define("DS/WAfrExecutionContext/mod_ExecutionContextInterpreter",["UWA/Class/Promise"],function(t){"use strict";class e{constructor(){this._executionContext=void 0,this._components=[],this._UIModel=void 0}interpret(e,n,o){this._executionContext=n,this._components=e.components,this._UIModel=e.UIModel;let i=!1;return this._components&&this._components.forEach(function(t){t&&"mod_WelcomeScreen"===t.key&&(i=!0)}),this._components&&i&&!this._executionContext.getSourceApp()?this._executionContext._doIWantToBeInWSContext=!0:i||(this._executionContext._doIWantToBeInWSContext=!1,this._executionContext.WSState=!1),t.resolve()}}var n={generateExecutionContextInterpreter:function(t){return new e}};return n}),define("DS/WAfrExecutionContext/mod_Component",["UWA/Core"],function(t){"use strict";var e=Object.create(null),n=function(){};function o(t,e){if("object"!=typeof e)throw new Error("target obj to update must be an object");var n;n=t.prototype,Object.keys(n).forEach(function(t){e.hasOwnProperty(t)||Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}function i(t,e){if("function"!=typeof e)throw new Error("parameters must be constructors (i.e. functions)");o(t,e.prototype)}e.Component=n,n.implementsBy=function(t){i(n,t)},n.mixinProperties=function(t){o(n,t)},n.prototype.getExecutionContext=function(){return this._private._executionContext},n.prototype.setExecutionContext=function(t){this._private=this._private||Object.create(null),this._private._executionContext=t},n.prototype.getRegisteredIdentifier=function(){return this._private._identifier},n.prototype.setRegisteredIdentifier=function(t){this._private=this._private||Object.create(null),this._private._identifier=t},n.prototype.setInitializedState=function(t){if("boolean"!=typeof t)throw new Error("Initialization state must be a boolean value");this._private=this._private||Object.create(null),this._private._initialized=t},n.prototype.isInitialized=function(){return this._private._initialized},n.prototype.initialize=function(){return t.Class.Promise.resolve()},n.prototype.clean=function(){return t.Class.Promise.resolve()},n.prototype.destroy=function(){return t.Class.Promise.resolve()},n.prototype.canBeParallelized=function(){return!0};var r=function(){};e.StandardComponent=r,n.implementsBy(r),r.implementsBy=function(t){i(r,t)},r.prototype.configure=function(){return t.Class.Promise.resolve()},r.prototype.getExposedComponentCtor=function(){return null},r.prototype.getExposedComponent=function(){return this._private?this._private._publicComponent:null},r.prototype.setExposedComponent=function(t){this._private=this._private||Object.create(null),this._private._publicComponent=t},r.prototype.generateInterpreter=function(t){return null},r.prototype.getCurrentInterpreter=function(){return this._private._currentInterpreter},r.prototype.setCurrentInterpreter=function(t){this._private=this._private||Object.create(null),this._private._currentInterpreter=t};var s=function(){};return e.Interpreter=s,s.prototype.interpret=function(t,e){throw new Error("Not implemented")},s.prototype.commit=function(t,e){throw new Error("Not implemented")},s.prototype.enrich=function(t,e){},e}),define("DS/WAfrExecutionContext/mod_ExecutionContext",["UWA/Utils","UWA/Core","DS/WAfrExecutionContext/mod_Component","UWA/Class/Promise","DS/WAfrExecutionContext/mod_ExecutionContextInterpreter","DS/WAfrUtils/Logger","DS/WAfrContainer/App","DS/WAfrDebug/mod_Performances","i18n!DS/WAfrContainer/assets/nls/Notification","DS/Controls/ModalContainer","DS/Controls/Loader","i18n!DS/WAfrExecutionContext/assets/nls/Transition","DS/WebUAUtils/WebUAUtils"],function(t,e,n,o,i,r,s,p,a,c,u,d,l){"use strict";var h=p.Performances,f=Object.create(null);function m(t){var e={},n=function(t){var n=t.split("==");if(2!==n.length)throw new Error("Bad syntax, expected expression like A == B, found "+t);var o=n[0].trim(),i=n[1].trim();if(o.indexOf('"')>=0||i.indexOf('"')>=0)throw new Error('Bad syntax, key and value should not contain double quote ", found '+t);if(o.indexOf(" ")>=0||i.indexOf(" ")>=0)throw new Error("Bad syntax, key and value should not contain space, found "+t);e[o]=i};if(t.indexOf("&&")>=0){var o=t.split("&&");if(o.length<2)throw new Error("Bad syntax, expected expression like A == B && C == D, found "+t);o.forEach(n)}else n(t);return e}function g(t,e,n){var o=!0;return Object.keys(e.when).forEach(function(n){o=o&&e.when[n]===t[n]}),o&&!e.fit?(e.fit=!0,!n&&e.onDidFitContext&&e.onDidFitContext(e.element)):o||(e.fit=!1,!n&&e.onDidUnfitContext&&e.onDidUnfitContext(e.element)),e.fit}function _(t){return{current:0,next:function(){return this.current>=t.length?null:t[this.current++]}}}function C(t){for(var e=n.Component.prototype,o=Object.keys(e),i=0;i<o.length;i++){const e=o[i];if(!t.hasOwnProperty(e))return!1}return!0}function x(t,e,n){return t(n)?e(n).then(x.bind(null,t,e)):n}function v(t){var e=t.iterator,n=t.action,i=t.generatedData,r=t.inverse;if(null===n||"function"!=typeof n)throw new Error("The action cannot be null and must be a function returning a promise");for(var s=[],p=[],a=[],c=[],u=e.next(),d=null,l=0;u;)d=i?i[l]:null,u.canBeParallelized()?(s.push(u),a.push(d)):r?(p.unshift(u),c.unshift(d)):(p.push(u),c.push(d)),u=e.next(),l+=1;var h=function(){return!p||p.length<=0?o.resolve():x(function(t){return t<p.length},function(t){return n(p[t],c[t]).then(function(){return++t})},0).then(function(t){return o.resolve(t)}).catch(function(t){return o.reject(t)})},f=function(){var t=s.length,e=null,i=[];for(l=r?t-1:0;r?l>=0:l<t;r?--l:++l)d=a[l],e=n(s[l],d),i.push(e);return o.all(i)};return r?f().then(h):h().then(f)}function A(t,e){return{current:0,next:function(){for(var n;this.current<t.length&&!n;){var o=t[this.current];n=e[o]?e[o].component:void 0,this.current+=1}return n}}}function w(t,e,n){var o,i,r=t._appComponents.length+t._stdComponents.length;if(n)for(i=r-1;i>=0;i--)o=i>=t._appComponents.length?t._stdComponents[i-t._appComponents.length]:t._appComponents[i],e(t._components[o],o);else for(i=0;i<r;i++)o=i>=t._stdComponents.length?t._appComponents[i-t._stdComponents.length]:t._stdComponents[i],e(t._components[o],o)}function y(t,e,o){return o?n.Component.implementsBy(t):n.StandardComponent.implementsBy(t),new t(e)}function I(t,e){return Boolean(t&&e&&t.stdConf&&t.stdConf[e])}function S(t){let e;return t&&t.stdConf&&(e=t.stdConf),e}function E(t,e){if(!t||!e)throw new Error("Missing parameters. Please provide modules to require and thier corresponding keys");let n=[].concat(e),o=[].concat(t);return new Promise(function(t,e){require(o,function(){let e=Object.create(null);for(let t=0;t<arguments.length;t++)e[n[t]]=arguments[t];t(e)},function(t){e(new Error(`Unable to load module : ${t.requireModules}. Please check your packaging`))})})}function W(t){const e=t.getComponent("mod_WelcomeScreen");e&&t.a2xConfig.isWelcomeScreenLoaded&&(e.hideWelcomeScreen(),t.a2xConfig.isWelcomeScreenLoaded=!1),t._doIWantToBeInWSContext=!1}function D(t,e){return new Promise((n,o)=>{require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","UWA/Data"],function(i,r){i.getAppInfo({appId:e,onComplete:i=>{var s="";i&&i.brand&&"string"==typeof i.brand&&"3DEXPERIENCE"!==i.brand&&"SOLIDWORKS"!==i.brand&&(s=i.brand),t._container._view.setBrand(s);let p=null;if(i.config)p=i.config;else for(var a=0;a<i.platforms.length;a++)if(i.platforms[a].id===i.platformId&&i.platforms[a].config){p=i.config;break}return p?(t=>{r.request(t,{type:"json",responseType:"json",onComplete:function(t){return t?(t.appId=e,t.title=i.title,t.brand=s,n(t)):o(new Error(`No app having the id ${e} has been retrieved from compass APIs`))}})})(p):n()}})})})}function b(t){if(!t)throw new Error("The execution context must be defined to fetch its widget's data");return t._container&&t._container._view?Promise.resolve(t._container._view.getValues()):Promise.reject(new Error("Impossible to retrieve the execution context's widget data."))}f.hasConfigurationFor=I,f.getConfigurationFor=function(t,e){let n;return t&&e&&t.stdConf&&t.stdConf[e]&&(n=t.stdConf[e]),n},f.getConfiguration=S;var T=function(t){return{getId:t.getId.bind(t),getComponent:function(e){return t.getComponent(e,!0)},registerComponent:function(e,n){t.registerApplicationComponent(e,n)},createAndRegisterComponent:t.createAndRegisterApplicationComponent.bind(t),unregisterComponent:t.unregisterApplicationComponent.bind(t),isRegisteredComponent:t.isRegisteredComponent.bind(t),recycleComponent:t.recycleComponent.bind(t),getData:function(){},getSourceApp:t.getSourceApp.bind(t),getTargetApp:t.getTargetApp.bind(t),getComponents:function(e){return t.getComponents(e,!0)},getContext:function(){return e.clone(t._contexts)},setContext:t.setContext.bind(t),switchApp:function(e,n){return e&&n?function(t,e,n){if(!t)throw new Error("Execution context must be defined to perform a switch of application specialization");const o=t.getSourceApp(),i=t._masterAppId;let r;return(r="localhost"===location.hostname?b(t):o&&o.getId()===e||i&&i===e?b(t):D(t,e)).then(e=>{let o=e&&e.afrSpecializations;return o?o&&Array.isArray(o)&&!o.includes(n)?Promise.reject(new Error("The given application is not authorized to switch in the current exeuction context")):t._container?t._container.getApplicationJSON({afrAppId:n}):Promise.reject(new Error("Cannot find the related container.")):Promise.reject(new Error("The given application is not authorized to switch in the current exeuction context"))}).then(n=>(t._masterAppId=e,t.load(n))).catch(function(t){return Promise.reject(t)})}(t,e,n):function(t,e){if(!t)throw new Error("Execution Context must be defined !");return D(t,e).then(n=>{if(n&&n.afrVersion&&"0.1"===n.afrVersion)return t.load(n);{t._masterAppId&&t._masterAppId!==e&&delete t._masterAppId;let o=n&&n.afrAppId||e;return t._container?t._container.getApplicationJSON({afrAppId:o}).then(e=>t.load(e)):Promise.reject(new Error("Cannot find the related container."))}})}(t,e)},gotoWelcomeScreen:function(){return t.gotoWelcomeScreen()},gotoApp:function(){return t.gotoApp()},getWelcomeScreenState:function(){return t.getWelcomeScreenState()},getWidgetID:t.getWidgetID.bind(t)}},k=function(n){var s=this;this._perf=new h,n=e.merge(n||{},{config:{components:[],interpreters:[]}}),this._id=n.id||t.getUUID(),this._config=n.config,this._config.interpreters=this._config.interpreters||[],this._interpreter=i.generateExecutionContextInterpreter(),this._components=Object.create(null),this._stdComponents=[],this._appComponents=[],this._contextualElements=[],this._WSComponents=[],this._handlers={},this.exposedApi=T(this),this.applicationContext=this.exposedApi,this._version=null,this._container=n.container,this._contexts=Object.create(null),this.onWillLoadApp=null,this.onDidLoadApp=null,this.onDidFailToLoadApp=null,this.onDidContextualComponentsUpdate=null,this._container=n.container,this._loader=null,this._container&&(this._container.subscribe("onReuseContext."+this.getId(),function(t){let e=10*parseFloat(t.afrVersion);(s._masterAppId&&delete s._masterAppId,e!==s._container._view._version)?require([e>=2?"DS/WAfrContainerAsWidget/default_config":"DS/WAfrContainerAsWidget/old_config"],function(e){s._container._config=e,s._config=e,s.load(t).then(console.log,console.warn)}):s.load(t).then(console.log,console.warn)}),this._container.subscribe("displayAfrLoader",function(t){s.displayLoader(t)}),this._container.subscribe("hideAfrLoader",function(){s.hideLoader()}),this._widgetID=this._container.id,this._winID=n.container._winID),this.applicativeMainUIComponentAvailability=!0,this._doIWantToBeInWSContext=!1,this.WSState=!1,this.isA2X=!1,this._isConfigured=!1,this._initExecutionContext=function(t,n,o){let i=Promise.resolve();return this.isA2X&&(i=this._initA2XExecutionContext(t)),i.then(()=>(function(t,e){function n(t,n){let o="["+t.module+"] "+t.func,i=e._perf.start(o);return new Promise((o,r)=>{function s(){e._perf.stop(i),o()}function p(){e._perf.stop(i),r()}require([t.module],function(e){return(0,e[t.func])(s,p,n)},function(t){return e._perf.stop(i),r(t)})})}let o=Promise.resolve();if(t.conditions){const e={appId:t.appId};let i=[],r=[];for(const[o,s]of Object.entries(t.conditions))i.push(o),r.push(n(s,e));o=Promise.allSettled(r).then(e=>{let n={};for(let t=0;t<i.length;++t)n[i[t]]=e[t];let o=t.components;if(o)for(let t=o.length-1;t>=0;--t)o[t].condition&&"rejected"===n[o[t].condition].status&&o.splice(t,1);let r=t.handlers.default;if(r)for(let t=r.length-1;t>=0;--t)r[t].condition&&"rejected"===n[r[t].condition].status&&r.splice(t,1);let s=t.handlers.check;if(s)for(let t=s.length-1;t>=0;--t)s[t].condition&&"rejected"===n[s[t].condition].status&&s.splice(t,1);let p=t.radioGroup;if(p&&(p=p.items))for(let t=p.length-1;t>=0;t--)p[t].condition&&"rejected"===n[p[t].condition].status&&p.splice(t,1);let a=t.UIModel;if(a&&(a=a.handlerList))for(let t=a.length-1;t>=0;t--)a[t].condition&&"rejected"===n[a[t].condition].status&&a.splice(t,1);let c=t.UIModel;if(c&&(c=c.categories))for(let t=c.length-1;t>=0;t--)c[t].condition&&"rejected"===n[c[t].condition].status&&c.splice(t,1)})}return o})(t,s).then(function(){return s._interpreter.interpret(t,s)}).then(function(){return s.registerStandardComponents()}).then(function(){return s.loadApp(t)}).then(function(t){if(s._targetApp=t.app,!s._targetApp)throw new Error("Not found a target app !");return s.prepareTransition(t)}).then(function(o){s._isConfigured=!1,s._components=e.merge(s._components,o.metaDatas),Object.keys(o.metaDatas).forEach(t=>{s._components[t].resetInfo&&!s._components[t].ctor&&(delete s._components[t],s._components[t]=o.metaDatas[t])}),s._appComponents=o.componentsKeys,s._WSComponents=o.WSComponentsKeys;var i=!1;for(var p in s._handlers){i=!1;for(var a=0;a<t.handlers.check.length;a++)t.handlers.check[a].identifier===p&&(t.handlers.check[a].defaultState=s._handlers[p],i=!0);if(!i)for(var c=0;c<t.radioGroup.items.length;c++)t.radioGroup.items[c].identifier===p&&(t.radioGroup.items[c].default=s._handlers[p])}return s.callAllInterpreters(t,n).then(function(t){return r.log("[Execution context] Initialize standard components"),s.initializeStandardComponents({generatedData:t})}).then(function(){return o})}))},this._welcomeScreenPromiseSequence=function(t){return r.log("[Execution context] Initialize WS applicative components"),s.initializeWSApplicativeComponents(t).then(function(){return r.log("[Execution context] Initialize application"),s.initializeWelcomeScreen()}).then(function(){r.log("[Execution context] Set Up the application Home Screen"),s.WSState=!0})},this._appPromiseSequence=function(t){let e=t,n=[],i=[],p=[];return t&&0!==Object.keys(t).length&&t.componentsKeys&&t.componentsKeys.forEach(function(t){s._components[t].component&&i.push(s._components[t].component)}),w(s,function(t,o){t.standard||(t.component?e||t.component.isInitialized()||(t.context&&t.context.fit||!t.context)&&i.push(t.component):(t.context&&t.context.fit||!t.context)&&(t.ctor?(s.registerComponentThruMetaData(o,t),i.push(t.component)):(p.push(t.module),n.push(o))))}),s.appModules=p,new o(function(t,e){let o,r,a,c;require(p,function(){for(arguments.length!=s.appModules.length&&t(),o=0;o<arguments.length;o++)r=arguments[o],a=n[o],(c=s._components[a]).ctor=r,s.registerComponentThruMetaData(a,c),i.push(c.component);t()},e)}).then(function(){return s.initializeApplicativeComponents({iterator:_(i)})}).then(function(){return r.log("[Execution context] Configure standard components"),s._isConfigured?Promise.resolve():s.configureComponents({setConfiguredFlag:!0})}).then(function(){return r.log("[Execution context] Initialize application"),s.initializeApp()}).then(function(t){return r.log("[Execution context] set the target app "+s._targetApp+" as source app"),t&&(r.warn("[WARNING] App should use the UIFrame component to add UI to their App"),t.inject(s.getUiContainer())),s.WSState=!1,o.resolve()})},this._launchA2XNativeApp=function(t){var e=this;if(!t.appId)throw new Error("Missing parameter appId!");return E("DS/WAfrA2XLoader/WAfrA2XAppLoader","AppLoader").then(n=>n.AppLoader.loadA2XApp({appId:t.appId,widgetID:e._widgetID}).then(t=>Promise.resolve(t)))},this._addNativeContent=function(t){return this.enrichStandardComponents(t).then(()=>{const t=this.getComponent("Afr_UIComponent");return t&&t.showMainComponent(),W(this),this._appPromiseSequence()})},this.whenAvailable=function(){return Promise.resolve()},this._subscribeToNativeTransitionEvent=function(){let t=Promise.resolve();return E("DS/WAfrA2XLoader/WAfrA2XAppLoader","AppLoader").then(e=>{this.a2xConfig.subscriptionToken=e.AppLoader.subscribeToNativeTransitionEvent({widgetID:this._widgetID,callback:e=>{r.log("Widget reacting to the Transition Event : "+this._widgetID),t=this._subscribeToNativeTransitionEventCallback(e),this.whenAvailable=(()=>new Promise((e,n)=>{t.then(e,n)}))}}),this.a2xConfig.subscribedToNative=!0})},this._unsubscribeToNativeTransitionEvent=function(){let t=this.a2xConfig.subscriptionToken;return E("DS/WAfrA2XLoader/WAfrA2XAppLoader","AppLoader").then(e=>{e.AppLoader.unsubscribeToNativeTransitionEvent(t)})},this._subscribeToNativeTransitionEventCallback=function(t){return new Promise((e,n)=>{const o=t.readString("winID"),i=t.readString("widgetID"),r=t.readString("wkName"),s=t.readString("appContent");if(this._widgetID!=i)console.log("INFO - the current window "+this._widgetID+" is not the target one.");else{if(!r||!s){const t=new Error("Impossible to retrieve the application name or the application content.");return console.error(t),n(t)}{const t=JSON.parse(s);if(!this._winID&&o&&(this._winID=o),(this.getSourceApp()?this.getSourceApp().getId():this.getTargetApp().getId())===`${r}_AP`&&this.getWelcomeScreenState())return this._addNativeContent(t).then(e).catch(t=>(console.error(t),n(t)));{this.a2xConfig.loadedFromNative=!0;const o=`${r}_AP`;this._container.getApplicationJSON({afrAppId:o}).then(t=>(W(this),this.load(t))).then(()=>this._addNativeContent(t).then(()=>(this.a2xConfig.loadedFromNative=!1,e())).catch(t=>(console.error(t),n(t))))}}}})},this._setPreferredWorkbench=function(t){if(!t.appId)throw new Error("Missing parameter appId!");return E("DS/WAfrA2XLoader/WAfrA2XAppLoader","AppLoader").then(e=>e.AppLoader.setPreferredWorkbench({appId:t.appId,widgetId:this._container._view.getId()}))},this._initA2XExecutionContext=function(t){this.a2xConfig||(this.a2xConfig={subscribedToNative:!1,loadedFromNative:!1,subscriptionToken:null,isWelcomeScreenLoaded:!1}),this.stdConfig=S(t);const e=t.appId;return this._setPreferredWorkbench({appId:e}).then(()=>{if(!this.a2xConfig.subscribedToNative)return this._subscribeToNativeTransitionEvent()})},this._closeA2XNativeWindow=function(){var t=this;return E("DS/WAfrA2XWidgetWindowSync/WAfrA2XWidgetWindowSync","WAfrA2XWidgetWindowSync").then(e=>e.WAfrA2XWidgetWindowSync.closeA2XWindow({widgetID:this._widgetID,winID:this._winID}).then(e=>t._winID!=e.readString("winID")||t._widgetID!=e.readString("widgetID")?(r.log("[Execution context] Error during CATFrmWindow destruction"),o.reject()):(r.log("[Execution context] Successful CATFrmWindow destruction"),o.resolve())))},this._disposeExecutionContext=function(){this._timerHandle&&clearTimeout(this._timerHandle),this._timerHandleTreatment&&clearTimeout(this._timerHandleTreatment);var t=this;this._sourceApp&&this._sourceApp.dispose(),w(this,function(e){e.component&&(e.component.clean(!0),e.component.setInitializedState(!1),e.component.destroy(!0),e.component.setExecutionContext(null),t.removeComponent(e))},!0),this.isA2X&&(this._unsubscribeToNativeTransitionEvent(),delete this.a2xConfig.loadedFromNative,delete this.a2xConfig.subscribedToNative,delete this.a2xConfig.subscriptionToken,delete this.a2xConfig,delete this.isA2X),delete this._components,delete this._stdComponents,delete this._appComponents,delete this.exposedApi,delete this._contexts,this.onWillLoadApp=null,this.onDidLoadApp=null,this.onDidFailToLoadApp=null,this.onDidContextualComponentsUpdate=null,this._container=null},this._setWidgetIDOnCATFrmWindow=function(){if(!this._widgetID||!this._winID)throw new Error("Missing parameter widgetID or winID!");return E("DS/WAfrA2XWidgetWindowSync/WAfrA2XWidgetWindowSync","WAfrA2XWidgetWindowSync").then(t=>t.WAfrA2XWidgetWindowSync.setWidgetID({widgetID:this._widgetID,winID:this._winID}))}};return f.ExecutionContext=k,k.prototype.setUiContainer=function(t){this._view=t},k.prototype.getUiContainer=function(){return this._view},k.prototype.getContainerView=function(){return this._container?this._container._view:null},k.prototype.getTargetApp=function(){return this._targetApp},k.prototype.getWidgetID=function(){return this._widgetID},k.prototype.getSourceApp=function(){return this._sourceApp},k.prototype.getId=function(){return this._id},k.prototype.getWinID=function(){return this._winID},k.prototype.getComponent=function(t,e){if(null==t)throw new Error("Invalid identifier "+t);var n=void 0;if(this._components&&(n=this._components[t]),n){var o=n.component;if(o){if(e&&o.getExposedComponent&&o.getExposedComponent())return o.getExposedComponent();if(!e||!n.standard)return o}}},k.prototype.cleanComponent=function(t,e){if(!t)throw new Error("Component must be defined ");var n=t.getRegisteredIdentifier();if(null==n||"string"!=typeof n)throw new Error("Invalid identifier "+n);var i=this._components[n];if(!i)throw new Error("The MetaData for this component do not exists");var s=this;if(r.log("[Execution context] clean component "+n),i.new)return i.new=!1,o.resolve();var p=t.clean()||o.resolve();return i.recycled&&i.context&&(i.recycled=g(s._contexts,i.context,!0)),!i.recycled&&!i.standard||i.standard&&i.clear||i.welcomeScreen?p.then(function(){return t.setInitializedState(!1),r.log("[Execution context] destroy component "+n),t.destroy()}).then(function(){return r.log("[Execution context] Remove component "+n+" from execution context"),e=!!i.clear||e&&!i.standard,s.removeComponent(i,e),o.resolve(t)}):(i.recycled=!1,i.standard||t.setInitializedState(!1),p.then(function(){return o.resolve(t)}))},k.prototype.unregisterComponent=function(t,e){if(null==t||"string"!=typeof t)throw new Error("Invalid identifier "+t);if(void 0!==this._components[t]){var n=this._components[t];if(n.standard&&e)throw new Error("Invalid access, try to unregister a standard component from application side");var i=n.component,s=this;return r.log("[Execution context] clean component "+t),(i.clean()||o.resolve()).then(function(){return r.log("[Execution context] destroy component "+t),i.destroy()}).then(function(){return r.log("[Execution context] Remove component "+t+" from execution context"),s.removeComponent(n,!0),o.resolve(i)})}return o.resolve()},k.prototype.isRegisteredComponent=function(t){if(!t)throw new Error("The component is null or undefined");var e=!1,n=t.getRegisteredIdentifier(),o=this._components[n];return o&&o.component&&(o.component===t||o.component.getExposedApi&&o.component.getExposedApi()===t)&&(e=!0),e},k.prototype.cleanComponents=function(t){var e=this;return v({action:function(n){return e.cleanComponent(n,!!t&&t.removeForGood)},inverse:!0,iterator:t&&t.iterator?t.iterator:A(e._appComponents.concat(e._stdComponents),e._components)})},k.prototype.destroyComponents=function(t){var e=this;return v({action:function(t){r.log("[Execution context] destroy component "+t.getRegisteredIdentifier());var n=e._components[t.getRegisteredIdentifier()];return t.destroy().then(function(){return e.removeComponent(n,n.clear)})},inverse:!0,iterator:t&&t.iterator?t.iterator:A(that._appComponents.concat(that._stdComponents),that._components)})},k.prototype.recycleComponent=function(t,e){if(null==t||"string"!=typeof t)throw new Error("Invalid identifier "+t);var n=this._components[t];if(!n)return!1;if(n.standard)throw new Error("Cannot recycle a standard component");if(n.recycled)return!1;var o=!0;if(e){var i=this._targetApp.options.appConfig.components.find(e=>e.key==t);n.options=i.options,n.component&&(n.component.options=i.options),i.when?(n.context={element:i.key,when:m(i.when),onDidFitContext:this.onDidFitContextForComponent.bind(this),onDidUnfitContext:this.onDidUnFitContextForComponent.bind(this)},o=g(this._contexts,n.context,!0)):delete n.context}return o&&(n.recycled=!0),!0},k.prototype.isComponentRecycled=function(t){if(null==t||"string"!=typeof t)throw new Error("Invalid identifier "+t);var e=this._components[t];return!!e&&e.recycled},k.prototype.getComponents=function(t,e){if(!t)throw new Error("Predicate function is mandatory");var n,o=[],i=this;return w(this,function(r,s){(n=i.getComponent(s,e))&&t(n)&&o.push(n)}),o},k.prototype.registerComponent=function(t,e,n,o){if(null==t||"string"!=typeof t)throw new Error("Invalid identifier "+t);if(null==e)throw new Error("Component cannot be null");if(o&&!C(Object.getPrototypeOf(e))&&!C(e))throw new Error("the given component do not contains some methods of DS/WAfrExecutionContext/mod_Component");if("setExecutionContext"in e==!1||"setRegisteredIdentifier"in e==!1)throw new Error("The component do not implements module:DS/WAfrExecutionContext/mod_Component~Component. Use applyComponentMixin first from the context.");if(this._components[t])throw new Error("An component has already been registered with this identifier "+t);var i=n?this._appComponents:this._stdComponents,r={standard:!n,position:i.length};this._components[t]=r,i.push(t),this.registerComponentThruMetaData(t,r,e)},k.prototype.removeComponent=function(t,e){if(!t)throw new Error("You must provide a metaData");if(!t.component)throw new Error("The component is already removed");var n=t.component.getRegisteredIdentifier();if(t.component.setExecutionContext(null),t.component.setRegisteredIdentifier(null),delete t.component,e){var o=t.standard?this._stdComponents:this._appComponents,i=o.indexOf(n);if(i>=0&&o.splice(i,1),!t.standard){let t=this._WSComponents.findIndex(function(t){return t===n});-1!==t&&this._WSComponents.splice(t,1)}delete this._components[n]}},k.prototype.registerComponentThruMetaData=function(t,e,o){if(!e)throw new Error("The metaData do not exist: the module may not be required");if(e.component)throw new Error("The component: "+e.component._private._identifier+" is already created");if(!o){if(!e.ctor)throw new Error("The Component constructor must be defined.");if("function"!=typeof e.ctor)throw new Error(" Component constructor must be a constructor (i.e. functions)");o=y(e.ctor,e.options,!e.standard)}e.component=o;var i=e.standard?this:this.exposedApi;e.component.setExecutionContext(i),e.component.setRegisteredIdentifier(t);var r=e.component.createExposedComponent&&e.component.createExposedComponent();if(r)n.Component.mixinProperties(r),r.setExecutionContext(this.exposedApi),r.setRegisteredIdentifier(t),e.component.setExposedComponent(r);else{var s=e.component.getExposedComponentCtor&&e.component.getExposedComponentCtor();if(s){var p=y(s,void 0,!0);p.setExecutionContext(this.exposedApi),p.setRegisteredIdentifier(t),e.component.setExposedComponent(p)}}return e.component},k.prototype.createAndRegisterComponent=function(t,e,n,o){if(!this._components[t]){var i=y(e,n,o);if(this.registerComponent(t,i,o),!this._components[t])throw new Error("The metaData for component do not exist !");return this._components[t].ctor=e,i}},k.prototype.requireStandardComponents=function(t,e){var n,i,r,s,p,a=this;if(t.length!==e.length)throw new Error("Modules and keys do not have the same size !");return new o(function(o,c){require(t,function(){var t;for(n=0;n<arguments.length;n+=1)i=arguments[n],r=e[n],t=a._components[r],s=t.ctorImport,p=s?i[s]:i,t.ctor=p,a.registerComponentThruMetaData(r,t);o()},c)})},k.prototype.registerStandardComponents=function(){r.log("[Execution context] Register standard components if need ");var t=this;if(t._stdComponents.length>0){var n,o=[],i=[],s=[],p=[],a=Array.from(t._config.components);if(w(this,function(e,r){if(t._stdComponents.length!=t._config.components.length&&e.standard){0==a.length&&(e.component?(s.push(e.component),e.clear=!0):delete t._components[r]);for(let n=0;n<a.length;n++){if(a[n].key===r){a.splice(n,1);break}n===a.length-1&&(e.component?(s.push(e.component),e.clear=!0):delete t._components[r])}}e.standard&&e.context&&(n=g(t._contexts,e.context,!0),e.component?!n&&e.component&&(s.push(e.component),p.push(e.component)):n&&(o.push(e.module),i.push(r)))}),t._stdComponents.length!=t._config.components.length){var c=t.parseComponents(a,!1,!0);t._components=e.merge(t._components,c.metaDatas),t._stdComponents=t._config.components.map(t=>t.key),o=o.concat(c.readyModules),i=i.concat(c.readyKeys)}return t.cleanComponents({iterator:_(s)}).then(function(){return t.destroyComponents({iterator:_(p)})}).then(function(){return t.requireStandardComponents(o,i)})}var u=t.parseComponents(t._config.components);return t._components=e.merge(t._components,u.metaDatas),t._stdComponents=u.componentsKeys,t.requireStandardComponents(u.readyModules,u.readyKeys)},k.prototype.initializeStandardComponents=function(t){var e=this,n=null;return v({action:function(t,o){(n=t.getCurrentInterpreter&&t.getCurrentInterpreter())&&n.commit&&n.commit(e,{componentId:t.getRegisteredIdentifier()});let i=e._perf.start("WAFR: initialize std :"+t._private._identifier);return t.initialize(o).then(function(){e._perf.stop(i)})},generatedData:t.generatedData,iterator:t&&t.iterator?t.iterator:A(this._stdComponents,this._components)})},k.prototype.enrichStandardComponents=function(t){const e=this._interpreters,n=this;let o=Promise.resolve();return this._interpreters.length>0&&(o=x(function(t){return t<e.length},function(o){const i=e[o];let r=Promise.resolve();return i.enrich&&(r=i.enrich(t,n).then(function(){},function(t){throw t})),r.then(()=>++o)},0)),o},k.prototype.initializeWSApplicativeComponents=function(t){var e=this;return v({action:function(t,n){let o=e._perf.start("WAFR: initialize "+t._private._identifier);var i=t.initialize(n);return i&&i.then||r.warn(`[Execution Context] The initialize method of your component ${t._private._identifier} is not a Promise object. Make sure it is not asynchronous.`),Promise.resolve(i).then(function(){t.setInitializedState(!0),e._perf.stop(o)})},iterator:t&&t.iterator?t.iterator:A(this._WSComponents,this._components)})},k.prototype.cleanNonWSComponentsMetadatasMap=function(){const t=this._targetApp.getTransitionFrom(this._sourceApp.getId());let e=[];t&&t.components&&t.components.keep&&(e=t.components.keep);const n=this._targetApp.getTransitionFromFamily(this._sourceApp.getFamily());let o=[];n&&n.components&&n.components.keep&&(o=n.components.keep),(this._sourceApp.options.appConfig.components||[]).forEach(t=>{-1===e.indexOf(t.key)&&-1===o.indexOf(t.key)&&(t.options&&t.options.welcomeScreen||delete this._components[t.key])})},k.prototype.configureComponents=function(t){var e=this;return v({action:function(t){return t.configure()},iterator:t&&t.iterator?t.iterator:A(this._stdComponents,this._components)}).then(function(){t&&t.setConfiguredFlag&&(e._isConfigured=!0)})},k.prototype.cleanStandardComponents=function(){return v({action:function(t){return t.clean()},iterator:A(this._stdComponents,this._components)})},k.prototype.parseApplicativeComponents=function(t){return this._appConfig={components:t},this.parseComponents(t,!0)},k.prototype.registerApplicationComponent=function(t,e){if(!e)throw new Error("Component is null");return this.registerComponent(t,e,!0,!0)},k.prototype.createAndRegisterApplicationComponent=function(t,e,n){if(!e)throw new Error("Component is null");return this.createAndRegisterComponent(t,e,n,!0)},k.prototype.createAndRegisterApplicationComponentsList=function(t){if(r.log("[Execution Context] Register Application Components :"+t),t)for(var e=0;e<t.length;e++){var n=t[e];this.createAndRegisterApplicationComponent(n.key,n.mod,n.options)}},k.prototype.getApplicationComponent=function(t){return this.getComponent(t,!0)},k.prototype.unregisterApplicationComponent=function(t){return this.unregisterComponent(t,!0)},k.prototype.isRegisteredApplicationComponent=function(t){return this.isRegisteredComponent(t)},k.prototype.recycleApplicationComponent=function(t,e,n){if(e&&!e.metaDatas[t])throw new Error('The App "'+this._targetApp.getId()+'" has requested to recyle the component "'+t+'" but do not declare it in its list of components :\n'+JSON.stringify(e.metaDatas,null,2));return this.recycleComponent(t,n)},k.prototype.isApplicationComponentRecycled=function(t){return this.isComponentRecycled(t)},k.prototype.prepareTransition=function(t){var e,n,i=this,r=0;return this._sourceApp?this._sourceApp.onWillLeave(this._targetApp).then(function(){return i._targetApp.onWillEnter(i._sourceApp)}).then(function(){var o=!0,s=i._targetApp.getTransitionFrom(i._sourceApp.getId());if(s||(s=i._targetApp.getTransitionFromFamily(i._sourceApp.getFamily())),s){var p=s.components||{},a=s.handlers||{};if(null!=s.resetInfo&&(o=s.resetInfo),p.keep)if("@all"===p.keep)for(e in i.applicationContext._components)i.recycleApplicationComponent(e,t,o);else if(Array.isArray(p.keep))for(;r<p.keep.length;r++)n=p.keep[r],i.recycleApplicationComponent(n,t,o);if(a.keep&&Array.isArray(a.keep)){var c=i._sourceApp.options.appConfig.handlers.check,u=t.app.options.appConfig.handlers.check,d=i._sourceApp.options.appConfig.radioGroup.items,l=t.app.options.appConfig.radioGroup.items,h="",f=h,m=h,g=i.getComponent(WAfrStandardComponentKey.HandlerComponent);for(r=0;r<a.keep.length;r++){m=a.keep[r],h=f="";for(var _=0;_<c.length;_++)if(c[_].identifier==m){h=c[_].identifier+"-"+c[_].check.identifier+"-"+c[_].uncheck.identifier;break}for(_=0;_<u.length;_++)if(u[_].identifier===m){f=u[_].identifier+"-"+u[_].check.identifier+"-"+u[_].uncheck.identifier;break}if(f===h&&""!=h){var C=g.getCheckState({id:m});i._handlers[m]=C}else{for(_=0;_<d.length;_++)if(d[_].identifier==m)for(var x=0;x<d[_].items.length;x++)1==g.getRadioItemState({radioId:d[_].identifier,id:d[_].items[x].identifier})&&(h=d[_].identifier+"-"+d[_].items[x].identifier+"-"+d[_].items[x].check.identifier+"-"+d[_].items[x].uncheck.identifier);for(_=0;_<l.length;_++)if(l[_].identifier==m)for(x=0;x<l[_].items.length;x++)if((f=l[_].identifier+"-"+l[_].items[x].identifier+"-"+l[_].items[x].check.identifier+"-"+l[_].items[x].uncheck.identifier)==h){C=l[_].items[x].identifier;i._handlers[m]=C;break}}}}}return i.cleanComponents({removeForGood:!0})}).then(function(){return i._doIWantToBeInWSContext&&i.cleanNonWSComponentsMetadatasMap(),o.resolve(t)}):o.resolve(t)},k.prototype.initializeApplicativeComponents=function(t){var e=this;return v({action:function(t,n){let o=e._perf.start("WAFR: initialize "+t._private._identifier);var i=t.initialize(n);return i&&i.then||r.warn(`[Execution Context] The initialize method of your component ${t._private._identifier} is not a Promise object. Make sure it is not asynchronous.`),Promise.resolve(i).then(function(){t.setInitializedState(!0),e._perf.stop(o)})},iterator:t&&t.iterator?t.iterator:A(this._appComponents,this._components)})},k.prototype.load=function(t,e){var n=this;if(!t.appId&&!t.afrAppId)throw new Error("Not found a valid App id from the current Id Card ");l.setAppid(t.appId||t.afrAppId),this.onWillLoadApp&&this.onWillLoadApp(t.appId||t.afrAppId),n._perf.start("WAFR:  load entire App "),e||(e=t.afrVersion||"0.1"),r.log("[Execution context] load new app "+t.appId),this.isA2X=I(t,"a2x");let i=this.isA2X?{...t.initialContext,a2x:!0}:t.initialContext;n.setInitialContext(i);var s=void 0;if(n._sourceApp&&t.afrTransitionsFrom&&((s=t.afrTransitionsFrom[n._sourceApp.getId()])||(s=t.afrTransitionsFromFamily?t.afrTransitionsFromFamily[n._sourceApp.getFamily()]:null),s&&"ReuseContext"===s.type)){var p=s.components||{};if(p.keep){if("@all"===p.keep)throw"TODO";if(Array.isArray(p.keep)){for(var a={},c=0;c<p.keep.length;c++){var u=p.keep[c],d=n._components[u];d&&d.context&&!0===d.context.fit&&Object.keys(d.context.when).forEach(function(t){a[t]=d.context.when[t]})}Object.keys(a).forEach(function(t){var e=a[t];null!=e&&(n._contexts[t]=String(e))})}}}let h=Promise.resolve();return this.isA2X&&(h=this._initA2XExecutionContext(t),this.stdConfig=S(t)),h.then(()=>this._initExecutionContext(t,e,s)).then(function(t){if(n._doIWantToBeInWSContext&&!n._winID)return n._welcomeScreenPromiseSequence(t);if(!n.isA2X)return n._appPromiseSequence(t);if(n._winID&&n._container._appContent)return n._appPromiseSequence(t).then(t=>n._addNativeContent(n._container._appContent).then(t=>(delete n._container._appContent,n._setWidgetIDOnCATFrmWindow().then(()=>{}))));if(!n.a2xConfig.loadedFromNative&&n.getTargetApp()){const t=n.getTargetApp().getId();return n._launchA2XNativeApp({appId:t})}}).then(function(){n.getSourceApp()&&!n.getSourceApp().isDisposeCalled()&&n.getSourceApp().dispose(),n._sourceApp=n._targetApp,n._targetApp=null,n.hideLoader(),n.onDidLoadApp&&n.onDidLoadApp()}).catch(function(t){return n.getSourceApp()&&l.setAppid(n.getSourceApp().getId()),n.hideLoader(),n.onDidFailToLoadApp&&n.onDidFailToLoadApp(t),o.reject(t)})},k.prototype.loadApp=function(t){var e=this;return new o(function(n,o){var i=t.afrCode;i||(i="DS/WAfrAppManager/App"),i=i.replace(/\./g,"/");var p,a,c,u,d,l,h=e.parseComponents(t.components||[],!0),f=[i].concat(h.readyModules);r.log("[Execution Context] Require modules "+f),require(f,function(){var i=arguments[0];if(arguments.length!==h.readyKeys.length+1)throw new Error("The count of arguments and components do not fit");for(p=0;p<h.readyKeys.length;p++)a=h.readyKeys[p],c=h.metaDatas[a],u=arguments[p+1],d=c.ctorImport,l=d?u[d]:u,c.ctor=l,e.registerComponentThruMetaData(a,c);var f=new i({appConfig:t});f instanceof s!=!1?f.getId()?(r.log("[App Interpreter] Success require App and components "),n({app:f,metaDatas:h.metaDatas,componentsKeys:h.componentsKeys,WSComponentsKeys:h.WSComponentsKeys})):o(new Error("The app loaded do not have an id")):o(new Error("The app loaded is not an instance of DS/WAfrAppManager/App"))},o)})},k.prototype.callAllInterpreters=function(t,e){r.log("[Execution context] Start interpret id card");var n=[],i=this._version!==e;function s(e,i){const r=e?this.getComponent(e):void 0;if(!r)throw new Error("No component associated to the given interpreter");if(r.setCurrentInterpreter(i),i){var s=i.interpret(t,this,{componentId:e});n.push(s)}else n.push(o.resolve(null))}let p=Promise.resolve();return this._interpreters&&this._config.interpreters.length==this._interpreters.length||(this._interpreters=[],i=!1,this._config.interpreters.length>0&&(p=x(t=>t<this._config.interpreters.length,t=>{return this._config.interpreters[t].module.generateInterpreter(e,this.stdConfig).then(e=>(this._interpreters.push(e),++t))},0))),p.then(function(){return this._interpreters||(this._interpreters=[]),x(t=>t<this._interpreters.length,t=>{var n=this._interpreters[t];return i?this._config.interpreters[t].module.generateInterpreter(e,this.stdConfig).then(e=>(this._interpreters[t]=e,s.bind(this)(this._config.interpreters[t].target,e),Promise.resolve(++t))):(s.bind(this)(this._config.interpreters[t].target,n),Promise.resolve(++t))},0)}.bind(this)).then(()=>o.all(n))},k.prototype.initializeApp=function(){var t=this.getTargetApp();if(!t&&!(t=this.getSourceApp()))return o.reject(new Error("No app has been loaded by the interpreter !"));var e=this;return t._executionContext=this.exposedApi,t.setContainer(e._container?e._container._view:null),new o(function(n,o){if(t){var i=t.setUp({sourceApp:e._sourceApp,done:function(t){n(t)},failure:function(t){o(t)}});i&&i.then(n,o)}})},k.prototype.initializeWelcomeScreen=function(){var t=this.getTargetApp();if(!t&&!(t=this.getSourceApp()))return o.reject(new Error("No app has been loaded by the interpreter !"));var e=this;t._executionContext=this.exposedApi,t.getContainer()||t.setContainer(e._container?e._container._view:null);var n=new o(function(n,o){if(t){var i=t.setUpWS({sourceApp:e._sourceApp,done:function(t){n(t)},failure:function(t){o(t)}});i&&i.then(n,o)}}).then(function(){if(e.isA2X){const t=e.getComponent("mod_WelcomeScreen");t&&t.showWelcomeScreen()}});return this.isA2X&&(this.a2xConfig.isWelcomeScreenLoaded=!0),n},k.prototype.dispose=function(){return this._winID&&""!=this._winID?this._closeA2XNativeWindow().then(()=>(this._disposeExecutionContext(),o.resolve()),function(t){return alert("Error during closing of Window on server side"),o.reject(t)}):(this._disposeExecutionContext(),o.resolve())},k.prototype.registerContextualElement=function(t,e){if(!t||!t.when)throw new Error("The contextual element must be defined and must contain a when expression");e=e||{};var n={element:t,when:m(t.when),onDidFitContext:e.onDidFitContext,onDidUnfitContext:e.onDidUnfitContext};return this._contextualElements.push(n),g(this._contexts,n),n},k.prototype.onDidChangeContext=function(){this._timerHandle=null;var t=this._contexts;w(this,function(e){e.context&&g(t,e.context)}),this._contextualElements.forEach(function(e){g(t,e)})},k.prototype.parseComponents=function(t,e,n){var o,i,r=[],s=[],p={},a=[],c=[],u=this;return t.forEach(function(t){o=!0,i={module:t.code,ctorImport:t.ctor,options:t.options,standard:!e,position:a.length,new:1==n,resetInfo:t.resetInfo},"mod_WelcomeScreen"===t.key&&(i.welcomeScreen=!0),p[t.key]=i,a.push(t.key),t.when&&(i.context={element:t.key,when:m(t.when),onDidFitContext:u.onDidFitContextForComponent.bind(u),onDidUnfitContext:u.onDidUnFitContextForComponent.bind(u)},o=g(u._contexts,i.context,!0)),e&&u._doIWantToBeInWSContext&&(t.options&&t.options.welcomeScreen||"mod_WelcomeScreen"===t.key?c.push(t.key):o=o&&!u._doIWantToBeInWSContext),o&&(r.push(t.code),s.push(t.key))}),{readyModules:r,readyKeys:s,metaDatas:p,componentsKeys:a,WSComponentsKeys:c}},k.prototype.onDidFitContextForComponent=function(t){var e=this._components[t];if(e&&e.context){if(!e.context.fit)throw new Error("Unexpected state of context");this._timerHandleTreatment&&clearTimeout(this._timerHandleTreatment),this._timerHandleTreatment=setTimeout(this.onDidProcessContextualComponent.bind(this),0)}},k.prototype.onDidUnFitContextForComponent=function(t){var e=this._components[t];if(e&&e.context){if(e.context.fit)throw new Error("Unexpected state of context");this._timerHandleTreatment&&clearTimeout(this._timerHandleTreatment),this._timerHandleTreatment=setTimeout(this.onDidProcessContextualComponent.bind(this),0)}},k.prototype.setInitialContext=function(t){var e,n=Object.create(null);Object.keys(t||n).forEach(function(o){null!=(e=t[o])&&(n[o]=String(e))}),this._contexts=n},k.prototype.setContext=function(t,e){return this._contexts[t]!==e&&(e?this._contexts[t]=String(e):delete this._contexts[t],this._timerHandle&&clearTimeout(this._timerHandle),this._timerHandle=setTimeout(this.onDidChangeContext.bind(this,this._contexts),0)),this},k.prototype.onDidProcessContextualComponent=function(){var t=[],e=[],n=[],i=[],r=[],s=[],p=this;return w(this,function(o,a){if(o.context){var c=!0;o.standard||p._WSComponents.includes(a)||(c=c&&!p.WSState),c&&o.context.fit&&!o.component?o.ctor?(p.registerComponentThruMetaData(a,o),o.standard?r.push(o.component):s.push(o.component)):(t.push(o.module),e.push(a)):o.context.fit||o.component&&(n.push(o.component),o.standard&&i.push(o.component))}}),this._timerHandleTreatment=null,p.modules=t,new o(function(n,o){var i,a,c,u;require(t,function(){if(arguments.length!==p.modules.length)return n();for(i=0;i<arguments.length;i++)a=arguments[i],c=e[i],(u=p._components[c]).ctor=a,u=p._components[c],p.registerComponentThruMetaData(c,u),u.standard?r.push(u.component):s.push(u.component);n()},o)}).then(function(){return p.cleanComponents({iterator:_(n)})}).then(function(){return p.destroyComponents({iterator:_(i)})}).then(function(){return p.initializeStandardComponents({iterator:_(r)})}).then(function(){return p.initializeApplicativeComponents({iterator:_(s)})}).then(function(){return p.getWelcomeScreenState()||p._doIWantToBeInWSContext?Promise.resolve():p.configureComponents({iterator:_(r),setConfiguredFlag:!1})}).then(function(){return p.onDidContextualComponentsUpdate&&p.onDidContextualComponentsUpdate(),o.resolve()})},k.prototype.displayLoader=function(t){if(!(this._container&&this._container.id!=t.id||this._loader)){this._loader=new u;var e=d.get("WAfrTransitionLaunched.title");this._loader.on(e+t.appTitle+"..."),c.createModal(this._view,this._loader.elements.container)}},k.prototype.hideLoader=function(){this._loader&&this._view&&(this._loader.off(),c.removeModal(this._view),this._loader=null)},k.prototype.gotoWelcomeScreen=function(){var t=this;return t._doIWantToBeInWSContext=!0,this.initializeWelcomeScreen().then(function(){return t.WSState=!0,Promise.resolve()})},k.prototype.gotoApp=function(){this._doIWantToBeInWSContext=!1;Promise.resolve();if(this.isA2X&&this.getSourceApp()){let t=this.getSourceApp().getId();return this._launchA2XNativeApp({appId:t})}return this._appPromiseSequence()},k.prototype.getWelcomeScreenState=function(){return this.WSState},f});