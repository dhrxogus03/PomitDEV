define("DS/LifecycleControls/EditPropDialog",["UWA/Class","DS/ApplicationFrame/Command"],function(e,t){"use strict";return t.extend({defaultIsTransient:!1,extraNotif:!1,mergeSupport:!0,init:function(e,t){this._parent(e,t),require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"]),this.editProp=null},beginExecute:function(){},_launchTransientWidget:function(e,t){window.top.performance.mark("end_EP_SelectionTreatment"),window.top.performance.mark("start_EP_TransientLoaded"),!0===window.top.isDebug&&console.log("Launch transient "+window.top.performance.now()),e.showWidget("ENOLCMT_AP","ENOVIA - Information ",t,{mode:"panel",height:800,width:650})},launchProperties:function(e){window.top.performance.mark("start_EP_FullTime"),window.top.performance.mark("start_ExecuteAndLoadCommand");var t,i,n,o,s,a,l,r,d,c,u=[],h=[],m=!1,f=null;let p=!1;if(null!=e.options&&(e.options,1)){if(null!=(u=e.options.arguments))for(let e=0;e<u.length;e++)void 0!==u[e].facets?h.push(u[e].facets):"true"==u[e].readOnly||"false"==u[e].readOnly?t=u[e].readOnly:void 0!==u[e].appId?i=u[e].appId:void 0!==u[e].multiselection?n=u[e].multiselection:void 0!==u[e].setCloseButton?o=u[e].setCloseButton:void 0!==u[e].setEditButton?s=u[e].setEditButton:void 0!==u[e].editMode?a=u[e].editMode:void 0!==u[e].extraNotif?l=u[e].extraNotif:void 0!==u[e].defaultFacetName?r=u[e].defaultFacetName:void 0!==u[e].infoForFacet?d=u[e].infoForFacet:void 0!==u[e].indexModeParameter?c=u[e].indexModeParameter:void 0!==u[e].disableAddExtensionButton?m=u[e].disableAddExtensionButton:void 0!==u[e].ignoreKernelAccessChecks&&(p=u[e].ignoreKernelAccessChecks);var g=e.options.infoForFacet;null!=g&&Object.keys(g).length>0&&(d=g);var v=e.options.indexModeParameter;null!=v&&(c=v)}e&&"function"==typeof e.getSecurityContext&&e.getSecurityContext()&&e.getSecurityContext().SecurityContext&&(f=e.getSecurityContext().SecurityContext);var C=widget.data.appId;if(C||(C=widget.data.x3dAppId),widget&&"1"===widget.getValue("debug_me")){for(var y=[],b=window.top.performance.getEntriesByType("mark"),w=0;w<b.length;w++){var S=b[w].name,x=S.replace("start_","").replace("end_","");S!==x&&y.push(S)}y.forEach(function(e){window.top.performance.clearMarks(e)})}var D=this,I=!1;widget&&(widget.setValue("index_mode",!1),I=widget.getValue("index_mode")),require(["DS/WidgetServices/securityContextServices/SecurityContextServices","DS/EditPropWidget/models/EditPropModelMerge","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/utils/EditPropUtils","DS/EditPropWidget/constants/ConstantsMapping","DS/EditPropWidget/ajaxRequests/ServicesAjaxRequests","DS/WidgetServices/WidgetServices","DS/TransientWidget/TransientWidget"],function(u,g,v,y,b,w,S,x){window.top.performance.mark("end_ExecuteAndLoadCommand"),window.top.performance.mark("start_EP_SelectionTreatment");var _=D.mergeSupport,E={context:e},k=[],A=[],L=e.model;L&&L.objectId?(L.tenant&&(E.tenant=L.tenant),L.source&&(E.source=L.source),A.push(new v(L))):k=e.getSelectedNodes(),u.getInstance(E).getValidSecurityContext(),k.length&&k.forEach(function(e){c&&(e.indexModeParameter=c);var t=y.getModelFromSelectedNode(e);t&&A.push(t)});var N=S.getWidgetValue("editProperties_readOnly");if(A.length>0){var M=A[0];_||(A=[M]),A=S.removeDuplicate(A,function(e){return e.get("objectId")});var P=D.defaultIsTransient;if("function"==typeof e.isTransient&&(P=e.isTransient()),!1!==(P=!0===P||S.isTransientWidget())||S.isWebInWinEnvironment()||S.isNatifEnvironnement())require(["DS/EditPropWidget/EditPropComponent","DS/EditPropWidget/constants/EditPropConstants"],function(t,i){if(null==D.editProp){var n=function(){},o=S.getWidgetPreference("editProperties_editMode");if(void 0===o){var s={type:"hidden",name:"editProperties_editMode",label:"editProperties_editMode",defaultValue:!1};S.addWidgetPreference(s)}o=!!o&&o.value;var a=!1;I?(a="true",o=!1):void 0!==N&&(a=N),c="true"===c||!0===c;var l=S.getWidgetBody();l=l||UWA.extend(document.body),D.editProp=new t({className:"editProp_popup_fromCmd",readOnly:a,editMode:o,context:e,displayType:i.POPUP,container:l,extraNotif:D.extraNotif,infoForFacet:d,indexModeParameter:c,securityContextFromAppPreference:f,appId:C,disableAddExtensionButton:m,USE_APP_SECURTIYCONTEXT:!0,ignoreKernelAccessChecks:p,events:{onCancel:function(){n&&(S.addWidgetResizeEvent(n),D.editProp.controller&&D.editProp.controller.skeleton&&"function"==typeof D.editProp.controller.skeleton.notifyClose&&D.editProp.controller.skeleton.notifyClose()),D.editProp=null}}}),D.editProp.show(A),S.removeWidgetResizeEvent(n)}else D.editProp.centerIt()});else{var O=function(u){var y=window.top.document.body.getElementsByClassName("preview-container")[0],_=!1;if(y){var E=y.getElement(".moduleContent");if(E)if(E.className.indexOf("EditPropWidget")>=0){_=!0,y.show();var k={};u&&(k.securityContext=u.SecurityContext),require(["DS/WidgetServices/commandProxy/CommandProxy"],function(e){e.publishUpdate(A,k)})}}if(!1===_){var L=null;A&&A.length>0&&(L=A[0]);var M=b.getServiceForModel(L),P=!(L&&!0===L.isTransient||!0===M.modelNeeded),O=[];A.forEach(function(e){O.push(e.toJSON())});k={SelectedItem:O,x3dPlatformId:w.getTenantFromModel(L),isTransient:"true",loadData:!0,asynchronousRequest:P,index_mode:S.getWidgetValue("index_mode"),parent_x3dAppId:C,securityContextFromAppPreference:f,disableAddExtensionButton:m,USE_APP_SECURTIYCONTEXT:!0,ignoreKernelAccessChecks:p};if(u&&u.SecurityContext&&(k.securityContext=u.SecurityContext),void 0!==N&&(k.readOnly=N),I&&(k.readOnly=!0),P){var U=A.length>1;if(U){var T=S.generateUniqueId();k.transactionId=T;var B=A[0],W=UWA.clone(B.getOptions());W.objectId=T;var z={};A.forEach(function(e){z[e.get("objectId")]=e});var F=new g(W);F.setMergingModels(z),A=[F]}require(["DS/EditPropWidget/comm/DistantAjax","DS/EditPropWidget/constants/ConstantsMapping","DS/EditPropWidget/utils/EditPropIndexUtils","DS/EditPropWidget/utils/EditPropIndexDictionaryForUnits","text!DS/EditPropWidget/assets/settings/SettingsForServices.json"],function(t,i,n,o,s){if(s=JSON.parse(s),c){if(A&&A.length>0&&A[0]&&A[0]instanceof v&&"function"==typeof A[0].isMergedModel&&!A[0].isMergedModel()){var a=A[0];if(a&&"businessobject"===a.get("metatype")&&a.get("type")){var l=a.get("type"),r={model:a,type:l};o.setUpDimensionsDictionary(),n.getListOfExtensions(r,function(e){var o=[],r={isBus:!0,name:l};o.push(r);for(var d=0;d<e.length;d++)o.push(e[d]);n.getMaskAttributes(o,function(n){var o=S.getCancelObject(),l=i.getServiceBySource("fedsearch"),r={};n.maskAttributeDetails&&(r.maskAttributeDetails=n.maskAttributeDetails),n.listOfPredicates&&(r.predicates=n.listOfPredicates),n.maskGroupInfo&&(r.maskGroupInfo=n.maskGroupInfo),n.groupAttributesInfoAsPerMask&&(r.groupAttributesInfoAsPerMask=n.groupAttributesInfoAsPerMask),n.dimensionAttributes&&(r.dimensionAttributes=n.dimensionAttributes),r.handleRequest={handle:o},r.service=l,r.listOfExtensions=e;let d=a.get("source"),c=d&&s[d.toUpperCase()],u=!1;c&&(u=c.plmParameterSupported),r.getPLMParameter=u,t.launchMainReadFromIndexService(a,r),S.isReplayedODT()&&window.top&&(window.top.EPIndex_ODTData={options:r})})})}}}else t.launchMainRead(A,k);t.getServices(k.x3dPlatformId),t.getRoles(k.x3dPlatformId);var d=i.getDefaultFacets(U,!0),u=[];d.forEach(function(e){if(e){var t=e;if(e.facet&&(t=e.facet.name),null!=h&&h.length>=1)for(let i=0;i<h.length;i++)t===h[i]&&u.push({name:t,inheritance:e.inheritance});else u.push({name:t,inheritance:e.inheritance})}});var m=null;A&&A.length>0&&(m=A[0]),c?t.launchFacetsVisibilityFromIndexService(m,u,{context:e}):t.launchFacetsVisibility(m,u,{context:e},!0,C)})}S.isChangeAvailable()?require(["DS/EditPropWidget/changeAction/passThruJS"],function(e){e.onReady(function(e){e.get2(function(u){"function"==typeof e.changeIsSetChecker&&(e.changeIsSetChecker(u)?k.changeControl=u:null!=u&&null!=u.configurationRevision&&(k.changeControl=u)),null!=t&&void 0!==t&&(k.readOnly=t),null!=i&&void 0!==i&&(k.appId=i),null!=n&&void 0!==n&&(k.multiselection=n),null!=o&&void 0!==o&&(k.setCloseButton=o),null!=s&&void 0!==s&&(k.setEditButton=s),null!=a&&void 0!==a&&(k.editMode=a),null!=l&&void 0!==l&&(k.extraNotif=l),null!=r&&void 0!==r&&(k.defaultFacetName=r),null!=d&&void 0!==d&&(k.infoForFacet=d),null!=c&&void 0!==c&&(k.indexModeParameter=c),D._launchTransientWidget(x,k)})})},function(){D._launchTransientWidget(x,k)}):D._launchTransientWidget(x,k)}};u.getValidSecurityContext({onSuccess:O,onFailure:function(){O(null)}})}}else D._setError(e,UWA.i18n("no content selected"));D.end()})},_setError:function(e,t){if("function"==typeof e.displayNotification){var i={eventID:"error",msg:t};e.displayNotification(i)}else alert(t)},endExecute:function(){}})}),define("DS/LifecycleControls/ProgressDialog",["UWA/Controls/Abstract","UWA/Core","DS/UIKIT/Mask","css!DS/LifecycleControls/LifecycleControls"],function(e,t,i){"use strict";return e.extend({showDelay:function(e,t,i){var n=this;this.timer=setTimeout(function(){n.timer=null,n._createProgress(e,t)},i)},close:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.progressContainer&&(this.progressContainer.remove(),this.progressContainer=null)},_createProgress:function(e,n){this.progressContainer=t.createElement("div",{class:"lcm-progress-container"});var o=t.createElement("span",{class:"progress-icon-container"});o.inject(this.progressContainer);var s=t.createElement("div",{class:"progress-icon"});s.inject(o);var a=t.createElement("span",{class:"progress-msg"});a.innerHTML=n,a.inject(this.progressContainer),this.progressContainer.inject(e),i.mask(s,"");var l=this.progressContainer;this.progressContainer.remove=function(){e.removeChild(l)}}})}),define("DS/LifecycleControls/CommandDialogWUX",["UWA/Controls/Abstract","UWA/Core","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/Windows/Dialog","i18n!DS/LifecycleControls/assets/nls/CommandDialog","css!DS/LifecycleControls/LifecycleControls"],function(e,t,i,n,o,s){"use strict";return e.extend({buttonStyle:{ok:1,okCancel:2,none:3,cancel:4},init:function(e){this._parent(e)},createDialog:function(e,t,n){var a=this;this._onOkHandler=t.onOk||function(){},this._onCloseHandler=t.onClose||function(){},this._fnContext=n||this,this._OKBtnText=t.OKBtnText||s.okButton,this.immersiveFrame=new i({}),this.immersiveFrame.inject(t.container);var l=t.buttonStyle||this.buttonStyle.okCancel;this.buttons=l===this.buttonStyle.none?void 0:this.createFooter(l);var r=new o({title:t.title||"Title",immersiveFrame:this.immersiveFrame,modalFlag:t.modalFlag,resizableFlag:t.resizableFlag,minWidth:t.minWidth,minHeight:t.minHeight,maximizeButtonFlag:t.maximizableFlag,maximizedFlag:t.maximizedFlag,closeButtonFlag:t.closeButtonFlag,identifier:t.identifier,content:e,buttons:this.buttons,position:{my:"center",at:"center",of:this.immersiveFrame}});return r.addEventListener("close",function(){a._onCancel()}),r.addEventListener("keydown",function(e){13===e.keyCode?a.disableBtnClickOnEnter=!0:27===e.keyCode&&a._onCancel()}),r.addEventListener("keyup",function(e){13===e.keyCode&&(a.disableBtnClickOnEnter=!1)}),this.dialog=r,this.closeButton=r.elements._closeButton,r},createFooter:function(e){var t=this,i={},n=[];switch(e){case this.buttonStyle.ok:n=["Ok"];break;case this.buttonStyle.cancel:n=["Cancel"];break;default:n=["Ok","Cancel"]}return n.forEach(function(e){i[e]=t.buildButton(e)}),i},buildButton:function(e){var t,i,o=this;switch(e){case"Ok":i={id:"execute",label:this._OKBtnText,onClick:function(){o.disableBtnClickOnEnter||o._onOk()}};break;case"Cancel":i={id:"cancel",label:s.cancelButton,onClick:function(){o._onCancel()}}}return i&&(t=new n(i)),t},_onOk:function(){this.disableUI(!0),this._onOkHandler.apply(this._fnContext)},_onCancel:function(){this.disableUI(!0),this._onCloseHandler.apply(this._fnContext)},disableUI:function(e){if(this.buttons)for(var t in this.buttons){this.buttons[t].disabled=e}},getButton:function(e){if(this.buttons)return this.buttons[e]||null},disableButton:function(e,t){if(this.buttons){var i=this.buttons[e];i&&(i.disabled=t)}},destroy:function(){this.dialog&&this.dialog.destroy(),this.immersiveFrame&&this.immersiveFrame.destroy(),this._parent()}})}),define("DS/LifecycleControls/DelayedMask",["UWA/Controls/Abstract","DS/UIKIT/Mask"],function(e,t){"use strict";return e.extend({timer:null,element:null,init:function(e,i,n){if(e){this.element=e;var o=this;this.timer=setTimeout(function(){o.timer=null,t.mask(o.element,n)},i)}},unmask:function(){this.element&&(this.timer&&(clearTimeout(this.timer),this.timer=null),t.unmask(this.element),this.element=null)}})}),define("DS/LifecycleControls/CredentialList",["UWA/Controls/Abstract","DS/LifecycleServices/WebReq"],function(e,t){"use strict";const i=e=>e.reduce(function(e,t){return e.concat(Array.isArray(t)?i(t):t)},[]),n=(e,i,n,a)=>new UWA.Class.Promise((l,r)=>{t.post("/resources/lifecycle/util/filterValidSCs",o(i,n,a),{tenant:e}).then(e=>{e.status&&"success"===e.status?l(s(e.data)):r(e.error?e.error:"/resources/lifecycle/util/filterValidSCs - failed!")}).catch(r)}),o=(e,t,i)=>{let n={Command:t,extraInfo:i||!1,SecurityContexts:e.map(e=>e.ctx)};return JSON.stringify(n)},s=e=>e.filter(e=>!(e=>{e.hasOwnProperty("secCtx")&&(e=e.secCtx);let t=e.match(/(ctx::)([^.]+)/);return t.length>2&&"VPLMAdmin"===t[2]})(e));return{loadCredentials:e=>new UWA.Class.Promise((n,o)=>{t.get("/resources/modeler/pno/person",{tenant:e,params:{current:"true",select:"collabspaces&select=preferredcredentials"}}).then(e=>n((e=>{let t=[];if(!UWA.is(e.collabspaces,"array"))return t;let n=[...new Set(i(e.collabspaces.map(e=>e.couples.map(e=>e.organization.name))))].length>1;return e.collabspaces.forEach(e=>{e.couples.forEach(i=>{var o=null==i.role.nls||""==i.role.nls?i.role.name:i.role.nls,s=i.role.name,a=i.organization.name,l=i.organization.title,r=e.name,d=e.title?e.title:e.name;let c=n?d+" ● "+l+" ● "+o:d+" ● "+o,u="ctx::"+s+"."+a+"."+r;t.push({displayName:c,ctx:u})})}),t.sort((e,t)=>e.displayName.localeCompare(t.displayName,void 0,{numeric:!0,sensitivity:"base"}))})(e)))}),filterCredentials:(e,t,i)=>n(e,t,i,!1),filterCredentialsEx:(e,t,i)=>n(e,t,i,!0)}}),define("DS/LifecycleControls/Assembly3DViewer",["UWA/Controls/Abstract","DS/LifecycleServices/LifecycleServicesSettings","UWA/Utils/InterCom","DS/CoreEvents/Events"],function(e,t,i,n){"use strict";return e.extend({init:function(e,t){var i=this;this._parent({}),this.isViewerReady=!1,this.lang=t,this.tenant=e,this.bufferedModels=null,this.bufferedActiveModel=null,this.pad3dViewerLoaded=!1,window.onPAD3DViewerLoaded=this.onPAD3DViewerLoaded;var o=Date.now().toString();this.id="assembly3dviewer_"+o,this.cmdQueue=[],this.listenFrameEvents(),this.buildUI(),this.onReadyCallback=null,this.onLoadCallback=null,this.onLoadFailCallback=null,n.subscribe({event:"ENOLifecycleSnapshotsHighlightOccurrencesInViewer"},function(e){i.postCommand("highlight",e)})},load:function(e){this.postCommand("load",e)},clear:function(){this.postCommand("clear")},destroy:function(){this.postCommand("destroy")},postCommand:function(e,t){var i={cmd:e,params:t};0==this.isViewerReady?this.cmdQueue.push(i):this.iframe.contentWindow.postMessage(i,"*")},buildUI:function(){this.iframe=UWA.createElement("iframe"),this.iframe.src=t.get3DSpaceWSUrl(this.tenant,"/webapps/LifecycleControls/Assembly3DViewerImpl.html","id="+this.id+"&lang="+widget.lang),this.iframe.className="CGRViewerWidget",this.iframe.width="100%",this.iframe.height="100%",this.iframe.style.border="0px",this.elements.container=this.iframe,this.htmlUnloaded=!0},onPAD3DViewerLoaded:function(){this.pad3dViewerLoaded=!0,this.loadBufferedModels(),this.showBufferedModel()},listenFrameEvents:function(){var e=this;window.addEventListener("message",function(t){var i=t.data,n=i.eventName,o=i.params;e.onEvent(n,o)},!1)},onEvent:function(e,t){switch(e){case"onSelect":this.onSelect(t);break;case"onReady":this.onReady();break;case"onHtmlLoad":this.onHtmlLoad();break;case"onHtmlUnload":this.onHtmlUnload();break;case"onLoad":null!=this.onLoadCallback&&this.onLoadCallback();break;case"onLoadFail":null!=this.onLoadFailCallback&&this.onLoadFailCallback()}},onHtmlLoad:function(){},onHtmlUnload:function(){this.htmlUnloaded=!0},onReady:function(){this.isViewerReady=!0;for(var e=this.cmdQueue.length,t=0;t<e;t++){var i=this.cmdQueue[t];this.iframe.contentWindow.postMessage(i,"*")}this.cmdQueue=[],null!=this.onReadyCallback&&this.onReadyCallback()},onSelect:function(e){console.log("Selected occurenceID List: "+e.toString()),n.publish({event:"ENOLifecycleSnapshotsSelectOccurrencesInTree",data:e})},loadBufferedModels:function(){1==this.pad3dViewerLoaded&&null!=this.iframe.contentWindow&&this.iframe.contentWindow.loadModels(this.bufferedModels)},showBufferedModel:function(){1==this.pad3dViewerLoaded&&null!=this.iframe.contentWindow&&this.iframe.contentWindow.showModel(this.bufferedActiveModel)}})}),define("DS/LifecycleControls/ChooseAttributes",["UWA/Class","UWA/Core","DS/UIKIT/SuperModal","i18n!DS/UIKIT/assets/nls/UIKIT","i18n!DS/LifecycleControls/assets/nls/CommandDialog","css!DS/LifecycleControls/assets/styles/LifecycleModals"],function(e,t,i,n,o,s){"use strict";return e.singleton({init:function(){this._parent({})},showDialog:function(e){var t=this,s=e.parent,a=e.title,l=e.allAttributes,r=e.onOk,d=e.onShow,c=new i({closable:!0,className:"Lifecycle_Modals",events:{onShow:function(){null!=d&&d(t)}},renderTo:s}),u=o.okButton,h=o.cancelButton,m=this.buildDialogBody(l);if(c.dialog({body:m,title:a,buttons:[{className:"primary",value:u,action:function(e){e.hide();var i=t.getSelectedAttributes();r(i)}},{value:h,action:function(e){e.hide()}}]}),c&&c.modals&&c.modals.current&&c.modals.current.elements){var f=c.modals.current.elements.header?c.modals.current.elements.header.getElement(".close.fonticon.fonticon-cancel"):null;f&&(f.setText("×"),f.removeClassName("fonticon"),f.removeClassName("fonticon-cancel"),f.setAttributes({title:n.close})),c.modals.current.elements.closeTooltip&&c.modals.current.elements.closeTooltip.elements&&c.modals.current.elements.closeTooltip.elements.container.addClassName("hideDefaultTooltip")}},getSelectedAttributes:function(){for(var e=[],t=this.checkboxes.length,i=0;i<t;i++){var n=this.checkboxes[i];n.checked&&e.push(n.id)}return e},buildDialogBody:function(e){var i=t.createElement("div",{styles:{position:"relative",height:"100%",overflow:"auto"}}),n=e.length;this.checkboxes=[];for(var o=0;o<n;o++){(s=e[o]).isSelected&&this.addItem(i,s)}for(o=0;o<n;o++){var s;(s=e[o]).isSelected||this.addItem(i,s)}return i},addItem:function(e,i){var n=t.createElement("div",{styles:{width:"100%",overflow:"hidden"}}),o=t.createElement("input");this.checkboxes.push(o),o.type="checkbox";var s=i.name,a=i.displayName,l=i.isSelected;o.id=s,o.checked=l;var r=t.createElement("label",{styles:{"font-weight":"inherit","margin-left":"4px","margin-bottom":"5px",display:"inline-block"}});!0===i.disabled&&(o.disabled=!0),r.htmlFor=s,r.innerHTML=a,o.inject(n),r.inject(n),n.inject(e)}})}),define("DS/LifecycleControls/ResizeMonitor",["UWA/Controls/Abstract","DS/LifecycleServices/EventHandler"],function(e,t){"use strict";var i=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return window.setTimeout(e,20)};return e.extend({addMonitor:function(e,n){if(e.resizeMonEvents=e.resizeMonEvents||[],!e.resizeMon){e.resizeMon={el:document.createElement("div"),cb:[]},e.resizeMon.cb.push(n);var o="position: absolute; left: 0; top: 0; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",s="position: absolute; left: 0; top: 0; transition: 0s;";e.resizeMon.el.style.cssText=o,e.resizeMon.el.innerHTML='<div style="'+o+'"><div style="'+s+'"></div></div><div style="'+o+'"><div style="'+s+' width: 200%; height: 200%"></div></div>',e.appendChild(e.resizeMon.el),e.resizeMon.el.offsetParent!==e&&(e.style.position="relative");var a,l,r=e.resizeMon.el.childNodes[0],d=e.resizeMon.el.childNodes[1],c=0,u=function(){r.childNodes[0].style.width="100000px",r.childNodes[0].style.height="100000px",r.scrollLeft=1e5,r.scrollTop=1e5,d.scrollLeft=1e5,d.scrollTop=1e5},h=function(){null!=e.resizeMon&&(a=e.offsetWidth,l=e.offsetHeight,c=0,u(),e.resizeMon.cb.forEach(function(e){e.call()}))},m=function(){a==e.offsetWidth&&l==e.offsetHeight||0===c&&(c=i(h))};return u(),e.resizeMonEvents.push(t(r,"scroll",m)),e.resizeMonEvents.push(t(d,"scroll",m)),{detach:function(){if(e.resizeMonEvents.forEach(function(e){e.unbind()}),e.resizeMonEvents=null,e.resizeMon){try{e.removeChild(e.resizeMon.el)}catch(e){}e.resizeMon=null}}}}e.resizeMon.cb.push(n)}})}),define("DS/LifecycleControls/RelatedObjectsControl",["UWA/Controls/Abstract","DS/PlatformAPI/PlatformAPI","DS/LifecycleServices/EventHandler","css!DS/LifecycleControls/assets/styles/RelatedObjectsControl"],function(e,t,i){"use strict";return e.extend({platformAPISubscriptions:[],init:function(e){this._parent(e)},expandCategoryExpanders:function(){[...this.elements.container.querySelectorAll(".accordion-item > .accordion-title")].forEach(e=>{e.click()})},load:function(){var e=this;return new UWA.Promise((n,o)=>{require(["DS/ENORIPE_Relations/RelationsTabSettings"],o=>{e.elements={container:UWA.createElement("div",{class:"lcm-relatedobjects-control-container"})},n();o.setProfile("PowerByCATIAV5_Relations"),this.platformAPISubscriptions.push(t.subscribe("ENORIPE_Relations_ViewReady",function(t){e.dispatchEvent("viewReady",{uniqueIds:t}),e.expandCategoryExpanders(),e.uniqueIds=t})),this.platformAPISubscriptions.push(t.subscribe("DS/PADUtils/PADCommandProxy/select",e=>{if(widget&&e&&e.metadata&&widget.id===e.metadata.originWidgetId){let t=e.data.attrData.map(e=>({id:e.id,type:e.type}));this.dispatchEvent("selectionChange",{selection:t})}}));o.isAvailable({getPlatformID:function(){return"OnPremise"},getServiceID:function(){return"3DSpace"}},{isDraggable:!0,isProfilesVisible:!1,appID:"ENORIPE_ECM",isExternal:!0,noContextualMenu:!0}).then(function(){require(["DS/ENORIPE_Relations/views/RelationsTab"],function(t){let n=new t({defaultProfile:"PowerByCATIAV5_Relations"});n.updateFacetExternal(e.options.model).then(()=>{e.selectAll=(()=>{n.selectNodes(e.uniqueIds)}),e.keydownHandler=new i(document,"keydown",t=>{65===t.keyCode&&t.ctrlKey&&(e.selectAll(),t.preventDefault())})}).catch(e=>{}),n.elements.container.inject(e.elements.container)})}).catch(e=>{console.error("Caught RelationsTab error:",e)})},e=>{o({AMDError:e})})})},destroy:function(){this.platformAPISubscriptions.forEach(e=>{t.unsubscribe(e)}),this.keydownHandler&&this.keydownHandler.unbind(),e.prototype.destroy.call(this)},selectAll:function(){},isAvailable:function(){return new UWA.Promise((e,t)=>{e(!0)})}})}),define("DS/LifecycleControls/WidgetMaximizeHandler",["UWA/Class","UWA/Controls/Abstract"],function(e,t){"use strict";return t.extend({init:function(){if(window&&window.parent&&window.parent.document&&window.frameElement&&window.frameElement.id){var e=window.frameElement.id.replace("frame","wi");this.widget=window.parent.document.querySelector("."+e),this.widget&&(this.btnContainer=this.widget.querySelector(".moduleHeader"),this.extrabtnContainer=window.parent.document.querySelector(".topbar-extrabtn"))}this._observeButtons(),this.isMaximized=this._isWidgetMaximized(),this._updateHandlers()},maximize:function(){this._maximize();var e=this;return new UWA.Class.Promise(function(t,i){e._wait(function(){t(null)})})},restore:function(){this._restore();var e=this;return new UWA.Class.Promise(function(t,i){e._wait(function(){t(null)})})},destroy:function(){this.maximizedObserver&&(this.maximizedObserver.disconnect(),this.maximizedObserver=null)},_observeButtons:function(){if(this.btnContainer){var e=this;this.maximizedObserver=new MutationObserver(function(t){e._isWidgetMaximized()!==e.isMaximized&&(e._updateHandlers(),e.dispatchEvent("widget-maxmized-changed",e.isMaximized))}),this.maximizedObserver.observe(this.btnContainer,{attributes:!0,subtree:!0})}},_isWidgetMaximized:function(){return!!this.btnContainer&&(this.widget&&this.widget.hasClassName("ifwe-maximized")||this.btnContainer.isHidden())},_updateHandlers:function(){if(this._maximize=function(){},this._restore=function(){},this._wait=function(e){e()},this.btnContainer&&this.extrabtnContainer){var e=this._isWidgetMaximized(),t=this,i=function(e,n){if(e.gotEl||(t.btnContainer.querySelector(e.cls)||t.extrabtnContainer.querySelector(e.cls))&&(e.gotEl=!0),e.gotNewW){if(1===e.gotNewW){var o;(o=t.widget.getBoundingClientRect().width)===e.oldW?e.gotNewW=2:e.oldW=o}}else(o=t.widget.getBoundingClientRect().width)!=e.oldW&&(e.gotNewW=1,e.oldW=o);e.gotEl&&e.gotNewW&&2===e.gotNewW?(t._updateHandlers(),n()):++e.cnt<30?setTimeout(i,100,e,n):n()},n=this.widget.getBoundingClientRect().width;e?e&&(t.isMaximized=!0,this._restore=function(){var e=t.extrabtnContainer.querySelector(".fonticon-resize-fullscreen-off");e&&(e.click(),t.isMaximized=!1)},this._wait=i.bind(null,{oldW:n,cnt:0,cls:".fonticon-resize-fullscreen"})):(t.isMaximized=!1,this._maximize=function(){var e=t.btnContainer.querySelector(".fonticon-resize-fullscreen");e&&(e.click(),t.isMaximized=!0)},this._wait=i.bind(null,{oldW:n,cnt:0,cls:".fonticon-resize-fullscreen-off"}))}}})}),define("DS/LifecycleControls/NumberModal",["UWA/Controls/Abstract","DS/UIKIT/Modal","DS/Controls/Button","DS/Controls/SpinBox","css!DS/UIKIT/UIKIT","css!DS/LifecycleControls/assets/styles/NumberModal"],function(e,t,i,n){"use strict";return e.extend({name:"numberModal",number:1,init:function(e){this._parent(e);var o=this,s=e.parentContainer||document.body,a=UWA.createElement("div",{class:this.getClassNames()}),l=new n({value:o.number,minValue:1,stepValue:1,pageStepValue:1}).inject(a);l.getContent().addClassName(this.getClassNames("_spinbox")),l.addEventListener("change",function(e){o.number=parseInt(e.dsModel.value)});var r=new i({icon:"check",emphasize:"success"}).inject(a);r.getContent().addClassName(this.getClassNames("_ok")),r.addEventListener("click",function(){o.dispatchEvent("onApply",o.number),d.destroy()}),l.elements.inputField&&l.elements.inputField.addEventListener("keyup",function(e){13===e.keyCode&&(o.dispatchEvent("onApply",o.number),d.destroy())});var d=new t({className:this.getClassNames("_modal"),closable:!1,body:a,visible:!0});d.elements.container.addEventListener("click",function(e){d.destroy()}),d.elements.content.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),!1}),d.inject(s);var c=e.windowPos.y-90+"px";try{var u=parseInt(window.getComputedStyle(d.elements.wrapper).paddingTop),h=d.elements.wrapper.getBoundingClientRect();c=e.windowPos.y-(h.y+u)+"px"}catch(e){}d.elements.wrapper.setStyle("margin-left",e.windowPos.x+"px"),d.elements.wrapper.setStyle("margin-top",c),l.elements.inputField&&l.elements.inputField.focus()}})}),define("DS/LifecycleControls/LifecycleControls",[],function(){return{}}),define("DS/LifecycleControls/DataGridViewContainer",["UWA/Core","UWA/Controls/Abstract","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/DataGridView/DataGridView","DS/Windows/ImmersiveFrame","DS/Controls/Expander","DS/PlatformAPI/PlatformAPI","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls","i18n!DS/LifecycleServices/assets/nls/LifecycleServicesNls","DS/ApplicationFrame/CommandsManager","DS/Controls/Button","DS/PADServices/utils/MaturityUtils","css!DS/LifecycleControls/assets/styles/DataGridViewContainer"],function(e,t,i,n,o,s,a,l,r,d,c,u,h,m){"use strict";var f=null;function p(){return null==f&&(f=r.getUser()),f}return t.extend({model:null,selection:null,dataGridView:null,defaultOptions:{idName:"dgvContainer",clickToShowDGV:!1,showNewRevision:!1,showLock:!1,showRowSelect:!1,showPreStatus:!1},init:function(e,t){this._parent(e),this.selection=t,this.buildSkeleton(t)},nodeUpdate:function(e){var t=e.data.nodeModel;if(t){var i=e.data.attributes;i["new revision"]&&this.selection[t._rowID]&&(this.selection[t._rowID].proposedRevision=i["new revision"])}},modelUpdate:function(e){var t=this,i=this.model,o=this.options;i.empty();var s=[];e.forEach(function(e){if(!e.hasOwnProperty("visible")||0!=e.visible){var t={},i=e["attribute[PLMEntity.V_Name]"]?e["attribute[PLMEntity.V_Name]"]:e.name,n=e.type;e.typeDisplayName?n=e.typeDisplayName:e.displayType&&(n=e.displayType);var a=e.currentFullName?e.currentFullName:e.current,l=e.current_internal?e.current_internal:void 0,r=e.policy?e.policy:void 0,d=e.proposedRevision,c=!1;o.showNewRevision&&(e.hasOwnProperty("modifiedAttributes")&&e.modifiedAttributes.hasOwnProperty("revision")&&(d=e.modifiedAttributes.revision),e.hasOwnProperty("customRevisionAllowed")&&(c=e.customRevisionAllowed));var u=null,h=null;o.showLock&&(e.hasOwnProperty("locked")&&(u=e.locked),e.hasOwnProperty("lockedBy")&&(h=e.lockedBy));var m=void 0;o.showPreStatus&&e.hasOwnProperty("preCheckStatus")&&(m=e.preCheckStatus),t.id=e.physicalid,t.title=i,t.type=n,t.revision=e.revision,t.maturity=a,t.maturity_internal=l,t.imageUrl=e.imageUrl,t["new revision"]=d,t.editableRevision=c,t.locked=u,t.lockedBy=h,t.attrExclude=!1,t.policy=r,t.preCheckStatus=m,s.push(t)}}),i.prepareUpdate(),s.forEach(function(e){var t=[];t.push(e.imageUrl);var o=e["attribute[PLMEntity.V_Name]"]?e["attribute[PLMEntity.V_Name]"]:e.title,s=new n({label:o,grid:e,icons:t});i.addRoot(s)}),i.pushUpdate(),i.onNodeModelUpdate(function(e){t.nodeUpdate(e)})},buildSkeleton:function(e){var t=this,o=this.options,r=new i,u={actionExclude:{stdTemplate:"functionIcon",semantics:{icon:{iconName:"block",fontIconFamily:WUXManagedFontIcons.Font3DS}}}},h=[];e.forEach(function(e){if(!e.hasOwnProperty("visible")||0!=e.visible){var t={},i=e["attribute[PLMEntity.V_Name]"]?e["attribute[PLMEntity.V_Name]"]:e.name,n=e.type;e.typeDisplayName?n=e.typeDisplayName:e.displayType&&(n=e.displayType);var s=e.currentFullName?e.currentFullName:e.current,a=e.current_internal?e.current_internal:void 0,l=e.policy?e.policy:void 0,r=e.proposedRevision,d=!1;o.showNewRevision&&(e.hasOwnProperty("modifiedAttributes")&&e.modifiedAttributes.hasOwnProperty("revision")&&(r=e.modifiedAttributes.revision),e.hasOwnProperty("customRevisionAllowed")&&(d=e.customRevisionAllowed));var c=null,u=null;o.showLock&&(e.hasOwnProperty("locked")&&(c=e.locked),e.hasOwnProperty("lockedBy")&&(u=e.lockedBy));var m=void 0;o.showPreStatus&&e.hasOwnProperty("preCheckStatus")&&(m=e.preCheckStatus),t.id=e.physicalid,t.title=i,t.type=n,t.revision=e.revision,t.maturity=s,t.maturity_internal=a,t.imageUrl=e.imageUrl,t["new revision"]=r,t.editableRevision=d,t.locked=c,t.lockedBy=u,t.attrExclude=!1,t.policy=l,t.preCheckStatus=m,h.push(t)}}),r.prepareUpdate(),h.forEach(function(e){var t=[];t.push(e.imageUrl);var i=new n({label:e.title,grid:e,icons:t});r.addRoot(i)}),r.pushUpdate();t=this;r.onNodeModelUpdate(function(e){t.nodeUpdate(e)});var f=[{icon:{iconName:"block",fontIconFamily:1},dataIndex:"attrExclude",alignmentValue:"center",description:d.exclude,visibleFlag:o.showRowSelect,width:30,sortableFlag:!0,resizableFlag:!1,editableFlag:!1,getCellTypeRepresentation:function(e){return"actionExclude"},getCellSemantics:function(e){var t=void 0;e.nodeModel&&(e.nodeModel.getReferenceValue("attrExclude")&&(t="wux-ui-3ds wux-ui-3ds-block lc_dgv_exclude"));return{icon:{iconClasses:t}}}},{text:d.title,dataIndex:"tree",className:"title"},{text:d.type,dataIndex:"type",width:100,className:"type"},{text:d.revision,dataIndex:"revision",width:70,className:"revision"},{text:c.proposedRevision,dataIndex:"new revision",width:90,getCellEditableState:function(e){return e.nodeModel.options.grid.editableRevision},editionPolicy:"EditionInPlace",visibleFlag:o.showNewRevision,className:"newrevision"},{text:c.maturitystate,dataIndex:"maturity",width:95,typeRepresentation:"tag",className:"lc-maturity-state",getCellClassName:function(e){if(e.nodeModel){var t,i=e.nodeModel.getReferenceValue("maturity_internal");if(i||(i=e.nodeModel.getReferenceValue("maturity")),i){if(!1===i.contains(".")){let t=e.nodeModel.getReferenceValue("policy");t&&(i=t+"."+i)}t=m.getAndCreateMaturityClass(i,"wux-controls-label")}return t}}},{text:c.Lock,visibleFlag:o.showLock,editableFlag:!1,dataIndex:"locked",width:60,typeRepresentation:"url",alignment:"center",getCellValue:function(e){var t,i,n=void 0;if(e.nodeModel){var o=e.nodeModel._options.grid.locked;if(void 0===o)n="";else if(!0===o){var s=(t=p(),i="",void 0!==t&&(i=t.login),i),a=function(){var e=p(),t="";return void 0!==e&&(t=e.firstName+" "+e.lastName),t}(),l=!0,r=e.nodeModel._options.grid.lockedBy;r.trim().length>0&&((l=r.toUpperCase().trim()===s.toUpperCase().trim()||!1)||(l=r.toUpperCase().trim()===a.toUpperCase().trim()||!1)),n=l?"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-key lc_dgv_lock":"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-lock lc_dgv_lock_other"}else!1===o&&(n="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-lock-open lc_dgv_unlock")}return{icon:{iconClasses:n}}}},{text:d.precheck,visibleFlag:o.showPreStatus,editableFlag:!1,dataIndex:"preCheckStatus",width:95,typeRepresentation:"url",alignment:"center",getCellValue:function(e){var t=void 0;if(e.nodeModel){var i=e.nodeModel._options.grid.preCheckStatus;"waiting"===i?t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-hourglass":!0===i?t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check lc_dgv_lock":!1===i&&(t="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-error lc_dgv_lock_other")}return{icon:{iconClasses:t}}}}];this.dataGridView=new s({treeDocument:r,columns:f}),this.dataGridView.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(u)),this.dataGridView.addEventListener("click",function(e,i){if(i&&i.nodeModel&&i.nodeModel.options.grid)switch(t.dataGridView.layout.getDataIndexFromColumnIndex(i.columnID)){case"attrExclude":if(i.nodeModel){var n=!0;i.nodeModel.getReferenceValue("attrExclude")&&(n=!1),i.nodeModel.updateOptions({grid:{attrExclude:n}})}}}.bind(t)),this.dataGridView.layout.rowsHeader=!1,this.dataGridView.rowSelection="none",this.dataGridView.cellSelection="none";var g=new a;g.setContentInBackgroundLayer(this.dataGridView.getContent()),g.reactToPointerEventsFlag=!1;var v=UWA.createElement("div",{id:o.idName});if(!0===o.clickToShowDGV){v.addClassName("hasExpander");var C=e.length?56+24*e.length:80;e.length>8&&(C=200);var y=!1;let t=void 0===o.expanderText?"Objects selected":o.expanderText;var b=new l({header:t,body:g});b.elements.header.addEvent("click",function(){y?(document.getElementsByClassName("command_dialog")[0].style.height="auto",document.getElementsByClassName("modal-body")[0].style.height="auto",v.removeClassName("open"),y=!1):(document.getElementsByClassName("command_dialog")[0].style.height=240+C+"px",document.getElementsByClassName("modal-body")[0].style.height=128+C+"px",v.addClassName("open"),y=!0)}),b.inject(v)}else g.inject(v);this.elements.container=v,this.model=r}})}),define("DS/LifecycleControls/InputValidation",["UWA/Controls/Abstract","DS/UIKIT/Tooltip","DS/LifecycleServices/EventHandler"],function(e,t,i){"use strict";var n={unknown:0,text:1,number:2,email:3,custom:4,submit:5};function o(){if(!(this instanceof o))return new o}function s(){if(!(this instanceof s))return new s}function a(e){if(!(this instanceof a))return new a;this.min=e}function l(e){if(!(this instanceof l))return new l;this.max=e}function r(){if(!(this instanceof r))return new r}o.prototype={validate:function(e){return"string"==typeof e&&e.length>0},getErrorInfo:function(e){return"Text cannot be empty"}},s.prototype={validate:function(e){return("string"!=typeof e||0!==e.length)&&!isNaN(e)},getErrorInfo:function(e){return"Must be a number"}},a.prototype={validate:function(e){return"string"==typeof e&&e.length>=this.min},getErrorInfo:function(e){return"Must be min "+this.min+" chars"}},l.prototype={validate:function(e){return"string"==typeof e&&e.length<=this.max},getErrorInfo:function(e){return"Must be max "+this.max+" chars"}},r.prototype={validate:function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},getErrorInfo:function(e){return"Must be a valid e-mail"}};var d=e.extend({init:function(e,t,i,n){this.isDebug=!1,this.element=e,this.type=t,this.customCSS=i,this.isOptional=!1,this.isValid=!0,this.customId=-1,this.validators=[],n&&(this.validators=this.validators.concat(n))},setGroupId:function(e){this.groupId=e},setOptional:function(e){this.isOptional=e},addValidators:function(e){var t;this.validators=this.validators.concat(e),((t=this.type)===n.text||t===n.number||t===n.email||t===n.custom)&&this.validate()},validate:function(e){var t=this.isValid,i=!1;if(null!=e||null!=this.element){var n="",o=null!=e?e:this.element.value;return this.validators.some(function(e){if(e){var t=e.validate(o);return t||(n=e.getErrorInfo(o)),!t}})?this.isValid=this.checkOptional(o):this.isValid=!0,t===this.isValid&&n===this.errorText||(this.errorText=n,this.updateUI(),i=!0),i}console.info("No element connected, skipping validation")},checkOptional:function(e){return!!this.isOptional&&(!e||"string"==typeof e&&0===e.length)},updateUI:function(){var e;this.element&&(this.isValid?(this.element.classList.remove("inputvalidation-validation-invalid"),this.customCSS&&this.customCSS.inputCSS&&this.element.classList.remove(this.customCSS.inputCSS),(e=this.getInfoElement(this.element,!0))&&(e.style.display="none")):(this.element.classList.add("inputvalidation-validation-invalid"),this.customCSS&&this.customCSS.inputCSS&&this.element.classList.add(this.customCSS.inputCSS),(e=this.getInfoElement(this.element,!0))&&(e.style.display="inline",this.tooltip.elements.body.innerHTML=this.errorText)))},removeValidationElementsFromHost:function(e){if(e){e.classList.remove("inputvalidation-validation-invalid"),this.customCSS&&this.customCSS.inputCSS&&e.classList.remove(this.customCSS.inputCSS);var t=this.getInfoElement(e,!1);t&&e.parentNode.removeChild(t),this.isDebug&&(e.classList.add("debug-inputvalidation-detached"),e.classList.remove("debug-inputvalidation-attached"),e.classList.remove("debug-inputvalidation-create"))}},getInfoElement:function(e,i){if(!e.parentNode)return null;var n=e.parentNode.querySelector(".inputvalidation-info-icon");return!n&&i&&((n=document.createElement("b")).classList.add("inputvalidation-info-icon"),this.customCSS&&this.customCSS.infoIconCSS&&n.classList.add(this.customCSS.infoIconCSS),this.tooltip=new t({target:UWA.extendElement(n),body:"no error yet",position:"bottom"}),this.tooltip.elements.container.classList.add("inputvalidation-tooltip"),this.customCSS&&this.customCSS.tooltipCSS&&this.tooltip.elements.container.classList.add(this.customCSS.tooltipCSS),e.parentNode.appendChild(n)),n}});return e.extend({init:function(e,t){this.validateEl=[],this.customValidators=t;var i,n,o=[];e&&(i=e,n="[data-validation]",o=Array.prototype.slice.apply(i.querySelectorAll(n))),o.forEach(function(e){var t=this._getValidators(e),i=e.getAttribute("data-validation-group"),n="string"==typeof e.getAttribute("data-validation-optional");this.addValidateElement(e,t.validators,n,i,t.type)},this),this._updateSubmit()},setCustomCSS:function(e){this.customCSS=e},_getValidators:function(e){var t,i=[],d=e.getAttribute("data-validation").split("."),c="text"===(t=d[0])?n.text:"number"===t?n.number:"email"===t?n.email:"custom"===t?n.custom:"submit"===t?n.submit:n.unknown;if(c!==n.unknown){c===n.text?i.push(new o):c===n.number?i.push(new s):c===n.email&&i.push(new r);var u=+e.getAttribute("data-validation-minLength");isNaN(u)||0===u||i.push(new a(u));var h=+e.getAttribute("data-validation-maxLength");isNaN(h)||0===h||i.push(new l(h)),m&&i.push(m);var m=null;return c===n.custom&&(m=this._getCustomValidator(this.customValidators,d[1])),m&&i.push(m),{type:c,validators:i}}},updateValidation:function(){this._updateSubmit()},addValidateElementNoUI:function(e){return this.addValidateElement(null,e,!1)},addValidateElement:function(e,t,o,s,a){var l=new d(e,a||n.custom,this.customCSS);l.setGroupId(s),l.setOptional(o||!1),l.addValidators(t),this.validateEl.push(l),e&&(l.inputHandler=new i(e,"input",this._onInputChanged.bind(this,l))),this.isDebug&&(e.classList.remove("debug-inputvalidation-attached"),e.classList.remove("debug-inputvalidation-detached"),e.classList.add("debug-inputvalidation-create"));var r=this;return{getValidator:function(){return l},setCustomId:function(e){l.customId=e,l.element&&l.element.setAttribute("data-custom-id",e)},getElementCustomId:function(){return l.element?l.element.getAttribute("data-custom-id"):-1},removeElementCustomId:function(){l.element&&l.element.removeAttribute("data-custom-id")},attachElement:function(e){this.detach(e),l.element=e,l.inputHandler=new i(e,"input",r._onInputChanged.bind(r,l)),this.setCustomId(l.customId),l.isValid||l.updateUI(),this.isDebug&&(e.classList.add("debug-inputvalidation-attached"),e.classList.remove("debug-inputvalidation-detached"),e.classList.remove("debug-inputvalidation-create"))},detach:function(e){if(l.element){if(-1!==l.customId&&l.element){var t=this.getElementCustomId();if(l.customId!=t)return console.error("ID mismatch","data-id: "+t+" validator id: "+l.customId),l.removeValidationElementsFromHost(e),this.removeInputHandler(),void(l.element=null)}l.removeValidationElementsFromHost(l.element),this.removeInputHandler(),this.removeElementCustomId(),l.element=null}},removeInputHandler:function(){l.inputHandler&&(l.inputHandler.unbind(),l.inputHandler=null)},updateInputValidation:function(e){return!!l.validate(e)&&(r._updateSubmit(),!0)}}},addSubmitElement:function(e,t){return this.addValidateElement(e,null,!1,t,n.submit)},isInputInvalid:function(e){return this.validateEl.filter(function(e){return e.type!==n.submit}).some(function(t){return!1===t.isValid&&t.groupId===e})},isInputValid:function(e){return!this.isInputInvalid(e)},_getCustomValidator:function(e,t){var i=null;if(e)for(var n=0;n<e.length;++n)if(e[n].name===t){i=e[n];break}return i},_updateSubmit:function(){this.validateEl.filter(function(e){return e.type===n.submit}).forEach(function(e){this.isInputInvalid(e.groupId)?(e.element.disabled=!0,e.element.classList.add("inputvalidation-submit-invalid")):(e.element.disabled=!1,e.element.classList.remove("inputvalidation-submit-invalid"))},this)},_onInputChanged:function(e){e.validate()&&this._updateSubmit()}})}),define("DS/LifecycleControls/Assembly3DViewerImpl",["UWA/Controls/Abstract","UWA/Utils/InterCom","DS/LifecycleServices/AssemblyJson","DS/Selection/CSOManager","DS/Selection/HSOManager"],function(e,t,i,n,o){"use strict";return e.extend({init:function(e,t){this.widget=e,this._parent({}),this.buildUI(),this.listenCommands(),this.postEvent("onHtmlLoad"),this.options=t},buildUI:function(){this.elements.container=new UWA.Element("div",{styles:{position:"absolute",height:"100%",width:"100%"}}),this.build3DViewer(this.elements.container)},build3DViewer:function(e){var t=this;require({baseUrl:"../"},["DS/ENOPAD3DViewer/PAD3DViewer"],function(i){t.viewer3d=new i({widget:t.widget,css_view_class:"windowed",activateProbes:!1,authorizeSet3DStructure:!1,propertiesCommandAvailability:!1,windowOptions:{BIMode:"SLAVE"}}),t.viewer3d.subscribe({event:"onActionBarReady"},function(){var i=t.viewer3d.elements.container.getElementsByClassName("paddnd_invite_container");null!=i&&(0!=i.length&&i[0].setStyle("z-index","-1"));null!=(i=t.viewer3d.elements.container.getElementsByClassName("wux-afr-view-tabbar-parent"))&&(0!=i.length&&i[0].setStyle("display","none"));t.on3DViewerActionBarReady(e)}),t.viewer3d.subscribe({event:"onLoadingComplete"},function(){t.postEvent("onLoad")}),t.viewer3d.subscribe({event:"onLoadingFailure"},function(){t.postEvent("onLoadFail")}),n.onUpdate(function(e){var i=n.get(),o=[];i.forEach(function(e){var i=t.viewer3d._controller.buildArrayFromPath(e.pathElement),n=JSON.stringify(i);null!=t.mapPathToOccurrence[n]&&o.push(t.mapPathToOccurrence[n])}),t.postEvent("onSelect",o)})})},on3DViewerActionBarReady:function(e){this.viewer3d.render().inject(e),this.viewer3d.getLevelSelectorCommand&&this.viewer3d.getLevelSelectorCommand(function(e){e&&e.displayLabels(!1)}),this.postEvent("onReady"),null!=this.options&&null!=this.options.onActionBarReady&&this.options.onActionBarReady()},postEvent:function(e,t){var i={eventName:e,params:t};window.parent.postMessage(i,"*")},listenCommands:function(){var e=this;window.addEventListener("message",function(t){var i=t.data,n=i.cmd,o=i.params;e.onCmd(n,o)},!1)},onCmd:function(e,t){switch(e){case"load":this.load(t);break;case"clear":this.clear();break;case"destroy":this.destroy();break;case"highlight":this.highlightSelectedObjects(t)}},load:function(e){var t=i.getRootPhysicalId(e);if(t!=this.lastSnapshotAssemblyRootId){this.clear();for(var n=(e=JSON.parse(JSON.stringify(e))).nodes.length,o=0;o<n;o++){var s=e.nodes[o],a=s.cgrurl;if(null!=a&&""!=a){a.endsWith("&origin=3DSpace")||(s.cgrurl+="&origin=3DSpace")}}var l=i.convertToViewerFormat(e);this.lastSnapshotAssemblyRootId=t;var r={data:[{rootID:t,structure:{results:l.results}}]};this.viewer3d.loadJSON(r),this.mapPathToOccurrence=l.mapPathToOccurrence,this.mapOccurrenceToPath=l.mapOccurrenceToPath}},clear:function(){null!=this.lastSnapshotAssemblyRootId&&(this.viewer3d.removeRoots({pids:[this.lastSnapshotAssemblyRootId]}),this.lastSnapshotAssemblyRootId=null)},destroy:function(){this.viewer3d.destroy()},highlightSelectedObjects:function(e){var t=this.mapPathToOccurrence,i=this.mapOccurrenceToPath;o.empty();for(var n=0;n<e.length;n++){var s=e[n];if(s>=0&&Array.isArray(i)){var a=i[s];if(Array.isArray(a)){var l=JSON.stringify(a);for(var r in t)if(0===r.indexOf(l)){var d=this.viewer3d._controller.buildPathFromArray(JSON.parse(r));o.add({pathElement:d})}}}}}})});const WebUXDialogFooter={YesNo:1,OkCancel:2};Object.freeze(WebUXDialogFooter);const WebUXDialogButton={Yes:1,No:2,Ok:3,Cancel:4};Object.freeze(WebUXDialogButton),define("DS/LifecycleControls/WebUXDialog",["UWA/Controls/Abstract","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button"],function(e,t,i,n){"use strict";return e.extend({create:function({container:e,content:n,title:o,footer:s=WebUXDialogFooter.OkCancel,zIndex:a,initialSize:l}){var r=new t({});let d=()=>{};if(l){let e={};n&&(e.width=window.getComputedStyle(n).width,e.height=window.getComputedStyle(n).height,n.setStyle("width",l.width+"px"),n.setStyle("height",l.height+"px")),d=(t=>{setTimeout(()=>{let i=t.dsModel.elements.container.querySelector(".wux-windows-window-maincontent.wux-element-contentbox"),o=t.dsModel.elements.container.querySelector(".wux-windows-window-content.wux-element-contentbox");i.setStyle("width",l.width+"px"),o.setStyle("height",l.height+"px"),n&&(n.setStyle("width",e.width),n.setStyle("height",e.height)),d=(()=>{})},100)})}return r.addEventListener("contentVisibleStateChange",e=>{d(e)}),this.dialog=new i({immersiveFrame:r,title:o,resizableFlag:!0,content:n||"null content",activeFlag:!1,buttons:this._createButtons(s)}),a&&r.getContent().setStyle("z-index",a),r.inject(e),new UWA.Promise((e,t)=>{this.dialog.addEventListener("close",()=>{this.dialog.destroy(),r.destroy(),t()}),this.addEvent("buttonClick",i=>{i!==WebUXDialogButton.Cancel&&(t=(()=>{}),e(i)),this.dialog.close()})})},enableButton:function(e,t){this._buttons[e]&&(this._buttons[e].disabled=!t)},_createButtons:function(e){this._buttons={};let t={};return e===WebUXDialogFooter.YesNo?(t={Yes:new n({onClick:e=>{this.dispatchEvent("buttonClick",WebUXDialogButton.Yes)}}),No:new n({onClick:e=>{this.dispatchEvent("buttonClick",WebUXDialogButton.No)}})},this._buttons[WebUXDialogButton.Yes]=t.Yes,this._buttons[WebUXDialogButton.No]=t.No):e===WebUXDialogFooter.OkCancel&&(t={Ok:new n({onClick:e=>{this.dispatchEvent("buttonClick",WebUXDialogButton.Ok)}}),Cancel:new n({onClick:e=>{this.dispatchEvent("buttonClick",WebUXDialogButton.Cancel)}})},this._buttons[WebUXDialogButton.Ok]=t.Ok,this._buttons[WebUXDialogButton.Cancel]=t.Cancel),t}})}),define("DS/LifecycleControls/AssemblyTreeList",["UWA/Controls/Abstract","UWA/Core","UWA/Class/Promise","DS/Tree/TreeListView","DS/Core/PointerEvents","DS/Controls/Toggle","DS/LifecycleServices/AssemblyJson","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/ArrayFunctions"],function(e,t,i,n,o,s,a,l,r){"use strict";return e.extend({init:function(e){e=e||{},this._parent({}),this.buildUI(),this.options=e,this.colIndexes=["revision","owner","description","modified","originated"],this.defaultWidth=[],this.defaultWidth.revision=72,this.defaultWidth.newTitle=180,this.defaultWidth.maturityNls=110,this.showCheckbox=!1,this.selectOnCheck=!1,this.postUpdateViewCalled=!1,this.enableDragAndDrop=!0,this.selectOnCheck=!1,this.treeColumnSortable=!0,this.enableListSelection=!1,this.options.updateRelatedCombos=void 0===e.updateRelatedCombos||e.updateRelatedCombos,void 0!==e&&(void 0!==e.showCheckbox&&(this.showCheckbox=e.showCheckbox),void 0!==e.selectOnCheck&&(this.selectOnCheck=e.selectOnCheck),void 0!==e.onDropCol&&(this.onDropCol=e.onDropCol),void 0!==e.allCols&&(this.colIndexes=e.allCols),void 0!==e.getTypeIcon&&(this.getTypeIconFunc=e.getTypeIcon),void 0!==e.getChildrenInTreeOrder&&(this.getChildrenInTreeOrder=e.getChildrenInTreeOrder),void 0!==e.treeColumnSortable&&(this.treeColumnSortable=e.treeColumnSortable),void 0!==e.colsSortable&&(this.colsSortable=e.colsSortable),void 0!==e.treeColumnSortable&&(this.treeColumnSortable=e.treeColumnSortable),void 0!==e.colsSortable&&(this.colsSortable=e.colsSortable),void 0!==e.enableDragAndDrop&&(this.enableDragAndDrop=e.enableDragAndDrop),void 0!==e.enableListSelection&&(this.enableListSelection=e.enableListSelection),void 0!==e.onContextualEvent&&(this.onContextualEvent=e.onContextualEvent),this.canMultiSelect=e.canMultiSelect||!1),this.options.useKeyboard&&this.installKeyboardHandlers(),this._configureDropdownCellFactory(),this.columns=this.initColumns()},disableNodesByType:function(e){for(var t=this.tree.getDocument().getAllDescendants(),i=t.length,n=0;n<i;n++){var o=t[n],s=o.options.type;-1==e.indexOf(s)&&this.disableNode(o)}},installKeyboardHandlers:function(){this.elements.container.addEventListener("keydown",e=>{65===e.keyCode&&e.ctrlKey&&(this.getAllNodes().forEach(e=>e._treeNode.select()),e.preventDefault())})},getNodes:function(e,t){t=[];for(var i=this.tree.getDocument().getAllDescendants(),n=i.length,o=0;o<n;o++){var s=i[o];if(e(s)){var a=this.buildAssemblyNode(s);t.push(a)}}return t},getAllNodes:function(){return this.getNodes(function(e){return!0})},getSelectedNodes:function(){var e=this;return this.tree.getDocument().getSelectedNodes().map(function(t){return e.buildAssemblyNode(t)})},clearSelection:function(){this.getSelectedNodes().forEach(e=>{e._treeNode.unselect()})},getSameNodes2:function(e){return this.getNodes(function(t){return e==t.options.nodeId})},getToggledNodes:function(){if(1!=this.showCheckbox)return[];for(var e=[],t=this.tree.getDocument().getAllDescendants(),i=t.length,n=0;n<i;n++){var o=t[n];if(o.toggled){var s=o.options.nodeId;-1==e.indexOf(s)&&e.push(s)}}return e},getDropdownSelectedIndex:function(e,t){var i=this.getSameNodes(e);if(0==i.length)return-1;var n=i[0];return this.getNodeDropdownSelectedIndex(n,t)},onSelect:function(e){this.onSelCallback=e},onUnselect:function(e){this.onUnselCallback=e},onCheck:function(e){this.onCheckCallback=e},onUncheck:function(e){this.onUncheckCallback=e},insertCol:function(e,t){this.columns.splice(e,0,t)},load:function(e,t,i){var o=this;let s=Array.isArray(e)?e:[e];this.filterDuplicates=!1,void 0!==i&&void 0!==i.filterDuplicates&&(this.filterDuplicates=i.filterDuplicates);var a,l=i?i.loadFilter:null,r=i?i.sortFn:null;let d="undefined"!==this.options?this.colIndexes:t,c=this.createNodeUIAttributes(d),u=this.createTreeListUIRoots(s,c.attributeNames,l,r);a=this.getOptions(u,c.customCols),this.tree=new n(a),this.tree.getManager().onPostUpdateView(function(){o.postUpdateViewCalled=!0,o.dispatchEvent("onPostUpdateView")}),this.tree.inject(this.elements.container),void 0!==this.options&&this.customizeColumns(t),this.elements.container.getElement(".wux-tree-treelistview").setStyle("height","100%"),this.elements.container.getElement(".wux-datagrid").setStyle("height","100%"),this.elements.container.getElement(".wux-layouts-gridengine").setStyle("height","100%"),this.elements.container.getElement(".wux-layouts-gridengine").setStyle("min-height","80px");for(var h=this.tree.getDocument().getAllDescendants(),m=h.length,f=0;f<m;f++){var p=h[f];p.onSelect(function(e){e.target;if(null!=o.onSelCallback){var t=o.buildAssemblyNode(e.target);o.onSelCallback(t)}}),p.onUnselect(function(e){e.target;if(null!=o.onUnselCallback){var t=o.buildAssemblyNode(e.target);o.onUnselCallback(t)}}),p.toggle=function(){this.toggled=!0,null!=this.checkbox&&!0!==this.checkbox.checkFlag&&this.checkbox.toggle()},p.untoggle=function(){this.toggled=!1,null!=this.checkbox&&!0===this.checkbox.checkFlag&&this.checkbox.toggle()}}i&&i.noExpandAll||this.tree.getNthRoot(0).expandAll()},insertDropdownListCol:function(e,t,i,n,o,s,a,l){s=void 0!==s?s:130;var r=void 0===a||a,d=this;this.insertCol(e,{text:i,dataIndex:t,isSortable:r,type:"string",width:s,onCellRequest:function(e){e.isHeader||d.insertDropdownListCell(t,e,n,o,l)}})},getRelatives:function(e){return{children:e.getAllDescendants(),parents:e.getParents(),instances:this.getSameNodes(e.options.nodeId)}},setDropdownSelectionIf:function(e,t,i,n){for(var o=0;o<e.length;o++){var s=e[o];if(("function"!=typeof n||n(this.getNodeDropdownSelectedIndex(s,i)))&&(this.setNodeDropdownSelectedIndex(s,i,t),void 0!==s.dropdownList)){var a=s.dropdownList[i];a.selectedIndex=t,a.previouslySelectedIndex=t}}},getNodeDropdownSelectedIndex:function(e,t,i){return void 0!==e.dropdownListSelectedIndex?e.dropdownListSelectedIndex[t]:void 0!==i?(e.dropdownListSelectedIndex={},e.dropdownListSelectedIndex[t]=i,i):0},setNodeDropdownSelectedIndex:function(e,t,i){void 0===e.dropdownListSelectedIndex&&(e.dropdownListSelectedIndex={}),e.dropdownListSelectedIndex[t]=i},onDropdownListChange:function(e){var t,i=e.target,n=i.nodeModel,o=i.dataIndex;"function"==typeof i.onChangeCallback&&i.onChangeCallback(i.previouslySelectedIndex,i.selectedIndex,n),i.previouslySelectedIndex=i.selectedIndex,t=this.options.updateRelatedCombos?this.getRelatives(n).instances:[n];var s=i.selectedIndex;this.setDropdownSelectionIf(t,s,o),n.options.grid[o]=i.options[s].innerHTML},_configureDropdownCellFactory:function(){this.defaultDropdownCellFactory=function(e,i){var n=t.createElement("select",{class:"atl-combo"+(0===e._nodeDepth?" atl-root":""),styles:{width:"100%"}});return n.onChangeCallback=i,n},this.dropdownCellFactory=this.options&&this.options.dropdownCellFactory?this.options.dropdownCellFactory:this.defaultDropdownCellFactory},insertDropdownListCell:function(e,i,n,o,s){var a=this,l=i.nodeModel,r={physicalId:l.options.physicalId,nodeId:l.options.nodeId,occId:l.options.occId},d=this.dropdownCellFactory(l,o);d.dataIndex=e,d.nodeModel=l,l.dropdownList={},l.dropdownList[e]=d,d.addEventListener("change",function(e){a.onDropdownListChange(e)});for(var c=n(r,l),u=c.length,h=0;h<u;h++){var m=t.createElement("option"),f="",p=!1;"object"==typeof c[h]?(f=c[h].text,p=!!c[h].disabled&&c[h].disabled):f=c[h],m.setText(f),p&&(m.disabled=!0),m.inject(d)}var g="function"==typeof s?s(r,l):0;d.selectedIndex=this.getNodeDropdownSelectedIndex(l,e,g),d.previouslySelectedIndex=d.selectedIndex,(u<=1||l.disabled)&&a.disableDropdownList(d),i.cellView.getContent().setHTML(d),null!=(m=d.options[d.selectedIndex])&&(l.options.grid[e]=d.options[d.selectedIndex].innerHTML)},disableDropdownLists:function(e){var t=e.dropdownList;for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];this.disableDropdownList(n)}},disableDropdownList:function(e){null!==e&&(e.disabled=!0,e.setStyle("opacity",".2"))},enableDropdownLists:function(e){var t=e.dropdownList;for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];this.enableDropdownList(n)}},enableDropdownList:function(e){null===e||e.nodeModel.hardDisabled||(e.disabled=!1,e.setStyle("opacity","1"))},buildAssemblyNode:function(e){var t=this,i=e.options,n={occId:i.occId,nodeId:i.nodeId,physicalId:i.physicalId,_treeNode:e,getParent:function(){var e=n._treeNode.getParent(),i=null;return null!=e&&null!=e.options.occId&&(i=t.buildAssemblyNode(e)),i},getChildren:function(){var e=[],i=n._treeNode.getChildren();if(null==i)return[];for(var o=i.length,s=0;s<o;s++){var a=i[s],l=t.buildAssemblyNode(a);e.push(l)}return e}};return n},customizeColumns:function(e){for(var t=this.getColumnsOptions(e),i=this.tree.options.columns.length,n=0;n<i;n++){"toggle"==(o=this.columns[n]).dataIndex||"tree"==o.dataIndex||e&&-1!=e.indexOf(o.dataIndex)||(o.isHidden=!0,t.push(o))}this.tree.loadColumns(t);for(n=0;n<i;n++){var o;(o=this.tree.options.columns[n]).isHidden?this.tree.getManager().hideColumn(o.dataIndex):this.tree.getManager().showColumn(o.dataIndex)}},getColumnsOptions:function(e){var t=[];if(this.showCheckbox){var i=this.getCol("toggle");i.isHidden=!1,t.push(i)}var n=this.getCol("tree");if(n.isHidden=!1,t.push(n),void 0!==e)for(var o=e.length,s=0;s<o;s++){var a=e[s],l=this.getCol(a);l.isHidden=!1,t.push(l)}return t},createNodeUIAttributes:function(e){var t=[];if(this.showCheckbox){this.insertToggleCol();var i=this.getCol("toggle");t.push(i)}var n=this.getCol("tree");t.push(n);var o=["physicalid","Title","type"];if(void 0!==e)for(var s=e.length,a=0;a<s;a++){var l=e[a],r=this.getCol(l);t.push(r);var d=l;"modified"==d&&(d="mod"),o.push(d)}return o.push("type_icon_url"),{attributeNames:o,customCols:t}},createTreeListUIRoots:function(e,t,i,n){var o=[];return e.forEach(e=>{var s=a.getRootOccurenceId(e),l=a.AssemblyHelper(e),r={};this.fillTreeListNode(e,l,s,t,r,i,n),o.push(r)}),o},getOptions:function(e,t){var i=this,n={apiVersion:2,columns:t,roots:e,enableDragAndDrop:this.enableDragAndDrop,resize:{columns:!0,rows:!0},selection:{toggle:!1,enableListSelection:this.enableListSelection,canMultiSelect:this.canMultiSelect},shouldAcceptDrag:function(e){return!1},onDrop:function(e,t,n,o){return i.onDragDropColumn(e,t,n,o)},onDropColumnHeader:function(e,t){return i.onDragDropColumn2(e,t)}};return this.onContextualEvent&&(n.onContextualEvent=this.onContextualEvent),n},getColIndex:function(e,t){for(var i=e.dataIndex,n=t.length,o=0;o<n;o++){if(i==t[o].dataIndex)return o}return-1},calcAfterDropColDataIndexes:function(e,t){for(var i=[],n=t.manager.options.columns,o=this.getColIndex(e,n),s=this.getColIndex(t,n),a=n.length,l=0;l<a;l++){var r=n[l].dataIndex;"toggle"!=r&&"tree"!=r&&(l!=o&&(l==s?o<s?(i.push(r),i.push(e.dataIndex)):o>s?(i.push(e.dataIndex),i.push(r)):i.push(r):i.push(r)))}return i},onDragDropColumn:function(e,t,i,n){if("tree"==t.dataIndex||"toggle"==t.dataIndex||"tree"==i.dataIndex||"toggle"==i.dataIndex)return!1;if(null!=this.onDropCol){var o=this.calcAfterDropColDataIndexes(t,i);this.onDropCol(o)}return!0},onDragDropColumn2:function(e,t){var i=e.dataTransfer.getData("Text"),n=t.dataIndex;if("tree"==i||"toggle"==i||"tree"==n||"toggle"==n)return!1;var o=this.tree.getManager().getColumn(i)[0],s=this.tree.getManager().getColumn(n)[0],a=!1;o.options.columnID>s.options.columnID&&(a=!0);for(var l=this.tree.getManager().getColumns(),r=[],d=l.length,c=0;c<d;c++){var u=l[c],h=u.dataIndex;if(0==u.isHidden&&"tree"!=h&&"toggle"!=h){if(h==i)continue;a?(h==n&&r.push(i),r.push(h)):(r.push(h),h==n&&r.push(i))}}return this.onDropCol(r),!0},fillTreeListNode:function(e,t,i,n,o,s,a){var r=t.getNodeIdFromOccurenceId(i),d=(x=t.getNodeAttributeValues(r,n))[0],c=x[1],u=x[2],h=x[n.indexOf("type_icon_url")];null==h&&null!=this.getTypeIconFunc&&(h=this.getTypeIconFunc(u));for(var m,f={},p=x.length,g=3;g<p;g++){var v=n[g],C=x[g],y=v;"mod"==v&&(y="modified",C=l.formatDate(C,!0)),"originated"==v&&(C=l.formatDate(C,!0)),f[y]=C}o.label=c,o.icons=[h],o.grid=f,o.type=u,o.occId=i,o.nodeId=r,o.physicalId=d,o.assembly=e;var b=(m=this.getChildrenInTreeOrder?t.getChildOccurenceIdsTreeOrder(i,this.filterDuplicates):t.getChildOccurenceIds(i,this.filterDuplicates)).length;if(b>0){o.children=[];for(g=0;g<b;g++){var w=m[g],S=!1;if(s){var x;r=t.getNodeIdFromOccurenceId(w);s({type:(x=t.getNodeAttributeValues(r,["type"]))[0]})&&(S=!0)}if(!S){var D={};o.children.push(D),this.fillTreeListNode(e,t,w,n,D,s,a)}}a&&(o.children=o.children.sort(a))}},addColumn:function(e,t,i,n,o){var s={text:t,dataIndex:i,isSortable:o,width:n};e.push(s)},initColumns:function(){var e=[],t=l.getAttributeDisplayName("title");this.addColumn(e,t,"tree","auto",this.treeColumnSortable);for(var i=this.colIndexes.length,n=0;n<i;n++){var o=this.colIndexes[n],s=l.getAttributeDisplayName(o),a="auto";null!=this.defaultWidth[o]&&(a=this.defaultWidth[o]);var r=!0;null!=this.colsSortable&&null!=this.colsSortable[o]&&(r=this.colsSortable[o]),this.addColumn(e,s,this.colIndexes[n],a,r)}return e},buildUI:function(){this.elements.container=t.createElement("div",{class:"assemblyTreeListContainer",styles:{class:"tree_list",top:"0px",left:"0px",width:"100%",height:"100%","background-color":"white"}})},updateToggleHeader:function(){var e=this.getAllNodesCount(),t=this.getSelectedNodes();this.lastSelected!=e&&0!=this.lastSelected||this.toggleHeader.toggle(),this.lastSelected=t.length},toggleAll:function(){for(var e=this.tree.getDocument().getAllDescendants(),t=e.length,i=0;i<t;i++){var n=e[i];n.disabled||n.toggle()}},untoggleAll:function(){for(var e=this.tree.getDocument().getAllDescendants(),t=e.length,i=0;i<t;i++){var n=e[i];n.disabled||n.untoggle()}},getAllNodesCount:function(){return 10},createToggleHeader:function(){var e=this,t=new s({checkFlag:!1,mixedState:!1});return t.getContent().addEventListener(o.POINTERDOWN,function(e){e.stopPropagation()}),t.getContent().addEventListener("focus",function(e){e.preventDefault(),e.stopPropagation()}),t.getContent().addEventListener("change",function(t){t.preventDefault(),t.stopPropagation(),t.dsModel.checkFlag?e.toggleAll():e.untoggleAll()}),t},getSameNodes:function(e){for(var t=[],i=this.tree.getDocument().getAllDescendants(),n=i.length,o=0;o<n;o++){var s=i[o];e==s.options.nodeId&&t.push(s)}return t},toggleSameNodes:function(e){for(var t=this.getSameNodes(e),i=t.length,n=0;n<i;n++){var o=t[n];this.selectOnCheck&&o.select(),o.toggle()}},untoggleSameNodes:function(e){for(var t=this.getSameNodes(e),i=t.length,n=0;n<i;n++){t[n].untoggle()}},onToggle:function(e){if(this.selectOnCheck&&e.select(),this.toggleSameNodes(e.options.nodeId),null!=this.onCheckCallback){var t=this.buildAssemblyNode(e);this.onCheckCallback(t)}},onUntoggle:function(e){if(this.untoggleSameNodes(e.options.nodeId),null!=this.onUncheckCallback){var t=this.buildAssemblyNode(e);this.onUncheckCallback(t)}},disableNode:function(e){e.disabled=!0,this.disableToggle(e),this.disableDropdownLists(e)},disableToggle:function(e){null!=e.checkbox&&(e.checkbox.disabled=!0)},enableNode:function(e){e.disabled=!1,this.enableToggle(e),this.enableDropdownLists(e)},enableToggle:function(e){null!=e.checkbox&&(e.checkbox.disabled=!1)},insertToggleCell:function(e){var t=this,i=e.nodeModel,n=new s({checkFlag:i.toggled,mixedState:!1});i.checkbox=n,i.disabled&&t.disableToggle(i),n.getContent().addEventListener(o.POINTERDOWN,function(e){e.stopPropagation()}),n.addEventListener("buttonclick",function(e){console.log("buttonclick")}),n.getContent().addEventListener("focus",function(e){e.preventDefault(),e.stopPropagation()}),n.getContent().addEventListener("change",function(e){i.toggled=e.dsModel.checkFlag,i.toggled?t.onToggle(i):t.onUntoggle(i)}),e.cellView.getContent().setHTML(n)},insertToggleCol:function(){var e=this;this.toggleHeader=this.createToggleHeader();var t={text:this.toggleHeader,width:30,dataIndex:"toggle",isSortable:!1,onCellRequest:function(t){t.isHeader||e.insertToggleCell(t)}};this.insertCol(0,t)},getCol:function(e){for(var t=this.columns.length,i=0;i<t;i++){var n=this.columns[i];if(n.dataIndex==e)return n}return null},selectOccurrences:function(e){for(var t=this.tree.getDocument().getAllDescendants(),i=0;i<t.length;i++){var n=t[i],o=n.options.occId;-1!=e.indexOf(o)?n.select():n.isSelected()&&n.unselect()}},onInitialUpdateView:function(){var e=this;return this._onInitialUpdateViewPromise=this._onInitialUpdateViewPromise||new t.Class.Promise(function(t,i){e.postUpdateViewCalled?t():e.addEvent("onPostUpdateView",function(){setTimeout(function(){t()},100)})}),this._onInitialUpdateViewPromise}})}),define("DS/LifecycleControls/CustomizeColumns",["UWA/Class","DS/LifecycleControls/ChooseAttributes","DS/LifecycleServices/LifecycleServices","i18n!DS/LifecycleControls/assets/nls/CustomizeColumns"],function(e,t,i,n){"use strict";return e.extend({init:function(e,t,i,n){this._parent({}),this.allColumns=i,this.defaultCols=n,this.hWidget=e,this.appId=t},getAll:function(){return this.allColumns},getAlldbKeys:function(){return this.allColumns.map(function(e){return e.dbKey})},load:function(){var e=null;return null==(e=this.hWidget?this.hWidget.getValue(this.appId):JSON.parse(window.localStorage.getItem(this.appId)))&&(e=this.defaultCols,this.save(e)),e},save:function(e){this.hWidget?this.hWidget.setValue(this.appId,e):window.localStorage.setItem(this.appId,JSON.stringify(e))},getAttrDispName:function(e){return"newTarget"==e?n.newTarget:i.getAttributeDisplayName(e)},customizeColumns:function(e,i){for(var o=this,s=this.load(),a=[{name:"title",displayName:this.getAttrDispName("title"),isSelected:!0,disabled:!0}],l=0,r=s.length;l<r;l++){var d=this.allColumns.find(function(e){return s[l]===e.dbKey});d&&a.push({name:d.dbKey,displayName:d.columnNLS,isSelected:!0})}var c=this.allColumns.length;for(l=0;l<c;l++)-1==s.indexOf(this.allColumns[l].dbKey)&&a.push({name:this.allColumns[l].dbKey,displayName:this.allColumns[l].columnNLS,isSelected:!1});t.showDialog({title:n.CustomizeColumns,parent:document.body,allAttributes:a,onShow:function(e){i(e)},onOk:function(t){for(var i=[],n=t.length,s=0;s<n;s++)"title"!=t[s]&&i.push(t[s]);o.save(i),e(i)}})},setParams:function(e,t,i){"string"==typeof e&&e.length&&(this.appId=e),Array.isArray(t)&&t.length&&(this.allColumns=t),Array.isArray(i)&&i.length&&(this.defaultCols=i)}})}),define("DS/LifecycleControls/AdaptiveLayout",["UWA/Controls/Abstract","DS/LifecycleControls/ResizeMonitor","DS/LifecycleServices/ArrayFunctions"],function(e,t,i){"use strict";function n(e){var t=parseInt(e,10);return isNaN(t)?0:t}var o=e.extend({init:function(e){if(this.el=e,!this.el.classList){var t=e;this.el.classList={contains:function(e){return-1!==this._getClassList().indexOf(e)},add:function(e){var t=this._getClassList();-1===t.indexOf(e)&&(t.push(e),this._updateClassList(t))},remove:function(e){var t=this._getClassList(),i=t.indexOf(e);-1!==i&&(t.splice(i,1),this._updateClassList(t))},_getClassList:function(){var e=t.getAttribute("class")||"";return e?e.trim().split(/\s+/):[]},_updateClassList:function(e){t.setAttribute("class",e.join(" "))}}}},hasClass:function(e){return this.el.classList.contains(e)},addClass:function(e){this.el.classList.add(e)},removeClass:function(e){this.el.classList.remove(e)}});return e.extend({init:function(e,i){this.cls=e,this.parentEl=i,this.queries=[],this.currentCls=[],this.queryIdCounter=2,this.currentStyle=0,this.onSizeChangedFn=null,this.onStyleChangedFn=null,this.isMain=!1,this.childGroups=[],this.resizeMon=new t,this.monitoredElements=[],this.currentCls.push(e)},query:function(e,t,i){var n={id:this.queryIdCounter++,query:function(e){var t={};return e.split(";").forEach(function(e){var i=e.split(":");2===i.length&&(t[i[0].trim()]=parseInt(i[1].trim(),10))}),t}(e),cls:[],optional:i||[]};return t.forEach?n.cls=t:n.cls.push(t),this.queries.push(n),this},onSizeChanged:function(e){return"function"==typeof e&&(this.onSizeChangedFn=e),this},onStyleChanged:function(e){return"function"==typeof e&&(this.onStyleChangedFn=e),this},start:function(){return this._init(!0)},stop:function(){this.monitoredElements.forEach(function(e){null!=e&&e.detach()}),this.monitoredElements=[]},restart:function(e){e.forEach?e.forEach(function(e){this._restart(e)},this):this._restart(e)},_restart:function(e){this.cls===e?(this._initAdaptiveElements(),this.currentStyle=0,this._sizeChanged()):this.childGroups.forEach(function(t){t.cls===e&&(t._initAdaptiveElements(),t.currentStyle=0,this._sizeChanged())},this)},_init:function(e){if(this.isMain=e,this._initAdaptiveElements(),this.isMain){var t=this,i=this.resizeMon.addMonitor(this.parentEl,function(){t._sizeChanged()});this.monitoredElements.push(i)}return this.childGroups.forEach(function(e){e._initAsChild()}),this},_initAdaptiveElements:function(){this.elements=Array.prototype.slice.apply(this.parentEl.querySelectorAll("."+this.cls)).map(function(e){return{el:new o(e),restoreCls:[],removeCls:[]}})},childGroup:function(e){return this.childGroups.push(e),this},_initAsChild:function(){this.isMain&&console.error("Ambiguous initialization"),this._init(!1)},_matchQueries:function(e,t){var i=this.queries.find(function(i){return!!(i.query["max-height"]&&t<i.query["max-height"])||(!!(i.query["min-height"]&&t>i.query["min-height"])||(!!(i.query["max-width"]&&e<i.query["max-width"])||!!(i.query["min-width"]&&e>i.query["min-width"])))}),n=i||{id:1,cls:[this.cls],optional:[]},o=!1;return this.currentStyle!==n.id&&(this._changeStyle(n),o=!0),o},_changeStyle:function(e){this.elements.forEach(function(t){t.restoreCls.forEach(function(e){t.el.addClass(e)}),t.restoreCls.length=0,t.removeCls.forEach(function(e){t.el.removeClass(e)}),t.removeCls.length=0,this.currentCls.forEach(function(e){t.el.removeClass(e)}),e.cls.forEach(function(e){t.el.addClass(e)}),e.optional.forEach(function(e){t.el.hasClass(e.from)&&(t.el.removeClass(e.from),t.restoreCls.push(e.from),t.el.addClass(e.to),t.removeCls.push(e.to))})},this),this.currentStyle=e.id,this.currentCls.length=0,this.currentCls.push.apply(this.currentCls,e.cls)},_sizeChanged:function(){var e=this.parentEl.offsetWidth,t=this.parentEl.offsetHeight,i=window.getComputedStyle(this.parentEl),o={width:e-(parseInt(i.paddingLeft,10)+parseInt(i.paddingRight,10)+n(i.borderLeft)+n(i.borderRight)),height:t-(parseInt(i.paddingTop,10)+parseInt(i.paddingBottom,10)+n(i.borderTop)+n(i.borderBottom))},s=this._matchQueries(o.width,o.height);if(this.childGroups.forEach(function(e){e._matchQueries(o.width,o.height)&&(s=!0)}),s&&this.onStyleChangedFn){var a=this.queries.find(function(e){return this.currentStyle===e.id},this),l=a?a.cls[0]:this.cls;this.onStyleChangedFn.call(null,l,o)}this.onSizeChangedFn&&this.onSizeChangedFn.call(null,s,o)}})}),define("DS/LifecycleControls/RelatedObjectsDialog",["UWA/Controls/Abstract","DS/LifecycleControls/WebUXDialog","DS/LifecycleServices/EventHandler","DS/LifecycleControls/RelatedObjectsControl","i18n!DS/LifecycleControls/assets/nls/RelatedObjectsDialog"],function(e,t,i,n,o){"use strict";return e.extend({create:function(e){let s=[],a=new t,l=new n({model:e.model,odtOptions:e.odtOptions,events:{selectionChange:e=>{s=e.selection},viewReady:e=>{a.enableButton(WebUXDialogButton.Ok,!0),this.keydownHandler=new i(document,"keydown",e=>{if(!e.shiftKey&&!e.ctrlKey&&13===e.keyCode){let t=a._buttons[WebUXDialogButton.Ok]||{onClick:()=>{}};t.disabled||t.onClick(),e.preventDefault()}})}}});return new UWA.Promise((t,i)=>{l.load().then(()=>{a.create({container:e.parentContainer,content:l.getContent(),title:o.selectRelatedObjs,zIndex:5e4,initialSize:{width:500,height:200}}).then(e=>{t(s)}).catch(e=>{console.log("RelatedObjectsDialog exception: ",e),i()}).finally(()=>{l.destroy(),this.keydownHandler&&this.keydownHandler.unbind()}),a.enableButton(WebUXDialogButton.Ok,!1)}).catch(()=>{console.warn("ENORIPE_Relations not available for selecting related objects"),t([])})})}})}),define("DS/LifecycleControls/DlgMaximizeHandler",["UWA/Controls/Abstract","DS/LifecycleControls/WidgetMaximizeHandler"],function(e,t){"use strict";return e.extend({init:function(e){var i=this;this.dialog=e,this.isUIVisible=!0,this.isMaximized=!1,this.widgetHandler=new t,this.widgetHandler.addEvent("widget-maxmized-changed",function(e){i._updateHeaderButtons(e),i.dispatchEvent("widget-maxmized-changed",e)}),this._insertMinMaxButtons()},destroy:function(){this.widgetHandler.destroy(),this.widgetHandler=null},isWidgetMaximized:function(){return this.widgetHandler.isMaximized},setUIVisibility:function(e){this.isUIVisible!==e&&(this.isUIVisible=e,this._updateHeaderButtons(this.isMaximized))},_insertMinMaxButtons:function(){var e=this.dialog.elements.header.querySelector(".floatingPanel_RightButtons");if(e){var t=this;this.maxBtn=UWA.createElement("span",{class:"right-actions fonticon fonticon-resize-full ",styles:{display:this.widgetHandler.isMaximized?"none":"inline-block"},events:{click:function(){t._maximize()},touchstart:function(){t._maximize()}}}).inject(e,"top"),this.restoreBtn=UWA.createElement("span",{class:"right-actions fonticon fonticon-resize-small ",styles:{display:this.widgetHandler.isMaximized?"inline-block":"none"},events:{click:function(){t._restore()},touchstart:function(){t._restore()}}}).inject(e,"top")}},_updateHeaderButtons:function(e){this.isMaximized=e,this.isUIVisible?e?(this.maxBtn.setStyle("display","none"),this.restoreBtn.setStyle("display","inline-block")):(this.maxBtn.setStyle("display","inline-block"),this.restoreBtn.setStyle("display","none")):(this.maxBtn.setStyle("display","none"),this.restoreBtn.setStyle("display","none"))},_maximize:function(e){this._updateHeaderButtons(!0),this.restoreRect=this.dialog.elements.container.getBoundingClientRect();var t=this;this.widgetHandler.maximize().then(function(){var i=t.dialog.elements.container.parentElement.getBoundingClientRect();t.dialog._changeWidth(i.width),t.dialog._changeHeight(i.height),t.dialog._resizeContainer(),t.dialog.isMaximized=!0,t.dialog.options.resizable&&!e&&(t.dialog._showResizeContainer(!1),t.oldResizeCB=t.dialog.__showResizeContainerCB,t.dialog.__showResizeContainerCB=function(){})})},_restore:function(){this._updateHeaderButtons(!0);var e=this;this.widgetHandler.restore().then(function(){e.restoreRect&&(e.dialog.isMaximized=!1,e.dialog.setNewSize({width:e.restoreRect.width,height:e.restoreRect.height}),e.dialog._changeLeft(e.restoreRect.left),e.dialog._changeTop(e.restoreRect.top),e.dialog.options.resizable&&(e.dialog.__showResizeContainerCB=e.oldResizeCB))})}})}),define("DS/LifecycleControls/CommandDialog",["UWA/Controls/Abstract","UWA/Core","DS/ENOFloatingPanel/ENOFloatingPanel","DS/UIKIT/Input/Button","DS/UIKIT/Mask","DS/LifecycleCmd/ImageUtil","DS/LifecycleControls/DlgMaximizeHandler","i18n!DS/LifecycleControls/assets/nls/CommandDialog","DS/ENO6WPlugins/jQuery","css!DS/LifecycleControls/LifecycleControls"],function(e,t,i,n,o,s,a,l,r){"use strict";return e.extend({buttonStyle:{ok:1,okCancel:2,none:3,cancel:4},init:function(){this._dialog=null,this._okButton=null,this._cancelButton=null,this._closeButton=null},create:function(e,i,n){var o=i||{};this._onOkHandler=o.onOk||function(){},this._onCloseHandler=o.onClose||function(){},this._enableCmdFn=o.enableCmd||null,this._fnContext=n||this,this._OKBtnText=o.OKBtnText||l.okButton,this._CancelBtnText=o.CancelBtnText||"",this._OKBtnType=o.OKBtnType||"";var s=document.getElementsByClassName("floatingPanelComponent");if(s.length>0){var r=s[0];this.overlayMask=t.createElement("div",{class:"modal-overlay fade EFP_overlay in"}).inject(r,"top")}o.onCloseOverride&&(o.events||(o.events={}),o.events.onClose=o.onCloseOverride);var d=this._createFooter(o.buttonStyle||this.buttonStyle.okCancel),c=(r=void 0===o.overlay||o.overlay,this._createDialog(d,e,o.resizable||!1,o.maximizable||!1,o.closeButton,o.settingsButton||!1,o.settingsCallback||null,o.events||{},o.title,r,o.className||"",o.persistId));this.updateUI();var u=this;return o.powerMaximize&&(this.DlgMaximizeHandler=new a(c),this.DlgMaximizeHandler.addEvent("widget-maxmized-changed",function(e){u.dispatchEvent("widget-maxmized-changed",e)})),c},destroy:function(){this.overlayMask&&(this.overlayMask.remove(),this.overlayMask=void 0),this.DlgMaximizeHandler&&(this.DlgMaximizeHandler.destroy(),this.DlgMaximizeHandler=null),this._dialog&&(this._dialog.destroy(),this._dialog=null)},setTitle:function(e){this._dialog&&this._dialog.setTitle(e)},updateUI:function(){this._cancelButton&&this._cancelButton.setDisabled(!1),this._closeButton&&(this._closeButton.disabled=!1),this._okButton&&(this._okButton.isDisabled()&&(this._okButton.events=null),this._enableCmdFn?this._okButton.setDisabled(!this._enableCmdFn.apply(this._fnContext)):this._okButton.setDisabled(!1))},isWidgetMaximized:function(){return!!this.DlgMaximizeHandler&&this.DlgMaximizeHandler.isWidgetMaximized()},setPowermaximizeVisibility:function(e){this.DlgMaximizeHandler&&this.DlgMaximizeHandler.setUIVisibility(e)},maximize:function(e){this.DlgMaximizeHandler&&this.DlgMaximizeHandler._maximize(e)},restore:function(){this.DlgMaximizeHandler&&this.DlgMaximizeHandler._restore()},maskBody:function(e){if(this._dialog){var t=this._dialog.getBody();t&&o.mask(t,e)}},unmaskBody:function(){if(this._dialog){var e=this._dialog.getBody();e&&o.isMasked(e)&&o.unmask(e)}},_onOk:function(){this._disableUI(),this._onOkHandler.apply(this._fnContext)},_onCancel:function(){this._disableUI(),this._onCloseHandler.apply(this._fnContext),this.destroy()},_disableUI:function(e){let t=null==e||e;this._okButton&&this._okButton.setDisabled(t),this._cancelButton&&this._cancelButton.setDisabled(t),this._closeButton&&(this._closeButton.disabled=t)},_disableOK:function(){this._okButton&&this._okButton.setDisabled(!0)},_createFooter:function(e){if(e!==this.buttonStyle.none){var t=document.createElement("div");e===this.buttonStyle.ok?"delete"===this._OKBtnType?this._okButton=new n({value:this._OKBtnText,className:"primary-delete"}):this._okButton=new n({value:this._OKBtnText,className:"primary"}):e===this.buttonStyle.cancel?this._cancelButton=new n({value:l.cancelButton,className:"default"}):("delete"===this._OKBtnType?this._okButton=new n({value:this._OKBtnText,className:"primary-delete"}):this._okButton=new n({value:this._OKBtnText,className:"primary"}),this._cancelButton=new n({value:this._CancelBtnText||l.cancelButton,className:"default"}));var i=this;return this._okButton&&(this._okButton.inject(t),this._okButton.addEvent("onClick",function(){i._onOk()})),this._cancelButton&&(this._cancelButton.inject(t),this._cancelButton.addEvent("onClick",function(){i._onCancel()})),t}},_decreaseAllzIndex:function(e){if(e&&""!==e)for(var t=r("."+e),i=0;i<t.length;i+=1){var n=r(t[i]).css("zIndex");r.isNumeric(n)&&r(t[i]).css("zIndex",n-=1)}},_setToTopzIndex:function(e){r(e).css("zIndex",40040)},_createDialog:function(e,t,n,o,s,a,l,r,d,c,u,h){var m=this;r.onClose||(r.onClose=function(){m._onCancel()}),this._decreaseAllzIndex(u),this._dialog=new i({className:"command_dialog "+u,title:d,footer:e,body:t,overlay:c,escapeToClose:s,closable:s,hasSettings:a,settingsCallback:l,animate:!0,resizable:n,maximizable:o,autocenter:!0,visible:!0,events:r,limitParent:!0,persistId:h}),this._setToTopzIndex(this._dialog.elements.container);var f=this,p=function(){f._decreaseAllzIndex(u),f._setToTopzIndex(f._dialog.elements.container)};return this._dialog.elements.content.addEventListener("touchstart",p,!0),this._dialog.elements.content.addEventListener("mousedown",p,!0),this._dialog}})});