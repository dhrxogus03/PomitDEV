define("DS/ShareWidget/ShareModel",["UWA/Controls/Abstract"],function(e){return e.extend({init:function(e){this._RightList=[],this._DataList=[],this._ObjectId=e,this._ownerId="",this._projId="",this._orgId="",this._userGrpId="",this._objectType=""},setPOV:function(e,t,n,r){this._ownerId=e,this._projId=t,this._orgId=n,this._userGrpId=r},getOwnerId:function(){return this._ownerId},getProjId:function(){return this._projId},getOrgId:function(){return this._orgId},getUserGrpId:function(){return this._userGrpId},getObjectType:function(){return this._objectType},setRightList:function(e){this._RightList=e},setDataList:function(e){this._DataList=e},setObjectId:function(e){this._ObjectId=e},setObjectType:function(e){this._objectType=e},getRightList:function(){return this._RightList},getDataList:function(){return this._DataList},getObjectId:function(){return this._ObjectId}})}),define("DS/ShareWidget/ShareController",["UWA/Controls/Abstract","UWA/Json","DS/ShareWidget/ShareModel","DS/WidgetServices/WidgetServices","DS/WidgetServices/CollabPerfTimer","DS/WAFData/WAFData","DS/WidgetServices/securityContextServices/SecurityContextServices","i18n!DS/ShareWidget/assets/nls/langAR"],function(e,t,n,r,i,a,o,s){var c=r.getProdLevel();return e.extend({defaultOptions:{uniqueRightList:!1,wintop:!1,serverName:"",serverUri:"",isReadOnly:!1,odtMode:!1,parent:null},init:function(e,t){c=r.getProdLevel(),this.widget=e,this.AccessRightModelList=[],this.ECToParentMap=JSON.parse("[]"),this.IdToECMap=JSON.parse("[]"),this.SelectedItemsMap=JSON.parse("[]"),this.ExistingECItemsMap=JSON.parse("[]"),this.AggrItemsMap=JSON.parse("[]"),this.ErrorExistingECAndAggrItemsMap=JSON.parse("[]"),this.SelectedItems=[],this.SelectedItemsTypeMap=JSON.parse("[]"),this.NonEmbeddedComponentList=[],this._bInitDatas=!1,this._options=t,this._parent(t),this.accessLogicalNlsMap={},this.listOfValidIDs=[],this.listOfInvalidIDs=[],this.InvalidSelectedItemsMap=JSON.parse("[]"),this.LifecycleConfidentialityEnabled=!1,this._perfTimer=i,this.widgetSecurityContext="";var n="";if(null!=e)if(e.hasOwnProperty("pad_security_ctx"))0!=(n=e.pad_security_ctx).indexOf("ctx::")&&(n="ctx::"+n);else if("function"==typeof e.hasPreference&&null!=e.getPreference("pad_security_ctx"))n=e.getPreference("pad_security_ctx").value;else if("function"==typeof e.hasPreference&&e.hasPreference("xPref_CREDENTIAL")){var a=e.getPreference("xPref_CREDENTIAL");void 0!==a.value&&null!==a.value&&a.hasOwnProperty("value")&&(n="ctx::"+a.value)}else"function"==typeof e.hasPreference&&null!=e.getPreference("securityContext")&&(n=e.getPreference("securityContext").value);this.widgetSecurityContext=n},getRightList:function(e){var t=[];return 1==this.options.uniqueRightList?this.AccessRightModelList.length>0&&(t=this.AccessRightModelList[0].getRightList()):this.AccessRightModelList.every(function(n){return n.getObjectId()!=e||(t=n.getRightList(),!1)}),t},getFormattedRightList:function(e){var t=this.getRightList(e),n=[];return t.forEach(function(e,t){var r={label:e.nls,value:e.logical};n.push(r)}),n},getOwnership:function(e){var t=[];return this.AccessRightModelList.every(function(n){return n.getObjectId()!=e||(t=n.getDataList(),!1)}),t},isInherited:function(e,t){var n=this.getOwnershipFromOwner(e,t),r=!1;return null!=n&&n.hasOwnProperty("inheritedPath")&&n.inheritedPath.length>0&&(r=!0),r},getOwner:function(e,t){var n=this.getOwnershipFromOwner(e,t);return null==n?null:n.owner},getOwnershipFromOwner:function(e,t){var n=this.getOwnership(e),r=null,i=this;return n.every(function(e){return 1!=i.ownerAreSame(e.owner,t).same||(r=e,!1)}),r},getFusionOwnership:function(){var e=this,t=[];return e.options.odtMode&&this.AccessRightModelList.length>0&&(this.AccessRightModelList[0]._DataList[0]={owner:{comment:"-",person:{personID:"svc_qauser1_PRJ",personFullName:"Mr svc_qauser1",personFirstName:"Mr",personLastName:"svc_qauser1"},collabSpace:{collabSpaceID:"TestCollabSpace1"},organization:{orgID:"Company Name"}},access:{logical:"Basic"},inheritedPath:[]}),this.AccessRightModelList.forEach(function(n,r){var i=n.getDataList();if(0==r)i.forEach(function(e){t.push({ownership:e,isTrueComment:!0,inheritedPath:!0})});else{var a=[];t.forEach(function(t){element=t.ownership,i.every(function(n){if(element.access.logical==n.access.logical){var r=e.ownerAreSame(element.owner,n.owner);if(1==r.same){if(0==t.hasOwnProperty("isTrueComment")&&(t.isTrueComment=!0),0==r.sameComment&&(element.owner.comment=UWA.i18n("DifferentFromItem"),t.isTrueComment=!1),0==t.hasOwnProperty("isTrueInheritedPath")&&(t.isTrueInheritedPath=!0),1==t.isTrueInheritedPath){var i=!0;if(1==element.hasOwnProperty("inheritedPath")||1==n.hasOwnProperty("inheritedPath")?1==element.hasOwnProperty("inheritedPath")&&1==n.hasOwnProperty("inheritedPath")?((element.inheritedPath.length<=0||n.inheritedPath.length<=0)&&(t.isAllInherit=!1),i=e.inheritedPathAreSame(element.inheritedPath,n.inheritedPath)):i=!1:element.isAllInherit=!1,0==i){var o=[{inheritedFrom:{objectID:"undefined",objectTNR:UWA.i18n("DifferentFromItem")},inheritedAccess:{logical:UWA.i18n("DifferentFromItem")}}];element.inheritedPath=o}}return a.push(t),!1}}return!0})}),t=a}}),t},inheritedPathAreSame:function(e,t){var n=!0;if(e.length==t.length){var r=t.slice();e.every(function(e){var t=!1;return r.every(function(n,i){return e.inheritedFrom.objectID!=n.inheritedFrom.objectID||(r.splice(i,1),t=!0,!1)}),0!=t||(n=!1,!1)})}else n=!1;return n},ownerAreSame:function(e,t){var n=!0,r=!1;return(e.hasOwnProperty("person")||t.hasOwnProperty("person"))&&(e.hasOwnProperty("person")&&t.hasOwnProperty("person")?e.person.personID!=t.person.personID&&(n=!1):n=!1),(1==n&&e.hasOwnProperty("collabSpace")||t.hasOwnProperty("collabSpace"))&&(e.hasOwnProperty("collabSpace")&&t.hasOwnProperty("collabSpace")?e.collabSpace.collabSpaceID!=t.collabSpace.collabSpaceID&&(n=!1):n=!1),(1==n&&e.hasOwnProperty("organization")||t.hasOwnProperty("organization"))&&(e.hasOwnProperty("organization")&&t.hasOwnProperty("organization")?e.organization.orgID!=t.organization.orgID&&(n=!1):n=!1),(1==n&&e.hasOwnProperty("userGrp")||t.hasOwnProperty("userGrp"))&&(e.hasOwnProperty("userGrp")&&t.hasOwnProperty("userGrp")?e.userGrp.userGrpID!=t.userGrp.userGrpID&&(n=!1):n=!1),(1==n&&e.hasOwnProperty("group")||t.hasOwnProperty("group"))&&(e.hasOwnProperty("group")&&t.hasOwnProperty("group")?e.group.groupURI!=t.group.groupURI&&(n=!1):n=!1),(e.hasOwnProperty("comment")||t.hasOwnProperty("comment"))&&e.hasOwnProperty("comment")&&t.hasOwnProperty("comment")&&e.comment==t.comment&&(r=!0),{same:n,sameComment:r}},_accessListContainsAccess:function(e,t){var n=!1;0==e.length&&(n=!0);for(var r=0;r<e.length;r++)if(e[r].logical==t.logical){n=!0;break}return n},_accessListSame:function(e,t){if(returnedValue=!0,e.length!=t.length)returnedValue=!1;else{var n=t.slice(),r=!0;e.every(function(e){var t=!1;return n.every(function(r,i){return e.logical!=r.logical||(t=!0,n.splice(i,1),!1)}),0!=t||(r=!1,!1)}),0==r&&(returnedValue=!1)}return returnedValue},onLoad:function(){this.AccessRightModelList=[],this.widget=widget,this.AccessRightModelList=[],this.ECToParentMap=JSON.parse("[]"),this.IdToECMap=JSON.parse("[]"),this.SelectedItemsMap=JSON.parse("[]"),this.ExistingECItemsMap=JSON.parse("[]"),this.AggrItemsMap=JSON.parse("[]"),this.ErrorExistingECAndAggrItemsMap=JSON.parse("[]"),this.SelectedItems=[],this.SelectedItemsTypeMap=JSON.parse("[]"),this.NonEmbeddedComponentList=[],this._bInitDatas=!1},onRefresh:function(){var e=[];this.AccessRightModelList.forEach(function(t){e.push({objectID:t.getObjectId()})}),this.AccessRightModelList=[],this._addSelectedIdInList(e)},getCurrentSelectedItems:function(){var e=[];return this.AccessRightModelList.forEach(function(t){e.push({objectID:t.getObjectId()})}),e},isPovUserGroup:function(e,t){var n=this._getModel(e);return null!=n&&n.getUserGrpId()==t},_getModel:function(e){for(var t=0;t<this.AccessRightModelList.length;t++){var r=this.AccessRightModelList[t];if(r.getObjectId()==e)return r}var i=new n(e);return this.AccessRightModelList.push(i),i},flatten:function(e){var t=this;return e.reduce(function(e,n){return e.concat(Array.isArray(n)?t.flatten(n):n)},[])},parseResponse:function(e){let t=[];if(!UWA.is(e.collabspaces,"array"))return t;let n=[...new Set(this.flatten(e.collabspaces.map(e=>e.couples.map(e=>e.organization.name))))].length>1;return e.collabspaces.forEach(e=>{e.couples.forEach(r=>{var i=null==r.role.nls||""==r.role.nls?r.role.name:r.role.nls,a=r.role.name,o=r.organization.name,s=r.organization.title,c=e.name,l=e.title?e.title:e.name;let d=n?l+" ● "+s+" ● "+i:l+" ● "+i,h="ctx::"+a+"."+o+"."+c;t.push({displayName:d,ctx:h})})}),t.sort((e,t)=>e.displayName.localeCompare(t.displayName,void 0,{numeric:!0,sensitivity:"base"}))},_createFilterPayload:function(e,t){let n={Command:t,SecurityContexts:e.map(e=>e.ctx)};return JSON.stringify(n)},isAdminCred:function(e){let t=e.match(/(ctx::)([^.]+)/);return t.length>2&&"VPLMAdmin"===t[2]},adminFilterPatch:function(e){var t=this;return e.filter(e=>!t.isAdminCred(e))},filterCredentials:function(e,t,n,r,i){var a=this,o=a._createFilterPayload(t,n);a._perfTimer.start("Share: filterValidSCs"),this._post3("/resources/lifecycle/util/filterValidSCs",o,function(e){a._perfTimer.stop("Share: filterValidSCs"),e.status&&"success"===e.status&&r(a.adminFilterPatch(e.data))},function(e){a._perfTimer.stop("Share: filterValidSCs"),i(e)})},_loadCredentials:function(e,t,n){var r=this;r._perfTimer.start("Share: person"),this._get("/resources/modeler/pno/person",{current:"true",select:"collabspaces&select=preferredcredentials"},function(e){r._perfTimer.stop("Share: person"),t(r.parseResponse(e))},function(e){r._perfTimer.stop("Share: person"),n(e)})},_fillAttributesOfSelectedItems:function(e,t,n){for(var r=this,i=[],a=e.length,o=[],s=[],c=0;c<a;c++){var l="";null!=e[c].type&&(l=e[c].type),null==e[c].type&&null!=e[c].typeDisplayName&&(l=e[c].typeDisplayName),o.push(l),s.push(e[c].physicalId)}for(var d=s.length,h=0;h<d;h++){var p=s[h];i.push({objectID:p,type:o[h]})}var m=i;r._perfTimer.start("Share: isTypeSupportedToCommand"),this._post2("/resources/accessRightServices/ar/isTypeSupportedToCommand",m,function(e,n){r._perfTimer.stop("Share: isTypeSupportedToCommand"),t(e,n)},function(e){n(e)})},_setValidInvalidIdList(e,t){if(this.listOfValidIDs=e,0==this.listOfInvalidIDs.length)this.listOfInvalidIDs=t;else{this.listOfInvalidIDs.concat(t),this.listOfInvalidIDs=this.listOfInvalidIDs.filter((e,t,n)=>t===n.findIndex(t=>t===e))}},_fillModels:function(e){for(var t=this,n=e.length,r=0;r<n;r++){var i=e[r];if(null!==i){var a=t._getModel(i.physicalId);null!=a&&(t.IdToECMap[i.physicalId]=i.v_IsEmbeddedComponent,t.SelectedItemsMap[i.physicalId]=i,t.SelectedItemsTypeMap[i.type]=i,a.setPOV(i.owner+"_PRJ",i.project,i.organization),a.setObjectType(i.type))}}if(t.SelectedItems=e.splice(0),0==t._bInitDatas){var o=[];t._bInitDatas=!0,t.AccessRightModelList.forEach(function(e){t.NonEmbeddedComponentList.push(e.getObjectId()),o.push({objectID:e.getObjectId()})}),t._getAccessListForIds(o)}},_getSecurityContext:function(e,t){var n=this;o.getInstance().getSecurityContext({onSuccess:function(t){var r="";null!=t&&null!=t.SecurityContext&&0!=(r=t.SecurityContext).indexOf("ctx::")&&(r="ctx::"+r),""!=n.widgetSecurityContext?e(n.widgetSecurityContext):e(r)},onFailure:function(r){""!=n.widgetSecurityContext?e(n.widgetSecurityContext):t(r)}})},_post2:function(e,n,i,a){var o=this;datasString=t.encode({requests:n}),this._getSecurityContext(function(t){r.get3DSpaceUrlAsync({onComplete:function(n){var c=n+e,l={Accept:"application/json","Content-Type":"application/json"};l.SecurityContext=encodeURIComponent(t),l["Accept-Language"]=widget.lang;var d=r.getTenantID();d&&0!=d.length?c+="?tenant="+d:c+="?tenant=OnPremise",r.partitionedAuthenticatedRequest(c,{method:"POST",headers:l,timeout:864e5,cancelCallback:function(){return!1},partisionedProgressLabel:s.get(""),progressBarContext:o.options.contextArea1,progressBarWaitContext:o.options.progressBarWaitContext,data:datasString,type:"json",onComplete:function(e){i(e,n)},onFailure:function(e){a(e)},onTimeout:function(){a("timeout")}})},serverUrl:o.options.serverUrl,wintop:o.options.wintop})},function(e){a(e)})},_post:function(e,t,n,i){var a=this;this._getSecurityContext(function(o){r.get3DSpaceUrlAsync({onComplete:function(c){var l=c+e,d={Accept:"application/json","Content-Type":"application/json"};d.SecurityContext=encodeURIComponent(o);var h=r.getTenantID();h&&0!=h.length?l+="?tenant="+h:l+="?tenant=OnPremise",r.partitionedAuthenticatedRequest(l,{method:"POST",headers:d,timeout:864e5,cancelCallback:function(){return!1},partisionedProgressLabel:s.get("AR_RetrievingAttributes"),progressBarContext:a.options.contextArea1,progressBarWaitContext:a.options.progressBarWaitContext,data:UWA.Json.encode(t),type:"json",onComplete:function(e){n(e)},onFailure:function(e){i(e)},onTimeout:function(){i("timeout")}})},serverUrl:a.options.serverUrl,wintop:a.options.wintop})},function(e){i(e)})},_post3:function(e,t,n,i){var a=this;this._getSecurityContext(function(o){r.get3DSpaceUrlAsync({onComplete:function(c){var l=c+e,d={Accept:"application/json","Content-Type":"application/json"};d.SecurityContext=encodeURIComponent(o);var h=r.getTenantID();h&&0!=h.length?l+="?tenant="+h:l+="?tenant=OnPremise",r.partitionedAuthenticatedRequest(l,{method:"POST",headers:d,timeout:864e5,cancelCallback:function(){return!1},partisionedProgressLabel:s.get(""),progressBarContext:a.options.contextArea1,progressBarWaitContext:a.options.progressBarWaitContext,data:t,type:"json",onComplete:function(e){n(e)},onFailure:function(e){i(e)},onTimeout:function(){i("timeout")}})},serverUrl:a.options.serverUrl,wintop:a.options.wintop})},function(e){i(e)})},_get:function(e,t,n,i){var o=this;this._getSecurityContext(function(i){r.get3DSpaceUrlAsync({onComplete:function(s){var l=s+e,d={Accept:"application/json","Content-Type":"application/json"};d.SecurityContext=encodeURIComponent(i);var h=r.getTenantID();h&&0!=h.length?l+="?tenant="+h:l+="?tenant=OnPremise",t.hasOwnProperty("current")&&t.hasOwnProperty("select")&&(l+="&current="+t.current+"&select="+t.select);var p="";2==c&&(p="passport"),a.authenticatedRequest(l,{type:"json",method:"GET",headers:d,proxy:p,data:"",onComplete:function(e){n(e)},onFailure:function(e,t,n){o._onFailureAvailability(e,t,n)},onTimeout:function(){o._onTimeoutAvailability(items)}})},serverUrl:o.options.serverUrl,wintop:o.options.wintop})},function(e){i(e)})},_addSelectedIdInList:function(e){var n=this;this.options.serverName,this.options.serverUri;this._getSecurityContext(function(i){r.get3DSpaceUrlAsync({onComplete:function(a){var o="",l=r.getRealPath("assets/dataRightList.json",n.widget),d="GET",h="";2==c&&(h="passport");var p="Share: pno logicalaccess";2==c&&(o='{ "businessObject": '+t.encode(e)+"}",n.options.hasOwnProperty("odtmode")&&n.options.odtmode?(l=a+"/resources/pno/ownership/logicalaccess",p="Share: pno logicalaccess"):e.length>0&&0===e[0].objectID.indexOf("cid:")?(l=a+"/resources/lifecycle/ownership/logicalaccess",p="Share: lifecycle logicalaccess"):(l=a+"/resources/pno/ownership/logicalaccess",p="Share: pno logicalaccess"),d="POST"),headers={Accept:"application/json"},headers["Content-Type"]="application/json",headers["Accept-Language"]=widget.lang,headers.SecurityContext=encodeURIComponent(i),n.RightList=[];var m=r.getTenantID();m&&0!=m.length?l+="?tenant="+m:l+="?tenant=OnPremise",n._perfTimer.start(p),r.partitionedAuthenticatedRequest(l,{type:"json",method:d,headers:headers,proxy:h,timeout:864e5,cancelCallback:function(){return!1},partisionedProgressLabel:s.get(""),progressBarContext:n.options.contextArea1,progressBarWaitContext:n.options.progressBarWaitContext,data:o,onComplete:function(t){n._perfTimer.stop(p),n._onCompleteRightList(t,e)},onFailure:function(e,t,r){n._perfTimer.stop(p),n._onFailure(e,t,r)},onTimeout:function(){n._perfTimer.stop(p),n._onTimeout()}})},serverUrl:n.options.serverUrl,wintop:n.options.wintop})},function(e){onError(e)})},_onFailure2:function(e){this.dispatchEvent("onError2",e)},_onFailure:function(e,t,n){var r={};r=null!=t&&t.hasOwnProperty("error")?t.error:{message:UWA.i18n("UnknownError"),code:"ERROR"},this.dispatchEvent("onError",r)},_onTimeout:function(){var e={message:UWA.i18n("ErrorTimeOut"),code:"TO"};this.dispatchEvent("onError",e)},_onCompleteRightList:function(e,t){var n=this,r=e.accessList,i=null,a=[];t.forEach(function(e){var t=n._getModel(e.objectID);a.push(t)});var o=-1,s=-1;r.every(function(e,t){var r=!1;if(a.every(function(t,n){return s=n,t.getObjectId()!=e.objectID||(t.setRightList(e.access),r=!0,!1)}),1==r&&1==n.options.uniqueRightList){var c=!0;if(0==n.AccessRightModelList.length&&t>0&&o>=0?c=n._accessListSame(a[o].getRightList(),e.access):n.AccessRightModelList.length>0&&(c=n._accessListSame(n.AccessRightModelList[0].getRightList(),e.access)),0==c){for(var l=!0,d={logical:"Reader",nls:"Can Read"},h={logical:"Read",nls:"Read"},p=n._accessListContainsAccess(n.AccessRightModelList[0].getRightList(),d),m=n._accessListContainsAccess(n.AccessRightModelList[0].getRightList(),h),u=0;u<n.AccessRightModelList.length;u++)p?0==n._accessListContainsAccess(n.AccessRightModelList[u].getRightList(),d)&&(l=!1):m&&0==n._accessListContainsAccess(n.AccessRightModelList[u].getRightList(),h)&&(l=!1);return i={message:UWA.i18n("ErrorDismatchAccessList"),code:""},l?n.dispatchEvent("onWarning",i):n.dispatchEvent("onError",i),n.dispatchEvent("onDataLoaded"),!1}o=s}return!0})},_getAccessListForIds:function(e){var n=this,i=[];if(null!=n.SelectedItemsTypeMap){Object.keys(n.SelectedItemsTypeMap).map(function(e){return n.SelectedItemsTypeMap[e]}).forEach(function(e){null!=e&&i.push({objectID:e.physicalId})})}this.options.serverName,this.options.serverUri;this._getSecurityContext(function(a){r.get3DSpaceUrlAsync({onComplete:function(o){var l="",d=r.getRealPath("assets/dataRightList.json",n.widget),h="GET",p="";2==c&&(p="passport");var m="";2==c&&(l='{ "businessObject": '+t.encode(i)+"}",n.options.hasOwnProperty("odtmode")&&n.options.odtmode?(d=o+"/resources/pno/ownership/logicalaccess",m="Share: pno logicalaccess"):i.length>0&&0===i[0].objectID.indexOf("cid:")?(d=o+"/resources/lifecycle/ownership/logicalaccess",m="Share: lifecycle logicalaccess"):(d=o+"/resources/pno/ownership/logicalaccess",m="Share: pno logicalaccess"),h="POST"),headers={Accept:"application/json"},headers["Content-Type"]="application/json",headers["Accept-Language"]=widget.lang,headers.SecurityContext=encodeURIComponent(a),n.RightList=[];var u=r.getTenantID();u&&0!=u.length?d+="?tenant="+u:d+="?tenant=OnPremise",n._perfTimer.start(m),r.partitionedAuthenticatedRequest(d,{type:"json",method:h,headers:headers,proxy:p,cancelCallback:function(){return!1},partisionedProgressLabel:s.get(""),progressBarContext:n.options.contextArea1,progressBarWaitContext:n.options.progressBarWaitContext,data:l,timeout:864e5,onComplete:function(t){n._perfTimer.stop(m),n._onCompleteGetAccessListForIds(t,e)},onFailure:function(e,t,r){n._perfTimer.stop(m),n._onFailure(e,t,r)},onTimeout:function(){n._perfTimer.stop(m),n._onTimeout()}})},serverUrl:n.options.serverUrl,wintop:n.options.wintop})},function(e){onError(e)})},_onCompleteGetAccessListForIds:function(e,t){var n=this,r=e.accessList,i=null,a=[],o=-1,s=-1;r.every(function(e,t){e.access.forEach(function(e){n.accessLogicalNlsMap[e.logical]=e.nls});var r=e.objectID,c=n.SelectedItemsMap[r],l=null;if(null!=c&&(l=c.type),n.AccessRightModelList.every(function(t,n){return s=n,t.getObjectType()!=l||(t.setRightList(e.access),itemFound=!0,!1)}),3==e.access.length&&n.LifecycleConfidentialityEnabled?(n._options.parent.container.parentElement.getParent().getParent().getParent().setStyle("height","400px"),n._options.parent.container.parentElement.setStyle("height","72.5%")):e.access.length>3&&(n._options.parent.container.parentElement.getParent().getParent().getParent().setStyle("height","450px"),n._options.parent.container.parentElement.setStyle("height","76%")),1==itemFound&&1==n.options.uniqueRightList){var d=!0;if(0==n.AccessRightModelList.length&&t>0&&o>=0?d=n._accessListSame(a[o].getRightList(),e.access):n.AccessRightModelList.length>0&&(d=n._accessListSame(n.AccessRightModelList[0].getRightList(),e.access)),0==d){for(var h=!0,p={logical:"Reader",nls:"Can Read"},m={logical:"Read",nls:"Read"},u=n._accessListContainsAccess(n.AccessRightModelList[0].getRightList(),p),g=n._accessListContainsAccess(n.AccessRightModelList[0].getRightList(),m),f=0;f<n.AccessRightModelList.length;f++)u?0==n._accessListContainsAccess(n.AccessRightModelList[f].getRightList(),p)&&(h=!1):g&&0==n._accessListContainsAccess(n.AccessRightModelList[f].getRightList(),m)&&(h=!1);return i={message:UWA.i18n("ErrorDismatchAccessList"),code:""},h?n.dispatchEvent("onWarning",i):n.dispatchEvent("onError",i),n.dispatchEvent("onDataLoaded"),!1}o=s}return n.dispatchEvent("onDataLoaded"),!0})},parseDataForRequest:function(e){for(var t=[],n=0;n<e.length;n++)if(null!=e[n].physicalId){e[n].physicalId,e[n].category;t.push(e[n].physicalId)}return t},_onCompleteDataList:function(e){var t=this;1==e.success?(e.ownershipVector.forEach(function(e){t.AccessRightModelList.every(function(t){return t.getObjectId()!=e.objectID||(t.setDataList(e.ownership),!1)})}),t.dispatchEvent("onDataLoaded")):e.hasOwnProperty("error")&&t.dispatchEvent("onError",e.error)},modifyDataWithSC:function(e,n,i){var a=this,o={Accept:"application/json","Content-Type":"application/json"};if(null!=i&&""!=i&&i.hasOwnProperty("SecurityContext")){0!=i.SecurityContext.indexOf("ctx::")&&"ctx::",o.SecurityContext=encodeURIComponent(i.SecurityContext);var s=a.getAggrItemList();if(e.length>0&&null!=s){var l=[],d=Object.keys(s);e.length>0&&d.forEach(function(t){var n={objectID:t,ownership:e[0].ownership};l.push(n),e.push(n)})}this.options.serverName,this.options.serverUri;for(var h=[],p=0;p<n.length;p++)h.indexOf(n[p])<0&&h.push(n[p]);r.get3DSpaceUrlAsync({onComplete:function(n){var s="POST",l="",d=r.getRealPath("assets/validModification.json",a.widget),p=t.encode({requests:h});2==c&&(l="passport");2==c&&(d=n+"/resources/accessRightServices/ar/getCompletedData",s="POST"),o["Accept-Language"]=widget.lang;var m=r.getTenantID();m&&0!=m.length?d+="?tenant="+m:d+="?tenant=OnPremise",a._perfTimer.start("Share: getCompletedData"),r.partitionedAuthenticatedRequest(d,{type:"json",method:s,proxy:l,headers:o,cancelCallback:function(){return!1},data:p,timeout:36e5,onComplete:function(t){a._perfTimer.stop("Share: getCompletedData");for(var n=0;n<t.results.length;n++)if(null!=t.results[n].invalidList&&t.results[n].invalidList.length>0){t.results[n].invalidList.forEach(function(t){void 0!==a.SelectedItemsMap[t]&&null!==a.SelectedItemsMap[t]&&(a.ErrorExistingECAndAggrItemsMap[t]=a.SelectedItemsMap[t]);for(var n=0;n<e.length;n++)e[n].objectID===t&&e.splice(n,1)})}else if(null!=t.results[n].validList&&t.results[n].validList.length>0){var r=[];r=t.results[n].validList,expandedOwnershipItems=[],r.forEach(function(t){null!=a.SelectedItemsMap[t]&&null!==a.SelectedItemsMap[t]||null!=a.AggrItemsMap[t]&&null!==a.AggrItemsMap[t]||e.length>0&&expandedOwnershipItems.push({objectID:t,ownership:e[0].ownership})}),expandedOwnershipItems.forEach(function(t){e.push(t)})}e.length<1?a._onFailure2(UWA.i18n("ShareNotValid")):a.getAndAddAggregatedItemsForUpdate(e,i)},onFailure:function(e,t,n){a._perfTimer.stop("Share: getCompletedData"),a._onFailure(e,t,n),a._perfTimer.stop("CommandExecutionDurationShare"),a._perfTimer.printTime("CommandUIDurationShare"),a._perfTimer.printTime("CommandExecutionDurationShare"),a._perfTimer.printTime("Share: getCompletedData")},onTimeout:function(){a._perfTimer.stop("Share: getCompletedData"),a._onTimeout(),a._perfTimer.stop("CommandExecutionDurationShare"),a._perfTimer.printTime("CommandUIDurationShare"),a._perfTimer.printTime("CommandExecutionDurationShare"),a._perfTimer.printTime("Share: getCompletedData")}})},serverUrl:a.options.serverUrl,wintop:a.options.wintop})}else{var m={message:UWA.i18n("ErrorSecurityContextEmpty"),code:"ERROR"};a.dispatchEvent("onError",m)}},getAndAddAggregatedItemsForUpdate:function(e,t){this.commitWithSCPCS(e,t)},commitWithSCPCS:function(e,n){var i=this,a={Accept:"application/json","Content-Type":"application/json"};if(null!=n&&""!=n&&n.hasOwnProperty("SecurityContext")){0!=n.SecurityContext.indexOf("ctx::")&&"ctx::",a.SecurityContext=encodeURIComponent(n.SecurityContext);this.options.serverName,this.options.serverUri;this._getSecurityContext(function(n){r.get3DSpaceUrlAsync({onComplete:function(o){var s="",l=r.getRealPath("assets/validModification.json",i.widget),d="Share: pno update";2==c&&(s="passport"),2==c&&(i.options.hasOwnProperty("odtmode")&&i.options.odtmode?l=o+"/resources/pno/ownership/update":e.length>0&&0===e[0].objectID.indexOf("cid:")?(l=o+"/resources/lifecycle/ownership/update",d="Share: lifecycle update"):l=o+"/resources/pno/ownership/update");var h='{ "ownershipVector": '+t.encode(e)+"}";console.log("<<<<<<<<<<< Data to send = "+h);a["Accept-Language"]=widget.lang,a.SecurityContext=encodeURIComponent(n);var p=r.getTenantID();p&&0!=p.length?l+="?tenant="+p:l+="?tenant=OnPremise",i._perfTimer.start(d),r.partitionedAuthenticatedRequest(l,{type:"json",method:"POST",proxy:s,headers:a,cancelCallback:function(){return!1},data:h,timeout:864e5,onComplete:function(t){i._perfTimer.stop(d),!0===i._options.odtMode?null!==i.options.parent&&i.options.parent.ODTModificationComplete(t):i.dispatchEvent("onModificationComplete",t);var n={ov:e};i.dispatchEvent("fireWintopNotif",n)},onFailure:function(e,t,n){i._perfTimer.stop(d),i._onFailure(e,t,n),i._perfTimer.stop("CommandExecutionDurationShare"),i._perfTimer.printTime("CommandUIDurationShare"),i._perfTimer.printTime("CommandExecutionDurationShare"),i._perftime.printTime(d)},onTimeout:function(){i._perfTimer.stop(d),i._onTimeout(),i._perfTimer.stop("CommandExecutionDurationShare"),i._perfTimer.printTime("CommandUIDurationShare"),i._perfTimer.printTime("CommandExecutionDurationShare"),i._perfTimer.printTime(d)}})},serverUrl:i.options.serverUrl,wintop:i.options.wintop})},function(e){onError(e)})}else{var o={message:UWA.i18n("ErrorSecurityContextEmpty"),code:"ERROR"};this.setError(o)}},getSelectedItemList:function(){return this.SelectedItems},getErrorSelectedItemList:function(){return this.ErrorExistingECAndAggrItemsMap},getAggrItemList:function(){return this.AggrItemsMap},fillInvalidList:function(e){for(var t=e.length,n=0;n<t;n++){var r=e[n];this.listOfInvalidIDs[n]=r}},getInvalidList:function(){return this.listOfInvalidIDs}})}),define("DS/ShareWidget/ShareWidget",["UWA/Core","UWA/Controls/Input","DS/UIKIT/Image","UWA/Controls/Abstract","UWA/Json","DS/WAFData/WAFData","DS/SearchWidget/SearchWidget","DS/SearchWidget/SearchWidgetConstant","DS/ErrorWidget/ErrorWidget","DS/DataGridWidget/DataGridWidget","DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/WidgetServices/CollabPerfTimer","DS/WarningWidget/WarningWidget","DS/ShareWidget/ShareController","DS/UIKIT/Input/Button","DS/UIKIT/Input/Select","DS/UIKIT/Spinner","DS/UIKIT/Input/ButtonGroup","DS/Logger/Logger","DS/WebToWinInfra/WebToWinCom","DS/Controls/Toggle","DS/UIKIT/Input/Text","UWA/Event","DS/ReportingPanel/ReportingPanel","DS/ENOCollabToolsUI/tracker/ENOCollabTracker","css!DS/ShareWidget/ShareWidget.css","i18n!DS/ShareWidget/assets/nls/langAR"],function(e,t,n,r,i,a,o,s,c,l,d,h,p,m,u,g,f,S,v,y,A,C,_,I,b,w,E,R){"use strict";UWA.debug=!0;var D=d.getProdLevel();return r.extend({defaultOptions:{className:"",ForbiddenChar:'"#$@%*,?\\<>[]|:',setValidButton:!0,setCloseButton:!0,showTopBar:!0,wintop:!1,topClassHeight:"SH_MasterContain",readOnly:"auto",displayWarningForAutoRO:!1,serverName:"",serverUri:"",activeMultisel:!0,activeComment:!1,serverUrl:""},init:function(e,t,n){if(this._parent(n),1==this.options.wintop&&(this.webToWinCom_Socket=A.createSocket({socket_id:"webinwinAccessRights_socket_"+Math.floor(1e5*Math.random()+1)}),void 0!==this.options.serverUrl&&this.options.serverUrl.length>0&&void 0!==this.options.serverUrl[0].platformId)){var r=this.options.serverUrl[0].platformId;d.setTenantID(r)}this.widgetSecurityContext={},this._perfTimer=p,this._perfTimer.init("Share"),this._perfTimer.start("CommandUIDurationShare");var i="";if(null!=e){if(e.hasOwnProperty("pad_security_ctx"))0!=(i=e.pad_security_ctx).indexOf("ctx::")&&(i="ctx::"+i);else if("function"==typeof e.hasPreference&&null!=e.getPreference("pad_security_ctx"))i=e.getPreference("pad_security_ctx").value;else if("function"==typeof e.hasPreference&&e.hasPreference("xPref_CREDENTIAL")){var a=e.getPreference("xPref_CREDENTIAL");void 0!==a.value&&null!==a.value&&a.hasOwnProperty("value")&&(i="ctx::"+a.value)}else"function"==typeof e.hasPreference&&null!=e.getPreference("securityContext")&&(i=e.getPreference("securityContext").value);i.length>0&&(this.widgetSecurityContext={SecurityContext:i})}this.isODT=!1,void 0!==typeof this.options&&null!==this.options&&this.options.hasOwnProperty("odtmode")&&(this.isODT=this.options.odtmode),D=d.getProdLevel(),this.options.activeMultisel=this.options.activeMultisel||d.isMultiSelODT(),this.options.activeComment=this.options.activeComment||d.isCommentODT(),this._initDataStructures(),this.isReadOnly=!1,this.listID=[],this.listOfIds=[],this.listOfAddedMembers=[],this.listOfPrivateProjects=[],this.listOfValidIDs=[],this.listOfInvalidIDs=[],this.arDone=!1,!0===this.options.readOnly&&(this.isReadOnly=!0),this.widget=e,this.parentWidget=t,this.SearchWidget_View=[];var o=UWA.i18n("AR_Status"),s=UWA.i18n("AR_Title"),c=UWA.i18n("AR_Sum_Type"),l=UWA.i18n("AR_Revision"),h=UWA.i18n("AR_Sum_Org"),m=UWA.i18n("AR_Sum_Collab"),u=UWA.i18n("AR_Sum_Resp"),g=UWA.i18n("AR_Result");this.cols=[{text:"ID",dataIndex:"ID",isHidden:!0},{text:"StatusToolTipColumn",dataIndex:"statusTooltip",isHidden:!0,tooltipColumn:"Status"},{text:o,dataIndex:"Status",typeRepresentation:"icon"},{text:s,dataIndex:s},{text:c,dataIndex:c},{text:l,dataIndex:l},{text:h,dataIndex:h},{text:m,dataIndex:m},{text:u,dataIndex:u},{text:g,dataIndex:g}],this.initUI(),this._perfTimer.stop("CommandUIDurationShare"),this.trackerEventBeginTime=Date.now()},_initDataStructures:function(){this.objectIds={},this.listOfError=[],this.SelectedItemsWithEC=[],this.ctxObjectIds=[],this.SelectedItems=[],this.dumpSection=null,this.firstInit=!0,this.arDone=!1,this._bAddUserError=!1,this.listInputErrors=[],this.listInvalidPovOwnerErrorMsg=[],this.listInvalidPovCollabSpaceErrorMsg=[],this.containsInheritedAccess=!1,this.csoTableLines=[],void 0===this.commentBox&&(this.commentBox=null),void 0===this.textArea&&(this.textArea=null)},createWebInWinSocket:function(e){return A.createSocket({socket_id:e+Math.floor(1e5*Math.random()+1)})},fireWintopCommand:function(e,t,n){var r=[],i=n+"\n",a=[];if("onModificationAccessRights"===n){var o=null;t.hasOwnProperty("ov")&&(o=t.ov),o.forEach(function(e,t){e.hasOwnProperty("ownership")&&(a.indexOf(e.objectID)<0&&(a.push(e.objectID),e.ownership.forEach(function(e,t){var n,r=e.operation,a=e.access.logical;e.owner.hasOwnProperty("person")?n=e.owner.person.personID:e.owner.hasOwnProperty("collabSpace")&&(n=e.owner.collabSpace.collabSpaceID),i=i+" "+r+" "+a+" "+n+"\n"}),r.push(i)))})}var s={severity:"warning",ID:a,message:r},c=A.createJSONArrayMessage(n,s);c.length>0&&e.dispatchEvent("onDispatchToWin",{notif_name:"onDisplayMessageODT",notif_parameters:c},"lf_web_in_win")},initData:function(e){this.trackAppContent(e),this.SelectedItems=[],this._initDataStructures(),this.ShareController.onLoad(),this.addDataPCS(e),this.getPrivateProjectList()},initDatafromWin:function(e){this.initData(e)},getPrivateProjectList:function(){var e=this;h.getInstance().getSecurityContext({onSuccess:function(t){e.widgetSecurityContext.hasOwnProperty("SecurityContext")?e.getListOfPrivateCS(e.widgetSecurityContext):e.getListOfPrivateCS(t)},onFailure:function(t){e.widgetSecurityContext.hasOwnProperty("SecurityContext")?e.getListOfPrivateCS(e.widgetSecurityContext):e.setError(t)}})},addDataPCS:function(e){var t=this;null==e&&(e=this.SelectedItems),"auto"==this.options.readOnly?h.getInstance().getSecurityContext({onSuccess:function(n){t.SelectedItemsList=e,0===e[0].physicalId.toString().indexOf("cid:")?t.widgetSecurityContext.hasOwnProperty("SecurityContext")?t._testAvailability(e,t.widgetSecurityContext):t._testAvailability(e,n):t.widgetSecurityContext.hasOwnProperty("SecurityContext")?t._doShareChecker(e,t.widgetSecurityContext):t._doShareChecker(e,n)},onFailure:function(n){t.widgetSecurityContext.hasOwnProperty("SecurityContext")?0===e[0].physicalId.toString().indexOf("cid:")?t._testAvailability(e,t.widgetSecurityContext):t._doShareChecker(e,t.widgetSecurityContext):t.setError(n)}}):this._addDataPCS(e)},_addDataPCS:function(e){this._ManageValidButton(!1),this.hideMainErrorArea();var t=[],n=this;if(1==this.options.activeMultisel?(null!=e&&(t=e.slice()),d.removeDuplicate(t,function(e){return e.physicalId}),t.forEach(function(e){d.arrayContains(n.SelectedItems,e,function(e){return e.physicalId})<0&&n.SelectedItems.push(e)})):null!=e&&e.length>0&&(n.SelectedItems=[],n.SelectedItems.push(e[0]),t.push(e[0])),n.SelectedItems.length<=0)return 1==this.options.wintop?this.showMainErrorArea(UWA.i18n("NoItemToDisplay")):this.showMainErrorArea(UWA.i18n("NoItemSelected")),this.hideMainLoadingArea(),this.hideMainComponent(),void n.dispatchEvent("onChangeSize");this.displayLoadingArea();n.SelectedItems.length>0&&(this.options.hasOwnProperty("odtmode")&&(this.ShareController.options.odtmode=this.options.odtmode),this.ShareController._fillAttributesOfSelectedItems(n.SelectedItems,function(e,t){for(var r=0;r<e.results.length;r++)e.results[r].validList.length>0&&(n.listOfValidIDs=n.listOfValidIDs.concat(e.results[r].validList)),e.results[r].invalidList.length>0&&(n.listOfInvalidIDs=n.listOfInvalidIDs.concat(e.results[r].validList));if(e.hasOwnProperty("CommandAvailability")&&!1===e.CommandAvailability)n.isReadOnly=!0,n.addError(UWA.i18n("SH_PLM_SecurityDenied")),n._updateReadOnlyDisplay();else if(0==n.listOfValidIDs.length)n.isReadOnly=!0,n.addError(UWA.i18n("ShareNotSupported")),n._updateReadOnlyDisplay();else if(n.listOfInvalidIDs.length>0){for(var i="",a=0;a<n.listOfInvalidIDs.length;a++)for(var o=0;o<n.SelectedItems.length;o++)n.listOfInvalidIDs[a]===n.SelectedItems[o].physicalId&&(null==n.SelectedItems[o].name&&null==n.SelectedItems[o].name||(i=n.SelectedItems[o].name),n.SelectedItems.splice(o,1));1==n.listOfInvalidIDs.length?0!=i.length?n.addError(UWA.i18n("ShareNotSupportedFor{0}").format(i)):n.addError(UWA.i18n("ShareNotSupportedForSomeObjects{0}").format(n.listOfInvalidIDs.length)):n.listOfInvalidIDs.length>1&&n.addError(UWA.i18n("ShareNotSupportedForSomeObjects{0}").format(n.listOfInvalidIDs.length))}n.ShareController._setValidInvalidIdList(n.listOfValidIDs,n.listOfInvalidIDs),n.ShareController._fillModels(n.SelectedItems)},function(e){}))},hideElements:function(e,t){for(var n=e.getElements(t),r=n.length,i=0;i<r;i++){n[i].hide()}},showElements:function(e,t){for(var n=e.getElements(t),r=n.length,i=0;i<r;i++){n[i].show()}},destroy:function(){this.searchWidget&&this.searchWidget.destroy(),this._parent()},addSearchBox:function(e,t){var n=this,r=n.listOfAddedMembers.length;e="  "+e;var i=UWA.createElement("span",{id:"addedItem"+r,class:"SH_AddedItemContainer"}),a=UWA.createElement("span",{class:"SH_TextForItemContainer",text:e}).inject(i);UWA.createElement("span",{id:r,class:"SH_TextForItemContainer",text:"x"}).inject(a).addEventListener("click",function(){i.setStyle("display","none"),n.DeleteUser(this.id)}),"Viewer"===t?(n.showMember_CanView.show(),i.inject(n.showMember_CanView)):"Reader"===t?(n.showMember_CanRead.show(),i.inject(n.showMember_CanRead)):"Owner"===t?(n.showMember_CanManage.show(),i.inject(n.showMember_CanManage)):"Author"===t?(n.showMember_CanEdit.show(),i.inject(n.showMember_CanEdit)):"CanAddRemoveAttachments"===t?(n.showMember_CanAddRemoveAttachment.show(),i.inject(n.showMember_CanAddRemoveAttachment)):"Read"===t?(n.showMember_Read.show(),i.inject(n.showMember_Read)):"Add"===t?(n.showMember_Add.show(),i.inject(n.showMember_Add)):"Basic"===t?(n.showMember_Basic.show(),i.inject(n.showMember_Basic)):"ReadWrite"===t?(n.showMember_ReadWrite.show(),i.inject(n.showMember_ReadWrite)):"Remove"===t?(n.showMember_Remove.show(),i.inject(n.showMember_Remove)):"AddRemove"===t?(n.showMember_AddRemove.show(),i.inject(n.showMember_AddRemove)):"Full"===t?(n.showMember_Full.show(),i.inject(n.showMember_Full)):"Leader"===t?(n.showMember_Leader.show(),i.inject(n.showMember_Leader)):"Project Member"===t?(n.showMember_Member.show(),i.inject(n.showMember_Member)):"Project Lead"===t&&(n.showMember_ProjectLead.show(),i.inject(n.showMember_ProjectLead))},getSearchInput:function(e){var t=this;return o.getSearchWidget(o.RESTRICTED,{className:"share-item-view-wrapper",id:e,ForbiddenChar:this.options.ForbiddenChar,MaxNumber:"5",MaxSize:"300",topClassHeight:this.options.topClassHeight,position:"auto",serverName:this.options.serverName,serverUri:this.options.serverUri,serverUrl:this.options.serverUrl,exttype:s.EXTTYPE_USERGRP,showEmptyCategory:!1,hint:UWA.i18n("SearchPlaceHolder"),PrivateProjectList:t.listOfPrivateProjects,events:{onValid:function(){t.AddUser(e)&&(t._ManageValidButton(!0),1==t.options.activeComment&&t.searchComment.show(),t.addSearchBox(this.searchInput.getValue(),this.options.id),t.dispatchEvent("onChangeSize")),this.searchInput.setValue("")},onUnvalid:function(){1==t.options.activeComment&&t.searchComment.hide(),t.dispatchEvent("onChangeSize")},onError:function(e){t.setError(e)}}})},initUI:function(){var e=this,t=this.container=UWA.createElement("div",{name:"SH_MasterContain","data-rec-id":"SH_MasterContain",class:"SH_MasterContain "+e.options.className});this.globalDiv=UWA.createElement("div",{class:"SH_GlobalContain","data-rec-id":"datarecGlobalContain"}).inject(t);var n="SH_ManageButtonDiv";this.options.wintop&&(n="SH_ManageButtonDivWintop"),this.ManageButtonDiv=UWA.createElement("table",{class:n,"data-rec-id":"datarecManageButtonDiv",html:{}}),e.ManageButtonRight=UWA.createElement("td",{class:"SH_ManageButtonRight","data-rec-id":"datarecManageButtonRight"}),e.ManageButtonLeft=UWA.createElement("td",{class:"SH_ManageButtonLeft","data-rec-id":"datarecManageButtonLeft"}),e.loadingArea=new S({visible:!1});var r=null;e.boutonValid=new g({attributes:{title:UWA.i18n("")},name:"TopButtonValid",value:UWA.i18n("AR_mainTile"),className:"default medium AR_buttonTop primary",disabled:!0});var i=e.boutonValid.getContent();null!=i&&i.setAttribute("data-rec-id","boutonValid"),r=new g({attributes:{title:UWA.i18n(""),"data-rec-id":"datarecButtonCancel"},name:"TopButtonCancel",value:UWA.i18n("AR_CloseOverlay"),className:"default medium AR_buttonTop"}),e.boutonValid.addEvents({onClick:function(){e._perfTimer.start("CommandExecutionDurationShare"),e._ManageValidButton(!1),e.displayLoadingArea(),e.modifyDataPCS(),r.setValue(UWA.i18n("AR_Close"))}}),r.addEvents({onClick:function(){e._ManageValidButton(!1),e.dispatchEvent("onCancel"),e._perfTimer.printTime("CommandUIDurationShare")}}),e.loadingArea.inject(e.ManageButtonRight),e.mainInterface=UWA.createElement("div",{class:"SH_MainInterface","data-rec-id":"datarecMainInterface"}).inject(this.globalDiv).hide(),0==this.isReadOnly&&1==e.options.setValidButton&&e.boutonValid.inject(e.ManageButtonRight),1==e.options.setCloseButton&&r.inject(e.ManageButtonRight),e.ManageButtonLeft.inject(this.ManageButtonDiv),e.ManageButtonRight.inject(this.ManageButtonDiv),e.options.showTopBar&&this.ManageButtonDiv.inject(e.globalDiv),e.mainInterface=UWA.createElement("div",{class:"SH_MainInterface","data-rec-id":"datarecMainInterface"}).inject(this.globalDiv).hide(),e.mainLoading=UWA.createElement("div",{class:"SH_MainLoading","data-rec-id":"datarecMainLoading"}).inject(this.globalDiv),e.mainError=UWA.createElement("div",{class:"SH_MainError","data-rec-id":"datarecMainError"}).inject(this.globalDiv).hide(),e.copyLink=new _({placeholder:"link",rows:1}),e.copyLink.inject(this.globalDiv).hide(),e.addMemberPanel=UWA.createElement("div",{class:"shareaddmember-item-view-container expanded"}).inject(e.mainLoading),e.memberPanel=UWA.createElement("div",{class:"shareaddmember-item-view-body","data-rec-id":"datarecMemberPanel"}).inject(e.addMemberPanel),e.addMemberPanel=UWA.createElement("div",{class:"share-item-view-container highlighted","data-rec-id":"c10"}).inject(e.memberPanel),e.tableAddMember=UWA.createElement("table").inject(e.addMemberPanel),e.addMEmberContainer=UWA.createElement("tbody").inject(e.tableAddMember);e.options.ForbiddenChar;this.searchIconArr=[],e.canView=UWA.createElement("tr",{class:"tr-canView"}).inject(e.addMEmberContainer),e.canViewTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.canView),e.canViewLabel=UWA.createElement("span",{id:"canView-label",text:R.get("CanView")}).inject(e.canViewTD),e.canViewHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("CanViewHelp")}).inject(e.canViewTD),e.canViewLabel.setStyle("text-align","left"),e.canViewLabel.setStyle("font-family","arial"),e.canViewLabel.setStyle("font-size","12px"),e.canViewSearchTD=UWA.createElement("td").inject(e.canView),e.showMember_CanView=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Viewer"}).inject(e.canViewSearchTD).hide(),e.searchWidget_CanView=e.getSearchInput("Viewer").inject(e.canViewSearchTD),e.searchWidget_CanView.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.canRead=UWA.createElement("tr",{class:"tr-canRead"}).inject(e.addMEmberContainer),e.canReadTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.canRead),e.canReadLabel=UWA.createElement("span",{id:"canRead-label",text:R.get("CanRead")}).inject(e.canReadTD),e.canReadHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("CanReadHelp")}).inject(e.canReadTD),e.canReadLabel.setStyle("text-align","left"),e.canReadLabel.setStyle("font-family","arial"),e.canReadLabel.setStyle("font-size","12px"),e.canReadSearchTD=UWA.createElement("td").inject(e.canRead),e.showMember_CanRead=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Reader"}).inject(e.canReadSearchTD).hide(),e.searchWidget_CanRead=e.getSearchInput("Reader").inject(e.canReadSearchTD),e.searchWidget_CanRead.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.canEdit=UWA.createElement("tr",{class:"tr-canEdit"}).inject(e.addMEmberContainer),e.canEditTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.canEdit),e.canEditLabel=UWA.createElement("span",{id:"canEdit-label",text:R.get("CanEdit")}).inject(e.canEditTD),e.canEditHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("CanEditHelp")}).inject(e.canEditTD),e.canEditLabel.setStyle("text-align","left"),e.canEditLabel.setStyle("font-family","arial"),e.canEditLabel.setStyle("font-size","12px"),e.canEditSearchTD=UWA.createElement("td").inject(e.canEdit),e.showMember_CanEdit=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Author"}).inject(e.canEditSearchTD).hide(),e.searchWidget_CanEdit=e.getSearchInput("Author").inject(e.canEditSearchTD),e.searchWidget_CanEdit.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.canManage=UWA.createElement("tr",{class:"tr-canManage"}).inject(e.addMEmberContainer),e.canManageTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.canManage),e.canManageLabel=UWA.createElement("span",{id:"canManage-label",text:R.get("CanManage")}).inject(e.canManageTD),e.canManageHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("CanManageHelp")}).inject(e.canManageTD),e.canManageLabel.setStyle("text-align","left"),e.canManageLabel.setStyle("font-family","arial"),e.canManageLabel.setStyle("font-size","12px"),e.canManageSearchTD=UWA.createElement("td").inject(e.canManage),e.showMember_CanManage=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Owner"}).inject(e.canManageSearchTD).hide(),e.searchWidget_CanManage=e.getSearchInput("Owner").inject(e.canManageSearchTD),e.searchWidget_CanManage.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.leader=UWA.createElement("tr",{class:"tr-leader"}).inject(e.addMEmberContainer),e.leaderTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.leader),e.leaderLabel=UWA.createElement("span",{id:"leader-label",text:R.get("Leader")}).inject(e.leaderTD),e.leaderHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("LeaderHelp")}).inject(e.leaderTD),e.leaderLabel.setStyle("text-align","left"),e.leaderLabel.setStyle("font-family","arial"),e.leaderLabel.setStyle("font-size","12px"),e.leaderSearchTD=UWA.createElement("td").inject(e.leader),e.showMember_Leader=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Leader"}).inject(e.leaderSearchTD).hide(),e.searchWidget_Leader=e.getSearchInput("Leader").inject(e.leaderSearchTD),e.searchWidget_Leader.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.projectLead=UWA.createElement("tr",{class:"tr-projectLead"}).inject(e.addMEmberContainer),e.projectLeadTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.projectLead),e.projectLeadLabel=UWA.createElement("span",{id:"projectLead-label",text:R.get("ProjectLead")}).inject(e.projectLeadTD),e.projectLeadHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("ProjectLeadHelp")}).inject(e.projectLeadTD),e.projectLeadLabel.setStyle("text-align","left"),e.projectLeadLabel.setStyle("font-family","arial"),e.projectLeadLabel.setStyle("font-size","12px"),e.projectLeadSearchTD=UWA.createElement("td").inject(e.projectLead),e.showMember_ProjectLead=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_ProjectLead"}).inject(e.projectLeadSearchTD).hide(),e.searchWidget_ProjectLead=e.getSearchInput("Project Lead").inject(e.projectLeadSearchTD),e.searchWidget_ProjectLead.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.member=UWA.createElement("tr",{class:"tr-member"}).inject(e.addMEmberContainer),e.memberTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.member),e.memberLabel=UWA.createElement("span",{id:"member-label",text:R.get("Member")}).inject(e.memberTD),e.memberHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("MemberHelp")}).inject(e.memberTD),e.memberLabel.setStyle("text-align","left"),e.memberLabel.setStyle("font-family","arial"),e.memberLabel.setStyle("font-size","12px"),e.memberSearchTD=UWA.createElement("td").inject(e.member),e.showMember_Member=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Member"}).inject(e.memberSearchTD).hide(),e.searchWidget_Member=e.getSearchInput("Project Member").inject(e.memberSearchTD),e.searchWidget_Member.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.canAddRemoveAttachment=UWA.createElement("tr",{class:"tr-canAddRemoveAttachment"}).inject(e.addMEmberContainer),e.canAddRemoveAttachmentTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.canAddRemoveAttachment),e.canAddRemoveAttachmentLabel=UWA.createElement("span",{id:"canAddRemoveAttachment-label",text:R.get("CanAddRemoveAttachments")}).inject(e.canAddRemoveAttachmentTD),e.canAddRemoveAttachmentHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("CanAddRemoveAttachmentHelp")}).inject(e.canAddRemoveAttachmentTD),e.canAddRemoveAttachmentLabel.setStyle("text-align","left"),e.canAddRemoveAttachmentLabel.setStyle("font-family","arial"),e.canAddRemoveAttachmentLabel.setStyle("font-size","12px"),e.canAddRemoveAttachmentSearchTD=UWA.createElement("td").inject(e.canAddRemoveAttachment),e.showMember_CanAddRemoveAttachment=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_CanAddRemoveAttachments"}).inject(e.canAddRemoveAttachmentSearchTD).hide(),e.searchWidget_CanAddRemoveAttachment=e.getSearchInput("CanAddRemoveAttachments").inject(e.canAddRemoveAttachmentSearchTD),e.searchWidget_CanAddRemoveAttachment.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.read=UWA.createElement("tr",{class:"tr-read"}).inject(e.addMEmberContainer),e.readTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.read),e.readLabel=UWA.createElement("span",{id:"read-label",text:R.get("Read")}).inject(e.readTD),e.readHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("ReadHelp")}).inject(e.readTD),e.readLabel.setStyle("text-align","left"),e.readLabel.setStyle("font-family","arial"),e.readLabel.setStyle("font-size","12px"),e.readSearchTD=UWA.createElement("td").inject(e.read),e.showMember_Read=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Viewer"}).inject(e.readSearchTD).hide(),e.searchWidget_Read=e.getSearchInput("Read").inject(e.readSearchTD),e.searchWidget_Read.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.add=UWA.createElement("tr",{class:"tr-add"}).inject(e.addMEmberContainer),e.addTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.add),e.addLabel=UWA.createElement("span",{id:"add-label",text:R.get("Add")}).inject(e.addTD),e.addHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("AddHelp")}).inject(e.addTD),e.addLabel.setStyle("text-align","left"),e.addLabel.setStyle("font-family","arial"),e.addLabel.setStyle("font-size","12px"),e.addSearchTD=UWA.createElement("td").inject(e.add),e.showMember_Add=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Viewer"}).inject(e.addSearchTD).hide(),e.searchWidget_Add=e.getSearchInput("Add").inject(e.addSearchTD),e.searchWidget_Add.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.basic=UWA.createElement("tr",{class:"tr-basic"}).inject(e.addMEmberContainer),e.basicTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.basic),e.basicLabel=UWA.createElement("span",{id:"basic-label",text:R.get("Basic")}).inject(e.basicTD),e.basicHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("BasicHelp")}).inject(e.basicTD),e.basicLabel.setStyle("text-align","left"),e.basicLabel.setStyle("font-family","arial"),e.basicLabel.setStyle("font-size","12px"),e.basicSearchTD=UWA.createElement("td").inject(e.basic),e.showMember_Basic=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Viewer"}).inject(e.basicSearchTD).hide(),e.searchWidget_Basic=e.getSearchInput("Basic").inject(e.basicSearchTD),e.searchWidget_Basic.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.readWrite=UWA.createElement("tr",{class:"tr-readWrite"}).inject(e.addMEmberContainer),e.readWriteTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.readWrite),e.readWriteLabel=UWA.createElement("span",{id:"readWrite-label",text:R.get("ReadWrite")}).inject(e.readWriteTD),e.readWriteHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("ReadWriteHelp")}).inject(e.readWriteTD),e.readWriteLabel.setStyle("text-align","left"),e.readWriteLabel.setStyle("font-family","arial"),e.readWriteLabel.setStyle("font-size","12px"),e.readWriteSearchTD=UWA.createElement("td").inject(e.readWrite),e.showMember_ReadWrite=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Viewer"}).inject(e.readWriteSearchTD).hide(),e.searchWidget_ReadWrite=e.getSearchInput("ReadWrite").inject(e.readWriteSearchTD),e.searchWidget_ReadWrite.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.remove=UWA.createElement("tr",{class:"tr-remove"}).inject(e.addMEmberContainer),e.removeTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.remove),e.removeLabel=UWA.createElement("span",{id:"remove-label",text:R.get("Remove")}).inject(e.removeTD),e.removeHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("RemoveHelp")}).inject(e.removeTD),e.removeLabel.setStyle("text-align","left"),e.removeLabel.setStyle("font-family","arial"),e.removeLabel.setStyle("font-size","12px"),e.removeSearchTD=UWA.createElement("td").inject(e.remove),e.showMember_Remove=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Viewer"}).inject(e.removeSearchTD).hide(),e.searchWidget_Remove=e.getSearchInput("Remove").inject(e.removeSearchTD),e.searchWidget_Remove.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.addRemove=UWA.createElement("tr",{class:"tr-addRemove"}).inject(e.addMEmberContainer),e.addRemoveTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.addRemove),e.addRemoveLabel=UWA.createElement("span",{id:"addRemove-label",text:R.get("AddRemove")}).inject(e.addRemoveTD),e.addRemoveHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("addRemoveHelp")}).inject(e.addRemoveTD),e.addRemoveLabel.setStyle("text-align","left"),e.addRemoveLabel.setStyle("font-family","arial"),e.addRemoveLabel.setStyle("font-size","12px"),e.addRemoveSearchTD=UWA.createElement("td").inject(e.addRemove),e.showMember_AddRemove=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Viewer"}).inject(e.addRemoveSearchTD).hide(),e.searchWidget_AddRemove=e.getSearchInput("AddRemove").inject(e.addRemoveSearchTD),e.searchWidget_AddRemove.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.full=UWA.createElement("tr",{class:"tr-full"}).inject(e.addMEmberContainer),e.fullTD=UWA.createElement("td",{class:"SH_LabelContainer"}).inject(e.full),e.fullLabel=UWA.createElement("span",{id:"full-label",text:R.get("Full")}).inject(e.fullTD),e.fullHelp=UWA.createElement("span",{class:"SH_HelpIcon fonticon fonticon-help ",title:R.get("FullHelp")}).inject(e.fullTD),e.fullLabel.setStyle("text-align","left"),e.fullLabel.setStyle("font-family","arial"),e.fullLabel.setStyle("font-size","12px"),e.fullSearchTD=UWA.createElement("td").inject(e.full),e.showMember_Full=UWA.createElement("div",{class:"SH_AddedMomberContainer",id:"member_Viewer"}).inject(e.fullSearchTD).hide(),e.searchWidget_Full=e.getSearchInput("Full").inject(e.fullSearchTD),e.searchWidget_Full.container.container.getElementsByClassName("AR_SearchButton").SW_SearchInputButton.setStyle("display","none"),e.canEditSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.canReadSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.canViewSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.canManageSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.canAddRemoveAttachmentSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.readSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.addSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.basicSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.readWriteSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.removeSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.addRemoveSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.fullSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.leaderSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.memberSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.projectLeadSearchTD.getElementsByClassName("SW_SearchInput form-control form-control-root")[0].setStyle("font-size","12px"),e.canRead.hide(),e.canManage.hide(),e.canEdit.hide(),e.canView.hide(),e.leader.hide(),e.canAddRemoveAttachment.hide(),e.read.hide(),e.add.hide(),e.basic.hide(),e.readWrite.hide(),e.remove.hide(),e.addRemove.hide(),e.full.hide(),e.member.hide(),e.projectLead.hide();e.selectRightNewUser=new f({nativeSelect:!0,placeholder:!1}),e.selectRightNewUser.elements.container.setAttribute("data-rec-id","dataRecselectRightNewUserContainer"),e.selectRightNewUser.elements.content.setAttribute("data-rec-id","dataRecselectRightNewUser"),e.errorOverlay=new c(e.widget,e.container,{className:"errorComponent_AccessRight","data-rec-id":"datarecErrorComponentAccessRight"}),this.ShareController=new u(e.widget,{uniqueRightList:!this.isReadOnly,serverName:this.options.serverName,wintop:this.options.wintop,serverUri:this.options.serverUri,serverUrl:this.options.serverUrl,isReadOnly:this.isReadOnly,odtMode:this.isODT,parent:this,contextArea2:this.ManageButtonLeft,progressBarWaitContext:e.container,events:{onError:function(t){e.hideFailMainLoadingArea(),e.addError(t)},onError2:function(t){e.hideFailMainLoadingArea(),e.hideMainLoadingArea(),e.addError(t)},onWarning:function(t){e.addError(t)},onDataLoaded:function(){if(null!=e.container.getParent()){e.hideMainLoadingArea();var t=e.ShareController.getFormattedRightList();e.selectRightNewUser.add(t,!0),t.length>0&&(e.selectRightNewUser.setValue(t[0]),t.forEach(function(t){"Reader"===t.value?e.canRead.show():"Owner"===t.value?e.canManage.show():"Author"===t.value?e.canEdit.show():"Viewer"===t.value?e.canView.show():"Read"===t.value?e.read.show():"Add"===t.value?e.add.show():"Basic"===t.value?e.basic.show():"Read Write"===t.value?e.readWrite.show():"Remove"===t.value?e.remove.show():"Add Remove"===t.value?e.addRemove.show():"Full"===t.value?e.full.show():"CanAddRemoveAttachments"===t.value?e.canAddRemoveAttachment.show():"Leader"===t.value?e.leader.show():"Project Member"===t.value?e.member.show():"Project Lead"===t.value&&e.projectLead.show()}));var n=e.selectRightNewUser.elements.container.childNodes[0].childNodes;if(n.forEach)n.forEach(function(e,t){e.setAttribute("data-rec-id","dataRecComboRightsValue"+t)});else Array.prototype.slice.call(n).forEach(function(e,t){e.setAttribute("data-rec-id","dataRecComboRightsValue"+t)});e.searchWidget_CanView.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_CanRead.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_CanManage.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_CanEdit.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_CanAddRemoveAttachment.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_Read.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_Add.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_Basic.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_ReadWrite.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_Remove.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_AddRemove.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_Full.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_Leader.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_Member.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),e.searchWidget_ProjectLead.setSelectedItemList(e.ShareController.getCurrentSelectedItems()),!0===e.firstInit&&(e.dispatchEvent("onFirstBuild"),e.firstInit=!1)}},onModificationComplete:function(t){e.hideLoadingArea(),e.showErrorReporting(t,this.SelectedItems),e._ManageValidButton(!1),e._perfTimer.stop("CommandExecutionDurationShare");var n="";null!=e.widgetSecurityContext&&""!=e.widgetSecurityContext&&e.widgetSecurityContext.SecurityContext&&(n=e.widgetSecurityContext.SecurityContext);e._perfTimer.printTimeShowDialogAndProcess(["CommandUIDurationShare","CommandExecutionDurationShare","Share: isTypeSupportedToCommand","Share: filterValidSCs","Share: pno logicalaccess","Share: lifecycle logicalaccess","Share: getCompletedData","Share: pno update","Share: lifecycle update","Share: pno checkaccess","Share: lifecycle checkaccess","Share: ar shareChecker","Share: lifecycle shareChecker","Share: getPrivateProjectList","Share: person"],n)},fireWintopNotif:function(t){!0===e.options.wintop&&e.fireWintopCommand(e.webToWinCom_Socket,t,"onModificationAccessRights")}}}),this._ManageValidButton()},_updateReadOnlyDisplay:function(){1==this.isReadOnly?(null!=this.boutonValid&&this.boutonValid.hide(),null!=this.memberPanel&&this.memberPanel.hide(),this.hideLoadingArea(),this.ManageButtonRight.setStyle("display","block")):null!=this.boutonValid&&this.boutonValid.show()},_ManageValidButton:function(e){var t=this.createJSONArrayModif(),n=e;null!=e&&void 0!==typeof e||(n=t.length>0),n?this.boutonValid.setDisabled(!1):this.boutonValid.setDisabled(!0)},getTopBar:function(){return this.ManageButtonDiv},getNewIDItem:function(){for(var e=!0,t=this.SelectedItems.length;1==e;)t++,e=!1,this.SelectedItems.forEach(function(n){t==n.index&&(e=!0)});return t},showErrorReporting:function(e,t){var n=[];if(e&&e.ownershipVector)for(var r=e.ownershipVector.length,i=0;i<r;i++){var a=[],o=e.ownershipVector[i];if(o){var s=o.ownership,c="access right success",l=!1;0==this.isODT&&(c=UWA.i18n("accessRightSuccess"));for(var d=0;d<s.length;d++){var h=s[d];if(h.hasOwnProperty("result")){c="access right failure",0==this.isODT&&(c=h.result.message),l=!0;break}}for(var p=0;p<t.length;p++)t[p].getID()===e.ownershipVector[i].objectID&&(t[p].status=c,a.push(t[p].getID()),l?(a.push(UWA.i18n("Share_Fail_Status")),a.push("Failed")):(a.push(UWA.i18n("Share_Success_Status")),a.push("Success")),a.push(t[p].getName()),a.push(t[p].typeDisplayName),a.push(t[p].Revision),a.push(t[p].organizationTitle),a.push(t[p].collabSpaceTitle),a.push(t[p].responsibleName),a.push(c),n.push(a))}}var m=this.ShareController.getInvalidList();if(m.length>0)for(p=0;p<t.length;p++){a=[];if(-1!=m.indexOf(t[p].getID())){c=R.get("ShareCheckerBlockedMessage");t[p].status=c,a.push(t[p].getID()),a.push(UWA.i18n("Share_Fail_Status")),a.push("Failed"),a.push(t[p].getName()),a.push(t[p].typeDisplayName),a.push(t[p].Revision),a.push(t[p].organizationTitle),a.push(t[p].collabSpaceTitle),a.push(t[p].responsibleName),a.push(c),n.push(a)}}b.launchReportingPanel(n,this.cols,null),this.dispatchEvent("onCancel")},setError:function(e){var t={};"object"==typeof e?"1500028"===e.code?(e.message=UWA.i18n("ErrorNotAccessRight"),t=e):e.hasOwnProperty("errorCode")&&"FS_INVALID_QUERY__NOT_AUTHORIZED_QUERY__WILDCARD"===e.errorCode?(t.code=e.errorCode,t.message=R.get("FS_INVALID_QUERY__NOT_AUTHORIZED_QUERY__WILDCARD")):t=e:t=e,this.addError(t)},addError:function(e){this.errorOverlay.displayJSONError(i.encode(e))},hideAllAreas:function(){this.hideLoadingArea(),this.hideMainComponent()},displayLoadingArea:function(){this.loadingArea.show(),this.loadingArea.elements.container.setStyle("display","flex")},hideLoadingArea:function(){this.loadingArea.hide()},displayMainInterfaceArea:function(){this.hideAllAreas(),null!=this.mainInterface&&this.mainInterface.show(),null!=this.boutonValid&&this.boutonValid.show()},hideMainComponent:function(){this.hideLoadingArea(),this.mainInterface.hide(),this.boutonValid.hide()},hideMainLoadingArea:function(){this.loadingArea.hide()},hideFailMainLoadingArea:function(){this.mainLoading.hide()},hideMainErrorArea:function(){this.mainError.hide()},showMainErrorArea:function(e){null!=e&&""!=e&&(this.clearAllMainError(),this.addMainError(e)),this.mainError.show()},addMainError:function(e){new UWA.createElement("div",{text:e}).inject(this.mainError)},clearAllMainError:function(){this.mainError.setContent("")},manageAdvancedMode:function(e){this.currentMode==this.lessButton?(this.showElements(this.mainInterface,".inherit_From"),this.showElements(this.mainInterface,".inherit_Access"),1==this.options.activeComment&&this.showElements(this.mainInterface,".Comments")):(this.hideElements(this.mainInterface,".inherit_From"),this.hideElements(this.mainInterface,".inherit_Access"),1==this.options.activeComment&&this.hideElements(this.mainInterface,".Comments")),this.resizeTable()},addErrorAfterOperation:function(e,t){t.hasOwnProperty("error")&&e.setError(t.error),t.ownershipVector.forEach(function(t,n){t.hasOwnProperty("ownership")&&t.ownership.forEach(function(t,n){t.hasOwnProperty("result")&&e.setError(t.result)})})},ownerAlreadyExist:function(e){var t=[],n=!1;return this.listOfAddedMembers.every(function(r,i){var a=r.ownership.owner;if(a.hasOwnProperty("person")||e.hasOwnProperty("person")){if(!a.hasOwnProperty("person")||!e.hasOwnProperty("person"))return!0;if(a.person.personID!=e.person.personID)return!0}if(a.hasOwnProperty("collabSpace")||e.hasOwnProperty("collabSpace")){if(!a.hasOwnProperty("collabSpace")||!e.hasOwnProperty("collabSpace"))return!0;if(a.collabSpace.collabSpaceID!=e.collabSpace.collabSpaceID)return!0}if(a.hasOwnProperty("organization")||e.hasOwnProperty("organization")){if(!a.hasOwnProperty("organization")||!e.hasOwnProperty("organization"))return!0;if(a.organization.orgID!=e.organization.orgID)return!0}if(a.hasOwnProperty("group")||e.hasOwnProperty("group")){if(!a.hasOwnProperty("group")||!e.hasOwnProperty("group"))return!0;if(a.group.groupURI!=e.group.groupURI)return!0}return(a.hasOwnProperty("comment")||e.hasOwnProperty("comment"))&&a.hasOwnProperty("comment")&&e.hasOwnProperty("comment")&&a.comment==e.comment&&(n=!0),t.push({Index:i,IsSame:n}),!0}),t},modifyDataPCS:function(){var e=this,t=e.createJSONArrayModif(),n=[],r=new Array,i=e.ShareController.getSelectedItemList(),a=e.ShareController.getErrorSelectedItemList(),o=e.ShareController.getInvalidList();if(a.length!==i.length){var s=[];i.forEach(function(e){null==a[e]&&-1==o.indexOf(e.getID())&&s.push(e)}),s.forEach(function(i,a){var o=new Array;i.hasOwnProperty("embeddedComp")&&!0===i.embeddedComp||(t.forEach(function(t){var n=t.operation;e.ShareController.isInherited(i.physicalId,n.owner)||o.push(n)}),r.push(i.physicalId),n.push({objectID:i.physicalId,ownership:o}))}),h.getInstance().getSecurityContext({onSuccess:function(t){e.widgetSecurityContext.hasOwnProperty("SecurityContext")?e.ShareController.modifyDataWithSC(n,r,e.widgetSecurityContext):e.ShareController.modifyDataWithSC(n,r,t)},onFailure:function(t){e.widgetSecurityContext.hasOwnProperty("SecurityContext")?e.ShareController.modifyDataWithSC(n,r,e.widgetSecurityContext):e.setError(t)}})}},modifyDataWithSC:function(e,t,n){var r=this,a={Accept:"application/json","Content-Type":"application/json"};if(null!=n&&""!=n&&n.hasOwnProperty("SecurityContext")){0!=n.SecurityContext.indexOf("ctx::")&&"ctx::",a.SecurityContext=encodeURIComponent(n.SecurityContext);this.options.serverName,this.options.serverUri;d.get3DSpaceUrlAsync({onComplete:function(o){var s="POST",c="",l=d.getRealPath("assets/validModification.json",r.widget),h={ownershipVector:e},p=JSON.stringify(h);R.get("AR_"),i.encode({requests:p});2==D&&(c="passport");h="";2==D&&(l=o+"/resources/accessRightServices/ar/completeInput",s="POST"),r.displayLoadingArea(),a["Accept-Language"]=widget.lang;var m=d.getTenantID();m&&0!=m.length?l+="?tenant="+m:l+="?tenant=OnPremise",d.partitionedAuthenticatedRequest(l,{type:"json",method:s,proxy:c,headers:a,partisionedProgressLabel:R.get("AR_RetrievingOwnership"),progressBarWaitContext:r.container,data:p,onComplete:function(i){r._getCompletedData(i,e,t,n)},onFailure:function(e,t,n){r._onFailure(e,t,n)},onTimeout:function(){r._onTimeout()}})},serverUrl:r.options.serverUrl,wintop:r.options.wintop})}else{var o={message:UWA.i18n("ErrorSecurityContextEmpty"),code:"ERROR"};this.setError(o)}},_onFailure:function(e,t,n,r,a,o){this.hideLoadingArea(),i.isJson(t)&&(t=i.decode(t));var s={};s=null!=t&&t.hasOwnProperty("error")?t.error:{message:UWA.i18n("AR_ErrorModification"),code:"ERROR"},this.setError(s)},_onTimeout:function(){this.hideLoadingArea();var e={message:UWA.i18n("ErrorTimeOut"),code:"TO"};this.setError(e)},getListOfPrivateCS:function(e){var t=this,n={Accept:"application/json","Content-Type":"application/json"};if(null!=e&&""!=e&&e.hasOwnProperty("SecurityContext")){0!=e.SecurityContext.indexOf("ctx::")&&"ctx::",n.SecurityContext=encodeURIComponent(e.SecurityContext);this.options.serverName,this.options.serverUri;d.get3DSpaceUrlAsync({onComplete:function(e){var r="",o=d.getRealPath("assets/availability.json",t.widget);2==D&&(r="passport"),2==D&&(o=e+"/resources/accessRightServices/ar/getPrivateProjectList");i.encode({requests:""});n["Accept-Language"]=widget.lang;var s=d.getTenantID();s&&0!=s.length?o+="?tenant="+s:o+="?tenant=OnPremise",t._perfTimer.start("Share: getPrivateProjectList"),a.authenticatedRequest(o,{type:"json",method:"GET",headers:n,proxy:r,data:"",onComplete:function(e){t._perfTimer.stop("Share: getPrivateProjectList"),t._onCompletePrivateProjectList(e)},onFailure:function(e,n,r){t._perfTimer.stop("Share: getPrivateProjectList"),t._onFailureAvailability(e,n,r)},onTimeout:function(){t._perfTimer.stop("Share: getPrivateProjectList"),t._onTimeoutAvailability(items)}})},serverUrl:t.options.serverUrl,wintop:t.options.wintop})}else{var r={message:UWA.i18n("ErrorSecurityContextEmpty"),code:"ERROR"};this.setError(r)}},_testAvailability:function(e,t){var n=this,r={Accept:"application/json","Content-Type":"application/json"};if(null==t||""==t||!t.hasOwnProperty("SecurityContext")){var a={message:UWA.i18n("ErrorSecurityContextEmpty"),code:"ERROR"};return this.setError(a),this.isReadOnly=!0,this._updateReadOnlyDisplay(),void this._addDataPCS(e)}t.SecurityContext.indexOf("ctx::"),r.SecurityContext=encodeURIComponent(t.SecurityContext);var o=[],s=e.length;s>10&&(s=10);for(var c=n.ShareController.getInvalidList(),l=0;l<s;l++){var h=e[l];-1==c.indexOf(h.physicalId)&&o.push({objectID:h.physicalId,accessRight:[{access:{physical:"changesov"}}]})}this.options.serverName,this.options.serverUri;d.get3DSpaceUrlAsync({onComplete:function(t){var a="",s="GET",c="",l=d.getRealPath("assets/availability.json",n.widget);2==D&&(c="passport");var h="Share: pno checkaccess";2==D&&(n.options.hasOwnProperty("odtmode")&&n.options.odtmode?l=t+"/resources/pno/ownership/checkaccess":0===o[0].objectID.indexOf("cid:")?(l=t+"/resources/lifecycle/ownership/checkaccess",h="Share: lifecycle checkaccess"):l=t+"/resources/pno/ownership/checkaccess",s="POST",a='{ "boAccessRights": '+i.encode(o)+"}"),r["Accept-Language"]=widget.lang;var p=d.getTenantID();p&&0!=p.length?l+="?tenant="+p:l+="?tenant=OnPremise",n._perfTimer.start(h);d.partitionedAuthenticatedRequest(l,{type:"json",method:s,proxy:c,progressBarWaitContext:n.container,data:a,headers:r,onComplete:function(t){n._perfTimer.stop(h),n.reponse=t;var r=d.getTenantID(),i=n.SelectedItemsList[0].filterValidSCList;n.ShareController._loadCredentials(r,function(a){if(null!=n.SelectedItemsList[0].filterValidSCList){i.length;0==i.length?(n.isReadOnly=!0,n.addError(UWA.i18n("ShareBlockedForCurrentResponsibility")),n._updateReadOnlyDisplay()):n._onCompleteAvailability(t,e)}else n.ShareController.filterCredentials(r,a,"accessRight",function(r){r.length;0==r.length?(n.isReadOnly=!0,n.addError(UWA.i18n("ShareBlockedForCurrentResponsibility")),n._updateReadOnlyDisplay()):n._onCompleteAvailability(t,e)})})},onFailure:function(t,r,i){n._perfTimer.stop(perftType),n._onFailureAvailability(t,r,i,e)},onTimeout:function(){n._perfTimer.stop(h),n._onTimeoutAvailability(e)}})},serverUrl:n.options.serverUrl,wintop:n.options.wintop})},_doShareChecker:function(e,t){var n=this,r=e,a={Accept:"application/json","Content-Type":"application/json"};if(null==t||""==t||!t.hasOwnProperty("SecurityContext")){var o={message:UWA.i18n("ErrorSecurityContextEmpty"),code:"ERROR"};return this.setError(o),this.isReadOnly=!0,this._updateReadOnlyDisplay(),void this._addDataPCS(e)}t.SecurityContext.indexOf("ctx::"),a.SecurityContext=encodeURIComponent(t.SecurityContext);var s=[],c=e.length;c>10&&(c=10);for(var l=0;l<c;l++){var h=e[l];s.push({objectID:h.physicalId})}this.options.serverName,this.options.serverUri;d.get3DSpaceUrlAsync({onComplete:function(o){var c="",l="GET",h="",p=d.getRealPath("assets/availability.json",n.widget);2==D&&(h="passport");var m="Share: ar shareChecker";2==D&&(n.options.hasOwnProperty("odtmode")&&n.options.odtmode?p=o+"/resources/accessRightServices/ar/shareChecker":0===s[0].objectID.indexOf("cid:")?(p=o+"/resources/lifecycle/ownership/checkaccess",m="Share: lifecycle shareChecker"):p=o+"/resources/accessRightServices/ar/shareChecker",l="POST",c=i.encode({requests:s})),a["Accept-Language"]=widget.lang;var u=d.getTenantID();u&&0!=u.length?p+="?tenant="+u:p+="?tenant=OnPremise",n._perfTimer.start(m);d.partitionedAuthenticatedRequest(p,{type:"json",method:l,proxy:h,progressBarWaitContext:n.container,data:c,headers:a,onComplete:function(i){if(n._perfTimer.stop(m),null!=i.results[0].invalidList&&i.results[0].invalidList.length>0){var a;if((a=i.results[0].invalidList).length==e.length){n.isReadOnly=!0,n.hideLoadingArea();var o={message:UWA.i18n("ShareCheckerBlockedMessage"),code:"TO"};return n.setError(o),void n._updateReadOnlyDisplay()}n.ShareController.fillInvalidList(a),n._testAvailability(r,t)}else n._testAvailability(r,t)},onFailure:function(t,r,i){n._perfTimer.stop(m),n._onFailureAvailability(t,r,i,e)},onTimeout:function(){n._perfTimer.stop(m),n._onTimeoutAvailability(e)}})},serverUrl:n.options.serverUrl,wintop:n.options.wintop})},_onTimeoutAvailability:function(e){this.isReadOnly=!0,this.hideLoadingArea();var t={message:UWA.i18n("ErrorTimeOut"),code:"TO"};this.setError(t),this._updateReadOnlyDisplay(),this._addDataPCS(e)},_onFailureAvailability:function(e,t,n,r){this.isReadOnly=!0,this.hideLoadingArea();var a={};i.isJson(t)&&(t=i.decode(t)),a=null!=t&&t.hasOwnProperty("error")?t.error:{message:UWA.i18n("UnknownError"),code:"ERROR"},this.setError(a),this._updateReadOnlyDisplay(),this._addDataPCS(r)},_onCompletePrivateProjectList:function(e){e.hasOwnProperty("PrivateProjects")&&(this.listOfPrivateProjects=e.PrivateProjects.PrivateProjectList,this.searchWidget_AddRemove.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_Add.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_Basic.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_CanAddRemoveAttachment.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_CanEdit.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_CanManage.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_CanRead.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_CanView.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_Full.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_Read.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_ReadWrite.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_Remove.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_Leader.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_Member.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList,this.searchWidget_ProjectLead.options.PrivateProjectList=e.PrivateProjects.PrivateProjectList)},_onCompleteAvailability:function(e,t){var n=this;if(1==e.success){this.isReadOnly=!1;var r=0;if(e.hasOwnProperty("boAccessRights")){var i=e.boAccessRights,a={};i.forEach(function(e){e.hasOwnProperty("accessRight")&&e.accessRight.forEach(function(i){if(i.hasOwnProperty("error")){r++;var o=i.error;o.type="warning";var s=UWA.i18n("an object");t.every(function(t){t.physicalId==e.objectID&&t.hasOwnProperty("name")&&(s=t.name)});var c="";switch(n.widgetSecurityContext.hasOwnProperty("SecurityContext")&&(c=n.widgetSecurityContext.SecurityContext.replace("ctx::","")),o.code+""){case"1501603":o.message=UWA.i18n("Bad credential for {0}").format(s);break;case"1501601":o.message=UWA.i18n("SH_PLM_SecurityDenied");break;case"1501602":o.message=UWA.i18n("NoCredentialAccess{0}").format(c)}a[e.objectID]=o.message,!0===n.options.displayWarningForAutoRO&&n.addError(o),y.warn("Access right : "+o.message)}})});var o=i.length;o==r?(n.isReadOnly=!0,1==o?null!=a[i[0].objectID]&&n.addError(a[i[0].objectID]):n.addError(UWA.i18n("ErrorNoAccessToSelectedObjects")),t.length>o&&(n.isReadOnly=!1,n.addError(UWA.i18n("ErrorNoAccessToAtLeast10")))):r>0&&n.addError(UWA.i18n("ErrorNoAccessToSomeObjects{0}").format(r))}n._updateReadOnlyDisplay(),n._addDataPCS(t)}else{if(this.isReadOnly=!0,e.hasOwnProperty("error")){var s=e.error;n.addError(s)}this.hideMainLoadingArea()}},_manageTableHeader:function(){var e=this.tableContainer.getElement(".SH_mainTableHeader");null!==e&&(this.table.allIsHidden()?e.hide():e.show())},AddUser:function(e){var t=!1;if(!d.isProgressBusy()){var n="";if("Reader"==e)n=this.searchWidget_CanRead.getNewOwner();else if("Author"==e)n=this.searchWidget_CanEdit.getNewOwner();else if("Owner"==e)n=this.searchWidget_CanManage.getNewOwner();else if("Viewer"==e)n=this.searchWidget_CanView.getNewOwner();else if("CanAddRemoveAttachments"==e)n=this.searchWidget_CanAddRemoveAttachment.getNewOwner();else if("Read"==e)n=this.searchWidget_Read.getNewOwner();else if("Add"==e)n=this.searchWidget_Add.getNewOwner();else if("Basic"==e)n=this.searchWidget_Basic.getNewOwner();else if("ReadWrite"==e){n=this.searchWidget_ReadWrite.getNewOwner();e="Read Write"}else if("Remove"==e)n=this.searchWidget_Remove.getNewOwner();else if("AddRemove"==e){n=this.searchWidget_AddRemove.getNewOwner();e="Add Remove"}else if("Full"==e)n=this.searchWidget_Full.getNewOwner();else if("Leader"==e)n=this.searchWidget_Leader.getNewOwner();else if("Project Member"==e)n=this.searchWidget_Member.getNewOwner();else if("Project Lead"==e)n=this.searchWidget_ProjectLead.getNewOwner();else""==e&&(n=this.searchWidget.getNewOwner());if(null===n||""===n)return t;n.hasOwnProperty("userGrp")&&(n.group={groupURI:n.userGrp.id,groupTitle:n.userGrp.label},delete n.userGrp);var r=e,i=!0,a=this.ownerAlreadyExist(n);if(a.length>0){var o=a[0],s=o.Index;1==o.IsSame?this.listOfAddedMembers[s].ownership.access.logical===r?i=!1:this.listOfAddedMembers[s].ownership.access.logical!=r&&(s+=1,this.container.getElement("#addedItem"+s).hide(),this.DeleteUser(s)):(s+=1,this.container.getElement("#addedItem"+s).hide(),this.DeleteUser(s))}if(i){var c={ownership:{InitRights:"",operation:"ADD",owner:n,access:{logical:r}},isTrueComment:!0,isTrueInheritedPath:!0};this.listOfAddedMembers.push(c),t=!0}return t}},DeleteUser:function(e){if(!d.isProgressBusy()){var t=parseInt(e)-1;this.listOfAddedMembers.splice(t,1),this._ManageValidButton()}},getNameUserFromOwner:function(e){var t=null,n="",r=-1;if(e.hasOwnProperty("person"))n=e.person.personLastName+" "+e.person.personFirstName,r=1;else{var i=!1;e.hasOwnProperty("organization")&&(i=!0,n=e.organization.orgID),e.hasOwnProperty("collabSpace")&&(1==i&&(n+=" / "),n+=e.collabSpace.collabSpaceID),e.hasOwnProperty("group")&&(n=e.group.groupTitle),r=2}return r>0&&(t={name:n,type:r}),t},resizeTable:function(){this.table.resizeTable()},createJSONArrayModif:function(){var e=[];if(1==this.isReadOnly)return e;for(var t=this.listOfAddedMembers.length,n=0;n<t;n++){var r=null,a=this.listOfAddedMembers[n];r=a.ownership.owner;var o=!0,s=!0;a.hasOwnProperty("isTrueComment")&&(o=a.isTrueComment),a.hasOwnProperty("isTrueInheritedPath")&&(s=a.isTrueInheritedPath);var c="";1==this.options.activeComment&&(c=this.table.getCellValue(lines[n],"Comments"));var l=a.ownership.InitRights,d="Reader";a.hasOwnProperty("ownership")&&(d=a.ownership.access.logical);var h=!1;null!=d&&""!=d||(h=!0);var p=!1;null!=l&&""!=l||(p=!0);var m=!1;if(""!=c&&c!=r.comment&&(m=!0),1==p&&0==h&&(1==m&&(r.comment=c),e.push({operation:{operation:"ADD",owner:r,access:{logical:d}},isTrueComment:!0,isTrueInheritedPath:!0,action:"ADD"})),0==p&&1==h&&e.push({operation:{operation:"REMOVE",owner:r,access:{logical:"Empty"}},isTrueComment:o,isTrueInheritedPath:s,action:"REMOVE"}),0==p&&0==h)if(1==m){var u=i.decode(i.encode(r));u.comment=c,e.push({operation:{operation:"ADD",owner:u,access:{logical:d}},isTrueComment:!0,isTrueInheritedPath:!0,action:"ADD"})}else d!=l&&e.push({operation:{operation:"ADD",owner:r,access:{logical:d}},isTrueComment:o,isTrueInheritedPath:s,action:"MODIFY"})}return e},ODTModificationComplete:function(e){this.hideLoadingArea(),1==e.success||this.addErrorAfterOperation(this,e),this._ManageValidButton(!1)},ODTGetListOfItemsInTable:function(){return this.ShareController.getSelectedItemList().length},ODTGetListOfUserItemsInTable:function(){return this.table.getAllLine().length},trackAppContent:function(e){var t={UXName:"Share",models:e};this.trackerEvent=w.createInitActionEvent(t,this.trackerEvent),w.checkAndTrackPageEvent(this.trackerEvent)}})});