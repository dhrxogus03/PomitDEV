define("DS/ENORouteMgmt/Utilities/RouteWidgetPersistency",[],function(){"use strict";let e={RouteSummaryPage:"GridView",TemplateSummaryPage:"GridView",RouteContentsPage:"GridView",RouteTasksPage:"GraphView",RouteMembersPage:"TileView"},t=function(t,o){let n="";switch(t){case"RouteSummaryPage":n=widget.getValue("RouteSummary-ShowView");break;case"TemplateSummaryPage":n=widget.getValue("TemplateSummary-ShowView");break;case"RouteTasksPage":n=widget.getValue("TasksTab-ShowView");break;case"RouteContentsPage":n=widget.getValue("ContentsTab-ShowView");break;case"RouteMembersPage":n=widget.getValue("MembersTab-ShowView")}if(void 0!==n&&""!==n||(n=function(t){let o="";for(var n of Object.keys(e))t===n&&(o=e[n]);return""===o&&(o="GridView"),o}(t)),n)return n===o?"selected":"unselected"};return{getViewPersistency:(e,o)=>t(e,o),getTabPersistency:e=>(function(e){let t="";return 1!=widget.data.openTaskProperties&&null==widget.getValue("taskIdTobePersisted")&&null==widget.data.taskId||(widget.setValue("RouteTabs-ShowView",0),widget.setValue("TemplateTabs-ShowView",0)),void 0!==(t="RouteTabsPage"===e?widget.getValue("RouteTabs-ShowView"):widget.getValue("TemplateTabs-ShowView"))&&""!==t||(t=0),t})(e)}}),define("DS/ENORouteMgmt/Model/Utils/TaskModelUtils",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o){"use strict";let n=function(e){let t=e.taskDetails,o=[];return t?t.forEach((e,t)=>{"true"==e.split("~")[1]&&o.push(e.split("~")[0])}):o.push("showTaskRemove"),o},i=function(e){let t={presentOrder:[]};return e.forEach(function(e){e.userGroupInfo&&e.userGroupAction&&(t.isPresent=!0,t.presentOrder.push(e.taskOrder))}),t},s=function(e){return new t({label:e})},a=function(e,t){e&&(e.options.grid.taskOrder&&(e.options.grid.taskOrder=String(parseInt(e.options.grid.taskOrder)+t)),a(e.getNextNode(),t))},r=function(e){let t={typeicon:"https://vdevpril249blr.dsone.3ds.com:443/3DSpace/snresources/images/icons/small/iconSmallInboxTask.gif",taskOrder:"1",parallelNodeProcessionRule:"All",validTaskData:!1,nodeType:"Route Task",type:"Route Node",templateTask:"No"};return e&&"Route Template"==e&&(t.chooseUsersFromUg="False"),t},l=function(e,o){let n={typeicon:"https://vdevpril249blr.dsone.3ds.com:443/3DSpace/snresources/images/icons/small/iconSmallInboxTask.gif",taskOrder:e.taskOrder,parallelNodeProcessionRule:e.taskAction,validTaskData:!1,nodeType:"Route Task",type:"Route Node",templateTask:"No"};return"Route Template"==o&&(n.chooseUsersFromUg="False",n.templateTask="Yes"),new t({label:n.title,grid:n})},d=function(e,t){if(e===t)return t;if(t.options.grid.taskOrder!=e.options.grid.taskOrder)throw"Could not find the deleted task node model to delete!";return d(e,t.getNextNode())};return{prepareTreeDocumentModel:(e,o)=>(function(e,o){let a,l,d,u=s("Start");o.addRoot(u),0==e.length&&(e=[r(e.parentObjectType)]);let c=i(e);e.forEach(function(e){if(a&&a.taskOrder==e.taskOrder||(l=new t({label:""==e.parallelNodeProcessionRule?"All":e.parallelNodeProcessionRule,grid:{taskOrder:e.taskOrder}}),o.addRoot(l)),c.isPresent&&c.presentOrder.indexOf(e.taskOrder)>-1){if(l._isSplitTaskPresent=!0,o.options._isSplitTaskPresent||(o.options._isSplitTaskPresent=!0),d=void 0,l.getChildren())for(let t=0;t<l.getChildren().length;t++){let o=l.getChildren()[t];if(o.options.grid.userGroupInfo&&o.options.grid.userGroupInfo==e.userGroupInfo){d=o;break}}d||(d=new t({label:e.userGroupAction,grid:{taskOrder:e.taskOrder,userGroupInfo:e.userGroupInfo,nodeType:"UG Action Node"}}),l.addChild(d));let i=n(e);e.taskDetailsList=i,e.id&&(e.validTaskData=!0),e.nodeType="Route Task";let s=new t({grid:e});d.addChild(s)}else{let o=n(e);e.taskDetailsList=o,e.id&&(e.validTaskData=!0),e.nodeType="Route Task";let i=new t({grid:e});l.addChild(i)}a=e});let m=o.getChildren();m&&m.forEach((e,t)=>{let o=e.getChildren();o&&1==o.length&&(e.options.label="All",e.getChildren()[0].options.grid.parallelNodeProcessionRule="All")});let p=s("Finish");o.addRoot(p)})(e,o),getTaskNodeModel:(e,o,n)=>(function(e,o,n){"right"==o&&(n+=1),e.prepareUpdate();let i=e.getChildren()[n],s={};e.getChildren().length;s.taskOrder=String(n),s.taskAction="bottom"==o||"top"==o?i.options.label:"All";let r=e.options.routeInfoJSON.model?e.options.routeInfoJSON.model.Type:e.options.routeInfoJSON.Type,d=l(s,r);if(d._isNewlyAdded=!0,e._isTaskAdded=!0,i._isSplitTaskPresent&&("bottom"==o||"top"==o)){let e=new t({label:"All",grid:{taskOrder:String(n),nodeType:"Task Action Node"}});e.addChild(d),d=e}if("bottom"==o)i.addChild(d);else if("top"==o){let e=i.getChildren()[0];i.insertBefore(d,e)}else{let o=i,s=new t({label:"All",grid:{taskOrder:String(n),nodeType:"Task Action Node"}});s.addChild(d),e.insertBefore(s,o),a(o,1)}return e.pushUpdate(),d})(e,o,n),destroy:()=>destroy(),deleteTreeNodeModel:(e,t)=>(function(e,t){let o=[],n=[];e.options.grid.graphNode&&o.push(e.options.grid.graphNode),n.push(e);let i=e.getParent(),s=e.getTreeDocument();if(s&&!s.options._isSplitTaskPresent){let t=e.getBrothers().length+1;1==t?(a(e.getNextNode(),-1),i.options.grid.graphNode&&o.push(i.options.grid.graphNode),i.remove()):(2==t&&o.push(i.options.grid.graphNode),e.remove())}else{let n=parseInt(e.options.grid.taskOrder);t||(t=s);let r=t.getChildren()[n];if(r)try{let t=d(e,r.getAllDescendants()[0]);0==e.getBrothers().length&&2==e.getParents().length?0==i.getBrothers().length&&1==i.getParents().length?(a(e.getNextNode(),-1),i.getParent().remove()):i.remove():0==e.getBrothers().length?(a(e.getNextNode(),-1),i.remove()):(e.remove(),t.remove())}catch(e){o=[],console.log(e)}}return{deletedGraphNodes:o,deletedTasks:n}})(e,t),getTasksDataForCreation:e=>(function(e){let t,o=!1;return null==e?t:(t=[],e.getAllDescendants().forEach(e=>{if(e.tileView){let n=e.options.grid;n.validTaskData||n.id?t.push(n):o=!0}}),!o&&t)})(e),reOrderTreeNodeModels:(e,o,n)=>(function(e,o,n){let i=parseInt(n.newOrder),s=parseInt(n.oldOrder),a=o,r=function(e,t){let o=!1;return e.getChildren()[t].getAllDescendants().forEach(function(e){e.getChildren()||e.options.grid.userGroupInfo&&e.options.grid.userGroupAction&&(o=!0)}),o}(e,i);if(e.options._isSplitTaskPresent)if(2==o.getParents().length)r?a=o.getParent():o.getParent().remove();else if(1==o.getParents().length&&r){let e=new t({label:"All",grid:{taskOrder:String(i),nodeType:"Task Action Node"}});e.addChild(a),a=e}if(e.getChildren()[i].getChildren())e.getChildren()[i].addChild(a);else{let o=e.getChildren()[i],n=new t({label:"All",grid:{taskOrder:String(i),nodeType:"Task Action Node"}});n.addChild(a),e.insertBefore(n,o)}return e.getChildren()[s]&&(e.getChildren()[s].getChildren()||e.getChildren()[s].remove()),e})(e,o,n),removeGraphNodesFromTree:e=>(function(e){return e.getAllDescendants().forEach((e,t)=>{e.options.grid.graphNode&&(e.options.grid.graphNode=void 0)}),e})(e),updateTaskAction:(e,t)=>(function(e,t){return e.options.label=t,e.getChildren().forEach((e,o)=>{let n=e.getChildren();n&&n.length>0?n.forEach((e,o)=>{e.options.grid.parallelNodeProcessionRule=t}):e.options.grid.parallelNodeProcessionRule=t}),e})(e,t),getTasksDataForEdit:e=>(function(e){let t,o=!1;return null==e?t:(t=[],e.getChildren().forEach((e,n)=>{let i=e.getChildren();i&&i.length>0&&i.forEach((e,n)=>{e.options.grid.validTaskData||e.options.grid.id?t.push(e.options.grid):(1==e.getBrothers().length+1?(a(e.getNextNode(),-1),e.getParent.remove()):e.remove(),o=!0)})}),!o&&t)})(e)}}),define("DS/ENORouteMgmt/Utilities/DataFormatter",["i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e){"use strict";let t;return t={gridData:t=>(function(t){var o=null==t.Type?t.type:t.Type;return{id:t.id,Name:t.name,Title:t.title,Maturity_State:t.stateNLS,state:t.state,Type:o,Route_Status:t.routeStatus,Activity_State:t.activityState,Description:t.description,Assignees:t.assignees,AssigneesDiv:t.assigneesdiv,Owner:t.ownerFullName,revision:t.revision,UserName:t.owner,Actions:t.actions,Originated:t.originated,organization:t.organization,Modified:t.modified,OwnerFullName:t.ownerFullName,TypeIconLarge:t.typeiconLarge,TypeIconSmall:t.typeicon,Project:t.project,ProjectTitle:t.projectTitle,BasePurpose:t.routeBasePurpose,BasePurposeNLS:e[t.routeBasePurpose],DemoteOnRejection:t.DemoteOnRejection,DemoteOnRejectionNLS:e[t.DemoteOnRejection],TemplateName:t.sConnectedRTName,TemplateId:t.sConnectedRTId,TemplateRevision:t.sConnectedRTRevision,TemplateTitle:t.sConnectedRTTitle,Scope:t.attrScope,ScopeMembers:t.attrScopeMembers,DeleteAccess:t.deleteAccess,ownerFilter:t.owner,preserveTaskOwner:t.preserveTaskOwner,actualState:t.state,selectUsersFromUserGroup:t.selectUsersFromUserGroup,attRestrictMembers:t.attRestrictMembers,currentRouteNode:t.currentRouteNode,linkedRouteTemplate:t.linkedRouteTemplate,linkedRouteTemplateTitle:t.linkedRouteTemplateTitle,routeCompletionAction:t.routeCompletionAction,requiresEsign:t.requiresEsign,taskEditSetting:t.taskEditSetting,AutoStopOnRejection:t.AutoStopOnRejection,showAbstain:t.showAbstain,parentRouteTaskDueDate:t.parentRouteTaskDueDate}})(t),contentGridData:e=>(function(e){return{id:e.id,Name:e["ds6w:identifier"],Title:e["ds6w:label"],Maturity:e["ds6w:status"],Type:e["ds6w:type"],Description:e["ds6w:description"],Owner:e.owner,Creation_Date:e["ds6w:created"],Modified_Date:e["ds6w:modified"],TypeIconLarge:e.preview_url}})(e),memberGridData:e=>(function(e){return{id:e.id,Access:e.newAccess}})(e),taskGridData:t=>(function(t){var o={id:t.id,type:t.type,projectTaskRelId:t.projectTaskRelId,originated:t.originated,taskRequirement:t.taskRequirement,allowDelegation:t.allowDelegation,assigneeSetDueDate:t.assigneeSetDueDate,dateOffsetFrom:t.dateOffsetFrom,dueDateOffset:t.dueDateOffset,reviewCommentsNeeded:t.reviewCommentsNeeded,needsOwnerReview:t.needsOwnerReview,reviewersComments:t.reviewersComments,title:t.title,comments:t.comments,taskAction:t.taskAction,taskActionNLS:"TRUE"==t.routeOwnerTask?e.assign:e[t.taskAction],instructions:t.instructions,taskDueDate:t.taskDueDate,approvalStatus:t.approvalStatus,name:t.name,current:t.current,currentNLS:t.stateNLS,modified:t.modified,revision:t.revision,taskOrder:t.taskOrder,parallelNodeProcessionRule:t.parallelNodeProcessionRule,assigneeId:t.assigneeId,assigneeTitle:t.assigneeTitle,assigneeType:t.assigneeType,assigneePID:t.assigneePID,taskAcceptLink:t.taskAcceptLink,taskAssignee:t.taskAssignee,taskAssigneeUsername:t.taskAssigneeUsername,taskDetails:t.taskDetails,typeicon:t.typeicon,awaiting_taskApprovalStatus:t.awaiting_taskApprovalStatus,chooseUsersFromUg:t.chooseUsersFromUg,routeOwnerTask:t.routeOwnerTask,routeOwnerUGChoice:t.routeOwnerUGChoice,routeOwnerUGName:t.routeOwnerUGName,routeOwnerUGTitle:t.routeOwnerUGTitle,isInitialTask:t.isInitialTask,templateTask:t.templateTask,taskEditSetting:t.taskEditSetting,attrTaskStatus:t.attrTaskStatus,taskAttachments:t.taskAttachments,routeContents:t.routeContents,userGroupAction:t.userGroupAction,userGroupInfo:t.userGroupInfo,taskSubRoutes:t.taskSubRoutes,subRouteApprovalStatus:t.subRouteApprovalStatus,subRouteGridApprovalStatus:t.subRouteGridApprovalStatus,RouteTaskContentToReview:t.RouteTaskContentToReview,ContentToReviewIds:t.ContentToReviewIds,contentToReviewFieldInfo:t.contentToReviewFieldInfo,contentToReviewOrgFieldInfo:t.contentToReviewOrgFieldInfo,removeContentToReview:t.removeContentToReview};"Auto Complete"==t.approvalStatus&&(o.awaiting_taskApprovalStatus=e.completedByOwner);let n=widget.getValue("task-custom-fields");return n&&n.forEach((e,n)=>{if("extensions"!=e.name){let n=t[e.name];o[e.name]=n}}),o})(t),templateGridData:t=>(function(t){return t.revision&&!isNaN(t.revision)&&(t.revision=parseInt(t.revision,10)),{id:t.id,Name:t.name,Title:t.title,Maturity_State:t.stateNLS,revision:t.revision,state:t.state,Type:t.type,Activity_State:t.routeStatus,Activity_StateNLS:null==e[t.routeStatus]?"":e[t.routeStatus],Description:t.description,Assignees:t.assignees,AssigneesDiv:t.assigneesdiv,Owner:t.ownerFullName,UserName:t.owner,Actions:t.actions,Originated:t.originated,organization:t.organization,Modified:t.modified,OwnerFullName:t.ownerFullName,TypeIconLarge:t.typeiconLarge,TypeIconSmall:t.typeicon,Project:t.project,ProjectTitle:t.projectTitle,BasePurpose:t.routeBasePurpose,BasePurposeNLS:e[t.routeBasePurpose],DemoteOnRejection:t.DemoteOnRejection,DemoteOnRejectionNLS:e[t.DemoteOnRejectionNLS],TemplateName:t.sConnectedRTName,Scope:[t.attRestrictMembers],ScopeMembers:t.attrScopeMembers,DeleteAccess:t.deleteAccess,ownerFilter:t.owner,actualState:t.state,selectUsersFromUserGroup:t.selectUsersFromUserGroup,attRestrictMembers:t.attRestrictMembers,currentRouteNode:t.currentRouteNode,preserveTaskOwner:t.preserveTaskOwner,linkedRouteTemplate:t.linkedRouteTemplateTitle,linkedRouteTemplateId:t.linkedRouteTemplateId,completionAction:t.completionAction,reviseAccess:t.reviseAccess,sConnectedRouteId:t.sConnectedRouteId,routeCompletionAction:t.routeCompletionAction}})(t),getIdsForServicePayload:e=>(function(e){var t=[];let o;for(var n=0;n<e.length;n++){var i={};i.id=e[n],t.push(i)}return o={data:t}})(e)}}),define("DS/ENORouteMgmt/Utilities/DragAndDropOnTaskInputField",["UWA/Core","DS/DataDragAndDrop/DataDragAndDrop"],function(e,t){"use strict";return{makeDroppable:function(o,n,i){let s=this;if(null!==o){if(s.dropInvite=o.getElement("#droppable"),!s.dropInvite){let t;t=null!=i?"droppable_"+i:"droppable",s.dropInvite=new e.createElement("div",{id:t}).inject(o)}s.dropInvite.callback=n;let a={enter:s._manageDragEvents.bind(s),leave:s._manageDragEvents.bind(s),over:s._manageDragEvents.bind(s),drop:s._manageDropEvent.bind(s)};t.droppable(o,a)}},_manageDragEvents:function(e,t){let o=this;switch(t.type){case"dragenter":o._addDroppableStyle();break;case"dragleave":o._removeDroppableStyle();break;case"dragover":o._addDroppableStyle()}return!0},_removeDroppableStyle:function(){let e=document.querySelector("#routeCreateContainer #InitiateTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips");null==e&&(e=document.querySelector("#routes-right-panel #InitiateTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips")),null!=e&&""!=e.style.border&&(e.style.border="")},_addDroppableStyle:function(){let e=document.querySelector("#routeCreateContainer #InitiateTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips");null==e&&(e=document.querySelector("#routes-right-panel #InitiateTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips")),null!=e&&""==e.style.border&&(e.style.border="2px dotted #368ec4")},_manageDropEvent:function(t,o){let n=this;if(""!==t&&null!=t)try{var i=(t=e.is(t,"string")?JSON.parse(t):t).data&&t.data.items?t.data.items:null;n.dropInvite.callback(i,o);let s=document.querySelector("#routeCreateContainer #InitiateTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips");null==s&&(s=document.querySelector("#routes-right-panel #InitiateTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips")),null!=s&&""!=s.style.border&&(s.style.border="")}catch(e){let t=document.querySelector("#routeCreateContainer #InitiateTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips");null==t&&(t=document.querySelector("#routes-right-panel #InitiateTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips")),null!=t&&""!=t.style.border&&(t.style.border="")}else{n.dropInvite.callback(arguments[2]);let e=document.querySelector("#routeCreateContainer #InitiateTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips");null==e&&(e=document.querySelector("#routes-right-panel #InitiateTaskPropertiesBody .wux-controls-abstract.wux-controls-selectionChips.wux-controls-autoComplete-selectionChips")),null!=e&&""!=e.style.border&&(e.style.border="")}}}}),define("DS/ENORouteMgmt/Utilities/Constants",["UWA/Class"],function(e){"use strict";return e.singleton({WELCOMEPANEL_ID_CREATE_ROUTE:"new_route",WELCOMEPANEL_ID_CREATE_ROUTE_TEMPLATE:"new_route_template",WELCOMEPANEL_ID_ROUTES:"routes",WELCOMEPANEL_ID_ROUTE_TEMPLATES:"route_templates",EVENT_ROUTE_SUMMARY_DBLCLICK:"route-DataGrid-on-dblclick",DIALOG_EVENTS:{CREATE_TASK:"redraw-graph-create",OPEN_TASK_PANEL:"route-task-open-click",CLOSE_TASK_PANEL:"route-task-close-click",TOGGLE_ROUTE_BUTTONS:"initiate-route-toggle-dialogbuttons",TOGGLE_TEMPLATE_BUTTONS:"initiate-template-toggle-dialogbuttons",SAVE_AS_TEMPLATE_TOGGLE:"initiate-saveAsTemplate-toggle-dialogbuttons",REVISE_TEMPLATE_DIALOG:"initiate-reviseTemplate-toggle-dialogbuttons",ROUTE_BASE_PURPOSE_CHANGE:"initiateRoute-on-RouteBasePurposeSelection",TEMPLATE_CHANGE:"initiateRoute-on-TemplateSelection",CHOOSE_UG_CHANGE:"InitiateTemplate-on-chooseUGSelection",SCOPE_CHANGE:"initiateRoute-on-ScopeSelection",TASK_PANEL_CLOSE:"task-panel-close",TASK_CREATE_SAVE:"task-create-on-save",CLEAR_CONTENT_ON_CREATEANOTHER:"initiateRouteClearContent-on-createAnother",CLEAR_CONTENT_REVIEW_MODEL:"clearContentToReview-on-ContentRemoval",TASK_ASSOCIATED_CONTENT_UPDATE:"task-associated-content-update",SHOW_NO_ROUTE_PLACEHOLDER:"show-no-route-placeholder",HIDE_NO_ROUTE_PLACEHOLDER:"hide-no-route-placeholder",HIDE_NO_CONTENT_PLACEHOLDER:"hide-no-content-placeholder",SHOW_NO_CONTENT_PLACEHOLDER:"show-no-content-placeholder",HIDE_NO_IROUTE_PLACEHOLDER:"hide-no-iRoutecontent-placeholder",SHOW_NO_IROUTE_PLACEHOLDER:"show-no-iRoutecontent-placeholder"}})}),define("DS/ENORouteMgmt/Utilities/DragAndDrop",["UWA/Core","DS/DataDragAndDrop/DataDragAndDrop"],function(e,t){"use strict";return{makeDroppable:function(o,n){let i=this;if(null!==o){i.dropInvite=o.getElement("#droppable"),i.dropInvite||(i.dropInvite=new e.createElement("div",{id:"droppable",class:"hidden"}).inject(o)),i.dropInvite.callback=n;let s={enter:i._manageDragEvents.bind(i),leave:i._manageDragEvents.bind(i),over:i._manageDragEvents.bind(i),drop:i._manageDropEvent.bind(i)};t.droppable(o,s)}},_manageDragEvents:function(e,t){let o=this;switch(t.type){case"dragenter":o._addDroppableStyle();break;case"dragleave":var n=t.target.className;if("droppable show"==n){o._removeDroppableStyle();break}if(n=n.replaceAll(" ","."),e&&null!=e.querySelector("."+n)){var i=e.querySelector("#dataGridContentsDivToolbar");i&&null!=i.querySelector("."+n)&&o._removeDroppableStyle(),(i=e.querySelector(".create-iRouteContent-help"))&&null!=i.querySelector("."+n)&&o._removeDroppableStyle();break}o._removeDroppableStyle();break;case"dragover":o._addDroppableStyle()}return!0},_removeDroppableStyle:function(){this.dropInvite.removeClassName("droppable"),this.dropInvite.removeClassName("show"),this.dropInvite.addClassName("hidden")},_addDroppableStyle:function(){this.dropInvite.addClassName("droppable"),this.dropInvite.removeClassName("hidden"),this.dropInvite.addClassName("show")},_manageDropEvent:function(t,o){let n=this;if(""!==t&&null!=t)try{var i=(t=e.is(t,"string")?JSON.parse(t):t).data&&t.data.items?t.data.items:null;n.dropInvite.callback(i),n.dropInvite.removeClassName("droppable"),n.dropInvite.removeClassName("show"),n.dropInvite.addClassName("hidden")}catch(e){n.dropInvite.removeClassName("droppable"),n.dropInvite.removeClassName("show"),n.dropInvite.addClassName("hidden")}else n.dropInvite.callback(arguments[2]),n.dropInvite.removeClassName("droppable"),n.dropInvite.removeClassName("show"),n.dropInvite.addClassName("hidden")}}}),define("DS/ENORouteMgmt/Components/Wrappers/SplitViewWrapper",["DS/ENOXSplitView/js/ENOXSplitView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){"use strict";var o=e;return o.prototype.getLeftViewWrapper=function(){return UWA.extendElement(this.getLeft())},o.prototype.getRightViewWrapper=function(){return UWA.extendElement(this.getRight())},o.prototype.addRightPanelExpander=function(){if(null!=this._rightPanel){var e=UWA.createElement("div",{class:"splitview-close fonticon fonticon-expand-left",id:"splitview-close",title:t.homeRightPanelExpand,styles:{"font-size":"20px"}});e.inject(this._rightPanel);var o=this;e.onclick=function(e){o._hideSide("left"),o._rightPanel.classList.remove("right-container-mobile-view");var n=document.querySelector(".splitview-close.fonticon-expand-left");if(n)n.title=t.homeRightPanelCollapse,n.removeClassName("fonticon-expand-left"),n.addClassName("fonticon-expand-right");else{var i=document.querySelector(".splitview-close.fonticon-expand-right");i.title=t.homeRightPanelExpand,o._showSide("left"),(i=UWA.extendElement(i)).removeClassName("fonticon-expand-right"),i.addClassName("fonticon-expand-left")}}}},o}),define("DS/ENORouteMgmt/Utilities/IdCardUtil",["i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e){"use strict";let t=function(){var e=document.querySelector("#channel3");e&&(e.style.display="none")},o=function(){var e=document.querySelector("#channel3");e&&(e.style.display="")},n=function(){document.querySelector("#thumbnailSection").classList.add("id-card-thumbnail-remove");var e=document.querySelector("#infoSec"),t=document.querySelector("#routeHeaderContainer"),o=document.querySelector("#templateHeaderContainer");t&&t.className.indexOf("minimized")>-1||o&&o.className.indexOf("minimized")>-1?e.classList.add("id-info-section-align-minimized"):e.classList.add("id-info-section-align")},i=function(){document.querySelector("#thumbnailSection").classList.remove("id-card-thumbnail-remove");var e=document.querySelector("#infoSec"),t=document.querySelector("#routeHeaderContainer"),o=document.querySelector("#templateHeaderContainer");t&&t.className.indexOf("minimized")>-1||o&&o.className.indexOf("minimized")>-1?e.classList.remove("id-info-section-align-minimized"):e.classList.remove("id-info-section-align")},s=function(e){var s;e<850?t():o(),e<768?n():i(),e<500?(s=document.querySelector("#channel2"))&&(s.style.display="none"):function(){var e=document.querySelector("#channel2");e&&(e.style.display="")}(),e<175?function(){var e=document.querySelector("#channel1");e&&(e.style.display="none")}():function(){var e=document.querySelector("#channel1");e&&(e.style.display="")}()};return{infoIconActive:()=>(function(){var e=document.querySelector("#routeInfoIcon");e&&e.className.indexOf("fonticon-color-display")>-1&&(e.className=e.className.replace("fonticon-color-display","fonticon-color-active"))})(),infoIconInActive:()=>(function(){var e=document.querySelector("#routeInfoIcon");e&&e.className.indexOf("fonticon-color-active")>-1&&(e.className=e.className.replace("fonticon-color-active","fonticon-color-display"))})(),hideChannel3:()=>t(),showChannel3:()=>o(),infoIconIsActive:()=>document.querySelector("#routeInfoIcon").className.indexOf("fonticon-color-active")>-1,collapseIcon:t=>(function(t){var o=document.querySelector("#routeHeaderContainer");if(t&&"template"==t&&(o=document.querySelector("#templateHeaderContainer")),o&&o.className.indexOf("minimized")>-1){var n=document.querySelector("#expandCollapse");n.className.indexOf("wux-ui-3ds-expand-up")>-1&&(n.className=n.className.replace("wux-ui-3ds-expand-up","wux-ui-3ds-expand-down"),n.title=e.idCardHeaderActionExpand)}})(t),hideThumbnail:()=>n(),showThumbnail:()=>i(),resizeIDCard:e=>s(e)}}),define("DS/ENORouteMgmt/Config/RouteTaskContentToReviewGridViewConfig",["i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e){"use strict";return[{text:e.title,dataIndex:"tree"}]}),define("DS/ENORouteMgmt/Views/Graph/eGraphToolbar",["DS/egraph/utils"],function(e){"use strict";var t,o={};function n(){}function i(){this.hovering=!0}function s(e){this.start=[e.touches[0].clientX,e.touches[0].clientY]}function a(e){return function(){var t,o;o=[this].concat(Array.prototype.slice.call(arguments)),this.state[e]&&(t=this.state[e].apply(this.state,o)),t&&(this.state=t)}}function r(e,t){this.tlb=e,this.elt=document.querySelector(t.query),this.mode=t.mode,this.id=t.id,this.cb=t.cb,this.sm=new o.ButtonStateMachine(this.elt),this.sm.onclick=this.push.bind(this,!1),this.sm.onpress=this.tlb.onBtnPress.bind(this.tlb,this),this.sm.onrelease=this.tlb.onBtnRelease.bind(this.tlb,this),this.keepHighlight=!1}function l(e){this.id=e,this.buttons=[],this.permSel=null,this.tempSel=null,this.highlighted=null}function d(e,t,o){r.call(this,e,t),this.group=o,t.selected&&this.group.select(this)}function u(e,t){var o;if(!t.group)throw new Error("missing group property on radio button");e.groups.hasOwnProperty(t.group)||(e.groups[t.group]=new l(t.group)),(o=e.groups[t.group]).buttons.push(this),d.call(this,e,t,o)}function c(e,t){d.call(this,e,t,new l("<flag-group>"))}function m(e,t){r.call(this,e,t),t.expand&&(this.expand=document.querySelector(t.expand),this.expandElt=document.createElement("div"),this.expandElt.className="expanded",this.expandElt.style.display="none",this.elt.appendChild(this.expandElt))}return n.prototype.mousedown=function(e,t){if(0===t.button)return t.preventDefault(),t.stopPropagation(),e.onpress(e.elt),new i},i.prototype.isHovering=function(e,t){var o;for(o=t.target;o;o=o.parentNode)if(o===e.elt)return!0;return!1},i.prototype.mouseover=function(e,t){this.hovering||(this.hovering=!0,e.onpress(e.elt))},i.prototype.mouseout=function(e,t){this.hovering&&(this.hovering=!1,e.onrelease(e.elt))},i.prototype.mouseup=function(e,t){if(0===t.button)return t.preventDefault(),t.stopPropagation(),e.onrelease(e.elt),this.isHovering(e,t)&&e.onclick(e.elt),new n},n.prototype.touchstart=function(e,t){if(1===t.touches.length)return t.preventDefault(),t.stopPropagation(),e.onpress(e.elt),new s(t)},s.prototype.touchstart=function(e,t){return new n},s.prototype.touchmove=function(e,t){return t.touches.length>1?(e.onrelease(e.elt),new n):Math.abs(t.touches[0].clientX-this.start[0])+Math.abs(t.touches[0].clientY-this.start[1])>30?(e.onrelease(e.elt),new n):(t.preventDefault(),void t.stopPropagation())},s.prototype.touchcancel=function(e,t){return e.onrelease(e.elt),new n},s.prototype.touchend=function(e,t){return e.onrelease(e.elt),e.onclick(e.elt),new n},o.ButtonStateMachine=function(e){this.elt=e,this.state=new n,this.buttons=0,this.boundMouseup=this.mouseup.bind(this),this.elt&&(this.elt.addEventListener("mousedown",this.mousedown.bind(this)),this.elt.addEventListener("mouseover",this.mouseover.bind(this)),this.elt.addEventListener("mouseout",this.mouseout.bind(this)),this.elt.addEventListener("touchstart",this.touchstart.bind(this)),this.elt.addEventListener("touchmove",this.touchmove.bind(this)),this.elt.addEventListener("touchend",this.touchend.bind(this)),this.elt.addEventListener("touchcancel",this.touchend.bind(this)))},o.ButtonStateMachine.prototype.onclick=function(e){},o.ButtonStateMachine.prototype.onpress=function(e){},o.ButtonStateMachine.prototype.onrelease=function(e){},o.ButtonStateMachine.prototype.mousedown_internal=a("mousedown"),o.ButtonStateMachine.prototype.mouseover=a("mouseover"),o.ButtonStateMachine.prototype.mouseout=a("mouseout"),o.ButtonStateMachine.prototype.mouseup_internal=a("mouseup"),o.ButtonStateMachine.prototype.touchstart=a("touchstart"),o.ButtonStateMachine.prototype.touchmove=a("touchmove"),o.ButtonStateMachine.prototype.touchend=a("touchend"),o.ButtonStateMachine.prototype.mousedown=function(e){0===this.buttons&&document.body.addEventListener("mouseup",this.boundMouseup),this.buttons|=1<<e.button,this.mousedown_internal.apply(this,arguments)},o.ButtonStateMachine.prototype.mouseup=function(e){this.buttons&=~(1<<e.button),0===this.buttons&&document.body.removeEventListener("mouseup",this.boundMouseup),this.mouseup_internal.apply(this,arguments)},r.prototype.push=function(){this.tlb.lastCheck&&this.tlb.lastCheck.unselect(),this.cb(this.id),this.tlb.defaultCheck&&this.tlb.defaultCheck.select()},r.prototype.highlight=function(t){t&&(this.keepHighlight=!0),e.classListAdd(this.elt,"selected")},r.prototype.unhighlight=function(t){t&&(this.keepHighlight=!1),this.keepHighlight||e.classListRemove(this.elt,"selected")},r.prototype.show=function(){e.classListRemove(this.elt,"hidden")},r.prototype.hide=function(){e.classListAdd(this.elt,"hidden")},Object.defineProperty(l.prototype,"sel",{get:function(){return this.tempSel||this.permSel},enumerable:!0,configurable:!0}),l.prototype.select=function(e,t){var o;t&&this.tempSel===e||!t&&this.permSel===e||(t?this.tempSel=e:this.permSel=e,(o=this.tempSel||this.permSel)!==this.highlighted&&(this.highlighted&&this.highlighted.unhighlight(!0),this.highlighted=o,this.highlighted&&this.highlighted.highlight(!0)))},l.prototype.toggle=function(e,t){(t?this.tempSel:this.permSel)===e?this.select(null,t):this.select(e,t)},e.inherit(d,r),d.prototype.isSelected=function(){return this.group.sel===this},d.prototype.push=function(e){this.group.select(this,e),this.cb(this.id)},e.inherit(u,d),e.inherit(c,d),c.prototype.push=function(e){this.group.toggle(this,e),this.cb(this.id)},e.inherit(m,r),m.prototype.push=function(){if(this.tlb.lastCheck){if(this.tlb.lastCheck===this)return this.tlb.lastCheck.unselect(),void(this.tlb.defaultCheck&&this.tlb.defaultCheck.select());this.tlb.lastCheck.unselect()}this.select()},m.prototype.select=function(){this.tlb.lastCheck=this,this.expand&&(this.expandElt.style.display="",e.classListAdd(this.expand,"display")),this.tlb.setPermanentHighlight(this),this.cb(this.id,!0)},m.prototype.unselect=function(){(this.tlb.lastCheck=this)&&(this.tlb.lastCheck=null),this.expand&&(this.expandElt.style.display="none",e.classListRemove(this.expand,"display")),this.tlb.setPermanentHighlight(null),this.cb(this.id,!1)},t={check:m,push:r,flag:c,radio:u},o.Toolbar=function(e){var o,n;for(this.lastCheck=null,this.permanentHighlight=null,this.highlight=null,this.buttons={},this.groups={},o=0,n=e.buttons.length;o<n;++o)this.buttons[e.buttons[o].id]=new t[e.buttons[o].mode](this,e.buttons[o]);this.defaultCheck=this.buttons[e.check],this.defaultCheck&&this.defaultCheck.select()},o.Toolbar.prototype.onBtnPress=function(e){this.highlight&&this.highlight.unhighlight(),this.highlight=e,e.highlight()},o.Toolbar.prototype.onBtnRelease=function(e){this.highlight===e&&(e.unhighlight(),this.highlight=this.permanentHighlight,this.highlight&&this.highlight.highlight())},o.Toolbar.prototype.setPermanentHighlight=function(e){this.permanentHighlight!==e&&(this.highlight===this.permanentHighlight&&this.highlight&&(this.highlight.unhighlight(),this.highlight=null),this.permanentHighlight=e,this.highlight||(this.highlight=e,this.highlight&&this.highlight.highlight()))},o}),define("DS/ENORouteMgmt/Config/InitiateRouteTabsConfig",["DS/Core/Core","UWA/Drivers/Alone","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o){"use strict";return[{label:o.infoPropertiesTab,id:"properties",isSelected:!0,icon:{iconName:"attributes",fontIconFamily:WUXManagedFontIcons.Font3DS,orientation:"horizontal"},content:t.createElement("div",{id:"iRoutePropertiesContainer",class:"route-properties-container"}),loader:"DS/ENORouteMgmt/Views/Loader/InitiateRoutePropertiesLoader"},{label:o.content,id:"content",icon:{iconName:"docs",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"iRouteContentsContainer",class:"iroute-contents-container"}),loader:"DS/ENORouteMgmt/Views/Loader/InitiateRouteContentsLoader"},{label:o.tasks,id:"tasks",icon:{iconName:"flow-tree",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"iRouteTasksContainer",class:"iroute-tasks-container"}),loader:"DS/ENORouteMgmt/Views/Loader/InitiateRouteTasksLoader"}]}),define("DS/ENORouteMgmt/Components/Wrappers/WrapperTileView",["DS/CollectionView/ResponsiveTilesCollectionView"],function(e){"use strict";let t,o,n,i=function(t,i,s){return n=i||UWA.createElement("div",{id:"TileViewContainer",class:"tile-view-container hideView"}),s||(s=!1),(o=new e({model:t,allowUnsafeHTMLContent:!0,useDragAndDrop:s,displayedOptionalCellProperties:["description","contextualMenu"]})).getContent().style.top="50 px",o.inject(n),n};return t={build:(e,t,o)=>i(e,t,o),tileView:()=>o,getSelectedRows:()=>(function(e){for(var t={},o=[],n=e.TreedocModel.getSelectedNodes(),i=0;i<n.length;i++)o.push(n[i].options.grid);return t.data=o,t})(o)}}),define("DS/ENORouteMgmt/Config/ContentToReviewGridViewConfig",["i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e){"use strict";return[{text:e.title,dataIndex:"tree"}]}),define("DS/ENORouteMgmt/Commands/CommandAvailableOnSelect",["UWA/Core","UWA/Class","DS/PADUtils/PADContext"],function(e,t,o){"use strict";return t.extend({init:function(e,t){this._parent(e,t),o.get()&&(this._check_select(),o.get().getPADTreeDocument().getXSO().onChange(this._check_select.bind(this)))},_check_select:function(){var e=o.get().getPADTreeDocument().getXSO().get(),t=e.length,n=!(!t||!0===this.options.cmd_selection_single&&1!==t);if(null!=this.isAvailable){var i=this;i.selectedObjects=e,n=this.isAvailable(e,function(e,t){t==i.selectedObjects&&(e?i.enable():i.disable())})}else!0===n?this.enable():this.disable()}})}),define("DS/ENORouteMgmt/Views/Form/CustomFieldUtils",[],function(){"use strict";let e=function(e){return JSON.parse(e.viewConfig).attributeType};return{getFieldType:e=>(function(e){let t=JSON.parse(e.viewConfig),o=t.attributeType;switch(t.type){case"text":return"Editor";case"number":case"real":return"real"===o&&e.units?"LineEditor with Unit":"LineEditor";case"date":return"DatePicker";case"select":return"ComboBox";case"checkbox":return"Toggle";default:return}})(e),isReadOnlyField:e=>(function(e){return"true"!==JSON.parse(e.viewConfig).readWrite})(e),isMandatoryField:e=>(function(e){return!0===e.mandatory})(e),getRangeElementsList:e=>(function(e){let t=e.range.item,o=[];return t.forEach((e,t)=>{let n={labelItem:e.display,valueItem:e.value};o.push(n)}),o})(e),isBooleanField:e=>(function(e){return"checkbox"===JSON.parse(e.viewConfig).type})(e),isDateField:e=>(function(e){return"date"===JSON.parse(e.viewConfig).type})(e),getMaxLength:t=>(function(t){let o=JSON.parse(t.viewConfig);if("string"==e(t))return o.maxlength})(t),getAttributeType:t=>e(t),getDefaultUnit:e=>(function(e){let t="";return e.units&&e.units.item.forEach(e=>{!0===e.default&&(e.display=e.display.replace("x","."),e.display=e.display.replace("_","/"),t=e)}),t})(e),isMultiValueField:e=>(function(e){return!0===JSON.parse(e.viewConfig).multivalue})(e)}}),define("DS/ENORouteMgmt/Config/WelcomePanelActionsConfig",["DS/Core/Core","UWA/Drivers/Alone","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o){"use strict";return{routes:{id:"routes",content:"summary_page",loader:{module:"DS/ENORouteMgmt/Views/RouteSummaryView",func:"build"}},route_templates:{id:"route_templates",content:"summary_page",loader:{module:"DS/ENORouteTemplateMgmt/Views/TemplateSummaryView",func:"build"}},new_route:{id:"new_route",content:"dialog",loader:{module:"DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog",func:"InitiateRouteDialog"}},new_route_template:{id:"new_route_template",content:"dialog",loader:{module:"DS/ENORouteTemplateMgmt/Views/Dialogs/InitiateTemplateDialog",func:"InitiateTemplateDialog"}}}}),define("DS/ENORouteMgmt/Config/TaskAttachmentsGridViewConfig",["i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e){"use strict";return[{text:e.title,dataIndex:"tree"}]}),define("DS/ENORouteMgmt/Utilities/CopyLinkContentAppId",["text!DS/ENORouteMgmt/assets/json/ContentAppListJson.json"],function(e){"use strict";let t;var o=JSON.parse(e);let n=function(e){var t="";return Object.entries(o).forEach(([o,n])=>{for(let i=0;i<n.length;i++)e==n[i]&&(t=o)}),t};return t={getAppId:e=>n(e),isCopyLink:e=>(function(e){return""==n(e)?"false":"true"})(e)}}),define("DS/ENORouteMgmt/Utilities/RouteViewUtils",["i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e){"use strict";let t=function(t){let o,n;if(t)return t.contains("(")?(o=t.split("(")[0],n=t.split("(")[1],o=o.toLowerCase().replace(/ /g,""),e[o]+" ("+n):(t=t.toLowerCase().replace(/ /g,""),t=e[t])},o=function(e){let t="";if(e)return e.contains("Awaiting")?t="hourglass":"Approved"==e?t="thumbs-up":"Commented"==e?t="comment":"Stopped"==e?t="stop":"Rejected"==e?t="thumbs-down":"Notified"==e?t="notification-read":"Not Started"==e?t="play-flash-off":"Abstained"==e&&(t="ignore"),t};return{getRouteActivityState:e=>(function(e){let n=e.Activity_State,i=t(n),s={icon:o(n),label:i};return n&&n.contains("your")?(s.func=function(e){widget.data.openTaskProperties=!0,widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:e.context.nodeModel.options.grid})},s.icon+=" awaiting-tasks"):s.func=void 0,s})(e),getRouteActivityStateNLS:e=>t(e),getRouteActivityStateIcon:e=>o(e),getRouteRevision:e=>(function(e){return{label:e.revision,icon:" ",func:function(t){require(["DS/ENORouteMgmt/Actions/RouteActions"],function(t){t.renderRevisionsDialog(e.id)})}}})(e),getRouteActions:t=>(function(t){var o=[];return t?(-1!==t.indexOf("edit.startroute")&&o.push(e.start),-1!==t.indexOf("edit.stoproute")&&o.push(e.stop),-1!==t.indexOf("edit.resumeroute")&&o.push(e.resume),-1!==t.indexOf("edit.restartroute")&&o.push(e.restart),o):o})(t),getRouteActionIcon:e=>(function(e){let t={};if(e)return-1!==e.indexOf("edit.startroute")&&(t.name="status-change",t.color="orange"),-1!==e.indexOf("edit.stoproute")&&(t.name="stop",t.color="red"),t})(e),isRouteActionStart:e=>(function(e){return-1!==e.indexOf("edit.startroute")})(e),getAvatarDetails:e=>(function(e){var t={},o="NA",n="rgb( 245,100,163 )",i=[[7,139,250],[249,87,83],[111,188,75],[158,132,106],[170,75,178],[26,153,123],[245,100,163],[255,138,46]],s=e.replace(/  +/g," ").trim().split(" "),a=s[0].toUpperCase(),r=s[s.length-1].toUpperCase();if(null!=a[0]&&null!=r[0]){o=a[0]+r[0];var l=Math.ceil((a.charCodeAt(0)+r.charCodeAt(0))%i.length);n="rgb("+i[l][0]+","+i[l][1]+","+i[l][2]+")"}return t.name=e,t.avatarStr=o,t.avatarColor=n,t})(e)}}),define("DS/ENORouteMgmt/Utilities/Utils",["DS/UIKIT/Alert","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){"use strict";var o={formatDateString:function(e){var t,n;return o.isValidDate(e)?UWA.is(o.getCookie("swymlang"))&&UWA.is(window.Intl)?(t={weekday:"short",year:"numeric",month:"short",day:"2-digit"},n=new Intl.DateTimeFormat(o.getCookie("swymlang"),t).format(e)):n=e.toDateString():n="",n},isValidDate:function(e){return UWA.is(e,"date")&&!isNaN(e.getTime())},getLocaleDate:function(e,t){const n={weekday:"long",year:"numeric",month:"long",day:"numeric"};if(t){let t=o.getCookie("swymlang");return null!=t?e.toLocaleString(t,n):e.toLocaleString("en",n)}return e.toLocaleString("en",n)},getLocaleTime:function(e,t){const n={weekday:"long",year:"numeric",month:"long",day:"numeric"};if(t){let t=o.getCookie("swymlang");return null!=t?e.toLocaleTimeString(t,n):e.toLocaleTimeString("en",n)}return e.toLocaleTimeString("en",n)},getCookie:function(e){var t=("; "+document.cookie).split("; "+e+"=");if(t.length>=2)return t.pop().split(";").shift()},reloadFacetObjects:function(e,t){if(e)for(var o=0;o<e.length;o++)t.indexOf(e[o].reference)>-1&&("taskgraph"===e[o].reference?e[o].view&&(e[o].view.destroy(),e[o].view=null):e[o].view.reload())},encodeHTMLEntites:function(e){return e.toString().replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")},decodeHTMLEntites:function(e){return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},initHelpSystem:function(e,t){require(["DS/TopBarProxy/TopBarProxy"],function(n){if(!n[widget.id]){n[widget.id]=new n({id:widget.id});var i,s=!0;n[widget.id].setContent({help:[{label:t,onExecute:function(){if(s){var t=o.getCookie("swymlang")||"English";s=!1,i="http://help.3ds.com/HelpDS.aspx?P=11&L="+t+"&F="+e+"&contextscope=onpremise"}i?window.open(i,"_blank"):alert("The help system is not available. Please contact your system administrator.")}}]})}})},getPrecondForContentSearch:function(){for(var e=widget.data.routeContentSearchTypes.split(","),t="flattenedtaxonomies:(",o=e.length,n=0;n<o;n++)t+='"types/'+e[n]+'"',n<o-1&&(t+=" OR "),n===o-1&&(t+=")");return t},strLength:function(e){for(var t=e.split(""),o=0,n=0;n<t.length;n++){var i=t[n],s=encodeURIComponent(i);1==s.length?o++:o+=s.split("%").length-1}return o},activateInfoIcon:function(e){if(e.getGridViewToolbar()){let t=e.getGridViewToolbar().getNodeModelByID("information");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&t._associatedView.elements.container.querySelector(".wux-controls-button").setStyle("color","rgb(54, 142, 196)")}},inActivateInfoIcon:function(e){if(e.getGridViewToolbar()){let t=e.getGridViewToolbar().getNodeModelByID("information");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&t._associatedView.elements.container.querySelector(".wux-controls-button").setStyle("color","rgb(61, 61, 61)")}},refreshRightPanel:function(e,t,o){if(widget.getValue("propWidgetOpen"))if(o){let t={};t.model=o,widget.routeMgmtMediator.publish("route-header-info-click",{model:t.model,info:e})}else if(t&&1==t.getSelectedRowsModel().data.length){let o={};o.model=t.getSelectedRowsModel().data[0].options.grid,widget.routeMgmtMediator.publish("route-header-info-click",{model:o.model,info:e})}else widget.routeMgmtMediator.publish("route-header-info-click",{info:e})},clearSummaryPage:function(){let e=document.querySelector(".widget-container"),t=e.children.length;for(let o=0;o<t;o++)e.children[0].remove()}};return o}),define("DS/ENORouteMgmt/Views/Grid/RouteMembersGridCustomColumns",["DS/Controls/Button","DS/Controls/TooltipModel","UWA/Drivers/Alone","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n){"use strict";return{onMemberActionCellRequest:e=>(function(e){require(["DS/ENORouteMgmt/Views/Menu/MemberContextualMenu"],function(o){var i=e.cellView.getContent(),s="";if(!e.isHeader){var a=[];a.push(e.nodeModel.options.grid.id),(s=UWA.createElement("div",{html:o.routeMemberGridCheveron(e.nodeModel.options.grid,a)})).tooltipInfos=new t({shortHelp:n.actions,allowUnsafeHTMLShortHelp:!0})}i.setContent(s)})})(e)}}),define("DS/ENORouteMgmt/Components/Notifications",["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t){"use strict";let o=null,n=function(){o=e,t.setNotificationManager(o),t.setStackingPolicy(9)};return n.prototype.handler=function(){return document.getElementById("initiateRoute")?(t.inject(document.getElementById("RouteImmersiveFrame")),document.getElementById("initiateRoute").scrollIntoView()):document.getElementById("initiateTemplate")?(t.inject(document.getElementById("initiateTemplate")),document.getElementById("initiateTemplate").scrollIntoView()):document.getElementById("saveAsTemplate")?(t.inject(document.getElementById("saveAsTemplate")),document.getElementById("saveAsTemplate").scrollIntoView()):document.getElementById("assigneeWarning")?t.inject(document.getElementById("assigneeWarning")):document.getElementById("selectUsers")?t.inject(document.getElementById("selectUsers")):document.getElementsByClassName("wux-notification-screen").length>0||t.inject(document.body),o},n.prototype.notifview=function(){return t},n}),define("DS/ENORouteMgmt/Model/RouteInfoHistoryModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WebappsUtils/WebappsUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n){"use strict";let i=new e({useAsyncPreExpand:!0,shouldBeSelected:function(e){return!1}});return{getModel:e=>(function(e){let s,a,r,l,d,u,c,m,p,g,f,h,w,v,S,R;return i.prepareUpdate(),e.forEach(function(e){for(s=e.state,a=s.length-1;a>=0;a--){r=e.Time[a],"User Agent"==(l=e.userName[a])&&(l="System Admin"),"create"==(d=e.routeAction[a])&&(d="action_create"),u=e.description[a],S=u.indexOf("with Comments:"),R=u.substring(0,S),S=R.indexOf("with electronic signature"),c=u.substring(u.indexOf("with Comments:")+14),m=u.match(/'(.*?)'/g),p="",g="",f="",h="";var y=!1;if("(Approve)"==d||"(Reject)"==d||"(None)"==d||"(Abstain)"==d||"(Review_Promote)"==d||"(Review_Demote)"==d){w=m[0],v=w.replace(/'/g,""),p=v.replace("Inbox Task",n.RouteTask).trim();try{var M=p.split(",")[0],T=p.split(",")[2].split("|")[1];p=M+" "+T}catch(e){y=!0}if(g=o.getWebappsAssetUrl("ENORouteMgmt","icons/48/I_RouteTask48.png"),(f=n.historyComment+c.replace(/'/g,"")).contains("Auto-Completed")&&(p.contains("|")&&(p=n.RouteTask+" '"+p.split("|")[1]+"'"),(f=f.split(":")[2]).contains("|")))try{var b=f.split("|")[1].split(" ")[0],C=f.split("|")[2].split(" ")[0];f=n.replace(n.taskAutoCompleteComment,{tag1:b,tag2:C})}catch(e){}-1==S?h=n.replace(n.taskDescription,{tag1:p,tag2:n[d],tag3:l}):S>0&&(h=n.replace(n.taskDescriptionESign,{tag1:p,tag2:n[d],tag3:l}))}else if("(Assignment)"==d){let e=c.split(","),t=(e[0].split(":"),e[1].split(":")),i=e[2].split(":"),s=e[3].split(":");e[4].split(":"),e[5].split(":"),g=o.getWebappsAssetUrl("ENORouteMgmt","icons/48/I_RouteTask48.png");let a=n.RouteTask+" "+t[1]+" "+i[1];h=n.replace(n.changeAssigneeDescription,{tag1:a,tag2:s[1]})}else if("change owner"==d){g=o.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png");let e=u.split("|")[0],t=u.split("|")[1];h=n.replace(n.changeOwnerDescription,{tag1:t,tag2:e})}else"(Auto Complete)"==d?(g=o.getWebappsAssetUrl("ENORouteMgmt","icons/48/I_RouteTask48.png"),h=n.replace(n.markasComplete,{tag1:u})):"action_create_subroute"==d?(g=o.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png"),h=n.replace(n.subRouteCreation,{tag1:u,tag2:l})):"action_disconnect_subroute"==d?(g=o.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png"),h=n.replace(n.subRouteDisconnect,{tag1:u})):(g=o.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png"),p=e.name,"(Stop)"!=d&&"(Finish)"!=d||"System Admin"!=l?"promote"==d&&"System Admin"==l?h=n.routePromoteDescription:"(Stop)"==d&&""!=u?(f=n.historyComment+u.replace(/'/g,""),h=n.replace(n.routeDescriptionDetail,{tag2:n[d],tag3:l})):h=n.replace(n.routeDescriptionDetail,{tag2:n[d],tag3:l}):h=n.replace(n.routeDescription,{tag2:n[d]}));var D=e.physicalid[a];y&&(S=0);var k=new t({label:h,subLabel:r,thumbnail:g,description:f,contextualMenu:S>0,data:D});i.addRoot(k)}}),i.pushUpdate(),i})(e),destroy:()=>{i=new e({useAsyncPreExpand:!0,shouldBeSelected:function(e){return!1}})}}}),define("DS/ENORouteMgmt/Views/Form/FormElements",["DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Controls/DatePicker","DS/Controls/Editor","DS/WUXAutoComplete/AutoComplete"],function(e,t,o,n,i,s){"use strict";return{createElement:(a,r,l)=>(function(a,r,l){switch(l){case"lineEditor":return new e(r).inject(a);case"Editor":return new t(r).inject(a);case"DatePicker":return new i(r).inject(a);case"ComboBox":return new n(r).inject(a);case"Toggle":return new o(r).inject(a);case"AutoComplete":return new s(r).inject(a);default:return}})(a,r,l)}}),define("DS/ENORouteMgmt/Config/Toolbar/InitiateRouteContentTabToolbarConfig",["i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e){let t;return t={writetoolbarDefination:t=>(function(t){var o={entries:[{id:"addExistingContent",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"plus",fontIconFamily:WUXManagedFontIcons.Font3DS}},action:{module:"DS/ENORouteMgmt/Views/Loader/InitiateRouteAddContentSearchLoader",func:"onSearchClick"},position:"far",category:"create",tooltip:e.addExistingContent},{id:"removeContent",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"remove",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Views/InitiateRouteContentsView",func:"removeContents"}},position:"far",category:"action",tooltip:e.deleteContent}]};return JSON.stringify(o)})(),destroy:function(){_dataGrid.destroy(),_container.destroy()}}}),define("DS/ENORouteMgmt/Config/RouteTabsConfig",["DS/Core/Core","UWA/Drivers/Alone","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o){"use strict";return[{label:o.tasks,id:"tasks",isSelected:!0,icon:{iconName:"flow-tree",fontIconFamily:WUXManagedFontIcons.Font3DS,orientation:"horizontal"},content:t.createElement("div",{id:"routeTasksContainer",class:"route-tasks-container"}),loader:"DS/ENORouteMgmt/Views/Loader/TaskGraphicalViewLoader"},{label:o.content,id:"content",icon:{iconName:"docs",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"routeContentsContainer",class:"route-contents-container"}),loader:"DS/ENORouteMgmt/Views/RouteContentsView"},{label:o.members,id:"members",icon:{iconName:"users",fontIconFamily:WUXManagedFontIcons.Font3DS},allowClosableFlag:!1,content:t.createElement("div",{id:"routeMembersContainer",class:"route-members-container"}),loader:"DS/ENORouteMgmt/Views/RouteMembersView"}]}),define("DS/ENORouteMgmt/EnoviaBootstrap",["UWA/Core","UWA/Class/Collection","UWA/Class/Listener","UWA/Utils","DS/ENORouteMgmt/Utilities/Utils","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOXWidgetPreferences/js/ENOXWidgetPreferences","DS/WAFData/WAFData"],function(e,t,o,n,i,s,a,r,l){"use strict";var d,u,c,m,p,g,f,h,w,v,S,R=!1,y=!1;return p=e.merge(o,{authenticateRequest:function(t,o){var n,s,a,r,d;if(u&&(n=u.getStorageWithUrl(t)),e.is(n)){t!==(r="url",(a=n)&&(d=a[r],e.is(d,"function")&&(d=d.call(a))),d)&&(o||(o={}),o.headers||(o.headers={}),o.headers["X-DS-CSRFTOKEN"]=c||"");var m=n.id;void 0!==widget.data.ids&&(m=p.getTenantValue()),(t=t+(-1===t.indexOf("?")?"?":"&")+"tenant="+m).includes("/bps/cspaces")||p.getSecurityContextValue()&&(t=t+"&SecurityContext="+encodeURIComponent(p.getSecurityContextValue()));const s=new Date;if(s){const e=s.getTimezoneOffset()/60;e&&(t=t+"&timezone="+e)}widget.debugMode&&(t+="&$debug=true"),i.getCookie("swymlang")&&(t=t+"&$language="+i.getCookie("swymlang"))}return"undefined"!=typeof widget&&widget&&widget.data&&widget.data.routeCredentials&&(t=p.modifyURL(t,widget.data.routeCredentials)),s=o.onComplete,o.onComplete=function(t,o,n){c=o["X-DS-CSRFTOKEN"],e.is(s,"function")&&s(t,o,n)},l.authenticatedRequest(t,o)},start:function(t){if(!R){t.frameENOVIA&&(y=!0),t=t?e.clone(t,!1):{},u=t.collection,function(e){if(d)return d;var t="com.ds."+e.id;(d=new n.InterCom.Socket(t)).subscribeServer("com.ds.compass",window.parent)}(t),g||a.getServiceUrl({serviceName:"3DSwym",onComplete:function(e){var t;if(g=e,(t=m&&m.id?m.id:p.getTenantValue())&&g)for(var o=0;o<g.length;o++)if(t===g[o].platformId){f=g[o].url;break}},onFailure:function(e){g=[]}}),v||a.getServiceUrl({serviceName:"3DSearch",onComplete:function(e){var t;if(v=e,(t=m&&m.id?m.id:p.getTenantValue())&&v)for(var o=0;o<v.length;o++)if(t===v[o].platformId){S=v[o].url;break}},onFailure:function(e){v=[]}}),function(){if(h)return h;var e=p.getTenantValue();a.getServiceUrl({serviceName:"3DSpace",platformId:e,onComplete:function(e){h="string"==typeof e?e:e[0].url},onFailure:function(){h=""}})}(),function(){if(w)return w;var e=p.getTenantValue();a.getServiceUrl({serviceName:"3DDashboard",platformId:e,onComplete:function(e){w="string"==typeof e?e:e[0].url},onFailure:function(){w=""}})}(),function(){var e=UWA.is(widget.getValue("X3DContentId"),"string")?JSON.parse(widget.getValue("X3DContentId")):null;if(null==widget.getValue("linkedContextTitle")&&(widget.setValue("approvalProcessIds",void 0),widget.setValue("approvalProcessType",void 0)),null==e&&"true"!=widget.getValue("isWidgetRefreshed")?e=widget.getValue("compassDataForContext"):widget.setValue("compassDataForContext",e),e&&e.data.items&&("Route"===e.data.items[0].objectType||"Route Template"===e.data.items[0].objectType||"Inbox Task"===e.data.items[0].objectType)){if(e.data.approvalObjectType)if("Inbox Task"===e.data.approvalObjectType)widget.data.contentId=e.data.items[0].objectId,widget.data.contentType=e.data.approvalObjectType,widget.data.taskId=e.data.items[0].objectId,widget.data.contextTitle=e.data.items[0].contextTitle,widget.data.contextId=e.data.items[0].contextId,widget.data.linkedContextTitle=e.data.items[0].linkedContextTitle;else{for(var t=[],o=0;o<e.data.items.length;o++)t.push(e.data.items[o].objectId);widget.data.approvalProcessIds=t,widget.data.approvalProcessType=e.data.approvalObjectType,widget.data.contextTitle=e.data.items[0].contextTitle,widget.data.contextId=e.data.items[0].contextId,widget.data.linkedContextTitle=e.data.items[0].linkedContextTitle}else widget.data.contentId=e.data.items[0].objectId,widget.data.contentType=e.data.items[0].objectType;"Inbox Task"===e.data.items[0].objectType&&(widget.data.taskId=e.data.items[0].objectId,widget.data.contextTitle=e.data.items[0].contextTitle,widget.data.contextId=e.data.items[0].contextId,widget.data.linkedContextTitle=e.data.items[0].linkedContextTitle),widget.setValue("routefilters",["owned","assigned","Define","In Process","Complete"]),widget.setValue("X3DContentId",null)}}();try{n.Client.Platform.windows&&require(["DS/MSFDocumentManagement/WidgetIntegration"],function(e){widget.MSFDocumentClient=e,widget.MSFDocumentClient.ConnectWidgetWithMSF()})}catch(e){console.error(e)}R=!0}},updateURLsOnEdit:function(e){let t=p.getTenantValue();var o=e.get(t);if(h=o._attributes.url,t&&g)for(var n=0;n<g.length;n++)if(t===g[n].platformId){f=g[n].url;break}},getLoginUser:function(){if("undefined"!=typeof dscef&&widget.getValue("native_user_info")&&1==widget.getValue("native_user_info").isNative)return widget.getValue("native_user_info").contextUser;var e=s.getUser();return e&&e.login?e.login:void 0},getLoginUserFullName:function(){var e=s.getUser();if(e&&e.login)return e.firstName+" "+e.lastName},getLoginUserEmail:function(){var e=s.getUser();if(e&&e.email)return e.email},getCompassSocket:function(){if(R)return d},getSyncOptions:function(){return y?{}:{ajax:l.authenticatedRequest}},getStorages:function(){if(R)return u},getStorage:function(){if(R)return m},get3DSpaceURL:function(){if(R)return h},getDashboardURL:function(){if(R)return w},getRouteServiceBaseURL:function(){if(R)return h+"/resources/v1/modeler/routes"},getRouteTemplateServiceBaseURL:function(){if(R)return h+"/resources/v1/modeler/routetemplates"},getCollabTaskServiceBaseURL:function(){if(R)return h+"/resources/v1/modeler/tasks"},getSNIconServiceBaseURL:function(){if(R)return h+"/snresources/images/icons/large"},getDocumentServiceBaseURL:function(){if(R)return h+"/resources/v1/modeler/documents"},get6WServiceBaseURL:function(){if(R)return h+"/resources/v3/e6w/service"},getSwymUrl:function(){if(f)return f},getSearchUrl:function(){if(S)return S},modifyURL:function(e,t){return t&&(t.tenant&&(e=e+(-1===e.indexOf("?")?"?":"&")+"tenant="+t.tenant),t.noSecurityContextForSearch||widget&&widget.data&&widget.data.noSecurityContextForSearch||t.securityContext&&(e=e+"&SecurityContext="+encodeURIComponent(t.securityContext)),i.getCookie("swymlang")&&(e=e+"&$language="+i.getCookie("swymlang"))),e},getTenantValue:function(){return widget.data.routeCredentials?widget.data.routeCredentials.tenant:widget.getValue("x3dPlatformId")},getSecurityContextValue:function(){var e="";if(widget.data.routeCredentials)e=widget.data.routeCredentials.securityContext;else{var t=r.getCredentialPreferenceKey();e="ctx::"+widget.getValue(t)}return e},getCSRFToken:function(){return new Promise(function(t,o){l.authenticatedRequest(h+"/resources/v1/application/E6WFoundation/CSRF",e.extend({method:"GET",onComplete:function(e){t(e)}}))})}})}),define("DS/ENORouteMgmt/Utilities/VersionFacetIntegration",["DS/ENOXVersionExplorerController/VersionExplorerController","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerViews/VersionExplorerModal","DS/ENORouteMgmt/EnoviaBootstrap","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a){"use strict";var r={};let l=function(e,t){console.log("Cancel Pressed"),r._myVersionExplorer.unsubscribeAll()};return{launchVersionControlApp:(a,d)=>(function(a,d){s.sendRouteTrackerEvent({event:"TemplateCommand",value:"Template - Revisions"}),r.oldTemplateId=a;var u=UWA.createElement("div",{class:"revisionUpdate-dialog"}).inject(document.body);r._myVersionExplorer=new e({versionGraphContainer:null,selectionMode:o.SELECTION_MODES.SINGLE_SELECT_ONLY,widget:widget}),r._myVersionExplorer.disableDrag(),r._myVersionExplorer.showDialog({x:100,y:100},u,!0),t.loadUserSettingsPromise({displayMode:o.DISPLAY_MODES.SUBWAY_VIEW,displayLegend:!0},!0),r._myVersionExplorer.subscribeEvent("ENOXVersionExplorerModalCancel",l.bind(this)),r._dlgVersionExplorer=n._dlg,n._dlg&&n._dlg.rightButtons&&n._dlg.rightButtons.addEventListener("click",l.bind(this)),r._myVersionExplorer.publishEvent("ENOXVersionExplorerLoadVersionModel",{id:r.oldTemplateId,tenantId:i.getTenantValue(),securityContext:i.getSecurityContextValue().split("ctx::")[1],onComplete:function(){},dataModelType:o.DATA_MODEL_TYPES.MODEL_HISTORY}),r._dlgVersionExplorer.getFooter().getChildren()[0].hide()})(a)}}),define("DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView",["DS/DataGridView/DataGridView","DS/ENORouteMgmt/EnoviaBootstrap","DS/DataGridView/DataGridViewLayout","DS/Controls/Label","UWA/Drivers/Alone"],function(e,t,o,n,i){"use strict";let s,a,r,l,d={rowsHeader:!1},u=function(t,n,i,s,u){if(u.identifier=u.identifier+"-"+widget.id,u&&1==u.showRowCount&&(d.rowsHeader=!0),u&&u.layoutOptions?delete u[d=u.layoutOptions]:d={rowsHeader:!1},l={identifier:u.identifier,treeDocument:t,useWidgetPreferencesFlag:!0,columns:n,layout:new o(d),defaultColumnDef:{widthd:"auto",typeRepresentation:"string"},virtuallyLoadAllModelItems:!0,rowGroupingEnabledFlag:!1},u)for(let e in u)u.hasOwnProperty(e)&&(l[e]=u[e]);var m;return(a=new e(l)).layout.cellHeight=35,a.rowSelection="multiple",a.cellSelection="none",a.getContent().style.top="50 px",i&&(m=i,m=JSON.parse(m),r=a.setToolbar(JSON.stringify(m))),c(),function(e){if(widget.getValue("wux-collectionView-dataGridView"))try{const t=JSON.parse(widget.getValue("wux-collectionView-dataGridView"))[e.identifier];t&&e.loadCustomViews(t.customViews,t.currentCustomViewId)}catch(e){console.log("error in fetching data grid persistence")}}(a),a.inject(s),s},c=function(){a.registerReusableCellContent({id:"_state_",buildContent:function(){let e=UWA.createElement("div");return UWA.createElement("span",{html:"",class:"route-state-title "}).inject(e),e}}),a.registerReusableCellContent({id:"_assignee_",buildContent:function(){new UWA.Element("div",{class:"members"}),new UWA.Element("div",{class:"assignee"});let e=UWA.createElement("div");return UWA.createElement("span",{html:"",class:"route-state-title "}).inject(e),e}}),a.registerReusableCellContent({id:"_owner_",buildContent:function(){var e=new UWA.Element("div",{}),o=new UWA.Element("div",{class:"assignee"});(null!=t.getSwymUrl()?UWA.createElement("img",{class:"userIcon"}):UWA.createElement("div",{html:"",class:"avatarIcon"})).inject(o),UWA.createElement("span",{class:"askRTOwnerDiv wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-user-clock",html:""}).inject(o).setStyle("display","none");var n=UWA.createElement("span",{class:"userName",html:""});return o.inject(e),n.inject(e),e}}),a.registerReusableCellContent({id:"_duedate_",buildContent:function(){let e=UWA.createElement("div",{class:"task-duedate-column"}),t=UWA.createElement("span",{html:"",class:"task-duedate-status wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attention"}).inject(e);t.setStyle("color","red"),t.setStyle("display","none");let o=UWA.createElement("span",{html:"",class:"task-duedate-status wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-clock"}).inject(e);return o.setStyle("color","orange"),o.setStyle("display","none"),new n({value:""}).inject(e),e}})};return s={build:(e,t,o,n,i)=>u(e,t,o,n,i),dataGridView:()=>a,destroy:function(){a.destroy(),(void 0).destroy()},dataGridViewToolbar:()=>r,getSelectedRowsModel:e=>(function(e){for(var t={},o=[],n=e.getSelectedNodes(),i=0;i<n.length;i++)o.push(n[i]);return t.data=o,t})(e),deleteRowModelByIndex:(e,t)=>(function(e,t){var o=e.getNthRoot(t);o&&(e.prepareUpdate(),e.removeRoot(o),e.pushUpdate())})(e,t),deleteRowModelSelected:e=>(function(e){let t=[];var o=e.getSelectedNodes();e.prepareUpdate();for(var n=0;n<o.length;n++)e.removeRoot(o[n]),t.push(o[n].options.id);return e.pushUpdate(),t})(e),deleteRowModelById:(e,t)=>(function(e,t){for(var o=e.getChildren(),n=0;n<o.length;n++)o[n].options.id==t&&(e.prepareUpdate(),e.removeRoot(o[n]),e.pushUpdate())})(e,t),deleteRowModelByIds:(e,t)=>(function(e,t){for(var o=e.getChildren(),n=[],i=0;i<o.length;i++)t.includes(o[i].options.id)&&n.push(o[i]);n.forEach(function(t){e.prepareUpdate(),e.removeRoot(t),e.pushUpdate()})})(e,t),getRowModelById:(e,t)=>(function(e,t){for(var o=e.getChildren(),n=0;n<o.length;n++)if(o[n].options.id==t)return o[n]})(e,t),getRowModelIndexById:(e,t)=>(function(e,t){for(var o=e.getChildren(),n=0;n<o.length;n++)if(o[n].options.id==t)return n})(e,t)}}),define("DS/ENORouteMgmt/Utilities/ParseJSONUtil",["UWA/Class","DS/ENORouteMgmt/Utilities/Utils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o){"use strict";var n=e.extend({parseResp:function(e){e.csrf&&(widget.data.csrf=e.csrf);let t=new Array;for(var o=e.data.length,n=0;n<o;n++){t[n]=e.data[n].dataelements,s(e.data[n],t[n]);let o=e.data[n].relateddata;if(o)for(let e in o)o.hasOwnProperty(e)&&(t[n][e]=i(o[e]))}return t},createCSRFForRequest:function(e){return void 0===e&&(e=widget.data.csrf),{csrf:e}},createDataForRequest:function(e,t){void 0===t&&(t=widget.data.csrf);var o={dataelements:e},n=new Array;return n.push(o),{csrf:t,data:n}},createDataForPromoteDemote:function(e,t,o){void 0===o&&(o=widget.data.csrf);var n={updateAction:t,dataelements:e},i=new Array;return i.push(n),{csrf:o,data:i}},createDatasForRequest:function(e,t,o){void 0===o&&(o=widget.data.csrf);for(var n=new Array,i=0;i<e.length;i++){var s={dataelements:e[i],id:t};n.push(s)}return{csrf:o,data:n}},createRemoveSubRouteForRequest:function(e,t,o,n){void 0===n&&(n=widget.data.csrf);for(var i=new Array,s=0;s<e.length;s++){var a={id:e[s],dataelements:{contextObjectId:t,contextObjectType:"Inbox Task",routeOwner:o[s]}};i.push(a)}return{csrf:n,data:i}},createDataWithIdForRequest:function(e,t){var o=[];void 0===t&&(t=widget.data.csrf);for(let t=0;t<e.length;t++){var n={id:e[t]};o.push(n)}return{csrf:t,data:o}},getParsedRouteTasks:function(e){var t={tasks:[]};return e.forEach(e=>{let o="";e.taskDueDate&&""!=e.taskDueDate&&(o=new Date(e.taskDueDate).toISOString()),t.tasks.push({dataelements:{allowDelegation:e.allowDelegation,assigneeId:e.assigneeId,assigneeSetDueDate:e.assigneeSetDueDate,instructions:e.instructions,parallelNodeProcessionRule:e.parallelNodeProcessionRule,taskAction:e.taskAction,taskOrder:e.taskOrder,taskDueDate:o,title:e.title,reviewTask:e.needsOwnerReview,dateOffsetFrom:e.dteOffsetFrom,dueDateOffset:e.dueaDateOffset,needsOwnerReview:e.needsOwnerReview,chooseUsersFromUg:e.chooseUsersFromUg}})}),t}});let i=function(e){let t=new Array;for(var o=e.length,n=0;n<o;n++)t[n]=e[n].dataelements,s(e[n],t[n]);return t},s=function(e,t){return"Group Proxy"!==e.dataelements.assigneeType&&"Group"!==e.dataelements.assigneeType||(t.assigneeTitle=e.dataelements.assigneeTitle),void 0===t.id&&(t.id=e.id),void 0===t.physicalid&&(t.physicalid=e.id),void 0===t.type&&(t.type=e.type),void 0===t.relId&&(t.relId=e.relId),t};return n}),define("DS/ENORouteMgmt/Utilities/Search/SearchUtil",["UWA/Class","DS/UIKIT/Alert","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n){"use strict";let i=function(e){let t={precond:'flattenedtaxonomies:("types/Route Template") AND current:"Active" AND latestrevision:"TRUE" AND route_95_base_95_purpose:"Standard" AND route_95_template_95_valid:"TRUE"'};var o=[];return""!=e&&null!=e&&(!function e(t,o){o.push(t[0].id);if(""==t[0].children)return;e(t[0].children,o)}(e.data,o),t.resourceid_not_in=o),t},s=function(){var e="";return widget.data.routeCredentials&&widget.data.routeCredentials.securityContext?e=widget.data.routeCredentials.securityContext.split("ctx::")[1].split(".")[1]:widget.data.pad_security_ctx?e=widget.data.pad_security_ctx.split("ctx::")[1].split(".")[1]:widget.getPreference("organization")&&(e=widget.getPreference("organization").value),e};return{getRefinementToSnN:(e,t,i,s)=>(function(e,t,i,s){var a={title:n[t],role:"",mode:"furtive",default_with_precond:!0,show_precond:!1,multiSel:i,idcard_activated:!1,select_result_max_idcard:!1,itemViewClickHandler:"",app_socket_id:e,widget_id:e,search_delegation:"3dsearch",default_search_criteria:"",source:["3dspace"],recent_search:{types:s}};return null!=o.getTenantValue()&&(a.tenant=o.getTenantValue()),a.global_actions=[{id:"incontextHelp",title:n["search.help"],icon:"fonticon fonticon-help",overflow:!1}],a})(e,t,i,s),getPrecondForContentSearch:(e,t,o)=>(function(e,t,o){var n="flattenedtaxonomies:(",i=t.length;return t.forEach(function(e,t){n+='"types/'+e+'"',t<i-1&&(n+=" BOR "),t===i-1&&(n+=")")}),""!=e&&void 0!==e&&"Organization"!=e&&"All"!=e?n+=' AND route_95_content_95_scope:"'+e+'"':"Organization"==e&&(null!=o&&""!=o||(o=s()),n+=' AND organization:"'+o+'"'),n})(e,t,o),getPrecondForRouteTemplateSearch:()=>'flattenedtaxonomies:("types/Route Template") AND current:"Active" AND latestrevision:"TRUE" AND route_95_template_95_valid:"TRUE"',getPrecondForScopeSearch:()=>'flattenedtaxonomies:"types/Workspace Vault" OR flattenedtaxonomies:"types/Workspace" OR flattenedtaxonomies:"types/Personal Workspace" OR flattenedtaxonomies:"types/Project Space" AND (identifier:(__QUERY__) OR label:(__QUERY__))',getPrecondForTaskMemberSearch:e=>(function(e){let t={precond:'(flattenedtaxonomies:"types/Person" OR "types/Group") AND current:"active"'};if(!e.Scope)return t;if(e.ScopeMembers||(e.ScopeMembers=[""]),0==e.ScopeMembers.length&&(null!=e.ScopeMembers[0]&&null!=e.ScopeMembers[0]||(e.ScopeMembers=[""])),"OnPremise"==o.getTenantValue())"All"==e.Scope[0]?t.precond='(flattenedtaxonomies:"types/Person" OR "types/Group") AND current:"active"':"Organization"==e.Scope[0]?t.precond='(flattenedtaxonomies:"types/Person" AND current:"active" AND member:"'+s()+'") OR (flattenedtaxonomies:"types/Group" AND current:"active")':(t.precond='(flattenedtaxonomies:"types/Person" OR "types/Group") AND current:"active"',t.resourceid_in=e.ScopeMembers);else if("All"==e.Scope[0])t.precond='([ds6w:type]:(Group) AND [ds6w:status]:(Public)) OR (flattenedtaxonomies:"types/Person" AND current:"active")';else if("Organization"==e.Scope[0])t.precond='([ds6w:type]:(Group) AND [ds6w:status]:(Public)) OR (flattenedtaxonomies:"types/Person" AND current:"active" AND member:"'+s()+'")';else{for(var n="(",i=[],a=!1,r=0;r<e.ScopeMembers.length;r++)-1!=e.ScopeMembers[r].indexOf("uuid")?(a=!0,n=n+'uri:"'+e.ScopeMembers[r]+'" OR '):i.push(e.ScopeMembers[r]);a?(n=n.substring(0,n.length-4),n+=") ",t.precond="("+n+' AND [ds6w:type]:(Group) AND [ds6w:status]:(Public)) OR (flattenedtaxonomies:"types/Person" AND current:"active")'):t.precond='((uri:"-1") AND [ds6w:type]:(Group) AND [ds6w:status]:(Public)) OR (flattenedtaxonomies:"types/Person" AND current:"active")',t.resourceid_in=i}return t})(e),getPrecondForLinkTemplateEditSearch:e=>i(e),getPrecondForLinkTemplateSaveAsSearch:e=>(function(e){let t={precond:'flattenedtaxonomies:("types/Route Template") AND current:"Active" AND latestrevision:"TRUE" AND route_95_base_95_purpose:"Standard" AND route_95_template_95_valid:"TRUE"'};return""!=e&&null!=e&&(t.resourceid_not_in=e),t})(e),getPrecondForRouteOwnerTaskAssignment:e=>(function(e){let t={};return""!=e.options.grid.routeOwnerUGChoice&&null!=e.options.grid.routeOwnerUGChoice?t.precond='(flattenedtaxonomies:"types/Person" AND userrole="'+e.options.grid.routeOwnerUGName+'"  AND current:"active") ':t.precond='(flattenedtaxonomies:"types/Person" AND current:"active") ',t})(e),getPrecondForLinkTemplateSearch:e=>'flattenedtaxonomies:("types/Route Template") AND current:"Active" AND latestrevision:"TRUE" AND route_95_base_95_purpose:"Standard" AND route_95_template_95_valid:"TRUE"',getPrecondForRouteOwnerAssignmentScope:e=>(function(e){let t={};return"OnPremise"==o.getTenantValue()?t.precond='(flattenedtaxonomies:"types/Group")':t.precond="([ds6w:type]:(Group) AND [ds6w:status]:(Public))",t})(),getPrecondForDocumentSearch:()=>'( NOT (flattenedtaxonomies:"types/Person" OR flattenedtaxonomies:"types/Business Role" OR flattenedtaxonomies:"types/Security Context" OR flattenedtaxonomies:"types/Route" OR flattenedtaxonomies:"types/Route Template" OR flattenedtaxonomies:"types/Inbox Task"))',getPrecondForContextSearch:(e,t)=>(function(e,t){var o="flattenedtaxonomies:(",n=t.length;return t.forEach(function(e,t){o+='"types/'+e+'"',t<n-1&&(o+=" BOR "),t===n-1&&(o+=")")}),o})(0,t)}}),define("DS/ENORouteMgmt/Model/TaskModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Model/Utils/TaskModelUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n){"use strict";let i,s=[],a=function(){s=[],i=new e};return{getModel:e=>(function(e){return s=[],i.prepareUpdate(),o.prepareTreeDocumentModel(e,i),i.pushUpdate(),i})(e),getTaskNodeModel:(e,t)=>(function(e,t){return o.getTaskNodeModel(i,e,t)})(e,t),getTaskTreeDocument:()=>i,destroy:()=>(i?i.empty():a(),void(i.options._isTaskPanelOpened=!1)),deleteTreeNodeModel:e=>(function(e){let t=o.deleteTreeNodeModel(e);return s=s.concat(t.deletedTasks),t.deletedGraphNodes})(e),getTasksDataForCreation:()=>o.getTasksDataForCreation(i),reOrderTreeNodeModels:(e,t)=>(function(e,t){return o.reOrderTreeNodeModels(i,e,t)})(e,t),removeGraphNodesFromTree:e=>(function(e){return o.removeGraphNodesFromTree(e)})(e),getTaskData:e=>(function(e){let t=[];return e&&e.options.grid.validTaskData&&t.push(e.options.grid),t})(e),getTasksDataForEdit:()=>o.getTasksDataForEdit(i),getDeletedTasks:()=>s}}),define("DS/ENORouteMgmt/Model/RouteModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/EnoviaBootstrap","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Utilities/RouteViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r){"use strict";let l,d=new e,u=function(e,t,o,n){o=o;var i,s=r["state_"+e];return i=UWA.createElement("div",{class:"route-task-state-and-assignee"}),UWA.createElement("span",{html:s,class:"route-state-title "+e.toUpperCase().replace(/ /g,"")}).inject(i),"Stopped"==o&&UWA.createElement("span",{html:r[o],class:"route-state-status "+o.replace(/ /g,"")}).inject(i),t.setStyle("display","inline"),t.setStyle("padding-left","3px"),t.set({title:n}),t.inject(i),i.outerHTML},c=function(e,n){d.prepareUpdate();var l=new UWA.Element("div",{class:"members"}),c="",m=e.assignees;if(void 0!==m)for(var p=0;p<m.length;p++){let e=m[p].split("~"),t=e[0],o=e[1],n=e[2];if(""!=m[p]&&"Collab Space"!=t){var g=new UWA.Element("div",{class:"assignee"});let e="";if("Person"==t){let t;t="/api/user/getpicture/login/"+o+"/format/normal";let s=i.getSwymUrl()+t;if(c=c+n+",\n",null!=i.getSwymUrl())e=UWA.createElement("img",{class:"userIcon",src:s});else{var w=a.getAvatarDetails(n);(e=UWA.createElement("div",{html:w.avatarStr,class:"avatarIcon"})).style.setProperty("background",w.avatarColor)}}"User Group"==t&&(c=c+n+",\n",e=UWA.createElement("img",{class:"userIcon",src:s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png")})),""!=e&&e.inject(g),g.inject(l)}}c=c.slice(0,-2),l.set({title:c}),e.assigneesdiv=l.outerHTML;var v=o.gridData(e);v.Activity_StateNLS=a.getRouteActivityState(v),v.revisionValue=a.getRouteRevision(v);var S=new t({label:e.title,id:e.id,width:300,grid:v,thumbnail:s.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png"),subLabel:r[e.routeBasePurpose],description:u(e.state,l,e.routeStatus,c),icons:[s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_Route16.png")],contextualMenu:["My context menu"],customTooltip:h(v)});return d.getXSO().add(S),d.addChild(S,0),d.unselectAll(),d.pushUpdate(),f(),void 0!==n&&0==n||widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:o.gridData(e)}),S},m=function(e){return n.getRowModelById(d,e)},p=function(e){0==g()&&widget.routeMgmtMediator.publish("show-no-route-placeholder",e)},g=function(){let e=0;return d.getChildren().forEach(t=>{t._isHidden||e++}),e},f=function(){0!=g()&&widget.routeMgmtMediator.publish("hide-no-route-placeholder")},h=function(e){return r.title+": "+e.Title+"\n"+r.name+": "+e.Name+"\n"+r.revision+": "+e.revision+"\n"+r.IDcardMaturityState+": "+e.Maturity_State+"\n"+r.routeBasePurpose+": "+e.BasePurposeNLS+"\n"+r.activity_state+": "+e.Activity_StateNLS.label+"\n"+r.IDcardOwner+": "+e.Owner},w=function(){widget.routeMgmtMediator.subscribe("route-DataGrid-on-dblclick",function(e){l=e}),widget.routeMgmtMediator.subscribe("route-back-to-summary",function(e){l=void 0,widget.setValue("routeIdToBePersisted",void 0)}),widget.routeMgmtMediator.subscribe("route-data-updated",function(e){l={model:o.gridData(e)}})};return{createModel:n=>(function(n){return(d=new e).prepareUpdate(),n.forEach(function(e){var n=new UWA.Element("div",{class:"members"}),l="",c=e.assignees;if(void 0!==c)for(var m=0;m<c.length;m++){let e=c[m].split("~"),t=e[0],o=e[1],r=e[2];if(""!=c[m]&&"Collab Space"!=t){var p=new UWA.Element("div",{class:"assignee"});let e="";if("Person"==t){let t;t="/api/user/getpicture/login/"+o+"/format/normal";let n=i.getSwymUrl()+t;if(l=l+r+",\n",null!=i.getSwymUrl())e=UWA.createElement("img",{class:"userIcon",src:n});else{var g=a.getAvatarDetails(r);(e=UWA.createElement("div",{html:g.avatarStr,class:"avatarIcon"})).style.setProperty("background",g.avatarColor)}}"User Group"==t&&(l=l+r+",\n",e=UWA.createElement("img",{class:"userIcon",src:s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png")})),""!=e&&e.inject(p),p.inject(n)}}l=l.slice(0,-2),n.set({title:l}),e.assigneesdiv=n.outerHTML;var f=o.gridData(e);f.Activity_StateNLS=a.getRouteActivityState(f),f.revisionValue=a.getRouteRevision(f);var w=new t({label:e.title,id:e.id,width:300,grid:f,thumbnail:s.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png"),subLabel:r[e.routeBasePurpose],description:u(e.state,n,e.routeStatus,l),icons:[s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_Route16.png")],contextualMenu:["My context menu"],shouldAcceptDrop:!0,customTooltip:h(f)});d.addRoot(w)}),d.pushUpdate(),w(),d})(n),appendRows:(e,t)=>c(e,t),updateRow:e=>(function(e){var t=new UWA.Element("div",{class:"members"}),n="",l=e.assignees;if(void 0!==l)for(var d=0;d<l.length;d++){let e=l[d].split("~"),o=e[0],r=e[1],u=e[2];if(""!=l[d]&&"Collab Space"!=o){var c=new UWA.Element("div",{class:"assignee"});let e="";if("Person"==o){let t;t="/api/user/getpicture/login/"+r+"/format/normal";let o=i.getSwymUrl()+t;if(n=n+u+",\n",null!=i.getSwymUrl())e=UWA.createElement("img",{class:"userIcon",src:o});else{var p=a.getAvatarDetails(u);(e=UWA.createElement("div",{html:p.avatarStr,class:"avatarIcon"})).style.setProperty("background",p.avatarColor)}}"User Group"==o&&(n=n+u+",\n",e=UWA.createElement("img",{class:"userIcon",src:s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png")})),""!=e&&e.inject(c),c.inject(t)}}if(n=n.slice(0,-2),t.set({title:n}),e.assigneesdiv=t.outerHTML,e.id&&""!=e.id){var g=m(e.id),f=o.gridData(e);f.Activity_StateNLS=a.getRouteActivityState(f),f.revisionValue=a.getRouteRevision(f),g.updateOptions({grid:f}),g.updateOptions({label:e.title,subLabel:r[e.routeBasePurpose],description:u(e.state,t,e.routeStatus,n),customTooltip:h(f)})}})(e),getModel:()=>d,getSelectedRowsModel:()=>n.getSelectedRowsModel(d),getRowModelById:e=>m(e),getRowModelIndexById:e=>n.getRowModelIndexById(d,e),deleteRowModelByIndex:e=>(function(e){n.deleteRowModelByIndex(d,e),p(d)})(e),deleteRowModelSelected:()=>(function(){let e=n.deleteRowModelSelected(d);return p(d),e})(),deleteRowModelById:e=>(function(e){n.deleteRowModelById(d,e),p(d)})(e),deleteRowModelByIds:e=>(function(e){n.deleteRowModelByIds(d,e),p(d)})(e),destroy:()=>{d=new e},getOpenedRouteModel:()=>l,appendAllRows:e=>(function(e){d.prepareUpdate(),e.forEach(e=>{var t=c(e,!1);d.addRoot(t)}),d.pushUpdate()})(e)}}),define("DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils",["DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){"use strict";let o=function(e,t,o,n){require(["DS/ENORouteMgmt/Model/InitiateRouteContentModel"],function(n){e.id&&""!=e.id&&(e.RouteTargetState=t,e.RouteTargetState_NLS=o,e.TargetMaturityMenu={},e.TargetMaturityMenu.menu=i(e),n.getRowModelById(e.id).updateOptions({grid:e}))})},n=function(e,o,n,i){require(["DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Controller/RouteServicesController"],function(e,a){let r=e.getModel().getSelectedNodes()[0].options.grid;if(r.id&&""!=r.id){r.RouteTargetState=o,r.RouteTargetState_NLS=n;let l=e.getModel().RouteId;r.setMaturityTarget=!0,a.updateRouteContentStateBlocking(r,l).then(function(o){if(o.success){var n=[];let o=e.getModel().getSelectedNodes()[0];r.TargetMaturityMenu={},r.TargetMaturityMenu.menu=s(r,i,e.getModel().routeModel.state,e.getModel().routeModel),o.updateOptions({grid:r}),widget.notify.handler().addNotif({level:"success",subtitle:t.successTargetMaturityUpdated,sticky:!0});var a={id:o.options.grid.id};n.push(a),widget.routeMgmtMediator.publish("route-content-updated",n)}}).catch(function(e){null!=e.internalError&&e.internalError.indexOf("#1600300")>=0&&e.internalError.indexOf(" Invalid object id")>0?widget.notify.handler().addNotif({level:"error",subtitle:t.ErrorInvalidObject,sticky:!0}):widget.notify.handler().addNotif({level:"error",subtitle:t.failedTargetMaturityUpdated,sticky:!0})})}})},i=function(e,t){var n=[],i=e.maturityTargetStates,s=e.RouteBaseState,a=e.RouteTargetState,r=!1,l="unselected";if(null!=i)for(let t=0;t<i.length;t++){var d=i[t].split("~");if(r=!!r||s==d[0]){for(var u=d[1].split(","),c=d[2].split(","),m=d[3].split(","),p=0;p<u.length;p++){l="selected"==l?"unselected":a==u[p]?"selected":"unselected";const t=m[p],i=u[p];var g={type:"CheckItem",title:t,title_actual:i,state:"TRUE"==c[p]?"enabled|"+l:"disabled|"+l,action:{callback:function(){o(e,i,t)}}};n.push(g)}break}}return n},s=function(e,t,o,i){if(d(e,i))return[];var s=[],a=e.maturityTargetStates,r=e.RouteBaseState,l=e.RouteTargetState,u=(e.current,!1),c="unselected";if(null!=a)for(let o=0;o<a.length;o++){var m=a[o].split("~");if(u=!!u||r==m[0]){for(var p=m[1].split(","),g=m[2].split(","),f=m[3].split(","),h=0;h<p.length;h++){c="selected"==c?"unselected":l==p[h]?"selected":"unselected";const o=f[h],i=p[h];var w={type:"CheckItem",title:o,title_actual:i,state:"TRUE"==g[h]?"enabled|"+c:"disabled|"+c,action:{callback:function(){e.RouteTargetState!=i&&n(0,i,o,t)}}};s.push(w)}break}}return s},a=function(e,t,o,n,a){if(d(e,a))return[];return"InitiateRoute"==t?i(e,o):s(e,o,n,a)},r=function(t){if(t){if("Completed"==t.actualState)return!1;if(t.UserName==e.getLoginUser())return!0;if(t.Assignees){var o=!1;return t.Assignees.forEach(function(t){t.contains("Person~"+e.getLoginUser()+"~")&&(o=!0)}),o}return!1}},l=function(e){if(e&&e.length>0){return e.find(e=>"enabled|selected"==e.state||"selected"==e.state).title}},d=function(e,t){if(t&&!r(t))return!0;if(t&&""!==t.state&&"In Process"==t.state){var o=e.maturityBlockingStates,n=e.current,i=!0;if(o&&o.length>0)for(var s=0;s<o.length-1;s++){n==(a=o[s].split("~"))[3]&&("TRUE"!=a[2]&&"True"!=a[2]||(i=!1))}return i}o=e.maturityBlockingStates,i=!0,n=e.current;if(o&&o.length>0)for(s=0;s<o.length-1;s++){var a;if("TRUE"!=(a=o[s].split("~"))[2]&&"True"!=a[2]||(i=!1),t&&""!==t.state&&n==a[3]&&("FALSE"==a[2]||"false"==a[2])){i=!0;break}}return i};return{getTargetMenuForGrid:(e,o,n)=>(function(e,o,n){if(!e.maturityTargetStates)return e.RouteTargetState_NLS?"  "+e.RouteTargetState_NLS:"  "+t.None;var i=a(e,o,"Grid",s,n);if(""==e.RouteTargetState&&"Ad Hoc"!=e.RouteBaseState){for(let t=0;t<e.maturityTargetStates.length;t++)if(e.maturityTargetStates[t].split("~")[0]==e.RouteBaseState)return e.RouteBaseState_NLS=e.maturityTargetStates[0].split("~")[3].split(",")[0],"  "+e.RouteBaseState_NLS}else{if(("RouteContent"!==o||r(n))&&i.length>1){var s="";return n&&n.state&&(s=n.state),{menu:i}}if(i.length<=1&&e.RouteTargetState_NLS)return"  "+e.RouteTargetState_NLS}})(e,o,n),isCellEditable:e=>(function(e){if(e.nodeModel&&"string"==typeof e.nodeModel.options.grid.TargetMaturityMenu)return!1})(e),getCellTypeRepresentation:e=>(function(e){return e.nodeModel?null==e.nodeModel.options.grid.TargetMaturityMenu||null==e.nodeModel.options.grid.TargetMaturityMenu.menu?"string":1==e.nodeModel.options.grid.TargetMaturityMenu.menu.length||0==e.nodeModel.options.grid.TargetMaturityMenu.menu.length?"string":"functionMenu":"functionMenu"})(e),compareTargetMaturityStates:(e,t)=>(function(e,t){let o,n;return o=e.menu?l(e.menu):e.trim(),n=t.menu?l(t.menu):t.trim(),o.localeCompare(n)})(e,t),showTooltip:e=>(function(e){if(e.nodeModel&&e.nodeModel.options.grid.RouteTargetState_NLS)return{shortHelp:e.nodeModel.options.grid.RouteTargetState_NLS,updateModel:!1}})(e),getRouteContentTargetMaturityMenu:(e,t,o,n)=>s(e,t,o,n),getInitiateRouteContentTargetMaturityMenu:e=>i(e),getTargetMaturityContextualMenu:(e,o,n,i)=>(function(e,o,n,i){if(d(e,i))return[];if(null!=i&&"Complete"==i.state)return[];var s=[],r=a(e,o,"contextualMenu",n,i);return r.length<=1&&(r=[{type:"CheckItem",title:e.RouteTargetState_NLS,state:"disabled|selected",action:{callback:function(){}}}]),e.maturityTargetStates&&r.length>0&&s.push({name:t.targetMaturity,title:t.targetMaturity,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-target"},data:null,submenu:r}),s})(e,o,n,i)}}),define("DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils",["DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o){"use strict";let n=function(e,n,i,a){require(["DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Controller/RouteServicesController"],function(e,r){let l=e.getModel().getSelectedNodes()[0].options.grid;if(l.id&&""!=l.id){l.RouteBaseState=n,l.RouteBaseState_NLS=i;var d=l.maturityTargetStates;if(null!=d)for(let e=0;e<d.length;e++){var u=d[e];if(u.split("~").length>3&&u.split("~")[0]==l.RouteBaseState)for(let e=0;e<u.split("~")[1].split(",").length;e++)if("TRUE"==u.split("~")[2].split(",")[e]){u.split("~")[1].split(",").length>1?(l.RouteTargetState=u.split("~")[1].split(",")[e],l.RouteTargetState_NLS=u.split("~")[3].split(",")[e]):(l.RouteTargetState=u.split("~")[1],l.RouteTargetState_NLS=u.split("~")[3]);break}}"Ad Hoc"==l.RouteBaseState&&(l.RouteTargetState="");let c=e.getModel().RouteId;r.updateRouteContentStateBlocking(l,c).then(function(n){if(n.success){var i=[];let d=e.getModel().getSelectedNodes()[0];l.BlockingMaturityMenu={},l.BlockingMaturityMenu.menu=s(l,"",e.getModel().routeModel.state,e.getModel().routeModel),l.TargetMaturityMenu={},l.TargetMaturityMenu.menu=t.getRouteContentTargetMaturityMenu(l,a,e.getModel().routeModel.state,e.getModel().routeModel),0==l.TargetMaturityMenu.menu.length?l.TargetMaturityMenu=o.None:1==l.TargetMaturityMenu.menu.length&&(l.TargetMaturityMenu=l.RouteTargetState_NLS),l.RouteTargetState=n.data[0].dataelements.RouteTargetState,l.RouteTargetState_NLS=n.data[0].dataelements.RouteTargetState_NLS,d.updateOptions({grid:l}),widget.notify.handler().addNotif({level:"success",subtitle:o.successStateBlockingUpdated,sticky:!0});var r={id:d.options.grid.id};i.push(r),widget.routeMgmtMediator.publish("route-content-updated",i)}}).catch(function(e){null!=e.internalError&&e.internalError.indexOf("#1600300")>=0&&e.internalError.indexOf(" Invalid object id")>0?widget.notify.handler().addNotif({level:"error",subtitle:o.ErrorInvalidObject,sticky:!0}):widget.notify.handler().addNotif({level:"error",subtitle:o.failedStateBlockingUpdated,sticky:!0})})}})},i=function(e,t){if(t&&!d(t))return!0;if(t&&""!==t.state&&"In Process"==t.state){var o=e.maturityBlockingStates,n=e.current,i=!0;if(o&&o.length>0)for(var s=0;s<o.length-1;s++){n==(a=o[s].split("~"))[3]&&("TRUE"!=a[2]&&"True"!=a[2]||(i=!1))}return i}o=e.maturityBlockingStates,i=!0,n=e.current;if(o&&o.length>0)for(s=0;s<o.length-1;s++){var a;if("TRUE"!=(a=o[s].split("~"))[2]&&"True"!=a[2]||(i=!1),t&&""!==t.state&&n==a[3]&&("FALSE"==a[2]||"false"==a[2])){i=!0;break}}return i},s=function(e,t,s,a){if(i(e,a))return[];var r=[{type:"CheckItem",title:o.None,state:"Ad Hoc"==e.RouteBaseState?"selected":"unselected",action:{callback:function(){"Ad Hoc"!=e.RouteBaseState&&n(0,"Ad Hoc",o.None,t)}}}],l=e.maturityBlockingStates,d=e.RouteBaseState,u=e.current,c=!1,m="unselected";return l.forEach(function(o){var i=o.split("~");c=!!c||u==i[3],m="selected"==m?"unselected":d==i[1]?"selected":"unselected",s&&"In Process"==s&&c&&u!==i[3]&&(c=!1);var a={type:"CheckItem",title:i[3],title_actual:i[1],state:c&&"TRUE"==i[2]?"enabled|"+m:"disabled|"+m,action:{callback:function(){e.RouteBaseState!=i[1]&&n(0,i[1],i[3],t)}}};r.push(a)}),r.pop(),r},a=function(e,n,i,s){require(["DS/ENORouteMgmt/Model/InitiateRouteContentModel"],function(s){if(e.id&&""!=e.id){e.RouteBaseState=n,e.RouteBaseState_NLS=i;var a=e.maturityTargetStates;if(null!=a)for(let t=0;t<a.length;t++){var l=a[t];if(l.split("~").length>3&&l.split("~")[0]==e.RouteBaseState)for(let t=0;t<l.split("~")[1].split(",").length;t++)if("TRUE"==l.split("~")[2].split(",")[t]){l.split("~")[1].split(",").length>1?(e.RouteTargetState=l.split("~")[1].split(",")[t],e.RouteTargetState_NLS=l.split("~")[3].split(",")[t]):(e.RouteTargetState=l.split("~")[1],e.RouteTargetState_NLS=l.split("~")[3]);break}}e.BlockingMaturityMenu={},e.BlockingMaturityMenu.menu=r(e),e.TargetMaturityMenu={},e.TargetMaturityMenu.menu=t.getInitiateRouteContentTargetMaturityMenu(e);var d=s.getRowModelById(e.id);0==e.TargetMaturityMenu.menu.length?(e.TargetMaturityMenu=" "+o.None,e.RouteTargetState=""):e.TargetMaturityMenu.menu.length>0&&1==e.TargetMaturityMenu.menu.length&&(e.TargetMaturityMenu.menu=[],e.TargetMaturityMenu=" "+e.RouteTargetState_NLS),d.updateOptions({grid:e})}})},r=function(e,t){var n=[{type:"CheckItem",title:o.None,state:"Ad Hoc"==e.RouteBaseState?"selected":"unselected",action:{callback:function(){a(e,"Ad Hoc",o.None)}}}],i=e.maturityBlockingStates,s=e.RouteBaseState,r=e.current,l=!1,d="unselected";return i.forEach(function(t){var o=t.split("~");l=!!l||r==o[1],d="selected"==d?"unselected":s==o[1]?"selected":"unselected";var i={type:"CheckItem",title:o[3],title_actual:o[1],state:l&&"TRUE"==o[2]?"enabled|"+d:"disabled|"+d,action:{callback:function(){a(e,o[1],o[3])}}};n.push(i)}),n.pop(),n},l=function(e,t,o,n,a){if(i(e,a))return[];return"InitiateRoute"==t?r(e,o):s(e,o,n,a)},d=function(t){if(t){if("Completed"==t.actualState)return!1;if(t.UserName==e.getLoginUser())return!0;if(t.Assignees){var o=!1;return t.Assignees.forEach(function(t){t.contains("Person~"+e.getLoginUser()+"~")&&(o=!0)}),o}return!1}},u=function(e){if(e&&e.length>0){return e.find(e=>"enabled|selected"==e.state||"selected"==e.state).title}};return{getMaturityMenuForGrid:(e,t,o)=>(function(e,t,o){if("RouteContent"===t&&!d(o)||i(e,o))return e.RouteBaseState_NLS?"  "+e.RouteBaseState_NLS:"";var n="";return o&&o.state&&(n=o.state),{menu:l(e,t,"Grid",n,o)}})(e,t,o),hideMaturityBlockCondition:(e,t)=>i(e,t),getBlockingMaturityContextualMenu:(e,t,n,s)=>(function(e,t,n,s){if(i(e,s))return[];var a=[],r=l(e,t,"contextualMenu",n,s);return e.maturityBlockingStates&&r.length>0&&a.push({name:o.blockingMaturity,title:o.blockingMaturity,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-block"},data:null,submenu:r}),a})(e,t,n,s),isCellEditable:e=>(function(e){return!!e.nodeModel&&!i(e.nodeModel.options.grid)})(e),isCellEditableOnCreatePage:e=>(function(e){return!!e.nodeModel&&!i(e.nodeModel.options.grid)})(e),getCellTypeRepresentation:e=>(function(e){return e.nodeModel?0==e.nodeModel.options.grid.isMaturityBlockingEditable?"string":i(e.nodeModel.options.grid)?"string":"functionMenu":"functionMenu"})(e),compareBlockingStates:(e,t)=>(function(e,t){let o,n;return o=e.menu?u(e.menu):e.trim(),n=t.menu?u(t.menu):t.trim(),o.localeCompare(n)})(e,t),showTooltip:e=>(function(e){if(e.nodeModel&&e.nodeModel.options.grid.RouteBaseState_NLS)return{shortHelp:e.nodeModel.options.grid.RouteBaseState_NLS,updateModel:!1}})(e)}}),define("DS/ENORouteMgmt/Components/Mediator",["DS/CoreEvents/ModelEvents","DS/ENORouteMgmt/Utilities/Constants"],function(e,t){"use strict";var o=null,n=function(){o=new e};return n.prototype.publish=function(e,t){o.publish({event:e,data:t})},n.prototype.subscribe=function(e,t){return o.subscribe({event:e},t)},n.prototype.subscribeOnce=function(e,t){return o.subscribeOnce({event:e},t)},n.prototype.unsubscribe=function(e){o.unsubscribe(e)},n.prototype.getEventBroker=function(){return o},n.prototype.destroy=function(){o.destroy()},n.prototype.destroyAllButDialogEvents=function(){let e=t.DIALOG_EVENTS,o=widget.routeMgmtMediator.getEventBroker()._pubsub.topics;for(var n in o)if(o.hasOwnProperty(n)){let t=!0;for(let o in e)if(e.hasOwnProperty(o)&&e[o]===n.replaceAll("/","")){t=!1;break}let i=o[n];if(t)for(;i.length>0;){let e=i[0];e.token&&widget.routeMgmtMediator.unsubscribe(e.token)}}},n}),define("DS/ENORouteMgmt/Commands/RouteTaskApprovalProcess",["UWA/Core","DS/i3DXCompassPlatformServices/OpenWith","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap"],function(e,t,o,n){"use strict";let i=function(n,i){let r=a(n,i),l=new t;l.set3DXContent(r);let d=[];if(e.is(l.retrieveCompatibleApps,"function"))return new o(function(e,t){0==r.data.items.length&&e(),l.retrieveCompatibleApps(function(t){t.forEach(function(e){d.push(s(e,null))}),e(d[0])},function(){t(new Error(NLS.openWithError))})})},s=function(e,t){return{id:e.text,title:e.text,icon:e.icon,type:"PushItem",multisel:!1,action:{context:t,callback:e.handler}}},a=function(e,t){let o=[],n=l(e),i=e.taskTitleForSubRoute,s=e.taskIdForSubRoute;return"openSummaryPage"==t&&(n="Route"),"Inbox Task"==n?e.route.forEach(function(e){if(e.dataelements.approvalTaskId){let t=d(e,i,s);t.objectId=e.dataelements.approvalTaskId,o.push(t)}}):"hyperlink"==e.fromPage?e.route.forEach(function(e){e.dataelements.activityState.indexOf("Awaiting your")>-1&&o.push(d(e,i,s))}):e.route.forEach(function(e){o.push(d(e,i,s))}),r(n,o)},r=function(e,t){return{protocol:"3DXContent",version:"1.1",source:widget.getValue("appId")?widget.getValue("appId"):"ENXROUT_AP",widgetId:widget.id,data:{items:t,approvalObjectType:e}}},l=function(e){for(var t=[],o=0;o<e.route.length;o++)e.route[o].dataelements.approvalTaskId&&t.push(e.route[o].dataelements.id);return 1==t.length?"Inbox Task":"Route"},d=function(e,t,o){return{envId:n.getTenantValue()?n.getTenantValue():"OnPremise",serviceId:"3DSpace",contextId:n.getSecurityContextValue(),objectId:e.dataelements.id,objectType:"Route",contextTitle:t,contextId:o,displayName:e.dataelements.name,path:[{resourceid:e.dataelements.id,type:"Route"}]}};return{getOpenWithMenu:e=>i(e),getApprovalCommandMenu:(e,t)=>(function(e,t){return i(e,t)})(e,t)}}),define("DS/ENORouteMgmt/Model/RouteMemberModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/EnoviaBootstrap","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Utilities/RouteViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r){"use strict";let l=new e,d=function(e,t){var o="/api/user/getpicture/login/"+t+"/format/normal",n=i.getSwymUrl()+o,s=(new UWA.Element("div",{}),new UWA.Element("div",{class:"assignee"}),"");if(null!=i.getSwymUrl())s=UWA.createElement("img",{class:"member-userIcon",src:n});else{var r=a.getAvatarDetails(e);(s=UWA.createElement("div",{html:r.avatarStr,title:e,class:"member-avatarIcon"})).style.setProperty("background",r.avatarColor)}return s},u=function(e){return"Collab Space"==e.accessType?r.Collab_Space:"User Group"==e.accessType?r.UserGroup:r.Person};return{createModel:(e,o)=>(function(e,o){var n,i=o.model.Maturity_State;return n="Inactive"==i||"Active"==i?"Route Template":"Route",l.prepareUpdate(),e.forEach(function(e){var o,a,c,m=e.userAccess,p=[];p="Collab Space"===e.accessType||"true"===e.isRouteOwner||"true"!==e.isLoggedInUserRouteOwner||"User Group"===e.accessType||"Route Template"==n&&"Active"===i||"Route"==n&&("Complete"===i||"Archive"===i||"false"===e.canModifyMemberAccess)?[]:["My Context Menu"],"Collab Space"===e.accessType?(o=s.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_CollabSpace108x144.png"),a=s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_CollabSpace16.png"),c=e.projectTitle?e.projectTitle:e.name):"User Group"===e.accessType?(o=s.getWebappsAssetUrl("ENORouteMgmt","icons/144/default-group.png"),a=s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png"),c=e.fullname):(o=d(e.fullname,e.userName),a="user wux-ui-3ds",c=e.fullname);var g=new t({label:c,width:300,grid:{id:e.id,Name:e.fullname,Type:e.accessType,TypeNLS:u(e),Access:e.userAccess,AccessNLS:r[e.userAccess],Actions:e.actions,isRouteOwner:e.isRouteOwner,isLoggedInUserRouteOwner:e.isLoggedInUserRouteOwner,canModifyMemberAccess:e.canModifyMemberAccess},thumbnail:o,subLabel:r[m],icons:[a],contextualMenu:p});l.addRoot(g)}),l.pushUpdate(),l})(e,o),getModel:()=>l,updateRow:e=>(function(e){if(e.model.id&&""!=e.model.id){var t="role."+e.model.Access.replace(" ","").toLowerCase(),n=o.getSelectedRowsModel(l),i=n.data[0].options.grid;i.Access=t,i.AccessNLS=r[t],n.data[0].updateOptions({grid:i}),n.data[0].updateOptions({subLabel:r[t]})}})(e),destroy:()=>{l=new e}}}),define("DS/ENORouteMgmt/Model/InitiateRouteTaskModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Model/Utils/TaskModelUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n){"use strict";let i,s=function(){(i=new e).options._isTaskPanelOpened=!1};return{getModel:e=>(function(e){return i.prepareUpdate(),o.prepareTreeDocumentModel(e,i),i.pushUpdate(),i})(e),getTaskNodeModel:(e,t)=>(function(e,t){return o.getTaskNodeModel(i,e,t)})(e,t),getTaskTreeDocument:()=>i,destroy:e=>(function(e){e?i=void 0:s()})(e),deleteTreeNodeModel:e=>(function(e){return o.deleteTreeNodeModel(e,i).deletedGraphNodes})(e),getTasksDataForCreation:()=>o.getTasksDataForCreation(i),reOrderTreeNodeModels:(e,t)=>(function(e,t){return o.reOrderTreeNodeModels(i,e,t)})(e,t),removeGraphNodesFromTree:e=>(function(e){return o.removeGraphNodesFromTree(e)})(e),setTaskTreeDocument:e=>(function(e){i=e})(e)}}),define("DS/ENORouteMgmt/Config/Toolbar/RouteSummaryToolbarConfig",["DS/ENORouteMgmt/Utilities/RouteWidgetPersistency","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){let o,n={menu:[{type:"CheckItem",title:t.gridView,state:"selected",fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-list"},action:{module:"DS/ENORouteMgmt/Views/ToggleViews",func:"doToggleView",argument:{view:"GridView",curPage:"RouteSummary"}},tooltip:t.gridView},{type:"CheckItem",title:t.tileView,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-small-tile"},action:{module:"DS/ENORouteMgmt/Views/ToggleViews",func:"doToggleView",argument:{view:"TileView",curPage:"RouteSummary"}},tooltip:t.tileView}]};let i=function(o){var i=function(e){var o={menu:[{type:"CheckItem",title:t.filterOwnedbyme,state:e.indexOf("owned")>-1?"selected":"unselected",id:"owned",action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"changeOwnerFilter",argument:{type:"owner",filter:"owned"}},tooltip:t.filterOwnedbymeTooltip},{type:"CheckItem",title:t.filterAssignedtome,state:e.indexOf("assigned")>-1?"selected":"unselected",id:"assigned",action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"changeOwnerFilter",argument:{type:"owner",filter:"assigned"}},tooltip:t.filterAssignedtomeTooltip},{type:"SeparatorItem",title:""}]},n=widget.getValue("stateNLS"),i={type:"CheckItem",state:e.indexOf("Define")>-1?"selected":"unselected",id:"draft",action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"changeStateFilter",argument:{type:"state",filter:"draft"}},tooltip:t.filterDraftTooltip};n&&n.Define?i.title=n.Define:i.title=t.filterDraft,o.menu.push(i),i={type:"CheckItem",state:e.indexOf("In Process")>-1?"selected":"unselected",id:"todo",action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"changeStateFilter",argument:{type:"state",filter:"todo"}},tooltip:t.filterTodoTooltip},n&&n.In_Process?i.title=n.In_Process:i.title=t.filterTodo,o.menu.push(i),i={type:"CheckItem",state:e.indexOf("Complete")>-1?"selected":"unselected",id:"completed",action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"changeStateFilter",argument:{type:"state",filter:"completed"}},tooltip:t.filterCompletedTooltip},n&&n.Complete?i.title=n.Complete:i.title=t.filterCompleted;var s={type:"CheckItem",title:t.filterByObject,state:e.indexOf("filterbyobject")>-1?"selected":"unselected",id:"filterbyobject",action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"renderObjectContextTitle",argument:{type:"filterbyobject",filter:"filterbyobject"}},tooltip:t.filterByObject};return o.menu.push(i),o.menu.push(s),o}(o),s=e.getViewPersistency("RouteSummaryPage","GridView"),a="selected"===s?"unselected":"selected";n.menu[0].state=s,n.menu[1].state=a;var r={entries:[{id:"filter",dataElements:{typeRepresentation:"filterdropdown",icon:{iconName:"list-filter",fontIconFamily:1},value:i},position:"far",action1:{module:"DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView",func:"launchFilter"},priority:1,category:"status",tooltip:t.filter,domId:"filterDropDownToolbar"},{id:"view",className:"routeViews",dataElements:{typeRepresentation:"viewdropdown",icon:{iconName:"selected"==s?"view-list":"view-small-tile",fontIconFamily:1},value:n},position:"far",tooltip:"selected"==s?t.gridView:t.tileView,category:"action"},{id:"changeOwner",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"user-change",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Views/Dialogs/RouteChangeOwnershipDialog",func:"routeChangeOwner"}},position:"far",category:"action",tooltip:t.changeOwner},{id:"deleteRoute",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"trash",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Views/Dialogs/RemoveRoute",func:"removeConfirmation"}},position:"far",category:"action",tooltip:t.Delete},{id:"information",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"info",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",func:"openPropertiesView"}},position:"far",category:"action",tooltip:t.Information}],typeRepresentations:{sortingdropdown:{stdTemplate:"functionMenuIcon",semantics:{label:"action",icon:"sorting"}},filterdropdown:{stdTemplate:"functionMenuIcon",semantics:{label:"action",icon:"sorting"},position:"far",tooltip:{text:"Filter",position:"far"}},viewdropdown:{stdTemplate:"functionMenuIcon",semantics:{label:"action",icon:"sorting"},position:"far",tooltip:{text:"view",position:"far"}}}};return null!=widget.data.contextTitle&&""!=widget.data.contextTitle&&r.entries.unshift({id:"subRouteInfoToolBar",dataElements:{typeRepresentation:"string",value:widget.data.contextTitle,allowResetToUndefinedByUIFlag:!0,position:"far",category:"status",label:widget.data.contextTitle}},{id:"removeSubRoute",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"remove",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Views/Dialogs/RemoveRoute",func:"removeSubRouteConfirmation"}},position:"far",category:"status",tooltip:t.remove,visibleFlag:!0}),JSON.stringify(r)};return o={writetoolbarDefination:e=>i(e),destroy:function(){_dataGrid.destroy(),_container.destroy()}}}),define("DS/ENORouteMgmt/Views/Loader/InitiateDocumentChooser",["DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n){"use strict";let i;var s=function(e,o){for(var n=0;n<o.length;n++){var s,a=o[n];a&&(s=new t({label:a["ds6w:label"],value:a.id,name:a["ds6w:identifier"],type:a["ds6w:type"]}),null==i.selectedItems?i.selectedItems=s:i.selectedItems.push(s),i._applySelectedItems())}};return{init:(t,o,n)=>(function(t,o,n){i=o;var a=[];null!=n&&(a=JSON.parse(JSON.stringify(n))),null!=i&&null!=i.selectedItems&&0!=i.selectedItems.length&&i.selectedItems.forEach(function(e){null==e.options.value.name&&a.push(e.options.value)});var r=t.dsModel,l=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],function(t){var o=t.createSocket({socket_id:l}),n=e.getRefinementToSnN(l,"addExistingAttachment",!0,["Document"]);if(n.precond=e.getPrecondForDocumentSearch(),n.resourceid_not_in=a,!UWA.is(o))throw new Error("Socket not initialized");o.dispatchEvent("RegisterContext",n),o.addListener("Selected_Objects_search",s.bind(r,"")),o.dispatchEvent("InContextSearch",n)})})(t,o,n),populateAddExisiting:(e,t)=>(function(e,t){let o=[],n=e.attachedDocuments;i=e.autoCompleteComponent;let a=[];null!=n&&(o=JSON.parse(JSON.stringify(n))),null!=i&&null!=i.selectedItems&&0!=i.selectedItems.length&&i.selectedItems.forEach(function(e){null==e.options.value.name&&o.push(e.options.value)});for(var r=0;r<t.length;r++){var l=t[r];o.includes(l.id)||(o.push(l.id),a.push(l))}s("",a)})(e,t)}}),define("DS/ENORouteMgmt/Commands/RouteOpenWith",["UWA/Core","UWA/Class","DS/i3DXCompassPlatformServices/OpenWith","DS/ENORouteMgmt/EnoviaBootstrap","UWA/Class/Promise"],function(e,t,o,n,i){"use strict";let s=function(t){let s=function(e){let t=e,o=[],i={envId:n.getTenantValue(),serviceId:"3DSpace",contextId:"",objectId:r(t,"id"),objectType:r(t,"Type"),displayName:r(t,"Title"),displayType:r(t,"Type"),facetName:"realized",path:[{resourceid:r(t,"id"),type:r(t,"Type")}]};return o.push(i),{protocol:"3DXContent",version:"1.1",source:widget.getValue("appId"),widgetId:widget.id,data:{items:o}}}(t),l=new o;l.set3DXContent(s);let d=[];if(e.is(l.retrieveCompatibleApps,"function"))return new i(function(e,t){l.retrieveCompatibleApps(function(t){t.forEach(function(e){d.push(a(e,null))}),e(d)},function(){t(new Error("Error while getting Open with menus"))})})},a=function(e,t){return{id:e.text,title:e.text,icon:e.icon,type:"PushItem",multisel:!1,action:{context:t,callback:e.handler}}},r=function(e,t){let o="";return e&&e.options.grid.id&&(o=e.options.grid[t]),o};return{getOpenWithMenu:e=>s(e)}}),define("DS/ENORouteMgmt/Config/Toolbar/RouteContentsTabToolbarConfig",["DS/ENORouteMgmt/Utilities/RouteWidgetPersistency","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){let o,n={menu:[{type:"CheckItem",title:t.gridView,state:"selected",fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-list"},action:{module:"DS/ENORouteMgmt/Views/ToggleViews",func:"doToggleView",argument:{view:"GridView",curPage:"ContentsTab"}},tooltip:t.gridView},{type:"CheckItem",title:t.tileView,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-small-tile"},action:{module:"DS/ENORouteMgmt/Views/ToggleViews",func:"doToggleView",argument:{view:"TileView",curPage:"ContentsTab"}},tooltip:t.tileView}]};return o={writetoolbarDefination:o=>(function(o){var i=o.routeModel.Actions.indexOf("add.contents")>=0,s=o.routeModel.actualState;let a={},r=[],l=e.getViewPersistency("RouteContentsPage","GridView"),d="selected"===l?"unselected":"selected";return n.menu[0].state=l,n.menu[1].state=d,"Complete"!=s&&i&&r.push({id:"createContent",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"plus",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Actions/ContentActions",func:"onSearchClick"}},position:"far",category:"create",tooltip:t.addExistingContent}),r.push({id:"view",className:"contentViews",dataElements:{typeRepresentation:"sortingdropdown",icon:{iconName:"selected"==l?"view-list":"view-small-tile",fontIconFamily:1},value:n},position:"far",tooltip:"selected"==l?t.gridView:t.tileView,category:"action"}),"Complete"!=s&&r.push({id:"removeContent",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"remove",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{module:"DS/ENORouteMgmt/Views/Dialogs/RemoveContent",func:"removeConfirmation"}},position:"far",category:"action",tooltip:t.deleteContent}),a.entries=r,JSON.stringify(a)})(o),destroy:function(){_dataGrid.destroy(),_container.destroy()}}}),define("DS/ENORouteMgmt/Config/InitiateRouteContentsViewConfig",["DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o){"use strict";return[{text:o.title,dataIndex:"tree",width:"150px",visibility:!0},{text:o.name,dataIndex:"Name",visibility:!1},{text:o.type,dataIndex:"Type",visibility:!0},{text:o.IDcardMaturityState,dataIndex:"Maturity",visibility:!0},{text:o.blockingMaturity,dataIndex:"BlockingMaturityMenu",visibility:!0,editableFlag:!0,getCellSemantics:function(e){return{label:e.nodeModel.options.grid.RouteBaseState_NLS}},getCellEditableState:function(t){return e.isCellEditable(t)},getCellTypeRepresentation:function(t){return e.getCellTypeRepresentation(t)},compareFunction:function(t,o){return e.compareBlockingStates(t,o)},getCellTooltip:function(t){return e.showTooltip(t)}},{text:o.targetMaturity,dataIndex:"TargetMaturityMenu",visibility:!0,editableFlag:!0,typeRepresentation:"functionMenu",getCellSemantics:function(e){return{label:e.nodeModel.options.grid.RouteTargetState_NLS}},getCellEditableState:function(e){return t.isCellEditable(e)},getCellTypeRepresentation:function(e){return t.getCellTypeRepresentation(e)},compareFunction:function(e,o){return t.compareTargetMaturityStates(e,o)},getCellTooltip:function(e){return t.showTooltip(e)}},{text:o.IDcardOwner,dataIndex:"Owner",visibility:!0},{text:o.modified,dataIndex:"Modified_Date",visibility:!1},{text:o.creationDate,dataIndex:"Creation_Date",visibility:!1},{text:o.relatedTo,dataIndex:"routeTask",visibility:!0}]}),define("DS/ENORouteMgmt/Services/RouteESignServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/WAFData/WAFData"],function(e,t,o,n,i){"use strict";let s,a,r;return a=function(s,a){return new t(function(t,r){var l=o.get3DSpaceURL()+"/resources/v1/modeler/ESignRecord/"+a,d={},u={};(u=e.extend(u,o.getSyncOptions(),!0)).method="PUT",u.type="json",u.headers={"Content-Type":"application/json"},u.wait=!0,d=(new n).createDataForRequest(d);var c=s.model.needsOwnerReview,m=""!=c&&"Yes"==c?"Review":"Complete",p={actionType:[{ObjectRevision:s.model.revision},{MaturityChange:{before:"To Do",after:m}}]};d.data[0].dataelements={ObjectActionTaken:JSON.stringify(p),ObjectReference:s.model.id,ObjectServiceID:"3DSpace",ObjectURI:"/resources/v1/modeler/tasks/"},u.data=JSON.stringify(d),u.onComplete=function(e){t(e)},u.onFailure=function(e,t){r(t||e)},i.authenticatedRequest(l,u)})},r=function(e,n){return new t(function(t,s){let a=o.get3DSpaceURL()+"/resources/v1/modeler/ESignRecord?ESignObjectRef="+e+"&ESignObjectServiceID="+n,r={method:"GET",timeout:0,headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t(e)},onFailure:function(e,t){s(t||e)}};i.authenticatedRequest(a,r)})},s={updateEsignRecordInformation:(e,t)=>a(e,t),fetchESignDetails:(e,t)=>r(e,t)}}),define("DS/ENORouteMgmt/Controller/RouteESignServicesController",["DS/ENORouteMgmt/Services/RouteESignServices","UWA/Promise"],function(e,t){"use strict";let o;return o={updateEsignRecordInformation:function(o,n){return new t(function(t,i){e.updateEsignRecordInformation(o,n).then(e=>{t(e)},e=>{i(e)})})},fetchESignDetails:(o,n)=>new t(function(t,i){e.fetchESignDetails(o,n).then(e=>{t(e)},e=>{i(e)})})}}),define("DS/ENORouteMgmt/Views/Grid/RouteGridCustomColumns",["DS/Controls/Button","DS/Controls/TooltipModel","DS/ENORouteMgmt/EnoviaBootstrap","UWA/Drivers/Alone","DS/ENORouteMgmt/Utilities/RouteViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s){"use strict";return{onRouteNodeStateCellRequest:e=>(function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_state_"))){let o=e.nodeModel.options.grid.state;t.getChildren()[0].setHTML(e.nodeModel.options.grid.Maturity_State),t.getChildren()[0].setAttribute("class","route-state-title "+o.toUpperCase().replace(/ /g,"")),e.cellView._setReusableContent(t)}})(e),onRouteNodeAssigneesCellRequest:e=>(function(e){var t=e.cellView.getContent(),o=new UWA.Element("div",{class:"members"});if(!e.isHeader){var n=e.nodeModel.options.grid.Assignees;if(void 0!==n)for(var s=0;s<n.length;s++)if(""!=n[s]){n[s];var a=new UWA.Element("div",{class:"assignee"}),r="",l=i.getAvatarDetails(n[s]);(r=UWA.createElement("div",{html:l.avatarStr,title:n[s],class:"avatarIcon"})).style.setProperty("background",l.avatarColor),r.inject(a),a.inject(o)}}t.setContent(o.outerHTML)})(e),onRouteNodeActionCellRequest:e=>(function(e){let o;e.isHeader||(o=e.cellView.collectionView.reuseCellContent("_actions_"))&&require(["DS/ENORouteMgmt/Views/Menu/RouteContextualMenu"],function(n){var i=[];i.push(e.nodeModel.options.grid.id),o.setHTML(n.routeGridCheveron(e.nodeModel.options.grid.Actions,i)),o.tooltipInfos=new t({shortHelp:s.actions,allowUnsafeHTMLShortHelp:!0}),o.setStyle(),e.cellView._setReusableContent(o)})})(e),onRouteNodeOwnerCellRequest:e=>(function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_owner_"))){var n=e.nodeModel.options.grid.OwnerFullName,s="/api/user/getpicture/login/"+e.nodeModel.options.grid.UserName+"/format/normal",a=i.getAvatarDetails(n),r=o.getSwymUrl()+s;null!=o.getSwymUrl()?t.getChildren()[0].getChildren()[0].src=r:(t.getChildren()[0].getChildren()[0].setHTML(a.avatarStr),t.getChildren()[0].getChildren()[0].setStyle("background",a.avatarColor)),t.getChildren()[1].setHTML(n),e.cellView._setReusableContent(t)}})(e),compareActivityStates:(e,t)=>(function(e,t){let o,n;return o=e&&e.label?e.label.trim():"",n=t&&t.label?t.label.trim():"",o.localeCompare(n)})(e,t),compareRevision:(e,t)=>(function(e,t){let o,n;return o=e&&e.label?e.label.trim():"",n=t&&t.label?t.label.trim():"",o.localeCompare(n)})(e,t)}}),define("DS/ENORouteMgmt/Services/RouteTemplateServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/WAFData/WAFData"],function(e,t,o,n,i){"use strict";let s,a;return a=function(e){return new t(function(t,n){let i=o.getRouteTemplateServiceBaseURL()+"/"+e,s={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t(JSON.parse(e))},onFailure:function(e){n(e)}};o.authenticateRequest(i,s)})},s={fetchRouteTemplateById:e=>a(e)}}),define("DS/ENORouteMgmt/Commands/InitialRoute_Widget",["UWA/Class","DS/ApplicationFrame/Command","DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/TransientWidget/TransientWidget","DS/ENORouteMgmt/EnoviaBootstrap"],function(e,t,o,n,i,s){"use strict";return t.extend({defaultIsTransient:!1,extraNotif:!1,init:function(e,t){this._parent(e,t),require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"]),this.editProp=null,s.start({id:widget.id})},beginExecute:function(){},execute:function(e){this.routeName=e.routeName,this.routeId=e.routeId;var t=this;require(["DS/PADUtils/PADContext"],function(e){var o=e.get();null==o&&(o=t.options.context),t.launchCreateRoute(o)})},_launchTransientWidget:function(e,t){window.top.performance.mark("end_EP_SelectionTreatment"),window.top.performance.mark("start_EP_TransientLoaded"),e.showWidget("ENXROUT_AP","",t,{mode:"panel",height:800,width:750})},launchCreateRoute:function(e){var t=this;widget.setValue("index_mode",!1);var s=widget.getValue("index_mode"),a={context:e};n.getInstance(a).getSecurityContext();var r=[],l=[],d=e.model;if(d&&d.objectId||(r=e.getSelectedNodes()),r.length&&(console.dir("selected_nodes : "+r),r.forEach(function(e){var t=e&&"function"==typeof e.getInstID?e.getInstID():null;null!=t&&Array.isArray(t)&&(t=t.length>0?t[0]:null);var n=t?"relationship":"businessobject";t=(t=t||e.getID())||e.id;var i=e.metatype?e.metatype:n,s=e.source?e.source:null,a=e.tenant?e.tenant:null,r=e.type?e.type:null;if(t){var d={metatype:i,objectId:t};(a=a||o.getTenantID())&&(d.tenant=a),s&&(d.source=s),r&&(d.type=r),l.push(d)}})),l.length>0){var u=t.defaultIsTransient;"function"==typeof e.isTransient&&(u=e.isTransient()),!1===u&&n.getSecurityContext({onSuccess:function(e){var o=window.top.document.body.getElementsByClassName("preview-container")[0],n=!1;if(o){var a=o.getElement(".moduleContent");if(a)a.className.indexOf("EditPropWidget")>=0&&(n=!0,o.show(),require(["DS/WidgetServices/commandProxy/CommandProxy"],function(e){e.publishUpdate(l)}))}if(!1===n){var r={SelectedItem:l,isTransient:"true",loadData:!0,asynchronousRequest:"true",index_mode:widget.getValue("index_mode"),routeName:t.routeName,routeId:t.routeId};e&&e.SecurityContext&&(r.securityContext=e.SecurityContext),s&&(r.readOnly=!0),t._launchTransientWidget(i,r)}}})}else t._setError(e,UWA.i18n("no content selected"));t.end()},_setError:function(e,t){if("function"==typeof e.displayNotification){var o={eventID:"error",msg:t};e.displayNotification(o)}else alert(t)},endExecute:function(){}})}),define("DS/ENORouteMgmt/Utilities/RouteTaskResponseFormatter",["DS/ENORouteMgmt/Utilities/ParseJSONUtil"],function(e){"use strict";let t;return t={getTaskReponse:t=>(function(t){var o=JSON.parse(t);if(o.data.length>0){for(var n=o.data[0].relateddata.tasks,i=o.data[0].relateddata.contents,s=[],a=0;a<i.length;a++){var r=i[a],l={id:r.id,physicalid:r.id,type:r.type,relId:r.relId};Object.assign(r.dataelements,l),s.push(r.dataelements)}require(["DS/ENORouteMgmt/Model/ContentToReviewModel"],function(e){e.destroy(),e.createModel(s)});for(var d=[],u=0;u<n.length;u++){for(var c=n[u],m=c.relateddata.taskAttachments,p=[],g=[],f=0;f<m.length;f++){var h=m[f],w={id:h.id,physicalid:h.id,type:h.type,relId:h.relId};Object.assign(h.dataelements,w),p.push(h.dataelements)}var v=c.dataelements.ContentToReviewIds,S=[];if(""!=v&&null!=v)for(var R=0;R<s.length;R++)v.includes(s[R].physicalid)&&S.push(s[R]);var y=!1;if(null!=n[u].relateddata.subroutes){for(var M=n[u].relateddata.subroutes[0].relateddata.route,T=0;T<M.length;T++)g.push(M[T].dataelements);g.length>0&&(y=!0)}var b="";y&&(b=n[u].relateddata.subroutes[0].dataelements.TaskApprovalStatus);let e=[];for(let t=0;t<s.length;t++)0==s[t].relatedToTaskIds.length?e.push(s[t]):s[t].relatedToTaskIds.toString().includes(c.id)&&e.push(s[t]);var C={id:c.id,physicalid:c.id,type:c.type,relId:c.relId,taskAttachments:p,routeContents:e,taskSubRoutes:g,subRouteApprovalStatus:b,RouteTaskContentToReview:S};Object.assign(c.dataelements,C),d.push(c.dataelements)}return d}return(new e).parseResp(JSON.parse(t))})(t)}}),define("DS/ENORouteMgmt/Services/RouteServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Utilities/RouteTaskResponseFormatter","DS/WAFData/WAFData"],function(e,t,o,n,i,s){"use strict";let a,r,l,d,u,c,m,p,g,f,h,w,v,S,R,y;r=function(){return new t(function(e,t){let i=o.getRouteServiceBaseURL(),s=widget.getValue("routeStateFilter");s&&(i+=M(i)+"stateFilter="+s);let a=widget.getValue("ownershipFilter");a&&(i+=M(i)+"ownershipFilter="+a);let r=widget.getValue("objectLimit");r&&(i+=M(i)+"objectLimit="+r);let l={method:"GET",timeout:0,headers:{"Content-Type":"application/ds-json"},onComplete:function(t){e((new n).parseResp(JSON.parse(t)))},onFailure:function(e,o){t(o||e)}};o.authenticateRequest(i,l)})};let M=function(e){return-1===e.indexOf("?")?"?":"&"};l=function(e,i){return new t(function(t,s){let a=o.getRouteServiceBaseURL()+"/"+e;"Route Template"===i&&(a=o.getRouteTemplateServiceBaseURL()+"/"+e);let r={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t((new n).parseResp(JSON.parse(e)))},onFailure:function(e,t){s(t||e)}};o.authenticateRequest(a,r)})},v=function(e){return new t(function(t,n){null==e&&t(),o.getCSRFToken().then(function(o){e.csrf=JSON.parse(o).csrf,t()})}).then(function(){return function(e){return new t(function(t,i){let s=o.getRouteServiceBaseURL()+"/ids?query=IncludeDataElements",a={method:"POST",headers:{"Content-Type":"application/ds-json"}};a.data=JSON.stringify(e),a.onComplete=function(e){t((new n).parseResp(JSON.parse(e)))},a.onFailure=function(e,t){t?(t="string"==typeof t?JSON.parse(t):t,i(t)):i(e)},o.authenticateRequest(s,a)})}(e)})},d=function(e){return new t(function(t,n){let i=o.getRouteServiceBaseURL()+"/"+e+"?$include=tasks,taskAttachments,contents,subroutes",s={method:"GET",headers:{"Content-Type":"application/ds-json"}};widget.data.routeCredentials&&(i=o.modifyURL(i,widget.data.routeCredentials)),s.onComplete=function(e){t(e)},s.onFailure=function(e,t){n(t||e)},o.authenticateRequest(i,s)})},u=function(e){return new t(function(t,i){let s={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t((new n).parseResp(JSON.parse(e)))},onFailure:function(e,t){t?(t="string"==typeof t?JSON.parse(t):t,i(t)):i(e)}};o.authenticateRequest(e,s)})},c=function(i,s){return new t(function(t,a){var r={};(r=e.extend(r,o.getSyncOptions(),!0)).method="PUT",r.type="json",r.timeout=0,r.headers={"Content-Type":"application/ds-json"},r.wait=!0,s||(s=(new n).createCSRFForRequest()),r.data=JSON.stringify(s),r.onComplete=function(e){t(e)},r.onFailure=function(e,t){a(t||e)},o.authenticateRequest(i,r)})},m=function(i){return new t(function(t,s){var a=(new n).createDataWithIdForRequest(i),r={};(r=e.extend(r,o.getSyncOptions(),!0)).method="DELETE",r.type="json",r.timeout=0,r.headers={"Content-Type":"application/ds-json"},r.wait=!0,r.data=JSON.stringify(a),r.onComplete=function(e){t(e)},r.onFailure=function(e,t){s(t||e)},o.authenticateRequest(o.getRouteServiceBaseURL(),r)})},p=function(e){return new t(function(t,n){let s=o.getRouteServiceBaseURL()+"/"+e+"?$include=tasks,taskAttachments,contents,subroutes",a={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t(i.getTaskReponse(e))},onFailure:function(e,t){n(t||e)}};o.authenticateRequest(s,a)})},g=function(e){return new t(function(t,n){let i=o.getRouteServiceBaseURL()+"/"+e+"?$include=contents,attachments",s={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t(e)},onFailure:function(e){n(e)}};o.authenticateRequest(i,s)})},R=function(e){return new t(function(t,n){let i=o.getRouteServiceBaseURL()+"/"+e+"/contents?include=none&$fields=none",s={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){let o=JSON.parse(e);t(o)},onFailure:function(e){n(e)}};o.authenticateRequest(i,s)})},f=function(e){return new t(function(t,i){let s=o.getRouteServiceBaseURL()+"/"+e+"/members",a={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t((new n).parseResp(JSON.parse(e)))},onFailure:function(e){i(e)}};o.authenticateRequest(s,a)})},h=function(e){return new t(function(t,i){let s=o.getRouteServiceBaseURL()+"/"+e+"/history",a={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t((new n).parseResp(JSON.parse(e)))},onFailure:function(e){i(e)}};o.authenticateRequest(s,a)})},w=function(e,t,n,i,s,a,r,l){var d="";null!=(l=l||null)&&null!=l.isfederated&&1==l.isfederated&&(d=o.getSearchUrl()+e);null!=l&&null!=l.acceptType&&""!=l.acceptType&&l.acceptType;null!=l&&null!=l.encodeSecurityContext&&""!=l.encodeSecurityContext&&l.encodeSecurityContext;var u=(new Date).getTime(),c=o.getTenantValue();d=-1==d.indexOf("?")?d+"?tenant="+c+"&timestamp="+u:d+"&tenant="+c+"&timestamp="+u,a=a||function(){},r=r||function(){};var m={};m.method=t,m.timeout=12e7,null!=l&&null!=l.isSwymUrl&&0!=l.isSwymUrl||(m.type="json"),n&&(m.auth={passport_target:n}),s&&(m.data=s),m.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":"en"},m.onComplete=function(e){a(e)},m.onFailure=function(e,t){console.log("Error in calling url: "+d),console.log("Error Detail: "+e),console.log("Error Data: "+JSON.stringify(t)),r(e,t)},m.onTimeout=function(){console.log("Timedout for url: "+d),widget.body&&Mask.unmask(widget.body)},o.authenticateRequest(d,m)},S=function(e){return new t(function(t,n){null==e&&t(),o.getCSRFToken().then(function(o){e.csrf=JSON.parse(o).csrf,t()})}).then(function(){return T(e)})};const T=function(e){return new t(function(t,n){null!=e&&null!=e.data&&0!=e.data.length||t();let i=o.getRouteServiceBaseURL()+"/contentsApprovalStatus",s={method:"POST",headers:{"Content-Type":"application/json"}};s.data=JSON.stringify(e),s.onComplete=function(e){let o=JSON.parse(e);t(o)},s.onFailure=function(e,t,o){n()},o.authenticateRequest(i,s)})};return y=function(e,i,s){var a=(new n).createRemoveSubRouteForRequest(e,i,s);return new t(function(e,t){let i=o.getRouteServiceBaseURL()+"/contextobjectremove",s={method:"PUT",headers:{"Content-Type":"application/json"}};s.data=JSON.stringify(a),s.onComplete=function(t){e((new n).parseResp(JSON.parse(t)))},s.onFailure=function(e,o){o?(o="string"==typeof o?JSON.parse(o):o,t(o)):t(e)},o.authenticateRequest(i,s)})},a={fetchAllRoutes:()=>r(),fetchRouteById:(e,t)=>l(e,t),fetchRouteByIds:e=>v(e),fetchRouteAndTaskByRouteId:e=>d(e),stopRouteCheck:e=>u(e),updateState:(e,t)=>c(e,t),deleteRoute:e=>m(e),fetchRouteTasks:e=>p(e),fetchRouteContents:e=>g(e),fetchRouteContentIds:e=>R(e),fetchRouteMembers:e=>f(e),fetchRouteHistory:e=>h(e),saveAsTemplate:(e,i)=>(function(e,i){return new t(function(t,s){let a={method:"POST",headers:{"Content-Type":"application/ds-json"}};a.data=JSON.stringify(e),a.onComplete=function(e){let o=(new n).parseResp(JSON.parse(e));t(o)},a.onFailure=function(e,t,o){s(JSON.parse(t))},o.authenticateRequest(i,a)})})(e,i),getESignConfigSetting:()=>new t(function(e,t){let n=o.get3DSpaceURL()+"/resources/bps/requiresESign",i={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(t){e(JSON.parse(t))},onFailure:function(e){t(JSON.parse(e))}};o.authenticateRequest(n,i)}),fetchApprovalStatusForContent:e=>S(e),makeWSCall:(e,t,o,n,i,s,a,r)=>w(e,t,o,0,i,s,a,r),removeSubRoute:(e,t,o)=>y(e,t,o)}}),define("DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete",["DS/WUXAutoComplete/AutoComplete","DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/EnoviaBootstrap","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","DS/TreeModel/BaseFilter","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a){var r,l;let d=function(e,n,i,s,a){var r="",l=[],d=[];e.precond&&(r=e.precond),e.resourceid_in&&(l=e.resourceid_in),e.resourceid_not_in&&(d=e.resourceid_not_in);var u;u="([ds6w:label]:(*"+n+"*) OR [ds6w:identifier]:(*"+n+"*)) AND ("+r+")";var c,m=o.getTenantValue(),p=((c={})["3dspace"]={SecurityContext:o.getSecurityContextValue()},c),g={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:identifier","ds6wg:fullname","ds6w:status"],select_file:["icon","thumbnail_2d"],query:u,order_by:"asc",order_field:"ds6w:label",nresults:1e3,start:"0",source:a,tenant:m,resourceid_in:l,resourceid_not_in:d,with_synthesis:!1,with_synthesis_attribute:!1};widget&&widget.data&&widget.data.routeCredentials&&widget.data.routeCredentials.noSecurityContextForSearch||widget&&widget.data&&widget.data.noSecurityContextForSearch||(g.login=p),g=JSON.stringify(g);var f={isfederated:!0};t.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",g,i,s,f)};return ENORouteAutoComplete={drawAutoCompleteComponent:t=>(function(t){r=new i;var o=new e({elementsTree:function(e){if(!t.getValidation||t.getValidation())return new Promise(function(o,a){var u=function(e){r=new i,l=s.inherit({isDataFiltered:function(e){var t=e.getAttributeValue("name"),o=e.getAttributeValue("label");if(t&&o&&this.filterModel&&this.filterModel.text){var n=this.filterModel.text.toLowerCase();return!(t.toLowerCase().indexOf(n)>-1||o.toLowerCase().indexOf(n)>-1)}return!!(o&&this.filterModel&&this.filterModel.text)&&(n=this.filterModel.text.toLowerCase(),!(o.toLowerCase().indexOf(n)>-1))},isEmpty:function(){return void 0===this.filterModel.text}}),r.getFilterManager().registerFilter("myFilterID",l),e&&e.results&&Array.isArray(e.results)&&e.results.forEach(function(e){var t=new n;e.attributes.forEach(function(e){"ds6w:type"===e.name&&(t.options.type=e.value),"resourceid"===e.name&&(t.options.value=e.value),"ds6w:label"===e.name&&(t.options.label=e.value),"ds6w:identifier"===e.name&&(t.options.name=e.value,t.options.grid={name:t.options.name}),"ds6w:status"===e.name&&(t.options.status=e.value)}),r.addRoot(t)}),o(r)},c=function(e){a(e)},m=["3dspace"];t.source&&(m=t.source);var p=t.getPrecond();p instanceof Promise?p.then(t=>{d(t,e,u,c,m)},e=>{e.error&&widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1})}):d(p,e,u,c,m)})},filterCB:function(e){r.setFilterModel({value:{filterId:"myFilterID",filterModel:{text:e}}})},multiSearchMode:t.isMultiSearchMode,placeholder:t.placeHolderValue,minLengthBeforeSearch:t.minLengthToType,allowFreeInputFlag:t.isFreeInputAllowed,keepSearchResultsFlag:t.toKeepSearchResultsFlag});return o.addEventListener("change",function(e){t.getChangeHandler&&t.getChangeHandler()}),o.getContent().querySelector(".wux-ui-state-undefined").addEventListener("keyup",function(e,t){13===e.keyCode&&e.stopPropagation()}),o})(t)},ENORouteAutoComplete}),define("DS/ENORouteMgmt/Services/MemberServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Utilities/ParseJSONUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","DS/WAFData/WAFData"],function(e,t,o,n,i,s,a){"use strict";let r,l;return l=function(e,s){return new t(function(t,a){var r,l=n.tileView(),d={};r=o.getRouteServiceBaseURL()+"/"+l.TreedocModel.RouteId+"/members/"+s;var u={id:s,newAccess:e};d.data=JSON.stringify((new i).createDataForRequest(u)),d.method="PUT",d.type="json",d.headers={"Content-Type":"application/ds-json"};var c=d;c.onComplete=function(e){t(e)},c.onFailure=function(e,t){a(t||e)},o.authenticateRequest(r,d)})},r={changeAccess:(e,t)=>l(e,t)}}),define("DS/ENORouteMgmt/Services/RouteTaskServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/WAFData/WAFData"],function(e,t,o,n,i){"use strict";let s,a,r;r=function(i){return new t(function(t,s){let r=(a=o.getRouteServiceBaseURL())+"/"+i+"/tasks",l={};(l=e.extend(l,o.getSyncOptions(),!0)).method="GET",l.type="json",l.timeout=0,l.headers={"Content-Type":"application/ds-json"},l.onComplete=function(e){e.result=(new n).parseResp(e),t(e.result)},l.onFailure=function(e,t){s(t||e)},o.authenticateRequest(r,l)})};let l=function(i,s){return new t(function(t,a){let r,l=i.routePropertiesInfo.id,d=i.options.grid.id,u=s.fields.taskAssigneeField.selectedItems.options.label,c=s.fields.descField.value,m=s.fields.assigneeId,p=o.getRouteServiceBaseURL()+"/"+l+"/tasks/"+d;if(r=i.options.grid.assigneeId,""==m)return void _alertFailure.add({message:NLS.errorTaskAssignee});if(r==m&&"TRUE"!=i.options.grid.routeOwnerTask)return void _alertFailure.add({message:NLS.taskNewAssignee});var g={};g="Inbox Task"==i.options.grid.type?{reAssignComments:c,routeId:l,taskId:d,newAssigneeId:m,newAssigneeType:s.fields.assigneeType,taskAssigneeName:u,taskAssigneeUserName:s.fields.taskAssigneeUserName,type:i.options.grid.type,isChangeAssignee:"true"}:{routeId:l,taskId:d,newAssigneeId:m,newAssigneeType:s.fields.assigneeType,taskAssigneeName:u,taskAssigneeUserName:s.fields.taskAssigneeUserName,type:i.options.grid.type,isChangeAssignee:"true"},i.routePropertiesInfo&&"Route Template"==i.routePropertiesInfo.model.Type&&(p=o.getRouteTemplateServiceBaseURL()+"/"+l+"/tasks/"+d,"TRUE"==i.options.grid.routeOwnerTask&&(g.routeOwnerTask="FALSE",g.routeOwnerUGChoice=""));let f={};(f=e.extend(f,o.getSyncOptions(),!0)).method="PUT",f.type="json",f.timeout=0,f.headers={"Content-Type":"application/ds-json"};var h={};h=null!=i.csrf?(new n).createDataForRequest(g,i.csrf):(new n).createDataForRequest(g),f.data=JSON.stringify(h),f.onComplete=function(e){e.result=(new n).parseResp(e),t(e.result)},f.onFailure=function(e,t){a(t||e)},o.authenticateRequest(p,f)})};return s={fetch:e=>r(e),deleteTask:i=>(function(i){return new t(function(t,s){let r=i.getTreeDocument().options.routeId,l=(a=o.getRouteServiceBaseURL())+"/"+r+"/tasks/"+i.options.grid.relId,d={assigneeId:i.options.grid.assigneeId},u={};(u=e.extend(u,o.getSyncOptions(),!0)).method="DELETE",u.type="json",u.timeout=0,u.headers={"Content-Type":"application/ds-json"},u.data=JSON.stringify((new n).createDataForRequest(d)),u.onComplete=function(e){e.result=(new n).parseResp(e),t(e.result)},u.onFailure=function(e,t){s(t||e)},o.authenticateRequest(l,u)})})(i),changeAssignee:(n,i)=>(function(n,i){return new t(function(t,i){null==widget.data.csrf?require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(i){i.getServiceUrl({serviceName:"3DSpace",platformId:o.getTenantValue(),onComplete:function(i){o.authenticateRequest(i+"/resources/v1/application/E6WFoundation/CSRF",e.extend({method:"GET",onComplete:function(e){n.csrf=JSON.parse(e).csrf,t()}}))}})}):t()}).then(function(){return l(n,i)})})(n,i),updateTaskData:(n,i,s)=>(function(n,i,s){return new t(function(t,a){var r={};(r=e.extend(r,o.getSyncOptions(),!0)).method=i,r.type="json",r.timeout=0,r.headers={"Content-Type":"application/ds-json"},r.wait=!0,r.data=JSON.stringify(n),r.onComplete=function(e){t(e)},r.onFailure=function(e,t){a(t||e)},o.authenticateRequest(s,r)})})(n,i,s),updateReviewComment:(i,s)=>(function(i,s){return new t(function(t,a){var r=o.getRouteServiceBaseURL()+"/"+s.id+"/tasks/"+i.model.id,l={taskOwnerReviewComments:i.model.reviewersComments,taskOwnerReviewAction:i.model.taskReviewButton},d={};(d=e.extend(d,o.getSyncOptions(),!0)).method="PUT",d.type="json",d.timeout=0,d.headers={"Content-Type":"application/ds-json"},d.wait=!0,d.data=JSON.stringify((new n).createDataForPromoteDemote(l,"REVISE")),d.onComplete=function(e){t(e)},d.onFailure=function(e,t){a(t||e)},o.authenticateRequest(r,d)})})(i,s),getUserGroupPhysicalId:e=>(function(e){return new t(function(t,n){let i=o.get3DSpaceURL()+"/resources/bps/uuids",s={method:"POST",headers:{"Content-Type":"application/json"}};s.data=JSON.stringify({phyIds:[e]}),s.onComplete=function(e){let o=JSON.parse(e);t(o)},s.onFailure=function(e,t,o){n(JSON.parse(t))},o.authenticateRequest(i,s)})})(e),fetchTaskFields:()=>new t(function(e,t){let n=o.getRouteServiceBaseURL()+"?$definition=nodata",i={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(t){let o=JSON.parse(t).definitions.filter(function(e){return"tasks"==e.name}),n=o.length>0&&o[0].items.filter(function(e){return"bps.publicroutetask-fields"==e.name}),i=(n.length>0&&n[0].items).filter(function(e){return"task-custom-fields"==e.name})[0].items;e(i)},onFailure:function(e){t(e)}};o.authenticateRequest(n,i)}),fetchTaskAttachments:(e,i)=>(function(e,i){return new t(function(t,s){let a=o.getRouteServiceBaseURL()+"/"+e+"/tasks/"+i+"/taskAttachments",r={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t((new n).parseResp(JSON.parse(e)))},onFailure:function(e){s(e)}};o.authenticateRequest(a,r)})})(e,i)}}),define("DS/ENORouteMgmt/Components/TagNavigator",["TagNavigatorProxy/TagNavigatorProxy","DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n){"use strict";var i,s,a,r=!0;let l=function(e){null==e&&(e=[]),i.setTags(null,e)},d=function(e){var t=widget.getValue("stateNLS");if(null!=e)for(var o=0;o<e.length;o++)"ds6w:what/ds6w:status"==e[o].sixw&&("Route.Define"==e[o].object?t&&t.Define&&(e[o].dispValue=t.Define):"Route.In Process"==e[o].object?t&&t.In_Process&&(e[o].dispValue=t.In_Process):"Route.Complete"==e[o].object&&t&&t.Complete&&(e[o].dispValue=t.Complete))},u=function(e){var t=widget.getValue("stateTemplateNLS");if(null!=e)for(var o=0;o<e.length;o++)"ds6w:what/ds6w:status"==e[o].sixw&&("Route Template.Active"==e[o].object?t&&t.Active&&(e[o].dispValue=t.Active):"Route Template.Inactive"==e[o].object&&t&&t.Inactive&&(e[o].dispValue=t.Inactive))};return{setTaggerProxy:t=>(function(t){var o={widgetId:widget.id,filteringMode:"FilteringOnServer"};return i&&a!=t&&(i.die(),i=e.createProxy(o)),a=t,r&&(i=e.createProxy(o),widget.addEvent("onSearch",function(e){s=e,"Route"==a?widget.routeMgmtMediator.publish("route-search-within-data",e):widget.routeMgmtMediator.publish("template-search-within-data",e)}),widget.addEvent("onResetSearch",function(){s=void 0,"Route"==a?widget.routeMgmtMediator.publish("route-reset-search-within-data"):widget.routeMgmtMediator.publish("template-reset-search-within-data")}),r=!1),i})(t),getTaggerVariable:()=>i,getSearchWithInTypedValue:()=>s,setTagsForSummaryPage:e=>l(e),getSearchResult:(e,n)=>(function(e,n){return new Promise(function(i,r){var c;null==e&&(e=[]),null==n&&(n=[]),c="Route"==a?'flattenedtaxonomies:"types/Route"':'flattenedtaxonomies:"types/Route Template"';var m="";m=s?"("+s+" AND "+c+")":c;var p=o.getTenantValue(),g={refine:e,with_indexing_date:!0,with_nls:!0,with_synthesis_attribute:!1,label:"yus-1515078503005",locale:null!=widget&&null!=widget.lang?widget.lang:"en",select_predicate:[],select_file:["icon","thumbnail_2d"],query:m,order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:p,resourceid_in:n};g=JSON.stringify(g);var f={isfederated:!0};t.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",g,function(e){var t=e.facets;"Route"==a?d(t):u(t),l(t),i(e)},function(e){r(e)},f)})})(e,n)}}),define("DS/ENORouteMgmt/Views/InitiateRouteTabsView",["DS/Controls/TabBar","DS/ENORouteMgmt/Components/Mediator","DS/ENORouteMgmt/Config/InitiateRouteTabsConfig"],function(e,t,o){"use strict";let n,i,s={},a={},r=function(e,t){this.container=e,a=t,u()},l=function(e){let t=e.options.value;if(void 0===t&&(t=e.dsModel.value[0]),t!==i){var o=["properties","content","tasks"];s[o[t]].init(a),void 0!==i&&s[o[i]].hideView(),i=t}};r.prototype.init=function(){n=new e({displayStyle:"strip",showComboBoxFlag:!0,editableFlag:!1,multiSelFlag:!1,reindexFlag:!0,touchMode:!0,centeredFlag:!1,allowUnsafeHTMLOnTabButton:!0}),o.forEach(e=>{n.add(e)}),n.inject(this.container),d()};let d=function(){new Promise(function(e,t){let n=[];o.forEach((e,t)=>{""!=e.loader&&(n[t]=new Promise(function(t,o){require([e.loader],function(o){s[e.id]=o,t()})}))}),Promise.all(n).then(()=>{e()})}).then(function(){let e={options:{}};e.options.value=0,l(e),n.addEventListener("tabButtonClick",function(e){l(e)}),n.addEventListener("change",function(e){l(e)})},function(){})};r.prototype.destroy=function(){try{i=void 0,Object.keys(s).map(e=>{s[e].destroy()}),n.destroy(),a={},this.container.destroy()}catch(e){}},r.getModel=function(e){return s[e].getModel()},r.getPropertiesModel=function(){s.properties.getModel()},r.getContentModel=function(){s.contents.getModel()},r.getTasksModel=function(){s.tasks.getModel()};let u=function(){null==widget.routeMgmtMediator&&(widget.routeMgmtMediator=new t),widget.routeMgmtMediator.subscribe("initiateRoute-on-TemplateSelection",function(e){e.template&&e.template.length>0&&e.template[0].id?(a.templateId=e.template[0].id,a.chooseUserFromGroup=e.chooseUserFromUG,a.taskEditSetting=e.template[0].taskEditSetting):(a.templateId="",a.chooseUserFromGroup="No",a.taskEditSetting="")}),widget.routeMgmtMediator.subscribe("initiateRoute-on-ScopeSelection",function(e){a.scopeId=e.scopeId,a.scopePhyId=e.scopePhyId,a.ScopeMembers=e.ScopeMembers}),widget.routeMgmtMediator.subscribe("initiateRoute-on-RouteBasePurposeSelection",function(e){e.basePurpose&&(a.routeBasePurpose=e.basePurpose)})};return r}),define("DS/ENORouteMgmt/Services/CollabTaskServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Views/Form/CustomFieldUtils","DS/WAFData/WAFData","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a){"use strict";let r,l,d,u,c,m,p;l=function(i,s,a){return new t(function(t,s){var r=o.getCollabTaskServiceBaseURL()+"/"+i.model.id,l={routeTaskApprovalComments:i.model.comments};if(l=g(l,i),3==i.model.dueDateOptionSelected){var d=new Date(i.model.taskDueDate);d=d.toISOString(),l.routeTaskDueDate=d}"saveForLater"!=i.model.taskActionButton&&("Yes"==i.model.needsOwnerReview?l.state="Review":l.state="Complete"),"Approve"!=i.model.taskActionButton&&"Reject"!=i.model.taskActionButton&&"Abstain"!=i.model.taskActionButton||(l.routeTaskApprovalAction=i.model.taskActionButton);var u={};(u=e.extend(u,o.getSyncOptions(),!0)).method="PUT",u.type="json",u.timeout=0,u.headers={"Content-Type":"application/ds-json"},u.wait=!0,l=(new n).createDataForRequest(l),"saveForLater"==i.model.taskActionButton&&0!=a.length&&(l.data[0].relateddata={references:a}),u.data=JSON.stringify(l),u.onComplete=function(e){t(e)},u.onFailure=function(e,t){s(t||e)},o.authenticateRequest(r,u)})},m=function(e){var o={};return"Yes"==e.needsOwnerReview&&"Assigned"==e.currentState?(o.routeTaskApprovalComments=a.markAsCompleteComments,o.state="Review",o.routeTaskApprovalAction="Auto Complete",new t(function(n,i){p(e,o).then(s=>(o.routeTaskReviewerComments=a.markAsCompleteComments,o.state="Complete",o.routeTaskApprovalAction="Auto Complete",new t(function(t,n){p(e,o).then(e=>{t(e)},e=>{i(e)})}).then(e=>{n(e)}).catch(e=>{i(e)})),e=>{i(e)})})):(o.routeTaskApprovalComments=a.markAsCompleteComments,o.state="Complete",o.routeTaskApprovalAction="Auto Complete",new t(function(t,n){p(e,o).then(e=>{t(e)},e=>{n(e)})}))},p=function(i,s){return new t(function(t,a){var r=o.getCollabTaskServiceBaseURL()+"/"+i.id,l={};(l=e.extend(l,o.getSyncOptions(),!0)).method="PUT",l.type="json",l.timeout=0,l.headers={"Content-Type":"application/ds-json"},l.wait=!0,s=(new n).createDataForRequest(s),l.data=JSON.stringify(s),l.onComplete=function(e){t(e)},l.onFailure=function(e,t){a(t||e)},o.authenticateRequest(r,l)})},d=function(i){return new t(function(t,s){var a=o.getCollabTaskServiceBaseURL(),r=[],l={updateAction:"DISCONNECT",id:i.model.assigneePID},d={updateAction:"CONNECT",dataelements:{name:o.getLoginUser()}};r.push(d),r.push(l);var u=(new n).createDataForRequest({});u.data[0].id=i.model.id,u.data[0].updateAction="MODIFY",u.data[0].relateddata={assignees:r},u=JSON.stringify(u);var c={};(c=e.extend(c,o.getSyncOptions(),!0)).method="POST",c.type="json",c.timeout=0,c.headers={"Content-Type":"application/ds-json"},c.wait=!0,c.data=u,c.onComplete=function(e){t(e)},c.onFailure=function(e,t){s(t||e)},o.authenticateRequest(a,c)})},u=function(n){return new t(function(t,i){var s=o.getCollabTaskServiceBaseURL()+"/"+n,a={};(a=e.extend(a,o.getSyncOptions(),!0)).method="GET",a.type="json",a.timeout=0,a.headers={"Content-Type":"application/ds-json"},a.wait=!0,a.onComplete=function(e){e.data[0].relateddata&&e.data[0].relateddata.route.length>0?t(e.data[0].relateddata.route[0].id):i(e)},a.onFailure=function(e,t){i(t||e)},o.authenticateRequest(s,a)})},c=function(i,s){return new t(function(t,a){if(0==s.length)t();else{var r=o.getCollabTaskServiceBaseURL()+"/"+i.model.id,l={},d={};(d=e.extend(d,o.getSyncOptions(),!0)).method="PUT",d.type="json",d.timeout=0,d.headers={"Content-Type":"application/ds-json"},d.wait=!0,(l=(new n).createDataForRequest(l)).data[0].relateddata={references:s},d.data=JSON.stringify(l),d.onComplete=function(e){t(e)},d.onFailure=function(e,t){a(t||e)},o.authenticateRequest(r,d)}})};let g=function(e,t){let o=widget.getValue("task-custom-fields");return o&&o.forEach((o,n)=>{if("extensions"!=o.name){let n=t.model[o.name];if("object"==typeof n&&n.getDate)n=n.toISOString();else if(i.isDateField(o))if(Array.isArray(n)){for(var s=0;s<n.length;s++)if(n&&""!=n){let e=new Date(n[s]);n[s]=e.toISOString()}}else if(n&&""!=n){n=new Date(n).toISOString()}e[o.name]=n}}),e};return r={completeTask:e=>m(e),updateComment:(e,t,o)=>l(e,0,o),acceptTask:e=>d(e),updateTaskAttachment:(e,t)=>c(e,t),getRouteIdByTask:e=>u(e)}}),define("DS/ENORouteMgmt/Controller/CollabTaskServicesController",["DS/ENORouteMgmt/Services/CollabTaskServices","UWA/Promise"],function(e,t){"use strict";let o;return o={updateComment:function(o,n,i){return new t(function(t,s){e.updateComment(o,n,i).then(e=>{t(e)},e=>{s(e)})})},completeTask:function(o){return new t(function(t,n){e.completeTask(o).then(e=>{t(e)},e=>{n(e)})})},acceptTask:function(o){return new t(function(t,n){e.acceptTask(o).then(e=>{t(e)},e=>{n(e)})})},getRouteIdByTask:function(o){return new t(function(t,n){e.getRouteIdByTask(o).then(e=>{t(e)},e=>{n(e)})})},updateTaskAttachment:function(o,n){return new t(function(t,i){e.updateTaskAttachment(o,n).then(e=>{t(e)},e=>{i(e)})})}}}),define("DS/ENORouteMgmt/Config/Toolbar/RouteTasksTabToolbarConfig",["DS/ENORouteMgmt/Utilities/RouteWidgetPersistency","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){let o,n={menu:[{type:"CheckItem",title:t.gridView,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-list"},action:{module:"DS/ENORouteMgmt/Views/ToggleTaskViews",func:"doToggleView",argument:{view:"GridView"}},tooltip:t.gridView},{type:"CheckItem",title:t.titleGraphView,state:"selected",fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-flow-tree wux-ui-3ds-lg graph-icon-task-toolbar"},action:{module:"DS/ENORouteMgmt/Views/ToggleTaskViews",func:"doToggleView",argument:{view:"GraphView"}},tooltip:t.titleGraphView}]};return o={writetoolbarDefination:(o,i)=>(function(o,i){let s=i.model.Actions.indexOf("selectusers.tasks")>=0&&"Define"==i.model.state,a=i.model.Actions.indexOf("add.tasks")>=0,r={},l=[],d=!1;i.model.taskEditSetting&&"Maintain Exact Task List"==i.model.taskEditSetting&&(d=!0);let u=!1,c=e.getViewPersistency("RouteTasksPage","GridView"),m="selected"===c?"unselected":"selected";return"Route Template"===i.model.Type&&"Active"===i.model.actualState&&i.model.Actions.indexOf("demote")>=0&&(u=!0),n.menu[0].state=c,n.menu[1].state=m,s&&l.push({id:"selectusers.tasks",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"users-group-ok",fontIconFamily:WUXManagedFontIcons.Font3DS}},action:{module:"DS/ENORouteMgmt/Views/Dialogs/ChooseUsersFromUserGroup",func:"showSeletUsers",argument:{routeId:o.RouteId}},position:"far",category:"create",tooltip:t.SelectAssigneeModalTitle}),(a||u)&&(d||l.push({id:"addRouteTask",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"plus",fontIconFamily:WUXManagedFontIcons.Font3DS}},action:{module:"DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphView",func:"addRouteTask"},position:"far",category:"create",tooltip:t.addTask}),l.push({id:"editTask",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"pencil",fontIconFamily:WUXManagedFontIcons.Font3DS}},action:{module:"DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphView",func:"switchView",argument:{view:"edit"}},position:"far",category:"create",tooltip:t.editMode}),d||l.push({id:"removeRouteTask",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"trash",fontIconFamily:WUXManagedFontIcons.Font3DS}},action:{module:"DS/ENORouteMgmt/Views/Dialogs/DeleteGridTaskDialog",func:"showConfirmationDialog"},position:"far",category:"create",tooltip:t.deleteTask})),l.push({id:"view",className:"routeViews",dataElements:{typeRepresentation:"taskViewDropDown",icon:{iconName:"selected"==c?"view-list":"flow-tree",fontIconFamily:1},value:n},position:"far",tooltip:"selected"==c?t.gridView:t.titleGraphView,category:"action"}),r.entries=l,r.typeRepresentations={taskViewDropDown:{stdTemplate:"functionMenuIcon",semantics:{label:"action",icon:"sorting"},position:"far",tooltip:{text:"view",position:"far"}}},JSON.stringify(r)})(o,i),destroy:function(){_dataGrid.destroy(),_container.destroy()}}}),define("DS/ENORouteMgmt/Config/Toolbar/RouteMembersTabToolbarConfig",["DS/ENORouteMgmt/Utilities/RouteWidgetPersistency","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){let o,n={menu:[{type:"CheckItem",title:t.gridView,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-list"},action:{module:"DS/ENORouteMgmt/Views/ToggleViews",func:"doToggleView",argument:{view:"GridView",curPage:"MembersTab"}},tooltip:t.gridView},{type:"CheckItem",title:t.tileView,state:"selected",fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-view-small-tile"},action:{module:"DS/ENORouteMgmt/Views/ToggleViews",func:"doToggleView",argument:{view:"TileView",curPage:"MembersTab"}},tooltip:t.tileView}]};return o={writetoolbarDefination:()=>(function(){let o=e.getViewPersistency("RouteMembersPage","GridView"),i="selected"===o?"unselected":"selected";n.menu[0].state=o,n.menu[1].state=i;var s={entries:[{id:"view",className:"memberViews",dataElements:{typeRepresentation:"viewdropdown",icon:{iconName:"selected"==o?"view-list":"view-small-tile",fontIconFamily:1},value:n},position:"far",tooltip:"selected"==o?t.gridView:t.tileView,category:"action"}]};return JSON.stringify(s)})(),destroy:function(){_dataGrid.destroy(),_container.destroy()}}}),define("DS/ENORouteMgmt/Model/CollabStorageModel",["UWA/Core","UWA/Class/Model","DS/ENORouteMgmt/EnoviaBootstrap"],function(e,t,o){"use strict";return t.extend({name:"collabstorage",defaults:{csrf:null,isInnovation:!1,displayName:"",url:""},url:function(){return this.get("url")},fetch:function(t){var n,i,s;i="url",(n=this)&&(s=n[i],e.is(s,"function")&&(s=s.call(n)));return t=t?e.clone(t,!1):{},e.extend(t,o.getSyncOptions(),!0),this._parent.call(this,t)},parse:function(t){var o=e.clone(t);return o.csrf=t.csrftoken,delete o.csrftoken,o.isInnovation=t.isinnovation,delete o.isinnovation,o}})}),define("DS/ENORouteMgmt/Views/Loader/ChangeTaskAssigneeChooser",["DS/Utilities/Dom","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i){"use strict";let s,a=function(e){var t;e&&(t=new o({label:e[0]["ds6w:label"],value:e[0].id,name:e[0]["ds6w:identifier"],type:e[0]["ds6w:type_value"]}),s.fields.taskAssigneeField.selectedItems=t)};return{launchAssigneeSearch:(e,o,i,r)=>(function(e,o,i,r){var l=e.dsModel;s=i;var d=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],function(e){var i=e.createSocket({socket_id:d}),s=["Person","User Group"],u="",c="";if(o.model&&"Route Template"==o.model.Type?(u=t.getRefinementToSnN(d,"searchAssignee",!1,s),c=t.getPrecondForTaskMemberSearch(o.model)):"TRUE"==r.options.grid.routeOwnerTask&&""!=r.options.grid.routeOwnerTask&&null!=r.options.grid.routeOwnerTask||"FALSE"==r.options.grid.routeOwnerTask&&"undefined"!=r.options.grid.routeOwnerUGChoice&&""!=r.options.grid.routeOwnerUGChoice?(s=["Person"],u=t.getRefinementToSnN(d,"searchAssignee",!1,s),c=t.getPrecondForRouteOwnerTaskAssignment(r)):(u=t.getRefinementToSnN(d,"searchAssignee",!1,s),c=t.getPrecondForTaskMemberSearch(o.model)),"OnPremise"!=n.getTenantValue()&&(u.source=["3dspace","usersgroup"]),u.precond=c.precond,u.resourceid_in=c.resourceid_in,!UWA.is(i))throw new Error("Socket not initialized");i.dispatchEvent("RegisterContext",u),i.addListener("Selected_Objects_search",a.bind(l)),i.dispatchEvent("InContextSearch",u)})})(e,o,i,r),populateAssigneeField:(e,t)=>(function(e,t){s=e,a(t)})(e,t),getPrecondForChangeAssigneeSearch:(e,o)=>(function(e,o){return e.model&&"Route Template"==e.model.Type?t.getPrecondForTaskMemberSearch(e.model):"TRUE"==o.options.grid.routeOwnerTask&&""!=o.options.grid.routeOwnerTask&&null!=o.options.grid.routeOwnerTask||"FALSE"==o.options.grid.routeOwnerTask&&"undefined"!=o.options.grid.routeOwnerUGChoice&&""!=o.options.grid.routeOwnerUGChoice?t.getPrecondForRouteOwnerTaskAssignment(o):t.getPrecondForTaskMemberSearch(e.model)})(e,o),changeHandlerForChangeAssigneeSearch:e=>(function(e){e.fields.taskAssigneeField.selectedItems&&e.fields.taskAssigneeField.selectedItems.options&&e.fields.taskAssigneeField._editor.elements.inputField.value==e.fields.taskAssigneeField.selectedItems.options.label&&(e.fields.assigneeId=e.fields.taskAssigneeField.selectedItems.options.value,"Person"==e.fields.taskAssigneeField.selectedItems.options.type?(e.fields.taskAssigneeUserName=e.fields.taskAssigneeField.selectedItems.options.name,e.fields.assigneeType=e.fields.taskAssigneeField.selectedItems.options.type):(e.fields.taskAssigneeUserName="",e.fields.assigneeType="Group"))})(e)}}),define("DS/ENORouteMgmt/Collections/CollabStorageCollection",["UWA/Core","UWA/Utils","UWA/Class/Collection","DS/PlatformAPI/PlatformAPI","DS/ENORouteMgmt/Model/CollabStorageModel","DS/i3DXCompassServices/i3DXCompassServices","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(e,t,o,n,i,s,a){"use strict";return o.extend({name:"collabstorages",model:i,fetch:function(e){var t=this,o=[];return new Promise(function(e,t){a.getGrantedRoles(function(t){t.forEach(function(e){"CSV"!==e.id&&"InternalDS"!==e.id||UWA.is(e.platforms,"array")&&(o=o.concat(e.platforms))}),e()})}).then(function(){s.getPlatformServices({serviceName:"3DSpace",onComplete:function(n){o.length>0&&Object.keys(n).map(function(e){o.includes(n[e].platformId)&&t.add({id:n[e].platformId,displayName:n[e].displayName,url:n[e]["3DSpace"]})}),e&&e.onComplete&&e.onComplete(t)},onFailure:function(t){e&&e.onFailure&&e.onFailure(t)}})})},getStorageWithUrl:function(o,n){n=e.clone(n||{},!1);var i,s=t.parseUrl(o).domain;n.domainStrict;if(i=function(o){var n,i,a;return t.parseUrl((n=o,i="url",n&&(a=n[i],e.is(a,"function")&&(a=a.call(n))),a)).domain===s},e.is(s))return this.find(i)}})}),define("DS/ENORouteMgmt/Views/Graph/TaskCustomTileView",["DS/Utilities/Dom","DS/Controls/LineEditor","DS/Controls/ComboBox","DS/Controls/Toggle","DS/Controls/ResponsiveViewAdaptor","UWA/Core","DS/Utilities/Utils","DS/Core/PointerEvents","DS/CoreEvents/ModelEvents","DS/ENORouteMgmt/EnoviaBootstrap","DS/Controls/TooltipModel","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Commands/RouteTaskApprovalProcess","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g){"use strict";let f;return f=i.inherit({name:"RouteTaskCustomView",markForRecordFlag:!0,publishedProperties:{thumbnailWidth:{defaultValue:225,type:"integer",category:"Behavior"}},_applyProperties:function(e){this._parent(e),this.isDirty("thumbnailWidth")&&this._applyThumbnailWidth(e.thumbnailWidth)},_clearTileContent:function(e){e.assignee&&this.elements.descriptionAssignee.getChildren()&&this.elements.descriptionAssignee.getChildren().length>0&&this.elements.descriptionAssignee.getChildren()[0].setContent("")},buildView:function(){this.elements.container;this.elements.container=new s.Element("div",{class:"routemgmt-thumnailview"}),this.elements.container.setStyle("height","90px"),this.elements.container.setAttribute("has-icon","false"),this.elements.container.setAttribute("active-mode","false"),this.elements.container.titleLineNumber=1,this.elements.container.descriptionLineNumber=2,this.elements.highlightBorder=new s.Element("div",{class:"routemgmt-thumnailview-highlightborder"}).inject(this.elements.container),this.elements.activediv=new s.Element("div",{class:"routemgmt-thumnailview-activediv"}).inject(this.elements.container),this.elements.thumbnailtitleBar=s.createElement("div",{class:"routemgmt-tile-thumbnailtitleBar"}),this.elements.titleIcon=new s.Element("div",{class:"routemgmt-thumnailview-title-icon"}),s.createElement("div",{class:"content",html:[{tag:"img",src:c.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")}]}).inject(this.elements.titleIcon),this.elements.titleIcon.inject(this.elements.thumbnailtitleBar);let t=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos);this.elements.thumbnailTitleText=e.createEllipsisText({allowUnsafeHTMLLabel:t,label:g.taskTitlePlaceholder,maxWidth:"auto",lineHeight:this._getTitleLineHeight(),nbLinesVisible:1}).inject(this.elements.thumbnailtitleBar),this.elements.checkbox=new s.Element("div",{class:"routemgmt-thumnailview-checkbox"}).inject(this.elements.thumbnailtitleBar),this.checkbox=this.elements.checkbox,this.elements.thumbnailtitleBar.inject(this.elements.container),this.elements.menu=new s.Element("div",{class:"routemgmt-tileview wux-controls-responsivetileview-menu"}).inject(this.elements.container),this.elements.menu.responsiveTileView=this,this.elements.menu.setAttribute("has-menu","false"),this.elements.maincontent=new s.Element("div",{class:"routemgmt-thumnailview-maincontent"}).inject(this.elements.container),this.elements.maincontent.setAttribute("has-menu","false"),this.elements.maincontent.setStyle("display","none"),this.elements.titlebar=new s.Element("div",{class:"routemgmt-thumnailview-titlebar"}).inject(this.elements.maincontent),this.elements.icon=new s.Element("div",{class:"routemgmt-thumnailview-icon"}).inject(this.elements.titlebar),this.elements.title=new s.Element("div",{class:"routemgmt-thumnailview-title"}).inject(this.elements.titlebar),this.elements.title.contentView=this,e.addEventOnElement(this,this.elements.title,"click",this._onTitleClick),this.elements.title.setAttribute("has-menu","false"),this.elements.title.setAttribute("has-icon","false"),this.elements.thumbnailsubtitleBar=s.createElement("div",{class:"routemgmt-tile-thumbnailsubtitleBar"}),this.elements.subtitle=new s.Element("div",{class:"routemgmt-thumnailview-subtitle",id:"approvalStatusGettingId"}).inject(this.elements.thumbnailsubtitleBar),this.elements.subtitleIcon=new s.Element("div",{class:"routemgmt-thumnailview-subtitle-icon"}),s.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x"}).inject(this.elements.subtitleIcon),this.elements.subtitleIcon.inject(this.elements.thumbnailsubtitleBar),this.elements.subtitle.setAttribute("has-subtitle","false"),this.elements.subtitle.setAttribute("has-menu","false"),this.elements.subtitle.inject(this.elements.thumbnailsubtitleBar),this.elements.thumbnailsubtitleBar.inject(this.elements.container),this.elements.mc_desc_separator=new s.Element("div",{class:"routemgmt-thumnailview-mc_desc_separator"}).inject(this.elements.container),this.elements.mc_desc_separator.setStyle("display","none"),this.elements.description=new s.Element("div",{class:"routemgmt-thumnailview-description"}).inject(this.elements.container),this.elements.dueDateStatusIcon=new s.Element("div",{class:"routemgmt-thumnailview-description-duedate-status"}).inject(this.elements.description),s.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x"}).inject(this.elements.dueDateStatusIcon),this.elements.dueDateStatusIcon.setStyle("display","none"),this.elements.descriptionDueDate=new s.Element("div",{class:"routemgmt-thumnailview-description-duedate"}).inject(this.elements.description),this.elements.descriptionDueDate.setStyle("display","none");m.getAvatarDetails("AdminUser VPLM");this.elements.ownerIcon=s.createElement("div",{class:"assignee task-assignee",html:[{tag:"img",class:"userIcon",src:""}]}),this.elements.ownerIcon.setStyle("display","none"),this.elements.descriptionAssignee=new s.Element("div",{class:"routemgmt-thumnailview-description-assignee"}),this.elements.assigneeIcon=new s.Element("div",{class:"routemgmt-thumnailview-assignee-icon"}),s.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-2x"}).inject(this.elements.assigneeIcon),this.elements.assigneeIcon.setStyle("display","none"),this.elements.assigneeIcon.inject(this.elements.descriptionAssignee),this.elements.ownerIcon.inject(this.elements.descriptionAssignee),this.elements.descriptionAssignee.inject(this.elements.description),this.elements.taskState=s.createElement("span",{html:"",class:""}),this.elements.descriptionState=new s.Element("div",{class:"routemgmt-thumnailview-description-state"}),this.elements.taskState.inject(this.elements.descriptionState),this.elements.descriptionState.inject(this.elements.description),this.elements.description.setAttribute("has-description","false"),this.elements.descriptionTemplateIcon=new s.Element("div",{class:"routemgmt-thumnailview-desc-template-icon"}),s.createElement("div",{class:"content",html:[{tag:"img",src:c.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTemplate16.png")}]}).inject(this.elements.descriptionTemplateIcon),this.elements.descriptionTemplateIcon.inject(this.elements.description),this.elements.descriptionRouteIcon=new s.Element("div",{class:"routemgmt-thumnailview-desc-route-icon"}),s.createElement("div",{class:"content",html:[{tag:"img",src:c.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_Route16.png")}]}).inject(this.elements.descriptionRouteIcon),this.elements.descriptionRouteIcon.inject(this.elements.description),this.elements.subroutes=new s.Element("div",{class:"routemgmt-thumnailview-subroutes-border",id:"taskSubRoutesBorder"}).inject(this.elements.container),this.elements.subroutes.style.display="none",this.elements.subRouteBar=s.createElement("div",{class:"routemgmt-tile-subRouteBar",id:"taskSubRouteDiv"}),this.elements.subRouteApprovalTitle=new s.Element("span",{class:"routemgmt-thumnailview-subRouteApprovalTitle"}).inject(this.elements.subRouteBar),this.elements.subRouteApprovalIcon=new s.Element("span",{class:"routemgmt-thumnailview-subtitle-subRouteApprovalIcon",id:"subRouteApproveStatusIcon"}),this.elements.activityIcon=s.createElement("span",{}),this.elements.activityIcon.inject(this.elements.subRouteApprovalIcon),this.elements.subRouteApprovalMainTitle=new s.Element("a",{class:"routemgmt-thumnailview-subRouteApprovalMainTitle",id:"subRouteApprovalInfo"}).inject(this.elements.subRouteApprovalTitle),this.elements.subRouteApprovalMainTitleNoLink=new s.Element("span",{class:"routemgmt-thumnailview-subRouteApprovalMainTitleNoLink",id:"subRouteApprovalInfoNoLink"}).inject(this.elements.subRouteApprovalTitle),this.elements.subRouteApprovalIcon.inject(this.elements.subRouteApprovalTitle),this.elements.subRouteApprovalMainTitle.inject(this.elements.subRouteApprovalTitle),this.elements.subRouteApprovalMainTitleNoLink.inject(this.elements.subRouteApprovalTitle),this.elements.subRouteApprovalTitle.inject(this.elements.subRouteBar),this.elements.subRouteApprovalMainTitle.style.display="none",this.elements.subRouteApprovalMainTitleNoLink.style.display="none",this.elements.subRouteBar.inject(this.elements.container),this.elements.subRouteBar.style.display="none",this.elements.picture=new s.Element("div",{class:"routemgmt-thumnailview-picture"}).inject(this.elements.container),this.elements.color=new s.Element("div",{class:"routemgmt-thumnailview-color"}).inject(this.elements.picture),this.elements.color.setAttribute("has-color","false"),this.elements.propertiesList=new s.Element("div",{class:"routemgmt-thumnailview-propertiesListContainer"}).inject(this.elements.container),this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.statusbar=new s.Element("div",{class:"routemgmt-thumnailview-statusbar"}).inject(this.elements.container),this.elements.statusbar.setAttribute("has-statusbar-content","false"),this.elements.statusbar.setAttribute("is-empty-statusbar-visible","false"),this.elements.statusbaricons=[]},_applyDescription:function(e){this.elements.mc_desc_separator.style.display="none",this._parent()},_applyTitle:function(t){let o=this.title;if(o){let t=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos);this.elements.title.layoutDsModel=this.layoutingCollection,e.setContent(this.elements.thumbnailTitleText,o,t),this.elements.container.setAttribute("title",o)}else this.elements.container.setAttribute("title",g.taskTitlePlaceholder)},_applyCustomTooltip:function(e){},_applySubtitle:function(t){var o=this.subtitle;if(o.label){var n=!this.layoutingCollection||this.layoutingCollection.shouldCellAllowUnsafeHTMLContentAt(this.cellInfos);if(this.elements.subtitle.layoutDsModel=this.layoutingCollection,e.setContent(this.elements.subtitle,o.label,n),this.elements.subtitle.setStyle("color",o.color),this.elements.subtitle.setAttribute("has-subtitle","true"),this.elements.subtitleIcon.getChildren()&&this.elements.subtitleIcon.getChildren().length>0&&void 0!==o.icon)this.elements.subtitleIcon.getChildren()[0].addClassName(o.icon),this.elements.subtitleIcon.getChildren()[0].setStyle("color",o.color);else if(this.elements.subtitleIcon.getChildren()[0].setStyle("color",o.color),this.elements.subtitle.setStyle("margin-left","0px"),this.elements.subtitleIcon.getChildren().length>0){let e=this.elements.subtitleIcon.getChildren()[0].classList.length>2?this.elements.subtitleIcon.getChildren()[0].classList[2]:void 0;e&&this.elements.subtitleIcon.getChildren()[0].classList.remove(e)}}else if(this.elements.subtitle.setAttribute("has-subtitle","false"),this.elements.subtitleIcon.getChildren()&&this.elements.subtitleIcon.getChildren().length>0){let e=this.elements.subtitleIcon.getChildren()[0].classList.length>2?this.elements.subtitleIcon.getChildren()[0].classList[2]:void 0;e&&(this.elements.subtitleIcon.getChildren()[0].classList.remove(e),this.elements.subtitleIcon.getChildren()[0].setStyle("color",""))}},_setDescription:function(e,t){if(!e)return this.elements.description.setAttribute("has-description","false"),void(this.elements.realdescription="");this.elements.mc_desc_separator.style.display="none",this.elements.propertiesList.setAttribute("has-propertiesList","false"),this.elements.realdescription=e,1===t?this.elements.description.setAttribute("on-singleLine","true"):this.elements.description.setAttribute("on-singleLine","false");this._getDescriptionLineHeight();var o=this.elements.description.getAttribute("on-singleLine");this.elements.description=new s.Element("div",{class:"routemgmt-thumnailview-description"}),e.assignee&&(" "==e.assignee?this.clearAssignee():this.drawAssignee(e)),e.state&&this.setTaskState(e),this.drawSubroutes(e),e.templateTask?(this.elements.descriptionTemplateIcon.style.display="block",this.elements.descriptionTemplateIcon.title=e.templateTaskTooltip?e.templateTaskTooltip:"",this.elements.descriptionRouteIcon.style.display="none"):e.initialTask?(this.elements.descriptionRouteIcon.style.display="block",this.elements.descriptionRouteIcon.title=e.routeInitialTaskTooltip?e.routeInitialTaskTooltip:"",this.elements.descriptionTemplateIcon.style.display="none"):(this.elements.descriptionTemplateIcon.style.display="none",this.elements.descriptionRouteIcon.style.display="none"),e.dueDateStatus&&(""==e.dueDateStatus.icon?this.elements.dueDateStatusIcon.setStyle("display","none"):this.elements.dueDateStatusIcon.setStyle("display","block"),this.elements.dueDateStatusIcon.getChildren()[0].addClassName(e.dueDateStatus.icon),this.elements.dueDateStatusIcon.getChildren()[0].setStyle("color",e.dueDateStatus.color),this.elements.dueDateStatusIcon.title=e.dueDateStatus.tooltip),e.duedate&&" "!=e.duedate?(this.elements.descriptionDueDate.setStyle("display","block"),this.elements.descriptionDueDate.innerText=e.duedate,this.elements.descriptionDueDate.title=e.dateTooltip):(this.elements.descriptionDueDate.setStyle("display","none"),this.elements.descriptionDueDate.innerText="",this.elements.descriptionDueDate.title=""),this.elements.description.layoutDsModel=this.layoutingCollection,this.elements.description.setAttribute("has-description","true"),this.elements.description.setAttribute("on-singleLine",o)},setTaskState:function(e){if(this.elements.descriptionState.getChildren()&&this.elements.descriptionState.getChildren().length>0){let t="";"Draft"===e.state.trim()?t="route-task-state-title DEFINE":"Assigned"===e.state.trim()?t="route-task-state-title INPROCESS":"Review"===e.state.trim()?t="route-task-state-title INAPPROVAL":"Complete"===e.state.trim()&&(t="route-task-state-title COMPLETE"),this.elements.descriptionState.getChildren()[0].className=t,this.elements.descriptionState.getChildren()[0].setContent(e.stateNLS),this.elements.descriptionState.getChildren()[0].title=e.stateNLS}},drawSubroutes:function(e){if(null!=e&&null!=e.state&&"Draft"!=e.state.trim()&&"view"==e.graphCurrentType&&null!=e.taskSubRoutes&&e.taskSubRoutes.length>0){var t="";t=e.subRouteApprovalStatus;let s=m.getRouteActivityStateIcon(t),a=m.getRouteActivityStateNLS(t),r="";t.contains("your")?(this.elements.subRouteApprovalMainTitle.style.display="inline-block",r="true",this.elements.activityIcon.hasClassName("wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+s+" awaiting-tasks")||this.elements.activityIcon.addClassName("wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+s+" awaiting-tasks")):(r="false",this.elements.subRouteApprovalMainTitleNoLink.style.display="inline-block",this.elements.activityIcon.hasClassName("wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+s+" disable-link")||this.elements.activityIcon.addClassName("wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+s+" disable-link")),this.elements.subroutes.style.display="block",this.elements.subRouteBar.style.display="block";var o="true"==r?this.elements.subRouteApprovalMainTitle:this.elements.subRouteApprovalMainTitleNoLink;o.title=a,o.innerText=a;var n={};n.taskTitleForSubRoute=e.taskTitleForSubRoute,n.taskIdForSubRoute=e.taskIdForSubRoute,n.route=[];var i=e.taskSubRoutes;for(let e=0;e<i.length;e++)n.route.push({dataelements:{id:i[e].routeId,name:i[e].routeName,approvalTaskId:i[e].approvalTaskId,activityState:i[e].activityState}});"true"==r&&(n.fromPage="hyperlink",o.addEventListener("click",function(e){p.getApprovalCommandMenu(n,"openInboxTask").then(e=>{e.action.callback()},e=>{})})),this.elements.container.setStyle("height","95px")}else this.elements.container.setStyle("height","70px")},drawAssignee:function(e){let t="/api/user/getpicture/login/"+e.assigneeUserName+"/format/normal",o=d.getSwymUrl()+t;if("Ask Route Owner"==e.assigneeType)this.elements.assigneeIcon.getChildren()&&this.elements.assigneeIcon.getChildren().length>0&&(this.elements.assigneeIcon.getChildren()[0].addClassName(e.assigneeIcon),this.elements.assigneeIcon.style.display="block",this.elements.assigneeIcon.title=g.routeOwnerTask,this.elements.descriptionAssignee.querySelector(".avatarIcon")&&this.elements.descriptionAssignee.querySelector(".avatarIcon").setStyle("display","none"),this.elements.descriptionAssignee.querySelector(".userIcon")&&this.elements.descriptionAssignee.querySelector(".userIcon").setStyle("display","none"),this.elements.ownerIcon.setStyle("display","none"));else{if(this.elements.assigneeIcon.style.display="none","Person"==e.assigneeType){if(null!=d.getSwymUrl())this.elements.descriptionAssignee.querySelector(".userIcon")&&(this.elements.descriptionAssignee.querySelector(".userIcon").setStyle("display","block"),this.elements.descriptionAssignee.querySelector(".userIcon").src=o);else{let t=s.createElement("div",{class:"avatarIcon"}),o=m.getAvatarDetails(e.assignee),n=o.avatarStr;t.setContent(n),t.style.setProperty("background",o.avatarColor),this.elements.descriptionAssignee.getChildren()&&this.elements.descriptionAssignee.getChildren().length>0&&(this.elements.descriptionAssignee.querySelector(".userIcon")&&this.elements.descriptionAssignee.querySelector(".userIcon").setStyle("display","none"),this.elements.descriptionAssignee.querySelector(".avatarIcon")?(this.elements.descriptionAssignee.querySelector(".avatarIcon").setContent(n),this.elements.descriptionAssignee.querySelector(".avatarIcon").style.setProperty("background",o.avatarColor)):this.elements.descriptionAssignee.querySelector(".assignee")&&this.elements.descriptionAssignee.querySelector(".assignee").addContent(t)),this.elements.descriptionAssignee.querySelector(".avatarIcon").setStyle("display","block")}this.elements.descriptionAssignee.title=e.assignee}"Group"!=e.assigneeType&&"Group Proxy"!=e.assigneeType&&"User Group"!=e.assigneeType||this.elements.descriptionAssignee.querySelector(".userIcon")&&(this.elements.descriptionAssignee.querySelector(".avatarIcon")&&this.elements.descriptionAssignee.querySelector(".avatarIcon").setStyle("display","none"),this.elements.descriptionAssignee.querySelector(".userIcon").setStyle("display","block"),this.elements.descriptionAssignee.querySelector(".userIcon").src=c.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png"),this.elements.descriptionAssignee.title=e.assigneeTitle),this.elements.ownerIcon.setStyle("display","block")}},clearAssignee:function(){if(this.elements.descriptionAssignee){let e=this.elements.descriptionAssignee.querySelector(".avatarIcon");e&&e.setStyle("display","none"),this.elements.descriptionAssignee.querySelector(".userIcon")&&this.elements.descriptionAssignee.querySelector(".userIcon").setStyle("display","none")}},_getViewMinWidth:function(){return 150},_getViewMaxWidth:function(){return 420},_getViewWidth:function(){return this.thumbnailWidth},_getViewCssClassSuffix:function(){return"routemgmtTileView"},_applyThumbnailWidth:function(e){this._applyViewWidth(e)}})}),define("DS/ENORouteMgmt/Services/InitiateRouteServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/WAFData/WAFData"],function(e,t,o,n,i){"use strict";let s,a,r;a=function(i){return new t(function(t,n){null==i.csrf?require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(n){n.getServiceUrl({serviceName:"3DSpace",platformId:o.getTenantValue(),onComplete:function(n){o.authenticateRequest(n+"/resources/v1/application/E6WFoundation/CSRF",e.extend({method:"GET",onComplete:function(e){i.csrf=JSON.parse(e).csrf,t()}}))}})}):t()}).then(function(){return function(e){return new t(function(t,i){let s=o.getRouteServiceBaseURL(),a={method:"POST",headers:{"Content-Type":"application/ds-json"}};"True"==e.data[0].dataelements.useTemplateTasks?s+="?$include=tasks":e.data[0].dataelements.useTemplateTasks="False",a.data=JSON.stringify(e),a.timeout=0,a.onComplete=function(e){let o=(new n).parseResp(JSON.parse(e)),i=JSON.parse(e);if(i.data[0].relateddata&&i.data[0].relateddata.tasks){let e=i.data[0].relateddata.tasks;for(let t of e)if("True"==t.dataelements.chooseUsersFromUg){o[0].actions.push("selectusers.tasks");break}let t=l(e);o[0].assignees=t}t(o)},a.onFailure=function(e,t,o){i(JSON.parse(t))},o.authenticateRequest(s,a)})}(i)})},r=function(i){return new t(function(t,n){null==i.csrf?require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(n){n.getServiceUrl({serviceName:"3DSpace",platformId:o.getTenantValue(),onComplete:function(n){o.authenticateRequest(n+"/resources/v1/application/E6WFoundation/CSRF",e.extend({method:"GET",onComplete:function(e){i.csrf=JSON.parse(e).csrf,t()}}))}})}):t()}).then(function(){return function(e){return new t(function(t,i){let s=o.getRouteServiceBaseURL()+"?action=start",a={method:"POST",headers:{"Content-Type":"application/ds-json"}};"True"==e.data[0].dataelements.useTemplateTasks?s+="&$include=tasks":e.data[0].dataelements.useTemplateTasks="False",a.data=JSON.stringify(e),a.timeout=0,a.onComplete=function(e){let o=(new n).parseResp(JSON.parse(e));t(o)},a.onFailure=function(e,t,o){i(JSON.parse(t))},o.authenticateRequest(s,a)})}(i)})};let l=function(e){let t=[];return e.forEach(function(e){if(t.indexOf(e.dataelements.taskAssignee)<0){let o="User Group";"Person"==e.dataelements.assigneeType&&(o=e.dataelements.assigneeType);let n=o+"~"+e.dataelements.taskAssigneeUsername+"~"+e.dataelements.taskAssignee;t.push(n)}}),t};return s={saveAsRoute:e=>a(e),createRoute:e=>r(e),getScopeInformation:e=>(function(e){return new t(function(t,n){let i=o.get3DSpaceURL()+"/resources/bps/scopeMembers?oid="+e,s={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(e){t(JSON.parse(e))},onFailure:function(e){n(JSON.parse(e))}};o.authenticateRequest(i,s)})})(e)}}),define("DS/ENORouteMgmt/Views/RouteTabsView",["DS/Controls/TabBar","DS/ENORouteMgmt/Config/RouteTabsConfig","DS/ENORouteMgmt/Utilities/RouteWidgetPersistency","DS/ENORouteMgmt/Model/RouteModel"],function(e,t,o,n){"use strict";let i,s,a={},r={},l=function(e,t){r=t,this.container=e};var d=["tasks","content","members"];let u=function(e){let t=e.options.value;if(void 0===t&&(t=e.dsModel.value[0]),t===s)return;let o=n.getOpenedRouteModel();if(r.model.state!=o.model.state){r=o;let e=document.getElementById("routeContentsContainer");null!=e&&e.parentNode.removeChild(e)}a[d[t]].init(r),void 0!==s&&a[d[s]].hideView(),s=t,widget.setValue("RouteTabs-ShowView",t)};l.prototype.init=function(){i=new e({displayStyle:"strip",showComboBoxFlag:!0,editableFlag:!1,multiSelFlag:!1,reindexFlag:!0,touchMode:!0,centeredFlag:!1,allowUnsafeHTMLOnTabButton:!0}),t.forEach(e=>{let t=o.getTabPersistency("RouteTabsPage");e.id==d[t]?e.isSelected=!0:e.isSelected=!1,i.add(e)}),i.inject(this.container),c()};let c=function(){new Promise(function(e,o){let n=[];t.forEach((e,t)=>{""!=e.loader&&(n[t]=new Promise(function(t,o){require([e.loader],function(o){a[e.id]=o,t()})}))}),Promise.all(n).then(()=>{e()})}).then(function(){let e={options:{}},t=o.getTabPersistency("RouteTabsPage");e.options.value=t,u(e),i.addEventListener("tabButtonClick",function(e){u(e)}),i.addEventListener("change",function(e){u(e)})},function(){})};return l.prototype.destroy=function(){try{s=void 0,Object.keys(a).map(e=>{a[e].destroy()}),null!=i&&i.destroy(),r={},this.container.destroy()}catch(e){}},l}),define("DS/ENORouteMgmt/Views/Loader/InitiateSaveAsTemplateLinkTemplateChooser",["DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/TreeModel/TreeNodeModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o){"use strict";let n,i=!1;var s=function(e,o){var i;o&&(i=new t({label:o[0]["ds6w:label"],value:o[0].id,status:o[0]["ds6w:status_value"],category:o[0]["ds6w:category"]}),n.fields.linkedTemplateField.selectedItems=i)};return{init:(t,o,i)=>(function(t,o,i){n=o;var a,r=t.dsModel,l=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],function(t){var o=t.createSocket({socket_id:l});a=null!=i&&""!=i&&"Revise Template"==n.fields.buttonGroupSA.value[0]?i.saveAsLtSearchRestictIds:"";var d=e.getRefinementToSnN(l,"linkTemplate",!1,["Route Template"]),u=e.getPrecondForLinkTemplateSaveAsSearch(a);if(d.precond=u.precond,""!=a&&(d.resourceid_not_in=u.resourceid_not_in),!UWA.is(o))throw new Error("Socket not initialized");o.dispatchEvent("RegisterContext",d),o.addListener("Selected_Objects_search",s.bind(r,"")),o.dispatchEvent("InContextSearch",d)})})(t,o,i),destroy:()=>{n={}},getPrecondForLinkedTemplateSearch:(t,o)=>(function(t,o){var n;return n=null!=t&&""!=t&&"Revise Template"==o.fields.buttonGroupSA.value[0]?t.saveAsLtSearchRestictIds:"",e.getPrecondForLinkTemplateSaveAsSearch(n)})(t,o),changeHandlerLinkedFortemplateField:e=>(function(e){if(i)i=!1;else{if(e.fields.linkedTemplateField.selectedItems){let t=e.fields.linkedTemplateField.selectedItems.options.status;if("Released"!=t&&"Route Template.Active"!=t){let n;"Draft"==t||"Route Template.Inactive"==t?n=o.errorSelectedInactiveTemplate:"Archived"!=t&&"Route Template.Archive"!=t||(n=o.errorSelectedArchiveTemplate),widget.notify.handler().addNotif({level:"error",subtitle:n,sticky:!1}),i=!0,e.fields.linkedTemplateField.selectedItems=void 0}}e.fields.linkedTemplateField.selectedItems&&e.fields.linkedTemplateField.selectedItems.options?e.fields.linkedTemplateField._editor.elements.inputField.value==e.fields.linkedTemplateField.selectedItems.options.label&&(e.linkTemplateCompleteActionField.className="",e.demoteOnRejectionField.className="",e.linkTemplateCompleteActionField.getChildren()[0]&&(e.linkTemplateCompleteActionField.getChildren()[0].innerText=o.replace(o.routeCompletionActionForSelectedTemplate,{tag1:e.fields.linkedTemplateField.selectedItems.options.label})),e.fields.linkedTemplateField.selectedItems.options.category&&e.fields.linkedTemplateField.selectedItems.options.category.includes("Promote Connected Object")?e.fields.routeCompletionAction.selectedIndex=1:e.fields.routeCompletionAction&&(e.fields.routeCompletionAction.selectedIndex=0)):(e.linkTemplateCompleteActionField.className="fonticon-chooser-scope-display",e.demoteOnRejectionField.className="fonticon-chooser-scope-display")}})(e)}}),define("DS/ENORouteMgmt/Utilities/RouteDocumentUtils",["UWA/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/DocumentManagement/DocumentManagement"],function(e,t,o){"use strict";return{getDocumentsData:function(n){return new e(function(e,i){o.getDocuments(n,{tenant:t.getTenantValue(),securityContext:decodeURIComponent(t.getSecurityContextValue()),tenantUrl:t.get3DSpaceURL(),additionalURLParams:"$fields=indexedTypeicon",onComplete:function(t){t.success&&Array.isArray(t.data)?e(t):i()},onFailure:function(e){console.log(e),i()}})})},getCommands:function(e,o,n,i,s){var a=this,r=t.get3DSpaceURL(),l=t.getDashboardURL(),d=[i];a.getDocumentsData(d).then(function(i){var u=new o;u.subscribe({event:"docv2-show-notification"},function(e){widget.notify.handler().addNotif({level:e.level,title:e.title,subtitle:e.subtitle,sticky:e.sticky,allowUnsafeHTML:e.allowUnsafeHTML,message:e.message})}),u.subscribe({event:"docv2-undoedit-complete"},function(e){a.getDocumentsData(d).then(function(t){c=t.data[0],u.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModel}})})}),u.subscribe({event:"docv2-edit-complete"},function(e){a.getDocumentsData(d).then(function(t){c=t.data[0],u.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModel}})})}),u.subscribe({event:"docv2-update-complete"},function(e){a.getDocumentsData(d).then(function(t){c=t.data[0],u.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModel}}),u.publish({event:"docv2-preview-reload-viewer",data:{nodeModel:e.nodeModel}})})});var c=i.data[0],m={fetchSecurityContext:function(){return decodeURIComponent(t.getSecurityContextValue())},getSelectedNodes:function(){return[c]},getDocumentFromNodeModel:function(e){return e},platformUrls:{"3DSpace":r,"3DDashboard":l,platformId:t.getTenantValue()},events:u},p=new n(m),g=p.commands,f={entries:[g[e.PREVIEW],g[e.UPDATE],g[e.DOWNLOAD],g[e.EDIT],g[e.UNDO_EDIT],g[e.OFFICE_WEB_EDITION],g[e.LOCK_AND_DOWNLOAD],g[e.UNLOCK],g[e.UPDATE_AND_UNLOCK]]};"Document"==c.type&&f.entries.push(g[e.COPY_LINK]),p.getWebUXContextMenuItemsForCurrentSelection(f.entries,!1).then(e=>{s(e)})})}}}),define("DS/ENORouteMgmt/Services/RouteWidgetUtilServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/WAFData/WAFData"],function(e,t,o,n){"use strict";let i,s,a,r;return s=function(){return new t(function(e,t){let n=o.get3DSpaceURL()+"/resources/bps/cspaces",i={method:"GET",headers:{"Content-Type":"application/ds-json"},onComplete:function(t){var o=[],n=[],i=null,s=null,a=JSON.parse(t).cspaces;a&&0!==a.length||(a=[]);var r="",l=!0;if(a.forEach(function(e){var t=e.displayName.split(".");if(3===t.length&&l){var o=t[1];""==r&&(r=o),l=r==o}}),a.forEach(function(e){var t=e.displayName,n=e.displayName.split("."),a=e.name.split(".");3===n.length&&(t=n[2]+" ● ",l||(t+=n[1]+" ● "),t+=n[0]),o.push({label:t,value:e.name}),e.isDefault&&(i=e.name,s=a[1])}),null==i&&a.length>0){i=a[0].name;var d=a[0].name.split(".");s=d[1]}n.push({cspaces:o,defaultsc:i,defaultOrgName:s}),e(n)},onFailure:function(e,o){t(o)}};o.authenticateRequest(n,i)})},a=function(){return new t(function(t,n){let i=o.getRouteServiceBaseURL()+"/supportedContentTypes",s={};(s=e.extend(s,o.getSyncOptions(),!0)).method="GET",s.type="json",s.headers={"Content-Type":"application/ds-json"},s.data={csrf:widget.data.csrf},s.onComplete=function(e){t(e)},s.onFailure=function(e){n(e)},o.authenticateRequest(i,s)})},r=function(n){return new t(function(t,i){let s=o.get3DSpaceURL()+"/resources/bps/objectAccess",a={};(a=e.extend(a,o.getSyncOptions(),!0)).method="POST",a.data="oid_list="+n.toString(),a.headers={"Content-Type":"application/x-www-form-urlencoded"},a.onComplete=function(e){let o=JSON.parse(e);t(o)},a.onFailure=function(e,t,o){i(JSON.parse(t))},o.authenticateRequest(s,a)})},i={fetchSecurityContext:()=>s(),fetchAllowedContentTypesForRoute:()=>a(),fetchStateBlockingConditions:e=>r(e)}}),define("DS/ENORouteMgmt/Views/ContentInfoPropWidget",["UWA/Class/View","UWA/Core","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","UWA/Class/Model","UWA/Drivers/Alone","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u){return{render:function(e,t){var i=[n.FACET_PROPERTIES,n.FACET_VIEWS,n.FACET_RELATIONS,n.FACET_ADMIN];this.parentContainer=this.container;var s={typeOfDisplay:n.ALL,selectionType:n.NO_SELECTION,facets:i,editMode:!1,readOnly:!0,context:{getSecurityContext:function(){return{SecurityContext:d.getSecurityContextValue()}}},extraNotif:!0,actions:[{name:"action_close_panel",text:u.infoCloseAction,icon:"close",handler:function(){widget.routeMgmtMediator.publish("route-content-preview-close")}}]};return this.EditPropWidget=new o(s),t.model.id&&this.loadModel(t.model.id,e),this},getPropModel:function(e){var t=[],o=new i({metatype:"businessobject",objectId:e.objectId,source:"3DSpace",tenant:d.getTenantValue()});return o.set("isTransient",!1),t.push(o),t},loadModel:function(e,t){var o=this.getPropModel({objectId:e});this.EditPropWidget.initDatas(o),this.EditPropWidget.elements.container.inject(t)}}}),define("DS/ENORouteMgmt/Components/Wrappers/WrapperLargeTileView",["DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/ENXESignature/ENXESignMgmtDetails","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Controller/RouteESignServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i){"use strict";let s,a,r=function(s,r){a=r||UWA.createElement("div",{id:"routeInfoHistoryContainer",class:""});var l=new e({model:s,displayedOptionalCellProperties:["description","contextualMenu"],selectionBehavior:{toggle:!1,unselectAllOnEmptyArea:!1,selectNodeModelOnCellSelection:!1,canMultiSelect:!1,canInteractiveMultiselectWithCheckboxClick:!1,enableShiftSelection:!1,enableFeedbackForActiveCell:!1},onContextualEvent:{callback:function(e){var s=[],a=e.cellInfos.cellModel.options.data.split("~")[3],r=e.cellInfos.cellModel.options.subLabel;return null==a||""==a?s:(s.push({name:i.ESignRecord,title:i.ESignRecord,type:"PushItem",data:e,action:{callback:function(){n.fetchESignDetails(a,"3DSpace").then(e=>{var n=JSON.parse(e);if(n.data.length>1){var i="",s="";n.data.forEach(e=>{var t=new Date(r),o=new Date(e.dataelements.SignedTime),n=Math.abs(o-t)/1e3;""==i&&(i=n),""==s&&(s=e.id),n<i&&(i=n,s=e.id)});let e={x3dPlatformId:o.getTenantValue(),ESignRecordId:s,onCloseCallback:()=>{}};t.init(e,null)}else{let e={x3dPlatformId:o.getTenantValue(),serviceID:"3DSpace ",refID:a,onCloseCallback:()=>{}};t.init(e,null)}},e=>{console.log(e)})}}}),s)}}});return l.getContent().style.top="50 px",l.inject(a),a};return s={build:(e,t)=>r(e,t),tileView:()=>{}}}),define("DS/ENORouteMgmt/Config/RouteSummaryGridViewConfig",["DS/ENORouteMgmt/Views/Grid/RouteGridCustomColumns","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){"use strict";return[{text:t.title,dataIndex:"tree",editableFlag:!1,pinned:"left"},{text:t.name,dataIndex:"Name",editableFlag:!1},{text:t.IDcardMaturityState,dataIndex:"Maturity_State",editableFlag:!1,onCellRequest:e.onRouteNodeStateCellRequest},{text:t.routeBasePurpose,dataIndex:"BasePurposeNLS",editableFlag:!1},{text:t.activity_state,dataIndex:"Activity_StateNLS",typeRepresentation:"user",editableFlag:!1,compareFunction:function(t,o){return e.compareActivityStates(t,o)}},{text:t.description,dataIndex:"Description"},{text:t.revision,dataIndex:"revisionValue",typeRepresentation:"user",editableFlag:!1,compareFunction:function(t,o){return e.compareRevision(t,o)}},{text:t.taskassignees,dataIndex:"AssigneesDiv",editableFlag:!1,allowUnsafeHTMLContent:!0},{text:t.IDcardOwner,dataIndex:"Owner",editableFlag:!1,onCellRequest:e.onRouteNodeOwnerCellRequest}]}),define("DS/ENORouteMgmt/Config/RouteMembersGridViewConfig",["DS/ENORouteMgmt/Views/Grid/RouteMembersGridCustomColumns","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){"use strict";return[{text:t.name,dataIndex:"tree"},{text:t.type,dataIndex:"TypeNLS"},{text:t.access,dataIndex:"AccessNLS"},{text:t.actions,dataIndex:"Action",editableFlag:!1,onCellRequest:e.onMemberActionCellRequest}]}),define("DS/ENORouteMgmt/Views/Grid/RouteMembersDataGridView",["DS/ENORouteMgmt/Config/RouteMembersGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Config/Toolbar/RouteMembersTabToolbarConfig"],function(e,t,o){"use strict";return{build:n=>(function(n){let i="Members-gridView-View hideView";"GridView"==widget.getValue("MembersTab-ShowView")&&(i="Members-gridView-View showView");var s=UWA.createElement("div",{id:"dataGridViewContainer",styles:{width:"100%",height:"calc(100% - 40px)",position:"relative"},class:i});let a=o.writetoolbarDefination();return t.build(n,e,a,s,{identifier:"RouteMembersDataGridView"})})(n),getGridViewToolbar:()=>t.dataGridViewToolbar()}}),define("DS/ENORouteMgmt/Services/ContentServices",["UWA/Core","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/WAFData/WAFData"],function(e,t,o,n,i){"use strict";let s,a,r,l,d,u,c;return a=function(i){return new t(function(t,s){let a=o.getDocumentServiceBaseURL()+"/"+i+"/files/DownloadTicket",r={};(r=e.extend(r,o.getSyncOptions(),!0)).data=JSON.stringify((new n).createDataForRequest({})),r.method="PUT",r.type="json",r.headers={"Content-Type":"application/ds-json"},r.onComplete=function(e){t(e)},r.onFailure=function(e){s(void 0)},o.authenticateRequest(a,r)})},r=function(i,s){return new t(function(t,a){for(var r={},l=[],d=0;d<s.length;d++)(r={}).label=s[d]["ds6w:label"],r.modified=s[d]["ds6w:modified"],r.status=s[d]["ds6w:status"],l.push(r);var u=i.TreedocModel.RouteId,c=o.getRouteServiceBaseURL()+"/"+u+"/contents",m=new Array;for(d=0;d<s.length;d++){var p={id:s[d].id};m.push(p)}var g={csrf:widget.data.csrf,data:m},f={};(f=e.extend(f,o.getSyncOptions(),!0)).method="PUT",f.type="json",f.headers={"Content-Type":"application/ds-json"},f.data={csrf:widget.data.csrf},f.data=JSON.stringify(g),f.timeout=0,f.onComplete=function(e){let o=(new n).parseResp(e);t(o)},f.onFailure=function(e,t){a(t||e)},o.authenticateRequest(c,f)})},l=function(i,s,a){return new t(function(t,r){let l=o.getRouteServiceBaseURL()+"/"+i+"/contents",d=new Array;s.forEach(function(e){let t={id:e,scopeId:a};d.push(t)});var u={csrf:widget.data.csrf,data:d},c={};(c=e.extend(c,o.getSyncOptions(),!0)).method="PUT",c.type="json",c.headers={"Content-Type":"application/ds-json"},c.data=JSON.stringify(u),c.timeout=0,c.onComplete=function(e){let o=(new n).parseResp(e);t(o)},c.onFailure=function(e,t){r(t||e)},o.authenticateRequest(l,c)})},d=function(n){return new t(function(t,i){let s=o.get6WServiceBaseURL()+"/bps.routeContents?&$fields=all,!image,!canDeleteContent",a=n.join(),r={};(r=e.extend(r,o.getSyncOptions(),!0)).method="POST",r.data="$ids="+a,r.headers={"Content-Type":"application/x-www-form-urlencoded"},r.onComplete=function(e){t(JSON.parse(e))},r.onFailure=function(e,t){i(t||e)},o.authenticateRequest(s,r)})},u=function(n){return new t(function(t,i){let s=o.getRouteServiceBaseURL()+"/typeDerivatives",a={csrf:widget.data.csrf,data:n.map(function(e){return{type:e}})},r={};(r=e.extend(r,o.getSyncOptions(),!0)).method="POST",r.type="json",r.headers={"Content-Type":"application/ds-json"},r.data=JSON.stringify(a),r.onComplete=function(e){if(e.success){let o={};e.data.forEach(e=>{n[e.type]=e.children.map(e=>e.type),n[e.type]=n[e.type].filter(function(e){return e}),0==n[e.type].length&&n[e.type].push(e.type),o[e.type]=n[e.type]}),t(o)}},r.onFailure=function(e,t){i(t||e)},o.authenticateRequest(s,r)})},c=function(n,i){return new t(function(t,s){var a=o.getRouteServiceBaseURL()+"/"+i+"/contents?routeAction=stateBlock",r={id:n.id,RouteBaseState:n.RouteBaseState,relId:n.relId,policy:n.policy,RouteTargetState:n.RouteTargetState},l={};(l=e.extend(l,o.getSyncOptions(),!0)).method="PUT",l.type="json",l.headers={"Content-Type":"application/ds-json"};var d={csrf:widget.data.csrf,data:[{id:n.id,policy:n.policy,relId:n.relId,dataelements:r}]};l.data=JSON.stringify(d),l.onComplete=function(e){t(e)},l.onFailure=function(e,t){s(t||e)},o.authenticateRequest(a,l)})},s={downloadRouteContent:e=>a(e),addExistingRouteContent:(e,t)=>r(e,t),addDraggedRouteContent:(e,t,o)=>l(e,t,o),getContentInfo:e=>d(e),fetchTypeDerivatives:e=>u(e),updateRouteContentStateBlocking:(e,t)=>c(e,t)}}),define("DS/ENORouteMgmt/Controller/RouteServicesController",["DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/Services/RouteTaskServices","DS/ENORouteMgmt/Services/InitiateRouteServices","DS/ENORouteMgmt/Services/ContentServices","DS/ENORouteMgmt/Services/MemberServices","DS/ENORouteMgmt/Services/RouteTemplateServices","DS/ENORouteMgmt/Services/RouteWidgetUtilServices","UWA/Promise","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l){"use strict";let d,u=function(e,t){500===t.statusCode?widget.notify.handler().addNotif({level:"error",subtitle:l.unexpectedError,sticky:!0}):e(t)};return d={fetchAllRoutes:function(){return new r(function(t,o){e.fetchAllRoutes().then(e=>{t(e)},e=>{u(o,e)})})},fetchRouteById:function(t,o){return new r(function(n,i){e.fetchRouteById(t,o).then(e=>{n(e)},e=>{u(i,e)})})},fetchRouteByIds:function(t){return new r(function(o,n){e.fetchRouteByIds(t).then(e=>{o(e)},e=>{n(e)})})},fetchRouteTemplateById:function(e){return new r(function(t,o){s.fetchRouteTemplateById(e).then(e=>{t(e)},e=>{u(o,e)})})},fetchRouteAndTaskByRouteId:function(t){return widget.getValue("task-custom-fields")&&widget.data&&"ENXROUT_AP"==widget.data.appId?new r(function(o,n){e.fetchRouteAndTaskByRouteId(t).then(e=>{o(e)},e=>{u(n,e)})}):new r(function(o,n){d.fetchTaskFields().then(i=>{widget.setValue("task-custom-fields",i),e.fetchRouteAndTaskByRouteId(t).then(e=>{o(e)},e=>{u(n,e)})},e=>{console.log("fetching custom task attribute defintion failed!!")})})},getScopeInformation:function(e){return new r(function(t,n){o.getScopeInformation(e).then(e=>{t(e)},e=>{u(n,e)})})},fetchSecurityContext:function(){return new r(function(e,t){a.fetchSecurityContext().then(t=>{e(t)},e=>{u(t,e)})})},fetchAllowedContentTypesForRoute:function(){return new r(function(e,t){a.fetchAllowedContentTypesForRoute().then(t=>{e(t)},e=>{u(t,e)})})},updateState:function(t,o){return new r(function(n,i){e.updateState(t,o).then(e=>{n(e)},e=>{u(i,e)})})},updateTaskData:function(e,o,n){return new r(function(i,s){t.updateTaskData(e,o,n).then(e=>{i(e)},e=>{s(e)})})},stopRouteCheck:function(t){return new r(function(o,n){e.stopRouteCheck(t).then(e=>{o(e)},e=>{n(e)})})},deleteRoute:function(t){return new r(function(o,n){e.deleteRoute(t).then(e=>{o(e)},e=>{u(n,e)})})},updateReviewComment:function(e,o){return new r(function(n,i){t.updateReviewComment(e,o).then(e=>{n(e)},e=>{u(i,e)})})},fetchRouteTasks:function(t){return new r(function(o,n){e.fetchRouteTasks(t).then(e=>{o(e)},e=>{u(n,e);let t=document.querySelector(".wux-controls-abstract.wux-controls-loader.wux-font-3dsregular");null!=t&&(t.style.display="none")})})},fetchRouteContents:function(t){return new r(function(o,n){e.fetchRouteContents(t).then(e=>{o(e)},e=>{u(n,e)})})},fetchRouteContentIds:function(t){return new r(function(o,n){e.fetchRouteContentIds(t).then(e=>{o(e)},e=>{u(n,e)})})},fetchRouteMembers:function(t){return new r(function(o,n){e.fetchRouteMembers(t).then(e=>{o(e)},e=>{u(n,e)})})},fetchRouteHistory:function(t){return new r(function(o,n){e.fetchRouteHistory(t).then(e=>{o(e)},e=>{u(n,e)})})},createRoute:function(e){return new r(function(t,n){o.createRoute(e).then(e=>{t(e)},e=>{u(n,e)})})},saveAsRoute:function(e){return new r(function(t,n){o.saveAsRoute(e).then(e=>{t(e)},e=>{u(n,e)})})},downloadRouteContent:function(e){return new r(function(t,o){n.downloadRouteContent(e).then(e=>{t(e)},e=>{u(o,e)})})},addExistingRouteContent:function(e,t){return new r(function(o,i){n.addExistingRouteContent(e,t).then(e=>{o(e)},e=>{i(e)})})},addDraggedRouteContent:function(e,t,o){return new r(function(i,s){n.addDraggedRouteContent(e,t,o).then(e=>{i(e)},e=>{u(s,e)})})},getContentInfo:function(e){return new r(function(t,o){n.getContentInfo(e).then(e=>{t(e)},e=>{u(o,e)})})},fetchTypeDerivatives:function(e){return new r(function(t,o){n.fetchTypeDerivatives(e).then(e=>{t(e)},e=>{u(o,e)})})},changeAccess:function(e,t){return new r(function(o,n){i.changeAccess(e,t).then(e=>{o(e)},e=>{n(e)})})},deleteTask:function(e){return new r(function(o,n){t.deleteTask(e).then(e=>{o(e)},e=>{u(n,e)})})},changeAssignee:function(e,o){return new r(function(n,i){t.changeAssignee(e,o).then(e=>{n(e)},e=>{u(i,e)})})},getUserGroupPhysicalId:function(e){return new r(function(o,n){t.getUserGroupPhysicalId(e).then(e=>{o(e)},e=>{u(n,e)})})},saveAsTemplate:function(t,o){return new r(function(n,i){e.saveAsTemplate(t,o).then(e=>{n(e)},e=>{u(i,e)})})},getESignConfigSetting:function(){return new r(function(t,o){e.getESignConfigSetting().then(e=>{t(e)},e=>{u(o,e)})})},fetchTaskFields:function(){return new r(function(e,o){t.fetchTaskFields().then(t=>{e(t)},e=>{u(o,e)})})},fetchStateBlockingConditions:function(e){return new r(function(t,o){a.fetchStateBlockingConditions(e).then(e=>{t(e)},e=>{u(o,e)})})},updateRouteContentStateBlocking:function(e,t){return new r(function(o,i){n.updateRouteContentStateBlocking(e,t).then(e=>{o(e)},e=>{i(e)})})},fetchTaskAttachments:function(e,o){return new r(function(n,i){t.fetchTaskAttachments(e,o).then(e=>{n(e)},e=>{u(i,e)})})},fetchApprovalStatusForContent:function(t){return new r(function(o,n){e.fetchApprovalStatusForContent(t).then(e=>{o(e)},e=>{n(e)})})},removeSubRoute:function(t,o,n){return new r(function(i,s){e.removeSubRoute(t,o,n).then(e=>{i(e)},e=>{u(s,e)})})}}}),define("DS/ENORouteMgmt/Views/RouteRelatedObjInfo",["DS/EditPropWidget/facets/Common/FacetsBase","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Utilities/DataFormatter","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n){"use strict";var i=e.extend({init:function(){this._parent.apply(this,arguments),this.elements.container=new UWA.Element("div",{id:"RelatedObjectFields",class:""})},updateFacet:function(){let e=this,n=e.getModel();if(1==n.isMergedModel())return;if(!n)return!1;let i=n.get("objectId");t.fetchRouteById(i).then(function(t){e.elements.container.setContent("");let n={};t&&t.length>0&&(n=o.gridData(t[0]));let i=s(n);i.routeTemplate.inject(e.elements.container),i.linkedRouteTemplate.inject(e.elements.container),i.routeScope.inject(e.elements.container),i.selectUsersFromUserGroup.inject(e.elements.container)})},destroyComponent:function(){},onResize:function(){},onRefresh:function(){}});let s=function(e){let t={};t.routeTemplate=new UWA.Element("div",{class:"related-object-display"}),new UWA.Element("label",{html:n.infoRelationTabTemplate+"&nbsp;:",class:"rel-obj-info-label"}).inject(t.routeTemplate),new UWA.Element("div",{html:"&nbsp;"}).inject(t.routeTemplate),new UWA.Element("span",{html:e.TemplateTitle,class:"rel-obj-info-span"}).inject(t.routeTemplate),t.linkedRouteTemplate=new UWA.Element("div",{class:"related-object-display"}),new UWA.Element("label",{html:n.linkedRouteTemplate+"&nbsp;:",class:"rel-obj-info-label"}).inject(t.linkedRouteTemplate),new UWA.Element("div",{html:"&nbsp;"}).inject(t.linkedRouteTemplate),new UWA.Element("span",{html:e.linkedRouteTemplateTitle,class:"rel-obj-info-span"}).inject(t.linkedRouteTemplate),t.routeScope=new UWA.Element("div",{class:"related-object-display"}),new UWA.Element("label",{html:n.infoRelationTabScope+"&nbsp;:",class:"rel-obj-info-label"}).inject(t.routeScope),new UWA.Element("div",{html:"&nbsp;"}).inject(t.routeScope);let o=e.Scope[0];"All"!=e.Scope[0]&&"Organization"!=e.Scope[0]||(o=n[o]),new UWA.Element("span",{html:o,class:"rel-obj-info-span"}).inject(t.routeScope);var i=n.no;return e.selectUsersFromUserGroup&&"True"==e.selectUsersFromUserGroup&&(i=n.yes),t.selectUsersFromUserGroup=new UWA.Element("div",{class:"related-object-display"}),new UWA.Element("label",{html:n.ChooseUsersFromUG+"&nbsp;:",class:"rel-obj-info-label"}).inject(t.selectUsersFromUserGroup),new UWA.Element("div",{html:"&nbsp;"}).inject(t.selectUsersFromUserGroup),new UWA.Element("span",{html:i,class:"rel-obj-info-span"}).inject(t.selectUsersFromUserGroup),t};return i}),define("DS/ENORouteMgmt/Utilities/RouteRefreshUtils",["DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){"use strict";return{refreshRouteData:function(o){let n,i="Route";n=o.id,o.model&&(i=o.model.Type),e.fetchRouteById(n,i).then(e=>{"Route Template"==e[0].type?widget.routeMgmtMediator.publish("template-data-updated",e[0]):widget.routeMgmtMediator.publish("route-data-updated",e[0])},e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:t.infoRefreshError,sticky:!1})})}}}),define("DS/ENORouteMgmt/Views/Dialogs/ChangeAssignee",["DS/WAFData/WAFData","DS/Windows/Dialog","DS/Controls/LineEditor","DS/Controls/Editor","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Utilities/RouteRefreshUtils","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Views/Loader/ChangeTaskAssigneeChooser","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,l,m,p){let g,f,h=function(e){let o=new i;o.inject(document.body);let a=new UWA.Element("div",{id:"assigneeWarning",class:""});g.formFields=new UWA.Element("div",{id:"changeAssigneeWarning",class:""});let l=e.options.grid.title;l=(l.length>40?l.substring(0,37)+"...":l)+" : "+("TRUE"==e.options.grid.routeOwnerTask?p.selectAssignee:p.changeAssignee),g.assigneeField=new UWA.Element("div",{id:"SearchAssigneeField",class:"fonticon-chooser-display"}),g.fields={},g.formFields.inject(a);let h=new UWA.Element("h5",{class:"required",text:p.taskAssignee}).inject(g.formFields);UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(h);var w={isMultiSearchMode:!1};w.placeHolderValue=p.searchAssignee,w.minLengthToType=3,w.isFreeInputAllowed=!1,w.toKeepSearchResultsFlag=!1,"OnPremise"!=m.getTenantValue()&&(w.source=["3dspace","usersgroup"]),w.getPrecond=function(){return d.getPrecondForChangeAssigneeSearch(f,e)},w.getChangeHandler=function(){return d.changeHandlerForChangeAssigneeSearch(g)},g.fields.taskAssigneeField=c.drawAutoCompleteComponent(w),g.fields.taskAssigneeField.inject(g.assigneeField),new UWA.Element("div",{html:"&nbsp;"}).inject(g.assigneeField),g.fields.taskAssigneeChooser=new s({icon:{iconName:"search"}}),g.fields.taskAssigneeChooser.inject(g.assigneeField),g.fields.taskAssigneeChooser.getContent().addEventListener("buttonclick",function(){if("undefined"!=typeof dscef){let e={taskProperties:g,taskGraphModel:void 0,invokeFrom:"dialog"};widget.routeMgmtMediator.publish("launch-task-assignee-search",e)}else d.launchAssigneeSearch(event,f,g,e)}),g.assigneeField.inject(g.formFields),new UWA.Element("h5",{text:p.assigneecomments}).inject(g.formFields),g.fields.descField=new n({placeholder:p.enterAssigneeComments,widthInCharNumber:51,nbRows:5,newLineMode:"enter"}),g.fields.descField.inject(g.formFields),new t({modalFlag:!0,width:500,height:300,title:l,content:a,domId:"RouteImmersiveFrame",immersiveFrame:o,buttons:{Ok:new s({disabled:!1,onClick:function(t){var o;t.dsModel.dialog;g.fields.taskAssigneeField.selectedItems&&g.fields.taskAssigneeField.selectedItems.options&&(o=g.fields.taskAssigneeField.selectedItems.options.value);var n=e.options.grid.assigneePID;if(null!=o)if(o.contains("uuid:")&&!n.contains("uuid:"))u.getUserGroupPhysicalId(o).then(n=>{o=n.ObjIds[0],e.options.grid.assigneeId!=o?u.changeAssignee(e,g).then(o=>{t.dsModel.dialog.close(),widget.notify.handler().addNotif({level:"success",subtitle:p.replace(p.successChangeTaskAssignee,{tag1:o[0].taskAssigneeName}),sticky:!0}),widget.routeMgmtMediator.publish("route-task-on-change-assignee",o[0]),r.refreshRouteData(e.routePropertiesInfo),widget.data.inboxTaskSelectedId=o[0].taskId,widget.routeMgmtMediator.publish("redraw-graph")},e=>{if(e&&e.error&&-1!=e.error.indexOf("System Error: #5000001:")){var t=e.error.replace("System Error: #5000001:","");widget.notify.handler().addNotif({level:"error",subtitle:t,sticky:!1})}else e&&e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:p.changeAssigneeError,sticky:!1})}):widget.notify.handler().addNotif({level:"error",subtitle:p.taskNewAssignee,sticky:!0})},e=>{});else{if(n==o&&"TRUE"!=e.options.grid.routeOwnerTask)return void widget.notify.handler().addNotif({level:"error",subtitle:p.taskNewAssignee,sticky:!0});u.changeAssignee(e,g).then(o=>{t.dsModel.dialog.close(),widget.notify.handler().addNotif({level:"success",subtitle:p.replace(p.successChangeTaskAssignee,{tag1:o[0].taskAssigneeName}),sticky:!0}),widget.routeMgmtMediator.publish("route-task-on-change-assignee",o[0]),r.refreshRouteData(e.routePropertiesInfo),widget.data.inboxTaskSelectedId=o[0].taskId,widget.routeMgmtMediator.publish("redraw-graph")},e=>{if(e&&e.error&&-1!=e.error.indexOf("System Error: #5000001:")){var t=e.error.replace("System Error: #5000001:","");widget.notify.handler().addNotif({level:"error",subtitle:t,sticky:!1})}else e&&e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:p.changeAssigneeError,sticky:!1})})}else widget.notify.handler().addNotif({level:"error",subtitle:p.errorTaskAssignee,sticky:!0})}}),Cancel:new s({onClick:function(e){e.dsModel.dialog.close()}})}}).addEventListener("close",function(e){try{o&&"undefined"!=typeof dscef?(o.elements.container.setStyle("height","1px"),o.elements.container.setStyle("width","1px")):o&&o.destroy()}catch(e){console.log("Error while destroying the change assignee dialog -immersive frame")}})};return{changeAssignee:e=>(function(e){f=e.routePropertiesInfo,g={},h(e)})(e)}}),define("DS/ENORouteMgmt/Views/Dialogs/InitiateChangeAssignee",["DS/ENORouteMgmt/Views/Dialogs/ChangeAssignee","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Components/Notifications","DS/ENORouteMgmt/Components/Mediator","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i){let s=function(e,t){return e.options={},e.options.grid={},e.options.grid.id=t.taskId,e.options.grid.title=t.taskTitle,e.options.grid.assigneePID=t.assigneePID,e.options.grid.routeOwnerTask=t.routeOwnerTask,e.options.grid.routeOwnerUGChoice=t.routeOwnerUGChoice,e.options.grid.routeOwnerUGName=t.routeOwnerUGName,e.options.grid.type=t.type,e},a=function(e,t){return e.routePropertiesInfo={},e.routePropertiesInfo.model={},e.routePropertiesInfo.id=t.routeId,e.routePropertiesInfo.model.Scope=t.Scope,e.routePropertiesInfo.model.ScopeMembers=t.ScopeMembers,e};return{init:r=>(function(r){var l,d={};widget.notify=new o,t.start({id:widget.id}),widget.routeMgmtMediator=new n,r.collabspace&&r.collabstorage?(widget.data.routeCredentials={securityContext:r.collabspace,tenant:r.collabstorage},r.noSecurityContextForSearch&&(widget.data.routeCredentials.noSecurityContextForSearch=r.noSecurityContextForSearch)):widget.data.routeCredentials={securityContext:widget.getPreference("collabspace").value,tenant:widget.getPreference("collabstorage").value},widget&&widget.data&&widget.data.noSecurityContextForSearch&&(widget.data.routeCredentials.noSecurityContextForSearch=widget.data.noSecurityContextForSearch),null==r.taskId||""==r.taskId||null==r.taskTitle||""==r.taskTitle?l=i.taskErrorMessage:"TRUE"!=r.routeOwnerTask||null==r.routeOwnerUGChoice||""==r.routeOwnerUGChoice||null!=r.routeOwnerUGName&&""!=r.routeOwnerUGName?r.Scope&&3!=r.Scope.length&&(l=i.scopeError):l=i.userGroupErrorMessage,null==l?(d=s(d,r),d=a(d,r),e.changeAssignee(d)):widget.notify.handler().addNotif({level:"error",subtitle:l,sticky:!1})})(r)}}),define("DS/ENORouteMgmt/Views/Dialogs/DeleteTask",["DS/WAFData/WAFData","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Controller/RouteServicesController","DS/WebappsUtils/WebappsUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r){let l=function(e){let i=new o;i.inject(document.body);let s=new UWA.Element("div",{id:"removeRouteWarning",html:r.removeTaskDetailConfirmation+"&nbsp;",class:""}),l=r.removeTask;e.options.grid.id&&(s.appendChild(UWA.createElement("div",{class:"",html:r.removeTaskWarningDetailSingle})),s.appendChild(UWA.createElement("div",{class:"",html:[UWA.createElement("div",{class:"deleteTaskDialog",html:[{tag:"img",src:a.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")}]}),UWA.createElement("span",{id:"deleteTaskTitle",html:"<b>"+e.options.grid.title+"</b>"})]}))),new t({modalFlag:!0,width:500,height:200,title:l,content:s,domId:"RouteImmersiveFrame",immersiveFrame:i,buttons:{Ok:new n({label:r.ok,disabled:!1,onClick:function(t){widget.routeMgmtMediator.publish("delete-task-success",e),t.dsModel.dialog.close()}}),Cancel:new n({label:r.cancel,onClick:function(e){e.dsModel.dialog.close()}})}}).addEventListener("close",function(e){i&&(i.elements.container.setStyle("height","1px"),i.elements.container.setStyle("width","1px"))})};return{deleteTask:e=>(function(e){l(e)})(e)}}),define("DS/ENORouteMgmt/Actions/TaskActions",["DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/Utils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n){"use strict";let i=function(e){let t=[];return e.getDeletedTasks().forEach(e=>{e.options.grid.validTaskData&&e.options.grid.id&&t.push(e.options.grid)}),t},s=function(e,t){let o="";e.taskDueDate&&""!=e.taskDueDate&&(o=new Date(e.taskDueDate));var n=l(e),i=e.removeContentToReview,s=i;if(n&&s)for(let e=0;e<s.length;e++)-1!=n.indexOf(s[e])&&(n=n.filter(t=>t!==s[e]),i=i.filter(t=>t!==s[e]));let r={dataelements:{allowDelegation:e.allowDelegation,assigneeSetDueDate:e.assigneeSetDueDate,instructions:e.instructions,parallelNodeProcessionRule:e.parallelNodeProcessionRule,taskAction:e.taskAction,taskOrder:e.taskOrder,taskDueDate:o,title:e.title,reviewTask:e.needsOwnerReview,dateOffsetFrom:e.dateOffsetFrom,dueDateOffset:e.dueDateOffset,needsOwnerReview:e.needsOwnerReview,assigneeId:e.assigneePID,contentToReviewIds:n,removeContentToReview:i}};return"Route Template"==t.model.Type&&(r.dataelements.routeOwnerTask=e.routeOwnerTask,r.dataelements.routeOwnerUGChoice=e.routeOwnerUGChoice,"TRUE"==r.dataelements.routeOwnerTask&&(r.dataelements.assigneeId="contextUser"),"True"==t.model.selectUsersFromUserGroup?"Group"!=e.assigneeType&&"Group Proxy"!=e.assigneeType||"TRUE"==e.routeOwnerTask?r.dataelements.chooseUsersFromUg="False":r.dataelements.chooseUsersFromUg=e.chooseUsersFromUg:r.dataelements.chooseUsersFromUg=t.model.selectUsersFromUserGroup),r=a(e,r)},a=function(e,t){let o=widget.getValue("task-custom-fields");return o&&o.forEach((o,n)=>{"extensions"!=o.name&&(t.dataelements[o.name]=e[o.name])}),t},r=function(e,t,o){let n=[];return e.forEach(e=>{let t=s(e,o);e.id?(t.id=e.id,t.type=e.type):t.updateAction="CREATE",n.push(t)}),t.forEach(e=>{let t=s(e,o);e.id&&(t.updateAction="DELETE",t.id=e.id,t.type=e.type),n.push(t)}),{csrf:widget.data.csrf,data:n}},l=function(e){var t=[];return null!=e.contentToReviewFieldInfo&&0!=e.contentToReviewFieldInfo.length&&e.contentToReviewFieldInfo.forEach(function(e){t.push(e.id)}),t};return{updateTaskDetails:(o,s)=>(function(o,s){return new Promise(function(a,l){let d=o.getTasksDataForCreation(),u=i(o),c=o.getTaskTreeDocument().options.isTaskUpdated;if(d&&(c||u.length>0)){let o=r(d,u,s),i="PUT",c="";c="Route Template"==s.model.Type?t.getRouteTemplateServiceBaseURL()+"/"+s.id+"/tasks":t.getRouteServiceBaseURL()+"/"+s.id+"/tasks",e.updateTaskData(o,i,c).then(e=>{a(e)},e=>{500==e.statusCode?null!=e.internalError&&-1!=e.internalError.indexOf("No modify access to relationship 'Route Node'")?widget.notify.handler().addNotif({level:"error",subtitle:n.errorNoAccess,sticky:!0}):widget.notify.handler().addNotif({level:"error",subtitle:n.unexpectedError,sticky:!0}):l(e)})}else{let e={};!c&&d?(e.refresh=!0,e.message="Tasks are not modified"):e.message="Not valid tasks are present",l(e)}})})(o,s),getTasksDatasForDelete:e=>i(e)}}),define("DS/ENORouteMgmt/Views/RouteInfoPropWidget",["DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i){return{getOptions:function(){let t=[e.FACET_PROPERTIES];return{typeOfDisplay:e.ALL,selectionType:e.NO_SELECTION,facets:t,editMode:!1,readOnly:!1,context:{getSecurityContext:function(){return{SecurityContext:n.getSecurityContextValue()}}},extraNotif:!0,disableAddExtensionButton:!0,actions:[{name:"action_close_panel",text:i.infoCloseAction,icon:"close",handler:function(){widget.routeMgmtMediator.publish("route-info-close-click",{info:"Route"})}}]}},getPropModel:function(e){var s=[],a=new t({metatype:"businessobject",objectId:e,source:"3DSpace",tenant:n.getTenantValue()});return a.set("isTransient",!1),a.addEvent("onSave",function(t){o.fetchRouteById(e).then(e=>{e[0].requestFrom="editPropWidget",widget.routeMgmtMediator.publish("route-data-updated",e[0])},e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:i.infoRefreshError,sticky:!1})})}),s.push(a),s},addFacets:function(e,t){let o=this.getFacets(t);e.addFacets(o)},getFacets:function(e){return[{alwaysVisible:!0,require:"DS/ENORIPE_Relations/views/RelationsTab",facet:{name:"relations",text:i.relations_tab,icon:"object-related"}},{alwaysVisible:!0,require:"DS/ENORouteMgmt/Views/RouteRelatedObjInfo",options:{model:e.model},facet:{name:"RelatedData",text:i.infoRelationTab,icon:"cog"}},{alwaysCalled:!0,alwaysVisible:!0,visible:!0,require:"DS/ENORouteMgmt/Views/RouteHistory",options:{id:e.model.id},facet:{name:"History",text:i.infoHistoryTab,icon:"navigation-history"}},{alwaysVisible:!0,require:"DS/EditPropWidget/facets/SwymComments/SwymComments",facet:{name:"social",text:i.comments,icon:"comment"}}]}}}),define("DS/ENORouteMgmt/Views/Dialogs/ChooseUsersFromUserGroup",["DS/WAFData/WAFData","UWA/Core","UWA/Controls/Abstract","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/Controls/ButtonGroup","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/Controls/Toggle","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/ENORouteMgmt/EnoviaBootstrap","DS/WUXAutoComplete/AutoComplete","DS/TreeModel/DataModelSet","DS/Logger/Logger","DS/Controls/ProgressBar","module","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CoreEvents/Events","DS/ENORouteMgmt/Utilities/Utils","DS/Controls/Loader","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g,f,h,w,v,S,R,y,M,T,b,C){"use strict";var D,k,E,O,N,A,I,U,x,F=0,V=[],_=[];I=v.getLogger(R);U=function(e){if(O.tenant&&(e=e+(-1===e.indexOf("?")?"?":"&")+"tenant="+O.tenant),O.securityContext){var t=O.securityContext;-1==O.securityContext.indexOf("ctx::")&&(t="ctx::"+t),e=e+(-1===e.indexOf("?")?"?":"&")+"SecurityContext="+encodeURIComponent(t)}return O.debugMode&&(e=e+(-1===e.indexOf("?")?"?":"&")+"$debug=true"),T.getCookie("swymlang")&&(e=e+(-1===e.indexOf("?")?"?":"&")+"$language="+T.getCookie("swymlang")),e},E=function(e){var t=this,o=e.cellView.getContent();if(!e.isHeader){var n=UWA.createElement("div",{class:"search-input-assignee"});if(""!=e.nodeModel.options.label){var s=UWA.createElement("div",{class:"task-order-div"});UWA.createElement("text",{html:C.taskOrder+" "+e.nodeModel.options.label}).inject(s),s.inject(n),new UWA.Element("div",{html:'<hr style= "width:100%; height:1px; margin:5px 0 5px 0; display: "block"/>'}).inject(n)}var a=UWA.createElement("div",{class:"task-content-div"}),r=UWA.createElement("div",{class:"label-div"}),d=e.nodeModel.options.grid.title,u=e.nodeModel.options.grid.taskAssignee;if(u=u.length>30?u.substr(0,30)+"...":u,UWA.createElement("label",{html:(d.length>30?d.substr(0,30)+"...":d)+" ["+u+"] ",title:d+" "+e.nodeModel.options.grid.taskAssignee}).inject(r),r.inject(a),void 0===V[e.rowID]){for(var p,g,f=e.nodeModel.options.grid.userGroupMembers,w=e.nodeModel.options.routeNode,v=new m({}),S=new Map,R=0;R<f.length;R++){let e=f[R].split("~");e.length>2&&(g=e[0],p=e[1]+"("+e[2]+")"),S.set(p,g);var y=new c({label:p,value:g});v.addChild(y)}e.cellView._myAutoComplete=new h({multiSearchMode:!0,elementsTree:v,allowFreeInputFlag:!1}),w.customDataMembers=S,e.cellView._myAutoComplete.addEventListener("change",function(o){var n=o.dsModel.value||void 0;void 0!==n&&n.length>0?t._dialog.buttons.Ok.disabled=!1:t._dialog.buttons.Ok.disabled=!0;var i=_[e.rowID].elements.container.parentElement;void 0!==n&&n.length>1?i.setStyle("visibility","visible"):i.setStyle("visibility","hidden"),w.selectedMembers=n}),e.cellView._myAutoComplete.getContent().querySelector(".wux-controls-lineEditor-lite").addEventListener("keydown",function(e){e.stopPropagation()}),void 0===V[e.rowID]&&(V[e.rowID]=e.cellView._myAutoComplete)}else void 0!==V[e.rowID]&&(e.cellView._myAutoComplete=V[e.rowID]);var M=UWA.createElement("div",{class:"auto-complete-div"});e.nodeModel.options.routeNode.selectedMembers,e.cellView._myAutoComplete.inject(M),M.inject(a);var T=UWA.createElement("div",{class:"check-box-div"});if(void 0===_[e.rowID]){var b="Any"!=e.nodeModel.options.grid.userGroupAction,D="All";"All"!=e.nodeModel.options.routeNode.userGroupAction&&(D=void 0,b=!1),e.cellView._myButtonGroup=new i({type:"checkbox"});var k=new l({type:"checkbox",label:C.AllMustApprove,value:D,checkFlag:b});e.cellView._myButtonGroup.addChild(k),e.cellView._myButtonGroup.addEventListener("change",function(e){w.userGroupAction=void 0===e.dsModel.value[0]?"Any":"All"}),_[e.rowID]=e.cellView._myButtonGroup}else e.cellView._myButtonGroup=_[e.rowID],void 0!==e.nodeModel.options.routeNode.selectedMembers&&e.nodeModel.options.routeNode.selectedMembers.length>1?T.setStyle("visibility","visible"):T.setStyle("visibility","hidden");e.cellView._myButtonGroup.inject(T),T.inject(a),a.inject(n),o.setContent(n)}},A=function(e,o){var i=this;i.isSaveForLater=!o;for(var s=i._dataGridView.treeDocument.getChildren(),a={},r=[],l=!0,d=!1,u=0;u<s.length;u++)(a=s[u].options.routeNode).assigneeId="",void 0!==a.selectedMembers&&a.selectedMembers.length>0?(d=!0,a.selectedMembers.forEach(function(e){a.assigneeId+=e+"~"}),a.assigneeId=a.assigneeId.substring(0,a.assigneeId.length-1)):l=!1,r.push(s[u].options.routeNode);if(!l&&o)x.addNotif({level:"error",subtitle:C.ErrorSelectAllAssignees,sticky:!0});else if(d){var c=new S({shape:"circular",infiniteFlag:!0,emphasize:"success",statusFlag:!1,height:120});c.inject(e.dsModel.dialog.elements._contentDiv),c.elements.container.setStyle("margin-left","40%"),e.dsModel.dialog.elements._contentDiv.getChildren()[0].setStyle("opacity","0.3");var m=(new n).createDatasForRequest(r,i.routeId,i.csrf),p={};(p=t.extend(p,f.getSyncOptions(),!0)).method="POST",p.type="json",p.timeout=0,p.headers={"Content-Type":"application/ds-json"},p.wait=!0,p.data=JSON.stringify(m);var g=i.baseURL+"/splitRouteNode";o&&(g=i.baseURL+"/splitRouteNodeAndStart"),p.onComplete=function(t){"undefined"!=typeof widget&&void 0!==widget.routeMgmtMediator?(widget.routeMgmtMediator.publish("ON_SPLIT_ROUTENODE"),t.data[0].dataelements.id=t.data[0].id,widget.routeMgmtMediator.publish("route-data-updated",t.data[0].dataelements)):M.publish({event:"ON_SPLIT_ROUTENODE",data:{this:i,response:t}});var o="";o=i.isSaveForLater?C.TaskCreationsSuccess:C.SuccessTaskCreationAndStartRoute,P(),x.addNotif({level:"success",subtitle:o,sticky:!0}),i._unloadDocument(),i._immersiveFrame.destroy(),e.dsModel.dialog.close()},p.onFailure=function(t,o,n){M.publish({event:"ON_SPLIT_ROUTENODE",data:{this:i,response:o}});var s="";if(s=i.isSaveForLater?C.TaskAssignmentFailure:C.failureToStartRoute,o.error){c.destroy();var a=o.error;-1!=a.indexOf("Error: Assignee(s) are not selected for one or more Route Nodes")&&(a=C.ErrorSelectAllAssignees),e.dsModel.dialog.elements._contentDiv.getChildren()[0].setStyle("opacity","1"),x.addNotif({level:"error",subtitle:a,sticky:!0})}else i._unloadDocument(),i._immersiveFrame.destroy(),e.dsModel.dialog.close(),x.addNotif({level:"error",subtitle:s,sticky:!0})},g=U(g),f.authenticateRequest(g,p)}else x.addNotif({level:"error",subtitle:C.ErrorSelectAssigneesForAssign,sticky:!0})},(N=o.extend({name:"RouteNodeTableGridView",_initColumns:function(){k=[{dataIndex:"Value",text:"Route Node Action details",width:"auto",className:"route-node-column",onCellRequest:E.bind(this)}]},_init:function(){this._initColumns(),this._buildRouteNodeGridView()},_getTaskOrderDisplayValue:function(e){void 0===this.previousTaskOrder?(this.previousTaskOrder=e.dataelements.taskOrder,this.taskOrderDisplayValue=e.dataelements.taskOrder):this.previousTaskOrder===e.dataelements.taskOrder?this.taskOrderDisplayValue="":(this.taskOrderDisplayValue=e.dataelements.taskOrder,this.previousTaskOrder=e.dataelements.taskOrder)},_loadDocument:function(e){this.dataModelSet=new w;var t,o,n=new m({dataModelSet:this.dataModelSet});n.prepareUpdate(),e.data.forEach(function(e){"True"!==e.dataelements.chooseUsersFromUg||"Group"!==e.dataelements.assigneeType&&"Group Proxy"!==e.dataelements.assigneeType||(this._getTaskOrderDisplayValue(e),o={selectAssignee:[],title:e.dataelements.title,id:e.id,userGroupAction:e.dataelements.userGroupAction,seqLevel:e.dataelements.taskOrder,taskAssignee:e.dataelements.assigneeTitle,originatedUserGroup:e.dataelements.assigneePID,userGroupMembers:e.dataelements.ugMembers,_rowAutoComplete:""},t=c.createTreeNodeDataModel(this.dataModelSet,{label:this.taskOrderDisplayValue,grid:o,height:80,routeNode:{originatedUserGroup:e.dataelements.assigneePID,userGroupAction:e.dataelements.userGroupAction,routeNodeId:e.id,assigneeId:""}}),n.addRoot(t))}.bind(this)),n.pushUpdate(),this._model=n},_buildRouteNodeTableGridView:function(e,t){var o,n=this;this.csrf=e.csrf,this._model=new m({useAsyncPreExpand:!1}),o=k,this._loadDocument(e);this._dataGridView=new p({treeDocument:this._model,columns:o,layout:new g({columnsHeader:!1,rowsHeader:!1}),selectionMode:"cell",defaultColumnDef:{width:"auto",height:50,editableFlag:!1,resizableFlag:!1,sortableFlag:!1}});var i=this._dataGridView;this._dataGridView.layout.getRowHeightFunction=function(e){var t=i.layout.cellHeight,o=i.model[e];return t=""==o.options.label?102:130,o.customRowHeight=t,t},this._dataGridView.rowSelection=!1,this._dataGridView.cellSelection=!1,this._dataGridView.elements.container.setStyle("top","10%");var l=new UWA.Element("div",{class:"data-grid-container",id:"selectUsers"});UWA.createElement("div",{html:C.SelectAssigneeModalLabel,class:"title-div"}).inject(l),this._dataGridView.inject(l),this._immersiveFrame=new a,this._immersiveFrame.inject(document.body);const c=A.bind(n);var f=500,h=700;t&&t.height&&(f=t.height,h=t.width),this._dialog=new s({title:C.SelectAssigneeModalTitle,modalFlag:!0,width:h,height:f,resizableFlag:!0,content:l,domId:"RouteImmersiveFrame",allowMaximizeFlag:!0,immersiveFrame:n._immersiveFrame,buttons:{Cancel:new r({label:C.cancel,allowUnsafeHTMLLabel:!0,onClick:function(e){n._unloadDocument(),e.dsModel.dialog.close(),n._immersiveFrame&&n._immersiveFrame.destroy()}}),Apply:new r({label:C.Assign,allowUnsafeHTMLLabel:!0,onClick:function(e){c(e,!1)}}),Ok:new r({label:C.start,disabled:!0,allowUnsafeHTMLLabel:!0,onClick:function(e){c(e,!0)}})}}),"undefined"!=typeof widget&&widget.notify?x=widget.notify.handler():(x=d,u.setNotificationManager(x),void 0!==document.getElementById("RouteImmersiveFrame")?u.inject(document.getElementById("RouteImmersiveFrame")):void 0!==document.getElementById("pageContentDiv")&&u.inject(document.getElementById("pageContentDiv")),u.setStackingPolicy(9)),this._dialog.addEventListener("close",function(e){n._unloadDocument(),M.publish({event:"ON_SPLIT_ROUTENODE_CANCEL"}),P(),n._immersiveFrame.destroy(),n._immersiveFrame=void 0})},_unloadDocument:function(){try{this._model=null,V=[],_=[],this._dataGridView.treeDocument.destroy(),this._dataGridView.layout.destroy(),this._dataGridView.destroy()}catch(e){I.warn(e)}},_showSelectAssigneeModal:function(e){var t=this;t.routeId=void 0===e._modelKey?e.routeId:e._modelKey.id,void 0===e.url?require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(e){e.getServiceUrl({serviceName:"3DSpace",platformId:f.getTenantValue(),onComplete:t._onCompleteCompassServices.bind(t)})}):t._fetchRouteTaskDetails(e)},_onCompleteCompassServices:function(e){this.baseURL=e+"/resources/v1/modeler/routes/"+this.routeId,this._fetchRouteTaskDetails()},_fetchRouteTaskDetails:function(e){var o=this;void 0===o.baseURL&&(o.baseURL=void 0===e._modelKey?e.url:e._modelKey.url()),o.fetchTaskURL=o.baseURL+"/tasks";var n={};(n=t.extend(n,f.getSyncOptions(),!0)).method="GET",n.type="json",n.timeout=0,n.headers={"Content-Type":"application/ds-json"},n.onComplete=function(t){o._buildRouteNodeTableGridView(t,e),F=0,D&&D.off(C.loading_label)},n.onFailure=function(e,t,o){F=0,D&&D.off(C.loading_label)},o.fetchTaskURL=U(o.fetchTaskURL),f.authenticateRequest(o.fetchTaskURL,n)},show:function(e){O=e,this._showSelectAssigneeModal(e),this._initColumns()}})).showSeletUsers=function(e){if(1==++F){var t=document.getElementById("routeGraphTaskContainer"),o=document.getElementById("viewTaskContainerExternal");if(null!=t)null==t.querySelector(".wux-controls-abstract.wux-controls-loader.wux-font-3dsregular")&&(D=(new b).inject(t));else if(null!=o){null==o.querySelector(".wux-controls-abstract.wux-controls-loader.wux-font-3dsregular")&&(D=(new b).inject(o))}null!=D&&D.on(C.loading_label),(new N).show(e)}};let P=function(){x=d,u.removeLastNotificationDisplayed(x)};return N}),define("DS/ENORouteMgmt/Views/Loader/InitiateRouteAddContentSearchLoader",["DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o){let n,i=function(t,o,n,i,a,r){var l=a?a.split(","):"",d=e.getRefinementToSnN(n,"addContent",!0,l);if(d.precond=e.getPrecondForContentSearch(i,l),d.resourceid_not_in=r.getContentIDs(),!UWA.is(o))throw new Error("Socket not initialized");o.dispatchEvent("RegisterContext",d),o.addListener("Selected_Objects_search",s.bind(t,"")),o.dispatchEvent("InContextSearch",d)},s=function(e,n){let i=[],s=[];for(var a=0;a<n.length;a++){var r={};r.id=n[a].id,r.name=n[a]["ds6w:identifier"],r.stateNLS=n[a]["ds6w:status"],r.title=n[a]["ds6w:label"],r.type=n[a]["ds6w:type"],r.created=n[a]["ds6w:created"],r.modified=n[a]["ds6w:modified"],r.type_icon_url=n[a].type_icon_url,r.owner=n[a].owner,r.policy=n[a]["ds6w:policy"],r.state=n[a]["ds6w:status"],r.revision=n[a]["ds6wg:revision"],s.push(r.id),i.push(r)}t.fetchStateBlockingConditions(s).then(e=>{for(var t=!1,n=0;n<e.length;n++){let o=i.find(t=>t.id==e[n].physicalid);o.maturityBlockingStates=e[n].maturityBlockingStates,o.maturityTargetStates=e[n].maturityTargetStates,o.RouteBaseState=e[n].RouteBaseState,o.RouteBaseState_NLS=e[n].RouteBaseState_NLS,o.RouteTargetState=e[n].RouteTargetState,o.RouteTargetState_NLS=e[n].RouteTargetState_NLS,o.current=e[n].current,o.associatedto="Route","Ad Hoc"===e[n].RouteBaseState&&(t=!0)}t&&widget.notify.handler().addNotif({level:"warning",subtitle:o.stateBlockingInfoMsg,sticky:!1}),require(["DS/ENORouteMgmt/Model/InitiateRouteContentModel"],function(e){e.appendRow(i)})}).catch(e=>{console.log("failed "+e[0])})};return n={onSearchClick:e=>{require(["DS/ENORouteMgmt/Model/InitiateRouteContentModel"],function(e){e.getModel().contentIds;var n,s=e.getModel().scopeId;if(""==s||null==s)return void widget.notify.handler().addNotif({level:"error",subtitle:o.ScopeSelectMessage,sticky:!1});var a=UWA.Utils.getUUID(),r=this;let l=widget.getValue("routeContentSearchTypes");UWA.is(n)||require(["DS/SNInfraUX/SearchCom"],function(o){n=o.createSocket({socket_id:a}),void 0===l?t.fetchAllowedContentTypesForRoute().then(t=>{l=t.data[0].dataelements.routeSearchContentTypes,i(r,n,a,s,l,e)},e=>{}):i(r,n,a,s,l,e)})})}}}),define("DS/ENORouteMgmt/Actions/InitiateRouteActions",["DS/ENORouteMgmt/Controller/RouteServicesController","DS/WAFData/WAFData","UWA/Core","DS/ENORouteMgmt/Utilities/Utils","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a){"use strict";let r,l=function(e){var t={title:e.fields.name.value.trim(),description:e.fields.descField.value,routeBasePurpose:0==e.fields.routePurpose.selectedIndex?"Standard":1==e.fields.routePurpose.selectedIndex?"Approval":"Review",routeCompletionAction:0==e.fields.routeCompletionAction.selectedIndex?"Notify Route Owner":"Promote Connected Object",AutoStopOnRejection:0==e.fields.routeAutoStopOnRejection.selectedIndex?"Immediate":"Deferred",DemoteOnRejection:0==e.fields.DemoteOnRejection.selectedIndex?"No":"Yes",preserveTaskOwner:"Retain"==e.fields.buttonGroupUGA.value[0]?"False":"True",attrScope:c(e),templateId:null!=e.fields.templateField.selectedItems?e.fields.templateField.selectedItems.options.value:void 0};return null!=e.fields.templateField.selectedItems?t.requiresEsign=e.fields.requiresEsign:t.requiresEsign="False",null!=e.fields.visibleToParent&&(t.visibleToParent=0==e.fields.visibleToParent.selectedIndex?"No":"Yes"),t},d=function(e,t){var o="",n=[];if(e.getChildren().length>300&&e.getChildren().forEach(e=>{n.push(e.options.grid.id+"|"+e.getAttributeValue("RouteBaseState")+"|"+e.getAttributeValue("RouteTargetState"))}),n.length>0)return n;if(e.getChildren().length>0){if(e.getChildren().forEach(e=>{o=o+"~"+e.options.grid.id+"|"+e.getAttributeValue("RouteBaseState")+"|"+e.getAttributeValue("RouteTargetState")}),o.length>0)return o.substr(1,o.length)}else{if(e.contentIds)return"";if(null!=t.contentIds&&""!=t.contentIds)return t.contentIds}return""},u=function(e){var t={tasks:[]};return e.forEach(e=>{let o="";e.taskDueDate&&""!=e.taskDueDate&&(o=new Date(e.taskDueDate).toISOString()),"Person"==e.assigneeType&&(e.chooseUsersFromUg="False"),t.tasks.push({dataelements:{allowDelegation:e.allowDelegation,assigneeId:e.assigneeId,assigneeSetDueDate:e.assigneeSetDueDate,instructions:e.instructions,parallelNodeProcessionRule:e.parallelNodeProcessionRule,taskAction:e.taskAction,taskOrder:e.taskOrder,taskDueDate:o,title:e.title,reviewTask:e.needsOwnerReview,dateOffsetFrom:e.dateOffsetFrom,dueDateOffset:e.dueDateOffset,needsOwnerReview:e.needsOwnerReview,chooseUsersFromUg:e.chooseUsersFromUg,routeOwnerTask:e.routeOwnerTask,routeOwnerUGChoice:e.routeOwnerUGChoice,routeOwnerUGName:e.routeOwnerUGName,routeOwnerUGTitle:e.routeOwnerUGTitle,templateTask:e.templateTask,contentToReviewIds:m(e)}})}),t},c=function(e){if(e.fields.buttonGroupScope){var t=e.fields.buttonGroupScope.value[0];return"scope"==t?e.fields.scopeField.selectedItems.options.value:t}if(e.fields.scopeField)return e.fields.scopeField.selectedItems.options.value},m=function(e,t){var o=[];return null!=e.contentToReviewFieldInfo&&0!=e.contentToReviewFieldInfo.length&&e.contentToReviewFieldInfo.forEach(function(e){o.push(e.id)}),o};return r={createRoute:(t,o,n)=>(function(t,o,n){var i;return new Promise(function(a,r){var c=l(t);c.contentIds=d(o,t),t.inboxTaskId&&(c.inboxTaskId=t.inboxTaskId),c=(new s).createDataForRequest(c),null!=n?c.data[0].relateddata=u(n):null!=t.fields.templateField.selectedItems&&(c.data[0].dataelements.useTemplateTasks="True"),e.createRoute(c).then(e=>{i=e[0].id,a(e)},e=>r(e))}).then(function(){return new Promise(function(t,o){e.fetchRouteById(i).then(e=>{t(e)},e=>o(e))})})})(t,o,n),saveAsRoute:(t,o,n)=>(function(t,o,n){return new Promise(function(i,a){var r=l(t);r.contentIds=d(o,t),t.inboxTaskId&&(r.inboxTaskId=t.inboxTaskId),r=(new s).createDataForRequest(r),null!=n?r.data[0].relateddata=u(n):null!=t.fields.templateField.selectedItems&&(r.data[0].dataelements.useTemplateTasks="True"),e.saveAsRoute(r).then(e=>i(e),e=>a(e))})})(t,o,n),refreshTemplateObjectOnRouteCreation:t=>(function(t){e.fetchRouteTemplateById(t).then(e=>{e.data[0].dataelements.id=e.data[0].id,widget.routeMgmtMediator.publish("template-data-updated",e.data[0].dataelements),widget.routeMgmtMediator.publish("template-idcard-data-updated",e.data[0].dataelements)})})(t)}}),define("DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog",["DS/ENORouteMgmt/Views/InitiateRouteTabsView","DS/ENORouteMgmt/Actions/InitiateRouteActions","DS/ENORouteMgmt/Utilities/Utils","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/ENORouteMgmt/Controller/RouteServicesController","DS/Controls/Button","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l){"use strict";let d,u,c,m,p={},g=function(){widget.routeMgmtMediator.subscribe("initiate-route-toggle-dialogbuttons",function(){let e=f(),t=w();if(e&&e.formFields){e.formFields.getChildren();""!=e.fields.name.elements.inputField.value.trim()&&(Array.isArray(t)&&t.length>=0||void 0===t)?(u.buttons.Apply.disabled=!1,m=!0):(u.buttons.Apply.disabled=!0,m=!1),c=!!(t&&Array.isArray(t)&&t.length>0)||!(void 0!==t||!e.fields.templateField.selectedItems),u.buttons.Ok.disabled=!m||!c}})},f=function(){return e.getModel("properties")},h=function(){return e.getModel("content")},w=function(){return e.getModel("tasks")};return{InitiateRouteDialog:o=>(function(o){let v=new UWA.Element("div",{html:"",id:"initiateRoute"});d=new UWA.Element("div",{id:"iRouteTabsContainer",class:"route-facets-container"}),p={},o&&o.contentIds&&(p.contentIds=o.contentIds,p.contentIdsList="",o.contentIds.forEach(e=>{p.contentIdsList=p.contentIdsList+"~"+e.id}),p.contentIdsList.length>0&&(p.contentIdsList=p.contentIdsList.substr(1,p.contentIdsList.length))),o&&o.folderDetails?(p.scopeId=o.folderDetails._options.mxid,p.scopePhyId=o.folderDetails.id,p.scopeValue=o.folderDetails._options.label,s.getScopeInformation(p.scopeId).then(function(e){p.ScopeMembers=e.ScopeMembers})):p.scopeId="Organization",p.routeBasePurpose="Standard",p.DemoteOnRejection="No",p.chooseUserFromGroup="False",o&&o.templateId&&(p.templateId=o.templateId,p.Actions=o.Actions),c=!1,m=!1,new e(d,p).init(),d.inject(v);var S=new i;S.inject(document.body);let R=l.newRoute;o&&o.inboxTaskId&&(p.inboxTaskId=o.inboxTaskId,R=l.createSubRoute+o.inboxTaskTitle),o&&o.parentRouteTaskDueDate&&(p.parentRouteTaskDueDate=o.parentRouteTaskDueDate),u=new n({title:R,modalFlag:!0,checkboxInfos:{label:l.createAnother,checkFlag:!1},width:600,height:500,content:v,domId:"RouteImmersiveFrame",immersiveFrame:S,resizableFlag:!0,buttons:{Ok:new a({disabled:!0,domId:"okButton",emphasize:"primary",label:l.start,allowUnsafeHTMLLabel:!0,onClick:function(e){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Start"});let n=f();if(n.fields.buttonGroupScope&&"scope"==n.fields.buttonGroupScope.value&&null==n.fields.scopeField.selectedItems)return widget.notify.handler().addNotif({level:"error",subtitle:l.ScopeSelectMessage,sticky:!1}),void n.fields.scopeField._editor.elements.inputField.focus();!n.fields.templateField.selectedItems||""==n.fields.templateField.selectedItems.options.label||""!=n.fields.templateField.selectedItems.options.value&&null!=n.fields.templateField.selectedItems.options.value?(e.dsModel.label=l.buttonProgress,e.dsModel.disabled=!0,u.buttons.Apply.disabled=!0,u.buttons.Cancel.disabled=!0,t.createRoute(n,h(),w()).then(n=>{var i="";i=n[0].title.length>30?n[0].title.substring(0,27)+"...":n[0].title;var a={level:"success",subtitle:l.replace(l.successCreatedAndStarted,{tag1:i}),sticky:!1};if(o&&o.parentRouteId)e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag?(widget.routeMgmtMediator.publish("initiateRouteClearContent-on-createAnother"),e.dsModel.label=l.start,e.dsModel.disabled=!1,u.buttons.Apply.disabled=!1,u.buttons.Cancel.disabled=!1):e.dsModel.dialog.close(),s.fetchRouteById(o.parentRouteId).then(e=>{widget.routeMgmtMediator.publish("route-summary-show-message",{message:a}),widget.routeMgmtMediator.publish("route-data-updated",e[0]),widget.data.inboxTaskSelectedId=o.inboxTaskId,widget.routeMgmtMediator.publish("redraw-graph",e[0]),null!=widget.data.contextTitle&&""!=widget.data.contextTitle||null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle||widget.routeMgmtMediator.publish("route-summary-append-rows",{model:n[0],openRoute:!1}),widget.data.fromContext="subRoute",widget.routeMgmtMediator.publish("route-created",n[0]),widget.data.fromContext="",widget.routeMgmtMediator.publish("refresh-homepage-after-route-created",{model:n[0],openRoute:!1})},e=>{});else if(o&&o.templateId)e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag?(widget.routeMgmtMediator.publish("initiateRouteClearContent-on-createAnother"),e.dsModel.label=l.start,e.dsModel.disabled=!1,u.buttons.Apply.disabled=!1,u.buttons.Cancel.disabled=!1):e.dsModel.dialog.close(),widget.routeMgmtMediator.publish("template-new-route-show-message",{message:a}),"Complete"==n[0].state&&(a={level:"success",subtitle:l.routeCompletedSuccess,sticky:!1},widget.routeMgmtMediator.publish("template-new-route-show-message",{message:a})),o.Actions&&-1!=o.Actions.findIndex(e=>e.includes("demote"))&&t.refreshTemplateObjectOnRouteCreation(o.templateId);else{let t=!0;e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag&&(t=!1),widget.routeMgmtMediator.publish("route-summary-append-rows",{model:n[0],openRoute:t}),widget.routeMgmtMediator.publish("route-created",n[0]),e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag?(widget.routeMgmtMediator.publish("initiateRouteClearContent-on-createAnother"),e.dsModel.label=l.start,e.dsModel.disabled=!1,u.buttons.Apply.disabled=!1,u.buttons.Cancel.disabled=!1):e.dsModel.dialog.close(),widget.routeMgmtMediator.publish("route-summary-show-message",{message:a}),widget.routeMgmtMediator.publish("refresh-homepage-after-route-created",{model:n[0],openRoute:t}),"Complete"==n[0].state&&(a={level:"success",subtitle:l.routeCompletedSuccess,sticky:!1},widget.routeMgmtMediator.publish("route-summary-show-message",{message:a}))}widget.routeMgmtMediator.publish("route-deactivate-tag-data")},t=>{e.dsModel.label=l.start,e.dsModel.disabled=!1,u.buttons.Apply.disabled=!1,u.buttons.Cancel.disabled=!1,t&&t.error&&-1!=t.error.indexOf(l.ErrorChooseUsers)?widget.notify.handler().addNotif({level:"error",subtitle:l.UnresolvedTasksError,sticky:!1}):t&&t.error.toLowerCase().indexOf("no create access")>-1?widget.notify.handler().addNotif({level:"error",title:l.errorCreateRouteForRoleTitle,subtitle:l.errorCreateRouteForRoleSubTitle,message:l.errorCreateRouteForRoleMsg,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:t.error,sticky:!1})})):widget.notify.handler().addNotif({level:"error",subtitle:l.TemplateSelectMessage,sticky:!1})}}),Apply:new a({disabled:!0,emphasize:"secondary",domId:"applyButton",label:l.saveAsDraft,allowUnsafeHTMLLabel:!0,onClick:function(e){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Save as Draft"});let n=f();if(n.fields.buttonGroupScope&&"scope"==n.fields.buttonGroupScope.value&&null==n.fields.scopeField.selectedItems)return widget.notify.handler().addNotif({level:"error",subtitle:l.ScopeSelectMessage,sticky:!1}),void n.fields.scopeField._editor.elements.inputField.focus();if(n.fields.templateField.selectedItems&&""!=n.fields.templateField.selectedItems.options.label&&(""==n.fields.templateField.selectedItems.options.value||null==n.fields.templateField.selectedItems.options.value))return void widget.notify.handler().addNotif({level:"error",subtitle:l.TemplateSelectMessage,sticky:!1});let i=w();e.dsModel.label=l.buttonProgress,e.dsModel.disabled=!0,0==u.buttons.Ok.disabled&&(c=!0),u.buttons.Cancel.disabled=!0,u.buttons.Ok.disabled=!0,t.saveAsRoute(n,h(),i).then(n=>{var i="";i=n[0].title.length>30?n[0].title.substring(0,27)+"...":n[0].title;var a={level:"success",subtitle:l.replace(l.successCreate,{tag1:i}),sticky:!1};if(o&&o.parentRouteId)e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag?(widget.routeMgmtMediator.publish("initiateRouteClearContent-on-createAnother"),e.dsModel.label=l.saveAsDraft,e.dsModel.disabled=!1,u.buttons.Cancel.disabled=!1,null!=n[0].tasks&&(u.buttons.Ok.disabled=!1)):e.dsModel.dialog.close(),s.fetchRouteById(o.parentRouteId).then(e=>{widget.routeMgmtMediator.publish("route-summary-show-message",{message:a}),widget.routeMgmtMediator.publish("route-data-updated",e[0]),widget.data.inboxTaskSelectedId=o.inboxTaskId,widget.routeMgmtMediator.publish("redraw-graph",e[0]),null!=widget.data.contextTitle&&""!=widget.data.contextTitle||null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle||widget.routeMgmtMediator.publish("route-summary-append-rows",{model:n[0],openRoute:!1}),widget.data.fromContext="subRoute",widget.routeMgmtMediator.publish("route-created",n[0]),widget.data.fromContext="",widget.routeMgmtMediator.publish("refresh-homepage-after-route-created",{model:n[0],openRoute:!1})},e=>{});else if(o&&o.templateId)e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag?(widget.routeMgmtMediator.publish("initiateRouteClearContent-on-createAnother"),e.dsModel.label=l.saveAsDraft,e.dsModel.disabled=!1,u.buttons.Cancel.disabled=!1,null!=n[0].tasks&&(u.buttons.Ok.disabled=!1)):e.dsModel.dialog.close(),widget.routeMgmtMediator.publish("template-new-route-show-message",{message:a}),o.Actions&&-1!=o.Actions.findIndex(e=>e.includes("demote"))&&t.refreshTemplateObjectOnRouteCreation(o.templateId);else{let t=!0;e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag&&(t=!1),widget.routeMgmtMediator.publish("route-summary-append-rows",{model:n[0],openRoute:t}),widget.routeMgmtMediator.publish("route-created",n[0]),e.dsModel.dialog.checkboxInfos&&!0===e.dsModel.dialog.checkboxInfos.checkFlag?(widget.routeMgmtMediator.publish("initiateRouteClearContent-on-createAnother"),e.dsModel.label=l.saveAsDraft,e.dsModel.disabled=!1,u.buttons.Cancel.disabled=!1,null!=n[0].tasks&&(u.buttons.Ok.disabled=!1)):e.dsModel.dialog.close(),widget.routeMgmtMediator.publish("route-summary-show-message",{message:a}),widget.routeMgmtMediator.publish("refresh-homepage-after-route-created",{model:n[0],openRoute:t})}widget.routeMgmtMediator.publish("route-deactivate-tag-data")},t=>{e.dsModel.label=l.saveAsDraft,e.dsModel.disabled=!1,u.buttons.Cancel.disabled=!1,1==c&&(u.buttons.Ok.disabled=!1),t&&t.error.toLowerCase().indexOf("no create access")>-1?widget.notify.handler().addNotif({level:"error",title:l.errorCreateRouteForRoleTitle,subtitle:l.errorCreateRouteForRoleSubTitle,message:l.errorCreateRouteForRoleMsg,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:t.error,sticky:!1})})}}),Cancel:new a({label:l.cancel,domId:"cancelButton",emphasize:"secondary",allowUnsafeHTMLLabel:!0,onClick:function(e){e.dsModel.dialog.close(),widget.setValue("isDialogOpened",!1)}})}}),g(),u.addEventListener("close",function(t){widget.notify.notifview().removeNotifications(),new e(d).destroy(),widget.setValue("isDialogOpened",!1)}),u.addEventListener("resize",function(e){document.getElementById("initiateRoute")&&(document.getElementById("initiateRoute").offsetWidth<400?e.dsModel.buttons.Cancel.hide():e.dsModel.buttons.Cancel.show())}),u.addEventListener("visibilityChange",function(e){document.getElementById("initiateRoute")&&(document.getElementById("initiateRoute").offsetWidth<400?e.dsModel.buttons.Cancel.hide():e.dsModel.buttons.Cancel.show())})})(o),getDialog:()=>u}}),define("DS/ENORouteMgmt/Commands/InitiateRoute_Popup",["UWA/Core","UWA/Class","DS/ApplicationFrame/Command","DS/Core/Core","DS/UIKIT/Alert","DS/WAFData/WAFData","DS/PADUtils/PADSettingsMgt","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Commands/CommandAvailableOnSelect","DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog","DS/UIKIT/Form","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/ENORouteMgmt/Components/Mediator","DS/ENORouteMgmt/Components/Notifications","DS/ENORouteMgmt/Commands/InitialRoute_Widget","DS/WidgetServices/WidgetServices","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g,f,h,w,v){"use strict";new i({className:"csg-alert",closable:!0,renderTo:document.body,visible:!0,autoHide:!0,hideDelay:5e3,messageClassName:"error"});var S,R=new i({className:"csg-alert",closable:!0,renderTo:document.body,visible:!0,autoHide:!0,messageClassName:"success"});let y;return t.extend(o,l,{init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!0}),widget.notify=new f,r.start({id:widget.id}),widget.routeMgmtMediator=new g},beginExecute:function(){this._frmWindow=this.getFrameWindow()},resumeExecute:function(){},launchCreateRouteModal:function(e){widget.body,S=e.getSelectedNodes();var t=[],o=[];S.length&&S.forEach(function(e){var n=e&&"function"==typeof e.getInstID?e.getInstID():null;if(null!=n&&Array.isArray(n)&&(n=n.length>0?n[0]:null),n=(n=n||e.getID())||e.id){var i={id:n,name:e._options.grid["ds6w:identifier"],title:e._options.label,stateNLS:e._options.grid["ds6w:status"],type:e._options.grid["ds6w:type"],description:e._options.grid["ds6w:description"],owner:e._options.grid["ds6w:responsible"],created:e._options.grid["ds6w:created"],modified:e._options.grid["ds6w:modified"],typeIcon:e._options.grid.thumbnail};t.push(i),o.push(i)}});this.collection;var n=S&&S[0]?S[0]:{};if(void 0!==n.getType&&"Content"===n.getType())require(["DS/FolderEditor/Folder_CSO"],function(e){var t={folderDetails:e.getCurrentFolder(),contentIds:o};d.InitiateRouteDialog(t)});else{var i={folderDetails:null,contentIds:o};d.InitiateRouteDialog(i)}widget.routeMgmtMediator.subscribeOnce("route-created",function(e){var t={};t.routeId=e.id,t.routeName=e.name,(new h).execute(t);var o="";o=t.routeName.length>30?t.routeName.substring(0,27)+"...":t.routeName,R.add({message:v.replace(v.successCreate,{tag1:o})})});this.onResume(function(){}),this.onPause(function(){})},execute:function(t){var o=this,n=widget.getValue("x3dPlatformId"),i=widget.getValue("xPref_CREDENTIAL")?"ctx::"+widget.getValue("xPref_CREDENTIAL"):"";i&&(widget.data.routeCredentials={securityContext:i,tenant:n}),require(["DS/PADUtils/PADContext"],function(t){var n=t.get();null==n&&(n=o.options.context);var i,s=n.getSelectedNodes(),a=s&&s[0]?s[0]:{};if(a.getType?i=a.getType():a.options?i=a.options.type:a.object&&(i=a.object.type),"Folder"===i||"RootFolder"===i){let t=new c;t.inject(document.body);let o=new e.Element("div",{id:"invalidSelection",class:""});o.appendChild(e.createElement("div",{class:"",html:v.invalidSelection})),y=new m({modalFlag:!0,width:350,height:150,title:"",content:o,immersiveFrame:t,buttons:{Ok:new p({onClick:function(e){e.dsModel.dialog.close()}})}})}else o.launchCreateRouteModal(n)})},endExecute:function(){}})}),define("DS/ENORouteMgmt/Views/Loader/InitiateRouteScopeChooser",["DS/Utilities/Dom","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Controller/RouteServicesController","DS/TreeModel/TreeNodeModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i){"use strict";let s;var a=function(e,t){var o;t&&(o=new n({label:t[0]["ds6w:label"],value:t[0].id}),s.fields.scopeField.selectedItems=o)};return{init:(e,o)=>(function(e,o){var n=e.dsModel;s=o;var i=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],function(e){var o=e.createSocket({socket_id:i}),s=t.getRefinementToSnN(i,"selectScope",!1,["Workspace Vault","Workspace","Personal Workspace","Project Space"]);if(s.precond=t.getPrecondForScopeSearch(),!UWA.is(o))throw new Error("Socket not initialized");o.dispatchEvent("RegisterContext",s),o.addListener("Selected_Objects_search",a.bind(n,"")),o.dispatchEvent("InContextSearch",s)})})(e,o),destroy:()=>{s={}},getPrecondForScope:()=>(function(){var e={};return e.precond=t.getPrecondForScopeSearch(),e})(),changeHandlerForScopeField:e=>(function(e){e.fields.scopeField.options.fromBookMarkEditor||(e.fields.scopeField.selectedItems?e.fields.scopeField._editor.elements.inputField.value==e.fields.scopeField.selectedItems.options.label&&o.getScopeInformation(e.fields.scopeField.selectedItems.options.value).then(function(t){e.fields.scopeField.selectedItems.options.scopeId=t.id,e.fields.scopeField.selectedItems.options.ScopeMembers=t.ScopeMembers,widget.routeMgmtMediator.publish("initiateRoute-on-ScopeSelection",{scopeId:t.id,scopePhyId:e.fields.scopeField.selectedItems.options.value,ScopeMembers:t.ScopeMembers})}):widget.routeMgmtMediator.publish("initiateRoute-on-ScopeSelection",{scopeId:"",scopePhyId:""}))})(e)}}),define("DS/ENORouteMgmt/Views/Panels/RoutePropertiesPanel",["DS/EditPropWidget/EditPropWidget","DS/ENORouteMgmt/Views/RouteInfoPropWidget","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o){var n,i={init:function(t){let o=r(t);this.EditPropWidget=new e(o)},render:function(e,t){var o=this;n?o.renderUI(e,t):d().then(function(){o.renderUI(e,t)})},renderUI:function(e,t){var o=this;o.EditPropWidget||(e.empty(),o.init(t)),a(o.EditPropWidget).then(function(n){let i=s(t);return n&&i!=n&&(e.empty(),o.init(t)),t.model&&t.model.id&&l(t).addFacets(o.EditPropWidget,t),o.loadModel(t,e),this})},loadModel:function(e,t){let o=[];e.model&&e.model.id&&(o=l(e).getPropModel(e.model.id)),this.EditPropWidget.initDatas(o),this.EditPropWidget.elements.container.inject(t)},removeFacets:function(e){this.EditPropWidget.removeFacets(e)},destroyEditPropWidget:function(){this.EditPropWidget=void 0}};let s=function(e){let t=e.model&&e.model.Type;return null==t&&(t=e.info),t},a=function(e){return new Promise(function(t,o){let n,i=e.getListModel();if(i&&i.length>0){let e=i[0].getAllAttributes().type;e&&e.dbValues&&t(n=e.dbValues.value)}t("")})},r=function(e){return l(e).getOptions(e)},l=function(e){switch(e.model?e.model.Type:e){case"Route":return t;case"Route Template":return n;default:return t}},d=function(){return new Promise(function(e,t){require(["DS/ENORouteTemplateMgmt/Views/TemplateInfoPropWidget"],function(t){n=t,e()})})};return i}),define("DS/ENORouteMgmt/Views/InitiateSaveAsTemplateView",["DS/Controls/LineEditor","DS/WebappsUtils/WebappsUtils","DS/Controls/Editor","DS/Controls/Accordeon","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Utilities/Dom","DS/ENORouteMgmt/Views/Loader/InitiateSaveAsTemplateLinkTemplateChooser","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/TreeModel/TreeNodeModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p){let g,f,h,w,v,S=function(n,l,u,S){if(v=S,f=u,h=l,(w={}).formFields=new UWA.Element("div",{id:"SaveAsTemplatePropertiesContainer",class:""}),w.fields={},w.formFields.inject(n),w.linkTemplateCompleteActionField=new UWA.Element("div",{id:"linkTemplateCompleteActionField",class:"fonticon-chooser-scope-display"}),w.demoteOnRejectionField=new UWA.Element("div",{id:"demoteOnRejectionField",class:"fonticon-chooser-scope-display"}),null!=l.data[0].options.grid.TemplateName&&"Archive"!=u.state){t.getWebappsAssetUrl("ENORouteTemplateMgmt","icons/144/I_RouteTemplate108x144.png");new UWA.Element("h5",{id:"SaveOptions",styles:{"font-weight":"normal"},html:[UWA.createElement("span",{html:p.SaveOptions+"&nbsp;"}),UWA.createElement("div",{class:"saveAsTemplate-title",styles:{"background-image":"url("+t.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTemplate16.png")+")"}}),UWA.createElement("span",{html:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+f.title})]}).inject(w.formFields);var T=p.ReviseTemplate;T=T+" "+f.title,w.fields.buttonGroupSA=new i({type:"radio"}),w.fields.buttonGroupSA.addChild(new a({type:"radio",label:T,value:"Revise Template",checkFlag:!0})),w.fields.buttonGroupSA.addChild(new a({type:"radio",label:p.SaveasNewTemplate,value:"Save as New Template"})),w.fields.buttonGroupSA.inject(w.formFields),w.fields.buttonGroupSA.addEventListener("change",function(e){"Save as New Template"==w.fields.buttonGroupSA.value?(widget.routeMgmtMediator.publish("initiate-saveAsTemplate-toggle-dialogbuttons"),w.fields.buttonGroupChooseUG.selectIndex(0),w.fields.buttonGroupChooseUG.show(),w.fields.selectUsersFromUserGroupFortemplate.hide(),w.fields.setPreserveTaskOwnerForTemplate.hide(),w.fields.buttonGroupPTO.show(),w.fields.name.className="","All"!=h.data[0].options.grid.Scope[0]&&"Organization"!=h.data[0].options.grid.Scope[0]&&w.fields.ScopeField.setText("All"),"Approval"!=h.data[0].options.grid.BasePurpose&&"Standard"!=h.data[0].options.grid.BasePurpose||M(),""==w.fields.nameField.elements.inputField.value&&setTimeout(function(){w.fields.nameField.elements.inputField.focus()},1e3)):(R(),w.fields.name.className="fonticon-chooser-scope-display",setTimeout(function(){document.querySelector("#SaveAsTemplatePropertiesContainer #SaveOptions").scrollIntoView()},1e3))})}"Archive"==u.state&&(w.fields.buttonGroupSA={},w.fields.buttonGroupSA.value=["Save as New Template"]),w.fields.name=new UWA.Element("div",{id:"title",class:"fonticon-chooser-scope-display"}),g=new UWA.Element("h5",{id:"NameField",text:p.title}).inject(w.fields.name),UWA.createElement("div",{id:"asterisk",class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(g),w.fields.nameField=new e({placeholder:p.placeholderTemplateName,pattern:"[^./#,\\[\\]\\$\\^@\\*\\?%:'\"\\\\<>;|]+",sizeInCharNumber:61}),w.fields.nameField.inject(w.fields.name),w.fields.nameField.addEventListener("uncommittedChange",function(e){widget.routeMgmtMediator.publish("initiate-saveAsTemplate-toggle-dialogbuttons")}),w.fields.name.inject(w.formFields),new UWA.Element("h5",{text:p.description}).inject(w.formFields),w.fields.descField=new o({placeholder:p.placeholderDescription,widthInCharNumber:63,nbRows:5,newLineMode:"enter"}),w.fields.descField.inject(w.formFields),new UWA.Element("h5",{class:"required",text:p.routeCompletionAction}).inject(w.formFields);var b=new UWA.Element("div",{id:"completeActionDiv",class:""}).inject(w.formFields);if(w.fields.completionAction=new r({elementsList:[p.notifyRouteOwner,p.promoteConnectedObject],enableSearchFlag:!1}),w.fields.completionAction.inject(b),"Promote Connected Object"==l.data[0].options.grid.routeCompletionAction?w.fields.completionAction.selectedIndex=1:w.fields.completionAction.selectedIndex=0,"Standard"==h.data[0].options.grid.BasePurpose){null!=f&&""!=f&&null==f.linkedRouteTemplate&&(f.linkedRouteTemplate="",f.linkedRouteTemplateId="");null!=f&&""!=f&&""!=f.linkedRouteTemplate&&"Archive"!=f.linkedRouteTemplateState&&(f.linkedRouteTemplateId,f.linkedRouteTemplate,w.linkTemplateCompleteActionField.className="",w.demoteOnRejectionField.className=""),w.fields.startRouteOnCompletionField=new UWA.Element("div",{id:"startRouteOnCompletionField"}),new UWA.Element("h5",{text:p.StartRouteOnCompletion}).inject(w.fields.startRouteOnCompletionField);var C,D=new UWA.Element("div",{id:"startRouteOnCompletionFieldChooser",class:"fonticon-chooser-display"}),k={isMultiSearchMode:!1};if(k.placeHolderValue=p.searchTemplate,k.minLengthToType=3,k.isFreeInputAllowed=!1,k.toKeepSearchResultsFlag=!1,k.getPrecond=function(){return d.getPrecondForLinkedTemplateSearch(f,w)},k.getChangeHandler=function(){return d.changeHandlerLinkedFortemplateField(w)},w.fields.linkedTemplateField=c.drawAutoCompleteComponent(k),w.fields.linkedTemplateField.inject(D),new UWA.Element("div",{html:"&nbsp;"}).inject(D),""!=f.linkedRouteTemplateId&&null!=f.linkedRouteTemplateId&&"Archive"!=f.linkedRouteTemplateState)C=new m({label:f.linkedRouteTemplateTitle,value:f.linkedRouteTemplateId,status:"Released"}),w.fields.linkedTemplateField.selectedItems=C;let e;w.fields.linkedTemplateField.options.linkedTemplateId="","Archive"==u.state&&(f=""),w.fields.templateChooser=new s({icon:{iconName:"search"}}),w.fields.templateChooser.inject(D),w.fields.templateChooser.getContent().addEventListener("buttonclick",function(e){d.init(e,w,f)}),D.inject(w.fields.startRouteOnCompletionField),w.fields.startRouteOnCompletionField.inject(w.formFields),new UWA.Element("h5",{class:"required",id:"linkTemplateCompleteActionField",text:p.replace(p.routeCompletionActionForSelectedTemplate,{tag1:f.linkedRouteTemplateTitle})}).inject(w.linkTemplateCompleteActionField);let t={};t.label=p.promoteConnectedObject,t.value="Promote Connected Object";let o,n={};n.label=p.notifyRouteOwner,n.value="Notify Route Owner",e=null!=f&&"Promote Connected Object"==f.routeCompletionAction?1:0,w.fields.routeCompletionAction=new r({elementsList:[n,t],enableSearchFlag:!1,selectedIndex:e}),w.fields.routeCompletionAction.inject(w.linkTemplateCompleteActionField),w.linkTemplateCompleteActionField.inject(w.formFields),new UWA.Element("h5",{class:"required",id:"demoteOnRejection",text:p.DemoteOnRejection}).inject(w.demoteOnRejectionField);let i={};i.label=p.no,i.value="No";let a={};a.label=p.yes,a.value="Yes",o="Yes"==f.DemoteOnRejection?1:0,w.fields.demoteOnRejection=new r({elementsList:[i,a],enableSearchFlag:!1,selectedIndex:o}),w.fields.demoteOnRejection.inject(w.demoteOnRejectionField),w.demoteOnRejectionField.inject(w.formFields)}new UWA.Element("h5",{id:"ScopeField",text:p.routeScope}).inject(w.formFields),w.fields.ScopeField=new UWA.Element("span",{text:l.data[0].options.grid.Scope[0]}),w.fields.ScopeField.inject(w.formFields),new UWA.Element("h5",{id:"RouteTaskedits",text:p.routeTaskEdits}).inject(w.formFields);let E,O=0;var N;""!=f&&(O="Modify/Delete Task List"==h.data[0].options.grid.taskEditSetting?0:"Extend Task List"==h.data[0].options.grid.taskEditSetting?1:"Modify Task List"==h.data[0].options.grid.taskEditSetting?2:3),w.fields.routeTaskEdits=new r({elementsList:[p.ModifyDeleteTaskList,p.ExtendTaskList,p.ModifyTaskList,p.MaintainExactTaskList],enableSearchFlag:!1,selectedIndex:O}),w.fields.routeTaskEdits.inject(w.formFields),new UWA.Element("h5",{id:"PreserveTaskOwner",text:p.PreserveTaskOwnerLabel}).inject(w.formFields),w.fields.buttonGroupPTO=new i({type:"radio"}),w.fields.buttonGroupPTO.addChild(new a({type:"radio",label:p.PreserveTaskOwnerSelect2,value:"Retain",checkFlag:!0})),w.fields.buttonGroupPTO.addChild(new a({type:"radio",label:p.PreserveTaskOwnerSelect1,value:"Reset"})),w.fields.buttonGroupPTO.inject(w.formFields),""!=f&&(E=p.PreserveTaskOwnerSelect2,w.fields.setPreserveTaskOwnerForTemplate=new UWA.Element("span",{html:E}).inject(w.formFields)),new UWA.Element("h5",{id:"selectUsersFromUserGroup",text:p.ChooseUsersFromUG}).inject(w.formFields),w.fields.buttonGroupChooseUG=new i({type:"radio"}),w.fields.buttonGroupChooseUG.addChild(new a({type:"radio",label:p.no,value:"False",checkFlag:!0})),w.fields.buttonGroupChooseUG.addChild(new a({type:"radio",label:p.yes,value:"True"})),w.fields.buttonGroupChooseUG.inject(w.formFields),w.fields.buttonGroupChooseUG.addEventListener("change",function(e){"True"==e.dsModel.value?(w.fields.buttonGroupPTO.selectIndex(0),w.fields.buttonGroupPTO.getButton(1).disabled=!0):w.fields.buttonGroupPTO.getButton(1).disabled=!1}),""!=f&&(N="True"!=f.selectUsersFromUserGroup?p.no:p.yes,w.fields.selectUsersFromUserGroupFortemplate=new UWA.Element("span",{html:N}).inject(w.formFields)),"Approval"!=h.data[0].options.grid.BasePurpose&&"Standard"!=h.data[0].options.grid.BasePurpose||(("None"!=v.routeESignConfigSetting||""!=f&&"True"==f.latestrouteRequiresESignValue&&"None"==v.routeESignConfigSetting)&&new UWA.Element("h5",{class:"required",id:"approvalWithSign",text:p.routeRequiresESign}).inject(w.formFields),"RouteSpecific"==v.routeESignConfigSetting?(w.fields.approvalWithSign=new i({type:"radio"}),w.fields.approvalWithSign.addChild(new a({type:"radio",label:p.no,value:"False",checkFlag:!0})),w.fields.approvalWithSign.addChild(new a({type:"radio",label:p.yes,value:"True"})),w.fields.approvalWithSign.inject(w.formFields)):""!=f&&"False"==f.latestrouteRequiresESignValue&&"All"==v.routeESignConfigSetting?(w.fields.setNoForApprovalWithSign=new UWA.Element("span",{html:p.no}).inject(w.formFields),w.fields.setYesForApprovalWithSign=new UWA.Element("span",{html:p.yes}).inject(w.formFields),w.fields.setYesForApprovalWithSign.hide()):("All"==v.routeESignConfigSetting||""!=f&&"True"==f.latestrouteRequiresESignValue&&"None"==v.routeESignConfigSetting)&&(w.fields.setYesForApprovalWithSign=new UWA.Element("span",{html:p.yes}).inject(w.formFields))),y();let A=document.querySelector("#SaveAsTemplatePropertiesContainer #SaveOptions");null!=A&&A.scrollIntoView()},R=function(){widget.routeMgmtMediator.publish("initiate-reviseTemplate-toggle-dialogbuttons"),w.fields.buttonGroupChooseUG.hide(),w.fields.selectUsersFromUserGroupFortemplate.show(),"True"==f.selectUsersFromUserGroup?(w.fields.setPreserveTaskOwnerForTemplate.show(),w.fields.buttonGroupPTO.hide()):(w.fields.buttonGroupPTO.show(),"True"==h.data[0].options.grid.preserveTaskOwner&&"True"!=f.selectUsersFromUserGroup?(w.fields.buttonGroupPTO.getButton(1).disabled=!1,w.fields.buttonGroupPTO.selectIndex(1)):(w.fields.buttonGroupPTO.selectIndex(0),w.fields.buttonGroupPTO.getButton(1).disabled=!1),w.fields.setPreserveTaskOwnerForTemplate.hide()),"All"!=h.data[0].options.grid.Scope[0]&&"Organization"!=h.data[0].options.grid.Scope[0]&&w.fields.ScopeField.setText(f.attRestrictMembers),"Approval"!=h.data[0].options.grid.BasePurpose&&"Standard"!=h.data[0].options.grid.BasePurpose||(""!=f&&"True"==f.latestrouteRequiresESignValue&&"None"==v.routeESignConfigSetting?(document.getElementById("approvalWithSign").style.display="block",w.fields.setYesForApprovalWithSign.show()):""!=f&&"False"==f.latestrouteRequiresESignValue&&"All"==v.routeESignConfigSetting&&(w.fields.setNoForApprovalWithSign.show(),w.fields.setYesForApprovalWithSign.hide()))},y=function(){""!=f?(w.fields.descField.value=f.description,R()):(w.fields.name.className="","True"==h.data[0].options.grid.preserveTaskOwner&&w.fields.buttonGroupPTO.selectIndex(1),"All"!=h.data[0].options.grid.Scope[0]&&"Organization"!=h.data[0].options.grid.Scope[0]&&w.fields.ScopeField.setText("All"));var e=w.fields.nameField._myInput;null!=e&&(e.style.width="100%",e.style.resize="both",e.style.overflow="auto");var t=w.fields.descField._myInput;null!=t&&(t.style.width="100%",t.style.resize="both",t.style.overflow="auto")},M=function(){""!=f&&"True"==f.latestrouteRequiresESignValue&&"None"==v.routeESignConfigSetting?(document.getElementById("approvalWithSign").style.display="none",w.fields.setYesForApprovalWithSign.hide()):""!=f&&"False"==f.latestrouteRequiresESignValue&&"All"==v.routeESignConfigSetting&&(w.fields.setNoForApprovalWithSign.hide(),w.fields.setYesForApprovalWithSign.show())};return{build:(e,t,o)=>(function(e,t,o){var n="";null!=t.data[0].options.grid.TemplateName?u.fetchRouteTemplateById(t.data[0].options.grid.TemplateId).then(i=>{i.data[0].dataelements.id=i.data[0].id,""!=(n=i.data[0].dataelements).linkedRouteTemplateId&&null!=n.linkedRouteTemplateId?u.fetchRouteTemplateById(n.linkedRouteTemplateId).then(i=>{n.linkedRouteTemplateState=i.data[0].dataelements.state,S(e,t,n,o)},e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:p.pageLoad,sticky:!1})}):S(e,t,n,o)},e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:p.pageLoad,sticky:!1})}):S(e,t,n,o)})(e,t,o),destroy:()=>{w={}},getProperties:()=>w}}),define("DS/ENORouteMgmt/Actions/MemberActions",["UWA/Drivers/Alone","UWA/Core","DS/WAFData/WAFData","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Model/RouteMemberModel","DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l){"use strict";let d;return d={onChangeAccess:function(e,t){r.changeAccess(e,t).then(e=>{widget.routeMgmtMediator.publish("member-data-updated",{model:i.memberGridData(e.data[0].dataelements)}),widget.notify.handler().addNotif({level:"success",subtitle:l.successChangeAccess,sticky:!0})},e=>{e.error&&e.error.indexOf("#1500572")>=0&&e.error.indexOf("select policy does not exist")>0?widget.notify.handler().addNotif({level:"error",subtitle:l.ErrorInvalidObject,sticky:!0}):widget.notify.handler().addNotif({subtitle:l.errorChangeAccess})})}}}),define("DS/ENORouteMgmt/Views/RouteHistory",["DS/EditPropWidget/facets/Common/FacetsBase","DS/ENORouteMgmt/Components/Wrappers/WrapperLargeTileView","DS/ENORouteMgmt/Model/RouteInfoHistoryModel","DS/ENORouteMgmt/Controller/RouteServicesController"],function(e,t,o,n){"use strict";var i=e.extend({init:function(){widget.propWidgetHistoryOpen=!0,this._parent.apply(this,arguments);arguments[0];this.elements.container=UWA.createElement("div",{id:"routeHistory",class:"routeHistory"})},updateFacet:function(){let e=this.getModel();if(1==e.isMergedModel())return;if(!e)return!1;this.elements.container.setContent("");let t=e.get("objectId");n.fetchRouteHistory(t).then(function(e){o.destroy();let t=s(e),n=a(t);null!=n&&n.inject(document.querySelector(".routeHistory"))})},destroyComponent:function(){},onResize:function(){},onRefresh:function(){this.updateFacet()}}),s=function(e){return o.getModel(e)};let a=function(e){let o=UWA.createElement("div",{id:"routeInfoHistoryContainer",class:""});return t.build(e,o)};return i}),define("DS/ENORouteMgmt/Views/Loader/InitiateRouteTemplateChooser",["DS/ENORouteMgmt/Controller/RouteServicesController","DS/Utilities/Dom","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/TreeModel/TreeNodeModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i){"use strict";let s,a=!1;var r=function(e,t){var o;t&&(o=new n({label:t[0]["ds6w:label"],value:t[0].id,status:t[0]["ds6w:status_value"],category:t[0]["ds6w:category"]}),s.fields.templateField.selectedItems=o)};let l=function(t,o){e.fetchRouteTemplateById(t[0].id).then(function(e){var i;t[0].createFromTemplate||(i=new n({label:e.data[0].dataelements.title,value:t[0].id,status:"Released"}),a=!0,o.fields.templateField.selectedItems=i),o.fields.descField.value=e.data[0].dataelements.description;var s=s="Standard"==e.data[0].dataelements.routeBasePurpose?0:"Approval"==e.data[0].dataelements.routeBasePurpose?1:2;if(o.fields.routePurpose.selectedIndex=s,s=s="Notify Route Owner"==e.data[0].dataelements.completionAction?0:1,o.fields.routeCompletionAction.selectedIndex=s,s=s="Immediate"==e.data[0].dataelements.AutoStopOnRejection?0:1,o.fields.routeAutoStopOnRejection.selectedIndex=s,!o.fields.scopeField.options.fromBookMarkEditor){s=s="All"==e.data[0].dataelements.attRestrictMembers?0:(e.data[0].dataelements.attRestrictMembers,1),o.fields.buttonGroupScope.selectIndex(s),o.fields.scopeField.selectedItems=void 0,o.routeScopeField.className="fonticon-chooser-scope-display";for(let e=0;e<o.fields.buttonGroupScope.getButtonCount();e++){let t=o.fields.buttonGroupScope.getButton(e);t.disabled=e!=s}}s=s="True"==e.data[0].dataelements.selectUsersFromUserGroup?0:"False"==e.data[0].dataelements.preserveTaskOwner?0:1,o.fields.buttonGroupUGA.selectIndex(s),"True"==e.data[0].dataelements.selectUsersFromUserGroup?(o.fields.buttonGroupUGA.hide(),o.advFormFields.querySelector("#PreserveTaskOwner").setStyle("display","none")):(o.fields.buttonGroupUGA.show(),o.advFormFields.querySelector("#PreserveTaskOwner").removeAttribute("style")),t[0].taskEditSetting=e.data[0].dataelements.taskEditSetting,widget.routeMgmtMediator.publish("initiateRoute-on-TemplateSelection",{template:t,chooseUserFromUG:e.data[0].dataelements.selectUsersFromUserGroup}),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons"),o.fields.requiresEsign=e.data[0].dataelements.routeRequiresESign,widget.routeMgmtMediator.publish("initiateRoute-on-TemplateSelection",{template:t,chooseUserFromUG:e.data[0].dataelements.selectUsersFromUserGroup}),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons")})};return{init:(e,t)=>(function(e,t){s=t;var n=e.dsModel,i=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],function(e){var t=e.createSocket({socket_id:i}),s=o.getRefinementToSnN(i,"routeTemplate",!1,["Route Template"]);if(s.precond=o.getPrecondForRouteTemplateSearch(),!UWA.is(t))throw new Error("Socket not initialized");t.dispatchEvent("RegisterContext",s),t.addListener("Selected_Objects_search",r.bind(n,"")),t.dispatchEvent("InContextSearch",s)})})(e,t),populateTemplate:(e,t)=>l(e,t),destroy:()=>{s={}},getPrecondForTemplateSearch:()=>(function(){var e={};return e.precond=o.getPrecondForRouteTemplateSearch(),e})(),changeHandlerFortemplateField:e=>(function(e){if(a)a=!1;else{if(e.fields.templateField.selectedItems){let t=e.fields.templateField.selectedItems.options.status;if("Released"!=t&&"Route Template.Active"!=t){let o;"Draft"==t||"Route Template.Inactive"==t?o=i.errorSelectedInactiveTemplate:"Archived"!=t&&"Route Template.Archive"!=t||(o=i.errorSelectedArchiveTemplate),widget.notify.handler().addNotif({level:"error",subtitle:o,sticky:!1}),a=!0,e.fields.templateField.selectedItems=void 0}}if(e.fields.templateField.selectedItems&&e.fields.templateField.selectedItems.options){if(e.fields.templateField._editor.elements.inputField.value==e.fields.templateField.selectedItems.options.label){var t=[],o={id:e.fields.templateField.selectedItems.options.value,createFromTemplate:!0};t.push(o),l(t,e),setTimeout(function(){var t=e.fields.templateField._editor.elements.inputField.value.length;e.fields.templateField._editor.elements.inputField.setSelectionRange(t,t),e.fields.templateField._editor.elements.inputField.focus()},1e3)}}else{if(e.fields.descField.value="",e.fields.routePurpose.selectedIndex=0,e.fields.routeCompletionAction.selectedIndex=0,e.fields.routeAutoStopOnRejection.selectedIndex=0,e.fields.requiresEsign="False",e.fields.DemoteOnRejection.selectedIndex=0,e.fields.buttonGroupUGA.selectIndex(0),e.fields.buttonGroupUGA.show(),e.advFormFields.querySelector("#PreserveTaskOwner").removeAttribute("style"),widget.routeMgmtMediator.publish("initiateRoute-on-TemplateSelection",{template:""}),!e.fields.scopeField.options.fromBookMarkEditor){e.fields.buttonGroupScope.selectIndex(1),e.routeScopeField.className="fonticon-chooser-scope-display";for(let t=0;t<e.fields.buttonGroupScope.getButtonCount();t++){let o=e.fields.buttonGroupScope.getButton(t);o&&o.disabled&&(o.disabled=!1)}}widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons"),setTimeout(function(){e.fields.templateField._editor.elements.inputField.focus()},1e3)}}})(e)}}),define("DS/ENORouteMgmt/Views/Menu/MemberContextualMenu",["DS/Menu/Menu","DS/ENORouteMgmt/Actions/MemberActions","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Model/RouteMemberModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i){"use strict";let s,a=function(e,o,n){let s;var a=[];return-1!==e.indexOf("Read")&&(s="unselected","role.read"==n&&(s="selected"),a.push({name:i["role.read"],title:i["role.read"],type:"CheckItem",state:s,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-book-locked"},data:null,action:{callback:function(){t.onChangeAccess("Read",o)}}})),-1!==e.indexOf("Read Write")&&(s="unselected","role.readwrite"==n&&(s="selected"),a.push({name:i["role.readwrite"],title:i["role.readwrite"],type:"CheckItem",state:s,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-book-open"},data:null,action:{callback:function(){t.onChangeAccess("Read Write",o)}}})),-1!==e.indexOf("Add")&&(s="unselected","role.add"==n&&(s="selected"),a.push({name:i["role.add"],title:i["role.add"],type:"CheckItem",state:s,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-doc-add"},data:null,action:{callback:function(){t.onChangeAccess("Add",o)}}})),-1!==e.indexOf("Remove")&&(s="unselected","role.remove"==n&&(s="selected"),a.push({name:i["role.remove"],title:i["role.remove"],type:"CheckItem",state:s,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-doc-delete"},data:null,action:{callback:function(){t.onChangeAccess("Remove",o)}}})),-1!==e.indexOf("Add Remove")&&(s="unselected","role.addremove"==n&&(s="selected"),a.push({name:i["role.addremove"],title:i["role.addremove"],type:"CheckItem",state:s,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-docs-delete"},data:null,action:{callback:function(){t.onChangeAccess("Add Remove",o)}}})),a};return s={memberContextualMenu:(e,t,o)=>a(e,t,o),membersGridRightClick:(t,o)=>(function(t,o){var i,s=[],r=o.Access,l=o.id,d=n.getModel().RouteState;if(i="Inactive"==d||"Active"==d?"Route Template":"Route","Collab Space"!==o.Type&&"true"!==o.isRouteOwner&&"true"===o.isLoggedInUserRouteOwner&&"User Group"!==o.Type&&("Route Template"!=i||"Active"!==d)&&("Route"!=i||"Complete"!==d&&"Archive"!==d&&"false"!==o.canModifyMemberAccess)){s=["Read","Read Write","Add","Remove","Add Remove"],t.preventDefault(),t.stopPropagation();var u=t.target.getBoundingClientRect(),c={position:{x:u.left,y:u.top+20}},m=[];m=m.concat(a(s,l,r)),e.show(m,c)}})(t,o),routeMemberGridCheveron:(t,o)=>(function(t,o){var i,s=[],r=t.Access,l=n.getModel().RouteState;if(i="Inactive"==l||"Active"==l?"Route Template":"Route","Collab Space"!==t.Type&&"true"!==t.isRouteOwner&&"true"===t.isLoggedInUserRouteOwner&&"User Group"!==t.Type&&("Route Template"!=i||"Active"!==l)&&("Route"!=i||"Complete"!==l&&"Archive"!==l&&"false"!==t.canModifyMemberAccess))return s=["Read","Read Write","Add","Remove","Add Remove"],UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-chevron-down ",events:{click:function(t){t.preventDefault(),t.stopPropagation();var n=t.target.getBoundingClientRect(),i={position:{x:n.left,y:n.top+20}},l=[];l=l.concat(a(s,o,r)),e.show(l,i)}}})})(t,o)}}),define("DS/ENORouteMgmt/Commands/RouteDocumentCommands",["UWA/Core","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n){"use strict";let i=function(e,o,n,i,s,a){let r={document:{id:o,contextId:t.getSecurityContextValue(),serviceId:"3DSpace",envId:t.getTenantValue(),index:1,data:function(e){let t={};if(Array.isArray(e))for(let o=0;o<e.length;o++)t.title=e[o].Title,t.type=e[o].Type,t.name=e[o].Name,t.owner=e[o].Owner;else{let o=e.data;for(let e=0;e<o.length;e++)t.title=o[e].options.grid.Title,t.type=o[e].options.grid.Type,t.name=o[e].options.grid.Name,t.owner=o[e].options.grid.Owner}return t}(i),type:"Document"},platformUrls:{"3DSpace":t.get3DSpaceURL(),"3DDashboard":t.getDashboardURL()},onComplete:function(e){a&&a(e)}};r.document.filesCallback=function(e){s(e)};let l=new e;l.init(r);l.render()};return{init:(e,t,o,n,s,a)=>i(e,t,0,n,s,a)}}),define("DS/ENORouteMgmt/Views/InitiateRoutePropertiesView",["DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/Accordeon","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Utilities/Dom","DS/ENORouteMgmt/Views/Loader/InitiateRouteTemplateChooser","DS/ENORouteMgmt/Views/Loader/InitiateRouteScopeChooser","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/TreeModel/TreeNodeModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m){"use strict";let p,g,f=function(r,f){p.contentIds=f.contentIdsList,p.formFields=new UWA.Element("div",{id:"InitiateRoutePropertiesContainer",class:""}),p.advFormFields=new UWA.Element("div",{id:"InitiateRouteAdvancedContainer",class:"main-panel"}),p.routeTemplateField=new UWA.Element("div",{id:"SearchTemplatesField",class:"fonticon-chooser-display"}),p.routeScopeField=new UWA.Element("div",{id:"SeachScopeField",class:"fonticon-chooser-scope-display"}),p.fields={},p.formFields.inject(r),g=new UWA.Element("h5",{class:"required",text:m.title}).inject(p.formFields),UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(g),p.fields.name=new e({placeholder:m.placeholderName,pattern:"[^./#,\\[\\]\\$\\^@\\*\\?%:'\"\\\\<>;|]+",sizeInCharNumber:61}),p.fields.name.domId="Route_name",p.fields.name.inject(p.formFields),p.fields.name.addEventListener("uncommittedChange",function(e){widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons",{properties:p})}),new UWA.Element("h5",{text:m.routeTemplate}).inject(p.formFields);var w={isMultiSearchMode:!1};w.placeHolderValue=m.searchTemplate,w.minLengthToType=3,w.isFreeInputAllowed=!1,w.toKeepSearchResultsFlag=!1,w.getPrecond=function(){return l.getPrecondForTemplateSearch()},w.getChangeHandler=function(){return l.changeHandlerFortemplateField(p)},p.fields.templateField=u.drawAutoCompleteComponent(w),p.fields.templateField.inject(p.routeTemplateField),new UWA.Element("div",{html:"&nbsp;"}).inject(p.routeTemplateField),p.fields.templateChooser=new i({icon:{iconName:"search"}}),p.fields.templateChooser.inject(p.routeTemplateField),p.fields.templateChooser.getContent().addEventListener("buttonclick",function(){l.init(event,p)}),p.routeTemplateField.inject(p.formFields),new UWA.Element("h5",{text:m.description}).inject(p.formFields),p.fields.descField=new t({placeholder:m.placeholderDescription,widthInCharNumber:61,nbRows:5,newLineMode:"enter"}),p.fields.descField.inject(p.formFields),p.fields.descField.domId="Route_description",g=new UWA.Element("h5",{class:"required",text:m.routeBasePurpose}).inject(p.advFormFields),p.fields.routePurpose=new a({elementsList:[m.standard,m.Approval,m.Review],enableSearchFlag:!1}).inject(p.advFormFields),p.fields.routePurpose.addEventListener("change",function(e){let t=e.dsModel.selectedIndex;t=t=0==t?"Standard":1==t?"Approval":"Review",widget.routeMgmtMediator.publish("initiateRoute-on-RouteBasePurposeSelection",{basePurpose:t})}),g=new UWA.Element("h5",{class:"required",text:m.routeCompletionAction}).inject(p.advFormFields);var v=new UWA.Element("div",{id:"completeActionDiv",class:""}).inject(p.advFormFields);p.fields.routeCompletionAction=new a({elementsList:[m.notifyRouteOwner,m.promoteConnectedObject],enableSearchFlag:!1}),g=new UWA.Element("h5",{class:"required",text:m.DemoteOnRejection}).inject(p.advFormFields),p.fields.DemoteOnRejection=new a({elementsList:[m.no,m.yes],enableSearchFlag:!1}),p.fields.DemoteOnRejection.inject(p.advFormFields),p.fields.routeCompletionAction.inject(v),f&&f.inboxTaskId&&(p.inboxTaskId=f.inboxTaskId,g=new UWA.Element("h5",{class:"required",text:m.visibleToParent}).inject(p.advFormFields),p.fields.visibleToParent=new a({elementsList:[m.no,m.yes],enableSearchFlag:!1}).inject(p.advFormFields)),g=new UWA.Element("h5",{class:"required",text:m.routeAutoStopOnRejection}).inject(p.advFormFields),p.fields.routeAutoStopOnRejection=new a({elementsList:[m.immediate,m.deferred],enableSearchFlag:!1}),p.fields.routeAutoStopOnRejection.inject(p.advFormFields),g=new UWA.Element("h5",{class:"required",text:m.routeScope}).inject(p.advFormFields),p.fields.buttonGroupScope=new n({type:"radio"}),null!=f.scopeId&&null!=f.scopeId&&null!=f.scopePhyId&&null!=f.scopePhyId?p.fields.buttonGroupScope.addChild(new s({type:"radio",label:m.selectScope,value:"scope",checkFlag:!0})):(p.fields.buttonGroupScope.addChild(new s({type:"radio",label:m.scopeAll,value:"All"})),p.fields.buttonGroupScope.addChild(new s({type:"radio",label:m.scopeOrg,value:"Organization",checkFlag:!0})),p.fields.buttonGroupScope.addChild(new s({type:"radio",label:m.selectScope,value:"scope"}))),p.fields.buttonGroupScope.inject(p.advFormFields),p.fields.buttonGroupScope.addEventListener("change",function(e){"scope"==e.dsModel.value?(p.routeScopeField.className="fonticon-chooser-display",p.fields.scopeField._editor.elements.inputField.focus(),widget.routeMgmtMediator.publish("initiateRoute-on-ScopeSelection",{scopeId:"",scopePhyId:""})):(p.fields.scopeField.selectedItems=void 0,widget.routeMgmtMediator.publish("initiateRoute-on-ScopeSelection",{scopeId:e.dsModel.value,scopePhyId:""}),p.routeScopeField.className="fonticon-chooser-scope-display")});var S={isMultiSearchMode:!1};var R;(S.placeHolderValue=m.selectScope,S.minLengthToType=3,S.isFreeInputAllowed=!1,S.toKeepSearchResultsFlag=!1,S.getPrecond=function(){return d.getPrecondForScope()},S.getChangeHandler=function(){return d.changeHandlerForScopeField(p,f)},p.fields.scopeField=u.drawAutoCompleteComponent(S),p.fields.scopeField.inject(p.routeScopeField),new UWA.Element("div",{html:"&nbsp;"}).inject(p.routeScopeField),p.fields.scopeChooser=new i({icon:{iconName:"search"}}),p.fields.scopeChooser.getContent().addEventListener("buttonclick",function(){d.init(event,p)}),null!=f.scopeId&&null!=f.scopeId&&null!=f.scopePhyId&&null!=f.scopePhyId)?(R=new c({label:f.scopeValue,value:f.scopePhyId,scopeId:f.scopeId,ScopeMembers:f.ScopeMembers}),p.fields.scopeField.options.fromBookMarkEditor=!0,p.fields.scopeField.selectedItems=R,p.routeScopeField.className="fonticon-chooser-display",p.fields.scopeField._editor.elements._clearFieldButton.hide(),p.fields.scopeField._editor.elements.inputField.disabled=!0):p.fields.scopeChooser.inject(p.routeScopeField);p.routeScopeField.inject(p.advFormFields),g=new UWA.Element("h5",{class:"required",id:"PreserveTaskOwner",text:m.PreserveTaskOwnerLabel}).inject(p.advFormFields),p.fields.buttonGroupUGA=new n({type:"radio"}),p.fields.buttonGroupUGA.addChild(new s({type:"radio",label:m.PreserveTaskOwnerSelect2,value:"Retain",checkFlag:!0})),p.fields.buttonGroupUGA.addChild(new s({type:"radio",label:m.PreserveTaskOwnerSelect1,value:"Reset"})),p.fields.buttonGroupUGA.inject(p.advFormFields);let y=new o({items:[{header:m.advancedOptions,content:p.advFormFields}],exclusive:!1,style:"filled-separate"});new UWA.Element("h5",{text:""}).inject(p.formFields),y.inject(p.formFields),f&&f.templateId&&(h(f.templateId),setTimeout(function(){p.fields.name.elements.inputField.focus()},1e3)),p.fields.name.elements.inputField.focus()},h=function(e){var t=[{id:e}];l.populateTemplate(t,p)};return{build:(e,t)=>(function(e,t){p={},f(e,t)})(e,t),destroy:()=>{p={}},getProperties:()=>p}}),define("DS/ENORouteMgmt/Views/Loader/InitiateRoutePropertiesLoader",["DS/ENORouteMgmt/Views/InitiateRoutePropertiesView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){"use strict";let o={};return{init:function(t){this.showView()||(o.container=new UWA.Element("div",{html:"",id:"InitiateRouteFormView",class:"route-initiate-properties-container"}),o.container.inject(document.querySelector("#iRouteTabsContainer")),e.build(o.container,t))},hideView:function(){document.querySelector("#InitiateRouteFormView")&&document.querySelector("#InitiateRouteFormView").getChildren().length>0&&(document.getElementById("InitiateRouteFormView").style.display="none")},showView:function(){return!!(document.querySelector("#InitiateRouteFormView")&&document.querySelector("#InitiateRouteFormView").getChildren().length>0)&&(document.getElementById("InitiateRouteFormView").style.display="block",!0)},destroy:function(){e.destroy()},getModel:function(){return e.getProperties()}}}),define("DS/ENORouteMgmt/Views/Tile/RouteMembersTileView",["DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Views/Menu/MemberContextualMenu","DS/Core/PointerEvents"],function(e,t,o){"use strict";let n;return{build:t=>(function(t){n=t||new TreeDocument({useAsyncPreExpand:!0});let o="Members-tileView-View showView nonVisible";"GridView"==widget.getValue("MembersTab-ShowView")&&(o="Members-tileView-View hideView");var i=UWA.createElement("div",{id:"tileViewContainer",styles:{width:"100%",height:"calc(100% - 40px)",position:"relative"},class:o});return e.build(t,i)})(t),contexualMenuCallback:()=>{e.tileView().onContextualEvent={callback:function(e){var o=[],i=[];if(e&&e.cellInfos&&e.cellInfos.cellModel){var s,a=n.RouteState;s="Inactive"==a||"Active"==a?"Route Template":"Route";var r=n.getSelectedNodes(),l=r[0].options.grid.Access;i="Collab Space"===r[0].options.grid.Type||"true"===r[0].options.grid.isRouteOwner||"true"!==r[0].options.grid.isLoggedInUserRouteOwner||"User Group"===r[0].options.grid.Type||"Route Template"==s&&"Active"===a||"Route"==s&&("Complete"===a||"Archive"===a||"false"===r[0].options.grid.canModifyMemberAccess)?[]:["Read","Read Write","Add","Remove","Add Remove"];var d=r[0]._options.grid.id;o=t.memberContextualMenu(i,d,l)}return o}}}}}),define("DS/ENORouteMgmt/Views/RouteMembersView",["DS/ENORouteMgmt/Views/Grid/RouteMembersDataGridView","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Views/Tile/RouteMembersTileView","DS/ENORouteMgmt/Model/RouteMemberModel","DS/ENORouteMgmt/Controller/RouteServicesController"],function(e,t,o,n,i){"use strict";let s,a={},r=function(t){let i=e.build(n.getModel()),s=o.build(n.getModel());o.contexualMenuCallback(),p();let a=e.getGridViewToolbar(),r=UWA.createElement("div",{id:"dataGridMembersDivToolbar",class:"toolbar-container",styles:{width:"100%"}}).inject(t);return a.inject(r),i.inject(t),s.inject(t),l(),t},l=function(){widget.routeMgmtMediator.subscribe("route-task-on-change-assignee",function(){u()}),widget.routeMgmtMediator.subscribe("route-task-on-save",function(){u()}),widget.routeMgmtMediator.subscribe("ON_SPLIT_ROUTENODE",function(){u()}),widget.routeMgmtMediator.subscribe("template-maturity-change",function(){d()})},d=function(){null!=s&&null!=s.model&&i.fetchRouteMembers(s.model.id).then(function(e){require(["DS/ENORouteTemplateMgmt/Model/RouteTemplateModel"],function(t){let o=t.getRowModelById(s.model.id).options.grid;n.getModel().removeRoots(),c(e,{model:o})})})},u=function(){s.model&&s.model.id&&i.fetchRouteMembers(s.model.id).then(function(e){n.getModel().removeRoots(),n.createModel(e,s)})},c=function(e,t){n.createModel(e,t),n.getModel().RouteId=t.model.id,n.getModel().RouteState=t.model.state},m=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&require(["DS/ENORouteMgmt/Views/Menu/MemberContextualMenu"],function(o){o.membersGridRightClick(e,t.nodeModel.options.grid)})},p=function(){t.dataGridView().addEventListener("contextmenu",m),widget.routeMgmtMediator.subscribe("member-data-updated",function(e){n.updateRow(e)})},g=function(){return null!=document.querySelector("#routeMembersContainer")&&(document.getElementById("routeMembersContainer").style.display="block",!0)};return{init:e=>(function(e){if(s=e,!g()){let t=UWA.createElement("div",{id:"routeMembersContainer",class:"route-members-container"});t.inject(document.querySelector(".route-facets-container")),i.fetchRouteMembers(e.model.id).then(function(o){n.destroy(),c(o,e),r(t)})}})(e),hideView:()=>{null!=document.getElementById("routeMembersContainer")&&(document.getElementById("routeMembersContainer").style.display="none")},destroy:()=>{a={},s={},n.destroy()}}}),define("DS/ENORouteMgmt/Views/Dialogs/StopRouteDemote",["DS/WAFData/WAFData","UWA/Core","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/Controls/Editor","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d){"use strict";let u,c,m={},p=function(e,t){require(["DS/ENORouteMgmt/Actions/RouteActions"],function(o){o.stopRouteComments(e,t)}),c.close()},g=function(e,t,o){require(["DS/ENORouteMgmt/Actions/RouteActions"],function(n){n.stopRouteWithDemoteConfirm(e,t,o)}),c.close()};return u={demoteConfirmation:(e,t,l)=>(function(e,t,l){let u=new n;u.inject(document.body);var f=l;f=d.stopRoute+" : "+(f.length>40?f.substring(0,37)+"...":f);let h=new UWA.Element("div",{id:"stopConfirmation",class:""});if(m.formFields=new UWA.Element("div",{id:"stopComment",class:""}),m.fields={},new UWA.Element("p1",{text:d.RouteStopWarningDetails}).inject(m.formFields),m.formFields.inject(h),"true"==t){var w=new a({type:"checkbox"});w.addChild(new r({type:"checkbox",label:d.demoteConnectedObjects,checkFlag:!1})),w.inject(m.formFields);var v=!1;w.addEventListener("buttonclick",function(e){v=e.dsModel.checkFlag})}new UWA.Element("h5",{text:d.comments}).inject(m.formFields),m.fields.descField=new s({placeholder:d.enterComments,nbRows:5,newLineMode:"enter"}),m.fields.descField.inject(m.formFields),c=new o({modalFlag:!0,width:500,height:300,title:f,content:h,domId:"RouteImmersiveFrame",immersiveFrame:u,buttons:{Ok:new i({emphasize:"primary",label:d.stop,onClick:function(o){o.dsModel.dialog;let n=m.fields.descField.value;"true"==t?g(v,n,e):p(n,e)}}),Cancel:new i({onClick:function(e){e.dsModel.dialog.close()}})}})})(e,t,l)}}),define("DS/ENORouteMgmt/Actions/RouteActions",["DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Views/Dialogs/ChooseUsersFromUserGroup","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Views/Dialogs/StopRouteDemote","DS/ENORouteMgmt/Utilities/ParseJSONUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a){"use strict";let r,l,d=function(o,n){let s=t.getRouteServiceBaseURL()+"/"+o+"?$fields=none,name&stopRouteCheck=true";e.stopRouteCheck(s).then(e=>{var t=e[0].isStateBased;i.demoteConfirmation(o,t,n)},e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:a.FailureRouteStop,sticky:!1})})},u=function(t,n,i,r,d){var u;if(p(),"stop"==d&&l){var c={StopCommentsValue:l};u=(new s).createDataForRequest(c)}e.updateState(n,u).then(o=>{widget.notify.handler().addNotif({level:"success",subtitle:i,sticky:!1}),e.fetchRouteById(t).then(e=>{g(),widget.routeMgmtMediator.publish("route-get-count-value",0),e[0].noTitleUpdate=!0,widget.routeMgmtMediator.publish("route-data-updated",e[0]),widget.routeMgmtMediator.publish("redraw-graph",e[0])},e=>{g(),widget.routeMgmtMediator.publish("route-get-count-value",0),e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:a.infoRefreshError,sticky:!1})})},e=>{if(g(),widget.routeMgmtMediator.publish("route-get-count-value",0),e.error)if(-1!=e.error.indexOf(a.ErrorChooseUsers)){var n={routeId:t};new o.showSeletUsers(n)}else-1!=e.error.indexOf("No privilege for operation")?widget.notify.handler().addNotif({level:"error",subtitle:a.FailureRouteStop1,sticky:!1}):-1!=e.error.indexOf("Route cannot be started for future states of the associated type")?widget.notify.handler().addNotif({level:"error",subtitle:a.FailureRouteRestart1,sticky:!1}):-1!=e.error.indexOf("Check trigger blocked event")?widget.notify.handler().addNotif({level:"error",subtitle:a.FailureRouteRestart1,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1});else widget.notify.handler().addNotif({level:"error",subtitle:r,sticky:!1})})},c=function(t,n,i,s,r){p(),e.updateState(n).then(o=>{var n;n=o.data&&o.data[0]&&o.data[0].dataelements?o.data[0].dataelements.REVISED_ID:t,e.fetchRouteById(n).then(e=>{g(),"Define"==e[0].state?widget.notify.handler().addNotif({level:"warning",subtitle:a.inactiveUserRouteRestart,sticky:!1}):widget.notify.handler().addNotif({level:"success",subtitle:i,sticky:!1}),e[0].noTitleUpdate=!0;var o={};o.model=e[0];var n=!1;"idcard-ctxCommand"==r&&(n=!0),o.action=n,o.openRoute=n,widget.routeMgmtMediator.publish("route-summary-delete-row-by-ids",{model:t}),widget.routeMgmtMediator.publish("route-summary-append-rows",o),widget.routeMgmtMediator.publish("route-summary-refresh"),widget.routeMgmtMediator.publish("route-data-updated",e[0]),widget.routeMgmtMediator.publish("redraw-graph",e[0])},e=>{g(),e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:a.infoRefreshError,sticky:!1})})},e=>{if(g(),widget.routeMgmtMediator.publish("route-get-count-value",0),e.error)if(-1!=e.error.indexOf(a.ErrorChooseUsers)){var n={routeId:t};new o.showSeletUsers(n)}else-1!=e.error.indexOf("No privilege for operation")?widget.notify.handler().addNotif({level:"error",subtitle:a.FailureRouteStop1,sticky:!1}):-1!=e.error.indexOf("Route cannot be started for future states of the associated type")?widget.notify.handler().addNotif({level:"error",subtitle:a.FailureRouteRestart1,sticky:!1}):-1!=e.error.indexOf("Check trigger blocked event")?widget.notify.handler().addNotif({level:"error",subtitle:a.FailureRouteRestart1,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1});else widget.notify.handler().addNotif({level:"error",subtitle:s,sticky:!1})})},m=function(e,t,o){var n={type:"Route Template",sConnectedRouteId:t.data[0].options.grid.id,description:e.fields.descField.value,attrAvailabilityType:"Organization",attrAvailabilityId:"",attRestrictMembers:e.fields.ScopeField.getText(),taskEditSetting:0==e.fields.routeTaskEdits.selectedIndex?"Modify/Delete Task List":1==e.fields.routeTaskEdits.selectedIndex?"Extend Task List":2==e.fields.routeTaskEdits.selectedIndex?"Modify Task List":"Maintain Exact Task List",preserveTaskOwner:"Retain"==e.fields.buttonGroupPTO.value[0]?"False":"True",AutoStopOnRejection:t.data[0].options.grid.AutoStopOnRejection,routeBasePurpose:t.data[0].options.grid.BasePurpose,completionAction:0==e.fields.completionAction.selectedIndex?"Notify Route Owner":"Promote Connected Object"};return null!=e.fields.setPreserveTaskOwnerForTemplate&&0==e.fields.setPreserveTaskOwnerForTemplate.isHidden()&&(n.preserveTaskOwner="False"),(null!=o&&""!=o&&"Revise Template"!=e.fields.buttonGroupSA.value[0]||null==o||""==o)&&(n.title=e.fields.nameField.value,n.type="Route",n.selectUsersFromUserGroup="True"==e.fields.buttonGroupChooseUG.value[0]?"True":"False"),"Standard"==t.data[0].options.grid.BasePurpose&&null!=e.fields.linkedTemplateField.selectedItems&&(n.linkedRouteTemplateId=e.fields.linkedTemplateField.selectedItems.options.value,n.routeCompletionAction=e.fields.routeCompletionAction.value,n.DemoteOnRejection=e.fields.demoteOnRejection.value),e.fields.setNoForApprovalWithSign&&!e.fields.setNoForApprovalWithSign.isHidden()?n.routeRequiresESign="False":e.fields.approvalWithSign&&e.fields.approvalWithSign.visibleFlag?n.routeRequiresESign="True"==e.fields.approvalWithSign.value[0]?"True":"False":e.fields.setYesForApprovalWithSign&&!e.fields.setYesForApprovalWithSign.isHidden()?n.routeRequiresESign="True":n.routeRequiresESign="False",n},p=function(){require(["DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView"],function(e){e.getDataGridInstance().displayModalLoader(a.operationInProgress)}),require(["DS/ENORouteMgmt/Views/Tile/RouteSummaryTileView"],function(e){e.getTileViewInstance().displayModalLoader(a.operationInProgress)})},g=function(){require(["DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView"],function(e){e.getDataGridInstance().removeModalLoader(a.operationInProgress)}),require(["DS/ENORouteMgmt/Views/Tile/RouteSummaryTileView"],function(e){e.getTileViewInstance().removeModalLoader(a.operationInProgress)})};return r={startRoute:e=>(function(e){u(e,t.getRouteServiceBaseURL()+"/"+e+"/start",a.routeStarted,a.failureToStartRoute,"start")})(e),stopRoute:(e,t)=>(function(e,t){d(e,t)})(e,t),stopRouteComments:(e,o)=>(function(e,o){l=e;u(o,t.getRouteServiceBaseURL()+"/"+o+"/stop?StopCommentsValue="+encodeURI(e),a.routeStopped,a.FailureRouteStop,"stop")})(e,o),stopRouteWithDemoteConfirm:(e,o,n)=>(function(e,o,n){l=o;u(n,t.getRouteServiceBaseURL()+"/"+n+"/stop?demoteConnectedObject="+e+"&StopCommentsValue="+encodeURI(o),a.routeStopped,a.FailureRouteStop,"stop")})(e,o,n),resumeRoute:e=>(function(e){u(e,t.getRouteServiceBaseURL()+"/"+e+"/resume",a.successRouteResume,a.FailureRouteResume,"resume")})(e),restartRoute:(e,o)=>(function(e,o){c(e,t.getRouteServiceBaseURL()+"/"+e+"/restart",a.successRouteRestart,a.FailureRouteRestart,o)})(e,o),DeleteRoute:(t,o)=>(function(t,o){e.deleteRoute(t).then(e=>{var o=a.successRemoveRoute;1==t.length&&(o=a.successRemoveRouteSingle),o=o.replace("{count}",t.length),widget.notify.handler().addNotif({level:"success",subtitle:o,sticky:!1}),widget.routeMgmtMediator.publish("route-summary-delete-row-by-ids",{model:t}),widget.routeMgmtMediator.publish("route-data-deleted",{model:t}),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:n.getModel()})},e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:a.errorRemove,sticky:!1})})})(t),saveAsTemplate:(o,n)=>(function(o,n){return new Promise(function(i,a){var r,l=n.data[0].options.grid.TemplateId,d=m(o,n,l),u=n.data[0].options.grid.id;d=(new s).createDataForRequest(d),r=null!=l&&""!=l&&"Revise Template"==o.fields.buttonGroupSA.value[0]?t.getRouteTemplateServiceBaseURL()+"/"+l+"/revise":t.getRouteServiceBaseURL()+"/"+u+"/savetemplate",e.saveAsTemplate(d,r).then(e=>i(e),e=>a(e))})})(o,n),refreshRouteObjectOnChangeOwner:(o,i)=>(function(o,i){var s=[];let r;for(var l=0;l<o.data.length;l++)if(-1!=o.data[l].options.grid.Actions.indexOf("changeowner")){var d={};d.id=o.data[l].options.grid.id,s.push(d)}r={data:s},e.fetchRouteByIds(r).then(e=>{for(var o=[],s=t.getLoginUser(),a=widget.getValue("routefilters"),r=0;r<e.length;r++)if(e[r].owner==s||null!=e[r].assignees&&0!=e[r].assignees.length){if(e[r].assignees.length>0)for(var l=0;l<e[r].assignees.length;l++){if(e[r].owner==s||-1!=a.indexOf("assigned")&&e[r].assignees[l].split("~")[1]==s){"idCard"==i?(e[r].noTitleUpdate=!0,widget.routeMgmtMediator.publish("route-data-updated",e[r]),widget.routeMgmtMediator.publish("redraw-graph",e[r])):n.updateRow(e[r]);break}l==e[r].assignees.length-1&&o.push(e[r].id)}}else o.push(e[r].id);n.deleteRowModelByIds(o),widget.routeMgmtMediator.publish("route-summary-refresh"),"idCard"==i&&(e[0].owner&&(e[0].owner==s?widget.routeMgmtMediator.publish("show-edit-icon-in-tasks-tab"):o.length>0?widget.routeMgmtMediator.publish("route-task-close-click-view-mode"):(widget.routeMgmtMediator.publish("hide-edit-icon-in-tasks-tab"),widget.routeMgmtMediator.publish("hide-plus-icon-in-tasks-toolbar"),widget.routeMgmtMediator.publish("hide-remove-icon-in-tasks-toolbar"))),widget.routeMgmtMediator.publish("route-data-deleted",{model:o})),widget.routeMgmtMediator.publish("route-tag-data-updated")},e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:a.infoRefreshError,sticky:!1})})})(o,i),removeSubRoute:(t,o,i,s)=>(function(t,o,i,s){e.removeSubRoute(t,o,i,"Route").then(e=>{var o=a.successRemoveSubRoute;1==t.length&&(o=a.successRemoveSubRouteSingle),o=o.replace("{count}",t.length),widget.notify.handler().addNotif({level:"success",subtitle:o,sticky:!1}),widget.routeMgmtMediator.publish("route-summary-delete-row-by-ids",{model:t}),widget.setValue("removedSubRoutes",t),widget.routeMgmtMediator.publish("route-data-deleted",{model:t}),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:n.getModel()})},e=>{e&&e.error&&e.error.indexOf("#1500028")>=0&&e.error.indexOf("No fromdisconnect access to object")>0?widget.notify.handler().addNotif({level:"error",subtitle:a.errorNoDissconnectAccessOnRoute,sticky:!1}):e&&e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:a.errorRemove,sticky:!1})})})(t,o,i),renderRevisionsDialog:e=>(function(e){require(["DS/LifecycleCmd/HistoryCmd"],function(t){var o=[{options:{physicalid:e},getID:function(){return e}}];(t=new t({ID:"revisions_cmd_ID",context:{getSelectedNodes:()=>o}})).begin()})})(e)}}),define("DS/ENORouteMgmt/Utilities/RouteWidgetUtil",["UWA/Core","DS/ENORouteMgmt/Controller/RouteServicesController","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Collections/CollabStorageCollection","DS/WAFData/WAFData","DS/ENOXWidgetPreferences/js/ENOXWidgetPreferences","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l,d){"use strict";let u,c,m,p;var g,f;let h=function(){return new o(function(e,i){f=new s,widget.getValue("xPref_CREDENTIAL")&&(p="ctx::"+widget.getValue("xPref_CREDENTIAL"),console.log("previous cs is set:"+p)),n.start({id:widget.id,collection:f}),widget.addPreference({name:"id-card-view",type:"hidden",defaultValue:"false",label:"minimized_label"}),widget.addPreference({name:"objectLimit",type:"range",min:"10",max:"10000",label:"objectLimit",defaultValue:"200"}),r.addPlatformSelectionPreferenceToWidget({roles:["CSV","InternalDS"],mustHaveAll:!1}).then(function(){console.log("New Platform Preference"),r.addCredentialPreferenceToWidget().then(function(){console.log("New Credential"),new o(function(e,i){f.fetch({onComplete:function(i,s,a){var r,l;(r=widget.getValue("collabstorage"))&&(f.forEach(function(e){e.get("url")===r&&(l=e.id)}),l&&widget.setValue("x3dPlatformId",l),widget.setValue("collabstorage",null)),function(e,i){e&&(t.fetchAllowedContentTypesForRoute().then(e=>{let t=e.data[0].dataelements.routeDnDContentTypes;widget.setValue("routeContentDnDTypes",t);let o=e.data[0].dataelements.routeSearchContentTypes;widget.setValue("routeContentSearchTypes",o)},e=>{}),new o(function(e,o){null==p?t.fetchSecurityContext().then(t=>{t[0].cspaces,null==t[0].defaultsc&&d.NoAccessToCollabSpace;let o=t[0].defaultsc,n=o?o.replace("ctx::",""):"";null==n&&""==n||widget.setValue("xPref_CREDENTIAL",n),e()},e=>{var t=JSON.parse(e);t.error?widget.notify.handler().addNotif({level:"error",subtitle:t.error.message,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:d.infoRefreshError,sticky:!1}),o()}):e()}).then(e=>{widget.addPreference({name:"organization",type:"hidden",defaultValue:n.getSecurityContextValue().split("ctx::")[1].split(".")[1]})},e=>{console.log("Updating credentials failed!!")}))}.call(void 0,i),e()}})}).then(function(t){v(),S(),e()}).catch(e=>{})})}),w()})},w=function(){widget.routeMgmtMediator.subscribe("route-widgetTitle-count-update",function(e){!function(e){var t=0;e.model.getChildren().forEach(e=>{e._isHidden&&t++});var o=e.model.getChildren().length-t,n=d.myRoutes,i="routes";e.model.getChildren().length>0&&(i="Route Template"===e.model.getChildren()[0].options.grid.Type?"route_templates":"routes");var s=document.getElementById("route_templates");("route_templates"===i||s&&s.className&&s.className.contains("selected"))&&(n=d.myTemplates);var a=n+" ("+o+")";widget.setTitle(a);let r={event:"ObjectCount"};r.objectType=i,r.value=o,l.sendRouteTrackerEvent(r)}(e)}),widget.routeMgmtMediator.subscribe("route-widgetTitle-update-withName",function(e){g=e.model.Title;var t=e.model.Title;widget.setTitle(t)}),widget.routeMgmtMediator.subscribe("route-data-updated",function(e){if(e.noTitleUpdate);else if(e.title!=g){var t=e.title;widget.setTitle(t)}}),widget.routeMgmtMediator.subscribe("template-data-updated",function(e){if(e.noTitleUpdate);else if(e.title!=g){var t=e.title;widget.setTitle(t)}})},v=function(){R("Route").then(function(e){widget.setValue("stateNLS",e)}).catch(e=>{}),R("Route Template").then(function(e){widget.setValue("stateTemplateNLS",e)}).catch(e=>{})},S=function(){t.fetchTaskFields().then(e=>{widget.setValue("task-custom-fields",e)},e=>{console.log("fetching custom task attribute defintion failed!!")})};function R(e){var t=n.get3DSpaceURL()+"/resources/bps/getTypeMaturity?type="+e;return new o(function(e,o){require(["DS/WAFData/WAFData"],function(i){n.authenticateRequest(t,{headers:{Accept:"application/json","Content-Type":"application/ds-json"},method:"get",type:"json",onComplete:function(t){e(t)},onFailure:function(e){o(new Error("Could not fetch Type State Mapping NLS values"))}})})})}return c=function(e){},m=function(e){f&&n.updateURLsOnEdit(f),widget.setValue("organization",n.getSecurityContextValue().split("ctx::")[1].split(".")[1])},u={init:()=>h(),onEdit:e=>{},endEdit:e=>m(),registerWidgetTitleEvents:()=>w(),getTaskCustomFields:()=>S()}}),define("DS/ENORouteMgmt/Views/Dialogs/InitiateSaveAsTemplateDialog",["DS/ENORouteMgmt/Actions/RouteActions","DS/ENORouteMgmt/Utilities/Utils","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/ENORouteMgmt/Views/InitiateSaveAsTemplateView","DS/ENORouteMgmt/Controller/RouteServicesController","DS/Controls/Button","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r){"use strict";let l,d,u,c=function(t){let s=new UWA.Element("div",{html:"",id:"saveAsTemplate"});l=new UWA.Element("div",{id:"dialogContainer",class:"template-facets-container"}),i.build(l,t,u),l.inject(s);var c=t.data[0].options.grid.Title,g=new n;g.inject(document.body),d=new o({title:r.replace(r.SaveRouteasTemplate,{route:c}),modalFlag:!0,width:450,height:500,content:s,domId:"RouteImmersiveFrame",immersiveFrame:g,resizableFlag:!0,buttons:{Ok:new a({disabled:!0,domId:"okSaveAsButton",emphasize:"primary",label:r.SaveasTemplate,allowUnsafeHTMLLabel:!0,onClick:function(o){let n=i.getProperties();m(n,t)&&(o.dsModel.label=r.SavingTemplate,o.dsModel.disabled=!0,d.buttons.Cancel.disabled=!0,e.saveAsTemplate(n,t).then(e=>{if(e[0].name!=t.data[0].options.grid.TemplateName){var n={level:"success",subtitle:r.replace(r.createSuccess,{Template:e[0].title}),sticky:!1};o.dsModel.dialog.close(),widget.routeMgmtMediator.publish("route-summary-show-message",{message:n})}else{n={level:"success",subtitle:r.replace(r.reviseSuccess,{Template:e[0].title}),sticky:!1};o.dsModel.dialog.close(),widget.routeMgmtMediator.publish("route-summary-show-message",{message:n})}},e=>{o.dsModel.label=r.SaveasTemplate,o.dsModel.disabled=!1,d.buttons.Cancel.disabled=!1,e&&e.error.toLowerCase().indexOf("no create access")>-1?widget.notify.handler().addNotif({level:"error",title:r.errorCreateRouteForRoleTitle,subtitle:r.errorCreateRouteForRoleSubTitle,message:r.errorCreateRouteForRoleMsg,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1})}))}}),Cancel:new a({label:r.cancel,domId:"cancelButton",emphasize:"secondary",allowUnsafeHTMLLabel:!0,onClick:function(e){e.dsModel.dialog.close()}})}}),p(),d.addEventListener("close",function(e){widget.notify.notifview().removeNotifications()})},m=function(e,o){if(""==e.fields.name.className&&0==e.fields.nameField.disabled){if(t.strLength(e.fields.nameField.value)>127)return widget.notify.handler().addNotif({level:"error",subtitle:r.errorRouteNameFormat,sticky:!1}),!1;if(0==e.fields.nameField.disabled&&(""==e.fields.nameField.value||null==e.fields.nameField.value))return widget.notify.handler().addNotif({level:"error",subtitle:r.saveasErrorMessage,sticky:!1}),!1}return"Standard"!=o.data[0].options.grid.BasePurpose||!e.fields.linkedTemplateField.selectedItems||""==e.fields.linkedTemplateField.selectedItems.options.label||""!=e.fields.linkedTemplateField.selectedItems.options.value&&null!=e.fields.linkedTemplateField.selectedItems.options.value||(widget.notify.handler().addNotif({level:"error",subtitle:r.linkedTemplateSelectMessage,sticky:!1}),!1)},p=function(){widget.routeMgmtMediator.subscribe("initiate-saveAsTemplate-toggle-dialogbuttons",function(){let e=i.getProperties();e&&e.formFields&&(""!=e.fields.nameField.elements.inputField.value.trim()?d.buttons.Ok.disabled=!1:d.buttons.Ok.disabled=!0)}),widget.routeMgmtMediator.subscribe("initiate-reviseTemplate-toggle-dialogbuttons",function(){let e=i.getProperties();e&&e.formFields&&(d.buttons.Ok.disabled=!1)})};return{InitiateSaveAsTemplateDialog:e=>(function(e){u={},s.getESignConfigSetting().then(function(t){u.routeESignConfigSetting=t.routeESignConfigSetting,c(e)})})(e)}}),define("DS/ENORouteMgmt/Config/RouteContentsGridViewConfig",["DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o){"use strict";return[{text:o.title,dataIndex:"tree"},{text:o.name,dataIndex:"Name"},{text:o.type,dataIndex:"TypeDisplay"},{text:o.revision,dataIndex:"Revision"},{text:o.IDcardMaturityState,dataIndex:"Maturity"},{text:o.blockingMaturity,dataIndex:"BlockingMaturityMenu",visibility:!0,editableFlag:!0,getCellSemantics:function(e){return{label:e.nodeModel.options.grid.RouteBaseState_NLS}},getCellEditableState:function(t){return e.isCellEditable(t)},getCellTypeRepresentation:function(t){return e.getCellTypeRepresentation(t)},compareFunction:function(t,o){return e.compareBlockingStates(t,o)},getCellTooltip:function(t){return e.showTooltip(t)}},{text:o.targetMaturity,dataIndex:"TargetMaturityMenu",visibility:!0,editableFlag:!0,getCellSemantics:function(e){return{label:e.nodeModel.options.grid.RouteTargetState_NLS}},getCellEditableState:function(e){return t.isCellEditable(e)},getCellTypeRepresentation:function(e){return t.getCellTypeRepresentation(e)},compareFunction:function(e,o){return t.compareTargetMaturityStates(e,o)},getCellTooltip:function(e){return t.showTooltip(e)}},{text:o.IDcardOwner,dataIndex:"Owner"},{text:o.relationType,dataIndex:"Relation"},{text:o.relatedTo,dataIndex:"relatedToTaskTitles"}]}),define("DS/ENORouteMgmt/Views/Form/FormValidation",["DS/ENORouteMgmt/Views/Form/CustomFieldUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){"use strict";let o=function(o,n){return!e.isMandatoryField(o)||!(null==n||n.trim&&""==n.trim())||(widget.notify.handler().addNotif({level:"error",subtitle:t.mandatoryFieldRequired,sticky:!1}),!1)},n=function(o,n){let i=e.getMaxLength(o);if(0==i);else if(n.length>i){let e=t.replace(t.longerThanDefinedCharLengthError,{name:o.name,length:i});return widget.notify.handler().addNotif({level:"error",subtitle:e,sticky:!1}),!1}return!0};return{validateCustomAttrInfo:(t,i)=>(function(t,i){let s=widget.getValue("task-custom-fields"),a=!0;if(s)for(let t=0;t<s.length;t++){let r=s[t];if("extensions"!=r.name&&i.elements[r.name])if(e.isMultiValueField(r)&&Array.isArray(i.elements[r.name])){for(let e=0;e<i.elements[r.name].length;e++){let t=i.elements[r.name][e].value;if(!(a=o(r,t)))break;if(!(a=n(r,t)))break}if(!a)break}else{let e=i.elements[r.name].value;if(!(a=o(r,e)))break;if(!(a=n(r,e)))break}}return a})(0,i)}}),define("DS/ENORouteMgmt/Views/Dialogs/RouteChangeOwnershipDialog",["DS/ENORouteMgmt/Actions/RouteActions","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_TransferOwnershipCmd","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s){return{routeChangeOwner:(a,r)=>(function(a,r){if(i.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Change Owner"}),void 0===a.data&&(a=t.getSelectedRowsModel()),a.data.length<1)widget.notify.handler().addNotif({level:"warning",subtitle:s.ErrorRouteChangeOwner,sticky:!1});else{var l=[];a.data.forEach(function(e){var t={getID:function(){return e.options.grid.id},getLabel:function(){return e.options.grid.Title}};l.push(t)});var d={SecurityContext:o.getSecurityContextValue()},u=new n({ID:"ActionBar_TransferOwnershipCmd_",context:{getSecurityContext:function(){return d},getSelectedNodes:function(){return l}}});u.onEnd(function(t){var o=setInterval(function(){u.transferOwnershipPanel&&u.transferOwnershipPanel.addEvent&&(clearInterval(o),u.transferOwnershipPanel.addEvent("onClose",function(){null!=event&&"readystatechange"!==event.type||e.refreshRouteObjectOnChangeOwner(a,r)}))})},200),u.begin()}})(a,r)}}),define("DS/ENORouteMgmt/Utilities/RouteLinkWidgetUtil",["DS/RouteWebAppUX/Utilities/RouteLinkWidget","DS/RouteWebAppUX/Utilities/CompassDataExchange","DS/RouteWebAppUX/Views/RouteActivityState","DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i){"use strict";let s,a,r=function(){a.subscribe("refresh-route-data",function(e){widget.routeMgmtMediator.publish("route-RefreshData-linkWidget-published",e)}),a.subscribe("load-route-data",function(e){let t,o=e.dropData.data,n=o.items,i=[];n.forEach(function(e){i.push(e.objectId),t=e.objectType}),1==n.length&&"Inbox Task"==o.approvalObjectType&&(widget.data.contentId=n[0].objectId,widget.data.contentType=o.approvalObjectType,widget.data.taskId=n[0].objectId,t=o.approvalObjectType),n.length>0&&(widget.data.linkedContextTitle=n[0].linkedContextTitle),widget.data.approvalProcessIds=i,widget.data.approvalProcessType=t,"route_templates"===widget.getValue("HomePage")?(widget.setValue("openSelected",!0),widget.routeMgmtMediator.publish("welcome-panel-load-subscribed-data",{id:"routes"})):widget.routeMgmtMediator.publish("route-data-linkWidget-published")}),widget.routeMgmtMediator.subscribe("route-data-updated",function(e){l(e,!1)}),widget.routeMgmtMediator.subscribe("route-created",function(e){null!=widget.data.fromContext&&""!=widget.data.fromContext||(widget.data.fromContext="createNewRoute"),l(e,!1)}),widget.routeMgmtMediator.subscribe("route-content-updated",function(e){l(e,!0)})},l=function(e,t){if(t){for(var o=[],i=0;i<e.length;i++){var s={};s.id=e[i].id,o.push(s)}d({data:o})}else n.fetchRouteContentIds(e.id).then(e=>{if(null!=e){for(var t=[],o=0;o<e.data.length;o++){var n={};n.id=e.data[o].id,t.push(n)}d({data:t})}},e=>{})},d=function(e){n.fetchApprovalStatusForContent(e).then(e=>{var o;if(null!=e){o={};for(var n=0;n<e.data.length;n++){var i=t.createModel(e.data[n]),s=e.data[n].id;o[s]={},o[s].approvalStatus=i.model.Activity_State,o[s].approvalStatusModel=i,o[s].maturity=i.model.current,o[s].maturity_NLS=i.model.current_NLS}}a.publish("load-route-data",o)},e=>{})};return s={subscribeEvents:()=>r(),init:()=>(a=e.init(widget,{appIds:["ENOWCHG_AP","ENXWDOC_AP","ENOFOL3_AP"],open:!0}),void r())}}),define("DS/ENORouteMgmt/Views/Loader/InitiateRouteContentsLoader",["DS/ENORouteMgmt/Views/InitiateRouteContentsView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){"use strict";let o={};return{init:function(t){this.showView()||(o.container=new UWA.Element("div",{html:"",id:"InitiateRouteContentView",class:"route-initiate-contents-container"}),o.container.inject(document.querySelector("#iRouteTabsContainer")),e.build(o.container,t.contentIds,{scopeId:t.scopeId,scopePhyId:t.scopePhyId}))},hideView:function(){document.querySelector("#InitiateRouteContentView")&&document.querySelector("#InitiateRouteContentView").getChildren().length>0&&(document.getElementById("InitiateRouteContentView").style.display="none")},showView:function(){return!!(document.querySelector("#InitiateRouteContentView")&&document.querySelector("#InitiateRouteContentView").getChildren().length>0)&&(document.getElementById("InitiateRouteContentView").style.display="block",!0)},destroy:function(){o={},e.destroy()},getModel:function(){return e.getModel()}}}),define("DS/ENORouteMgmt/Views/Loader/InitiateRouteTasksLoader",["DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphEditView","DS/ENORouteMgmt/Model/InitiateRouteTaskModel","DS/ENORouteMgmt/Views/Panels/CreateTaskRightPanelSplitView","DS/Windows/ImmersiveFrame","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i){"use strict";let s,a={};return{init:function(t){if(!this.showView()){!function(){a.container=new UWA.Element("div",{html:"",id:"CreateTaskContainer",class:"create-task-graph-container"}),a.container.inject(document.querySelector("#iRouteTabsContainer")),a.graphContainer=new UWA.Element("div",{html:"",id:"CreateTaskContainerGraph",class:""}).inject(a.container);let e=(new o).getSplitView(widget.routeMgmtMediator.getEventBroker());(new o).setSplitviewEvents(e),e.getLeftViewWrapper().appendChild(a.graphContainer),s=(new o).getTokens();let t=new n;t.setContentInBackgroundLayer(e.getContent()),t.reactToPointerEventsFlag=!1,t.inject(a.container)}(),e.build(a.graphContainer);let i="create";e.initTaskGraphView(t,i)}},hideView:function(){document.querySelector("#CreateTaskContainer")&&document.querySelector("#CreateTaskContainer").getChildren().length>0&&(document.getElementById("CreateTaskContainer").style.display="none")},showView:function(){return!!(document.querySelector("#CreateTaskContainer")&&document.querySelector("#CreateTaskContainer").getChildren().length>0)&&(document.getElementById("CreateTaskContainer").style.display="block",!0)},destroy:function(){a={},t.destroy(!0),s&&s.open&&widget.routeMgmtMediator.unsubscribe(s.open),s&&s.close&&widget.routeMgmtMediator.unsubscribe(s.close);try{e.destroy()}catch(e){}},getModel:function(){return t.getTasksDataForCreation()}}}),define("DS/ENORouteMgmt/Views/ToggleViews",["DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView","DS/ENORouteMgmt/Views/Grid/RouteContentsDataGridView","DS/ENORouteMgmt/Views/Grid/RouteMembersDataGridView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n){"use strict";let i,s,a;return{doToggleView:function(r){switch(r.curPage){case"RouteSummary":i=".data-grid-container",s=".tile-view-container",a=e.getGridViewToolbar().getNodeModelByID("view");break;case"ContentsTab":i=".Contents-gridView-View",s=".Contents-tileView-View",a=t.getGridViewToolbar().getNodeModelByID("view");break;case"MembersTab":i=".Members-gridView-View",s=".Members-tileView-View",a=o.getGridViewToolbar().getNodeModelByID("view");break;default:Console.log("Incorrect arguments in config file.")}if(widget.setValue(r.curPage+"-ShowView",r.view),"GridView"==r.view)a.options.grid.data.menu[0].state="selected",a.options.grid.data.menu[1].state="unselected",a&&"view-list"!=a.options.grid.semantics.icon.iconName&&a.updateOptions({grid:{semantics:{icon:{iconName:"view-list"}}},tooltip:n.gridView}),(l=document.querySelector(i))&&(l.removeClassName("hideView"),l.removeClassName("nonVisible"),l.addClassName("showView")),(d=document.querySelector(s))&&(d.removeClassName("showView"),d.addClassName("hideView"));else if("TileView"==r.view){var l,d;a.options.grid.data.menu[0].state="unselected",a.options.grid.data.menu[1].state="selected",a&&"view-small-tile"!=a.options.grid.semantics.icon.iconName&&a.updateOptions({grid:{semantics:{icon:{iconName:"view-small-tile"}}},tooltip:n.tileView}),(l=document.querySelector(i))&&(l.removeClassName("showView"),l.addClassName("hideView")),(d=document.querySelector(s))&&(d.removeClassName("hideView"),d.addClassName("showView"))}}}}),define("DS/ENORouteMgmt/Views/Loader/TaskGraphicalViewLoader",["UWA/Drivers/Alone","DS/ENORouteMgmt/Views/RouteTasksView","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphView","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Model/RouteTaskModel","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","DS/Controls/Loader","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/egraph/views.css","css!DS/etree/syncviews.css","css!DS/etree/overviewui.css"],function(e,t,o,n,i,s,a,r,l){"use strict";let d,u;return{init:function(n,i){if(!this.showView()){d={},i?d.container=i:(d.container=e.createElement("div",{id:"routeGraphTaskContainer",class:"route-graph-task-container"}),d.container.inject(document.querySelector(".route-facets-container")));var a=this;return a.showProgressBar(),new Promise(function(e,i){s.fetchRouteTasks(n.model.id).then(function(i){let s={id:n.model.id,scopeId:""==n.model.Scope[0]?""==n.model.Scope[1]?n.model.Scope[2]:n.model.Scope[1]:n.model.Scope[0],routeBasePurpose:n.model.BasePurpose,chooseUserFromGroup:n.model.chooseUserFromGroup,model:n.model};n&&"Route Template"==n.model.Type&&(i.parentObjectType="Route Template"),a.updateModels(i,s),t.destroyContainer(),t.build(s,d.container),o.destroy(),o.build(d.container),o.initTaskGraphView(s,"view"),e()})}).then(()=>{a.hideProgressBar(),o.fitToWindowDefaultLoad()})}},updateModels:function(e,t){t.model&&(e=a.updateTaskEditSettings(e,t.model.taskEditSetting)),n.destroy();let o=n.getModel(e);o.options.routeId=t.id,o.options.routeInfoJSON=t,o.options.responseLength=e.length,i.destroy(),i.createModel(t),i.getModel().RouteId=t.id},hideView:function(){null!=document.getElementById("routeGraphTaskContainer")&&(document.getElementById("routeGraphTaskContainer").style.display="none")},showView:function(){return null!=document.getElementById("routeGraphTaskContainer")&&(document.getElementById("routeGraphTaskContainer").style.display="block",!0)},showProgressBar:function(){var e=document.getElementById("routeGraphTaskContainer");null!=e&&(u=(new r).inject(e)),u.elements.container.setStyle("margin-top","10%"),u.on(l.loading_label)},hideProgressBar:function(){u&&u.off(l.loading_label)},destroy:function(){d={}}}}),define("DS/ENORouteMgmt/Commands/RouteTaskView",["DS/ENORouteMgmt/Views/Panels/RouteTaskPanelSplitView","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphView","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Model/RouteTaskModel","DS/ENORouteMgmt/Views/RouteTasksView","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Components/Mediator","DS/ENORouteMgmt/Components/Notifications","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g,f){"use strict";let h={},w=function(e,n){var i,l,d,u;return new Promise(function(c,m){t.fetchRouteAndTaskByRouteId(e.id).then(t=>{l=(new a).parseResp(JSON.parse(t)),t=JSON.parse(t);var m={};m.data=t.data[0].relateddata.tasks,i=(new a).parseResp(m);var p={};p.data=t.data[0].relateddata.contents,u=(new a).parseResp(p);var g=t.data[0].relateddata.tasks;for(let e=0;e<i.length;e++){var f=[],w=!1;if(null!=g[e].relateddata.subroutes){for(var S=g[e].relateddata.subroutes[0].relateddata.route,y=0;y<S.length;y++)f.push(S[y].dataelements);f.length>0&&(w=!0)}var M="";w&&(M=g[e].relateddata.subroutes[0].dataelements.TaskApprovalStatus);var T=i[e].ContentToReviewIds,b=[];if(""!=T&&null!=T)for(var C=0;C<u.length;C++)T.includes(u[C].physicalid)&&b.push(u[C]);let t=[];for(let o=0;o<u.length;o++)0==u[o].relatedToTaskIds.length?t.push(u[o]):u[o].relatedToTaskIds.toString().includes(i[e].id)&&t.push(u[o]);i[e].routeContents=t,i[e].RouteTaskContentToReview=b,i[e].taskSubRoutes=f,i[e].subRouteApprovalStatus=M}var D={};D.model=r.gridData(l[0]);d={id:D.model.id,scopeId:""==D.model.Scope[0]?""==D.model.Scope[1]?D.model.Scope[2]:D.model.Scope[1]:D.model.Scope[0],routeBasePurpose:D.model.BasePurpose,chooseUserFromGroup:D.model.chooseUserFromGroup,model:D.model},R(e,h.container,n),v(i,d),s.destroyContainer(),s.build(d,h.graphContainer),o.destroy(),o.build(h.graphContainer),o.initTaskGraphView(d,"view"),c()},e=>{e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:f.errorFetchingRoute,sticky:!1})})}).then(()=>{o.fitToWindowDefaultLoad()})},v=function(e,t){t.model&&(e=g.updateTaskEditSettings(e,t.model.taskEditSetting)),n.destroy();let o=n.getModel(e);o.options.routeId=t.id,o.options.routeInfoJSON=t,o.options.responseLength=e.length,i.destroy(),i.createModel(t),i.getModel().RouteId=t.id},S=function(){let t=(new e).getSplitView(widget.routeMgmtMediator.getEventBroker());(new e).setSplitviewEvents(t),t.getLeftViewWrapper().appendChild(h.graphContainer);let o=new m;o.setContentInBackgroundLayer(t.getContent()),o.reactToPointerEventsFlag=!1,o.inject(h.container)},R=function(e,t,o){if("dialog"==e.renderType){S();let e=new m;e.inject(document.body);var n=f.taskPanelOpenWithHeader;new c({modalFlag:!0,width:1e3,height:1e3,title:n,content:t,immersiveFrame:e,resizableFlag:!0,buttons:{Cancel:new p({onClick:function(e){e.dsModel.dialog.close()}})}})}else"container"==e.renderType?o.appendChild(t):"containerWithSplitView"==e.renderType&&(S(),o.appendChild(t))};return{init:(e,o)=>(function(e,o){widget.notify=new u,l.start({id:widget.id}),widget.routeMgmtMediator=new d,widget.data.routeCredentials={securityContext:e.securityContext,tenant:e.tenant},h.container=new UWA.Element("div",{html:"",id:"viewTaskContainerExternal",class:"task-graph-container-external"}),h.graphContainer=new UWA.Element("div",{html:"",id:"viewTaskContainerGraphExternal",class:""}).inject(h.container),t.fetchAllowedContentTypesForRoute().then(t=>{let n=t.data[0].dataelements.routeDnDContentTypes;widget.setValue("routeContentDnDTypes",n);let i=t.data[0].dataelements.routeSearchContentTypes;widget.setValue("routeContentSearchTypes",i),w(e,o)},t=>{w(e,o)})})(e,o)}}),define("DS/ENORouteMgmt/ENORoutesWidgetInit",["UWA/Class","UWA/Class/Promise","UWA/Core","DS/ENORouteMgmt/Components/Mediator","DS/ENORouteMgmt/Components/Notifications","DS/ENORouteMgmt/Views/RouteHomeSplitView","DS/Windows/ImmersiveFrame","DS/ENORouteMgmt/Utilities/RouteWidgetUtil","DS/ENORouteMgmt/Views/RouteSummaryView","DS/ENORouteMgmt/Components/Wrappers/TriptychWrapper","DS/ENORouteMgmt/Views/Panels/WelcomePanel","DS/ENORouteMgmt/Components/RouteApplicationFrame","DS/ENORouteMgmt/Utilities/Utils","DS/ENORouteMgmt/Utilities/RouteLinkWidgetUtil","DS/ENORouteMgmt/Model/RouteModel","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g){"use strict";var f=null;return e.extend({name:"RouteManagement",onLoad:function(e){var t=this;widget.notify=new i,widget.routeMgmtMediator=new n,r.init().then(function(e){return t._initializeComponent({})}),p.init()},onRefresh:function(){var e=this;return new t(function(e,t){l.destroy(),null!=f&&f.destroy(),!0===widget.getValue("isDialogOpened")?widget.routeMgmtMediator.destroyAllButDialogEvents():(widget.routeMgmtMediator.destroy(),widget.routeMgmtMediator=new n),r.registerWidgetTitleEvents(),r.getTaskCustomFields(),widget.setValue("linkedContextTitle",void 0),widget.setValue("isWidgetRefreshed","true"),e()}).then(function(){return e._initializeComponent({})})},onEdit:function(e){r.onEdit(e)},endEdit:function(e){r.endEdit(e)},_initializeComponent:function(e){var n,i=null,r={};let l="DS/ENORouteMgmt/Views/RouteSummaryView";return r.id="routes","Route Template"==widget.data.contentType?(l="DS/ENORouteTemplateMgmt/Views/TemplateSummaryView",r.id="route_templates"):"route_templates"===widget.getValue("HomePage")&&(l="DS/ENORouteTemplateMgmt/Views/TemplateSummaryView",r.id="route_templates"),new t(function(e){require(["UWA/Core",l],function(t,o){n=o,o.build().then(function(t){i=t,e()})})}).then(function(){return new t(function(e,t){let l=(new s).getSplitView(widget.routeMgmtMediator.getEventBroker());(new s).setSplitviewEvents(l),l.getLeftViewWrapper().appendChild(i),f=new a;let d=o.createElement("div",{id:"routes-main-div",styles:{height:"100%"}}),u=o.createElement("div",{id:"routes-wc-panel",styles:{height:"100%"}}).inject(d),p=o.createElement("div",{id:"routes-right-panel",styles:{height:"100%"}}),h=new c;h.init(widget.routeMgmtMediator.getEventBroker(),null,d,u,l.getContent(),p),h.setTooltipForExpandCollapse(),f.setContentInBackgroundLayer(d),f.reactToPointerEventsFlag=!1,f.inject(widget.body);document.getElementsByClassName("toolbar-container")[0].getDimensions().height;if(document.getElementsByClassName("widget-container")[0].getChildren()[0].setStyle("top","50px"),n.openSelected(),h.showWelcomePanel(),widget.getValue("propWidgetOpen")&&(n.activateInfoIcon(),null==widget.getValue("routeIdToBePersisted")&&null==widget.getValue("templateIdToBePersisted")))if(null!=widget.getValue("right-panel-peristed-id")){let e=widget.getValue("right-panel-peristed-id"),t=void 0;if("Route"==e.type)(t=g.getRowModelById(e.id))&&t.select(!0);else if("Route Template"==e.type){require(["DS/ENORouteTemplateMgmt/Model/RouteTemplateModel"],function(o){(t=o.getRowModelById(e.id))&&t.select(!0)})}}else{let e="Routes";"route_templates"==r.id&&(e="Route Template"),m.refreshRightPanel(e)}widget.routeMgmtMediator.publish("route-welcome-panel-activity-selection",{id:r.id}),e()}).then(()=>{var e=document.querySelector("#dataGridDivToolbar .wux-controls-lineeditor .wux-controls-lineeditor-clearbutton");if(e){e.addEventListener("click",function(){if(null!=widget.data.contextTitle&&""!=widget.data.contextTitle){widget.data.contextTitle="";widget.routeMgmtMediator.publish("welcome-panel-action-selected",{id:"routes"})}}),e.addEventListener("touchend",function(){if(null!=widget.data.contextTitle&&""!=widget.data.contextTitle){widget.data.contextTitle="";widget.routeMgmtMediator.publish("welcome-panel-action-selected",{id:"routes"})}});var t=document.querySelector("#dataGridDivToolbar .wux-controls-lineeditor.wux-controls-lineeditor-width > input.wux-ui-state-undefined");t.addEventListener("change",function(){if(""==t.value){if(null!=widget.data.contextTitle&&""!=widget.data.contextTitle){widget.data.contextTitle="";widget.routeMgmtMediator.publish("welcome-panel-action-selected",{id:"routes"})}}else t.value=widget.data.contextTitle})}(widget.getValue("routefilters").indexOf("filterbyobject")>-1||null!=widget.data.linkedContextTitle)&&widget.routeMgmtMediator.publish("load-filterbyobject-search")})})}})}),define("DS/ENORouteMgmt/Utilities/PlaceHolder",["DS/Controls/Button","DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog","DS/ENORouteMgmt/Actions/ContentActions","DS/ENORouteMgmt/Views/Loader/InitiateRouteAddContentSearchLoader","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i){"use strict";let s=function(e,o){let n=e.getElement(".no-routes-to-show-container");if(e.querySelector(".tile-view-container").setStyle("display","none"),e.querySelector(".data-grid-container").setStyle("display","none"),null!==n)return widget.routeMgmtMediator.publish("route-back-to-summary"),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:o}),n;var s=UWA.createElement("span",{class:"no-routes-to-show-filter-shortcut fonticon fonticon-list-filter",title:i.filter}),a=UWA.createElement("span",{class:"no-routes-to-show-create-shortcut fonticon fonticon-plus",title:i.newRoute}),r=UWA.createElement("div",{class:"no-routes-to-show-container",html:[UWA.createElement("div",{class:"no-routes-to-show",html:[UWA.createElement("div",{class:"pin",html:'<span class="fonticon fonticon-5x fonticon-route"></span>'}),UWA.createElement("span",{class:"no-routes-to-show-label",html:i.titles.placeholder.label}),UWA.createElement("div",{class:"no-routes-to-show-sub-container",html:UWA.createElement("span",{html:i.replace(i.titles.placeholder.sub,{filter:s.outerHTML,create:a.outerHTML})})})]})]});r.getElement(".no-routes-to-show-filter-shortcut").addEventListener("click",function(){document.querySelector(".widget-container").getElementsByClassName("wux-button-icon-fi wux-ui-genereatedicon-fi wux-ui-3ds wux-ui-3ds-list-filter wux-ui-3ds-lg")[0].click()}),r.getElement(".no-routes-to-show-create-shortcut").addEventListener("click",function(){t.InitiateRouteDialog()}),e.appendChild(r),widget.routeMgmtMediator.publish("route-back-to-summary"),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:o})},a=function(e){let t=e.getElement(".no-routes-to-show-container");null!==t&&(e.querySelector(".tile-view-container").removeAttribute("style"),e.querySelector(".data-grid-container").removeAttribute("style"),t.destroy())},r=function(t,n){let s=t.getElement(".no-contents-to-show-container");if(t.querySelector(".Contents-tileView-View").setStyle("display","none"),t.querySelector(".Contents-gridView-View").setStyle("display","none"),null!==s)return t.querySelector(".no-contents-to-show-container").removeAttribute("style"),s;let a="";a=n?UWA.createElement("div",{class:"no-contents-to-show-container",html:[UWA.createElement("div",{class:"no-contents-to-show",html:[UWA.createElement("span",{class:"no-contents-to-show-label",html:i.emptyiRouteContentsLabelwithoutButton})]})]}):UWA.createElement("div",{class:"no-contents-to-show-container",html:[UWA.createElement("div",{class:"no-contents-to-show",html:[UWA.createElement("span",{class:"no-contents-to-show-label",html:i.emptyiRouteContentsLabel}),UWA.createElement("div",{class:"no-contents-to-show-sub-container",html:new e({disabled:!1,emphasize:"primary",label:i.addExistingContent,allowUnsafeHTMLLabel:!0,onClick:function(e){o.onSearchClick()}})})]})]}),t.appendChild(a)},l=function(e){null!==e.getElement(".no-contents-to-show-container")&&(e.querySelector(".Contents-tileView-View").removeAttribute("style"),e.querySelector(".Contents-gridView-View").removeAttribute("style"),e.querySelector(".no-contents-to-show-container").setStyle("display","none"))},d=function(t){let o=t.getElement(".no-icontents-to-show-container");if(t.querySelector(".iContents-gridView-View").setStyle("display","none"),null!==o)return t.querySelector(".no-icontents-to-show-container").removeAttribute("style"),o;let s=UWA.createElement("div",{class:"no-icontents-to-show-container",html:[UWA.createElement("div",{class:"no-icontents-to-show",html:[UWA.createElement("span",{class:"no-icontents-to-show-label",html:i.emptyiRouteContentsLabel}),UWA.createElement("div",{class:"no-icontents-to-show-sub-container",html:new e({disabled:!1,emphasize:"primary",label:i.addExistingContent,allowUnsafeHTMLLabel:!0,onClick:function(e){n.onSearchClick()}})})]})]});t.appendChild(s)},u=function(e){if(null===e)return;null!==e.getElement(".no-icontents-to-show-container")&&(e.querySelector(".iContents-gridView-View").removeAttribute("style"),e.querySelector(".no-icontents-to-show-container").setStyle("display","none"))},c=function(e){let t=e.querySelector(".generic-error-container");if(e.querySelector(".tile-view-container")&&e.querySelector(".tile-view-container").setStyle("display","none"),e.querySelector(".data-grid-container")&&e.querySelector(".data-grid-container").setStyle("display","none"),e.querySelector("#dataGridDivToolbar")&&e.querySelector("#dataGridDivToolbar").setStyle("display","none"),e.querySelector("#TemplatedataGridDivToolbar")&&e.querySelector("#TemplatedataGridDivToolbar").setStyle("display","none"),e.querySelector("#TemplatedataGridDivToolbar")&&e.querySelector("#TemplatedataGridDivToolbar").setStyle("display","none"),null===t){var o=UWA.createElement("div",{class:"generic-error-container",html:[UWA.createElement("div",{class:"generic-error",html:[UWA.createElement("span",{class:"generic-error-label",html:i.loading})]})]});e.appendChild(o)}else t.removeAttribute("style")};return{hideEmptyRoutePlaceholder:e=>a(e),showEmptyRoutePlaceholder:(e,t)=>s(e,t),hideEmptyContentPlaceholder:e=>l(e),showEmptyContentPlaceholder:(e,t)=>r(e,t),hideEmptyTasksPlaceholder:(e,t)=>(function(e,t){let o=e.getElement(".no-tasks-to-show-container");if(null!==o){if(e.querySelector(".canvas").removeAttribute("style"),"createMode"!=t&&e.querySelector(".Tasks-gridView-View")){let t=e.querySelector(".Tasks-gridView-View");t.className.contains("showView")&&(t.addClassName("task-grid-container-edit-mode"),widget.routeMgmtMediator.publish("show-plus-icon-in-tasks-toolbar"),widget.routeMgmtMediator.publish("show-remove-icon-in-tasks-toolbar")),t.removeAttribute("style")}e.querySelector("#task-graph-toolbar")&&e.querySelector("#task-graph-toolbar").removeAttribute("style"),o.destroy(),"EditMode"==t&&e.setStyle("position","")}})(e,t),showEmptyTasksPlaceholder:(t,o)=>(function(t,o){let n=t.getElement(".no-tasks-to-show-container");if("EditMode"==o&&t.setStyle("position","absolute"),t.querySelector(".canvas").setStyle("display","none"),"createMode"!=o&&t.querySelector(".Tasks-gridView-View")&&(t.querySelector(".Tasks-gridView-View").setStyle("display","none"),t.querySelector(".Tasks-gridView-View").removeClassName("task-grid-container-edit-mode")),t.querySelector("#task-graph-toolbar")&&t.querySelector("#task-graph-toolbar").setStyle("display","none"),null!==n)return n;let s=UWA.createElement("div",{class:"no-tasks-to-show-container "+o,html:[UWA.createElement("div",{class:"no-tasks-to-show",html:[UWA.createElement("span",{class:"no-tasks-to-show-label",html:i.emptyTaskLabel}),UWA.createElement("div",{class:"no-tasks-to-show-sub-container",html:new e({disabled:!1,emphasize:"primary",label:i.addTask,allowUnsafeHTMLLabel:!0,onClick:function(e){"createMode"==o?widget.routeMgmtMediator.publish("redraw-graph-create",{graphMode:o}):"EditMode"==o&&(widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:"view"}),widget.routeMgmtMediator.publish("redraw-graph-edit",{graphMode:o}))}})})]})]});t.appendChild(s)})(t,o),showEmptyInitiateRouteContentPlaceholder:e=>d(e),hideEmptyInitiateRouteContentPlaceholder:e=>u(e),showeErrorPlaceholder:e=>c(e),hideeErrorPlaceholder:e=>(function(e){let t=e.getElement(".generic-error-container");null!==t&&t.setStyle("display","none")})(e),registerListeners:()=>(widget.routeMgmtMediator.subscribe("show-no-route-placeholder",function(e){s(document.querySelector(".widget-container"),e)}),widget.routeMgmtMediator.subscribe("hide-no-route-placeholder",function(e){a(document.querySelector(".widget-container"))}),widget.routeMgmtMediator.subscribe("hide-no-content-placeholder",function(e){l(document.querySelector(".route-contents-container"))}),widget.routeMgmtMediator.subscribe("show-no-content-placeholder",function(e){r(document.querySelector(".route-contents-container"))}),widget.routeMgmtMediator.subscribe("hide-no-iRoutecontent-placeholder",function(e){u(document.querySelector(".dataGrid-button-container"))}),widget.routeMgmtMediator.subscribe("show-no-iRoutecontent-placeholder",function(e){d(document.querySelector(".dataGrid-button-container"))}),void widget.routeMgmtMediator.subscribe("show-generic-error-placeholder",function(e){c(document.querySelector(".widget-container"))}))}}),define("DS/ENORouteMgmt/Model/InitiateRouteContentModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a){"use strict";let r=new e,l=function(e){return new t({label:e.title,id:e.id,width:300,dataIndex:"tree",grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,Creation_Date:e.created,Modified_Date:e.modified,Owner:e.owner,current:e.current,RouteBaseState:e.RouteBaseState,RouteBaseState_NLS:e.RouteBaseState_NLS,maturityBlockingStates:e.maturityBlockingStates,maturityTargetStates:e.maturityTargetStates,RouteTargetState:e.RouteTargetState,RouteTargetState_NLS:e.RouteTargetState_NLS,BlockingMaturityMenu:o.getMaturityMenuForGrid(e,"InitiateRoute"),TargetMaturityMenu:s.getTargetMenuForGrid(e,"InitiateRoute"),routeTask:null!=e.routeTask?e.routeTask:a.allTasks,associatedto:null!=e.associatedto?e.associatedto:"Route"},icons:[e.type_icon_url]})},d=function(e){return new t({label:e.title,id:e.id,width:300,dataIndex:"tree",grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,Creation_Date:e.created,Modified_Date:e.modified,Owner:e.owner,current:e.current,RouteBaseState:e.RouteBaseState,RouteBaseState_NLS:e.RouteBaseState_NLS,maturityBlockingStates:e.maturityBlockingStates,maturityTargetStates:e.maturityTargetStates,RouteTargetState:e.RouteTargetState,RouteTargetState_NLS:e.RouteTargetState_NLS,BlockingMaturityMenu:o.getMaturityMenuForGrid(e,"InitiateRoute"),TargetMaturityMenu:s.getTargetMenuForGrid(e,"InitiateRoute"),routeTask:null!=e.routeTask?e.routeTask:a.allTasks,associatedto:null!=e.associatedto?e.associatedto:"Route"},icons:[e.typeicon]})},u=function(){if(null!=r){for(var e=r.getChildren(),t=[],o=0;o<e.length;o++)t.push(e[o]._options.grid.id);return t}},c=function(e){return i.getRowModelById(r,e)},m=function(){widget.routeMgmtMediator.publish("task-associated-content-update")},p=function(e,t){r.prepareUpdate(),c(t).updateOptions({grid:{routeTask:e}}),r.pushUpdate()};return{createModel:e=>(function(e){return r.prepareUpdate(),e&&e.forEach(function(e){var n=new t({label:e.name,width:300,dataIndex:"tree",grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,Creation_Date:e.created,Modified_Date:e.modified,Owner:e.owner,current:e.current,maturityBlockingStates:e.stateNLS,maturityTargetStates:e.maturityTargetStates,RouteBaseState:e.RouteBaseState,RouteBaseState_NLS:e.RouteBaseState_NLS,RouteTargetState:e.RouteTargetState,RouteTargetState_NLS:e.RouteTargetState_NLS,BlockingMaturityMenu:o.getMaturityMenuForGrid(e,"InitiateRoute"),TargetMaturityMenu:s.getTargetMenuForGrid(e,"InitiateRoute"),routeTask:null!=e.routeTask?e.routeTask:a.allTasks,associatedto:"Route"},icons:[e.type_icon_url]});r.addRoot(n)}),r.pushUpdate(),e&&m(),r})(e),getModel:()=>r,appendRow:(e,t,o)=>(function(e,t,o){var n=[];r.prepareUpdate(),e.forEach(function(e){let i;null==e.associatedto&&(e.associatedto=null==o?"Route":o),i=t?d(e):l(e);var s=e.id+"~"+e.title;n.push(s),r.addRoot(i)}),r.pushUpdate(),0!=r.getChildren().length&&widget.routeMgmtMediator.publish("hide-no-iRoutecontent-placeholder"),m()})(e,t,o),getContentIDs:()=>u(),getRouteContentIds:()=>(function(){var e=[];if(null!=r)for(var t=r.getChildren(),o=0;o<t.length;o++)"Route"==t[o]._options.grid.associatedto&&e.push(t[o]._options.grid.id);return e})(),deleteSelectedRows:()=>(function(){var e=r.getSelectedNodes(),t=[];r.prepareUpdate();for(var o=0;o<e.length;o++)r.removeRoot(e[o]),t.push(e[o].options.id);r.pushUpdate(),0==r.getChildren().length&&widget.routeMgmtMediator.publish("show-no-iRoutecontent-placeholder");var n=u();widget.routeMgmtMediator.publish("clearContentToReview-on-ContentRemoval",n),m()})(),deleteAllRows:()=>(function(){r.prepareUpdate(),r.removeRoots(),r.pushUpdate(),0==r.getChildren().length&&widget.routeMgmtMediator.publish("show-no-iRoutecontent-placeholder");var e=u();widget.routeMgmtMediator.publish("clearContentToReview-on-ContentRemoval",e),m()})(),getSelectedRowsModel:()=>i.getSelectedRowsModel(r),destroy:()=>{r=new e},getRowModelById:e=>c(e),getRouteContentModel:()=>(function(){if(null!=r){let o=new e;return o.prepareUpdate(),r.getChildren().forEach(function(e){if("Route"==e._options.grid.associatedto){var n=new t({label:e.options.grid.Title,width:300,dataIndex:"tree",grid:{id:e.options.id,Title:e.options.grid.Title,Name:e.options.grid.Name},icons:e.options.icons});o.addRoot(n)}}),o}})(),getRowContentByTaskId:t=>(function(t){if(null!=r){let t=new e;for(var o=r.getChildren(),n=0;n<o.length;n++)"Route"==o[n]._options.grid.associatedto&&t.addRoot(root);return t}})(),updateRowModel:(e,t)=>(function(e,t,o){r.prepareUpdate(),t.forEach(t=>{let n,i=c(t),s=i.options.grid.routeTask;o||(n=s==a.allTasks?e:i.options.grid.routeTask+","+e),i.updateOptions({grid:{routeTask:n}})}),r.pushUpdate()})(e,t),deleteRowModelById:e=>(function(e){i.deleteRowModelById(r,e),0==r.getChildren().length&&widget.routeMgmtMediator.publish("show-no-iRoutecontent-placeholder")})(e),updateRelatedToForContents:()=>{require(["DS/ENORouteMgmt/Model/InitiateRouteTaskModel"],function(e){var t=u();let o=[];e.getTaskTreeDocument().getAllDescendants().forEach(e=>{if(e.tileView){let t=e.options.grid;t.validTaskData&&o.push(t)}});for(let e=0;e<t.length;e++){let n="";for(let i=0;i<o.length;i++){let s=o[i].contentToReviewFieldInfo;if(s&&s&&s.length>0)for(let a=0;a<s.length;a++){let r=s[a].id;t[e]==r&&(n=""==n?o[i].title:n+","+o[i].title)}}""!=n&&p(n,t[e])}})},updateRelatedToTitle:(e,t)=>p(e,t)}}),define("DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/PlaceHolder","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s){"use strict";let a=new e;return{createModel:(e,o)=>(function(e,o){return a.prepareUpdate(),e.forEach(function(e){var o=new t({label:e.title,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,canDeleteContent:e.canDeleteContent},thumbnail:e.image,subLabel:e.stateNLS,icons:[e.typeicon],description:e.modified,contextualMenu:["My context menu"]});a.addRoot(o)}),a.pushUpdate(),a})(e),getModel:()=>a,getSelectedRowsModel:()=>o.getSelectedRowsModel(a),getContentIDs:()=>(function(){if(null!=a){for(var e=a.getChildren(),t=[],o=0;o<e.length;o++)t.push(e[o]._options.grid.id);return t}})(),destroy:()=>{a=new e},appendRows:e=>(function(e){a.prepareUpdate(),e.forEach(e=>{var o=new t({label:e["ds6w:label"],id:e.id,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,canDeleteContent:e.canDeleteContent},thumbnail:e.preview_url,subLabel:e["ds6w:status"],description:e["ds6w:modified"],contextualMenu:["My context menu"],icons:[e.type_icon_url]});a.addRoot(o)}),a.pushUpdate()})(e),deleteSelectedRows:()=>(function(){var e=a.getSelectedNodes();a.prepareUpdate();for(var t=0;t<e.length;t++)a.removeRoot(e[t]);if(a.pushUpdate(),0==a.getChildren().length){var o=document.querySelector(".routeTaskContentToReview-gridView-View");o&&o.addClassName("hideView")}})()}}),define("DS/ENORouteMgmt/Model/TaskAttachmentModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/PlaceHolder","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s){"use strict";let a=new e,r=!1;return{createModel:(e,o)=>(function(e,o){return a.prepareUpdate(),e.forEach(function(e){var o=new t({label:e.title,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,canDeleteContent:e.canDeleteContent},thumbnail:e.image,subLabel:e.stateNLS,icons:[e.typeicon],description:e.modified,contextualMenu:["My context menu"]});a.addRoot(o)}),a.pushUpdate(),a})(e),getModel:()=>a,getSelectedRowsModel:()=>o.getSelectedRowsModel(a),getContentIDs:()=>(function(){if(null!=a){for(var e=a.getChildren(),t=[],o=0;o<e.length;o++)t.push(e[o]._options.grid.id);return t}})(),destroy:()=>{a=new e},appendRows:e=>(function(e){a.prepareUpdate(),e.forEach(e=>{var o=new t({label:e["ds6w:label"],id:e.id,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,canDeleteContent:e.canDeleteContent},thumbnail:e.preview_url,subLabel:e["ds6w:status"],description:e["ds6w:modified"],contextualMenu:["My context menu"],icons:[e.type_icon_url]});a.addRoot(o)}),a.pushUpdate()})(e),deleteSelectedRows:()=>(function(){var e=a.getSelectedNodes();a.prepareUpdate();for(var t=0;t<e.length;t++)a.removeRoot(e[t]);if(a.pushUpdate(),0==a.getChildren().length){var o=document.querySelector(".taskAttachments-gridView-View");o&&o.addClassName("hideView")}r=!0})(),getAttachmentRemovalStatus:e=>(function(e){return"reset"==e&&(r=!1),r})(e)}}),define("DS/ENORouteMgmt/Views/Form/TaskViewUtil",["DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Controller/CollabTaskServicesController","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Utilities/RouteRefreshUtils","DS/ENORouteMgmt/Views/Form/FormValidation","DS/ENORouteMgmt/Views/Form/CustomFieldUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","DS/ENXESignature/Views/Dialogs/ESignatureAuthDialog","DS/DocumentManagement/DocumentManagement","DS/Windows/ImmersiveFrame","DS/ENORouteMgmt/Model/TaskAttachmentModel","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Utilities/Utils","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Controller/RouteESignServicesController","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g,f,h,w){"use strict";let v=!1,S={canUserEditTask:function(e){return"Complete"!=e.model.current},canUserEditAllFields:function(e){return"Inbox Task"!=e.model.type},canUserReview:function(e,t){return!(!T(e.model.taskDetails)||"Inbox Task"!=e.model.type||"Yes"!=e.model.needsOwnerReview||"Review"!=e.model.current||"Started"!=t.Route_Status)},canUserCompleteTask:function(e,t){return"Notify Only"!=e.model.taskAction&&"Assigned"==e.model.current&&"Inbox Task"==e.model.type&&"Started"==t.Route_Status&&e.model.taskAssigneeUsername==n.getLoginUser()},canLoadInViewMode:function(e,t){return"Route Template"!=t.Type&&null!=t.taskEditSetting&&"Modify/Delete Task List"!=t.taskEditSetting&&("Yes"==e.model.templateTask||"Yes"==e.model.isInitialTask&&null==t.templateTaskEditSetting)},isInboxTask:function(e){return"Inbox Task"==e.model.type},dueDateViewMode:function(e,t){var o="";if(e.model.assigneeSetDueDate&&"Yes"==e.model.assigneeSetDueDate)if(e.model.taskDueDate&&""!=e.model.taskDueDate){let t=new Date(e.model.taskDueDate);o=t=g.getLocaleTime(t,!0)}else o=l.assigneeSetDueDate;else if(e.model.taskDueDate&&""!=e.model.taskDueDate){let t=new Date(e.model.taskDueDate);o=t=g.getLocaleTime(t,!0)}else if(e.model.dueDateOffset&&""!=e.model.dueDateOffset){var n=l.dueDateTextStartsFrom;"1"==e.model.dueDateOffset&&(n=l.dueDateTextStartFrom),o=e.model.dueDateOffset+" "+n+" ",e.model.dateOffsetFrom&&"Task Create Date"==e.model.dateOffsetFrom?o+=l.dueDateFromPriorTask:o+=l.dueDateFromRouteStart}else o=t=g.getLocaleTime(t,!0);return o},expectedActionElemList:function(e,t){return"Approval"==e?[{labelItem:l.approve,valueItem:"Approve"}]:"Review"==e?[{labelItem:l.Comment,valueItem:"Comment"}]:[{labelItem:l.approve,valueItem:"Approve"},{labelItem:l.notifyOnly,valueItem:"Notify Only"},{labelItem:l.Comment,valueItem:"Comment"}]},canPerformTaskAction:function(e){for(var t=0;t<e.length;t++){if(e[t].indexOf("canPerformTaskAction")>-1)return"true"==e[t].split("~")[1]}return!1},taskReviewUpdate:function(e,n,i){var a=n.autoCompleteComponent,r=CKEDITOR.instances.ckeditorTaskReviewComment.getData().replace(/<br\s*[\/]?>/gi," ").replace(/[\n\r]/g," ").replace(/&nbsp;/g," ").replace(/\s+/g," "),d=CKEDITOR.instances.ckeditorTaskReviewComment.editable().getText();if(""==r.trim()||""==d.trim())return void widget.notify.handler().addNotif({level:"error",subtitle:l.errorTaskReviewComment,sticky:!1});e.model.reviewersComments=CKEDITOR.instances.ckeditorTaskReviewComment.getData(),e.model.taskReviewButton=n.elements.taskReviewButtons.value;var u=l.successReviewTaskPromote,c=l.failReviewTask,m=l.failUpload,p=l.failAttachment;"demote"==e.model.taskReviewButton&&(u=l.successReviewTaskDemote);var g=[];let f=[],h=[],w=[];null!=a&&null!=a.selectedItems&&0!=a.selectedItems.length&&a.selectedItems.forEach(function(e){if(e.options.grid&&"upload"==e.options.grid.action)g.push(e.options.value);else{let t={};t.id=e.options.value,t.updateAction="CONNECT",f.push(t),h.push(e.options.value)}}),V(e,f,w),n.elements.taskReviewButtons.elements.container.dsModel.disabled=!0,n.elements.taskReviewButtons.actionOnClickFlag=!1,I(g,e.model.id).then(r=>{var l=r;null!=r&&0!=r.length&&r.forEach(function(e){let t={};t.id=e.data[0].id,t.updateAction="CONNECT",f.push(t)}),t.updateTaskAttachment(e,f).then(r=>{o.updateReviewComment(e,i,a).then(t=>{widget.notify.handler().addNotif({level:"success",subtitle:u,sticky:!1}),s.refreshRouteData(i),widget.routeMgmtMediator.publish(n.closeEventName),widget.routeMgmtMediator.publish("task-action-on-save",e),f&&0!=f.length&&widget.routeMgmtMediator.publish("content-summary-update")},o=>{n.elements.taskReviewButtons.elements.container.dsModel.disabled=!1,n.elements.taskReviewButtons.actionOnClickFlag=!0,null!=l&&U(l),null!=h&&x(h,e.model.id),null!=w&&w.length>0&&t.updateTaskAttachment(e,w),o.error?widget.notify.handler().addNotif({level:"error",title:c,message:o.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:c,sticky:!1})})},e=>{n.elements.taskReviewButtons.elements.container.dsModel.disabled=!1,n.elements.taskReviewButtons.actionOnClickFlag=!0,null!=l&&U(l),e.error?widget.notify.handler().addNotif({level:"error",title:p,message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:p,sticky:!1})})},e=>{n.elements.taskReviewButtons.elements.container.dsModel.disabled=!1,n.elements.taskReviewButtons.actionOnClickFlag=!0,e&&e.result&&U(e.result),e.error?widget.notify.handler().addNotif({level:"error",title:m,message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:m,sticky:!1})})},taskAccept:function(e,o,n){t.acceptTask(e).then(t=>{widget.notify.handler().addNotif({level:"success",message:l.acceptTaskSuccess,sticky:!1}),s.refreshRouteData(o),widget.routeMgmtMediator.publish("task-action-on-save",e),widget.routeMgmtMediator.publish("route-task-on-change-assignee",e)},e=>{e.error?widget.notify.handler().addNotif({level:"error",message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",message:l.acceptTaskError,sticky:!1})})},taskActionUpdate:function(e,o,i){var s=CKEDITOR.instances.ckeditorTaskComment.getData().replace(/<br\s*[\/]?>/gi," ").replace(/[\n\r]/g," ").replace(/&nbsp;/g," ").replace(/\s+/g," "),r=CKEDITOR.instances.ckeditorTaskComment.editable().getText();if(""==s.trim()||""==r.trim())return widget.notify.handler().addNotif({level:"error",subtitle:l.errorTaskComment,sticky:!1}),void CKEDITOR.instances.ckeditorTaskComment.container.$.focus();if(M(o)){if(3==o.elements.dueDateOptionSelected&&(e.model.taskDueDate=o.elements.taskActionDueDate.value),e.model.dueDateOptionSelected=o.elements.dueDateOptionSelected,e.model.comments=CKEDITOR.instances.ckeditorTaskComment.getData(),e.model.taskActionButton=o.elements.taskActionButtons.value,a.validateCustomAttrInfo(e,o)){N(e,o);var u=l.taskSave,c=l.taskSaveError,m=l.failUpload,p=l.failAttachment;if("saveForLater"!=e.model.taskActionButton&&("Yes"==e.model.needsOwnerReview?(u=l.taskSentForReview,c=l.taskSentForReviewError):(u=l.taskCompleted,c=l.taskCompletedError)),"Approve"!=e.model.taskActionButton&&"Reject"!=e.model.taskActionButton&&"Abstain"!=e.model.taskActionButton||"True"!=i.requiresEsign)v(e,i,o.autoCompleteComponent);else{var g,f;f=n.getTenantValue();var h=o.elements.assignee.selectedItems&&o.elements.assignee.selectedItems.options.name?o.elements.assignee.selectedItems.options.name:"",w=e.model.taskActionButton;"Reject"==w&&(w="Disapprove"),g={eSignPolicyReference:"ESignConfigRoute",Username:h,x3dPlatformId:f,ObjectActionType:w},d.init(g).subscribe("ESign-Authenticated",function(t){console.log("ESign-Validated Success "+t.ESignRecordId);let n=t.ESignRecordId;e.model.eSignRecordId=n,v(e,i,o.autoCompleteComponent)})}}}else o.elements.taskActionDueDate.elements.inputField.elements.inputField.focus();function v(e,n,i){var s=[];let a=[],r=[],l=[];null!=i&&null!=i.selectedItems&&0!=i.selectedItems.length&&i.selectedItems.forEach(function(e){if(e.options.grid&&"upload"==e.options.grid.action)s.push(e.options.value);else{let t={};t.id=e.options.value,t.updateAction="CONNECT",a.push(t),r.push(e.options.value)}}),V(e,a,l),o.elements.taskActionButtons.elements.container.dsModel.disabled=!0,o.elements.taskActionButtons.actionOnClickFlag=!1,I(s,e.model.id).then(i=>{var s=i;null!=i&&0!=i.length&&i.forEach(function(e){let t={};t.id=e.data[0].id,t.updateAction="CONNECT",a.push(t)}),"saveForLater"==e.model.taskActionButton?F(e,n,a,u,o,c,s):t.updateTaskAttachment(e,a).then(t=>{F(e,n,a,u,o,c,s,r,l)},e=>{o.elements.taskActionButtons.elements.container.dsModel.disabled=!1,o.elements.taskActionButtons.actionOnClickFlag=!0,null!=s&&U(s),e.error?widget.notify.handler().addNotif({level:"error",title:p,message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:p,sticky:!1})})},e=>{o.elements.taskActionButtons.elements.container.dsModel.disabled=!1,o.elements.taskActionButtons.actionOnClickFlag=!0,e&&e.result&&U(e.result),e.error?widget.notify.handler().addNotif({level:"error",title:m,message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:m,sticky:!1})})}},launchAssignmentScopeSearch:function(t,o,i,s){var a=t.dsModel,r=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],function(t){var l=t.createSocket({socket_id:r}),d=e.getRefinementToSnN(r,"searchScopeAssignment",!1,["User Group"]);if("OnPremise"!=n.getTenantValue()){var u=["usersgroup"];d.source=u}else{u=["3dspace"];d.source=u}var c=e.getPrecondForRouteOwnerAssignmentScope(i);if(d.precond=c.precond,d.resourceid_in=c.resourceid_in,!UWA.is(l))throw new Error("Socket not initialized");l.dispatchEvent("RegisterContext",d),l.addListener("Selected_Objects_search",b.bind(a,o,s,i)),l.dispatchEvent("InContextSearch",d)})},launchAssigneeSearch:(e,t,o,n)=>_(e,t,o,n),clearAssigneeFields:function(e){e.elements.assignee.selectedItems=void 0,e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="none")},updateContentToReviewFieldOnContentRemoval:function(e,t){var o=[];if(null!=t&&e.contentToReviewField&&null!=e.contentToReviewField.selectedItems){for(var n=0;n<e.contentToReviewField.selectedItems.length;n++)-1!=t.indexOf(e.contentToReviewField.selectedItems[n].options.value)&&o.push(e.contentToReviewField.selectedItems[n]);e.contentToReviewField.selectedItems=o,e.contentToReviewField._applySelectedItems()}},changeHandlerForAssigneeField:function(e,t,o){var n=!1;v?v=!1:(e.elements.assignee.selectedItems&&e.elements.assignee.selectedItems.options?e.elements.assignee._editor.elements.inputField.value==e.elements.assignee.selectedItems.options.label&&("Person"==e.elements.assignee.selectedItems.options.type?t&&"Route Template"==t.Type?"True"!=t.chooseUserFromGroup&&"True"!=t.selectUsersFromUserGroup||e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="none",e.elements.chooseUsersFromUg.checkFlag=!1):o.options.grid.chooseUsersFromUg&&"True"==o.options.grid.chooseUsersFromUg&&e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="none"):(e.elements.assignee.selectedItems.options.label.includes("(User Group)")||(e.elements.assignee.selectedItems.options.label=e.elements.assignee.selectedItems.options.label+"("+l.UserGroup+")",n=!0),t&&"Route Template"==t.Type?"True"!=t.chooseUserFromGroup&&"True"!=t.selectUsersFromUserGroup||e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="",e.elements.chooseUsersFromUg.checkFlag=!0):"True"!=t.chooseUserFromGroup&&"True"!=t.selectUsersFromUserGroup||!o.options.grid.chooseUsersFromUg||"True"==o.options.grid.chooseUsersFromUg&&e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="")),"Person"!=e.elements.assignee.selectedItems.options.type&&(e.elements.assignee.selectedItems.options.type="Group")):e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="none"),n&&(v=!0,e.elements.assignee._applySelectedItems()))},validationForAssigneeField:e=>L(e),updateInitiateRouteContentViewOnNodeRemoval:(e,t)=>W(e,t),taskDataSave:function(e,t,o,n,i){var s=!1;if("taskEditMode"==t&&!n.options.grid.graphNode){s=!0;let t=p.getTaskTreeDocument().getChildren();if(t)for(let o=1;o<t.length-1;o++){let i=t[o].getAllDescendants();if(i)for(let t=0;t<i.length;t++){i[t].options.grid;if(i[t]._id==n.options.graphNodeId){e={model:(n=i[t]).options.grid};break}}}}if(""==o.elements.title.value.trim())return widget.notify.handler().addNotif({level:"error",subtitle:l.errorTitle,sticky:!1}),void o.elements.title.elements.inputField.focus();if(""==o.elements.instruction.value.trim())return widget.notify.handler().addNotif({level:"error",subtitle:l.errorInstructions,sticky:!1}),void o.elements.instruction._myInput.focus();if(y(o,n,i)){if(!(null!=o.elements.assignee.selectedItems&&null!=o.elements.assignee.selectedItems.options.value||"Route Template"==i.Type&&o.elements.radioAssigneeRouteOwner.checked))return widget.notify.handler().addNotif({level:"error",subtitle:l.errorTaskAssignee,sticky:!1}),void o.elements.assignee._editor.elements.inputField.focus();if("Route Template"!=i.Type||!o.elements.radioAssigneeRouteOwner.checked||""==o.elements.assignmentScope.selectedItems||null==o.elements.assignmentScope.selectedItems||""==o.elements.assignmentScope.selectedItems.options.label||null==o.elements.assignmentScope.selectedItems.options.label||""!=o.elements.assignmentScope.selectedItems.options.value&&null!=o.elements.assignmentScope.selectedItems.options.value){if(!R(o,n,i))return o.elements.radioDueDateOption1.checked&&o.elements.radioDueDateOption1Date.elements.inputField._myInput.focus(),void(o.elements.radioDueDateOption2.checked&&o.elements.radioDueDateOption2DaysFrom.elements.inputField.focus());var r={};if(r.tasks=n,o.currentValue.order!=o.elements.order.value&&(r.orderInfo={orderUpdated:!0,oldOrder:o.currentValue.order,newOrder:o.elements.order.value}),o.elements.assignee.selectedItems&&o.elements.assignee.selectedItems.options.value&&o.currentValue.assigneeId!=o.elements.assignee.selectedItems.options.value&&(r.assignee={assigneeUpdated:!0,oldId:o.currentValue.assigneeId,newId:o.elements.assignee.selectedItems.options.value}),"create"==t)D(e,o,i),widget.routeMgmtMediator.publish(o.closeEventName),widget.routeMgmtMediator.publish("task-create-on-save",r),"Route Template"==i.Type?widget.routeMgmtMediator.publish("initiate-template-toggle-dialogbuttons",{tasks:e}):(widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons",{tasks:e}),P(e));else if("taskEditMode"==t){if(D(e,o,i),!a.validateCustomAttrInfo(e,o))return;N(e,o),widget.routeMgmtMediator.publish(o.closeEventName),widget.routeMgmtMediator.publish("task-edit-on-save",r),s&&widget.routeMgmtMediator.publish("update-Route-Task-Model",r)}}else widget.notify.handler().addNotif({level:"error",subtitle:l.errorAssignmentScope,sticky:!1})}else o.elements.order.elements.inputField.focus()},enableDisableDueDateOptions:function(e,t){1==e?(t.elements.dueDateOptionSelected=1,t.elements.radioDueDateOption1Date.disabled=!1,t.elements.radioDueDateOption2DaysFrom.disabled=!0,t.elements.radioDueDateOption2ComboBox.disabled=!0,t.elements.radioDueDateOption3Text.disabled=!0):2==e?(t.elements.dueDateOptionSelected=2,t.elements.radioDueDateOption2DaysFrom.disabled=!1,t.elements.radioDueDateOption2ComboBox.disabled=!1,t.elements.radioDueDateOption1Date.disabled=!0,t.elements.radioDueDateOption3Text.disabled=!0):(t.elements.dueDateOptionSelected=3,t.elements.radioDueDateOption3Text.disabled=!1,t.elements.radioDueDateOption1Date.disabled=!0,t.elements.radioDueDateOption2DaysFrom.disabled=!0,t.elements.radioDueDateOption2ComboBox.disabled=!0)},dueDateOptionSelected:function(e){return k(e)},getApprovalStatusForTask:function(e,t){let o={};o.Route_Status=t,S.getApprovalStatusForTask1(e,o)},getApprovalStatusForTask1:function(e,t){let o,n,i;return null!=t&&(null!=t.Route_Status&&(n=t.Route_Status),null!=t.state&&(i=t.state)),null==n&&(n=e.routeStatus),"TRUE"==e.routeOwnerTask&&null!=n?"awaitingAssignment":("Inbox Task"===e.type?"Complete"===e.current?"Approve"===e.approvalStatus?o="approved":"Reject"===e.approvalStatus?o="rejected":"Abstain"===e.approvalStatus?o="abstained":"Comment"===e.taskAction?o="commented":"Notify Only"===e.taskAction?o="notificationSent":"Approve"===e.taskAction&&(o="completed"):o="Review"===e.current?"Stopped"===n?"RouteStopped":"awaitingReview":"Stopped"===n?"RouteStopped":"Comment"===e.taskAction?"awaitingComment":"awaitingApproval":"Route Node"===e.type&&"Complete"!=i&&"Draft"===e.current&&("Comment"===e.taskAction?o="tobecommented":"Notify Only"===e.taskAction?o="notificationtobesent":"Approve"===e.taskAction&&(o="tobeapproved")),o)},populateAssigneeField:function(e,t,o,n){C(e,t,o,n)}},R=function(e,t,o){if(e.elements.radioDueDateOption1.checked){if(""==e.elements.radioDueDateOption1Date.value)return widget.notify.handler().addNotif({level:"error",subtitle:l.errorDueDate,sticky:!1}),!1;var n=new Date;if(Date.parse(e.elements.radioDueDateOption1Date.value.toGMTString())<=Date.parse(n.toGMTString()))return widget.notify.handler().addNotif({level:"error",subtitle:l.errorDueDate1,sticky:!1}),!1;for(var i=[],s=[],a=[],r=t.getTreeDocument().getChildren(),d=1;d<r.length-1;d++)for(var u=r[d].getChildren(),c=0;c<u.length;c++)u[c]._id!=t._id&&u[c].options.grid.taskDueDate&&""!=u[c].options.grid.taskDueDate&&(i.push(parseInt(u[c].options.grid.taskOrder)),s.push(u[c].options.grid.taskDueDate),a.push(u[c].options.grid.title));i.push(parseInt(e.elements.order.value)),s.push(e.elements.radioDueDateOption1Date.value),a.push(e.elements.title.value);for(var m=0;m<i.length-1;m+=1)for(var p=m+1;p<i.length;p+=1){var g=E(i[m],s[m],i[p],s[p]);if(1==g?h=l.replace(l.errorDueDateLesser,{tag1:a[m],tag2:i[m],tag3:a[p],tag4:i[p]}):2==g?h=l.replace(l.errorDueDateGreater,{tag1:a[m],tag2:i[m],tag3:a[p],tag4:i[p]}):3==g&&(h=l.errorDueDate2),0!=g)return widget.notify.handler().addNotif({level:"error",subtitle:h,sticky:!1}),!1}if(o.parentRouteTaskDueDate){var f=o.parentRouteTaskDueDate;for(p=0;p<i.length;p+=1){if(1==O(s[p],f))return h=l.replace(l.errorSubRouteTaskDueDateGreater,{tag1:a[p],tag2:i[p]}),widget.notify.handler().addNotif({level:"error",subtitle:h,sticky:!1}),!1}}}if(e.elements.radioDueDateOption2.checked){if(""==e.elements.radioDueDateOption2DaysFrom.value)return widget.notify.handler().addNotif({level:"error",subtitle:l.errorNdaysFromStart,sticky:!1}),!1;if(0==e.elements.radioDueDateOption2DaysFrom.value)return widget.notify.handler().addNotif({level:"error",subtitle:l.errorNdaysFromStart2,sticky:!1}),!1;if(o.parentRouteTaskDueDate){f=o.parentRouteTaskDueDate;var h,w=new Date,v=parseInt(e.elements.radioDueDateOption2DaysFrom.value),S=w.getTime()+24*v*60*60*1e3,R=new Date(S);f=o.parentRouteTaskDueDate;if(1==O(R,f))return h=l.replace(l.errorSubRouteTaskDueDateGreater,{tag1:e.elements.title.value,tag2:e.elements.order.value}),widget.notify.handler().addNotif({level:"error",subtitle:h,sticky:!1}),!1}}return!0},y=function(e,t,o){if(""==e.elements.order.value)return widget.notify.handler().addNotif({level:"error",subtitle:l.errorTaskOrder3,sticky:!1}),!1;if(parseInt(e.elements.order.value)<1){var n=l.replace(l.errorTaskOrder,{tag1:"1"});return widget.notify.handler().addNotif({level:"error",subtitle:n,sticky:!1}),e.elements.order.value="",!1}var i,s,a=isNaN(parseInt(o.currentRouteNode))?1:parseInt(o.currentRouteNode);if(parseInt(e.elements.order.value)<parseInt(a)){n=l.replace(l.errorCurrentTaskOrder,{tag1:o.currentRouteNode});return widget.notify.handler().addNotif({level:"error",subtitle:n,sticky:!1}),e.elements.order.value="",!1}for(var r=[],d=t.getTreeDocument().getChildren(),u=1;u<d.length-1;u++)for(var c=d[u].getChildren(),m=0;m<c.length;m++)c[m]._id!=t._id&&r.push(parseInt(c[m].options.grid.taskOrder));if(0==r.length&&1!=e.elements.order.value){n=l.replace(l.errorTaskOrder2,{tag1:e.elements.order.value-1,tag2:e.elements.order.value});return widget.notify.handler().addNotif({level:"error",title:l.errorTaskOrder1,subtitle:n,sticky:!1}),e.elements.order.value="",!1}r.push(parseInt(e.elements.order.value));for(var p=0;p<r.length-1;p++)for(var g=p+1;g<r.length;g++)if(r[g]<r[p]){var f=r[p];r[p]=r[g],r[g]=f}for(var h=0;h<r.length-1;h++){if(0==h&&1!=r[h]){i=1,s=r[h];break}if(r[h]!=r[h+1]&&r[h]+1!=r[h+1]){i=r[h]+1,s=r[h+1];break}}if(i>-1){var w=l.errorTaskOrder1,v=l.replace(l.errorTaskOrder2,{tag1:s-1,tag2:s});return widget.notify.handler().addNotif({level:"error",title:w,subtitle:v,sticky:!1}),e.elements.order.value="",!1}return!0},M=function(e){var t=e.elements.taskActionDueDate;if(3==e.elements.dueDateOptionSelected){if(""==t.value)return widget.notify.handler().addNotif({level:"error",subtitle:l.errorDueDate,sticky:!1}),!1;var o=new Date;if(Date.parse(t.value.toGMTString())<=Date.parse(o.toGMTString()))return widget.notify.handler().addNotif({level:"error",subtitle:l.errorDueDate3,sticky:!1}),!1}return!0},T=function(e){for(var t=0;t<e.length;t++){if(e[t].indexOf("isRouteOwner")>-1)return"true"==e[t].split("~")[1]}return!1},b=function(e,t,o,n){var i;n&&(i=new f({label:n[0]["ds6w:label"],value:n[0].id,name:n[0]["ds6w:identifier_value"]}),e.elements.assignmentScope.selectedItems=i)},C=function(e,t,o,n){"Person"==n[0]["ds6w:type_value"]?(e.elements.assignee.value=n[0]["ds6w:label"].unescapeHTML(),o&&"Route Template"==o.Type?"True"!=o.chooseUserFromGroup&&"True"!=o.selectUsersFromUserGroup||e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="none",e.elements.chooseUsersFromUg.checkFlag=!1):t.options.grid.chooseUsersFromUg&&"True"==t.options.grid.chooseUsersFromUg&&e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="none")):(e.elements.assignee.value=n[0]["ds6w:label"].unescapeHTML()+"("+l.UserGroup+")",o&&"Route Template"==o.Type?"True"!=o.chooseUserFromGroup&&"True"!=o.selectUsersFromUserGroup||e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="",e.elements.chooseUsersFromUg.checkFlag=!0):"True"!=o.chooseUserFromGroup&&"True"!=o.selectUsersFromUserGroup||!t.options.grid.chooseUsersFromUg||"True"==t.options.grid.chooseUsersFromUg&&e.chooseUsersFromUgDiv&&(e.chooseUsersFromUgDiv.style.display="")),e.elements.assignee.options.assigneeId=n[0].id,n[0]["ds6w:type_value"].includes("Person")?e.elements.assignee.options.assigneeType=n[0]["ds6w:type_value"].unescapeHTML():e.elements.assignee.options.assigneeType="Group",e.elements.assignee.options.taskAssigneeUsername=n[0]["ds6w:identifier_value"]},D=function(e,t,o){if(e.model.title=t.elements.title.value,e.model.taskAction=t.elements.expectedAction.value,e.model.taskOrder=t.elements.order.value,o&&"Route Template"==o.Type&&(e.model.routeOwnerTask=t.elements.radioAssigneeRouteOwner&&1==t.elements.radioAssigneeRouteOwner.checked?"TRUE":"FALSE",e.model.routeOwnerUGChoice=t.elements.assignmentScope.selectedItems&&t.elements.assignmentScope.selectedItems.options.value?t.elements.assignmentScope.selectedItems.options.value:"",e.model.routeOwnerUGName=t.elements.assignmentScope.selectedItems&&t.elements.assignmentScope.selectedItems.options.name?t.elements.assignmentScope.selectedItems.options.name:"",e.model.routeOwnerUGTitle=t.elements.assignmentScope.selectedItems&&t.elements.assignmentScope.selectedItems.options.label?t.elements.assignmentScope.selectedItems.options.label:"",e.model.chooseUsersFromUg=t.elements.chooseUsersFromUg&&1==t.elements.chooseUsersFromUg.checkFlag?"True":"False"),t.elements.needOwnerReview.checkFlag?e.model.needsOwnerReview="Yes":e.model.needsOwnerReview="No",e.model.instructions=t.elements.instruction.value,t.elements.assignee.selectedItems&&t.elements.assignee.selectedItems.options.label){let o=t.elements.assignee.selectedItems.options.label;if("Group"==t.elements.assignee.selectedItems.options.type&&o.contains("(")&&o.contains(")")){let e=o.lastIndexOf("(");o=o.slice(0,e)}e.model.taskAssignee=o,e.model.assigneeTitle=o}t.elements.assignee.selectedItems&&t.elements.assignee.selectedItems.options.value!=e.model.assigneeId&&(e.model.assigneeId=t.elements.assignee.selectedItems.options.value,e.model.assigneePID=t.elements.assignee.selectedItems.options.value),t.elements.assignee.selectedItems&&t.elements.assignee.selectedItems.options.type!=e.model.assigneeType&&(e.model.assigneeType=t.elements.assignee.selectedItems.options.type),t.elements.assignee.selectedItems&&t.elements.assignee.selectedItems.options.name&&(e.model.taskAssigneeUsername=t.elements.assignee.selectedItems.options.name),t.elements.allowDelegation.checkFlag?e.model.allowDelegation="TRUE":e.model.allowDelegation="FALSE",1==t.elements.dueDateOptionSelected?(e.model.taskDueDate=t.elements.radioDueDateOption1Date.value,e.model.dueDateOffset="",e.model.dateOffsetFrom="Route Start Date",e.model.assigneeSetDueDate="No"):2==t.elements.dueDateOptionSelected?(e.model.taskDueDate="",e.model.dueDateOffset=t.elements.radioDueDateOption2DaysFrom.value,e.model.dateOffsetFrom=t.elements.radioDueDateOption2ComboBox.value,e.model.assigneeSetDueDate="No"):"Inbox Task"==e.model.type&&""!=e.model.taskDueDate?e.model.assigneeSetDueDate="Yes":(e.model.taskDueDate="",e.model.dueDateOffset="",e.model.dateOffsetFrom="Route Start Date",e.model.assigneeSetDueDate="Yes"),null==e.model.current&&(e.model.current="Draft",e.model.stateNLS=l.Draft),o&&"Route Template"!=o.Type&&(t.contentToReviewField.selectedItems?(null!=e.model.contentToReviewFieldInfo?e.model.contentToReviewOrgFieldInfo=e.model.contentToReviewFieldInfo:e.model.contentToReviewOrgFieldInfo=[],e.model.contentToReviewFieldInfo=[],t.contentToReviewField.selectedItems.forEach(function(t){var o=t.options.grid;e.model.contentToReviewFieldInfo.push(o)})):e.model.contentToReviewFieldInfo=[]),o&&"Route Template"!=o.Type&&t.removeContentToReview&&(e.model.removeContentToReview&&e.model.removeContentToReview.length>0?t.removeContentToReview.forEach(function(t){e.model.removeContentToReview.push(t)}):e.model.removeContentToReview=t.removeContentToReview),t.removeContentToReview=[],e.model.validTaskData=!0},k=function(e){return e.model.assigneeSetDueDate&&"Yes"==e.model.assigneeSetDueDate?3:e.model.taskDueDate&&""!=e.model.taskDueDate?1:e.model.dueDateOffset&&""!=e.model.dueDateOffset?2:1},E=function(e,t,o,n){var i=new Date(t),s=new Date(n);return""===t||""===n?0:e>o&&Date.parse(i.toGMTString())>=Date.parse(s.toGMTString())||e<o&&Date.parse(i.toGMTString())<=Date.parse(s.toGMTString())||e==o?0:e>o&&Date.parse(i.toGMTString())<Date.parse(s.toGMTString())?1:e<o&&Date.parse(i.toGMTString())>Date.parse(s.toGMTString())?2:3},O=function(e,t){var o;o="string"==typeof e?new Date(e):e;var n=new Date(t);return""===e||""===t?0:Date.parse(o.toGMTString())>Date.parse(n.toGMTString())?1:void 0},N=function(e,t){let o=widget.getValue("task-custom-fields");o&&o.forEach((o,n)=>{if("extensions"!=o.name){let n=t.elements[o.name];if(n){let t;Array.isArray(n)?(t=[],n.forEach((e,n)=>{t.push(A(e,o))})):t=A(n,o),e.model[o.name]=t}}})},A=function(e,t){let o=e.value;if(Array.isArray(o)&&(o=e.value[0]),"object"==typeof o&&o.getDate)o=o.toISOString();else if(r.isDateField(t)&&o&&""!=o){o=new Date(o).toISOString()}return r.isBooleanField(t)&&(o=e.checkFlag?"TRUE":"FALSE"),o},I=function(e,t){var o=[],i=0;return new Promise(function(t,s){0==e.length&&t();for(var a=0;a<e.length;a++){var r={onFailure:function(e){e.result=o,s(e)},onComplete:function(e){i++,o.push(e),a==i&&t(o)}};r.tenant=n.getTenantValue(),r.securityContext=n.getSecurityContextValue(),r.tenantUrl=n.get3DSpaceURL();var l={fileName:e[a].name,fileInfo:{file:e[a]}};u.createDocument(l,r)}})},U=function(e){var t=0;return new Promise(function(o,i){0==e.length&&o();for(var s=0;s<e.length;s++){var a={onFailure:function(e){i()},onComplete:function(e){s==++t&&o()}};a.tenant=n.getTenantValue(),a.securityContext=n.getSecurityContextValue(),a.tenantUrl=n.get3DSpaceURL(),u.deleteDocument(e[s].data[0].id,a)}})},x=function(e,t){var o=0;return new Promise(function(i,s){0==e.length&&i();for(var a=0;a<e.length;a++){var r={onFailure:function(e){s()},onComplete:function(e){a==++o&&i()}};r.relInfo={parentId:t,parentRelName:"Reference Document",parentDirection:"from"},r.tenant=n.getTenantValue(),r.securityContext=n.getSecurityContextValue(),r.tenantUrl=n.get3DSpaceURL(),u.disconnectDocumentFromParent(e[a],r)}})},F=function(e,o,n,i,a,r,l,d,u){t.updateComment(e,o,n).then(t=>{if(null!=e.model.eSignRecordId){let t=e.model.eSignRecordId;w.updateEsignRecordInformation(e,t).then(t=>{widget.notify.handler().addNotif({level:"success",subtitle:i,sticky:!1}),s.refreshRouteData(o),widget.routeMgmtMediator.publish(a.closeEventName),widget.routeMgmtMediator.publish("task-action-on-save",e),n&&0!=n.length&&widget.routeMgmtMediator.publish("content-summary-update")},e=>{console.log("Failed to update esign"+e)})}else s.refreshRouteData(o),widget.routeMgmtMediator.publish(a.closeEventName),widget.routeMgmtMediator.publish("task-action-on-save",e),n&&0!=n.length&&widget.routeMgmtMediator.publish("content-summary-update")},o=>{a.elements.taskActionButtons.elements.container.dsModel.disabled=!1,a.elements.taskActionButtons.actionOnClickFlag=!0,null!=l&&U(l),null!=d&&x(d,e.model.id),null!=u&&u.length>0&&t.updateTaskAttachment(e,u),o.error?widget.notify.handler().addNotif({level:"error",title:r,message:o.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:r,sticky:!1})})},V=function(e,t,o){if(e.model.taskAttachments){let n=m.getContentIDs(),i=[];for(let t=0;t<e.model.taskAttachments.length;t++)i.push(e.model.taskAttachments[t].id);for(let e=0;e<i.length;e++)if(!n.includes(i[e])){let n={},s={};n.id=i[e],n.updateAction="DISCONNECT",t.push(n),(s=JSON.parse(JSON.stringify(n))).updateAction="CONNECT",o.push(s)}}},_=function(t,o,i,s){if(L(i)){var a=t.dsModel,r=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],function(t){var l=t.createSocket({socket_id:r}),d=e.getRefinementToSnN(r,"searchAssignee",!1,["Person","User Group"]);if("OnPremise"!=n.getTenantValue()){d.source=["3dspace","usersgroup"]}var u=e.getPrecondForTaskMemberSearch(i);if(d.precond=u.precond,d.resourceid_in=u.resourceid_in,!UWA.is(l))throw new Error("Socket not initialized");l.dispatchEvent("RegisterContext",d),l.addListener("Selected_Objects_search",function(e,t,o,n){var i;n&&(i=new f({label:n[0]["ds6w:label"],value:n[0].id,name:n[0]["ds6w:identifier"],type:n[0]["ds6w:type_value"]}),e.elements.assignee.selectedItems=i)}.bind(a,o,s,i)),l.dispatchEvent("InContextSearch",d)})}},P=function(e){for(var t=[],n=h.getModel().getChildren(),i=[],s=[],a=0;a<n.length;a++)i.push(n[a]._options.grid.id),n[a]._options.grid.routeTask&&-1!=n[a]._options.grid.routeTask.indexOf(",")&&s.push(n[a]._options.grid.id);var r=[];if(null!=e.model.contentToReviewOrgFieldInfo&&e.model.contentToReviewOrgFieldInfo.length>0&&e.model.contentToReviewOrgFieldInfo.forEach(function(e){var t=e.id;-1==r.indexOf(t)&&r.push(t)}),e.model.contentToReviewFieldInfo){var d=[];e.model.contentToReviewFieldInfo.forEach(function(e){var o=e.id;d.push(o),-1==i.indexOf(o)&&t.push(o)});for(var u=0;u<r.length;u++)s.indexOf(r[u])>-1?h.updateRelatedToForContents():-1==d.indexOf(r[u])&&h.deleteRowModelById(r[u]);t.length>0?o.fetchStateBlockingConditions(t).then(t=>{for(var o=!1,n=0;n<t.length;n++){t[n].id=t[n].physicalid;let i=e.model.contentToReviewFieldInfo.find(e=>e.id==t[n].physicalid);t[n].created=i.created,t[n].modified=i.modified,t[n].name=i.name,t[n].owner=i.owner,t[n].policy=i.policy,t[n].revision=i.revision,t[n].state=i.state,t[n].stateNLS=t[n].current_NLS,t[n].title=i.title,t[n].type=i.type,t[n].type_icon_url=i.type_icon_url,t[n].associatedto="RouteTask","Ad Hoc"===t[n].RouteBaseState&&(o=!0)}o&&widget.notify.handler().addNotif({level:"warning",subtitle:l.stateBlockingInfoMsg,sticky:!1}),h.appendRow(t,!1,"RouteTask"),h.updateRelatedToForContents()}).catch(e=>{console.log("failed "+e[0])}):h.updateRelatedToForContents()}},W=function(e,t){var o=h.getModel().getChildren(),n=[];if(e){var i=[];e.forEach(function(e){var t=e.id;i.push(t)});for(var s=0;s<o.length;s++)if(-1!=i.indexOf(o[s]._options.grid.id)){var a=o[s]._options.grid.routeTask.split(",");if(1==a.length)n.push(o[s]._options.grid.id);else{const e=a.indexOf(t);a.splice(e,-1!==e?1:0),h.updateRelatedToTitle(a.join(),o[s]._options.grid.id)}}for(var r=0;r<n.length;r++)h.deleteRowModelById(n[r])}},L=function(e){if(null!=e.scopeId){if(!e.scopeId||""==e.scopeId)return widget.notify.handler().addNotif({level:"error",subtitle:l.ScopeSelectMessage,sticky:!1}),!1;if(e.scopeId){var t=[e.scopeId,"",""];e.Scope=t}}return e.Scope&&(!Array.isArray(e.Scope)||""!=e.Scope[0])||(widget.notify.handler().addNotif({level:"error",subtitle:l.ScopeSelectMessage,sticky:!1}),!1)};return S}),define("DS/ENORouteMgmt/Model/RouteContentModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r){"use strict";let l,d=new e,u=function(e){let t="";return t+=e.typeNLS+" | "+e.revision+" | "+e.stateNLS};return{createModel:(e,o)=>(function(e,o){return l=o,d.prepareUpdate(),e.forEach(function(e){var i=new t({label:e.title,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,TypeDisplay:e.typeNLS,Description:e.description,Owner:e.owner,Creation_Date:e.created,Modified_Date:e.modified,relatedToTaskTitles:e.relatedToTaskTitles,Relation:e.relation,RelationValue:e.relationValue,TypeIconLarge:e.image,relId:e.relId,policy:e.policy,current:e.current,RouteBaseState:e.RouteBaseState,RouteBaseState_NLS:e.RouteBaseState_NLS,RouteTargetState:e.RouteTargetState,RouteTargetState_NLS:e.RouteTargetState_NLS,maturityBlockingStates:e.maturityBlockingStates,connectedTaskTitles:e.connectedaskTitles,maturityTargetStates:e.maturityTargetStates,isMaturityBlockingEditable:!n.hideMaturityBlockCondition(e,o),BlockingMaturityMenu:n.getMaturityMenuForGrid(e,"RouteContent",o),TargetMaturityMenu:a.getTargetMenuForGrid(e,"RouteContent",o),canDeleteContent:e.canDeleteContent,Revision:e.revision},thumbnail:e.image,subLabel:u(e),icons:[e.typeicon],description:e.modified,contextualMenu:["My context menu"]});null!=i.options.grid.relatedToTaskTitles&&0!=i.options.grid.relatedToTaskTitles.length||(i.options.grid.relatedToTaskTitles=r.allTasks),d.addRoot(i)}),d.pushUpdate(),d})(e,o),getModel:()=>d,getSelectedRowsModel:()=>o.getSelectedRowsModel(d),getContentIDs:()=>(function(){if(null!=d){for(var e=d.getChildren(),t=[],o=0;o<e.length;o++)"Content to review"==e[o]._options.grid.RelationValue&&t.push(e[o]._options.grid.id);return t}})(),destroy:()=>{d=new e},appendRows:e=>(function(e){d.prepareUpdate(),e.forEach(e=>{var o=new t({label:e.title,id:e.id,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,TypeDisplay:e.typeNLS,Description:e.description,Owner:e.owner,Creation_Date:e.created,Modified_Date:e.modified,Relation:r.contentToReview,RelationValue:"Content to review",TypeIconLarge:e.image,relId:e.relId,policy:e.policy,current:e.current,relatedToTaskTitles:e.relatedToTaskTitles,RouteBaseState:e.RouteBaseState,RouteBaseState_NLS:e.RouteBaseState_NLS,RouteTargetState:e.RouteTargetState,RouteTargetState_NLS:e.RouteTargetState_NLS,maturityBlockingStates:e.maturityBlockingStates,maturityTargetStates:e.maturityTargetStates,connectedTaskTitles:e.connectedaskTitles,isMaturityBlockingEditable:!n.hideMaturityBlockCondition(e,l),BlockingMaturityMenu:n.getMaturityMenuForGrid(e,"RouteContent",l),TargetMaturityMenu:a.getTargetMenuForGrid(e,"RouteContent",l),canDeleteContent:e.canDeleteContent,Revision:e.revision},thumbnail:e.image,subLabel:u(e),description:e.modified,contextualMenu:["My context menu"],icons:[e.typeicon]});null!=o.options.grid.relatedToTaskTitles&&0!=o.options.grid.relatedToTaskTitles.length||(o.options.grid.relatedToTaskTitles=r.allTasks),d.addRoot(o)}),d.pushUpdate(),0!=d.getChildren().length&&widget.routeMgmtMediator.publish("hide-no-content-placeholder")})(e),deleteRows:e=>(function(e){var t=d.getNthRoot(e);t&&(d.prepareUpdate(),d.removeRoot(t),d.pushUpdate()),0==d.getChildren().length&&widget.routeMgmtMediator.publish("show-no-content-placeholder")})(e),deleteSelectedRows:()=>(function(){var e=[],t=d.getSelectedNodes();d.prepareUpdate();for(var o=0;o<t.length;o++)if("Content to review"==t[o].options.grid.RelationValue&&"true"==t[o].options.grid.canDeleteContent){d.removeRoot(t[o]);var n={id:t[o].options.grid.id};e.push(n)}d.pushUpdate(),0==d.getChildren().length&&widget.routeMgmtMediator.publish("show-no-content-placeholder"),widget.routeMgmtMediator.publish("route-content-updated",e),widget.routeMgmtMediator.publish("redraw-graph")})(),appendRowsFromDropData:e=>(function(e){d.prepareUpdate(),e.forEach(e=>{let o=new t({label:e.title,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Maturity:e.stateNLS,Type:e.type,TypeDisplay:e.typeNLS,Description:e.description,Owner:e.owner,Modified_Date:e.modified,Relation:r.contentToReview,RelationValue:"Content to review",current:e.current,relatedToTaskTitles:e.relatedToTaskTitles,RouteBaseState:e.RouteBaseState,RouteBaseState_NLS:e.RouteBaseState_NLS,maturityBlockingStates:e.maturityBlockingStates,maturityTargetStates:e.maturityTargetStates,isMaturityBlockingEditable:!n.hideMaturityBlockCondition(e,l),BlockingMaturityMenu:n.getMaturityMenuForGrid(e,"RouteContent",l),TargetMaturityMenu:a.getTargetMenuForGrid(e,"RouteContent",l),RouteTargetState:e.RouteTargetState,RouteTargetState_NLS:e.RouteTargetState_NLS,Creation_Date:e.created,TypeIconLarge:e.image,canDeleteContent:e.canDeleteContent,relId:e.relId,policy:e.policy,Revision:e.revision},thumbnail:e.image,subLabel:u(e),icons:[e.typeicon],description:e.modified,contextualMenu:["My context menu"]});null!=o.options.grid.relatedToTaskTitles&&0!=o.options.grid.relatedToTaskTitles.length||(o.options.grid.relatedToTaskTitles=r.allTasks),d.addRoot(o)}),d.pushUpdate(),0!=d.getChildren().length&&widget.routeMgmtMediator.publish("hide-no-content-placeholder")})(e)}}),define("DS/ENORouteMgmt/Utilities/DragAndDropManager",["UWA/Core","DS/ENORouteMgmt/Controller/RouteServicesController","UWA/Class/Promise","DS/ENORouteMgmt/EnoviaBootstrap","DS/WAFData/WAFData","DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Utilities/DragAndDrop","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l,d){"use strict";let u,c=function(e,o){let n=a.getRowModelById(e).attRestrictMembers;t.addDraggedRouteContent(e,o,n).then(function(t){widget.notify.handler().addNotif({level:"success",subtitle:d.successAddContent,sticky:!0});for(var o=!1,n=0;n<t.length;n++)"Ad Hoc"===t[n].RouteBaseState&&(o=!0);o&&widget.notify.handler().addNotif({level:"warning",subtitle:d.stateBlockingInfoMsg,sticky:!1});let i=R();if(i){let o=i.id;e==o&&(s.appendRowsFromDropData(t),widget.routeMgmtMediator.publish("route-content-updated",t),widget.routeMgmtMediator.publish("redraw-graph"))}l._removeDroppableStyle()},function(e){null!=e.internalError&&-1!=e.internalError.indexOf("A relationship of this type already exists")?widget.notify.handler().addNotif({level:"error",subtitle:d.errorAddExistingContent,sticky:!0}):null!=e.error&&-1!=e.error.indexOf("Error:")?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!0}):widget.notify.handler().addNotif({level:"error",subtitle:d.ErrorAddContent,sticky:!0})})},m=function(e){let t;if(e.dataTransfer){let o=function(e){for(var t,o=UWA.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",n="",i=["text/searchitems","text/plain","Text"],s=0;s<i.length&&""===n;s++){var a=e.dataTransfer.types[o](i[s]);(UWA.is(a,"number")&&a>=0||UWA.is(a,"boolean")&&!0===a)&&(n=i[s])}if(""===n)throw new Error("Unknown type in DnD");return t=e.dataTransfer.getData(n),JSON.parse(t)}(e);o.data&&o.data.items&&(t=o.data.items)}else if("object"==typeof e)t=e;else{let o=JSON.parse(e);o.data&&o.data.items&&(t=o.data.items)}return t},p=function(e,o,n,i){let s=i?i.split(","):"",a=m(e),u=f(a,n);if(h(o,n)){if(!u){let e=[];if(a.every(function(t){let o=t.objectType;if(s.indexOf(o)>-1){let o=t.objectId;return e.push(o),!0}return null==o?widget.notify.handler().addNotif({subtitle:d.replace(d.ErrorContentUndefined,{type:o}),level:"error"}):widget.notify.handler().addNotif({subtitle:d.replace(d.errorAddContentType,{type:o}),level:"error"}),!1}),e.length>0){let i=w(o,n);i?c(i,e):t.getContentInfo(e).then(function(o){t.fetchStateBlockingConditions(e).then(e=>{for(var t=!1,n=0;n<e.length;n++){let i=o.data.find(t=>t.id==e[n].physicalid);i.maturityBlockingStates=e[n].maturityBlockingStates,i.maturityTargetStates=e[n].maturityTargetStates,i.RouteBaseState=e[n].RouteBaseState,i.RouteBaseState_NLS=e[n].RouteBaseState_NLS,i.RouteTargetState=e[n].RouteTargetState,i.RouteTargetState_NLS=e[n].RouteTargetState_NLS,i.current=e[n].current,i.type=i.typeNLS,"Ad Hoc"===e[n].RouteBaseState&&(t=!0)}t&&widget.notify.handler().addNotif({level:"warning",subtitle:d.stateBlockingInfoMsg,sticky:!1}),r.appendRow(o.data,!0)}).catch(e=>{console.log("failed "+e[0])})},function(e){l._removeDroppableStyle()})}}}else widget.notify.handler().addNotif({subtitle:d.noAddAccessError,level:"error"})},g=function(e,t){if(t)return!1;let o;return e&&e.nodeModel?"Complete"==e.nodeModel.options.grid.state&&(o=e.nodeModel.options.grid.state):o=S(),"Complete"===o&&(widget.notify.handler().addNotif({subtitle:d.errorCompletedRouteAddContent,level:"error"}),!0)},f=function(e,t){let o,n=!1;return t&&(o=r.getContentIDs(),e.every(function(e){let t=e.objectId;return!(o&&o.indexOf(t)>-1)||(widget.notify.handler().addNotif({subtitle:d.errorAddExistingContent,level:"error"}),n=!0,!1)})),n},h=function(e,t){if(t)return!0;let o,n=!1;return(o=e&&e.nodeModel?e.nodeModel.options.grid:R()).Actions&&o.Actions.indexOf("add.contents")>=0&&(n=!0),n},w=function(e,t){let o;return e?o=e.nodeModel.options.grid.id:t||(o=v()),o},v=function(){return R().id},S=function(){return R().state},R=function(){return u},y=function(e){return{envId:n.getTenantValue(),serviceId:"3DSpace",contextId:"",objectId:e.options.grid.id,objectType:e.options.grid.Type,displayName:e.options.grid.Title,displayType:e.options.grid.displayType}};return{init:e=>(function(e){e&&e.model&&e.model.id&&(u=e.model)})(e),addContent:(e,t)=>c(e,t),onDropManager:(e,o,n)=>(function(e,o,n){if(g(o,n))return;let i=widget.getValue("routeContentDnDTypes");void 0===i?t.fetchAllowedContentTypesForRoute().then(t=>{i=t.data[0].dataelements.routeDnDContentTypes,p(e,o,n,i)},e=>{}):p(e,o,n,i)})(e,o,n),getContentForDrag:(e,t)=>(function(e,t){let o=[];t.nodeModel.getTreeDocument().getSelectedNodes().length>1?t.nodeModel.getTreeDocument().getSelectedNodes().forEach(function(e){o.push(y(e))}):o.push(y(t.nodeModel));let n={protocol:"3DXContent",version:"1.1",source:widget.getValue("appId")?widget.getValue("appId"):"ENXROUT_AP",widgetId:widget.id,data:{items:o}};e.dataTransfer.setData("Text",JSON.stringify(n)),e.dataTransfer.effectAllowed="all"})(e,t)}}),define("DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView",["DS/ENORouteMgmt/Config/RouteSummaryGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DragAndDropManager","DS/ENORouteMgmt/Config/Toolbar/RouteSummaryToolbarConfig"],function(e,t,o,n){"use strict";let i,s,a={},r=function(){var e=widget.getValue("routefilters");return null==e?(widget.setValue("routefilters",["owned","assigned","Define","In Process"]),["owned","assigned","Define","In Process"]):e};return{build:l=>(function(l){let d=widget.getValue("RouteSummary-ShowView"),u="data-grid-container showView nonVisible";d&&"TileView"==d&&(u="data-grid-container hideView");var c=UWA.createElement("div",{id:"dataGridViewContainer",class:u});let m=n.writetoolbarDefination(r());1==UWA.Utils.Client.Features.touchEvents&&(a.showRowCount=!0),a.cellDragEnabledFlag=!0,a.identifier="RouteSummaryDataGridView";let p=t.build(l,e,m,c,a);return i=t.dataGridViewToolbar(),(s=t.dataGridView()).onDragStartCell=function(e,t){return o.getContentForDrag(e,t),!0},s.onDragEndCell=function(e,t){e.target.removeClassName("wux-ui-state-activated wux-ui-state-highlighted")},s.onDropCell=function(e,t){t.nodeModel.unhighlight(),o.onDropManager(e,t)},s.onDragOverCell=function(e,t){t.nodeModel.highlight(),e.preventDefault()},s.onDragLeaveCell=function(e,t){t.nodeModel.unhighlight()},p})(l),registerListners:()=>registerListners(),destroy:()=>{s&&s.destroy()},getGridViewToolbar:()=>i,getDataGridInstance:()=>s}}),define("DS/ENORouteMgmt/Views/Grid/RouteContentsDataGridView",["DS/ENORouteMgmt/Config/RouteContentsGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Config/Toolbar/RouteContentsTabToolbarConfig","DS/ENORouteMgmt/Utilities/DragAndDropManager"],function(e,t,o,n){"use strict";let i,s,a={};return{build:r=>(function(r){let l="Contents-gridView-View nonVisible showView",d=widget.getValue("ContentsTab-ShowView");d&&"GridView"!=d&&(l="Contents-gridView-View hideView");var u=UWA.createElement("div",{id:"dataGridViewContainer",class:l});let c=o.writetoolbarDefination(r);1==UWA.Utils.Client.Features.touchEvents&&(a.showRowCount=!0),a.cellDragEnabledFlag=!0,a.identifier="RouteContentsDataGridView";let m=t.build(r,e,c,u,a);return i=t.dataGridViewToolbar(),(s=t.dataGridView()).onDragStartCell=function(e,t){return n.getContentForDrag(e,t),!0},s.onDragEndCell=function(e,t){e.target.removeClassName("wux-ui-state-activated wux-ui-state-highlighted")},m})(r),getGridViewToolbar:()=>i}}),define("DS/ENORouteMgmt/Model/ContentToReviewModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/PlaceHolder","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s){"use strict";let a=new e;return{createModel:(e,o)=>(function(e,o){return a.prepareUpdate(),e.forEach(function(e){var o=new t({label:e.title,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Type:e.type,relatedToTaskIds:e.relatedToTaskIds},subLabel:e.stateNLS,icons:[e.typeicon],contextualMenu:["My context menu"]});""===e[0]&&(o._isHidden=!0),a.addRoot(o)}),a.pushUpdate(),a})(e),getModel:()=>a,getSelectedRowsModel:()=>o.getSelectedRowsModel(a),getContentIDs:()=>(function(){if(null!=a){for(var e=a.getChildren(),t=[],o=0;o<e.length;o++)t.push(e[o]._options.grid.id);return t}})(),destroy:()=>{a=new e},appendRows:e=>(function(e){a.prepareUpdate(),e.forEach(e=>{var o=new t({label:e.title,width:300,grid:{id:e.id,Title:e.title,Name:e.name,Type:e.type},subLabel:e.stateNLS,icons:[e.typeicon],contextualMenu:["My context menu"]});a.addRoot(o)}),a.pushUpdate();var o=document.querySelector(".contentToReview-gridView-View");o.hasClassName("hideView")&&o.removeClassName("hideView")})(e)}}),define("DS/ENORouteMgmt/Actions/ContentActions",["UWA/Drivers/Alone","UWA/Core","DS/WAFData/WAFData","UWA/Utils","DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Utilities/Search/SearchUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l){"use strict";let d;return d={onSearchClick:function(){var t,o,n=i.tileView();require(["DS/ENORouteMgmt/Model/RouteContentModel"],function(i){var s=(a=i).getModel().routeModel.Scope,l=a.getModel().routeModel.organization;o="All"==s[0]?s[0]:"Organization"==s[0]?s[0]:s[2];var u=e.Utils.getUUID(),c=this;e.is(t)||require(["DS/SNInfraUX/SearchCom"],function(i){t=i.createSocket({socket_id:u});let s=widget.getValue("routeContentSearchTypes");var m=s?s.split(","):"",p=r.getRefinementToSnN(u,"addContent",!0,m);if(p.precond=r.getPrecondForContentSearch(o,m,l),p.resourceid_not_in=a.getContentIDs(),!e.is(t))throw new Error("Socket not initialized");t.dispatchEvent("RegisterContext",p),t.addListener("Selected_Objects_search",d.selected_Objects_search.bind(c,n)),t.dispatchEvent("InContextSearch",p)})})},selected_Objects_search:function(e,t){s.addExistingRouteContent(e,t).then(function(e){widget.notify.handler().addNotif({level:"success",subtitle:l.successAddContent,sticky:!0});for(var t=!1,o=0;o<e.length;o++)"Ad Hoc"===e[o].RouteBaseState&&(t=!0);t&&widget.notify.handler().addNotif({level:"warning",subtitle:l.stateBlockingInfoMsg,sticky:!1}),a.appendRows(e),widget.routeMgmtMediator.publish("route-content-updated",e),widget.routeMgmtMediator.publish("redraw-graph")},function(e){null!=e.internalError&&-1!=e.internalError.indexOf("A relationship of this type already exists")?widget.notify.handler().addNotif({level:"error",subtitle:l.errorAddExistingContent,sticky:!0}):e.error?widget.notify.handler().addNotif({level:"error",subtitle:e.error,sticky:!0}):widget.notify.handler().addNotif({level:"error",subtitle:l.ErrorAddContent,sticky:!0})})},getPrecondForContentSearch:function(){for(var e=widget.getValue("routeContentSearchTypes").split(","),t="flattenedtaxonomies:(",o=e.length,n=0;n<o;n++){t+='"types/'+e[n]+'"',n<o-1&&(t+=" OR "),n===o-1&&(t+=")")}return t}}}),define("DS/ENORouteMgmt/Views/Dialogs/RemoveContent",["DS/WAFData/WAFData","UWA/Core","DS/ENORouteMgmt/EnoviaBootstrap","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Views/Grid/RouteContentsDataGridView","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c){"use strict";let m,p,g=function(e){var n=(new a).createDataWithIdForRequest(e),i=l.tileView(),s=i.TreedocModel.RouteId,d=i.TreedocModel.routeModel.Title,u=o.getRouteServiceBaseURL()+"/"+s+"/contents",m={};(m=t.extend(m,o.getSyncOptions(),!0)).method="DELETE",m.type="json",m.timeout=0,m.headers={"Content-Type":"application/ds-json"},m.wait=!0,m.data=JSON.stringify(n),m.onComplete=function(t){widget.notify.handler().addNotif({level:"success",subtitle:c.successRemoveContent,sticky:!0}),r.deleteSelectedRows(),widget.routeMgmtMediator.publish("route-content-preview-delete",{model:{ids:e}})},m.onFailure=function(e,t,o){if(t.error){let e=t.error;t.internalError&&t.internalError.indexOf("#1500028")>=0&&t.internalError.indexOf("No todisconnect access to object")>0?e=c.errorNoDissconnectAccess:t.internalError&&t.internalError.indexOf("#1500219")>=0&&t.internalError.indexOf("Business object has no relationship 'Object Route'")>0&&(e=c.replace(c.errorRemovedContent,{tag1:d})),widget.notify.handler().addNotif({level:"error",subtitle:e,sticky:!0})}else widget.notify.handler().addNotif({level:"error",subtitle:c.errorRemoveContent,sticky:!0})},o.authenticateRequest(u,m),p.close()};return m={removeConfirmation:e=>(function(e){if(void 0===e.data&&(e=r.getSelectedRowsModel()),e.data.length<1)return void widget.notify.handler().addNotif({level:"error",subtitle:c.ErrorContentRemoveSelection,sticky:!0});for(var t=[],o=[],a=UWA.createElement("ul",{class:"",styles:{"list-style-type":"circle"}}),l=UWA.createElement("ul",{class:"",styles:{"list-style-type":"circle"}}),d=0;d<e.data.length;d++)"false"==e.data[d].options.grid.canDeleteContent||"Attachment"==e.data[d].options.grid.RelationValue?(o.push(e.data[d].id),l.appendChild(UWA.createElement("li",{class:"",html:[UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-content"}),UWA.createElement("span",{html:"&nbsp;"+e.data[d].options.grid.Title})]}))):(t.push(e.data[d].options.grid.id),a.appendChild(UWA.createElement("li",{class:"",html:[UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-content"}),UWA.createElement("span",{html:"&nbsp;"+e.data[d].options.grid.Title})]})));let u=new i;u.inject(document.body);let m=new UWA.Element("div",{id:"removeContentWarning",class:""});var f="";t.length>0&&(f=(f=1==t.length?c.removeContentHeaderSingle:c.removeContentHeader).replace("{count}",t.length),1==t.length?m.appendChild(UWA.createElement("div",{class:"",html:c.removeContentDetailSingle})):m.appendChild(UWA.createElement("div",{class:"",html:c.removeContentDetail})),m.appendChild(UWA.createElement("div",{class:""}).appendChild(a))),o.length>0&&(""==f&&(f=c.removeContentHeader2),1==o.length?m.appendChild(UWA.createElement("div",{class:"",html:c.removeContentWarningDetailSingle})):m.appendChild(UWA.createElement("div",{class:"",html:c.removeContentWarningDetail})),m.appendChild(UWA.createElement("div",{class:""}).appendChild(l)));var h=!1;o.length>0&&t.length<1&&(h=!0),p=new n({modalFlag:!0,width:500,height:200,title:f,content:m,domId:"RouteImmersiveFrame",immersiveFrame:u,buttons:{Ok:new s({label:c.ok,disabled:h,onClick:function(e){e.dsModel.dialog,g(t)}}),Cancel:new s({label:c.cancel,onClick:function(e){e.dsModel.dialog.close()}})}})})(e),getDialog:()=>p}}),define("DS/ENORouteMgmt/Views/Grid/TaskAssociatedContent",["DS/ENORouteMgmt/Config/ContentToReviewGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Model/InitiateRouteContentModel"],function(e,t,o){"use strict";let n=0,i=function(i){let s=o.getRouteContentModel();n=s._numberOfNodesInDocument;let a={};a=null!=i?i:document.querySelector("#taskAssociatedContent-dataGridViewContainer");let r={cellDragEnabledFlag:!1,showRowBorderFlag:!0,showOutlineFlag:!0,showAlternateBackgroundFlag:!1};r.layoutOptions={rowsHeader:!1,columnsHeader:!1,rowSpacing:5,cellWidth:2},r.showContextualMenuColumnFlag=!1,r.identifier="TaskAssociatedContent";let l=t.build(s,e,!1,a,r),d=document.querySelector("#taskAssociatedContentDatagridViewId");return null!=d&&l.inject(d),l},s=function(){var e=document.querySelector("#taskAssociatedContent-dataGridViewContainer");let t=n;e&&(0==t?e.setStyle("display","none"):t<5?(e.setStyle("height",41*t+"px"),e.setStyle("display","block"),e.setStyle("position","relative")):(e.setStyle("height","200px"),e.setStyle("display","block"),e.setStyle("position","relative")))};return{build:()=>(function(){let e=UWA.createElement("div",{id:"taskAssociatedContent-dataGridViewContainer",class:"taskAssociatedContent-dataGridViewContainerClass"});return i(e)})(),registerListners:()=>{widget.routeMgmtMediator.subscribe("task-associated-content-update",function(){i(),s()})},setContentDatagridHeight:()=>s()}}),define("DS/ENORouteMgmt/Views/Dialogs/RemoveRoute",["DS/WAFData/WAFData","UWA/Core","DS/ENORouteMgmt/EnoviaBootstrap","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ENORouteMgmt/Utilities/ParseJSONUtil","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView","DS/ENORouteMgmt/Actions/RouteActions","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c){"use strict";let m,p,g=function(e,t){d.DeleteRoute(e,t),p.close()},f=function(e,t,o){d.removeSubRoute(e,t,o),p.close()};return m={removeConfirmation:(e,t)=>(function(e,t){if(u.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Delete"}),void 0===e.data&&(e=r.getSelectedRowsModel()),e.data.length<1)return void widget.notify.handler().addNotif({level:"warning",subtitle:c.ErrorRouteRemoveSelection,sticky:!1});for(var o=[],a=[],l=UWA.createElement("ul",{class:"",styles:{"list-style-type":"circle"}}),d=UWA.createElement("ul",{class:"",styles:{"list-style-type":"circle"}}),m=0;m<e.data.length;m++)"FALSE"==e.data[m].options.grid.DeleteAccess?(a.push(e.data[m].options.grid.id),d.appendChild(UWA.createElement("li",{class:"",html:[UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-route"}),UWA.createElement("span",{text:" "+e.data[m].options.grid.Title})]}))):(o.push(e.data[m].options.grid.id),l.appendChild(UWA.createElement("li",{class:"",html:[UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-route"}),UWA.createElement("span",{text:" "+e.data[m].options.grid.Title})]})));let f=new i;f.inject(document.body);let h=new UWA.Element("div",{id:"removeRouteWarning",class:""});var w="";o.length>0&&(w=(w=1==o.length?c.removeRouteHeaderSingle:c.removeRouteHeader).replace("{count}",o.length),h.appendChild(UWA.createElement("div",{class:"",html:c.removeRouteWarning})),1==o.length?h.appendChild(UWA.createElement("div",{class:"",html:c.removeRouteWarningDetailSingle})):h.appendChild(UWA.createElement("div",{class:"",html:c.removeRouteWarningDetail})),h.appendChild(UWA.createElement("div",{class:""}).appendChild(l))),a.length>0&&(""==w&&(w=c.removeRouteHeader2),1==a.length?h.appendChild(UWA.createElement("div",{class:"",html:c.removeRouteWarningDetail2Single})):h.appendChild(UWA.createElement("div",{class:"",html:c.removeRouteWarningDetail2})),h.appendChild(UWA.createElement("div",{class:""}).appendChild(d)));var v=!1;a.length>0&&o.length<1&&(v=!0),p=new n({modalFlag:!0,width:500,height:200,title:w,content:h,domId:"RouteImmersiveFrame",immersiveFrame:f,buttons:{Ok:new s({label:c.Delete,disabled:v,onClick:function(e){e.dsModel.dialog,g(o,t)}}),Cancel:new s({onClick:function(e){e.dsModel.dialog.close()}})}})})(e,t),removeSubRouteConfirmation:e=>(function(e){u.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Delete Subroute"});var t=widget.data.contextId;if(void 0===e.data&&(e=r.getSelectedRowsModel()),e.data.length<1)return void widget.notify.handler().addNotif({level:"warning",subtitle:c.ErrorSubRouteRemoveSelection,sticky:!1});for(var a=[],l=[],d=[],m=UWA.createElement("ul",{class:"",styles:{"list-style-type":"circle"}}),g=UWA.createElement("ul",{class:"",styles:{"list-style-type":"circle"}}),h=0;h<e.data.length;h++)e.data[h].options.grid.UserName!=o.getLoginUser()?(d.push(e.data[h].options.grid.id),g.appendChild(UWA.createElement("li",{class:"",html:[UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-route"}),UWA.createElement("span",{html:"&nbsp;"+e.data[h].options.grid.Title})]}))):(a.push(e.data[h].options.grid.id),l.push(e.data[h].options.grid.UserName),m.appendChild(UWA.createElement("li",{class:"",html:[UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-route"}),UWA.createElement("span",{html:"&nbsp;"+e.data[h].options.grid.Title})]})));let w=new i;w.inject(document.body);let v=new UWA.Element("div",{id:"removeRouteWarning",class:""});var S="";a.length>0&&(S=(S=1==a.length?c.removeSubRouteHeaderSingle:c.removeSubRouteHeader).replace("{count}",a.length),v.appendChild(UWA.createElement("div",{class:"",html:c.removeSubRouteWarning})),1==a.length?v.appendChild(UWA.createElement("div",{class:"",html:c.removeSubRouteWarningDetailSingle})):v.appendChild(UWA.createElement("div",{class:"",html:c.removeSubRouteWarningDetail})),v.appendChild(UWA.createElement("div",{class:""}).appendChild(m))),d.length>0&&(""==S&&(S=c.removeSubRouteHeader2),1==d.length?v.appendChild(UWA.createElement("div",{class:"",html:c.removeSubRouteWarningDetail2Single})):v.appendChild(UWA.createElement("div",{class:"",html:c.removeSubRouteWarningDetail2})),v.appendChild(UWA.createElement("div",{class:""}).appendChild(g)));var R=!1;d.length>0&&a.length<1&&(R=!0),p=new n({modalFlag:!0,width:500,height:200,title:S,content:v,domId:"RouteImmersiveFrame",immersiveFrame:w,buttons:{Ok:new s({label:c.remove,disabled:R,onClick:function(e){e.dsModel.dialog,f(a,t,l)}}),Cancel:new s({onClick:function(e){e.dsModel.dialog.close()}})}})})(e)}}),define("DS/ENORouteMgmt/Views/Menu/RouteContextualMenu",["DS/Menu/Menu","DS/ENORouteMgmt/Views/Dialogs/RemoveRoute","DS/ENORouteMgmt/Actions/RouteActions","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Views/Dialogs/InitiateSaveAsTemplateDialog","DS/ENORouteMgmt/Views/Dialogs/RouteChangeOwnershipDialog","DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenuItems","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l){"use strict";let d,u=function(e,o){let n=!0;1===e.data.length&&"TRUE"!=e.data[0].options.grid.DeleteAccess&&(n=!1);var i=[];return n&&i.push({name:l.Delete,title:l.Delete,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash"},data:null,action:{callback:function(){t.removeConfirmation(e,o)}}}),i},c=function(e){var t=[];return-1!==e.data[0].options.grid.Actions.indexOf("saveAs")&&t.push({name:l.SaveasTemplate,title:l.SaveasTemplate,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-template-add"},data:null,action:{callback:function(){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Save as Template"}),i.InitiateSaveAsTemplateDialog(e)}}}),t},m=function(e){var t=[];return t.push({name:l.revisions,title:l.revisions,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-branch-list"},data:null,action:{callback:function(){o.renderRevisionsDialog(e.data[0].options.grid.id)}}}),t},p=function(e){var t=[];return t.push({name:l.Open,title:l.Open,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open"},data:null,action:{callback:function(){widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:e})}}}),t},g=function(e,t){var o=[];return o.push({name:l.changeOwner,title:l.changeOwner,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-change"},data:null,action:{callback:function(){s.routeChangeOwner(e,t)}}}),o},f=function(e,t,n,i){var s=[];return e?(-1!==e.indexOf("edit.startroute")&&s.push({name:l.start,title:l.start,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-status-change"},data:null,action:{callback:function(){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Start"}),o.startRoute(t)}}}),-1!==e.indexOf("edit.stoproute")&&s.push({name:l.stop,title:l.stop,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-stop"},data:null,action:{callback:function(){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Stop"}),o.stopRoute(t,n)}}}),-1!==e.indexOf("edit.resumeroute")&&s.push({name:l.resume,title:l.resume,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-resume"},data:null,action:{callback:function(){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Resume"}),o.resumeRoute(t)}}}),-1!==e.indexOf("edit.restartroute")&&s.push({name:l.restart,title:l.restart,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reset"},data:null,action:{callback:function(){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Restart"}),o.restartRoute(t,i)}}}),s):s},h=function(e){var o=[];return o.push({name:l.remove,title:l.remove,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},data:null,action:{callback:function(){t.removeSubRouteConfirmation(e)}}}),o};return d={routeIdCardCheveron:t=>(function(t){return UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-3x wux-ui-3ds-chevron-down fonticon-display fonticon-color-display",title:l.idCardHeaderActionRouteAction,styles:{"padding-top":"0px"},events:{click:function(o){var n=o.target.getBoundingClientRect(),i={position:{x:n.left,y:n.top+20}},s=u(t,!0);s=(s=s.concat(m(t))).concat(c(t)),-1!=t.data[0].options.grid.Actions.indexOf("changeowner")&&(s=s.concat(g(t,"idCard"))),s=s.concat(a.getCopyLink(t.data)),e.show(s,i)}}})})(t),routeIdCardStateCheveron:(t,o,n)=>(function(t,o,n){return t?-1===t.findIndex(e=>e.includes("edit."))?"":UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-chevron-down ",title:l.idCardHeaderRouteActivityState,styles:{"font-size":"18px","line-height":"24px"},events:{click:function(i){var s=i.target.getBoundingClientRect(),a={position:{x:s.left,y:s.top+20}},r=f(t,o,n,"idcard-ctxCommand");e.show(r,a)}}}):""})(t,o,n),routeGridCheveron:(t,o)=>(function(t,o){return UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-chevron-down ",events:{click:function(i){i.preventDefault(),i.stopPropagation();var s=i.target.getBoundingClientRect(),a={position:{x:s.left,y:s.top+20}},r=n.getSelectedRowsModel(),l=[];if(1===r.data.length){l=l.concat(p(r.data[0].options.grid));var d=r.data[0].options.grid.Title;l=(l=l.concat(f(t,o,d,"summarypage-ctxCommand"))).concat(m(r))}l=l.concat(u(r,!1)),null!=widget.data.contextTitle&&""!=widget.data.contextTitle&&(l=l.concat(h(r))),e.show(l,a)}}})})(t,o),routeTileCheveron:(e,t)=>(function(e,t){var o=n.getSelectedRowsModel(),i=[];if(1===o.data.length){i=i.concat(p(o.data[0].options.grid));var s=o.data[0].options.grid.Title;i=(i=i.concat(f(e,t,s,"summarypage-ctxCommand"))).concat(m(o)),-1!=o.data[0].options.grid.Actions.indexOf("changeowner")&&(i=i.concat(g(o,"summaryPage"))),i=i.concat(a.getCopyLink(o.data))}return o.data.length>1&&(i=i.concat(g(o,"summaryPage"))),i=i.concat(u(o,!1)),null!=widget.data.contextTitle&&""!=widget.data.contextTitle&&(i=i.concat(h(o))),i})(e,t),routeMaturityStateMenus:(e,t,o,n)=>f(e,t,o,n),routeGridRightClick:(t,o)=>(function(t,o){t.preventDefault(),t.stopPropagation();var i=t.target.getBoundingClientRect(),s={position:{x:i.left,y:i.top+20}},r=n.getSelectedRowsModel(),l=[];1===r.data.length&&(l=(l=(l=l.concat(p(o))).concat(f(o.Actions,o.id,o.Title,"summarypage-ctxCommand"))).concat(m(r)),-1!=o.Actions.indexOf("changeowner")&&(l=l.concat(g(r,"summaryPage"))),l=l.concat(a.getCopyLink(r.data))),r.data.length>1&&(l=l.concat(g(r,"summaryPage"))),l=l.concat(u(r,!1)),null!=widget.data.contextTitle&&""!=widget.data.contextTitle&&(l=l.concat(h(r))),e.show(l,s)})(t,o)}}),define("DS/ENORouteMgmt/Views/Grid/InitiateRouteContentsDataGridView",["DS/ENORouteMgmt/Config/InitiateRouteContentsViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Config/Toolbar/InitiateRouteContentTabToolbarConfig","DS/ENORouteMgmt/Utilities/DragAndDropManager"],function(e,t,o,n){"use strict";let i,s={},a=function(){let o=t.dataGridView();for(let t=0;t<e.length;t++)o.layout.setColumnVisibleFlag(e[t].dataIndex,e[t].visibility)};return{build:r=>(function(r){var l=UWA.createElement("div",{id:"dataGridViewContainer",class:"iContents-gridView-View showView"});let d=o.writetoolbarDefination();s.cellDragEnabledFlag=!0;let u=t.build(r,e,d,l,s);return a(),(i=t.dataGridView()).onDragStartCell=function(e,t){return n.getContentForDrag(e,t),!0},i.onDragEndCell=function(e,t){e.target.removeClassName("wux-ui-state-activated wux-ui-state-highlighted")},u})(r),getGridViewToolbar:()=>t.dataGridViewToolbar()}}),define("DS/ENORouteMgmt/Views/Menu/ContentContextualMenuItems",["DS/ENORouteMgmt/Views/Dialogs/RemoveContent","DS/ENORouteMgmt/Commands/RouteOpenWith","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/UIKIT/Dropdown","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/CopyLinkContentAppId","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r){"use strict";let l=function(t,o){var n=[];return t&&n.push({name:r.deleteContent,title:r.deleteContent,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},data:null,action:{callback:function(){e.removeConfirmation(o)}}}),n},d=function(e,t){var o=[];return e&&o.push({name:r.deleteContent,title:r.deleteContent,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},data:null,action:{callback:function(){t()}}}),o},u=function(e,t,o){var n=[];return e&&n.push({name:r.deleteContent,title:r.deleteContent,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},data:null,action:{callback:function(){t(o)}}}),n};return{addPreviewCommand:(e,t)=>(function(e,t){let o=e.Preview,n={name:o.name,title:o.title,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-"+o.fonticon},action:{callback:o.handler}};return t.push(n),t})(e,t),addDownloadCommand:(e,t)=>(function(e,t){let o=e.Download,n={name:o.name,title:o.title,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-"+o.fonticon},action:{callback:o.handler}};return t.push(n),t})(e,t),deleteMenu:e=>(function(e){var t=!0;return e.data.forEach(e=>{"false"==e._options.grid.canDeleteContent&&(t=!1)}),l(t,e)})(e),deleteMenuForTile:e=>(function(e){var t=!0;return e.forEach(e=>{"false"==e.canDeleteContent&&(t=!1)}),l(t,e)})(e),previewMenu:e=>(function(e){var t=[];return t.push({name:r.contentPreview,title:r.contentPreview,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-info"},data:null,action:{callback:function(){widget.routeMgmtMediator.publish("route-content-preview-click",{model:{id:e}})}}}),t})(e),getOpenWithMenu:e=>(function(e){let o=[];return new Promise(function(n,i){t.getOpenWithMenu(e).then(e=>{e&&e.length>0&&o.push({id:"OpenWith",type:"PushItem",title:r.openWith,icon:"export",submenu:e}),n(o)},e=>{n(o)})})})(e),addUpdateOrEditCommand:(e,t,o)=>(function(e,t,o){let n=e.Edit;if(n){let e={name:n.name,title:n.title,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-"+n.fonticon},action:{callback:n.handler}};t.push(e)}let i=e.Update;if(i){let e={name:i.name,title:i.title,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-"+i.fonticon},action:{callback:i.handler}};t.push(e)}let s=e.UndoEdit;if(s){let e={name:s.name,title:s.title,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-"+s.fonticon},action:{callback:s.handler}};t.push(e)}return t})(e,t),deleteMenuForAttachments:(e,t)=>(function(e,t){var o=!0;return e.forEach(e=>{"false"==e.canDeleteContent&&(o=!1)}),d(o,t)})(e,t),deleteMenuForRouteTaskContentToReview:(e,t,o)=>(function(e,t,o){var n=!0;return e.forEach(e=>{"false"==e.canDeleteContent&&(n=!1)}),u(n,t,o)})(e,t,o)}}),define("DS/ENORouteMgmt/Views/Menu/ContentContextualMenu",["DS/Menu/Menu","DS/ENORouteMgmt/Actions/ContentActions","DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Views/Dialogs/RemoveContent","DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Commands/RouteDocumentCommands","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Commands/RouteOpenWith","DS/ENORouteMgmt/Views/Menu/ContentContextualMenuItems","DS/ENORouteMgmt/Utilities/RouteDocumentUtils","DS/ENORouteMgmt/Utilities/CopyLinkContentAppId","DS/RouteWebAppUX/Views/Menu/AttachmentContextualMenuItems","DS/ENORouteMgmt/Utilities/ContentTargetMaturityUtils","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g){"use strict";let f,h,w,v,S=[],R=function(e,t,o,n,i){var s=[];h&&d.getCommands(w,v,h,t,function(t){-1!==e.indexOf("Preview")&&-1!==e.indexOf("Download")&&(s=t),n(s)},i)},y=function(t,o,n,i,s,a,r){n.preventDefault(),n.stopPropagation();let d=n.target.getBoundingClientRect(),m={position:{x:d.left,y:d.top+20}},p=[],g=[],f=["Remove","Download","Preview"];if(p.push(t[0].options.grid),1===t.length){"ENXROUT_AP"==widget.getValue("appId")&&(g=g.concat(l.previewMenu(i)));var w=p[0].Type;"true"==u.isCopyLink(w)&&(g=g.concat(c.getCopyLink(t))),l.getOpenWithMenu(o).then(function(t){g=g.concat(t),h?R(f,i,0,function(t){g=g.concat(t),s||(g=g.concat(l.deleteMenuForAttachments(p,a))),e.show(g,m)},r):(s||(g=g.concat(l.deleteMenuForAttachments(p,a))),e.show(g,m))})}else s||(g=g.concat(l.deleteMenuForAttachments(p,a))),e.show(g,m)},M=function(t,o,n,i,s,a,r){n.preventDefault(),n.stopPropagation();let d=n.target.getBoundingClientRect(),m={position:{x:d.left,y:d.top+20}},p=[],g=[],f=[];if(p.push(t[0].options.grid),1===t.length){"ENXROUT_AP"==widget.getValue("appId")&&(g=g.concat(l.previewMenu(i)));var w=p[0].Type;"true"==u.isCopyLink(w)&&(g=g.concat(c.getCopyLink(t))),l.getOpenWithMenu(o).then(function(t){g=g.concat(t),h?(("Document"==w||S.includes(w))&&(f=["Download","Preview"]),R(f,i,0,function(t){g=g.concat(t),e.show(g,m)},r)):e.show(g,m)})}},T=function(t,o,n,i,s,a,r,d){n.preventDefault(),n.stopPropagation();let m=n.target.getBoundingClientRect(),p={position:{x:m.left,y:m.top+20}},g=[],f=[],w=[];if(g.push(t[0].options.grid),1===t.length){"ENXROUT_AP"==widget.getValue("appId")&&(f=f.concat(l.previewMenu(i)));var v=g[0].Type;"true"==u.isCopyLink(v)&&(f=f.concat(c.getCopyLink(t))),l.getOpenWithMenu(o).then(function(t){f=f.concat(t),h?(("Document"==v||S.includes(v))&&(w=["Download","Preview"]),R(w,i,0,function(t){f=f.concat(t),!s&&g[0].canDeleteContent&&(f=f.concat(l.deleteMenuForRouteTaskContentToReview(g,a,d))),e.show(f,p)},r)):(s||(f=f.concat(l.deleteMenuForRouteTaskContentToReview(g,a,d))),e.show(f,p))})}else s||(f=f.concat(l.deleteMenuForRouteTaskContentToReview(g,a,d))),e.show(f,p)};return f={contentContextualMenu:(e,t,o)=>R(e,t),contentsGridRightClick:(t,n,s,a)=>(function(t,n,s,a){t.preventDefault(),t.stopPropagation();var r=t.target.getBoundingClientRect(),d={position:{x:r.left,y:r.top+20}},p=i.getSelectedRowsModel(),g=[],f=[];1===p.data.length?(g=g.concat(l.previewMenu(n.id)),"true"==u.isCopyLink(n.Type)&&(g=g.concat(c.getCopyLink(p.data))),g=(g=g.concat(o.getBlockingMaturityContextualMenu(n,"RouteContent",s,a))).concat(m.getTargetMaturityContextualMenu(n,"RouteContent",s,a)),l.getOpenWithMenu(p.data[0]).then(function(t){g=g.concat(t),h?(("Document"==n.Type||S.includes(n.Type))&&(f=["Download","Preview"]),R(f,n.id,0,function(t){g=(g=g.concat(t)).concat(l.deleteMenu(p)),e.show(g,d)})):(g=g.concat(l.deleteMenu(p)),e.show(g,d))})):(g=g.concat(l.deleteMenu(p)),e.show(g,d))})(t,n,s,a),isDocumentManagementInstalled:()=>{require(["DS/DocumentCommands/DocumentCommandsV2","DS/DocumentCommands/TypeDerivativesCache","DS/DocumentCommands/Constants","DS/CoreEvents/ModelEvents"],function(e,t,o,n){h=e,w=o,v=n;let i=["Document"];t.getTypeDerivatives(i,function(e){S=e[i[0]]},a.get3DSpaceURL())},function(e){widget.notify.handler().addNotif({level:"error",subtitle:g.documentManagementNotInstalled,sticky:!1})})},tileContextualMenu:(t,n,i)=>(function(t,n,i){let s=t.data.event;s.preventDefault(),s.stopPropagation();var a=s.target.getBoundingClientRect(),r={position:{x:a.left,y:a.top+20}},d=[],p=[],g=[],f=t.cellInfos.nodeModel?t.cellInfos.nodeModel:t.cellInfos.cellModel;if(t&&t.cellInfos&&t.cellInfos.cellModel){var w=n.getSelectedNodes(),v=w[0].options.grid.Type;if(g.push(w[0].options.grid),p="Document"==v||S.includes(v)?["Remove","Download","Preview"]:["Remove"],1===w.length){var y=w[0]._options.grid.id;d=d.concat(l.previewMenu(y));var M=g[0].Type;"true"==u.isCopyLink(M)&&(d=d.concat(c.getCopyLink(w)));var T="",b="";n&&n.routeModel&&(T=n.routeModel.state,b=n.routeModel),d=(d=d.concat(o.getBlockingMaturityContextualMenu(w[0]._options.grid,"RouteContent",T,b))).concat(m.getTargetMaturityContextualMenu(w[0]._options.grid,"RouteContent",T,b)),l.getOpenWithMenu(f).then(function(t){d=d.concat(t),h?R(p,y,0,function(t){d=(d=d.concat(t)).concat(l.deleteMenuForTile(g)),e.show(d,r)},i):(d=d.concat(l.deleteMenuForTile(g)),e.show(d,r))})}else d=d.concat(l.deleteMenuForTile(g)),e.show(d,r)}})(t,n,i),taskAttachmentContextualMenu:(e,t,o,n,i)=>(function(e,t,o,n,i){let s=e.data.event,a=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(e&&e.cellInfos&&e.cellInfos.cellModel){let e=t.getTreeDocument().getSelectedNodes(),r=e[0]._options.grid.id;y(e,a,s,r,o,n,i)}})(e,t,o,n,i),taskAttachmentGridRightClick:(e,t,o,n)=>(function(e,t,o,n){let s=i.getSelectedRowsModel();s.length>0&&y(s,s.data[0],e,t.id,o,n)})(e,t,o,n),taskContentToReviewContextualMenu:(e,t,o,n,i)=>(function(e,t,o,n,i){let s=e.data.event,a=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(e&&e.cellInfos&&e.cellInfos.cellModel){let e=t.getTreeDocument().getSelectedNodes(),r=e[0]._options.grid.id;M(e,a,s,r,o,n,i)}})(e,t,o,n,i),routeTaskContentToReviewContextualMenu:(e,t,o,n,i,s)=>(function(e,t,o,n,i,s){let a=e.data.event,r=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(e&&e.cellInfos&&e.cellInfos.cellModel){let e=t.getTreeDocument().getSelectedNodes(),l=e[0]._options.grid.id;T(e,r,a,l,o,n,i,s)}})(e,t,o,n,i,s),routeTaskContentToReviewGridRightClick:(e,t,o,n,i)=>(function(e,t,o,n,i){let s=p.getSelectedRowsModel();s.length>0&&T(s,s.data[0],e,t.id,o,n,i)})(e,t,o,n,i),drawRouteTaskContentToReviewMenu:(e,t,o,n,i,s)=>T(e,t,o,n,i,s)}}),define("DS/ENORouteMgmt/Views/RouteHeaderView",["DS/ENORouteMgmt/Views/Menu/RouteContextualMenu","DS/WebappsUtils/WebappsUtils","DS/ResizeSensor/js/ResizeSensor","DS/ENORouteMgmt/Utilities/IdCardUtil","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Actions/RouteActions","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r){"use strict";let l;var d=function(e){this.container=e};d.prototype.resizeSensor=function(){new o(l,function(){n.resizeIDCard(l.offsetWidth)})},d.prototype.resizeIDCard=function(){n.resizeIDCard(l.offsetWidth)},d.prototype.init=function(o,n){l=new UWA.Element("div",{id:"routeIdCard",class:""}),this.container.appendChild(l);var i=new UWA.Element("div",{id:"infoAndThumbnailSec",class:"id-card-info-and-thumbnail-section"});l.appendChild(i);UWA.createElement("div",{id:"routeHome",class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-home fonticon-display fonticon-color-display",title:r.home,styles:{"font-size":"20px"},events:{click:function(e){g()}}}).inject(i);var s=new UWA.Element("div",{id:"thumbnailSection",class:"id-card-thumbnail-section",html:[UWA.createElement("div",{class:"id-card-thumbnail",styles:{"background-image":"url("+t.getWebappsAssetUrl("ENORouteMgmt","icons/144/I_Route108x144.png")+")"}})]});i.appendChild(s);var d=new UWA.Element("div",{id:"infoSec",class:"id-card-info-section no-bottom-border"});i.appendChild(d);var f=new UWA.Element("div",{id:"infoHeaderSec",class:"id-card-header-section"});d.appendChild(f);var h=new UWA.Element("div",{id:"infoHeaderSecTitle",class:"id-card-title-section"});f.appendChild(h),UWA.createElement("h4",{title:o.model.Title,text:o.model.Title}).inject(h);var w=new UWA.Element("div",{id:"infoHeaderSecAction",class:"id-card-actions-section"});f.appendChild(w);let v=widget.getValue("routeIdCardPersistency"),S="wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-expand-down fonticon-display fonticon-color-display",R=r.idCardHeaderActionExpand;v&&"maximized"==v&&(S="wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-expand-up fonticon-display fonticon-color-display",R=r.idCardHeaderActionCollapse),UWA.createElement("div",{id:"expandCollapse",class:S,title:R,styles:{"font-size":"20px"},events:{click:function(e){u()}}}).inject(w);var y={},M=[],T={options:{}};T.options.grid=o.model,M.push(T),y.data=M,("Complete"!=M[0].options.grid.state&&o.model.Actions.indexOf("delete")>-1||o.model.Actions.indexOf("saveAs")>-1||o.model.Actions.indexOf("changeowner")>-1)&&e.routeIdCardCheveron(y).inject(w);var b="fonticon-color-display";n&&(b="fonticon-color-active"),UWA.createElement("div",{id:"routeInfoIcon",title:r.idCardHeaderActionInfo,class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-info fonticon-display "+b+" ",styles:{"font-size":"20px"},events:{click:function(e){a.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Properties"}),widget.getValue("propWidgetOpen")?widget.routeMgmtMediator.publish("route-info-close-click",{info:"Route"}):widget.routeMgmtMediator.publish("route-header-info-click",{model:o.model,info:"Route"})}}}).inject(w);var C=new UWA.Element("div",{id:"infoDetailedSec",class:"id-card-detailed-info-section"});d.appendChild(C);var D=new UWA.Element("div",{id:"channel1",class:"properties-channel"});C.appendChild(D),p(o).inject(D),UWA.createElement("div",{html:[UWA.createElement("label",{html:r.IDcardOwner+"&nbsp;:&nbsp;",class:""}),UWA.createElement("span",{html:o.model.OwnerFullName,class:""})]}).inject(D);var k=o.model.ProjectTitle;k||(k=o.model.Project),UWA.createElement("div",{html:[UWA.createElement("label",{html:r.IDcardCollSpace+"&nbsp;:&nbsp;",class:""}),UWA.createElement("span",{html:k,class:""})]}).inject(D);var E=new UWA.Element("div",{id:"channel2",class:"properties-channel"});C.appendChild(E),UWA.createElement("div",{html:[UWA.createElement("label",{html:r.revision+"&nbsp;:&nbsp;",class:""}),UWA.createElement("span",{html:m(o.model.id,o.model.revision),class:""})]}).inject(E);var O=new Date(o.model.Modified);UWA.createElement("div",{html:[UWA.createElement("label",{html:r.IDcardModified+"&nbsp;:&nbsp;",class:""}),UWA.createElement("span",{html:O.toGMTString().parseRelativeTime(),class:""})]}).inject(E);var N=o.model.TemplateTitle;null!=N&&o.model.TemplateTitle.length>30&&(N=o.model.TemplateTitle.substring(0,27)+"..."),UWA.createElement("div",{html:[UWA.createElement("label",{html:r.routeTemplate+"&nbsp;:&nbsp;",class:""}),UWA.createElement("span",{html:N,title:o.model.TemplateTitle,class:""}),UWA.createElement("span",{html:"&nbsp;",class:""}),UWA.createElement("span",{html:c(o.model.TemplateId,o.model.TemplateRevision),class:""})]}).inject(E);var A=new UWA.Element("div",{id:"channel3",class:"properties-channel"});C.appendChild(A),UWA.createElement("div",{class:"id-card-description",html:[UWA.createElement("span",{text:o.model.Description,title:o.model.Description,class:""})]}).inject(A)},d.prototype.destroyContainer=function(){this.container.destroy()},d.prototype.destroyContent=function(){l.destroy()};let u=function(){var e=document.querySelector("#expandCollapse"),t=document.querySelector("#routeHeaderContainer");document.querySelector("#graph_canvas_view");let o=document.querySelector(".route-graph-task-container");if(e.className.indexOf("wux-ui-3ds-expand-up")>-1){if(e.className=e.className.replace("wux-ui-3ds-expand-up","wux-ui-3ds-expand-down"),t.classList.add("minimized"),e.title=r.idCardHeaderActionExpand,(n=document.querySelector("#thumbnailSection"))&&n.className.indexOf("id-card-thumbnail-remove")>-1)(i=document.querySelector("#infoSec")).classList.remove("id-info-section-align"),i.classList.add("id-info-section-align-minimized");null!=o&&o.setStyle("height","calc(100% - 96px)"),widget.setValue("routeIdCardPersistency","minimized")}else{var n,i;if(e.className=e.className.replace("wux-ui-3ds-expand-down","wux-ui-3ds-expand-up"),t.classList.remove("minimized"),e.title=r.idCardHeaderActionCollapse,(n=document.querySelector("#thumbnailSection"))&&n.className.indexOf("id-card-thumbnail-remove")>-1)(i=document.querySelector("#infoSec")).classList.remove("id-info-section-align-minimized"),i.classList.add("id-info-section-align");null!=o&&o.style.removeProperty("height"),widget.setValue("routeIdCardPersistency","maximized")}},c=function(e,t){if(null!=e&&""!=e){var o=UWA.createElement("a");return o.set({title:r.revision,text:t,phyId:e,revision:t,class:"cursorPointer",events:{click:function(){s.renderRevisionsDialog(this.getAttribute("phyid"))}}}),o}},m=function(e,t){if(null!=e&&""!=e){var o=UWA.createElement("a");return o.set({title:r.revision,text:t,phyId:e,revision:t,class:"cursorPointer",events:{click:function(){s.renderRevisionsDialog(this.getAttribute("phyid"))}}}),o}},p=function(t){let o=UWA.createElement("div",{class:"maturity-state-container"});UWA.createElement("label",{class:"ms-label",html:r.IDcardMaturityState+"&nbsp;:"}).inject(o),UWA.createElement("span",{class:"route-state-title "+t.model.state.toUpperCase().replace(/ /g,""),html:"&nbsp;"+t.model.Maturity_State+"&nbsp;",styles:{margin:"0 5px 0 5px"}}).inject(o);if(t.model.state&&"In Process"==t.model.state){let e=UWA.createElement("div",{class:"activity-state-container"}).inject(o),n=i.getRouteActivityStateIcon(t.model.Activity_State),s=UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+n}).inject(e),a=i.getRouteActivityStateNLS(t.model.Activity_State);if(t.model.Activity_State&&t.model.Activity_State.contains("your")){let o;if(t.model.Activity_State.contains("(")){const e=a.split("(");a=e[0],o="("+e[1]}s.addClassName("awaiting-tasks");UWA.createElement("a",{class:"rt-activity-state",html:"&nbsp;"+a,title:a,events:{click:function(e){widget.routeMgmtMediator.publish("OPEN-TASK-PROPERTIES",{info:"Route"})}},styles:{cursor:"pointer"}}).inject(e);if(o){UWA.createElement("a",{class:"rt-activity-state-counter",html:"&nbsp;"+o+"&nbsp;",title:a,events:{click:function(e){widget.routeMgmtMediator.publish("OPEN-TASK-PROPERTIES",{info:"Route"})}},styles:{cursor:"pointer"}}).inject(e)}}else{UWA.createElement("span",{class:"rt-activity-state",html:"&nbsp;"+a+"&nbsp;",title:a}).inject(e)}}let n=i.getRouteActions(t.model.Actions);if(i.isRouteActionStart(t.model.Actions)){let e=i.getRouteActionIcon(t.model.Actions);UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-"+e.name,styles:{color:e.color}}).inject(o);var a=0;UWA.createElement("a",{class:"",html:"&nbsp;"+n[0]+"&nbsp;",events:{click:function(e){widget.routeMgmtMediator.subscribeOnce("route-get-count-value",function(e){a=e}),++a>1&&widget.notify.handler().addNotif({level:"error",subtitle:r.routeStartOperation,sticky:!1}),1==a&&s.startRoute(t.model.id)}},styles:{"font-weight":"bold",cursor:"pointer"}}).inject(o)}else{UWA.createElement("span",{html:e.routeIdCardStateCheveron(t.model.Actions,t.model.id,t.model.Title)}).inject(o)}return o},g=function(){if(widget.routeMgmtMediator.publish("route-back-to-summary"),widget.routeMgmtMediator.publish("route-tag-data-updated"),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),require(["DS/ENORouteMgmt/Model/RouteModel"],function(e){widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:e.getModel()})}),widget.setValue("openedRouteId",void 0),widget.setValue("taskIdTobePersisted",void 0),widget.setValue("routeIdToBePersisted",void 0),null!=widget.data.contextTitle&&""!=widget.data.contextTitle&&null!=widget.data.fromContext&&"createNewRoute"==widget.data.fromContext){var e={id:"routes"};widget.routeMgmtMediator.publish("welcome-panel-action-selected",e)}else if(null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle&&null!=widget.data.fromContext&&"createNewRoute"==widget.data.fromContext){e={id:"routes"};widget.routeMgmtMediator.publish("welcome-panel-action-selected",e)}};return d}),define("DS/ENORouteMgmt/Views/Tile/RouteSummaryTileView",["DS/WAFData/WAFData","UWA/Core","DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Views/Menu/RouteContextualMenu","DS/WebappsUtils/WebappsUtils","DS/Core/PointerEvents","DS/ENORouteMgmt/Utilities/DragAndDropManager","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r){"use strict";let l,d,u=function(){let e=o.tileView();e.onDragStartCell=function(e,t){a.getContentForDrag(e,t)},e.onDragEndCell=function(e,t){e.target.removeClassName("wux-ui-state-activated wux-ui-state-highlighted")},e.onDropCell=function(e,t){a.onDropManager(e,t)}};return{build:e=>(function(e){d=e||new TreeDocument({useAsyncPreExpand:!0});let n=widget.getValue("RouteSummary-ShowView"),i="tile-view-container hideView";n&&"TileView"==n&&(i="tile-view-container showView"),l=t.createElement("div",{id:"TileViewContainer",class:i});let s=o.build(d,l,!0);return u(),s})(e),contexualMenuCallback:()=>{o.tileView().onContextualEvent={callback:function(e){var t=[];if(e&&e.cellInfos&&e.cellInfos.cellModel){var o=d.getSelectedNodes(),i=o[0].options.grid.Actions,s=o[0]._options.grid.id;t=n.routeTileCheveron(i,s)}return t}}},destroy:()=>{!function(){let e=o.tileView();e&&e.destroy()}()},getTileViewInstance:()=>o.tileView()}}),define("DS/ENORouteMgmt/Views/RouteSummaryView",["DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Views/Tile/RouteSummaryTileView","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Controller/CollabTaskServicesController","DS/Utilities/Array","DS/Core/PointerEvents","DS/ENORouteMgmt/Utilities/Utils","DS/ENORouteMgmt/Components/TagNavigator","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g,f){"use strict";let h=[],w=function(e){a.createModel(e);let t=C();return s.getSecurityContextValue()?l.hideeErrorPlaceholder(t):(b(t),widget.notify.handler().addNotif({title:f.errorCreateRouteForRoleTitle,subtitle:f.errorCreateRouteForRoleSubTitle,message:f.errorCreateRouteForRoleMsg,level:"warning",sticky:!1})),t},v=function(e){b(document.querySelector(".widget-container"));var t="";try{t=JSON.parse(e)}catch(e){}t.error?widget.notify.handler().addNotif({level:"error",subtitle:t.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:f.infoRefreshError,sticky:!1})},S=function(){let e;return void 0!==widget.data.ids&&(e=widget.data.ids),widget.data.contentId&&(e=widget.data.contentId),widget.data.routeId&&(e=widget.data.routeId),e},R=function(){return widget.data.approvalProcessIds},y=function(){return widget.data.approvalProcessType},M=function(){widget.data.approvalProcessIds=void 0,widget.data.approvalProcessType=void 0,widget.data.contentId=void 0},T=function(){void 0!==widget.data.ids&&(widget.data.ids=void 0),widget.data.contentId&&(widget.data.contentId=void 0),widget.data.routeId&&(widget.data.routeId=void 0),widget.data.approvalProcessIds&&(widget.data.approvalProcessIds=void 0),widget.data.approvalProcessType&&(widget.data.approvalProcessType=void 0)};function b(e){e||(e=new UWA.Element("div",{class:"widget-container"})).inject(widget.body),l.hideEmptyRoutePlaceholder(e),l.showeErrorPlaceholder(e)}let C=function(t){widget.setValue("HomePage","routes");var o=a.getModel();let n=e.build(o),s=i.build(o);i.contexualMenuCallback(),j();let r,d=e.getGridViewToolbar(),u=document.querySelector(".widget-container");r=u||new UWA.Element("div",{class:"widget-container"});let c=UWA.createElement("div",{id:"dataGridDivToolbar",class:"toolbar-container"}).inject(r);d.inject(c),n.inject(r),s.inject(r);var m=[];if(0==o.getChildren().length)l.showEmptyRoutePlaceholder(r,o);else{o.prepareUpdate();var p=0;o.getChildren().forEach(e=>{e._isHidden&&p++,m.push(e.options.id)}),o.pushUpdate(),p==o.getChildren().length&&l.showEmptyRoutePlaceholder(r,o)}return widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:o}),l.registerListeners(),m.length>1e3&&widget.notify.handler().addNotif({message:f.taggerWarning,level:"warning",sticky:!1}),x(m),widget.getValue("openSelected")&&(H(),widget.setValue("openSelected",void 0)),r},D=function(){let e=U(),t="";e.indexOf("Define")>-1&&(t+="Define,"),e.indexOf("In Process")>-1&&(t+="In_Process,"),e.indexOf("Complete")>-1&&(t+="Complete,"),""==t||(t=t.slice(0,-1)),widget.setValue("routeStateFilter",t)},k=function(){let e=U(),t="";e.indexOf("assigned")>-1&&(t+="Assigned,"),e.indexOf("owned")>-1&&(t+="Owned,"),""==t||(t=t.slice(0,-1)),widget.setValue("ownershipFilter",t)},E=function(t){let o=e.getDataGridInstance(),n=i.getTileViewInstance();t?(o.displayModalLoader(f.loadingRoutesMessage),n.displayModalLoader(f.loadingRoutesMessage)):(o.removeModalLoader(f.loadingRoutesMessage),n.removeModalLoader(f.loadingRoutesMessage))},O=function(e){var t=a.getModel(),o=g.getTaggerVariable(),n=g.getSearchWithInTypedValue();t.prepareUpdate(),c.optimizedForEach(t.getChildren(),function(t){null==n&&0==Object.keys(o.getCurrentFilter().allfilters).length?t.show():e.includes(t.options.id)?t.show():t.hide()});t.getChildren().forEach(e=>{e._isHidden&&0}),t.pushUpdate(),document.querySelector(".right-container")&&"0px"==document.querySelector(".right-container").getStyle("width")&&widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:t})},N=function(e){var t=s.getLoginUser();if(e)(E(!0),D(),k(),new Promise(function(e,t){d.fetchAllRoutes().then(t=>{E(!1);var o=a.getModel();o.prepareUpdate(),o.removeRoots(),o.pushUpdate();let n=document.querySelector(".widget-container");null!=n&&(0==t.length?l.showEmptyRoutePlaceholder(n,o):l.hideEmptyRoutePlaceholder(n)),a.appendAllRows(t),H(),e(t)},e=>{_dataGridView.removeModalLoader()})})).then(e=>{let t=a.getModel();widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:t}),widget.routeMgmtMediator.publish("route-tag-data-updated")},e=>{v(e)});else{var o=U(),n=a.getModel();let e=n.getSelectedNodes();n.prepareUpdate(),c.optimizedForEach(n.getChildren(),function(e){(o.indexOf("assigned")>=0&&o.indexOf("owned")>=0||o.indexOf("owned")>=0&&e.options.grid.ownerFilter==t||o.indexOf("assigned")>=0&&e.options.grid.Assignees&&e.options.grid.Assignees.toString().indexOf("Person~"+t+"~")>=0)&&o.indexOf(e.options.grid.actualState)>=0?e.show():e.hide()});var i=0;n.getChildren().forEach(e=>{e._isHidden&&i++}),n.pushUpdate(),e&&1==e.length&&e[0]._isHidden&&F(),(0==e.length||document.querySelector(".right-container")&&"0px"==document.querySelector(".right-container").getStyle("width"))&&widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:n});let s=document.querySelector(".widget-container");null!=s&&(n.getChildren().length==i?l.showEmptyRoutePlaceholder(s,n):l.hideEmptyRoutePlaceholder(s))}p.refreshRightPanel("Route",a)},A=function(o){let n=R(),i=y();"routes"===widget.getValue("HomePage")&&(null==widget.getValue("openedRouteId")&&null==a.getOpenedRouteModel()||(widget.routeMgmtMediator.publish("route-back-to-summary"),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),widget.setValue("openedRouteId",void 0)));let s=e.getGridViewToolbar().getNodeModelByID("filter");if(s&&(s=s.options.grid.data.menu,widget.setValue("routefilters",["owned","assigned","Define","In Process","Complete","filterbyobject"]),s.forEach(function(e){"unselected"==e.state&&(e.state="selected")})),"Route"==i){let e=t.getIdsForServicePayload(n);return E(!0),new Promise(function(t,n){d.fetchRouteByIds(e).then(e=>{E(!1);var n=a.getModel();n.prepareUpdate(),n.removeRoots(),n.pushUpdate();let i=document.querySelector(".widget-container");null!=i&&(0==e.length?l.showEmptyRoutePlaceholder(i,n):l.hideEmptyRoutePlaceholder(i)),a.appendAllRows(e),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:a.getModel()}),widget.routeMgmtMediator.publish("route-tag-data-updated"),H(),M(),null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle&&"summary-onchange"!=o&&widget.routeMgmtMediator.publish("load-filterbyobject-search"),t(e)},e=>{_dataGridView.removeModalLoader(),n()})})}if("Inbox Task"==i)return E(!0),new Promise(function(e,t){u.getRouteIdByTask(n[0]).then(t=>{widget.data.contentId=t,d.fetchRouteById(t).then(t=>{D(),k(),E(!1);var n=a.getModel();n.prepareUpdate(),n.removeRoots(),n.pushUpdate(),E(!1);let i=document.querySelector(".widget-container");null!=i&&(0==t.length?l.showEmptyRoutePlaceholder(i,n):l.hideEmptyRoutePlaceholder(i)),a.appendAllRows(t),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:a.getModel()}),null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle&&"summary-onchange"!=o&&widget.routeMgmtMediator.publish("load-filterbyobject-search"),H(),M(),e(t)},e=>{v(e)})},e=>{v(e)})});{let e=t.getIdsForServicePayload(n);return new Promise(function(o,n){d.fetchApprovalStatusForContent(e).then(e=>{let o=e.data[0].relateddata.route;var n=[];let i;for(var s=0;s<o.length;s++){var r={};r.id=o[s].dataelements.id,n.push(r)}return i=t.getIdsForServicePayload(n),new Promise(function(e,t){d.fetchRouteByIds(i).then(t=>{D(),k(),E(!1);var o=a.getModel();o.prepareUpdate(),o.removeRoots(),o.pushUpdate();let n=document.querySelector(".widget-container");null!=n&&(0==t.length?l.showEmptyRoutePlaceholder(n,o):l.hideEmptyRoutePlaceholder(n)),a.appendAllRows(t),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:a.getModel()}),widget.routeMgmtMediator.publish("route-tag-data-updated"),H(),M(),e(t)},e=>{_dataGridView.removeModalLoader()})})},e=>{widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:f.errorMessage,sticky:!0}),o()})})}},I=function(e,t){var o=[];g.getSearchResult(e,t).then(t=>{if(t.results)for(var n=0;n<t.results.length;n++)o.push(t.results[n].attributes[0].value);O(o),t.infos&&t.infos.nmatches>1e3&&g.getSearchResult(e,o)})},U=function(){var e=widget.getValue("routefilters");return S()?(widget.setValue("routefilters",["owned","assigned","Define","In Process","Complete"]),["owned","assigned","Define","In Process","Complete"]):null==e?(widget.setValue("routefilters",["owned","assigned","Define","In Process"]),["owned","assigned","Define","In Process"]):e},x=function(e){var t=g.setTaggerProxy("Route");t.addEvent("onFilterChange",function(e){var t=W(),o=g.getSearchWithInTypedValue(),n=g.getTaggerVariable().getCurrentFilter();t.length>1e3&&null==o&&(t=t.slice(0,1e3)),I(n.allfilters,t)});var o=t.getCurrentFilter().allfilters;if(0==e.length)g.setTagsForSummaryPage([]);else{e.length>1e3&&(e=e.slice(0,1e3));var n=g.getSearchWithInTypedValue(),i=[];g.getSearchResult(o,e).then(e=>{if(e.results)for(var o=0;o<e.results.length;o++)i.push(e.results[o].attributes[0].value);(null!=n||Object.keys(t.getCurrentFilter().allfilters).length>0)&&O(i)})}},F=function(){widget.routeMgmtMediator.publish("route-back-to-summary"),widget.routeMgmtMediator.publish("route-widgetTitle-count-update",{model:a.getModel()}),widget.setValue("openedRouteId",void 0)},V=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid?2==e.multipleHitCount?(t.nodeModel.select(!0),widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:t.nodeModel.options.grid})):e.ctrlKey||e.shiftKey||p.refreshRightPanel("Route",a,t.nodeModel.options.grid):p.refreshRightPanel("Route",a)},_=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.multipleHitCount&&(t.nodeModel.select(!0),widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:t.nodeModel.options.grid}))},P=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&(require(["DS/ENORouteMgmt/Views/Menu/RouteContextualMenu"],function(o){o.routeGridRightClick(e,t.nodeModel.options.grid)}),p.refreshRightPanel("Route",a,t.nodeModel.options.grid))},W=function(){var e=a.getModel(),t=[];return e.getChildren().forEach(e=>{t.push(e.options.id)}),t},L=function(e,t){p.refreshRightPanel("Route",a)},G=function(e,t){p.refreshRightPanel("Route",a),widget.setValue("right-panel-peristed-id",void 0)},j=function(){let e=o.dataGridView();e.addEventListener(m.POINTERHIT,V),e.addEventListener("contextmenu",P),n.tileView().addEventListener(m.POINTERHIT,_),e.getTreeDocument().getXSO().onAdd(L),e.getTreeDocument().getXSO().onRemove(G),B()},B=function(){q();let t=widget.routeMgmtMediator.subscribe("route-summary-append-rows",function(t){let o=a.appendRows(t.model,t.openRoute);e.getDataGridInstance().ensureNodeModelVisible(o,!0),o.select(),p.refreshRightPanel("Route",a)});h.push(t),t=widget.routeMgmtMediator.subscribe("route-summary-show-message",function(e){widget.notify.handler().addNotif(e.message)}),h.push(t),t=widget.routeMgmtMediator.subscribe("route-summary-delete-rows",function(e){a.deleteRowModelByIndex(e),p.refreshRightPanel("Route",a),widget.routeMgmtMediator.publish("route-tag-data-updated")}),h.push(t),t=widget.routeMgmtMediator.subscribe("route-summary-delete-row-by-ids",function(e){e.model.length>0&&a.deleteRowModelByIds(e.model),p.refreshRightPanel("Route",a),widget.routeMgmtMediator.publish("route-tag-data-updated")}),h.push(t),t=widget.routeMgmtMediator.subscribe("route-summary-delete-selected-rows",function(){a.deleteRowModelSelected(),p.refreshRightPanel("Route",a),widget.routeMgmtMediator.publish("route-tag-data-updated")}),h.push(t),t=widget.routeMgmtMediator.subscribe("route-data-updated",function(e){a.updateRow(e),N()}),h.push(t),t=widget.routeMgmtMediator.subscribe("route-data-linkWidget-published",function(){A()}),h.push(t),t=widget.routeMgmtMediator.subscribe("route-RefreshData-linkWidget-published",function(e){z(e)}),h.push(t),t=widget.routeMgmtMediator.subscribe("route-summary-refresh",function(){N()}),h.push(t),t=widget.routeMgmtMediator.subscribe("route-tag-data-updated",function(e){var t=W(),o=g.getTaggerVariable(),n=o.getCurrentFilter();t.length>1e3&&(t=t.slice(0,1e3)),t.length>0?I(n.allfilters,t):g.setTagsForSummaryPage([]),o.activate()}),h.push(t),t=widget.routeMgmtMediator.subscribe("route-deactivate-tag-data",function(e){var t=g.getTaggerVariable();t&&t.deactivate()}),h.push(t),t=widget.routeMgmtMediator.subscribe("route-search-within-data",function(e){var t=W(),o=g.getTaggerVariable().getCurrentFilter();I(o.allfilters,t)}),h.push(t),t=widget.routeMgmtMediator.subscribe("route-reset-search-within-data",function(e){var t=W(),o=g.getTaggerVariable().getCurrentFilter();t.length>1e3&&(t=t.slice(0,1e3)),I(o.allfilters,t)}),h.push(t),t=widget.routeMgmtMediator.subscribe("filter-by-object-resize",function(){setTimeout(()=>{try{if(widget.getValue("routefilters").indexOf("filterbyobject")>-1&&"routes"==widget.getValue("HomePage")){let t=e.getGridViewToolbar().getContent(),o=t.getDocument(),n=o.querySelector("#routes-main-div #dataGridDivToolbar"),i=o.getElementById("contextObjectSearch"),s=1==t.hasAttribute("touch-mode")?"85px":"60px";if(null!=i&&null!=n&&n.clientWidth>0){let e=n.getChildren()[0].getElementsByClassName("wux-controls-toolbar-farContainer")[0];n.clientWidth<420?(i.inject(n),i.style.width="100%",n.style.height=s):(e.insertBefore(i,e.children[0]),i.style.width="250px",n.style.height="41px")}}}catch(e){}},300)}),h.push(t)},q=function(){h.forEach((e,t)=>{widget.routeMgmtMediator.unsubscribe(e)}),h=[]},H=function(){let e=S(),t=R();if(!e&&widget.getValue("openedRouteId")&&(e=widget.getValue("openedRouteId"),widget.setValue("openedRouteId",void 0)),null==e&&(e=widget.getValue("routeIdToBePersisted")),e){T();let t=a.getRowModelById(e);t?(t.select(!0),widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:t.options.grid})):F()}else t&&T()},J=function(e,t){d.fetchRouteByIds(e).then(e=>{let o=w(e);D(),k(),t(o)},e=>{v(e)})},z=function(e){d.fetchRouteById(e.routeId).then(e=>{widget.routeMgmtMediator.publish("route-data-updated",e[0]),widget.routeMgmtMediator.publish("redraw-graph",e[0])},e=>{})};return{build:()=>(function(){let e=S(),o=R(),n=y();if(e)return"Inbox Task"==widget.data.contentType?new Promise(function(t,o){u.getRouteIdByTask(e).then(e=>{widget.data.contentId=e,d.fetchRouteById(e).then(e=>{let o=w(e);t(o)},e=>{v(e)})},e=>{v(e)})}):new Promise(function(t,o){d.fetchRouteById(e).then(e=>{let o=w(e);t(o)},e=>{v(e)})});if(o){if("Route"==n){let e=t.getIdsForServicePayload(o);return new Promise(function(t,o){J(e,t)})}{let e=t.getIdsForServicePayload(o);return new Promise(function(t,o){d.fetchApprovalStatusForContent(e).then(e=>{let o=e.data[0].relateddata.route;var n=[];let i;for(var s=0;s<o.length;s++){var a={};a.id=o[s].dataelements.id,n.push(a)}J(i={data:n},t)},e=>{widget.routeWebAppNotify.handler().addNotif({level:"error",subtitle:f.errorMessage,sticky:!0}),t()})})}}return D(),k(),new Promise(function(e,t){d.fetchAllRoutes().then(t=>{a.destroy();let o=w(t);e(o)},e=>{v(e)})})})(),getFilterPreferences:()=>U(),updateFilterPreferences:(e,t)=>(function(e,t){var o=[...widget.getValue("routefilters")];const n=o.indexOf(e);t?n<=-1&&o.push(e):n>-1&&o.splice(n,1),widget.setValue("routefilters",o)})(e,t),destroyAndRedrawwithFilters:()=>{N(!0)},destroy:()=>{a.destroy(),e.destroy(),i.destroy(),q()},backToRouteSummary:()=>F(),getModel:()=>getSummaryModel(),openSelected:()=>H(),activateInfoIcon:()=>{p.activateInfoIcon(e)},inActivateInfoIcon:()=>{p.inActivateInfoIcon(e)},loadSubscribedData:e=>{A(e)}}}),define("DS/ENORouteMgmt/Views/Tile/RouteContentsTileView",["DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Views/Menu/ContentContextualMenu","DS/Core/PointerEvents","DS/ENORouteMgmt/Utilities/DragAndDropManager"],function(e,t,o,n){"use strict";let i,s=function(){let t=e.tileView();t.onDragStartCell=function(e,t){n.getContentForDrag(e,t)},t.onDragEndCell=function(e,t){e.target.removeClassName("wux-ui-state-activated wux-ui-state-highlighted")},t.onDragEnterBlankDefault=function(e){},t.onDragEnterBlank=function(e){}};return{build:t=>(function(t){i=t||new TreeDocument({useAsyncPreExpand:!0});let o=widget.getValue("ContentsTab-ShowView"),n="Contents-tileView-View hideView";o&&"TileView"==o&&(n="Contents-tileView-View showView");var a=UWA.createElement("div",{id:"tileViewContainer",class:n});let r=e.build(t,a,!0);return s(),r})(t),contexualMenuCallback:()=>(function(){let o=e.tileView();o.onContextualEvent={callback:function(e){t.tileContextualMenu(e,i,function(e){if("Update"==e.action){let e=i.getSelectedNodes();e.length>0&&o.lastSelectedNode.setAttribute("thumbnail",e[0].options.icons[0])}})}}})()}}),define("DS/ENORouteMgmt/Views/RouteContentsView",["DS/ENORouteMgmt/Views/Grid/RouteContentsDataGridView","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Components/Wrappers/WrapperTileView","DS/ENORouteMgmt/Views/Tile/RouteContentsTileView","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Model/RouteContentModel","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Controller/RouteServicesController","DS/Core/PointerEvents","DS/ENORouteMgmt/Utilities/DragAndDrop","DS/ENORouteMgmt/Utilities/DragAndDropManager","DS/Controls/ProgressBar","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p){"use strict";let g,f;g=function(e,t){c.onDropManager(e)};let h=function(t,o){let i=a.getModel(),s=e.build(i),l=n.build(i);n.contexualMenuCallback(),S();let d=e.getGridViewToolbar(),u=UWA.createElement("div",{id:"dataGridContentsDivToolbar",class:"toolbar-container",styles:{width:"100%"}}).inject(o);d.inject(u),l.inject(o),s.inject(o);var c=!0;return t.model.Actions.indexOf("add.contents")>=0&&"Complete"!=t.model.actualState&&(c=!1),0==i.getChildren().length&&r.showEmptyContentPlaceholder(o,c),r.registerListeners(),o},w=function(e,t){a.createModel(e,t),a.getModel().RouteId=t.id,a.getModel().routeModel=t},v=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&require(["DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],function(o){var n=a.getModel().routeModel.state;o.contentsGridRightClick(e,t.nodeModel.options.grid,n,a.getModel().routeModel)})},S=function(){let e=t.dataGridView();e.addEventListener(d.POINTERHIT,R),e.addEventListener("contextmenu",v),o.tileView().addEventListener(d.POINTERHIT,R),y()},R=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.multipleHitCount&&(t.nodeModel.select(!0),widget.routeMgmtMediator.publish("route-content-preview-click",{model:{id:t.nodeModel.options.grid.id}}))},y=function(){widget.routeMgmtMediator.subscribe("content-summary-append-rows",function(e){a.appendRows(e)}),widget.routeMgmtMediator.subscribe("content-summary-delete-rows",function(e){a.deleteRows(e)}),widget.routeMgmtMediator.subscribe("content-summary-delete-selected-rows",function(){a.deleteSelectedRows()}),widget.routeMgmtMediator.subscribe("content-summary-update",function(){M()}),widget.routeMgmtMediator.subscribe("route-data-updated",function(e){a.getModel().routeModel=s.gridData(e),M()})},M=function(){l.fetchRouteContents(a.getModel().RouteId).then(function(e){a.getModel().removeRoots();var t=T(e);a.createModel(t,a.getModel().routeModel),0!=a.getModel().getChildren().length?widget.routeMgmtMediator.publish("hide-no-content-placeholder"):widget.routeMgmtMediator.publish("show-no-content-placeholder")})},T=function(e){let t=[];a.getModel();return(e=JSON.parse(e)).data[0].relateddata.contents.forEach(function(e){e.dataelements.id=e.id,e.dataelements.physicalid=e.id,e.dataelements.relId=e.relId,e.dataelements.type=e.type,e.dataelements.relation=p.contentToReview,e.dataelements.relationValue="Content to review",t.push(e.dataelements)}),e.data[0].relateddata.attachments.forEach(function(e){var o=[],n=e.dataelements.sConnectedTaskInformation;null!=n&&0!=n.length&&n.forEach(function(e){o.push(e.split("~")[1])}),e.dataelements.id=e.id,e.dataelements.physicalid=e.id,e.dataelements.relId=e.relId,e.dataelements.type=e.type,e.dataelements.relatedToTaskTitles=o,e.dataelements.relation=p.attachment,e.dataelements.relationValue="Attachment",t.push(e.dataelements)}),t},b=function(){let e=document.querySelector(".route-contents-container");(f=new m({shape:"circular",infiniteFlag:!0,emphasize:"info",statusFlag:!1,height:60})).inject(e),f.elements.container.setStyle("margin-left","40%"),f.elements.container.setStyle("margin-top","20%")},C=function(){f.destroy()},D=function(){return null!=document.querySelector("#routeContentsContainer")&&(document.getElementById("routeContentsContainer").style.display="block",!0)};return{init:e=>(function(e){if(!D()){let t=UWA.createElement("div",{id:"routeContentsContainer",class:"route-contents-container"});t.inject(document.querySelector(".route-facets-container")),u.makeDroppable(t,g),b(),l.fetchRouteContents(e.model.id).then(function(o){var n=T(o);a.destroy(),w(n,e.model),h(e,t),C()}),c.init(e),require(["DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],function(e){e.isDocumentManagementInstalled()})}})(e),hideView:()=>{null!=document.getElementById("routeContentsContainer")&&(document.getElementById("routeContentsContainer").style.display="none")},getModel:()=>a.getModel(),destroy:()=>{a.destroy()}}}),define("DS/ENORouteMgmt/Views/Grid/TaskAttachmentsDataGridView",["DS/ENORouteMgmt/Config/TaskAttachmentsGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Views/Menu/ContentContextualMenu","DS/ENORouteMgmt/Model/TaskAttachmentModel","DS/ENORouteMgmt/Utilities/DragAndDropManager"],function(e,t,o,n,i){"use strict";let s,a={},r=!1,l=function(n,l){r=!!l;var d=UWA.createElement("div",{id:"taskAttachments-dataGridViewContainer",class:"taskAttachments-gridView-View"});a.cellDragEnabledFlag=!0,a.showRowBorderFlag=!0,a.showOutlineFlag=!0,a.showAlternateBackgroundFlag=!1;a.layoutOptions={rowsHeader:!1,columnsHeader:!1,rowSpacing:5,cellWidth:2},a.showContextualMenuColumnFlag=!0,a.onContextualEvent=function(e){e&&e.cellInfos&&o.taskAttachmentContextualMenu(e,e.cellInfos.nodeModel,r,c,function(e){console.log("asd")})};let m=t.build(n,e,!1,d,a);return(s=t.dataGridView()).onDragStartCell=function(e,t){return i.getContentForDrag(e,t),!0},u(),require(["DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],function(e){e.isDocumentManagementInstalled()}),m},d=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&require(["DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],function(o){o.taskAttachmentGridRightClick(e,t.nodeModel.options.grid,r,c)})},u=function(){t.dataGridView().addEventListener("contextmenu",d),widget.routeMgmtMediator.subscribeOnce("triptych-resized",function(e){m()})},c=function(){n.deleteSelectedRows(),m()},m=function(){var e=document.querySelector("#taskAttachments-dataGridViewContainer");let t=s.getRowModelLength();e&&(t<5?e.setStyle("height",41*t+"px"):e.setStyle("height","200px"))};return{build:(e,t)=>l(e,t)}}),define("DS/ENORouteMgmt/Views/RouteIDCardView",["DS/ENORouteMgmt/Views/RouteHeaderView","DS/ENORouteMgmt/Views/RouteTabsView","DS/ENORouteMgmt/Utilities/IdCardUtil","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Views/RouteHistory"],function(e,t,o,n,i){"use strict";let s,a,r,l,d;var u=function(e){this.rightPanel=e,s=new UWA.Element("div",{id:"routeHeaderContainer",class:"route-header-container"});let t=widget.getValue("routeIdCardPersistency");t&&"maximized"==t?s.addClassName("maximized"):s.addClassName("minimized"),a=new UWA.Element("div",{id:"routeFacetsContainer",class:"route-facets-container"})};return u.prototype.init=function(i){var u=i.model.id;widget.setValue("routeIdToBePersisted",u),new e(s).destroyContainer(),new t(a).destroy(),l&&widget.routeMgmtMediator.unsubscribe(l),d&&widget.routeMgmtMediator.unsubscribe(d);new e(s).init(i,!1),r=i.model.id,new t(a,i).init(),this.rightPanel.appendChild(s),this.rightPanel.appendChild(a),new e(s).resizeSensor(),l=widget.routeMgmtMediator.subscribe("route-data-updated",function(t){var i={model:n.gridData(t)};if(i.model.id==r){var a=o.infoIconIsActive();let n=new e(s);n.destroyContent(),n.init(i,a),n.resizeSensor(),n.resizeIDCard(),widget.propWidgetOpen&&(t.requestFrom&&"editPropWidget"==t.requestFrom||widget.routeMgmtMediator.publish("route-header-info-click",{model:i.model,info:"Route"}))}}),d=widget.routeMgmtMediator.subscribe("route-data-deleted",function(e){e.model.includes(r)&&require(["DS/ENORouteMgmt/Views/RouteSummaryView"],function(e){e.backToRouteSummary()})})},u.prototype.destroy=function(){this.rightPanel.destroy()},u}),define("DS/ENORouteMgmt/Views/Loader/InitiateDocumentContentToReviewChooser",["DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s){"use strict";let a;var r=function(e,o){for(var n=0;n<o.length;n++){var i,s=o[n];s&&((i=new t({label:s["ds6w:label"],value:s.id})).options.grid.id=s.id,i.options.grid.name=s["ds6w:identifier"],i.options.grid.stateNLS=s["ds6w:status"],i.options.grid.title=s["ds6w:label"],i.options.grid.type=s["ds6w:type"],i.options.grid.created=s["ds6w:created"],i.options.grid.modified=s["ds6w:modified"],i.options.grid.type_icon_url=s.type_icon_url,i.options.grid.owner=s.owner,i.options.grid.policy=s["ds6w:policy"],i.options.grid.state=s["ds6w:status"],i.options.grid.revision=s["ds6wg:revision"],null==a.selectedItems?a.selectedItems=i:a.selectedItems.push(i),a._applySelectedItems())}};return{init:(t,o,s,l,d)=>(function(t,o,s,l,d){a=o;var u=[],c=[];if("create"!=l)for(var m=i.getModel().getChildren(),p=0;p<m.length;p++)c.push(m[p]._options.grid.id);if(u=c,"create"==l){var g=n.getRouteContentIds();for(p=0;p<g.length;p++)u.push(g[p])}null!=a&&null!=a.selectedItems&&0!=a.selectedItems.length&&a.selectedItems.forEach(function(e){u.push(e.options.value)});var f=t.dsModel;let h=widget.getValue("routeContentSearchTypes");var w=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],function(t){var o=t.createSocket({socket_id:w}),n=h?h.split(","):"",i=d.scopeId;null==i&&(i="All"==d.Scope[0]?d.Scope[0]:"Organization"==d.Scope[0]?d.Scope[0]:d.Scope[2]);var s=e.getRefinementToSnN(w,"addContent",!0,n);if(s.precond=e.getPrecondForContentSearch(i,n),s.resourceid_not_in=u,!UWA.is(o))throw new Error("Socket not initialized");o.dispatchEvent("RegisterContext",s),o.addListener("Selected_Objects_search",r.bind(f,"")),o.dispatchEvent("InContextSearch",s)})})(t,o,0,l,d),populateAddExisiting:(e,t)=>(function(e,t){let o=[],n=e.attachedDocuments;a=e.autoCompleteComponent;let i=[];null!=n&&(o=JSON.parse(JSON.stringify(n))),null!=a&&null!=a.selectedItems&&0!=a.selectedItems.length&&a.selectedItems.forEach(function(e){null==e.options.value.name&&o.push(e.options.value)});for(var s=0;s<t.length;s++){var l=t[s];o.includes(l.id)||(o.push(l.id),i.push(l))}r("",i)})(e,t)}}),define("DS/ENORouteMgmt/Views/Loader/RouteContextObjectChooser",["DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Utilities/PlaceHolder","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o){"use strict";let n,i=!1;var s=function(e,o){var s;o&&(s=new t({label:o[0]["ds6w:label"],value:o[0].id,status:o[0]["ds6w:status"],category:o[0]["ds6w:category"]}),i=!0,n.selectedItems=s)};let a=function(e){if(null==e){widget.routeMgmtMediator.publish("welcome-panel-action-selected",{id:"routes"})}else require(["DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/RouteSummaryView","DS/ENORouteMgmt/Model/RouteModel"],function(t,n,i){let s=function(e){var t=[];let o;for(var n=0;n<e.length;n++){var i={};i.id=e[n],t.push(i)}return o={data:t}}([e]);return new Promise(function(e,a){t.fetchApprovalStatusForContent(s).then(e=>{let t=e.data[0].relateddata.route;if(0==t.length){var s=i.getModel();s.prepareUpdate(),s.removeRoots(),s.pushUpdate();let e=document.querySelector(".widget-container");null!=e&&(0==t.length?o.showEmptyRoutePlaceholder(e,s):o.hideEmptyRoutePlaceholder(e)),i.appendAllRows(t)}else{var a=[];let e,o=[];for(var r=0;r<t.length;r++){var l={};l.id=t[r].dataelements.id,a.push(l),o.push(t[r].dataelements.id)}e={data:a},widget.setValue("approvalProcessIds",o),widget.setValue("approvalProcessType","Route"),n.loadSubscribedData("summary-onchange")}},t=>{widget.notify.handler().addNotif({level:"success",subtitle:NLS.errorMessage,sticky:!0}),e()})})})};return{init:(t,o)=>(function(t,o){n=o;var i=t.dsModel,a=UWA.Utils.getUUID();require(["DS/SNInfraUX/SearchCom"],function(t){var o=t.createSocket({socket_id:a});let n=widget.getValue("routeContentSearchTypes");var r=n?n.split(","):"",l=e.getRefinementToSnN(a,"searchObjects",!1,r);if(l.precond=e.getPrecondForContextSearch("is_95_rel_95_objectroute",r),!UWA.is(o))throw new Error("Socket not initialized");o.dispatchEvent("RegisterContext",l),o.addListener("Selected_Objects_search",s.bind(i,"")),o.dispatchEvent("InContextSearch",l)})})(t,o),filterByObjectOnChange:e=>(function(e){var t=e.dsModel.value;null!=t?widget.setValue("linkedContextTitle",e.dsModel.selectedItems.options.label):(widget.setValue("linkedContextTitle",void 0),widget.setValue("isWidgetRefreshed","true")),a(t),i&&(i=!1)})(e),loadSelectedContextRoutes:e=>a(e)}}),define("DS/ENORouteMgmt/Views/Form/TaskInEditMode",["DS/ENORouteMgmt/Views/Form/FormElements","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/ENORouteMgmt/Utilities/Utils","DS/Controls/Button","DS/ENORouteMgmt/Views/Form/CustomFieldUtils","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/EnoviaBootstrap","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u){"use strict";let c=function(e,t,o,n,s){let a=i.isMultiValueField(t),r=o.model[t.name];a&&Array.isArray(r)?(s=0,0===r.length&&m(e,t,"",n,s),r.forEach((o,i)=>{m(e,t,o,n,s),s+=1})):m(e,t,r,n,s)},m=function(e,t,o,n,s){let a=i.getFieldType(t),r=i.isReadOnlyField(t),l=i.isMultiValueField(t);if(r)p(e,t,o,n);else{if(l){s||(s=0),e=new UWA.Element("div",{id:"row-"+s,class:"multiVal"}).inject(e)}switch(a){case"Editor":f(e,t,o,n);break;case"LineEditor":g(e,t,o,n);break;case"DatePicker":v(e,t,o,n);break;case"Toggle":h(e,t,o,n);break;case"ComboBox":w(e,t,o,n);break;case"LineEditor with Unit":S(e,t,o,n);break;default:return}if(l){let o=new UWA.Element("div",{id:"MultiVal_button",class:""}).inject(e);R(e,t,n,o),s&&y(e,t,n,o)}}},p=function(e,t,n,s){if(i.isDateField(t)&&n&&""!=n){let e=new Date(n);n=o.getLocaleDate(e,!0)}if("LineEditor with Unit"==i.getFieldType(t)){n+=" "+i.getDefaultUnit(t).display}new UWA.Element("span",{text:n}).inject(e),s.elements[t.name]={value:n}},g=function(t,o,n,s){JSON.parse(o.viewConfig);let a="[0-9]+";"real"==i.getAttributeType(o)&&(a="[0-9]+|([0-9]+.[0-9]+)");let r={sizeInCharNumber:1,value:n};r.pattern=a;let l=e.createElement(t,r,"lineEditor");M(s,o,l)},f=function(t,o,n,i){let s={pattern:"[^./#,\\[\\]\\$\\^@\\*\\?%:'\"\\\\<>]+",widthInCharNumber:32,nbRows:4,newLineMode:"enter",value:n},a=e.createElement(t,s,"Editor");M(i,o,a)},h=function(t,o,n,i){let s=!1;"TRUE"==n&&(s=!0);let a={type:"checkbox",label:o.label,value:n,checkFlag:s};t.setStyle("padding-top","10px");let r=e.createElement(t,a,"Toggle");M(i,o,r)},w=function(t,o,n,s){let a={elementsList:i.getRangeElementsList(o),value:n,enableSearchFlag:!1},r=e.createElement(t,a,"ComboBox");M(s,o,r)},v=function(t,o,n,i){let s={value:new Date(n),minValue:new Date(n),timePickerFlag:!0},a=e.createElement(t,s,"DatePicker");M(i,o,a)},S=function(t,o,n,s){t.setStyle("display","flex");let a={value:n,pattern:"[0-9]+|([0-9]+.[0-9]+)",sizeInCharNumber:17},r=e.createElement(t,a,"lineEditor"),l={placeholder:i.getDefaultUnit(o).display,disabled:!0,sizeInCharNumber:5};new UWA.Element("div",{html:"&nbsp;"}).inject(t),e.createElement(t,l,"lineEditor"),M(s,o,r)},R=function(e,t,o,i){let s=1,a=new n({icon:{iconName:"plus"}}).inject(i),r={model:{}};r.model[t.name]="",a.getContent().addEventListener("buttonclick",function(){c(e.parentElement,t,r,o,s),s++})},y=function(e,t,o,i){new n({icon:{iconName:"minus"}}).inject(i).getContent().addEventListener("buttonclick",function(){let e=i.parentElement.id.split("-")[1];o.elements[t.name].splice(e,1),i.parentElement.destroy()})},M=function(e,t,o){if(i.isMultiValueField(t)&&e.elements[t.name]){if(!Array.isArray(e.elements[t.name])){let o=e.elements[t.name];e.elements[t.name]=[],e.elements[t.name].push(o)}e.elements[t.name].push(o)}else e.elements[t.name]=o};return{drawTitleInEditMode:(t,o,n,i)=>(function(t,o,n,i){let s=new UWA.Element("h5",{class:i,text:u.title}).inject(t);i&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(s),o.model.title||(o.model.title="");let a={placeholder:u.placeholderTitle,pattern:"[^./#,\\[\\]\\$\\^@\\*\\?%:'\"\\\\<>]+",sizeInCharNumber:30,value:o.model.title};n.elements.title=e.createElement(t,a,"lineEditor")})(t,o,n,i),drawOrderInEditMode:(t,o,n,i)=>(function(t,o,n,i){let s=new UWA.Element("h5",{class:i,text:u.taskOrder}).inject(t);i&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(s);let a={pattern:"[0-9]+",sizeInCharNumber:1,value:o.model.taskOrder};n.elements.order=e.createElement(t,a,"lineEditor")})(t,o,n,i),drawAssigneeInEditMode:(e,o,i,s,c,m,p)=>(function(e,o,i,s,c,m,p){let g=new UWA.Element("h5",{class:s,text:u.taskassignee}).inject(e);s&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(g);var f,h={};h.isMultiSearchMode=!1,h.placeHolderValue=u.searchTaskAssigneePlaceHolder,h.minLengthToType=3,h.isFreeInputAllowed=!1,"OnPremise"!=d.getTenantValue()&&(h.source=["3dspace","usersgroup"]),h.getPrecond=function(){return l.getPrecondForTaskMemberSearch(c)},h.getValidation=function(){return t.validationForAssigneeField(c)},h.getChangeHandler=function(){return t.changeHandlerForAssigneeField(i,c,m)},i.elements.assignee=r.drawAutoCompleteComponent(h),i.elements.assignee.inject(i.taskAssigneeField),new UWA.Element("div",{html:"&nbsp;"}).inject(i.taskAssigneeField),null!=p&&""!=p&&(f=new a({isSelected:!0,label:p,value:o.model.assigneeId,name:o.model.taskAssigneeUsername,type:o.model.assigneeType}),i.elements.assignee.selectedItems=f);i.elements.taskAssigneeChooser=new n({icon:{iconName:"search"}}),i.elements.taskAssigneeChooser.inject(i.taskAssigneeField),i.elements.taskAssigneeChooser.getContent().addEventListener("buttonclick",function(){if("undefined"!=typeof dscef){let e={taskProperties:i,taskGraphModel:m,invokeFrom:"form",routeInfo:c};widget.routeMgmtMediator.publish("launch-task-assignee-search",e)}else t.launchAssigneeSearch(event,i,c,m)}),i.taskAssigneeField.inject(e)})(e,o,i,s,c,m,p),drawCustomFieldsInEditMode:(e,t,o,n)=>c(e,t,o,n),drawLabelInEditMode:(e,t,o,n)=>(function(e,t,o,n){let s=i.getFieldType(t),a=!0;if(i.isReadOnlyField(t)||"Toggle"!==s||(a=!1),a){let o=i.isMandatoryField(t)?"required":"",n=new UWA.Element("h5",{class:o,text:t.label}).inject(e);o&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(n)}})(e,t),drawTaskComments:(e,t)=>(function(e,t){e.inline("ckeditorTaskComment",{floatSpaceDockedOffsetX:175,floatSpaceDockedOffsetY:0}),e.config.toolbarGroups=[{name:"links"}],e.config.title="",e.config.removeButtons="Cut,Copy,Paste,Undo,Redo,Anchor,Underline,Strike,Subscript,Superscript",e.config.removeDialogTabs="link:advanced;link:target",e.config.removePlugins="image,forms,elementspath,magicline",e.config.enterMode=e.ENTER_BR,e.config.uiColor="#ffffff",CKEDITOR.on("instanceReady",function(e){CKEDITOR.instances.ckeditorTaskComment.setData(t),CKEDITOR.instances.ckeditorTaskComment.container.$.focus()}),CKEDITOR.on("dialogDefinition",function(e){var t=e.data.name,o=e.data.definition;"link"==t&&o.getContents("info").get("linkType").items.splice(1,3)})})(e,t),drawTaskReviewComments:(e,t)=>(function(e,t){e.inline("ckeditorTaskReviewComment",{floatSpaceDockedOffsetX:175,floatSpaceDockedOffsetY:0}),e.config.toolbarGroups=[{name:"links"}],e.config.title="",e.config.removeButtons="Cut,Copy,Paste,Undo,Redo,Anchor,Underline,Strike,Subscript,Superscript",e.config.removeDialogTabs="link:advanced;link:target",e.config.removePlugins="image,forms,elementspath,magicline",e.config.enterMode=e.ENTER_BR,e.config.uiColor="#ffffff",CKEDITOR.on("instanceReady",function(e){CKEDITOR.instances.ckeditorTaskReviewComment.setData(t),CKEDITOR.instances.ckeditorTaskComment.container.$.focus()}),CKEDITOR.on("dialogDefinition",function(e){var t=e.data.name,o=e.data.definition;"link"==t&&o.getContents("info").get("linkType").items.splice(1,3)})})(e,t)}}),define("DS/ENORouteMgmt/Views/Menu/InitiateRouteContentContextualMenu",["DS/Menu/Menu","DS/ENORouteMgmt/Utilities/ContentStateBlockingUtils","DS/ENORouteMgmt/Model/InitiateRouteContentModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n){"use strict";let i,s=function(){var e=[];return e.push({name:n.deleteContent,title:n.deleteContent,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove"},data:null,action:{callback:function(){require(["DS/ENORouteMgmt/Views/InitiateRouteContentsView"],function(e){e.removeContents()})}}}),e};return i={InitiateContentGridRightClick:(n,i)=>(function(n,i){n.preventDefault(),n.stopPropagation();var a=n.target.getBoundingClientRect(),r={position:{x:a.left,y:a.top+20}},l=[];o.getSelectedRowsModel().data.length<2&&(l=l.concat(t.getBlockingMaturityContextualMenu(i,"InitiateRoute"))),l=l.concat(s()),e.show(l,r)})(n,i)}}),define("DS/ENORouteMgmt/Views/Grid/RouteTasksGridCustomColumns",["DS/Controls/Button","DS/Controls/TooltipModel","DS/ENORouteMgmt/EnoviaBootstrap","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Views/Form/TaskViewUtil","UWA/Drivers/Alone","DS/ENORouteMgmt/Utilities/RouteViewUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r){"use strict";return{onRouteTaskStateCellRequest:e=>(function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_state_"))){let o,n=e.nodeModel.options.grid.current,i=e.nodeModel.options.grid.currentNLS;if(null==n)return t.getChildren()[0].setHTML(""),e.cellView._setReusableContent(t),void t.getChildren()[0].setAttribute("class","");"Draft"===n.trim()?o="DEFINE":"Assigned"===n.trim()?o="INPROCESS":"Review"===n.trim()?o="INAPPROVAL":"Complete"===n.trim()&&(o="COMPLETE"),t.getChildren()[0].setHTML(i),t.getChildren()[0].setAttribute("class","route-state-title "+o),e.cellView._setReusableContent(t)}})(e),onRouteTaskAssigneeCellRequest:e=>(function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_owner_"))){let c=e.nodeModel.options.grid.routeOwnerTask,m=e.nodeModel.getTreeDocument().parentType;if(m&&"Route Template"==m&&"TRUE"==c)t.querySelector(".userIcon")&&t.querySelector(".userIcon").setStyle("display","none"),t.querySelector(".avatarIcon")&&t.querySelector(".avatarIcon").setStyle("display","none"),t.querySelector(".askRTOwnerDiv")&&t.querySelector(".askRTOwnerDiv").setStyle("display","block"),t.getChildren()[1].setHTML(r.routeOwnerTask),e.cellView._setReusableContent(t);else{var i;t.querySelector(".askRTOwnerDiv")&&t.querySelector(".askRTOwnerDiv").setStyle("display","none");var s=e.nodeModel.options.grid.assigneeType,l=e.nodeModel.options.grid.taskAssignee,d="/api/user/getpicture/login/"+e.nodeModel.options.grid.taskAssigneeUsername+"/format/normal";if(null==l||""==l)return t.getChildren()[1].setHTML(""),t.querySelector(".avatarIcon")&&t.querySelector(".avatarIcon").setStyle("display","none"),t.querySelector(".userIcon")&&t.querySelector(".userIcon").setStyle("display","none"),t.querySelector(".askRTOwnerDiv")&&t.querySelector(".askRTOwnerDiv").setStyle("display","none"),void e.cellView._setReusableContent(t);var u=a.getAvatarDetails(l);let r=UWA.createElement("img",{class:"userIcon",src:""});"Group"===s||"User Group"===s||"Group Proxy"===s?(l=e.nodeModel.options.grid.assigneeTitle,i=n.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_UserGroup16.png"),r.src=i):i=o.getSwymUrl()+d,"Person"==s?null!=o.getSwymUrl()?t.querySelector(".userIcon")&&(t.querySelector(".userIcon").setStyle("display","block"),t.querySelector(".userIcon").src=i):(t.querySelector(".userIcon")&&t.querySelector(".userIcon").setStyle("display","none"),t.querySelector(".avatarIcon").setHTML(u.avatarStr),t.querySelector(".avatarIcon").setStyle("background",u.avatarColor),t.querySelector(".avatarIcon").setStyle("display","block")):(t.querySelector(".userIcon")?t.querySelector(".userIcon").src=i:t.getChildren()[0].addContent(r),t.querySelector(".avatarIcon")&&t.querySelector(".avatarIcon").setStyle("display","none"),t.querySelector(".userIcon").setStyle("display","block")),t.getChildren()[1].setHTML(l),e.cellView._setReusableContent(t)}}})(e),onRouteTaskDueDateCellRequest:e=>(function(e){let t;if(!e.isHeader&&(t=e.cellView.collectionView.reuseCellContent("_duedate_"))){let o=e.nodeModel.options.grid.taskDueDate;if(null==o)return t.getChildren()[0].setStyle("display","none"),t.getChildren()[1].setStyle("display","none"),t.getChildren()[2].setHTML(""),void e.cellView._setReusableContent(t);if("object"==typeof o){let t={};t.model=e.nodeModel.options.grid,o=i.dueDateViewMode(t,o)}else{o=new Date(o);let t={};t.model=e.nodeModel.options.grid,o=i.dueDateViewMode(t,o)}let n=e.nodeModel.options.grid.attrTaskStatus;"status-late"==n?(t.getChildren()[0].setStyle("display","block"),t.getChildren()[0].title=r.overdue,t.getChildren()[1].setStyle("display","none")):"status-due"==n?(t.getChildren()[1].setStyle("display","block"),t.getChildren()[1].title=r.soonToBeOverDue,t.getChildren()[0].setStyle("display","none")):(t.getChildren()[0].setStyle("display","none"),t.getChildren()[1].setStyle("display","none")),t.getChildren()[2].setHTML(o),e.cellView._setReusableContent(t)}})(e),getCellTypeRepresentation:e=>(function(e){return e.nodeModel&&""!=e.nodeModel.options.grid.subRouteGridApprovalStatus?"user":"string"})(e)}}),define("DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions",["DS/ENORouteMgmt/Views/Grid/RouteSummaryDataGridView","DS/ENORouteMgmt/Views/RouteSummaryView","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/Controls/Button","DS/ENORouteMgmt/Views/Loader/RouteContextObjectChooser","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l){"use strict";var d=Object.create(null);d.currentView="Grid",d.previousView="Grid";var u=function(o,n){if(null!=widget.data.contextTitle&&""!=widget.data.contextTitle){widget.data.contextTitle="";widget.routeMgmtMediator.publish("welcome-panel-action-selected",{id:"routes"})}var i=e.getGridViewToolbar().getNodeModelByID("filter"),s=!0;if("filterbyobject"==o.type&&("selected"==i.options.grid.data.menu[6].state&&"selected"!=o.state?(i.options.grid.data.menu[6].state="unselected",s=!1):i.options.grid.data.menu[6].state="selected",t.updateFilterPreferences(o.filter,s)),"owner"==o.type)"owned"==o.filter?"selected"==i.options.grid.data.menu[0].state?(i.options.grid.data.menu[0].state="unselected",s=!1):i.options.grid.data.menu[0].state="selected":"assigned"==o.filter&&("selected"==i.options.grid.data.menu[1].state?(i.options.grid.data.menu[1].state="unselected",s=!1):i.options.grid.data.menu[1].state="selected"),t.updateFilterPreferences(o.filter,s),t.destroyAndRedrawwithFilters(),i&&"list-ok"!=i.options.grid.semantics.icon.iconName&&i.updateOptions({label:"list-ok"});else if("state"==o.type){i=e.getGridViewToolbar().getNodeModelByID("filter"),s=!0;"completed"==o.filter?("selected"==i.options.grid.data.menu[5].state?(i.options.grid.data.menu[5].state="unselected",s=!1):i.options.grid.data.menu[5].state="selected",o.filter="Complete"):"todo"==o.filter?("selected"==i.options.grid.data.menu[4].state?(i.options.grid.data.menu[4].state="unselected",s=!1):i.options.grid.data.menu[4].state="selected",o.filter="In Process"):"draft"==o.filter&&("selected"==i.options.grid.data.menu[3].state?(i.options.grid.data.menu[3].state="unselected",s=!1):i.options.grid.data.menu[3].state="selected",o.filter="Define"),t.updateFilterPreferences(o.filter,s),t.destroyAndRedrawwithFilters(),i&&"list-delete"!=i.options.grid.semantics.icon.iconName&&i.updateOptions({label:"list-delete"})}"filterbyobject"!=o.type&&widget.getValue("routefilters").indexOf("filterbyobject")>-1&&(widget.setValue("linkedContextTitle",void 0),widget.setValue("compassDataForContext",null),widget.setValue("isWidgetRefreshed","true"),p())},c="",m="";let p=function(t){var o=widget.data.linkedContextTitle;null==t&&(t={type:"filterbyobject",state:"selected",filter:"filterbyobject"}),u(t);var r=e.getGridViewToolbar().getContent().getDocument(),d=r.getElementById("contextObjectSearch");null!=d&&d.remove(),d=UWA.createElement("div",{class:"filter-context",id:"contextObjectSearch"});let p=new s({displayStyle:"lite",label:"lite displayStyle",icon:{iconName:"search",fontIconFamily:WUXManagedFontIcons.Font3DS},showLabelFlag:!1});var f={isMultiSearchMode:!1};f.placeHolderValue=l.searchForRouteContent,f.minLengthToType=3,f.isFreeInputAllowed=!1,f.toKeepSearchResultsFlag=!1;var h=widget.getValue("routeContentSearchTypes"),w=h?h.split(","):"";if(f.getPrecond=function(){var e={};return e.precond=i.getPrecondForContextSearch("is_95_rel_95_objectroute",w),e},m=n.drawAutoCompleteComponent(f),o&&(c=o,m.value=o),m.addEventListener("change",function(e){a.filterByObjectOnChange(e),c=widget.data.linkedContextTitle}),m.inject(d),p.inject(d),p.getContent().addEventListener("buttonclick",function(e){a.init(e,m)}),g(r,d),"unselected"==e.getGridViewToolbar().getNodeModelByID("filter").options.grid.data.menu[6].state){null!=c&&""!=c&&(a.loadSelectedContextRoutes(),c=""),d.empty(),e.getGridViewToolbar().getContent().parentElement.setStyle("height","41px")}},g=function(e,t){if(widget.getValue("routefilters").indexOf("filterbyobject")>-1){let n=null==e.getElementById("contextObjectSearch")?t:e.getElementById("contextObjectSearch"),i=e.querySelector("#routes-main-div #dataGridDivToolbar");if(null!=i&&i.getChildren().length>0){var o=i.getChildren()[0].getElementsByClassName("wux-controls-toolbar-farContainer")[0];let e=n,t=e.parentElement;null!=o&&(null!=t&&t.contains(e)&&(e=t.removeChild(e)),o.insertBefore(e,o.children[0]))}}widget.routeMgmtMediator.publish("filter-by-object-resize")};return{changeOwnerFilter:e=>(function(e){u(e)})(e),changeStateFilter:e=>(function(e){u(e)})(e),openPropertiesView:e=>(function(e){r.sendRouteTrackerEvent({event:"RouteCommand",value:"Route - Properties"});let t=o.getSelectedRowsModel();if(1==t.data.length){let e=t.data[0].options.grid;t.model=e}widget.getValue("propWidgetOpen")?widget.routeMgmtMediator.publish("route-info-close-click",{info:"Route"}):widget.routeMgmtMediator.publish("route-header-info-click",{model:t.model,info:"Route"})})(),renderObjectContextTitle:e=>p(e)}}),define("DS/ENORouteMgmt/Views/Panels/WelcomePanel",["DS/Controls/Abstract","DS/ENORouteMgmt/Utilities/Constants","DS/ENORouteMgmt/Config/WelcomePanelActionsConfig","DS/ENORouteMgmt/Utilities/DataFormatter","DS/Controls/ProgressBar","DS/ENORouteMgmt/Model/RouteModel","DS/ENORouteMgmt/Utilities/Utils","DS/ENORouteMgmt/Actions/Toolbar/RouteSummaryToolbarActions","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l,d){"use strict";let u,c,m=!0;return e.extend({activities:[{id:"list",title:d.AccessYourWork,actions:[{id:t.WELCOMEPANEL_ID_ROUTES,text:d.routes,className:"wcpanel-routes",fonticon:"route",isDefault:void 0===widget.getValue("HomePage")||"routes"===widget.getValue("HomePage")},{id:t.WELCOMEPANEL_ID_ROUTE_TEMPLATES,text:d.templates,className:"wcpanel-routes-templates",fonticon:"template",isDefault:"route_templates"===widget.getValue("HomePage")}]},{id:"creation",title:d.StartNewActivity,actions:[{id:t.WELCOMEPANEL_ID_CREATE_ROUTE,text:d.newRoute,fonticon:"plus",className:"action-new",isNotHighlightable:"true"},{id:t.WELCOMEPANEL_ID_CREATE_ROUTE_TEMPLATE,text:d.newRouteTemplate,fonticon:"template-add",className:"action-new",isNotHighlightable:"true"}]}],init:function(e){this.wPanelOptions={collapsed:!1,title:d.AppHeader,subtitle:"",activities:this.activities,parentContainer:e.leftContainer,selectedItem:t.WELCOMEPANEL_ID_ROUTES,withTogglableButton:!0,modelEvents:e.modelEvents};let n=o.routes,i=o.route_templates;require([n.loader.module],function(e){u=e}),require([i.loader.module],function(e){c=e})},getWPanelOptions:function(){return this.wPanelOptions},registerEvents:function(){let e=this;widget.routeMgmtMediator.subscribe("welcome-panel-action-selected",function(t){if(m){"routes"==t.id&&null!=widget.data.contextTitle&&""!=widget.data.contextTitle?widget.data.contextTitle="":"routes"==t.id&&null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle&&(widget.setValue("linkedContextTitle",void 0),widget.setValue("compassDataForContext",null),widget.setValue("isWidgetRefreshed","true")),m=!1;let n=o[t.id],i={};"routes"==n.id?i.value="Routes":"route_templates"==n.id?i.value="Templates":"new_route"==n.id?i.value="New Route":"new_route_template"==n.id&&(i.value="New Template"),i.event="WelcomePanel",l.sendRouteTrackerEvent(i),"summary_page"==n.content?(widget.setValue("HomePage",n.id),widget.routeMgmtMediator.publish("route-welcome-panel-activity-selection",{id:n.id}),a.clearSummaryPage(),e.showProgressBar(),document.querySelector(".widget-container"),e.loadSummaryPages(n)):(widget.setValue("isDialogOpened",!0),e.loadDialogPages(n))}}),widget.routeMgmtMediator.subscribe("load-filterbyobject-search",function(e){setTimeout(()=>{r.renderObjectContextTitle(e)},200)}),widget.routeMgmtMediator.subscribe("welcome-panel-load-subscribed-data",function(t){if(m){m=!1;let n=o[t.id];"summary_page"==n.content&&(widget.setValue("HomePage",n.id),widget.routeMgmtMediator.publish("route-welcome-panel-activity-selection",{id:n.id}),a.clearSummaryPage(),e.showProgressBar(),document.querySelector(".widget-container"),widget.routeMgmtMediator.publish("template-back-to-summary"),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),"routes"===n.id&&u[n.loader.func]().then(function(t){e.hideProgressBar(),m=!0,e.activateInfoIcon(u)}))}}),widget.routeMgmtMediator.subscribe("welcome_note_icon_event",function(e){console.log(e)}),widget.routeMgmtMediator.subscribe("welcome-panel-toggle",function(e){console.log(e)}),widget.routeMgmtMediator.subscribe("welcome-panel-collapse",function(e){console.log(e)}),widget.routeMgmtMediator.subscribe("welcome-panel-expand",function(e){console.log(e)}),widget.routeMgmtMediator.subscribe("refresh-homepage-after-route-created",function(t){var n=document.querySelector("#RouteImmersiveFrame .wux-controls-checkbox > div.wux-toggle-icon-placeholder");if(null!=widget.data.contextTitle&&""!=widget.data.contextTitle){if(null!=n&&n.hasClassName("wux-ui-fa-check")){t={id:"routes"};widget.routeMgmtMediator.publish("welcome-panel-action-selected",t)}}else if(null!=n&&n.hasClassName("wux-ui-fa-check")&&null!=widget.data.linkedContextTitle&&""!=widget.data.linkedContextTitle){widget.setValue("linkedContextTitle",void 0),widget.setValue("compassDataForContext",null);t={id:"routes"};widget.routeMgmtMediator.publish("welcome-panel-action-selected",t)}if("route_templates"===widget.getValue("HomePage")){a.clearSummaryPage();let n=o.routes;e.loadSummaryPageAndOpenSelected(n,t.model,t.openRoute),widget.routeMgmtMediator.publish("route-welcome-panel-activity-selection",{id:"routes"})}}),widget.routeMgmtMediator.subscribe("refresh-homepage-after-template-created",function(t){if(void 0===widget.getValue("HomePage")||"routes"===widget.getValue("HomePage")){a.clearSummaryPage();let n=o.route_templates;e.loadSummaryPageAndOpenSelected(n,t),widget.routeMgmtMediator.publish("route-welcome-panel-activity-selection",{id:"route_templates"})}})},loadDialogPages:function(e){require([e.loader.module],function(t){t[e.loader.func](),m=!0,widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode")})},loadSummaryPages:function(e){let t=this,o="Route";"routes"===e.id?u[e.loader.func]().then(function(e){let o=widget.getValue("routefilters");o&&o.indexOf("filterbyobject")>-1&&widget.routeMgmtMediator.publish("load-filterbyobject-search"),t.hideProgressBar(),m=!0,widget.routeMgmtMediator.publish("route-back-to-summary"),t.activateInfoIcon(u);var n=document.querySelector("#dataGridDivToolbar .wux-controls-lineeditor .wux-controls-lineeditor-clearbutton");n&&n.addEventListener("click",function(){if(null!=widget.data.contextTitle&&""!=widget.data.contextTitle){widget.data.contextTitle="";var e={id:"routes"};widget.routeMgmtMediator.publish("welcome-panel-action-selected",e)}else{widget.setValue("linkedContextTitle",void 0);e={id:"routes"};widget.routeMgmtMediator.publish("welcome-panel-action-selected",e)}})}):"route_templates"===e.id&&(o="Route Template",c[e.loader.func]().then(function(e){t.hideProgressBar(),m=!0,widget.routeMgmtMediator.publish("template-back-to-summary"),t.activateInfoIcon(c)})),widget.getValue("propWidgetOpen")&&widget.routeMgmtMediator.publish("route-header-info-click",{info:o}),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode")},loadSummaryPageAndOpenSelected:function(e,t,o){require([e.loader.module],function(i){"routes"===e.id?u[e.loader.func]().then(function(e){let i=s.getRowModelById(t.id);i&&i.select(!0),0==o||widget.routeMgmtMediator.publish("route-DataGrid-on-dblclick",{model:n.gridData(t)})}):"route_templates"===e.id&&c[e.loader.func]().then(function(e){widget.routeMgmtMediator.publish("initialize-IDCard-on-dblClick",{model:n.templateGridData(t.data)})})})},showProgressBar:function(){let e=document.querySelector(".widget-container");this.progressbar7=new i({shape:"circular",infiniteFlag:!0,emphasize:"info",statusFlag:!1,height:60}),this.progressbar7.inject(e),this.progressbar7.elements.container.setStyle("margin-left","40%"),this.progressbar7.elements.container.setStyle("margin-top","20%")},hideProgressBar:function(){this.progressbar7.destroy()},activateInfoIcon:function(e){widget.getValue("propWidgetOpen")&&e.activateInfoIcon()}})}),define("DS/ENORouteMgmt/Components/Wrappers/TriptychWrapper",["DS/ENOXTriptych/js/ENOXTriptych","DS/ENORouteMgmt/Views/Panels/WelcomePanel"],function(e,t){"use strict";var o=function(){};return o.prototype.init=function(o,n,i,s,a){this._left=i,this._main=s,this._right=a,this._applicationChannel=o,this._triptych=new e;let r=widget.getValue("route-right-panel-width"),l={left:{resizable:!0,originalSize:300,minWidth:300,originalState:"open",overMobile:!0,withClose:!1},right:{resizable:!0,minWidth:250,originalSize:null==r?400:r,originalState:"close",overMobile:!0,withClose:!1},borderLeft:!1,container:n,withtransition:!0,modelEvents:this._applicationChannel},d={};d.modelEvents=this._applicationChannel,d.leftContainer=i,this._routesWCPanel=new t(d);let u=this._routesWCPanel.getWPanelOptions();this._routesWCPanel.registerEvents(),this._triptych.init(l,i,s,a,u),this._right.addEvent("resize",function(){let e=this.clientWidth;widget.setValue("route-right-panel-width",e)}),this.registerRouteEvents()},o.prototype.inject=function(e){this._triptych.inject(e)},o.prototype._getTriptych=function(){return this._triptych},o.prototype.getLeftPanelContainer=function(){return this._left},o.prototype.getLeftPanelContainerTriptych=function(){return this._triptych._leftPanelContent},o.prototype.getRightPanelContainer=function(){return this._right},o.prototype.getMainPanelContainer=function(){return this._main},o.prototype.registerRouteEvents=function(){let e=this;widget.routeMgmtMediator.subscribe("route-welcome-panel-activity-selection",function(t){e._routesWCPanel.wPanelOptions.parentContainer.getElements(".activity-btn.selected").forEach(e=>{e.removeClassName("selected")}),t.id&&(e._routesWCPanel.wPanelOptions.parentContainer.getElement(".activity-btn#"+t.id).addClassName("selected"),e._routesWCPanel.wPanelOptions.selectedItem=t.id)})},o}),define("DS/ENORouteMgmt/Views/InitiateRouteContentsView",["DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/Accordeon","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Utilities/Dom","DS/TreeModel/TreeDocument","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Views/Menu/InitiateRouteContentContextualMenu","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Views/Grid/InitiateRouteContentsDataGridView","DS/ENORouteMgmt/Utilities/DragAndDrop","DS/ENORouteMgmt/Utilities/DragAndDropManager","DS/ENORouteMgmt/Controller/RouteServicesController","DS/Controls/TooltipModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g,f,h,w,v){"use strict";let S,R=function(e,t){f.onDropManager(e,void 0,"initiate route content")},y=function(e){let t=function(){let e=UWA.createElement("div",{class:"create-iRouteContent-help-content",html:[UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-info fonticon-display fonticon-color-display"})]});return e.tooltipInfos=new w({shortHelp:v.initiateContentHelp,allowUnsafeHTMLShortHelp:!0}),UWA.createElement("div",{class:"create-iRouteContent-view",html:[UWA.createElement("div",{class:"create-iRouteContent-element initiate-routeContent-view-toolbar-help-group",html:[{tag:"div",class:"create-iRouteContent-toolbar-gridview-group"},{tag:"div",class:"create-iRouteContent-help",html:[e]}]})]})}().inject(e),o=p.build(S),n=p.getGridViewToolbar();T();let i=UWA.createElement("div",{id:"dataGridInitiateRouteDivToolbar",class:"initiateRoute-toolbar-container"}).inject(document.querySelector(".create-iRouteContent-toolbar-gridview-group"));n.inject(i);let s=UWA.createElement("div",{id:"idataGridButtonDiv",class:"dataGrid-button-container"}).inject(document.querySelector(".create-iRouteContent-toolbar-gridview-group"));o.inject(s),0==S.getChildren().length&&m.showEmptyInitiateRouteContentPlaceholder(document.querySelector(".dataGrid-button-container")),m.registerListeners(),C();t.querySelector(".create-iRouteContent-toolbar-gridview-group");g.makeDroppable(t,R)},M=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&c.InitiateContentGridRightClick(e,t.nodeModel.options.grid)},T=function(){u.dataGridView().addEventListener("contextmenu",M)},b=function(){return d.getModel()},C=function(){widget.routeMgmtMediator.subscribe("initiateRoute-on-ScopeSelection",function(e){let t=b().contentIds;d.deleteAllRows(),function(e,t){b().scopeId=e.scopeId,b().scopePhyId=e.scopePhyId,b().contentIds=t}(e,t)}),widget.routeMgmtMediator.subscribe("initiateRouteClearContent-on-createAnother",function(){d.getContentIDs().length>0&&d.deleteAllRows()})};return{build:(e,t,o)=>(function(e,t,o){if(t){let n=[];return t.forEach(e=>{n.push(e.id)}),new Promise(function(e,o){h.fetchStateBlockingConditions(n).then(o=>{for(var n=0;n<o.length;n++){let e=t.find(e=>e.id==o[n].physicalid);e.maturityBlockingStates=o[n].maturityBlockingStates,e.maturityTargetStates=o[n].maturityTargetStates,e.RouteBaseState=o[n].RouteBaseState,e.RouteBaseState_NLS=o[n].RouteBaseState_NLS,e.RouteTargetState=o[n].RouteTargetState,e.RouteTargetState_NLS=o[n].RouteTargetState_NLS,e.current=o[n].current}e()})}).then(()=>{(S=d.createModel()).contentIds=t,S.scopeId=o.scopeId,S.scopePhyId=o.scopePhyId,y(e),S=d.appendRow(t)})}(S=d.createModel(t)).contentIds=t,S.scopeId=o.scopeId,S.scopePhyId=o.scopePhyId,y(e)})(e,t,o),destroy:()=>{d.destroy()},getModel:()=>b(),onSearchClick:()=>onSearchClick(),removeContents:()=>{d.getSelectedRowsModel().data.length<1?widget.notify.handler().addNotif({level:"error",subtitle:v.ErrorContentRemoveSelection,sticky:!0}):S=d.deleteSelectedRows()}}}),define("DS/ENORouteMgmt/Utilities/Search/DndSearchUtil",["DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Model/TaskAttachmentModel","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/Controller/RouteServicesController","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l){"use strict";let d=function(e){let t;if(e.dataTransfer){let o=function(e){for(var t,o={},n=UWA.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",i="",s=["text/searchitems","text/plain","Text"],a=0;a<s.length&&""===i;a++){var r=e.dataTransfer.types[n](s[a]);(UWA.is(r,"number")&&r>=0||UWA.is(r,"boolean")&&!0===r)&&(i=s[a])}return""===i?console.log("data format is not correct"):(t=e.dataTransfer.getData(i),o=JSON.parse(t)),o}(e);o.data&&o.data.items&&(t=o.data.items)}else if("object"==typeof e)t=e;else{let o=JSON.parse(e);o.data&&o.data.items&&(t=o.data.items)}return t},u=function(e,t,o,n){let i=[],s=[],a=[];if(null!=o){null!=n&&0!=n.length&&n.forEach(function(e){null==e.options.value.name&&i.push(e.options.value)}),s=e.concat(i);for(let e=0;e<t.length;e++){let o=t[e].objectId;s&&-1==s.indexOf(o)&&a.push(t[e])}}return a},c=function(e,n,s){let a=d(e);if(null!=a){let e=[],r=[],d=[],c=[];if("droppable_TaskViewContentAttachment"==s)r=i.getContentIDs(),e=u(r,a,s,n.autoCompleteComponent.selectedItems);else if("create"==n.mode)r=t.getRouteContentIds(),e=u(r,a,s,n.contentToReviewField.selectedItems);else{if(!(n.mode="taskEditMode"))return;r=o.getContentIDs(),e=u(r,a,s,n.contentToReviewField.selectedItems)}a.length>e.length&&widget.notify.handler().addNotif({subtitle:l.errorAddExistingContentInputField,level:"warning"}),e.length>0&&(d=function(e,t){let o={},n=[],i="",s=[];for(let o=0;o<e.length;o++){let a=e[o].displayType?e[o].displayType:e[o].objectType;if("droppable_TaskViewContentReview"==t||"droppable_TaskViewContentAttachment"==t){let r=widget.getValue("routeContentDnDTypes"),l=["Person","Business Role","Security Context","Route","Route Template","Inbox Task"];(r=r?r.split(","):"").includes(e[o].objectType)&&"droppable_TaskViewContentReview"==t||"droppable_TaskViewContentAttachment"==t&&!l.includes(e[o].objectType)?n.push(e[o]):""==i?(i=a,s.push(a)):-1==s.indexOf(a)&&(i=i+", "+a,s.push(a))}}return o.notSupportedTypeString=i,o.supportedData=n,o}(e,s)),e.length>d.supportedData.length&&widget.notify.handler().addNotif({subtitle:l.replace(l.typeNotSupported,{tag1:d.notSupportedTypeString}),level:"error"}),d.supportedData.length>0&&(c=d.supportedData),g(c,n,s)}},m=function(e,t,o){"droppable_TaskViewContentAttachment"==o?(null!=e.autoCompleteComponent.selectedItems?e.autoCompleteComponent.selectedItems.push(t):e.autoCompleteComponent.selectedItems=t,e.autoCompleteComponent._applySelectedItems()):(null!=e.contentToReviewField.selectedItems?e.contentToReviewField.selectedItems.push(t):e.contentToReviewField.selectedItems=t,e.contentToReviewField._applySelectedItems())},p=function(t){let o;if("create"==t.mode){let t=e.getSecurityContextValue().split(".");3==t.length&&(o=t[1])}else(t.mode="taskEditMode")&&(o=t.routeInfo.organization);return o},g=function(i,d,u){let c=d.routeInfo;var g,f,h=d.mode,w="",v=[];for(let e=0;e<i.length;e++)v.push(i[e].objectId);var S,R=[],y=[],M=((S={})["3dspace"]={SecurityContext:e.getSecurityContextValue()},S),T=e.getTenantValue();g=(g=widget.getValue("routeContentSearchTypes"))?g.split(","):"",null==(f=c.scopeId)&&(f="All"==c.Scope[0]?c.Scope[0]:"Organization"==c.Scope[0]?c.Scope[0]:c.Scope[2]);var b={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_file:["icon","thumbnail_2d"],order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:["3dspace"],tenant:T,resourceid_in:v,with_synthesis:!1,with_synthesis_attribute:!1};if("droppable_TaskViewContentReview"==u){if(w=s.getPrecondForContentSearch("All",g,""),"create"!=h){for(var C=o.getModel().getChildren(),D=0;D<C.length;D++)y.push(C[D]._options.grid.id)}if(R=y,"create"==h){var k=t.getRouteContentIds();for(D=0;D<k.length;D++)R.push(k[D])}null!=d.contentToReviewField&&null!=d.contentToReviewField.selectedItems&&0!=d.contentToReviewField.selectedItems.length&&d.contentToReviewField.selectedItems.forEach(function(e){R.push(e.options.value)}),b.login=M,b.select_predicate=["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname","ds6wg:revision","owner","organization","route_content_scope"],b.resourceid_not_in=R,b.query=w}else"droppable_TaskViewContentAttachment"==u&&(null!=d.attachedDocuments&&(R=JSON.parse(JSON.stringify(d.attachedDocuments))),null!=d.autoCompleteComponent&&null!=d.autoCompleteComponent.selectedItems&&0!=d.autoCompleteComponent.selectedItems.length&&d.autoCompleteComponent.selectedItems.forEach(function(e){null==e.options.value.name&&R.push(e.options.value)}),w=s.getPrecondForDocumentSearch(),b.login=M,b.select_predicate=["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname","organization","route_content_scope"],b.resourceid_not_in=R,b.query=w);let E=[];var O,N={};let A;var I={isfederated:!0};b=JSON.stringify(b),a.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",b,function(e){e&&e.results&&Array.isArray(e.results)&&((O=e.results).forEach(function(e){let t=[];var o=new n;e.attributes.forEach(function(e){"resourceid"===e.name?o.options.value=e.value:"ds6w:label"===e.name&&(o.options.label=e.value),"droppable_TaskViewContentReview"==u&&("ds6w:what/ds6w:type"===e.name?o.options.grid.type=e.value:"resourceid"===e.name?o.options.grid.id=e.value:"ds6w:label"===e.name?o.options.grid.title=e.value:"ds6w:identifier"===e.name?o.options.grid.name=e.value:"ds6w:what/ds6w:status"===e.name?(o.options.grid.state=e.value,o.options.grid.stateNLS=e.value):"ds6w:when/ds6w:created"===e.name?o.options.grid.created=e.value:"ds6w:when/ds6w:modified"===e.name?o.options.grid.modified=e.value:"type_icon_url"===e.name?o.options.grid.type_icon_url=e.value:"owner"===e.name?o.options.grid.owner=e.value:"ds6w:what/ds6w:policy"===e.name?o.options.grid.policy=e.value:"ds6wg:revision"===e.name?o.options.grid.revision=e.value:"organization"===e.name?o.options.organization=e.value:"route_content_scope"===e.name&&t.push(e.value))}),o.options.scopeId=t,E.push(o.options.value),N[o.options.value]=o}),A=i.length==O.length),function(e,t,o,i,s,a,d){let u=[],c=[],g=[];for(let n=0;n<e.length;n++){let r=e[n].objectId;if(i.includes(r)){let e;if("droppable_TaskViewContentAttachment"==o||"droppable_TaskViewContentReview"==o&&"All"==a)e=s[r];else if("droppable_TaskViewContentReview"==o&&"Organization"==a){let o,n=s[r];(o=p(t))==n.options.organization?e=n:u.push(n)}else if("droppable_TaskViewContentReview"==o){let t=[],o=s[r];if((t=o.options.scopeId).length>0)for(let n=0;n<t.length;n++)a==t[n]&&(e=o);void 0===e&&c.push(o)}void 0!==e&&m(t,e,o)}else"droppable_TaskViewContentAttachment"!=o&&"droppable_TaskViewContentReview"!=o||d||i.includes(r)||g.push(r)}g.length>0?r.getContentInfo(g).then(e=>{for(let s=0;s<e.data.length;s++){var i=new n;if(i.options.value=e.data[s].id,i.options.label=e.data[s].title,"droppable_TaskViewContentReview"==o&&(i.options.grid.id=e.data[s].id,i.options.grid.title=e.data[s].title,i.options.grid.name=e.data[s].name,i.options.grid.revision=e.data[s].revision,i.options.grid.owner=e.data[s].owner,i.options.grid.type_icon_url=e.data[s].typeicon),"droppable_TaskViewContentReview"==o&&"Organization"==a){let n;n=p(t),e.data[s].organization==n?m(t,i,o):u.push(e.data[s].id)}else"droppable_TaskViewContentAttachment"!=o&&"droppable_TaskViewContentReview"!=o||m(t,i,o)}u.length>0&&widget.notify.handler().addNotif({subtitle:l.errorInOrganization,level:"error"})}):(u.length>0&&widget.notify.handler().addNotif({subtitle:l.errorInOrganization,level:"error"}),c.length>0&&widget.notify.handler().addNotif({subtitle:l.errorInCotentScope,level:"error"}))}(i,d,u,E,N,f,A)},function(e){widget.notify.handler().addNotif({subtitle:l.NoDataRetrived,level:"error"})},I)};return{getResultFromSearch:(e,t,o,n)=>c(e,t,o)}}),define("DS/ENORouteMgmt/Views/Grid/RouteTaskContentToReviewDataGridView",["DS/ENORouteMgmt/Config/RouteTaskContentToReviewGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Views/Menu/ContentContextualMenu","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","DS/ENORouteMgmt/Utilities/DragAndDropManager"],function(e,t,o,n,i){"use strict";let s,a,r={},l=!1,d=function(n,d,u){l=!!d,a=u;var p=UWA.createElement("div",{id:"routeTaskContentToReview-dataGridViewContainer",class:"routeTaskContentToReview-gridView-View"});r.cellDragEnabledFlag=!0,r.showRowBorderFlag=!0,r.showOutlineFlag=!0,r.showAlternateBackgroundFlag=!1;r.layoutOptions={rowsHeader:!1,columnsHeader:!1,rowSpacing:5,cellWidth:2},r.showContextualMenuColumnFlag=!0,r.onContextualEvent=function(e){e&&e.cellInfos&&o.routeTaskContentToReviewContextualMenu(e,e.cellInfos.nodeModel,l,m,function(e){console.log("asd")},u)};let g=t.build(n,e,!1,p,r);return(s=t.dataGridView()).onDragStartCell=function(e,t){return i.getContentForDrag(e,t),!0},c(),require(["DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],function(e){e.isDocumentManagementInstalled()}),g},u=function(e,t){t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&require(["DS/ENORouteMgmt/Views/Menu/ContentContextualMenu"],function(o){o.routeTaskContentToReviewGridRightClick(e,t.nodeModel.options.grid,l,m)})},c=function(){t.dataGridView().addEventListener("contextmenu",u),widget.routeMgmtMediator.subscribeOnce("triptych-resized",function(e){p()}),widget.routeMgmtMediator.subscribe("task-content-height-update",function(){p()})},m=function(){var e=n.getSelectedRowsModel();n.deleteSelectedRows(),null==a.removeContentToReview&&(a.removeContentToReview=[]);for(var t=0;t<e.data.length;t++)a.removeContentToReview.push(e.data[t].options.grid.id);p()},p=function(){var e=document.querySelector("#routeTaskContentToReview-dataGridViewContainer");let t=s.getRowModelLength();e&&(t<5?e.setStyle("height",41*t+"px"):e.setStyle("height","200px"))};return{build:(e,t,o)=>d(e,t,o)}}),define("DS/ENORouteMgmt/Config/RouteTasksGridViewConfig",["DS/ENORouteMgmt/Views/Grid/RouteTasksGridCustomColumns","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t){"use strict";return[{text:t.order,dataIndex:"taskOrder",pinned:"left",width:"50px"},{text:t.title,dataIndex:"tree",pinned:"left"},{text:t.revision,dataIndex:"revision",width:"70px"},{text:t.taskAction,dataIndex:"taskActionNLS",width:"110px"},{text:t.IDcardMaturityState,dataIndex:"currentNLS",width:"100px",onCellRequest:e.onRouteTaskStateCellRequest},{text:t.approvalStatus,dataIndex:"awaiting_taskApprovalStatus",width:"125px"},{text:t.subRouteApprovalStatus,dataIndex:"subRouteGridApprovalStatus",width:"125px",getCellTypeRepresentation:function(t){return e.getCellTypeRepresentation(t)}},{text:t.searchTaskAssignee,dataIndex:"taskAssignee",editableFlag:!1,onCellRequest:e.onRouteTaskAssigneeCellRequest},{text:t.dueDateAndTime,dataIndex:"taskDueDate",onCellRequest:e.onRouteTaskDueDateCellRequest},{text:t.comments,dataIndex:"comments",width:"133px",allowUnsafeHTMLContent:!0}]}),define("DS/ENORouteMgmt/Views/Grid/RouteTasksDataGridView",["DS/ENORouteMgmt/Config/RouteTasksGridViewConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Config/Toolbar/RouteTasksTabToolbarConfig","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n){"use strict";let i,s;return{build:(a,r)=>(function(a,r){let l=widget.getValue("TasksTab-ShowView"),d="Tasks-gridView-View hideView";l&&"GridView"==l&&(d="Tasks-gridView-View showView");var u=UWA.createElement("div",{id:"dataGridViewContainer",class:d});let c=o.writetoolbarDefination(a,r);var m=e.slice(0,e.length);a.getChildren().forEach(e=>{"TRUE"==e.options.grid.routeOwnerTask&&"routeOwnerUGTitle"!=m[m.length-1].dataIndex&&m.push({text:n.assignmentScope,dataIndex:"routeOwnerUGTitle"})}),r.model.TemplateId&&""!=r.model.TemplateId&&m.push({text:n.generatedFromTemplate,dataIndex:"templateTask"}),"Route Template"==r.model.Type&&(m=m.filter(function(e,t,o){if("revision"!=e.dataIndex&&"awaiting_taskApprovalStatus"!=e.dataIndex&&"comments"!=e.dataIndex&&"subRouteGridApprovalStatus"!=e.dataIndex)return e}),a.parentType="Route Template");let p=t.build(a,m,c,u,{identifier:"RouteTasksDataGridView"});return i=t.dataGridViewToolbar(),s=t.dataGridView(),p})(a,r),getGridViewToolbar:()=>i,getDataGridInstance:()=>s}}),define("DS/ENORouteMgmt/Views/ToggleTaskViews",["DS/ENORouteMgmt/Views/Grid/RouteTasksDataGridView","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o){"use strict";let n,i,s,a,r;return{doToggleView:function(l){let d={};if(d.initialValue=a=l.view,d.event="TaskView","GridView"==a?d.switchValue="Switch to Grid View":"GraphView"==a&&(d.switchValue="Switch to Graph View"),t.sendRouteTrackerEvent(d),s=e.getGridViewToolbar().getNodeModelByID("view"),n=".Tasks-gridView-View",i=".canvas",r="#task-graph-toolbar",widget.setValue("TasksTab-ShowView",l.view),"GridView"==l.view){s.options.grid.data.menu[0].state="selected",s.options.grid.data.menu[1].state="unselected",s&&"view-list"!=s.options.grid.semantics.icon.iconName&&s.updateOptions({grid:{semantics:{icon:{iconName:"view-list"}}},tooltip:o.gridView});let e=document.querySelector(".Tasks-gridView-View");e&&(e.removeClassName("hideView"),e.removeClassName("nonVisible"),e.addClassName("showView"));let t=document.querySelector(".canvas");if(t){t.removeClassName("showView"),t.addClassName("hideView");let e=document.querySelector("#task-graph-toolbar");e&&(e.removeClassName("showView"),e.addClassName("hideView"))}}else if("GraphView"==l.view){s.options.grid.data.menu[0].state="unselected",s.options.grid.data.menu[1].state="selected",s&&"view-small-tile"!=s.options.grid.semantics.icon.iconName&&s.updateOptions({grid:{semantics:{icon:{iconName:"flow-tree"}}},tooltip:o.titleGraphView});let e=document.querySelector(".Tasks-gridView-View");e&&(e.removeClassName("showView"),e.addClassName("hideView"));let t=document.querySelector(".canvas");if(t){t.removeClassName("hideView"),t.addClassName("showView");let e=document.querySelector("#task-graph-toolbar");e&&(e.removeClassName("hideView"),e.addClassName("showView"))}let n=document.querySelector("#task-graph-toolbar"),i=document.querySelector(".no-tasks-to-show-container");n&&null==i&&n.show()}},getViewType:function(){return null==a?widget.getValue("TasksTab-ShowView"):a},resetViewType:function(){a=void 0}}}),define("DS/ENORouteMgmt/Model/RouteTaskModel",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Utilities/DataFormatter","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Utilities/RouteViewUtils","DS/ENORouteMgmt/Commands/RouteTaskApprovalProcess","DS/ENORouteMgmt/Views/ToggleTaskViews","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l,d,u,c){"use strict";let m=new e,p=function(e,t){let o=e.subRouteApprovalStatus,n=l.getRouteActivityStateNLS(o),i={icon:l.getRouteActivityStateIcon(o),label:n};return o&&o.contains("your")&&(i.func=function(o){t.taskTitleForSubRoute=e.title,t.taskIdForSubRoute=e.id,t.fromPage="hyperlink",d.getApprovalCommandMenu(t,"openInboxTask").then(e=>{e.action.callback()},e=>{})},i.icon+=" awaiting-tasks"),i},g=function(e){return n.getRowModelById(m,e)};return{createModel:e=>(function(e){m.prepareUpdate();let r=o.getTaskTreeDocument().getChildren();if(r)for(let o=1;o<r.length-1;o++){let n=r[o].getAllDescendants();if(n)for(let o=0;o<n.length;o++){let r=n[o].options.grid;if("UG Action Node"==r.nodeType||"Task Action Node"==r.nodeType)continue;let d={route:[]};if(null!=r.taskSubRoutes){let e=r.taskSubRoutes;for(let t=0;t<e.length;t++)d.route.push({dataelements:{id:e[t].routeId,name:e[t].routeName,approvalTaskId:e[t].approvalTaskId}})}let u=a.getApprovalStatusForTask1(r,e.model);r.awaiting_taskApprovalStatus=c[u],null!=r.subRouteApprovalStatus&&""!=r.subRouteApprovalStatus?r.subRouteGridApprovalStatus=p(r,d):r.subRouteGridApprovalStatus="";var l=new t({label:r.title,graphNodeId:n[o]._id,id:r.id,width:300,grid:i.taskGridData(r),icons:[s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")]});m.addRoot(l)}}return m.pushUpdate(),n.dataGridView()&&n.dataGridView().reapplySortModel(),m})(e),updateModel:e=>(function(e){m.prepareUpdate(),m.removeRoots();let r=o.getTaskTreeDocument().getChildren();if(r)for(let o=1;o<r.length-1;o++){let n=r[o].getAllDescendants();if(n)for(let o=0;o<n.length;o++){let r=n[o].options.grid;if("UG Action Node"==r.nodeType||"Task Action Node"==r.nodeType)continue;let d={route:[]};if(null!=r.taskSubRoutes){let e=r.taskSubRoutes;for(let t=0;t<e.length;t++)d.route.push({dataelements:{id:e[t].routeId,name:e[t].routeName,approvalTaskId:e[t].approvalTaskId,activityState:e[t].activityState}})}let u=a.getApprovalStatusForTask1(r,e.model);r.awaiting_taskApprovalStatus=c[u],null!=r.subRouteApprovalStatus&&""!=r.subRouteApprovalStatus?r.subRouteGridApprovalStatus=p(r,d):r.subRouteGridApprovalStatus="";var l=new t({label:r.title,graphNodeId:n[o]._id,id:r.id,width:300,grid:i.taskGridData(r),icons:[s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")]});null==l.options.label&&(l.options.label=c.taskTitlePlaceholder),m.addRoot(l)}}if(m.pushUpdate(),n.dataGridView()&&n.dataGridView().reapplySortModel(),null!=m&&null!=widget.data.inboxTaskSelectedId&&"GridView"==u.getViewType()){let e=m.getChildren();for(var d=0;d<e.length;d++)if(e[d].options.id==widget.data.inboxTaskSelectedId){e[d].select(!0),widget.data.inboxTaskSelectedId=void 0;break}}return m})(e),getModel:()=>m,getRowModelById:e=>g(e),getSelectedRowsModel:()=>n.getSelectedRowsModel(m),destroy:()=>{m=new e},appendRows:e=>(function(e){m.prepareUpdate(),e.forEach(e=>{var o=new t({label:c.taskTitlePlaceholder,graphNodeId:e._id,id:e.options.grid.id,width:300,grid:i.taskGridData(e.options.grid),icons:[s.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")]});m.addRoot(o)}),m.pushUpdate()})(e),updateAssignee:e=>(function(e){if(e.id&&""!=e.id){var t=e.taskAssigneeName,o=e.taskAssigneeUserName,n=g(e.taskId),i=n.options.grid;i.assigneeTitle=t,i.assigneeType=e.newAssigneeType,i.taskAssignee=t,i.taskAssigneeUsername=o,i.assigneePID=e.newAssigneeId,i.assigneeId=e.newAssigneeId,i.taskAcceptLink=e.taskAcceptLink,i.routeOwnerTask=e.routeOwnerTask,i.routeOwnerUGChoice=e.routeOwnerUGChoice,i.routeOwnerUGName=e.routeOwnerUGName,i.routeOwnerUGTitle=e.routeOwnerUGTitle,"TRUE"!=e.routeOwnerTask&&(i.taskActionNLS=c[i.taskAction],"Route Node"==e.type?i.awaiting_taskApprovalStatus=void 0:"Inbox Task"==e.type&&(i.awaiting_taskApprovalStatus=c[a.getApprovalStatusForTask(i,"Started")])),n.updateOptions({grid:i})}})(e),deleteRowModelById:e=>(function(e){n.deleteRowModelById(m,e)})(e)}}),define("DS/ENORouteMgmt/Views/Form/TaskInViewMode",["DS/ENORouteMgmt/Views/Form/CustomFieldUtils","DS/ENORouteMgmt/Utilities/Utils","DS/WUXAutoComplete/AutoComplete","DS/UIKIT/Input/File","DS/ENORouteMgmt/Views/Loader/InitiateDocumentChooser","DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/Model/TaskAttachmentModel","DS/ENORouteMgmt/Views/Grid/TaskAttachmentsDataGridView","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Model/ContentToReviewModel","DS/ENORouteMgmt/Views/Grid/RouteTaskContentToReviewDataGridView","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","DS/ENORouteMgmt/Views/Loader/InitiateDocumentContentToReviewChooser","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Views/Form/TaskViewUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g,f,h,w,v){"use strict";let S,R=function(e,t,o){return o||(o=""),new UWA.Element("h5",{class:o,text:t.label}).inject(e)},y=function(e){if(e&&""!=e){let o=new Date(e);e=t.getLocaleDate(o,!0)}return e},M=function(e){return new n({input:!1,multiple:!0,buttonText:"",buttonClassName:"fonticon fonticon-upload",events:{onChange:function(t){for(var o=0;o<t.target.files.length;o++){var n;(n=new s({label:t.target.files[o].name,value:t.target.files[o],grid:{action:"upload"}})).options.value.options="",null==e.selectedItems?e.selectedItems=n:e.selectedItems.push(n),e._applySelectedItems()}S.elements.input.title=v.upload}}})},T=function(e){var t=UWA.createElement("div",{class:"fonticon fonticon-plus",id:"attachmentSearch",title:v.addExistingAttachment});return t.addEventListener("click",function(t){if("undefined"!=typeof dscef){let t=[],o=e.attachedDocuments,n=e.autoCompleteComponent;null!=o&&(t=JSON.parse(JSON.stringify(o))),null!=n&&null!=n.selectedItems&&0!=n.selectedItems.length&&n.selectedItems.forEach(function(e){null==e.options.value.name&&t.push(e.options.value)});let i={taskProperties:e,alreadyAttachedDocs:t,invokeFrom:"form"};widget.routeMgmtMediator.publish("launch-add-attachment-search",i)}else i.init(t,e.autoCompleteComponent,e.attachedDocuments)}),t},b=function(e,t,o){var n=UWA.createElement("div",{class:"fonticon fonticon-plus",id:"contentToReviewSearch",title:v.addExistingContent});return n.addEventListener("click",function(n){w.validationForAssigneeField(o)&&f.init(n,e.contentToReviewField,e.attachedContentsToReview,t,o)}),n};return{drawTitleInViewMode:(e,t,o)=>(function(e,t,o){new UWA.Element("h5",{class:"",text:v.title}).inject(e),new UWA.Element("span",{text:t.model.title}).inject(e),o.elements.title={value:t.model.title}})(e,t,o),drawOrderInViewMode:(e,t,o)=>(function(e,t,o){new UWA.Element("h5",{class:"",text:v.taskOrder}).inject(e),new UWA.Element("span",{text:t.model.taskOrder}).inject(e),o.elements.order={value:t.model.taskOrder}})(e,t,o),drawAssigneeInViewMode:(e,t,o,n)=>(function(e,t,o,n){var i;new UWA.Element("h5",{class:"",text:v.taskassignee}).inject(e),new UWA.Element("span",{text:n}).inject(e),null!=n&&""!=n&&(i=new s({label:n,value:t.model.assigneeId,name:t.model.taskAssigneeUsername,type:t.model.assigneeType}),o.elements.assignee={selectedItems:i})})(e,t,o,n),drawCustomFieldsInViewMode:(t,o,n,i)=>(function(t,o,n,i){e.getFieldType(o);let s=n.model[o.name];if(e.isDateField(o))if(e.isMultiValueField(o)){let e=[];for(let t=0;t<s.length;t++)e.push(y(s[t]));s=e}else s=y(s);"LineEditor with Unit"==e.getFieldType(o)&&(s+=" "+e.getDefaultUnit(o).display);new UWA.Element("span",{text:s}).inject(t),i.elements[o.name]={value:s}})(t,o,n,i),drawLabelInViewMode:(e,t,o)=>R(e,t,o),drawListOfAttachments:(e,t,o)=>(function(e,t,o){var n=new UWA.Element("div",{id:"taskAttachmentsId",class:""});if(o){var i={};i.label=v.attachments,R(n,i,"attachmentHeader")}if(e.model.taskAttachments&&e.model.taskAttachments.length>0){l.destroy(),l.createModel(e.model.taskAttachments),l.getModel().RouteId=t.id;let i=l.getModel();d.build(i,o).inject(n)}else o&&new UWA.Element("span",{text:v.noAttachments}).inject(n);return n})(e,t,o),drawListOfRouteTaskContentToReviews:(e,t,o,n)=>(function(e,t,o,n){var i=new UWA.Element("div",{id:"routeTaskContentToReviewId",class:""});if(o){var s={};s.label=v.contentToReview,R(i,s,"contentToReviewHeader")}if(e.model.RouteTaskContentToReview&&e.model.RouteTaskContentToReview.length>0){if(g.destroy(),e.model.routeContents&&e.model.routeContents.length>0){let t=e.model.routeContents,o=e.model.RouteTaskContentToReview,n=[];for(let e=0;e<t.length;e++){let i=!1;for(let n=0;n<o.length;n++)t[e].id==o[n].id&&(i=!0);i||n.push(t[e])}e.model.RouteTaskContentToReview=o.concat(n)}g.createModel(e.model.RouteTaskContentToReview),g.getModel().RouteId=t.id;let s=g.getModel();if(e.model.removeContentToReview&&e.model.removeContentToReview.length>0&&null!=s){s.prepareUpdate();for(var a=s.getChildren(),r=0;r<a.length;r++)-1!=e.model.removeContentToReview.indexOf(a[r]._options.grid.id)&&(s.removeRoot(r),r--);s.pushUpdate()}s&&s.getChildren().length>0&&m.build(s,o,n).inject(i)}else o&&new UWA.Element("span",{text:v.noAttachments}).inject(i);return i})(e,t,o,n),renderAttachmentField:e=>(function(e,t,o){var n=new UWA.Element("div",{class:"attachmentField"}).inject(e.formFields),i={};i.label=v.attachments;R(n,i,"attachmentHeader");var s=new UWA.Element("div",{class:"attachmentButton"}).inject(n);(S=M(e.autoCompleteComponent)).elements.input.title=v.upload,S.inject(s),T(e).inject(s)})(e),getAutoComponent:e=>(function(e){return new o({multiSearchMode:!0,elementsTree:function(t){return new Promise(function(o,n){var i=[];null!=e.attachedDocuments&&(i=JSON.parse(JSON.stringify(e.attachedDocuments))),null!=e.autoCompleteComponent&&null!=e.autoCompleteComponent.selectedItems&&0!=e.autoCompleteComponent.selectedItems.length&&e.autoCompleteComponent.selectedItems.forEach(function(e){null==e.options.value.name&&i.push(e.options.value)});var s={};s["3dspace"]={SecurityContext:u.getSecurityContextValue()};var a={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",login:s,select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname"],select_file:["icon","thumbnail_2d"],query:"("+t+' AND NOT (flattenedtaxonomies:"types/Person" OR flattenedtaxonomies:"types/Business Role" OR flattenedtaxonomies:"types/Security Context" OR flattenedtaxonomies:"types/Route" OR flattenedtaxonomies:"types/Route Template" OR flattenedtaxonomies:"types/Inbox Task"))',order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:["3dspace"],tenant:u.getTenantValue(),resourceid_not_in:i};a=JSON.stringify(a);var l={isfederated:!0};r.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",a,function(e){var t=[];e&&e.results&&Array.isArray(e.results)&&e.results.forEach(function(e){var o={};e.attributes.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(o.type=e.value),"resourceid"===e.name&&(o.value=e.value),"ds6w:label"===e.name&&(o.label=e.value),"ds6w:identifier"===e.name&&(o.name=e.value)}),o.data=o,t.push(o)}),o(t)},function(e){n(e)},l)})},placeholder:v.typeToDropAndSearch,minLengthBeforeSearch:3,allowFreeInputFlag:!1})})(e),renderRouteTaskContentToReviewField:(e,t,o)=>(function(e,t,o){var n=new UWA.Element("div",{class:"contentToReviewField"}).inject(e.formFields),i={};i.label=v.contentToReview;R(n,i,"contentToReviewHeader");var s=new UWA.Element("div",{class:"contentToReviewButton"}).inject(n);b(e,t,o).inject(s)})(e,t,o),getRouteTaskContentToReviewField:(e,t,n,i)=>(function(e,t,n,i){return new o({multiSearchMode:!0,elementsTree:function(o){if(w.validationForAssigneeField(t))return new Promise(function(i,l){var d=[],c=[];if("create"!=n)for(var m=g.getModel().getChildren(),f=0;f<m.length;f++)c.push(m[f]._options.grid.id);if(d=c,"create"==n){var w=p.getRouteContentIds();for(f=0;f<w.length;f++)d.push(w[f])}null!=e.contentToReviewField&&null!=e.contentToReviewField.selectedItems&&0!=e.contentToReviewField.selectedItems.length&&e.contentToReviewField.selectedItems.forEach(function(e){d.push(e.options.value)});var v={};v["3dspace"]={SecurityContext:u.getSecurityContextValue()};var S="",R=widget.getValue("routeContentSearchTypes");R=R?R.split(","):"";var y=t.scopeId;null==y&&(y="All"==t.Scope[0]?t.Scope[0]:"Organization"==t.Scope[0]?t.Scope[0]:t.Scope[2]),S=h.getPrecondForContentSearch(y,R,""),""!=o&&(S="(([ds6w:label]:(*"+o+"*) OR [ds6w:identifier]:(*"+o+"*)) AND "+S+")");var M={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",login:v,select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname","ds6wg:revision","owner"],select_file:["icon","thumbnail_2d"],query:S,order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:["3dspace"],tenant:u.getTenantValue(),resourceid_not_in:d};M=JSON.stringify(M);var T={isfederated:!0};r.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",M,function(e){var t=new a;e&&e.results&&Array.isArray(e.results)&&e.results.forEach(function(e){var o=new s;e.attributes.forEach(function(e){"ds6w:what/ds6w:type"===e.name?o.options.grid.type=e.value:"resourceid"===e.name?(o.options.value=e.value,o.options.grid.id=e.value):"ds6w:label"===e.name?(o.options.label=e.value,o.options.grid.title=e.value):"ds6w:identifier"===e.name?o.options.grid.name=e.value:"ds6w:what/ds6w:status"===e.name?(o.options.grid.state=e.value,o.options.grid.stateNLS=e.value):"ds6w:when/ds6w:created"===e.name?o.options.grid.created=e.value:"ds6w:when/ds6w:modified"===e.name?o.options.grid.modified=e.value:"type_icon_url"===e.name?o.options.grid.type_icon_url=e.value:"owner"===e.name?o.options.grid.owner=e.value:"ds6w:what/ds6w:policy"===e.name?o.options.grid.policy=e.value:"ds6wg:revision"===e.name&&(o.options.grid.revision=e.value)}),t.addRoot(o)}),i(t)},function(e){l(e)},T)})},placeholder:v.typeToDropAndSearch,minLengthBeforeSearch:3,allowFreeInputFlag:!1,keepSearchResultsFlag:!1})})(e,t,n),drawRouteContentsInTaskViewMode:(e,t,o,n)=>(function(e,t,o,n){var i=new UWA.Element("div",{id:"routeTaskContentToReviewId",class:""});if(n){var s={};s.label=v.contentToReview,R(i,s,"contentToReviewHeader")}g.destroy(),g.createModel(e.model.routeContents),g.getModel().RouteId=o.id;let a=g.getModel();a&&a.getChildren().length>0&&m.build(a,n,t).inject(i);return i})(e,t,o,n)}}),define("DS/ENORouteMgmt/Views/Form/TaskView",["DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/Controls/ComboBox","DS/Controls/DatePicker","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/ENORouteMgmt/Views/Form/TaskInViewMode","DS/ENORouteMgmt/Views/Form/TaskInEditMode","DS/ENORouteMgmt/Services/RouteServices","DS/ENORouteMgmt/Views/Loader/InitiateDocumentChooser","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Views/Form/ENORouteAutoComplete","DS/ENORouteMgmt/Utilities/Search/SearchUtil","DS/ENORouteMgmt/Model/InitiateRouteContentModel","DS/ENORouteMgmt/Model/ContentToReviewModel","DS/ENORouteMgmt/Model/RouteTaskContentToReviewModel","DS/ENORouteMgmt/Views/Grid/TaskAssociatedContent","DS/ENORouteMgmt/Utilities/DragAndDropOnTaskInputField","DS/ENORouteMgmt/Utilities/Search/DndSearchUtil","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g,f,h,w,v,S,R,y,M,T,b){"use strict";let C,D,k,E,O,N,A,I,U,x=function(e,t,o,n,i,s){if("create"!=n&&d.isInboxTask(e)){let n,a,r,l=new UWA.Element("div",{id:"customAttributes",class:""}).inject(t.formFields),m=widget.getValue("task-custom-fields");m&&m.forEach((m,p)=>{"extensions"!=m.name&&(n=new UWA.Element("div",{id:"customAttr_"+m.name,class:""}).inject(l),a=new UWA.Element("div",{id:"customAttr_label"}).inject(n),r=new UWA.Element("div",{id:"customAttr_Val"}).inject(n),e.model.hasOwnProperty(m.name)&&(i&&d.canUserCompleteTask(e,o)||s&&d.canUserEditTask(e)&&d.isInboxTask(e)?(c.drawLabelInEditMode(a,m,e,t),c.drawCustomFieldsInEditMode(r,m,e,t)):(u.drawLabelInViewMode(a,m),u.drawCustomFieldsInViewMode(r,m,e,t))))})}},F=function(e,t,o,n){let i=!_(e,n,o);if(e.model.taskAttachments&&e.model.taskAttachments.length>0){u.drawListOfAttachments(e,o,i).inject(t.formFields),t.attachedDocuments=[],e.model.taskAttachments.forEach(function(e){t.attachedDocuments.push(e.id)})}},V=function(e,t,o,n,i){if(S.destroy(),e.model.RouteTaskContentToReview&&e.model.RouteTaskContentToReview.length>0){e.model.routeContents.forEach(function(e){e.relatedToTaskIds&&0==e.relatedToTaskIds.length&&(e.canDeleteContent=!1)}),"Review"==e.model.current&&e.model.RouteTaskContentToReview.forEach(function(e){e.canDeleteContent=!1}),u.drawListOfRouteTaskContentToReviews(e,o,i,t).inject(t.formFields),t.attachedContentsToReview=[],e.model.RouteTaskContentToReview.forEach(function(e){t.attachedContentsToReview.push(e.id)})}else{if(null==e.model.routeContents){let t=v.getModel().getChildren();if(t.length>0){let o=[];for(let e=0;e<t.length;e++)if(null==t[e].options.grid.relatedToTaskIds||t[e].options.grid.relatedToTaskIds&&0==t[e].options.grid.relatedToTaskIds.length){let n={};n.typeicon=t[e].options.icons[0],n.id=t[e].options.grid.id,n.title=t[e].options.grid.Title,n.name=t[e].options.grid.Name,n.type=t[e].options.grid.Type,n.canDeleteContent=!1,o.push(n)}e.model.routeContents=o}}if(e.model.routeContents&&e.model.routeContents.length>0){e.model.routeContents.forEach(function(e){e.canDeleteContent=!1}),u.drawRouteContentsInTaskViewMode(e,t,o,i).inject(t.formFields)}}},_=function(e,t,o){return!(!t||!d.canUserReview(e,o))||!(!t||!d.canUserCompleteTask(e,o))},P=function(e){C&&widget.routeMgmtMediator.unsubscribe(C),D&&widget.routeMgmtMediator.unsubscribe(D),k&&widget.routeMgmtMediator.unsubscribe(k),E&&widget.routeMgmtMediator.unsubscribe(E),"create"!=e&&(O&&widget.routeMgmtMediator.unsubscribe(O),N&&widget.routeMgmtMediator.unsubscribe(N)),A&&widget.routeMgmtMediator.unsubscribe(A)},W=function(){return U},L=function(e,t){let o=W();let n;null!=t.querySelector("#droppable_TaskViewContentReview")?n="droppable_TaskViewContentReview":null!=t.querySelector("#droppable_TaskViewContentAttachment")&&(n="droppable_TaskViewContentAttachment"),null!=n&&M.getResultFromSearch(e,o,n,{})};return{build:(i,m,p)=>(function(i,m,p){let w,S,M;P(p),(w={}).currentValue={},S=m.model.model,M=m.model.routePropertiesInfo.model?m.model.routePropertiesInfo.model:m.model.routePropertiesInfo;var _={model:m.model.model.options.grid};"create"!=p&&widget.setValue("taskIdTobePersisted",_.model.id),w.elements={},w.formBody=new UWA.Element("div",{id:"InitiateTaskPropertiesBody",class:"task-prop-body"}),w.formBody.inject(i),w.formHeader=new UWA.Element("div",{id:"InitiateTaskPropertiesHeader",class:"task-prop-header"}),w.formHeader.inject(w.formBody),w.formFields=new UWA.Element("div",{id:"InitiateTaskPropertiesContainer",class:"task-prop-container"}),w.formFields.inject(w.formBody),w.formFooter=new UWA.Element("div",{id:"InitiateTaskPropertiesFooter",class:"task-prop-footer"}),w.formFooter.inject(w.formBody),w.taskAssigneeField=new UWA.Element("div",{id:"SearchTaskAssigneeField",class:"fonticon-chooser-display"}),w.taskAssignmentScopeField=new UWA.Element("div",{id:"SearchTaskAssignmentScopeField",class:"fonticon-chooser-scope-display"}),w.dueDateDiv=new UWA.Element("div",{id:"dueDate",class:""}),w.dueDateDivOption1=new UWA.Element("div",{id:"dueDateOption1",class:"fonticon-chooser-display fit-content"}),w.dueDateDivOption2=new UWA.Element("div",{id:"dueDateOption2",class:"fonticon-chooser-display"}),w.dueDateDivOption3=new UWA.Element("div",{id:"dueDateOption3",class:"fonticon-chooser-display"});var W=!1,G=!1,j=!1,B=!1,q="required";w.closeEventName="route-task-close-click","taskActionMode"==p?(j=!0,W=!0,q="",w.closeEventName="route-task-close-click-view-mode"):"taskEditMode"==p&&(w.closeEventName="route-task-close-click-edit-mode",G=!0,"Auto Complete"==_.model.approvalStatus?(B=!0,j=!0):d.canUserEditTask(_)?(j=!1,B=!d.canUserEditAllFields(_)):(j=!0,q="")),UWA.createElement("div",{title:b.taskFormPropertiesTooltip,class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attributes fonticon-display fonticon-color-display",styles:{"font-size":"20px",float:"left",color:"#368ec4"},events:{click:function(e){}}}).inject(w.formHeader),UWA.createElement("div",{id:"taskViewPanelClose",title:b.taskFormCloseTooltip,class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-close fonticon-display fonticon-color-display",styles:{"font-size":"20px",float:"right"},events:{click:function(e){widget.routeMgmtMediator.publish(w.closeEventName),P(p)}}}).inject(w.formHeader),"taskActionMode"==p&&"HRL1"==_.model.taskAcceptLink&&UWA.createElement("div",{title:b.taskFormAcceptTaskTooltip,class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-user-ok fonticon-display fonticon-color-display",styles:{"font-size":"20px",float:"right"},events:{click:function(e){d.taskAccept(_,M,"callFromPanel")}}}).inject(w.formHeader);var H=new UWA.Element("div",{id:"titleId",class:""}).inject(w.formFields);j||B||d.canLoadInViewMode(_,M)?u.drawTitleInViewMode(H,_,w):c.drawTitleInEditMode(H,_,w,q);var J=new UWA.Element("div",{id:"expectedActionId",class:""}).inject(w.formFields),z="Comment";if(_.model.taskAction&&""!=_.model.taskAction&&(z=_.model.taskAction),B?new UWA.Element("h5",{class:"",text:b.taskAction}).inject(J):I=new UWA.Element("h5",{class:q,text:b.taskAction}).inject(J),j||B){var X="";"TRUE"==_.model.routeOwnerTask?X=b.assign:"Approve"==_.model.taskAction?X=b.approve:"Notify Only"==_.model.taskAction?X=b.notifyOnly:"Comment"==_.model.taskAction&&(X=b.Comment),new UWA.Element("span",{text:X}).inject(J),w.elements.expectedAction={value:_.model.taskAction}}else{M.BasePurpose&&(M.routeBasePurpose=M.BasePurpose);var K=d.expectedActionElemList(M.routeBasePurpose,_.model.routeOwnerTask);w.elements.expectedAction=new s({elementsList:K,value:z,enableSearchFlag:!1}).inject(J),"Route Template"==M.Type&&w.elements.expectedAction.addEventListener("change",function(e){let t=e.dsModel.selectedIndex;"Approve"==(t=t=0==t?"Approve":1==t?"Notify Only":"Comment")||"Comment"==t?(1==w.elements.radioAssigneeChooser.checked&&(w.elements.taskAssigneeChooser.disabled=!1,w.elements.assignee._editor.elements.inputField.disabled=!1),w.elements.radioAssigneeRouteOwner.disabled=!1,1==w.elements.radioAssigneeRouteOwner.checked&&(w.taskAssignmentScopeField.className="fonticon-chooser-display",w.formFields.querySelector("#assignmentScopeLabel").show())):(w.elements.radioAssigneeChooser.checked=!0,w.elements.taskAssigneeChooser.disabled=!1,w.elements.assignee._editor.elements.inputField.disabled=!1,w.elements.radioAssigneeRouteOwner.disabled=!0,w.elements.assignmentScope.selectedItems=void 0,w.taskAssignmentScopeField.className="fonticon-chooser-scope-display",w.formFields.querySelector("#assignmentScopeLabel").hide())})}j&&"Route Template"!=M.Type&&V(_,w,M,W,j);var Y=new UWA.Element("div",{id:"needOwnerReviewId",class:""}).inject(w.formFields);new UWA.Element("div",{styles:{padding:"inherit"}}).inject(Y);var $=!1;if("Yes"==_.model.needsOwnerReview&&($=!0),j){var Z=b.taskNeedOwnerReviewNo;$&&(Z=b.taskNeedOwnerReviewYes),new UWA.Element("h5",{text:b.needsOwnerReview}).inject(Y),new UWA.Element("span",{text:Z}).inject(Y)}else w.elements.needOwnerReview=new n({type:"checkbox",label:b.needsOwnerReview,value:$,checkFlag:$}).inject(Y);if(!j&&"Route Template"!=M.Type&&(w.contentToReviewField=u.getRouteTaskContentToReviewField(w,M,p,_),u.renderRouteTaskContentToReviewField(w,p,M),w.contentToReviewField.inject(w.formFields),_.model.contentToReviewFieldInfo&&0!=_.model.contentToReviewFieldInfo.length&&_.model.contentToReviewFieldInfo.forEach(function(e){var t=new l({label:e.title,value:e.id});t.options.grid=e,null==w.contentToReviewField.selectedItems?w.contentToReviewField.selectedItems=t:w.contentToReviewField.selectedItems.push(t),w.contentToReviewField._applySelectedItems()}),"create"!=p))if("Review"==_.model.current){w.contentToReviewField.elements.container.hide(),w.formFields.querySelector("#contentToReviewSearch").hide();var Q,ee=v.getModel(),te=!1;if(null!=ee){Q=ee.getChildren();for(var oe=0;oe<Q.length;oe++)if(null==Q[oe].options.grid.relatedToTaskIds||0==Q[oe].options.grid.relatedToTaskIds.length){te=!0;break}}te||null!=_.model.RouteTaskContentToReview&&_.model.RouteTaskContentToReview.length>0?V(_,w,M,W,!1):w.formFields.querySelector(".contentToReviewField").hide()}else new UWA.Element("div",{html:"&nbsp;"}).inject(w.formFields),V(_,w,M,W,!1);if("create"==p){let e=new UWA.Element("div",{id:"taskAssociatedContentDatagridViewId",class:""}).inject(w.formFields);R.build().inject(e),R.registerListners(),R.setContentDatagridHeight()}var ne=new UWA.Element("div",{id:"instructionId",class:""}).inject(w.formFields);I=new UWA.Element("h5",{class:q,text:b.instructions}).inject(ne),q&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(I),j?new UWA.Element("span",{text:_.model.instructions}).inject(ne):(_.model.instructions||(_.model.instructions=""),w.elements.instruction=new t({placeholder:b.placeholderInstructions,pattern:"[^./#,\\[\\]\\$\\^@\\*\\?%:'\"\\\\<>]+",widthInCharNumber:30,nbRows:4,newLineMode:"enter",value:_.model.instructions}).inject(ne)),w.currentValue.order=_.model.taskOrder;var ie=new UWA.Element("div",{id:"taskOrderId",class:""}).inject(w.formFields);if(j||B||_.model.userGroupInfo&&""!=_.model.userGroupInfo||d.canLoadInViewMode(_,M)&&"Modify Task List"!=M.taskEditSetting?u.drawOrderInViewMode(ie,_,w):c.drawOrderInEditMode(ie,_,w,q),"Route Template"==M.Type){var se=new UWA.Element("div",{id:"assigneeId",class:""}).inject(w.formFields);B?new UWA.Element("h5",{class:"",text:b.taskassignee}).inject(se):(I=new UWA.Element("h5",{class:q,text:b.taskassignee}).inject(se),q&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(I)),null==_.model.taskAssignee&&(_.model.taskAssignee=""),null==_.model.assigneeTitle&&(_.model.assigneeTitle="");var ae=_.model.taskAssignee;if(_.model.assigneeType&&(ae="Person"==_.model.assigneeType?_.model.taskAssignee:_.model.assigneeTitle),w.currentValue.assigneeId=_.model.assigneePID,j||B){if("TRUE"==_.model.routeOwnerTask&&(ae=b.routeOwnerTask),new UWA.Element("span",{text:ae}).inject(se),null!=ae&&""!=ae&&(pe=new l({label:ae,value:_.model.assigneeId,name:_.model.taskAssigneeUsername,type:_.model.assigneeType}),w.elements.assignee={selectedItems:pe}),"TRUE"==_.model.routeOwnerTask&&""!=_.model.routeOwnerUGChoice){var re=new UWA.Element("div",{id:"assignmentScopeId",class:""}).inject(w.formFields);I=new UWA.Element("h5",{class:q,text:b.routeOwnerTaskAssignmentScope}).inject(re),new UWA.Element("span",{text:_.model.routeOwnerUGTitle}).inject(re)}}else{var le=!0;"TRUE"==_.model.routeOwnerTask&&(le=!1),w.radioAssigneeChooserDiv=new UWA.Element("div",{id:"radioAssigneeChooserDiv",class:"fonticon-chooser-display fit-content"}).inject(w.formFields),w.elements.radioAssigneeChooser=new UWA.Element("input",{type:"radio",name:"AssigneeOption",value:"1",checked:le,class:"cursor-pointer"}),w.elements.radioAssigneeChooser.inject(w.radioAssigneeChooserDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(w.radioAssigneeChooserDiv),w.radioAssigneeRouteOwnerTaskDiv=new UWA.Element("div",{id:"radioAssigneeRouteOwnerTask",class:"fonticon-chooser-display fit-content"}).inject(w.formFields),w.elements.radioAssigneeRouteOwner=new UWA.Element("input",{type:"radio",name:"AssigneeOption",value:"2",checked:!le,class:"cursor-pointer"}),w.elements.radioAssigneeRouteOwner.inject(w.radioAssigneeRouteOwnerTaskDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(w.radioAssigneeRouteOwnerTaskDiv);var de={isMultiSearchMode:!1};de.placeHolderValue=b.searchTaskAssigneePlaceHolder,de.minLengthToType=3,de.isFreeInputAllowed=!1,de.toKeepSearchResultsFlag=!1,"OnPremise"!=g.getTenantValue()&&(de.source=["3dspace","usersgroup"]),de.getPrecond=function(){return h.getPrecondForTaskMemberSearch(M)},de.getValidation=function(){return d.validationForAssigneeField(M)},de.getChangeHandler=function(){return d.changeHandlerForAssigneeField(w,M,S)},w.elements.assignee=f.drawAutoCompleteComponent(de),le?(w.elements.assignee._editor.elements.inputField.disabled=!1,null!=ae&&""!=ae&&(pe=new l({label:ae,value:_.model.assigneeId,name:_.model.taskAssigneeUsername,type:_.model.assigneeType}),w.elements.assignee.selectedItems=pe)):(w.elements.assignee.selectedItems=void 0,w.elements.assignee._editor.elements.inputField.disabled=!0),w.elements.assignee.inject(w.radioAssigneeChooserDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(w.radioAssigneeChooserDiv),w.elements.taskAssigneeChooser=new o({icon:{iconName:"search"},disabled:!le}),w.elements.taskAssigneeChooser.inject(w.radioAssigneeChooserDiv),w.elements.taskAssigneeChooser.getContent().addEventListener("buttonclick",function(){d.launchAssigneeSearch(event,w,M,S)}),w.taskAssigneeField.inject(w.radioAssigneeChooserDiv),w.routeOwnerTaskDiv=new UWA.Element("div",{id:"routeOwnerTaskId",class:""}).inject(w.radioAssigneeRouteOwnerTaskDiv),new UWA.Element("div",{id:"routeOwnerTaskTextDiv",html:[UWA.createElement("span",{class:"task-days-from-text",text:b.routeOwnerTask})]}).inject(w.radioAssigneeRouteOwnerTaskDiv),""==w.elements.expectedAction.value||"Approve"!=w.elements.expectedAction.value&&"Comment"!=w.elements.expectedAction.value?(w.routeOwnerTaskDiv.style.display="none",w.elements.radioAssigneeRouteOwner.disabled=!0):w.routeOwnerTaskDiv.style.display="";var ue,ce={isMultiSearchMode:!1};ce.placeHolderValue=b.searchPlaceHolderAssignmentScope,ce.minLengthToType=3,ce.isFreeInputAllowed=!1,ce.toKeepSearchResultsFlag=!1,"OnPremise"!=g.getTenantValue()&&(ce.source=["usersgroup"]),ce.getPrecond=function(){return h.getPrecondForRouteOwnerAssignmentScope(M)},w.elements.assignmentScope=f.drawAutoCompleteComponent(ce),null!=_.model.routeOwnerUGTitle&&""!=_.model.routeOwnerUGTitle&&null!=_.model.routeOwnerUGChoice&&""!=_.model.routeOwnerUGChoice&&null!=_.model.routeOwnerUGName&&""!=_.model.routeOwnerUGName&&(ue=new l({label:_.model.routeOwnerUGTitle,value:_.model.routeOwnerUGChoice,name:_.model.routeOwnerUGName}),w.elements.assignmentScope.selectedItems=ue),new UWA.Element("h5",{class:"",id:"assignmentScopeLabel",text:"     "+b.routeOwnerTaskAssignmentScope}).inject(w.formFields),w.elements.assignmentScope.inject(w.taskAssignmentScopeField),new UWA.Element("div",{html:"&nbsp;"}).inject(w.taskAssignmentScopeField),w.elements.assignmentScopeChooser=new o({icon:{iconName:"search"}}),w.elements.assignmentScopeChooser.inject(w.taskAssignmentScopeField),w.elements.assignmentScopeChooser.getContent().addEventListener("buttonclick",function(){d.launchAssignmentScopeSearch(event,w,M,S)}),w.taskAssignmentScopeField.inject(w.formFields),le?w.formFields.querySelector("#assignmentScopeLabel").hide():(w.taskAssignmentScopeField.className="fonticon-chooser-display",w.formFields.querySelector("#assignmentScopeLabel").show()),w.elements.radioAssigneeChooser.onclick=function(e){w.routeOwnerTaskDiv.style.display="none",w.elements.taskAssigneeChooser.disabled=!1,w.elements.assignee._editor.elements.inputField.disabled=!1,w.taskAssignmentScopeField.className="fonticon-chooser-scope-display",w.formFields.querySelector("#assignmentScopeLabel").hide(),w.elements.assignmentScope.selectedItems=void 0},w.elements.radioAssigneeRouteOwner.onclick=function(e){w.routeOwnerTaskDiv.style.display="",w.elements.taskAssigneeChooser.disabled=!0,w.elements.assignee._editor.elements.inputField.disabled=!0,w.taskAssignmentScopeField.className="fonticon-chooser-display",w.formFields.querySelector("#assignmentScopeLabel").show(),w.elements.assignee.selectedItems=void 0,w.elements.assignmentScope._editor.elements.inputField.focus()}}}else if("TRUE"==_.model.routeOwnerTask){var me;se=new UWA.Element("div",{id:"assigneeId",class:""}).inject(w.formFields),new UWA.Element("h5",{class:"",text:b.taskassignee}).inject(se),"create"==p?(ae=g.getLoginUserFullName(),me=g.getLoginUser()):(ae=_.model.taskAssignee,me=_.model.taskAssigneeUsername),new UWA.Element("span",{text:ae}).inject(se);var pe,ge="contextUser";if(m.model.routePropertiesInfo.model&&(ge=_.model.assigneeId),null!=ae&&""!=ae&&(pe=new l({label:ae,value:ge,name:me,type:"Person"}),w.elements.assignee={selectedItems:pe}),""!=_.model.routeOwnerUGChoice&&null!=_.model.routeOwnerUGChoice&&_.model.routeOwnerUGChoice.length>0){var fe=new UWA.Element("div",{id:"routeOwnerUserGroupId",class:""}).inject(w.formFields);new UWA.Element("h5",{text:b.assignmentScope}).inject(fe),new UWA.Element("span",{text:_.model.routeOwnerUGTitle}).inject(fe)}}else se=new UWA.Element("div",{id:"assigneeId",class:""}).inject(w.formFields),null==_.model.taskAssignee&&(_.model.taskAssignee=""),null==_.model.assigneeTitle&&(_.model.assigneeTitle=""),ae=_.model.taskAssignee,_.model.assigneeType&&(ae="Person"==_.model.assigneeType?_.model.taskAssignee:_.model.assigneeTitle),w.currentValue.assigneeId=_.model.assigneePID,j||B||d.canLoadInViewMode(_,M)&&"Modify Task List"!=M.taskEditSetting?u.drawAssigneeInViewMode(se,_,w,ae):c.drawAssigneeInEditMode(se,_,w,q,M,S,ae);!_.model.chooseUsersFromUg||"True"!=_.model.chooseUsersFromUg&&"False"!=_.model.chooseUsersFromUg||(w.chooseUsersFromUgDiv=new UWA.Element("div",{id:"chooseUsersFromUgId",class:""}).inject(w.formFields),"Route Template"==M.Type&&_.model.chooseUsersFromUg,w.elements.chooseUsersFromUg=new n({type:"checkbox",label:b.ChooseUsersFromUG,value:_.model.chooseUsersFromUg,checkFlag:!0,disabled:"Route Template"!=M.Type}).inject(w.chooseUsersFromUgDiv),"Route Template"==M.Type?"Group"!=_.model.assigneeType&&"Group Proxy"!=_.model.assigneeType||"True"!=M.chooseUserFromGroup&&"True"!=M.selectUsersFromUserGroup?w.chooseUsersFromUgDiv.style.display="none":(w.chooseUsersFromUgDiv.style.display="",w.elements.chooseUsersFromUg.checkFlag="False"!=_.model.chooseUsersFromUg,(j||B)&&(w.elements.chooseUsersFromUg.disabled=!0)):"False"!=_.model.chooseUsersFromUg&&"Person"!=_.model.assigneeType||(w.chooseUsersFromUgDiv.style.display="none"));var he=new UWA.Element("div",{id:"allowDelegationId",class:""}).inject(w.formFields),we=!1;if(null==_.model.allowDelegation&&null!=localStorage.getItem(g.getLoginUser()+"_allowDelegation")?we="true"==localStorage.getItem(g.getLoginUser()+"_allowDelegation"):"TRUE"==_.model.allowDelegation&&(we=!0),j){var ve=b.taskAllowDelegationNo;we&&(ve=b.taskAllowDelegationYes),new UWA.Element("h5",{text:b.allowDelegation}).inject(he),new UWA.Element("span",{text:ve}).inject(he)}else w.elements.allowDelegation=new n({type:"checkbox",label:b.allowDelegation,value:we,checkFlag:we}).inject(he),w.elements.allowDelegation.addEventListener("change",function(e){localStorage.setItem(g.getLoginUser()+"_allowDelegation",!e.dsModel.value)});var Se=new Date;Se.setDate(Se.getDate()+1);var Re=new Date;Re.setDate(Re.getDate()-1),_.model.taskDueDate&&(Se=new Date(_.model.taskDueDate));var ye=d.dueDateOptionSelected(_);if(!j){var Me=new UWA.Element("div",{id:"dueDateId",class:""}).inject(w.formFields);I=new UWA.Element("h5",{class:q,text:b.dueDateAndTime}).inject(Me),q&&UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(I),w.elements.radioDueDateOption1=new UWA.Element("input",{type:"radio",name:"dueDate",value:"1",checked:!0,class:"cursor-pointer"}),w.elements.radioDueDateOption1.inject(w.dueDateDivOption1),new UWA.Element("div",{html:"&nbsp;"}).inject(w.dueDateDivOption1),w.elements.dueDateOptionSelected=1,w.elements.radioDueDateOption1.onclick=function(){d.enableDisableDueDateOptions(w.elements.radioDueDateOption1.value,w)},new UWA.Element("div",{html:"&nbsp;"}).inject(w.dueDateDivOption1),(Se-Re)/864e5<0&&(Re=Se),w.elements.radioDueDateOption1Date=new a({value:new Date(Se),minValue:new Date(Re),timePickerFlag:!0}),w.elements.radioDueDateOption1Date.inject(w.dueDateDivOption1),w.dueDateDivOption1.inject(w.dueDateDiv),"Route Template"==M.Type&&(w.dueDateDivOption1.style.display="none",1==ye&&(ye=3));var Te=!1;2==ye&&(Te=!0),w.elements.radioDueDateOption2=new UWA.Element("input",{type:"radio",name:"dueDate",value:"2",checked:Te,class:"cursor-pointer"}),w.elements.radioDueDateOption2.inject(w.dueDateDivOption2),new UWA.Element("div",{html:"&nbsp;"}).inject(w.dueDateDivOption2),w.elements.radioDueDateOption2.onclick=function(){d.enableDisableDueDateOptions(w.elements.radioDueDateOption2.value,w)},new UWA.Element("div",{html:"&nbsp;"}).inject(w.dueDateDivOption2),_.model.dueDateOffset||(_.model.dueDateOffset=""),w.elements.radioDueDateOption2DaysFrom=new e({pattern:"[0-9]+",sizeInCharNumber:1,disabled:!0,value:_.model.dueDateOffset}),w.elements.radioDueDateOption2DaysFrom.inject(w.dueDateDivOption2),new UWA.Element("div",{html:"&nbsp;"}).inject(w.dueDateDivOption2),new UWA.Element("div",{html:[UWA.createElement("span",{class:"task-days-from-text",text:b.dueDateTextStartsFrom})]}).inject(w.dueDateDivOption2),new UWA.Element("div",{html:"&nbsp;"}).inject(w.dueDateDivOption2),w.elements.radioDueDateOption2ComboBox=new s({elementsList:[{labelItem:b.dueDateFromRouteStart,valueItem:"Route Start Date"},{labelItem:b.dueDateFromPriorTask,valueItem:"Task Create Date"}],value:_.model.dateOffsetFrom,enableSearchFlag:!1,disabled:!0}),w.elements.radioDueDateOption2ComboBox.inject(w.dueDateDivOption2),w.dueDateDivOption2.inject(w.dueDateDiv);var be=!1;3==ye&&(be=!0),w.elements.radioDueDateOption3=new UWA.Element("input",{type:"radio",name:"dueDate",value:"3",checked:be,class:"cursor-pointer"}),w.elements.radioDueDateOption3.inject(w.dueDateDivOption3),new UWA.Element("div",{html:"&nbsp;"}).inject(w.dueDateDivOption3),w.elements.radioDueDateOption3.onclick=function(){d.enableDisableDueDateOptions(w.elements.radioDueDateOption3.value,w)},new UWA.Element("div",{html:"&nbsp;"}).inject(w.dueDateDivOption3),w.elements.radioDueDateOption3Text=new UWA.Element("span",{html:b.assigneeSetDueDate}).inject(w.dueDateDivOption3),w.dueDateDivOption3.inject(w.dueDateDiv),w.dueDateDiv.inject(w.formFields),ye&&d.enableDisableDueDateOptions(ye,w)}if(j||(w.saveButton=new UWA.Element("div",{id:"saveButtonId",class:"task-save-float"}).inject(w.formFooter),w.elements.save=new o({label:b.apply,emphasize:"primary"}).inject(w.saveButton),new UWA.Element("div",{html:"&nbsp;"}).inject(w.saveButton),w.elements.save.getContent().addEventListener("buttonclick",function(){d.taskDataSave(_,p,w,S,M)})),W&&d.canUserCompleteTask(_,M)){if(_.model.reviewersComments&&""!=_.model.reviewersComments){var Ce=new UWA.Element("div",{id:"commentId",class:""}).inject(w.formFields);new UWA.Element("h5",{class:"",text:b.reviewComments}).inject(Ce),new UWA.Element("span",{html:_.model.reviewersComments}).inject(Ce)}var De=new UWA.Element("div",{id:"dueDateIdCompleteTask",class:""}).inject(w.formFields);if(w.elements.dueDateOptionSelected=ye,3==w.elements.dueDateOptionSelected){let e=new UWA.Element("h5",{class:"required",text:b.dueDateAndTime}).inject(De);(Se-Re)/864e5<0&&(Re=Se),UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(e),w.elements.taskActionDueDate=new a({value:new Date(Se),minValue:new Date(Re),timePickerFlag:!0}).inject(w.formFields),w.elements.taskActionDueDate.addEventListener("change",function(){widget.routeMgmtMediator.publish("task-due-date-changed",!0)})}else{new UWA.Element("h5",{class:"",text:b.dueDateAndTime}).inject(De);var ke=d.dueDateViewMode(_,Se);new UWA.Element("span",{text:ke}).inject(De)}let e=new UWA.Element("h5",{class:"required",text:b.collabTaskAddComment}).inject(w.formFields);UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(e),_.model.comments||(_.model.comments=""),w.elements.taskApproveComments=new UWA.Element("textarea",{name:"ckeditorTaskComment"}),require(["DS/CKEditor/CKEditor"],function(e){c.drawTaskComments(e,_.model.comments)}),w.elements.taskApproveComments.inject(w.formFields),w.autoCompleteComponent=u.getAutoComponent(w),u.renderAttachmentField(w),w.autoCompleteComponent.inject(w.formFields),new UWA.Element("div",{html:"&nbsp;"}).inject(w.formFields);var Ee=new r;if("Approve"==_.model.taskAction&&d.canPerformTaskAction(_.model.taskDetails)){var Oe=new l({label:b.taskApprove,grid:{valueItem:"Approve"},icons:[{iconName:"thumbs-up"}]}),Ne=new l({label:b.taskReject,grid:{valueItem:"Reject"},icons:[{iconName:"thumbs-down"}]}),Ae=new l({label:b.taskAbstain,grid:{valueItem:"Abstain"},icons:[{iconName:"ignore"}]});Ee.addRoot(Oe),Ee.addRoot(Ne),"true"==M.showAbstain&&Ee.addRoot(Ae)}if("Comment"==_.model.taskAction){var Ie=new l({label:b.taskComplete,grid:{valueItem:"Complete"},icons:[{iconName:"thumbs-up"}]});Ee.addRoot(Ie)}var Ue=new l({label:b.taskSaveForLater,grid:{valueItem:"saveForLater"}});Ee.addRoot(Ue),w.taskActionButtonDiv=new UWA.Element("div",{id:"taskActionButtonDiv",class:"task-action-button-allign"}),w.elements.taskActionButtons=new s({enableSearchFlag:!1,actionOnClickFlag:!0,elementsTree:Ee}),w.elements.taskActionButtons.inject(w.taskActionButtonDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(w.taskActionButtonDiv),w.taskActionButtonDiv.inject(w.formHeader),w.elements.taskActionButtons.getContent().addEventListener("click",function(){"saveForLater"==w.elements.taskActionButtons.value?T.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Save for later"}):T.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - "+w.elements.taskActionButtons.value}),d.taskActionUpdate(_,w,M)}),w.formFooter.style.display="none"}else if(W&&d.canUserReview(_,M)){var xe=new UWA.Element("div",{id:"dueDateIdReviewTask",class:""}).inject(w.formFields);new UWA.Element("h5",{class:"",text:b.dueDateAndTime}).inject(xe),ke=d.dueDateViewMode(_,Se),new UWA.Element("span",{text:ke}).inject(xe),new UWA.Element("h5",{class:"",text:b.collabTaskAddComment}).inject(w.formFields),_.model.comments||(_.model.comments=""),new UWA.Element("span",{html:_.model.comments}).inject(w.formFields);let e=new UWA.Element("h5",{class:"required",text:b.reviewComments}).inject(w.formFields);UWA.createElement("div",{class:"required-label-routes fonticon fonticon-asterisk-alt"}).inject(e),_.model.reviewersComments||(_.model.reviewersComments=""),w.elements.taskReviewersComments=new UWA.Element("textarea",{name:"ckeditorTaskReviewComment"}),require(["DS/CKEditor/CKEditor"],function(e){c.drawTaskReviewComments(e,_.model.reviewersComments)}),w.elements.taskReviewersComments.inject(w.formFields),w.autoCompleteComponent=u.getAutoComponent(w),u.renderAttachmentField(w),w.autoCompleteComponent.inject(w.formFields),new UWA.Element("div",{html:"&nbsp;"}).inject(w.formFields),Ee=new r;var Fe=new l({label:b.taskReviewAccept,grid:{valueItem:"promote"},icons:[{iconName:"check"}]});Ee.addRoot(Fe),Ne=new l({label:b.taskReviewReject,grid:{valueItem:"demote"},icons:[{iconName:"thumbs-down"}]}),Ee.addRoot(Ne),w.taskReviewButtonDiv=new UWA.Element("div",{id:"taskReviewButtonDiv",class:"task-action-button-allign"}),w.elements.taskReviewButtons=new s({enableSearchFlag:!1,actionOnClickFlag:!0,elementsTree:Ee}),w.elements.taskReviewButtons.inject(w.taskReviewButtonDiv),new UWA.Element("div",{html:"&nbsp;"}).inject(w.taskReviewButtonDiv),w.taskReviewButtonDiv.inject(w.formHeader),w.elements.taskReviewButtons.getContent().addEventListener("click",function(){"promote"==w.elements.taskReviewButtons.value?T.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Accept"}):"demote"==w.elements.taskReviewButtons.value&&T.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Reject"}),d.taskReviewUpdate(_,w,M)}),w.formFooter.style.display="none"}else if(j){var Ve=new UWA.Element("div",{id:"dueDateViewOnlyId",class:""}).inject(w.formFields);if(new UWA.Element("h5",{class:"",text:b.dueDateAndTime}).inject(Ve),ke=d.dueDateViewMode(_,Se),new UWA.Element("span",{text:ke}).inject(Ve),_.model.comments&&""!=_.model.comments){var _e=new UWA.Element("div",{id:"commentId",class:""}).inject(w.formFields);new UWA.Element("h5",{class:"",text:b.collabTaskAddComment}).inject(_e),new UWA.Element("span",{html:_.model.comments}).inject(_e)}_.model.reviewersComments&&""!=_.model.reviewersComments&&(Ce=new UWA.Element("div",{id:"commentId",class:""}).inject(w.formFields),new UWA.Element("h5",{class:"",text:b.reviewComments}).inject(Ce),new UWA.Element("span",{html:_.model.reviewersComments}).inject(Ce)),w.formFooter.style.display="none"}F(_,w,M,W),x(_,w,M,p,W,G),C=widget.routeMgmtMediator.subscribe("initiateRoute-on-RouteBasePurposeSelection",function(e){w.elements.expectedAction.elementsList=d.expectedActionElemList(e.basePurpose),"Route Template"==M.Type&&("Approval"==e.basePurpose?w.routeOwnerTaskDiv.style.display="":"Review"==e.basePurpose?w.routeOwnerTaskDiv.style.display="none":""==w.elements.expectedAction.value||"Approve"!=w.elements.expectedAction.value&&"Comment"!=w.elements.expectedAction.value?w.routeOwnerTaskDiv.style.display="none":w.routeOwnerTaskDiv.style.display="")}),D=widget.routeMgmtMediator.subscribe("initiateRoute-on-TemplateSelection",function(e){P(p),widget.routeMgmtMediator.publish(w.closeEventName)}),D=widget.routeMgmtMediator.subscribe("InitiateTemplate-on-chooseUGSelection",function(e){"Route Template"==e.Type&&("True"==e.chooseUserFromUG&&(w.elements.assignee.selectedItems&&"Group"==w.elements.assignee.selectedItems.options.type||w.elements.assignee.selectedItems&&"Group Proxy"==w.elements.assignee.selectedItems.options.type)?w.chooseUsersFromUgDiv&&(w.chooseUsersFromUgDiv.style.display=""):w.chooseUsersFromUgDiv&&(w.chooseUsersFromUgDiv.style.display="none"))}),k=widget.routeMgmtMediator.subscribe("initiateRoute-on-ScopeSelection",function(e){d.clearAssigneeFields(w)}),E=widget.routeMgmtMediator.subscribe("clearContentToReview-on-ContentRemoval",function(e){d.updateContentToReviewFieldOnContentRemoval(w,e)}),"create"!=p&&(O=widget.routeMgmtMediator.subscribe("redraw-graph",function(e){P(p),widget.routeMgmtMediator.publish(w.closeEventName)}),N=widget.routeMgmtMediator.subscribe("route-header-info-click",function(e){P(p)})),A=widget.routeMgmtMediator.subscribe("task-panel-close",function(e){P(p),widget.routeMgmtMediator.publish(w.closeEventName)}),U=w,null!=w.elements.title.elements&&""==w.elements.title.elements.inputField.value.trim()&&setTimeout(function(){w.elements.title.elements.inputField.focus()},1e3),w.mode=p,w.routeInfo=M;let Pe=w.formFields.querySelector(".wux-ui-state-undefined.wux-controls-lineEditor-lite");null!=Pe&&("taskActionMode"==w.mode?y.makeDroppable(Pe,L,"TaskViewContentAttachment"):y.makeDroppable(Pe,L,"TaskViewContentReview"))})(i,m,p),destroy:e=>P(e),getTaskPropertyFields:()=>W(),ondropTaskView:(e,t)=>{L(e,t)}}}),define("DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils",["i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","DS/egraph/core","DS/egraph/views","DS/egraph/iact","DS/egraph/utils","DS/Controls/ResponsiveTileView","DS/Controls/ComboBox","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Model/InitiateRouteTaskModel","DS/ENORouteMgmt/Views/Dialogs/ChangeAssignee","DS/ENORouteMgmt/Views/Dialogs/DeleteTask","DS/ENORouteMgmt/Actions/TaskActions","DS/ENORouteMgmt/Views/Graph/TaskCustomTileView","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/Utilities/Dom","DS/ENORouteMgmt/Model/Utils/TaskModelUtils","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/Controls/TooltipModel","DS/ENORouteMgmt/Model/RouteTaskModel","DS/ENORouteMgmt/Controller/CollabTaskServicesController","DS/ENORouteMgmt/Utilities/RouteRefreshUtils","DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/ENORouteMgmt/Commands/RouteTaskApprovalProcess","DS/WebappsUtils/WebappsUtils","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Model/TaskAttachmentModel","DS/ENORouteMgmt/Views/Form/TaskView","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g,f,h,w,v,S,R,y,M,T,b,C,D,k,E,O,N,A,I){"use strict";let U,x,F,V,_,P,W,L,G=[],j=[],B={x_initialPos:-132,y_initialPos:150,y_pos_diff_odd:120,y_pos_even:53,y_initialPos_node:120},q={height:80,width:225},H={view:55,create:62,edit:62},J={height:25},z={width:30,width_diff:15},X=50,K=50,Y=120,$=function(e){return e.options.grid.title||e.options.grid.name},Z=function(t){let o;t.routePropertiesInfo.model&&(o=t.routePropertiesInfo.model);let n=v.getApprovalStatusForTask1(t.options.grid,o),i={};if(n)if("Auto Complete"==t.options.grid.approvalStatus)i.label=e.completedByOwner,i.color="grey";else{i.label=e[n];let t=function(e){let t,o;return"awaitingApproval"==e||"awaitingReview"==e||"awaitingComment"==e||"awaitingAssignment"==e?t="wux-ui-3ds-hourglass":"approved"==e?(t="wux-ui-3ds-thumbs-up",o="green"):"notificationSent"==e?(t="wux-ui-3ds-notification-read",o="green"):"abstained"==e?t="wux-ui-3ds-ignore":"rejected"==e?(t="wux-ui-3ds-thumbs-down",o="red"):"RouteStopped"==e?(t="wux-ui-3ds-stop",o="red"):"commented"==e?(t="wux-ui-3ds-comment",o="green"):"tobeapproved"!=e&&"tobecommented"!=e&&"notificationtobesent"!=e||(o="grey"),{icon:t,color:o}}(n);i.icon=t.icon,i.color=t.color}return i},Q=function(t){let o,n={},i=t.routePropertiesInfo.model?t.routePropertiesInfo.model.Type:t.routePropertiesInfo.Type,s=t.routePropertiesInfo.model?t.routePropertiesInfo.model:t.routePropertiesInfo;if("Complete"==t.options.grid.current?(o=t.options.grid.taskActualCompletionDate,n.dateTooltip=e.completionDate):(o=t.options.grid.taskDueDate,n.dateTooltip=e.taskDueDate),"object"==typeof o?o=o.toLocaleDateString():o&&"string"==typeof o&&(o=new Date(o).toLocaleDateString()),t.options.grid.taskAssignee&&(n.assignee=t.options.grid.taskAssignee),t.options.grid.current&&(n.state=t.options.grid.current,n.stateNLS=t.options.grid.stateNLS),"Route Template"==i&&"TRUE"==t.options.grid.routeOwnerTask?(n.assignee="Ask Route Owner",n.assigneeType="Ask Route Owner",n.assigneeIcon="wux-ui-3ds-user-clock"):(t.options.grid.taskAssigneeUsername&&(n.assigneeUserName=t.options.grid.taskAssigneeUsername),t.options.grid.assigneeType&&(n.assigneeType=t.options.grid.assigneeType),t.options.grid.assigneeTitle&&(n.assigneeTitle=t.options.grid.assigneeTitle)),o&&(n.duedate=o),t.options.grid.attrTaskStatus){let o=function(t){let o,n,i;switch(t){case"status-late":o="wux-ui-3ds-attention",i=e.overdue,n="red";break;case"status-due":o="wux-ui-3ds-clock",n="orange",i=e.soonToBeOverDue;break;default:o="",n="",i=""}return{icon:o,color:n,tooltip:i}}(t.options.grid.attrTaskStatus);o&&(n.dueDateStatus=o)}return"Route Template"==i||"Yes"!==t.options.grid.isInitialTask||s.sConnectedRTId||(n.initialTask=!0,n.routeInitialTaskTooltip=e.routeInitialTaskTooltip),"Route Template"!=i&&"Yes"===t.options.grid.templateTask&&(n.templateTask=!0,n.templateTaskTooltip=e.templateTaskTooltip),n.graphCurrentType=t.graphCurrentType,n.taskSubRoutes=t.options.grid.taskSubRoutes,n.subRouteApprovalStatus=t.options.grid.subRouteApprovalStatus,n.taskTitleForSubRoute=t.options.grid.title,n.taskIdForSubRoute=t.options.grid.id,n},ee=function(t,o){let n;if("Start"==o.title)(n=g.generateIcon({iconName:"flag",fontIconFamily:WUXManagedFontIcons.Font3DS})).title=e[o.title];else{n=new UWA.createElement("div",{class:"finish-node"}),g.generateIcon({iconName:"flag-finish",fontIconFamily:WUXManagedFontIcons.Font3DS}).inject(n).title=e[o.title];let t=o.model.getTreeDocument().options.routeInfoJSON.model;if(t&&"Route Template"===t.Type);else if("view"==o.model.getTreeDocument().options.graphType){let e=new UWA.createElement("span",{class:"finish-info wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-help"}),o=te(t);e.tooltipInfos=new S({shortHelp:o,allowUnsafeHTMLShortHelp:!0}),n.appendChild(e)}}let i={};return i.content=n,i.type="terminating node",o.model&&(i.model=oe(o)),i},te=function(t){let o,n="",i="";return n="Notify Route Owner"==t.routeCompletionAction?e.routeComletionActionNotify:e.routeComletionActionPromote,t.linkedRouteTemplate&&(o=e.replace(e.routeCompletionActionLinkRT,{tag1:t.linkedRouteTemplate})),i=e.replace(e.finishNodeHelpTooltip,{tag1:n,tag2:o})},oe=function(e){let t={options:{}};return t.options.grid={},t.options.grid.taskOrder=parseInt(e.model.options.grid.taskOrder)+1,t},ne=function(e,t){this.node=e,this.title=String(t.title),t.model&&(this.model=oe(t))},ie=function(e){e.highlight(),"view"==L&&le(e,"select")},se=function(e){e.unhighlight(),"view"==L&&le(e,"deSelect")},ae=function(e,t){fe(t),ie(e),t._isHighlighted=!0},re=function(e,t){let o=!0;if(Ne()&&0==e.detail&&(o=!1),o){let e=t.getOption("taskModel");e.getTreeDocument().options._isTaskPanelOpened||(t.isHighlighted()?(se(t),e._isHighlighted=!1):(fe(e),ie(t),e._isHighlighted=!0))}},le=function(e,t){let o=e.options.taskModel.options.grid.id,n=R.getModel().getChildren();for(var i=0;i<n.length;i++){let e=n[i].options.id;if(null!=e&&null!=o&&e==o){"select"==t?n[i].select(!0):n[i].unselect(!0);break}}},de="",ue=!1,ce=function(t){de=et();let o=t.getOption("taskModel"),n=o.getTreeDocument(),i=n.options.graphType;if("view"!=i)if(n.options._isTaskPanelOpened)widget.notify.handler().addNotif({level:"error",subtitle:e.taskErrorOnEdit,sticky:!1});else{ae(t,o),o._isTaskPanelOpened=!0,n.options._isTaskPanelOpened=!0;let e=n.options.graphType,i={};i.model=o,i.routePropertiesInfo=n.options.routeInfoJSON;let s=ye(e,"open");widget.routeMgmtMediator.publish(s,{model:i}),widget.routeMgmtMediator.publish("task-content-height-update"),be(t,o),Me(t,o)}else{widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",function(){N.getAttachmentRemovalStatus("reset"),de="",me(ue=!1)}),widget.routeMgmtMediator.subscribe("route-task-close-click-edit-mode",function(){N.getAttachmentRemovalStatus("reset"),de="",me(ue=!1)}),widget.routeMgmtMediator.subscribe("task-due-date-changed",function(e){me(ue=!!e)});let s=O.getTaskTreeDocument().getChildren(),a=N.getAttachmentRemovalStatus(),r=document.querySelector("#InitiateTaskPropertiesContainer .cke_editable_inline"),l=A.getTaskPropertyFields(),d=!1;if("view"==i&&""!=de)for(let i=1;i<s.length-1;i++){let u=s[i].getAllDescendants();if(u)for(let i=0;i<u.length;i++){let s=u[i].options.grid;if(s.id==de){let i="";i="Review"==s.current?null!=s.reviewersComments||null!=s.reviewersComments?s.reviewersComments.trim():"":null!=s.comments||null!=s.comments?s.comments.trim():"";let u="";null!=r&&(u="Review"==s.current?CKEDITOR.instances.ckeditorTaskReviewComment.getData():CKEDITOR.instances.ckeditorTaskComment.getData());let c="";if(null!=l&&l.autoCompleteComponent){let e=l.autoCompleteComponent.selectedItems;c=e&&e.length>0?"attachmentsAdded":""}if(null!=r&&i!=u||""!=c||a||pe()){d=!0;let i=new b;i.inject(document.body);let s=o.options.grid.id==de;new C({modalFlag:!0,width:350,height:150,title:e.openTask,content:s?e.reopenSelectedTask:e.unsavedTaskChanges,immersiveFrame:i,buttons:{Ok:new D({disabled:!1,onClick:function(e){e.dsModel.dialog.close(),ae(t,o),o._isTaskPanelOpened=!0,n.options._isTaskPanelOpened=!0;let i=n.options.graphType,s={};s.model=o,s.routePropertiesInfo=n.options.routeInfoJSON;let a=ye(i,"open");widget.routeMgmtMediator.publish(a,{model:s}),widget.routeMgmtMediator.publish("task-content-height-update"),be(t,o),Me(t,o),de=o.options.grid.id,N.getAttachmentRemovalStatus("reset"),me(ue=!1)}}),Cancel:new D({onClick:function(e){e.dsModel.dialog.close()}})}})}}}}if(!d){ae(t,o),o._isTaskPanelOpened=!0,n.options._isTaskPanelOpened=!0;let e=n.options.graphType,i={};i.model=o,i.routePropertiesInfo=n.options.routeInfoJSON;let s=ye(e,"open");widget.routeMgmtMediator.publish(s,{model:i}),widget.routeMgmtMediator.publish("task-content-height-update"),be(t,o),Me(t,o),de=o.options.grid.id,me(ue=!1)}}},me=function(e){ue=e},pe=function(){return ue},ge=function(e){de="",e.routePropertiesInfo=e.getTreeDocument().options.routeInfoJSON,e.graphCurrentType=L;let t=new m({picture:e.options.grid.typeicon,title:$(e),contextualMenu:function(e){let t=e.getTreeDocument().options.graphType;if(e.options.grid.id&&"create"!=t){let t=e.options.grid.taskDetailsList;return t.push("open"),t}return["open","showTaskRemove"]}(e),onContextMenuBuildCallback:Se,icon:"",tileWidth:"250px"}),o=Z(e);o&&(t.subtitle=o),t.description=Q(e),t.setOption("taskSequenceInAnOrder",e.options.grid.taskSequenceInAnOrder),t.setOption("taskModel",e),function(e){let t=e.getOption("taskModel");t.getTreeDocument()._isTaskAdded?t._isNewlyAdded?(ae(e,t),t._isNewlyAdded=!1):(t._isHighlighted=!1,se(e)):t._isHighlighted?ie(e):(se(e),t._isHighlighted=!1)}(t),t.addEventListener("click",function(e){re(e,t)});let n=!1;return t.addEventListener("touchstart",function(e){if(e.stopPropagation(),!n)return n=!0,setTimeout(function(){n=!1,re(e,t)},300),!1;setTimeout(function(){ce(t)},300)}),t.addEventListener("dblclick",function(e){ce(t)}),e.tileView=t,t},fe=function(e){document.querySelectorAll(".routemgmt-thumnailview.wux-ui-state-highlighted").forEach(function(e){e.classList.remove("wux-ui-state-highlighted")});let t=e.getTreeDocument();t&&t.getAllDescendants().forEach((e,t)=>{e._isHighlighted&&(e._isHighlighted=!1),e.tileView&&e.tileView.unhighlight()})},he=function(e,t,o){let n=!1;"edit"!=t||e.options.grid.id||(n=!0),("create"==t||"showTaskRemove"===o&&"edit"==t)&&(n=!0);let i=Ze(e);if(n&&i)return!0},we=function(t,o){let n=o.getTreeDocument(),i=n.options.graphType;n.options._isTaskPanelOpened?widget.notify.handler().addNotif({level:"error",subtitle:e.taskErrorOnDelete,sticky:!1}):(De(),t.taskPanelOpened&&widget.routeMgmtMediator.publish("route-task-close-click"),o.options.grid.id&&"edit"==i?u.deleteTask(o):widget.routeMgmtMediator.publish("delete-task-success",o))},ve=function(t,o){o.getTreeDocument().options._isTaskPanelOpened?widget.notify.handler().addNotif({level:"error",subtitle:e.taskErrorOnChangeAssignee,sticky:!1}):d.changeAssignee(o)},Se=function(t){let o=this,n=o.getOption("taskModel"),i=n.getTreeDocument().options.graphType,s=!1;"create"!=i&&(s=tt(O.getTaskTreeDocument().getChildren()));let a={};a.model=n,a.routePropertiesInfo=n.getTreeDocument().options.routeInfoJSON;var r=[];if(r.push({name:e.Open,title:e.Open,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open"},data:null,action:{callback:function(){!function(e){ce(e)}(o)}}}),"view"==i&&null!=n.options.grid.taskSubRoutes&&n.options.grid.taskSubRoutes.length>0&&r.push({name:e.approvalProcess,title:e.approvalProcess,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-route"},data:null,action:{callback:function(){I.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Approval Process"});var e={route:[]},t=n.options.grid.taskSubRoutes;e.taskTitleForSubRoute=n.options.grid.title,e.taskIdForSubRoute=n.options.grid.id;for(let o=0;o<t.length;o++)e.route.push({dataelements:{id:t[o].routeId,name:t[o].routeName,approvalTaskId:t[o].approvalTaskId}});Re(e)}}}),t.forEach((t,a)=>{"isRouteOwner"===t&&"Assigned"==n.options.grid.current&&"In Process"==n.routePropertiesInfo.model.state&&"view"==i&&"Stopped"!=n.routePropertiesInfo.model.Activity_State&&"Maintain Exact Task List"!=n.options.grid.taskEditSetting&&s&&("Extend Task List"!=n.options.grid.taskEditSetting||"Extend Task List"==n.options.grid.taskEditSetting&&"No"==n.options.grid.templateTask&&"No"==n.options.grid.isInitialTask)&&r.push({name:"MarkasComplete",title:e.markasCompleteTitle,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-status-change"},data:null,action:{callback:function(){I.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Mark as Complete"}),n.getTreeDocument().options._isTaskPanelOpened?widget.notify.handler().addNotif({level:"error",subtitle:e.taskErrorOnMarkAsComplete,sticky:!1}):function(t){var o={};o.id=t.routePropertiesInfo.id;var n={};n.id=t.options.grid.id,n.needsOwnerReview=t.options.grid.needsOwnerReview,n.currentState=t.options.grid.current;let i=new b;i.inject(document.body);let s=e.AutoCompleteTitle+t.options.grid.title;new C({modalFlag:!0,width:400,height:150,title:s,content:e.AutoCompleteContent,immersiveFrame:i,resizableFlag:!0,buttons:{Ok:new D({onClick:function(i){y.completeTask(n).then(e=>{M.refreshRouteData(o),widget.routeMgmtMediator.publish("task-action-on-save",t)},t=>{t.error?widget.notify.handler().addNotif({level:"error",title:e.taskCompletedError,message:t.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:e.taskCompletedError,sticky:!1})}),i.dsModel.dialog.close()}}),Cancel:new D({label:e.cancel,onClick:function(e){e.dsModel.dialog.close()}})}})}(n)}}}),"showTaskRemove"===t&&he(n,i,t)?r.push({type:"PushItem",title:e.Delete,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash"},action:{callback:function(e){I.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Delete"}),we(o,n)}}}):"canChangeAssignee"===t&&function(e,t,o){let n=!1;"view"==t&&(n=!0),e.routePropertiesInfo&&"Route Template"==e.routePropertiesInfo.model.Type&&"Inactive"!=e.routePropertiesInfo.model.actualState&&(n=!1);let i=Qe(e);return n=!(!n||!i)}(n,i)&&r.push({type:"PushItem",title:"TRUE"==n.options.grid.routeOwnerTask?e.selectAssignee:e.changeAssignee,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-change"},action:{callback:function(e){"TRUE"==n.options.grid.routeOwnerTask?I.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Select Assignee"}):I.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Change Assignee"}),ve(0,n)}}})}),"true"==a.model.options.grid.taskAcceptLink&&"Assigned"==a.model.options.grid.current&&"view"==i&&r.push({type:"PushItem",title:e.accepTask,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-ok"},action:{callback:function(t){I.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Accept Task"}),function(t,o,n){o.getTreeDocument().options._isTaskPanelOpened?widget.notify.handler().addNotif({level:"error",message:e.taskErrorOnAcceptTask,sticky:!1}):v.taskAccept({model:n.model.options.grid},n.routePropertiesInfo,"callFromMenu")}(0,n,a)}}}),"view"==i&&"Assigned"==a.model.options.grid.current&&a.model.options.grid.taskDetails&&v.canPerformTaskAction(a.model.options.grid.taskDetails)){w.getLoginUser()==a.model.options.grid.taskAssigneeUsername&&r.push({name:e.subRouteCommand,title:e.subRouteCommand,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-plus"},data:null,action:{callback:function(){I.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Create Subroute"});var e={inboxTaskId:a.model.options.grid.physicalid,parentRouteId:a.routePropertiesInfo.id,inboxTaskTitle:a.model.options.grid.title,parentRouteTaskDueDate:a.model.options.grid.taskDueDate};widget.setValue("isDialogOpened",!0),T.InitiateRouteDialog(e)}}})}return r},Re=function(e){k.getApprovalCommandMenu(e,"openSummaryPage").then(e=>{e.action.callback()},e=>{})},ye=function(e,t){let o;return"create"==e?o="route-task-"+t+"-click":"view"==e?o="route-task-"+t+"-click-view-mode":"edit"==e&&(o="route-task-"+t+"-click-edit-mode"),o},Me=function(e,t){let o=t.getTreeDocument().options.graphType,n=ye(o,"close");widget.routeMgmtMediator.subscribeOnce(n,function(e){W=!1,t._isTaskPanelOpened=!1,t.getTreeDocument().options._isTaskPanelOpened=!1,widget.setValue("taskIdTobePersisted",void 0)})},Te=function(e){let t=r.getTaskTreeDocument().getAllDescendants();for(let o=0;o<t.length;o++){let n=t[o];if(n.options.grid&&n.options.grid.id&&n.options.grid.id==e)return n}},be=function(e,t){let o=t.getTreeDocument().options.graphType,n=function(e){let t;return"create"==e?t="task-create-on-save":"edit"==e&&(t="task-edit-on-save"),t}(o),i=Ce(t);widget.routeMgmtMediator.subscribeOnce(n,function(n){if(n.orderInfo&&n.orderInfo.orderUpdated){let e=i.reOrderTreeNodeModels(t,n.orderInfo);Ge(e),widget.routeMgmtMediator.publish("redraw-graph-"+o,{taskTreeDocument:e})}"create"==o&&widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons"),"edit"==o&&t.options.grid.validTaskData&&(t.getTreeDocument().options.isTaskUpdated=!0),function(e,t){let o=Z(t);o&&(e.subtitle=o);let n=$(t);e.title=n,e.description=Q(t)}(e,t)})},Ce=function(e){let t,o=e.getTreeDocument().options.graphType;return"create"==o?t=l:"view"!=o&&"edit"!=o||(t=r),t},De=function(){widget.routeMgmtMediator.subscribeOnce("delete-task-success",function(e){let t;e.getParent()&&(t=e.getParent().options.grid.graphNode);let o=Ce(e),n=o.deleteTreeNodeModel(e),i=o.getTaskTreeDocument(),s=i.options.graphType;if("edit"==s&&(R.updateModel(i.options.routeInfoJSON),R.getModel().RouteId=i.options.routeInfoJSON.id),2==i.getChildren().length){let e=".create-task-graph-container",t={};"edit"==s?(t.graphMode="EditMode",e=".route-graph-task-container",0==c.getTasksDatasForDelete(o).length&&(widget.routeMgmtMediator.publish("disable-edit-icon-in-tasks-tab"),ke())):"create"==s&&(t.graphMode="createMode"),p.showEmptyTasksPlaceholder(document.querySelector(e),t.graphMode)}else i.options._isSplitTaskPresent?widget.routeMgmtMediator.publish("redraw-graph-"+s,{taskTreeDocument:i}):n.length>0&&Oe(e,i,n,t);"create"==s&&(widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons"),e.options.grid.contentToReviewFieldInfo&&e.options.grid.contentToReviewFieldInfo.length>0&&v.updateInitiateRouteContentViewOnNodeRemoval(e.options.grid.contentToReviewFieldInfo,e.options.grid.title))})},ke=function(){let e=document.querySelector("#routeGraphTaskContainer");e.querySelector("#footer_view")&&e.querySelector("#footer_view").destroy(),e.querySelector("#footer_edit")&&e.querySelector("#footer_edit").destroy()},Ee=function(e){_="create"===e.options.graphType?F:V},Oe=function(e,t,o,n){Ee(t);let i,s=parseInt(e.options.grid.taskOrder),a=0;_.selection.first;o.forEach((e,t)=>{a=e.actualLeft<a||!a?e.actualLeft:a,i=e.actualTop<i||!i?e.actualTop:i,_.removeNode(e)});t.getChildren()[s-1].options.grid.graphNode;n&&(a=n.actualLeft,i=n.actualTop),xe(_,t,s,{currX:a,currY:i},{operation:"delete"}),He(t)},Ne=function(){return UWA.Utils.Client.Features.touchEvents},Ae=function(e){return{"01":"bottom",10:"right","0-1":"top","-10":"left"}[e]},Ie=function(e,t,o,n,i){let s,a,r=t.getChildren();if(r.length>=2){let s=t.getAttributeValue("graphNode"),a=o;s?(_.removeNode(s),a=s.actualLeft,n=!1):o+=H[i]+K,s=Fe(a,B.y_initialPos,{title:t.options.label,model:t}),Ue(e,s),t.setAttribute("graphNode",s)}s=r.length%2==0?B.y_pos_even-(q.height+X)*(parseInt(r.length/2)-1):B.y_initialPos_node-(q.height+X)*parseInt(r.length/2),a=q.height+X,Be(r,o,s,a,!0),o+=q.width+K,n&&(o+=4);let l={};return l.xPos=o,l.moveNextOrderTasks=n,l},Ue=function(e,t){e.addNode?e.addNode(t):e.parent&&e.parent.addNode&&e.parent.addNode(t)},xe=function(e,t,o,n,i){Ge(t);let s,a=n.currX,r=n.currY,l=B,d=t.options.graphType,u=t.getChildren().length;for(let n=o;n<u;n++){let u=t.getChildren()[n];if(i.isTaskAddedToSameOrder&&n==o){let t=Ie(e,u,a,!0,d);if(a=t.xPos,t.moveNextOrderTasks)continue;break}let c=u.getChildren();if(n==o&&"create"==i.operation){je(c[0],0,1,a,l.y_initialPos_node,l.y_pos_diff_odd,!0),a+=q.width+K;continue}c&&c.length<2&&"delete"==i.operation&&u.getAttributeValue("graphNode")&&u.setAttribute("graphNode",void 0);let m=u.getAttributeValue("graphNode");if(m)try{_.removeNode(m)}catch(e){console.log(e)}if(c&&c.length>=2)m=Fe(a,B.y_initialPos,{title:u.options.label,model:u}),a+=H[d]+K,Ue(e,m),u.setAttribute("graphNode",m),r=c.length%2==0?l.y_pos_even-(q.height+X)*(parseInt(c.length/2)-1):l.y_initialPos_node-(q.height+X)*parseInt(c.length/2),s=q.height+X,Be(c,a,r,s,!0,!0),a+=q.width+K;else if(c&&1==c.length)je(c[0],0,1,a,l.y_initialPos_node,l.y_pos_diff_odd,!0,!0),a+=q.width+K;else{let t=void 0;"Finish"==u.options.label&&(t=u.getPreviousNode(),u.getPreviousBrother().getChildren()&&u.getPreviousBrother().getChildren().length>1&&(a+=z.width_diff)),m=Fe(a,B.y_initialPos,{title:u.options.label,model:t}),a+=H.width+K,Ue(e,m),u.setAttribute("graphNode",m)}}},Fe=function(o,n,i){let s,r,l=30,d=25,u=0,c=0,m=i.model&&i.model.getTreeDocument?i.model.getTreeDocument().options.graphType:"view";if((s=new t.Node).views.main=new U,"Start"==i.title||"Finish"==i.title?(s.data=new ee(s,i),l=30):"Any"==i.title||"All"==i.title?("create"==m||"edit"==m)&&i.model&&0==i.model.getParents().length?(s.data={title:i.title,content:function(t,o){let n="Any"==t.title?0:1,i=new a({elementsList:[e.taskAnyOption,e.taskAllOption],label:e[t.title],placeholder:e[t.title],enableSearchFlag:!1,selectedIndex:n});return i.elements.mainElement.style.minWidth="35px",/chrome|chromium|crio/i.test(navigator.userAgent)&&i.addEventListener("click",e=>{e.target.getElementsByClassName("wux-controls-combobox-icon")[0].click()}),i.addEventListener("change",function(e){let t=0==e.dsModel.selectedIndex?"Any":"All";f.updateTaskAction(o,t),o.getTreeDocument().options.isTaskUpdated=!0}),i}(i,i.model),model:i.model},l=62):(s.data=new ne(s,i),l=55):i.title||(s.data={content:ge(i),model:i},d="Assigned"==s.data.model.options.grid.current&&"view"==L?105:80,l=225,u=1,c=3.3),s.multiset("left",o,"top",n,"width",l,"height",d),s.views.overview=!0,i.options&&(r=i.options.grid.taskSequenceInAnOrder),i.model&&i.model.options.grid&&(r=i.model.options.grid.taskSequenceInAnOrder),"Finish"==i.title){let e=i.model.getAllDescendants(),t=We(e);r=t.isEditableTaskPresent&&t.taskCount>1?-2:2}if("Start"!=i.title)if(s.data.in1=Ve(t.BorderCstr.LEFT,u),s.appendConnector(s.data.in1),i.title)s.data.in1.showPlusIcon=-2==r,"Finish"==i.title?s.data.in1.showArrow=!0:s.data.in1.showArrow=-2!=r,"Any"!=i.title&&"All"!=i.title||(s.data.in1.showArrow=!1);else{s.data.in2=Ve(t.BorderCstr.TOP,c),s.appendConnector(s.data.in2);const e=[1,0,3,4];s.data.in2.showPlusIcon=e.includes(r),s.data.in1.showPlusIcon=0==r,s.data.in1.showArrow=0!=r}if("Finish"!=i.title&&(s.data.out2=Ve(t.BorderCstr.RIGHT,u),s.appendConnector(s.data.out2),!i.title)){s.data.out1=Ve(t.BorderCstr.BOTTOM,c),s.appendConnector(s.data.out1);const e=[-1,0,3,4];s.data.out1.showPlusIcon=e.includes(r),s.data.out2.showPlusIcon=0==r||3==r}return s},Ve=function(e,o){var n,i;return i=10+30*o,(n=new t.Connector).views.main=new x(e,0,!1),n.multiset(["cstr","attach"],e,["cstr","offset"],i),n},_e=function(e,n,i){var s;(s=new t.Edge).views.main=new o.SVGEdgeView,i&&s.set("geometry",new t.StairGeometry);return _.addEdge(e,n,s,{autoPairSelection:!0}),s},Pe=function(e){let t=!0,o=0;return e.forEach((e,n)=>{if(e.options&&"Route Task"==e.options.grid.nodeType&&(o++,t&&(e.options.grid.taskDetailsList&&-1==e.options.grid.taskDetailsList.indexOf("showEditTask")&&(t=!1),e.options.grid.validTaskData||(t=!0),e.options.grid.id||(t=!0),"Inbox Task"==e.options.grid.type&&(t=!1),e.getTreeDocument()&&e.getTreeDocument().options.routeInfoJSON))){let o=e.getTreeDocument().options.routeInfoJSON;"Route Template"===(o.model?o.model.Type:o.Type)||(o.templateId&&""!=o.templateId&&(t=$e(e)&&"Route Node"===e.options.grid.type),("Yes"==e.options.grid.templateTask||"No"==e.options.grid.templateTask&&e.options.grid.taskEditSetting&&"Maintain Exact Task List"==e.options.grid.taskEditSetting)&&(t=$e(e)&&"Route Node"===e.options.grid.type))}}),{hasEditAccess:t,taskCount:o}},We=function(e,t){let o=!1,n=0;return e.forEach((e,t)=>{if(n++,e.options&&"Route Task"==e.options.grid.nodeType){if(o)return;if(e.options.grid.taskDetailsList&&e.options.grid.taskDetailsList.indexOf("showEditTask")>-1&&(o=!0),e.options.grid.validTaskData||(o=!0),e.options.grid.id||(o=!0),e.getTreeDocument()&&e.getTreeDocument().options.routeInfoJSON){let t=e.getTreeDocument().options.routeInfoJSON;"Route Template"===(t.model?t.model.Type:t.Type)||(t.templateId&&""!=t.templateId&&(o=$e(e)),("Yes"==e.options.grid.templateTask||"No"==e.options.grid.templateTask&&e.options.grid.taskEditSetting&&"Maintain Exact Task List"==e.options.grid.taskEditSetting)&&(o=$e(e)))}}}),{isEditableTaskPresent:o,taskCount:n}},Le=function(e,t){let o=!0,n=e.getTreeDocument().options.routeInfoJSON.taskEditSetting;return e.getTreeDocument().options.routeInfoJSON.model&&(n=e.getTreeDocument().options.routeInfoJSON.model.taskEditSetting),"Extend Task List"===n&&t.forEach((e,t)=>{e.options&&"Route Task"==e.options.grid.nodeType&&o&&("Yes"==e.options.grid.templateTask||"No"==e.options.grid.templateTask&&"Yes"==e.options.grid.isInitialTask)&&(o=!1)}),o},Ge=function(e){let t,o,n;e.getChildren().forEach(e=>{let i,s=e.getAllDescendants(),a=Pe(s),r=0,l=a.taskCount,d=We(s).isEditableTaskPresent,u=function(e){let t=!0,o=e.getAllDescendants();return t=Le(e,o)}(e),c=function(e){let t=!0;if(e.getNextBrother()){let o=e.getNextBrother().getAllDescendants();t=Le(e,o)}return t}(e);if(0!=s.length&&(n=s[0].options.grid.parallelNodeProcessionRule),s.forEach((e,i)=>{e.options&&"Route Task"==e.options.grid.nodeType?(r++,e.options.grid.parallelNodeProcessionRule!=n&&(e.options.grid.parallelNodeProcessionRule=n),d?(1==r&&r==l?"Inbox Task"==e.options.grid.type?(o=3,u||c||(o=4)):(o=0,u||(o=3),u||c||(o=4)):o=1==r&&r<l?1:r==l?-1:2,void 0!==t&&(0!=t&&3!=t||0!=o||(o=3))):o=2,e.options.grid.taskSequenceInAnOrder=o,t=o):e.options&&"UG Action Node"==e.options.grid.nodeType?e.options.grid.taskSequenceInAnOrder=2:e.options&&"Maintain Exact Task List"==e.options.grid.taskEditSetting&&(e.options.grid.taskSequenceInAnOrder=2)}),e.getPreviousBrother()){let t=e.getPreviousBrother().getAllDescendants();i=Pe(t)}a.hasEditAccess?i&&1==i.taskCount?e.options.grid.taskSequenceInAnOrder=2:i&&a.hasEditAccess&&i.taskCount>1&&u?e.options.grid.taskSequenceInAnOrder=-2:i&&a.hasEditAccess&&a.taskCount>1&&u?e.options.grid.taskSequenceInAnOrder=-2:a.hasEditAccess&&i&&0==i.taskCount&&u?e.options.grid.taskSequenceInAnOrder=-2:e.options.grid.taskSequenceInAnOrder=2:e.options.grid.taskSequenceInAnOrder=2})},je=function(e,t,o,n,i,s,a,r){if(a){let t=e.getAttributeValue("graphNode");t&&_.removeNode(t)}let l=Fe(n,i+s*t,e);e.setAttribute("graphNode",l),_.insertNodeBefore(l,null)},Be=function(e,t,o,n,i,s){let a=e.length;e.forEach((e,r)=>{je(e,r,a,t,o,n,i,s)})},qe=function(e){Ee(e),Ge(e);let t,o=B,n=o.x_initialPos,i=o.y_initialPos,s=e.options.graphType,a={xPos:n=Y,yPos:i,y_pos_diff:t};e.getChildren().forEach(e=>{let n=a.xPos;if(e._isSplitTaskPresent){let r=e.getChildren();if(r.length>1){let t=Fe(n,o.y_initialPos,{title:e.options.label,model:e});n+=H[s]+K,_.insertNodeBefore(t,null),e.setAttribute("graphNode",t)}let l=e.getAllDescendants().length-r.length;i=l%2==0?o.y_pos_even-(q.height+X)*(parseInt(l/2)-1):o.y_initialPos_node-(q.height+X)*parseInt(l/2);let d=0;e.getChildren().forEach(e=>{let o=e.getChildren(),s=o.length;if(s>1){d=i+[q.height*parseInt(s)+X*parseInt(s-1)]/2,d-=s%2==0?J.height/2-5:J.height/2-2;let t=Fe(n,d,{title:e.options.label,model:e});_.insertNodeBefore(t,null),e.setAttribute("graphNode",t)}t=q.height+X,Be(o,n+80,i,t),i+=(q.height+X)*o.length}),n+=q.width+K+80,a={xPos:n,yPos:i,y_pos_diff:t}}else a=function(e,t,o,n){L=o;let i=B,s=t.xPos,a=t.yPos,r=t.y_pos_diff,l=e.getChildren();if(l&&l.length>1){(function(e){let t=!1;return 2!=e.options.grid.taskSequenceInAnOrder&&"view"!=e.getTreeDocument().options.graphType||(t=!0),t&&e.getPreviousBrother().getChildren()&&1==e.getPreviousBrother().getChildren().length||t&&"Start"==e.getPreviousBrother().options.label||(t=!1),t})(e)&&(s-=25);let t=Fe(s,i.y_initialPos,{title:e.options.label,model:e});s+=H[o]+K,_.insertNodeBefore(t,null),e.setAttribute("graphNode",t),a=l.length%2==0?i.y_pos_even-(q.height+X)*(parseInt(l.length/2)-1):i.y_initialPos_node-(q.height+X)*parseInt(l.length/2),r=q.height+X,Be(l,s,a,r),s+=q.width+K}else if(l){let e=Fe(s,a=i.y_initialPos_node,l[0]);l[0].setAttribute("graphNode",e),_.insertNodeBefore(e,null),s+=q.width+K}else{let t=void 0;"Finish"==e.options.label&&(t=e.getPreviousNode(),e.getPreviousBrother().getChildren()&&e.getPreviousBrother().getChildren().length>1&&(s+=z.width_diff));let o=Fe(s,i.y_initialPos,{title:e.options.label,model:t});e.setAttribute("graphNode",o),_.insertNodeBefore(o,null),s+=z.width+K}return t={xPos:s,yPos:a,y_pos_diff:r}}(e,a,s)}),He(e)},He=function(e,t,o){e.getChildren().forEach(e=>{let t=e.getAttributeValue("graphNode");if(!t&&!(t=e.getChildren()[0].getAttributeValue("graphNode"))&&e.getChildren()[0].hasChildren()){let o=e.getChildren()[0];t=o.getChildren()[0].getAttributeValue("graphNode")}if(t){(function(e){let t=[];if(e.getPreviousBrother()){let o=e.getPreviousBrother().getAllDescendants();0==o.length&&t.push(e.getPreviousBrother()),o.forEach(e=>{e.tileView&&t.push(e)})}return t})(e).forEach(e=>{let o=e.getAttributeValue("graphNode");_e(o.data.out2,t.data.in1,!0)}),e.hasChildren()&&e.getChildren().forEach((e,o)=>{if(e.hasChildren()){let o=e.getAttributeValue("graphNode");o&&_e(o.data.out2,t.data.in1,!0),e.getChildren().forEach(e=>{let n=e.getAttributeValue("graphNode");_e(o?o.data.out2:t.data.out2,n.data.in1,!0)})}else{let o=e.getAttributeValue("graphNode");_e(t.data.out2,o.data.in1,!0)}})}})},Je=function(t,o){t&&("Review"==o.basePurpose?t.options.grid.taskAction="Comment":"Approval"==o.basePurpose&&(t.options.grid.taskAction="Approve"),Je(t.getNextNode(),o),function(t){let o={},n=document.querySelectorAll("#approvalStatusGettingId");for(let i=0;i<n.length;i++)"Approval"==t.basePurpose?o=e.tobeapproved:"Review"==t.basePurpose&&(o=e.tobecommented),0!=Object.keys(o).length&&(n[i].innerHTML=o)}(o))},ze=function(e,t){if(!e)return;let o;if(e.routePropertiesInfo&&(o=e.routePropertiesInfo.model?e.routePropertiesInfo.model.Type:e.routePropertiesInfo.Type),e.options.grid)if("Route Template"===o&&"TRUE"===e.options.grid.routeOwnerTask);else if(e.options.grid.assigneeId="",e.options.grid.assigneePID="",e.options.grid.assigneeTitle="",e.options.grid.assigneeType="",e.options.grid.taskAssignee="",e.options.grid.taskAssigneeUsername="",e.options.grid.validTaskData=!1,e.tileView){let t=Q(e);t.assignee=" ",e.tileView.description=t}ze(e.getNextNode(),t)},Xe=function(e,t){if(e){if(e.options.grid&&e.options.grid.contentToReviewFieldInfo){for(var o=[],n=0;n<e.options.grid.contentToReviewFieldInfo.length;n++)-1!=t.indexOf(e.options.grid.contentToReviewFieldInfo[n].id)&&o.push(e.options.grid.contentToReviewFieldInfo[n]);e.options.grid.contentToReviewFieldInfo=o}Xe(e.getNextNode(),t)}},Ke=function(){let e;widget.routeMgmtMediator.subscribe("route-task-open-click-view-mode",function(t){(e=r.getTaskTreeDocument()).options._isTaskPanelOpened=!0}),widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",function(t){(e=r.getTaskTreeDocument()).options._isTaskPanelOpened=!1});let t=widget.routeMgmtMediator.subscribe("route-task-on-change-assignee",function(e){let t=Te(e.id);t&&t.options&&(t.options.grid.assignee="",t.options.grid.assigneePID=e.newAssigneeId,t.options.grid.assigneeId=e.newAssigneeId,t.options.grid.taskAssignee=e.taskAssigneeName,t.options.grid.taskAssigneeUsername=e.taskAssigneeUserName,t.options.grid.taskAcceptLink=e.taskAcceptLink,t.options.grid.assigneeType=e.newAssigneeType,t.options.grid.assigneeTitle=e.taskAssigneeName,t.options.grid.routeOwnerTask=e.routeOwnerTask,t.options.grid.routeOwnerUGChoice=e.routeOwnerUGChoice,t.options.grid.routeOwnerUGName=e.routeOwnerUGName,t.options.grid.routeOwnerUGTitle=e.routeOwnerUGTitle,t.tileView&&(t.tileView.subtitle=Z(t),t.tileView.description=Q(t)))});return j.push(t),j},Ye=function(e,t){let o,n,s,a,r=new i.BoundingRect,l=e.nodes.first;for(;l;)(null==o||o>l.left)&&(o=l.left),(null==n||n<l.left+l.width)&&(n=l.left+l.width),(null==s||s>l.top)&&(s=l.top),(null==a||a<l.top+l.height)&&(a=l.top+l.height),l=l.next;r.xmin=o,r.xmax=n,r.ymin=s,r.ymax=a;let d=document.querySelector("#"+t);if(d){let e=d.querySelector(".egraph_views_domroot").offsetWidth,t=d.querySelector(".egraph_views_domroot").offsetHeight;_.views.main.setSize(e,t)}!function(e,t,o,n){let s=e.views.main.getSize();if(s[0]<=0&&s[1]<=0)return!1;let a=e.views.main.vpt,r={padding:25,minSize:50,horizontal:0,vertical:0,aliasing:0,defaultVpt:a};o&&(r.minScale=a[2],r.maxScale=a[2]),n&&(r.maxScale=1);let l=i.reframeViewpoint(e.views.main.getSize(),t,r);e.views.main.setViewpoint(l,!0)}(e,r,!1,!0)},$e=function(e){if(e.options){let t=e.options.grid.templateTask,o=e.options.grid.taskEditSetting,n=e.options.grid.taskDetailsList,i=(e.options.grid.type,e.options.grid.isInitialTask);if(("Yes"===t||"Yes"===i&&e.routePropertiesInfo&&null==e.routePropertiesInfo.model.templateTaskEditSetting)&&"Maintain Exact Task List"===o)return!1;if("No"===t&&"Maintain Exact Task List"===o)return!1;if(n&&-1==n.indexOf("showEditTask")&&"create"!=e.getTreeDocument().options.graphType)return!1}return!0},Ze=function(e){if(e.options){let t=e.options.grid.templateTask,o=e.options.grid.isInitialTask,n=e.options.grid.taskEditSetting;if("Yes"===t||"Yes"===o&&e.routePropertiesInfo&&null==e.routePropertiesInfo.model.templateTaskEditSetting)switch(n){case"Modify Task List":case"Extend Task List":case"Maintain Exact Task List":return!1;default:return!0}}return!0},Qe=function(e){if(e.options){let t=e.options.grid.templateTask,o=e.options.grid.isInitialTask,n=e.options.grid.taskEditSetting,i=e.options.grid.type,s=e.options.grid.routeOwnerTask;if("Yes"===t&&"TRUE"==s)return!0;if("Yes"===t&&"Route Node"==i)return"Modify/Delete Task List"==n||"Modify Task List"==n;if("Yes"===o&&"Route Node"==i&&e.routePropertiesInfo&&null==e.routePropertiesInfo.model.templateTaskEditSetting)return"Modify/Delete Task List"==n||"Modify Task List"==n}return!0},et=function(){return de},tt=function(e){let t=0,o=0;if(1==e.length)return!1;for(let n=1;n<e.length-1;n++){let i=e[n].getAllDescendants();if(i.length>0)for(let e=0;e<i.length;e++){t++,"Auto Complete"==i[e]._options.grid.approvalStatus&&o++}}return o!=t-1};return{init:(e,t,o,n,i)=>{"create"==n?F=o:V=o,x=t,U=e,W=!1},createGraphNodes:e=>(function(e){"create"==e.options.graphType&&(P=e),qe(e)})(e),drawGraphNode:(e,t,o)=>(function(e,t,o){let n="#templates";document.querySelector("#templates_create")&&(n="#templates_create");let i=document.querySelector(n+" > .mixnode").cloneNode(!0),s="task-"+t+"-view";i.classList.add(s);let a=new UWA.Element("div",{class:"wux-control-inline-container",styles:{"vertical-align":"bottom"}});"dropdown"==t&&(Ne()?(a.setStyle("width","75px"),a.setStyle("margin","-8px 0px 0 0px")):a.setStyle("width","62px")),"tile"==t&&a.setStyle("width","225px");e.inject(a);return"terminating node"===t&&(i.title=e.title),a.inject(i),i})(e,t),insertNewNode:(e,t,o)=>(function(e,t,o){Ee(o);let n=e.node,i=n.actualLeft,s=n.actualTop,a=Ae(String(e.anormx)+String(e.anormy)),r=parseInt(t.options.grid.taskOrder),l=_,d=(l.data&&l.data.refType,n.actualLeft,n.actualTop);switch(a){case"bottom":s+=100,d-=100;break;case"top":s-=100,d+=100}"right"==a||"left"==a?("right"==a&&(i+=q.width+K),xe(l,o,r,{currX:i,currY:s},{operation:"create",isTaskAddedToSameOrder:!1}),He(o)):(xe(l,o,r,{currX:i,currY:s},{operation:"create",isTaskAddedToSameOrder:!0}),He(o)),o._isTaskAdded=!1})(e,t,o),getConnectorPostion:()=>Ae(xyCords),isTaskPanelOpened:e=>(function(e){if(e&&e.getTreeDocument){let t=e.getTreeDocument();if(t&&t.options._isTaskPanelOpened)return!0}return!1})(e),registerEventsForCreateGraph:()=>(function(){let e=widget.routeMgmtMediator.subscribe("initiateRoute-on-RouteBasePurposeSelection",function(e){if(e.basePurpose&&P.getChildren().length>=3){let t=P.getChildren()[1].getChildren()[0];Je(t,e)}});return G.push(e),e=widget.routeMgmtMediator.subscribe("initiateRoute-on-ScopeSelection",function(e){if(P.getChildren().length>=3){let t=P.getChildren()[1].getChildren()[0];ze(t,e),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons")}P.options.routeInfoJSON.scopeId=e.scopeId,P.options.routeInfoJSON.ScopeMembers=e.ScopeMembers}),G.push(e),e=widget.routeMgmtMediator.subscribe("clearContentToReview-on-ContentRemoval",function(e){if(P.getChildren().length>=3){let t=P.getChildren()[1].getChildren()[0];Xe(t,e)}}),G.push(e),G})(),onDoubleClickOfTaskTile:e=>ce(e),registerEventsForViewMode:()=>Ke(),setZoomOptionsOnGraph:e=>(function(e){e.setZoomOpts({min:.5,max:1.5})})(e),changeTransformOfSvg:(e,t,o)=>(function(e,t,o){let n=!1;-1!=navigator.userAgent.indexOf("Firefox")&&(n=!0);if(o.data.title&&("Any"==o.data.title||o.data.title),e.startsWith("translate")){let i=e.indexOf(" matrix")-1,s=e.substring(i,e.length),a=e.substring(10,i).split(" "),r=parseInt(a[0]),l=parseInt(a[1]),d=r,u=l,c=r,m=l;return"top"==t?(r-=10,l-=5,d-=7,u-=14):"bottom"==t?(r+=10,l-=5,d-=8,u+=6):"left"==t?("terminating node"==o.data.type?(r-=17,c-=10):c-=13,l+=10,d=(r-=5)-18,m-=1):"right"==t&&(r+=5,l-=10,d+=8,u+=2),n&&(m+=8,u+=8),{rect:"translate("+r+" "+l+s,text:"translate("+d+" "+u+") matrix(1 0 0 1 0 0)",arrow:"translate("+c+" "+m+") matrix(1 0 0 1 0 0)"}}})(e,t,o),fitToWindow:(e,t)=>Ye(e,t),createToolbarContainer:t=>(function(t){let o=new UWA.Element("div",{class:"main-rt-task-toolbar rt-task-toolbar",id:"task-graph-toolbar"}),n=widget.getValue("TasksTab-ShowView");n&&"GridView"==n&&(o.removeClassName("showView"),o.addClassName("hideView"));let i=new UWA.Element("div",{class:"wux-controls-button wux-ui-style-icon icon fitToWindow right",title:e.fitToWindow}).inject(o);new UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-arrow-double-combo"}).inject(i),o.inject(t)})(t),isTouchDevice:()=>Ne(),onDeleteContextualMenuClick:(e,t)=>we(e,t),onChangeAssigneeContextualMenuClick:(e,t)=>ve(0,t),getFinishNodeHelpTooltip:e=>te(e),showPlusIconBasedOnRTE:e=>$e(e),updateTaskEditSettings:(e,t)=>(function(e,t){return e.forEach(function(e){e.taskEditSetting=t}),e})(e,t),fitToWindowDefaultLoad:(e,t)=>(function(e,t){let o,n,s,a,r=new i.BoundingRect,l=e.nodes.first;for(;l;)(null==o||o>l.left)&&(o=l.left),(null==n||n<l.left+l.width)&&(n=l.left+l.width),(null==s||s>l.top)&&(s=l.top),(null==a||a<l.top+l.height)&&(a=l.top+l.height),l=l.next;r.xmin=o,r.xmax=n,r.ymin=s,r.ymax=a;let d=document.querySelector("#"+t);if(d){let e=d.querySelector(".egraph_views_domroot").offsetWidth,t=d.querySelector(".egraph_views_domroot").offsetHeight;0!=e&&0!=t||(e=widget.body.offsetWidth,t=widget.body.offsetHeight-195),_.views.main.setSize(e,t)}let u=e.views.main.vpt,c={padding:75,minSize:50,horizontal:-1,vertical:0,aliasing:0,defaultVpt:u};c.minScale=u[2],c.maxScale=u[2];let m=i.reframeViewpoint(e.views.main.getSize(),r,c);return e.views.main.setViewpoint(m,!0),!0})(e,t),updateRouteTaskModel:e=>(function(e){let t=e.tasks.getTreeDocument().options.graphType,o=Ce(e.tasks);if(e.orderInfo&&e.orderInfo.orderUpdated){let n=o.reOrderTreeNodeModels(e.tasks,e.orderInfo);Ge(n),widget.routeMgmtMediator.publish("redraw-graph-"+t,{taskTreeDocument:n})}else widget.routeMgmtMediator.publish("update-task-model");if("edit"==t&&e.tasks.options.grid.validTaskData&&(e.tasks.getTreeDocument().options.isTaskUpdated=!0),e&&e.tasks._id){let t=R.getModel();if(null!=t){let o=t.getChildren();for(var n=0;n<o.length;n++)if(o[n].options.graphNodeId==e.tasks._id){o[n].select(!0);break}}}})(e),canShowDeleteTask:(e,t,o)=>he(e,t,o),postGridDeleteAction:e=>(function(e){let t;e.getParent()&&(t=e.getParent().options.grid.graphNode);let o=Ce(e),n=o.deleteTreeNodeModel(e),i=o.getTaskTreeDocument(),s=i.options.graphType;if(2==i.getChildren().length){let e=".create-task-graph-container",t={};"edit"==s&&(t.graphMode="EditMode",e=".route-graph-task-container",0==c.getTasksDatasForDelete(o).length&&(widget.routeMgmtMediator.publish("disable-edit-icon-in-tasks-tab"),ke())),p.showEmptyTasksPlaceholder(document.querySelector(e),t.graphMode)}else i.options._isSplitTaskPresent?widget.routeMgmtMediator.publish("redraw-graph-"+s,{taskTreeDocument:i}):n.length>0&&Oe(e,i,n,t)})(e),openRouteTaskApprovalProcess:e=>Re(e),getPreviouslyOpenedTaskId:()=>et(),setPreviouslyOpenedTaskId:e=>(function(e){""!=e&&(de=e)})(e),setUpdatedDueDate:e=>me(e),getUpdatedDueDate:()=>pe()}}),define("DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphView",["DS/WAFData/WAFData","DS/ENORouteMgmt/Utilities/ParseJSONUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","DS/egraph/core","DS/egraph/views","DS/egraph/iact","DS/egraph/utils","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Actions/TaskActions","DS/ENORouteMgmt/Views/ToggleTaskViews","DS/ENORouteMgmt/Utilities/DataFormatter","DS/ENORouteMgmt/Utilities/RouteRefreshUtils","DS/Controls/Button","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/ENORouteMgmt/Views/Graph/eGraphToolbar","DS/ENORouteMgmt/Model/RouteTaskModel","DS/Controls/Loader","DS/ENORouteMgmt/Views/Grid/RouteTasksDataGridView","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","css!DS/UIKIT/UIKIT.css","css!DS/egraph/views.css","css!DS/egraph/views_default.css","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g,f,h,w,v,S,R,y,M,T){"use strict";let b,C,D,k,E,O,N,A=[],I=0,U=function(e,t){let o="showView",n=widget.getValue("TasksTab-ShowView");("GridView"==p.getViewType()||n&&"GridView"===n)&&(o="hideView");let i=new UWA.Element("div",{id:"templates",display:"none"}).inject(e);new UWA.Element("div",{class:"mixnode"}).inject(i);var s=new UWA.Element("div",{class:"canvas "+o,id:"graph_canvas_"+t});s.inject(e),s.addEventListener(void 0!==document.body.onwheel?"wheel":"mousewheel",function(e){var t=document.querySelector(".wux-controls-combobox-popup");t&&(t.style.display="none");var o=document.querySelector(".wux-menu-container");o&&(o.style.display="none")},!0),new UWA.Element("div",{class:"taskEdit_footer ShowView",id:"footer_"+t}).inject(e),l.createToolbarContainer(e),E=e.id,s.addEventListener("click",function(){document.querySelector(".wux-menu")&&(document.querySelector(".wux-menu").style.display="none")})},x=function(e,t,r,c){function m(){i.HTMLNodeView.call(this)}a.inherit(m,i.HTMLNodeView),m.prototype.buildNodeElement=function(e){if(e.data.content){if("Any"==e.data.title||"All"==e.data.title){let t=e.data.content;return l.drawGraphNode(t,"dropdown")}if("terminating node"==e.data.type){let t=e.data.content;return l.drawGraphNode(t,"terminating-node")}{let t=e.data.content,o={width:"300px"};return l.drawGraphNode(t,"tile",o)}}var t=document.querySelector("#templates > .mixnode").cloneNode(!0);return t.appendChild(document.createTextNode(o[e.data.title])),t.className="mixnode task-action-node-view",t};var g=new n.BoundsGeometry;function f(){i.HTMLNodeView.call(this)}function w(e,t,o){this.side=e,this.nodeIndex=t,this.events=o,i.SVGConnView.call(this)}function v(e){return{"01":"bottom",10:"right","0-1":"top","-10":"left"}[e]}g.paddingTop=80,a.inherit(f,i.HTMLNodeView),f.prototype.buildNodeElement=function(e){var t=document.querySelector(e.collapsed?"#templates > .collapsed-group":"#templates > .expanded-group").cloneNode(!0);return t.appendChild(document.createTextNode("Any one of the task can be completed to move the next step")),t},a.inherit(w,i.SVGConnView),w.prototype.buildConnElement=function(e){i.SVGConnView.prototype.buildConnElement.call(this,e);let t=document.createElementNS(N,"rect");return t.setAttribute("width",21),t.setAttribute("height",21),t.setAttribute("class","rectConnnector"),t},w.prototype.onmodifyDisplay=function(t,n,s){let a="view"!=b,r=!1;a=(!t.node.data.title||"Any"==t.node.data.title||"All"==t.node.data.title)&&"view"!=b&&arguments[0].showPlusIcon;let u=v(String(t.anormx)+String(t.anormy));(arguments[0].showArrow||"left"==u&&"view"==b)&&("Any"==t.node.data.title||"All"==t.node.data.title||(r=!0)),i.SVGConnView.prototype.onmodifyDisplay.apply(this,arguments);var c=this.display.elt;let m=c.getAttribute("transform"),p=l.changeTransformOfSvg(m,u,t.node);if(!c.nextElementSibling){if(p&&(c.setAttribute("transform",p.rect),m=p.text),a){let n=document.createElementNS(N,"text");n.setAttribute("class","plusConnector"),n.setAttribute("transform",m),n.setAttribute("alignment-baseline","middle"),n.textContent="+";let i=document.createElementNS(N,"title");function g(n){if(n.stopImmediatePropagation(),l.isTaskPanelOpened(t.node.data.model))widget.notify.handler().addNotif({level:"error",subtitle:o.taskErrorOnAdd,sticky:!1});else{let o=v(String(t.anormx)+String(t.anormy)),n=parseInt(t.node.data.model.options.grid.taskOrder),i=d.getTaskNodeModel(o,n),s=i.getTreeDocument();s.options._isSplitTaskPresent?(G(),U(D,s.options.graphType),x(e,s.options.graphType,!1,s)):l.insertNewNode(t,i,s),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons")}}i.textContent=o.addTask,n.appendChild(i),this.prevEvent,n.addEventListener("click",function(e){g(e)}),n.addEventListener("touchstart",function(e){e.preventDefault(),g(e)}),this.display.elt.parentNode.appendChild(n)}else c.setAttribute("display","none");if(r){let e=document.createElementNS(N,"text");e.setAttribute("class","arrowConnector"),e.setAttribute("transform",p?p.arrow:m),e.setAttribute("alignment-baseline","central"),e.textContent=">",new UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-chevron-right"}).inject(e),this.display.elt.parentNode.appendChild(e)}}};var y,M,N="http://www.w3.org/2000/svg";y=new n.EGraph,O=y;new S.Toolbar({buttons:[{id:"fitToWindow",query:"#"+E+" .main-rt-task-toolbar .fitToWindow",mode:"push",cb:function(){l.fitToWindow(y,E)}}]});if(y.addView("main",new i.HTMLGraphView(document.querySelector("#graph_canvas_"+t))),(M=new s.StateMachine(y,null,null,y.views.main)).rootState.newDragForElement=(M.rootState.newDragForElement,function(e,t,o){if(t.type===n.Type.GROUP&&"expand-btn"===o)return new s.SubEltClickDrag(t,o,function(e){e.collapsed||e.geometry.recenterGroup(e),e.set("collapsed",!e.collapsed)}.bind(void 0,t))}),y.addListener("update",function(e){if(y.selection.last&&y.selection.last.data){let e=y.selection.last.data.content;e.elements.container.click()}}),l.setZoomOptionsOnGraph(y),function(){y.updateLock();try{c?(j(C),A.concat(l.registerEventsForViewMode()),l.init(m,w,y,b,C),c.options.graphType=b,l.createGraphNodes(c),R.updateModel(c.options.routeInfoJSON),R.getModel().RouteId=c.options.routeInfoJSON.id):r?("GridView"!=p.getViewType()?F():_(!0),L().then(function(){P(m,w,y,b,C),"view"==b&&setTimeout(function(){ee()},100),"GridView"!=p.getViewType()?V():_(!1)})):P(m,w,y,b,C)}finally{let e=p.getViewType(),t={event:"TaskView"};if(t.initialValue=null==e?"GraphView":e,T.sendRouteTrackerEvent(t),"GridView"==e){let e=document.querySelector("#task-graph-toolbar");e&&e.hide()}y.updateUnlock()}}(),"edit"==t){let e={view:"edit"},t=new UWA.Element("div",{id:"footer-buttons",class:"footer-buttons"}).inject(document.querySelector(".taskEdit_footer"));new h({disabled:!1,label:o.save,domId:"graph_save",emphasize:"primary",onClick:function(t){t.dsModel.label=o.SavingTask,t.dsModel.disabled=!0,document.querySelector("#graph_cancel").dsModel.disabled=!0;var n=t.dsModel;q(e,n)}}).inject(t),new h({label:o.cancel,domId:"graph_cancel",emphasize:"secondary",onClick:function(t){t.dsModel;D.getElement(".no-tasks-to-show-container")&&u.hideEmptyTasksPlaceholder(D,"EditMode"),k="view",H(e)}}).inject(t)}},F=function(){if(1==++I){var e=document.getElementById("routeGraphTaskContainer"),t=document.getElementById("viewTaskContainerExternal");null!=e?N=(new y).inject(e):null!=t&&(N=(new y).inject(t)),N.elements.container.setStyle("margin-top","10%"),N.on(o.loading_label)}},V=function(){N&&N.off(o.loading_label),I=0},_=function(e){let t=M.getDataGridInstance();e?t.displayModalLoader(o.loading_label):t.removeModalLoader(o.loading_label)},P=function(e,t,o,n,i){j(i),A.concat(l.registerEventsForViewMode()),l.init(e,t,o,n,i);let s=d.getTaskTreeDocument();s.options.graphType=n,"edit"==n&&(s.options.isTaskUpdated=!1),new Promise(function(e,t){l.createGraphNodes(s),e()}).then(function(){let e=!1;if(R.updateModel(s.options.routeInfoJSON),widget.data.taskId){for(var t=s.getAllDescendants(),o=0;o<t.length;o++)if(t[o].options.grid.id&&t[o].options.grid.id==widget.data.taskId){l.onDoubleClickOfTaskTile(s.getAllDescendants()[o].tileView),e=!0;break}widget.data.taskId=void 0}if(widget.data.inboxTaskSelectedId&&"GridView"!=p.getViewType())for(t=s.getAllDescendants(),o=0;o<t.length;o++)if(t[o].options.grid.id&&t[o].options.grid.id==widget.data.inboxTaskSelectedId){s.getAllDescendants()[o].tileView.highlight(),widget.data.inboxTaskSelectedId=void 0;break}widget.data.openTaskProperties&&(widget.data.openTaskProperties=!1,J(),e=!0),"view"==n&&0==s.options.responseLength&&(u.showEmptyTasksPlaceholder(document.querySelector(".route-graph-task-container"),"EditMode"),widget.routeMgmtMediator.publish("disable-edit-icon-in-tasks-tab")),"edit"==n&&0==s.options.responseLength&&u.showEmptyTasksPlaceholder(document.querySelector(".route-graph-task-container"),"EditMode"),R.getModel().RouteId=s.options.routeInfoJSON.id;let i=widget.getValue("taskIdTobePersisted");null!=i&&0==e&&W(i)})},W=function(e){let t=d.getTaskTreeDocument().getAllDescendants(),o="";for(var n=0;n<t.length;n++){let i=t[n];null!=i.options.grid.id&&i.options.grid.id==e&&(o=i)}"GridView"==widget.getValue("TasksTab-ShowView")?widget.routeMgmtMediator.publish("task-DataGrid-on-dblclick",{_id:e}):l.onDoubleClickOfTaskTile(o.tileView)},L=function(e){return new Promise(function(e,t){r.fetchRouteTasks(C.id).then(function(t){t=l.updateTaskEditSettings(t,C.model.taskEditSetting),d.destroy();let o=d.getModel(t);o.options.routeId=C.model.id,o.options.routeInfoJSON=C,o.options.responseLength=t.length,e()})})},G=function(){document.querySelector("#templates")&&document.querySelector("#templates").destroy(),document.querySelector("#footer_view")&&document.querySelector("#footer_view").destroy(),document.querySelector("#footer_edit")&&document.querySelector("#footer_edit").destroy(),document.querySelector("#graph_canvas_view")&&document.querySelector("#graph_canvas_view").destroy(),document.querySelector("#graph_canvas_edit")&&document.querySelector("#graph_canvas_edit").destroy(),document.querySelector("#routeGraphTaskContainer #task-graph-toolbar")&&document.querySelector("#routeGraphTaskContainer #task-graph-toolbar").destroy(),document.querySelector("#viewTaskContainerExternal #task-graph-toolbar")&&document.querySelector("#viewTaskContainerExternal #task-graph-toolbar").destroy(),A.forEach((e,t)=>{widget.routeMgmtMediator.unsubscribe(e)})},j=function(e){let t=widget.routeMgmtMediator.subscribe("redraw-graph-edit",function(t){if(t.taskTreeDocument){G(),U(D,"edit");let o=d.removeGraphNodesFromTree(t.taskTreeDocument);x(e,o.options.graphType,!1,o)}else{let e=".create-task-graph-container";"EditMode"==t.graphMode&&(b="edit",e=".route-graph-task-container"),u.hideEmptyTasksPlaceholder(document.querySelector(e),t.graphMode);let o=d.getTaskTreeDocument();if(t.type="edit",o.options.graphType=t.type,k=t.type,G(),U(D,t.type),o&&o.getChildren().length<3){let e=d.getTaskNodeModel("right",0);x(C,t.type,!1,e.getTreeDocument())}else x(C,t.type,!1,o)}"GridView"==p.getViewType()&&widget.routeMgmtMediator.publish("task-DataGrid-on-dblclick")});A.push(t),t=widget.routeMgmtMediator.subscribe("redraw-graph",function(e){if(e&&"Active"==e.state&&d.getTaskTreeDocument().options&&"edit"==d.getTaskTreeDocument().options.graphType){let e={view:"view"};widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:"edit"}),H(e,!1);let t=".route-graph-task-container";if(u.hideEmptyTasksPlaceholder(document.querySelector(t),"view"),"GridView"==p.getViewType()){let e=document.querySelector("#task-graph-toolbar");e&&e.hide()}}else B()}),A.push(t),t=widget.routeMgmtMediator.subscribe("task-action-on-save",function(e){B()}),A.push(t),widget.routeMgmtMediator.subscribe("route-data-updated",function(e){if(e=g.gridData(e),d.getTaskTreeDocument().options.routeInfoJSON.model=e,C.model=e,d.getTaskTreeDocument().options.routeInfoJSON.routeBasePurpose=e.BasePurpose,C.routeBasePurpose=e.BasePurpose,D.querySelector(".finish-info")){let t=l.getFinishNodeHelpTooltip(e);D.querySelector(".finish-info").tooltipInfos.shortHelp=t}}),widget.routeMgmtMediator.subscribe("template-data-updated",function(e){e=g.templateGridData(e),d.getTaskTreeDocument().options.routeInfoJSON.model=e,C.model=e,d.getTaskTreeDocument().options.routeInfoJSON.routeBasePurpose=e.BasePurpose,C.routeBasePurpose=e.BasePurpose}),t=widget.routeMgmtMediator.subscribe("ON_SPLIT_ROUTENODE",function(){B()}),A.push(t),t=widget.routeMgmtMediator.subscribe("OPEN-TASK-PROPERTIES",function(){J()}),A.push(t),t=widget.routeMgmtMediator.subscribe("update-task-model",function(e){var t=d.getTaskTreeDocument();G(),U(D,t.options.graphType),x(t.options.routeInfoJSON,t.options.graphType,!1,t)}),A.push(t)},B=function(){var e=document.getElementById("routeGraphTaskContainer"),t=document.getElementById("viewTaskContainerExternal");if(null!=e||null!=t){c.getLoginUser()!=C.model.ownerFilter&&"edit"==d.getTaskTreeDocument().options.graphType&&(d.getTaskTreeDocument().options.graphType="view",widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:"edit"}));let e=d.getTaskTreeDocument().options.graphType;G(),U(D,e),x(C,e,!0)}},q=function(e,t){m.updateTaskDetails(d,C).then(t=>{widget.notify.handler().addNotif({level:"success",message:o.successEditTask,sticky:!1}),widget.routeMgmtMediator.publish("route-task-on-save"),widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:k}),H(e),f.refreshRouteData(C)},n=>{t.disabled=!1,document.querySelector("#graph_cancel").dsModel.disabled=!1,t.label=o.save,n.refresh?(widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:k}),H(e)):n.error?widget.notify.handler().addNotif({level:"error",message:n.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",message:o.allTaskNotValidatedErrorForEdit,sticky:!1})})},H=function(e,t){let o,n=document.querySelector(".Tasks-gridView-View");document.querySelector(".canvas");if(G(),"view"==k?("GridView"==p.getViewType()&&(widget.routeMgmtMediator.publish("show-plus-icon-in-tasks-toolbar"),widget.routeMgmtMediator.publish("show-remove-icon-in-tasks-toolbar"),n.addClassName("task-grid-container-edit-mode")),e.view="edit",k="edit"):("GridView"==p.getViewType()&&(widget.routeMgmtMediator.publish("hide-plus-icon-in-tasks-toolbar"),widget.routeMgmtMediator.publish("hide-remove-icon-in-tasks-toolbar"),n.removeClassName("task-grid-container-edit-mode")),e.view="view",k="view"),U(D,e.view),"GridView"==p.getViewType()){let e=document.querySelector("#task-graph-toolbar");e&&e.hide()}b=e.view,t?(o=d.getTaskTreeDocument(),x(C,e.view,!1,o)):x(C,e.view,!0),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode")},J=function(){let e=d.getTaskTreeDocument(),t=e.getAllDescendants(),o=[];for(var n=0;n<t.length;n++){let i=t[n];Z(i,e)&&(Y(i)&&X(i)?o.push(i):K(i)&&$(i,e)&&o.push(i))}o=z(o),l.onDoubleClickOfTaskTile(o[0].tileView)},z=function(e){return e.sort(function(e,t){return null!=e.options.grid.taskDueDate&&""!=e.options.grid.taskDueDate||null!=t.options.grid.taskDueDate&&""!=t.options.grid.taskDueDate?null==e.options.grid.taskDueDate||""==e.options.grid.taskDueDate?1:null==t.options.grid.taskDueDate||""==t.options.grid.taskDueDate?-1:new Date(e.options.grid.taskDueDate)-new Date(t.options.grid.taskDueDate):0}),e},X=function(e){return"Assigned"==e.options.grid.current},K=function(e){return"Review"==e.options.grid.current},Y=function(e){return e.options.grid.taskAssigneeUsername==c.getLoginUser()},$=function(e,t){return(t.options&&t.options.routeInfoJSON&&t.options.routeInfoJSON.model?t.options.routeInfoJSON.model.UserName:"")==c.getLoginUser()},Z=function(e,t){let o=Q(t);if(K(e)&&o.contains("Review"))return!0;if(X(e)){if("Comment"==e.options.grid.taskAction&&o.contains("Comment"))return!0;if("Approve"==e.options.grid.taskAction&&o.contains("Approval"))return!0}return!1},Q=function(e){return e.options&&e.options.routeInfoJSON&&e.options.routeInfoJSON.model?e.options.routeInfoJSON.model.Activity_State:""},ee=function(){l.fitToWindowDefaultLoad(O,E)};return{build:e=>(D=e,p.resetViewType(),U(e,"view")),initTaskGraphView:(e,t)=>(k=t,b=t,C=e,x(e,t,!1)),switchView:e=>(function(e){let t=d.getTasksDataForCreation(),n=d.getTaskTreeDocument().options.isTaskUpdated,i=m.getTasksDatasForDelete(d);i.length>0&&(n=!0);let s=D.getElement(".no-tasks-to-show-container"),a={};if("edit"==k)if(!n&&t||null==n||s&&0==i.length)a.refresh=!0,a.message="Tasks are not modified",widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:k}),H(e);else{let t=new v;t.inject(document.body),new w({modalFlag:!0,width:350,height:150,title:o.switchToViewMode,content:o.switchToViewModeConfirmation,immersiveFrame:t,buttons:{Ok:new h({disabled:!1,onClick:function(t){t.dsModel,t.dsModel.dialog.close(),i&&D.getElement(".no-tasks-to-show-container")&&u.hideEmptyTasksPlaceholder(D,"EditMode"),widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:k}),H(e)}}),Cancel:new h({onClick:function(e){e.dsModel.dialog.close()}})}})}else widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:k}),H(e);widget.setValue("taskIdTobePersisted",void 0)})(e),destroy:()=>G(),fitToWindowDefaultLoad:()=>ee(),addRouteTask:()=>(function(){if(R.getModel().options&&R.getModel().options._isTaskPanelOpened)widget.notify.handler().addNotif({level:"error",subtitle:o.taskErrorOnAdd,sticky:!1});else if(null!=document.querySelector(".no-tasks-to-show-container"))widget.routeMgmtMediator.publish("disable-switch-view-and-add-save-icon",{curView:"view"}),widget.routeMgmtMediator.publish("redraw-graph-edit",{graphMode:"EditMode"});else{var e=d.getTaskTreeDocument();let o=e.getChildren().length-2;var t=d.getTaskNodeModel("right",o);G(),U(D,e.options.graphType),x(e.options.routeInfoJSON,e.options.graphType,!1,e),widget.routeMgmtMediator.publish("task-DataGrid-on-dblclick",t)}})()}}),define("DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphEditView",["DS/WAFData/WAFData","DS/ENORouteMgmt/Utilities/ParseJSONUtil","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","DS/egraph/core","DS/egraph/views","DS/egraph/iact","DS/egraph/utils","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","DS/ENORouteMgmt/Model/InitiateRouteTaskModel","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Views/Graph/eGraphToolbar","DS/ENORouteMgmt/EnoviaBootstrap","css!DS/UIKIT/UIKIT.css","css!DS/egraph/views.css","css!DS/egraph/views_default.css","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m){"use strict";let p,g,f,h,w,v,S=[],R="http://www.w3.org/2000/svg",y=function(e){let t=new UWA.Element("div",{id:"templates_create",display:"none"}).inject(e);new UWA.Element("div",{class:"mixnode"}).inject(t);var o=new UWA.Element("div",{class:"canvas",id:"graph_canvas_create"});o.inject(e),o.addEventListener(void 0!==document.body.onwheel?"wheel":"mousewheel",function(e){var t=document.querySelector(".wux-controls-combobox-popup");t&&(t.style.display="none");var o=document.querySelector(".wux-menu-container");o&&(o.style.display="none")},!0),l.createToolbarContainer(e),h=e.id,o.addEventListener("click",function(){document.querySelector(".wux-menu")&&(document.querySelector(".wux-menu").style.display="none")})},M=function(e,t){function m(){i.HTMLNodeView.call(this)}a.inherit(m,i.HTMLNodeView),m.prototype.buildNodeElement=function(e){if(e.data.content){if("Any"==e.data.title||"All"==e.data.title){let t=e.data.content;return l.drawGraphNode(t,"dropdown")}if("terminating node"==e.data.type){let t=e.data.content;return l.drawGraphNode(t,"terminating-node")}{let t=e.data.content,o={width:"300px"};return l.drawGraphNode(t,"tile",o)}}var t=document.querySelector("#templates_create > .mixnode").cloneNode(!0);return t.appendChild(document.createTextNode(o[e.data.title])),t};var k=new n.BoundsGeometry;function E(){i.HTMLNodeView.call(this)}function O(e,t,o){this.side=e,this.nodeIndex=t,this.events=o,i.SVGConnView.call(this)}function N(e){return{"01":"bottom",10:"right","0-1":"top","-10":"left"}[e]}k.paddingTop=80,a.inherit(E,i.HTMLNodeView),E.prototype.buildNodeElement=function(e){var t=document.querySelector(e.collapsed?"#templates_create > .collapsed-group":"#templates_create > .expanded-group").cloneNode(!0);return t.appendChild(document.createTextNode("Any one of the task can be completed to move the next step")),t},a.inherit(O,i.SVGConnView),O.prototype.buildConnElement=function(e){i.SVGConnView.prototype.buildConnElement.call(this,e);let t=document.createElementNS(R,"rect");return t.setAttribute("width",21),t.setAttribute("height",21),t.setAttribute("class","rectConnnector"),t},O.prototype.onmodifyDisplay=function(t,n,s){let a="view"!=p,r=!1;a=(!t.node.data.title||"Any"==t.node.data.title||"All"==t.node.data.title||"Finish"==t.node.data.title)&&"view"!=p&&arguments[0].showPlusIcon,arguments[0].showArrow&&(r=!0);let u=N(String(t.anormx)+String(t.anormy));i.SVGConnView.prototype.onmodifyDisplay.apply(this,arguments);let c=this.display.elt,m=c.getAttribute("transform"),g=l.changeTransformOfSvg(m,u,t.node);if(!c.nextElementSibling){if(g&&(c.setAttribute("transform",g.rect),m=g.text),a){let e=document.createElementNS(R,"text");e.setAttribute("class","plusConnector"),e.setAttribute("transform",m),e.setAttribute("alignment-baseline","middle"),e.textContent="+";let t=document.createElementNS(R,"title");t.textContent=o.addTask,e.appendChild(t),this.prevEvent,e.addEventListener("click",function(e){h(e)}),e.addEventListener("touchstart",function(e){e.preventDefault(),h(e)}),this.display.elt.parentNode.appendChild(e)}else c.setAttribute("display","none");function h(n){if(n.stopImmediatePropagation(),l.isTaskPanelOpened(t.node.data.model))widget.notify.handler().addNotif({level:"error",subtitle:o.taskErrorOnAdd,sticky:!1});else{let o=N(String(t.anormx)+String(t.anormy)),n=parseInt(t.node.data.model.options.grid.taskOrder),i=d.getTaskNodeModel(o,n),s=i.getTreeDocument();s.options._isSplitTaskPresent?(D(),y(f),M(e,s)):l.insertNewNode(t,i,s),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons")}}if(r){let e=document.createElementNS(R,"text");e.setAttribute("class","arrowConnector"),e.setAttribute("transform",g?g.arrow:m),e.setAttribute("alignment-baseline","central"),e.textContent=">",this.display.elt.parentNode.appendChild(e)}}},(w=new n.EGraph).addView("main",new i.HTMLGraphView(document.querySelector("#graph_canvas_create")));new c.Toolbar({buttons:[{id:"fitToWindow",query:"#"+h+" .main-rt-task-toolbar .fitToWindow",mode:"push",cb:function(){l.fitToWindow(w,h)}}]});w.addListener("update",function(e){if(w.selection.last&&w.selection.last.data){let e=w.selection.last.data.content;e.elements.container.click()}}),(v=new s.StateMachine(w,null,null,w.views.main)).rootState.newDragForElement=(v.rootState.newDragForElement,function(e,t,o){if(t.type===n.Type.GROUP&&"expand-btn"===o)return new s.SubEltClickDrag(t,o,function(e){e.collapsed||e.geometry.recenterGroup(e),e.set("collapsed",!e.collapsed)}.bind(void 0,t))}),l.setZoomOptionsOnGraph(w),function(){w.updateLock();try{t?(C(e,w),l.init(m,O,w,p,g),S.concat(l.registerEventsForCreateGraph()),l.createGraphNodes(t)):r.fetchRouteTasks(e.id).then(function(t){if(C(e,w),e.createTask||t.length>0){l.init(m,O,w,p,g),S.concat(l.registerEventsForCreateGraph()),d.destroy(),t=T(t),e.id&&""!=e.id&&(t=b(t)),e.taskEditSetting&&(t=l.updateTaskEditSettings(t,e.taskEditSetting)),"Route Template"==e.Type&&(t.parentObjectType="Route Template");let o=d.getModel(t);o.options.routeId=e.id,o.options.routeInfoJSON=e,o.options.graphType=p,o.options._isSplitTaskPresent?(D(),y(f),M(e,o)):l.createGraphNodes(o),widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons")}else u.showEmptyTasksPlaceholder(document.querySelector(".create-task-graph-container"),"createMode");widget.routeMgmtMediator.publish("initiate-route-toggle-dialogbuttons")})}finally{w.updateUnlock()}}()},T=function(e){return e.forEach((e,t)=>{if(e.routeOwnerTask&&"TRUE"==e.routeOwnerTask){let t=m.getLoginUserFullName();e.taskAssignee=t,e.assigneeId="contextUser"}}),e},b=function(e){return e.forEach(function(e){e.templateTask="Yes"}),e},C=function(e,t){let o=widget.routeMgmtMediator.subscribe("redraw-graph-create",function(t){if(t.taskTreeDocument){D();let o=d.removeGraphNodesFromTree(t.taskTreeDocument);y(f),M(e,o)}else{let o=".create-task-graph-container";"EditMode"==t.graphMode&&(o=".route-graph-task-container"),u.hideEmptyTasksPlaceholder(document.querySelector(o),t.graphMode),D(),e.createTask=!0,e||((e={}).id=""),y(f),M(e)}});S.push(o),o=widget.routeMgmtMediator.subscribe("initiateRoute-on-TemplateSelection",function(t){if(d.destroy(!0),t.template&&t.template.length>0&&t.template[0].id){if(f){let o=".create-task-graph-container";u.hideEmptyTasksPlaceholder(document.querySelector(o),"EditMode"),D(),y(f),null==e&&(e={}),e.id=t.template[0].id,M(e)}}else f&&(D(),y(f),e.id="",e.templateId="",M(e));e.createTask=!1}),S.push(o)},D=function(){let e=document.querySelector("#"+h);e.querySelector("#templates_create")&&e.querySelector("#templates_create").destroy(),e.querySelector("#graph_canvas_create")&&e.querySelector("#graph_canvas_create").destroy(),e.querySelector("#task-graph-toolbar")&&e.querySelector("#task-graph-toolbar").destroy(),S.forEach((e,t)=>{widget.routeMgmtMediator.unsubscribe(e)})};return{build:e=>(f=e,y(e)),initTaskGraphView:(e,t)=>(S.forEach((e,t)=>{widget.routeMgmtMediator.unsubscribe(e)}),p=t,g=e,""==e&&(p="create"),e.templateId&&!e.id&&(e.id=e.templateId),null==e.id&&(e.id=""),M(e)),destroy:()=>{D()}}}),define("DS/ENORouteMgmt/Views/RouteTasksView",["DS/ENORouteMgmt/Views/Grid/RouteTasksDataGridView","DS/ENORouteMgmt/Config/Toolbar/RouteSummaryToolbarConfig","DS/ENORouteMgmt/Components/Wrappers/WrapperDataGridView","DS/ENORouteMgmt/Model/RouteTaskModel","DS/ENORouteMgmt/Utilities/PlaceHolder","DS/ENORouteMgmt/Views/ToggleTaskViews","DS/ENORouteMgmt/Controller/RouteServicesController","DS/Utilities/Array","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Model/Utils/TaskModelUtils","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphEditView","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphView","DS/Core/PointerEvents","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g){"use strict";let f,h,w=[],v=function(t,o){let i=UWA.createElement("div",{id:"dataGridTasksDivToolbar",class:"toolbar-container",styles:{width:"100%"}}).inject(t),s=n.getModel(),a=e.build(s,o);return e.getGridViewToolbar().inject(i),a.inject(t),P(n.getModel()),W(n.getModel(),o),L(),G(),b(),t},S=function(e,t){if(t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.multipleHitCount){let e={};e.model=t.nodeModel,e.model.routePropertiesInfo=f,e.routePropertiesInfo=f,require(["DS/ENORouteMgmt/Views/Menu/TaskContextualMenu"],function(t){t.onDoubleClickOfTaskGrid(e)})}},R=function(e,t){let o={};o.model=t.nodeModel,o.model.routePropertiesInfo=f,o.routePropertiesInfo=f,t&&t.nodeModel&&t.nodeModel.options.grid&&2==e.button&&require(["DS/ENORouteMgmt/Views/Menu/TaskContextualMenu"],function(t){t.taskGridRightClick(e,o)})},y=function(e){T(e,"select")},M=function(e){T(e,"deSelect")},T=function(e,t){let o=e.options.grid.id,n=l.getTaskTreeDocument();if("view"==n.options.graphType)for(var i=n.getAllDescendants(),s=0;s<i.length;s++){let e=i[s].options.grid.id;if(null!=e&&null!=o){let i=n.getAllDescendants()[s];null!=i.tileView&&e==o&&("select"===t?i.tileView.highlight():i.tileView.unhighlight())}}},b=function(){let e=o.dataGridView();e.addEventListener(p.POINTERHIT,S),e.addEventListener("contextmenu",R),e.getTreeDocument().getXSO().onAdd(y),e.getTreeDocument().getXSO().onRemove(M),C()},C=function(){D();let e=widget.routeMgmtMediator.subscribe("route-task-on-change-assignee",function(e){n.updateAssignee(e)});w.push(e),e=widget.routeMgmtMediator.subscribe("task-action-on-save",function(){V()}),w.push(e),e=widget.routeMgmtMediator.subscribe("redraw-graph",function(){_()}),w.push(e),e=widget.routeMgmtMediator.subscribe("route-task-on-save",function(){V()}),w.push(e),e=widget.routeMgmtMediator.subscribe("ON_SPLIT_ROUTENODE",function(){V("splitTask")}),w.push(e),e=widget.routeMgmtMediator.subscribe("disable-switch-view-and-add-save-icon",function(e){F(e.curView)}),w.push(e),e=widget.routeMgmtMediator.subscribe("disable-edit-icon-in-tasks-tab",function(){E()}),e=widget.routeMgmtMediator.subscribe("show-edit-icon-in-tasks-tab",function(){O()}),e=widget.routeMgmtMediator.subscribe("hide-edit-icon-in-tasks-tab",function(){N()}),w.push(e),e=widget.routeMgmtMediator.subscribe("route-task-open-click-view-mode",function(e){k(!0)}),w.push(e),e=widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",function(e){k(!1)}),w.push(e),e=widget.routeMgmtMediator.subscribe("show-plus-icon-in-tasks-toolbar",function(){A()}),w.push(e),e=widget.routeMgmtMediator.subscribe("hide-plus-icon-in-tasks-toolbar",function(){I()}),w.push(e),e=widget.routeMgmtMediator.subscribe("update-Route-Task-Model",function(e){u.updateRouteTaskModel(e)}),w.push(e),e=widget.routeMgmtMediator.subscribe("show-remove-icon-in-tasks-toolbar",function(){U()}),w.push(e),e=widget.routeMgmtMediator.subscribe("hide-remove-icon-in-tasks-toolbar",function(){x()}),w.push(e),e=widget.routeMgmtMediator.subscribe("task-DataGrid-on-dblclick",function(e){let t=n.getModel();if(widget.getValue("taskIdTobePersisted")){if(e&&e._id&&null!=t){let n=t.getChildren();for(var o=0;o<n.length;o++)if(n[o].options.id==e._id){let e={};n[o].select(!0),e.model=n[o],e.model.routePropertiesInfo=f,e.routePropertiesInfo=f,require(["DS/ENORouteMgmt/Views/Menu/TaskContextualMenu"],function(t){t.onDoubleClickOfTaskGrid(e)});break}}}else if(e&&e._id){if(null!=t){let n=t.getChildren();for(o=0;o<n.length;o++)if(n[o].options.graphNodeId==e._id){let e={};n[o].select(!0),e.model=n[o],e.model.routePropertiesInfo=f,e.routePropertiesInfo=f,require(["DS/ENORouteMgmt/Views/Menu/TaskContextualMenu"],function(t){t.onDoubleClickOfTaskGrid(e)});break}}}else if(null!=t&&1==t.getChildren().length){let e={};t.getChildren()[0].select(!0),e.model=t.getChildren()[0],e.model.routePropertiesInfo=f,e.routePropertiesInfo=f,require(["DS/ENORouteMgmt/Views/Menu/TaskContextualMenu"],function(t){t.onDoubleClickOfTaskGrid(e)})}}),w.push(e)},D=function(){w.forEach((e,t)=>{widget.routeMgmtMediator.unsubscribe(e)}),w=[]},k=function(t){e.getDataGridInstance().getTreeDocument().options._isTaskPanelOpened=t},E=function(){let t=e.getGridViewToolbar().getNodeModelByID("editTask"),o=e.getGridViewToolbar().getNodeModelByID("view");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(t._associatedView.elements.container.querySelector(".wux-controls-button").removeAttribute("style"),t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.disabled=!0),o&&o._associatedView.elements.container.querySelector(".wux-controls-button")&&(o._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.disabled=!1)},O=function(){let t=e.getGridViewToolbar().getNodeModelByID("editTask");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.visibleFlag=!0,null!=document.querySelector("#dataGridTasksDivToolbar .wux-controls-toolbar-category-separator")&&document.querySelector("#dataGridTasksDivToolbar .wux-controls-toolbar-category-separator").show())},N=function(){let t=e.getGridViewToolbar().getNodeModelByID("editTask");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.visibleFlag=!1,null!=document.querySelector("#dataGridTasksDivToolbar .wux-controls-toolbar-category-separator")&&document.querySelector("#dataGridTasksDivToolbar .wux-controls-toolbar-category-separator").hide())},A=function(){let t=e.getGridViewToolbar().getNodeModelByID("addRouteTask"),o=n.getModel(),i=!0;if(0==o.getChildren().length||"GraphView"==s.getViewType())i=!1;else if(o.getChildren().length>=0){var a=o.getChildren()[0];a&&a.options.grid&&a.options.grid.taskEditSetting&&"Maintain Exact Task List"==a.options.grid.taskEditSetting&&(i=!1)}i&&t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(0==t.options.visibleFlag&&t.updateOptions({visibleFlag:!0}),t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.visibleFlag=!0)},I=function(){let t=e.getGridViewToolbar().getNodeModelByID("addRouteTask");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.visibleFlag=!1)},U=function(){let t=e.getGridViewToolbar().getNodeModelByID("removeRouteTask"),o=n.getModel(),i=!0;if(0==o.getChildren().length||"GraphView"==s.getViewType())i=!1;else if(o.getChildren().length>=0){var a=o.getChildren()[0];a&&a.options.grid&&a.options.grid.taskEditSetting&&"Maintain Exact Task List"==a.options.grid.taskEditSetting&&(i=!1)}i&&t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(0==t.options.visibleFlag&&t.updateOptions({visibleFlag:!0}),t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.visibleFlag=!0)},x=function(){let t=e.getGridViewToolbar().getNodeModelByID("removeRouteTask");t&&t._associatedView.elements.container.querySelector(".wux-controls-button")&&(t._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.visibleFlag=!1)},F=function(t){let o=e.getGridViewToolbar().getNodeModelByID("view"),n=e.getGridViewToolbar().getNodeModelByID("editTask");n._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.disabled=!1,"view"==t?(n._associatedView.elements.container.querySelector(".wux-controls-button").setStyle("color","rgb(54, 142, 196)"),o._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.disabled=!0):(n._associatedView.elements.container.querySelector(".wux-controls-button").removeAttribute("style"),o._associatedView.elements.container.querySelector(".wux-controls-button").dsModel.disabled=!1)},V=function(e){f.model&&f.model.id&&a.fetchRouteTasks(f.model.id).then(function(t){n.getModel().removeRoots(),n.createModel(f),e&&"splitTask"==e&&P(n.getModel()),W(n.getModel())})},_=function(e){f.model&&f.model.id&&a.fetchRouteTasks(f.model.id).then(function(t){e&&"splitTask"==e&&P(n.getModel()),W(n.getModel())})},P=function(t){var o=!0;for(let e of t.getChildren())if("True"==e._options.grid.chooseUsersFromUg){o=!1;break}if(o){var n=e.getGridViewToolbar().getNodeModelByID("selectusers.tasks");n&&n.updateOptions({visibleFlag:!1})}},W=function(t,o){let n=!0,i=!0;for(let e of t.getChildren())if("Complete"!=e._options.grid.current){n=!1;break}var s;(t.getChildren().length>0&&n&&(i=!1),i)?(s=e.getGridViewToolbar().getNodeModelByID("editTask"))&&s.updateOptions({visibleFlag:!0}):(s=e.getGridViewToolbar().getNodeModelByID("editTask"))&&s.updateOptions({visibleFlag:!1});o&&"Route Template"==o.model.Type&&"Active"===o.model.actualState&&o.model.Actions.indexOf("demote")>=0&&((s=e.getGridViewToolbar().getNodeModelByID("editTask"))&&(s.updateOptions({visibleFlag:!1}),document.querySelector("#dataGridTasksDivToolbar .wux-controls-toolbar-category-separator").hide()))},L=function(){var t=e.getGridViewToolbar().getNodeModelByID("addRouteTask");t&&t.updateOptions({visibleFlag:!1})},G=function(){var t=e.getGridViewToolbar().getNodeModelByID("removeRouteTask");t&&t.updateOptions({visibleFlag:!1})};return{build:(e,t)=>(h=t,function(e,t){v(t,f=e)}(e,t)),addorRemoveRouteEventListeners:()=>addorRemoveRouteEventListeners(),destroy:()=>{n.destroy(),D()},getModel:()=>getSummaryModel(),destroyContainer:()=>(document.querySelector("#dataGridTasksDivToolbar")&&document.querySelector("#dataGridTasksDivToolbar").destroy(),void(document.querySelector(".Tasks-gridView-View")&&document.querySelector(".Tasks-gridView-View").destroy()))}}),define("DS/ENORouteMgmt/Views/Dialogs/DeleteGridTaskDialog",["DS/WAFData/WAFData","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Model/RouteTaskModel","DS/ENORouteMgmt/Controller/RouteServicesController","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","DS/WebappsUtils/WebappsUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d){"use strict";let u;return{showConfirmationDialog:()=>(function(){let e=i.getTaskTreeDocument();if(s.getModel().options&&s.getModel().options._isTaskPanelOpened)return void widget.notify.handler().addNotif({level:"error",subtitle:d.taskErrorOnDelete,sticky:!1});if((u=s.getSelectedRowsModel()).data.length<1)return void widget.notify.handler().addNotif({level:"warning",subtitle:d.ErrorTaskRemoveSelection,sticky:!1});let a=[],c=e.options.graphType,m=e.getAllDescendants();for(let e=0;e<u.data.length;e++)for(let t=0;e<m.length;t++){let o=m[t];if(o._id==u.data[e].options.graphNodeId){a.push(o);break}}var p=[],g=[],f=UWA.createElement("ul",{class:"",styles:{"list-style-type":"circle"}}),h=UWA.createElement("ul",{class:"",styles:{"list-style-type":"circle"}});for(let e=0;e<a.length;e++){let t=[];if(a[e].options.grid.taskDetails&&a[e].options.grid.taskDetails.forEach((e,o)=>{"true"==e.split("~")[1]&&t.push(e.split("~")[0])}),!a[e].options.grid.taskDetails||t.includes("showTaskRemove")&&r.canShowDeleteTask(a[e],c,"showTaskRemove")){let t;p.push(a[e]),t=null==a[e].options.grid.title?d.taskTitlePlaceholder:a[e].options.grid.title,f.appendChild(UWA.createElement("li",{class:"",html:[UWA.createElement("span",{class:"",html:[{tag:"img",src:l.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")}]}),UWA.createElement("span",{id:"deleteGridTaskTitle",html:"<b>"+t+"</b>"})]}))}else{let t;t=null==a[e].options.grid.title?d.taskTitlePlaceholder:a[e].options.grid.title,g.push(a[e]),h.appendChild(UWA.createElement("li",{class:"",html:[UWA.createElement("span",{class:"",html:[{tag:"img",src:l.getWebappsAssetUrl("ENORouteMgmt","icons/16/I_RouteTask16.png")}]}),UWA.createElement("span",{id:"deleteGridTaskTitle",html:"<b>"+t+"</b>"})]}))}}let w=new o;w.inject(document.body);let v=new UWA.Element("div",{id:"removeGridTaskWarning",class:""});var S="";p.length>0&&(S=(S=1==p.length?d.removeTaskHeaderSingle:d.removeTaskHeader).replace("{count}",p.length),v.appendChild(UWA.createElement("div",{class:"",html:d.removeTaskWarning})),1==p.length?v.appendChild(UWA.createElement("div",{class:"",html:d.removeTaskWarningDetailSingle})):v.appendChild(UWA.createElement("div",{class:"",html:d.removeTaskWarningDetail})),v.appendChild(UWA.createElement("div",{class:""}).appendChild(f))),g.length>0&&(""==S&&(S=d.removeTaskHeader2),1==g.length?v.appendChild(UWA.createElement("div",{class:"",html:d.removeTaskWarningDetail2Single})):v.appendChild(UWA.createElement("div",{class:"",html:d.removeTaskWarningDetail2})),v.appendChild(UWA.createElement("div",{class:""}).appendChild(h)));var R=!1;g.length>0&&p.length<1&&(R=!0),new t({modalFlag:!0,width:500,height:200,title:S,content:v,domId:"RouteImmersiveFrame",immersiveFrame:w,buttons:{Ok:new n({label:d.ok,disabled:R,onClick:function(e){for(let e=0;e<p.length;e++)r.postGridDeleteAction(p[e]);let t=i.getTaskTreeDocument();s.updateModel(t.options.routeInfoJSON),s.getModel().RouteId=t.options.routeInfoJSON.id,e.dsModel.dialog.close()}}),Cancel:new n({label:d.cancel,onClick:function(e){e.dsModel.dialog.close()}})}}).addEventListener("close",function(e){w&&(w.elements.container.setStyle("height","1px"),w.elements.container.setStyle("width","1px"))})})()}}),define("DS/ENORouteMgmt/Views/Menu/TaskContextualMenu",["DS/Menu/Menu","DS/ENORouteMgmt/Model/RouteTaskModel","DS/ENORouteMgmt/Views/Dialogs/DeleteTask","DS/ENORouteMgmt/Views/Dialogs/ChangeAssignee","DS/ENORouteMgmt/Views/Form/TaskViewUtil","DS/ENORouteMgmt/Model/TaskModel","DS/ENORouteMgmt/Views/Graph/RouteTaskeGraphViewUtils","DS/ENORouteMgmt/Views/Dialogs/DeleteGridTaskDialog","DS/ENORouteMgmt/Controller/CollabTaskServicesController","DS/ENORouteMgmt/Utilities/RouteRefreshUtils","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/ENORouteMgmt/EnoviaBootstrap","DS/ENORouteMgmt/Views/Dialogs/InitiateRouteDialog","DS/ENORouteMgmt/Model/TaskAttachmentModel","DS/ENORouteMgmt/Views/Form/TaskView","DS/RouteWebAppUX/RouteTracker/RouteCloudProbeUtils","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt","css!DS/ENORouteMgmt/ENORouteMgmt.css"],function(e,t,o,n,i,s,a,r,l,d,u,c,m,p,g,f,h,w,v){"use strict";let S,R,y=function(e,t,o,l){R=t.model;let d=A(s.getTaskTreeDocument().getChildren());var u=[];let c=l.options.graphType;if("view"==c&&null!=t.model.options.grid.taskSubRoutes&&t.model.options.grid.taskSubRoutes.length>0&&u.push({name:v.approvalProcess,title:v.approvalProcess,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-route"},data:null,action:{callback:function(){w.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Approval Process"}),R.route=[];var e=t.model.options.grid.taskSubRoutes;for(let t=0;t<e.length;t++)R.route.push({dataelements:{id:e[t].routeId,name:e[t].routeName,approvalTaskId:e[t].approvalTaskId}});R.taskTitleForSubRoute=R.options.grid.title,R.taskIdForSubRoute=R.options.grid.id,a.openRouteTaskApprovalProcess(R)}}}),e.forEach((e,i)=>{"isRouteOwner"===e&&"Assigned"==R.options.grid.current&&"In Process"==t.routePropertiesInfo.model.state&&"view"==c&&"Stopped"!=t.routePropertiesInfo.model.Activity_State&&"Maintain Exact Task List"!=R.options.grid.taskEditSetting&&d&&("Extend Task List"!=R.options.grid.taskEditSetting||"Extend Task List"==R.options.grid.taskEditSetting&&"No"==R.options.grid.templateTask&&"No"==R.options.grid.isInitialTask)&&u.push({name:"MarkasComplete",title:v.markasCompleteTitle,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-status-change"},data:null,action:{callback:function(){w.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Mark as Complete"}),t.model.getTreeDocument().options._isTaskPanelOpened?widget.notify.handler().addNotif({level:"error",subtitle:v.taskErrorOnMarkAsComplete,sticky:!1}):M(t)}}}),"showTaskRemove"===e&&(o.data.length>1||a.canShowDeleteTask(R,c,e))?u.push({type:"PushItem",title:v.Delete,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash"},action:{callback:function(){w.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Delete"}),r.showConfirmationDialog()}}}):"canChangeAssignee"===e&&O(R,c,e)&&u.push({type:"PushItem",title:"TRUE"==t.model.options.grid.routeOwnerTask?v.selectAssignee:v.changeAssignee,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-change"},action:{callback:function(e){"TRUE"==t.model.options.grid.routeOwnerTask?w.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Select Assignee"}):w.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Change Assignee"}),R.getTreeDocument().options._isTaskPanelOpened?widget.notify.handler().addNotif({level:"error",subtitle:v.taskErrorOnChangeAssignee,sticky:!1}):n.changeAssignee(R)}}})}),"view"==c&&"Assigned"==R.options.grid.current&&R.options.grid.taskDetails&&i.canPerformTaskAction(R.options.grid.taskDetails)){p.getLoginUser()==R.options.grid.taskAssigneeUsername&&u.push({name:v.subRouteCommand,title:v.subRouteCommand,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-plus"},data:null,action:{callback:function(){w.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Create Subroute"});var e={inboxTaskId:R.options.grid.id,parentRouteId:R.routePropertiesInfo.id,inboxTaskTitle:R.options.grid.title,parentRouteTaskDueDate:R.options.grid.taskDueDate};widget.setValue("isDialogOpened",!0),g.InitiateRouteDialog(e)}}})}return"true"==R.options.grid.taskAcceptLink&&"Assigned"==R.options.grid.current&&"view"==c&&u.push({type:"PushItem",title:v.accepTask,fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-user-ok"},action:{callback:function(e){w.sendRouteTrackerEvent({event:"TaskCommand",value:"Task - Accept Task"}),R.getTreeDocument().options._isTaskPanelOpened?widget.notify.handler().addNotif({level:"error",message:v.taskErrorOnAcceptTask,sticky:!1}):i.taskAccept({model:R.options.grid},R.routePropertiesInfo,"callFromMenu")}}}),u},M=function(e){var t={};t.id=e.routePropertiesInfo.id;var o={};o.id=e.model.options.grid.id,o.needsOwnerReview=e.model.options.grid.needsOwnerReview,o.currentState=e.model.options.grid.current;let n=new u;n.inject(document.body);let i=v.AutoCompleteTitle+e.model.options.grid.title;new c({modalFlag:!0,width:400,height:150,title:i,content:v.AutoCompleteContent,immersiveFrame:n,resizableFlag:!0,buttons:{Ok:new m({onClick:function(n){l.completeTask(o).then(o=>{d.refreshRouteData(t),widget.routeMgmtMediator.publish("task-action-on-save",e)},e=>{e.error?widget.notify.handler().addNotif({level:"error",title:v.taskCompletedError,message:e.error,sticky:!1}):widget.notify.handler().addNotif({level:"error",subtitle:v.taskCompletedError,sticky:!1})}),n.dsModel.dialog.close()}}),Cancel:new m({label:v.cancel,onClick:function(e){e.dsModel.dialog.close()}})}})},T=function(e){var t=[];return t.push({name:v.Open,title:v.Open,type:"PushItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open"},data:null,action:{callback:function(){D(e)}}}),t},b="",C=!1,D=function(e){b=a.getPreviouslyOpenedTaskId();let t=(R=e.model).getTreeDocument(),o=s.getTaskTreeDocument().options.graphType;if("view"!=o)if(t.options._isTaskPanelOpened)widget.notify.handler().addNotif({level:"error",subtitle:v.taskErrorOnEdit,sticky:!1});else{t.options._isTaskPanelOpened=!0,R._isTaskPanelOpened=!0;let n=E(o,"open");widget.routeMgmtMediator.publish(n,{model:e}),widget.routeMgmtMediator.publish("task-content-height-update"),k(R)}else{widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",function(){f.getAttachmentRemovalStatus("reset"),b="",C=!1,a.setUpdatedDueDate(C)}),widget.routeMgmtMediator.subscribe("route-task-close-click-edit-mode",function(){f.getAttachmentRemovalStatus("reset"),b="",C=!1,a.setUpdatedDueDate(C)}),widget.routeMgmtMediator.subscribe("task-due-date-changed",function(e){C=!!e,a.setUpdatedDueDate(C)});let n=s.getTaskTreeDocument().getChildren(),i=f.getAttachmentRemovalStatus(),r=document.querySelector("#InitiateTaskPropertiesContainer .cke_editable_inline"),l=h.getTaskPropertyFields(),d=!1;if("view"==o&&""!=b)for(let s=1;s<n.length-1;s++){let p=n[s].getAllDescendants();if(p)for(let n=0;n<p.length;n++){let s=p[n].options.grid;if(s.id==b){let n="";n="Review"==s.current?null!=s.reviewersComments||null!=s.reviewersComments?s.reviewersComments.trim():"":null!=s.comments||null!=s.comments?s.comments.trim():"";let p="";null!=r&&(p="Review"==s.current?CKEDITOR.instances.ckeditorTaskReviewComment.getData():CKEDITOR.instances.ckeditorTaskComment.getData());let g="";if(null!=l&&l.autoCompleteComponent){let e=l.autoCompleteComponent.selectedItems;g=e&&e.length>0?"attachmentsAdded":""}if(null!=r&&n!=p||""!=g||i||a.getUpdatedDueDate()){d=!0;let n=new u;n.inject(document.body);let i=R.options.grid.id==b;new c({modalFlag:!0,width:400,height:150,title:v.openTask,content:i?v.reopenSelectedTask:v.unsavedTaskChanges,immersiveFrame:n,buttons:{Ok:new m({disabled:!1,onClick:function(n){n.dsModel;n.dsModel.dialog.close(),t.options._isTaskPanelOpened=!0,R._isTaskPanelOpened=!0;let i=E(o,"open");widget.routeMgmtMediator.publish(i,{model:e}),widget.routeMgmtMediator.publish("task-content-height-update"),k(R),a.setPreviouslyOpenedTaskId(R.options.grid.id),f.getAttachmentRemovalStatus("reset"),C=!1,a.setUpdatedDueDate(C)}}),Cancel:new m({onClick:function(e){e.dsModel.dialog.close()}})}})}}}}if(!d){t.options._isTaskPanelOpened=!0,R._isTaskPanelOpened=!0;let n=E(o,"open");widget.routeMgmtMediator.publish(n,{model:e}),widget.routeMgmtMediator.publish("task-content-height-update"),k(R),a.setPreviouslyOpenedTaskId(R.options.grid.id),C=!1,a.setUpdatedDueDate(C)}}},k=function(e){let t=s.getTaskTreeDocument().options.graphType,o=E(t,"close");widget.routeMgmtMediator.subscribeOnce(o,function(t){e._isTaskPanelOpened=!1,e.getTreeDocument().options._isTaskPanelOpened=!1,widget.setValue("taskIdTobePersisted",void 0)})},E=function(e,t){let o;return"create"==e?o="route-task-"+t+"-click":"view"==e?o="route-task-"+t+"-click-view-mode":"edit"==e&&(o="route-task-"+t+"-click-edit-mode"),o},O=function(e,t,o){let n=!1;"view"==t&&(n=!0),e.routePropertiesInfo&&"Route Template"==e.routePropertiesInfo.model.Type&&"Inactive"!=e.routePropertiesInfo.model.actualState&&(n=!1);let i=N(e);return n=!(!n||!i)},N=function(e){if(e.options){let t=e.options.grid.templateTask,o=e.options.grid.isInitialTask,n=e.options.grid.taskEditSetting,i=e.options.grid.type,s=e.options.grid.routeOwnerTask;if("Yes"===t&&"TRUE"==s)return!0;if("Yes"===t&&"Route Node"==i)return"Modify/Delete Task List"==n||"Modify Task List"==n;if("Yes"===o&&"Route Node"==i&&e.routePropertiesInfo&&null==e.routePropertiesInfo.model.templateTaskEditSetting)return"Modify/Delete Task List"==n||"Modify Task List"==n}return!0},A=function(e){let t=0,o=0;if(1==e.length)return!1;for(let n=1;n<e.length-1;n++){let i=e[n].getAllDescendants();if(i.length>0)for(let e=0;e<i.length;e++){t++,"Auto Complete"==i[e]._options.grid.approvalStatus&&o++}}return o!=t-1};return S={onDoubleClickOfTaskGrid:e=>D(e),taskGridRightClick:(o,n)=>(function(o,n){let i=[],a=s.getTaskTreeDocument();o.preventDefault(),o.stopPropagation();var r=o.target.getBoundingClientRect(),l={position:{x:r.left,y:r.top+20}},d=t.getSelectedRowsModel(),u=[];if(1===d.data.length){let e=n.model.options.grid.taskDetails;e?e.forEach((e,t)=>{"true"==e.split("~")[1]&&i.push(e.split("~")[0])}):i.push("showTaskRemove"),u=(u=u.concat(T(n))).concat(y(i,n,d,a))}if(d.data.length>1){let e=!1;n.routePropertiesInfo.model.taskEditSetting&&"Maintain Exact Task List"==n.routePropertiesInfo.model.taskEditSetting&&(e=!0),"edit"!=a.options.graphType||e||(i.push("showTaskRemove"),u=u.concat(y(i,n,d,a)))}e.show(u,l)})(o,n)}}),define("DS/ENORouteMgmt/Views/TaskInfoEdit",["DS/ENORouteMgmt/Views/Form/TaskView"],function(e){"use strict";return{init:(t,o,n)=>(function(t,o,n){e.build(t,o,n)})(t,o,n)}}),define("DS/ENORouteMgmt/Views/RightPanelInfoView",["DS/ENORouteMgmt/Views/RouteInfoPropWidget","DS/ENORouteMgmt/Views/TaskInfoEdit","DS/ENORouteMgmt/Views/ContentInfoPropWidget","DS/ENORouteMgmt/Views/Panels/RoutePropertiesPanel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i){"use strict";let s;var a=function(e){this.container=e,s=new UWA.Element("div",{id:"routeInfoDisplayContainer",styles:{height:"100%"}})};return a.prototype.init=function(e,a){if(e.info&&e.model){let t={type:e.info,id:e.model.id};widget.setValue("right-panel-peristed-id",t)}s.empty(),"routeInfo"==a?n.render(s,e):"taskActionMode"==a||"taskEditMode"==a?t.init(s,e,a):"contentPreview"==a?o.render(s,e):"emptyInfo"==a&&function(){let e=UWA.createElement("div",{class:"route-information-no-selection-placeholder",html:[UWA.createElement("div",{class:"no-info-to-show",html:[UWA.createElement("div",{class:"pin",html:'<span class="fonticon fonticon-5x fonticon-info"></span>'}),UWA.createElement("span",{class:"no-info-to-show-label",html:i.NoInfoPlaceholder})]})]});s.appendChild(e)}(),this.container.appendChild(s)},a.prototype.destroy=function(){this.container.destroy()},a.prototype.destroyEditPropWidget=function(){n.destroyEditPropWidget()},a}),define("DS/ENORouteMgmt/Views/Panels/CreateTaskRightPanelSplitView",["DS/ENORouteMgmt/Components/Wrappers/SplitViewWrapper","DS/ENORouteMgmt/Views/Form/TaskView"],function(e,t){"use strict";var o,n,i=function(){};return i.prototype.getSplitView=function(t){var o=new e;var n={modelEvents:t,withtransition:!1,withoverflowhidden:!1,params:{leftWidth:1==screen.width<450?10:50,rightWidth:35,leftMinWidth:25,leftVisible:!0,rightVisible:!1},rightMaximizer:!1,leftMaximizer:!1,resizable:!0};return o.init(n),o},i.prototype.setSplitviewEvents=function(e){var i,s=e,a=s.getRightViewWrapper();o=widget.routeMgmtMediator.subscribe("route-task-open-click",function(e){i&&i.destroy(),(i=new UWA.Element("div",{id:"routeCreateContainer",styles:{height:"100%"}})).inject(a),t.build(i,e,"create"),s._showSide("right")}),n=widget.routeMgmtMediator.subscribe("route-task-close-click",function(e){s._rightVisible&&s._hideSide("right")})},i.prototype.getTokens=function(){return{open:o,close:n}},i}),define("DS/ENORouteMgmt/Views/RightPanelSplitView",["DS/ENORouteMgmt/Components/Wrappers/SplitViewWrapper","DS/ENORouteMgmt/Views/RightPanelInfoView","DS/ENORouteMgmt/Utilities/IdCardUtil"],function(e,t,o){"use strict";var n=function(){};return n.prototype.getSplitView=function(t){var o=new e,n={modelEvents:t,withtransition:!1,withoverflowhidden:!1,params:{leftWidth:65,rightWidth:75,leftMinWidth:25,leftVisible:!0,rightVisible:!1},rightMaximizer:!1,leftMaximizer:!1,resizable:!0};return o.init(n),o},n.prototype.setSplitviewEvents=function(e){var n=e;let i=n.getRightViewWrapper(),s=new t(i);widget.routeMgmtMediator.subscribe("route-header-info-click",function(e){widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),o.infoIconActive(),s.init(e,"routeInfo"),n._showSide("right"),widget.propWidgetOpen=!0}),widget.routeMgmtMediator.subscribe("route-info-close-click",function(e){n._rightVisible&&(o.infoIconInActive(),n._hideSide("right"),widget.propWidgetOpen=!1)}),widget.routeMgmtMediator.subscribe("route-task-open-click-view-mode",function(e){o.infoIconInActive(),s.init(e,"taskActionMode"),widget.propWidgetOpen=!1,n._showSide("right")}),widget.routeMgmtMediator.subscribe("route-task-open-click-edit-mode",function(e){o.infoIconInActive(),s.init(e,"taskEditMode"),widget.propWidgetOpen=!1,n._showSide("right")}),widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",function(e){n._rightVisible&&n._hideSide("right")}),widget.routeMgmtMediator.subscribe("route-task-close-click-edit-mode",function(e){n._rightVisible&&n._hideSide("right")}),widget.routeMgmtMediator.subscribe("route-content-preview-click",function(e){o.infoIconInActive(),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),s.init(e,"contentPreview"),widget.propWidgetOpen=!1,widget.contentPreviewId=e.model.id,n._showSide("right")}),widget.routeMgmtMediator.subscribe("route-content-preview-delete",function(e){n._rightVisible&&e.model.ids.includes(widget.contentPreviewId)&&n._hideSide("right")}),widget.routeMgmtMediator.subscribe("route-content-preview-close",function(e){n._rightVisible&&n._hideSide("right")})},n}),define("DS/ENORouteMgmt/Components/RouteApplicationFrame",["DS/Core/Core","DS/ENORouteMgmt/Components/Wrappers/TriptychWrapper","DS/ENORouteMgmt/Utilities/Constants","DS/ENORouteMgmt/Utilities/IdCardUtil","DS/ENORouteMgmt/Views/RightPanelInfoView","DS/ENORouteMgmt/Views/RouteSummaryView","DS/Controls/TooltipModel","i18n!DS/ENORouteMgmt/assets/nls/ENORouteMgmt"],function(e,t,o,n,i,s,a,r){"use strict";var l,d=function(){};return d.prototype.init=function(e,t,o,n,i,s){this._applicationChannel=widget.routeMgmtMediator.getEventBroker(),this._leftContent=n,this._middleContent=i,this._rightContent=s,this._mainContainer=o,this._initDom(),this._loadTemplateView()},d.prototype._loadTemplateView=function(){require(["DS/ENORouteTemplateMgmt/Views/TemplateSummaryView"],function(e){l=e})},d.prototype._initDom=function(){this._content=document.createElement("div"),this._content.classList.add("route-panel"),this._mainContainer.classList.add("route-content"),this._content.appendChild(this._mainContainer),this._triptychWrapper=new t,this._triptychWrapper.init(widget.routeMgmtMediator.getEventBroker(),this._mainContainer,this._leftContent,this._middleContent,this._rightContent),this._middleContainer=document.createElement("div"),this._middleContainer.classList.add("route-content-wrapper"),this._applicationContent=document.createElement("div"),this._applicationContent.classList.add("route-content-wrapper"),this._middleContainer.appendChild(this._applicationContent),this._middleContent&&this._middleContent._container&&this._applicationContent.appendChild(this._middleContent._container),this._subscribeEvents(),this._subscribeRightPanelEvents(),this.__mobileBreakpoint=this._triptychWrapper._triptych.__mobileBreakpoint},d.prototype._subscribeRightPanelEvents=function(){this._listRightPanelSubscription=[];var e=this;let t=new i(e._rightContent);t.destroyEditPropWidget();let o=e._triptychWrapper._getTriptych();e._listRightPanelSubscription.push(e._applicationChannel.subscribe({event:"route-header-info-click"},function(o){if(e._content.clientWidth<e.__mobileBreakpoint){if(widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),o&&"Route Template"===o.info)if(null==l){require(["DS/ENORouteTemplateMgmt/Views/TemplateSummaryView"],function(e){(l=e).activateInfoIcon()})}else l.activateInfoIcon();else o&&"Route"===o.info&&s.activateInfoIcon();n.infoIconActive(),t.init(o,"routeInfo"),e._applicationChannel.publish({event:"triptych-show-panel",data:"right"}),widget.setValue("propWidgetOpen",!0)}})),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-info-close-click",function(t){o._isRightOpen&&(t&&"Route Template"===t.info?l.inActivateInfoIcon():s.inActivateInfoIcon(),n.infoIconInActive(),e._applicationChannel.publish({event:"triptych-hide-panel",data:"right"}),widget.setValue("propWidgetOpen",!1))})),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-task-open-click-view-mode",function(o){n.infoIconInActive(),s.inActivateInfoIcon(),l.inActivateInfoIcon(),t.init(o,"taskActionMode"),widget.setValue("propWidgetOpen",!1),e._applicationChannel.publish({event:"triptych-show-panel",data:"right"})})),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-task-open-click-edit-mode",function(o){n.infoIconInActive(),s.inActivateInfoIcon(),l.inActivateInfoIcon(),t.init(o,"taskEditMode"),widget.setValue("propWidgetOpen",!1),e._applicationChannel.publish({event:"triptych-show-panel",data:"right"})})),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",function(t){o._isRightOpen&&!widget.getValue("propWidgetOpen")&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"right"})})),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-DataGrid-on-dblclick",function(t){e._isDetailsPageOpened=!0,o._isLeftOpen&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"left"}),widget.routeMgmtMediator.publish("route-triptych-hide-toggle-button")})),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-template-DataGrid-on-dblclick",function(t){e._isDetailsPageOpened=!0,o._isLeftOpen&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"left"}),widget.routeMgmtMediator.publish("route-triptych-hide-toggle-button")})),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-task-close-click-edit-mode",function(t){o._isRightOpen&&!widget.getValue("propWidgetOpen")&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"right"})})),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-content-preview-click",function(o){n.infoIconInActive(),s.inActivateInfoIcon(),l.inActivateInfoIcon(),widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"),t.init(o,"contentPreview"),widget.setValue("propWidgetOpen",!1),widget.contentPreviewId=o.model.id,e._applicationChannel.publish({event:"triptych-show-panel",data:"right"})})),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-content-preview-delete",function(t){o._isRightOpen&&t.model.ids.includes(widget.contentPreviewId)&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"right"})})),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-content-preview-close",function(t){o._isRightOpen&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"right"})})),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("route-back-to-summary",function(t){e._isDetailsPageOpened=!1})),e._listRightPanelSubscription.push(widget.routeMgmtMediator.subscribe("template-back-to-summary",function(t){e._isDetailsPageOpened=!1}))},d.prototype._subscribeEvents=function(){this._listSubscription=[];var e=this;widget.body.addEvent("resize",function(){widget.routeMgmtMediator.publish("filter-by-object-resize")}),e._listSubscription.push(e._applicationChannel.subscribe({event:"triptych-show-panel"},function(t){e._content.clientWidth<e.__mobileBreakpoint&&e._mainContainer.classList.add("full-height")})),e._listSubscription.push(e._applicationChannel.subscribe({event:"triptych-panel-hide-started"},function(t){e._content.clientWidth<e.__mobileBreakpoint&&e._mainContainer.classList.remove("full-height"),e._applicationChannel.publish({event:"model-conflict-panel-closed"})})),e._listSubscription.push(e._applicationChannel.subscribe({event:"triptych-entering-mobile"},function(){e._mainContainer.classList.remove("full-height")})),e._listSubscription.push(e._applicationChannel.subscribe({event:"triptych-resized"},function(t){if("right"===t.side)t.width;"left"===t.side&&e._isDetailsPageOpened&&e._applicationChannel.publish({event:"triptych-hide-panel",data:"left"}),widget.routeMgmtMediator.publish("filter-by-object-resize")})),e._listSubscription.push(e._applicationChannel.subscribe({event:"triptych-leaving-mobile"},function(){e._mainContainer.classList.remove("full-height")})),e._listSubscription.push(e._applicationChannel.subscribe({event:"route-triptych-hide-toggle-button"},function(){e._mainContainer.querySelector(".triptych-wp-toggle-btn").classList.add("route-toggle-hide")})),e._listSubscription.push(e._applicationChannel.subscribe({event:"route-triptych-show-toggle-button"},function(){e._mainContainer.querySelector(".triptych-wp-toggle-btn").classList.remove("route-toggle-hide"),e._applicationChannel.publish({event:"triptych-show-panel",data:"left"})})),e._listSubscription.push(e._applicationChannel.subscribe({event:"welcome-panel-collapsed"},function(){let t=e._mainContainer.querySelector(".triptych-wp-toggle-btn");t&&(t.tooltipInfos=new a({shortHelp:r.homeRightPanelExpand,allowUnsafeHTMLShortHelp:!0}))})),e._listSubscription.push(e._applicationChannel.subscribe({event:"welcome-panel-expanded"},function(){let t=e._mainContainer.querySelector(".triptych-wp-toggle-btn");t&&(t.tooltipInfos=new a({shortHelp:r.homeRightPanelCollapse,allowUnsafeHTMLShortHelp:!0}))})),e._listSubscription.push(e._applicationChannel.subscribe({event:"triptych-clicked-overlay"},function(t){if("left"==t){let t=e._mainContainer.querySelector(".triptych-wp-toggle-btn");t&&(t.tooltipInfos=new a({shortHelp:r.homeRightPanelExpand,allowUnsafeHTMLShortHelp:!0}))}"right"==t&&(widget.routeMgmtMediator.publish("route-task-close-click-view-mode"),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode"))}))},d.prototype.inject=function(e){e.appendChild(this._content)},d.prototype.destroy=function(){this._content=null},d.prototype.setTooltipForExpandCollapse=function(){let e=this._mainContainer.querySelector(".triptych-wp-toggle-btn");e&&(e.tooltipInfos=new a({shortHelp:r.homeRightPanelCollapse,allowUnsafeHTMLShortHelp:!0}))},d.prototype.showWelcomePanel=function(){this._triptychWrapper._getTriptych()._isLeftOpen||this._applicationChannel.publish({event:"triptych-show-panel",data:"left"}),this._applicationChannel.publish({event:"triptych-set-size",data:{size:300,side:"left"}})},d}),define("DS/ENORouteMgmt/Views/Panels/RouteTaskPanelSplitView",["DS/ENORouteMgmt/Components/Wrappers/SplitViewWrapper","DS/ENORouteMgmt/Views/RightPanelInfoView"],function(e,t){"use strict";var o=function(){};return o.prototype.getSplitView=function(t){var o=new e,n={modelEvents:t,withtransition:!1,withoverflowhidden:!1,params:{leftWidth:50,rightWidth:35,leftMinWidth:25,leftVisible:!0,rightVisible:!1},rightMaximizer:!1,leftMaximizer:!1,resizable:!0};return o.init(n),o},o.prototype.setSplitviewEvents=function(e){var o=e;let n=o.getRightViewWrapper(),i=new t(n);widget.routeMgmtMediator.subscribe("route-task-open-click-view-mode",function(e){i.init(e,"taskActionMode"),widget.setValue("propWidgetOpen",!1),o._showSide("right")}),widget.routeMgmtMediator.subscribe("route-task-open-click-edit-mode",function(e){i.init(e,"taskEditMode"),widget.setValue("propWidgetOpen",!1),o._showSide("right")}),widget.routeMgmtMediator.subscribe("route-task-close-click-view-mode",function(e){o._rightVisible&&o._hideSide("right")}),widget.routeMgmtMediator.subscribe("route-task-close-click-edit-mode",function(e){o._rightVisible&&o._hideSide("right")})},o}),define("DS/ENORouteMgmt/Views/RouteHomeSplitView",["DS/ENORouteMgmt/Components/Wrappers/SplitViewWrapper","DS/ENORouteMgmt/Views/RouteIDCardView","DS/ENORouteMgmt/Views/RightPanelSplitView","DS/ENORouteMgmt/Utilities/IdCardUtil"],function(e,t,o,n){"use strict";var i,s=function(){};return s.prototype.getSplitView=function(t){var o={modelEvents:t,withtransition:!1,withoverflowhidden:!1,params:{leftWidth:25,rightWidth:75,leftMinWidth:25,leftVisible:!0,rightVisible:!1},rightMaximizer:!1,leftMaximizer:!1,resizable:!0};return(i=new e).init(o),i},s.prototype.setSplitviewEvents=function(e){var o=e;let i=o.getRightViewWrapper();widget.routeMgmtMediator.subscribe("route-DataGrid-on-dblclick",function(e){widget.routeMgmtMediator.publish("route-deactivate-tag-data"),o.getRightViewWrapper().innerHTML="",new t(i).init(e),o._showSide("right"),o._hideLeft(),n.collapseIcon(),widget.getValue("propWidgetOpen")?n.infoIconActive():(widget.routeMgmtMediator.publish("route-task-close-click-view-mode",{model:e.model}),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode",{model:e.model})),widget.routeMgmtMediator.publish("route-widgetTitle-update-withName",{model:e.model})}),widget.routeMgmtMediator.subscribe("route-template-DataGrid-on-dblclick",function(e){widget.routeMgmtMediator.publish("template-deactivate-tag-data"),o._showSide("right"),o._hideLeft(),widget.getValue("propWidgetOpen")?n.infoIconActive():(widget.routeMgmtMediator.publish("route-task-close-click-view-mode",{model:e.model}),widget.routeMgmtMediator.publish("route-task-close-click-edit-mode",{model:e.model})),widget.routeMgmtMediator.publish("route-widgetTitle-update-withName",{model:e.model})}),widget.routeMgmtMediator.subscribe("route-back-to-summary",function(e){widget.routeMgmtMediator.publish("route-triptych-show-toggle-button"),o._leftVisible||o._showSide("left"),o._rightVisible&&o._hideSide("right")}),widget.routeMgmtMediator.subscribe("template-back-to-summary",function(e){widget.routeMgmtMediator.publish("route-triptych-show-toggle-button"),o._leftVisible||o._showSide("left"),o._rightVisible&&o._hideSide("right")})},s.prototype.getExistingHomeSplitView=function(){return i},s.prototype.getExistingRightViewWrapper=function(){return i.getRightViewWrapper()},s});