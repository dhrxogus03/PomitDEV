define("DS/VCXWeb3DPlay/VCXModelManagerPlayManager",["require","exports","DS/VCXWebComposer/VCXCAT3DXModelManager"],function(e,t,r){"use strict";class a extends r{_GoToPreferredSceneAtStart(){let e=this._experienceBase.getManager("VCXSequenceManager").GetListSequences();if(e.length){let t=e[0].GetListScenariosId();if(t.length){let e=t[0];this._experienceBase.getManager("VCXAPIManager").GoToScenario(e)}}}}return Object.defineProperty(a.prototype,"componentType",{enumerable:!0,get:function(){return"VCXCAT3DXModelManager"}}),a}),define("DS/VCXWeb3DPlay/VCXNotificationPlayManager",["require","exports","DS/VCXWebKernel/VCXNotificationManager","UWA/Core"],function(e,t,r,a){"use strict";class i extends r{constructor(){super(...arguments),this._isHide=!1}addProgressNotification(e){if(this._isHide)return;let t=this._experienceBase.getManager("VCXWeb3DPlayManager");if(t){let e=t.QueryInterface("XCTEWSIExperienceMgr");e&&e.update3DPlayProgressBar(this.computeBarValue(e.currentValue,98,100))}this.modal.show()}hideCurtain(){this.modal.style.opacity=0,this._isHide=!0,setTimeout(()=>this.modal.hide(),1e3)}postInitialize(){super.postInitialize(),this.modal=a.createElement("div",{class:"vcx-Modal-Hide"}),this.modal.hide();let e=document.getElementById("canvas-div");e&&this.modal.inject(e),this._loadingPanel=null}}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXNotificationManager"}}),i}),define("DS/VCXWeb3DPlay/VCX3DPlayDictionary",[],function(){"use strict";var e={VCXEWSManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},CXPCameraActor_Spec:{CATI3DExperienceObject:"DS/CAT3DExpModel/extensions/CATE3DExperienceObject",CATI3DExpVCXObjectConvertor:"DS/VCXWebDressup/CXPCameraActorVCXCXPConvertor",W3AISGNodeHolder:"DS/VCXWebDressup/VCXCameraSGNodeHolder"},VCXComponentOccurrenceComposer:{CATI3DX3DActorAsset:"DS/CATCXPModel/extensions/CATE3DX3DActorOverrideAssetMedia",W3AISGNodeHolder:"DS/VCXWeb3DPlay/VCXNodeHolderAsset3DPlay",CATI3DXOverrideAssetProperties:"DS/CATCXPModel/extensions/CATE3DXOverrideAssetProperties",CATI3DExperienceObject:"DS/VCXWebComposer/CATE3DExperienceObjectNavigable",CATI3DXAssetHolder:"DS/CAT3DExpModel/extensions/CATE3DXAssetHolder",CATI3DExpVCXObjectConvertor:"DS/VCXWebComposer/CATE3DExpVCXObjectConvertorOccurrence"},Model_VPMReference_Spec:{CATI3DX3DActorAsset:"DS/CATCXPModel/extensions/CATE3DX3DActorAssetMedia",W3AISGNodeHolder:"DS/VCXWeb3DPlay/VCXNodeHolderAsset3DPlay",VCXIModifiable:"DS/VCXWeb3DMaster/VCXModifiableOccurrenceComposer",VCXIModifiableView:"DS/VCXWeb3DMaster/VCXModifiableViewOccurrenceComposer",CATI3DExperienceObject:"DS/VCXWebComposer/CATE3DExperienceObjectNavigable",CATI3DXAssetHolder:"DS/CAT3DExpModel/extensions/CATE3DXAssetHolder",VCXIModelNavigable:"DS/VCXWeb3DMaster/VCXNavigableAssetOccurrenceComposer",VCXITreeNode:"DS/VCXWebTreeExtensions/VCXTreeNodeOccurrence",VCXIPulseBehavior:"DS/VCXWebPulseManager/VCXPulseBehaviorOccurrence",VCXISensible:"DS/VCXWebComposer/VCXASensible",VCXIVisibility:"DS/VCXWebVisibilityImpl/VCXVisibilityOccurrence",CATI3DExpVCXObjectConvertor:"DS/VCXWebComposer/CATE3DExpVCXObjectConvertorOccurrence",CATI3DXAssetProperties:"DS/CATCXPModel/extensions/CATE3DXAssetProperties"},AmbienceModel_Spec:{CATI3DXAmbienceAsset:"DS/CAT3DExpAmbienceModelWebMedia/extensions/CATE3DXAmbienceAssetMedia",CATI3DXAssetHolder:"DS/CAT3DExpModel/extensions/CATE3DXAssetHolder",CATI3DExperienceObject:"DS/CAT3DExpModel/extensions/CATE3DExperienceObject",CATI3DExpVCXObjectConvertor:"DS/VCXWebDressup/AmbienceModelVCXCXPConvertor"},VCXComponentAssetOccurrenceComposer:{W3AISGNodeHolder:"DS/VCXWebComposer/VCXNodeHolderAssetOccurrenceComposer"},Abstract3DExperienceObject_Spec:{CATIAlias:"DS/CAT3DExpModel/extensions/CATEAlias",CATI3DExperienceObject:"DS/CAT3DExpModel/extensions/CATE3DExperienceObject",VCXIModelNavigable:"DS/WebApplicationBase/VCXAModelNavigable",CATI3DXAssetHolder:"DS/CAT3DExpModel/extensions/CATE3DXAssetHolder"},CXPCoveringMaterial_Spec:{CATI3DXAssetProperties:"DS/VCXWeb3DPlay/VCXE3DXAssetProperties",CATI3DXMaterialAsset:"DS/CAT3DExpMaterialWebMedia/extensions/CATE3DXMaterialAssetMedia",CATI3DExperienceObject:"DS/CAT3DExpModel/extensions/CATE3DExperienceObject"},CAT3DXVisuManager:{W3AIManager:"DS/CAT3DExpModel/managers/W3AACAT3DXVisuManager"},CAT3DXLoaderManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},CAT3DXLinkManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},CXPExperience_Spec:{CATICXPResourcesMgr:"DS/CATCXPModel/extensions/CATECXPExperienceResourcesMgr",VCXIModelNavigable:"DS/VCXWebComposer/VCXModelNavigableRoot",VCXISensible:"DS/VCXWebComposer/VCXASensible",VCXITreeNode:"DS/VCXWebTreeExtensions/VCXTreeNodeOccurrence",VCXIVisibility:"DS/VCXWebVisibility/VCXVisibility",W3AISGNodeHolder:"DS/VCXWebComposer/VCXNodeHolderRoot",VCXIModifiable:"DS/VCXWebEWS/VCXModifiableRoot",VCXIModifiableView:"DS/VCXWebEWS/VCXModifiableViewRoot"},CXPURLResource_Spec:{CATI3DXURLResourceAsset:"DS/StudioResourceModelWeb/extensions/CATE3DXURLResourceAsset",VCXIRessourceAsset:"DS/VCXWebExperienceBase/VCXERessourceURLAsset"},CXPSoundResource_Spec:{CATI3DXSoundResourceAsset:"DS/StudioResourceModelWeb/extensions/CATE3DXSoundResourceAsset"},CXPPictureResource_Spec:{CATI3DXPictureResourceAsset:"DS/StudioResourceModelWeb/extensions/CATE3DXPictureResourceAsset",VCXIRessourceAsset:"DS/VCXWebExperienceBase/VCXERessourcePictureAsset"},CXPMaterialApplication_Spec:{CATI3DExperienceObject:"DS/CAT3DExpModel/extensions/CATE3DExperienceObject"},CXPKeyframerResource_Spec:{CATI3DXKeyframerResourceAsset:"DS/StudioResourceModelWeb/extensions/CATE3DXKeyframerResourceAsset",VCXIRessourceAsset:"DS/VCXWebExperienceBase/VCXERessourceKeyFramerAsset"}},t={CATI3DX3DActorAsset:"DS/CATCXPModel/interfaces/CATI3DX3DActorAsset",W3AISGNodeHolder:"DS/WebApplicationBase/W3AISGNodeHolder",CATI3DXOverrideAssetProperties:"DS/CATCXPModel/interfaces/CATI3DXOverrideAssetProperties",CATI3DXAssetHolder:"DS/CAT3DExpModel/interfaces/CATI3DXAssetHolder",CATI3DExperienceObject:"DS/CAT3DExpModel/interfaces/CATI3DExperienceObject",CATI3DXJSONProcessor:"DS/VIAIdeaExperienceScenarioModelWeb/interfaces/CATI3DXJSONProcessor",CATI3DExpVCXObjectConvertor:"DS/CAT3DExpModel/interfaces/CATI3DExpVCXObjectConvertor",CATI3DXAmbienceAsset:"DS/CAT3DExpAmbienceModelWeb/interfaces/CATI3DXAmbienceAsset",CATI3DXMaterialAsset:"DS/CAT3DExpMaterialWeb/interfaces/CATI3DXMaterialAsset",CATI3DXPictureResourceAsset:"DS/StudioResourceModelWeb/interfaces/CATI3DXPictureResourceAsset",CATI3DXSoundResourceAsset:"DS/StudioResourceModelWeb/interfaces/CATI3DXSoundResourceAsset",CATI3DXURLResourceAsset:"DS/StudioResourceModelWeb/interfaces/CATI3DXURLResourceAsset",CATIAlias:"DS/CAT3DExpModel/interfaces/CATIAlias",CATICXPResourcesMgr:"DS/CATCXPModel/interfaces/CATICXPResourcesMgr",CATI3DXAssetProperties:"DS/CATCXPModel/interfaces/CATI3DXAssetProperties",CATI3DXKeyframerResourceAsset:"DS/StudioResourceModelWeb/interfaces/CATI3DXKeyframerResourceAsset",VCXIRessourceAsset:"DS/VCXWebExperienceBase/VCXIRessourceAsset"},r={CAT3DXVisuManager:"DS/CAT3DExpModel/managers/CAT3DXVisuManager",Model_VPMOccurrence_Spec:"DS/VCXWeb3DMaster/VCXComponentOccurrenceComposer",Model_VPMReference_Spec:"DS/VCXWebComposer/Model_VPMReference_Spec",AmbienceModel_Spec:"DS/VCXWebDressup/AmbienceModel_Spec",VCXEWSManager:"DS/VCXWeb3DPlay/VCXEWSManagerPlay",ExpTrackManager_Spec:"DS/VCXWebKernel/ExpTrackManager_Spec",CAT3DXLoaderManager:"DS/CAT3DExpModel/managers/CAT3DXLoaderManager",CAT3DXLinkManager:"DS/CAT3DExpModel/managers/CAT3DXLinkManager",VCXNotificationManager:"DS/VCXWeb3DPlay/VCXNotificationPlayManager",VCXCAT3DXModelManager:"DS/VCXWeb3DPlay/VCXModelManagerPlayManager"},a=[];return{GetDictionary:function(){return{interfaces:t,components:r,extensions:e}},getNLSModules:function(){return a}}}),define("DS/VCXWeb3DPlay/VCXEWSManagerPlay",["require","exports","DS/VCXWebEWS/VCXEWSManagerBase"],function(e,t,r){"use strict";class a extends r{constructor(){super(),window&&window.localStorage&&window.localStorage.setItem("EWS_DisableGetWebVisuMaterial","true")}async initialize(){}async GetFactory(){}GetVirtualPool(){return""}GetAppIdentifier(){return""}async GetFactoryCSIOptions(){}}return Object.defineProperty(a.prototype,"componentType",{enumerable:!0,get:function(){return"VCXEWSManager"}}),a}),define("DS/VCXWeb3DPlay/VCXE3DXAssetProperties",["require","exports"],function(e,t){"use strict";return class{async getPhysicalId(){return this._object.QueryInterface("CATI3DXAssetHolder")._getLinkDescription()}getAssetStatus(){return this._object.QueryInterface("CATI3DXAssetHolder")._getAssetStatus()}}}),define("DS/VCXWeb3DPlay/VCXNodeHolderAsset3DPlay",["require","exports","DS/Visualization/Node3D","DS/Visualization/ThreeJS_DS","DS/WebApplicationBase/W3AASGNodeHolder"],function(e,t,r,a,i){"use strict";return class extends i{init(){}async buildSGNode(){let e=this.QueryInterface("CATI3DX3DActorAsset");this._sgNode=await e.getNode3D().catch(()=>{let e=new r;return e.setMatrix(null),e}).then(e=>{e.productType="VPMInstance",e.name=this.QueryInterface("CATI3DExperienceObject").GetValueByName("_varName"),this.GetObject().name=e.name;let t=this.GetLocalPosition();var r=new a.Matrix4(t[0],t[3],t[6],t[9],t[1],t[4],t[7],t[10],t[2],t[5],t[8],t[11],0,0,0,1);return e.setMatrix(r),e});let t=this.QueryInterface("VCXIModelNavigable").getParent().QueryInterface("W3AISGNodeHolder"),i=t.getPathElement(),n=t.getSGNode();this._pathElement=i.clone(),this._pathElement.addElement(this._sgNode),n.addChild(this._sgNode),this.GetObject().SetIsMesh(!0);let o=this.QueryInterface("VCXIModelNavigable").getChildren();if(this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("DSXMDeterministLoading"))for(let e of o)await e.QueryInterface("W3AISGNodeHolder").getSGNode();else await Promise.all(o.map(e=>e.QueryInterface("W3AISGNodeHolder").getSGNode()));return this._sgNode}isSelfManagedPathElement(){return!0}GetLocalPosition(){var e=this.QueryInterface("CATI3DExperienceObject").GetValueByName("_varposition");return e&&12===e.length?e:this.QueryInterface("CATI3DX3DActorAsset").getPositionInAssetContext()}getPathElement(){return this._pathElement}}}),define("DS/VCXWeb3DPlay/VCXWebPlayerOptionsMgr",["require","exports"],function(e,t){"use strict";return class{Dispose(){delete this._playerOptions}setPlayerOptions(e){var t,r,a,i,n;let o=null!==(t=e.playExperience)&&void 0!==t?t:{};o.onModelLoadingProgression=null!==(r=o.onModelLoadingProgression)&&void 0!==r?r:function(){},o.onModelLoadingCompleted=null!==(a=o.onModelLoadingCompleted)&&void 0!==a?a:function(){},this._playerOptions={transparentBackground:null!==(i=e.transparentBackground)&&void 0!==i&&i,workbench:"VCXWeb3DPlay",workbenchModule:"VCXWebDsxmApp.xml",playExperience:o,optimizeRaycasting:null===(n=e.OptimizeRaycasting)||void 0===n||n,...e},e.playExperience&&(e.playExperience.modelLoadComplete=void 0,e.playExperience.autoReframe=!1);let s=this._object._experienceBase;if(this._object._experienceBase.getManager("VCXPlayManager").QueryInterface("VCXIModifiable").GetPropertyValue("VCXPlayManager.showActionBar")||s.getManager("VCXContextManager").getUrlVars().debug){var c=s.getManager("VCXContextManager").getActionBar();c&&delete c._additionalActionBarSections,s.webApplication.frmWindow.loadActionBar({workbenchModule:this._playerOptions.workbenchModule,workbench:this._playerOptions.workbench})}}getPlayerOptions(){return this._playerOptions?this._playerOptions:{}}}}),define("DS/VCXWeb3DPlay/VCXWebExperienceMgr",["require","exports","DS/CoreEvents/Events"],function(e,t,r){"use strict";return class{constructor(){this.currentValue=0}async onExperienceReady(e){let t=this._object.QueryInterface("XCTEWSIPlayerOptionsMgr").getPlayerOptions().playExperience;this._onModelLoadingProgression=t.onModelLoadingProgression,this._onModelLoadingCompleted=t.onModelLoadingCompleted,this.currentValue=70,await this.loadExperience(e),this.currentValue=100,this._onModelLoadingCompleted(),this._object._experienceBase.getManager("VCXNotificationManager").hideCurtain()}update3DPlayProgressBar(e){this.currentValue=e,this._onModelLoadingProgression({loaded:e,total:100})}onPreDisposeExperience(){}async loadExperience(e){let t=this._object._experienceBase;e.QueryInterface("CATI3DExperienceObject").SetVolatile(),t.getManager("VCXContextManager").getMainViewer().setVisuEnv("None");var r=e.QueryInterface("W3AISGNodeHolder").getSGNode();t.getManager("VCXContextManager").setRootNode(r),e.QueryInterface("CATI3DExperienceObject").GetValueByName("scenariosKF")[0].QueryInterface("CATI3DXJSONProcessor").Process(),t.getManager("VCXScenarioManager").RestoreNeutralPropertiesOneModifiable(t.getManager("VCXPlayManager").QueryInterface("VCXIModifiable").GetHashing(),null),await this.applyPlayerOptionAtInit(),await t.getManager("VCXCAT3DXModelManager")._LoadExperienceModel(),t.getManager("VCXPlayManager").setPlayMode(!0),await t.getManager("VCXExperience").waitLoops(1)}async applyPlayerOptionAtInit(){let e=this._object._experienceBase,t=e.getManager("VCXContextManager");if(e.getManager("VCXContextManager").getUrlVars().debug)return;let r=e.getManager("VCXPlayManager").QueryInterface("VCXIModifiable");t.setSupported("DisplayUIPropertiesPanel",r.GetPropertyValue("VCXPlayManager.showPropertiesPanel")),t.setSupported("DisplayUIAssemblyPanel",r.GetPropertyValue("VCXPlayManager.showAssemblyPanel")),t.setSupported("DisplayUIDressupsPanel",r.GetPropertyValue("VCXPlayManager.showDressupPanel")),t.setSupported("DisplayUIScenariosPanel",r.GetPropertyValue("VCXPlayManager.showScenePanel"));let a=this._object.QueryInterface("XCTEWSIPlayerOptionsMgr");if(!a)return;a=a.getPlayerOptions();let i=t.getMainViewer();i.ambience.getBackground().setActivated(!a.transparentBackground),i.setBackgroundColor("rgb(0,0,0)","0")}}}),define("DS/VCXWeb3DPlay/VCXWeb3DPlayManager",["require","exports","DS/VCXWebExperienceBase/VCXBaseDictionary","DS/VCXWebComposer/VCXWebDictionary","DS/VCXWebDressup/VCXWebDressupDictionary","DS/VCXWebEWS/VCXWebEWSDictionary","DS/VCXWebEWS/VCXWebEWSDictionaryFD02","DS/VCXWebDigger/VCXWebDiggerDictionary","DS/VCXWeb3DPlay/VCX3DPlayDictionary","DS/WebApplicationBase/W3AAManager"],function(e,t,r,a,i,n,o,s,c,l){"use strict";class C extends l{constructor(){super(),this.alreadyInit=!1,this.lockUnitiliaze=!1}async initialize(){if(this.alreadyInit)return;this.alreadyInit=!0,console.log("init 3DPlayer"),widget.isLocalMode=!0;let e=this.GetObject()._experienceBase;await this.addDictionnary(),this.lockUnitiliaze=!0,await e._ManagerSet.unInitialize(!0),this.lockUnitiliaze=!1;let t=e.getManager("VCXContextManager").getFrameWindow();await this.setupExperience(),e.webApplication.app&&(e.webApplication.app._actionBarNew=UWA.Promise.deferred()),e.getManager("VCXExperience").addApplicationManagers();var r=this._experienceBase.getManager("VCXStylesManager");r&&r.SetModuleName("VCXWebStyles"),await e._ManagerSet.initialize(!0),e.getManager("VCXContextManager").setFrameWindow(t),await e._ManagerSet.postInitialize(!0),e.webApplication.app&&e.webApplication.app._actionBarNew.resolve(),e.getManager("VCXManipulatorManager").setManipulatorsRequirements({active:!0});e.getManager("VCXVisuManager").setDefaultAmbienceOptions({requestedMap:"3DExcite_Ambiance_Default_1024",baseModule:"CAT3DExpModel",baseFolder:"3DExcite_Ambiance_Default/",is3dxc:!0});let a=e.getManager("VCXContextManager").getMainViewer();return this.setDefaultVisuOption(a),console.log("end init 3DPlayer"),!0}async setupExperience(){let e=this.GetObject()._experienceBase;var t=e.Factory.BuildComponent("VCXExperience");t.SetID("VCXExperienceID"),t.SetPersistency(1),e._ManagerSet.addManager("VCXExperience",t),e._ManagerSet.removeManager("VCXContextManager");let r=e.Factory.BuildComponent("VCXContextManager");r.SetID("VCXContextManagerID"),r.SetPersistency(1),e._ManagerSet.addManager("VCXContextManager",r),r.setSupported("DSXMPlayer",!0),r.setTrapSelectionRequirements({pick:!0,prePick:!0}),r.setSupported("CameraDisplay",!1),r.setSupported("Cat3DXIntegration"),r.setSupported("Section",!0),r.setSupported("ProductCentric"),r.setSupported("OpacityOverride",!0),r.setSupported("DisplayUIPlay",!0),r.setSupported("FrameUnboxing",!0),r.setSupported("Paper",!1),r.setSupported("SceneControlV2"),r.setExperienceIn3DPlay(),r.setProdHighMode(),e.odt&&r.setSupported("DSXMDeterministLoading"),r.setPlayerMode()}async addDictionnary(){let e=this.GetObject()._experienceBase;await e.AddDictionaryDescription(r.GetDictionary()),await e.AddDictionaryDescription(a.GetDictionary()),await e.AddDictionaryDescription(i.GetDictionary()),await e.AddDictionaryDescription(n.GetDictionary()),localStorage.getItem("VCX_TweakingMaterial")&&await e.AddDictionaryDescription(o.GetDictionary()),await e.AddDictionaryDescription(s.GetDictionary()),await e.AddDictionaryDescription(c.GetDictionary())}async unInitialize(){this.lockUnitiliaze||(this.lockUnitiliaze=!0,await this.GetObject()._experienceBase._ManagerSet.unInitialize(!0),this.lockUnitiliaze=!1)}setDefaultVisuOption(e){e.displayInfinitePlane(!1),e.setGrid(!1),e.planeGrid&&(e.planeGrid.displayPlane=0),e.setAllowMirror(!0)}getInitPhase(){return 1}}return Object.defineProperty(C.prototype,"componentType",{enumerable:!0,get:function(){return"VCXWeb3DPlayManager"}}),C});