define("DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants",[],function(){"use strict";return{APP_NAME:"Alternate_Substitute",CONSTANT_CONTEXT_COMMAND:"ContextMenu",CONSTANT_ALT_REF:"ALT_REF",CONSTANT_DS6W_STATUS:"ds6w:status",CONSTANT_ROWUID:"AlternateItemConnectionPhysicalId",CONSTANT_REF_ID:"PrimaryItemPhysicalId",CONSTANT_ALT_INFO:"AlternateItemInfo",CONSTANT_ALT_ID:"AlternateItemPhysicalId",CONSTANT_WORK_UNDER_CHANGE_ID:"WorkUnderChangeActionPhyId",CONSTANT_CHANGE_ID:"change_id",CONSTANT_REL_ALTERNATE_OF:"Alternate Of",CONSTANT_BUS_ALTERNATE_REFERENCE:"Alternate Reference",CONSTANT_ALT_REF_PHYSICALID:"AlternateReferencePhysicalId",CONSTANT_ALT_REF_TITLE:"AlternateReferenceTitle",CONSTANT_USER_SELECTED_PRIMARY_ITEM_PHYSICALID_LIST:"UserSelectedPrimaryItemRevisionPhyIdList",CONSTANT_USER_SELECTED_INSTANCE_LOGICAL_ID_LIST:"UserSelectedInstanceLogicalPhyIdList",CONSTANT_USER_SELECTED_CONTEXT_REVISION_PHYSICAL_ID_LIST:"UserSelectedContextRevisionPhyIdList",CONSTANT_CARRY_OVER_ALTERNATE:"CarryOverAlternate",CONSTANT_CARRY_OVER_SUBSTITUTE:"CarryOverSubstitute",CONSTANT_CONFIRM_MODEL_CLASS:"alternateDlgConfirm_modal",CONSTANT_MENU_CMD_STATE_ENABLED:"enabled",CONSTANT_MENU_CMD_STATE_DISABLED:"disabled",CONSTANT_CTX_ITEM_ID:"SubstituteInstancePhysicalId",CONSTANT_INCLUDE_OTHER_CONTEXTS:"IncludeOtherContext",CONSTANT_CONSTRAINTS:"Constraints",CONSTANT_SYMMETRIC:"Symmetric",CONSTANT_REFERENCE_PHYSICAL_ID:"SubstituteReferencePhysicalId",CONSTANT_SYMMETRIC_EXCHANGE:"fonticon fonticon-exchange",CONSTANT_PRODUCT_ICON:"fonticon fonticon-product",CONSTANT_STATUS:"AlternateQualificationStatus",CONSTANT_NOT_APPLICABLE:"Not Applicable",CONSTANT_CURRENT:"current",CONSTANT_PROPOSED:"Proposed",CONSTANT_QUALIFIED:"Qualified",CONSTANT_CHANGE_ATTACHED:"ChangeActionProposed",CONSTANT_OBSOLETE:"Obsolete",CONSTANT_APPROVE:"Approve",CONSTANT_REMOVE:"Remove",CONSTANT_STRICT:"Strict",CONSTANT_REJECTED:"Rejected",BUTTON_ADD:"Add",BUTTON_CANCEL:"Cancel",BUTTON_OK:"Ok",BUTTON_SAVE:"SaveAll",CONSTANT_TITLE:"Title",KEY_CONSTANT_TYPEREPRESENTATION:"typeRepresentation",CONSTANT_SEPERATOR:"--\x3e",CONSTANT_CONTEXT:"Context",CONSTANT_DS_LABEL:"ds6w:label",CONSTANT_DS_REVISION:"ds6wg:revision",CONSTANT_REVISION:"revision",CONSTANT_PARTNUMBER:"PartNumber",CONSTANT_NONE:"None",CONSTANT_ALTERNATE_TOOLBAR_ADD_CMD:"Add",CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD:"AddToChange",CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD:"Remove",CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD:"Approve",CONSTANT_ALTERNATE_TOOLBAR_OBSELETE_CMD:"Obselete",CONSTANT_ALTERNATE_TOOLBAR_GROUP_BY:"GroupBy",CONSTANT_ALTERNATE_TOOLBAR_SWITCH_VIEW_CMD:"SwitchView",CONSTANT_ALTERNATE_TOOLBAR_MAKE_APPLICABLE_CMD:"MakeApplicable",CONSTANT_ALTERNATE_TOOLBAR_MULTISELECT_CMD:"MultiSelect",CONSTANT_APPLICABILTY:"Applicability",CONSTANT_SPLIT:"InstanceSplitApplicability",CONSTANT_YES:"Yes",CONSTANT_NO:"No",ERROR:"error",SUCCESS:"success",CONSTANT_ACTION:"status",CONSTANT_TEXT_PRIMARY_ITEM:"primaryitem",CONSTANT_CONTEXT_COUNT:"contextCount",CONSTANT_AUTOCOMPLETE_SEARCH_TITLE:"Select Engineering Item",CONSTANTS_KEY_ICONS:"icons",CONSTANTS_ICON:"icon",CONSTANTS_ICON_NAME:"Icon_Name",CONSTANTS_THUMNAIL_NAME:"Thumbnail_2d_Name",CONSTANTS_KEY_TITLE:"Title",CONSTANTS_THUMNAIL:"thumbnail",CONSTANT_PARENT_ITEM_KEY:"parentItem",CONSTANT_INSTANCE_NAME_KEY:"instanceName",CONSTANT_OPERATION_KEY:"Operation",CONSTANT_COLUMN_ALTERNATE_KEY:"Alternate",CONSTANT_OPERATION_KEY_VALUE_ALTERNATE:"Alternate",CONSTANT_OPERATION_KEY_VALUE_INSTANCE_SUB:"InstanceSubstitute",CONSTANT_OTHER_CONTEXT_KEY:"OtherContexts",CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS:"SameStatusExistsInOtherContexts",CONSTANT_KEY_PHYSICALID:"physicalid",CONSTANT_KEY_ID:"id",CONSTANT_KEY_TYPE:"type",CONSTANT_KEY_REFERENCE_IDS:"referenceIds",CONSTANT_KEY_TYPE_REF_FILTER:"type_filter_rel",CONSTANT_PARENT_CONTEXT_TITLE:"ParentContextTitle",CONSTANT_PARENT_CONTEXT_REVISION:"ParentContextRevision",CONSTANT_INSTANCE_CONTEXT_TITLE:"InstanceContextTitle",CONSTANT_CARRYOVER_ALTERNATE:"CarryOverAlternate",CONSTANT_CARRYOVER_SUBSTITUTE:"CarryOverSubstitute",CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS:"OtherContextsApplicableDataExists",CONSTANT_IS_NODE_EXPANDED:"isNodeExpanded",CONSTANT_OTHER_CONTEXT_APPLICABLE_ALTERNATE_REF_PHYSICALD:"OtherContextsApplicableAlternateRefIDS",CONSTANT_SELECTED_PRIMARY_ITEM_DIFFERENT_LOGICALID:"multipleLogicalID",CONSTANT_ALTERNATE_USAGE_POPUP_NOT_APPLICABLE_NAVIGATION:"notApplicableAlternate",CONSTANT_BASIC_ALTERNATE_ATTRIBUTES:"alternateBasicAttributes",CONSTANT_SAME_CONSTANT_ALTERNATES:"sameContextAlternteItems",CONSTANT_USER_SELECTED_INSTANCE_ID:"UserSelectedInstancePhysicalId",CONSTANT_USER_SELECTED_PRIMARY_ITEM_REVISION_IDS:"UserSelectedPrimaryItemRevisionList",CONSTANT_ALTERNATE_FILTER_PARAMS:"alternateFilterParams",CONSTANT_ALTERNATE_GROUPBY_OPTIONS:"alternateGroupByOptions",CONSTANT_ALTERNATE_SUGGESTION_FILTER:"alternateSuggestionFilterParams",CONSTANT_PROPOSE_FOR:"Proposefor",CONSTANT_PROPOSE_FOR_INSTANCE:"ProposeforInstance",CONSTANT_PROPOSE_FOR_REFERENCE:"ProposeforReference",CONSTANT_PROPOSE_FOR_ALL:"ProposeforAll",CONSTANT_CONTEXT_SEPARATOR:"  |  ",KEY_CONSTANT_MODEL_ID:"ModelPhysicalId",SUPPORTED_ALTERNATE_COUNT_ONPREMISE:200,SUPPORTED_ALTERNATE_COUNT_ONCLOUD:30,CONSTANT_ICON_SPLIT:"clock",CONSTANT_ICON_PROPOSED:"clock",CONSTANT_ICON_QUALIFIED:"status-ok",CONSTANT_ICON_OBSOLETE:"block",CONSTANT_ICON_WARNING:"attention",CONSTANT_ICON_NOT_APPLICABLE:"status-ko",CONSTANT_ICON_POINTER_DOWN:"expand-down",CONSTANT_ICON_POINTER_RIGHT:"expand-right",CONSTANT_PRODUCT_CUSTOMDIV_ICON:"product productIcon",CONSTANT_ICON_SPLIT_CLASS:"statusSplit",CONSTANT_ICON_PROPOSED_CLASS:"statusProposed",CONSTANT_ICON_QUALIFIED_CLASS:"statusQualified",CONSTANT_ICON_REJECTED_CLASS:"statusRejected",CONSTANT_ICON_SYMMETRIC_CLASS:"symmetricIcon",CONSTANT_ICON_OBSOLETE_CLASS:"statusObsolete",CONSTANT_ICON_OBSOLETE_WUC_CLASS:"statusObsoleteWUC",CONSTANT_ICON_WARNING_CLASS:"statusattention",CONSTANT_DATAGRID_COLUMN_TITLE:"Title",CONSTANT_DATAGRID_COLUMN_REVISION:"revision",CONSTANT_DATAGRID_COLUMN_STATUS:"Status",CONSTANT_WORK_UNDER_CHANGE:"WorkUnderChangeActionPhyId",CONSTANT_DATAGRID_USAGE_SCOPE:"UsageScope",CONSTANT_DATAGRID_COLUMN_CHANGE:"ActiveChange",CONSTANT_DATAGRID_PART_NUMBER:"PartNumber",CONSTANT_DATAGRID_MATURITY_STATE:"AlternateItemCurrentState",CONSTANT_DATAGRID_COLUMN_HAS_CONFIG_CONTEXT:"HasConfigContext",CONSTANT_DATAGRID_LABEL:"label",CONSTANT_DATAGRID_MODEL:"HasConfigContext",CONSTANTS_TRUE:"true",CONSTANTS_URL:"url",CONSTANT_DATAGRID_AVAILABLE_CONTEXT:"AvaiableContexts",CONSTANT_DATAGRID_COLUMN_SOURCE:"Source",CONSTANT_DATAGRID_COLUMN_USAGE_COUNT:"UsageCount",CONSTANT_SUGGESTION_SELECT_USAGE:"SelectUsage",CONSTANT_SUGGESTION_COLUMN_MATURITY_STATUS:"SuggestionMaturity",CONSTANT_SUGGESTION_COLUMN_REVISION:"SuggestionRevision",CONSTANT_SUGGESTION_COLUMN_STATUS:"SuggestionStatus",CONSTANT_DATAGRID_PRIMARY_USAGE_SCOPE:"PrimaryUsageScope",CONSTANT_USAGE_COLUMN_PRIMARY_ITEM_REVISION:"PrimaryItemRevision",CONSTANT_TILE_AVAILABLE_CONTEXT:"AvaiableContexts",RELATIONSHIP_ALTERNATE_ITEM:"Alternate Item",RELATIONSHIP_ALTERNATE_OF:"Alternate Of",PHYSICAL_ID:"physicalid",DS6W_LABEL:"ds6w:label",DS6W_DESCRIPTION:"ds6w:description",DS6W_IDENTIFIER:"ds6w:identifier",DS6W_TYPE:"ds6w:type",DS6W_REVISION:"ds6wg:revision",DS6W_PARTNUMBER:"ds6wg:EnterpriseExtension.V_PartNumber",ALTERNATE_STATUS:"ALTERNATE_STATUS",OTHER_USAGE_ALTERNATE_STATUS_INFO:"OtherUsageStatusInfo",CONTEXT_SCOPE:"ContextScope",Operation_InstanceSubstitute:"InstanceSubstitute",Operation_ReferenceSubstitute:"ReferenceSubstitute",Operation_Alternate:"Alternate",UserSelectedInstanceTitle:"UserSelectedInstanceTitle",UserSelectedContextRevisionInformation:"UserSelectedContextRevisionInformation",UserSelectedContextParentPhysicalId:"UserSelectedContextParentPhysicalId",UserSelectedInstanceLogicalId:"UserSelectedInstanceLogicalId",UserSelectedContextApplicableParentPhysicalIds:"UserSelectedContextApplicableParentPhysicalIds",USER_SELECTED_CONTEXT_CONFIGURED_PRODUCT:"UserSelectedContextConfiguredProduct",APPLICABILITY_YES:"Yes",SPLIT_YES:"Yes",CONTEXTS:"Contexts",APPLICABILITY_NO:"No",SPLIT_NO:"No",SYMETRIC_NO:"No",OPERATION:"Operation",NOT_APPLICABLE:"Not Applicable",Element_1_PhysicalId:"Element_1_PhysicalId",Element_1_LogicalId:"Element_1_LogicalId",Element_2_PhysicalId:"Element_2_PhysicalId",Element_2_LogicalId:"Element_2_LogicalId",Element_3_PhysicalId:"Element_3_PhysicalId",Element_3_LogicalId:"Element_3_LogicalId",Element_2_type:"Element_2_type",Element_3_type:"Element_3_type",Constant_Products:"Products",Constant_VPMInstance:"VPMInstance",VALUE_QUANTITY_VIEW:"value-quantity-view",VALUE_MFG_VIEW:"ManufacturableView",VALUE_QUALIFIED_AS_FINAL_COMPONENT:"value_qualified_as_final_component",QUALIFIED_AS_FINAL_CMD:"QualifiedAsFinal",LEAF_MATERIALS_CMD:"LeafMaterials",CONSTANT_PARENT_CONTEXT_PHYSICALID:"ParentContextPhysicalid",CONSTANT_PARENT_CONTEXT_LOGICALID:"ParentContextLogicalid",CONSTANT_INSTANCE_CONTEXT_PHYSICALID:"InstanceContextPhysicalid",CONSTANT_INSTANCE_CONTEXT_LOGICALID:"InstanceContextLogicalid",CONSTANT_CONFIG_CONTEXT_PHYSICALID:"ConfigContextPhysicalId",CONSTANT_STATUS_ICON_CLASS:"StatusIconClass",TYPE_VPMREFERENCE:"VPMReference",EVENT_LAUNCH_COMMAND:"show-light-component",OPEN_ENG_ITEM:"OpenProduct",MATURITY_GRAPH_CMD:"MaturityHdr",RELATEDOBJECTS_CMD:"RelatedObjectsHdr",CONSTANT_INDEX_MODE_INPUT_PHYSICAL_IDS:"input_physical_ids",CONSTANT_INDEX_MODE_INPUT_LABEL:"label",CONTEXT_GRIDVIEW_SELCTION_COLUMN_TITLE:"Title",CONTEXT_GRIDVIEW_SELCTION_COLUMN_REVISION:"Revision",CONTEXT_GRIDVIEW_SELCTION_COLUMN_INSTANCE_NAME:"InstanceName",CONTEXT_GRIDVIEW_SELCTION_COLUMN_PARTNUMBER:"PartNumber",CONTEXT_GRIDVIEW_SELECTION_OPTIONS_LABEL_KEY:"ds6w:label",CONTEXT_GRIDVIEW_SELECTION_OPTIONS_REVISION_KEY:"ds6wg:revision",CONTEXT_GRIDVIEW_SELECTION_OPTIONS_PHYSICALID_KEY:"physicalid",CONTEXT_GRIDVIEW_SELECTION_OPTIONS_INSTANCEID_KEY:"instanceId",CONTEXT_GRIDVIEW_SELCTION_COLUMN_PARTNUMBER_KEY:"ds6wg:EnterpriseExtension.V_PartNumber",CONSTANT_AUTHORING_MODE:"authoring",CONSTANT_INDEX_MODE:"index",CONSTANT_USE_ONLY_DB:"use_only_DB",CONSTANT_AUTHORING_MODE_INFO:"Alternate_Facet_Authoring_Mode",CONSTANT_INTERVAL_TO_SWITCH:"intervalToSwitchMode",CONSTANT_ALTERNATE_VIEW_DATAGRID:"AlternateDataGridView",CONSTANT_SELECTED_INSTANCE_INFO:"selectedRelIds",CONSTANT_ALTERNATE_VIEW_TILES:"AlternateTilesView",TOOLBAR_SWITCH_VIEW:"enox-alternate-toolbar-switch-view-activated",RMB_EVENT_HANDLER:"enox-alternate-rmb-event",MULTI_SELECT_ENABLE_DISABLE_MAKE_APPLICABLE_CMD:"enox-alternate-toolbar-enable-disable-make-applicable-cmd",HIDE_SHOW_MAKE_APPLICABLE_CMD:"enox-alternate-toolbar-hide-show-make-applicable-cmd",MULTI_SELECT_ICON_UPDATE:"enox-alternate-toolbar-multiselect-icon-update",CONSTANT_RMB_CMD_OPEN:"open",CONSTANT_RMB_CMD_PROPOSE_FOR:"proposeFor",CONSTANT_RMB_CMD_QUALIFY:"qualify",CONSTANT_RMB_CMD_MANAGE_USAGES:"manageUsages",CONSTANT_RMB_CMD_MATURITY:"maturity",CONSTANT_RMB_CMD_RELATED_OBJECTS:"relatedObjects",CONSTANT_RMB_CMD_REMOVE:"remove",CONSTANT_RMB_CMD_OBSELETE:"obselete",CONSTANT_ENG_ITEM_LABEL:"ds6w:label",CONSTANT_ENG_ITEM_REVISION:"ds6wg:revision",CONSTANT_ENG_ITEM_INSTANCE:"ds6w:label-Instance",CONSTANT_DUPLICATE_IDS:"DuplicateIDs",CONSTANT_REVISION_IDS:"RevisionIDs",CONSTANT_BRANCH_IDS:"BranchIds",CONSTANT_BRANCH_FROM_IDS:"BranchFromIDs",CONSTANT_PREVIOUS_REVISION_IDS:"PreviousRevisionIDs",CONSTANT_OTHER_USAGE_IDS:"OtherUsageIDs",CONSTANT_SUGGESTION_DUPLICATE:"Duplicate",CONSTANT_SUGGESTION_REVISION:"Revision",CONSTANT_SUGGESTION_BRANCH:"Branch",CONSTANT_SUGGESTION_BRANCH_FROM:"BranchFrom",CONSTANT_SUGGESTION_PREVIOUS_REVISION:"PreviousRevision",CONSTANT_SUGGESTION_OTHER_USAGE:"OtherUsage",CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE:"AlternatesOfAlternate",CONSTANT_SUGGESTION_APPLICABLE_ALTERNATE:"primaryAlternates",CONSTANT_ALTERNATE_SUGGESTIONS_GROUPBY_OPTIONS:"alternateSuggestionsGroupByOptions",CONSTANT_SUGGESTION_CHANGE_USAGE:"ChangeUsage",CONSTANT_PRIMARY_ITEM_TITLE:"PrimaryItemTitle",CONSTANT_PRIMARY_ITEM_REVISION:"PrimaryItemRevision",CONSTANT_ALTERNATE_ITEM_TITLE:"AlternateItemTitle",CONSTANT_ALTERNATE_ITEM_REVISION:"AlternateItemRevision",CONSTANT_SUGGESTION_SOURCE_TITLE:"Title",CONSTANT_SUGGESTION_COLUMN_INFO:"SuggestionColumnInfo",CONSTANT_SUGGESTION_USAGE_COLUMN_INFO:"ColumnsOfUsageInfoPopup",CONSTANT_SUGGESTION_USAGE_COLUMN_OPTIONS:"ColumnsOptionsForUsageInfoPopup",CONSTANT_SUGGESTION_COLUMN_OPTIONS:"ColumnsOptionsForSuggestionPopup",CONSTANT_SUGGESTION_SETTINGS_COLUMN_OPTIONS:"ColumnsOptionsForSuggestionSettings",CONSTANT_SUGGESTION_SETTINGS_DATA:"AlternateSuggestionSettingsData",CONSTANT_SUGGESTION_FIND:"Find",CONSTANT_SUGGESTION_REVISION_EXPLORER:"RevisionExplorer",CONSTANT_SELECT_USAGE_ALL:"All Usage",CONSTANT_SELECT_USAGE_INSTANCE:"Selected Instance",CONSTANT_SELECT_USAGE_REFERENCE:"All Instance",CONSTANT_SUGGESTION_SOURCE_SETTINGS:"Alternate_Sugg_Source_Settings",CONSTANT_SUGGESTION_SETTINGS:"Settings",SHOW_HISTORY_CMD:"HistoryHdr",CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID:"alternate_primary_item_physical_id",CONSTANT_SUGGESTION_CUSTOM_TYPE_USAGE:"Usages",CONSTANT_SUGGESTION_CUSTOM_TYPE_OTHERVIEWS:"OtherViews",CONSTANT_SUGGESTION_CUSTOM_TYPE_REFERENCEVIEW:"referenceView",CONSTANT_SUGGESTION_CUSTOM_TYPE_OTHERUSAGES:"OtherUsages",CONSTANT_PROPERTIES_OBJECT_ID:"objectId",CONSTANT_PROPERTIES_TENANT_ID:"tenant",CONSTANT_SUGGESTION_VERSION_GRAPH_COPYFROM:"copyFrom",CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS:"ancestors",CONSTANT_SUGGESTION_VERSION_GRAPH_DERIVEDFROM:"V_DerivedFrom",CONSTANT_SUGGESTION_VERSION_GRAPH_VERSIONS:"versions",CONSTANT_SUGGESTION_VERSION_GRAPHS:"graphs",CONSTANT_SUGGESTION_VERSION_GRAPH_ID:"id",CONSTANT_SUGGESTION_VERSION_GRAPH_VID:"vid",CONSTANT_VERSION_GRAPH_ATTRIBUTES:"versionGraphAttributes",CONSTANT_SUGGESTION_VERSION_GRAPH_PAYLOAD:"graphRequests",CONSTANT_SUGGESTION_VERSION_GRAPH_PAYLOAD_ID:"id",CONSTANT_VERSION_GRAPH_PAYLOAD_ATTRIBUTE:"attributes",CHANGE_OWNER_CMD:"ActionBar_ChangeOwner",CONSTANT_CARRYOVER_ALT_REF_PHYSICALID:"AlternateReferencePhysicalId",CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD:"CarryOverFromRevisionsCommand",CONSTANT_CARRYOVER_ALTERNATES_COLUMNS_INFO:"CarryOverAlternatesColumnsInfo",CONSTANT_CARRYOVER_FROM_REVISION_EXPLORER:"CarryOverFromRevisionExplorer",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_OPTIONS:"ColumnsOptionsForCarryOverAlternatesPopup",CONSTANT_CARRYOVER_ALTERNATE_REVISIONS_COLUMN_OPTIONS:"ColumnsOptionsForCarryOverAlternateRevisionsPopup",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_REVISIONS_TITLE:"RevisionsTitle",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_TITLE:"AlternatesTitle",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_TITLE_DATAINDEX:"Title",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PART_NUMBER:"EnterpriseExtension.V_PartNumber",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY:"Maturity",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PRIMARY_ITEM_TITLE:"PrimaryItemTitle",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE:"InstanceTitle",CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_STATUS:"AlternateStatus",CONSTANT_CARRYOVER_REVISIONS_COLUMN_INFO:"CarryOverRevisionsColumnInfo",CONSTANT_CARRYOVER_REVISION_COLUMN_MATURITY_NLS:"maturity_nls",CONSTANT_CARRYOVER_REVISION_COLUMN_MODIFICATION_DATE:"modification",CONSTANT_CARRYOVER_REVISION_COLUMN_CREATION_DATE:"creation",CONSTANT_CARRYOVER_REVISIOND_COLUMN_DISCRIPTION:"description",CONSTANT_CARRYOVER_PARENT_PRODUCTS_PHYSICAL_ID:"parentProductPhysicalId",CONSTANT_CARRYOVER_SOURCE_PRODUCTS_PHYSICAL_ID:"sourceProductPhysicalId",CONSTANT_CARRYOVER_DEST_PRODUCTS_PHYSICAL_ID:"destProductPhysicalId",CONSTANT_CARRYOVER_REVISION_SEMANTIC:"E",CONSTANT_CARRYOVER_LIMIT:50}}),define("DS/ENOXAlternateSubstitute/components/AlternateFilter",["DS/TreeModel/BaseFilter"],function(e){return e.inherit({publishedProperties:{},isDataFiltered:function(e){if(this.isEmpty())return!1;var t=e.getAttributeValue(this.propertyId);return!(!this.filterModel||!this.filterModel.allowedRoles)&&-1===this.filterModel.allowedRoles.indexOf(t)},isEmpty:function(){return void 0===this.filterModel.allowedRoles||0==this.filterModel.allowedRoles.length}})}),define("DS/ENOXAlternateSubstitute/services/AlternateSettingsManager",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Controls/Abstract","DS/WebappsUtils/WebappsUtils","DS/ENOXEngineerCommonUtils/XENPlatform3DXSettings","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","text!DS/ENOXAlternateSubstitute/assets/config/AlternateManagement.conf.json"],function(e,t,n,a,i,o,r,s,l,T){"use strict";var A=JSON.parse(T);return t.singleton(n,o,{initialize:function(e){this.altAppCore=e},getCommand:function(t){return e.is(t,"string")&&e.is(A.commands[t])?A.commands[t]:null},getConfiguration:function(t){return e.is(t,"string")&&e.is(A[t])?A[t]:null},getSecurityContext:function(){return widget&&widget.getValue&&widget.getValue("SC")?widget.getValue("SC"):this._preferredSC},getTenant:function(){return widget&&widget.getValue&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):this._platformId},getSmallIconPathFromIconSNResourceRepository:function(e){return this.getDefault3DSpaceUrl()+"/snresources/images/icons/small/"+e},getLargeIconPathFromIconSNResourceRepository:function(e){return this.getDefault3DSpaceUrl()+"/snresources/images/icons/large/"+e},getDefaultProductIcon:function(){return this.getDefault3DSpaceUrl()+"/snresources/images/icons/small/I_VPMNavProduct.png"},getDefaultProductThumbnail:function(){return i.getWebappsAssetUrl("ENOXEngineer","icons/32/I_VPMNavProduct108x144.png")},getChangeActionIcon:function(){return this.getDefault3DSpaceUrl()+"/snresources/images/icons/small/I_ECM_CA.png"},getCVRequestLabel:function(){return l.APP_NAME+"-"+this.getCurrentUser().id+"-"+(new Date).getTime()},isUsingDB:function(){if(this.altAppCore.appCore&&this.altAppCore.appCore.sessionManager&&this.altAppCore.appCore.sessionManager.isUsingDB)return this.altAppCore.appCore.sessionManager.isUsingDB();if(widget){var e=widget.getValue(l.CONSTANT_AUTHORING_MODE_INFO)?widget.getValue(l.CONSTANT_AUTHORING_MODE_INFO):null;if(!e)return!1;var t=(new Date).getTime();if(UWA.is(e.state,"string")&&UWA.is(e.last_editing,"number")){return e.state===l.CONSTANT_AUTHORING_MODE&&e.last_editing+18e4<t&&widget.setValue(l.CONSTANT_AUTHORING_MODE_INFO,{state:"index",last_editing:(new Date).getTime()}),!(e.last_editing+18e4<t)}}return!1},setAuthoringMode:function(e){if(this.altAppCore.appCore&&this.altAppCore.appCore.sessionManager&&this.altAppCore.appCore.sessionManager.setAuthoringMode)this.altAppCore.appCore.sessionManager.setAuthoringMode(e);else if(widget){var t={state:e,last_editing:(new Date).getTime()};widget.setValue(l.CONSTANT_AUTHORING_MODE_INFO,t)}},getWorkUnderHeaders:function(){return this.getAuthorizedChange(),this.authorizedChange&&this.authorizedChange.AuthoringContextHeader?Object.assign({},this.authorizedChange.AuthoringContextHeader):{}},getAuthorizedChange:function(){return this.authorizedChange=s.get(),this.authorizedChange},isChangeAuthorized:function(){var e=this.getAuthorizedChange().change&&this.getAuthorizedChange().change.id;return null!=e&&""!=e},_getUserPrefKey:function(e){return this.getPlatformId()+"_"+e}})}),define("DS/ENOXAlternateSubstitute/utils/AlternateHttpClient",["UWA/Core","DS/ENOXEngineerCommonUtils/XENGenericHttpClient","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXEngineerCommonUtils/XENCommonConstants"],function(e,t,n,a){"use strict";return Object.assign(e.clone(t,!0),{decorateWithAddtionnaloptions:function(e,t){t.noSecurityContextNeeded||t.targetService!==a.SERVICE_3DSPACE_NAME||(e.headers.SecurityContext=encodeURIComponent("ctx::"+n.getSecurityContext()),e.headers.SecurityToken=encodeURIComponent(n.getSecurityToken()))},buildChangeHeaders:function(e){return Object.assign(e,n.getWorkUnderHeaders())},buildUrl:function(e){var t=n.getServiceURL(e.targetService);return n.isTenantBasedService(e.targetService)?t=this.decorateUrlWithTenant(t+e.url):t+=e.url,e.sc_tenant_in_url&&(t=this.decorateUrlWithSecuritycontext(t)),e.queryParameters&&(t=this.decorateUrlWithQueryParameters(t,e.queryParameters)),t},decorateUrlWithTenant:function(e){var t=e||"",a=t.indexOf("?");return t=a>-1?t+"&tenant="+n.getPlatformId():t+"?tenant="+n.getPlatformId()},decorateUrlWithQueryParameters:function(e,t){if("string"==typeof e&&Array.isArray(t)){e+=`&${t.join("&")}`}return e},decorateUrlWithSecuritycontext:function(e){var t=n.getSecurityContext(),a=e||"";if(e&&t&&t.length>0){var i=a.indexOf("?");a=i>-1?a+"&SecurityContext="+encodeURIComponent("ctx::"+n.getSecurityContext()):a+"?SecurityContext="+encodeURIComponent("ctx::"+n.getSecurityContext())}return a}})}),define("DS/ENOXAlternateSubstitute/components/properties/js/AlternatePropertiesFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/UIKIT/Scroller","DS/EditPropWidget/facets/Common/FacetsBase","DS/Handlebars/Handlebars4","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","text!DS/ENOXAlternateSubstitute/components/properties/html/AlternateProperties.html","css!DS/ENOXAlternateSubstitute/components/properties/css/AlternateProperties.css"],function(e,t,n,a,i,o,r,s,l,T,A,N,_){"use strict";var S={};return S[A.CONSTANT_PROPOSED]="eng.alternate.status.proposed",S[A.CONSTANT_QUALIFIED]="eng.alternate.status.qualified",S[A.CONSTANT_OBSOLETE]="eng.alternate.status.obsolete",t.extend(n,i,{init:function(t){this._parent(t);this.elements.container||(this.elements.container=e.createElement("div",{class:"alternatePropertiesFacet"}))},getProvidedSC:function(){if(!T.getSecurityContext)return null;var e=T.getSecurityContext();return e?(e.startsWith("ctx::")&&(e=e.substring(5)),e):null},_buildView:function(t){var n=this;console.log("update facet"),n.wrapper=e.createElement("div",{class:"alternateSubstitute-content"}),n.elements.container.appendChild(n.wrapper);var i=!this.getProvidedSC(),s=T.getTenant();s&&"string"==typeof s&&T.setPlatformId(s),T.bindCommandsToABackend(i).then(function(){n.getAlternateProperties().then(function(e){if(e.hasOwnProperty(A.ERROR))r.errorAlert(e.response);else if(e.status==A.SUCCESS){var t=n.parseResponse(e),i=o.compile(_);n.wrapper.setHTML(i({attribute:t})),new a({element:n.wrapper}).inject(n.elements.container)}})}).catch(function(e){console.error(e),r.errorAlert(N.get("error.contact.admin"))})},parseResponse:function(e){for(var t=[],n=e.AlternateItemInfo,a=0;a<n.length;a++){var i={};i.label=N.get("eng.alternate.properties.primaryItem"),i.value=n[a].PrimaryItemTitle+" "+n[a].PrimaryItemRevision;var o={};o.label=N.get("eng.alternate.properties.alternateItem"),o.value=n[a].AlternateItemTitle+" "+n[a].AlternateItemRevision;var r={};r.label=N.get("eng.alternate.properties.usageDetails"),n[a][A.CONSTANT_PARENT_CONTEXT_TITLE]?n[a][A.CONSTANT_INSTANCE_CONTEXT_TITLE]?n[a][A.CONSTANT_PARENT_CONTEXT_TITLE]&&n[a][A.CONSTANT_INSTANCE_CONTEXT_TITLE]&&(r.value=N.get("eng.alternate.properties.usageDetails.instance").replace("$1",n[a][A.CONSTANT_INSTANCE_CONTEXT_TITLE]).replace("$2",n[a][A.CONSTANT_PARENT_CONTEXT_TITLE]).replace("$3",n[a][A.CONSTANT_PARENT_CONTEXT_REVISION])):r.value=N.get("eng.alternate.datagrid.column.usage.reference")+" "+n[a][A.CONSTANT_PARENT_CONTEXT_TITLE]+" "+n[a][A.CONSTANT_PARENT_CONTEXT_REVISION]:r.value=N.get("eng.alternate.usage.all");var s={};s.label=N.get("eng.alternate.properties.maturityState"),s.value=N.get(S[n[a][A.CONSTANT_STATUS]]),t.push(i),t.push(o),t.push(r),t.push(s)}return t},getAlternateProperties:function(){var e=T.getCommand("alternate_properties");e.url=e.url;var t={};return model&&(t[A.CONSTANT_ALT_REF_PHYSICALID]=[model.get("objectId")]),l.wrappedWithCancellablePromise(function(n,a){s.perform(e,t).then(function(e){return n(e)}).catch(function(e){n(e)})})},updateFacet:function(e){this._buildView(e)},destroyComponent:function(){console.warn("destroyComponent called")},onResize:function(){console.warn("onResize")},onRefresh:function(){},onAction:function(e){},isActionAvailable:function(e){}})}),define("DS/ENOXAlternateSubstitute/facets/AlternateFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/EditPropWidget/facets/Common/FacetsBase","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants"],function(e,t,n,a,i,o,r,s){"use strict";return t.extend(n,a,{init:function(t){this._parent(t);this.elements.container||(this.elements.container=e.createElement("div",{class:"alternateSubstitute"})),this.appCore=this.options.appContext},_buildView:function(){var e,t=this;if(t.modid){if(!(e=t.getModel()))return!1;if(t.modid==e.get("objectId"))return}if(!t._alternateView){var n=o.getCommand("getUserSelectedPrimaryItemConfigurations"),a={};n=o.getCommand("getUserSelectedPrimaryItemConfigurations"),a={};r.perform(n,"").then(function(e){a=e}).finally(function(){require(["DS/ENOXAlternateSubstitute/commands/AlternateFacetContentBuilder"],function(e){t._alternateView=new e({readOnly:t.options.readOnly,model:t.getModel(),appCore:t.options.appContext,activeEngItemTreeInfo:t.getXenTreeInfo(),viewInfo:t.getViewInfo(),alternateManagementConfigurations:a,altfacetContainer:widget.body}),t._alternateView.elements.container.inject(t.elements.container),t._alternateView.resizeToolbar(),t.refreshFacetView()})})}},getViewInfo:function(){var e={};this.appCore&&this.appCore.localStorage&&(e._isReferenceView=this.appCore.localStorage.getItem(s.VALUE_QUANTITY_VIEW),e._isFlatennedView=!(this.appCore.localStorage.getItem(s.VALUE_QUALIFIED_AS_FINAL_COMPONENT)!=s.QUALIFIED_AS_FINAL_CMD&&this.appCore.localStorage.getItem(s.VALUE_QUALIFIED_AS_FINAL_COMPONENT)!=s.LEAF_MATERIALS_CMD&&!this.appCore.localStorage.getItem(s.VALUE_MFG_VIEW)),e._isFlatView=!!(this.appCore&&this.appCore.sessionManager&&this.appCore.sessionManager.shouldShowFlatView&&this.appCore.sessionManager.shouldShowFlatView())&&this.appCore.sessionManager.shouldShowFlatView());var t=this.getXENTreeDoc(),n=t&&t.getSelectedNodes()&&t.getSelectedNodes()[0].getTreeDocument?t.getSelectedNodes()[0].getTreeDocument():null;return e._isGroupByView=n&&n.isViewGrouped?n.isViewGrouped():null,e._isReferenceOrFlattenedORGroupView=!!(e._isReferenceView||e._isFlatennedView||e._isGroupByView),e._isReferenceORGroupView=!(!e._isReferenceView&&!e._isGroupByView),e},getXENTreeDoc:function(){return this.appCore&&this.appCore.contextManager&&this.appCore.contextManager.getXENTreeDocument()?this.appCore.contextManager.getXENTreeDocument():null},getXenTreeInfo:function(){var e={},t=this.getXENTreeDoc();e._selectedNodeId=t&&t.getSelectedNodes()&&t.getSelectedNodes()[0]?t.getSelectedNodes()[0].getID():null,e._selectedNodes=t&&t.getSelectedNodes()?t.getSelectedNodes():null,e._parentNode=this.appCore&&this.appCore.contextManager&&this.appCore.contextManager.getActiveEngItem()?this.appCore.contextManager.getActiveEngItem():e._selectedNodes?e._selectedNodes[0]:null,e._parentId=t&&t.getRoots()&&t.getRoots()[0]?t.getRoots()[0].getID():null,this.appCore.sessionManager&&this.appCore.sessionManager.shouldShowQuantityView&&this.appCore.sessionManager.shouldShowQuantityView()&&this.appCore.Factories&&e._selectedNodes[0]instanceof this.appCore.Factories.ListItemFactory.getReferenceClass()?(e._parentNode=e._selectedNodes[0].getRealParent().getID()&&""!=e._selectedNodes[0].getRealParent().getID()?e._selectedNodes[0].getRealParent():e._parentNode,e._parentId=e._parentNode&&e._parentNode.getID()?e._parentNode.getID():e._parentId):this.appCore.Factories&&e._selectedNodes[0]instanceof this.appCore.Factories.ListItemFactory.getListInstanceClass()&&(e._parentNode=e._selectedNodes[0].getParent()instanceof this.appCore.Factories.ListItemFactory.getListInstanceClass()?e._selectedNodes[0].getParent():this.appCore.contextManager.getActiveEngItem(),e._parentId=e._parentNode.getID());var n=e._parentNode&&e._parentNode.getPreferedAttachedConfigModel?e._parentNode.getPreferedAttachedConfigModel():null;return e._configModelVersionID=null!=n&&n._options.preferedVersion?n._options.preferedVersion.id:null,e},updateFacet:function(){var e=o.getTenant();return e&&"string"==typeof e&&o.setPlatformId(e),this._alternateView?this.refreshFacetView():this._buildView(),this.elements.container},checkIfSameInstance:function(e){var t=!0,n=e[0].getID(),a=e[0].getParent&&e[0].getParent()?e[0].getParent().getID&&e[0].getParent().getID():"";return e.forEach(function(e){var i=e.getParent&&e.getParent()?e.getParent().getID&&e.getParent().getID():"";if(e.getID()!=n||a!=i)return t=!1}),t},refreshFacetView:function(){var e=(t=this).appCore.contextManager.getXENTreeDocument().getSelectedNodes();if(0==e.length)console.error("Wrong number of selected object "+e.length);else if(e.length>1&&!t.checkIfSameInstance(e))console.error("Multiple selection not allowed"+e.length),this._alternateView.notApplicable("multipleSelection");else if(e[0].isEngineeringItem()){var t;(t=this)._alternateView.options.activeEngItemTreeInfo=t.getXenTreeInfo(),t._alternateView.options.viewInfo=t.getViewInfo(),t._alternateView.selectionModified(t._alternateView.options.activeEngItemTreeInfo._selectedNodes,t._alternateView.options.activeEngItemTreeInfo._parentNode,t._alternateView.options.activeEngItemTreeInfo._selectedNodeId)}else this._alternateView.notApplicable("notSupported")},destroyComponent:function(){e.is(this.destroy,"function")&&this.destroy()}})}),define("DS/ENOXAlternateSubstitute/utils/AlternateDataParser",["UWA/Class","UWA/Core","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/ExpandPayloadFactory","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i,o){return e.singleton({addIsApplicableData:function(e,t,n,a){var o=e[i.CONSTANT_ALT_ID];t[o]?t[o][i.CONSTANT_PARENT_CONTEXT_LOGICALID]==e[i.CONSTANT_PARENT_CONTEXT_LOGICALID]&&t[o][i.CONSTANT_INSTANCE_CONTEXT_LOGICALID]==e[i.CONSTANT_INSTANCE_CONTEXT_LOGICALID]?t[o][i.CONSTANT_STATUS]==i.CONSTANT_NOT_APPLICABLE?t[o]=e:e[i.CONSTANT_STATUS]!=i.CONSTANT_NOT_APPLICABLE&&(n[o]?n[o].push(e):(n[o]=[e],n[o].push(JSON.parse(JSON.stringify(t[o]))))):e[i.CONSTANT_STATUS]!=i.CONSTANT_NOT_APPLICABLE&&(t[o][i.CONSTANT_STATUS]==i.CONSTANT_NOT_APPLICABLE?t[o]=e:n[o]?n[o].push(e):(n[o]=[e],n[o].push(JSON.parse(JSON.stringify(t[o]))))):t[o]=e},mergeItemsOnAlternateCriteria:function(e,t){var n=this,a=[],o={},r=[],s={},l={},T={};return e.forEach(function(e){var a=this.appInfo.altAppCore;data=n.basicOptionsBuilder(e,a);var T=data[i.CONSTANT_ALT_ID];data[i.CONSTANT_APPLICABILTY]==i.APPLICABILITY_YES||data[i.CONSTANT_SPLIT]==i.SPLIT_YES?data[i.CONSTANT_OPERATION_KEY]==i.Operation_Alternate?s[T]=data:n.addIsApplicableData(data,o,r,l):(this.appInfo.hasAlternatesInOtherContexts=!0,t&&(l.hasOwnProperty(T)?l[T].push(data):l[T]=[data]))}),Object.keys(s).forEach(function(e){n.createStatusObj(s[e],T)}),Object.keys(o).forEach(function(e){r.hasOwnProperty(e)&&(o[e][i.CONSTANT_OTHER_CONTEXT_KEY]=r[e],o[e][i.CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS]=!0,o[e][i.CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS]=n.checkIfSameStatus(r[e],o[e][i.CONSTANT_STATUS]),delete r[e]),l.hasOwnProperty(e)&&(o[e][i.CONSTANT_OTHER_CONTEXT_KEY]?o[e][i.CONSTANT_OTHER_CONTEXT_KEY]=o[e][i.CONSTANT_OTHER_CONTEXT_KEY].concat(l[e]):(o[e][i.CONSTANT_OTHER_CONTEXT_KEY]=[JSON.parse(JSON.stringify(o[e]))],o[e][i.CONSTANT_OTHER_CONTEXT_KEY]=o[e][i.CONSTANT_OTHER_CONTEXT_KEY].concat(l[e])),delete l[e]),n.createStatusObj(o[e],T)}),a=n.changeOrderStatus(T),Object.keys(l).forEach(function(e){var t=JSON.parse(JSON.stringify(l[e][0]));t[i.CONSTANT_OTHER_CONTEXT_KEY]=JSON.parse(JSON.stringify(l[e])),a.push(t)}),a},createStatusObj:function(e,t){t.hasOwnProperty(e[i.CONSTANT_STATUS])?t[e[i.CONSTANT_STATUS]].push(e):t[e[i.CONSTANT_STATUS]]=[e]},checkIfSameStatus:function(e,t){for(var n in e)if(e[n][i.CONSTANT_APPLICABILTY]==i.APPLICABILITY_YES&&e[n].grid[i.CONSTANT_STATUS]!=t)return i.CONSTANT_NO;return i.CONSTANT_YES},changeOrderStatus:function(e){var t=[];return[i.CONSTANT_QUALIFIED,i.CONSTANT_PROPOSED,i.CONSTANT_OBSOLETE,i.CONSTANT_NOT_APPLICABLE].forEach(function(n){e[n]&&(t=t.concat(e[n]))}),t},basicOptionsBuilder:function(e,t){return this.updateNLSValues(e,t),this.Options=Object.assign({grid:{}},e),this._fillAttributes(e),this.Options},getDefaultIcon:function(e,t){let n=e[i.CONSTANTS_ICON_NAME];return n?t.altSettingsManager.getSmallIconPathFromIconSNResourceRepository(n):t.altSettingsManager.getDefaultProductIcon()},getDefaultIconThumbnail:function(e,t){let n=e[i.CONSTANTS_THUMNAIL_NAME];return n?t.altSettingsManager.getLargeIconPathFromIconSNResourceRepository(n):t.altSettingsManager.getDefaultProductThumbnail()},updateNLSValues:function(e,t){var n=t.altDataServices.getNlsOfPropertiesValues();e[i.CONSTANTS_ICON]=e[i.CONSTANTS_ICON]?e[i.CONSTANTS_ICON]:this.getDefaultIcon(e,t),e[i.CONSTANTS_THUMNAIL]=e[i.CONSTANTS_THUMNAIL]?e[i.CONSTANTS_THUMNAIL]:this.getDefaultIconThumbnail(e,t),e[i.CONSTANT_DATAGRID_MATURITY_STATE]=n["ds6w:status"][e[i.CONSTANT_DATAGRID_MATURITY_STATE]]},_fillAttributes:function(e){var t=this;return Object.keys(e).forEach(function(n){t.Options.grid[n]=e[n]}),this.Options},parseFetchedResult:function(e){var t=this,n=e.results,a=[];return n.forEach(function(e){a.push(t.attributesParser(e.attributes))}),a},attributesParser:function(e){for(var t={},n=0;n<e.length;n++)t[e[n].name]=e[n].value;return t},parseExpandResult:function(e){if(!e||!Array.isArray(e.results))throw new Error("Ouups ! invalid input");var n={nodes:{},paths:[],iconsSet:[]},a=this;return e.results.forEach(function(e){if(e.hasOwnProperty("attributes")){var i=a.attributesParser(e.attributes);t.is(i.did)&&(n.nodes[i.did]=i)}else e.hasOwnProperty("path")?n.paths.push(e.path):e.hasOwnProperty("icon__default_thumbnail_2d")&&(n.iconsSet=e.icon__default_thumbnail_2d)}),this.updateNodeWithIconsData(n),n},updateNodeWithIconsData:function(e){var t=e.iconsSet,n=e.nodes;Array.isArray(t)&&t.forEach(function(e){e.did.forEach(function(t){let a=n[t],i=e.icon;a.thumbnail=a.thumbnail?a.thumbnail:e.thumbnail_2d,a&&a.icons?a.icons.push(i):a.icons=[i]})})},parsedExpandV2Result:function(e){if(!e||!Array.isArray(e.results))throw new Error("Ouups ! invalid input");var t={nodes:{},paths:[],iconsSet:[]};return JSON.parse(JSON.stringify(e)).results.forEach(function(e){e.hasOwnProperty("Path")?t.paths.push(e.Path):(t.nodes[e.resourceid]=e,t.nodes[e.resourceid].physicalid=t.nodes[e.resourceid].resourceid,delete t.nodes[e.resourceid].resourceid)}),t},doExpand:async function(e,t,i){const{executor:o,payloadAlreadyConverted:r}=t||{};if(!o||!e)throw new Error("invalid inputs");const s=i.altAppCore.altSettingsManager.getCommand(o);if(!s)throw new Error(`unknow expand command executor ${o}`);const l=r?e:a.convertPayloadTo(e,o);if(!l)throw new Error("fails to convert payload");const T=[];let A=null;try{A=await n.perform(s,JSON.stringify(l))}catch(e){T.push(e)}return a.postTreatAnswer(A,o),A}})}),define("DS/ENOXAlternateSubstitute/views/AlternateItemModel",["UWA/Core","DS/TreeModel/TreeNodeModel","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a){function i(n){this.options={contextualMenu:[null],emptyStatusbarVisibleFlag:!0},this.options=e.extend(this.options,n),t.call(this,this.options)}return i.prototype=Object.create(t.prototype),i.prototype.getOtherContextAlternteItems=function(){return this.options.OtherContexts?this.options.OtherContexts:[]},i.prototype.getOnClickContextAlternateItems=function(){var e=[],t=this.getOtherContextAlternteItems(),a=this.options;a[n.CONSTANT_APPLICABILTY]!=n.CONSTANT_YES&&0!=t.length||e.push(a);for(var i=0;i<t.length;i++)e.push(t[i]);return e},i.prototype.getReferenceVersion=function(){return this.options.grid[n.CONSTANT_REVISION]},i.prototype.getType=function(){return n.TYPE_VPMREFERENCE},i.prototype.getID=function(){return this.options.grid[n.CONSTANT_ALT_ID]},i.prototype.getInterchangeabilityID=function(){return this.options.grid[n.CONSTANT_ALT_REF_PHYSICALID]},i.prototype.getInterchangeabilityTitle=function(){return this.options.grid[n.CONSTANT_ALT_REF_TITLE]},i.prototype.getPhysicalID=function(){return this.options.grid[n.CONSTANT_KEY_PHYSICALID]},i.prototype.getLabel=function(){return this.options.grid[n.CONSTANTS_KEY_TITLE]},i.prototype.getDisplayName=function(){return this.getLabel()+" "+this.getReferenceVersion()},i.prototype.getUuid=function(){return this.getID()},i.prototype.getAlternateTilesViewOrderedAttribute=function(){var e=[];e.push({attrName:n.CONSTANT_DATAGRID_MATURITY_STATE,attrNls:"eng.alternate.column.maturityState",attrLabel:"eng.alternate.label.maturityState"}),e.push({attrName:n.CONSTANT_PARTNUMBER,attrNls:"eng.alternate.column.partNumber",attrLabel:"eng.alternate.label.partNumber"});var t=this,i=[];return e.forEach(function(e){var n={};n.attrName=e.attrName,n.name=a.get(e.attrNls),n.attrLabel=a.get(e.attrLabel),n.value=t.options.grid[e.attrName],i.push(n)}),i},i.prototype.getTypeForVersionGraph=function(){return this.getType()},i.prototype.getIdForVersionGraph=function(){return this.getID()},i.prototype.getRevision=function(){return this.getReferenceVersion()},i.prototype.getTitle=function(){return this.getLabel()},i.prototype.getTypeActualName=function(){return this.getType()},i}),define("DS/ENOXAlternateSubstitute/views/AlternateGridViewManager",["UWA/Class","DS/DataGridView/DataGridView","DS/ENOXAlternateSubstitute/views/AlternateItemModel","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i){"use strict";return e.singleton({init:function(e){this._parent(e)},initialize:function(e){this.options=e},_columnConfiguration:function(e){var t=this,n=e.altSettingsManager.getCommand(a.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES).Alternate,i=[];return[a.CONSTANT_DATAGRID_COLUMN_TITLE,a.CONSTANT_DATAGRID_PART_NUMBER,a.CONSTANT_DATAGRID_COLUMN_REVISION,a.CONSTANT_DATAGRID_MATURITY_STATE,a.CONSTANT_DATAGRID_COLUMN_STATUS,a.CONSTANT_DATAGRID_USAGE_SCOPE,a.CONSTANT_DATAGRID_COLUMN_CHANGE].forEach(function(a){n.forEach(function(n){n.attrName===a&&t.getColumnConfiguration(n,i,e)})}),i},getColumnConfiguration:function(e,t,n){var o=this;switch(e.attrName){case a.CONSTANT_DATAGRID_COLUMN_TITLE:t.push({text:i.get(e.attrNls),dataIndex:"tree",width:e.width?e.width:"auto",pinned:e.pinned?e.pinned:"unpinned",alwaysVisibleFlag:a.CONSTANTS_TRUE,getCellValue:function(e){if(n.altItemFactory.checkIfHeaderNode(e.nodeModel)&&e.nodeModel.options.grid[a.CONSTANT_DATAGRID_COLUMN_TITLE]){var t=n.altItemFactory.getNodeCounterQuantity(e.nodeModel);return i.get("eng.alternate.header.title").replace("$1",e.nodeModel.options.grid[a.CONSTANT_DATAGRID_COLUMN_TITLE]).replace("$2",t)}return e.nodeModel.options.grid[a.CONSTANT_DATAGRID_COLUMN_TITLE]?e.nodeModel.options.grid[a.CONSTANT_DATAGRID_COLUMN_TITLE]:n.altItemFactory.getNlsOfGroupByTitle(e.nodeModel)},getCellValueAsStringForFind:function(e){if(e&&e.nodeModel)return e.nodeModel.options.grid[a.CONSTANT_DATAGRID_COLUMN_TITLE]?e.nodeModel.options.grid[a.CONSTANT_DATAGRID_COLUMN_TITLE]:n.altItemFactory.getNlsOfGroupByTitle(e.nodeModel)}});break;case a.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY:case a.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PRIMARY_ITEM_TITLE:case a.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PART_NUMBER:case a.CONSTANT_CARRYOVER_REVISION_COLUMN_MATURITY_NLS:case a.CONSTANT_CARRYOVER_REVISION_COLUMN_MODIFICATION_DATE:case a.CONSTANT_CARRYOVER_REVISION_COLUMN_CREATION_DATE:case a.CONSTANT_CARRYOVER_REVISIOND_COLUMN_DISCRIPTION:t.push({text:i.get(e.attrNls),dataIndex:e.dataIndex,width:e.width?e.width:"auto",pinned:e.pinned?e.pinned:"unpinned",allowUnsafeHTMLContent:a.CONSTANTS_TRUE,alwaysVisibleFlag:a.CONSTANTS_TRUE,getCellValue:function(t){return t.nodeModel.options.grid[e.dataIndex]}});break;case a.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_TITLE:case a.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_REVISIONS_TITLE:t.push({text:i.get(e.attrNls),dataIndex:"tree",width:e.width?e.width:"auto",pinned:e.pinned?e.pinned:"unpinned",alwaysVisibleFlag:a.CONSTANTS_TRUE,getCellValue:function(t){return t.nodeModel.options.grid[e.dataIndex]}});break;case a.CONSTANT_DATAGRID_COLUMN_STATUS:t.push({text:i.get(e.attrNls),dataIndex:e.attrName,sortableFlag:!1,width:e.width?e.width:"41px",allowUnsafeHTMLContent:a.CONSTANTS_TRUE,getCellValue:function(e){return n.altItemFactory.getValidStatus(e.nodeModel,!1).outerHTML}});break;case a.CONSTANT_USAGE_COLUMN_PRIMARY_ITEM_REVISION:case a.CONSTANT_SUGGESTION_COLUMN_MATURITY_STATUS:case a.CONSTANT_DATAGRID_COLUMN_REVISION:t.push({text:i.get(e.attrNls),dataIndex:e.dataIndex,width:e.width?e.width:"41px",getCellValue:function(t){return t.nodeModel.options.grid[e.dataIndex]}});break;case a.CONSTANT_SUGGESTION_COLUMN_REVISION:case a.CONSTANT_DATAGRID_COLUMN_USAGE_COUNT:case a.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE:case a.CONSTANT_DATAGRID_MATURITY_STATE:t.push({text:i.get(e.attrNls),dataIndex:e.dataIndex,width:e.width?e.width:"auto",typeRepresentation:"url",hyperlinkTarget:"_self",getCellValue:function(t){return{label:t.nodeModel.options.grid[e.dataIndex],url:"#UNEXISTANT_ID"}}});break;case a.CONSTANT_DATAGRID_PART_NUMBER:t.push({text:i.get(e.attrNls),dataIndex:e.attrName,width:e.width?e.width:"81px",getCellValue:function(e){return e.nodeModel.options.grid[a.CONSTANT_DATAGRID_PART_NUMBER]}});break;case a.CONSTANT_DATAGRID_USAGE_SCOPE:t.push({text:i.get(e.attrNls),dataIndex:e.attrName,getCellValue:function(e){return n.altItemFactory.getUsageDetails(e.nodeModel)}});break;case a.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_STATUS:case a.CONSTANT_SUGGESTION_COLUMN_STATUS:t.push({text:i.get(e.attrNls),dataIndex:e.dataIndex,sortableFlag:!0,width:e.width?e.width:"41px",allowUnsafeHTMLContent:a.CONSTANTS_TRUE,getCellValueAsStringForFind:function(e){return""},getCellValue:function(e){var t=n.altItemFactory.getStatus(e.nodeModel,!0);return t?n.altItemFactory.buildIconSpan(t[a.CONSTANT_STATUS_ICON_CLASS],t[a.CONSTANT_STATUS]).outerHTML:""}});break;case a.CONSTANT_DATAGRID_COLUMN_CHANGE:t.push({text:i.get(e.attrNls),dataIndex:e.dataIndex,sortableFlag:!0,width:"41px",typeRepresentation:"image",getCellValue:function(e){return e.nodeModel.options.grid.WorkUnderChangeActionPhyId&&""!=e.nodeModel.options.grid.WorkUnderChangeActionPhyId?n.altSettingsManager.getChangeActionIcon():"N/A"}});break;case a.CONSTANT_DATAGRID_COLUMN_SOURCE:t.push({text:i.get(e.attrNls),dataIndex:e.dataIndex,sortableFlag:!0,width:"41px",allowUnsafeHTMLContent:a.CONSTANTS_TRUE,getCellValueAsStringForFind:function(e){return""},getCellValue:function(e){var t=e.nodeModel.options.grid[a.CONSTANT_DATAGRID_COLUMN_SOURCE];return n.altItemFactory.buildIconSpan(o.getSuggestionSourceIcons(t),n.altItemFactory.getNLSPropertyMap(t)).outerHTML}});break;case a.CONSTANT_SUGGESTION_SELECT_USAGE:t.push({text:i.get(e.attrNls),dataIndex:e.dataIndex,sortableFlag:!0,editionPolicy:"EditionOnOver",width:"auto",getCellEditableState:function(e){return!0},getCellValueAsStringForFind:function(e){return""},setCellValue:function(e,t){t==i.get("eng.alternate.select.usage.all")?e.nodeModel.options.grid[a.CONSTANT_SUGGESTION_SELECT_USAGE]=a.CONSTANT_SELECT_USAGE_ALL:t==i.get("eng.alternate.select.usage.reference")?e.nodeModel.options.grid[a.CONSTANT_SUGGESTION_SELECT_USAGE]=a.CONSTANT_SELECT_USAGE_REFERENCE:t==i.get("eng.alternate.select.usage.instance")&&(e.nodeModel.options.grid[a.CONSTANT_SUGGESTION_SELECT_USAGE]=a.CONSTANT_SELECT_USAGE_INSTANCE),e.nodeModel.select()},getCellTypeRepresentation:function(e){return e.nodeModel&&e.nodeModel._isFromOriginalModel()?a.CONSTANT_SUGGESTION_CUSTOM_TYPE_USAGE:""},getCellValue:function(e){var t=e.nodeModel.options.grid[a.CONSTANT_SUGGESTION_SELECT_USAGE];return t===a.CONSTANT_SELECT_USAGE_ALL?i.get("eng.alternate.select.usage.all"):t===a.CONSTANT_SELECT_USAGE_REFERENCE?i.get("eng.alternate.select.usage.reference"):t===a.CONSTANT_SELECT_USAGE_INSTANCE?i.get("eng.alternate.select.usage.instance"):""}});break;case a.CONSTANT_PRIMARY_ITEM_TITLE:t.push({text:i.get(e.attrNls),dataIndex:e.dataIndex,getCellValue:function(e){return e.nodeModel.options.grid[a.CONSTANT_PRIMARY_ITEM_TITLE]}});break;case a.CONSTANT_DATAGRID_PRIMARY_USAGE_SCOPE:t.push({text:i.get(e.attrNls),dataIndex:a.CONSTANT_DATAGRID_USAGE_SCOPE,getCellValue:function(e){if(e.nodeModel.options.grid[a.CONSTANT_PARENT_CONTEXT_TITLE])if(e.nodeModel.options.grid[a.CONSTANT_INSTANCE_CONTEXT_TITLE]){if(e.nodeModel.options.grid[a.CONSTANT_PARENT_CONTEXT_TITLE]&&e.nodeModel.options.grid[a.CONSTANT_INSTANCE_CONTEXT_TITLE])t=i.get("eng.alternate.properties.usageDetails.instance").replace("$1",e.nodeModel.options.grid[a.CONSTANT_INSTANCE_CONTEXT_TITLE]).replace("$2",e.nodeModel.options.grid[a.CONSTANT_PARENT_CONTEXT_TITLE]).replace("$3",e.nodeModel.options.grid[a.CONSTANT_PARENT_CONTEXT_REVISION])}else var t=i.get("eng.alternate.datagrid.column.usage.reference")+" "+e.nodeModel.options.grid[a.CONSTANT_PARENT_CONTEXT_TITLE]+" "+e.nodeModel.options.grid[a.CONSTANT_PARENT_CONTEXT_REVISION];else var t=i.get("eng.alternate.usage.all");return t}})}},_getDataGridColumns:function(e,t){var n=this,a=[];return e.forEach(function(e){n.getColumnConfiguration(e,a,t)}),a},getSuggestionSourceIcons:function(e){var t={};return t[a.CONSTANT_SUGGESTION_OTHER_USAGE]="fonticon fonticon-graph-linear enox-alternate-suggestion-source",t[a.CONSTANT_SUGGESTION_DUPLICATE]="fonticon fonticon-duplicate enox-alternate-suggestion-source",t[a.CONSTANT_SUGGESTION_BRANCH]="fonticon fonticon-flow-branch enox-alternate-suggestion-source",t[a.CONSTANT_SUGGESTION_BRANCH_FROM]="fonticon fonticon-flow-branch enox-alternate-suggestion-source",t[a.CONSTANT_SUGGESTION_REVISION]="fonticon fonticon-flow-line enox-alternate-suggestion-source",t[a.CONSTANT_SUGGESTION_PREVIOUS_REVISION]="fonticon fonticon-flow-line enox-alternate-suggestion-source",t[a.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE]="fonticon fonticon-exchange enox-alternate-suggestion-source",t[e]}})}),define("DS/ENOXAlternateSubstitute/utils/AlternateUtils",["UWA/Core","UWA/Utils","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOFilterBIUX/FilterBIComponentProxy","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants"],function(e,t,n,a,i,o){return{getformatedDate:function(e){this.dataFormatter||(this.dataFormatter=new Intl.DateTimeFormat(a.getLanguage(),{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}));try{return this.dataFormatter.format(new Date(e)).replace(",","")}catch(t){return e}},mapSelectedAlternate:function(e){return{id:e[o.CONSTANT_ALT_ID]?e[o.CONSTANT_ALT_ID]:e.id,value:e[o.CONSTANT_ALT_ID]||e.resourceid,label:e[o.CONSTANT_DATAGRID_LABEL]+" "+e[o.CONSTANT_REVISION],icon:Array.isArray(e.icons)?e.icons[0]:e.type_icon_url}}}}),define("DS/ENOXAlternateSubstitute/utils/AlternateCommands",["UWA/Class","DS/Menu/Menu","DS/UIKIT/Iconbar","DS/ENOXEngineer/utils/Search","DS/CoreEvents/ModelEvents","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateUtils","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i,o,r,s,l){"use strict";var T;return e.singleton({init:function(e){this._parent(e)},initialize:function(e){this.altOptions=e.altOptions,this.options=e.options,this.altOptions.alternateEnableDisableCommandEvents=new i},showMenu:function(e,n){if(!e||!Array.isArray(n))throw new Error("unable to build the menu");t.show(n,{position:{x:e.left,y:e.bottom},submenu:"outside"})},buildIconSpan:function(e,t){return"<i class='fonticon fonticon-"+e+" "+t+"'></i>"},getDisplayApproveMessageName:function(e,t){var n=this.getDisplayMessageName(t);return"<p>"+this.buildIconSpan(o.CONSTANT_ICON_QUALIFIED,o.CONSTANT_ICON_QUALIFIED_CLASS)+e.replace("$1",n)+"</p><b><p>"+l.get("eng.alternate.approve.conformation.message1")+"</b><br><i>&ensp;"+l.get("eng.alternate.approve.conformation.message2")+"<br>&ensp;"+l.get("eng.alternate.approve.conformation.message3")+"</i></p>"},getDisplayRemoveMessageName:function(e,t){var n=this.buildIconSpan(o.CONSTANT_ICON_WARNING,o.CONSTANT_ICON_WARNING_CLASS),a=this.getDisplayMessageName(t);return"<p>"+n+e.replace("$1",a)+"</p>"},getDisplayObsoleteMessageName:function(e,t){var n=this.buildIconSpan(o.CONSTANT_ICON_OBSOLETE,o.CONSTANT_ICON_OBSOLETE_CLASS),a=this.getDisplayMessageName(t);return"<p>"+n+e.replace("$1",a)+"</p>"},getDisplayMessageName:function(e){var t=l.get("eng.alternate.confirmation.dialog.allSelected.msg");return 1==e.length&&(t=e[0].getDisplayName()),UWA.String.escapeHTML(t)},getToolbarCmds:function(e){var t=this,n=!0;t.altOptions.alternateCollectionToolBarModelEvents.subscribe({event:o.HIDE_SHOW_MAKE_APPLICABLE_CMD},function(e){n=e});var a=[];return a.push({id:o.CONSTANT_ALTERNATE_TOOLBAR_MULTISELECT_CMD,text:l.get("eng.alternate.multi.select"),fonticon:"select-off",className:"enox-alternate-toolbar-multiselect-icon",disabled:!1,handler:function(e){t.showMenu(e.target.getBoundingClientRect(),t.getMultiSelMenu(n))}}),a.push({id:o.CONSTANT_ALTERNATE_TOOLBAR_ADD_CMD,text:l.get("eng.alternate.add"),fonticon:"plus",disabled:!1,handler:function(t){e()}}),t.altOptions.getEnforcedChange()||a.push({id:o.CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD,text:l.get("eng.alternate.approve"),fonticon:"check",disabled:!0,className:"enox-alternate-toolbar-item-disable",handler:function(e){t.approveConfirmPopup()}}),a.push({id:o.CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD,text:l.get("eng.alternate.remove"),fonticon:"fonticon fonticon-remove",disabled:!0,className:"enox-alternate-toolbar-item-disable",handler:function(e){t.removeConfirmPopup()}}),t.altOptions.getEnforcedChange()||a.push({id:o.CONSTANT_ALTERNATE_TOOLBAR_OBSELETE_CMD,text:l.get("eng.alternate.obsolete"),fonticon:"block",disabled:!0,className:"enox-alternate-toolbar-item-disable",handler:function(e){t.obsoleteConfirmPopup()}}),a.push({id:o.CONSTANT_ALTERNATE_TOOLBAR_MAKE_APPLICABLE_CMD,text:l.get("eng.alternate.applicable"),fonticon:"checkbox-on",disabled:!0,className:"enox-alternate-toolbar-item-disable ",handler:function(e){t.makeApplicable()}}),a.push({id:o.CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD,text:l.get("eng.alternate.addToChange"),fonticon:"change",disabled:!0,handler:function(e){t.addToChange()}}),a.push({id:o.CHANGE_OWNER_CMD,text:l.get("eng.alternate.change_ownership"),fonticon:"move-to",disabled:!0,handler:function(e){t.moveToCmdHandler()}}),a.push({id:o.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD,text:l.get("eng.alternate.carryOver.command"),fonticon:"fonticon fonticon-flow-cascade-search",disabled:!1,handler:function(e){t.altOptions.CarryOver.renderAlternatesDialog()}}),a.push({id:o.CONSTANT_ALTERNATE_TOOLBAR_GROUP_BY,text:l.get("eng.alternate.groupBy"),fonticon:"fonticon fonticon-group",handler:function(e){t.showMenu(e.target.getBoundingClientRect(),t.getGroupByMenu())}}),a.push({id:"Separator",className:"divider"}),a},getFilterMenu:function(e){return new n({renderTo:e,items:[{name:l.get("eng.alternate.filter"),fonticon:"list-filter",text:l.get("eng.alternate.filter"),handler:function(e){}}]})},removeConfirmPopup:function(){var e=this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes();if(e.length>0&&this.altOptions.checkValidAlternates(e,l.get("eng.alternate.only.proposed.objects.removed"),o.CONSTANT_PROPOSED,o.CONSTANT_REMOVE)){var t=this.getDisplayRemoveMessageName(l.get("eng.alternate.remove.confirmation.dialog.msg"),e),n=l.get("eng.alternate.remove.confirmation.dialog.title"),a=l.get("eng.alternate.remove.confirmation.dialog.confirm");this.altOptions.confirmToProceedDialog(n,t,o.CONSTANT_REMOVE,a)}},obsoleteConfirmPopup:function(){var e=this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes();if(e.length>0&&this.altOptions.checkValidAlternates(e,l.get("eng.alternate.only.qualified.objects.obsolete"),o.CONSTANT_QUALIFIED,o.CONSTANT_OBSOLETE)){var t=this.getDisplayObsoleteMessageName(l.get("eng.alternate.obsolete.confirmation.dialog.msg"),e),n=l.get("eng.alternate.obsolete.confirmation.dialog.title"),a=l.get("eng.alternate.obsolete.confirmation.dialog.confirm");this.altOptions.confirmToProceedDialog(n,t,o.CONSTANT_OBSOLETE,a)}},approveConfirmPopup:function(){var e=this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes();if(e.length>0&&this.altOptions.checkValidAlternates(e,l.get("eng.alternate.only.proposed.objects.qualified"),o.CONSTANT_PROPOSED,o.CONSTANT_APPROVE)){var t=this.getDisplayApproveMessageName(l.get("eng.alternate.approve.confirmation.dialog.msg"),e),n=l.get("eng.alternate.qualify.confirmation.dialog.title"),a=l.get("eng.alternate.qualify.confirmation.dialog.confirm");this.altOptions.confirmToProceedDialog(n,t,o.CONSTANT_APPROVE,a)}},makeApplicable:function(){var e=[],t=[],n=this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes();T=this.options.activeEngItemTreeInfo._selectedNodes;this.options.activeEngItemTreeInfo._configModelVersionID;for(var a=0;a<T.length;a++)e.push(T[a].getRelationID&&T[a].getRelationID());for(var i in n)t.push(s.mapSelectedAlternate(n[i].options));var A=this.altOptions.altAppCore&&this.altOptions.altAppCore.altSettingsManager&&this.altOptions.altAppCore.altSettingsManager.isCloud()?o.SUPPORTED_ALTERNATE_COUNT_ONCLOUD:o.SUPPORTED_ALTERNATE_COUNT_ONPREMISE;if(t&&t.length>A){var N=l.get("eng.alternate.make.applicable.maxcount.errormsg").replace("$1",A);r.errorAlert(N)}else require(["DS/ENOXAlternateSubstitute/commands/AddAlternate"],function(n){n.addAlternateDataService(T[0],e,null,t).then(function(e){e.hasOwnProperty(o.ERROR)?r.errorAlert(e.response.message):e.status==o.SUCCESS&&n.addAlternateSuccessUXModification(l.get("eng.alternate.applicable.success.message"),e)})})},addToChange:function(){this.searchMgt=new a({multiSel:!1});var e=this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes(),t=this.altOptions.altAppCore.altSettingsManager.getCurrentUser().id,n='AND (owner:"'+t+'"OR [ECM_CHANGE_ASSIGNEE_USERNAME]:"'+t+'")';e.length>0&&this.searchMgt.launchASearch({title:l.get("eng.alternate.select.Change.Action"),allowedTypes:["Change"],role:"",criteria:"",precondition:'current:"In Work"'+n,multiSel:!1,in_apps_callback:this.onSelectedFromSearchForCA.bind(this,e)})},onSelectedFromSearchForCA:function(e,t){for(var n=this,a={altObjInfo:[]},i=0;i<e.length;i++){var r={};r[o.CONSTANT_KEY_PHYSICALID]=e[i]._options.grid[o.CONSTANT_CARRYOVER_ALT_REF_PHYSICALID],r[o.CONSTANT_STATUS]=e[i]._options.grid.AlternateQualificationStatus,a.altObjInfo.push(r)}a.caId=t[0].id,this.altOptions.altAppCore.altDataServices.addToChangeService(a).then(function(t){n.altOptions.altAppCore.altSettingsManager.setAuthoringMode(o.CONSTANT_AUTHORING_MODE),n.altOptions.updateChangeColumn(e,a.caId)}).catch(function(e){console.error(e)})},renderDropdownItems:function(e,t){for(var n=[],a=0;a<e.length;a++)n.push({id:e[a].id,text:l.get(e[a].title),tooltip:l.get(e[a].title),name:e[a].name,fonticon:e[a].fonticon?e[a].fonticon:"",selected:e[a].selected,className:"enox-filter-view",selectable:!0,items:e[a].items?this.renderDropdownItems(e[a].items):null}),e[a].selected&&(t[e[a].name]={filterId:"stringRole",filterModel:{allowedRoles:t[e[a].name]?t[e[a].name].filterModel.allowedRoles.push(e[a].id)&&t[e[a].name].filterModel.allowedRoles:[e[a].id]}});return n},getGroupByMenu:function(){for(var e=[],t=this.altOptions.altAppCore.altSettingsManager.getCommand(o.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[o.CONSTANT_ALTERNATE_GROUPBY_OPTIONS],n=0;n<t.length;n++)e.push({title:l.get(t[n].title),type:t[n].type,action:{this:this,context:o[t[n].context],callback:this.altOptions.groupAlternateNodes}});return e},getMultiSelMenu:function(e){var t=[];return t.push({title:l.get("eng.alternate.multi.select.all"),type:"PushItem",action:{this:this,context:!0,callback:this.updateNodeSelection.bind(this)}}),t.push({title:l.get("eng.alternate.multi.select.proposed"),type:"PushItem",action:{this:this,context:o.CONSTANT_PROPOSED,callback:this.updateNodeSelection.bind(this)}}),t.push({title:l.get("eng.alternate.multi.select.qualified"),type:"PushItem",action:{this:this,context:o.CONSTANT_QUALIFIED,callback:this.updateNodeSelection.bind(this)}}),t.push({title:l.get("eng.alternate.multi.select.obsolete"),type:"PushItem",action:{this:this,context:o.CONSTANT_OBSOLETE,callback:this.updateNodeSelection.bind(this)}}),e&&t.push({title:l.get("eng.alternate.multi.select.not.applicable"),type:"PushItem",action:{this:this,context:o.CONSTANT_NOT_APPLICABLE,callback:this.updateNodeSelection.bind(this)}}),t.push({title:l.get("eng.alternate.multi.select.none"),type:"PushItem",action:{this:this,context:!1,callback:this.updateNodeSelection.bind(this)}}),t},updateNodeSelection:function(e){var t=[];this.altOptions._addAlternateUX.ALTERNATE.model._getTrueRoot().getTreeDocument().unselectAll(),this.altOptions._addAlternateUX.ALTERNATE.model.processDescendants({onlyVisibleNodes:!0,processNode:function(n){let a=n.nodeModel,i=a.getAllDescendants();if(a.options[o.CONSTANT_STATUS]==e.context?t.push(a):1==e.context&&t.push(a),i.length)for(var r of i)r.options[o.CONSTANT_STATUS]==e.context?t.push(r):1==e.context&&t.push(r)}}),t.forEach(function(e){e.select()}),this.altOptions.alternateEnableDisableCommandEvents.publish({event:o.MULTI_SELECT_ENABLE_DISABLE_MAKE_APPLICABLE_CMD})},buildToolbarForSuggestions:function(e){var t=this,a=t.altOptions.options.activeEngItemTreeInfo._selectedNodes[0],i=a.options.grid[o.CONSTANT_DS_LABEL],r=a.options.grid[o.CONSTANT_DS_REVISION];return new n({renderTo:e.container,items:[{name:o.CONSTANT_SUGGESTION_FIND,fonticon:"fonticon fonticon-find",text:l.get("eng.alternate.suggestion.find"),handler:function(t){e.findCB()}},{name:o.CONSTANT_SUGGESTION_SETTINGS,fonticon:"fonticon fonticon-cog",text:l.get("eng.alternate.suggestion.settings"),handler:function(t){e.settingsCB()}},{name:o.CONSTANT_SUGGESTION_REVISION_EXPLORER,fonticon:"fonticon fonticon-flow-branch-list",text:l.get("eng.alternate.suggestion.toolBar.revision")+i+" "+r,handler:function(e){widget.appMediator.publish(o.EVENT_LAUNCH_COMMAND,{commandId:o.SHOW_HISTORY_CMD,context:{item:a}})}},{name:o.CONSTANT_SUGGESTION_CHANGE_USAGE,fonticon:"fonticon fonticon-pencil",text:l.get("eng.alternate.suggestion.change.usage"),handler:function(n){t.showMenu(n.target.getBoundingClientRect(),t.getChangeUsageMenu(e.model))}},{name:o.CONSTANT_ALTERNATE_TOOLBAR_GROUP_BY,text:l.get("eng.alternate.groupBy"),fonticon:"fonticon fonticon-group",handler:function(n){t.showMenu(n.target.getBoundingClientRect(),t.getSuggestionGroupByMenu(e.model))}}]})},getChangeUsageMenu:function(e){var t=[],n={usage:o.CONSTANT_SELECT_USAGE_ALL,model:e};t.push({title:l.get("eng.alternate.select.usage.all"),type:"RadioItem",action:{this:this,context:n,callback:this.massUpdateUsageSelection}});var a={usage:o.CONSTANT_SELECT_USAGE_REFERENCE,model:e};t.push({title:l.get("eng.alternate.select.usage.reference"),type:"RadioItem",action:{this:this,context:a,callback:this.massUpdateUsageSelection}});var i={usage:o.CONSTANT_SELECT_USAGE_INSTANCE,model:e};return t.push({title:l.get("eng.alternate.select.usage.instance"),type:"RadioItem",action:{this:this,context:i,callback:this.massUpdateUsageSelection}}),t},massUpdateUsageSelection:function(e){var t=this,n=e.context.model;n.getSelectedNodes().length>0&&""!=e.context.usage&&n.getSelectedNodes().forEach((a,i)=>{a._isFromOriginalModel()&&(a.options.grid[o.CONSTANT_SUGGESTION_SELECT_USAGE]=e.context.usage,t.updateNodeInfo(a,n))})},updateNodeInfo:function(e,t){var n=e&&e._getRowID&&e._getRowID(),a=e&&e._parentNode;if(a&&!a._isFromOriginalModel()){var i=n-a._getRowID();a.addChild(e,i-1),a.expand()}else t.addChild(e,n);e.select()},getSuggestionGroupByMenu:function(e){for(var t=[],n=this.altOptions.altAppCore.altSettingsManager.getCommand(o.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[o.CONSTANT_ALTERNATE_SUGGESTIONS_GROUPBY_OPTIONS],a=0;a<n.length;a++){var i={option:o[n[a].context],model:e};t.push({title:l.get(n[a].title),type:n[a].type,action:{this:this,context:i,callback:this.groupSuggestions}})}return t},groupSuggestions:function(e){"None"===e.context.option?e.context.model.ungroupRoots():(e.context.model.ungroupRoots(),e.context.model.groupRoots({propertiesToGroup:[e.context.option]}))},moveToCmdHandler:function(){var e=this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes(),t=[];e.forEach((e,n)=>{let a=Object.assign(Object.create(Object.getPrototypeOf(e)),e);a.getID=function(){return a.getInterchangeabilityID()},a.getLabel=function(){return a.getInterchangeabilityTitle()},t.push(a)}),widget.appMediator.publish(o.EVENT_LAUNCH_COMMAND,{commandId:o.CHANGE_OWNER_CMD,context:{item:t}})}})}),define("DS/ENOXAlternateSubstitute/services/AlternateSubstituteServices",["UWA/Class","UWA/Core","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","require","text!DS/ENOXAlternateSubstitute/assets/config/AlternateManagement.conf.json","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i,o,r,s,l,T){"use strict";var A,N;return e.singleton({initialize:function(e){this.altAppCore=e,this.getNlsOfPropertiesValues(e.altSettingsManager.getConfiguration("nlsPropValue")),this.temporaryLoadEmptyView()},temporaryLoadEmptyView:function(e){return N?new N(e):n.wrappedWithPromise(function(e,t){s(["DS/ENOXEmptyContent/js/ENOXEmptyContent"],function(t){N=t,e(!0)},function(e){t(e)})})},getRelatedItemsUsingVersionGraphServices:function(e){var t=this.altAppCore.altSettingsManager.getCommand("fetchRelatedItemIdsFromVersionGraph"),i=Object.assign({},t);return i.url=i.url+"?withThumbnail=1&withIsLastVersion=1&withAttributes=1&withCopyFrom=1",n.wrappedWithCancellablePromise(function(t,n){a.perform(i,e).then(function(e){return i=null,t(e)}).catch(function(e){t(e)})})},addAlternateItems:function(e){var t=this.altAppCore.altSettingsManager.getCommand("add_alternate"),i=Object.assign({},t);return i.url=i.url,n.wrappedWithCancellablePromise(function(t,n){a.perform(i,e).then(function(e){return i=null,t(e)}).catch(function(e){t(e)})})},addAlternteFromSuggestedItems:function(e,t,i){var o=this.altAppCore.altSettingsManager.getCommand("add_alternate");o.url=o.url;var s={[r.CONSTANT_REF_ID]:t.getID(),[r.CONSTANT_USER_SELECTED_INSTANCE_ID]:this.getInstanceId(t,i),[r.CONSTANT_ALT_INFO]:e};return n.wrappedWithCancellablePromise(function(e,t){a.perform(o,s).then(function(t){return e(t)}).catch(function(t){e(t)})})},removeAlternateItems:function(e){var t=this.altAppCore.altSettingsManager.getCommand("remove_alternate");t.url=t.url;var i=e._addAlternateUX.ALTERNATE.model.getSelectedNodes(),o=e.options.activeEngItemTreeInfo._selectedNodeId,s=this.getPayload(o,i,r.CONSTANT_PROPOSED);return n.wrappedWithCancellablePromise(function(e,n){a.perform(t,s).then(function(t){return e(t)}).catch(function(t){e(t)})})},obsoleteAlternateItems:function(e){var t=this.altAppCore.altSettingsManager.getCommand("obsolete_alternate");t.url=t.url;var i=e._addAlternateUX.ALTERNATE.model.getSelectedNodes(),o=e.options.activeEngItemTreeInfo._selectedNodeId,s=e.options.activeEngItemTreeInfo._parentId,l=this.getPayload(o,i,r.CONSTANT_QUALIFIED);return s!=o&&(l[r.CONSTANT_PARENT_CONTEXT_PHYSICALID]=s),n.wrappedWithCancellablePromise(function(e,n){a.perform(t,l).then(function(t){return e(t)}).catch(function(t){e(t)})})},approveAlternateItems:function(e){var t=this.altAppCore.altSettingsManager.getCommand("approve_alternate");t.url=t.url;var i=e._addAlternateUX.ALTERNATE.model.getSelectedNodes(),o=this.getPayload(e.currentNodeId,i,r.CONSTANT_PROPOSED);return n.wrappedWithCancellablePromise(function(e,n){a.perform(t,o).then(function(t){return e(t)}).catch(function(t){e(t)})})},addAlternatePartToEngItem:function(e,t,a,o,r){var s=this;return n.wrappedWithPromise(function(n,l){s.fetchEngItem(e,t,a,o,r).then(function(e){n(e)}).catch(function(e){i.errorAlert(e.error||JSON.stringify(e)),n(e)})})},proposeAlternatePartToEngItem:function(e,t,i,o,s){var l=this.altAppCore.altSettingsManager.getCommand("modifyProposedFor"),T={[r.CONSTANT_REF_ID]:e.getID(),[r.CONSTANT_PROPOSE_FOR]:s,[r.CONSTANT_ALT_INFO]:this.createJSONForProposeFor(o,t,i)},A=Object.assign({},l);return A.url=A.url,n.wrappedWithCancellablePromise(function(e,t){a.perform(A,T).then(function(t){return A=null,e(t)}).catch(function(t){e(t)})})},fetchEngItem:function(e,t,a,i,o){var r=this,s=this.getPayloadForAdd(e,t,a,i,o);return n.wrappedWithPromise(function(e,t){e(r.addAlternateItems(s))})},getPayloadForAdd:function(e,t,n,a,i){for(var o=[],s=0;s<i.length;s++){var l=null!=i[s].id?i[s].id:i[s].AlternateItemPhysicalId;o.push(l)}return{[r.CONSTANT_REF_ID]:e.getID(),[r.CONSTANT_USER_SELECTED_INSTANCE_ID]:this.getInstanceId(e,t),[r.CONSTANT_ALT_INFO]:this.createJSON(o,n,a)}},shouldShowInstanceAlternates:function(e){return!(!e||!e.getRelationID)&&e.getRelationID()},getInstanceId:function(e,t){var n=null;return t.options.activeEngItemTreeInfo._parentNode&&e&&e.getRelationID?(e.getID()!=t.options.activeEngItemTreeInfo._parentNode.getID()&&(n=e.getRelationID()),n):n},createJSON:function(e,t,n){var a=[];e=this.removeDuplicates(e);if(null==n)for(var i in e){if(t.length)for(var o in t){(s={})[r.CONSTANT_ALT_ID]=e[i],s[r.CONSTANT_CTX_ITEM_ID]=t[o],a.push(s)}else(s={})[r.CONSTANT_ALT_ID]=e[i],a.push(s)}else for(var i in e){var s;(s={})[r.CONSTANT_ALT_ID]=e[i],s[r.CONSTANT_REFERENCE_PHYSICAL_ID]=n,a.push(s)}return a},createJSONForProposeFor:function(e,t,n){var a=[];e=this.removeDuplicates(e);for(var i in e){var o={},s=null!=e[i].id?e[i].id:e[i].AlternateItemPhysicalId,l=e[i][r.CONSTANT_ALT_REF_PHYSICALID];if(o[r.CONSTANT_ALT_ID]=s,o[r.CONSTANT_ALT_REF_PHYSICALID]=l,t&&t.length)for(var T in t){(o={})[r.CONSTANT_ALT_ID]=s,o[r.CONSTANT_ALT_REF_PHYSICALID]=l,o[r.CONSTANT_CTX_ITEM_ID]=t[T],a.push(o)}else n&&(o[r.CONSTANT_REFERENCE_PHYSICAL_ID]=n),a.push(o)}return a},getPayload:function(e,t,n){var a=this.createJSONForRemoveRejectQualify(this.getAlternateIds(t,n));return{[r.CONSTANT_REF_ID]:e,[r.CONSTANT_ALT_INFO]:a}},createJSONForRemoveRejectQualify:function(e){var t=[];for(var n in e){var a={[r.CONSTANT_ALT_REF_PHYSICALID]:e[n]};t.push(a)}return t},getAlternateIds:function(e,t){for(var n=[],a=0;a<e.length;a++)e[a].options.grid[r.CONSTANT_STATUS]!=t||this.altAppCore.altItemFactory.checkIfHeaderNode(e[a])||n.push(e[a].options[r.CONSTANT_ALT_REF_PHYSICALID]);return n},removeDuplicates:function(e){for(var t=[],n=0;n<e.length;n++)-1==t.indexOf(e[n])&&t.push(e[n]);return t},fetchEngItemAttributes:function(e){var t=this.altAppCore.altSettingsManager.getCommand("fetch_attributes");return n.wrappedWithCancellablePromise(function(n,i){a.perform(t,e).then(function(e){return n(e)}).catch(function(e){i(e)})})},getRootsForExpand:function(e){for(var t=[],n=0;n<e.length;n++){var a={id:e[n]};t.push(a)}return t},expandServicePayload:function(e,t){return{roots:this.getRootsForExpand(e),no_type_filter_rel:["XCADBaseDependency"],include_param_Attributes:!0,"q.iterative_filter_query_bo":'[ds6w:globalType]:"ds6w:Part"',level:t,intent:"explore_2D",source:"cstorage",authored:!0}},fetchExpandService:function(e,t){var i=this.expandServicePayload(e,t),o=this.altAppCore.altSettingsManager.getCommand("fetch_enopad_expand");return n.wrappedWithCancellablePromise(function(e,t){a.perform(o,i).then(function(t){return e(t)}).catch(function(e){t(e)})})},getPathsForAttributes:function(e){for(var t,n=0;n<e.length;n++)e[n].path&&(t=e[n].path);return t},getAttributeValues:function(e){for(var t={},n=0;n<e.length;n++)t[e[n].name]=e[n].value;return t},fetchedObjectInfo:function(e,t){var a=this;return n.wrappedWithCancellablePromise(function(n,i){a.fetchExpandService(e,t).then(function(e){if(e.results){var t=e.results,i=a.getPathsForAttributes(t),o={};if(i)for(var r=0;r<i.length;r++)if(t[i[r]].attributes){var s=t[i[r]].attributes,l=a.getAttributeValues(s);o[l.resourceid]=l}return n(o)}})})},getNlsOfPropertiesValues:function(e){var t=this;return A||n.wrappedWithCancellablePromise(function(n,a){o.getNlsOfPropertiesValues(JSON.stringify(e),{apiVersion:"R2020x",tenantId:t.altAppCore.altSettingsManager.getPlatformId(),lang:t.altAppCore.altSettingsManager.getLanguage(),onComplete:function(e){e&&(t.ds6wClassPropNls||(t.ds6wClassPropNls={}),UWA.extend(t.ds6wClassPropNls,e,!0),A=t.ds6wClassPropNls,n(t.ds6wClassPropNls))},onFailure:function(){console.warn("DictionaryAccess## FedDictionaryAccessAPI.getNlsOfPropertiesValues failed for"+e),n()}})})},federadedSearch:function(e){if(!e.query)throw new Error("query is a mandatory parameter");var t=this.altAppCore.altSettingsManager.getCommand("fed_myEng"),n={label:this.altAppCore.altSettingsManager.getCVRequestLabel(),nresults:e.nresults||100,order_by:"desc",order_field:"ds6w:modified",query:e.query,select_predicate:e.predicates||this.altAppCore.altSettingsManager.getSetting("select_predicate"),select_file:["icon","thumbnail_2d"],start:"0",tenant:this.altAppCore.altSettingsManager.getPlatformId(),with_indexing_date:!0,with_nls:!0,source:e.source||t.source};return a.perform(t,JSON.stringify(n))},fireAutocompleteSearch:function(e){var t=this,a={predicates:["ds6w:label","physicalid","ds6wg:revision"],nresults:e.nresults};Array.isArray(e.sources)&&e.sources.length>0&&(a.sources=e.sources);var i=t.getAugmenttedQueryForSearch(e.criteria);if(Array.isArray(e.targetTypes)&&e.targetTypes.length>0){for(var o='flattenedtaxonomies:"types/'+e.targetTypes[0]+'"',r=1;r<e.targetTypes.length;r++){o+=' OR flattenedtaxonomies:"types/'+e.targetTypes[r]+'"'}a.query="("+o+") AND "+i}else a.query=i;return e.precond&&(a.query=e.precond+" AND "+a.query),n.wrappedWithPromise(function(e,n){t.federadedSearch(a).then(function(n){var a=t.parseFetchResult(n);e(a.results)}).catch(function(e){n(e)})})},getAugmenttedQueryForSearch:function(e){if(t.is(e,"string")&&e.trim().length>0){var n=e;return"*"!==e.charAt(0)&&(n="*"+e),"*"!==e.charAt(e.length-1)&&(n+="*"),n}return null},parseFetchResult:function(e,t){var n=e.results||[],a=[],i=this,o=null;return t&&(o={withNlsProp:t,classes:[],properties:{}}),n.forEach(function(e){0===e.attributes.length||e.sort&&"#DELETE#"===e.sort.sortType?a.push({deleted:!0}):a.push(i.attributesParser(e.attributes,o))}),{results:a,nlsTracker:o}},attributesParser:function(e){for(var t={},n=0;n<e.length;n++)t[e[n].name]=e[n].value;return t},getParentPointedAlternateReferenceIds:function(e){var t={};t[r.CONSTANT_CARRYOVER_PARENT_PRODUCTS_PHYSICAL_ID]=e;var i=this.altAppCore.altSettingsManager.getCommand("getParentPointedAlternateReferencePhyIds");return n.wrappedWithCancellablePromise(function(e,n){a.perform(i,t).then(function(t){return e(t)}).catch(function(t){e(t)})})},performCarryOverRevisions:function(e,t){var i={};i[r.CONSTANT_CARRYOVER_DEST_PRODUCTS_PHYSICAL_ID]=t,i[r.CONSTANT_CARRYOVER_SOURCE_PRODUCTS_PHYSICAL_ID]=e;var o=this.altAppCore.altSettingsManager.getCommand("carryOverAlternates");return n.wrappedWithCancellablePromise(function(e,t){a.perform(o,i).then(function(t){return e(t)}).catch(function(e){t(e)})})},getUsagesInfoForAlternates:function(e){var t=this.altAppCore.altSettingsManager.getCommand("alternate_properties");t.url=t.url;var i={};return i[r.CONSTANT_ALT_REF_PHYSICALID]=e,n.wrappedWithCancellablePromise(function(e,n){a.perform(t,i).then(function(t){return e(t)}).catch(function(t){e(t)})})},getSettingsForAlternateSources:function(e){if(!UWA.is(e))return null;var t=this.altAppCore.altSettingsManager.getCommand("my_app_getPreference"),i=Object.assign({},t);return i.url=i.url+"?name="+this.altAppCore.altSettingsManager._getUserPrefKey(e),n.wrappedWithCancellablePromise(function(e,t){a.perform(i).then(function(t){return i=null,t&&""===t.trim()?e(null):e(t)}).catch(function(e){t(e)})})},setSourceSettings:function(e,t){if(!UWA.is(e)||!UWA.is(t))return null;var i=this.altAppCore.altSettingsManager.getCommand("my_app_setPreference"),o=Object.assign({},i);return o.url=o.url+"?name="+this.altAppCore.altSettingsManager._getUserPrefKey(e)+"&value="+UWA.Utils.encodeUrl(t),n.wrappedWithCancellablePromise(function(e,t){a.perform(o).then(function(t){return o=null,e(t)}).catch(function(e){t(e)})})},getSelectedAddToChangeAlternates:function(e){for(var t=[],n=0;n<e.length;n++){e[n];var a={activities:[{what:{operation:"ChangeStatus","target state":r.CONSTANT_PROPOSED==e[n][r.CONSTANT_STATUS]?"Release":r.CONSTANT_QUALIFIED==e[n][r.CONSTANT_STATUS]?"Obsolete":""},why:{comment:{}}}],operation:{name:"None"},where:{id:"pid:"+e[n][r.CONSTANT_KEY_PHYSICALID]},why:{comment:{}}};t.push(a)}return t},addToChangeService:function(e){var t={changeaction:{add:{proposed:this.getSelectedAddToChangeAlternates(e.altObjInfo)}},cestamp:"0000",delete:{},modify:{},version:"v0"},o=this.altAppCore.altSettingsManager.getCommand("add_to_change"),r=Object.assign({},o);return r.url=r.url+"/pid:"+e.caId+"?proposed=1",n.wrappedWithCancellablePromise(function(n,o){a.perform(r,t).then(function(t){return i.sucessAlert(T.get("eng.alternate.addchange.success.msg").replace("$1",e.alternateItemName).replace("$2",t.changeaction.description)),n(t)}).catch(function(e){i.errorAlert(e.response.errorMessage),o(e)})})},getCVServletPayload:function(e){var t=JSON.parse(l);return{multi_root_physicalid:e,type_filter_rel:[r.RELATIONSHIP_ALTERNATE_ITEM],expand_iter:"1",no_type_filter_rel:["XCADBaseDependency"],select_bo:t.select_bo,select_rel:t.select_rel,compute_select_bo:t.compute_select_bo,label:this.altAppCore.altSettingsManager.getCVRequestLabel()}}})}),define("DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator",["UWA/Core","UWA/Class","DS/ENOXAlternateSubstitute/services/AlternateSubstituteServices","DS/ENOXAlternateSubstitute/views/AlternateItemModel","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXAlternateSubstitute/utils/AlternateUtils","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i,o,r,s){"use strict";return t.singleton({init:function(e){this._parent(e),this._nlsPropValues=n.getNlsOfPropertiesValues()},createRevisionsItem:function(e){e[o.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_REVISIONS_TITLE]=e[o.CONSTANT_DATAGRID_LABEL],e[o.CONSTANT_CARRYOVER_REVISION_COLUMN_CREATION_DATE]=r.getformatedDate(e[o.CONSTANT_CARRYOVER_REVISION_COLUMN_CREATION_DATE]),e[o.CONSTANT_CARRYOVER_REVISION_COLUMN_MODIFICATION_DATE]=r.getformatedDate(e[o.CONSTANT_CARRYOVER_REVISION_COLUMN_MODIFICATION_DATE]),e[o.CONSTANT_KEY_PHYSICALID]=e[o.CONSTANT_KEY_ID],e[o.CONSTANTS_KEY_ICONS]=e[o.CONSTANTS_ICON]?[e[o.CONSTANTS_ICON]]:[i.getDefaultProductIcon()];var t=this._optionsRetrievor(e),n=this.basicOptionsBuilder(t);return new a(n)},createAlternateItem:function(e){var t=this._nlsPropValues["ds6w:status"][e[o.CONSTANT_DATAGRID_MATURITY_STATE]];e[o.CONSTANTS_KEY_ICONS]=e[o.CONSTANTS_ICON]?[e[o.CONSTANTS_ICON]]:[i.getDefaultProductIcon()],e[o.CONSTANTS_THUMNAIL]=e[o.CONSTANTS_THUMNAIL],e[o.CONSTANT_DATAGRID_MATURITY_STATE]=t||e[o.CONSTANT_DATAGRID_MATURITY_STATE];var n=this._optionsRetrievor(e),r=this.basicOptionsBuilder(n);return new a(r)},createAlternateCarryOverItems:function(e){var t=this._nlsPropValues["ds6w:status"][e[o.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY]];e[o.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY]=t||e[o.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY],e[o.CONSTANTS_KEY_ICONS]=e[o.CONSTANTS_KEY_ICONS]?e[o.CONSTANTS_KEY_ICONS]:[i.getDefaultProductIcon()];var n=this._optionsRetrievor(e),r=this.basicOptionsBuilder(n);return new a(r)},basicOptionsBuilder:function(e){return this.Options={},e.grid?(e.grid[o.CONSTANT_DATAGRID_LABEL]=e[o.CONSTANT_DATAGRID_LABEL],e.grid[o.CONSTANT_DATAGRID_AVAILABLE_CONTEXT]=e[o.CONSTANT_DATAGRID_AVAILABLE_CONTEXT],e.grid[o.CONSTANT_DATAGRID_MODEL]=e[o.CONSTANT_DATAGRID_MODEL],this.Options=Object.assign({},e)):(this.Options=Object.assign({grid:{}},e),this._fillAttributes(e)),this.Options},_optionsRetrievor:function(e){return this.retrieveNodeData(e)},retrieveNodeData:function(e){return e[o.CONSTANT_DATAGRID_LABEL]=e[o.CONSTANT_TITLE],e[o.CONSTANT_DATAGRID_AVAILABLE_CONTEXT]=this.getContextColumnValue(e),e[o.CONSTANT_DATAGRID_MODEL]=this.getHasConfigContextColumnValue(e),e},_fillAttributes:function(e){var t=this;return Object.keys(e).forEach(function(n){t.Options.grid[n]=e[n]}),this.Options},createAlternateItemNodes:function(e){var t=this,n=[];return e.forEach(function(e){var a=t.createAlternateItem(e),i=[];e[o.CONSTANT_OTHER_CONTEXT_KEY]&&(e[o.CONSTANT_OTHER_CONTEXT_KEY].forEach(function(e){if(e[o.CONSTANT_APPLICABILTY]==o.APPLICABILITY_YES){var n=t.createAlternateItem(e);i.push(n)}}),i.length>1&&a.addChild(i)),e[o.CONSTANT_APPLICABILTY]!=o.APPLICABILITY_YES&&e[o.CONSTANT_SPLIT]!=o.SPLIT_YES||n.push(a)}),n},createAlternateItemWithNotApplicableData:function(e){var t=this,n=[];return e.forEach(function(e){var a=t.createAlternateItem(e);n.push(a)}),n},getContextColumnValue:function(e){if(e[o.CONSTANT_OTHER_CONTEXT_KEY]){var t=this.countStatusInfo(e[o.CONSTANT_OTHER_CONTEXT_KEY]),n=t.usage.split(","),a=t.count;if(n.length>1?e[o.CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS]=o.CONSTANT_NO:(e[o.CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS]=o.CONSTANT_YES,e.grid&&e.grid[o.CONSTANT_STATUS]?e.grid[o.CONSTANT_STATUS]=t[o.CONSTANT_STATUS]:e[o.CONSTANT_STATUS]=t[o.CONSTANT_STATUS]),1==a)return this.getContextInformation(e);var i=s.get("eng.alternate.column.applicable.availableContexts");return e[o.CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS]==o.CONSTANT_YES?a+" "+i:a+" "+i+(t.usage?" ( "+t.usage+" )":"")}return this.getContextInformation(e)},getHasConfigContextColumnValue:function(e){if(e[o.CONSTANT_APPLICABILTY]!=o.CONSTANT_YES&&e[o.CONSTANT_OTHER_CONTEXT_KEY]&&e[o.CONSTANT_SPLIT]!=o.SPLIT_YES){var t=s.get("eng.alternate.config.context.value.no");return e[o.CONSTANT_OTHER_CONTEXT_KEY].forEach(function(e){e[o.CONSTANT_CONFIG_CONTEXT_PHYSICALID]&&(t=s.get("eng.alternate.config.context.value.yes"))}),t}return e[o.CONSTANT_CONFIG_CONTEXT_PHYSICALID]?s.get("eng.alternate.config.context.value.yes"):s.get("eng.alternate.config.context.value.no")},getContextInformation:function(e){return e[o.CONSTANT_OPERATION_KEY]==o.CONSTANT_OPERATION_KEY_VALUE_ALTERNATE?s.get("eng.alternate.datagrid.column.usage.all"):e[o.CONSTANT_OPERATION_KEY]==o.CONSTANT_OPERATION_KEY_VALUE_INSTANCE_SUB?e[o.CONSTANT_SPLIT]==o.SPLIT_YES?s.get("eng.alternate.datagrid.column.usage.alternate.applicable.other.context")+e[o.CONSTANT_OTHER_CONTEXT_APPLICABLE_ALTERNATE_REF_PHYSICALD].length:s.get("eng.alternate.datagrid.column.usage.instance")+e[o.CONSTANT_INSTANCE_CONTEXT_TITLE]:s.get("eng.alternate.datagrid.column.usage.reference")+e[o.CONSTANT_PARENT_CONTEXT_TITLE]+" "+e[o.CONSTANT_PARENT_CONTEXT_REVISION]},countStatusInfo:function(e){var t={},n="",a="",i=0,r={};return e.forEach(function(e){t.hasOwnProperty(e.grid[o.CONSTANT_STATUS])?t[e.grid[o.CONSTANT_STATUS]].push(e):t[e.grid[o.CONSTANT_STATUS]]=[e]}),Object.keys(t).forEach(function(e){e==o.CONSTANT_PROPOSED?a=s.get("eng.alternate.status.proposed"):e==o.CONSTANT_QUALIFIED?a=s.get("eng.alternate.status.qualified"):e==o.CONSTANT_OBSOLETE&&(a=s.get("eng.alternate.status.obsolete")),n+=t[e].length+" "+a+", ",i+=t[e].length,r[o.CONSTANT_STATUS]=e}),r.usage=n.substring(0,n.length-2),r.count=i,r}})}),define("DS/ENOXAlternateSubstitute/commands/GetSuggestionAlternateUsage",["UWA/Class","UWA/Core","DS/TreeModel/TreeDocument","DS/Controls/Button","DS/Windows/Dialog","DS/Handlebars/Handlebars4","DS/Windows/ImmersiveFrame","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXEngineerCommonUtils/XENMask","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","text!DS/ENOXAlternateSubstitute/views/html/SuggestionUsagesList.html","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","css!DS/ENOXAlternateSubstitute/styles/Alternate.css"],function(e,t,n,a,i,o,r,s,l,T,A,N,_,S){return e.singleton({initialize:function(e){this.altOptions=e.altOptions},_initDivs:function(e){var n={alternatesuggestionUsageGridView:!0,usagesInfo:e.usagesInfo},a=o.compile(_);this._container=t.createElement("div",{class:"enox-alternate-suggestion-usage-wrapper"}),this._container.innerHTML=a(n),this._SuggestionUsageAlternateModal=this._container.querySelector(".enox-alternate-suggestion-usages"),this._SuggestionUsageToolbar=this._container.querySelector(".enox-alternare-suggestion-usage-toolbar"),this._SuggestionUsagedataGridViewDiv=this._container.querySelector(".enox-alternate-suggestion-usage-grid-view")},createsuggestionReferenceModel:function(e){this._initDivs(e.context?e.context:e);var n,a=e.context?e.context:e;n=a.navigation&&a.navigation==N.CONSTANT_ALTERNATE_USAGE_POPUP_NOT_APPLICABLE_NAVIGATION?S.get("eng.alternate.applicable.usage.popup.note"):S.get("eng.alternate.suggestion.usage.popup.note"),this._leftMenuContainer=this._SuggestionUsageToolbar?t.createElement("div",{class:"alternate_Suggestion_right_menu_container",text:n}).inject(this._SuggestionUsageToolbar):"",this.buildContextViewContent(e.context?e.context:e)},buildContextDialog:function(e){var t=new r;return t.inject(this.altOptions.getAltFacetMainContainer()),this.suggestionDialog=new i({title:S.get("eng.alternate.suggestion.parent.usage.history")+e,content:this._SuggestionUsageAlternateModal,immersiveFrame:t,resizableFlag:!0,width:550,height:450,position:{at:"center",my:"center"},modalFlag:!0,touchMode:!0,buttons:{Cancel:new a({onClick:function(e){e.dsModel.dialog.close()}})}}),this.suggestionDialog},buildContextViewContent:function(e){var t=this;this.suggestionReferenceModel=new n,t.alternateReferenceDialogbox=t.buildContextDialog(e.title),l.mask(t.alternateReferenceDialogbox.elements._contentDiv),t.altOptions.altAppCore.altDataServices.getUsagesInfoForAlternates(e.Alt_ref_ids).then(function(e){if(e.hasOwnProperty(N.ERROR)){var n=e.error.message?e.error.message:e;return n=e.response&&e.response.message?e.response.message:n,void s.errorAlert(n)}if(e.status==N.SUCCESS){l.unmask(t.alternateReferenceDialogbox.elements._contentDiv);var a=T.createAlternateItemWithNotApplicableData(e.AlternateItemInfo,!0);t.suggestionReferenceModel.addRoot(a),t.getDataGridView()}})},getDataGridView:function(){var e=this.altOptions.altAppCore.altSettingsManager.getCommand(N.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[N.CONSTANT_SUGGESTION_USAGE_COLUMN_INFO],t=A._getDataGridColumns(e,this.altOptions.altAppCore),n=this.altOptions.altAppCore.altSettingsManager.getCommand(N.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[N.CONSTANT_SUGGESTION_USAGE_COLUMN_OPTIONS];this.alternateReferenceGridView=this.altOptions.createDataGridView(this.suggestionReferenceModel,t,n),this.alternateReferenceGridView.dsModel.layout.rowsHeader=!1,this._SuggestionUsageAlternateModal.appendChild(this._SuggestionUsagedataGridViewDiv),this.alternateReferenceGridView.show(),this.alternateReferenceGridView.inject(this._SuggestionUsagedataGridViewDiv)}})}),define("DS/ENOXAlternateSubstitute/services/AlternateItemsFactory",["UWA/Class","DS/ENOXAlternateSubstitute/views/AlternateItemModel","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","UWA/Utils/InterCom","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i,o){"use strict";return e.singleton({initialize:function(e){this.options=e},getValidStatus:function(e,t){if(e.options[i.CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS]&&e.options[i.CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS]&&e.options[i.CONSTANT_OTHER_CONTEXT_SAME_STATUS_EXISTS]==i.CONSTANT_NO){var n=o.get("eng.alternate.column.status.multiple");return this.buildIconSpan(null,n,t)}var a=this.getStatus(e);return a?this.buildIconSpan(a[i.CONSTANT_STATUS_ICON_CLASS],a[i.CONSTANT_STATUS],t):""},buildIconSpan:function(e,t,n){var a="enox-alternate-status",o="enox-alternate-status-text",r="16px";n&&(a="enox-alternate-tilesview-status",o="enox-alternate-tilesview-status-text",r="14px");var s=new UWA.createElement("div",{class:a});if(e===i.CONSTANT_ICON_OBSOLETE_WUC_CLASS)this.buildIconForObsoleteWUC(s,e);else if(e){var l=new UWA.createElement("div",{class:e});l.style.fontSize=r,s.append(l)}var T=new UWA.createElement("span",{class:o});return T.addContent(t),s.append(T),s},getChangeIcon:function(e){var t=UWA.createElement("span");if(e.options.grid.WorkUnderChangeActionPhyId&&""!=e.options.grid.WorkUnderChangeActionPhyId){t.setText(" | "),attributesDiv.appendChild(t);var n=new UWA.createElement("img",{class:"enox-alternate-statusIcon fonticon fonticon-change-action-proposed "+i.CONSTANT_ICON_QUALIFIED_CLASS});n.style.fontSize="16px",attributesDiv.appendChild(n)}},getStatus:function(e,t){var n,a=e.options.grid;return a[i.CONSTANT_STATUS]==i.CONSTANT_NOT_APPLICABLE?n=this.buildStatusIconClass(i.CONSTANT_ICON_SPLIT,i.CONSTANT_ICON_SPLIT_CLASS,o.get("eng.alternate.status.NotApplicable"),a,t):a[i.CONSTANT_STATUS]==i.CONSTANT_PROPOSED?n=this.buildStatusIconClass(i.CONSTANT_ICON_PROPOSED,i.CONSTANT_ICON_PROPOSED_CLASS,o.get("eng.alternate.status.proposed"),a,t):a[i.CONSTANT_STATUS]!=i.CONSTANT_QUALIFIED||a[i.CONSTANT_WORK_UNDER_CHANGE]?a[i.CONSTANT_STATUS]==i.CONSTANT_OBSOLETE?n=this.buildStatusIconClass(i.CONSTANT_ICON_OBSOLETE,i.CONSTANT_ICON_OBSOLETE_CLASS,o.get("eng.alternate.status.obsolete"),a,t):(a[i.CONSTANT_STATUS]==i.CONSTANT_CHANGE_ATTACHED||a[i.CONSTANT_STATUS]==i.CONSTANT_QUALIFIED&&a[i.CONSTANT_WORK_UNDER_CHANGE])&&(n=this.buildStatusIconClass(i.CONSTANT_ICON_WARNING,i.CONSTANT_ICON_OBSOLETE_WUC_CLASS,o.get("eng.alternate.status.qualified"),a,t)):n=this.buildStatusIconClass(i.CONSTANT_ICON_QUALIFIED,i.CONSTANT_ICON_QUALIFIED_CLASS,o.get("eng.alternate.status.qualified"),a,t),n},buildIconForObsoleteWUC:function(e,t){var n=new UWA.createElement("div",{class:"fonticon fonticon-"+i.CONSTANT_ICON_QUALIFIED+" "+i.CONSTANT_ICON_QUALIFIED_CLASS});n.style.fontSize="14px",e.append(n);var a=new UWA.createElement("div",{class:"enox-alternate-statusIcon fonticon fonticon-"+i.CONSTANT_ICON_WARNING+" "+t});a.style.fontSize="10px",e.append(a)},buildStatusIconClass:function(e,t,n,a,r){new UWA.createElement("div",{class:"enox-alternate-status"});var s,l,T=a[i.CONSTANT_OPERATION_KEY]==i.CONSTANT_OPERATION_KEY_VALUE_ALTERNATE?o.get("eng.alternate.status.context.applicable.all"):o.get("eng.alternate.status.context.applicable.this");l=a[i.CONSTANT_OPERATION_KEY]==i.CONSTANT_OPERATION_KEY_VALUE_ALTERNATE||r?n:o.get("eng.alternate.status.context.applicable.yes").replace("$1",n).replace("$2",T),t===i.CONSTANT_ICON_OBSOLETE_WUC_CLASS?(s=t,l=o.get("eng.alternate.status.qualified.WUC").replace("$1",l)):s="enox-alternate-statusIcon fonticon fonticon-"+e+" "+t;var A={};return A[i.CONSTANT_STATUS_ICON_CLASS]=s,A[i.CONSTANT_STATUS]=l,A},getUsageDetails:function(e,t){var n="";if(this.checkIfHeaderNode(e)){var a=this.getNodeCounterQuantity(e),r=o.get("eng.alternate.views.tiles.header.usage").replace("$1"," "+a);n=t?r:""}else e.options.grid[i.CONSTANT_OPERATION_KEY]==i.Operation_Alternate?n=o.get("eng.alternate.datagrid.column.usage.all"):e.options.grid[i.CONSTANT_OPERATION_KEY]==i.Operation_InstanceSubstitute?n=e.options.grid[i.CONSTANT_SPLIT]==i.SPLIT_YES?o.get("eng.alternate.datagrid.column.usage.alternate.applicable.other.context")+e.options.grid[i.CONSTANT_OTHER_CONTEXT_APPLICABLE_ALTERNATE_REF_PHYSICALD].length:o.get("eng.alternate.datagrid.column.usage.instance")+e.options.grid[i.CONSTANT_INSTANCE_CONTEXT_TITLE]:e.options.grid[i.CONSTANT_OPERATION_KEY]==i.Operation_ReferenceSubstitute&&(n=o.get("eng.alternate.datagrid.column.usage.reference")+e.options.grid[i.CONSTANT_PARENT_CONTEXT_TITLE]+"  "+e.options.grid[i.CONSTANT_PARENT_CONTEXT_REVISION]);return n},getNodeCounterQuantity:function(e){return e.getChildren()?e.getChildren().length:"0"},getNlsOfGroupByTitle:function(e){var t=e.getProperty(),n=e.getIdentifier(),a=e.getChildren&&e.getChildren()?e.getChildren().length:"0",r=e.getOriginalChildrenInformation&&e.getOriginalChildrenInformation()&&e.getOriginalChildrenInformation().notHiddenNotFilteredChildrenCount?e.getOriginalChildrenInformation().notHiddenNotFilteredChildrenCount:a,s="",l=this.getNLSPropertyMap(t);return s=t==i.CONSTANT_ALT_ID?e.getChildren()&&e.getChildren()[0].getDisplayName():this.getNLSPropertyMap(n),e.getNodeSource()&&(e._options.label=o.get("eng.alternate.groupBy.title").replace("$1",l).replace("$2",s).replace("$3",r)),o.get("eng.alternate.groupBy.title").replace("$1",l).replace("$2",s).replace("$3",r)},getNLSPropertyMap:function(e){var t={};return t[i.CONSTANT_STATUS]=o.get("eng.alternate.column.status"),t[i.CONSTANT_DATAGRID_COLUMN_REVISION]=o.get("eng.alternate.column.revision"),t[i.CONSTANT_DATAGRID_MATURITY_STATE]=o.get("eng.alternate.column.maturityState"),t[i.CONSTANT_DATAGRID_PART_NUMBER]=o.get("eng.alternate.column.partNumber"),t[i.CONSTANT_OPERATION_KEY]=o.get("eng.alternate.label.usageScope"),t[i.CONSTANT_ALT_ID]=o.get("eng.alternate.groupby.options.reference"),t[i.CONSTANT_SUGGESTION_SELECT_USAGE]=o.get("eng.alternate.suggestion.usage.details"),t[i.CONSTANT_DATAGRID_COLUMN_SOURCE]=o.get("eng.alternate.suggestion.source.details"),t[i.CONSTANT_PROPOSED]=o.get("eng.alternate.status.proposed"),t[i.CONSTANT_QUALIFIED]=o.get("eng.alternate.status.qualified"),t[i.CONSTANT_OBSOLETE]=o.get("eng.alternate.status.obsolete"),t[i.Operation_Alternate]=o.get("eng.alternate.usage.all"),t[i.Operation_InstanceSubstitute]=o.get("eng.alternate.usage.instance"),t[i.Operation_ReferenceSubstitute]=o.get("eng.alternate.usage.reference"),t[i.CONSTANT_SELECT_USAGE_ALL]=o.get("eng.alternate.select.usage.all"),t[i.CONSTANT_SELECT_USAGE_REFERENCE]=o.get("eng.alternate.select.usage.reference"),t[i.CONSTANT_SELECT_USAGE_INSTANCE]=o.get("eng.alternate.select.usage.instance"),t[i.CONSTANT_SUGGESTION_REVISION]=o.get("eng.alternate.suggestion.revision"),t[i.CONSTANT_SUGGESTION_PREVIOUS_REVISION]=o.get("eng.alternate.suggestion.previous.revision"),t[i.CONSTANT_SUGGESTION_BRANCH_FROM]=o.get("eng.alternate.suggestion.branch.from"),t[i.CONSTANT_SUGGESTION_BRANCH]=o.get("eng.alternate.suggestion.branch"),t[i.CONSTANT_SUGGESTION_DUPLICATE]=o.get("eng.alternate.suggestion.duplicate"),t[i.CONSTANT_SUGGESTION_OTHER_USAGE]=o.get("eng.alternate.suggestion.other.usages"),t[i.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE]=o.get("eng.alternate.suggestion.alternates.of.alternate"),t[e]?t[e]:e},checkIfHeaderNode:function(e){var n=e&&e.options[i.CONSTANT_OTHER_CONTEXT_KEY],a=!1,o=e&&e._parentNode;return n&&n.length>0&&!(o instanceof t)&&e instanceof t&&e.getVisibleChildren()&&(a=!0),a},checkIfAlternateChildNode:function(e){var n=!1;return(e&&e._parentNode)instanceof t&&(n=!0),n},updateAlternateNode:function(e){var t=e&&e._getRowID&&e._getRowID();if(this.checkIfAlternateChildNode(e)){var n=e&&e._parentNode,a=t-n._getRowID();n.addChild(e,a-1)}else this.options.altOptions._addAlternateUX.ALTERNATE.model.addChild(e,t)},updateGroupBy:function(){this.options.altOptions._addAlternateUX.ALTERNATE.model.isGroupedByView&&this.options.altOptions.groupAlternateNodes({context:this.options.altOptions._addAlternateUX.ALTERNATE.model.groupedByProperty})},removeChildFromParentNode:function(e,t){var a=[],o=e.options[i.CONSTANT_OTHER_CONTEXT_KEY];e.removeChild(t),o&&o.forEach(function(e){t.options.grid[i.CONSTANT_INSTANCE_CONTEXT_LOGICALID]!=e.grid[i.CONSTANT_INSTANCE_CONTEXT_LOGICALID]&&a.push(e)}),e.options[i.CONSTANT_OTHER_CONTEXT_KEY]=a,e.options.grid[i.CONSTANT_DATAGRID_AVAILABLE_CONTEXT]=n.getContextColumnValue(e.options)},getContentForCompassInteraction:function(e){var t=[];if(e){var n={objectId:e.getID(),objectType:e.getType(),displayName:e.getDisplayName(),displayType:e.getType(),facetName:"realized"};t.push(n)}else for(var a=this.options._addAlternateUX.ALTERNATE.model.getSelectedNodes(),i=0;i<a.length;i++){var o={objectId:a[i].getID(),objectType:a[i].getType(),displayName:a[i].getDisplayName(),displayType:a[i].getType(),facetName:"realized"};t.push(o)}var r=this.options.altAppCore.altSettingsManager.getSecurityContext(),s=[];return t.forEach(function(e){var t={envId:widget.getValue("x3dPlatformId"),serviceId:"3DSpace",contextId:r,objectId:e.objectId,objectType:e.objectType,displayName:e.displayName,displayType:e.displayType,facetName:e.facetName?e.facetName:"",path:[{resourceid:e.objectId,type:e.objectType}]};s.push(t)}),{protocol:"3DXContent",version:"1.1",source:widget.data.appId,widgetId:widget.id,data:{items:s}}},openItemWithCompass:function(){var e=this.options._addAlternateUX.ALTERNATE.model.getSelectedNodes(),t=UWA.is(widget)&&widget.id?"xEngAltCompassSocket_"+widget.id:"xEngAltCompassSocket";if(this._compass_socket||(this._compass_socket=new a.Socket(t),this._compass_socket.subscribeServer("com.ds.compass",window.parent)),e&&e.length>0){var n=this.getContentForCompassInteraction();this._compass_socket.dispatchEvent("onSetX3DContent",n,t)}else this._compass_socket.dispatchEvent("onResetX3DContent",{},t)},checkIfNodeSelected:function(e){var t=!1;return e&&(e.isSelected()&&this.options.activeView!==i.CONSTANT_ALTERNATE_VIEW_DATAGRID||!e.isSelected()&&this.options.activeView===i.CONSTANT_ALTERNATE_VIEW_DATAGRID)&&(t=!0),t}})}),define("DS/ENOXAlternateSubstitute/commands/GetAlternates",["UWA/Class","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXAlternateSubstitute/utils/AlternateDataParser","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i,o,r){var s,l,T;return e.singleton({getAlternates:function(e,t){return this.appInfo=e,this.primaryItemPhysicalId=t,this.getRelInfo(e),e.altAppCore.altSettingsManager.isUsingDB()?this.getAlternateUsingDBMode(t):this.getAlternateUsingIndexMode(t)},getAlternateUsingDBMode:function(e){var a=this,o=a.getAlternatePayload(e),r=a.appInfo.altAppCore.altSettingsManager.getCommand("get_alternate");return n.wrappedWithCancellablePromise(function(e,n){t.perform(r,o).then(function(n){r=a.appInfo.altAppCore.altSettingsManager.getCommand("get_PrimaryItemInfo"),t.perform(r,o).then(function(t){var i=a.splitInstanceApplicability(n.AlternateItemInfo),o=a.splitUsage(i);return a.isSelectedPrimaryItemLogicallyIdentical(t.AlternateItemInfo),e(o)}).catch(function(t){console.error(t);var n=t.response&&t.response.message?t.response.message:t;return i.errorAlert(n),e({})})}).catch(function(t){console.error(t);var n=t.response&&t.response.message?t.response.message:t;return i.errorAlert(n),e({})})})},getAlternateUsingIndexMode:function(e,i){var r=this,s=r.getAlternatePayload(e),A=r.appInfo.altAppCore.altSettingsManager.getCommand("get_PrimaryItemInfo");return n.wrappedWithCancellablePromise(function(n,N){t.perform(A,s).then(function(N){var _=N.AlternateItemInfo;A=r.appInfo.altAppCore.altSettingsManager.getCommand("get_AlternateReference");var S=i||_[o.CONSTANT_USER_SELECTED_PRIMARY_ITEM_PHYSICALID_LIST];s=r.getIndexAlternatePayload(S),l=_[o.CONSTANT_CARRYOVER_ALTERNATE],T=_[o.CONSTANT_CARRYOVER_SUBSTITUTE],t.perform(A,s).then(function(t){var o=r.getReferenceIdForIndexData(t);if(!(o.length>0))return n([]);a.doExpand(r.appInfo.altAppCore.altDataServices.getCVServletPayload(o),{executor:"cv_expand_v2"},r.appInfo).then(e=>{var t=r.parsedataforGridView(r.appInfo.parentNode&&r.appInfo.currentNodeId==r.appInfo.parentNode.getID(),_,a.parsedExpandV2Result(e,[]),r.appInfo,i),o=r.splitUsage(t);return r.isSelectedPrimaryItemLogicallyIdentical(_),n(o)}).catch(function(t){return n(r.getErrorResponseOfIndexMode(t,e,i))})}).catch(function(t){return n(r.getErrorResponseOfIndexMode(t,e,i))})}).catch(function(t){return n(r.getErrorResponseOfIndexMode(t,e,i))})})},getErrorResponseOfIndexMode:function(e,t,n){return n?e:this.getAlternateUsingDBMode(t)},getReferenceIdForIndexData:function(e){var t=[];return this.primaryIds={},e.result.forEach((e,n)=>{var a=e.outputs[o.CONSTANT_ALT_REF];if(a)for(n=0;n<a.length;n++)t.push(a[n][o.PHYSICAL_ID]),this.primaryIds[a[n][o.PHYSICAL_ID]]=a[n][o.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID]}),t},getIcons:function(e,t){for(var n=0;n<e.length;n++)if(-1!=e[n].did.indexOf(t.toString()))return e[n][o.CONSTANTS_ICON];return appInfo.altAppCore.altSettingsManager.getDefaultProductIcon()},getThumbnail:function(e,t){for(var n=0;n<e.length;n++)if(-1!=e[n].did.indexOf(t.toString()))return e[n].thumbnail_2d;return appInfo.altAppCore.altSettingsManager.getDefaultProductThumbnail()},getRelInfo:function(e){var t=e.selectedNode;s={};for(var n=[],a=0;a<t.length;a++)if(t[a].getRelationID){var i=e.selectedNode[a].getRelationID();n.push(i),s[i]=e.selectedNode[a].getInstanceName()}s[o.CONSTANT_SELECTED_INSTANCE_INFO]=n},parsedataforGridView:function(e,t,n,a,i){for(var r=[],s={},l=(n.nodes,0);l<n.paths.length;l++){var T=n.paths[l];if(T.length>1){var A=n.nodes[T[0]],N=T[1],_=n.nodes[T[2]];if(s[T[2]]=_,s[T[2]].Path=n.nodes[N],s[T[2]][o.CONSTANTS_ICON]=this.getIcons(n.iconsSet,T[2]),s[T[2]][o.CONSTANTS_THUMNAIL]=_[o.CONSTANTS_THUMNAIL]?_[o.CONSTANTS_THUMNAIL]:this.getThumbnail(n.iconsSet,T[2]),(e||null==e||null==e)&&s[T[2]].Path[o.Element_1_PhysicalId])continue;r.push(this.createAlternateResponse(t,s[T[2]],A,a,i))}}return r},createAlternateResponse:function(e,t,n,a,i){var r={},s=this.isApplicable(e,t,a);return r[o.CONSTANT_DATAGRID_COLUMN_TITLE]=t[o.DS6W_LABEL],r[o.CONSTANT_REVISION]=t[o.DS6W_REVISION],r[o.CONSTANT_PARTNUMBER]=t[o.DS6W_PARTNUMBER],r[o.CONSTANT_SYMMETRIC]=o.SYMETRIC_NO,r[o.CONSTANT_APPLICABILTY]=s[o.CONSTANT_APPLICABILTY],r[o.CONSTANT_SPLIT]=i?o.SPLIT_NO:s[o.CONSTANT_SPLIT],r[o.CONSTANT_ALT_ID]=t[o.PHYSICAL_ID],r[o.CONSTANT_DATAGRID_MATURITY_STATE]=t[o.CONSTANT_CURRENT],r[o.CONSTANT_ROWUID]=t.Path[o.PHYSICAL_ID],r[o.CONSTANTS_ICON]=t[o.CONSTANTS_ICON],r[o.CONSTANTS_THUMNAIL]=t[o.CONSTANTS_THUMNAIL],r[o.CONSTANT_WORK_UNDER_CHANGE_ID]=n[o.CONSTANT_CHANGE_ID],r[o.CONSTANT_STATUS]=s[o.CONSTANT_SPLIT]!=o.SPLIT_YES||i?n[o.CONSTANT_CURRENT]:o.CONSTANT_NOT_APPLICABLE,r[o.CONSTANT_ALT_REF_PHYSICALID]=n[o.PHYSICAL_ID],r[o.CONSTANT_ALT_REF_TITLE]=n[o.DS6W_LABEL],r[o.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID]=this.primaryIds[n[o.PHYSICAL_ID]],this.updateNodeWithContextInformation(e,t,r),r},updateNodeWithContextInformation:function(e,t,n){var a=t.Path[o.Element_1_PhysicalId],i=t.Path[o.Element_2_PhysicalId],r=(e[o.UserSelectedContextRevisionInformation]&&e[o.UserSelectedContextRevisionInformation][a]&&JSON.parse(e[o.UserSelectedContextRevisionInformation][a]),n[o.CONSTANT_APPLICABILTY]&&this.primaryItemPhysicalId!=appInfo.options.activeEngItemTreeInfo._selectedNodeId),s=n[o.CONSTANT_APPLICABILTY]&&a!=appInfo.options.activeEngItemTreeInfo._parentId;if(a&&i)n[o.OPERATION]=o.Operation_InstanceSubstitute,n[o.CONSTANT_CARRYOVER_SUBSTITUTE]=s?T:null;else{if(!a)return n[o.OPERATION]=o.Operation_Alternate,n[o.CONSTANT_CARRYOVER_ALTERNATE]=r?l:null,n;n[o.OPERATION]=o.Operation_ReferenceSubstitute,n[o.CONSTANT_CARRYOVER_SUBSTITUTE]=s?T:null}return n[o.CONTEXT_SCOPE]=t.Path[o.CONTEXT_SCOPE],n[o.CONSTANT_PARENT_CONTEXT_PHYSICALID]=t.Path[o.Element_1_PhysicalId],n[o.CONSTANT_PARENT_CONTEXT_LOGICALID]=t.Path[o.Element_1_LogicalId],n[o.CONSTANT_INSTANCE_CONTEXT_PHYSICALID]=t.Path[o.Element_2_PhysicalId],n[o.CONSTANT_INSTANCE_CONTEXT_LOGICALID]=t.Path[o.Element_2_LogicalId],n[o.CONSTANT_INSTANCE_CONTEXT_TITLE]=this.getInstanceContextTitle(i),a&&this.getApplicableParentObjectTitleAndRevision(n,a),t.Path[o.Element_2_type]==o.Constant_Products&&(n[o.CONSTANT_CONFIG_CONTEXT_PHYSICALID]=t.Path[o.Element_2_PhysicalId]),t.Path[o.Element_3_type]==o.Constant_Products&&(n[o.CONSTANT_CONFIG_CONTEXT_PHYSICALID]=t.Path[o.Element_3_PhysicalId]),n},getInstanceContextTitle(e){var t=appInfo.options.activeEngItemTreeInfo._selectedNodes;if(e)for(var n of t)if(n.getRelationID()==e)return n.getInstanceName();return""},splitUsage(e){var t={};for(var n in e)e[n][o.CONSTANT_STATUS]==o.CONSTANT_NOT_APPLICABLE&&(t[e[n][o.CONSTANT_ALT_ID]]?t[e[n][o.CONSTANT_ALT_ID]].push(e[n][o.CONSTANT_ALT_REF_PHYSICALID]):t[e[n][o.CONSTANT_ALT_ID]]=[e[n][o.CONSTANT_ALT_REF_PHYSICALID]],e[n][o.CONSTANT_OTHER_CONTEXT_APPLICABLE_ALTERNATE_REF_PHYSICALD]=t[e[n][o.CONSTANT_ALT_ID]]);return e},isSelectedPrimaryItemLogicallyIdentical(e){var t=!1;for(var n of e[o.CONSTANT_USER_SELECTED_INSTANCE_LOGICAL_ID_LIST])if(e[o.CONSTANT_USER_SELECTED_INSTANCE_LOGICAL_ID_LIST][0]!=n){t=!0;break}widget.setValue(o.CONSTANT_SELECTED_PRIMARY_ITEM_DIFFERENT_LOGICALID,!t)},getApplicableParentObjectTitleAndRevision:function(e,t){return e[o.CONSTANT_PARENT_CONTEXT_TITLE]=t?appInfo.options.activeEngItemTreeInfo._parentNode.getLabel():"",e[o.CONSTANT_PARENT_CONTEXT_REVISION]=t?appInfo.options.activeEngItemTreeInfo._parentNode.getReferenceVersion():"",e},isApplicable:function(e,t,n){s[o.CONSTANT_SELECTED_INSTANCE_INFO];var a=t.Path[o.Element_1_PhysicalId],i=null,r={};if(r[o.CONSTANT_APPLICABILTY]=o.APPLICABILITY_NO,r[o.CONSTANT_SPLIT]=o.SPLIT_NO,null==a||null==a)return r[o.CONSTANT_APPLICABILTY]=o.APPLICABILITY_YES,r;if(t.Path[o.Element_2_type]==o.Constant_VPMInstance)var l=t.Path[o.Element_2_LogicalId];t.Path[o.Element_2_type]==o.Constant_Products&&(i=t.Path[o.Element_2_PhysicalId]),t.Path[o.Element_3_LogicalId]&&(i=t.Path[o.Element_3_PhysicalId]);var T=n.options.activeEngItemTreeInfo._configModelVersionID;return n.options.viewInfo._isReferenceView&&l?r:((null==i||i==T)&&((null==l||null==l||e[o.CONSTANT_USER_SELECTED_INSTANCE_LOGICAL_ID_LIST].includes(l))&&(isApplicable=e[o.CONSTANT_USER_SELECTED_CONTEXT_REVISION_PHYSICAL_ID_LIST].includes(a),e[o.USER_SELECTED_CONTEXT_CONFIGURED_PRODUCT]&&t.Path&&t.Path.Element_2_PhysicalId&&(isApplicable=s.selectedRelIds.includes(t.Path.Element_2_PhysicalId)),r[o.CONSTANT_APPLICABILTY]=isApplicable?o.APPLICABILITY_YES:o.APPLICABILITY_NO),e[o.CONSTANT_USER_SELECTED_INSTANCE_LOGICAL_ID_LIST].includes(l)&&e[o.CONSTANT_USER_SELECTED_CONTEXT_REVISION_PHYSICAL_ID_LIST].includes(a)&&e[o.USER_SELECTED_CONTEXT_CONFIGURED_PRODUCT]&&!s.selectedRelIds.includes(t.Path.Element_2_PhysicalId)&&(r[o.CONSTANT_SPLIT]=o.SPLIT_YES)),r)},splitInstanceApplicability(e){for(var t=0;t<e.length;t++)e[t][o.CONSTANT_APPLICABILTY]==o.APPLICABILITY_NO&&(e[t][o.CONSTANT_STATUS]=e[t][o.CONSTANT_SPLIT]==o.SPLIT_YES?o.CONSTANT_NOT_APPLICABLE:e[t][o.CONSTANT_STATUS]);return e},getIndexAlternatePayload:function(e){appInfo=this.appInfo;var t=this.appInfo.altAppCore.altSettingsManager.getConfiguration("getIndexModePayloadAttributes");return{input_physical_ids:e,primitives:[{navigate_from_rel:{id:1,filter:{rel_type:[o.CONSTANT_REL_ALTERNATE_OF]}}}],patterns:{ALT_REF:[{id:1}]},patternTypeFilters:{ALT_REF:{typesToReturn:[o.CONSTANT_BUS_ALTERNATE_REFERENCE]}},fileAttributes:[],attributes:t,flags:["returnMatches"],version:3,label:this.appInfo.altAppCore.altSettingsManager.getCVRequestLabel()}},getAlternatePayload:function(e){appInfo=this.appInfo;let t=appInfo.altAppCore.altDataServices.shouldShowInstanceAlternates(appInfo.selectedNode[0]);var n={};if(appInfo.options.viewInfo._isReferenceView||!t){var a=appInfo&&appInfo.parentNode&&appInfo.parentNode.getID?appInfo.parentNode.getID():"";n={[o.CONSTANT_REF_ID]:e,[o.CONSTANT_REFERENCE_PHYSICAL_ID]:a}}else{appInfo.selectedNode&&appInfo.selectedNode[0]&&appInfo.selectedNode[0].getRelationID&&appInfo.selectedNode[0].getRelationID();n={[o.CONSTANT_REF_ID]:e,[o.CONSTANT_CTX_ITEM_ID]:s[o.CONSTANT_SELECTED_INSTANCE_INFO],[o.CONSTANT_INCLUDE_OTHER_CONTEXTS]:!0}}return appInfo.options&&appInfo.options.activeEngItemTreeInfo&&null!=appInfo.options.activeEngItemTreeInfo._configModelVersionID&&(n[o.KEY_CONSTANT_MODEL_ID]=appInfo.options.activeEngItemTreeInfo._configModelVersionID),n}})}),define("DS/ENOXAlternateSubstitute/components/properties/js/PropertiesFacet",["UWA/Class","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/models/EditPropAttributeModel","DS/EditPropWidget/EditPropComponent","DS/ENOXEngineerCommonUtils/XENModal","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i,o,r,s,l){"use strict";return e.singleton({_getPropertiesWidget:function(e){var t=[n.FACET_PROPERTIES,n.FACET_CHANGE,n.FACET_ALTERNATE];this.alternateEditComp=new o({typeOfDisplay:n.ALL,selectionType:n.ALL_SELECTION,displayType:n.POPUP,facets:t,setCloseButton:!1,readOnly:!1,extraNotif:!1,editMode:!1});var i=e.context[s.CONSTANT_PROPERTIES_OBJECT_ID],r=[],l=new a({tenant:e.context[s.CONSTANT_PROPERTIES_TENANT_ID],objectId:i});r.push(l),this.alternateEditComp.show(r)}})}),define("DS/ENOXAlternateSubstitute/commands/AlternateSuggestionSettings",["UWA/Class","UWA/Core","DS/TreeModel/TreeDocument","DS/Windows/Dialog","DS/TreeModel/TreeNodeModel","DS/Controls/Button","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/Handlebars/Handlebars4","DS/Windows/ImmersiveFrame","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","text!DS/ENOXAlternateSubstitute/views/html/EditSuggestionSettings.html","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","css!DS/ENOXAlternateSubstitute/styles/Alternate.css"],function(e,t,n,a,i,o,r,s,l,T,A,N){return e.singleton({initialize:function(e){this.options=e,this.altOptions=e.altOptions},createSettingsDialogBox:function(e,n){var i=this,r={ediTHeaderSuggestionOptions:!0,editSettingsNote:!0},T=s.compile(A),_=r?t.clone(r,!1):{},S=t.createElement("div",{class:"enox-alternate-source-wrapper"});S.innerHTML=T(_);var c=S.querySelector(".enox-suggestion-settings-container");S.querySelector(".enox-suggestion-settings-note").innerHTML=N.get("eng.alternate.suggestion.settings.description");var d=new l;d.inject(e.elements.container),this.settingsDialogbox=new a({title:N.get("eng.alternate.suggestion.settings.title"),content:S,immersiveFrame:d,width:300,height:325,buttons:{Cancel:new o({label:N.get("eng.alternate.button.cancel"),onClick:function(e){i.settingsDialogbox.immersiveFrame.getModel().elements.container.destroy()}}),Ok:new o({label:N.get("eng.alternate.suggestion.settings.ok"),onClick:function(e){var t={};i.alternateSourceModel.getSelectedNodes().forEach((e,n)=>{var a=e.options.grid.tree;t[a]=!0}),i.saveSourceOptions(t,n),i.settingsDialogbox.immersiveFrame.getModel().elements.container.destroy()}})}}),i.settingsDialogbox.addEventListener("close",function(e){i.settingsDialogbox.immersiveFrame.getModel().elements.container.destroy()}),i.getDataGridViewForSettings(c)},getDataGridViewForSettings:function(e){var t=this;this.alternateSourceModel=new n({shouldBeSelected:function(e){return!0}});for(var a=t.altOptions.altAppCore.altSettingsManager.getCommand(T.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[T.CONSTANT_SUGGESTION_SETTINGS_DATA],o=0,r=a.length;o<r;o++){var s=a[o],l=new i({label:s.Title,grid:s});t.alternateSourceModel.addChild(l),(t.options.newSourceSettings&&t.options.newSourceSettings[s.tree]||!t.options.newSourceSettings&&s.tree!=T.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE)&&l.select()}var A=[{text:N.get("eng.alternate.suggestion.settings.header"),dataIndex:"tree",sortableFlag:!0,getCellValue:function(e){return t.altOptions.altAppCore.altItemFactory.getNLSPropertyMap(e.nodeModel.options.grid[T.CONSTANT_SUGGESTION_SOURCE_TITLE])}}],_=t.altOptions.altAppCore.altSettingsManager.getCommand(T.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[T.CONSTANT_SUGGESTION_SETTINGS_COLUMN_OPTIONS];t.alternateSourceGridView=t.options.createDataGridView(t.alternateSourceModel,A,_),t.alternateSourceGridView.dsModel.selectionBehavior.unselectAllOnEmptyArea=!1,t.alternateSourceGridView.dsModel.addEventListener("click",function(e,n){null!=n&&(-1==n.columnID&&-1==n.rowID&&t.enableDisableSourceSaveButton(),n.nodeModel&&(n.nodeModel.onSelect(function(){t.enableDisableSourceSaveButton()}),n.nodeModel.onUnselect(function(){t.enableDisableSourceSaveButton()})))}),this.alternateSourceGridView.show(),this.alternateSourceGridView.inject(e)},saveSourceOptions:function(e,t){var n=this;return r.wrappedWithPromise(function(a,i){n.altOptions.altAppCore.altDataServices.setSourceSettings(T.CONSTANT_SUGGESTION_SOURCE_SETTINGS,JSON.stringify(e)).then(function(i){n.options.newSourceSettings=e,t(),a(n.options.newSourceSettings)}).catch(function(e){i(e)})})},enableDisableSourceSaveButton:function(){this.alternateSourceModel.getSelectedNodes().length>0?this.settingsDialogbox.buttons[T.BUTTON_OK].disabled=!1:this.settingsDialogbox.buttons[T.BUTTON_OK].disabled=!0}})}),define("DS/ENOXAlternateSubstitute/commands/AddSuggestionAlternate",["UWA/Class","UWA/Core","DS/Menu/Menu","DS/TreeModel/TreeDocument","DS/Controls/Find","DS/Windows/Dialog","DS/UIKIT/Iconbar","DS/TreeModel/TreeNodeModel","DS/Controls/Button","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/Handlebars/Handlebars4","DS/Windows/ImmersiveFrame","DS/DataGridView/DataGridView","DS/ENOXEngineerCommonUtils/XENMask","DS/ENOXAlternateSubstitute/components/AlternateFilter","DS/UIKIT/DropdownMenu","DS/ENOXAlternateSubstitute/components/properties/js/PropertiesFacet","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateDataParser","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXAlternateSubstitute/commands/GetAlternates","DS/ENOXAlternateSubstitute/utils/AlternateCommands","DS/ENOXAlternateSubstitute/commands/GetSuggestionAlternateUsage","DS/ENOXAlternateSubstitute/commands/AlternateSuggestionSettings","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","text!DS/ENOXAlternateSubstitute/views/html/AddSuggestionAlternate.html","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","css!DS/ENOXAlternateSubstitute/styles/Alternate.css"],function(e,t,n,a,i,o,r,s,l,T,A,N,_,S,c,d,u,C,E,O,g,p,I,h,m,R,f,D){var L,v,M,b;return e.singleton({initialize:function(e){this.options=e,this.altOptions=e.altOptions},_initDivs:function(){h.initialize(this.options),m.initialize(this.options);var e=A.compile(f);this._suggestedAlternatescontainer=t.createElement("div",{class:"enox-alternate-suggestions-wrapper"}),this._suggestedAlternatescontainer.innerHTML=e(),this._referenceAlternateModal=this._suggestedAlternatescontainer.querySelector(".enox-alternate-suggestion"),this._suggestionSelectedUsageInfo=this._suggestedAlternatescontainer.querySelector(".enox-alternate-suggestion-instance-info"),this._referenceToolbar=this._suggestedAlternatescontainer.querySelector(".enox-alternare-suggestion-toolbar"),this._referencedataGridViewDiv=t.createElement("div",{class:"enox-alternate-suggestion-grid-view"}).inject(this._referenceAlternateModal),this._toolbarLeftContainer=this._suggestedAlternatescontainer.querySelector(".alternate_Suggestion_Toolbar_left_container"),this._toolbarRightContainer=this._suggestedAlternatescontainer.querySelector(".alternate_Suggestion_Toolbar_right_container"),this._suggestionfilterContainer=this._suggestedAlternatescontainer.querySelector(".alternate_Suggestion_Filter_container"),this._SearchMenuContainer=this._suggestedAlternatescontainer.querySelector(".alternate_Suggestion_search_container"),this._rightMenuContainer=this._suggestedAlternatescontainer.querySelector(".alternate_Suggestion_right_menu_container"),this.suggestionsFilterEmptyResultDOM=t.createElement("div",{class:"alternate-suggestion-empty-filter-result"}).inject(this._referenceAlternateModal),this.buildContent()},buildContent:function(){L=this.options.options.activeEngItemTreeInfo._selectedNodes,v=this.options.options.activeEngItemTreeInfo._parentNode,M=this.options.options.viewInfo._isFlatennedView,b=this.options.options.viewInfo._isReferenceORGroupView;var e=L[0];this.contextTitle=e.options.grid[R.CONSTANT_DS_LABEL],this.contextRevision=e.options.grid[R.CONSTANT_DS_REVISION],this.applicableAlternateIds=[],this.initializeSuggestionUsageInfoDivs(this._suggestionSelectedUsageInfo),this.options._buildEmptyFilterDOM(this.suggestionsFilterEmptyResultDOM)},initializeSuggestionUsageInfoDivs:function(e){t.createElement("span",{class:"alternate_usageInfo_container_name"}).inject(e).innerText=D.get("eng.alternate.usage.info.title");var n=t.createElement("span",{class:"alternate_usageInfo_container_value"}).inject(e);this.options.renderSelectedPrimaryObjectInfo(n)},buildToolbar:function(){var e=this,t={container:e._rightMenuContainer,model:e.alternateSuggestionModel,findCB:function(){e._buildFindInDatagrid()},settingsCB:function(){m.createSettingsDialogBox(e.suggestionDialog,function(){e._rightMenuContainerList.destroy(),e._suggestionfilterMenu.destroy(),e.refreshAlternateSuggestion()})}};e._rightMenuContainerList=I.buildToolbarForSuggestions(t),this._suggestionfilterMenu=I.getFilterMenu(this._suggestionfilterContainer)},buildModal:function(e){var t=this,n=new N;return n.inject(t.altOptions.getAltFacetMainContainer()),t.suggestionDialog=new o({title:D.get("eng.alternate.previous.revision.add.title")+" - "+this.contextTitle+"  "+this.contextRevision,content:this._referenceAlternateModal,className:"alternate-suugestion-model",immersiveFrame:n,resizableFlag:!0,width:800,height:550,position:{at:"center",my:"center"},modalFlag:!0,touchMode:!0,buttons:{Reset:new l({label:D.get("eng.alternate.suggestion.button.back.label"),onClick:function(n){t.suggestionDialog.buttons[R.BUTTON_CANCEL].dialog.destroy(),e.show()}}),SaveAll:new l({label:D.get("eng.alternate.button.add.label"),onClick:function(n){var a=t.alternateSuggestionModel.getSelectedNodes(),i=t.validateSuggestedAlternates(a);i&&i.length>0&&(t.addSuggestedItems(i),t.suggestionDialog.buttons[R.BUTTON_CANCEL].dialog.destroy(),e.close())}}),Cancel:new l({onClick:function(n){t.suggestionDialog.buttons[R.BUTTON_CANCEL].dialog.destroy(),e.close()}})}}),t.suggestionDialog.buttons[R.BUTTON_SAVE].disabled=!0,t.suggestionDialog.addEventListener("close",function(t){e.close()}),t.suggestionDialog},_buildFindInDatagrid:function(){var e=this,t=e.alternatSuggestionGridView.dsModel;e.findWidget&&e.findWidget.relatedWidget?(t.closeFind(),e.findWidget.destroy()):(e.findWidget=new i({displayMatchCaseToggle:!1,relatedWidget:t,onFindRequest:t.setFindStr,onFindPreviousResult:t.goToPreviousMatchingCell,onFindNextResult:t.goToNextMatchingCell,onFindClose:function(){t.closeFind(),e.findWidget.destroy()}}).inject(e._SearchMenuContainer),e.findWidget.getContent().style.position="relative",e.findWidget.focus())},getSuggestedItems:function(e){var t=this,n={},a={};return a[R.CONSTANT_SUGGESTION_VERSION_GRAPH_PAYLOAD_ID]=e,a[R.CONSTANT_VERSION_GRAPH_PAYLOAD_ATTRIBUTE]=t.altOptions.altAppCore.altSettingsManager.getCommand(R.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[R.CONSTANT_VERSION_GRAPH_ATTRIBUTES],n[R.CONSTANT_SUGGESTION_VERSION_GRAPH_PAYLOAD]=[a],T.wrappedWithCancellablePromise(function(e,a){t.altOptions.altAppCore.altDataServices.getRelatedItemsUsingVersionGraphServices(n).then(function(n){if(n.hasOwnProperty(R.ERROR)){var a=n.error.message?n.error.message:n;return a=n.response&&n.response.message?n.response.message:a,void C.errorAlert(a)}var i=t.splitPrimaryIdsWithSource(n);return e(i)})}).catch(function(e){return resolve(e)})},splitPrimaryIdsWithSource:function(e){var t=this,n={},a=[],i=[],o=[],r=[],s=[],l=[],T=e[R.CONSTANT_SUGGESTION_VERSION_GRAPHS];return T&&T.forEach((e,n)=>{var T=e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_VERSIONS];e.item[R.CONSTANT_SUGGESTION_VERSION_GRAPH_VID];T.forEach((e,n)=>{var T=e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_ID];!e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS]&&e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_COPYFROM]?(i.push(T),L[0].getID()==T&&i.push(e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_COPYFROM])):e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS]&&"S"===e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS][0].semantic?(r.push(T),L[0].getID()==T&&(s.push(e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS][0].id),t.removeIdFromBranchAndRevision(e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS][0].id,r,a))):(e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS]&&"E"===e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_ANCESTORS][0].semantic||!e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_COPYFROM])&&(L[0].getID()===T&&e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_DERIVEDFROM]?(o.push(e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_DERIVEDFROM]),t.removeIdFromBranchAndRevision(e[R.CONSTANT_SUGGESTION_VERSION_GRAPH_DERIVEDFROM],r,a)):-1==s.indexOf(T)&&-1==o.indexOf(T)&&a.push(T)),L[0].getID()==T&&l.push(T)})}),(t.options.newSourceSettings&&t.options.newSourceSettings[R.CONSTANT_REVISION_IDS]||!t.options.newSourceSettings)&&(n[R.CONSTANT_REVISION_IDS]=a,n[R.CONSTANT_PREVIOUS_REVISION_IDS]=o),(t.options.newSourceSettings&&t.options.newSourceSettings[R.CONSTANT_OTHER_USAGE_IDS]||!t.options.newSourceSettings)&&(n[R.CONSTANT_OTHER_USAGE_IDS]=l),(t.options.newSourceSettings&&t.options.newSourceSettings[R.CONSTANT_PREVIOUS_REVISION_IDS]||!t.options.newSourceSettings)&&(n[R.CONSTANT_PREVIOUS_REVISION_IDS]=o),(t.options.newSourceSettings&&t.options.newSourceSettings[R.CONSTANT_DUPLICATE_IDS]||!t.options.newSourceSettings)&&(n[R.CONSTANT_DUPLICATE_IDS]=i),(t.options.newSourceSettings&&t.options.newSourceSettings[R.CONSTANT_BRANCH_FROM_IDS]||!t.options.newSourceSettings)&&(n[R.CONSTANT_BRANCH_FROM_IDS]=s),(t.options.newSourceSettings&&t.options.newSourceSettings[R.CONSTANT_BRANCH_IDS]||!t.options.newSourceSettings)&&(n[R.CONSTANT_BRANCH_IDS]=r,n[R.CONSTANT_BRANCH_FROM_IDS]=s),n},removeIdFromBranchAndRevision:function(e,t,n){var a=n.indexOf(e);-1!=a&&n.splice(a,1);var i=t.indexOf(e);-1!=i&&t.splice(i,1)},registerAlternateFilter:function(){var e=this;this.altSuggestionFilterManager=e.alternateSuggestionModel.getFilterManager(),this.altSuggestionFilterManager.registerFilter("stringRole",c);var t={},n=e.altOptions.altAppCore.altSettingsManager.getCommand(R.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[R.CONSTANT_ALTERNATE_SUGGESTION_FILTER];new d({target:e._suggestionfilterContainer,multiSelect:!0,position:"bottom left",closeOnClick:!0,items:[],events:{onClick:function(n,a){var i=a.name;if(a.selected)t[i]={filterId:"stringRole",filterModel:{allowedRoles:t[a.name]?t[a.name].filterModel.allowedRoles.push(a.id)&&t[a.name].filterModel.allowedRoles:[a.id]}};else{var o=t[a.name].filterModel.allowedRoles.indexOf(a.id);t[a.name].filterModel.allowedRoles.length>1?t[a.name].filterModel.allowedRoles.splice(o,1):delete t[i]}e.altSuggestionFilterManager.filterModel={},e.alternateSuggestionModel.setFilterModel(t),0==Object.keys(t).length||0==e.alternateSuggestionModel._getTrueRoot().getNumberOfVisibleChildren()&&e.alternateSuggestionModel._getTrueRoot().getNumberOfDescendants()>0?(e._referencedataGridViewDiv.hide(),e.suggestionsFilterEmptyResultDOM.show()):(e._referencedataGridViewDiv.show(),e.suggestionsFilterEmptyResultDOM.hide())}.bind(e)}}).addItem(I.renderDropdownItems(n,t))},createAlternateSuggestionModel:function(e){this._initDivs(),this.suggestionDialog=this.buildModal(e),this.refreshAlternateSuggestion()},refreshAlternateSuggestion:function(){this.buildContextViewContent(),this.buildToolbar(),this.registerAlternateFilter()},addSuggestedItems:function(e){var t=this,n=t.getSuggestedAlternatePayload(e);t.altOptions.altAppCore.altDataServices.addAlternteFromSuggestedItems(n,L[0],t.options).then(function(e){if(e.hasOwnProperty(R.ERROR)){var n=e.error.message?e.error.message:e;return n=e.response&&e.response.message?e.response.message:n,void C.errorAlert(n)}if(e.status==R.SUCCESS){t.altOptions.altAppCore.altSettingsManager.setAuthoringMode(R.CONSTANT_AUTHORING_MODE);var a=t.altOptions._addAlternateUX.ALTERNATE.model.getAllDescendants(),i={},o=[],r=!1,s=O.createAlternateItemNodes(E.mergeItemsOnAlternateCriteria(e.AlternateItemInfo));for(var l in s)i[s[l].options[R.CONSTANT_ALT_ID]]=s[l];for(var T in a)i[a[T].options[R.CONSTANT_ALT_ID]]?o.push(a[T]):a[T].options[R.CONSTANT_STATUS]==R.CONSTANT_NOT_APPLICABLE&&(r=!0);t.altOptions.alternateCollectionToolBarModelEvents.publish({event:R.HIDE_SHOW_MAKE_APPLICABLE_CMD,data:r}),o.length>0&&t.altOptions.removeDeletedRowFromView(o),t.altOptions._addAlternateUX.ALTERNATE.append(s),""==L[0].options.grid[R.CONSTANT_COLUMN_ALTERNATE_KEY]&&(t.altOptions.hasAlternatesInOtherContexts=!1,t.altOptions.updateAlternateColumnWithValue(D.get("eng.altenante.datagrid.column.alternate.value"))),C.sucessAlert(D.get("eng.alternate.add.success.message")),t.altOptions.switchView(t.altOptions.activeView),t.altOptions._addAlternateUX.ALTERNATE.model.isGroupedByView&&t.altOptions.groupAlternateNodes({context:t.altOptions._addAlternateUX.ALTERNATE.model.groupedByProperty})}})},getSuggestedAlternatePayload:function(e){var t=[],n=v.options.grid[R.CONSTANT_KEY_PHYSICALID];return e&&e.forEach((e,a)=>{if(e._isFromOriginalModel()){var i={},o=e.options.grid,r=null!=o.id?o.id:o[R.CONSTANT_ALT_ID];if(o[R.CONSTANT_SUGGESTION_SELECT_USAGE]==R.CONSTANT_SELECT_USAGE_REFERENCE)i[R.CONSTANT_ALT_ID]=r,i[R.CONSTANT_REFERENCE_PHYSICAL_ID]=n,t.push(i);else if(o[R.CONSTANT_SUGGESTION_SELECT_USAGE]==R.CONSTANT_SELECT_USAGE_INSTANCE)for(var s in L){(i={})[R.CONSTANT_ALT_ID]=r,i[R.CONSTANT_CTX_ITEM_ID]=L[s].options.instanceId,t.push(i)}else i[R.CONSTANT_ALT_ID]=r,t.push(i)}}),t},validateSuggestedAlternates:function(e){for(var t=[],n=[],a=0;a<e.length;a++)if(e[a]._isFromOriginalModel()){if(!this.validateSelectedUsage(e[a]))return;var i=e[a].getID(),o=e[a].options.grid[R.CONSTANT_SUGGESTION_SELECT_USAGE],r=t.indexOf(i);if(-1==r)n.push(e[a]),t.push(i);else if(n[r].options.grid[R.CONSTANT_SUGGESTION_SELECT_USAGE]!=o)return void C.errorAlert(e[a].getDisplayName()+D.get("eng.alternate.suggestion.multiple.usage.error"))}return n},validateSelectedUsage:function(e){var t=!0;return v.getID()!=L[0].getID()&&!M||e.options.grid[R.CONSTANT_SUGGESTION_SELECT_USAGE]==R.CONSTANT_SELECT_USAGE_ALL?b&&e.options.grid[R.CONSTANT_SUGGESTION_SELECT_USAGE]===R.CONSTANT_SELECT_USAGE_INSTANCE?(C.errorAlert(e.getDisplayName()+D.get("eng.alternate.suggestion.reference.view.error")),t=!1):e.options[R.CONSTANT_DATAGRID_COLUMN_SOURCE]===R.CONSTANT_SUGGESTION_OTHER_USAGE&&e.options.grid[R.CONSTANT_SUGGESTION_SELECT_USAGE]===R.CONSTANT_SELECT_USAGE_ALL&&(C.errorAlert(e.getDisplayName()+D.get("eng.alternate.suggestion.other.usage.error")),t=!1):(C.errorAlert(e.getDisplayName()+D.get("eng.alternate.suggestion.flattened.view.error")),t=!1),t},getSuggestionAlternates:function(e,t){return p.getAlternateUsingIndexMode(e,t)},buildContextViewContent:function(){var e=this;this.alternateSuggestionModel=new a({shouldBeSelected:function(e){return!0}}),S.mask(e.suggestionDialog.elements._contentDiv);var t=L[0];e.getSuggestedItems(t.getID()).then(function(n){var a=e.mergeWithAlternateIds(n);e.getSuggestionAlternates(t.getID(),a).then(function(t){var a=e.buildAlternateSourceInfo(t,n),i=e.sortSourceByPreference(a),o=e.removeDuplicateIds(i,n),r=O.createAlternateItemWithNotApplicableData(o,!0);if(e.alternateSuggestionModel.addRoot(r),e.sources&&Object.keys(e.sources).length>1){var s={option:R.CONSTANT_DATAGRID_COLUMN_SOURCE,model:e.alternateSuggestionModel};I.groupSuggestions({context:s})}e.getDataGridView(),S.unmask(e.suggestionDialog.elements._contentDiv)}).catch(function(e){console.error(e)})}).catch(function(e){console.error(e)})},mergeWithAlternateIds:function(e){var t=this;t.applicableAlternateIds=[];var n=[];return t.altOptions.alternateModel&&t.altOptions.alternateModel.getAllDescendants().length>0&&t.altOptions.alternateModel.getAllDescendants().forEach((e,n)=>{e._isFromOriginalModel()&&e.options[R.CONSTANT_STATUS]!=R.CONSTANT_NOT_APPLICABLE&&t.applicableAlternateIds.push(e.getID())}),t.options.newSourceSettings&&t.options.newSourceSettings[R.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE]&&(n=n.concat(t.applicableAlternateIds),e[R.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE]=t.applicableAlternateIds),e&&Object.keys(e).forEach((t,a)=>{n=n.concat(e[t])}),n},sortSourceByPreference:function(e){var t=[];return[R.CONSTANT_SUGGESTION_PREVIOUS_REVISION,R.CONSTANT_SUGGESTION_REVISION,R.CONSTANT_SUGGESTION_BRANCH_FROM,R.CONSTANT_SUGGESTION_BRANCH,R.CONSTANT_SUGGESTION_DUPLICATE,R.CONSTANT_SUGGESTION_OTHER_USAGE,R.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE].forEach((n,a)=>{e[n]&&(t=t.concat(e[n]))}),t},buildAlternateSourceInfo:function(e,t){var n=this,a={};return e&&e.length>0&&e.forEach(e=>{-1===n.applicableAlternateIds.indexOf(e[R.CONSTANT_ALT_ID])&&(t&&t[R.CONSTANT_OTHER_USAGE_IDS]&&-1!=t[R.CONSTANT_OTHER_USAGE_IDS].indexOf(e[R.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])?e[R.CONSTANT_DATAGRID_COLUMN_SOURCE]=R.CONSTANT_SUGGESTION_OTHER_USAGE:t&&t[R.CONSTANT_BRANCH_FROM_IDS]&&-1!=t[R.CONSTANT_BRANCH_FROM_IDS].indexOf(e[R.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])?e[R.CONSTANT_DATAGRID_COLUMN_SOURCE]=R.CONSTANT_SUGGESTION_BRANCH_FROM:t&&t[R.CONSTANT_BRANCH_IDS]&&-1!=t[R.CONSTANT_BRANCH_IDS].indexOf(e[R.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])?e[R.CONSTANT_DATAGRID_COLUMN_SOURCE]=R.CONSTANT_SUGGESTION_BRANCH:t&&t[R.CONSTANT_PREVIOUS_REVISION_IDS]&&-1!=t[R.CONSTANT_PREVIOUS_REVISION_IDS].indexOf(e[R.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])?e[R.CONSTANT_DATAGRID_COLUMN_SOURCE]=R.CONSTANT_SUGGESTION_PREVIOUS_REVISION:t&&t[R.CONSTANT_DUPLICATE_IDS]&&-1!=t[R.CONSTANT_DUPLICATE_IDS].indexOf(e[R.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])?e[R.CONSTANT_DATAGRID_COLUMN_SOURCE]=R.CONSTANT_SUGGESTION_DUPLICATE:t&&t[R.CONSTANT_REVISION_IDS]&&-1!=t[R.CONSTANT_REVISION_IDS].indexOf(e[R.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])?e[R.CONSTANT_DATAGRID_COLUMN_SOURCE]=R.CONSTANT_SUGGESTION_REVISION:t&&t[R.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE]&&-1!=t[R.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE].indexOf(e[R.CONSTANT_ALTERNATE_PRIMARY_ITEM_PHYSICAL_ID])&&(e[R.CONSTANT_DATAGRID_COLUMN_SOURCE]=R.CONSTANT_SUGGESTION_ALTERNATES_OF_ALTERNATE),n.getSelectUsageData(e),n.splitItemBasedonSource(e,a))}),a},splitItemBasedonSource:function(e,t){t.hasOwnProperty(e[R.CONSTANT_DATAGRID_COLUMN_SOURCE])?t[e[R.CONSTANT_DATAGRID_COLUMN_SOURCE]].push(e):t[e[R.CONSTANT_DATAGRID_COLUMN_SOURCE]]=[e]},removeDuplicateIds:function(e,t){var n=[],a=[];this.sources={},this.suggestedAltInfo={};for(var i=0;i<e.length;i++){var o=e[i][R.CONSTANT_ALT_ID]+e[i][R.CONSTANT_DATAGRID_COLUMN_SOURCE],r=n.indexOf(o);-1==r?(e[i][R.CONSTANT_DATAGRID_COLUMN_USAGE_COUNT]=1,a.push(e[i]),n.push(o),this.suggestedAltInfo[o]=[e[i][R.CONSTANT_ALT_REF_PHYSICALID]]):a[r]&&(a[r][R.CONSTANT_DATAGRID_COLUMN_USAGE_COUNT]++,this.suggestedAltInfo[o].push(e[i][R.CONSTANT_ALT_REF_PHYSICALID])),this.splitItemBasedonSource(e[i],this.sources)}return a},getSelectUsageData:function(e){var t={};t[R.Operation_Alternate]=R.CONSTANT_SELECT_USAGE_ALL,t[R.Operation_InstanceSubstitute]=R.CONSTANT_SELECT_USAGE_INSTANCE,t[R.Operation_ReferenceSubstitute]=R.CONSTANT_SELECT_USAGE_REFERENCE;var n=e[R.CONSTANT_OPERATION_KEY];e[R.CONSTANT_SUGGESTION_SELECT_USAGE]=t[n]},getDataGridView:function(){var e=this,t=e.altOptions.altAppCore.altSettingsManager.getCommand(R.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[R.CONSTANT_SUGGESTION_COLUMN_INFO],n=g._getDataGridColumns(t,e.altOptions.altAppCore),a=e.altOptions.altAppCore.altSettingsManager.getCommand(R.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[R.CONSTANT_SUGGESTION_COLUMN_OPTIONS];e.alternatSuggestionGridView=e.options.createDataGridView(e.alternateSuggestionModel,n,a),e.alternatSuggestionGridView.dsModel.selectionBehavior.unselectAllOnEmptyArea=!1,e.alternateSuggestionModel.expandAll(),e.alternatSuggestionGridView.dsModel.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(e.buildSelectUsageTypeRepresentation())),this._referenceAlternateModal.appendChild(this._referencedataGridViewDiv),e.alternatSuggestionGridView.dsModel.onContextualEvent=function(t){var n=[],a=t.cellInfos&&t.cellInfos.nodeModel?t.cellInfos.nodeModel:"";if(-1===(t.cellInfos?t.cellInfos.rowID:"")||!a)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(t,i):[];if(t&&t.collectionView&&a&&a._isFromOriginalModel()){var i={properties:!0,expandCollapse:!0},o={};o[R.CONSTANT_PROPERTIES_OBJECT_ID]=t.cellInfos.nodeModel.options[R.CONSTANT_ALT_ID],o[R.CONSTANT_PROPERTIES_TENANT_ID]=e.altOptions.altAppCore.altSettingsManager.getPlatformId(),n.push({title:D.get("eng.alternarte.rmb.menu.properties"),icon:"fonticon fonticon-attributes",type:"PushItem",action:{this:e,context:o,callback:e._displayPropertiesWidget.bind(this)}});var r=t.cellInfos.nodeModel.options[R.CONSTANT_ALT_ID]+t.cellInfos.nodeModel.options[R.CONSTANT_DATAGRID_COLUMN_SOURCE],s={Alt_ref_ids:e.suggestedAltInfo[r],usagesInfo:!0,title:t.cellInfos.nodeModel.getLabel()+" "+t.cellInfos.nodeModel.getReferenceVersion()};n.push({title:D.get("eng.alternarte.suggestion.rmb.menu.usages"),icon:"fonticon fonticon-table",type:"PushItem",action:{this:h,context:s,callback:h.createsuggestionReferenceModel}})}return n},e.alternatSuggestionGridView.dsModel.addEventListener("click",function(t,n){if(null!=n){if(n.nodeModel)if(n.nodeModel._isFromOriginalModel()){var a=t.dsModel.layout.getDataIndexFromColumnIndex(n.columnID);if(a==R.CONSTANT_DATAGRID_COLUMN_USAGE_COUNT){var i=n.nodeModel.options[R.CONSTANT_ALT_ID]+n.nodeModel.options[R.CONSTANT_DATAGRID_COLUMN_SOURCE],o={Alt_ref_ids:e.suggestedAltInfo[i],usagesInfo:!0,title:n.nodeModel.getLabel()+" "+n.nodeModel.getReferenceVersion()};h.createsuggestionReferenceModel(o)}else a==R.CONSTANT_REVISION&&widget.appMediator.publish(R.EVENT_LAUNCH_COMMAND,{commandId:R.SHOW_HISTORY_CMD,context:{item:n.nodeModel}});n.nodeModel.onSelect(function(){e.enableDisableAddButton()}),n.nodeModel.onUnselect(function(){e.enableDisableAddButton()})}else n.nodeModel.getChildren().length&&(n.nodeModel.onSelect(function(){n.nodeModel.getChildren()&&n.nodeModel.getChildren().forEach((e,t)=>{e.select()}),e.enableDisableAddButton()}),n.nodeModel.onUnselect(function(){n.nodeModel.getChildren()&&n.nodeModel.getChildren().forEach((e,t)=>{e.unselect()}),e.enableDisableAddButton()}));-1==n.columnID&&-1==n.rowID&&e.enableDisableAddButton()}}),e.alternatSuggestionGridView.dsModel.addEventListener("DSpointerdown",function(t,n){n&&n.nodeModel&&(n.nodeModel.onSelect(function(){e.enableDisableAddButton()}),n.nodeModel.onUnselect(function(){e.enableDisableAddButton()}))}),this.alternatSuggestionGridView.show(),this.alternatSuggestionGridView.inject(e._referencedataGridViewDiv),e.enableDisableAddButton()},buildSelectUsageTypeRepresentation:function(){var e={},t={};return t[R.CONSTANT_SUGGESTION_CUSTOM_TYPE_USAGE]=[D.get("eng.alternate.select.usage.all"),D.get("eng.alternate.select.usage.reference"),D.get("eng.alternate.select.usage.instance")],Object.keys(t).forEach(function(n){e[n]={stdTemplate:"comboSelector",semantics:{possibleValues:t[n]}}}),e},enableDisableAddButton:function(){this.alternateSuggestionModel.getSelectedNodes().length>0?this.suggestionDialog.buttons[R.BUTTON_SAVE].disabled=!1:this.suggestionDialog.buttons[R.BUTTON_SAVE].disabled=!0,this.enabledisableToolbar()},enabledisableToolbar:function(){var e=this._rightMenuContainerList.getItem(R.CONSTANT_SUGGESTION_CHANGE_USAGE);this.alternateSuggestionModel&&this.alternateSuggestionModel.getSelectedNodes().length>0?(e.elements.container.removeClassName("enox-alternate-toolbar-item-disable"),this._rightMenuContainerList.enableItem(e.id)):(e.elements.container.addClassName("enox-alternate-toolbar-item-disable"),this._rightMenuContainerList.disableItem(e.id))},_displayPropertiesWidget:function(e){u._getPropertiesWidget(e)}})}),define("DS/ENOXAlternateSubstitute/commands/AddAlternate",["UWA/Core","UWA/Class","DS/UIKIT/Alert","DS/Controls/Button","DS/Windows/Dialog","DS/UIKIT/Tooltip","DS/Controls/Toggle","DS/Handlebars/Handlebars4","DS/Windows/ImmersiveFrame","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXEngineer/utils/Search","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXEngineer/componentsHelpers/XEngAutoComplete/XEngAutoComplete","DS/ENOXAlternateSubstitute/utils/AlternateDataParser","DS/ENOXAlternateSubstitute/commands/AddSuggestionAlternate","DS/ENOXEngineerCommonUtils/XENTracker","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","text!DS/ENOXAlternateSubstitute/views/html/AddAlternateModal.html"],function(e,t,n,a,i,o,r,s,l,T,A,N,_,S,c,d,u,C,E,O){"use strict";return t.singleton({initialize:function(e){this.options=e.options,this.altAppCore=e.altAppCore,this.altOptions=e.altOptions,this.xenSearchMgmt=new A({multiSel:!1})},_initDivs:function(){var t=s.compile(O);this._container=e.createElement("div",{class:"enox-alternate-add-wrapper"}),this._container.innerHTML=t({contextLabel:!0,autocomplete:!0,alternateContextHeader:!0,alternateContext:!0,suggestionlink:!0}),this._container=this._container.querySelector(".enox-addAlternate"),this._contextLabel=this._container.querySelector(".enox-addAlternate-context-text"),this._mandatorySymbol=this._container.querySelector(".enox-addAlternate-context-mandatory-symbol"),this._autocompleteContainer=this._container.querySelector(".enox-addAlternate-autocomplete"),this._contextHeaderLabel=this._container.querySelector(".enox-addAlternate-context-header-label"),this._contextHeaderInfo=this._container.querySelector(".enox-addAlternate-context-header-info"),this._contextSelectionContainer=this._container.querySelector(".enox-addAlternate-context"),this._alternateAsAll=this._container.querySelector(".enox-addAlternate-context-selection-all"),this._alternateAsInstance=this._container.querySelector(".enox-addAlternate-context-selection-instance"),this._alternateAsReference=this._container.querySelector(".enox-addAlternate-context-selection-reference"),this._suggestionsLink=this._container.querySelector(".enox-addAlternate-suggestion-link")},renderAddAlternateDialog:function(){const t=this.options&&this.options.appCore&&this.options.appCore.sessionManager&&this.options.appCore.sessionManager.getCurrentViewOptions?this.options.appCore.sessionManager.getCurrentViewOptions():{};C.trackCommandLaunched("Alternate_Add",t),this._initDivs(),this.buildDialogboxContent(),this.buildAutoCompleteLabel(),this._contextHeaderLabel.innerText=E.get("eng.alternate.context.selection.header.label");var n=e.createElement("span",{class:"enox-addAlternate-header-tooltip fonticon fonticon-help",html:E.get("eng.alternate.context.selection.header.info").replace("$1",E.get("eng.alternate.status.proposed").bold())+"<br/><br/>"+E.get("eng.alternate.context.selection.header.subinfo").replace("$1",E.get("eng.alternate.status.qualified").bold()).replace("$2",E.get("eng.alternate.tooltip.released").bold())});new o({position:"bottom",trigger:"hover click touch",target:this._contextHeaderInfo,body:n}),this.buildItemSearchComponent(),this.buildSuggestionLink(),this.buildContextSelectionSettings()},buildSuggestionLink:function(){var t=this;this._suggestionsLinkText=e.createElement("a",{class:"enox-addAlternate-suggestion-link"}),this._suggestionsLinkText.innerText=E.get("eng.alternate.suggestion.link.label"),this._suggestionsLink.appendChild(this._suggestionsLinkText),this._suggestionsLink.onclick=function(){t.addAlternateDialogBox.hide(),u.createAlternateSuggestionModel(t.addAlternateDialogBox)}},buildAutoCompleteLabel:function(){this._contextLabelMandatorySymbol=e.createElement("span",{class:"enox-addAlternate-context-mandatory-symbol"}),this._contextLabel.innerText=E.get("eng.alternate.autocomplete.header.label"),this._contextLabelMandatorySymbol.innerText=E.get("eng.alternate.asteric"),this._contextLabel.appendChild(this._contextLabelMandatorySymbol)},buildDialogboxContent:function(){var e=this,t=new l;t.inject(e.altOptions.getAltFacetMainContainer()),e.addAlternateDialogBox=new i({title:E.get("eng.alternate.add.alternate.to").replace("$1",this.altOptions.selectedNode[0].getDisplayName()),content:e._container,immersiveFrame:t,resizableFlag:!0,width:550,height:400,modalFlag:!0,touchMode:!0,buttons:{Ok:new a({label:E.get("eng.alternate.button.add.label"),onClick:function(t){t.dsModel.dialog;e.selectedNodesFromSearch=e.itemSearchAutoComplete.selectedItems;var n=e.altAppCore&&e.altAppCore.altSettingsManager&&e.altAppCore.altSettingsManager.isCloud()?N.SUPPORTED_ALTERNATE_COUNT_ONCLOUD:N.SUPPORTED_ALTERNATE_COUNT_ONPREMISE;if(e.selectedNodesFromSearch&&e.selectedNodesFromSearch.length>n){var a=E.get("eng.alternate.add.maxcount.errormsg").replace("$1",n);T.errorAlert(a)}else 1==e.alternateAsAllRadioButton.checkFlag?e.addAsGlobal(e.itemSearchAutoComplete.selectedItems):1==e.alternateAsInstanceRadioButton.checkFlag?e.addAsInstance(e.itemSearchAutoComplete.selectedItems):1==e.alternateAsReferenceRadioButton.checkFlag&&e.addAsReference(e.itemSearchAutoComplete.selectedItems),e.addAlternateDialogBox.buttons[N.BUTTON_CANCEL].dialog.close()}}),Cancel:new a({onClick:function(e){e.dsModel.dialog.close()}})}}),e.addAlternateDialogBox.buttons[N.BUTTON_OK].disabled=!0},buildContextSelectionSettings:function(){let e=this.altOptions.altAppCore.altDataServices.shouldShowInstanceAlternates(this.altOptions.selectedNode[0]);this.buildAlternateAsReference(),this.buildAlternteAsAll(),this.buildAlternateAsInstance(),this.altOptions.parentNode.getID()==this.altOptions.selectedNode[0].getID()||this.options.viewInfo._isFlatennedView||this.options.viewInfo._isFlatView?(this._alternateAsInstance.classList.add("disabledContent"),this._alternateAsReference.classList.add("disabledContent")):this.options.viewInfo._isReferenceORGroupView||!e?this._alternateAsInstance.classList.add("disabledContent"):1==this.altOptions.selectedNode.length?(this.alternateAsAllRadioButton.checkFlag=!1,this.alternateAsInstanceRadioButton.checkFlag=!0,this.alternateAsReferenceRadioButton.checkFlag=!1):this.altOptions.selectedNode.length>1&&(this.alternateAsAllRadioButton.checkFlag=!1,this.alternateAsInstanceRadioButton.checkFlag=!1,this.alternateAsReferenceRadioButton.checkFlag=!0)},buildRadioButton:function(t,n,a,i){var o=e.createElement("div",{class:"enox-addAlternate-"+t+"-button"}),r=e.createElement("div",{class:"enox-addAlternate-"+t+"-description"});r.addContent(n),a.inject(o),i.appendChild(o),i.appendChild(r)},buildAlternteAsAll:function(){var e=this,t=e.getEscapeHTMLString(this.altOptions.selectedNode[0].getDisplayName()).italics(),n=E.get("eng.alternate.radioButton.all.description").replace("$1",t);this.alternateAsAllRadioButton=new r({type:"radio",checkFlag:!0,label:E.get("eng.alternate.radioButton.all"),value:0}),e.buildRadioButton("addAll",n,this.alternateAsAllRadioButton,this._alternateAsAll),this.alternateAsAllRadioButton.addEventListener("click",function(){e.alternateAsInstanceRadioButton.checkFlag=!1,e.alternateAsReferenceRadioButton.checkFlag=!1})},buildAlternateAsInstance:function(){var e=this,t=e.getEscapeHTMLString(this.altOptions.selectedNode[0].getDisplayName()).italics(),n=(e.getEscapeHTMLString(this.altOptions.parentNode.getDisplayName()).italics(),E.get("eng.alternate.radioButton.instance.description").replace("$1",t).replace("$2",this.altOptions.selectedNode.length));this.alternateAsInstanceRadioButton=new r({type:"radio",checkFlag:!1,label:E.get("eng.alternate.radioButton.instance"),value:0}),e.buildRadioButton("addInstance",n,this.alternateAsInstanceRadioButton,this._alternateAsInstance),this.alternateAsInstanceRadioButton.addEventListener("click",function(){e.alternateAsAllRadioButton.checkFlag=!1,e.alternateAsReferenceRadioButton.checkFlag=!1})},buildAlternateAsReference:function(){var e=this,t=e.getEscapeHTMLString(this.altOptions.selectedNode[0].getDisplayName()).italics(),n=e.getEscapeHTMLString(this.altOptions.parentNode.getDisplayName()).italics(),a=E.get("eng.alternate.radioButton.reference.description").replace("$1",t).replace("$2",n);this.alternateAsReferenceRadioButton=new r({type:"radio",checkFlag:!1,label:E.get("eng.alternate.radioButton.reference")+this.altOptions.parentNode.getDisplayName(),value:0}),e.buildRadioButton("addReference",a,this.alternateAsReferenceRadioButton,this._alternateAsReference),this.alternateAsReferenceRadioButton.addEventListener("click",function(){e.alternateAsAllRadioButton.checkFlag=!1,e.alternateAsInstanceRadioButton.checkFlag=!1})},buildItemSearchComponent:function(){var e=this,t={};t.dataService=e.altAppCore.altDataServices,this.itemSearchAutoComplete=new c({placeholder:E.get("eng.alternate.search.eng.item"),multiSelect:!0,datasetName:"alternate_model",targetTypes:[N.TYPE_VPMREFERENCE],itemMultiSelect:!1,appCore:t,objectMapper:this._selectedAlternateItemMapper.bind(this)}),this.itemSearchAutoComplete.onSearchClick=this.launchSearch.bind(this),e.itemSearchAutoComplete.onUnselectXeng=function(t){e.enableOrDisableAddButton()},e.itemSearchAutoComplete.onSelectXeng=function(t){e.enableOrDisableAddButton()},this.itemSearchAutoComplete.inject(this._autocompleteContainer)},launchSearch:function(e){this.xenSearchMgmt.launchASearch({title:E.get("eng.alternate.select.engineering.item"),allowedTypes:[N.TYPE_VPMREFERENCE],role:"",criteria:"",multiSel:!0,in_apps_callback:this.onSelectedFromSearchForAlternate.bind(this)})},onSelectedFromSearchForAlternate:function(e){var t=[],n=!0;if(this.itemSearchAutoComplete.selectedItems.length)for(var a in e){for(var i in n=!0,this.itemSearchAutoComplete.selectedItems)if(e[a].id==this.itemSearchAutoComplete.selectedItems[i].id){n=!1;break}n&&t.push(e[a])}else t=e;for(var a in t)this.itemSearchAutoComplete.onSelect(this._selectedAlternateItemMapper(t[a]),a);this.enableOrDisableAddButton()},_selectedAlternateItemMapper:function(e){return{id:e[N.CONSTANT_KEY_PHYSICALID]?e[N.CONSTANT_KEY_PHYSICALID]:e.id,value:e[N.CONSTANT_KEY_PHYSICALID]||e.resourceid,label:e[N.CONSTANT_DS_LABEL]+" "+e[N.CONSTANT_DS_REVISION],icon:Array.isArray(e.icons)?e.icons[0]:e.type_icon_url}},addAsGlobal:function(e){var t=this.options.activeEngItemTreeInfo._selectedNodes[0],n=e;this.addAlternateItem(t,[],null,n)},addAsReference:function(e,t){var n=this.options.activeEngItemTreeInfo._selectedNodes,a=this.options.activeEngItemTreeInfo._parentNode.getID(),i=e;this.addAlternateItem(n[0],[],a,i,t)},addAsInstance:function(e,t){for(var n=this.options.activeEngItemTreeInfo._selectedNodes,a=[],i=e,o=0;o<n.length;o++)a.push(n[o].getRelationID&&n[o].getRelationID());this.addAlternateItem(n[0],a,null,i,t)},addAlternateItem:function(e,t,n,a,i){var o=this;o.addAlternateDataService(e,t,n,a).then(function(e){e.hasOwnProperty(N.ERROR)?T.errorAlert(e.response.message):e.status==N.SUCCESS&&o.addAlternateSuccessUXModification(E.get("eng.alternate.add.success.message"),e,i)})},addAlternateDataService:function(e,t,n,a){var i=this;return _.wrappedWithPromise(function(o,r){i.altAppCore.altDataServices.addAlternatePartToEngItem(e,i,t,n,a).then(function(e){o(e)})})},addAlternateSuccessUXModification:function(e,t,n){this.altAppCore.altSettingsManager.setAuthoringMode(N.CONSTANT_AUTHORING_MODE);var a=this.altOptions._addAlternateUX.ALTERNATE.model.getAllDescendants(),i={},o=[],r=!1,s=S.createAlternateItemNodes(d.mergeItemsOnAlternateCriteria(t.AlternateItemInfo));for(var l in s)i[s[l].options[N.CONSTANT_ALT_ID]]=s[l];for(var A in a)i[a[A].options[N.CONSTANT_ALT_ID]]?o.push(a[A]):a[A].options[N.CONSTANT_STATUS]==N.CONSTANT_NOT_APPLICABLE&&(r=!0);this.altOptions.alternateCollectionToolBarModelEvents.publish({event:N.HIDE_SHOW_MAKE_APPLICABLE_CMD,data:r}),n&&(s[0].options[N.CONSTANT_OTHER_CONTEXT_KEY]=n.options[N.CONSTANT_OTHER_CONTEXT_KEY],n.remove()),o.length>0&&this.altOptions.removeDeletedRowFromView(o),this.altOptions._addAlternateUX.ALTERNATE.append(s),""==this.options.activeEngItemTreeInfo._selectedNodes[0].options.grid[N.CONSTANT_COLUMN_ALTERNATE_KEY]&&this.altOptions.updateAlternateColumnWithValue(E.get("eng.altenante.datagrid.column.alternate.value")),T.sucessAlert(e),this.altOptions.switchView(this.altOptions.activeView),this.altOptions._addAlternateUX.ALTERNATE.model.isGroupedByView&&this.altOptions.groupAlternateNodes({context:this.altOptions._addAlternateUX.ALTERNATE.model.groupedByProperty})},enableOrDisableAddButton:function(){null!=this.addAlternateDialogBox&&(this.itemSearchAutoComplete.selectedItems.length>0?this.addAlternateDialogBox.buttons[N.BUTTON_OK].disabled=!1:this.addAlternateDialogBox.buttons[N.BUTTON_OK].disabled=!0)},displayAlertMessage:function(e,t,a){var i={visible:!0,className:"altSub-param-alert",messageClassName:a,closable:!0,renderTo:e,autoHide:!0,hideDelay:2e3,fullWidth:!1};this.addAlternateAlertMsg=new n(i),this.addAlternateAlertMsg.add({message:t})},proposeAlternateItem:function(e,t,n,a,i){var o=this;o.altAppCore.altDataServices.proposeAlternatePartToEngItem(e,t,n,a,i).then(function(e){if(e.hasOwnProperty(N.ERROR))return e.response&&e.response.message&&e.response.message.contains("access")?void T.errorAlert(E.get("eng.alternate.modify.access.error")):void T.errorAlert(e.response.message);if(e.status==N.SUCCESS){o.altAppCore.altSettingsManager.setAuthoringMode(N.CONSTANT_AUTHORING_MODE);for(var t=o.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes(),n=0;n<t.length;n++)o.updateUsageDetails(t[n],i);T.sucessAlert(E.get("eng.alternate.propose.success.message")),o.altAppCore.altItemFactory.updateGroupBy()}})},updateUsageDetails:function(e,t){var n=e._getRowID(),a=this.options.activeEngItemTreeInfo._parentNode,i=a.getLabel?a.getLabel():"",o=a.getReferenceVersion?a.getReferenceVersion():"",r=this.options.activeEngItemTreeInfo._selectedNodes[0].getInstanceName?this.options.activeEngItemTreeInfo._selectedNodes[0].getInstanceName():"";switch(t){case N.CONSTANT_PROPOSE_FOR_ALL:e.options.grid[N.CONSTANT_OPERATION_KEY]=N.Operation_Alternate;break;case N.CONSTANT_PROPOSE_FOR_INSTANCE:e.options.grid[N.CONSTANT_OPERATION_KEY]=N.Operation_InstanceSubstitute,e.options.grid[N.CONSTANT_INSTANCE_CONTEXT_TITLE]=r;break;case N.CONSTANT_PROPOSE_FOR_REFERENCE:e.options.grid[N.CONSTANT_OPERATION_KEY]=N.Operation_ReferenceSubstitute,e.options.grid[N.CONSTANT_PARENT_CONTEXT_TITLE]=i,e.options.grid[N.CONSTANT_PARENT_CONTEXT_REVISION]=o}this.altAppCore.altItemFactory.updateAlternateNode(e,n),e.select()},getEscapeHTMLString:function(t){return e.String.escapeHTML(t)}})}),define("DS/ENOXAlternateSubstitute/utils/AlternateRMBEventHandler",["UWA/Class","DS/WebappsUtils/WebappsUtils","DS/ENOXAlternateSubstitute/commands/AddAlternate","DS/ENOXAlternateSubstitute/utils/AlternateCommands","DS/ENOXAlternateSubstitute/components/properties/js/PropertiesFacet","DS/i3DXCompassPlatformServices/OpenWith","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXAlternateSubstitute/commands/GetSuggestionAlternateUsage","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i,o,r,s,l,T){"use strict";var A,N,_,S,c,d,u,C,E,O="fonticon fonticon-open-menu-dot",g="fonticon fonticon-collaborative-lifecycle-management",p="fonticon fonticon-object-related",I="fonticon fonticon-info-open-in-a-new-window";return e.singleton({initialize:function(e){this.options=e.options,this.altOptions=e.altOptions,l.initialize(e)},getRMBMenu:function(e){var t=this,n=e.cellInfos?e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel:null;A=t.options.activeEngItemTreeInfo._selectedNodes;var a=t.options.activeEngItemTreeInfo._parentNode;return _=a.getLabel(),N=a.getID(),S=e.cellInfos.nodeModel.getOnClickContextAlternateItems()[0],n.options.grid[s.CONSTANT_APPLICABILTY],c=n.options.grid[s.CONSTANT_STATUS],d=n.options.grid[s.CONSTANT_OPERATION_KEY],u=!(n.options[s.CONSTANT_OTHER_CONTEXT_KEY]&&(!n.options[s.CONSTANT_OTHER_CONTEXT_KEY]||0!=n.options[s.CONSTANT_OTHER_CONTEXT_KEY].length)),C=n.options[s.CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS],E=t.altOptions.altAppCore.altItemFactory.checkIfAlternateChildNode(n),t.getOpenWithRMBMenus(e,n).then(function(a){return t.renderRMBMenu(e,n,a)})},renderRMBMenu:function(e,t,n){var i=[],o=this.getQualifyState(t),r=this.getObsoleteState(t),A=this.getRemoveState(),N=this.getApplicableState(t),S=N==s.CONSTANT_MENU_CMD_STATE_ENABLED?s.CONSTANT_MENU_CMD_STATE_DISABLED:s.CONSTANT_MENU_CMD_STATE_ENABLED,c=s.CONSTANT_MENU_CMD_STATE_DISABLED,d=s.CONSTANT_MENU_CMD_STATE_DISABLED,u=s.CONSTANT_MENU_CMD_STATE_DISABLED,C=this.altOptions.altAppCore.altItemFactory.checkIfHeaderNode(t);if(this.activateProposeFor()&&(c=this.getReferenceState(),d=this.getInstanceState(),u=this.getAllUsageState()),null!=t||null!=t){if(t.select(),N!=s.CONSTANT_MENU_CMD_STATE_ENABLED&&i.push({title:T.get("eng.alternarte.rmb.menu.open.title"),icon:O,type:"PushItem",submenu:n}),!C){var E={};if(E[s.CONSTANT_PROPERTIES_OBJECT_ID]=e.cellInfos.nodeModel.options[s.CONSTANT_ALT_REF_PHYSICALID],E[s.CONSTANT_PROPERTIES_TENANT_ID]=this.altOptions.altAppCore.altSettingsManager.getPlatformId(),N!=s.CONSTANT_MENU_CMD_STATE_ENABLED&&(i.push({title:T.get("eng.alternarte.rmb.menu.properties.title"),icon:I,type:"PushItem",state:S,action:{this:this,context:E,callback:this._displayPropertiesWidget.bind(this)}}),i.push({title:T.get("eng.alternate.rmb.menu.proposedfor.title"),icon:"plus",type:"PushItem",state:S,submenu:[{title:T.get("eng.alternate.add.context.all"),type:"PushItem",state:u,action:{this:this,context:e,callback:this._getAddAsGlobal.bind(this)}},{title:T.get("eng.alternate.add.context.reference").replace("$1",_),type:"PushItem",state:c,action:{this:this,context:e,callback:this._getAddAsReference.bind(this)}},{title:T.get("eng.alternate.add.context.instance"),type:"PushItem",state:d,action:{this:this,context:e,callback:this._getAddAsInstance.bind(this)}}]}),this.altOptions.getEnforcedChange()||i.push({title:T.get("eng.alternate.approve"),icon:"check",type:"PushItem",state:o,action:{this:a,context:t,callback:a.approveConfirmPopup}}),i.push({title:T.get("eng.alternate.remove"),icon:"remove",type:"PushItem",state:A,action:{this:a,context:t,callback:a.removeConfirmPopup}}),this.altOptions.getEnforcedChange()||i.push({title:T.get("eng.alternate.obsolete"),icon:"block",type:"PushItem",state:r,action:{this:a,context:t,callback:a.obsoleteConfirmPopup}})),N==s.CONSTANT_MENU_CMD_STATE_ENABLED&&(i.push({title:T.get("eng.alternate.applicable"),icon:"checkbox-on",type:"PushItem",state:widget.getValue(s.CONSTANT_SELECTED_PRIMARY_ITEM_DIFFERENT_LOGICALID)?s.CONSTANT_MENU_CMD_STATE_ENABLED:s.CONSTANT_MENU_CMD_STATE_DISABLED,action:{this:this,context:e,callback:a.makeApplicable}}),this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes&&1==this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes().length)){var h={Alt_ref_ids:e.cellInfos.nodeModel.options[s.CONSTANT_OTHER_CONTEXT_APPLICABLE_ALTERNATE_REF_PHYSICALD],usagesInfo:!0,title:e.cellInfos.nodeModel.getLabel()+" "+e.cellInfos.nodeModel.getReferenceVersion(),navigation:s.CONSTANT_ALTERNATE_USAGE_POPUP_NOT_APPLICABLE_NAVIGATION};i.push({title:T.get("eng.alternarte.suggestion.rmb.menu.usages"),icon:"fonticon fonticon-table",type:"PushItem",action:{this:l,context:h,callback:l.createsuggestionReferenceModel}})}N!=s.CONSTANT_MENU_CMD_STATE_ENABLED&&i.push({id:s.CHANGE_OWNER_CMD,title:T.get("eng.alternate.change_ownership"),icon:"move-to",type:"PushItem",state:S,action:{this:a,context:t,callback:a.moveToCmdHandler}})}N!=s.CONSTANT_MENU_CMD_STATE_ENABLED&&(i.push({title:T.get("eng.alternarte.rmb.menu.maturity.title"),icon:g,type:"PushItem",state:S,action:{this:this,context:t,callback:this._getLifeCycleCmds.bind(this)}}),i.push({title:T.get("eng.alternarte.rmb.menu.relatedobjects.title"),icon:p,type:"PushItem",action:{this:this,context:t,callback:this._getRelatedObjects.bind(this)}}))}return i},getQualifyState:function(e){var t=s.CONSTANT_MENU_CMD_STATE_DISABLED,n=e.options.grid[s.CONSTANT_WORK_UNDER_CHANGE];return c!=s.CONSTANT_PROPOSED||n||(t=s.CONSTANT_MENU_CMD_STATE_ENABLED),C&&(t=s.CONSTANT_MENU_CMD_STATE_ENABLED),t},getRemoveState:function(){var e=s.CONSTANT_MENU_CMD_STATE_DISABLED;return(c==s.CONSTANT_PROPOSED||C)&&(e=s.CONSTANT_MENU_CMD_STATE_ENABLED),e},getObsoleteState:function(e){var t=s.CONSTANT_MENU_CMD_STATE_DISABLED,n=e.options.grid[s.CONSTANT_WORK_UNDER_CHANGE];return(c==s.CONSTANT_QUALIFIED&&!n||C)&&(t=s.CONSTANT_MENU_CMD_STATE_ENABLED),t},getApplicableState:function(e){var t=s.CONSTANT_MENU_CMD_STATE_DISABLED;return(c==s.CONSTANT_NOT_APPLICABLE||C)&&(t=s.CONSTANT_MENU_CMD_STATE_ENABLED),t},getReferenceState:function(){var e=s.CONSTANT_MENU_CMD_STATE_DISABLED;return c!=s.CONSTANT_PROPOSED||d!=s.Operation_Alternate&&(d!=s.Operation_InstanceSubstitute||!u||E)||this.options.viewInfo._isFlatView||(e=s.CONSTANT_MENU_CMD_STATE_ENABLED),A.length>1&&(e=s.CONSTANT_MENU_CMD_STATE_DISABLED),e},getInstanceState:function(){var e=s.CONSTANT_MENU_CMD_STATE_DISABLED;return c!=s.CONSTANT_PROPOSED||d!=s.Operation_Alternate&&d!=s.Operation_ReferenceSubstitute||this.options.viewInfo._isReferenceORGroupView||this.options.viewInfo._isFlatView||(e=s.CONSTANT_MENU_CMD_STATE_ENABLED),A.length>1&&(e=s.CONSTANT_MENU_CMD_STATE_DISABLED),e},getAllUsageState:function(){var e=s.CONSTANT_MENU_CMD_STATE_DISABLED;return c!=s.CONSTANT_PROPOSED||d!=s.Operation_ReferenceSubstitute&&d!=s.Operation_InstanceSubstitute||!u||E||(e=s.CONSTANT_MENU_CMD_STATE_ENABLED),A.length>1&&(e=s.CONSTANT_MENU_CMD_STATE_DISABLED),e},activateProposeFor:function(){return!(A[0].getID()==N||this.options.viewInfo._isFlatennedView)},getEmptyMenu:function(){var e=[];return e.push({title:T.get("eng.alternate.rmb.menu.noactions.title"),type:"PushItem",state:s.CONSTANT_MENU_CMD_STATE_DISABLED}),e},getOpenWithRMBMenus:function(e,t){var n=this.altOptions.altAppCore.altItemFactory.getContentForCompassInteraction(t),a=new o;a.set3DXContent(n,!0);var i=[];if(UWA.is(a.retrieveCompatibleApps,"function"))return new Promise(function(e,n){UWA.is(a.retrieveCompatibleApps,"function")?a.retrieveCompatibleApps(function(n){n.forEach(function(e){i.push({id:e.text,title:e.text,icon:e.fonticon?e.fonticon:e.icon,type:"PushItem",multisel:!1,action:{context:t,callback:e.handler}})}),e(i)}):e([])})},_getLifeCycleCmds:function(e){widget.appMediator.publish(s.EVENT_LAUNCH_COMMAND,{commandId:s.MATURITY_GRAPH_CMD,context:{item:e.context}})},_getRelatedObjects:function(e){widget.appMediator.publish(s.EVENT_LAUNCH_COMMAND,{commandId:s.RELATEDOBJECTS_CMD,context:{item:e.context}})},_getAvailableContexts:function(e){e.context.modelEvents.publish({event:s.CONSTANT_EVENT_TILESVIEW_CONTEXT_CMD,data:e.context.cellInfos.nodeModel})},checkIfValidAlternate:function(e){if(e.grid.WorkUnderChangeActionPhyId&&""!=e.grid.WorkUnderChangeActionPhyId&&!this.altOptions.altAppCore.altSettingsManager.isChangeAuthorized()){var t=T.get("eng.alternate.change.usage.error.msg").replace("$1",e.Title).replace("$2",e.revision);return r.errorAlert(t),!1}return!0},_getAddAsGlobal:function(e){this.checkIfValidAlternate(S)&&n.proposeAlternateItem(A[0],[],null,[S],s.CONSTANT_PROPOSE_FOR_ALL)},_getAddAsReference:function(e){this.checkIfValidAlternate(S)&&n.proposeAlternateItem(A[0],[],N,[S],s.CONSTANT_PROPOSE_FOR_REFERENCE)},_getAddAsInstance:function(e){for(var t=[],a=0;a<A.length;a++)t.push(A[a].getRelationID&&A[a].getRelationID());this.checkIfValidAlternate(S)&&n.proposeAlternateItem(A[0],t,null,[S],s.CONSTANT_PROPOSE_FOR_INSTANCE)},_displayPropertiesWidget:function(e){i._getPropertiesWidget(e)}})}),define("DS/ENOXAlternateSubstitute/commands/RevisionsExplorerForCarryOver",["UWA/Class","DS/Windows/ImmersiveFrame","DS/Handlebars/Handlebars4","DS/Controls/Button","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXEngineerCommonUtils/XENMask","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXAlternateSubstitute/utils/AlternateCommands","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/xEngAlertManager","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","text!DS/ENOXAlternateSubstitute/views/html/CarryOverRevisionsDailog.html"],function(e,t,n,a,i,o,r,s,l,T,A,N,_,S,c,d){return e.singleton({initialize:function(e){this.options=e.options,this.altAppCore=e.altAppCore,this.altOptions=e.altOptions},_initDailogDivs:function(){var e=n.compile(d);this._carryOverAlternateRevisionscontainer=UWA.createElement("div",{class:"enox-alternate-carryover-revisions-wrapper"}),this._carryOverAlternateRevisionscontainer.innerHTML=e({revisionsInfo:!0}),this.RevisionsModal=this._carryOverAlternateRevisionscontainer.querySelector(".enox-alternate-carryOver-revisions"),this._carryOverAlternateRevisionInfo=this._carryOverAlternateRevisionscontainer.querySelector(".enox-alternate-carryOver-revisions-header"),this._revisionsInfoheader=this._carryOverAlternateRevisionInfo?UWA.createElement("div",{class:"enox-alternate-carryOver-revisions-header-container",text:c.get("eng.alternate.carryOver.revisions.model.info")}).inject(this._carryOverAlternateRevisionInfo):"",this.buildRevisionsContent()},renderRevisionsDialog:function(){var e=this,t=e.altOptions.altAppCore.altSettingsManager.getCommand(A.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES),n=t[A.CONSTANT_CARRYOVER_REVISIONS_COLUMN_INFO],a=t[A.CONSTANT_CARRYOVER_ALTERNATE_REVISIONS_COLUMN_OPTIONS],i=l._getDataGridColumns(n,e.altOptions.altAppCore);this.ContextRevisionsModel=new o({shouldBeSelected:function(e){return!0}}),this.getRevisionsOfSelectedObject().then(function(t){var n=[];t.graphs.forEach(t=>{var a=e.altOptions.currentNodeId,i=t.versions;t.item;i.forEach(e=>{e&&e.versionid&&e.logicalid;a!=e.id&&n.push(T.createRevisionsItem(e))})}),0==n.length?e.altOptions.CarryOver.renderAlternatesDialogOnCarryOver(e.altOptions.selectedNode[0].getID()):(e._initDailogDivs(),e.ContextRevisionsModel.addRoot(n),e.contextRevisionsGridView=e.altOptions.createDataGridView(e.ContextRevisionsModel,i,a),e.contextRevisionsGridView.show(),e.enableSelectEventsOnRevisions(e.contextRevisionsGridView),e.contextRevisionsGridView.inject(e.RevisionsModal))})},getRevisionsOfSelectedObject:function(){var e=this,t=e.altOptions.currentNodeId;console.log("Inside Revisions of Context Item");var n={},a={};return a[A.CONSTANT_SUGGESTION_VERSION_GRAPH_PAYLOAD_ID]=t,a[A.CONSTANT_VERSION_GRAPH_PAYLOAD_ATTRIBUTE]=e.altOptions.altAppCore.altSettingsManager.getCommand(A.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[A.CONSTANT_VERSION_GRAPH_ATTRIBUTES],n[A.CONSTANT_SUGGESTION_VERSION_GRAPH_PAYLOAD]=[a],r.wrappedWithCancellablePromise(function(t,a){e.altOptions.altAppCore.altDataServices.getRelatedItemsUsingVersionGraphServices(n).then(function(e){if(!e.hasOwnProperty(A.ERROR))return t(e);var n=e.response&&e.response.message?e.response.message:n;S.errorAlert(n)})}).catch(function(e){return resolve(e)})},carryOverAlternatesFromSrcToDest:function(e){var t=this,n=e.getPhysicalID(),a=t.altOptions.selectedNode[0].getID();t.altAppCore.altDataServices.getParentPointedAlternateReferenceIds(n).then(function(e){e.referenceIds;s.mask(t.altOptions.getAltFacetMainContainer()),t.altAppCore.altDataServices.performCarryOverRevisions(n,a).then(function(e){"Yes"===e.isBackgroundJobCreated?(s.unmask(t.altOptions.getAltFacetMainContainer()),S.notifyAlert(c.get("eng.alternate.carryover.BG.submitted"))):(t.altOptions.altAppCore.altSettingsManager.setAuthoringMode(A.CONSTANT_AUTHORING_MODE),t.altOptions.CarryOver.renderAlternatesDialogOnCarryOver(a))}).catch(function(e){s.unmask(t.altOptions.getAltFacetMainContainer()),console.log(e);var n=e.response&&e.response.message?e.response.message:n;S.errorAlert(n)})})},buildRevisionsContent:function(){var e=this,n=new t;return n.inject(e.altOptions.getAltFacetMainContainer()),e.carryOverRevisionsDialog=new i({title:c.get("eng.alternate.CarryOver.from").replace("$1",this.altOptions.selectedNode[0].getDisplayName()),content:this.RevisionsModal,className:"alternate-revisions-model",immersiveFrame:n,resizableFlag:!0,width:600,height:400,position:{at:"center",my:"center"},modalFlag:!0,touchMode:!0,buttons:{Ok:new a({label:c.get("eng.alternate.button.add.label"),onClick:function(t){var n=e.ContextRevisionsModel.getSelectedNodes()[0];e.carryOverAlternatesFromSrcToDest(n),t.dsModel.dialog.close()}}),Cancel:new a({onClick:function(e){e.dsModel.dialog.close()}})}}),e.carryOverRevisionsDialog.buttons[A.BUTTON_OK].disabled=!0,e.carryOverRevisionsDialog},enableSelectEventsOnRevisions:function(e){var t=this;e.dsModel.addEventListener("click",function(e,n){null!=n&&n.nodeModel&&(n.nodeModel.onSelect(function(){t.enableDisableAddButton()}),n.nodeModel.onUnselect(function(){t.enableDisableAddButton()}))})},enableDisableAddButton:function(){this.ContextRevisionsModel.getSelectedNodes().length>0?this.carryOverRevisionsDialog.buttons[A.BUTTON_OK].disabled=!1:this.carryOverRevisionsDialog.buttons[A.BUTTON_OK].disabled=!0}})}),define("DS/ENOXAlternateSubstitute/views/AlternateFacetDragandDrop",["UWA/Core","UWA/Class","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/commands/AddAlternate","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXAlternateSubstitute/utils/AlternateDataParser","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i,o,r,s){"use strict";return t.singleton({init:function(e){this._parent(e)},initialize:function(e){this.options=e.options},_dragOverAlternateFacetContent:function(e){e.preventDefault(),e.stopPropagation()},_dragEnterAlternateFacetContent:function(e){0===this._dndCounter&&(this.elements.container.addClassName("drag_over_alternate_item"),this._displayInformationBox("dragAlternateItem"),this._switchContainer("information"),this._applyAddProductIcon()),this._dndCounter++,e.preventDefault(),e.stopPropagation()},_dragLeaveAlternateFacetContent:function(e){this._dndCounter--,0===this._dndCounter&&(this.elements.container.removeClassName("drag_over_alternate_item"),this._switchContainer("alternateItemsContent")),e.preventDefault(),e.stopPropagation()},_dropAlternateItem:function(e){var t=this;e.preventDefault(),e.stopPropagation(),this._dndCounter=0,this.elements.container.removeClassName("drag_over_alternate_item"),this._switchContainer("alternateItemsContent"),this.droppedAlternateItem=JSON.parse(e.dataTransfer.getData("text"));for(var i=[],l=0;l<this.droppedAlternateItem.data.items.length;l++)i.push(this.droppedAlternateItem.data.items[l].objectId);var T={authored:!0,include_param_Attributes:!0,intent:"XEN_attributes",label:t.altAppCore.altSettingsManager.getCVRequestLabel(),nresults:i.length,query:"physicalid:"+i.join(" OR physicalid:"),tenant:t.altAppCore.altSettingsManager.getPlatformId()};t.altAppCore.altDataServices.fetchEngItemAttributes(T).then(function(e){if(Array.isArray(e.results)&&e.results.length>0)for(let t in e.results)if("ds6w:Part"!=e.results[t].attributes.find(e=>"ds6w:globalType"==e.name).value)return n.errorAlert(s.get("eng.alternate.dnd.add.onlyPhysicalProducts.error.message"));if(null==e.error){for(var i=o.parseFetchedResult(e),l=0;l<i.length;l++)i[l].id=i[l][r.CONSTANT_KEY_PHYSICALID];var T=t.options.activeEngItemTreeInfo._parentNode,A=t.options.activeEngItemTreeInfo._selectedNodes[0];if(T.getID()==A.getID()){A=t.options.activeEngItemTreeInfo._selectedNodes[0];var N=[];i.forEach(function(e){N.push(a._selectedAlternateItemMapper(e))}),t.addAlternateDataService=a.addAlternateDataService,t.addAlternateSuccessUXModification=a.addAlternateSuccessUXModification,a.addAlternateItem.bind(t)(A,[],null,N)}else a.renderAddAlternateDialog(t),a.onSelectedFromSearchForAlternate(i)}else a.displayAlertMessage(a._contextLabel,s.get("eng.alternate.dnd.add.error.message"),"error")}).catch(function(e){n.errorAlert(s.get("eng.alternate.dnd.add.onlyPhysicalProducts.error.message"))})}})}),define("DS/ENOXAlternateSubstitute/commands/CarryOverFromRevision",["UWA/Class","DS/Windows/ImmersiveFrame","DS/Handlebars/Handlebars4","DS/Controls/Button","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/ENOXEngineerCommonUtils/PromiseUtils","DS/ENOXEngineerCommonUtils/XENMask","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXAlternateSubstitute/utils/AlternateDataParser","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXAlternateSubstitute/commands/GetSuggestionAlternateUsage","DS/ENOXEngineerCommonUtils/xEngAlertManager","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","text!DS/ENOXAlternateSubstitute/views/html/CarryOverFromRevisions.html"],function(e,t,n,a,i,o,r,s,l,T,A,N,_,S,c,d,u){"use strict";return e.singleton({initialize:function(e){this.options=e.options,this.altAppCore=e.altAppCore,this.altOptions=e.altOptions},_initDivs:function(){this.refreshView=!1,S.initialize(this);var e=n.compile(u);this._carryOverAlternatescontainer=UWA.createElement("div",{class:"enox-alternate-carryover-wrapper"}),this._carryOverAlternatescontainer.innerHTML=e(),this._primaryItemAlternatesModal=this._carryOverAlternatescontainer.querySelector(".enox-alternate-carryOver"),this._primaryItemAlternatesModalBodyDiv=this._carryOverAlternatescontainer.querySelector(".enox-alternate-carryOver-body"),this._primaryItemAlternatesModalBody=UWA.createElement("div",{class:"enox-alternate-carryOver-grid-view"}).inject(this._primaryItemAlternatesModalBodyDiv),this.buildContentModel()},renderAlternatesDialog:function(){var e=this;e.getAlternatesOfStructureUnderContextItem().then(function(t){e._initDivs(),e.buildAlternatesDialog(t)})},renderAlternatesDialogOnCarryOver:function(e){var t=this;t.getCarriedAlternatesOfStructureUnderContextItem(e).then(function(e){t._initDivs(),t.buildAlternatesDialog(e),s.unmask(t.altOptions.getAltFacetMainContainer())})},buildAlternatesDialog:function(e){var t=this.altOptions.altAppCore.altSettingsManager.getCommand(_.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES),n=t[_.CONSTANT_CARRYOVER_ALTERNATES_COLUMNS_INFO],a=t[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_OPTIONS],i=A._getDataGridColumns(n,this.altOptions.altAppCore);this.AlternatesCarryOverRevisionsModel=new o({});var r=[];Array.isArray(e)&&e.forEach(e=>{r.push(N.createAlternateCarryOverItems(e))}),this.AlternatesCarryOverRevisionsModel.addRoot(r),this.alternatContextGridView=this.altOptions.createDataGridView(this.AlternatesCarryOverRevisionsModel,i,a),this.enableClickEvents(this.alternatContextGridView),this.alternatContextGridView.inject(this._primaryItemAlternatesModalBody)},enableClickEvents:function(e){e.dsModel.addEventListener("click",function(e,t){if(null!=t&&t.nodeModel&&e.dsModel.layout.getDataIndexFromColumnIndex(t.columnID)==_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE){var n=t.nodeModel.options[_.CONSTANT_ALT_REF_PHYSICALID];if(!Array.isArray(n))return;S.createsuggestionReferenceModel({Alt_ref_ids:n,title:t.nodeModel.getLabel(),usagesInfo:!1})}})},buildContentModel:function(){var e=new t;return e.inject(this.altOptions.getAltFacetMainContainer()),this.alternatesDialog=new i({title:d.get("eng.alternate.carryOver.existingAlternates.from").replace("$1",this.altOptions.selectedNode[0].getDisplayName()),content:this._primaryItemAlternatesModal,className:"alternate-revisions-model",immersiveFrame:e,resizableFlag:!0,width:800,height:550,position:{at:"center",my:"center"},modalFlag:!0,touchMode:!0,buttons:{SaveAll:new a({label:d.get("eng.alternate.carryOver.close.label"),onClick:function(e){e.dsModel.dialog.close()}})}}),this.alternatesDialog},getCarriedAlternatesOfStructureUnderContextItem:function(e){var t=this;return r.wrappedWithCancellablePromise(function(n,a){t.altAppCore.altDataServices.getParentPointedAlternateReferenceIds(e).then(function(e){var a=e.referenceIds;if(!(a&&Array.isArray(a)&&a.length>0))return n();var i=e[_.CONSTANT_KEY_REFERENCE_IDS];if(!i||0==i.length)return n();var o={};o[_.CONSTANT_CARRYOVER_ALT_REF_PHYSICALID]=e[_.CONSTANT_KEY_REFERENCE_IDS];var r=t.altAppCore.altSettingsManager.getCommand("alternate_properties");l.perform(r,o).then(function(e){var a=t.buildAlternatesNodeDB(e[_.CONSTANT_ALT_INFO]);return n(a)}).catch(function(e){return s.unmask(t.altOptions.getAltFacetMainContainer()),console.log(e),n()})}).catch(function(e){return s.unmask(t.altOptions.getAltFacetMainContainer()),n()})})},getAlternatesOfStructureUnderContextItem:function(){var e=this;return r.wrappedWithCancellablePromise(function(t,n){e.altAppCore.altDataServices.getParentPointedAlternateReferenceIds(e.altOptions.selectedNode[0].getID()).then(function(n){var a=n.referenceIds;if(a&&Array.isArray(a)&&a.length>0){var i=n[_.CONSTANT_KEY_REFERENCE_IDS];if(!i||0==i.length)return t();var o=e.altAppCore.altDataServices.getCVServletPayload(i);o[_.CONSTANT_KEY_TYPE_REF_FILTER].push(_.RELATIONSHIP_ALTERNATE_OF),T.doExpand(o,{executor:"cv_expand_v2"},e).then(function(n){var a=e.parsedataForAlternatesDailog(T.parsedExpandV2Result(n));return t(a)}).catch(function(e){return c.errorAlert(e.response),t()})}else e.altOptions.CarryOverRevisions.renderRevisionsDialog()}).catch(function(e){return t()})})},updateNodeWithPrimaryItemInfo:function(e,t){return e[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PRIMARY_ITEM_TITLE]=t[_.CONSTANT_DS_LABEL]+" "+t[_.CONSTANT_DS_REVISION],e[_.CONSTANT_REF_ID]=t[_.CONSTANT_KEY_PHYSICALID],e},parsedataForAlternatesDailog:function(e){var t=this,n=e.nodes,a=e.paths,i={},o=[],r={};return Array.isArray(a)||console.log("Wrong Response for carry Over"),a.forEach(function(e){if(!Array.isArray(a)||3!=e.length)return;let o=n[e[0]],s=n[e[1]],l=n[e[2]],T=o[_.CONSTANT_KEY_PHYSICALID],A=i[T]?i[T]:{};if(s[_.CONSTANT_KEY_TYPE]!=_.RELATIONSHIP_ALTERNATE_OF){if(A[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_TITLE_DATAINDEX]=l[_.CONSTANT_DS_LABEL],A[_.CONSTANTS_KEY_ICONS]=l[_.CONSTANTS_KEY_ICONS],A[_.CONSTANT_REVISION]=l[_.DS6W_REVISION],A[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PART_NUMBER]=l[_.DS6W_PARTNUMBER],A[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY]=l[_.CONSTANT_CURRENT],A[_.CONSTANT_STATUS]=o[_.CONSTANT_CURRENT],A[_.CONSTANT_ALT_ID]=l[_.CONSTANT_KEY_PHYSICALID],A[_.CONSTANT_ALT_REF_PHYSICALID]=o[_.CONSTANT_KEY_PHYSICALID],A[_.Element_2_PhysicalId]=s[_.Element_2_PhysicalId],i[T]=A,A[_.CONSTANT_ALT_ID]&&A[_.CONSTANT_REF_ID]){let e=A[_.CONSTANT_ALT_ID]+"/"+A[_.CONSTANT_REF_ID];S=r[e];if(A[_.Element_2_PhysicalId])(N=S&&Array.isArray(S[_.CONSTANT_ALT_REF_PHYSICALID])?S[_.CONSTANT_ALT_REF_PHYSICALID]:[]).push(A[_.CONSTANT_ALT_REF_PHYSICALID]),A[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE]=N.length,A[_.CONSTANT_ALT_REF_PHYSICALID]=N;r[e]=A}}else if(i[T]=t.updateNodeWithPrimaryItemInfo(A,l),A[_.CONSTANT_ALT_ID]&&A[_.CONSTANT_REF_ID]){let e=A[_.CONSTANT_ALT_ID]+"/"+A[_.CONSTANT_REF_ID];var N,S=r[e];if(A[_.Element_2_PhysicalId])(N=S&&Array.isArray(S[_.CONSTANT_ALT_REF_PHYSICALID])?S[_.CONSTANT_ALT_REF_PHYSICALID]:[]).push(A[_.CONSTANT_ALT_REF_PHYSICALID]),A[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE]=N.length,A[_.CONSTANT_ALT_REF_PHYSICALID]=N;r[e]=A}}),Object.keys(r).forEach(function(e){o.push(r[e])}),o},buildAlternatesNodeDB:function(e){var t=[],n={};return Array.isArray(e)&&e.length>0&&e.forEach(function(e){var t={};e[_.CONSTANT_ALT_REF_PHYSICALID];t[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PRIMARY_ITEM_TITLE]=e[_.CONSTANT_PRIMARY_ITEM_TITLE]+" "+e[_.CONSTANT_PRIMARY_ITEM_REVISION],t[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_ALTERNATE_TITLE_DATAINDEX]=e[_.CONSTANT_ALTERNATE_ITEM_TITLE],t[_.CONSTANTS_KEY_ICONS]=e[_.CONSTANTS_KEY_ICONS],t[_.CONSTANT_REVISION]=e[_.CONSTANT_ALTERNATE_ITEM_REVISION],t[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_PART_NUMBER]=e[_.CONSTANT_PARTNUMBER],t[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY]=e[_.CONSTANT_CURRENT],t[_.CONSTANT_STATUS]=e[_.CONSTANT_STATUS],t[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_MATURITY]=e[_.CONSTANT_DATAGRID_MATURITY_STATE],t[_.CONSTANT_ALT_ID]=e[_.CONSTANT_ALT_ID],t[_.CONSTANT_REF_ID]=e[_.CONSTANT_REF_ID],t[_.CONSTANT_ALT_REF_PHYSICALID]=[e[_.CONSTANT_ALT_REF_PHYSICALID]],t[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE]=e[_.CONSTANT_INSTANCE_CONTEXT_TITLE]?1:"";let a=t[_.CONSTANT_ALT_ID]+"/"+t[_.CONSTANT_REF_ID];var i=n[a];if(i){var o=i[_.CONSTANT_ALT_REF_PHYSICALID]?i[_.CONSTANT_ALT_REF_PHYSICALID]:[];o.push(e[_.CONSTANT_ALT_REF_PHYSICALID]),t[_.CONSTANT_CARRYOVER_ALTERNATE_COLUMN_INSTANCE_TITLE]=o?o.length:1,t[_.CONSTANT_ALT_REF_PHYSICALID]=o}n[t[_.CONSTANT_ALT_ID]+"/"+t[_.CONSTANT_REF_ID]]=t}),Object.keys(n).forEach(function(e){t.push(n[e])}),t}})}),define("DS/ENOXAlternateSubstitute/views/AlternateTileView",["DS/Controls/ResponsiveTileView","UWA/Core","DS/Utilities/Dom","DS/Core/PointerEvents","DS/ENOXAlternateSubstitute/services/AlternateItemsFactory","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i,o,r){"use strict";return e.inherit({_postBuildView:function(){this._parent()},_getStatusBarContent:function(){if(this.cellInfos&&this.cellInfos.cellModel){var e=this.cellInfos.nodeModel,t=i.getUsageDetails(e,!0);return this.elements.container.setAttribute("has-statusbar-content","true"),this.elements.statusbar.setAttribute("has-statusbar-content","true"),t}},_applyStatusbarIcons:function(e){var t=this;this.elements.statusbar.empty(),this.elements.statusbaricons=[];var i=new UWA.Element("div",{html:this._getStatusBarContent(),class:"alternate-controls-responsivetileview-statusbaricon"});this.elements.statusbaricons.push(i),this.elements.statusbar.appendChild(i),i._index=0,n.addEventOnElement(this,i,a.POINTERDOWN,function(e){t.fire("StatusbarIconPointerDown",{iconIndex:e.target._index}),e.stopPropagation()}),n.generateIcon(this.statusbarIcons[0],{target:i}),i.setStyle("font-size","14px"),i.setStyle("line-height","14px"),i.setStyle("height","inherit"),i.setStyle("display","flex")}})}),define("DS/ENOXAlternateSubstitute/components/AlternateToolBar",["DS/UIKIT/Iconbar","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n){"use strict";function a(e){this.alternateCollectionToolBarModelEvents=e.modelEvents,this.toolbarContainer=this.createActionBarWrapper(),this.toolbarContainer.inject(e.container,"top")}return a.prototype.createActionBarWrapper=function(){return this.toolBarContainer=UWA.createElement("div",{id:"listview-toolbar",styles:{height:"40px",width:"100%"}}),this.toolBarActionsContainer=UWA.createElement("div",{class:"enox-alternate-toolbar-actions"}).inject(this.toolBarContainer),this.toolBarContainer},a.prototype.getToolBarActionCommands=function(){return this.options.actions},a.prototype.AddToolbarCommand=function(e){return null!=this._actionsIconBar&&this._actionsIconBar.addItem({id:e.id,fonticon:e.fonticon,className:e.className,text:e.text,handler:e.handler,selected:!1,allowSelectRetain:e.allowSelectRetain,disabled:e.disabled}),this},a.prototype.AddToolbarCommands=function(e){if(!Array.isArray(e))throw new Error("invalid input for AddToolbarCommands ");this.initializeIconbar();var t=this;return e.forEach(function(e){t.AddToolbarCommand(e)}),t.attachSwitchViewsToToolbar(),t.renderMultiselection(),this},a.prototype.attachSwitchViewsToToolbar=function(){var e=this,a=n.get("eng.alternate.view.tiles"),i={id:t.CONSTANT_ALTERNATE_TOOLBAR_SWITCH_VIEW_CMD,name:t.CONSTANT_ALTERNATE_TOOLBAR_SWITCH_VIEW_CMD,fonticon:"view-big-tile",text:a,content:{type:"icondropdown",options:{items:[{name:t.CONSTANT_ALTERNATE_VIEW_TILES,fonticon:"view-big-tile",text:n.get("eng.alternate.view.tiles"),selectable:!0,selected:!0,handler:function(){var a=e._actionsIconBar.getItem("SwitchView"),i=a.elements.icon,o=a.tooltip;i.hasClassName("fonticon-view-list")&&(i.removeClassName("fonticon-view-list").addClassName("fonticon-view-big-tile"),a.fonticon="fonticon-view-big-tile",a.text=n.get("eng.alternate.view.tiles"),o.setBody(n.get("eng.alternate.view.tiles"))),e.alternateCollectionToolBarModelEvents.publish({event:"enox-alternate-toolbar-switch-view-activated",data:t.CONSTANT_ALTERNATE_VIEW_TILES})}},{name:t.CONSTANT_ALTERNATE_VIEW_DATAGRID,fonticon:"view-list",text:n.get("eng.alternate.view.datagrid"),selectable:!0,selected:!1,handler:function(){var a=e._actionsIconBar.getItem("SwitchView"),i=a.elements.icon,o=a.tooltip;i.hasClassName("fonticon-view-big-tile")&&(i.removeClassName("fonticon-view-big-tile").addClassName("fonticon-view-list"),a.fonticon="fonticon-view-list",a.text=n.get("eng.alternate.view.datagrid"),o.setBody(n.get("eng.alternate.view.datagrid"))),e.alternateCollectionToolBarModelEvents.publish({event:"enox-alternate-toolbar-switch-view-activated",data:t.CONSTANT_ALTERNATE_VIEW_DATAGRID})}}]}}};this._actionsIconBar.addItem(i)},a.prototype.renderMultiselection=function(){this.currentNbSelections=0,this._multiActionIcon=this.toolBarActionsContainer.querySelector("#MultiSelect"),this._multiActionIcon.getChildren()[0].setAttribute("id","alternate-select-on-multiSelect-action");var e=document.createElement("sub");e.setAttribute("class","enox-alternate-toolbar-multiselect-count"),this.numberOfSelection=document.createTextNode(""),this._updateIconMultiselectNumber(this.currentNbSelections),e.appendChild(this.numberOfSelection),this._multiActionIcon.appendChild(e);var t=document.createElement("span");t.setAttribute("class","fonticon fonticon-chevron-down"),t.setAttribute("id","alternate-down-chevron-multi-action"),this._multiActionIcon.appendChild(t),t.style.paddingLeft="8px"},a.prototype._updateIconMultiselectNumber=function(e){this.currentNbSelections=e,e>9999?(this.numberOfSelection.nodeValue=">9999",this._multiActionIcon.getChildren()[0].setAttribute("class","fonticon fonticon-select-on")):0===e?(this.numberOfSelection.nodeValue="",this._multiActionIcon.getChildren()[0].setAttribute("class","fonticon fonticon-select-off")):(this.numberOfSelection.nodeValue=e,this._multiActionIcon.getChildren()[0].setAttribute("class","fonticon fonticon-select-on"))},a.prototype.initializeIconbar=function(){this._actionsIconBar=new e({renderTo:this.toolBarActionsContainer,tooltipsTrigger:"touch"})},a}),define("DS/ENOXAlternateSubstitute/views/AlternateTilesViewManager",["UWA/Class","DS/Controls/TooltipModel","DS/Handlebars/Handlebars4","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXAlternateSubstitute/views/AlternateItemModel","DS/ENOXAlternateSubstitute/views/AlternateTileView","DS/ENOXAlternateSubstitute/services/AlternateItemsFactory","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i,o,r,s,l,T,A){"use strict";var N=i.inherit({name:"AlternateResponsiveTileViewLayout",_getRowHeight:function(){return 65}});return a.inherit({name:"AlternateResponsiveTileView",publishedProperties:{layout:{defaultValue:null,type:"object"},height:{defaultValue:"inherit",type:"integer"}},init:function(e){this.modelType=e.modelType,this._parent(e)},getLabel:function(e){var t=UWA.createElement("div",{});const n=UWA.String.escapeHTML(e.getLabel());if(e instanceof r){var a=e.getChildren()?e.getChildren().length:"0";i='<div class="altsub-pull-left">'+n+"</div>",i='<div class="altsub-pull-left">'+(a>0&&!l.checkIfHeaderNode(e)?A.get("eng.alternate.header.title").replace("$1",n+" "+e.getReferenceVersion()).replace("$2",a):n+" "+e.getReferenceVersion())+"</div>"}else{var i='<div class="altsub-pull-left">'+UWA.String.escapeHTML(l.getNlsOfGroupByTitle(e))+"</div>"}return t.set("html",i),t},getAttributesBuilder:function(e,t){var n=UWA.createElement("div",{class:e});for(let e=0;e<t.length;e++){var a;a=UWA.createElement("div",{class:"enox-alternate-tilesview-description-column"});var i=t[e].value;if(i){if(e>0){var o=UWA.createElement("span");o.setText(" | "),a.appendChild(o)}t[e].attrName==T.CONSTANT_STATUS?a.appendChild(t[e].value):(t[e].attrLabel&&(i=t[e].attrLabel+i),a.appendText(i))}n.appendChild(a)}return n},getSubLabel:function(e){if(e._isFromOriginalModel()){var t=this.nodeAttributes;return this.getAttributesBuilder("enox-alternate-tilesview-sublabel",t)}},getStatusbarIcons:function(e){return!0!==e._isFromOriginalModel()||e.getChildren()&&"0"!=e.getChildren().length?e.isExpanded()?[T.CONSTANT_ICON_POINTER_DOWN]:[T.CONSTANT_ICON_POINTER_RIGHT]:[""]},onStatusbarIconPointerDown:function(e){var t=e.cellInfos,n=e.clickedIconIndex,a=t?t.cellView:void 0,i=a?a.contentView:void 0,o=t?t.cellModel:void 0;i&&o&&n>=0&&n<i.statusbarIcons.length&&(o.getTreeDocument().prepareUpdate(),o.isExpanded()?o.collapse():o.expand(),o.getTreeDocument().pushUpdate())},getStatusbarIconsTooltips:function(e){return e.getLabel()},getTilesViewDescriptionAttributes:function(e){var t=l.getValidStatus(e,!1),n=[];return n.push({attrName:T.CONSTANT_STATUS,name:A.get("eng.alternate.label.status"),value:t}),n},getDescription:function(e,t){if(e._isFromOriginalModel()){for(var n=UWA.createElement("div",{class:"enox-alternate-tilesview-description"}),a=UWA.createElement("div",{class:"enox-alternate-tilesview-description-row"}),i=UWA.createElement("span"),r=0;r<t.length;r++)r>0&&(i.setText(" | "),a.appendChild(i)),t[r].attrName==T.CONSTANT_STATUS?a.appendChild(t[r].value):a.appendText(t[r].value);if(e.options.grid.WorkUnderChangeActionPhyId&&""!=e.options.grid.WorkUnderChangeActionPhyId){i.setText(" | "),a.appendChild(i);var s=UWA.createElement("img");s.src=o.getChangeActionIcon(),s.width="16",s.height="16",a.appendChild(s)}return n.appendChild(a),n}return""},getCustomTooltip:function(e){var n=this.nodeAttributes,a="";if(e instanceof r){for(let e=0;e<n.length;e++){var i=n[e].value?n[e].value:"";a=a+n[e].name+" : "+i+"\n"}var o=this.attributes;for(let t=0;t<o.length;t++){i="";if(o[t].attrName==T.CONSTANT_STATUS)i=l.getStatus(e)[T.CONSTANT_STATUS];else i=o[t].value?o[t].value:"";a=a+o[t].name+i+"\n"}a=a+A.get("eng.alternate.label.usage")+l.getUsageDetails(e,!0)+"\n"}else a=l.getNlsOfGroupByTitle(e);return new t({shortHelp:a,shortHelpImageDimension:{x:144,y:350}})},_preBuild:function(){this._parent(),this._properties.layout.value=new N({columnMaxWidth:"100%",rowHeight:"60",rowMaxHeight:70,gutter:2})},_postBuildView:function(){this._parent(),this.cellStyleOverload="wux-cell-responsivelargetile",this.elements.container.addClassName("wux-layout-largetilecollectionView");var e=this,t=this;e.registerReusableCellContent({id:"AlternateTile",buildContent:function(){var e=new s;return e.layoutingCollection=t,t._onEndResize(t.___onEndResizeCB),e}}),e.onCellRequest(function(t){var n=e.reuseCellContent("AlternateTile");t.cellView.collectionView=e,t.cellView.contentView=n,n.cellInfos=t,n.unPrehighlight(),n.getContent().setStyles({width:"100%",height:"100%"});var a,i=t.cellModel;t.cellView.getContent().addClassName(e.cellStyleOverload),a=e.getAlternateTileProperties(e,i),-1!==this._displayedOptionalCellProperties.indexOf("statusbarIcons")&&(a.statusbarIcons=e.getStatusbarIcons(i)),n.setProperties(a),t.cellView._setReusableContent(n),this.selectionBehavior.enableFeedbackForActiveCell&&(i===this.activeNode?n.activate():n.deactivate()),this.modelProvider.isNodeSelected(i)?n.highlight():n.unhighlight(),e._onPostRequestCellCB&&e._onPostRequestCellCB.call(e,t)})},getAlternateTileProperties:function(e,t){e.nodeAttributes=t.getAlternateTilesViewOrderedAttribute?t.getAlternateTilesViewOrderedAttribute():"",e.allowUnsafeHTMLContent=T.CONSTANTS_TRUE,e.attributes=e.getTilesViewDescriptionAttributes?e.getTilesViewDescriptionAttributes(t):"";var n={title:e.getLabel(t),subtitle:e.getSubLabel(t),customTooltip:e.getCustomTooltip(t),clickableTitle:e.getClickableTitle(t),multipleTitleLineNumber:e.getMultipleTitleLineNumber(t),picture:e.getThumbnail(t)?e.getThumbnail(t):o.getDefaultProductThumbnail(),emptyStatusbarVisibleFlag:e.getEmptyStatusbarVisibleFlag(t),icon:t.options[T.CONSTANTS_ICON]?t.options[T.CONSTANTS_ICON]:o.getDefaultProductIcon(),color:e.getColor(t)};return-1!==this._displayedOptionalCellProperties.indexOf("description")&&(n.description=e.getDescription(t,e.attributes)),-1!==this._displayedOptionalCellProperties.indexOf("contextualMenu")&&(n.contextualMenu=e.getContextualMenu(t)),n}})}),define("DS/ENOXAlternateSubstitute/views/AlternateItemViewsManager",["UWA/Core","DS/CoreEvents/ModelEvents","DS/UIKIT/Input/Button","DS/TreeModel/TreeDocument","DS/DataGridView/DataGridView","DS/PlatformAPI/PlatformAPI","DS/ENOXAlternateSubstitute/commands/AddAlternate","DS/ENOXAlternateSubstitute/views/AlternateGridViewManager","DS/ENOXAlternateSubstitute/views/AlternateTilesViewManager","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/utils/AlternateRMBEventHandler","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json"],function(e,t,n,a,i,o,r,s,l,T,A,N,_){"use strict";function S(e){this.buildContentViewer()}return S.prototype.switchView=function(e){this.rmbModelEvents=new t,this.hidePreviousView&&this.hidePreviousView(),e==N.CONSTANT_ALTERNATE_VIEW_DATAGRID?this.buildDataGridViewContent():0==this._addAlternateUX.ALTERNATE.model.getAllDescendants().length?this.renderEmptyView(e):this.buildTilesViewContent&&this.buildTilesViewContent(),this.refreshFilterView&&this.refreshFilterView()},S.prototype.enableDisableToolbarCmdsOnUserSelections=function(e){var t="",n=!1;if(0==e.length)this.disableToolbarCmds();else{t="Mixed"!=t?e[0].options.grid[N.CONSTANT_STATUS]:"Mixed";var a=!!e[0].options[N.CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS],i=!!e[0].options.grid[N.CONSTANT_WORK_UNDER_CHANGE];n=e[0].options.grid[N.CONSTANT_STATUS]==N.CONSTANT_NOT_APPLICABLE;for(var o=1;o<e.length;o++){var r=e[o].options.grid[N.CONSTANT_STATUS];e[o].options[N.CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS];e[o].options.grid[N.CONSTANT_WORK_UNDER_CHANGE]&&(i=!0),r==t||a||(t="Mixed"),r==N.CONSTANT_NOT_APPLICABLE&&(n=!0)}"Mixed"==t?(this.disableToolbarCmds(),i||(n?this._enableDisableToolbarCmds(new Array(N.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!1):this._enableDisableToolbarCmds(new Array(N.CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD),!0))):(this.disableToolbarCmds(),a?this._enableDisableToolbarCmds(new Array(N.CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD,N.CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD,N.CONSTANT_ALTERNATE_TOOLBAR_OBSELETE_CMD),!0):this.enableToolbarCmds(t,i)),t==N.CONSTANT_NOT_APPLICABLE||n||this._enableDisableToolbarCmds(new Array(N.CHANGE_OWNER_CMD),!0)}},S.prototype.buildTilesViewContent=function(){var e=this;null==this.alternateResonseTilesView&&(this.alternateResonseTilesView=new l({useDragAndDrop:!0,displayedOptionalCellProperties:["contextualMenu","statusbarIcons","description","activeFlag"]}),this.alternateResonseTilesView.model=e.alternateModel,this.alternateResonseTilesView.onContextualEvent={this:e,callback:e._onContextualEventTilesView},this.alternateResonseTilesView.addEventListener("click",function(t,n){e.manageHeaderNodeSelection(n&&n.nodeModel),e.altAppCore.altItemFactory.openItemWithCompass(n&&n.nodeModel),n&&n.cellID>=0&&e.alternateModel.getSelectedNodes().length>0?e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes()):e.disableToolbarCmds()})),this.alternateResonseTilesView.elements.container.classList.add("visible"),this.instanciatedViews[N.CONSTANT_ALTERNATE_VIEW_TILES]=this.alternateResonseTilesView,this.alternateGridView&&this.alternateGridView.hide(),this.alternateResonseTilesView.show(),this.alternateResonseTilesView.getContent().inject(e._dataContainer),this.activeView=N.CONSTANT_ALTERNATE_VIEW_TILES},S.prototype._onContextualEventTilesView=function(e){return e.modelEvents=this.alternateResonseTilesView._modelEvents,this.enableDisableToolbarCmdsOnUserSelections(this.alternateModel.getSelectedNodes()),this.isMultipleNodesSelected()?A.getEmptyMenu():(e.reference=this,A.getRMBMenu(e))},S.prototype.buildDataGridViewContent=function(){var e=this;if(null==this.alternateGridView){var t={treeDocument:e.alternateModel,columns:s._columnConfiguration(this.altAppCore),rowSelection:"multiple",cellSelection:"multiple",identifier:"alternate_gridview",showContextualMenuColumnFlag:!0,placeholder:e.getGridEmptyView(N.CONSTANT_ALTERNATE_VIEW_DATAGRID),defaultColumnDef:{width:"auto",typeRepresentation:"string",editionPolicy:"EditionOnDoubleClick"}};this.alternateGridView=new i(t).getContent(),this.instanciatedViews[N.CONSTANT_ALTERNATE_VIEW_DATAGRID]=this.alternateGridView.dsModel,this.alternateGridView.dsModel.buildDefaultContextualMenu=function(t,n){var a=t.cellInfos&&t.cellInfos.nodeModel?t.cellInfos.nodeModel:null;return-1!==(t.cellInfos?t.cellInfos.rowID:null)&&a?(a.isSelected()||(this.unselectAll(),a&&a.select()),e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes()),e.isMultipleNodesSelected()?A.getEmptyMenu():a&&a._isFromOriginalModel()?(t.modelEvents=e.alternateGridView.dsModel._modelEvents,t.reference=e,A.getRMBMenu(t)):void 0):this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(t,n):[]},this.alternateGridView.dsModel.addEventListener("click",function(t,n){null!=n?-1!==n.rowID?t.dsModel.layout.getDataIndexFromColumnIndex(n.columnID)==N.CONSTANT_DATAGRID_MATURITY_STATE?(e.alternateModel.unselectAll(),n.nodeModel.select(),widget.appMediator.publish(N.EVENT_LAUNCH_COMMAND,{commandId:N.MATURITY_GRAPH_CMD,context:{item:n.nodeModel}})):(n.nodeModel.onSelect(function(){e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes())}),n.nodeModel.onUnselect(function(){0==e.alternateModel.getSelectedNodes().length?e.disableToolbarCmds():e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes())}),-1===n.columnID&&(e.manageHeaderNodeSelection(n&&n.nodeModel),e.altAppCore.altItemFactory.openItemWithCompass(n&&n.nodeModel))):-1==n.rowID&&(e.alternateModel.getSelectedNodes().length>0?e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes()):e.disableToolbarCmds()):e.disableToolbarCmds()})}this.alternateGridView.dsModel.elements.container.classList.add("visible"),this.alternateResonseTilesView&&this.alternateResonseTilesView.hide(),this.alternateGridView.show(),this.alternateGridView.inject(this._dataContainer),this.activeView=N.CONSTANT_ALTERNATE_VIEW_DATAGRID},S.prototype.isMultipleNodesSelected=function(){var e=this._addAlternateUX.ALTERNATE.model.getSelectedNodes();if(e.length>1)for(var t=0;t<e.length;t++)if(e[t].options.grid[N.CONSTANT_STATUS]!=N.CONSTANT_NOT_APPLICABLE)return!0;return!1},S.prototype.buildContentViewer=function(){var e=this;this.instanciatedViews={},null==e.alternateModel&&(e.alternateModel=new a({shouldBeSelected:function(e){return e.options.grid[N.CONSTANT_APPLICABILTY]==N.CONSTANT_YES||e.options.grid[N.CONSTANT_SPLIT]==N.CONSTANT_YES}})),e.alternateModel.collapseAll(),this._addAlternateUX.ALTERNATE={model:e.alternateModel,isInjected:!1,update:function(t){e._addAlternateUX.ALTERNATE.model.empty(),e._addAlternateUX.ALTERNATE.model.addRoot(t),e._addAlternateUX.ALTERNATE.model.isGroupedByView=!1},append:function(t){e._addAlternateUX.ALTERNATE.model.unselectAll(),e._addAlternateUX.ALTERNATE.model.addRoot(t),t.forEach(function(e){e.select()}),e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes())}},o.subscribe("DS/PADUtils/PADCommandProxy/refresh",function(t){console.log("From Alternate"),t.data.authored&&t.data.authored.modified&&(console.log(t),e.altAppCore.altDataServices.fetchedObjectInfo(t.data.authored.modified,"0").then(function(t){t?e.updateMaturityColumn(e.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes(),t):console.log(t)}))})},S.prototype.renderEmptyView=function(e){this.activeView=e,this._emptyViewRendered&&this.emptyView||(this.emptyView=this.getGridEmptyView(this.activeView),this.emptyView&&(this._emptyViewRendered=!0,this.emptyView.inject(this._dataContainer)))},S.prototype.removeEmptyView=function(){if(this.emptyView){try{this.emptyView._containerEmptyContent&&(this._dataContainer.removeChild(this.emptyView._containerEmptyContent),this.emptyView._containerEmptyContent.innerHTML=""),this.emptyView.destroy()}catch(e){console.error(e)}this.emptyView=null}this._emptyViewRendered=!1},S.prototype.hidePreviousView=function(){var e=this;Object.keys(this.instanciatedViews).forEach(function(t){e.instanciatedViews[t].elements.container.classList.remove("visible")}),e._emptyViewRendered&&e.removeEmptyView()},S.prototype.getGridOptions=function(e){var t=new n({value:_.get("eng.alternate.views.tiles.addInstance.title"),className:"primary"});return{sentences:[{type:"drop",text:_.get("eng.alternate.views.tiles.dnd.title")},{type:"dom",DOMelement:t.getContent(),events:{onclick:function(){r.renderAddAlternateDialog()}}}],fontSize:"16px",orderedListType:"none",modelEvents:this._modelEvents}},S.prototype.getGridEmptyView=function(e){return this._instanciateEmptyViewer(this.getGridOptions(e))},S.prototype._instanciateEmptyViewer=function(e){return this.altAppCore.altDataServices.temporaryLoadEmptyView(e)},S.prototype.refreshFilterView=function(){this.altFilterManager.filterModel={},this._addAlternateUX.ALTERNATE.model._getTrueRoot().getTreeDocument().setFilterModel(this.filterModel),0==Object.keys(this.filterModel).length||0==this._addAlternateUX.ALTERNATE.model._getTrueRoot().getNumberOfVisibleChildren()&&this._addAlternateUX.ALTERNATE.model._getTrueRoot().getNumberOfDescendants()>0?(this._dataContainer.hide(),this.filterEmptyResultDOM.show()):(this._dataContainer.show(),this.filterEmptyResultDOM.hide())},S.prototype.groupAlternateNodes=function(e){e.context==N.CONSTANT_NONE?(this.altOptions._addAlternateUX.ALTERNATE.model.ungroupRoots(),this.altOptions._addAlternateUX.ALTERNATE.model.isGroupedByView=!1):(this.altOptions._addAlternateUX.ALTERNATE.model.ungroupRoots(),this.altOptions._addAlternateUX.ALTERNATE.model.groupRoots({propertiesToGroup:[e.context]}),this.altOptions._addAlternateUX.ALTERNATE.model.isGroupedByView=!0,this.altOptions._addAlternateUX.ALTERNATE.model.groupedByProperty=e.context)},S.prototype.updateMaturityColumn=function(e,t){for(var n=0;n<e.length;n++)if(t&&t[e[n].getID()]){var a=t[e[n].getID()],i=(e[n]._getRowID(),this.altAppCore.altDataServices.getNlsOfPropertiesValues()[N.CONSTANT_DS6W_STATUS][a[N.CONSTANT_DS6W_STATUS]]);if(e[n].options.grid[N.CONSTANT_DATAGRID_MATURITY_STATE]=i,this.altAppCore.altItemFactory.checkIfAlternateChildNode(e[n])||this.altAppCore.altItemFactory.checkIfHeaderNode(e[n])){var o=this.altAppCore.altItemFactory.checkIfHeaderNode(e[n])?e[n]:e[n]._parentNode;o.options.grid[N.CONSTANT_DATAGRID_MATURITY_STATE]=i,o.getChildren().forEach(function(e){e.options.grid[N.CONSTANT_DATAGRID_MATURITY_STATE]=i})}this.altAppCore.altItemFactory.updateAlternateNode(e[n]),e[n].select()}this.altAppCore.altItemFactory.updateGroupBy()},S.prototype.createDataGridView=function(e,t,n){var a={treeDocument:e,columns:t,rowSelection:n.rowSelection?n.rowSelection:"multiple",showSelectionCheckBoxesFlag:n.showSelectionCheckBoxesFlag?n.showSelectionCheckBoxesFlag:"OnOver",showRowIndexFlag:!n.hasOwnProperty("showRowIndexFlag")||n.showRowIndexFlag,cellSelection:n.cellSelection?n.cellSelection:"multiple",identifier:n.identifier?n.identifier:"XEN-DatagridView_alternate_gridView",defaultColumnDef:{width:"auto",typeRepresentation:"string"}};return new i(a).getContent()},S}),define("DS/ENOXAlternateSubstitute/commands/AlternateFacetContentBuilder",["UWA/Core","DS/CoreEvents/ModelEvents","UWA/Controls/Abstract","DS/Controls/Button","DS/UIKIT/Input/Toggle","DS/UIKIT/SuperModal","DS/Windows/ImmersiveFrame","DS/PlatformAPI/PlatformAPI","DS/ENOXAlternateSubstitute/components/AlternateFilter","DS/UIKIT/DropdownMenu","DS/UIKIT/Iconbar","DS/UIKIT/Tooltip","DS/ENOXEngineerCommonUtils/XENMask","DS/ResizeSensor/js/ResizeSensor","DS/ENOXAlternateSubstitute/utils/AlternateHttpClient","DS/ENOXEngineerCommonUtils/xEngAlertManager","DS/ENOXAlternateSubstitute/commands/AddAlternate","DS/ENOXAlternateSubstitute/commands/CarryOverFromRevision","DS/ENOXAlternateSubstitute/commands/RevisionsExplorerForCarryOver","DS/ENOXAlternateSubstitute/commands/GetAlternates","DS/ENOXAlternateSubstitute/services/AlternateSettingsManager","DS/ENOXAlternateSubstitute/services/AlternateSubstituteServices","DS/ENOXAlternateSubstitute/components/AlternateToolBar","DS/ENOXAlternateSubstitute/views/AlternateItemViewsManager","DS/ENOXAlternateSubstitute/views/AlternatesDataGridViewRowsGenerator","DS/ENOXAlternateSubstitute/views/AlternateFacetDragandDrop","DS/ENOXAlternateSubstitute/utils/AlternateCommands","DS/ENOXAlternateSubstitute/commands/AddSuggestionAlternate","DS/ENOXAlternateSubstitute/utils/AlternateCommonConstants","DS/ENOXAlternateSubstitute/utils/AlternateDataParser","DS/ENOXAlternateSubstitute/utils/AlternateRMBEventHandler","DS/ENOXAlternateSubstitute/services/AlternateItemsFactory","i18n!DS/ENOXAlternateSubstitute/assets/nls/AlternateManagement.json","css!DS/ENOXAlternateSubstitute/styles/Alternate.css"],function(e,t,n,a,i,o,r,s,l,T,A,N,_,S,c,d,u,C,E,O,g,p,I,h,m,R,f,D,L,v,M,b,U){"use strict";return n.extend(h,{_addAlternateUX:{},_informationBox:null,_informationContainerBox:null,currentNodeId:null,selectionType:null,alternatesOnSelectedNode:null,alternateManagementConfigurations:{},isChangeEnforced:!1,hasAlternatesInOtherContexts:!1,existedAlternateItems:[],_dndCounter:0,activeView:null,init:function(t){this._parent(t),this.appCore=t.appCore,this.altAppCore={},this.altAppCore.altFacetMainContainer=document.getElementsByClassName("floatingPanelComponent").length>0&&document.getElementsByClassName("uwa-framed")&&document.getElementsByClassName("uwa-framed").length>0?document.getElementsByClassName("uwa-framed")[0]:t.altfacetContainer,this.altAppCore.altSettingsManager=g,g.initialize(t),this.altAppCore.altItemFactory=b,b.initialize(this),this.altAppCore.altDataServices=p,p.initialize(this.altAppCore),this.altOptions=this,u.initialize(this),R.initialize(this),f.initialize(this),M.initialize(this),D.initialize(this),C.initialize(this),this.altOptions.CarryOver=C,E.initialize(this),this.altOptions.CarryOverRevisions=E,this.alternateManagementConfigurations=t.alternateManagementConfigurations,this.setEnforcedChange(),this.elements.container=e.createElement("div",{class:"alternate_container"}),this._selectedUsageInfo=e.createElement("div",{class:"alternate_usageInfo_container"}).inject(this.elements.container),this._toolBarContainer=e.createElement("div",{class:"alternate_ToolBar_container"}).inject(this.elements.container),this._filterContainer=e.createElement("div",{class:"alternate_Filter_container"}).inject(this._toolBarContainer),this._rightMenuContainer=e.createElement("div",{class:"alternate_ToolBar_commands_container"}).inject(this._toolBarContainer),this._dataContainer=e.createElement("div",{class:"alternate_Data_container"}).inject(this.elements.container),this.filterEmptyResultDOM=e.createElement("div",{class:"alternate-empty-filter-result"}).inject(this.elements.container),this._buildAlternateMessageDisplayContent(),this._buildEmptyFilterDOM(this.filterEmptyResultDOM),this._buildAlternateModel(),this._buildDnDEvents(),this.loadSourceOptions()},getAltFacetMainContainer:function(){return this.altAppCore.altFacetMainContainer},_buildDnDEvents:function(){this.elements.container.addEventListener("dragenter",R._dragEnterAlternateFacetContent.bind(this)),this.elements.container.addEventListener("dragleave",R._dragLeaveAlternateFacetContent.bind(this)),this.elements.container.addEventListener("dragover",R._dragOverAlternateFacetContent.bind(this)),this.elements.container.addEventListener("drop",R._dropAlternateItem.bind(this))},_buildEmptyFilterDOM:function(t){this.filterIconDom=e.createElement("span",{class:"fonticon fonticon-list-filter"});e.createElement("div",{class:"alternate-empty-filter-container",html:[e.createElement("div",{class:"alternate-empty-filter-label",html:U.get("eng.alternate.filter.empty.view.label")}),e.createElement("div",{class:"alternate-empty-filter-sublabel",html:U.get("eng.alternate.filter.empty.view.sublabel")+this.filterIconDom.outerHTML})]}).inject(t);t.hide()},_buildAlternateModel:function(){this.activeView=L.CONSTANT_ALTERNATE_VIEW_TILES,this.initializeUsageInfoDivs(),this.initializeToolbar(),this.buildContentViewer(),this.registerAlternateFilter()},registerAlternateFilter:function(){var e=this;this.altFilterManager=e._addAlternateUX.ALTERNATE.model._getTrueRoot().getTreeDocument().getFilterManager(),this.altFilterManager.registerFilter("stringRole",l),e.filterModel={};var t=e.altAppCore.altSettingsManager.getCommand(L.CONSTANT_BASIC_ALTERNATE_ATTRIBUTES)[L.CONSTANT_ALTERNATE_FILTER_PARAMS];this._dropDown=new T({target:e._filterContainer,multiSelect:!0,closeOnClick:!0,items:[],events:{onClick:function(t,n){var a=n.name;if(n.selected)e.filterModel[a]={filterId:"stringRole",filterModel:{allowedRoles:e.filterModel[n.name]?e.filterModel[n.name].filterModel.allowedRoles.push(n.id)&&e.filterModel[n.name].filterModel.allowedRoles:[n.id]}};else{var i=e.filterModel[n.name].filterModel.allowedRoles.indexOf(n.id);e.filterModel[n.name].filterModel.allowedRoles.length>1?e.filterModel[n.name].filterModel.allowedRoles.splice(i,1):delete e.filterModel[a]}e._addAlternateUX.ALTERNATE.model._getTrueRoot().getTreeDocument().unselectAll(),e.disableToolbarCmds(),e.refreshFilterView()}.bind(e)}}),this._dropDown.addItem(f.renderDropdownItems(t,e.filterModel))},initializeUsageInfoDivs:function(){this.nameDiv=e.createElement("span",{class:"alternate_usageInfo_container_name"}).inject(this._selectedUsageInfo),this.nameDiv.innerText=U.get("eng.alternate.usage.info.title"),this.valueDiv=e.createElement("span",{class:"alternate_usageInfo_container_value"}).inject(this._selectedUsageInfo)},renderSelectedPrimaryObjectInfo:function(t){var n="",a="";let i=this.altAppCore.altDataServices.shouldShowInstanceAlternates(this.selectedNode[0]);if(this.selectedNode[0].getID()==this.parentNode.getID())n=this.parentNode.getDisplayName(),a=U.get("eng.alternate.usage.info.reference");else if(this.options.viewInfo._isReferenceOrFlattenedORGroupView||!i)n=this.selectedNode[0].getDisplayName(),a=U.get("eng.alternate.usage.info.reference");else{let e=this.selectedNode[0].getInstanceTypeNLS&&this.selectedNode[0].getInstanceTypeNLS()?this.selectedNode[0].getInstanceTypeNLS():"";this.selectedNode.length>1?(a=U.get("eng.alternate.usage.info.instance.multiple").replace("$1",this.selectedNode.length).replace("$2",e),this.selectedNode.forEach(function(e){n+=e.getInstanceName()+", "}),n=n.substring(0,n.length-2)):(n=this.selectedNode[0].getInstanceName(),a=U.get("eng.alternate.usage.info.instance").replace("$1",this.selectedNode.length).replace("$2",e))}const o=e.String.escapeHTML(n);t.innerText="",t.addContent(a.bold()+" "+o),null==this.usageInfoTooltip&&(this.usageInfoTooltip=new N({position:"top",target:t}));var r=e.createElement("div",{class:"alternate_usageInfo_tooltip",html:a+" "+o});this.usageInfoTooltip.setBody(r)},initializeToolbar:function(){var e=this;this.alternateCollectionToolBarModelEvents=new t,this.eventsTokens=[],this.eventsTokens.push(e.alternateCollectionToolBarModelEvents.subscribe({event:L.TOOLBAR_SWITCH_VIEW},function(t){console.warn("switching view to  alternate --\x3e "+t),e.switchView(t)})),this.eventsTokens.push(e.alternateCollectionToolBarModelEvents.subscribe({event:L.HIDE_SHOW_MAKE_APPLICABLE_CMD},function(t){e._showHideToolbarCmds(new Array(L.CONSTANT_ALTERNATE_TOOLBAR_MAKE_APPLICABLE_CMD),t)})),this.eventsTokens.push(e.altOptions.alternateEnableDisableCommandEvents.subscribe({event:L.MULTI_SELECT_ENABLE_DISABLE_MAKE_APPLICABLE_CMD},function(){e.enableDisableToolbarCmdsOnUserSelections(e._addAlternateUX.ALTERNATE.model.getSelectedNodes())})),this.eventsTokens.push(e.alternateCollectionToolBarModelEvents.subscribe({event:L.MULTI_SELECT_ICON_UPDATE},function(t){e._alternateToolbar._updateIconMultiselectNumber(t)})),e._filterMenu=new A({renderTo:e._filterContainer,items:[{name:U.get("eng.alternate.filter"),fonticon:"list-filter",text:U.get("eng.alternate.filter"),handler:function(e){}}]}),e._alternateToolbar=new I({modelEvents:this.alternateCollectionToolBarModelEvents,container:this._rightMenuContainer,ListView:e}),e.buildToolBar()},buildToolBar:function(){if(!this._alternateToolbar)throw new Error(" toolbar not yet initialized");this._alternateToolbar.AddToolbarCommands(this.getSupportedToolBarActions())},getSupportedToolBarActions:function(){return f.getToolbarCmds(function(){u.renderAddAlternateDialog()})},setEnforcedChange:function(){var e=this.alternateManagementConfigurations;this.isChangeEnforced=e&&e.EnforceChangeRequired&&null!=e.EnforceChangeRequired&&null!=e.EnforceChangeRequired?e.EnforceChangeRequired:this.isChangeEnforced},getEnforcedChange:function(){return this.isChangeEnforced},manageHeaderNodeSelection:function(e){var t=this,n=e&&e._parentNode;t.altAppCore.altItemFactory.checkIfHeaderNode(e)?e.getChildren()&&e.getChildren().forEach(function(n){t.altAppCore.altItemFactory.checkIfNodeSelected(e)?n.select():n.unselect()}):t.altAppCore.altItemFactory.checkIfAlternateChildNode(e)&&(t.altAppCore.altItemFactory.checkIfNodeSelected(e)||n.unselect())},_showHideToolbarCmds:function(e,t){this._alternateToolbar._actionsIconBar.menu.items.forEach(function(n){for(var a=0;a<e.length;a++)if(n.id==e[a]){t?n.elements.container.removeClassName("enox-alternate-toolbar-item-hide"):n.elements.container.addClassName("enox-alternate-toolbar-item-hide");break}})},_enableDisableToolbarCmds:function(e,t){var n=this;n._alternateToolbar._actionsIconBar.menu.items.forEach(function(a){for(var i=0;i<e.length;i++)if(a.id==e[i]){t?(a.elements.container.removeClassName("enox-alternate-toolbar-item-disable"),n._alternateToolbar._actionsIconBar.enableItem(a.id)):(a.elements.container.addClassName("enox-alternate-toolbar-item-disable"),n._alternateToolbar._actionsIconBar.disableItem(a.id));break}})},disableToolbarCmds:function(){this._alternateToolbar.alternateCollectionToolBarModelEvents.publish({event:L.MULTI_SELECT_ICON_UPDATE,data:this.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes().length}),this._enableDisableToolbarCmds(new Array(L.CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_OBSELETE_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD,L.CHANGE_OWNER_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_MAKE_APPLICABLE_CMD),!1),this._enableDisableToolbarCmds(new Array(L.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!0)},enableToolbarCmds:function(e,t){this._enableDisableToolbarCmds(new Array(L.CHANGE_OWNER_CMD),!0),L.CONSTANT_PROPOSED==e?t?this._enableDisableToolbarCmds(new Array(L.CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!0):this._enableDisableToolbarCmds(new Array(L.CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!0):L.CONSTANT_QUALIFIED==e?t||this._enableDisableToolbarCmds(new Array(L.CONSTANT_ALTERNATE_TOOLBAR_OBSELETE_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!0):L.CONSTANT_NOT_APPLICABLE==e&&(this._enableDisableToolbarCmds(new Array(L.CONSTANT_ALTERNATE_TOOLBAR_REMOVE_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_APPROVE_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_OBSELETE_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_ADD_TO_CHANGE_CMD,L.CHANGE_OWNER_CMD,L.CONSTANT_ALTERNATE_TOOLBAR_CARRYOVER_CMD),!1),this._enableDisableToolbarCmds(new Array(L.CONSTANT_ALTERNATE_TOOLBAR_MAKE_APPLICABLE_CMD),widget.getValue(L.CONSTANT_SELECTED_PRIMARY_ITEM_DIFFERENT_LOGICALID)))},getTruncatedMessage:function(e){var t=e;return-1!=e.indexOf("Severity:")&&-1!=(t=t.replace(new RegExp("Severity:.*"),"")).indexOf(":")&&(t=t.replace(new RegExp(".*:"),"")),t},approveAlternate:function(){var e=this;e.altAppCore.altDataServices.approveAlternateItems(e).then(function(t){if(t[L.CONSTANT_ACTION]==L.SUCCESS){e.altAppCore.altSettingsManager.setAuthoringMode(L.CONSTANT_AUTHORING_MODE);var n=e._addAlternateUX.ALTERNATE.model.getSelectedNodes();e.updateStatusColumn(n,L.CONSTANT_PROPOSED),e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes()),d.sucessAlert(U.get("eng.alternate.approve.success"))}else d.errorAlert(e.getTruncatedMessage(t.response.message))})},removeAlternate:function(){var e=this;e.altAppCore.altDataServices.removeAlternateItems(e).then(function(t){if(t[L.CONSTANT_ACTION]==L.SUCCESS)e.removeDeletedRows(),e.altAppCore.altSettingsManager.setAuthoringMode(L.CONSTANT_AUTHORING_MODE),d.sucessAlert(U.get("eng.alternate.remove.success.message"));else{if(t.response&&t.response.message&&t.response.message.contains("access"))return void d.errorAlert(U.get("eng.alternate.modify.access.error"));d.errorAlert(e.getTruncatedMessage(t.response.message))}})},obsoleteAlternate:function(){var e=this;e.altAppCore.altDataServices.obsoleteAlternateItems(e).then(function(t){if(t[L.CONSTANT_ACTION]==L.SUCCESS){e.altAppCore.altSettingsManager.setAuthoringMode(L.CONSTANT_AUTHORING_MODE);var n=e._addAlternateUX.ALTERNATE.model.getSelectedNodes();e.updateStatusColumn(n,L.CONSTANT_QUALIFIED),e.enableDisableToolbarCmdsOnUserSelections(e.alternateModel.getSelectedNodes()),e.altAppCore.altSettingsManager.isChangeAuthorized()?d.sucessAlert(U.get("eng.alternate.proposed.obsolete.success.message")):d.sucessAlert(U.get("eng.alternate.obsolete.success.message"))}else d.errorAlert(e.getTruncatedMessage(t.response.message))})},selectionModified:function(e,t,n,a){_.mask(this.elements.container),this.selectionType=a,this.currentNodeId=n,this.selectedNode=e,this.parentNode=t,this._switchContainer("alternateItemsContent"),this.renderSelectedPrimaryObjectInfo(this.valueDiv),this._updateAlternateItemView(e[0]),this.disableToolbarCmds()},_updateAlternateItemView:function(e){var t=this;O.getAlternates(t,e.getID()).then(function(e){t.hasAlternatesInOtherContexts=!1,t.alternatesOnSelectedNode=v.mergeItemsOnAlternateCriteria(e);var n=m.createAlternateItemNodes(t.alternatesOnSelectedNode);t._getMakeApplicableCmdFlag(t.alternatesOnSelectedNode),t._addAlternateUX.ALTERNATE.update(n),t._alternateToolbar.alternateCollectionToolBarModelEvents.publish({event:L.MULTI_SELECT_ICON_UPDATE,data:t.altOptions._addAlternateUX.ALTERNATE.model.getSelectedNodes().length}),t.switchView(t.activeView)}).catch(function(e){console.error(e)}).finally(function(){_.unmask(t.elements.container)})},_getMakeApplicableCmdFlag:function(e){var t=!1;for(var n of e)if(n[L.CONSTANT_STATUS]==L.CONSTANT_NOT_APPLICABLE){t=!0,widget.getValue(L.CONSTANT_SELECTED_PRIMARY_ITEM_DIFFERENT_LOGICALID)||d.warningAlert(U.get("eng.alternate.primaryitem.multiselect.warning.message"));break}this._alternateToolbar.alternateCollectionToolBarModelEvents.publish({event:L.HIDE_SHOW_MAKE_APPLICABLE_CMD,data:t})},updateStatusColumn:function(e,t){for(var n=0;n<e.length;n++){if(!this.altAppCore.altItemFactory.checkIfHeaderNode(e[n])){e[n]._getRowID();this.updateStatusInGrid(e[n].options,t);e[n]._parentNode;this.altAppCore.altItemFactory.checkIfAlternateChildNode(e[n])&&this.updateParentNode(e[n],t),this.altAppCore.altItemFactory.updateAlternateNode(e[n]),e[n].select()}this.altAppCore.altItemFactory.updateGroupBy()}},updateParentNode:function(e,t){var n=this,a=e._parentNode,i=(a._getRowID(),a.options[L.CONSTANT_OTHER_CONTEXT_KEY]);i&&i.forEach(function(a){e.options.grid[L.CONSTANT_INSTANCE_CONTEXT_LOGICALID]===a.grid[L.CONSTANT_INSTANCE_CONTEXT_LOGICALID]&&n.updateStatusInGrid(a,t)}),a.options.grid[L.CONSTANT_DATAGRID_AVAILABLE_CONTEXT]=m.getContextColumnValue(a.options)},updateStatusInGrid:function(e,t){var n=e.grid[L.CONSTANT_STATUS];n==L.CONSTANT_PROPOSED&&n==t?e.grid[L.CONSTANT_STATUS]=L.CONSTANT_QUALIFIED:n==L.CONSTANT_QUALIFIED&&n==t&&(this.altAppCore.altSettingsManager.getAuthorizedChange().change&&this.altAppCore.altSettingsManager.getAuthorizedChange().change.id?e.grid[L.CONSTANT_STATUS]=L.CONSTANT_CHANGE_ATTACHED:e.grid[L.CONSTANT_STATUS]=L.CONSTANT_OBSOLETE)},removeDeletedRows:function(){var e=this._addAlternateUX.ALTERNATE.model.getSelectedNodes();this.removeDeletedRowFromView(e),this.altAppCore.altItemFactory.updateGroupBy(),this._addAlternateUX.ALTERNATE.model.getRoots().length<1&&(this.updateAlternateColumnWithValue(""),this.switchView(this.activeView)),this.disableToolbarCmds()},removeDeletedRowFromView:function(e){for(var t=0;t<e.length;t++){var n=e[t]._parentNode,a=this.altAppCore.altItemFactory.checkIfHeaderNode(e[t]),i=this.altAppCore.altItemFactory.checkIfAlternateChildNode(e[t]);if(!a&&i){var o=n._getRowID();if(this.altAppCore.altItemFactory.removeChildFromParentNode(n,e[t]),1!=n.options[L.CONSTANT_OTHER_CONTEXT_KEY].length||n.getChildren()&&n.getChildren()[0].isSelected())n.options[L.CONSTANT_OTHER_CONTEXT_KEY].length>0&&!n.areAllChildrenSelected()?this._addAlternateUX.ALTERNATE.model.addChild(n,o):0===n.options[L.CONSTANT_OTHER_CONTEXT_KEY].length&&this._addAlternateUX.ALTERNATE.model.removeRoot(n);else{n.options[L.CONSTANT_OTHER_CONTEXT_KEY];var r=m.createAlternateItemNodes(n.options[L.CONSTANT_OTHER_CONTEXT_KEY]);n.removeChildren(),this._addAlternateUX.ALTERNATE.model.removeRoot(n),this._addAlternateUX.ALTERNATE.model.addChild(r[0],o)}}else a||this._addAlternateUX.ALTERNATE.model.removeRoot(e[t]);e[t].select(),this._addAlternateUX.ALTERNATE.model.isGroupedByView&&!a&&(!i||i&&0===n.options[L.CONSTANT_OTHER_CONTEXT_KEY].length)&&this._addAlternateUX.ALTERNATE.model.getRoots().forEach(function(a){a.removeChild(e[t]),i&&a.removeChild(n)})}},updateChangeInGrid:function(e,t){e.grid[L.CONSTANT_WORK_UNDER_CHANGE_ID];null!=t&&null!=t&&""!=t&&(e.grid[L.CONSTANT_WORK_UNDER_CHANGE_ID]=t)},updateChangeColumn:function(e,t){for(var n=0;n<e.length;n++){if(!this.altAppCore.altItemFactory.checkIfHeaderNode(e[n])){e[n]._getRowID();this.updateChangeInGrid(e[n].options,t);e[n]._parentNode;this.altAppCore.altItemFactory.checkIfAlternateChildNode(e[n])&&this.updateParentNode(e[n],t),this.altAppCore.altItemFactory.updateAlternateNode(e[n]),e[n].select()}this.enableDisableToolbarCmdsOnUserSelections(e),this.altAppCore.altItemFactory.updateGroupBy()}},updateAlternateColumnWithValue:function(e){var t=this.options.activeEngItemTreeInfo._selectedNodes,n={};n.alternate=e,n[L.CONSTANT_KEY_PHYSICALID]=t[0].getID(),this.hasAlternatesInOtherContexts||s.publish("XEN/PUBLIC_EVENT/ENGINEERING_ITEM/ALTERNATE_UPDATED",[n])},checkValidAlternates:function(e,t,n,a){var i=!0;for(var o in e){if(a==L.CONSTANT_REMOVE&&e[o].options.grid.WorkUnderChangeActionPhyId&&""!=e[o].options.grid.WorkUnderChangeActionPhyId&&!this.altAppCore.altSettingsManager.isChangeAuthorized()){i=!1;var r=U.get("eng.alternate.invalid.remove.error.msg").replace("$1",e[o].options.Title).replace("$2",e[o].options.revision);d.errorAlert(r);break}if(a==L.CONSTANT_APPROVE&&this.altAppCore.altSettingsManager.isChangeAuthorized()&&!e[o].options.grid.WorkUnderChangeActionPhyId){i=!1;r=U.get("eng.alternate.invalid.approveWithchange.error.msg").replace("$1",e[o].options.Title).replace("$2",e[o].options.revision);d.errorAlert(r);break}if(e[o].options[L.CONSTANT_OTHER_CONTEXT_APPLICABLE_DATA_EXISTS]&&e[o].options.grid[L.CONSTANT_STATUS]!=n){var s=!1;if(e[o].options[L.CONSTANT_OTHER_CONTEXT_KEY].forEach(function(e){e.grid[L.CONSTANT_STATUS]==n&&(s=!0)}),!s){i=!1;r=U.get("eng.alternate.invalid.status.error.msg").replace("$1",e[o].options.Title).replace("$2",e[o].options.revision).replace("$3",t);d.errorAlert(r);break}}else if(e[o].options.grid[L.CONSTANT_STATUS]!=n){i=!1;r=U.get("eng.alternate.invalid.status.error.msg").replace("$1",e[o].options.Title).replace("$2",e[o].options.revision).replace("$3",t);d.errorAlert(r);break}}return i},performAction:function(e){e==L.CONSTANT_APPROVE?this.approveAlternate():e==L.CONSTANT_OBSOLETE?this.obsoleteAlternate():e==L.CONSTANT_REMOVE&&this.removeAlternate()},getSuperModelDailog:function(e){return new o({className:L.CONSTANT_CONFIRM_MODEL_CLASS,closable:!0,okButtonText:e,animate:!0,renderTo:this.altOptions.getAltFacetMainContainer()})},getConfirmationDailog:function(t,n,a,i){var o=this;(new r).inject(o.altOptions.getAltFacetMainContainer());var s=new e.Element("div",{html:n}),l=this.getSuperModelDailog(i);return l.dialog({body:s,title:t,buttons:[{className:"primary",value:i,action:function(e){var t=o.displayToggle.isChecked();t&&localStorage.setItem(a+".displayConfirmMsg",t),o.performAction(a),e.hide()}},{value:U.get("eng.alternate.button.cancel"),action:function(e){e.hide()}}]}),l},confirmToProceedDialog:function(e,t,n,a){if("true"==localStorage.getItem(n+".displayConfirmMsg"))this.performAction(n);else{this.getConfirmationDailog(e,t,n,a);this.displayToggle=new i({type:"checkbox",label:U.get("eng.alternate.ui.DisplayToggle"),checked:!1});var o=document.querySelector("."+L.CONSTANT_CONFIRM_MODEL_CLASS+" .modal-footer");this.displayToggle.inject(o)}},_buildAlternateMessageDisplayContent:function(){this._informationContainerBox=e.createElement("div",{class:"alternate_substitute_container_information"}),this._informationBox=e.createElement("div",{class:"alternate_substitute_information"}).inject(this._informationContainerBox),e.createElement("span",{class:"alternate_substitute_information_icon wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"}).inject(this._informationBox),this._messageInformationBox=e.createElement("h2",{class:"alternate_substitute_information_msg"}).inject(this._informationBox),this._informationContainerBox.hide(),this._informationContainerBox.inject(this.elements.container)},notApplicable:function(e){this._emptyModels(),"multipleSelection"==e?(this._displayInformationBox("multipleSelection"),this._switchContainer("information")):(this._displayInformationBox("notSupported"),this._switchContainer("information"))},_getAlternatePayload:function(e){return{[L.CONSTANT_REF_ID]:e}},_emptyModels:function(e){for(var t=e||Object.getOwnPropertyNames(this._addAlternateUX),n=0;n<t.length;n++)this._addAlternateUX[t[n]].model&&this._addAlternateUX[t[n]].model.empty()},_switchContainer:function(e){switch(e||this._activeContainer){case"information":this._informationContainerBox.show(),this._selectedUsageInfo.hide(),this._dataContainer.hide(),this.filterEmptyResultDOM.hide(),this._toolBarContainer.hide(),this._activeContainer="information";break;case"alternateItemsContent":this._informationContainerBox.hide(),this._selectedUsageInfo.show(),this._dataContainer.show(),this._toolBarContainer.show(),this._activeContainer="alternateItemsContent"}},_displayInformationBox:function(e){"notSupported"===e?this._messageInformationBox.setText(U.get("eng.alternate.notSupportedSelection")):"multipleSelection"===e?this._messageInformationBox.setText(U.get("eng.alternate.multipleSelection.msg")):"dragAlternateItem"===e&&this._messageInformationBox.setText(U.get("eng.alternate.dnd.add.message"))},_applyAddProductIcon:function(){var e=this._informationBox.getElement(".alternate_substitute_information_icon");e&&e.hasClassName("wux-ui-3ds-block")&&(e.removeClassName("wux-ui-3ds-block"),e.addClassName("fonticon fonticon-part-add"))},loadSourceOptions:function(){var e=this;return e.altAppCore.altDataServices.getSettingsForAlternateSources(L.CONSTANT_SUGGESTION_SOURCE_SETTINGS).then(function(t){return e.newSourceSettings=t?JSON.parse(t):null,e.newSourceSettings}).catch(function(e){console.log(e)})},resizeToolbar:function(){var e=this;this.resizor=new S(this._toolBarContainer,function(){e._alternateToolbar._actionsIconBar.resize()})}})});