define("DS/UnifiedExportCommand/Utils/ExchangeInfra",["UWA/Class","UWA/Class/Collection","DS/WAFData/WAFData","DS/CoreEvents/ModelEvents","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t,n,o,i,a,r){"use strict";return r.setNotificationManager(a),e.singleton({EngineeringFormatType:{NONE:0,ALL:1,NATIVE:2,DERIVED:3},URLS:{CVSERVLET_FETCH:"/cvservlet/fetch/v2",CVSERVLET_PROGESSIVEEXPAND:"/cvservlet/progressiveexpand/v2?output_format=cvjson&xrequestedwith=xmlhttprequest"},EVENTS:{LOAD_METHOD_FAILED:"loadmethodfailed",ERROR_OCCURED:"erroroccured",PREPROCESS_STARTED:"preprocessstarted",PREPROCESS_SUCCEEDED:"preprocesssucceeded",EXPAND_STARTED:"expandstarted",EXPAND_SUCCEEDED:"expandsucceeded",CHECKIN_STARTED:"checkinstarted",CHECKIN_SUCCEEDED:"checkinsucceeded",CHECKIN_PROGRESS:"checkinprogress"},SERVICE_CONFIG:{"STEP AP242":"exchange","CAD Files":"xcaddataprocessor","3DEXPERIENCE":"transfer"},SERVER:{VERB:{GET:"GET",POST:"POST",PATCH:"PATCH",DELETE:"DELETE"},DEFAULT_HEADERS:{Accept:"application/json","Accept-Language":window.widget?window.widget.lang:"en","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}},{setup:function(e){let t=this;return t._private_={modelEvents:new o},t.options=UWA.extend(t.options||{},e),t.APP_ID=t.getAppId(),UWA.Promise.all([t.expectations(),t.getPlatformServices().then(t.getSecurityContext.bind(null,t)).then(t.getGrantedRoles.bind(null,t))])},get:function(){return{platformServices:this.platformServices,securityContext:this.securityContext,grantedRoles:this.grantedRoles}},getPlatformServices:function(){let e=this;return new UWA.Promise(function(t,n){i.getPlatformServices({onComplete:e.postGetPlatformServices.bind(null,e,t)})})},postGetPlatformServices:function(e,t,n){let o=n.find(function(t){return t.platformId==e.getX3DPlatformId()});o||(o=n[0]),e.platformServices=o,e.platformServicesForAllPlatforms=n,t()},getSecurityContext:function(e){return new UWA.Promise(function(t,o){n.authenticatedRequest(e.platformServices["3DSpace"]+"/resources/pno/person/getsecuritycontext",{method:"GET",type:"json",proxy:"passport",onComplete:e.postGetSecurityContext.bind(null,e,t)})})},postGetSecurityContext:function(e,t,n){e.securityContext=n.SecurityContext,t()},getGrantedRoles:function(e){return new UWA.Promise(function(t,n){i.getGrantedRoles(e.postGetGrantedRoles.bind(null,e,t))})},postGetGrantedRoles:function(e,t,n){e.grantedRoles=n,t()},getAppId:function(){return this.getWidget()&&widget.getValue("x3dAppId")||this.options.context&&this.options.context.getAppId&&this.options.context.getAppId()},getX3DPlatformId:function(){return this.getWidget()&&widget.getValue("x3dPlatformId")||this.options.context.getX3DPlatformId&&this.options.context.getX3DPlatformId()},getWidget:function(){return window.widget&&window.widget||this.options.widget},expectations:function(){var e=this;return new UWA.Promise(function(t,n){var o=["DS/UnifiedExportCommand/Utils/Expectations",["ENOFOL3_AP","ENOPSTR_AP","ENOSCEN_AP","ENXENG_AP","X3DSEAR_AP"].includes(e.APP_ID)&&e.APP_ID||"ExpectationsBase"].join("/");require([o],n=>{for(var o in n.prototype)"contructor"!=n.prototype&&(e.__proto__[o]=n.prototype[o]);t()},n)})},server:function(e){var t={url:e.url,method:e.method||this.SERVER.VERB.GET,data:e.data,dataType:e.dataType||"json",timeout:e.timeout||5e5,cache:e.cache||3600,proxy:e.proxy||void 0,onComplete:e.onComplete,onFailure:e.onFailure,headers:e.headers&&UWA.merge(e.headers,this.SERVER.DEFAULT_HEADERS)||this.SERVER.DEFAULT_HEADERS};return n.authenticatedRequest(t.url,t)},alert:{info:function(e,t){return a.addNotif({title:e,message:t,level:"info"})},success:function(e,t){return a.addNotif({title:e,message:t,level:"success"})},warning:function(e,t){return a.addNotif({title:e,message:t,level:"warning"})},error:function(e,t){return a.addNotif({title:e,message:t,level:"error"})}},unique:function(){return UUID.v4().substring(0,10).replaceAll("-","")},noop:function(){}})}),define("DS/UnifiedExportCommand/SearchLocalAction/SearchLocalActionsForExport",["UWA/Class","UWA/Class/Debug","UWA/Class/Events","UWA/Environment"],function(e,t,n,o){return e.singleton(n,t,{executeAction:function(e){e.object_id&&e.actionsHelper.getServiceURL({onComplete:function(t){require.config({paths:{"DS/UnifiedExportCommand":t+"/webapps/UnifiedExportCommand"}}),require(["DS/UnifiedExportCommand/Commands/UnifiedExportCommandExt","DS/UnifiedExportCommand/Commands/UnifiedExportCommand","DS/UnifiedExportCommand/Utils/ProxyContext"],function(t,n,o){if("exportAs"==e.action_id)new t({context:new o({treeDocument:e.collection.getTreeDocument(),selectedNodes:e.collection.getTreeDocument().getSelectedNodes(),x3dAppId:"X3DSEAR_AP",x3dPlatformId:e.collection.search_ressources.active_tenant})})})},id:e.object_id})}})}),define("DS/UnifiedExportCommand/Views/ParameterView",["UWA/Class/Model","UWA/Class/View","DS/Controls/Label","DS/Controls/TooltipModel"],function(e,t,n,o){"use strict";return t.extend({tagName:"div",className:"exportcommand-parameterview",setup:function(){this.model=new e},build:function(e,t){try{let n=this;return n.model.options={fieldCfg:e},n.key=e.key,n.resolve=t,e.type?require([e.type],function(t){(n.control=new t(e.options),e.custom)?n.control.inject(n.container):(n.control.getContent().setStyles({width:"100%"}),e.label?n.buildRow(e,n.control).inject(n.container):n.control.inject(n.container),e.validFlagChange&&n.control.addEventListener("validFlagChange",e.validFlagChange),e.uncommittedChange&&n.control.addEventListener("uncommittedChange",e.uncommittedChange),e.blur&&n.control.addEventListener("blur",e.blur),e.keydown&&n.control.addEventListener("keydown",e.keydown),n.control.addEventListener("change",e.change?e.change:t=>{let o=t.target.dsModel;null==o.checkFlag&&null==o.value||(n.model.unset(e.key),n.model.set(e.key,null!=o.checkFlag?o.checkFlag:o.value))}),"boolean"==UWA.typeOf(n.control.value)?(n.control.checkFlag=!e.value,n.control.checkFlag=e.value):(n.control.value=void 0,n.control.value=e.value));n.resolve&&n.resolve(n.control)}):e.hidden&&n.model.set(e.key,e.value),n.control}catch(e){console.log(e)}},buildRow:function(e,t){let n=this;try{let o=UWA.createElement("div",{class:"exportcommand-parametersview-group"}),i=UWA.createElement("div",{class:"exportcommand-parametersview-row"}).inject(o),a=(UWA.createElement("div",{class:"exportcommand-parametersview-col-label",html:n.buildLabel(e)}).inject(i),UWA.createElement("div",{class:"exportcommand-parametersview-col-value"}).inject(i));return n.buildValue(t,e).inject(a),o}catch(e){console.log(e)}},buildLabel:function(e){var t={value:e.label};e.help&&(t.tooltipInfos=new o({title:e.label,shortHelp:e.help,mouseRelativePosition:!0,position:"top"}));var i=new n(t);return i.getContent().style.marginLeft="0px",i.getContent().style.background="transparent",i.getContent().style.fontWeight="bold",i.getContent().style.maxWidth="95%",i},buildValue:function(e){return UWA.createElement("div",{class:"exportcommand-parametersview-col-value-cell1",html:e})}})}),define("DS/UnifiedExportCommand/Collections/TransferSuperTreeDocument",["DS/TreeModel/TreeDocument","DS/WAFData/WAFData"],(e,t)=>{const n={Accept:"application/json","Accept-Language":window.widget?window.widget.lang:"en","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"};return e.extend({isEmpty:function(){return 0===this.getRoots().length},hasSingleRoot:function(){return 1===this.getRoots().length},defaultSelection:function(){this.hasSingleRoot()&&this.selectAll()},getSelected:function(){return this.getSelectedNodes()[0]},populate:function(){this.defaultSelection()},server:function(e){var o={url:e.url,method:e.method||"GET",data:e.data,dataType:e.dataType||"json",timeout:e.timeout||5e5,cache:e.cache||3600,proxy:e.proxy||void 0,onComplete:e.onComplete,onFailure:e.onFailure,headers:e.headers&&UWA.merge(e.headers,n)||n};return t.authenticatedRequest(o.url,o)}})}),define("DS/UnifiedExportCommand/Utils/Expectations/ExpectationsBase",["UWA/Class","DS/Utilities/UUID","DS/UnifiedExchangeAnalytics/Tracker"],function(e,t,n){"use strict";return e.extend({CVQUERY:{EXPAND:{level:-1,batch:{graph:{}},outputs:{select_object:["physicalid","type","interface","ds6w:cadMaster","flattenedtaxonomies"],select_relation:["identifier","physicalid","type","interface","flattenedtaxonomies"],format:"entity_relation_occurrence"}}}},{setCVFNodes:function(e){this.cvfnodes=e},treatAsRoot:function(e){return this.isGroupingApplied()},extractRoot:function(e){return e.getRoot()},refineSelectionByValidCVFNodes:function(e){var t=this;return!t.cvfnodes||!(t.cvfnodes&&!t.cvfnodes.find(n=>{return n.attributes.find(e=>"resourceid"===e.name).value===t.getNodeId(e)}))},isGroupingApplied:function(){return this.getTreeDocument().isGroupingApplied&&this.getTreeDocument().isGroupingApplied()},getTreeDocument:function(){var e=this.options.context;return e.options.model||e.getPADTreeDocument()},processSelectedNodes:function(e){var t=this,n=[];return e.forEach(e=>{if(e.isGroupingNode){t.options.groupingApplied=!0;var o=e.getChildren();o.length?n=n.concat(t.processSelectedNodes(o)):t._private_.modelEvents.publish({event:t.EVENTS.ERROR_OCCURED,data:{message:UWA.i18n("exchangecommand.notification.expansionfailed.groupnotexpanded")}})}else if(e.isRelationsObjectNode)return;t.refineSelectionByValidCVFNodes(e)&&n.push(e)}),n},getSelectedNodes:function(){return this.options.context.getSelectedNodes()},getExportableContent:function(){var e=this.getSelectedNodes();return this.processSelectedNodes(e)},getOccurrencePath:function(e){return e.getOccurrencePath&&e.getOccurrencePath()},getNodeId:function(e){return e.getID&&e.getID()||e.options.id},extractNodes:function(){var e=this,t=[],o=[],i=e.getExportableContent();return n.setSelectionSize(i.length),i.forEach(n=>{let i=-1;if(e.treatAsRoot(n)){var a=n.getID&&n.getID()||n.options.id;-1===(i=t.indexOf(a))&&(t.push(a),o.push([[a]]))}else{let a=e.getOccurrencePath(n),r=e.extractRoot(n).getID();-1===(i=t.indexOf(r))?(t.push(r),o.push([a])):o[i]&&o[i].push(a)}}),{roots:t,paths:o}},expandLabel:function(){return`unifiedexport-${this.APP_ID}-${(new Date).getTime()}`},expandGraphParams:function(){return this.CVQUERY.EXPAND.batch.graph},expandLevel:function(){return this.CVQUERY.EXPAND.level},prefixPath:function(e){return e.map(e=>({physical_id_path:e}))},expandFilterParams:function(e,t){var n=this.options.context,o={filter:{all:1}};if(n.GetFilterSpec){var i=this.prefixPath(t);o=n.GetFilterSpec(e,{V2:{prefixPathArray:i}})}return o.filter},expandOutput:function(){return{select_object:this.CVQUERY.EXPAND.outputs.select_object,select_relation:this.CVQUERY.EXPAND.outputs.select_relation,format:this.CVQUERY.EXPAND.outputs.format}},expandBatch:function(e,t){var n=this,o={label:n.expandLabel(),root:{physical_id:e},filter:n.expandFilterParams(e,t),graph:n.expandGraphParams()},i=n.expandLevel();return i>-1&&(o.aggregation_processors=[{truncate:{max_distance_from_prefix:i,prefix_filter:{prefix_path:n.prefixPath(t)}}}]),o},expandQuery:function(){var e=this,t=e.extractNodes(),n=t.roots,o=t.paths,i=n&&n.map((t,n)=>{var i=o[n];return e.expandBatch(t,i)});return i&&{batch:{expands:i},outputs:e.expandOutput()}||void 0},fetchQuery:function(){var e=this;return e.setCVFNodes(void 0),{physicalid:e.getExportableContent().map(t=>e.getNodeId(t)),label:e.expandLabel(),select_predicate:["flattenedtaxonomies"]}}})}),define("DS/UnifiedExportCommand/Utils/ProxyContext",["UWA/Core","UWA/Class","UWA/Class/Options"],function(e,t,n){"use strict";return t.extend(n,{init:function(e){this._parent(),this.setOptions(e)},getSelectedNodes:function(){return this.options.selectedNodes||[]},getTreeDocument:function(){return this.options.treeDocument},getPADTreeDocument:function(){return this.options.treeDocument},getX3DPlatformId:function(){return this.options.x3dPlatformId},getAppId:function(){return this.options.x3dAppId}})}),define("DS/UnifiedExportCommand/Views/Options/ExpandLevel",["DS/Controls/Abstract","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WUXAutoComplete/AutoComplete","DS/UnifiedExportCommand/Utils/ExchangeInfra"],(e,t,n,o,i)=>{"use strict";const a=/^([6-9]\d*|[1-9]\d+)$/,r=/^$/;return e.inherit({name:"expandLevel",publishedProperties:{value:{defaultValue:void 0,type:"number"}},init:function(e){this.setOptions(e),this._parent()},buildView:function(){var e=this;e.elements.autocomplete=new o({fireOnlyFromUIInteractionFlag:!1,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1,keepSearchResultsFlag:!1,customFilterMessage:UWA.i18n("exchangecommand.options.field.expandLevel.error"),placeholder:"",elementsTree:e.elementsTree()}),e.elements.container.appendChild(e.elements.autocomplete.getContent()),e.elements.autocomplete.addEventListener("uncommittedChange",e.uncommittedChange.bind(null,e)),e.elements.autocomplete.addEventListener("change",e.change.bind(null,e)),e.elements.autocomplete.addEventListener("blur",e.blur.bind(null,e)),e.elements.autocomplete.addEventListener("keydown",e.keydown.bind(null,e))},_applyValue:function(e,t){this.elements.autocomplete.value=this.value},uncommittedChange:function(e,t){var o=e.treeDocument,i=o.getRoots(),s=t.dsModel.getValueToCommit();if(a.test(s)){s=Number(s),o.prepareUpdate();var l=i.find(e=>e.options.freeText);l&&l.remove(),l=new n({label:String(s),value:Number(s),freeText:!0}),o.addChild(l,7),o.pushUpdate(),e.options.exchangemodel.set("uexp-validFlag-expansion",!1)}else if(r.test(s)){o.prepareUpdate();for(let e=0;e<i.length;e++){const t=i[e];if(t.options.freeText){t.remove();break}}o.pushUpdate(),t.target.dsModel.value=void 0,t.target.dsModel.value=-1}else e.options.exchangemodel.set("uexp-validFlag-expansion",!1)},change:function(e,t){e.options.exchangemodel.set("uexp-expandLevel",t.dsModel.value)},blur:function(e,t){e.options.exchangemodel.set("uexp-validFlag-expansion",!0)},keydown:function(e,t){e.options.exchangemodel.set("uexp-validFlag-expansion",!0)},elementsTree:function(){var e=this;return e.treeDocument=new t({}),e.treeDocument.prepareUpdate(),[{label:UWA.i18n("exchangecommand.options.field.expandLevel.expandNone"),value:0},{label:UWA.i18n("exchangecommand.options.field.expandLevel.expandAll"),value:-1},{label:"1",value:1},{label:"2",value:2},{label:"3",value:3},{label:"4",value:4},{label:"5",value:5}].forEach(t=>{var o=new n(t);e.treeDocument.addRoot(o)}),e.treeDocument.pushUpdate(),e.treeDocument}})}),define("DS/UnifiedExportCommand/Utils/Expectations/ENXENG_AP",["DS/UnifiedExportCommand/Utils/Expectations/ExpectationsBase"],e=>{"use strict";return e.extend({CVQUERY:{EXPAND:{level:-1,batch:{graph:{descending_condition_object:{uql:'(flattenedtaxonomies:"types/VPMReference") OR (flattenedtaxonomies:"types/VPMRepReference") OR (flattenedtaxonomies:"types/XCADNonPSBaseRepReference") OR (flattenedtaxonomies:"types/XCADModelRepReference") OR (flattenedtaxonomies:"types/Document")'},descending_condition_relation:{uql:"(taxonomies:*VPMInstance*) OR (taxonomies:*VPMRepInstance*) OR (taxonomies:*XCADAssemblyRepInstance*) OR (taxonomies:*Reference Document*) OR (taxonomies:*SpecificationDocument*)"}}}}}},{treatAsRoot:function(e){return!(this.isStructureIndented()&&!this.isGroupingApplied())},extractRoot:function(e){return this.isStructureIndented()?this.options.context.getActiveEngItem():this._parent(e)},expandLevel:function(){return this.isStructureIndented()||this.options.context.isThereARootSelected()?this.CVQUERY.EXPAND.level:0},getTreeDocument:function(){return this.options.context.getXENTreeDocument()},isStructureIndented:function(){return this.options.context.isStructureIndented()}})}),define("DS/UnifiedExportCommand/Utils/Expectations/ENOSCEN_AP",["DS/UnifiedExportCommand/Utils/Expectations/ExpectationsBase"],e=>{"use strict";return e.extend({getOccurrencePath:function(e){return e.getOccurencePath&&e.getOccurencePath()}})}),define("DS/UnifiedExportCommand/Utils/Expectations/ENOPSTR_AP",["DS/UnifiedExportCommand/Utils/Expectations/ExpectationsBase"],e=>{"use strict";return e.extend({getOccurrencePath:function(e){return e.getOccurencePath&&e.getOccurencePath()}})}),define("DS/UnifiedExportCommand/Collections/PlatformsTreeDocument",["DS/TreeModel/TreeNodeModel","DS/UnifiedExportCommand/Collections/TransferSuperTreeDocument","DS/UnifiedExportCommand/Utils/ExchangeInfra"],(e,t,n)=>{const o="/resources/v1/collaboration/tenant",i="/resources/v1/collaboration/destination";return e=e.extendNode({toNodeOpts:function(e){return{value:{label:e.name,icon:"topbar-cloud",id:e.id},raw:e}},getId:function(){return this.options.raw.id},getName:function(){return this.options.raw.name}}),t.extend({init:function(e){this._parent(e),this._destinations={}},getSelectedPlatformId:function(){return this.getSelected().getId()},getSelectedPlatformName:function(){return this.getSelected().getName()},hasDestinations:function(){return this._destinations[this.getSelectedPlatformId()]},getPlatforms:function(){var e=this;return new UWA.Promise((t,i)=>{e.server({url:`${n.platformServices.ieclb}${o}`,onComplete:function(n){n=JSON.parse(n),e.populate(n.platforms,t,i)},onFailure:function(){i()}})})},populate:function(t,n,o){var i=this;try{i.prepareUpdate(),t.forEach(t=>{var n=new e({});n.updateOptions(n.toNodeOpts(t)),i.addRoot(n)}),i.pushUpdate(),i._parent(),1==i.getRoots().length&&i.getRoots()[0].select(),n()}catch{o()}},isLoggedInOnDestinations:function(){var e=this;return new UWA.Promise((t,o)=>{let i=n.platformServicesForAllPlatforms.find(t=>t.platformId==e.getSelectedPlatformId())["3DPassport"];fetch(`${i}/login`,{credentials:"include",method:"GET",headers:{Accept:"application/json","Accept-Language":"en","Content-Type":"application/json"}}).then(e=>{!e||200!=e.status||e.url!==`${i}/login`&&e.url!==`${i}/3DPassport/login`?t():t({url:`${i}/3DPassport/login`})})})},getDestinations:function(){var e=this;return new UWA.Promise((t,o)=>{if(e.hasDestinations())t();else{let a=n.platformServicesForAllPlatforms.find(t=>t.platformId==e.getSelectedPlatformId());e.server({url:`${a.ieclb}${i}?filter=${e.getSelectedPlatformId()}`,onComplete:e.getDestinationsSuccess.bind(null,e,t),onFailure:e.getDestinationsFailure.bind(null,e,o)})}})},getDestinationsSuccess:function(e,t,n){n=JSON.parse(n),e._destinations[e.getSelectedPlatformId()]=n,t()},getDestinationsFailure:function(e,t){t()},getCSpaces:function(){var e=this._destinations[this.getSelectedPlatformId()].cspaces;const t=[],n={};return e.forEach(e=>{if(e.collaboration)t.push(e);else{const o=e.name;n[o]||(n[o]=!0,t.push(e))}}),t},getOrganizationsByCSpace:function(e){if(e){var t=this._destinations[this.getSelectedPlatformId()].cspaces;const n={};if(t.forEach((t,o)=>{t.name==e.getName()&&(n[t.name]?n[t.name]=[...n[t.name],t]:n[t.name]=[{...t}])}),e.isCollaboration()&&n&&Object.keys(n).length&&n[e.getName()].length>1)return;return n[e.getName()]}}})}),define("DS/UnifiedExportCommand/Collections/OrganzationTreeDocument",["DS/TreeModel/TreeNodeModel","DS/UnifiedExportCommand/Collections/TransferSuperTreeDocument"],(e,t)=>(e=e.extendNode({toNodeOpts:function(e){return{value:{label:e.org,icon:"building-office"},raw:e}},getName:function(){return this.options.raw}}),t.extend({getSelectedOrg:function(){return this.getSelected().getName()},populate:function(t){var n=this;t&&(n.prepareUpdate(),n.empty(),t.organizations.forEach(t=>{var o=new e;o.updateOptions(o.toNodeOpts(t)),n.addRoot(o)}),n.pushUpdate(),n._parent())}}))),define("DS/UnifiedExportCommand/Models/EngineeringFormatsModel",["UWA/Class/Model","DS/UnifiedExportCommand/Utils/ExchangeInfra"],function(e,t){"use strict";try{const n="3d-object-unknown-format",o="derived-output",i="/resources/v1/modeler/conversionAdmin/derivedformatmanagement/declarative",a="/resources/v1/derivedoutput/derivedoutputrules/getconversionrules?downloadableOnly=true";return e.extend({defaults:{engineeringType:"part"},setup:function(){this._private={currentReq:[]}},transform:function(){return this._attributes},getCADMasters:function(e){var t=this.get("engineeringType");e=e||this.objects||[];var n=new Set;return e.forEach(e=>{var o=e["ds6w:cadMaster"],i=e.flattenedtaxonomies;o&&("drawing"===t&&i.includes("types/Drawing")?n.add(o):"part"!==t||i.includes("types/Drawing")||n.add(o))}),n.delete("3DEXPERIENCE"),[...n]},getNativeFormats:function(){var e=this;return new UWA.Promise((t,o)=>{var i=e.getCADMasters();i.sort(),t(i=i.map(e=>({value:e,label:e,native:"true",icon:n,tooltipInfos:{title:"dwdw"}})))})},getDerivedFormats:function(){let e=this;return new UWA.Promise(function(n,o){if(e.derivedformats)n(e.derivedformats);else{let i=[t.platformServices["3DSpace"],a].join("");e.currentReq=t.server({url:i,headers:{SecurityContext:t.securityContext},onComplete:e.postGetDerivedFormatsSuccess.bind(null,e,n),onFailure:e.postGetDerivedFormatsFailure.bind(null,e,o)})}})},postGetDerivedFormatsSuccess:function(e,t,n){var i=(n=JSON.parse(n)).derivedOutputRules,a="part"===e.get("engineeringType"),r=new Set;e.derivedformats=Array.from(new Set(i.reduce((e,t)=>{if(!r.has(t.target)){var n={value:t.target,label:t.target,icon:o};a&&"Part"===t.sourceType?(e.push(n),r.add(t.target)):a||"Drawing"!==t.sourceType||(e.push(n),r.add(t.target))}return e},[]))).sort((e,t)=>e.label.localeCompare(t.label)),t(e.derivedformats)},postGetDerivedFormatsFailure:function(e,t){t()},getAllFormats:function(){return UWA.Promise.all([this.getNativeFormats(),this.getDerivedFormats()])},getFormats:function(e){var n=this;return n.formatType=e.formatType||t.EngineeringFormatType.ALL,n.objects=e.objects||[],t.EngineeringFormatType.ALL===n.formatType?this.getAllFormats():t.EngineeringFormatType.NATIVE===n.formatType?this.getNativeFormats():t.EngineeringFormatType.DERIVED===n.formatType?this.getDerivedFormats():void 0},getFormatParameters:function(e){let t=this;return new UWA.Promise(function(n,o){t.getDeclarative().then(t.filterParameters.bind(null,t,e,n))})},getFormatParameterNLS:function(e,t){return this._private.declarative.nlsData[e].parameter[t]},getDeclarative:function(){let e=this;return new UWA.Promise(function(n,o){if(e._private.decalrative)n(e._private.decalrative);else{let a=[t.platformServices["3DSpace"],i].join("");e._private.currentReq.push(t.server({url:a,onComplete:e.postGetDeclarativeSuccess.bind(null,e,n),onFailure:e.postGetDeclarativeFailure.bind(null,o)}))}})},postGetDeclarativeSuccess:function(e,t,n){e._private.declarative=JSON.parse(n),t(e._private.declarative)},postGetDeclarativeFailure:function(e){e()},filterParameters:function(e,t,n){var o=[];let i=e._private.declarative.data.find(e=>e.name.toLowerCase()===t.source.toLowerCase()).connectors.find(function(e){return e.id.toLowerCase()===t.connector.toLowerCase()});if(i.id==t.connector){let e=i.supportedformats.find(function(e){return e.source.type.toLowerCase()===t.sourceType.toLowerCase()});if(e.source.type.toLowerCase()==t.sourceType.toLowerCase()){o=e.targets.find(function(e){return e.target.toLowerCase()===t.target.toLowerCase()}).parameters}}n(o)},cancel:function(){this._private.currentReq&&this._private.currentReq.forEach(e=>{e.cancel()})}})}catch(e){console.log(e)}}),define("DS/UnifiedExportCommand/Utils/Expectations/ENOFOL3_AP",["DS/UnifiedExportCommand/Utils/Expectations/ExpectationsBase"],e=>{"use strict";return e.extend({CVQUERY:{EXPAND:{level:-1,batch:{graph:{descending_condition_object:{uql:'(flattenedtaxonomies:"types/Workspace Vault") OR (flattenedtaxonomies:"types/Workspace") OR (flattenedtaxonomies:"types/VPMReference") OR (flattenedtaxonomies:"types/VPMRepReference") OR (flattenedtaxonomies:"types/XCADNonPSBaseRepReference") OR (flattenedtaxonomies:"types/XCADModelRepReference") OR (flattenedtaxonomies:"types/Document")'},descending_condition_relation:{uql:"(taxonomies:*Vaults*) OR (taxonomies:*Vaulted Objects*) OR (taxonomies:*VPMInstance*) OR (taxonomies:*VPMRepInstance*) OR (taxonomies:*XCADAssemblyRepInstance*)"}}}}}},{treatAsRoot:function(e){var t=this.getWidget()&&this.getWidget().getValue("allow-products-expand")&&e.isTreeElementType&&!e.isTreeElementType()&&(e.canBeExpanded&&e.canBeExpanded()||e.getFirstVisibleParent&&e.getFirstVisibleParent());return!(!t||!this.getWidget()||"XCAD"!==this.getWidget().getValue("exportMethod"))||!t},getOccurrencePath:function(e){return e.getOccurencePath&&e.getOccurencePath()}})}),define("DS/UnifiedExportCommand/Utils/Expectations/X3DSEAR_AP",["DS/UnifiedExportCommand/Utils/Expectations/ENOFOL3_AP"],e=>{"use strict";return e.extend({getTreeDocument:function(){return this.options.context.getTreeDocument()}})}),define("DS/UnifiedExportCommand/Collections/CollaborationTreeDocument",["DS/TreeModel/TreeNodeModel","DS/UnifiedExportCommand/Collections/TransferSuperTreeDocument","DS/UnifiedExportCommand/Utils/ExchangeInfra"],(e,t,n)=>(e=e.extendNode({toNodeOpts:function(e){var t=e.collaboration;return{value:{label:t?e.collaboration.title:e.name,subLabel:t?"Extended Collaboration":"Collaborative Space",icon:e.collaboration?`${n.platformServices.ieclb}/webapps/Collaborations/assets/img/I_ExtendedCollaborationsObject_Thumbnail.png`:`${n.platformServices["3DSpace"]}/webapps/W3DDrive/assets/Collab_Space_Thumbnail.png`,securityContext:e.securityContext},raw:e}},isCollaboration:function(){return this.options.raw.collaboration},getName:function(){return this.options.raw.name},getSecurityContext:function(){return this.options.raw.securityContext}}),t.extend({getSelectedOrg:function(){return this.getSelected().getOrg()},getCollaborationsByOrg:function(e){if(e){return this.getRoots().filter(e=>e.hasOrg())}},populate:function(t){var n=this;t&&(n.prepareUpdate(),n.empty(),t.collaborations.forEach(t=>{var o=new e;o.updateOptions(o.toNodeOpts(t)),n.addRoot(o)}),n.pushUpdate(),n._parent(),1==n.getRoots().length&&n.getRoots()[0].select())}}))),define("DS/UnifiedExportCommand/Views/Options/Transfer/Destinations",["UWA/Class/Model","DS/Controls/Abstract","DS/UnifiedExportCommand/Collections/PlatformsTreeDocument","DS/UnifiedExportCommand/Collections/CollaborationTreeDocument","DS/UnifiedExportCommand/Collections/OrganzationTreeDocument","DS/UnifiedExportCommand/Views/ParameterView","DS/UnifiedExportCommand/Utils/ExchangeInfra","i18n!DS/UnifiedExportCommand/assets/nls/IPTransferNLS","css!DS/UnifiedExportCommand/UnifiedExportCommand"],(e,t,n,o,i,a,r,s)=>{"use strict";UWA.i18n(s);UWA.i18n("exchangecommand.options.placeholder.chooseall"),UWA.i18n("exchangecommand.options.placeholder.choosenative"),UWA.i18n("exchangecommand.options.placeholder.choosederived");let l,c;return t.inherit({name:"transfer-destinations",init:function(e){this.setOptions(e),this._parent()},buildView:function(){var t=this;t.options.exchangemodel=t.options.exchangemodel||new e,t.model=new e,t.model.addEvent("onChange:destination-selected",t.transformAndFire.bind(null,t)),l=new UWA.Element("div",{class:"transfer-specific-container"}).inject(t.elements.container),c=new UWA.Element("div",{class:"transfer-error-text-container"}).inject(t.elements.container),t.setupPlatforms()},setupPlatforms:function(){var e=this;e.options.exchangemodel.set("uexp-validFlag-transferdestination",!1),e.platformTreeDocument=new n,e.platform=new a({}).inject(l),new UWA.Promise(function(t){e.platform.build({key:"platform",label:UWA.i18n("iptransfer.dialog.field.tenants.label"),value:!0,type:"DS/WUXAutoComplete/AutoComplete",options:{placeholder:UWA.i18n("iptransfer.loader.tenants"),disabled:!0,multiSearchMode:!1,allowFreeInputFlag:!1,columnOptions:{autoRowHeightFlag:!0,typeRepresentation:"detailedInfo"},elementsTree:e.platformTreeDocument},change:e.platformChange.bind(null,e)},t)}).then(function(){e.platformTreeDocument.getPlatforms().then(e.platformsFound.bind(null,e)).fail(e.platformsFound.bind(null,e))})},platformsFound:function(e){e.platform.control.disabled=!1,e.platform.control.placeholder=UWA.i18n("iptransfer.dialog.field.placeholder.choosetenant"),e.platformTreeDocument.isEmpty()},platformsNotFound:function(e){e.platform.control.disabled=!0},setupErrorText:function(e){c.empty(),new UWA.Element("p",{class:"transfer-error-text",text:e,styles:{margin:"0 10px",color:"red",fontWeight:"600"}}).inject(c)},platformChange:function(e,t){t.stopPropagation(),t.dsModel.value?(e.options.exchangemodel.set("uexp-selected-platform",e.platformTreeDocument.getSelectedPlatformId()),e.options.exchangemodel.set("uexp-validFlag-transferdestination",!1),e.collaboration?(e.organization&&e.organization.destroy(),e.updateCollabOnPlatformChange(e)):e.setupCollaborations()):e.collaboration&&e.collaboration.control&&(e.options.exchangemodel.set("uexp-validFlag-transferdestination",!1),e.collaboration.control.value=void 0,e.collaboration.control.disabled=!0,e.collaboration.hide())},updateCollabOnPlatformChange:function(e){e.collaboration.show(),e.collaboration.control.value=void 0,e.collaboration.control.disabled=!0,e.collaboration.control.placeholder=UWA.i18n("iptransfer.loader.destinations"),e.platformTreeDocument.isLoggedInOnDestinations().then(t=>{t&&t.url?r._private_.modelEvents.publish({event:r.EVENTS.ERROR_OCCURED,data:{message:UWA.String.format(UWA.i18n("iptransfer.alert.destination.not.reachable"),e.platformTreeDocument.getSelectedPlatformId()),action:{label:UWA.i18n("iptransfer.alert.actions.login"),callback:function(){var e=UWA.createElement("a");e.style.display="none",e.href=t.url,e.target="_blank",document.body.appendChild(e),e.click()}},allowUnsafeHTML:!0}}):e.platformTreeDocument.getDestinations().then(()=>{e.model.set("destinations-loaded",!0),e.collaboration.show(),e.collaboration.control.value=void 0,e.collaboration.control.disabled=!1,e.collaboration.control.placeholder=UWA.i18n("iptransfer.dialog.field.placeholder.choosedestination"),e.collaboration.control.elementsTree.populate({collaborations:e.platformTreeDocument.getCSpaces()})}).fail(()=>{r._private_.modelEvents.publish({event:r.EVENTS.ERROR_OCCURED,data:{message:UWA.i18n("iptransfer.alert.destination.not.reachable2")}})})})},setupCollaborations:function(){var e=this;e.organization&&e.organization.destroy(),e.collaborationTreeDocument=new o,e.collaboration=new a({}).inject(l),new UWA.Promise(function(t){e.collaboration.build({key:"collaboration",label:UWA.i18n("iptransfer.dialog.field.destinations.label"),value:!0,type:"DS/WUXAutoComplete/AutoComplete",options:{placeholder:UWA.i18n("iptransfer.loader.destinations"),disabled:!0,multiSearchMode:!1,allowFreeInputFlag:!1,columnOptions:{autoRowHeightFlag:!0,typeRepresentation:"detailedInfo"},elementsTree:e.collaborationTreeDocument},change:e.collaborationChange.bind(null,e)},t)}).then(()=>{e.collaboration.control.disabled=!0,e.collaboration.show(),e.collaboration.control.placeholder=UWA.i18n("iptransfer.loader.destinations"),e.updateCollabOnPlatformChange(e)})},collaborationChange:function(e,t){t.stopPropagation(),t.dsModel.value?e.setupOrganizations():(e.organization&&e.organization.destroy(),e.options.exchangemodel.set("uexp-validFlag-transferdestination",!1)),e.setDimensionChanged()},setDimensionChanged:function(){this.model.unset("dimensionChanged"),this.model.set("dimensionChanged",!0)},setupOrganizations:function(){var e=this;e.organization&&e.organization.destroy(),e.organzationTreeDocument=new i;var t=e.platformTreeDocument.getOrganizationsByCSpace(e.collaboration.control.elementsTree.getSelected());t&&(e.organization=new a({}).inject(l),new UWA.Promise(function(t){e.organization.build({key:"organization",label:UWA.i18n("iptransfer.dialog.field.organizations.label"),value:!0,type:"DS/WUXAutoComplete/AutoComplete",options:{placeholder:"Loading Organization",multiSearchMode:!1,allowFreeInputFlag:!1,columnOptions:{autoRowHeightFlag:!0,typeRepresentation:"detailedInfo"},elementsTree:e.organzationTreeDocument},change:e.organizationChange.bind(null,e)},t)}).then(()=>{c.empty(),e.organization.control.placeholder=UWA.i18n("iptransfer.dialog.field.placeholder.chooseorganization"),e.organization.control.elementsTree.populate({organizations:t})}))},organizationChange:function(e,t){t.stopPropagation(),t.dsModel.value?(e.model.set("destination-selected",{id:e.platformTreeDocument.getSelectedPlatformId(),tenant:e.platformTreeDocument.getSelectedPlatformId(),securityContext:e.organzationTreeDocument.getSelectedOrg().securityContext}),e.options.exchangemodel.set("uexp-validFlag-transferdestination",!0)):(e.model.unset("destination-selected"),e.options.exchangemodel.set("uexp-validFlag-transferdestination",!1)),e.setDimensionChanged()},transformAndFire:function(e){e.value=e.model.get("destination-selected"),e.fire("change")}})}),define("DS/UnifiedExportCommand/Views/Options/DerivedFormatOptions",["UWA/Class/Model","UWA/Class/View","DS/Controls/Expander","DS/UnifiedExportCommand/Views/ParameterView"],(e,t,n,o)=>(o=o.extend({destroy:function(){this.control.fire("change"),this.getContent().remove()}}),t.extend({className:"engineering-formats-options",setup:function(){var t=this;t._private={attrViewList:[]},t.model=new e({}),["STEP"].includes(t.options.target)?(t._private.content=UWA.createElement("div"),new n({header:UWA.String.format(UWA.i18n("exchangecommand.options.field.includeformatoptions"),t.options.target),expandedFlag:!0,body:t._private.content}).inject(t.container),t._private.includeFormatAttributes=new o({}).inject(t._private.content),t._private.includeFormatAttributes.build({key:"formatAttributes",label:UWA.i18n("exchangecommand.options.placeholder.chooseoptions"),type:"DS/WUXAutoComplete/AutoComplete",options:{allowFreeInputFlag:!1,placeholder:UWA.i18n("exchangecommand.options.placeholder.chooseoptions"),elementsTree:t.elementsTreeCallback.bind(null,t),customFilterMessage:UWA.i18n("exchangecommand.options.field.chooseoptions.customFilterMessage")},change:t.onAddOrRemoveFormatAttributes.bind(null,t)})):t.hide()},elementsTreeCallback:function(e){return new UWA.Promise(function(t,n){e.options.formatStore.getFormatParameters({source:e.options.source,sourceType:e.options.sourceType,connector:e.options.connector,target:e.options.target}).then(function(n){e._private.attributes=n,t(n.map(t=>({label:e.options.formatStore.getFormatParameterNLS(e.options.source,t.name),value:t.name,icon:"parameters"})))})})},onAddOrRemoveFormatAttributes:function(e,t){t.stopPropagation();for(var n=t.dsModel.value||[],i=e._private.attrViewList.length-1;i>=0;i--){var a=e._private.attrViewList[i];n.includes(a.key)||(e._private.attrViewList.splice(i,1),a.destroy(),a=void 0)}n.forEach(function(t){if(!e._private.attrViewList.find(e=>e.key===t)){var n=(new o).inject(e._private.content),i=e.toAttributeUIOpts(t);n.build(i),e._private.attrViewList.push(n)}})},toAttributeUIOpts:function(e){var t,n=this,o=n._private.attributes.find(t=>t.name===e),i="DS/Controls/ComboBox",a={};if(o.values){var r=o.values.split("|");2===r.length&&r.includes("true")&&r.includes("false")?(i="DS/Controls/Toggle",a={...a,...{type:"switch",value:!0,checkFlag:!0}},t=!0):(a.elementsList=r.map(e=>({label:n.options.formatStore.getFormatParameterNLS(n.options.source,e),value:e})),t=a.elementsList[0].value)}return{key:o.name,label:n.options.formatStore.getFormatParameterNLS(n.options.source,o.name),type:i,value:t,options:a,change:n.onAttributeChange.bind(null,n)}},onAttributeChange:function(e,t){t.stopPropagation();var n=[];e._private.attrViewList.forEach(e=>{var t=e.key,o=e.control&&e.control.value;e.control&&void 0!==e.control.checkFlag&&(o=e.control.checkFlag),UWA.is(t)&&UWA.is(o)&&n.push({name:t,values:[o]})}),e.model.unset("geometricalParameters"),n.length&&e.model.set("geometricalParameters",n)},destroy:function(){this.options.formatStore.cancel(),this._private.attrViewList.forEach(e=>{e.destroy()}),this.model.clear(),this.getContent().remove(),this._parent()}}))),define("DS/UnifiedExportCommand/Views/Options/EngineeringFormats",["UWA/Class/Model","DS/Controls/Abstract","DS/UnifiedExportCommand/Models/EngineeringFormatsModel","DS/UnifiedExportCommand/Views/ParameterView","DS/UnifiedExportCommand/Views/Options/DerivedFormatOptions","DS/UnifiedExportCommand/Utils/ExchangeInfra"],(e,t,n,o,i,a)=>{"use strict";const r=["",UWA.i18n("exchangecommand.options.placeholder.chooseall"),UWA.i18n("exchangecommand.options.placeholder.choosenative"),UWA.i18n("exchangecommand.options.placeholder.choosederived")];return t.inherit({name:"engineering-formats",init:function(e){UWA.is(e.nativeFormatsFlag)||(e.nativeFormatsFlag=!0),this.setOptions(e),this._parent()},buildView:function(){var t=this;t.options.exchangemodel=t.options.exchangemodel||new e,t._private={formatType:a.EngineeringFormatType.NONE,derivedFormatOptionViewList:[]},t.model=new n({engineeringType:t.options.engineeringType}),t.model.addEvent("onChange",t.transformAndFire.bind(null,t)),t.options.nativeFormatsFlag&&t.setupAllNativeFormatsToggle(),t.setupAllDerivedFormatsToggle(),t.setupIncludeSpecificFormats(),t.setupIncludeLatestFormats(),t.options.exchangemodel.addEvent("onChange:objects",function(){t._private.includeSpecificFormats&&t._private.includeSpecificFormats.control&&(t._private.includeSpecificFormats.control.value=void 0,t.toggleIncludeAllNativeFormats(),t.toggleIncludeAllDerivedFormats(),t.toggleIncludeSpecificFormats())})},setupAllNativeFormatsToggle:function(){var e=this;e._private.includeAllNativeFormats=new o({}).inject(e.elements.container),e._private.includeAllNativeFormats.build({key:"includeAllNativeFormats",label:UWA.i18n("exchangecommand.options.field.engineeringformat.includeallnative"),help:UWA.i18n("exchangecommand.options.field.engineeringformat.includeallnative.help"),value:!0,type:"DS/Controls/Toggle",options:{type:"switch",value:!0,checkFlag:!0},change:function(t){t.stopPropagation(),e.model.set("includeAllNativeFormats",t.dsModel.checkFlag),e.toggleIncludeSpecificFormats()}})},setupAllDerivedFormatsToggle:function(){var e=this;e._private.includeAllDerivedFormats=new o({}).inject(e.elements.container),e._private.includeAllDerivedFormats.build({key:"includeAllDerivedFormats",label:UWA.i18n("exchangecommand.options.field.engineeringformat.includeallderived"),help:UWA.i18n("exchangecommand.options.field.engineeringformat.includeallderived.help"),value:!0,type:"DS/Controls/Toggle",options:{type:"switch",value:!0,checkFlag:!0},change:function(t){t.stopPropagation(),e.model.set("includeAllDerivedFormats",t.dsModel.checkFlag),e.toggleIncludeSpecificFormats()}})},setupIncludeSpecificFormats:function(){var e=this;e._private.includeSpecificFormats=new o({}).inject(e.elements.container),e._private.includeSpecificFormats.hide(),e._private.includeSpecificFormats.build({key:"includeSpecificFormats",label:UWA.i18n("exchangecommand.options.field.engineeringformat.includespecific"),help:UWA.i18n("exchangecommand.options.field.engineeringformat.includespecific.help"),type:"DS/WUXAutoComplete/AutoComplete",options:{allowFreeInputFlag:!1,customFilterMessage:UWA.i18n("exchangecommand.options.field.chooseoptions.customFilterMessage")},change:function(t){t.stopPropagation();var n=[],o=[],i=t.dsModel.value,a=e._private.includeSpecificFormats.control.selectedItems;i&&i.forEach(e=>{e&&(a.find(t=>t.options.value===e&&t.options.icons.includes("3d-object-unknown-format"))?n.push(e):o.push(e))}),n.length?e.model.set("specificNativeFormats",n):e.model.unset("specificNativeFormats"),o.length?e.model.set("specificDerivedFormats",o):e.model.unset("specificDerivedFormats"),e.setupSpecificFormatOptions(),e.toggleIncludeLatestFormats()}})},getDerivedFormatOptionsViewByTarget:function(e){return this._private.derivedFormatOptionViewList.find(t=>t.options.target===e.target)},setupSpecificFormatOptions:function(){for(var e=this,t=e.model.get("specificDerivedFormats")||[],n=e._private.derivedFormatOptionViewList.length-1;n>=0;n--){var o=e._private.derivedFormatOptionViewList[n];t.includes(o.options.target)||(o.destroy(),o=void 0,e._private.derivedFormatOptionViewList.splice(n,1))}t.forEach(t=>{if(!e.getDerivedFormatOptionsViewByTarget({target:t})){var n=new i({formatStore:e.model,source:"3DEXPERIENCE",sourceType:e.options.engineeringType,connector:"CATIAV5",target:t}).inject(e.elements.container);n.listenTo(n.model,"onChange",function(){const t=e._private.derivedFormatOptionViewList.reduce((e,t)=>{var n=t.model._attributes;return Object.keys(n).length&&e.push(n),e},[]);e.model.unset("specificDerivedOutputWithParams"),t.length&&e.model.set("specificDerivedOutputWithParams",t)}),e._private.derivedFormatOptionViewList.push(n),n.model.set("format",t)}})},hasReferenceObjects:function(e){var t=this.options.exchangemodel.get("objects")||[],n=this.options.engineeringType;return t.findIndex((e,t)=>!("part"!==n||!e.flattenedtaxonomies||!e.flattenedtaxonomies.includes("types/3DShape"))||(!("drawing"!==n||!e.flattenedtaxonomies||!e.flattenedtaxonomies.includes("types/Drawing"))||void 0))>-1},toggleIncludeAllNativeFormats:function(){var e=this,t=e.options.exchangemodel.get("objects")||[];e.model.getCADMasters(t).length>0?e.enableField(e._private.includeAllNativeFormats):e.disableField(e._private.includeAllNativeFormats)},toggleIncludeAllDerivedFormats:function(){var e=this;e.hasReferenceObjects()?e.enableField(e._private.includeAllDerivedFormats):e.disableField(e._private.includeAllDerivedFormats)},setupIncludeLatestFormats:function(){var e=this;e._private.includeLatestFormats=new o({}).inject(e.elements.container),e._private.includeLatestFormats.build({key:"includeLatestFormats",label:UWA.i18n("exchangecommand.options.field.engineeringformat.includelatestformats"),help:UWA.i18n("exchangecommand.options.field.engineeringformat.includelatestformats.help"),value:!1,type:"DS/Controls/Toggle",options:{type:"switch",value:!1,checkFlag:!1},change:function(t){t.stopPropagation(),e.model.set("includeLatestFormats",t.dsModel.checkFlag)}})},toggleIncludeLatestFormats:function(){var e=this;e.isLatestFormatsRequired()?(e._private.includeLatestFormats.show(),e.model.set(e._private.includeLatestFormats.model.options.fieldCfg.key,e._private.includeLatestFormats.control.checkFlag)):(e._private.includeLatestFormats.hide(),e.model.unset(e._private.includeLatestFormats.model.options.fieldCfg.key))},isLatestFormatsRequired:function(){var e=this;return e._private.includeLatestFormats&&(!0===e.model.get("includeAllDerivedFormats")||!e._private.includeSpecificFormats.getContent().isHidden()&&e.model.get("specificDerivedFormats")&&e.model.get("specificDerivedFormats").length>0)},toggleIncludeSpecificFormats:function(){var e=this;if(e._private.includeSpecificFormats.control){var t=void 0,n=void 0;"boolean"===UWA.typeOf(e.model.get("includeAllNativeFormats"))&&(t=e.model.get("includeAllNativeFormats"));var o=e.model.get("includeAllDerivedFormats");!1===t&&!1===o?(n=a.EngineeringFormatType.ALL,e._private.includeSpecificFormats.show(),e.getFormats(n)):!1===t?(n=a.EngineeringFormatType.NATIVE,e._private.includeSpecificFormats.show(),e.getFormats(n)):!1===o?(n=a.EngineeringFormatType.DERIVED,e._private.includeSpecificFormats.show(),e.getFormats(n)):(n=a.EngineeringFormatType.NONE,e._private.includeSpecificFormats.control.value=void 0,e._private.includeSpecificFormats.hide()),e.toggleIncludeLatestFormats(),e._private.includeSpecificFormats.control.placeholder=r[n]}},getFormats:function(e){var t=this,n=t.options.exchangemodel.get("objects");n&&n.length&&(t.refineSpecificselectedFormats(e),t._private.includeSpecificFormats.control.elementsTree=function(){return t.model.cancel(),new UWA.Promise((o,i)=>{t.model.getFormats({formatType:e,objects:n}).then(e=>{e=e.flat(),o(e)})})})},refineSpecificselectedFormats:function(e){var t=this._private.includeSpecificFormats.control.value,n=this._private.includeSpecificFormats.control.selectedItems;t&&t.length&&(e===a.EngineeringFormatType.NATIVE?t=t.filter(e=>n.find(t=>t.options.value===e&&t.options.icons.includes("3d-object-unknown-format"))):e===a.EngineeringFormatType.DERIVED&&(t=t.filter(e=>n.find(t=>t.options.value===e&&t.options.icons.includes("derived-output"))||void 0)),this._private.includeSpecificFormats.control.value=t)},transformAndFire:function(e){e.value=e.model.transform(),e.fire("change")},enableField:function(e){e.getContent().style.opacity=1,e.control.disabled=!1,this.model.unset(e.model.options.fieldCfg.key),this.model.set(e.model.options.fieldCfg.key,e.control.checkFlag)},disableField:function(e){e.control.checkFlag=!0,e.getContent().style.opacity=.7,e.control.disabled=!0,this.model.unset(e.model.options.fieldCfg.key)}})}),define("DS/UnifiedExportCommand/Views/ParametersView",["UWA/Class/Model","UWA/Class/View","DS/UnifiedExportCommand/Views/ParameterView"],function(e,t,n){"use strict";let o=t.extend({tagName:"div",className:"exportcommand-parametersview",insert:function(e,t){let o=this,i=new n;return i.inject(o.container),o.listenTo(i.model,"onChange",function(e){var t=e.keys();t.forEach(e=>{o.model.unset(e)}),0!==t.length&&o.model.set(e._attributes)}),i.build(e,t),i}});return{getInstance:function(){return new o({model:new e})}}}),define("DS/UnifiedExportCommand/Utils/CVExpandUtil",["DS/WAFData/WAFData","DS/UnifiedExportCommand/Utils/ExchangeInfra"],function(e,t){"use strict";var n={fetch:function(){return new UWA.Promise(function(e,o){let i=t.fetchQuery();i.physicalid&&i.physicalid.length?t.server({url:`${t.platformServices["3DSpace"]}${t.URLS.CVSERVLET_FETCH}?tenant=${t.getX3DPlatformId()}`,method:t.SERVER.VERB.POST,data:JSON.stringify(i),headers:{SecurityContext:t.securityContext},onComplete:n.postFetchSuccess.bind(null,e,o),onFailure:n.postFetchFailure.bind(null,o)}):o(UWA.i18n("exchangecommand.cvfetch.failure.emptypayload"))})},postFetchSuccess:function(e,t,n){(n=JSON.parse(n))&&n.results?e(n):t(UWA.i18n("exchangecommand.options.field.cvfetch.noresult"))},postFetchFailure:function(e){e(UWA.i18n("exchangecommand.options.field.cvfetch.failure"))},expand:function(e){return t.CVQUERY.EXPAND.level=e.expandLevel,new UWA.Promise(function(o,i){let a=t.expandQuery();a?t.server({url:`${t.platformServices["3DSpace"]}${t.URLS.CVSERVLET_PROGESSIVEEXPAND}?tenant=${t.getX3DPlatformId()}`,method:t.SERVER.VERB.POST,data:JSON.stringify(a),headers:{SecurityContext:t.securityContext},onComplete:n.postExpandSuccess.bind(null,e,o,i),onFailure:n.postExpandFailure.bind(null,i)}):i(UWA.i18n("exchangecommand.options.field.cvexpand.error"))})},postExpandSuccess:function(e,t,o,i){var a=(i=JSON.parse(i)).errors,r=i.results;if(a)o(UWA.i18n("exchangecommand.notification.exportfailed.message2"));else if(r){var s=e.allowedExpansionTypes;r.length?s&&s.length?n.alterExpansion(r,s).then(t).fail(o):t(r):o(UWA.i18n("exchangecommand.notification.exportfailed.noresults"))}},postExpandFailure:function(e){e(UWA.i18n("exchangecommand.notification.expansionfailed"))},alterExpansion:function(e,t){return new UWA.Promise(function(n,o){let i=[],a=[],r=[],s=[],l=[],c=[],d=[],u=[];e.forEach(e=>{e.from?s.push(e):e.Path?d.push(e):t.some(t=>e.flattenedtaxonomies.includes(t))&&(r.push(e.resourceid),a.push(e))}),a&&a.length&&(i.push(a),c=s.filter(e=>{if(r.includes(e.from)&&r.includes(e.to))return l.push(e.resourceid),!0}),i.push(c),d.forEach(e=>{var t=e.Path.filter((e,t)=>t%2==0?r.includes(e):l.includes(e));t&&t.length&&u.push({Path:t})}),i.push(u));let p=[].concat(...i);0==p.length?o(UWA.i18n("exchangecommand.notification.exportfailed.noresults3")):n(p)})}};return n}),define("DS/UnifiedExportCommand/Views/ParametersViewFactory",["UWA/Class","DS/UnifiedExportCommand/Views/ParameterView","DS/UnifiedExportCommand/Views/ParametersView"],function(e,t,n){"use strict";return e.singleton({build:function(e){let t=this,o=n.getInstance();return e.forEach(e=>{e.successors?t.buildSuccessors(o,e):e.children?t.buildGroup(o,e):o.insert(e)}),o},buildSuccessors:function(e,n){let o,i=this,a=new t;a.inject(e.container),a.build(n);let r=[];a.listenTo(a.model,"onChange:"+n.key,function(t){if(e.model.set(t._attributes),n.successors){o&&o.container.empty();let s=n.successors.call(UWA.clone(t._attributes));s?((s=s.filter(e=>!e.children)).forEach(function(e){r.push(e.key)}),o=i.build(s),a.getContent().insertAdjacentElement("afterend",o.getContent()),o.listenTo(o.model,"onChange",function(t){r.forEach(function(t){e.model.unset(t)}),e.model.set(t._attributes)})):r.forEach(function(t){e.model.unset(t)})}})},buildGroup:function(e,n){let o=this;e.model.set(n.key,{}),new UWA.Promise(function(o){let i=new t;i.inject(e.container),i.build(n,o)}).then(function(t){n.children.forEach((i,a)=>{if(0==a&&(i.isSelected=!0),i.label&&(i.header=i.label),i.icon&&(i.icon={iconName:i.icon,fontIconFamily:WUXManagedFontIcons.Font3DS}),i.fields){let a=o.build(i.fields);i.content=a.getContent(),a.listenTo(a.model,"onChange",function(t){let o=t._attributes,a=UWA.clone(e.model.get(n.key));a[i.key]=o,e.model.unset(n.key),e.model.set(n.key,a)}),t.add?t.add(i):t.addItem?t.addItem(i):a.inject(e.container)}}),t.expandItem&&t.expandItem(0)})}})}),define("DS/UnifiedExportCommand/Models/Exchange",["UWA/Utils","UWA/Class/Model","DS/WAFData/WAFData","DS/Utilities/UUID","DS/UnifiedExportCommand/Utils/ExchangeInfra","DS/UnifiedExportCommand/Utils/CVExpandUtil","DS/UnifiedExchangeAnalytics/Tracker","text!DS/UnifiedExportCommand/assets/config/UnifiedExportCommand.json"],function(e,t,n,o,i,a,r,s){"use strict";try{let e=require.toUrl("");e=e.substr(0,e.lastIndexOf("?")),s=JSON.parse(s);let l,c;return t.extend({defaults:{title:"Export - "+o.v4()},preprocess:null,transform:null,upload:null,setup:function(){let e=this,t=i.get();e.addEvent("onChange:uexp-expandLevel",()=>{e.expand()});for(const n in t)e[n]=t[n]},authorize:function(){let e=this;return new UWA.Promise(function(t,n){e.fetch().then(function(o){o&&(e.exporters=[],e.grantedRoles=e.grantedRoles,s.forEach(t=>{e.validateExporterByRole(t)&&e.validateExporterByLimitedAvailability(t)&&e.validateExporterBySelection(t)&&e.exporters.push(t)}),e.exporters.length>0?t():n(UWA.i18n("exchangecommand.notification.notallowed")))}).fail(n)})},validateExporterByRole:function(e){return e&&e.value&&this.grantedRoles.some(function(t){return e.roles.indexOf(t.id)>-1})&&e.value&&e.service&&e.service.id&&e.service.url},validateExporterByLimitedAvailability:function(e){var t=e.validate&&e.validate["limited-availability"];return!t||!!new URL(i.getWidget()&&i.getWidget().widgetDomain||window.location.href).searchParams.has(t)},validateExporterBySelection:function(e){var t=(e=e).validate&&e.validate["allowed-selection-types"];return!t||!t.length||this.getCVFNodesByExporter(e).length>0},getCVFNodesByExporter:function(e){var t=(e=e).validate&&e.validate["allowed-selection-types"];return this.cvf.filter(e=>{return!t||(!!e.attributes.find(e=>{if("flattenedtaxonomies"===e.name&&t.includes(e.value))return!0})||void 0)})},setCVFNodesByExporter:function(e){i.setCVFNodes(this.getCVFNodesByExporter(e))},fetch:function(){var e=this;return new UWA.Promise((t,n)=>{a.fetch().then(function(n){e.cvf=n.results,t(n)}).fail(n)})},expand:function(){var e=this;return new UWA.Promise((t,n)=>{e.set("uexp-expand-starts",!0),a.expand({expandLevel:e.get("uexp-expandLevel"),allowedExpansionTypes:e.exporter.validate&&e.exporter.validate["allowed-expansion-types"]}).then(function(n){e.set("objects",n),e.set("uexp-expand-resolved",!0),t()}).fail(function(e){i._private_.modelEvents.publish({event:i.EVENTS.ERROR_OCCURED,data:{message:e}})}).finally(function(){e.unset("uexp-expand-starts",{silent:!0}),e.unset("uexp-expand-resolved",{silent:!0})})})},save:function(){let e=this,t=i.getSelectedNodes(),n=e.get("objects");e.set("uexp-preprocess",!0);let o=e.preprocess?e.preprocess.bind(null,{selectedNodes:t,expandedNodes:n,securityContext:e.securityContext,platformServices:e.platformServices}):e=>e();return new UWA.Promise(o).then(e.refinement.bind(null,e,n)).then(e.uploads.bind(null,e)).then(e.export.bind(null,e))},refinement:function(e,t){return new UWA.Promise((e,n)=>{e(t=t.map(e=>(e.resourceid&&(e.flattenedtaxonomies&&delete e.flattenedtaxonomies,e["ds6w:cadMaster"]&&delete e["ds6w:cadMaster"],e.from&&delete e.from,e.to&&delete e.to),e)))})},getSelectedPlatformServices:function(){var e=this;if(e.has("uexp-selected-platform")){return i.platformServicesForAllPlatforms.find(t=>t.platformId==e.get("uexp-selected-platform"))}return i.platformServices},uploads:function(e,t){e.get("uexp-exportMethod");let n;var o=e.getSelectedPlatformServices()[e.exporter.service.id];let a=new Blob([t],{type:"application/json"});return r.setContentSize(a.size),a.size>175e3&&e.upload?(e.set("uexp-checkin-starts",!0),"string"==UWA.typeOf(e.get("uexp-checkinticketurl"))?n=e.checkinticket(o+e.get("uexp-checkinticketurl")+"?maxNumberOfFiles=1"):"function"==UWA.typeOf(e.get("uexp-checkinticketurl"))&&(n=e.upload.checkinticket({platformServices:i.platformServices,securityContext:i.securityContext})),new UWA.Promise(function(o,i){n.then(e.postcheckinticket.bind(null,e)).then(e.checkin.bind(null,e,t)).then(function(t){e.set("receipts",t[0].trim()),e.set("fileIds",t[1]),e.unset("objects",{silent:!0}),o()}).fail(i)})):new UWA.Promise(function(e,t){e()})},checkinticket:function(e){return new UWA.Promise(function(t,o){n.authenticatedRequest(e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":window.widget?window.widget.lang:"en","X-Requested-With":"XMLHttpRequest"},onComplete:t,onFailure:o})})},postcheckinticket:function(e,t){return t&&JSON.parse(t)||{}},checkin:function(e,t,o){return new UWA.Promise(function(i,a){var r=o.uploadCorrelation[0].fileId,s=o.url;let l=JSON.stringify({results:t}),c=new Blob([l],{type:"application/json"});var d=new FormData;d.set("__fcs__jobTicket",o.ticket),d.set("__fcs__corelation_0",r),d.set("file_0",c),n.authenticatedRequest(s,{method:"POST",data:d,timeout:18e5,cache:3600,onComplete:function(e){i([e,r])},onFailure:a,onUploadProgress:function(t){e.set("uexp-checkin-progress",Math.ceil(100*t.loaded/t.total))}})})},export:function(e){return l=(new Date).getTime(),e.set("uexp-export-requested",!0),new Promise(function(t,o){let i=e.getSelectedPlatformServices()[e.exporter.service.id]+e.exporter.service.url,a=e.exportPayload(),r={Accept:"application/json","Content-Type":"application/json","Accept-Language":window.widget?window.widget.lang:"en","X-Requested-With":"XMLHttpRequest",SecurityContext:e.securityContext},s={data:JSON.stringify(a),method:"POST",headers:r,onComplete:e.success.bind(null,e,t),onFailure:e.failure.bind(null,e,o)};n.authenticatedRequest(i,s)})},exportPayload:function(){let e=this;if(e.transform)try{return e.transform.call(UWA.clone(e.omit(e.keys().filter(e=>e.includes("uexp-")))),{platformServices:e.platformServices,securityContext:e.securityContext})}catch(e){console.log(e)}return e._attributes},requireModulePath:function(e){let t=this;try{if(t.platformServices[e.service.id]){let o=[t.platformServices[e.service.id],e.service["export-ui"]["module-deployment-directory"]?e.service["export-ui"]["module-deployment-directory"]:"/webapps"].join("");var n={};n[["DS",e.service["export-ui"]["module-directory"]].join("")]=o+e.service["export-ui"]["module-directory"],require.config({paths:n})}}catch(e){console.log(e)}},resetBaseUrl:function(){},success:function(e,t,n){e.calculateExportTime(e),e.track(),t&&t(UWA.i18n("exchangecommand.notification.exportstarted.message"))},failure:function(e,t,n){e.calculateExportTime(e),e.track(),t&&t(UWA.i18n("exchangecommand.notification.exportfailed.message"))},calculateExportTime:function(e){let t=((c=(new Date).getTime())-l)/1e3;r.setTime(t)},track:function(){r.setOperation(r.EVENT.CATEGORY.VALUES.EXPORT),r.setTenant(i.getX3DPlatformId()),r.setAppId(i.getAppId()),r.sendEvent()}})}catch(e){console.log()}}),define("DS/UnifiedExportCommand/Views/ExchangeOptions",["UWA/Class/View","DS/UIKIT/Spinner","DS/Utilities/UUID","DS/UnifiedExportCommand/Views/ParametersViewFactory","DS/UnifiedExportCommand/Utils/ExchangeInfra","DS/UnifiedExchangeAnalytics/Tracker"],function(e,t,n,o,i,a){"use strict";let r,s;const l=/^$/,c=/^(?!\s*$).+/;return e.extend({tagName:"div",id:"exportcommand-optionsview",className:"exportcommand-optionsview",setup:function(e){try{let e=this;e.setupMethods(),e.setupLoader()}catch(e){console.log(e)}},setupLoader:function(){this.loader=UWA.createElement("p",{}).inject(this.container),this.loader.style.textAlign="center",new t({zIndex:2e3}).inject(this.loader).show()},setupMethods:function(){let e=this;if(e.model.exporters&&e.model.exporters.length){let n=null,a=[],s=!1;var t=i.getWidget()&&i.getWidget().getValue("exportMethod");e.model.exporters.forEach((e,o)=>{0==o&&(n=e),t===e.value&&(s=!0),a.push({value:e.value,label:UWA.i18n(e.label)})}),(r=o.build([{id:"exportMethod",label:UWA.i18n("exchangecommand.options.field.exportOutput"),help:UWA.i18n("exchangecommand.options.field.exportOutput.help"),type:"DS/Controls/ComboBox",value:s?t:n.value,options:{elementsList:a},change:e.changeOutput.bind(null,e)}])).inject(e.container)}},clear:function(){a.clear(),this.model.clear(),s&&s.container.empty(),this.loader.hide()},changeOutput:function(e,t){e.exportmethodcombobox=t.target;let n=e.exportmethodcombobox.dsModel.value;if(n){e.clear(),e.exportmethodcombobox.dsModel.disabled=!0,i.getWidget()&&i.getWidget().setValue("exportMethod",n),e.model.set("uexp-exportMethod",n);var o=e.model.exporters.find(e=>e.value==n);o&&(e.model.exporter=o,a.setFormat(n),a.setService(o.service.id),e.load(o))}},load:function(e){let t=this;t.loader.show(),t.model.setCVFNodesByExporter(e),t.model.requireModulePath(e),require([["DS",e.service["export-ui"]["module-name"],e.service["export-ui"]["module-directory"]].join("")],e=>{t.exportmethodcombobox.dsModel.disabled=!1,t.parse(e)},e=>{i._private_.modelEvents.publish({event:i.EVENT_LOAD_METHOD_FAILED})})},parse:function(e){let t=this,n=i.getSelectedNodes();t.config=e,e.preprocess?t.model.preprocess=e.preprocess:t.model.preprocess=void 0,e.transform&&(t.model.transform=e.transform),e.upload&&e.upload.checkinticketurl&&(t.model.upload=e.upload,t.model.set("uexp-checkinticketurl",e.upload.checkinticketurl));var o="function"==UWA.typeOf(e.fields)?e.fields.bind(null,{platformServices:i.platformServices,platformServicesForAllPlatforms:i.platformServicesForAllPlatforms,securityContext:i.securityContext,selectedNodes:n}):t=>t(e.fields);new UWA.Promise(o).then(function(e){t.parseExpoterFields(e)})},parseExpoterFields:function(e){let t=this;t.loader.hide();let n=UWA.clone(e);(n=t.refine(n)).unshift(t.getTitleConfig()),t.model.get("uexp-expansion-ready")||t.model.set("uexp-expandLevel",-1),(s=o.build(n)).inject(t.container),s.listenTo(s.model,"onChange",function(e){let n=e._attributes;t.model.set(n)})},refine:function(e){var t=this;let n=[];return e.forEach(e=>{e.children&&e.children.forEach(e=>{e.fields=t.refine(e.fields)}),"title"!==e.key.toLowerCase()&&("formats"===e.key.toLowerCase()?e=t.getFormatsConfig(e):"expandlevel"===e.key.toLowerCase()?e=t.getExpandLevelConfig():"transferdestination"===e.key.toLowerCase()&&(e=t.getTransferConfig()),n.push(e))}),n},getTitleConfig:function(){var e=this;return{key:"title",label:UWA.i18n("exchangecommand.options.field.title"),type:"DS/Controls/LineEditor",value:"Export - "+n.v4().substring(0,10).replaceAll("-",""),options:{pattern:"[^&'<>\"]+",placeholder:UWA.i18n("exchangecommand.options.field.title.placeholder")},validFlagChange:function(t){e.model.set("uexp-validFlag-title",t.dsModel.validFlag)},uncommittedChange:function(t){l.test(t.dsModel.valueToCommit)||!c.test(t.dsModel.valueToCommit)?e.model.set("uexp-validFlag-title-empty",!1):(t.dsModel.valueToCommit=t.dsModel.valueToCommit&&t.dsModel.valueToCommit.trimStart(),e.model.set("uexp-validFlag-title-empty",!0))}}},getExpandLevelConfig:function(){return this.model.set("uexp-expansion-ready",!0),{key:"expandLevel",type:"DS/UnifiedExportCommand/Views/Options/ExpandLevel",label:UWA.i18n("exchangecommand.options.field.expandLevel"),help:UWA.i18n("exchangecommand.options.field.expandLevel.help"),value:-1,options:{exchangemodel:this.model}}},getFormatsConfig:function(e){return e.options||(e[options]={}),e.options.exchangemodel=this.model,e.options.engineeringType||(e.options.engineeringType="part"),{key:"part"===e.options.engineeringType?"engineering-part-formats":"engineering-drawing-formats",type:"DS/UnifiedExportCommand/Views/Options/EngineeringFormats",options:e.options}},getTransferConfig:function(){return{key:"transferdestination",type:"DS/UnifiedExportCommand/Views/Options/Transfer/Destinations",options:{exchangemodel:this.model}}}})}),define("DS/UnifiedExportCommand/Views/ExchangeProcessDialog",["UWA/Class/View","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/Controls/Label","DS/Controls/Button","DS/Controls/ProgressBar","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/UnifiedExportCommand/Models/Exchange","DS/UnifiedExportCommand/Utils/ExchangeInfra","DS/UnifiedExportCommand/Views/ExchangeOptions","i18n!DS/UnifiedExportCommand/assets/nls/UnifiedExportCommandNLS","css!DS/UIKIT/UIKIT.css","css!DS/UnifiedExportCommand/UnifiedExportCommand"],function(e,t,n,o,i,a,r,s,l,c,d,u){"use strict";try{let p,m,f,g,h,v,x,E,C,S,b;return UWA.i18n(u),e.extend({tagName:"div",id:"exportcommand-exchangeprocessdialog",className:"exportcommand-exchangeprocessdialog",setup:function(e){let t=this;t.model=e&&e.model||new l,t.setupDialog(),t.model.authorize().then(t.setupExporters.bind(null,t)).fail(t.reject.bind(null,t))},setupDialog:function(){var e=this;e.setupSubscriptions(),e.setupDialogContainer(),e.setupProgressView().inject(p),m&&m.close(),(g=new n).inject(e.container),(m=new t({title:UWA.i18n("exchangecommand.dialog.header"),content:p,immersiveFrame:g,modalFlag:!0,usePaddingFlag:!0,resizableFlag:!0})).resizableFlag=!1,m.closeButtonFlag=!1,m.addEventListener("close",e.afterClose.bind(null,e)),m.addEventListener("resize",e.onDialogResize.bind(null,e)),c.getWidget()&&c.getWidget().addEvent("onResize",e.setDialogWidth.bind(null,e)),e.container.inject(e.options.elParent||c.getWidget()&&widget.body),e.setDialogWidth(e)},setupDialogContainer:function(){p=UWA.createElement("div",{class:"exchangecommand-dialogcontainer"})},setupProgressView:function(){return x=UWA.createElement("div",{class:"exportcommand-exchangeprocessdialog-progressview",styles:{margin:2}}),(v=new o({value:"Analyzing selection..",maxDisplayLength:500,icon:{iconName:"multiselect",fontIconFamily:1}}).inject(x)).getContent().style.background="transparent",v.getContent().style.fontSize="13px",v.getContent().style.fontWeight="bold",h=new a({statusFlag:!1,infiniteFlag:!0,displayStyle:"lite"}).inject(x),x},setupExporters:function(e){x.hide(),f=new d({model:e.model}).inject(p),m.buttons=e.getFooter(),m.resizableFlag=!0,m.closeButtonFlag=!0,e.setDialogWidth(e)},expansionStarts:function(e){b.start(),b.element.show(),C.disabled=!0,e.model.set({"uexp-validFlag-expansion":!1})},expansionResolved:function(e){b.stop(),b.element.hide(),E.hide(),e.model.set({"uexp-validFlag-expansion":!0})},getFooter:function(){E=new i({displayStyle:"lite",label:UWA.i18n("exchangecommand.dialog.footer.button.ok"),visibleFlag:!1}),C=new i({label:UWA.i18n("exchangecommand.dialog.footer.button.save"),disabled:!0,onClick:this.save.bind(null,this)}),S=new i({label:UWA.i18n("exchangecommand.dialog.footer.button.cancel"),onClick:this.cancel.bind(null,this)});var e=E.getContent();return e.style.position="absolute",e.style.left="15px",e.style.cursor="default",(b=new UWA.Fx(e,{duration:1200,wait:!0,events:{onComplete:function(){b.tween("color","#005686","#B4B6BA")}}})).element.hide(),{Ok:E,Save:C,Cancel:S}},save:function(e,t){let n=e;C.label=UWA.i18n("exchangecommand.dialog.footer.button.saving"),C.disabled=!0,n.model.save().then(n.resolve.bind(null,n),n.reject.bind(null,n))},setupSubscriptions:function(){var e=this;e.listenTo(e.model,"onChange",e.fireDimensionsChanged),c.getWidget()&&widget.addEvent("onRefresh",function(){m.close()}),e.listenTo(e.model,"onChange:uexp-expand-starts",e.expansionStarts.bind(null,e)),e.listenTo(e.model,"onChange:uexp-preprocess",e.preprocessStarts.bind(null,e)),e.listenTo(e.model,"onChange:uexp-checkin-starts",e.checkinStarts.bind(null,e)),e.listenTo(e.model,"onChange:uexp-checkin-progress",e.checkinProgress.bind(null,e)),e.listenTo(e.model,"onChange:uexp-export-requested",e.exportRequested.bind(null,e)),e.listenTo(e.model,"onChange:uexp-expand-resolved",e.expansionResolved.bind(null,e)),e.listenTo(e.model,"onChange:uexp-validFlag-title",e.enableBtnSave.bind(null,e)),e.listenTo(e.model,"onChange:uexp-validFlag-title-empty",e.enableBtnSave.bind(null,e)),e.listenTo(e.model,"onChange:uexp-validFlag-expansion",e.enableBtnSave.bind(null,e)),e.listenTo(e.model,"onChange:uexp-validFlag-transferdestination",e.enableBtnSave.bind(null,e)),c._private_.modelEvents.subscribeOnce({event:c.EVENTS.ERROR_OCCURED},function(t){e.reject(e,t),c._private_.modelEvents.unsubscribe("ExchangeInfra.EVENTS.ERROR_OCCURED")})},enableBtnSave:function(e){C.disabled=!(!1!==e.model.get("uexp-validFlag-title")&&e.model.get("uexp-validFlag-expansion")&&!1!==e.model.get("uexp-validFlag-title-empty")&&(!e.model.has("uexp-validFlag-transferdestination")||!1!==e.model.get("uexp-validFlag-transferdestination")))},preprocessStarts:function(e){v.value=UWA.i18n("exchangecommand.dialog.progressMessage.validated"),v.icon={iconName:"check",fontIconFamily:1},m.resizableFlag=!1,m.closeButtonFlag=!1,m.buttons=null,f.hide(),x.show()},checkinStarts:function(e){h.infiniteFlag=!1,v.value=UWA.i18n("exchangecommand.dialog.progressMessage.packaged"),v.icon={iconName:"upload",fontIconFamily:1}},checkinProgress:function(e,t){h.value=e.model.get("uexp-checkin-progress")},exportRequested:function(e){v.value=UWA.i18n("exchangecommand.dialog.progressMessage.progress"),v.icon={iconName:"hourglass ",fontIconFamily:1}},resolve:function(e,t){m&&m.close(),t&&e.exportStarted(t)},reject:function(e,t){m&&m.close(),t&&e.exportNotAllowed(t)},cancel:function(e){m.close()},afterClose:function(e){g.destroy(),m.destroy(),e.model.dispatchEvent("closeexchange")},exportStarted:function(e){s.setNotificationManager(r),s.setFadeOutPolicy(2),s.setStackingPolicy(5);let t={message:e,level:"success"};r.addNotif(t)},exportNotAllowed:function(e){s.setNotificationManager(r),s.setFadeOutPolicy(2),s.setStackingPolicy(5);let t={level:"error"};"string"==typeof e?t.message=e:"object"==typeof e&&(t={...t,...e}),r.addNotif(t)},fireDimensionsChanged:function(){m.fire("dimensionsChanged")},onDialogResize:function(e,t){p&&(t.currentTarget.clientWidth>=480?(e.container.querySelectorAll(".exportcommand-parametersview-col-label").forEach(e=>{e.classList.remove("resize-shrinked"),e.classList.add("resize-expanded")}),e.container.querySelectorAll(".exportcommand-parametersview-col-value").forEach(e=>{e.classList.remove("resize-shrinked"),e.classList.add("resize-expanded")})):(e.container.querySelectorAll(".exportcommand-parametersview-col-label").forEach(e=>{e.classList.remove("resize-expanded"),e.classList.add("resize-shrinked")}),e.container.querySelectorAll(".exportcommand-parametersview-col-value").forEach(e=>{e.classList.remove("resize-expanded"),e.classList.add("resize-shrinked")})))},setDialogWidth:function(e){m&&(m.width=e.computeWidth())},computeWidth:function(e=0){0===e&&(e=c.getWidget()&&c.getWidget().body.clientWidth||this.options.elParent.clientWidth);return e>=510&&(e=510),e}})}catch(e){console.log(e)}}),define("DS/UnifiedExportCommand/Commands/UnifiedExportCommand",["DS/ApplicationFrame/Command","DS/PADUtils/PADContext","DS/UnifiedExportCommand/Views/ExchangeProcessDialog","DS/UnifiedExportCommand/Utils/ExchangeInfra","DS/UnifiedExportCommand/Utils/ProxyContext"],function(e,t,n,o,i){return e.extend({init:function(e){let n=this;(n._parent(e),!window.jasmine||window.tstEnvironment)&&(n.model=e&&e.model,o.setup({context:n.options.context||t.get()||new i(e)}).then(n.onInfraReady.bind(null,n)))},onInfraReady:function(e){e.disable();var t=o.getTreeDocument();t&&(t._modelEvents.subscribe({event:"select"},e.toggleExport.bind(null,e)),t._modelEvents.subscribe({event:"unselect"},e.toggleExport.bind(null,e)),t._modelEvents.subscribe({event:"removeChild"},e.toggleExport.bind(null,e)))},execute:function(){let e=this;e.disable();let t=new n({model:e.model});t.listenTo(t.model,"closeexchange",()=>{e.toggleExport(e)})},toggleExport:function(e){e.disable(),o.getSelectedNodes()&&o.getSelectedNodes().find(e=>e.getRoot())&&e.enable()}})}),define("DS/UnifiedExportCommand/Commands/UnifiedExportCommandExt",["DS/UnifiedExportCommand/Commands/UnifiedExportCommand","DS/UnifiedExportCommand/Views/ExchangeProcessDialog","DS/UnifiedExportCommand/Utils/ExchangeInfra"],function(e,t,n){return e.extend({onInfraReady:function(e){e.execute()},execute:function(){n.get()&&n.get();let e=new t({elParent:document.body});e.listenTo(e.model,"closeexchange",this.closeexchange.bind(null,this))},closeexchange:function(e){document.querySelectorAll("exportcommand-widget-container").forEach(e=>{e.empty(),e.destory()})}})});