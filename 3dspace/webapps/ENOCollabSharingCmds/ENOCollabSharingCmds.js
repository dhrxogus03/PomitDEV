define("DS/ENOCollabSharingCmds/commands/ENONew/NewDrawing",["DS/ENONewWidget/command/NewContentCommandBase","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WAFData/WAFData","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ModalLoader","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","i18n!DS/ENOCollabSharingCmds/assets/nls/NewDrawingNls"],function(e,t,n,i,o,a,r,s,l,c){"use strict";return e.extend({defaults:{newType:"drawing",prefType:"Drawing",objType:"Drawing"},CAD_ORIGIN_MIX:"V5&V6",CAD_ORIGIN_TYPE_V5:"V5",init(e){this._parent(e),this.labelTopBar=c.get("createNewDrawing"),this.commandName=c.get("newObjectType"),this.tenant=widget.getValue("x3dPlatformId")||"OnPremise",this.addEventsForCommad()},getType(){return this.defaults.newType},getCommandLabel(){return"ENOInsertNewDrawingHdr"===this.options.ID?c.get("insertNewDrawing"):c.get("createNewDrawing")},getOptions(e){return{labelTopBar:this.labelTopBar,commandName:this.commandName,options:{preferedType:e&&e.type?e.type:this.defaults.prefType},type:this.defaults.objType}},execute(e){var t,n=this;if(n.disable(),n.showModalLoader(),(t=e?this.getCreateOptions(e):this.getCreateOptions({newType:this.getType()}))&&t.options){let e=t.options.parentPIDs;e&&e.length>0?this.multiselectionChecksForParentObject(e,e=>{n.getCadOriginsTypes(t,function(e){t.options.parentOrigin=e.parentOrigin,n.launchCreateNew(t)},function(e){n.hideModalLoader(),n.isEnabled()||n.enable(),console.log(e)})},e=>{n.hideModalLoader(),n.isEnabled()||n.enable(),console.log(e)}):this.launchCreateNew(t)}else this.launchCreateNew(t)},multiselectionChecksForParentObject(e,t,n){var i=this;e.length<2?t():this.launchPopupDialog({title:c.get("multiParentInsertDrawingTitle"),overlay:!0,content:new UWA.Element("text",{text:c.get("multiParentInsertDrawingMsg")}),footerButtons:{Ok:new a({name:"okay",label:c.get("okBtn"),onClick:function(e){i.popupDialog.isOKButtonClicked=!0,i.popupDialog.close(),t()}}),Discard:new a({name:"close",label:c.get("closeBtn"),onClick:function(e){i.popupDialog.isOKButtonClicked=!1,i.popupDialog.close(),n("DialogClose")}})}},function(){i.popupDialog.isOKButtonClicked||n("DialogClose")})},getCadOriginsTypes:function(e,t,i){var o=this,a=[];e.options.parentPIDs.forEach(function(e){a.push({objectId:e})});var r={data:a};o.getPlatformInfo(function(){var a=o.platformInfo["3DSpace"]+"/resources/v1/modelerServices/authoring/op/getCADOriginsTypes",s={Accept:"application/json","Content-Type":"application/json","Accept-Language":widget.lang};e.context&&e.context.header&&(s.SecurityContext=e.context.header.SecurityContext),n.authenticatedRequest(a,{method:"POST",headers:s,timeout:864e5,data:JSON.stringify(r),type:"json",onComplete:function(e){if(e.hasOwnProperty("result")){var n=!1,a=!1;if(e.result.V_usages.forEach(function(e){"3DPart"===e?n=!0:"DraftingRepresentation"===e&&(a=!0)}),n)o.setNotification({eventID:"error",msg:c.get("multiParentCannotInsert")}),i(e);else if(a)o.setNotification({eventID:"error",title:c.get("CannotInsert.Type",{type:o.commandName})}),i(e);else{var r=e.result.cadOrigintypes,s="";r.length>0&&(s=r[0]);var l=[];r.forEach(function(e){s!=e&&(s=o.CAD_ORIGIN_MIX);var t=e;"V5"===e?t="CATIAV5":"SW"===e?t="SOLIDWORKS":"CR"===e?t="CREO":"IV"===e?t="INVENTOR":"AD"===e?t="AUTOCAD":"SE"===e&&(t="SOLIDEDGE"),l.push(t)}),s==o.CAD_ORIGIN_MIX&&(s=o.CAD_ORIGIN_TYPE_V5),t({parentOrigin:l})}}else i(e)},onFailure:function(e){i(e)},onTimeout:function(){i(object)}})},function(e){i(e)})},addEventsForCommad(){var e=this;require(["DS/ENONewWidget/ENONew/Events"],function(t){t.addEvent("onSelection",function(t){if(t){if(!0!==t.editMode)return void e.disable();var n=!1;if(t.selectedNodes&&t.selectedNodes.length>0){for(var i=0;i<t.selectedNodes.length;i++){var o=t.selectedNodes[i];if(o){var a=o.cadMaster;if(a&&(a.contains("CATIAV5")||a.contains("SOLIDWORKS")||a.contains("SOLIDEDGE")||a.contains("INVENTOR"))){n=!0;break}}}n?e.disable():e.enable()}else e.enable()}}),t.addEvent("onCreationDialogAction",function(t){t&&"ready"===t.action&&e.hideModalLoader()}),t.addEvent("onNewInfraExit",function(t){t.newType!==e.getType()||e.isEnabled()||e.enable()})})},getPlatformInfo(e,n){var i=this;this.platformInfo?e():t.getPlatformServices({onComplete:function(t){t&&t.length&&(i.platformInfo=t.filter(e=>e.platformId===i.tenant)[0],e())},onFailure:function(e){n(e)}})},launchPopupDialog(e,t){var n=this;let a="drawing";this.immersiveFrame||(this.immersiveFrame=new i({identifier:a}),this.immersiveFrame.inject(widget.body)),this.popupDialog=new o({identifier:a,title:e.title?e.title:"",modalFlag:e.overlay,content:e.content,position:{my:"center",at:"center",collision:"fit"},buttons:e.footerButtons,escapeButton:e.footerButtons.Discard}),this.popupDialog.addEventListener("close",function(){console.log("Popup closed: "+n.defaults.newType),t(arguments)})},setNotification(e){this.notifMgr||(this.notifMgr=s,l.setNotificationManager(this.notifMgr),l.setStackingPolicy(5)),this.notifMgr.addNotif({level:e.eventID,title:void 0!==e.title?e.title:void 0,subtitle:void 0!==e.subtitle?e.subtitle:void 0,message:void 0!==e.msg?e.msg:void 0,sticky:!1,allowUnsafeHTML:!1})},showModalLoader(){r.displayModalLoader(widget.body)},hideModalLoader(){r.removeModalLoader(widget.body)},destroy:function(){this.popupDialog&&this.popupDialog.destroy(),this.immersiveFrame&&this.immersiveFrame.destroy(),this._parent()}})}),define("DS/ENOCollabSharingCmds/Services/CommandServices",["DS/LifecycleServices/LifecycleServices"],function(e){"use strict";return{TYPE_ROOT_FOLDER_1:"Workspace",TYPE_ROOT_FOLDER_2:"RootFolder",TYPE_FOLDER_1:"Workspace Vault",TYPE_FOLDER_2:"Folder",TYPE_FOLDER_3:"Workspace Folder",TYPE_PERSONAL_FOLDER_1:"Personal Workspace",TYPE_MATERIALS:"dsc_mat",TYPE_MATERIAL_DOMAIN_REP:"dsc_matref_rep",TYPE_MATERIAL_DOMAIN_REP_1:"MaterialDomainDS",TYPE_MATERIAL_DOMAIN_REP_2:"ENOSTMatDomainDS",TYPE_MATERIAL_DOMAIN_REP_3:"MaterialDomain",TYPE_MATERIAL_REFERENCE:"dsc_matref_ref_",isRootFolder:function(e){return e===this.TYPE_ROOT_FOLDER_1||e===this.TYPE_ROOT_FOLDER_2},isFolder:function(e){return e===this.TYPE_FOLDER_1||e===this.TYPE_FOLDER_2||e===this.TYPE_FOLDER_3},isPersonalFolder:function(e){return e===this.TYPE_PERSONAL_FOLDER_1},isWorkspaceFolder:function(e){return e===this.TYPE_ROOT_FOLDER_1||e===this.TYPE_FOLDER_1},inFamilyFolder:function(e){return this.isRootFolder(e)||this.isFolder(e)||this.isPersonalFolder(e)},isMaterialDomain:function(e){if("string"==typeof e||e instanceof String){var t=!1;return-1!=e.search(new RegExp(this.TYPE_MATERIAL_DOMAIN_REP,"i"))?t=!0:-1!=e.search(new RegExp(this.TYPE_MATERIAL_DOMAIN_REP_1,"i"))?t=!0:-1!=e.search(new RegExp(this.TYPE_MATERIAL_DOMAIN_REP_2,"i"))?t=!0:-1!=e.search(new RegExp(this.TYPE_MATERIAL_DOMAIN_REP_3,"i"))?t=!0:(-1!=e.search(new RegExp(this.TYPE_MATERIALS,"i"))&&(t=!0,0==e.search(new RegExp(this.TYPE_MATERIAL_REFERENCE,"i"))&&(t=!1)),t)}return-1},allAggregated3DShape:function(t,n){for(var i=t.length,o=[],a=0;a<i;a++){var r=t[a],s=r.type,l=r.getID();if(o.push(l),"3DShape"!=s)return void n(!1)}var c=widget.getValue("x3dPlatformId");e.listAttributes(c,o,["attribute[PLMEntity.V_usage]"],function(e){for(var t=!0,i=e.results.length,o=0;o<i;o++){if("3DPart"!=e.results[o]["attribute[PLMEntity.V_usage]"]){t=!1;break}}n(t)},function(e){console.log(e),n(!1)})}}}),define("DS/ENOCollabSharingCmds/commands/Sample/ENONewMockDocumentCmd",["DS/ENONewWidget/command/NewContentCommandBase"],function(e){"use strict";return e.extend({defaults:{newType:"MockDocument"},getType(){return this.defaults.newType}})}),define("DS/ENOCollabSharingCmds/commands/ENONew/NewProduct",["DS/ENONewWidget/command/NewContentCommandBase","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WAFData/WAFData","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ModalLoader","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","i18n!DS/ENOCollabSharingCmds/assets/nls/NewProductNls"],function(e,t,n,i,o,a,r,s,l,c){return e.extend({defaults:{newType:"assembly",prefType:"VPMReference",objType:"VPMReference"},CAD_ORIGIN_MIX:"V5&V6",CAD_ORIGIN_TYPE_V5:"V5",init(e){this._parent(e),this.labelTopBar=c.get("createNewProduct"),this.commandName=c.get("newObjectType"),this.tenant=widget.getValue("x3dPlatformId")||"OnPremise",this.addEventsForCommad()},getType(){return this.defaults.newType},getCommandLabel(){return"ENOInsertNewProductHdr"===this.options.ID?c.get("insertNewProduct"):c.get("createNewProduct")},getOptions(e){return{labelTopBar:this.labelTopBar,commandName:this.commandName,options:{preferedType:e&&e.type?e.type:this.defaults.prefType},type:this.defaults.objType}},execute(e){var t,n=this;if(n.disable(),n.showModalLoader(),(t=e?this.getCreateOptions(e):this.getCreateOptions({newType:this.getType()}))&&t.options){let e=t.options.parentPIDs;e&&e.length>0?this.multiselectionChecksForParentObject(e,e=>{n.getCadOriginsTypes(t,function(e){t.options.parentOrigin=e.parentOrigin,n.launchCreateNew(t)},function(e){n.hideModalLoader(),n.isEnabled()||n.enable(),console.log(e)})},e=>{n.hideModalLoader(),n.isEnabled()||n.enable(),console.log(e)}):this.launchCreateNew(t)}else this.launchCreateNew(t)},multiselectionChecksForParentObject(e,t,n){var i=this;e.length<2?t():this.launchPopupDialog({title:c.get("multiParentInsertProductTitle"),overlay:!0,content:new UWA.Element("text",{text:c.get("multiParentInsertProductMsg")}),footerButtons:{Ok:new a({name:"okay",label:c.get("okBtn"),onClick:function(e){i.popupDialog.isOKButtonClicked=!0,i.popupDialog.close(),t()}}),Discard:new a({name:"close",label:c.get("closeBtn"),onClick:function(e){i.popupDialog.isOKButtonClicked=!1,i.popupDialog.close()}})}},function(){i.popupDialog.isOKButtonClicked||n("DialogClose")})},getCadOriginsTypes:function(e,t,i){var o=this,a=[];e.options.parentPIDs.forEach(function(e){a.push({objectId:e})});var r={data:a};o.getPlatformInfo(function(){var a=o.platformInfo["3DSpace"]+"/resources/v1/modelerServices/authoring/op/getCADOriginsTypes",s={Accept:"application/json","Content-Type":"application/json","Accept-Language":widget.lang};e.context&&e.context.header&&(s.SecurityContext=e.context.header.SecurityContext),n.authenticatedRequest(a,{method:"POST",headers:s,timeout:864e5,data:JSON.stringify(r),type:"json",onComplete:function(e){if(e.hasOwnProperty("result")){var n=!1,a=!1;if(e.result.V_usages.forEach(function(e){"3DPart"===e?n=!0:"DraftingRepresentation"===e&&(a=!0)}),n)o.setNotification({eventID:"error",msg:c.get("multiParentCannotInsert")}),i(e);else if(a)o.setNotification({eventID:"error",title:c.get("CannotInsert.Type",{type:o.commandName})}),i(e);else{var r=e.result.cadOrigintypes,s="";r.length>0&&(s=r[0]);var l=[];r.forEach(function(e){s!=e&&(s=o.CAD_ORIGIN_MIX);var t=e;"V5"===e?t="CATIAV5":"SW"===e?t="SOLIDWORKS":"CR"===e?t="CREO":"IV"===e?t="INVENTOR":"AD"===e?t="AUTOCAD":"SE"===e&&(t="SOLIDEDGE"),l.push(t)}),s==o.CAD_ORIGIN_MIX&&(s=o.CAD_ORIGIN_TYPE_V5),t({parentOrigin:l})}}else i(e)},onFailure:function(e){i(e)},onTimeout:function(){i(object)}})},function(e){i(e)})},addEventsForCommad(){var e=this;require(["DS/ENONewWidget/ENONew/Events"],function(t){t.addEvent("onSelection",function(t){if(t){if(!0!==t.editMode)return void e.disable();var n=!1;if(t.selectedNodes&&t.selectedNodes.length>0){for(var i=0;i<t.selectedNodes.length;i++){var o=t.selectedNodes[i];if(o.type&&o.type.contains("Drawing")){n=!0;break}}n?e.disable():e.enable()}else e.enable()}}),t.addEvent("onCreationDialogAction",function(t){t&&"ready"===t.action&&e.hideModalLoader()}),t.addEvent("onNewInfraExit",function(t){t.newType!==e.getType()||e.isEnabled()||e.enable()})})},getPlatformInfo(e,n){var i=this;this.platformInfo?e():t.getPlatformServices({onComplete:function(t){t&&t.length&&(i.platformInfo=t.filter(e=>e.platformId===i.tenant)[0],e())},onFailure:function(e){n(e)}})},launchPopupDialog(e,t){var n=this;let a="assembly";this.immersiveFrame||(this.immersiveFrame=new i({identifier:a}),this.immersiveFrame.inject(widget.body)),this.popupDialog=new o({identifier:a,title:e.title?e.title:"",modalFlag:e.overlay,content:e.content,position:{my:"center",at:"center",collision:"fit"},buttons:e.footerButtons,escapeButton:e.footerButtons.Discard}),this.popupDialog.addEventListener("close",function(){console.log("Popup closed: "+n.defaults.newType),t(arguments)})},setNotification(e){this.notifMgr||(this.notifMgr=s,l.setNotificationManager(this.notifMgr),l.setStackingPolicy(5)),this.notifMgr.addNotif({level:e.eventID,title:void 0!==e.title?e.title:void 0,subtitle:void 0!==e.subtitle?e.subtitle:void 0,message:void 0!==e.msg?e.msg:void 0,sticky:!1,allowUnsafeHTML:!1})},showModalLoader(){r.displayModalLoader(widget.body)},hideModalLoader(){r.removeModalLoader(widget.body)},destroy:function(){this.popupDialog&&this.popupDialog.destroy(),this.immersiveFrame&&this.immersiveFrame.destroy(),this._parent()}})}),define("DS/ENOCollabSharingCmds/BaseModels/ResultElement",["UWA/Controls/Abstract"],function(e){"use strict";return e.extend({init:function(e){for(var t in this.CategoryRelation="RelationClass",this.CategoryObj="Class",this.CategoryEBOM="EBOM",this.CategoryRelationM1="rel",this.CategoryObjM1="bus",this.MetatypeRel="relationship",this.MetatypeBus="businessobject",this.MetatypeEBOM="EBOM",this.urlIcon="",this.project="",this.org="",this.physicalId="",this.owner="",this.title="",this.name="",this.id="",this.type="",this.children=[],this.category="",this.serverUri="",this.serverHost="",this.isResultElement=!0,e)this[t]=e[t]},getUrlIcon:function(){return this.urlIcon},getProject:function(){return this.project},getOrganization:function(){return this.org},getPhysicalId:function(){return this.physicalId},getOwner:function(){return this.owner},getTitle:function(){return this.title},getLabel:function(){return this.getTitle()},getName:function(){return this.name},getId:function(){return this.id},getID:function(){return this.getPhysicalId()},getChildren:function(){return this.children},getCategory:function(){return this.category},getCategoryM1:function(){return this.getCategory()===this.CategoryRelation?this.CategoryRelationM1:this.getCategory()===this.CategoryObj?this.CategoryObjM1:""},getMetatype:function(){return this.getCategory()===this.CategoryRelation?this.MetatypeRel:this.getCategory()===this.CategoryEBOM?this.MetatypeEBOM:this.MetatypeBus},getType:function(){return this.type},getServerHost:function(){return this.serverHost},getServerUri:function(){return this.serverUri},setUrlIcon:function(e){this.urlIcon=e},setProject:function(e){this.project=e},setOrganization:function(e){this.org=e},setPhysicalId:function(e){this.physicalId=e},setOwner:function(e){this.owner=e},setTitle:function(e){this.title=e},setName:function(e){this.name=e},setId:function(e){this.id=e},setChildren:function(e){this.children=e},setCategory:function(e){this.category=e},setType:function(e){this.type=e},setServerHost:function(e){this.serverHost=e},setServerUri:function(e){this.serverUri=e}})}),define("DS/ENOCollabSharingCmds/commands/ENONew/NewECcompCBDAssembly",["DS/ENONewWidget/command/NewContentCommandBase","i18n!DS/ENOCollabSharingCmds/assets/nls/NewECcompNls"],function(e,t){"use strict";return e.extend({defaults:{newType:"PhysicalProductCBDAssembly",prefType:"VPMReference",objType:"VPMReference"},init(e){this._parent(e),this.labelTopBar=t.get("createNewCBDAssemblyNls"),this.commandName=t.get("newCBDAssemblyType")},getType(){return this.defaults.newType},getOptions(){return{labelTopBar:this.labelTopBar,commandName:this.commandName,options:{preferedType:this.defaults.prefType},type:this.defaults.objType}}})}),define("DS/ENOCollabSharingCmds/commands/Notification/Notification",["UWA/Core","DS/WebappsUtils/Console","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t,n,i){"use strict";var o={notificationsManager:null,display:function(e){null===o.notificationsManager&&(o.notificationsManager=n,i.setNotificationManager(o.notificationsManager),i.setStackingPolicy(9));var t={level:e.level,title:e.title,subtitle:e.subtitle,message:e.message?e.message:"",sticky:"error"===e.level};o.notificationsManager.addNotif(t)}};return o}),define("DS/ENOCollabSharingCmds/commands/EditPropCmd/EditPropCmdBase",["UWA/Class","DS/LifecycleControls/EditPropDialog"],function(e,t){"use strict";return t.extend({})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/AttributesPanel",["DS/UIKIT/SuperModal","DS/UIKIT/Form","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","DS/ENOFloatingPanel/ENOFloatingPanel","DS/EditPropWidget/facets/Properties/Properties","DS/EditPropWidget/models/EditPropAttributeModel","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/utils/AttributesUtils","UWA/Class/Promise","DS/UIKIT/Tooltip","i18n!DS/UIKIT/assets/nls/UIKIT","i18n!DS/ENOCollabSharingCmds/assets/nls/AttributesPanelNls"],function(e,t,n,i,o,a,r,s,l,c,d,u,p){"use strict";var f,g,h,m,v;return o.extend({init:function(e){this._parent(e);var t=widget.getValue("report_dlg_size");null==t&&(t='{ "width":580, "height":280 }'),this.setNewSize(JSON.parse(t)),f=widget.preferences[0].options},destroy:function(){var e=this.getModalBodySize();e.height=this.getContainerHeight();var t="report_dlg_size";widget.getValue(t)||widget.addPreference({name:t,type:"hidden",defaultValue:"{}"}),widget.setValue(t,JSON.stringify(e)),this._parent()},displayPanel:function(){var i=this,o=!0;this.addEvent("onClose",function(){o=!0,F(null)});var u,C,y,S,b=arguments,D=(b[0],b[1],b[2]),N=b[3],E=b[4],w=b[5],_=b[6],P=b[7],T=b[8],A=b[9],O=b[10],I=b[11],x=b[12],M=[],R=T,U=!1,W=null,V=null!=A&&A.length>2;function F(e,t,n,i,a){if(u.preventEvent=!0,o&&u.destroy(),o=!0,null!=n){var r=JSON.parse(n);if(r.length>0){var s=r[0],l=i.getChangedValues();for(var c in l){var d=i.get(c);if("object"==typeof d&&!d.isTransient){var p=d.name,f=d.valueDB;Object.keys(s).forEach(function(e){if("attributes"==e)for(var t=s[e],n=t.length,i=0;i<n;i++){var o=t[i];if(o.hasOwnProperty("name"))if(o.name==p)if(o.hasOwnProperty("modifiedattribute")&&r[0].attributes[i].value!==f&&(r[0].attributes[i].modifiedattribute=!0),o.hasOwnProperty("value")&&(r[0].attributes[i].value=f),o.hasOwnProperty("type"))"Double"==o.type&&(r[0].attributes[i].type="Real")}})}}}n=JSON.stringify(r)}if(UWA.is(O,"function")){var g=u.isVisible,h=null,m=null;if(null!=i){h=i.get("V_Name").get("value");var v=i.get("internalfilemane");m=null!=v?v.get("value"):null}O(e,h,t,m,n,g,a)}}function B(e,t){z(e).then(function(e){return e}).then(function(e){e&&"function"==typeof e.getInvalidCharInTitle&&e.getInvalidCharInTitle(type).then(function(e){i.invalidCharinTitle=e;var n=t.get("V_Name");if(null!=n){var o=new r(n);o.set("forbiddenChar",invalidCharinTitle),t.set(o.getIdentifier(),o)}})}).catch(function(e){i.invalidCharinTitle=null})}function L(e,t,n){var o=e.getValue("input_select"),a=t.get("internalfilemane");new r(a);if(w)if("V6"==o)i.showfilename=!1;else{if(null!=_&&null!=o){var s=o;s=s.substring(0,5);var l=JSON.parse(_),c=!1;Object.keys(l).forEach(function(e){s==e&&(l[e].hasOwnProperty("filenameStatus")&&"TRUE"==l[e].filenameStatus&&(c=!0))})}i.showfilename=!!c}else i.showfilename=!1;i.showfilename;var d=j(n),p=m.getField("input_select").selectedOptions[0].value;if("V6"!==p)for(var f=0;null!=n.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[f];){var g=n.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[f];if((h=n.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[f].childNodes[0].childNodes[0].childNodes[0])&&h.hasChildNodes()&&h.childNodes[0].childNodes[0].hasAttribute("name")&&"3DPartTemplate"===h.childNodes[0].childNodes[0].attributes.name.nodeValue){h.hide(),g.hide();n.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[f].childNodes[0].childNodes[0];u.elements.footer.childNodes[3].disabled=!0;break}f++}else if("V6"==p)for(f=0;null!=n.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[f];){var h,v=n.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[f];if((h=n.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[f].childNodes[0].childNodes[0].childNodes[0])&&h.hasChildNodes()&&h.childNodes[0].childNodes[0].hasAttribute("name")&&"3DPartTemplate"===h.childNodes[0].childNodes[0].attributes.name.nodeValue){h.style.display="",n.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[f].childNodes[0].childNodes[0].style.display="",n.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[f].childNodes[0].childNodes[1].childNodes[0].style.display="",v.style.display="",u.elements.footer.childNodes[3].disabled=!1;break}f++}var C=H(t,null);n.initData([C]);var y=n.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1],b=n.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[0];for(f=0;f<d.length;f++)y.insertBefore(d[f],b);u.show();var D=n.elements.formSection.elements.accordion;D.items[0].elements.container.childNodes[0].hide();var N=D.items[1];N&&D.dispatchEvent("onChange",[N]),U=!1}function j(e){for(var t=0,n=[];null!=e.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[t];){var i=e.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[t],o=e.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[t].childNodes[0].childNodes[0].childNodes[0];o&&o.hasChildNodes()&&o.childNodes[0].childNodes[0].hasAttribute("name")&&"3DPartTemplate"===o.childNodes[0].childNodes[0].attributes.name.nodeValue&&n.push(i),o&&o.hasChildNodes()&&o.childNodes[0].childNodes[0].hasAttribute("name")&&"Type"===o.childNodes[0].childNodes[0].attributes.name.nodeValue&&n.push(i),o&&o.hasChildNodes()&&o.childNodes[0].childNodes[0].hasAttribute("name")&&"SecurityContext"===o.childNodes[0].childNodes[0].attributes.name.nodeValue&&n.push(i),o&&o.hasChildNodes()&&o.childNodes[0].childNodes[0].hasAttribute("name")&&"Template"===o.childNodes[0].childNodes[0].attributes.name.nodeValue&&n.push(i),t++}return n}function k(e){var t,n=e.getValue("input_select");return"V5"==n||-1!==n.indexOf("UPSV5")?t="CATIAV5":-1!==n.indexOf("UPSSW")?t="SOLIDWORKS":-1!==n.indexOf("UPSCR")?t="CREO":-1!==n.indexOf("UPSNX")?t="NX":-1!==n.indexOf("UPSNX")?t="NX":-1!==n.indexOf("UPSIV")?t="INVENTOR":-1!==n.indexOf("UPSAD")?t="AUTOCAD":-1!==n.indexOf("UPSSE")&&(t="SOLIDEDGE"),t}function z(e){return new c(function(t,n){var i=k(e);require(["DS/LifecycleServices/LifecycleServicesSettings"],function(e){e.getCADvalidityService(i).then(function(e){t(e)}).catch(function(e){n(e)})})})}function X(e,t,n){q(e,t,function(e){!function(e,t,n){var o=t.get("V_Name"),a=t.get("internalfilemane"),s=null,l=null;null!=o&&(s=o.get("value"));null!=a&&(l=a.get("value"));s!=l&&(i.modifyfilename=!1);(function(e){return new c(function(t,n){if(function(e){var t=!1,n=e.getValue("input_select");return"V5"!=n&&-1===n.indexOf("UPSV5")||(t=!0),t}(e)){var i=k(e);require(["DS/LifecycleServices/LifecycleServicesSettings"],function(e){e.getCADvalidityService(i).then(function(e){t(e)}).catch(function(e){n(e)})})}else n(null)})})(m).then(function(e){if(e&&"function"==typeof e.checkfilenameValidity)e.checkfilenameValidity(l,function(e){var i=!0;if(null!=e){var o=new r(a);o.setError(e,"error",!0),t.set(o.getIdentifier(),o),i=!1;var s={msg:e,eventID:"warning",customClass:"EP_Warning_"+o.name};$(s)}n(i)});else{n(!0)}}).catch(function(e){var i=t.get("internalfilemane"),o=new r(i);o.resetError(),t.set(o.getIdentifier(),o),n(!0)})}(0,t,function(i){var o=!0,a=[];a.push(t),l.validateModels(a)&&(o=!1),n(e&&i&&o)})})}function q(e,t,n){z(e).then(function(e){return e}).then(function(e){if(e&&"function"==typeof e.checktitleValidity){var i=null,o=JSON.parse(N);Object.keys(o).forEach(function(e){o[e].hasOwnProperty("DSType")&&(i=e)});var a=null,s=t.get("V_Name");null!=s&&(a=s.get("value")),e.checktitleValidity(i,a).then(function(e){n(!0)}).catch(function(e){if(null!=e){var i=new r(s);i.setError(e,"error",!0),t.set(i.getIdentifier(),i)}n(!1)})}else{n(!0)}}).catch(function(e){var i=t.get("V_Name"),o=new r(i);o.resetError(),t.set(o.getIdentifier(),o),n(!0)})}function H(e,t){var n=null;if(null!=e){var o={};if(null!=t){var a=JSON.parse(t),l=null;if(a.length>0)for(var c=a[0].interfaces,d=a[0].attributes,u=d.length,f=0;f<u;f++){var g=d[f],h=g.name,v=g.NLS,C=g.type,y=g.value,S=g.value,b=g.access,D=g.dimension,N=g.unitName,E=g.dimensionType,w=g.mandatory,_=g.multiline,P=g.maxlength,T=g.authorizedvalues,A=g.multivaluated,O=g.isdisplayed,I=g.associatedType;if(O){var x=C;if("String"===C)x="text";else if("Integer"===C)x="integer";else if("Real"===C)x="real";else if("Boolean"===C)x="boolean";else if("Date"===C){if(""!=y){var R=parseInt(y);S=K(new Date(R),!0).valueDB}x="timestamp"}var W=null,V=e.get(h);if(null!=V)(W=new r(V)).set("value",y),W.set("valueDB",S);else{if(W=new r({path:h,name:h,label:v,value:y,valueDB:S,type:x,readOnly:b}),null!=D&&(W.set("dimension",D),W.set("unitName",N),W.set("dimensionType",E)),null!=T&&null!=W){var F=[],L=[];for(var j in T)F.push(T[j].Name),L.push(T[j].NLS);W.set("authorizedValues",F),W.set("authorizedValuesNLS",L),W.set("authorizedValuesRequired",!0)}if(P>0&&W.set("maxlength",P),_&&W.set("multiline",_),w&&W.set("mandatory",w),A&&W.set("multivalue",A),I&&c){var k=c.indexOf(I);if(k>=0&&k<c.length){p.expandExtension&&p.expandExtension;W.set("facet","ExtensionsFacet")}}}null!=W&&(o[W.getIdentifier()]=W),"V_Name"==h&&(l=y,B(m,i.model))}}}else{var z=e.getAllAttributes(),X=e.getChangedValues();for(var j in z){if((q=z[j])instanceof r)"internalfilemane"!=(H=q.get("name"))&&(o[q.getIdentifier()]=q),"V_Name"==H&&(l=q.get("value"))}for(var j in X){var q,H;if((q=X[j])instanceof r)"internalfilemane"!=(H=q.get("name"))&&(o[q.getIdentifier()]=q),"V_Name"==H&&(l=q.get("value"))}B(m,i.model)}if(i.showfilename){var Y=null,G=e.get("internalfilemane");null!=G?((Y=new r(G)).set("value",l),Y.set("valueDB",l)):Y=new r({path:"internalfilemane",name:"internalfilemane",label:p.Filename,value:l,valueDB:l,type:"text",readOnly:!1}),null!=Y&&(o[Y.getIdentifier()]=Y)}X=null;null==t&&(X=e.getChangedValues(),n=new s,e=n,i.model=n),e.set(o),null!=X&&e.setChangedValues(X),e.addEvent("onChange",function(){var t=e._changed,n=0;for(var i in t){var o=e.get(i);if("object"==typeof o&&o.mandatory){o.getIdentifier();var a=o.value;if("undefined"===a||""==a){n=1;break}}}M.length>0&&M[0].setDisabled(n),M.length>1&&M[1].setDisabled(n)}),e.addEvent("onChange:V_Name",function(){if(!U){var t=e.get("internalfilemane"),n=e.get("V_Name");if(null!=t){var i=new r(t);i.set("value",n.get("value")),i.set("valueDB",n.get("valueDB")),e.set(i.getIdentifier(),i),U=!1}}}),e.addEvent("onChange:internalfilemane",function(){U=!0})}return n}function Y(e,t,n,i,o){var a=UWA.createElement("div",{class:"formLine s12 m12 l12"}),r=UWA.createElement("div",{class:"flexLine",styles:{width:"100%","z-index":i}}).inject(a),s=UWA.createElement("div",{class:"formLabel s12",styles:{"padding-top":"10px"}}).inject(r),l=UWA.createElement("div",{class:"attrLabel"}).inject(s),c=UWA.createElement("span",{class:"textContainer"}).inject(l),u=UWA.createElement("span",{text:e,name:n}).inject(c);new d({position:"left top",target:u,body:e});var p=UWA.createElement("div",{class:"formValue s12",styles:{width:"100%",display:"flex","flex-direction":"column","padding-left":"10px","padding-right":"1px","z-index":i,overflow:"visible","min-width":o}}).inject(r);if(V){var f=m.getField("input_select").selectedOptions[0].value;null!==ee&&null!=f&&"V6"!==f&&s&&s.hasChildNodes()&&s.childNodes[0].childNodes[0].childNodes[0].hasAttribute("name")&&"3DPartTemplate"===s.childNodes[0].childNodes[0].childNodes[0].attributes.name.nodeValue&&s.hide()}return t.inject(p),a}function G(){var e,t;null!=m&&(e=m.getValues("input_select").input_select,localStorage.setItem("CADOriginPSECreate",e));null!=h&&(t=h.getValues("input_types").input_types);if(null!=t&&null!=t||(t=ne[0].value),null!=g){var n=g.getValues("input_selectcontext").input_selectcontext;localStorage.setItem("selectedsecuritycontext",n)}F(t,e,R,i.model,null)}function K(e,t){if(!e)return{value:"",valueDB:""};var n=t?e:new Date,i=e.getUTCFullYear(),o=e.getUTCMonth()+1,a=e.getUTCDate(),r=n.getUTCHours(),s=n.getUTCMinutes(),l=n.getUTCSeconds();return o<10&&(o="0"+o),a<10&&(a="0"+a),r<10&&(r="0"+r),s<10&&(s="0"+s),l<10&&(l="0"+l),n.setYear(i),n.setMonth(e.getMonth()),n.setDate(a),{value:n.toLocaleString(widget.lang),valueDB:i+"/"+o+"/"+a+"@"+r+":"+s+":"+l+":GMT"}}function J(e,t,n){var i=[];if(null!=n){var o=JSON.parse(n);Object.keys(o).forEach(function(e){if(o[e].type===t){var n=o[e].current,a=o[e].templates;Object.keys(a).forEach(function(e){var t=a[e].name,o=!1;a[e].physicalid===n&&(o=!0);var r={value:t,selected:o};i.push(r)})}})}if(null!=v){var a=v.getAutocompleteInput("input_partTemplates");if(null!=a){a.removeDataset("all3Dparttemplates");var r={name:"all3Dparttemplates",items:i};a.addDataset(r)}}}function $(e){var t=e.msg,n=e.eventID,i=e.customClass;switch(n){case"error":(function(e,t){Q(function(n){var i=n.addError(e,t);u.dispatchEvent("onNotification",i)})})(t=t||e.json,i);break;case"warning":!function(e,t){Q(function(n){var i=n.addWarning(e,t);u.dispatchEvent("onNotification",i)})}(t,i);break;case"success":!function(e,t){Q(function(n){var i=n.addSuccess(e,t);u.dispatchEvent("onNotification",i)})}(t,i);break;default:!function(e,t){Q(function(n){var i=n.addInfo(e,t);u.dispatchEvent("onNotification",i)})}(t,i)}}function Q(e){W?e.call(null,W):require(["DS/ErrorWidget/ErrorWidget"],function(t){W||(W=new t(widget,u.elements.container,{className:"newcontent_errorManager"})),e.call(null,W)})}widget.removeEvent("CREATIONDONE"),widget.addEvent("CREATIONDONE",function(e){if(u.isVisible&&(R=e,C=new s,i.model=C,C)){var t=j(y);y.setAccordionProperties({ExtensionsFacet:{name:"ExtensionsFacet",nameNLS:"Extensions",weight:-10}}),H(C,e),y.initData([C]),S=y.elements.formSection.elements.accordion.items[0].name;for(var n=y.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1],o=y.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[0],a=0;a<t.length;a++)n.insertBefore(t[a],o);u.show();var r=y.elements.formSection.elements.accordion;r.items[0].elements.container.childNodes[0].hide();var l=r.items[1];l&&r.dispatchEvent("onChange",[l]),U=!1,C.clearChangedValue()}var c=p.CreateButton;M[1].load(!1,c)}),UWA.is(b[0],"object")&&(b[0].message,b[0].title,E=b[0].fields,O=b[0].callback,I=b[0].okButtonText,x=b[0].koButtonText);var Z=localStorage.getItem("CADOriginPSECreate"),ee=Z;null!==ee&&"V6"!==ee&&(ee=ee.substring(0,5));var te=i.labelSort(E,ee),ne=[];if(null!=N){var ie=D,oe=!1,ae=JSON.parse(N);Object.keys(ae).forEach(function(e){oe=!1,null===ie&&ae[e].hasOwnProperty("DSType")&&(oe=!0),ie===e&&(oe=!0);var t={label:ae[e].nlsname,value:e,selected:oe};ne.push(t)})}ne.sort(function(e,t){var n=e.label.toLowerCase(),i=t.label.toLowerCase();return n.localeCompare(i)});var re=[];if(void 0!==f)for(var se=0;se<f.length;se++){var le=f[se].value;if(le===widget.environment.data._data._x_pad_security_ctx||le===widget.environment.data._data._x_SC){var ce={label:f[se].label,value:f[se].value,selected:!0};re.push(ce)}else{ce={label:f[se].label,value:f[se].value,selected:!1};re.push(ce)}}u=this;var de,ue,pe,fe,ge,he=[],me=[],ve=[],Ce=[],ye=(p.Template,p.Title,p.Filename,p.Type,p.TitlePlaceHolder);p.FilenamePlaceHolder;if(i.modifyfilename=!0,i.filenamevalidated=!0,"V6"==Z&&(i.showfilename=!1),w||(i.showfilename=!1),ne.length>1&&(he.push({type:"select",name:"input_types",label:" ",options:ne,events:{onChange:function(e){if(UWA.is(O,"function")){var t=h.getValue("input_types");J(0,t,A),O(t,null,null,null,null,!0)}}}}),h=new t({className:"horizontal",fields:he,events:{onSubmit:function(e){}}}),this.TypeForm=h,h.elements.container.childNodes[0].childNodes[0].remove(),h.elements.container.getElementsByClassName("col-sm-10")[0].style.width="100%",h.elements.container.childNodes[0].style.marginBottom="1px"),ve.push({type:"select",name:"input_select",label:" ",options:te,events:{onChange:function(e){w&&L(m,i.model,i.propUI),B(m,i.model)}}}),m=new t({className:"horizontal",fields:ve,events:{onSubmit:function(e){}}}),this.templateForm=m,m.elements.container.childNodes[0].childNodes[0].remove(),m.elements.container.getElementsByClassName("col-sm-10")[0].style.width="100%",m.elements.container.childNodes[0].style.marginBottom="1px",V){p.partTemplate,ye=p.partTemplatePlaceHolder;Ce.push({type:"autocomplete",name:"input_partTemplates",label:" ",placeholder:ye,showSuggestsOnFocus:!0}),v=new t({className:"horizontal",fields:Ce,events:{onSubmit:function(e){}}}),this.PartTemplateForm=v,v.elements.container.childNodes[0].childNodes[0].remove(),v.elements.container.getElementsByClassName("col-sm-10")[0].style.width="100%",v.elements.container.childNodes[0].style.marginBottom="1px"}if(re.length>1&&(me.push({type:"select",name:"input_selectcontext",label:" ",options:re,events:{onChange:function(e){}}}),g=new t({className:"horizontal",fields:me,events:{onSubmit:function(e){}}}),this.credentialForm=g,g.elements.container.childNodes[0].childNodes[0].remove(),g.elements.container.getElementsByClassName("col-sm-10")[0].style.width="100%",g.elements.container.childNodes[0].style.marginBottom="1px"),null!=h&&(de=h.getValue("input_types")),null!=de&&null!=de||(de="VPMReference"),V){var Se=m.getField("input_select").selectedOptions[0].value;null!==ee&&null!=Se&&"V6"!==Se&&v.hide(),J(0,de,A)}var be=[];ne.length>1&&(ue=Y(p.Type,h,"Type",1103,"1px"),be.push(ue)),fe=Y(p.Template,m,"Template",1102,"1px"),be.push(fe),V&&(ge=Y(p.partTemplate,v,"3DPartTemplate",1101,"1px"),be.push(ge)),re.length>1&&(pe=Y(p.credential,g,"SecurityContext",1100,"1px"),be.push(pe)),y=new a({setCloseButton:!1,editMode:!0,readOnly:!1,scroller:!1,events:{onCancel:function(){this.destroy()},onNotification:function(e){$(e)}}}),this.propUI=y,C=new s,this.model=C;y.setAccordionProperties({ExtensionsFacet:{name:"ExtensionsFacet",nameNLS:"Extensions",weight:-10}}),H(C,T),y.initData([C]),C.clearChangedValue(),y.elements.container.setStyle("height","100%"),S=y.elements.formSection.elements.accordion.items[0].name,i.showfilename||L(m,i.model,i.propUI),q(m,i.model,function(e){});var De=y.elements.formSection.elements.accordion;De.items[0].elements.container.childNodes[0].hide();var Ne=De.items[1];Ne&&(De.addEvent("onChange",function(e){if("ExtensionsFacet"===e.name){var t=e.isSelected?p.collapseExtension:p.expandExtension;e.title.getElement("span").setText(t)}}),De.dispatchEvent("onChange",[Ne])),this.Attrcontainer=UWA.createElement("div",{class:"Attr_container","data-rec-id":"Attr_container_rec-id",styles:{width:"100%",height:"100%",display:"flex","overflow-y":"auto","overflow-x":"hidden","flex-direction":"column"}});Se=m.getField("input_select").selectedOptions[0].value;if(null!==ee&&null!=Se&&"V6"!==Se)for(var Ee=0;Ee<be.length;Ee++){if((_e=(we=be[Ee]).childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0])&&_e.hasChildNodes()&&_e.hasAttribute("name")&&"3DPartTemplate"===_e.attributes.name.nodeValue){we.style.display="none";break}}else for(Ee=0;Ee<be.length;Ee++){var we,_e;if((_e=(we=be[Ee]).childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0])&&_e.hasChildNodes()&&_e.hasAttribute("name")&&"3DPartTemplate"===_e.attributes.name.nodeValue){we.style.display="";break}}var Pe=y.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1],Te=y.elements.formSection.elements._organizers[S].elements.container.childNodes[0].childNodes[1].childNodes[0];for(se=0;se<be.length;se++)Pe.insertBefore(be[se],Te);""===Te.innerText&&Te.remove(),y.inject(this.Attrcontainer),u.elements.body.addContent(this.Attrcontainer),u.inject(widget.body),!UWA.is(O,"function")&&this.options.callback&&(O=this.options.callback);var Ae=p.CreateButton,Oe=p.CreateCloseButton,Ie=p.CloseButton,xe=p.SaveSettingsButton;M.push(new n({value:I||Oe,className:"primary"})),M[0].addEvent("onClick",function(){X(m,i.model,function(e){1==e&&(o=!0,G())})}),M.push(new n({value:I||Ae})),M[1].addEvent("onClick",function(){X(m,i.model,function(e){if(1==e){var t=p.CreatingButton;M.length&&null!=M[1]&&M[1].load(!0,t),o=!1,G()}})}),M.push(new n({value:x||Ie})),M[2].addEvent("onClick",function(){o=!0,F(null)}),P&&M[1].hide(),V&&(M.push(new n({value:x||xe})),M[3].addEvent("onClick",function(){var t=this,n="Physical Product";if(null!=h){var i=h.getField("input_types");n=null==i||null==i?"Physical Product":i.selectedOptions[0].label}new e({closable:!0,animate:!1,overlay:!0}).confirm({title:p.saveSettingsTitle,message:p.confirmsaveSettingsMsg+" "+n+" ?",callback:function(e){if(t.load(!0),e){var i;if(null!=h&&(i=h.getValue("input_types")),null!=i&&null!=i||(i="VPMReference"),null!=v)var a=v.getValue("input_partTemplates");var r=null;if(null!=A){var s=JSON.parse(A);Object.keys(s).forEach(function(e){if(s[e].type===i){s[e].current;var t=s[e].templates;Object.keys(t).forEach(function(e){t[e].name===a&&(r=t[e].physicalid)})}})}null!=r?($({msg:p.confirmsaveSuccessMsg+" "+n,eventID:"success"}),o=!1,F(i,null,null,null,r)):$({msg:p.confirmsaveErrorMsg+" "+n,eventID:"error"})}t.load(!1)}})})),u.setFooter(M);Se=m.getField("input_select").selectedOptions[0].value;V&&null!==ee&&null!=Se&&"V6"!==Se&&(u.elements.footer.childNodes[3].disabled=!0),u.show(),u.onResize(),u.dispatchEvent("onShowModal")},labelSort:function(e,t){for(var n=[],i=!1,o=[],a=0;a<e.length;a++)o.push(e[a].label);o.sort();for(var r=0;r<e.length;r++){var s="background-image: url("+e[r].icon+");background-repeat: no-repeat;background-position-y: center;white-space: pre;background-size: 20px;background-origin: content-box;",l=e[r].value,c=o.indexOf(e[r].label);if(l.startsWith(t)&&!i){var d={label:e[r].label,value:e[r].value,attributes:{style:s},group:e[r].Connector,selected:!0};n[c]=d,i=!0}else{d={label:e[r].label,value:e[r].value,attributes:{style:s},group:e[r].Connector};n[c]=d}}return n}})}),define("DS/ENOCollabSharingCmds/commands/ENONew/NewPart",["DS/ENONewWidget/command/NewContentCommandBase","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/WAFData/WAFData","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ModalLoader","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","i18n!DS/ENOCollabSharingCmds/assets/nls/NewPartNls"],function(e,t,n,i,o,a,r,s,l,c){"use strict";return e.extend({defaults:{newType:"component",prefType:"VPMReference",objType:"VPMReference"},CAD_ORIGIN_MIX:"V5&V6",CAD_ORIGIN_TYPE_V5:"V5",init(e){this._parent(e),this.labelTopBar=c.get("createNewPart"),this.commandName=c.get("newObjectType"),this.tenant=widget.getValue("x3dPlatformId")||"OnPremise",this.addEventsForCommad()},getType(){return this.defaults.newType},getCommandLabel(){return"ENOInsertNewPartHdr"===this.options.ID?c.get("insertNewPart"):c.get("createNewPart")},getOptions(e){return{labelTopBar:this.labelTopBar,commandName:this.commandName,options:{preferedType:e&&e.type?e.type:this.defaults.prefType},type:this.defaults.objType}},execute(e){var t,n=this;if(n.disable(),n.showModalLoader(),(t=e?this.getCreateOptions(e):this.getCreateOptions({newType:this.getType()}))&&t.options){let e=t.options.parentPIDs;e&&e.length>0?this.multiselectionChecksForParentObject(e,e=>{n.getCadOriginsTypes(t,function(e){t.options.parentOrigin=e.parentOrigin,n.launchCreateNew(t)},function(e){n.hideModalLoader(),n.isEnabled()||n.enable(),console.log(e)})},e=>{n.hideModalLoader(),n.isEnabled()||n.enable(),console.log(e)}):this.launchCreateNew(t)}else this.launchCreateNew(t)},multiselectionChecksForParentObject(e,t,n){var i=this;e.length<2?t():this.launchPopupDialog({title:c.get("multiParentInsertPartTitle"),overlay:!0,content:new UWA.Element("text",{text:c.get("multiParentInsertPartMsg")}),footerButtons:{Ok:new a({name:"okay",label:c.get("okBtn"),onClick:function(e){i.popupDialog.isOKButtonClicked=!0,i.popupDialog.close(),t()}}),Discard:new a({name:"close",label:c.get("closeBtn"),onClick:function(e){i.popupDialog.isOKButtonClicked=!1,i.popupDialog.close()}})}},function(){i.popupDialog.isOKButtonClicked||n("DialogClose")})},getCadOriginsTypes:function(e,t,i){var o=this,a=[];e.options.parentPIDs.forEach(function(e){a.push({objectId:e})});var r={data:a};o.getPlatformInfo(function(){var a=o.platformInfo["3DSpace"]+"/resources/v1/modelerServices/authoring/op/getCADOriginsTypes",s={Accept:"application/json","Content-Type":"application/json","Accept-Language":widget.lang};e.context&&e.context.header&&(s.SecurityContext=e.context.header.SecurityContext),n.authenticatedRequest(a,{method:"POST",headers:s,timeout:864e5,data:JSON.stringify(r),type:"json",onComplete:function(e){if(e.hasOwnProperty("result")){var n=!1,a=!1;if(e.result.V_usages.forEach(function(e){"3DPart"===e?n=!0:"DraftingRepresentation"===e&&(a=!0)}),n)o.setNotification({eventID:"error",msg:c.get("multiParentCannotInsert")}),i(e);else if(a)o.setNotification({eventID:"error",title:c.get("CannotInsert.Type",{type:o.commandName})}),i(e);else{var r=e.result.cadOrigintypes,s="";r.length>0&&(s=r[0]);var l=[];r.forEach(function(e){s!=e&&(s=o.CAD_ORIGIN_MIX);var t=e;"V5"===e?t="CATIAV5":"SW"===e?t="SOLIDWORKS":"CR"===e?t="CREO":"IV"===e?t="INVENTOR":"AD"===e?t="AUTOCAD":"SE"===e&&(t="SOLIDEDGE"),l.push(t)}),s==o.CAD_ORIGIN_MIX&&(s=o.CAD_ORIGIN_TYPE_V5),t({parentOrigin:l})}}else i(e)},onFailure:function(e){i(e)},onTimeout:function(){i(object)}})},function(e){i(e)})},addEventsForCommad(){var e=this;require(["DS/ENONewWidget/ENONew/Events"],function(t){t.addEvent("onSelection",function(t){if(t){if(!0!==t.editMode)return void e.disable();var n=!1;if(t.selectedNodes&&t.selectedNodes.length>0){for(var i=0;i<t.selectedNodes.length;i++){var o=t.selectedNodes[i];if(o.type&&o.type.contains("Drawing")){n=!0;break}}n?e.disable():e.enable()}else e.enable()}}),t.addEvent("onCreationDialogAction",function(t){t&&"ready"===t.action&&e.hideModalLoader()}),t.addEvent("onNewInfraExit",function(t){t.newType!==e.getType()||e.isEnabled()||e.enable()})})},getPlatformInfo(e,n){var i=this;this.platformInfo?e():t.getPlatformServices({onComplete:function(t){t&&t.length&&(i.platformInfo=t.filter(e=>e.platformId===i.tenant)[0],e())},onFailure:function(e){n(e)}})},launchPopupDialog(e,t){var n=this;let a="component";this.immersiveFrame||(this.immersiveFrame=new i({identifier:a}),this.immersiveFrame.inject(widget.body)),this.popupDialog=new o({identifier:a,title:e.title?e.title:"",modalFlag:e.overlay,content:e.content,position:{my:"center",at:"center",collision:"fit"},buttons:e.footerButtons,escapeButton:e.footerButtons.Discard}),this.popupDialog.addEventListener("close",function(){console.log("Popup closed: "+n.defaults.newType),t(arguments)})},setNotification(e){this.notifMgr||(this.notifMgr=s,l.setNotificationManager(this.notifMgr),l.setStackingPolicy(5)),this.notifMgr.addNotif({level:e.eventID,title:void 0!==e.title?e.title:void 0,subtitle:void 0!==e.subtitle?e.subtitle:void 0,message:void 0!==e.msg?e.msg:void 0,sticky:!1,allowUnsafeHTML:!1})},showModalLoader(){r.displayModalLoader(widget.body)},hideModalLoader(){r.removeModalLoader(widget.body)},destroy:function(){this.popupDialog&&this.popupDialog.destroy(),this.immersiveFrame&&this.immersiveFrame.destroy(),this._parent()}})}),define("DS/ENOCollabSharingCmds/commands/ENONew/NewECcompPLMPCBPhysicalComponent",["DS/ENONewWidget/command/NewContentCommandBase","i18n!DS/ENOCollabSharingCmds/assets/nls/NewECcompNls"],function(e,t){"use strict";return e.extend({defaults:{newType:"PhysicalProductPLMPCBPhysicalComponent",prefType:"VPMReference",objType:"VPMReference"},init(e){this._parent(e),this.labelTopBar=t.get("createNewPLMPCBPhysicalComponentNls"),this.commandName=t.get("newPLMPCBPhysicalComponentType")},getType(){return this.defaults.newType},getOptions(){return{labelTopBar:this.labelTopBar,commandName:this.commandName,options:{preferedType:this.defaults.prefType},type:this.defaults.objType}}})}),define("DS/ENOCollabSharingCmds/ENOCollabSharingCmds",[],function(){}),define("DS/ENOCollabSharingCmds/commands/NewCmd/Models/NewCommandResponse",["DS/PlatformAPI/PlatformAPI","UWA/Controls/Abstract","require","DS/LifecycleServices/LifecycleServicesSettings"],function(e,t,n,i){return t.extend({init:function(e){for(var t in this.result="",this.id="",this.message="",this.physicalid="",this.relationphysicalid="",this.relationname="",this.PhysicalIDToRefresh="",this.attributes=null,e.hasOwnProperty("to[CAD SubComponent].physicalid")?this.relationphysicalid=e["to[CAD SubComponent].physicalid"]:e.hasOwnProperty("to[VPMInstance].physicalid")&&(this.relationphysicalid=e["to[VPMInstance].physicalid"]),e.hasOwnProperty("instanceName")&&(this.relationname=e.instanceName),this.isNewCommandResponse=!0,i.app_initialization(function(){}),e)this[t]=e[t]},isSuccess:function(){return"SUCCESS"==this.result},isWarning:function(){return"WARNING"==this.result},getType:function(){this.getAttributes();for(var e in this.attributes)if(this.attributes[e].hasOwnProperty("name")&&"ds6w:type"===this.attributes[e].name)return this.attributes[e].value;return""},getRelationPhysicalId:function(){return this.relationphysicalid},getPhysicalId:function(){return this.physicalid},getMessage:function(){return this.message},getPhysicalIdsToRefresh:function(){return this.PhysicalIDToRefresh},getAttributes:function(){if(null==this.attributes)for(var e in this.attributes=JSON.parse(this.rawAttr)[0].attributes,this.relationname&&0!=this.relationname.length&&this.attributes.push({name:"instanceName",value:this.relationname}),this.attributes)if(this.attributes[e].hasOwnProperty("name")&&("type_icon_url"===this.attributes[e].name||"thumbnail_2d"===this.attributes[e].name)){var t=i.get3DSpaceWSUrl(i.getTenant(),this.attributes[e].value,null);null!=t&&null!=t||(t=""),this.attributes[e].value=t}return this.attributes}})}),define("DS/ENOCollabSharingCmds/commands/ENONew/NewECcompCBDBoard",["DS/ENONewWidget/command/NewContentCommandBase","i18n!DS/ENOCollabSharingCmds/assets/nls/NewECcompNls"],function(e,t){"use strict";return e.extend({defaults:{newType:"PhysicalProductCBDBoard",prefType:"VPMReference",objType:"VPMReference"},init(e){this._parent(e),this.labelTopBar=t.get("createNewCBDBoardNls"),this.commandName=t.get("newCBDBoardType")},getType(){return this.defaults.newType},getOptions(){return{labelTopBar:this.labelTopBar,commandName:this.commandName,options:{preferedType:this.defaults.prefType},type:this.defaults.objType}}})}),define("DS/ENOCollabSharingCmds/uiex/SuperModalEx",["DS/UIKIT/SuperModal","DS/UIKIT/Form","DS/UIKIT/Input/Button","DS/UIKIT/Input/Text","DS/UIKIT/Tooltip","UWA/Class/Promise","i18n!DS/ENOCollabSharingCmds/assets/nls/SuperModalEx","css!DS/ENOCollabSharingCmds/assets/style/SuperModalEx.css"],function(e,t,n,i,o,a,r){"use strict";return e.extend({init:function(e){this._parent(e)},promptRadioList:function(){var e,i,o=arguments,a=o[0],r=o[1],s=o[2],l=o[3],c=o[4],d=o[5],u=[],p=UWA.merge({visible:!1,closable:!0},this.options);function f(t){e.preventEvent=!0,e.hide(),UWA.is(l,"function")&&l(t)}UWA.is(o[0],"object")&&(a=o[0].message,r=o[0].title,s=o[0].fields,l=o[0].callback,c=o[0].okButtonText,d=o[0].koButtonText),p.events={onHide:function(){!e.preventEvent&&UWA.is(l,"function")&&l()},onShow:function(){i.getField("input_radio").focus()}},e=this.modalFactory(p);for(var g=[],h=0;h<s.length;h++){var m=!1;0==h&&(m=!0),g.push({type:"radio",checked:m,name:"input_radio",value:s[h].value,label:s[h].label})}i=new t({fields:g,events:{onSubmit:function(e){f(e.input_radio)}}}),this.form=i,UWA.is(a,"string")?e.elements.body.addContent({tag:"p",text:a},i):e.elements.body.addContent(a,i),UWA.is(r,"string")?e.setHeader({tag:"h4",text:r}):(e.getHeader().hide(),l||(l=r)),!UWA.is(l,"function")&&this.options.callback&&(l=this.options.callback),u.push(new n({value:c||p.okButtonText,className:"primary"})),u[0].addEvent("onClick",function(){i.submit()}),u.push(new n({value:d||p.koButtonText})),u[1].addEvent("onClick",function(){f(null)}),e.setFooter(u),e.dispatchEvent("onShowModal")},promptSelectList:function(){var i,s,l,c,d,u,p=this,f=!0,g=arguments,h=(g[0],g[1]),m=g[2],v=g[3],C=g[4],y=g[5],S=g[6],b=g[7],D=g[8],N=g[9],E=g[10],w=g[11],_=[],P=UWA.merge({visible:!1,closable:!0},this.options),T=null,A=null!=D&&D.length>=2;function O(e,t,n,o,a){i.preventEvent=!0,f&&i.hide(),f=!0,UWA.is(N,"function")&&N(e,t,n,o,a)}function I(e){var t=e.getValue("input_select"),n=(e.getTextInput("input_filename"),e.getField("input_filename").getParent().getParent());if(y)if("V6"==t)n.hide(),p.showfilename=!1;else{if(null!=S&&null!=t){var i=t;i=i.substring(0,5);var o=JSON.parse(S),a=!1;Object.keys(o).forEach(function(e){i==e&&(o[e].hasOwnProperty("filenameStatus")&&"TRUE"==o[e].filenameStatus&&(a=!0))})}a?(n.show(),p.showfilename=!0):(n.hide(),p.showfilename=!1)}else n.hide()}function x(e){var t,n=e.getValue("input_select");return"V5"==n||-1!==n.indexOf("UPSV5")?t="CATIAV5":-1!==n.indexOf("UPSSW")?t="SOLIDWORKS":-1!==n.indexOf("UPSCR")?t="CREO":-1!==n.indexOf("UPSNX")?t="NX":-1!==n.indexOf("UPSNX")?t="NX":-1!==n.indexOf("UPSIV")?t="INVENTOR":-1!==n.indexOf("UPSAD")&&(t="AUTOCAD"),t}function M(e){return new a(function(t,n){var i=x(e);require(["DS/LifecycleServices/LifecycleServicesSettings"],function(e){e.getCADvalidityService(i).then(function(e){t(e)}).catch(function(e){n(e)})})})}function R(e,t){U(e,function(n){!function(e,t){var n=e.getValue("input_title"),i=e.getValue("input_filename");n!=i&&(p.modifyfilename=!1);(function(e){return new a(function(t,n){if(function(e){var t=!1,n=e.getValue("input_select");return"V5"!=n&&-1===n.indexOf("UPSV5")||(t=!0),t}(e)){var i=x(e);require(["DS/LifecycleServices/LifecycleServicesSettings"],function(e){e.getCADvalidityService(i).then(function(e){t(e)}).catch(function(e){n(e)})})}else n(null)})})(e).then(function(n){if(n&&"function"==typeof n.checkfilenameValidity)n.checkfilenameValidity(i,function(n){var i=e.getField("input_filename"),o=i.getParent();if(null!=n){if(null!=o){p.filenamevalidated=!1;var a=!1;o.lastChild.textContent=n,i.getParent(".form-group").addClassName("has-error"),i.focus(),t(a)}}else if(null!=o){p.filenamevalidated=!0;var a=!0;i.getParent(".form-group").removeClassName("has-error"),o.lastChild.textContent="",i.focus(),t(a)}});else{var o=e.getField("input_filename"),a=o.getParent();o.getParent(".form-group").removeClassName("has-error"),a.lastChild.textContent="";t(!0)}}).catch(function(n){var i=e.getField("input_filename"),o=i.getParent();i.getParent(".form-group").removeClassName("has-error"),o.lastChild.textContent="";t(!0)})}(e,function(e){t(n&&e)})})}function U(e,t){M(e).then(function(e){return e}).then(function(n){if(n&&"function"==typeof n.checktitleValidity){var i,o=e.getValue("input_title"),a=JSON.parse(v);Object.keys(a).forEach(function(e){a[e].hasOwnProperty("DSType")&&(i=e)}),n.checktitleValidity(i,o).then(function(n){var i=e.getField("input_title").getParent();null!=i&&i.getParent(".form-group").removeClassName("has-error"),i.lastChild.textContent="";t(!0)}).catch(function(n){var i=e.getField("input_title"),o=i.getParent();null!=o&&(o.lastChild.textContent=n,o.getParent(".form-group").addClassName("has-error"));i.focus(),t(!1)})}else{r.lastChild.textContent="";var r=titlefield.getParent();null!=r&&r.getParent(".form-group").removeClassName("has-error");t(!0)}}).catch(function(n){var i=e.getField("input_title").getParent();null!=i&&i.getParent(".form-group").removeClassName("has-error"),i.lastChild.textContent="";t(!0)})}function W(e,t){var n=e.getInput("input_types");if(null!=n&&null!=n)for(var i=n.getOptions(),o=0;o<i.length;o++){var a=i[o];a.value==t&&(u=a.label)}}function V(e,t,n){var i=[];if(null!=n){var o=JSON.parse(n);Object.keys(o).forEach(function(e){if(o[e].type===t){var n=o[e].current,a=o[e].templates;Object.keys(a).forEach(function(e){var t=a[e].name,o=!1;a[e].physicalid===n&&(o=!0);var r={value:t,selected:o};i.push(r)})}})}if(null!=e){var a=e.getAutocompleteInput("input_partTemplates");if(null!=a){a.removeDataset("all3Dparttemplates");var s={name:"all3Dparttemplates",items:i};a.addDataset(s)}}if(null!=d){var l=r.TooltipSaveSettings+u;d.setBody(l)}}function F(e){var t=e.msg,n=e.eventID,o=e.customClass;switch(n){case"error":(function(e,t){B(function(n){var o=n.addError(e,t);i.dispatchEvent("onNotification",o)})})(t=t||e.json,o);break;case"warning":!function(e,t){B(function(n){var o=n.addWarning(e,t);i.dispatchEvent("onNotification",o)})}(t,o);break;case"success":!function(e,t){B(function(n){var o=n.addSuccess(e,t);i.dispatchEvent("onNotification",o)})}(t,o);break;default:!function(e,t){B(function(n){var o=n.addInfo(e,t);i.dispatchEvent("onNotification",o)})}(t,o)}}function B(e){T?e.call(null,T):require(["DS/ErrorWidget/ErrorWidget"],function(t){T||(T=new t(widget,widget.body,{className:"newcontent_errorManager"})),e.call(null,T)})}widget.addEvent("CREATIONDONE",function(){var e=r.CreateButton;_[1].load(!1,e)}),UWA.is(g[0],"object")&&(g[0].message,h=g[0].title,C=g[0].fields,N=g[0].callback,E=g[0].okButtonText,w=g[0].koButtonText),P.events={onHide:function(){!i.preventEvent&&UWA.is(N,"function")&&N()},onShow:function(){s.getField("input_select").focus()}};var L=localStorage.getItem("CADOriginPSECreate"),j=L;null!==j&&"V6"!==j&&(j=j.substring(0,5));var k=p.labelSort(C,j),z=[];if(null!=v){var X=m,q=!1,H=JSON.parse(v);Object.keys(H).forEach(function(e){q=!1,null===X&&H[e].hasOwnProperty("DSType")&&(q=!0),X===e&&(q=!0);var t={label:H[e].nlsname,value:e,selected:q};z.push(t)})}z.sort(function(e,t){var n=e.label.toLowerCase(),i=t.label.toLowerCase();return n.localeCompare(i)}),i=this.modalFactory(P);var Y=r.Template,G=r.Title,K=r.Filename,J=r.Type,$=r.TitlePlaceHolder,Q=r.FilenamePlaceHolder,Z=[];if(p.modifyfilename=!0,p.filenamevalidated=!0,"V6"==L&&(p.showfilename=!1),y||(p.showfilename=!1),z.length>1&&Z.push({type:"select",name:"input_types",label:J,options:z,events:{onChange:function(e){if(UWA.is(N,"function")){var t=s.getValue("input_types");W(s,t);V(s,t,D)}}}}),Z.push({type:"text",name:"input_title",placeholder:$,maxlength:100,label:G,errorText:"title not correct",events:{onKeyDown:function(e){13===e.keyCode&&setTimeout(function(){R(s,function(e){1!=e&&0!=p.showfilename||s.submit()})})}}}),Z.push({type:"select",name:"input_select",label:Y,options:k,events:{onChange:function(e){y&&I(s),U(s,function(e){})}}}),Z.push({type:"text",name:"input_filename",placeholder:Q,label:K,errorText:"filename not correct",events:{onChange:function(e){!0===p.modifyfilename&&(s.getValue("input_title")!=s.getValue("input_filename")&&(p.modifyfilename=!1))}}}),A){var ee=r.partTemplate;$=r.partTemplatePlaceHolder;Z.push({type:"autocomplete",name:"input_partTemplates",label:ee,placeholder:$,showSuggestsOnFocus:!0})}if(s=new t({className:"horizontal",fields:Z,grid:"3 9",events:{onSubmit:function(e){var t=e.input_title,n=e.input_select,i=e.input_filename,o=e.input_types;localStorage.setItem("CADOriginPSECreate",n),O(o,t,n,i,null)}}}),this.form=s,A){var te=s.getValue("input_types");null!=te&&null!=te||(te="VPMReference"),W(s,te),V(s,te,D)}var ne={input:function(){setTimeout(function(){var e=s.getTextInput("input_title");s.getTextInput("input_filename");if(e.elements.input){var t=e.getValue();!function(e){var t=null,n=JSON.parse(v);Object.keys(n).forEach(function(e){n[e].hasOwnProperty("DSType")&&(t=e)});var i=e.getTextInput("input_title").getValue();M(e).then(function(e){return e}).then(function(n){n&&"function"==typeof n.getInvalidCharInTitle&&n.getInvalidCharInTitle(t).then(function(e){return e}).then(function(t){var n=new RegExp(t),o=i.match(n),a=e.getField("input_title").getParent();if(null==o)a.getParent(".form-group").removeClassName("has-error");else{var s,l,c=null;for(l=0;l<o.length;l++)void 0===s?s=o[l]:s.includes(o[l])||(s+=o[l]);var d=s.split("");void 0!==d&&(c=r.get("Unsupported_char",{char:d})),null!=c&&null!=a&&(a.lastChild.textContent=c,a.getParent(".form-group").addClassName("has-error"))}}).catch(function(t){e.getField("input_title").getParent().getParent(".form-group").removeClassName("has-error")})}).catch(function(t){e.getField("input_title").getParent().getParent(".form-group").removeClassName("has-error")})}(s),p.modifyfilename&&p.form.setValue("input_filename",t)}})}};s.getTextInput("input_title").elements.input.addEvents(ne),p.showfilename||I(s),U(s,function(e){}),i.elements.body.addContent(s),UWA.is(h,"string")?i.setHeader({tag:"h4",text:h}):(i.getHeader().hide(),N||(N=h)),!UWA.is(N,"function")&&this.options.callback&&(N=this.options.callback);var ie=r.CreateButton,oe=r.CreateCloseButton,ae=r.CloseButton,re=r.SaveSettingsButton;_.push(new n({value:E||oe,className:"primary"})),_[0].addEvent("onClick",function(){R(s,function(e){1!=e&&0!=p.showfilename||(f=!0,s.submit())})}),_.push(new n({value:E||ie})),_[1].addEvent("onClick",function(){R(s,function(e){if(1==e||0==p.showfilename){var t=r.CreatingButton;_.length&&null!=_[1]&&_[1].load(!0,t),f=!1,s.submit()}})}),_.push(new n({value:w||ae})),_[2].addEvent("onClick",function(){f=!0,O(null)}),b&&_[1].hide(),A&&(_.push(new n({value:w||re})),_[3].addEvent("onClick",function(){l=s.getValue("input_types"),c=s.getValue("input_partTemplates"),i.hide();new e({closable:!0,animate:!1,overlay:!0}).confirm({title:r.saveSettingsTitle,message:r.confirmsaveSettingsMsg+u+"?",callback:function(e){!function(e,t,n){if(n){var i=null;if(null!=D){var o=JSON.parse(D);Object.keys(o).forEach(function(n){if(o[n].type===e){o[n].current;var a=o[n].templates;Object.keys(a).forEach(function(e){a[e].name===t&&(i=a[e].physicalid)})}})}null!=i?(F({msg:r.SaveSettingsOK+u,eventID:"success"}),f=!1,O(e,null,null,null,i)):F({msg:r.SaveSettingsKO+u,eventID:"error"})}}(l,c,e)}})}),d=new o({target:_[3].getContent(),body:r.TooltipSaveSettings+u})),i.setFooter(_),i.dispatchEvent("onShowModal")},labelSort:function(e,t){for(var n=[],i=!1,o=[],a=0;a<e.length;a++)o.push(e[a].label);o.sort();for(var r=0;r<e.length;r++){var s="background-image: url("+e[r].icon+");background-repeat: no-repeat;background-position-y: center;white-space: pre;background-size: 20px;background-origin: content-box;",l=e[r].value,c=o.indexOf(e[r].label);if(l.startsWith(t)&&!i){var d={label:e[r].label,value:e[r].value,attributes:{style:s},group:e[r].Connector,selected:!0};n[c]=d,i=!0}else{d={label:e[r].label,value:e[r].value,attributes:{style:s},group:e[r].Connector};n[c]=d}}return n}})}),define("DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect",["UWA/Core","UWA/Class","DS/PlatformAPI/PlatformAPI","DS/PADUtils/PADContext","DS/WAFData/WAFData","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleControls/CredentialList"],function(e,t,n,i,o,a,r){"use strict";return t.extend({init:function(e,t){this._parent(e,t),this.checking_select=!1;var n=i.get();n&&!1!==n.checkOnCommand&&(this._check_select(),n.addEvent("editModeModified",this.check_select.bind(this)),"function"==typeof n.getPADTreeDocument&&(n.getPADTreeDocument().getXSO().onPostAdd(this.check_select.bind(this)),n.getPADTreeDocument().getXSO().onPostRemove(this.check_select.bind(this))))},isCID:function(e){for(var t=!1,n=e.length,i=0;i<n;i++)if(null!=e[i].getID()&&0===e[i].getID().indexOf("cid:")){t=!0;break}return t},check_select:function(){if(!this.checking_select){this.checking_select=!0;var e=!1!==this.options.withTimeout?300:0;setTimeout(function(){this.checking_select=!1,this._check_select()}.bind(this),e)}},_check_select:function(){var t=i.get(),n=[];if("function"==typeof t.getPADTreeDocument){n=t.getPADTreeDocument().getXSO().get();var o=this.isCID(n),a=n.length,s=!(!a||!0===this.options.cmd_selection_single&&1!==a);if(0===a&&"function"==typeof t.getFolderXSO){var l=t.getFolderXSO().getCurrentFolder();(s=!!l&&!!l.id)&&(a=(n=[l]).length)}if(null!=this.isAvailable)(p=this).selectedObjects=n,s=this.isAvailable(n,function(e,t){t==p.selectedObjects&&(e?p.enable():p.disable())});else if(!0!==s||t.getEditMode&&!0!==t.getEditMode())this.disable();else{for(var c=!0,d=0;d<a;d++)null!=n[d].getID()&&(c=!1);if(c)this.disable();else if(this.enable(),o&&this.disable(),!window.__karma__&&"ActionBar_AccessRightCmd"===this.options.ID){var u=t.getSecurityContext(),p=this,f=widget.getValue("x3dPlatformId");let n=r.loadCredentials(f);e.Promise.all([n,u]).then(t=>{t.length<2||!e.is(t[0],"array")?console.error("Missing credentials"):r.filterCredentials(f,t[0],"accessRight").then(e=>{e.length;0==e.length&&p.disable()}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}}}else this.enable()}})}),define("DS/ENOCollabSharingCmds/commands/EditPropCmd/ActionBar_EditPropCmd",["UWA/Class","DS/ENOCollabSharingCmds/commands/EditPropCmd/EditPropCmdBase","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(e,t,n){"use strict";return e.extend(t,n,{defaultIsTransient:!1,extraNotif:!1,init:function(e){e.withTimeout=!1,this._parent(e,{isAsynchronous:!0}),this.editProp=null},execute:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();null==n&&(n=e.options.context),e.disable(),n.options.arguments=e.options.arguments,e.launchProperties(n),setTimeout(function(){e.enable()},2e3)})}})}),define("DS/ENOCollabSharingCmds/commands/ReserveCmd/ActionBar_ReserveCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/PlatformAPI/PlatformAPI","DS/ENOCollabSharingCmds/Services/CommandServices","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t,n,i,o,a,r,s){"use strict";return e.extend(t,n,{labelTopBar:UWA.i18n("Reserve selected objects"),init:function(e){var t=!1;this.options=e,void 0!==typeof e&&null!==e&&e.hasOwnProperty("odtMode")&&(t=e.odtmode),t||this._setCommandEnableStatus(),this._parent(e,{isAsynchronous:!0}),"function"==typeof i.getUser()?this.currentUser=i.getUser().login:this.currentUser="",this._unsupportedTypes=[]},beginExecute:function(){},execute:function(e){var t=this;require(["DS/WidgetServices/WidgetServices","DS/ENOCollabSharingCmds/Services/CommandServices","DS/ReserveWidget/ReserveWidget","DS/PADUtils/PADContext","DS/ENOCollabSharingCmds/BaseModels/ResultElement"],function(n,o,l,c,d){var u=c.get();null==u&&(u=t.options.context);var p={_setNotification:function(e,t){if("function"==typeof u.displayNotification){var n={eventID:t,msg:e};u.displayNotification(n)}else{window.notifs=r,s.setNotificationManager(window.notifs);var i={level:t,title:"",subtitle:"",message:e,sticky:!1};window.notifs.addNotif(i)}},_setError:function(e){this._setNotification(e,"error")},_setWarning:function(e){this._setNotification(e,"warning")},_setInfo:function(e){this._setNotification(e,"info")}},f=[],g=u.getSelectedNodes(),h=!1,m=!1;if(g.length&&g.forEach(function(e){if("function"==typeof e.getID&&"function"==typeof e.getLabel){void 0===(i=e.plmType||e.getType&&e.getType())&&e.hasOwnProperty("object")&&(i=e.object.type);var n="";o.inFamilyFolder(i)&&(console.log("$$$ A Folder has been selected $$$"),h=!0);var i="";null!=e.options&&(i=e.options.type),e.object&&o.isMaterialDomain(e.object.type)&&(null!=e.object.options&&(n=e.object.options["ds6w:type"]),console.log("$$$ An unsupported Material type has been selected $$$"),m=!0,t._unsupportedTypes.includes(n)||t._unsupportedTypes.push(n));var a=e.getID(),r=e.getLabel();if(null!=a){var s="";"function"==typeof e.getRelationID&&(s=e.getRelationID());var l="";if("function"==typeof e.getRealParent)"function"==typeof(c=e.getRealParent()).getID&&(l=c.getID());else if("function"==typeof e.getParent){var c;"function"==typeof(c=e.getParent()).getID&&(l=c.getID())}var u=null;null!=e&&null!=e.options&&null!=e.options.grid&&(u=e.options.grid["ds6w:cadMaster"]);var p=new d({physicalId:a,name:r,relID:s,parentID:l,cadMaster:u,type:i});f.push(p)}}}),f.length>0){var v=!1;void 0!==typeof t.options&&null!==t.options&&t.options.hasOwnProperty("odtmode")&&(v=t.options.odtmode),0==v&&o.allAggregated3DShape(f,function(e){})}if(!0===h)p._setWarning(UWA.i18n("reserve not available"));else if(!0===m){var C=a.replace(a.errorMatRefReserveCmdErrorMessage,{dispType:t._unsupportedTypes});p._setError(C)}else if(f.length>0){var y=f[0],S=t.currentUser;null==S&&(S=i.getUser().login),t.container=new l({readOnly:"auto",serverName:y.getServerHost(),serverUri:y.getServerUri(),operation:"reserve",currentUser:S,executeOptions:e,localContext:u,events:{onNotification:function(e){if(null!=u&&"function"==typeof u.displayNotification)u.displayNotification(e);else{window.notifs=r,s.setNotificationManager(window.notifs);var t=e.eventID;"primary"===e.eventID&&(t="info");var n={level:t,title:"",subtitle:e,message:e.msg,sticky:!1};window.notifs.addNotif(n)}}}}),t.container.setObjects(f),t.container.launchCmd()}else p._setWarning(UWA.i18n("reserve no content"))}),t.end()},endExecute:function(){},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=0;null!=t.get()&&(null!=t.get().getEditMode&&!0!==t.get().getEditMode()&&(n=0),1===n?e.enable():e.disable(),t.get().addEvent("editModeModified",function(t){!0===t?e.enable():e.disable()}))})}})}),define("DS/ENOCollabSharingCmds/commands/ShareCmd/ActionBar_ShareCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t,n,i,o,a,r,s){"use strict";return e.extend(t,n,{init:function(e){this._parent(e,{isAsynchronous:!0}),this.sharePanel=null},beginExecute:function(){},execute:function(){var e=this;e.disable(),require(["DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/SharePopup/SharePopup","DS/Selection/CSOManager","DS/ENOCollabSharingCmds/BaseModels/ResultElement","DS/PADUtils/PADContext","DS/LifecycleServices/LifecycleServices"],function(t,n,i,a,r,s,l){e._unsupportedTypes=[];var c=s.get();null!=c&&"function"==typeof c.getSelectedNodes||(c=e.options.context);var d=t.getTenantID(),u={context:c};n.getInstance(u).getSecurityContext();a.get();var p=[],f=a.get();0==f.length&&(f=c.getSelectedNodes());let g=!1;f.length&&f.forEach(function(e){"function"==typeof e.getID&&"function"==typeof e.getLabel&&(g=!0)}),g||(f=c.getSelectedNodes()),f.length&&f.forEach(function(e){if("function"==typeof e.getID&&"function"==typeof e.getLabel){var n=e.getID();e.getLabel();if(null!==n){n=e.getID();var i=e.getLabel(),a=null,s="",l="",c=null,d=null;if(e.options)a=e.options.type,l=e.options.subLabel,c=e.options.grid["ds6wg:revision"],s=e.options.grid["ds6w:type"],null!=e.options.icons&&e.options.icons.length>0&&(d=e.options.icons[0]);else if(e.object){if(l=e.object.ownerFullName,c=e.object.revision,null!=e.object.options&&null!=e.object.options.icons&&e.object.options.icons.length>0){var u=e.object.options.icons[0];d=u.length&&u.indexOf("http")<0?o.get3DSpaceBaseUrl(t.getTenantID())+u:u}s=e.object.type}var f="";"function"==typeof e.getRelationID&&(f=e.getRelationID());var g="",h="";if(null!==e&&null!==e.getParent&&"function"==typeof e.getParent){var m=e.getParent();null!==m&&null!==m.getID&&"function"==typeof m.getID&&(g=m.getID(),h=m.options.grid["ds6w:cadMaster"])}var v=null;null!=e&&null!=e.options&&null!=e.options.grid&&(v=e.options.grid["ds6w:cadMaster"]);var C=new r({urlIcon:d,physicalId:n,name:i,category:"",type:a,typeDisplayName:s,relID:f,parentID:g,cadMaster:v,parentCADMaster:h,responsibleName:l,Revision:c});p.push(C)}}}),null===n._currentSecurityContext?e.isAllECInSelection(d,c,p,""):e.isAllECInSelection(d,c,p,n._currentSecurityContext.SecurityContext)})},isAllECInSelection:function(e,t,n,o){for(var r=this,s=(JSON.parse("[]"),!1),l=n.length,c=[],d=0;d<l;d++){var u=n[d].getID();c.push(u)}return i.listAttributes(e,c,["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]","attribute[PLMCoreRepReference.V_isOnceInstantiable]","attribute[PLMEntity.V_usage]","type","owner","project","organization","physicalid","project.property[Title].value","organization.property[Title].value"],function(i,o){var c=0;s=!1;for(var d=0,u=i.results.length,p=0;p<u;p++){"TRUE"==(f=i.results[p])["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"]&&d++}if(u>0)for(p=0;p<i.results.length;p++){(f=i.results[p]).physicalid;for(var f,g=0;g<n.length;g++)if(f.physicalid===n[g].physicalId){var h;1==(h="3DPart"==f["attribute[PLMEntity.V_usage]"]&&"3DShape"==f.type)&&c++,n[g].owner=f.owner,n[g].project=f.project,n[g].organization=f.organization,n[g].v_IsEmbeddedComponent=f["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"],f.hasOwnProperty("options")&&f.options.hasOwnProperty("ds6w:type")&&(n[g].typeDisplayName=f.options["ds6w:type"]),null!=n[g].typeDisplayName&&null!=n[g].typeDisplayName||null==f.type&&null==f.type||(n[g].typeDisplayName=f.type),null==f["organization.property[Title].value"]||""===f["organization.property[Title].value"]?n[g].organizationTitle=f.organization:n[g].organizationTitle=f["organization.property[Title].value"],null===f["project.property[Title].value"]||""===f["project.property[Title].value"]?n[g].collabSpaceTitle=f.project:n[g].collabSpaceTitle=f["project.property[Title].value"],"3DPart"==f["attribute[PLMEntity.V_usage]"]&&"3DShape"!=n[g].type&&(null!=n[g].urlIcon&&null!=n[g].urlIcon.iconPath&&null!=n[g].urlIcon.iconPath&&(n[g].urlIcon=n[g].urlIcon.iconPath.replace("I_VPMNavProduct.png","I_3DPart.png")),n[g].typeDisplayName=a["3DPart"]),1==h&&(r._unsupportedTypes.includes(n[g].typeDisplayName)||r._unsupportedTypes.push(n[g].typeDisplayName))}}if(d==l)return r._setError(t,a.selectOwning),r.enable(),void r.end();if(c==l){var m=a.replace(a.errorMatRefShareCmdErrorMessage,{dispType:r._unsupportedTypes});return r._setError(t,m),r.end(),void(r._unsupportedTypes=[])}require(["DS/SharePopup/SharePopup","DS/LifecycleControls/CredentialList"],function(i,o){if(r.sharePanel){c=t._currentSC;let i=o.loadCredentials(e);UWA.Promise.all([i,c]).then(i=>{i.length<2||!UWA.is(i[0],"array")?console.error("Missing credentials"):o.filterCredentials(e,i[0],"accessRight").then(e=>{n.length>0&&(n[0].filterValidSCList=e);e.length;0!=e.length?(r.sharePanel.show(n),r.sharePanel.container.centerIt()):r._setError(t._currentSC,a.errorNotSupportedRoleForShare)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}else if(n.length>0){var s=n[0],l=widget.body;l=l||UWA.extend(document.body),r.sharePanel=new i(widget,widget.body,{className:"share_popup_fromCmd",serverName:s.getServerHost(),serverUri:s.getServerUri(),removeAtClose:!0,events:{onClose:function(){r.sharePanel=null,r.options.hasOwnProperty("sharingWebUI")&&r.options.sharingWebUI.onRefresh()}}});var c=t._currentSC;let d=o.loadCredentials(e);UWA.Promise.all([d,c]).then(i=>{i.length<2||!UWA.is(i[0],"array")?console.error("Missing credentials"):o.filterCredentials(e,i[0],"accessRight").then(e=>{n.length>0&&(n[0].filterValidSCList=e);e.length;0!=e.length?r.sharePanel.show(n):r._setError(t._currentSC,a.errorNotSupportedRoleForShare)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}else r._setError(localContext,UWA.i18n("no content selected"));r.end(),r.enable()})},function(e){return console.log(e),r._setError(t,a.InternalServerError),r.enable(),-1}),s},_setError:function(e,t){if(null!=e&&"function"==typeof e.displayNotification){var n={eventID:"error",msg:t};e.displayNotification(n)}else{window.notifs=r,s.setNotificationManager(window.notifs);var i={level:"error",title:"",subtitle:t,message:"",sticky:!1};window.notifs.addNotif(i)}},endExecute:function(){}})}),define("DS/ENOCollabSharingCmds/commands/AccessRightCmd/ActionBar_AccessRightCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(e,t,n,i,o,a){"use strict";return e.extend(t,n,{init:function(e){this._parent(e,{isAsynchronous:!0}),this.accessRightPanel=null},beginExecute:function(){},execute:function(){var e=this;e.disable(),require(["DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/AccessRightPopup/AccessRightPopup","DS/Selection/CSOManager","DS/ENOCollabSharingCmds/BaseModels/ResultElement","DS/PADUtils/PADContext","DS/LifecycleServices/LifecycleServices"],function(t,n,i,a,r,s,l){e._unsupportedTypes=[];var c=s.get();null==c&&(c=e.options.context);var d=t.getTenantID(),u={context:c};n.getInstance(u).getSecurityContext();a.get();var p=[],f=a.get();0==f.length&&(f=c.getSelectedNodes()),f.length&&f.forEach(function(e){if("function"==typeof e.getID&&"function"==typeof e.getLabel){var n=e.getID();e.getLabel();if(null!==n){n=e.getID();var i=e.getLabel(),a=null,s="",l="",c=null,d=null;if(e.options)a=e.options.type,l=e.options.subLabel,c=e.options.grid["ds6wg:revision"],s=e.options.grid["ds6w:type"],null!=e.options.icons&&e.options.icons.length>0&&(d=e.options.icons[0]);else if(e.object){if(l=e.object.ownerFullName,c=e.object.revision,null!=e.object.options&&null!=e.object.options.icons&&e.object.options.icons.length>0){var u=e.object.options.icons[0];null===u&&e.object.options.icons.length>1&&(u=e.object.options.icons[1]),d=u.length&&u.indexOf("http")<0?o.get3DSpaceBaseUrl(t.getTenantID())+u:u}s=e.object.type}var f="";"function"==typeof e.getRelationID&&(f=e.getRelationID());var g="",h="";if(null!==e&&null!==e.getParent&&"function"==typeof e.getParent){var m=e.getParent();null!==m&&null!==m.getID&&"function"==typeof m.getID&&(g=m.getID(),h=m.options.grid["ds6w:cadMaster"])}var v=null;null!=e&&null!=e.options&&null!=e.options.grid&&(v=e.options.grid["ds6w:cadMaster"]);var C=new r({urlIcon:d,physicalId:n,name:i,category:"",type:a,typeDisplayName:s,relID:f,parentID:g,cadMaster:v,parentCADMaster:h,responsibleName:l,Revision:c});p.push(C)}}}),e.isAllECInSelection(d,c,p)})},isAllECInSelection:function(e,t,n){for(var o=this,r=(JSON.parse("[]"),!1),s=n.length,l=[],c=0;c<s;c++){var d=n[c].getID();l.push(d)}return i.listAttributes(e,l,["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]","attribute[PLMCoreRepReference.V_isOnceInstantiable]","attribute[PLMEntity.V_usage]","type","owner","project","organization","physicalid","project.property[Title].value","organization.property[Title].value"],function(i,l){var c=0;r=!1;for(var d=0,u=i.results.length,p=0;p<u;p++){"TRUE"==(f=i.results[p])["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"]&&d++}if(u>0)for(p=0;p<i.results.length;p++){(f=i.results[p]).physicalid;for(var f,g=0;g<n.length;g++)if(f.physicalid===n[g].physicalId){var h;1==(h="3DPart"==f["attribute[PLMEntity.V_usage]"]&&"3DShape"==f.type)&&c++,n[g].owner=f.owner,n[g].project=f.project,n[g].organization=f.organization,n[g].v_IsEmbeddedComponent=f["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"],null==f["organization.property[Title].value"]||""===f["organization.property[Title].value"]?n[g].organizationTitle=f.organization:n[g].organizationTitle=f["organization.property[Title].value"],null===f["project.property[Title].value"]||""===f["project.property[Title].value"]?n[g].collabSpaceTitle=f.project:n[g].collabSpaceTitle=f["project.property[Title].value"],"3DPart"==f["attribute[PLMEntity.V_usage]"]&&"3DShape"!=n[g].type&&(null!=n[g].urlIcon.iconPath&null!=n[g].urlIcon.iconPath&&(n[g].urlIcon=n[g].urlIcon.iconPath.replace("I_VPMNavProduct.png","I_3DPart.png")),n[g].typeDisplayName=a["3DPart"]),1==h&&(o._unsupportedTypes.includes(n[g].typeDisplayName)||o._unsupportedTypes.push(n[g].typeDisplayName))}}if(d==s)return o._setError(t,a.selectOwning),o.enable(),void o.end();if(c==s){var m=a.replace(a.errorMatRefShareCmdErrorMessage,{dispType:o._unsupportedTypes});return o._setError(t,m),o.end(),void(o._unsupportedTypes=[])}i.results[0].popup?require(["DS/SharePopup/SharePopup","DS/LifecycleControls/CredentialList"],function(i,r){if(o.sharePanel){c=t._currentSC;let i=r.loadCredentials(e);UWA.Promise.all([i,c]).then(i=>{i.length<2||!UWA.is(i[0],"array")?console.error("Missing credentials"):r.filterCredentials(e,i[0],"accessRight").then(e=>{n.length>0&&(n[0].filterValidSCList=e);e.length;0!=e.length?(o.sharePanel.show(n),o.sharePanel.container.centerIt()):o._setError(t,a.errorNotSupportedRoleForShare)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}else if(n.length>0){var s=n[0],l=widget.body;l=l||UWA.extend(document.body),o.sharePanel=new i(widget,widget.body,{className:"share_popup_fromCmd",serverName:s.getServerHost(),serverUri:s.getServerUri(),removeAtClose:!0,events:{onClose:function(){o.sharePanel=null}}});var c=t._currentSC;let d=r.loadCredentials(e);UWA.Promise.all([d,c]).then(i=>{i.length<2||!UWA.is(i[0],"array")?console.error("Missing credentials"):r.filterCredentials(e,i[0],"accessRight").then(e=>{n.length>0&&(n[0].filterValidSCList=e);e.length;0!=e.length?o.sharePanel.show(n):o._setError(t,a.errorNotSupportedRoleForShare)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}else o._setError(localContext,UWA.i18n("no content selected"));o.end(),o.enable()}):require(["DS/AccessRightPopup/AccessRightPopup","DS/LifecycleControls/CredentialList"],function(i,r){if(o.accessRightPanel){c=t._currentSC;let i=r.loadCredentials(e);UWA.Promise.all([i,c]).then(i=>{i.length<2||!UWA.is(i[0],"array")?console.error("Missing credentials"):r.filterCredentials(e,i[0],"accessRight").then(e=>{n.length>0&&(n[0].filterValidSCList=e);e.length;0!=e.length?(o.accessRightPanel.show(n),o.accessRightPanel.container.centerIt()):o._setError(t,a.errorNotSupportedRoleForShare)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}else if(n.length>0){var s=n[0],l=widget.body;l=l||UWA.extend(document.body),o.accessRightPanel=new i(widget,widget.body,{className:"accessRight_popup_fromCmd",serverName:s.getServerHost(),serverUri:s.getServerUri(),removeAtClose:!0,events:{onClose:function(){o.accessRightPanel=null}}});var c=t._currentSC;let d=r.loadCredentials(e);UWA.Promise.all([d,c]).then(i=>{i.length<2||!UWA.is(i[0],"array")?console.error("Missing credentials"):r.filterCredentials(e,i[0],"accessRight").then(e=>{n.length>0&&(n[0].filterValidSCList=e);e.length;0!=e.length?o.accessRightPanel.show(n):o._setError(t,a.errorNotSupportedRoleForShare)}).catch(e=>{console.error("FAiled to call credential filter svc, error:",e)})})}else o._setError(localContext,UWA.i18n("no content selected"));o.end(),o.enable()})},function(e){return console.log(e),o._setError(t,a.InternalServerError),o.enable(),-1}),r},_setError:function(e,t){if(null!=e&&"function"==typeof e.displayNotification){var n={eventID:"error",msg:t};e.displayNotification(n)}else{window.notifs=NotificationsManager,NotificationsManagerViewOnScreen.setNotificationManager(window.notifs);var i={level:"error",title:"",subtitle:t,message:"",sticky:!1};window.notifs.addNotif(i)}},endExecute:function(){}})}),define("DS/ENOCollabSharingCmds/commands/UnreserveCmd/ActionBar_UnreserveCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/PlatformAPI/PlatformAPI","DS/ENOCollabSharingCmds/Services/CommandServices","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t,n,i,o,a,r,s){"use strict";return e.extend(t,n,{labelTopBar:UWA.i18n("Unreserve selected objects"),init:function(e){var t=!1;void 0!==typeof e&&null!==e&&e.hasOwnProperty("odtMode")&&(t=e.odtmode),t||this._setCommandEnableStatus(),this.options=e,this._parent(e,{isAsynchronous:!0}),this._unsupportedTypes=[]},beginExecute:function(){},execute:function(e){var t=this;require(["DS/WidgetServices/WidgetServices","DS/ENOCollabSharingCmds/Services/CommandServices","DS/ReserveWidget/ReserveWidget","DS/PADUtils/PADContext","DS/ENOCollabSharingCmds/BaseModels/ResultElement"],function(n,i,o,l,c){var d=l.get();null==d&&(d=t.options.context);var u={_setNotification:function(e,t){if("function"==typeof d.displayNotification){var n={eventID:t,msg:e};d.displayNotification(n)}else{window.notifs=r,s.setNotificationManager(window.notifs);var i={level:t,title:"",subtitle:"",message:e,sticky:!1};window.notifs.addNotif(i)}},_setError:function(e){this._setNotification(e,"error")},_setWarning:function(e){this._setNotification(e,"warning")},_setInfo:function(e){this._setNotification(e,"info")}},p=[],f=d.getSelectedNodes(),g=!1,h=!1;if(f.length&&f.forEach(function(e){if("function"==typeof e.getID&&"function"==typeof e.getLabel){var n="",o="";null!=e.options&&(n=e.options.type);var a=e.plmType||e.getType&&e.getType();void 0===a&&e.hasOwnProperty("object")&&(a=e.object.type),i.inFamilyFolder(a)&&(console.log("$$$ A Folder has been selected $$$"),g=!0),e.object&&i.isMaterialDomain(e.object.type)&&(null!=e.object.options&&(o=e.object.options["ds6w:type"]),console.log("$$$ An unsupported Material type has been selected $$$"),h=!0,t._unsupportedTypes.includes(o)||t._unsupportedTypes.push(o));var r=e.getID(),s=e.getLabel();if(null!=r){var l="";"function"==typeof e.getRelationID&&(l=e.getRelationID());var d="";if("function"==typeof e.getRealParent)"function"==typeof(u=e.getRealParent()).getID&&(d=u.getID());else if("function"==typeof e.getParent){var u;"function"==typeof(u=e.getParent()).getID&&(d=u.getID())}var f=null;null!=e&&null!=e.options&&null!=e.options.grid&&(f=e.options.grid["ds6w:cadMaster"]);var m=new c({physicalId:r,name:s,relID:l,parentID:d,cadMaster:f,type:n});p.push(m)}}}),p.length>0){var m=!1;void 0!==typeof t.options&&null!==t.options&&t.options.hasOwnProperty("odtmode")&&(m=t.options.odtmode),0==m&&i.allAggregated3DShape(p,function(e){})}if(!0===g)u._setWarning(UWA.i18n("unreserve not available"));else if(!0===h){var v=a.replace(a.errorMatRefUnreserveCmdErrorMessage,{dispType:t._unsupportedTypes});u._setError(v)}else if(p.length>0){var C=p[0];t.container=new o({readOnly:"auto",serverName:C.getServerHost(),serverUri:C.getServerUri(),operation:"unreserve",executeOptions:e,localContext:d,events:{onNotification:function(e){if(null!=d&&"function"==typeof d.displayNotification)d.displayNotification(e);else{window.notifs=r,s.setNotificationManager(window.notifs);var t=e.eventID;"primary"===e.eventID&&(t="info");var n={level:t,title:"",subtitle:e,message:e.msg,sticky:!1};window.notifs.addNotif(n)}}}}),console.log("calling setObjects"),t.container.setObjects(p),t.container.launchCmd()}else u._setWarning(UWA.i18n("unreserve no content"))}),t.end()},endExecute:function(){},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){null!=t.get()&&(!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){!0===t?e.enable():e.disable()}))})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/Models/NewCommandResponse","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/ENOCollabSharingCmds/Services/CommandServices","DS/WAFData/WAFData","require","DS/ENONewWidget/ENONewLauncher","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleServices/LifecycleServices","DS/UIKIT/SuperModal","DS/ENOCollabSharingCmds/commands/NewCmd/AttributesPanel","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/ENOCollabSharingCmds/commands/Notification/Notification","DS/WebappsUtils/WebappsUtils","i18n!DS/UIKIT/assets/nls/UIKIT","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(t,n,i,o,a,r,s,l,c,d,u,p,f,g,h,m){"use strict";return t.extend({isENONew:!0,labelTopBar:"",labelWaitingCreation:"",CurrentlabelWaitingCreation:"",isInsert:!1,useSelectedNodes:!0,datas:{},activeTopBar:!0,ExecutedByTopBar:!1,currentPreferredCAD:"",CAD_ORIGIN_MIX:"V5&V6",CAD_ORIGIN_TYPE_V6:"V6",CAD_ORIGIN_TYPE_V5:"V5",CAD_ORIGIN_TYPE_SW:"SW",CAD_ORIGIN_TYPE_CR:"CR",CAD_ORIGIN_TYPE_NX:"NX",CAD_ORIGIN_TYPE_IV:"IV",CAD_ORIGIN_TYPE_AD:"AD",CAD_ORIGIN_TYPE_SE:"SE",init:function(e){var t=this;if(t._setCommandEnableStatus(),this._parent(e,{isAsynchronous:!0}),!0===this.activeTopBar&&""!=this.labelTopBar&&(void 0===e.activeTopBar||e.activeTopBar))try{require(["DS/TopBarProxy/TopBarProxy","DS/TopBarProxy/Menu","DS/TopBarProxy/MenuItem"],function(e,n,i){var o=new e({id:widget.id}),a=new i({label:t.labelTopBar,onExecute:function(){t.executeTopBar()}});o.addContent({add:a})})}catch(e){console.log("can't load top bar")}},beginExecute:function(){},executeTopBar:function(){this.ExecutedByTopBar=!0,this.execute()},execute:function(){var e=this,t=e.ExecutedByTopBar;e.ExecutedByTopBar=!1;var r={};require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(e){if(e)try{var t=e.get();r={"DS-Change-Authoring-Context":t.AuthoringContextHeader?t.AuthoringContextHeader["DS-Change-Authoring-Context"]:null,"DS-Configuration-Authoring-Context":t.AuthoringContextHeader?t.AuthoringContextHeader["DS-Configuration-Authoring-Context"]:null}}catch(e){console.log("Change action is empty"),r=null}}),require(["DS/WidgetServices/WidgetServices","DS/PADUtils/PADContext"],function(s,c){var d=c.get();null==d&&(d=e.options.context),null!=d&&"function"==typeof d.getpreferredCAD&&(e.datas.preferredCAD=d.getpreferredCAD()),e.datas.expectSingleCreation=!1,null!=d&&"function"==typeof d.expectSingleCreation&&(e.datas.expectSingleCreation=d.expectSingleCreation()),null!=d&&"function"==typeof d.getpreferredTemplate&&(e.datas.preferredTemplate=d.getpreferredTemplate());var u,p={getContext:function(){return d},getCAHeader:function(){return r},_endCreation:function(){if(d.endBlockingTransaction(e.CurrentlabelWaitingCreation),t||e.end(),e.enable(),"undefined"!=typeof widget)if(e.datas.toupdate){var n=widget.getValue("x3dPlatformId"),i=e.datas.type,o=null,a=i+"PSECreate";null==(o=localStorage.getItem(a))&&(o="undefined"),e._get(n,"/resources/v1/collabServices/authoring/op/getJSProxyNew",{Type:i,objType:o},function(t){e.datas.attributes=t.Attributes,widget.dispatchEvent("CREATIONDONE",t.Attributes)},function(e){widget.dispatchEvent("CREATIONDONE"),y(e)})}else widget.dispatchEvent("CREATIONDONE")},_setNotification:function(e,t){if("function"==typeof d.displayNotification){var n={eventID:t,msg:e};d.displayNotification(n)}else alert(e)},_setError:function(e){this._setNotification(e,"error")},_setWarning:function(e){this._setNotification(e,"warning")},_setInfo:function(e){this._setNotification(e,"info")},_setSuccess:function(e){this._setNotification(e,"success")},_getCurrentFolder:function(){var e=null;if(d&&"function"==typeof d.getCurrentFolder){var t=d.getCurrentFolder();if(t){var n=JSON.parse(t);e={FolderID:n.FolderID,FolderType:n.FolderType}}}return e},_launchThroughSecurityContext:function(e,t,n){var o=this,a={context:d};i.getInstance(a).getSecurityContext({onSuccess:function(t){o._onCompleteGetSecurityContext(t,e,n)},onFailure:function(e){p._endCreation(),null!=e&&p._setError(e.message)}},{serverName:null,serverUri:null})},_onCompleteGetSecurityContext:function(t,n,i){var o=this,r={Accept:"application/json","Content-Type":"application/json"};null!=i&&(i["DS-Change-Authoring-Context"]&&(r["DS-Change-Authoring-Context"]=i["DS-Change-Authoring-Context"]),i["DS-Configuration-Authoring-Context"]&&(r["DS-Configuration-Authoring-Context"]=i["DS-Configuration-Authoring-Context"]));var c="",u=localStorage.selectedsecuritycontext;localStorage.setItem("selectedsecuritycontext",""),void 0!==u&&"undefined"!==u&&0!==u.length||(u=t.SecurityContext),0!=u.indexOf("ctx::")&&(c="ctx::"),r.SecurityContext=c+encodeURIComponent(u);var f=e.datas;if(d&&"function"==typeof d.getCurrentFolder){var m=d.getCurrentFolder();for(var v in m)f[v]=m[v]}delete f.aggregating_context;var C="?select=type&select=physicalid&select=cestamp";!0===e.isInsert&&""!==g?(C+="&aggregating_context="+g,C+="&select="+encodeURIComponent("to[CAD SubComponent].physicalid")):!0===e.isInsert&&h.length>=1&&(C+="&select="+encodeURIComponent("to[CAD SubComponent].physicalid"),f.aggregating_context=[],h.forEach(function(e){f.aggregating_context.push(e)}));f=UWA.Json.encode(f);var y=p._getCurrentFolder(),S=null,b=!1;null!=y&&(S=y.FolderID);try{if(void 0!==l.getActiveFolder){var D=l.getActiveFolder();if("folder"!==(N=UWA.Json.decode(f).type)&&null!==D.id&&void 0!==D.id&&""!==D.id){if(S=D.id,b=!0,void 0!==D.sc&&""!==D.sc){c="";0!==D.sc.indexOf("ctx::")&&(c="ctx::"),r.SecurityContext=c+encodeURIComponent(D.sc)}require(["DS/PlatformAPI/PlatformAPI"],function(e){e.publish("FolderEditor.ActiveFolderCallBack",{id:D.id,label:D.label})})}}}catch(e){null!=y&&(S=y.FolderID,r.SecurityContext=c+encodeURIComponent(t.SecurityContext))}null!=S&&(C+="&folderID="+S,b&&(C+="&activeFolder=true"));var N=UWA.Json.decode(f).type;if(null!=e.options.odtmode&&0!=e.options.odtmode||!l.getEnforceFolderLinkSetting()||null!=y&&null!=S||"component"!=N&&"assembly"!=N){null!=n&&(n.getHost(),n.getRootUri()),s.get3DSpaceUrlAsync({onComplete:function(e){var t=e+"/resources/v1/collabServices/authoring/op/createContent"+C;r["Accept-Language"]=widget.lang;var n=s.getTenantID();n&&0!=n.length?t+="&tenant="+n:t+="&tenant=OnPremise",a.authenticatedRequest(t,{type:"json",method:"POST",proxy:"passport",headers:r,timeout:36e5,data:f,onComplete:function(e){o._onCompleteCreation(e)},onFailure:function(e,t,n){p._endCreation(),p._setError(UWA.i18n("Failure during content creation"))},onTimeout:function(){p._endCreation(),p._setError(UWA.i18n("Timeout for content creation"))}})}})}else p._endCreation(),window.top.location.href.indexOf("ENOPRSU_AP")>-1||window.top.location.href.indexOf("ENOPSTR_AP")>-1?p._setError(UWA.i18n("ERROR_PIN_APP")):p._setError(UWA.i18n("ERROR_SELECT_FOLDER"))},_onCompleteCreation:function(t){p._endCreation();var i=new n(t);if("function"==typeof d.author)if(i.isSuccess()||i.isWarning()){i.isSuccess()&&p._setSuccess(UWA.i18n("Creation successful")),i.isWarning()&&p._setInfo(UWA.i18n("Creation successful")),i.isWarning()&&i.getMessage()&&p._setWarning(i.getMessage());var a=i.getPhysicalId();if(""!=a){if(d&&"function"==typeof d.insertNodes){if(!0===e.isInsert&&i.hasOwnProperty("instances")){d.author(!0);var r=[];i.instances.forEach(function(t){var n=t["to[VPMInstance].physicalid"],o=i.getAttributes(),a=o?Object.assign([],o):[];a.push({name:"instanceName",value:t.instanceName}),("component"==e.datas.type&&"undefined"!=e.datas.cadOriginType&&null!=e.datas.cadOriginType&&""!=e.datas.cadOriginType||"component"==e.datas.type&&e.isENONew)&&a.push({name:"relcount",value:"1"});var s=t.parentid;r.push({parent_id:s,children:[{relationid:n,attributes:a}]})}),d.insertNodes({inserted:r})}else if(!0===e.isInsert){var s=i.getRelationPhysicalId();d.author(!0);var l=i.getAttributes();"component"==e.datas.type&&"undefined"!=e.datas.cadOriginType&&null!=e.datas.cadOriginType&&""!=e.datas.cadOriginType&&l.push({name:"relcount",value:"1"}),d.insertNodes({inserted:[{parent_id:g,children:[{relationid:s,attributes:l}]}]})}else if(d.author(!0),o.isWorkspaceFolder(i.getType()))d.author(!0),d.addRoots({pids:[a]}),require(["DS/PADUtils/PADCommandProxy"],function(e){e.create().destroy()});else{l=i.getAttributes();("component"==e.datas.type&&"undefined"!=e.datas.cadOriginType&&null!=e.datas.cadOriginType&&""!=e.datas.cadOriginType||"component"==e.datas.type&&e.isENONew)&&l.push({name:"relcount",value:"1"}),d.insertNodes({created:[{attributes:l}]})}var c=i.getPhysicalIdsToRefresh();c.length>0&&require(["DS/PADUtils/PADCommandProxy"],function(e){var t=[];c.forEach(function(e){var n=[e.physicalid,a];t.push(n)});var n={authored:{connected:t}},i=e.create();i.authored({authored:!0}),i.refresh(n),i.destroy()})}}else p._setError(UWA.i18n("Warning : no physical id returned"))}else{var u=i.getMessage();if(null!=u)if("NoAccessToCreatePart"===u)u={level:"error",title:UWA.i18n("partCreationfailed"),subtitle:UWA.i18n("partCreationFailedSubtitle"),message:UWA.i18n("NoAccessToCreatePart")},f.display(u);else if(u.includes("ErrorCode:1501009"))u={level:"error",title:UWA.i18n("InvalidCSCreationfailed"),subtitle:UWA.i18n("InvalidCSCreationFailedSubtitle"),message:UWA.i18n("NoAccessToCS")},f.display(u);else{var h=UWA.i18n("creationfailed");!0===e.isInsert&&(h=UWA.i18n("insertionfailed")),u=h+UWA.i18n(u),p._setError(u)}else u=UWA.i18n("Failure during content creation"),p._setError(u)}}},g="",h=[];e.useSelectedNodes&&(u=d.getSelectedNodes());var m="";if(null!=u&&u.length>0){e.isInsert=!0,e.CurrentlabelWaitingCreation=UWA.i18n("Inserting "+e.labelWaitingCreation),e.disable();var v=[];if(u.forEach(function(e){v.hasOwnProperty(e.getID())||(v[e.getID()]=!0,h.push(e.getID()))}),"ENOPSTR_AP"==widget.getValue("x3dAppId")||"ENXENG_AP"==widget.getValue("x3dAppId")){var C=function(){p._endCreation()},y=function(e){p._setError(e),p._endCreation()},S=function(){e.chooseCadOriginTypeForNewObject(u,function(t,n,i,o,a,s){e.datas.cadOriginType=i,e.datas.title=n,e.datas.filename=o,e.datas.specializedtype=t,e.datas.attributes=a,e.datas.toupdate=s,d.beginBlockingTransaction(e.CurrentlabelWaitingCreation),p._launchThroughSecurityContext(null,!0,r)},C,y,p)};return void(u.length>1?e.warningMultiSelectionDialog(u,S,C,y):S())}if(null!=u&&u.length>1){m=UWA.i18n("Please select only one parent");p._endCreation(),p._setError(m)}else g=u[0].getID(),"ENOFOL3_AP"!=widget.getValue("x3dAppId")&&(e.datas.cadOriginType="V6",e.datas.title=""),d.beginBlockingTransaction(e.CurrentlabelWaitingCreation),p._launchThroughSecurityContext(null,!0,r)}else{if(e.isInsert=!1,e.CurrentlabelWaitingCreation=UWA.i18n("Creating "+e.labelWaitingCreation),e.disable(),"ENOPSTR_AP"==widget.getValue("x3dAppId")||"ENXENG_AP"==widget.getValue("x3dAppId"))return void e.showChooseCadOriginTypeDlg(void 0,function(t,n,i,o,a,s){e.datas.cadOriginType=i,e.datas.title=n,e.datas.filename=o,e.datas.specializedtype=t,e.datas.attributes=a,e.datas.toupdate=s,d.beginBlockingTransaction(e.CurrentlabelWaitingCreation),p._launchThroughSecurityContext(null,!0,r)},function(){p._endCreation()},function(t){e.datas.toupdate=!1,p._setError(t),p._endCreation()},p);"ENOFOL3_AP"!=widget.getValue("x3dAppId")&&(e.datas.cadOriginType="V6",e.datas.title=""),d.beginBlockingTransaction(e.CurrentlabelWaitingCreation),p._launchThroughSecurityContext(null,!0,r)}""!=m&&p._setError(m)})},getCadOriginsTypes:function(e,t,n){var i=[];e.forEach(function(e){var t=e.getID();i.push({objectId:t})});var o=widget.getValue("x3dPlatformId");this._post(o,"/resources/v1/collabServices/authoring/op/getCADOriginsTypes",{data:i},function(e){e.hasOwnProperty("result")?t(e.result):n(e)},function(e){n(e)})},set3DPartTemplate:function(e,t,n,i){var o=[];o.push({type:e,UUID:t});var a=this,r=widget.getValue("x3dPlatformId");a._post(r,"/resources/v1/collabServices/authoring/op/set3DPartTemplateExpression",{data:o},function(o){if(o.hasOwnProperty("result")){var r=a.datas.partTemplates;if(null!=r){var s=JSON.parse(r);Object.keys(s).forEach(function(n){s[n].type===e&&(s[n].current=t)}),a.datas.partTemplates=JSON.stringify(s)}n(o.result)}else i(o)},function(e){i(e)})},getTemplateNames:function(e,t,n){var i=e,o=(d=this).datas.Templates,a=d.datas.Specializedtypes,r=d.datas.CheckfilenameDisplay,s=d.datas.filenameStatus,l=d.datas.partTemplates;if(null==o){var c="/resources/v1/collabServices/authoring/op/getTemplatesNames",d=this,u=widget.getValue("x3dPlatformId"),p=e+"PSECreate";null==(f=localStorage.getItem(p))&&(f="undefined"),d._get(u,c,{templateType:i,objType:f},function(e){e.results?(d.datas.Templates=e.results,d.datas.CheckfilenameDisplay=e.CheckfilenameDisplay,d.datas.Specializedtypes=e.types,d.datas.filenameStatus=e.filenameStatus,d.datas.attributes=e.Attributes,d.datas.partTemplates=e.partTemplates,t(e.results,e.CheckfilenameDisplay,e.types,e.filenameStatus,e.Attributes,e.partTemplates)):n(e.errorMessage)},function(e){n(e)})}else{var f;c="/resources/v1/collabServices/authoring/op/getJSProxyNew",d=this,u=widget.getValue("x3dPlatformId"),p=e+"PSECreate";null==(f=localStorage.getItem(p))&&(f="undefined"),d._get(u,c,{Type:i,objType:f},function(e){d.datas.attributes=e.Attributes,t(o,r,a,s,e.Attributes,l)},function(e){n(e)})}},showChooseCadOriginTypeDlg:function(e,t,n,i,o,a){var r=this;if(this.isENONew)this.enoNew(e,o,a);else{var s=new u({closable:!0,resizable:!0,overlay:!0,title:r.labelTopBar,persistId:"newContentDim",className:"Lifecycle_Modals",events:{onShow:function(){this.dispatchEvent("onChooseTypeShown",s)}},renderTo:document.body}),l=r.datas;"drawing"!=l.type&&"assembly"!=l.type&&"component"!=l.type||r.getTemplateNames(l.type,function(o,a,c,d,u,p){var f=[];r._getavailableUPSData(e,function(e){for(var h=e,m="3DExperience",v=0;v<h.length;v++){if((b=h[v]).CAD==m){var C=g.getWebappsAssetUrl("ENOCollabSharingCmds","icons/3DEXPERIENCE.png");if("assembly"==l.type||"component"==l.type){m=UWA.i18n("3DExperience");var y="ProductTemplate";"component"==l.type&&(y="PartTemplate");var S={Connector:m,icon:C,label:"        "+m+" - "+UWA.i18n(y),value:r.CAD_ORIGIN_TYPE_V6};r._getpreferredCAD();f.push(S)}}}for(v=0;v<h.length;v++)for(var b=h[v],D=r._getavailableUPSChoice(b,o),N=0;N<D.length;N++)f.push(D[N]);var E=r._getexpectSingleCreationMode(),w=r._getsilentMode();if(w&&(1!=f.length&&(w=!1),function(e){var t=!0;if(null!=e){var n=JSON.parse(e);if(n.length>0)for(var i=n[0].attributes,o=i.length,a=0;a<o&&t;a++){var r=i[a],s=r.value;r.mandatory&&(null!=s&&""!==s||(t=!1))}}return t}(u)||(w=!1)),w){var _=(S=f[0]).value;t(null,void 0,_,null,u)}else{if(f.length){var P=l.type+"PSECreate",T=localStorage.getItem(P);s.displayPanel(UWA.i18n("Choose CAD authoring experience"),r.labelTopBar,T,c,f,a,d,E,u,p,function(e,o,a,s,l,c,d){null!=d?r.set3DPartTemplate(e,d,function(e){},function(e){i(e)}):null==a?(null!=e&&localStorage.setItem(P,e),r.datas.toupdate=c,n()):(localStorage.setItem(P,e),t(e,o,a,s,l,c))})}else{var A=UWA.i18n("notemplateavailable");i(A)}}},function(e){i(e)})},function(e){i(e)})}},warningMultiSelectionDialog:function(e,t,n,i){var o=UWA.i18n("warningMultiSelectionDialog Title"),a=UWA.i18n("warningMultiSelectionDialog Text");"drawing"==this.datas.type?(o=UWA.i18n("warningMultiSelectionDialog Title drawing"),a=UWA.i18n("warningMultiSelectionDialog Text drawing")):"component"==this.datas.type?(o=UWA.i18n("warningMultiSelectionDialog Title component"),a=UWA.i18n("warningMultiSelectionDialog Text component")):"assembly"==this.datas.type&&(o=UWA.i18n("warningMultiSelectionDialog Title assembly"),a=UWA.i18n("warningMultiSelectionDialog Text assembly"));var r=!0;new d({className:"Lifecycle_Modals",renderTo:document.body,events:{onHide:function(){r&&n()}}}).dialog({title:o,body:new UWA.Element("text",{text:a}),buttons:[{className:"primary",value:h.ok,action:function(e){r=!1,e.hide(),t()},name:"buttonOK"},{className:"default",value:h.ko,action:function(e){r=!1,e.hide(),n()},name:"buttonCancel"}]})},enoNew:function(e,t,n){var i="VPMReference";"drawing"===this.datas.type&&(i="Drawing");var o=UWA.i18n(this.datas.type),a=t.getContext().getSecurityContext(),r={SecurityContext:a?a.SecurityContext:""},c=t.getCAHeader();if(c)for(var d in c)r[d]=c[d];var u={tenant:a.tenant,header:r},p="PSECreate_prefType_"+a.tenant+"_"+this.datas.type,f=localStorage.getItem(p),g=[];e&&e.forEach(function(e){var t=e;"V5"===e?t="CATIAV5":"SW"===e?t="SOLIDWORKS":"CR"===e?t="CREO":"IV"===e?t="INVENTOR":"AD"===e?t="AUTOCAD":"SE"===e&&(t="SOLIDEDGE"),g.push(t)});var h=t._getCurrentFolder(),m=[],v=!1;null!=h&&(m[0]=h.FolderID);try{if(void 0!==l.getActiveFolder){var C=l.getActiveFolder();"folder"!==(y=this.datas.type)&&null!==C.id&&void 0!==C.id&&""!==C.id&&(m[0]=C.id,v=!0,require(["DS/PlatformAPI/PlatformAPI"],function(e){e.publish("FolderEditor.ActiveFolderCallBack",{id:C.id,label:C.label})}))}}catch(e){null!=h&&(m[0]=h.FolderID)}var y=this.datas.type;if(null!=this.options.odtmode&&0!=this.options.odtmode||!l.getEnforceFolderLinkSetting()||null!=h&&null!=m||"component"!=y&&"assembly"!=y){var S=this._getsilentMode();(new s).CreateNew({id:p,context:u,type:i,silentMode:S,labelTopBar:this.labelTopBar,commandName:o,responseFormat:1,options:{parentOrigin:g,preferedType:f,typeName:this.datas.type,parentPIDs:n,folderID:m,activeFolder:v,select:["type","physicalid","cestamp"]},events:{onSuccess:function(e){if("success"===e.status)if(e.parsedResult){var n=JSON.parse(e.parsedResult);t._onCompleteCreation(n)}else t._endCreation();else t._endCreation()},onFailure:function(e){t._endCreation()},onCancel:function(e){if(e&&e.preferedType){var n=e.preferedType;localStorage.setItem(p,n)}t._endCreation()}}})}else t._endCreation(),window.top.location.href.indexOf("ENOPRSU_AP")>-1||window.top.location.href.indexOf("ENOPSTR_AP")>-1?t._setError(UWA.i18n("ERROR_PIN_APP")):t._setError(UWA.i18n("ERROR_SELECT_FOLDER"))},chooseCadOriginTypeForNewObject:function(e,t,n,i,o){var a=this,r=!0,s=[];if(e.forEach(function(e){if(e.options.padgrid){s.push(e.getID());var t=e.options.padgrid;if(t&&"ds6w:Part"==t["ds6w:globalType"])return}r=!1}),r)a.getCadOriginsTypes(e,function(e){a.datas;var r=e.cadOrigintypes,l=e.V_usages,c=!1;l.forEach(function(e){"3DPart"==e&&(c=!0)});var d="";if(r.length>0&&(d=r[0]),r.forEach(function(e){d!=e&&(d=a.CAD_ORIGIN_MIX)}),d==a.CAD_ORIGIN_MIX&&(d=a.CAD_ORIGIN_TYPE_V5),c){var u=UWA.i18n("Error :")+UWA.i18n("Can not insert multiselection case");i(u)}else a.showChooseCadOriginTypeDlg(r,t,n,i,o,s)},function(e){i(e)});else{var l=e[0].options.type;"3DShape"===l&&(l="Part");var c={level:"error",title:m.Multipleselectionerror+" "+l};f.display(c)}},endExecute:function(){},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();null!=n&&"function"==typeof n.getEditMode&&(!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){!0===t?e.enable():e.disable()}))})},_getavailableUPSData:function(e,t,n){var i=this,o=i._getpreferredCAD(),a=!1;if(void 0!==e){var r="";if(e.forEach(function(e){r+=e}),""!==r){var s=!1;i.currentPreferredCAD!==o&&(s=!0);var l=i.datas[r];void 0===l||s||(a=!0,t(l))}}if(i.currentPreferredCAD=o,!a){var c=widget.getValue("x3dPlatformId");i._get(c,"/resources/v1/collabServices/authoring/op/getInsertableCADS",{parentCADOrigins:e},function(a){if(a.results){var r="";void 0!==e&&e.forEach(function(e){r+=e});var s,l=a.results;if(null!=o&&o.length>0)for(var c=0;c<l.length;c++)if(l[c].CAD==o){var d=new Array;d.push(l[c]),s=d}null==s&&(s=l),i.datas[r]=s,t(s)}else n(a.errorMessage)},function(e){n(e)})}},_getavailableUPSChoice:function(e,t){var n=[],i=e.CAD,o=e.prefix,a="icons/"+e.icon+".png",r=UWA.i18n(o),s=g.getWebappsAssetUrl("ENOCollabSharingCmds",a),l=this._getpreferredCAD(),c=this._getpreferredTemplate(o);return t.forEach(function(e){var t=e.fileName,a=t;if(1==t.startsWith(o)){var d=t=t.substring(o.length,t.length);t.includes("Default Assembly")?d="Default Assembly":t.includes("Assembly")&&!t.includes("Default Assembly")?d="Assembly":t.includes("Part")&&!t.includes("PartTemplate")?d="Part":t.includes("ProductTemplate")?d="ProductTemplate":t.includes("PartTemplate")?d="PartTemplate":t.includes("Default Drawing")?d="Default Drawing":!t.includes("Drawing")||t.includes("Default Drawing")||t.includes("DrawingISOA0PortaitTemplate")||t.includes("DrawingISOA0LandscapeTemplate")||(d="Drawing");var u=UWA.i18n(d),p=t.replace(d,u),f={Connector:r,icon:s,label:"        "+r+" - "+p,value:a};null!=c?c==t&&n.push(f):null!=l?l==i&&n.push(f):n.push(f)}}),n},_getsilentMode:function(){var e=!1,t=this._getpreferredCAD();return null!=t&&t.length>0&&(e=!0),e},_getexpectSingleCreationMode:function(){var e=!1,t=this.datas.expectSingleCreation;return null!=t&&(e=t),e},_getpreferredCAD:function(){return this.datas.preferredCAD},_getpreferredTemplate:function(e){return this.datas.preferredTemplate},_get:function(t,n,o,r,s){var d=this;require(["DS/PADUtils/PADContext"],function(u){var p;null!=u&&(p=u.get()),null==p&&(p=d.options.context);var f=Date.now().toString();o["timestamp"+f]=f;var g={context:p};i.getInstance(g).getSecurityContext({onSuccess:function(e){var i=e.SecurityContext;"ctx::"!=i&&""!=i||p&&"function"==typeof p.getSecurityContext&&(i=p.getSecurityContext().SecurityContext);var d=l.get3DSpaceWSUrl(t,n,null);for(var u in-1!=d.indexOf("?")?d+="&":d+="?",o){var f=o[u];f instanceof Array?f.forEach(function(e){d+=u+"="+e+"&"}):d+=u+"="+f+"&"}a.authenticatedRequest(d,{method:"GET",headers:l.getHeaders(encodeURIComponent(i)),timeout:864e5,type:"json",onComplete:function(e){r(e)},onFailure:function(e,t){c.onWebServiceError(s,e,t)},onTimeout:function(){c.onWebServiceError(s,null,NLS.timeout)}})},onFailure:function(t){privateMethods._endCreation(),c.onWebServiceError(s,null,e)}})})},_post:function(t,n,o,r,s){var d=this;require(["DS/PADUtils/PADContext"],function(u){var p;null!=u&&(p=u.get()),null==p&&(p=d.options.context);var f=JSON.stringify(o),g={context:p};i.getInstance(g).getSecurityContext({onSuccess:function(e){var i=e.SecurityContext;"ctx::"!=i&&""!=i||p&&"function"==typeof p.getSecurityContext&&(i=p.getSecurityContext().SecurityContext);var o=l.get3DSpaceWSUrl(t,n,null);a.authenticatedRequest(o,{method:"POST",headers:l.getHeaders(encodeURIComponent(i)),timeout:864e5,data:f,type:"json",onComplete:function(e){r(e)},onFailure:function(e,t){c.onWebServiceError(s,e,t)},onTimeout:function(){c.onWebServiceError(s,null,NLS.timeout)}})},onFailure:function(t){privateMethods._endCreation(),c.onWebServiceError(s,null,e)}})})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_InsertNewPartCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New part"),labelWaitingCreation:"new part",activeTopBar:!1,isInsert:!0,datas:{type:"component"},init:function(e){this._parent(e,{isAsynchronous:!0})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();if(null!=n){!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){if(!0===t){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1&&i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(o=!1)}),o?e.enable():e.disable()}else e.disable()});var i=n.options.model;null!=i&&(i.getXSO().onPostAdd(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(o=!1)}),o?e.enable():e.disable()):e.disable()}}),i.getXSO().onPostRemove(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(o=!1)}),o?e.enable():e.disable()):e.disable()}}),i.getXSO().onEmpty(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(o=!1)}),o?e.enable():e.disable()):e.disable()}}))}})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_NewDrawingCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New drawing"),labelWaitingCreation:"new drawing",datas:{type:"drawing"},init:function(e){this._parent(e,{isAsynchronous:!0});var t=(new Date).getTime();this.datas.PLM_ExternalID="prd"+t,this._setDrwCommandEnableStatus()},beginExecute:function(){this._parent()},execute:function(){var e,t=this.getArguments();if(t&&t.length){for(var n=0;n<t.length;n++)"Mode"===t[n].ID&&(e=t[n].Value);if("ForceNew"===e)require("DS/PADUtils/PADContext").get().getPADTreeDocument().unselectAll()}this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();null!=n&&(!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){if(!0===t){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1&&i.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&t.contains("CATIAV5")&&(o=!1)}),o?e.enable():e.disable()}else e.disable()}))})},_setDrwCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();if(null!=n){var i=n.options.model;null!=i&&(i.getXSO().onPostAdd(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&(t.contains("CATIAV5")||t.contains("SOLIDWORKS")||t.contains("INVENTOR")||t.contains("SOLIDEDGE"))&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}),i.getXSO().onPostRemove(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&(t.contains("CATIAV5")||t.contains("SOLIDWORKS"))&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}),i.getXSO().onEmpty(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&(t.contains("CATIAV5")||t.contains("SOLIDWORKS"))&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}))}})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_InsertNewDrawingCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New drawing"),labelWaitingCreation:"new drawing",activeTopBar:!1,datas:{type:"drawing"},init:function(e){this._parent(e,{isAsynchronous:!0});var t=(new Date).getTime();this.datas.PLM_ExternalID="prd"+t},beginExecute:function(){this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();if(null!=n){!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){if(!0===t){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1&&i.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&t.contains("CATIAV5")&&(o=!1)}),o?e.enable():e.disable()}else e.disable()});var i=n.options.model;null!=i&&(i.getXSO().onPostAdd(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&(t.contains("CATIAV5")||t.contains("SOLIDWORKS")||t.contains("INVENTOR")||t.contains("SOLIDEDGE"))&&(o=!1)}),o?e.enable():e.disable()):e.disable()}}),i.getXSO().onPostRemove(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&(t.contains("CATIAV5")||t.contains("SOLIDWORKS"))&&(o=!1)}),o?e.enable():e.disable()):e.disable()}}),i.getXSO().onEmpty(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.grid["ds6w:cadMaster"];t&&(t.contains("CATIAV5")||t.contains("SOLIDWORKS"))&&(o=!1)}),o?e.enable():e.disable()):e.disable()}}))}})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_NewPartCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New part"),labelWaitingCreation:"new part",datas:{type:"component"},init:function(e){this._parent(e,{isAsynchronous:!0}),this._setPartCommandEnableStatus()},beginExecute:function(){this._parent()},execute:function(){var e,t=this.getArguments();if(t&&t.length){for(var n=0;n<t.length;n++)"Mode"===t[n].ID&&(e=t[n].Value);if("ForceNew"===e)require("DS/PADUtils/PADContext").get().getPADTreeDocument().unselectAll()}this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();null!=n&&(!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){if(!0===t){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1&&i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(o=!1)}),o?e.enable():e.disable()}else e.disable()}))})},_setPartCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();if(null!=n){var i=n.options.model;null!=i&&(i.getXSO().onPostAdd(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}),i.getXSO().onPostRemove(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}),i.getXSO().onEmpty(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}))}})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_NewFolderCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New folder"),labelWaitingCreation:"new folder",isInsert:!0,useSelectedNodes:!1,datas:{type:"folder"},init:function(e){this._parent(e,{isAsynchronous:!0})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_InsertNewProductCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New product"),labelWaitingCreation:"new product",activeTopBar:!1,isInsert:!0,datas:{type:"assembly"},init:function(e){this._parent(e,{isAsynchronous:!0});var t=(new Date).getTime();this.datas.PLM_ExternalID="prd"+t},beginExecute:function(){this._parent()},endExecute:function(){this._parent()},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();if(null!=n){!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){if(!0===t){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1&&i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(o=!1)}),o?e.enable():e.disable()}else e.disable()});var i=n.options.model;null!=i&&(i.getXSO().onPostAdd(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(o=!1)}),o?e.enable():e.disable()):e.disable()}}),i.getXSO().onPostRemove(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(o=!1)}),o?e.enable():e.disable()):e.disable()}}),i.getXSO().onEmpty(function(){if(!0===t.get().getEditMode()){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1?(i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(o=!1)}),o?e.enable():e.disable()):e.disable()}}))}})}})}),define("DS/ENOCollabSharingCmds/commands/NewCmd/ActionBar_NewProductCmd",["DS/ApplicationFrame/Command","DS/ENOCollabSharingCmds/commands/NewCmd/NewCommandBase"],function(e,t){"use strict";return t.extend({labelTopBar:UWA.i18n("New product"),labelWaitingCreation:"new product",datas:{type:"assembly"},init:function(e){this._parent(e,{isAsynchronous:!0});var t=(new Date).getTime();this.datas.PLM_ExternalID="prd"+t,this._setPrdCommandEnableStatus()},beginExecute:function(){this._parent()},endExecute:function(){this._parent()},execute:function(){var e,t=this.getArguments();if(t&&t.length){for(var n=0;n<t.length;n++)"Mode"===t[n].ID&&(e=t[n].Value);if("ForceNew"===e)require("DS/PADUtils/PADContext").get().getPADTreeDocument().unselectAll()}this._parent()},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();null!=n&&(!0!==t.get().getEditMode()&&e.disable(),t.get().addEvent("editModeModified",function(t){if(!0===t){var i=n.getSelectedNodes(),o=!0;null!=i&&i.length>=1&&i.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(o=!1)}),o?e.enable():e.disable()}else e.disable()}))})},_setPrdCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=t.get();if(null!=n){var i=n.options.model;null!=i&&(i.getXSO().onPostAdd(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}),i.getXSO().onPostRemove(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}),i.getXSO().onEmpty(function(){if(!0===n.getEditMode()){var t=n.getSelectedNodes(),i=!0;null!=t&&t.length>=1?(t.forEach(function(e){var t=e.options.type;t&&t.contains("Drawing")&&(i=!1)}),i?e.enable():e.disable()):e.enable()}else e.disable()}))}})}})}),define("DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ChangeCommandBase",["UWA/Class","DS/ApplicationFrame/Command","DS/LifecycleServices/LifecycleServicesSettings","DS/ENOCollabSharingCmds/commands/CommandAvailableOnSelect","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/ENOCollabSharingCmds/Services/CommandServices","i18n!DS/ENOCollabSharingCmds/assets/nls/langSharingCmds"],function(e,t,n,i,o,a,r){"use strict";return e.extend(t,i,{transferType:"full",genericTransfer:!1,init:function(e){var t=!1;void 0!==typeof e&&null!==e&&e.hasOwnProperty("odtMode")&&(t=e.odtmode),t||this._setCommandEnableStatus(),this.options=e,this._parent(e,{isAsynchronous:!0}),this.transferOwnershipPanel=null,this._isMaterialDomain=!1,this._unsupportedTypes=[]},beginExecute:function(){},execute:function(){var e=this,t={};require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(e){if(e)try{var n=e.get();t={"DS-Change-Authoring-Context":n.AuthoringContextHeader?n.AuthoringContextHeader["DS-Change-Authoring-Context"]:null,"DS-Configuration-Authoring-Context":n.AuthoringContextHeader?n.AuthoringContextHeader["DS-Configuration-Authoring-Context"]:null}}catch(e){console.log("Change action is empty"),t=null}}),require(["DS/WidgetServices/WidgetServices","DS/TransferOwnershipWidget/TransferOwnershipConstant","DS/TransferOwnershipWidget/popup/TransferOwnershipPopup","DS/ENOCollabSharingCmds/BaseModels/ResultElement","DS/Selection/CSOManager","DS/PADUtils/PADContext","DS/ENOCollabSharingCmds/Services/CommandServices","DS/LifecycleServices/LifecycleServices"],function(i,o,a,s,l,c,d,u){e._unsupportedTypes=[];var p=c.get();e.options.context&&(p=e.options.context),null==p&&(p=e.options.context),null===e.options.context&&null!==p&&(e.options.context=p);var f={context:p},g="";g="owner"==e.transferType?o.TransferPerson:"CS"==e.transferType?o.TransferCollabSpace:o.TransferFull;var h=[],m={},v=l.get();if(v.length>0)v.forEach(function(e){e.hasOwnProperty("isResultElement")&&(e.setCategory(""),h.push(e))});else{var C=p.getSelectedNodes();C.length&&C.forEach(function(t){var o=t.getID(),a=(t.getLabel(),null);t.getType&&"function"==typeof t.getType&&(a=t.getType());var r="",l="",c=null,u=null,p=null,f=null;if(t.options)a=t.options.type,r=t.options.grid["ds6w:type"],l=t.options.subLabel,t.options.hasOwnProperty("grid")&&null!=t.options.grid&&(c=t.options.grid["ds6wg:revision"],l=t.options.grid["ds6wg:responsible"]);else if(t.object){if(l=t.object.ownerFullName,c=t.object.revision,r=t.object.type,0===o.indexOf("cid:")&&(f=t.object.branch),a=t.object.type,null!=t.object.options&&null!=t.object.options.icons&&t.object.options.icons.length>0)null===(D=t.object.options.icons[0])?t.object.options.icons.length>1&&(D=t.object.options.icons[1]):u="object"==typeof D?D:D.length&&D.indexOf("http")<0?n.get3DSpaceBaseUrl(i.getTenantID())+D:D,r=t.object.options["ds6w:type"]}if(null!=l&&null!=l||t.options&&(l=t.options.grid["ds6w:responsible"]),null!==o){var g="";"function"==typeof t.getRelationID&&(g=t.getRelationID());var v="",C="";if(null!==t&&null!==t.getParent&&"function"==typeof t.getParent){var y=t.getParent();null!==y&&null!==y.getID&&"function"==typeof y.getID&&(v=y.getID(),C=y.options.grid["ds6w:cadMaster"])}var S=null;if(null!=t&&null!=t.options&&null!=t.options.grid&&(S=t.options.grid["ds6w:cadMaster"]),null==u&&null!=t&&null!=t.options&&null!=t.options.icons&&t.options.icons.length>0){if(t.options.icons.length>0)for(var b=0;b<t.options.icons.length;b++){if(t.options.icons[b].hasOwnProperty("iconPath")){p=t.options.icons[b].iconPath;break}if(null!=t.options.icons[b]){p=t.options.icons[b];break}}if(null!==p)if("object"!=typeof p&&-1!=p.indexOf("url"))u=p.replace("url(","").replace(")","");else u=p}var D,N=new s({urlIcon:u,physicalId:o,name:t.getLabel(),title:t.getLabel(),category:"bus",type:a,typeDisplayName:r,relID:g,parentID:v,cadMaster:S,parentCADMaster:C,responsibleName:l,Revision:c,branch:f});if(null!=a&&null!=a)1==(D=d.isMaterialDomain(a))&&(e._isMaterialDomain=D,e._unsupportedTypes.includes(r)||e._unsupportedTypes.push(r));h.push(N),m[N.physicalId]=N}})}if(h.length>0){var y=!1;void 0!==typeof e.options&&null!==e.options&&e.options.hasOwnProperty("odtmode")&&(y=e.options.odtmode),0==y&&n.app_initialization(function(){d.allAggregated3DShape(h,function(e){})})}n.app_initialization(function(){var n=widget.getValue("x3dPlatformId"),i=Object.keys(m);u.listAttributes(n,i,["attribute[PLMEntity.V_usage]","attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]","physicalid","owner","revision","attribute[PLMCoreRepReference.V_isOnceInstantiable]","attribute[Marketing Name]","organization","organization.property[Title].value","project","type","displayType","project.property[Title].value","branch"],function(n){for(var l=0,c=0,d=null,u=0;u<n.results.length;u++){var v=n.results[u],C=v.objectId||v.physicalid,y=m[C],S="3DPart"==v["attribute[PLMEntity.V_usage]"]&&"3DShape"!=v.type;null===v["attribute[XCADEmbeddedCmp.V_IsEmbeddedComponent]"]?y.v_IsEmbeddedComponent=0:(y.v_IsEmbeddedComponent=1,l++);var b;1==(b="3DPart"==v["attribute[PLMEntity.V_usage]"]&&"3DShape"==v.type)&&c++,y.aggrObj=b,y.Revision=v.revision,y.organization=v.organization,null==y.type&&(y.type=v.type),null==v["organization.property[Title].value"]||""===v["organization.property[Title].value"]?y.organizationTitle=v.organization:y.organizationTitle=v["organization.property[Title].value"],y.project=v.project,null===v["project.property[Title].value"]||""===v["project.property[Title].value"]?y.projectTitle=v.project:y.projectTitle=v["project.property[Title].value"],y.owner=v.owner,y.responsibleName||(y.responsibleName=v.ownerFullName),y.typeDisplayName||(y.typeDisplayName=v.displayType),1==b&&(d=y.typeDisplayName,e._unsupportedTypes.includes(y.typeDisplayName)||e._unsupportedTypes.push(y.typeDisplayName)),S&&(y.typeDisplayName=r["3DPart"])}if(l==i.length)return e._setError(r.selectOwning),void e.end();if(c==i.length){var D=r.replace(r.errorMatRefMoveCmdErrorMessage,{dispType:e._unsupportedTypes});return g===o.TransferPerson&&(D=r.replace(r.errorMatRefChangeOwnerCmdErrorMessage,{dispType:e._unsupportedTypes})),e._setError(D),e.end(),void(e._unsupportedTypes=[])}e.getSecurityContext(function(n){if(e.transferOwnershipPanel)e.transferOwnershipPanel.setSecurityContext(n),e.transferOwnershipPanel.show(h,t),e.transferOwnershipPanel.container.centerIt();else if(h.length>0){var i=h[0];if(i=new s(i),null!==d&&e._unsupportedTypes.indexOf(d)>-1){var l=e._unsupportedTypes.indexOf(d);e._unsupportedTypes.splice(l,1)}if(e._unsupportedTypes.length>0){var c=r.replace(r.errorMatRefMoveCmdErrorMessage,{dispType:e._unsupportedTypes});return g===o.TransferPerson&&(c=r.replace(r.errorMatRefChangeOwnerCmdErrorMessage,{dispType:e._unsupportedTypes})),e._setError(c),void e.end()}var u="TOSP_PopupDial";g===o.TransferPerson&&(u="TOSP_PopupDial_Change_Owner"),e.className&&(u=e.className+" ."+u),e.transferOwnershipPanel=new a(widget.body,{className:u,context:p,transferType:g,serverName:i.getServerHost(),serverUri:i.getServerUri(),activeDnD:!0,activeOptions:!0,activeAdminCheckBox:widget.getBool("admin"),activeSummaryButton:!0,genericTransfer:e.genericTransfer,securityContext:n,events:{onClose:function(){e.transferOwnershipPanel=null}}}),e.transferOwnershipPanel.show(h,t)}else e._setError(UWA.i18n("no content selected"))},function(){e._setError(UWA.i18n("Fail to get security context"))},f),e.end()})})})},getSecurityContext:function(e,t,n){o.getInstance(n).getSecurityContext({onSuccess:function(n){if(null!=n&&""!=n&&n.hasOwnProperty("SecurityContext")&&null!=n.SecurityContext){var i="";0!=n.SecurityContext.indexOf("ctx::")&&(i="ctx::");var o=i+n.SecurityContext;e(o)}else t()},onFailure:function(e){t()}})},_setError:function(e){if("function"==typeof this.options.context.displayNotification){var t={eventID:"error",msg:e};this.options.context.displayNotification(t)}else alert(e)},endExecute:function(){},_setCommandEnableStatus:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){var n=0;null!=t.get()&&(null!=t.get().getEditMode&&!0!==t.get().getEditMode()&&(n=0),1===n?e.enable():e.disable(),t.get().addEvent("editModeModified",function(t){!0===t?e.enable():e.disable()}))})}})}),define("DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_TransferOwnershipCmd",["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ChangeCommandBase"],function(e){"use strict";return e.extend({transferType:"owner",genericTransfer:!0,className:"changeOwnership_popup_fromCmd",init:function(e){this._parent(e,{isAsynchronous:!0})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()}})}),define("DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd",["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ChangeCommandBase"],function(e){"use strict";return e.extend({transferType:"full",genericTransfer:!0,className:"changeOwner_popup_fromCmd",init:function(e){this._parent(e,{isAsynchronous:!0})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()}})}),define("DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeCSCmd",["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ChangeCommandBase"],function(e){"use strict";return e.extend({transferType:"CS",className:"changeCollabSpace_popup_fromCmd",init:function(e){this._parent(e,{isAsynchronous:!0})},beginExecute:function(){this._parent()},endExecute:function(){this._parent()}})});