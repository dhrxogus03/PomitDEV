define("DS/IssueServices/Contexts",["UWA/Class","UWA/Class/Events","UWA/Class/Options","DS/Logger/Logger"],function(e,t,r,s){"use strict";return e.singleton(r,t,{name:"DS/IssueServices/Contexts",version:"24x",_logger:null,_contexts:{},init:function(){this._logger=s.getLogger(this.name),this._contexts={}},add:function(e,t){this._contexts.hasOwnProperty(e)&&this._logger.warn("The context %s already exists, now replaced by the given context",e),this._contexts[e]=t},remove:function(e){this._contexts.hasOwnProperty(e)||this._logger.warn("The context %s does not exist, cannot remove it",e),delete this._contexts[e]},get:function(e){return void 0===this._contexts[e]?(this._logger.warn("The context %s does not exist",e),null):this._contexts[e]},reset:function(){this._contexts={}}})}),define("DS/IssueServices/utils/Parser",["UWA/Core"],function(e){"use strict";var t={id:"resourceid",typeIcon:"type_icon_url",previewUrl:"preview_url",owner:"owner",name:"ds6w:identifier",title:"ds6w:label",state:"ds6w:status",type:"ds6w:type",responsible:"ds6w:responsible",responsibleUid:"ds6w:responsibleUid",modified:"ds6w:modified",created:"ds6w:created",revision:"ds6wg:revision",organization:"ds6w:organizationResponsible",isLastRevision:"ds6wg:PLMReference.V_isLastVersion",interface:"interface",i3dxId:"ds6w:i3dx"};return{parseFetchResponse:function(r){var s={value:{},display:{}};if(e.is(r,"object")&&r.hasOwnProperty("attributes")){for(var a=0;a<r.attributes.length;a++){var n=r.attributes[a],o=e.is(n.name,"string")?n.name.replace("ds6w:what/","").replace("ds6w:when/","").replace("ds6w:who/",""):n.name;switch(o){case t.id:""!=s.value.id&&null!=s.value.id||(s.value.id=n.value,s.display.id=n.value),s.value.physicalId=n.value,s.display.physicalId=n.value;break;case t.typeIcon:s.value.typeIcon=n.value,s.display.typeIcon=n.value;break;case t.previewUrl:s.value.previewUrl=n.value,s.display.previewUrl=n.value;break;case t.owner:s.value.owner=n.value,s.display.owner=n.value;break;case t.name:s.value.name=n.value,s.display.name=n.dispValue||n.value;break;case t.title:s.value.title=n.value,s.display.title=n.dispValue||n.value;break;case t.state:s.value.state=n.value,s.display.state=e.is(n.dispValue,"string")?n.dispValue.replace("Issue.",""):n.dispValue;break;case t.type:s.value.type=n.value,s.display.type=n.dispValue||n.value;break;case t.responsible:s.value.responsible=n.value,s.display.responsible=n.dispValue||n.value;break;case t.responsibleUid:""!=s.value.owner&&null!=s.value.owner||(s.value.owner=n.value,s.display.owner=n.value);break;case t.modified:s.value.modified=n.value,s.display.modified=n.dispValue||n.value;break;case t.created:s.value.created=n.value,s.display.created=n.dispValue||n.value;break;case t.revision:s.value.revision=n.value,s.display.revision=n.value||n.value;break;case t.organization:s.value.organization=n.value,s.display.organization=n.dispValue||n.value;break;case t.interface:s.value.interface?s.value.interface.push(n.value):s.value.interface=[n.value],s.display.interface?s.display.interface.push(n.value):s.display.interface=[n.value];break;case t.isLastRevision:var i=n.value;i&&""!==i?(s.value.isLastRevision="true"===i.toLowerCase(),s.display.isLastRevision="true"===i.toLowerCase()):(s.value.isLastRevision=null,s.display.isLastRevision=null);break;case t.i3dxId:""!=n.value&&(s.value.id=n.value,s.display.id=n.dispValue||n.value,""!=s.value.physicalId&&null!=s.value.physicalId||(s.value.physicalId=n.value,s.display.physicalId=n.value));break;default:o&&""!==o?(s.value[o]=n.value,s.display[o]=n.dispValue||n.value):(s.value[o]=null,s.display[o]=null)}}null==s.value.isLastRevision&&(null!=s.value.lastrevision?s.value.isLastRevision="true"==s.value.lastrevision.toLowerCase().trim():s.value.isLastRevision=null)}return s}}}),define("DS/IssueServices/services/PlatformServices",["UWA/Class/Promise","UWA/Core","UWA/Utils/InterCom","DS/ENOFloatingPanel/ENOFloatingPanel","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/i3DXCompassServices/i3DXCompassPubSub","DS/PlatformAPI/PlatformAPI","DS/WAFData/WAFData"],function(e,t,r,s,a,n,o,i){"use strict";var u={WIDTH:700,HEIGHT:800},l="X3DPRFL_AP",c="?tenant=",d="onpremise",p=0,m=1,v=2,g=0,h=null,f={},S={platformServices:h,securityContexts:f,getCurrentTenantIndex:function(){if(!Array.isArray(h))throw new Error("Platform services have not been initialized correctly");var e=window.widget.getValue("x3dPlatformId"),r=-1;if(t.is(e,"string"))for(var s=0;s<h.length;s++)h[s].platformId===e&&(r=s);return-1===r?0:r},getSearchOptions:function(e){var r={title:"",role:"",mode:"furtive",default_with_precond:!0,precond:"",show_precond:!1,multiSel:!0,idcard_activated:!1,select_result_max_idcard:!1,itemViewClickHandler:"",app_socket_id:e.socket,widget_id:e.widget,search_delegation:"3dsearch",default_search_criteria:"",tenant:e.tenant};return r=t.merge(e||{},r)},getSecurityContexts:function(t){var r={method:"GET"};return r.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":widget.lang?widget.lang:widget.getValue("lang")},r.cache=-1,new e(function(e,s){r.onComplete=function(t){e(JSON.parse(t))},r.onFailure=function(e,t){var r=null;try{r=JSON.parse(t)}catch(e){}null===r&&(r=t),s(r)};var a=S.getCurrentTenantIndex(),n=h[a].platformId;i.authenticatedRequest(t+"/resources/modeler/pno/person?tenant="+n+"&current=true&select=preferredcredentials&select=collabspaces",r)}).then(function(e){var t=function(e,t,r){return"ctx::"+r+"."+t+"."+e},r=function(e,t,r){return""===t?e+" ● "+r:e+" ● "+t+" ● "+r},s=function(e){var t="",r="",s="",a="";for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];switch(n){case"organization":t=o.name,a=o.title?o.title:t;break;case"role":r=o.name,s=o.nls?o.nls:r}}return{org:t,role:r,roleNls:s,orgNls:a}},a="ctx:",n=e.pid,o=[],i="",u="",l="";for(var c in e.preferredcredentials)if(e.preferredcredentials.hasOwnProperty(c)){var d=e.preferredcredentials[c];switch(c){case"collabspace":i=d.name;break;case"organization":u=d.name;break;case"role":l=d.name}}a=t(i,u,l);var p=[];for(var m in e.collabspaces)if(e.collabspaces.hasOwnProperty(m))for(var v=e.collabspaces[m],h=0;h<v.couples.length;h++){var f=s(v.couples[h]);p.push(f.org)}var S=p.every(function(e,t,r){return e===r[p.length-1]});for(var y in e.collabspaces.sort((e,t)=>{let r=e.name.toLowerCase(),s=t.name.toLowerCase();return r<s?-1:r>s?1:0}),e.collabspaces)if(e.collabspaces.hasOwnProperty(y)){var b=e.collabspaces[y];b.couples.sort((e,t)=>e.organization.name.toLowerCase()>t.organization.name.toLowerCase()?1:e.organization.name.toLowerCase()===t.organization.name.toLowerCase()&&e.role.nls.toLowerCase()>t.role.nls.toLowerCase()?1:-1);for(var w=0;w<b.couples.length;w++){var C=s(b.couples[w]),T=t(b.name,C.org,C.role),F=b.title?b.title:b.name,I={csName:F,label:r(F,S?"":C.orgNls,C.roleNls),value:T,orgNls:C.orgNls,roleNls:C.roleNls};a===T&&(I.isDefault=!0),o.push(I)}}return""!==i&&""!==u&&""!==l||o.length>0&&(a=o[g].value),{userId:n,securityContext:a,cspaces:o}})}};return{_internals:S,initPlatformServices:function(){var r=this;if(null!==h)return e.resolve();var s=[];return new e(function(e,r){a.getGrantedRoles(function(r){r.forEach(function(e){"CSV"!==e.id&&"InternalDS"!==e.id||t.is(e.platforms,"array")&&(s=s.concat(e.platforms))}),e()})}).then(function(){return new e(function(e,t){a.getPlatformServices({onComplete:function(t){if(s.length>0){var a=[];t.forEach(function(e){s.includes(e.platformId)&&a.push(e)}),h=r._internals.platformServices=a}else h=r._internals.platformServices=t;e()},onFailure:function(e){t(e)}})})}).then(function(){return S.getSecurityContexts(r.get3DSpaceUrl())}).then(function(e){return f=r._internals.securityContexts=e,r})},isCloudEnvironment:function(){var e=!1,r=window.widget.getValue("x3dPlatformId");t.is(r,"string")&&""!==r&&(e=-1===r.toLowerCase().indexOf(d));return e},search:function(e){e=t.merge(e||{},{title:"",widget_id:window.widget.id,app_socket_id:window.widget.name+"_"+window.widget.id,default_search_criteria:"",tenant:this.getTenant()});var s=S.getSearchOptions(e),a=new r.Socket(s.app_socket_id,{dispatchRetryInterval:5});a.subscribeServer("SearchComServer"),a.dispatchEvent("RegisterContext",s),a.dispatchEvent("InContextSearch",s);var n=function(){},o=function(t){"function"==typeof e.callback&&e.callback.call(null,t),n()};a.addListener("Selected_Objects_search",o);var i=function(){"function"==typeof e.cancel&&e.cancel.call(null),n()};a.addListener("onCloseTransient",i),n=function(){a.dispatchEvent("UnregisterContext",{widget_id:s.widget_id}),a.unsubscribeServer("SearchComServer"),a.removeListener("Selected_Objects_search",o),a.removeListener("onCloseTransient",i),a.disconnect()}},getUserProfile:function(e){var t=this,r={mode:"panel",height:u.HEIGHT,width:u.WIDTH};require(["DS/TransientWidget/TransientWidget"],function(s){s.showWidget(l,"",{login:e,url:t.get3DSwymUrl()},r)})},getUserGroupProfile:function(e){var t=this,r=window.widget;require(["DS/i3DXRDFGroupViewer/js/GroupViewer"],function(a){var n=new a({platformId:t.getTenant(),groupId:e,language:r.lang,securityContext:t.getSecurityContext()});new s({animate:!0,autocenter:!1,closable:!0,limitParent:!0,overlay:!0,resizable:!0,visible:!0,minHeight:600,minWidth:450,persistId:"ISUGroupDialog",className:"group-viewer-dialog",title:"Group Viewer",header:null,body:n.render()}).inject(document.body)})},getCompassPubSub:function(){return n},get3DSearchUrl:function(){var e=S.getCurrentTenantIndex();if(void 0===h[e]["3DSearch"])throw new Error("No 3DSearch URL available for this tenant");return h[e]["3DSearch"]},get3DSpaceUrl:function(){var e=S.getCurrentTenantIndex();if(void 0===h[e]["3DSpace"])throw new Error("No 3DSpace URL available for this tenant");return h[e]["3DSpace"]},getUrlFromService:function(e){var t=S.getCurrentTenantIndex();if(void 0===h[t][e])throw new Error("No URL available for this service");return h[t][e]},get3DSwymUrl:function(){var e=S.getCurrentTenantIndex();return void 0===h[e]["3DSwym"]?"":h[e]["3DSwym"]},get3DCompassUrl:function(){var e=S.getCurrentTenantIndex();if(void 0===h[e]["3DCompass"])throw new Error("No 3DCompass URL available for this tenant");return h[e]["3DCompass"]},get3DDashboardUrl:function(){var e=S.getCurrentTenantIndex();if(void 0===h[e]["3DDashboard"])throw new Error("No 3DDashboard URL available for this tenant");return h[e]["3DDashboard"]},getPlatformUrl:function(){var e=S.getCurrentTenantIndex();if(void 0===h[e])throw new Error("No 3DDashboard URL available for this tenant");return h[e]},getSecurityContexts:function(){return f},getSecurityContext:function(){var e="",r=window.widget;if(r.hasPreference("pad_security_ctx")&&r.getPreference("pad_security_ctx")?e=r.getPreference("pad_security_ctx").value:null==(e=r.getValue("pad_security_ctx"))&&(e=this.getSecurityContexts().securityContext),t.is(e,"string")&&e.contains("ctx::")){var s=e.split("::");return encodeURIComponent(s[s.length-1])}return encodeURIComponent(e)},getTenants:function(){var e=[];for(var t in h)h.hasOwnProperty(t)&&e.push({label:h[t].displayName,value:h[t].platformId});return{platforms:e,tenant:this.getTenant()}},getTenant:function(){var e=S.getCurrentTenantIndex();return h[e].platformId},getCurrentCredentials:function(){var e=decodeURIComponent(this.getSecurityContext()),t=e.split(".");if(3!==t.length)return{role:"",organization:"",collaborativeSpace:""};let r={roleNls:void 0,orgNls:void 0};return f.cspaces.forEach(t=>{t.value=="ctx::"+e&&(r.orgNls=t.orgNls,r.roleNls=t.roleNls)}),{role:t[p],organization:t[m],collaborativeSpace:t[v],details:r}},getUserName:function(){return o.getUser().login},getFullName:function(){return o.getUser().firstName.trim()+" "+o.getUser().lastName.trim()},getUserImage:function(e,t){var r="";return t&&"mini"===t.format&&(r="/format/mini"),""!=this.get3DSwymUrl()?this.assembleURLFor3DSwym("/api/user/getpicture/login/"+e+r):""},getUserImageElement:function(e,r,s){var a,n,o=this;n=o.getUserImage(e.user,s),r="undefined"!=r&&r;var i="";i=void 0!==s&&void 0!==s.cssClass?""!=n?s.cssClass:s.cssClass+"-avatar":""!=n?"":"user-image-avatar";var u=void 0!==s&&void 0!==s.Title?s.Title:e.fullName+" ("+e.user+")";if(""!=n)a=t.createElement("img",{class:i,src:n,title:u}),r&&a.addEventListener("click",function(){o.getUserProfile(e.user)});else{var l=void 0!==e.fullName?e.fullName:e,c=o.getAvatarDetails(l);a=t.createElement("span",{class:i,styles:{background:c.avatarColor},title:u,html:c.avatarStr})}return a},getUserInfo:function(e,r){var s=t.clone(r);s.method="GET",s.headers={Accept:"application/json","Content-Type":"application/json",SecurityContext:this.getSecurityContext()},s.cache=-1,i.authenticatedRequest(this.assembleURLFor3DSpace("/resources/modeler/pno/person/"+e),s)},getUserGroupInfo:function(e,r){var s=t.clone(r);s.method="GET",s.headers={Accept:"application/json","Content-Type":"application/json",SecurityContext:this.getSecurityContext()},s.cache=-1,i.authenticatedRequest(this.assembleURLFor3DSpace("/resources/modeler/pno/group/"+e),s)},assembleURLFor3DSpace:function(e,r){var s="";if(t.is(r,"string")&&r.length>0){if("&"!==r.charAt(0))throw new Error("The parameters argument should start with &");s=r}else s="";var a="";return-1===e.indexOf(c)&&(a=c+this.getTenant()),this.get3DSpaceUrl()+e+a+s},assembleURLFor3DSwym:function(e,r){var s="";if(t.is(r,"string")&&r.length>0){if("&"!==r.charAt(0))throw new Error("The parameters argument should start with &");s=r}else s="";var a="";return-1===e.indexOf(c)&&(a=c+this.getTenant()),this.get3DSwymUrl()+e+a+s},getAvatarDetails:function(e){var t={},r=[[7,139,250],[249,87,83],[111,188,75],[158,132,106],[170,75,178],[26,153,123],[245,100,163],[255,138,46]],s=e.match(/\b\w/g),a=s[0].toUpperCase(),n=s[s.length-1].toUpperCase(),o=a+n,i=Math.ceil((a.charCodeAt(0)+n.charCodeAt(0))%r.length),u="rgb("+r[i][0]+","+r[i][1]+","+r[i][2]+")";return t.name=e,t.avatarStr=o,t.avatarColor=u,t}}}),define("DS/IssueServices/utils/Performance",["UWA/Class","DS/Logger/Logger"],function(e,t){"use strict";var r=1e4;return e.singleton({name:"DS/IssueServices/utils/Performance",_logger:null,_dumpRoutineInterval:null,init:function(){this._logger=t.getLogger("DS/IssueServices/Utils"),this._dumpRoutineInterval=null,window.performances={},window.performances.dump=this.dump,window.performances.clear=this.clear},start:function(e){window.performance.mark(e+"_start")},end:function(e){try{window.performance.mark(e+"_end"),window.performance.measure(e,e+"_start",e+"_end")}catch(t){this._logger.warn("The mark %s cannot be ended",e)}},dump:function(){try{for(var e=window.performance.getEntriesByType("measure"),t={},r=0;r<e.length;r++)void 0===t[e[r].name]?t[e[r].name]=e[r].duration:t[e[r].name]+=e[r].duration;var s=Object.keys(t).length;for(var a in 0===s?this._logger.info("No entries to be dumped for this interval"):this._logger.info("Dumping %s entries...",s),t)t.hasOwnProperty(a)&&this._logger.info("%s: %s ms",a,t[a])}catch(e){this._logger.warn("Dumping has failed unexpectedly: ",e.message)}},clear:function(){try{window.performance.clearMarks(),window.performance.clearMeasures()}catch(e){this._logger.warn("Clearing has failed unexpectedly: ",e.message)}},enableDumpRoutine:function(){var e=this;try{null!==e._dumpRoutineInterval&&e._logger.warn("A routine is already set, please disable it first"),e._dumpRoutineInterval=setInterval(function(){try{e._logger.info("Performance measured from %s %s for an interval of %s ms:",window.widget.name,window.widget.id,r),e.dump(),e.clear()}catch(t){e._logger.warn("Dumping routine interval has failed unexpectedly: ",t.message)}},r)}catch(t){e._logger.warn("Enabling dump routine has failed unexpectedly: ",t.message)}},disableDumpRoutine:function(){try{null!==this._dumpRoutineInterval&&(clearInterval(this._dumpRoutineInterval),this._dumpRoutineInterval=null)}catch(e){this._logger.warn("Disabling dump routine has failed unexpectedly: ",e.message)}}})}),define("DS/IssueServices/services/IssueServices",["UWA/Class/Promise","UWA/Core","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/WAFData/WAFData","DS/IssueServices/Contexts","DS/IssueServices/services/PlatformServices"],function(e,t,r,s,a,n){"use strict";var o={ISSUE_TYPE:"Issue",HEADER_ACCEPT_JSON:"application/json",HEADER_CONTENT_TYPE_JSON:"application/json",TEN_MINUTES:6e5,CACHE_LIMIT:5,FETCH_PREDICATES:["owner","organization","ds6w:project","ds6w:identifier","ds6w:label","ds6w:status","ds6w:type","ds6w:responsible","ds6w:state","ds6w:modified","ds6w:created","ds6wg:revision","ds6w:organizationResponsible","ds6wg:PLMReference.V_isLastVersion","lastrevision","description","ds6w:priority","ds6w:assignee","ds6w:contributor","ds5w:coordinator","ds6w:policy","ds6w:kind","ds6w:i3dx","ds6w:description","ds6w:responsibleUid","interface"],NLS_PREDICATES:["ds6w:type","ds6w:status","organization","ds6w:project"],NLS_PREDICATES_TITILE:{"ds6w:type":"ds6w:type","ds6w:status":"ds6w:status",organization:"ds6w:organizationResponsible","ds6w:project":"ds6w:project"},MAXIMUM_RECENT_OBJECTS:100,DELTA_TIME_RECENT_OBJECTS:300},i={getCurrentSecurityContext:function(){return n.getSecurityContext()},getCurrentTenant:function(){return n.getTenant()},isJson:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},getHeaderForJson:function(e){var r=e&&t.is(e.version,"string")?e.version:"1.0",s=a.get("widget")||window.widget,n=e&&t.is(e.securityContexts,"string")?e.securityContexts.replace("ctx::",""):i.getCurrentSecurityContext();return e&&0==e.encode?n=decodeURIComponent(i.getCurrentSecurityContext()):e&&1==e.encode&&null!=e.securityContexts&&(n=encodeURIComponent(n)),{Accept:"application/json","Content-Type":"application/json","Accept-Language":s.lang,"DS-API-Version":r,SecurityContext:"ctx::"+n}},getHeaderForSearch:function(e){var r=a.get("widget")||window.widget,s=e&&t.is(e.securityContexts,"string")?e.securityContexts.replace("ctx::",""):i.getCurrentSecurityContext();return e&&0==e.encode?s=decodeURIComponent(i.getCurrentSecurityContext()):e&&1==e.encode&&null!=e.securityContexts&&(s=encodeURIComponent(s)),{Accept:"application/json","Content-Type":"application/json","Accept-Language":r.lang,SecurityContext:"ctx::"+s}},setPromise:function(r){var s=t.clone(r.onComplete),a=t.clone(r.onFailure);return new e(function(e,n){r.onComplete=function(a){t.is(a,"object")&&"failure"==a.status&&n(a),t.is(a,"string")&&""!==a&&(a=JSON.parse(a)),!0===r.mustEmbedInBody&&(delete r.mustEmbedInBody,a={success:!0,body:a}),t.is(s,"function")&&s(a),e(a)},r.onFailure=function(e,s){t.is(s,"string")&&""!==s&&(s=JSON.parse(s)),!0===r.mustEmbedInBody&&(delete r.mustEmbedInBody,s={success:!1,body:s}),t.is(a,"function")&&a(s),n(s)}})}},u={recent:function(t){return new e(function(e,r){var u=a.get("widget")||window.widget,l=o.FETCH_PREDICATES;Array.isArray(t.predicates)&&(l=l.concat(t.predicates)),l.push("ds6w:responsibleUid");var c={label:u.name+"-"+n.getUserName()+"-"+Date.now(),nresults:o.MAXIMUM_RECENT_OBJECTS,delta_time_interval:o.DELTA_TIME_RECENT_OBJECTS,tenant:i.getCurrentTenant(),select_predicate:l,select_file:["icon","thumbnail_2d"]},d={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},timeout:o.TEN_MINUTES,onComplete:function(t){try{var s=JSON.parse(t);e(s)}catch(e){r(e)}},onFailure:r,data:JSON.stringify(c)},p=n.get3DSearchUrl()+"/recent?tenant="+i.getCurrentTenant()+"&_="+Date.now();s.authenticatedRequest(p,d)})},getRecentObjects:function(t){var r=this,s=t.predicates,a=t.physicalIds;return new e(function(e,t){r.recent({predicates:s}).then(function(t){var s=[];if(Array.isArray(t.results)){for(var n=0;n<t.results.length;n++){var o=r._getPhysicalId(t.results[n]);-1!==a.indexOf(o)&&s.push(t.results[n])}e(s)}else e([])}).catch(function(){e([])})})},federatedSearch:function(t){var r=this;let u=t.physicalIds;return new e(function(e,t){var l=a.get("widget")||window.widget,c=o.FETCH_PREDICATES,d=r.getQueryForFederatedSearch(u),p={label:l.name+"-"+n.getUserName()+"-"+Date.now(),query:d,nresults:50,tenant:i.getCurrentTenant(),select_predicate:c,login:{"3dspace":{SecurityContext:i.getCurrentSecurityContext()}}},m={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},timeout:o.TEN_MINUTES,onComplete:function(t){try{var r=JSON.parse(t);e(r)}catch(t){e([])}},onFailure:function(t){e([])},data:JSON.stringify(p)},v=n.get3DSearchUrl()+"/search?tenant="+i.getCurrentTenant()+"&_="+Date.now();s.authenticatedRequest(v,m)})},getQueryForFederatedSearch:function(e){let t="";for(let r=0;r<e.length;r++){let s='[ds6w:i3dx]:("'+e[r]+'")';r!=e.length-1&&(s+=" OR "),t+=s}return t},_getPhysicalId:function(e){for(var t="",r=0;r<e.attributes.length;r++){var s=e.attributes[r];"resourceid"===s.name&&(t=s.value)}return t},getMissingIdsOfFetch:function(e){var t=e.physicalIds,r=e.responseFromFetch,s={};try{s=JSON.parse(r)}catch(e){}if(Array.isArray(s.results)&&s.results.length===t.length)return{missingI3dxIds:[],missingRecentIds:[]};var a=[];if(Array.isArray(s.results)){var n=s.results.map(function(e){return u._getPhysicalId(e)});a=t.filter(function(e){return-1===n.indexOf(e)})}else a=t;var[o,i]=a.reduce((e,t)=>(e[t.includes("i3dx:")?0:1].push(t),e),[[],[]]);return{missingI3dxIds:o,missingRecentIds:i}},getDomainMapping:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({}),t.timeout=o.TEN_MINUTES,t.data=JSON.stringify(e);var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/related/domain",""),t),r},fetchbyService:function(e){let t=e.ids,r=e.url;var a={method:"POST"};a.headers=i.getHeaderForSearch({});var n={data:[]};t.forEach(e=>{var t={"ds6w:i3dx":e};n.data.push(t)}),a.timeout=o.TEN_MINUTES,a.data=JSON.stringify(n);var u=i.setPromise(a);return r=r+"?include=ds6w:kind,ds6w:icon,ds6wg:revision,ds6w:status,ds6w:responsibleUid,ds6w:previewURL&tenant="+i.getCurrentTenant(),s.authenticatedRequest(r,a),u}},l={internals:i,fetcher:u,search:function(r){var u={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}};if(u.timeout=o.TEN_MINUTES,!t.is(r.data,"object"))return e.reject(new Error('Invalid argument "options.data". Expected an Object.'));var l=a.get("widget")||window.widget,c=t.merge(t.clone(r.data),{label:l.name+"-"+n.getUserName()+"-"+Date.now(),nresults:100,start:0,tenant:i.getCurrentTenant()});u.data=JSON.stringify(c),u.mustEmbedInBody=!0;var d=i.setPromise(u);return s.authenticatedRequest(n.get3DSearchUrl()+"/search",u),d},fetch:function(l){var c={method:"POST"};c.headers=i.getHeaderForJson({version:l.version,encode:!1}),c.timeout=o.TEN_MINUTES;var d=l.data.objects.reduce(function(e,t){return e.push(t.physicalId),e},[]),p=o.FETCH_PREDICATES;Array.isArray(l.data.predicates)&&(p=p.concat(l.data.predicates));var m=a.get("widget")||window.widget,v={label:m.name+"-"+n.getUserName()+"-"+Date.now(),nresults:l.data.objects.length,physicalid:d,start:0,tenant:i.getCurrentTenant(),select_predicate:p};c.data=JSON.stringify(v);var g=t.clone(l.onComplete),h=t.clone(l.onFailure),f=new e(function(s,a){c.onComplete=function(a){var l=[],c=[],{missingI3dxIds:v,missingRecentIds:h}=u.getMissingIdsOfFetch({responseFromFetch:a,physicalIds:d}),f=v;u.getDomainMapping({uri:v}).then(function(r){var s=r.body.data,a=(Object.keys(s),[]);for(let r=0;r<s.length;r++){var o=s[r],i=o.service,l=o.uri,d=o.path;if(""!==d){var p=n.getUrlFromService(i)+d;f=f.filter(e=>!l.includes(e));var m=parseInt(l.length/50);l.length/50>parseInt(l.length/50)&&m++;for(let r=1;r<=m;r++){var v=l.map(function(e,t){if(t>=50*(r-1)&&t<50*r)return e}).filter(function(e){return void 0!==e});let s=new e((e,r)=>{u.fetchbyService({ids:v,url:p}).then(function(r){var s=[];r.data.forEach(e=>{var t=Object.keys(e),r={attributes:[]};t.forEach(t=>{var s="";switch(t){case"ds6w:icon":s="type_icon_url";break;case"ds6w:previewURL":s="preview_url";break;case"ds6wg:responsible":s="ds6w:responsible";break;case"ds6w:responsibleUid":s="owner";break;default:s=t}var a={name:s,value:e[t]};if(r.attributes.push(a),"i3dx"===t){a={name:"resourceid",value:e[t]};r.attributes.push(a)}}),s.push(r)}),e(t.clone(s))}).catch(function(){e([])})});a.push(s)}}}c=c.concat(a)}).catch(function(e){}).finally(function(){if(h.length>0){var n=new e((e,r)=>{u.getRecentObjects({predicates:p,physicalIds:h}).then(function(r){e(t.clone(r))}).catch(function(){e([])})});c.push(n)}var d=[],v=parseInt(f.length/50);f.length/50>parseInt(f.length/50)&&v++;for(let r=1;r<=v;r++){var S=f.map(function(e,t){if(t>=50*(r-1)&&t<50*r)return e}).filter(function(e){return void 0!==e});let s=new e((e,r)=>{u.federatedSearch({physicalIds:S}).then(function(r){e(t.clone(r.results))}).catch(function(){e([])})});d.push(s)}c=c.concat(d);var y=[];e.all(c).then(e=>{e.forEach(e=>{Array.isArray(e)&&(y=y.concat(e))})},function(e){}).finally(function(){t.is(a,"string")&&""!==a&&(l=JSON.parse(a)),Array.isArray(l.results)||(l.results=[],l.infos={nhits:0,nresults:0}),y.forEach(e=>{l.results.push(e),l.infos.nhits+=1,l.infos.nresults+=1}),l={success:!0,body:l};var e={};if(Array.isArray(l.body.results)&&l.body.results.length)for(var n=t.clone(l.body.results),u=0;u<n.length;u++)if(Array.isArray(n[u].attributes)&&n[u].attributes.length)for(var c=n[u].attributes,d=c.find(e=>"sourceid"==e.name),p=d?d.value.split(":")[0]:"3dspace",v=0;v<c.length;v++){var h=n[u].attributes[v],f=t.is(h.name,"string")?h.name.replace("ds6w:what/","").replace("ds6w:when/","").replace("ds6w:who/",""):h.name;if(-1!==o.NLS_PREDICATES.indexOf(f)){let t=o.NLS_PREDICATES_TITILE[f];if(e.hasOwnProperty(t)||(e[t]=[]),-1===e[t].indexOf(h.value)){var S={};S.value=h.value,S.source=[p],e[t].push(S)}}}r.getNlsOfPropertiesValuesBySource(e,{tenantId:i.getCurrentTenant(),lang:m.lang,onComplete:function(e){if(Array.isArray(l.body.results)&&l.body.results.length)for(var r=l.body.results,a=0;a<r.length;a++)if(Array.isArray(r[a].attributes)&&r[a].attributes.length)for(var n=r[a].attributes,i=0;i<n.length;i++){var u=r[a].attributes[i],c=t.is(u.name,"string")?u.name.replace("ds6w:what/","").replace("ds6w:when/","").replace("ds6w:who/",""):u.name;t.is(o.NLS_PREDICATES_TITILE[c])&&e.hasOwnProperty(o.NLS_PREDICATES_TITILE[c])&&e[o.NLS_PREDICATES_TITILE[c]].hasOwnProperty(u.value)&&(u.dispValue=e[o.NLS_PREDICATES_TITILE[c]][u.value])}t.is(g,"function")&&g(l),s(l)},onFailure:function(){t.is(g,"function")&&g(l),s(l)}})})})},c.onFailure=function(e){t.is(e,"string")&&""!==e&&(e=JSON.parse(e)),e={success:!1,body:e},t.is(h,"function")&&h(e),a(e)}});return s.authenticatedRequest(n.assembleURLFor3DSpace("/cvservlet/fetch/v2"),c),f},getNLSValuesPromise:function(t){return new e(function(e,s){null!=t?r.getNlsOfPropertiesValues(JSON.stringify(t),{tenantId:i.getCurrentTenant(),lang:widget.lang,onComplete:function(t){e(t)},onFailure:function(e){s(e)}}):e()})},recent:u.recent,comments:{retrieve:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES,t.onComplete=e.onComplete,t.onFailure=e.onFailure,t.mustEmbedInBody=!0;var r=i.setPromise(t),a="/resources/commentproxy/subjects/pid:"+e.data.physicalId+"/contributions";return s.authenticatedRequest(n.assembleURLFor3DSpace(a,"&page_number=0&page_size=8&total_pages=0&sort_by=time&order_by=reverse_time"),t),r},notify:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.data=JSON.stringify(e.data),t.timeout=o.TEN_MINUTES,t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t),a=n.assembleURLFor3DSpace("/resources/issues/notify","");return s.authenticatedRequest(a,t),r}},custom:{getCustomAttributes:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES,t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t),a=n.assembleURLFor3DSpace("/resources/issues/custom/attributes","");return void 0!==e.subType&&(a=a+"&subType="+e.subType),s.authenticatedRequest(a,t),r}},export:{pptx:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),delete t.headers.Accept,t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"GET",url:"resources/issues/"+e.data.objects[a].physicalId+"/export/pptx"});t.data=JSON.stringify({requests:r}),t.responseType="arraybuffer",t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/export/batch",""),t),u}},getRevisions:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES,t.data=JSON.stringify(e.data),t.onComplete=e.onComplete,t.onFailure=e.onFailure,t.mustEmbedInBody=!0;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/v1/dslc/versiongraph","&withIsLastVersion=1"),t),r},images:{retrieve:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"GET",url:"resources/issues/"+e.data.objects[a].physicalId+"/images/primary"});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},update:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"PUT",url:"resources/issues/"+e.data.objects[a].physicalId+"/images/primary",body:e.data.objects[a]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},delete:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"PUT",url:"resources/issues/"+e.data.objects[a].physicalId+"/images/primary",body:e.data.objects[a]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u}},issues:{filter:function(e){var r={method:"GET"};r.headers=i.getHeaderForJson({version:e.version}),r.timeout=o.TEN_MINUTES;var u=a.get("widget")||window.widget,c=a.get("component"),d=e.data.filter,p=[];if(!e.data.isFilterChange&&t.is(c.getSessionOrFilteredRoots,"function")?p=c.getSessionOrFilteredRoots():!0===d.session&&(p=u.getValue("roots")),p.length>0||!0===d.synchronize)return l.issues.retrieve({data:{objects:p.map(function(e){return{physicalId:e}})}}).then(function(e){return{success:!0,body:e.results.map(function(e){return e.body})}},function(e){return{success:!1,body:e}});var m="";["owned","assigned","reported","responsible","contributed","closed","onlyids","affectedItem","resolvedItem","context"].forEach(function(e){d[e]&&t.is(d[e],"boolean")?m+="&"+e+"="+d[e]:m+="&"+e+"=false"});var v=void 0===u.getValue("selectedContext")||""===u.getValue("selectedContext")?"":u.getValue("selectedContext").id;t.is(v,"string")&&v.length>0&&(m+="&selectedContext="+v);var g=u.getValue("defaultFilterForAll");t.is(g,"string")&&g.length>0&&(m+="&defaultFilterForAll="+g),e.data.customAttrInfo&&(r.data=JSON.stringify({attribute:e.data.customAttrInfo})),r.onComplete=e.onComplete,r.onFailure=e.onFailure;var h=i.setPromise(r);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues",m),r),h},customAttrFilter:function(e){var r={method:"POST"};r.headers=i.getHeaderForJson({version:e.version}),r.timeout=o.TEN_MINUTES;var u=a.get("widget")||window.widget,c=a.get("component"),d=e.data.filter,p=[];if(!e.data.isFilterChange&&t.is(c.getSessionOrFilteredRoots,"function")?p=c.getSessionOrFilteredRoots():!0===d.session&&(p=u.getValue("roots")),p.length>0||!0===d.synchronize)return l.issues.retrieve({data:{objects:p.map(function(e){return{physicalId:e}})}}).then(function(e){return{success:!0,body:e.results.map(function(e){return e.body})}},function(e){return{success:!1,body:e}});var m="";["owned","assigned","reported","responsible","contributed","closed","affectedItem","resolvedItem","context"].forEach(function(e){d[e]&&t.is(d[e],"boolean")?m+="&"+e+"="+d[e]:m+="&"+e+"=false"});var v=u.getValue("selectedContext");t.is(v,"string")&&v.length>0&&(m+="&selectedContext="+v);var g=u.getValue("defaultFilterForAll");t.is(g,"string")&&g.length>0&&(m+="&defaultFilterForAll="+g),e.data.customAttrInfo&&(r.data=JSON.stringify({attribute:e.data.customAttrInfo,indexed:!1,output:"attribute"})),r.onComplete=e.onComplete,r.onFailure=e.onFailure;var h=i.setPromise(r);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/filtered",m),r),h},create:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version,securityContexts:e.data.securityContexts,encode:!0}),t.timeout=o.TEN_MINUTES,t.data=JSON.stringify(e.data),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues",""),t),r},retrieve:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"GET",url:"resources/issues/"+e.data.objects[a].physicalId});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},update:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"PUT",url:"resources/issues/"+e.data.objects[a].physicalId,body:e.data.objects[a]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},delete:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;var r={data:[],options:[]};e.data.objects.forEach(function(e){r.data.push({physicalid:e.physicalId})}),t.data=JSON.stringify(r),t.type="json",t.onComplete=e.onComplete,t.onFailure=e.onFailure,t.mustEmbedInBody=!0;var a=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/lifecycle/Delete/structure/",""),t),a},promote:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"PUT",url:"resources/issues/"+e.data.objects[a].physicalId+"/promotion",body:e.data.objects[a]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},demote:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES,t.method="POST",t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"PUT",url:"resources/issues/"+e.data.objects[a].physicalId+"/demotion",body:e.data.objects[a]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},close:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"PUT",url:"resources/issues/"+e.data.objects[a].physicalId+"/closure",body:e.data.objects[a]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},reopen:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"PUT",url:"resources/issues/"+e.data.objects[a].physicalId+"/reopener",body:e.data.objects[a]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},duplicate:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"POST",url:"resources/issues/"+e.data.objects[a].physicalId+"/duplication",body:e.data.objects[a]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},getMaturityGraph:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson(),t.headers["Content-Type"]="application/json",t.data=JSON.stringify({data:[{physicalid:e.data.id}]}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t),a="/resources/lifecycle/maturity/getStateGraph?tenant="+i.getCurrentTenant();return s.authenticatedRequest(n.assembleURLFor3DSpace(a,""),t),r},getIssueMaturityGraph:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES,t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t),a="/resources/issues/maturityGraph?tenant="+i.getCurrentTenant();return s.authenticatedRequest(n.assembleURLFor3DSpace(a,""),t),r},enableApproval:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version,securityContexts:e.data.securityContexts,encode:!0}),t.timeout=o.TEN_MINUTES,t.data=JSON.stringify(e.data),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/enableApproval",""),t),r},disableApproval:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version,securityContexts:e.data.securityContexts,encode:!0}),t.timeout=o.TEN_MINUTES,t.data=JSON.stringify(e.data),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/disableApproval",""),t),r},getStatesAttributes:function(e){var r={method:"POST"};r.headers=i.getHeaderForJson(),r.headers["Content-Type"]="application/json",e=t.is(e)?e:{};var a=(t.is(e.data),e.data);r.data=JSON.stringify(a),r.onComplete=e.onComplete,r.onFailure=e.onFailure;var o=i.setPromise(r),u="/resources/lifecycle/maturity/getStatesAttributes?tenant="+i.getCurrentTenant();return s.authenticatedRequest(n.assembleURLFor3DSpace(u,""),r),o}},organizations:{getCompanies:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES,t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/organizations",""),t),r}},people:{retrieve:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"GET",url:"resources/issues/"+e.data.objects[a].physicalId+"/people"});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},update:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"PUT",url:"resources/issues/"+e.data.objects[a].physicalId+"/people",body:e.data.objects[a]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},delete:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"DELETE",url:"resources/issues/"+e.data.objects[a].physicalId+"/people",body:e.data.objects[a]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u}},preferences:{get:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES,t.data=e.data;var r="/resources/AppsMngt/user/getPreferences",a="";!0===n.isCloudEnvironment()?(a=n.get3DCompassUrl()+r,delete t.headers.SecurityContext):a=n.assembleURLFor3DSpace(r),t.onComplete=e.onComplete,t.onFailure=e.onFailure,t.mustEmbedInBody=!0;var u=i.setPromise(t);return s.authenticatedRequest(a,t),u},set:function(e){var t={method:"PUT"};t.headers=i.getHeaderForJson({version:e.version}),t.headers["Content-Type"]="application/x-www-form-urlencoded",t.timeout=o.TEN_MINUTES,t.data=e.data;var r="/resources/AppsMngt/user/preference",a="";!0===n.isCloudEnvironment()?(a=n.get3DCompassUrl()+r,delete t.headers.SecurityContext):a=n.assembleURLFor3DSpace(r),t.onComplete=e.onComplete,t.onFailure=e.onFailure,t.mustEmbedInBody=!0;var u=i.setPromise(t);return s.authenticatedRequest(a,t),u},getApprovalEnablement:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES,t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/getIssueApproval"),t),r},getServerSettings:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES,t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/getServerSettings"),t),r}},related:{retrieve:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"GET",url:"resources/issues/"+e.data.objects[a].physicalId+"/related"});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},update:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"PUT",url:"resources/issues/"+e.data.objects[a].physicalId+"/related",body:e.data.objects[a]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},delete:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"DELETE",url:"resources/issues/"+e.data.objects[a].physicalId+"/related",body:e.data.objects[a]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u}},routes:{retrieve:function(t){if(t.data&&null!=t.data.validationColumnVisibility&&1!=t.data.validationColumnVisibility)return e.resolve("validationColumnInvisible");var r={method:"POST"};r.headers=i.getHeaderForJson({version:t.version}),r.timeout=o.TEN_MINUTES;for(var a=[],u=0;u<t.data.objects.length;u++)a.push({id:u,method:"GET",url:"resources/issues/"+t.data.objects[u].physicalId+"/routes"});r.data=JSON.stringify({requests:a}),r.onComplete=t.onComplete,r.onFailure=t.onFailure;var l=i.setPromise(r);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),r),l},retrieveTasks:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"GET",url:"resources/issues/"+e.data.objects[a].physicalId+"/tasks"});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},approve:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"PUT",url:"resources/issues/"+e.data.objects[a].physicalId+"/routes/approval",body:{comment:e.data.objects[a].comment,action:e.data.objects[a].action}});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u},reject:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=0;a<e.data.objects.length;a++)r.push({id:a,method:"PUT",url:"resources/issues/"+e.data.objects[a].physicalId+"/routes/rejection",body:{reason:e.data.objects[a].reason,action:e.data.objects[a].action}});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var u=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),u}},templates:{getTemplates:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES,t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t),a=n.assembleURLFor3DSpace("/resources/issues/templates","");return s.authenticatedRequest(a,t),r},createTemplate:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version,securityContexts:e.data.data.securityContexts,encode:!0}),t.timeout=o.TEN_MINUTES,t.data=JSON.stringify(e.data),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/templates",""),t),r},editTemplate:function(e){var t={method:"PUT"};t.headers=i.getHeaderForJson({version:e.version,encode:!0}),t.timeout=o.TEN_MINUTES;var r=e.data.id;t.data=JSON.stringify(e.data),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var a=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/templates/"+r,""),t),a},getCustomAttributes:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES,e.data.customAttrInfo&&(t.data=JSON.stringify({attribute:e.data.customAttrInfo,indexed:!1,output:"attribute"})),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/templates/attributes/"),t),r},retrieve:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;var r=e.data.objects.physicalId;t.onComplete=e.onComplete,t.onFailure=e.onFailure;var a=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/templates/"+r,""),t),a},promoteTemplate:function(e,t){var r={method:"PUT"};r.headers=i.getHeaderForJson({version:e.version,securityContexts:t.data.securityContexts,encode:!0}),r.timeout=o.TEN_MINUTES;var a=e.issueId;r.onComplete=e.onComplete,r.onFailure=e.onFailure;var u=i.setPromise(r);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/templates/"+a+"/promote"),r),u},changeTemplateOwner:function(e,t){var r={method:"PUT"};r.headers=i.getHeaderForJson({version:e.version,securityContexts:t.data.securityContexts,encode:!0}),r.timeout=o.TEN_MINUTES;var a=e.issueId;r.data=JSON.stringify(t.data.owner),r.onComplete=e.onComplete,r.onFailure=e.onFailure;var u=i.setPromise(r);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/templates/"+a+"/changeowner"),r),u},deleteDocument:function(e){var t={method:"DELETE"};t.headers=i.getHeaderForJson({version:e.version,encode:!0}),t.timeout=o.TEN_MINUTES,t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/templates/document/"+e.data),t),r},getMembers:function(r){var a={method:"POST"};(r=t.is(r)?r:{}).isfederated=!0,a.headers=i.getHeaderForSearch({encode:!0});let o=r.user,u=r.userGroup;var l="",c="";"OnPremise"==n.getTenant()?(o.length>0&&(l='([ds6w:type]:"Person" AND (',o.forEach((e,t,r)=>{l=t!=r.length-1?l+"[ds6w:identifier]:("+e.user+") OR ":l+"[ds6w:identifier]:("+e.user+")) AND "}),l+='policycurrent:"Person.Active")'),u.length>0&&(c='([ds6w:type]:"Group" AND (',u.forEach((e,t,r)=>{c=t!=r.length-1?c+'groupuri:("'+e.user+'") OR ':c+'groupuri:("'+e.user+'")) AND '}),c+='current:"Active")')):(o.length>0&&(l='([ds6w:type]:"Person" AND (',o.forEach((e,t,r)=>{l=t!=r.length-1?l+"[ds6w:identifier]:("+e.user+") OR ":l+"[ds6w:identifier]:("+e.user+")) AND "}),l+='policycurrent:"Person.Active")'),u.length>0&&(c='([ds6w:type]:"foaf:Group" AND (',u.forEach((e,t,r)=>{c=t!=r.length-1?c+'[ds6w:resourceUid]:("'+e.user+'") OR ':c+'[ds6w:resourceUid]:("'+e.user+'")))'})));var d={with_indexing_date:!0,with_nls:!1,label:"isu-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname","groupuri","ds6w:resourceUid"],select_file:["icon","thumbnail_2d"],query:""!=l&&""!=c?l+" OR "+c:""!=l&&""==c?l:c,order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:n.getTenant()};a.data=JSON.stringify(d);var p=new e(function(e,t){a.onComplete=function(t){t=JSON.parse(t);var r=[];t&&t.results&&Array.isArray(t.results)&&t.results.forEach(function(e){var t={},s=e.attributes,a="",o="";"OnPremise"==n.getTenant()?(s.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(t.type=e.value),"resourceid"===e.name&&(t.id=e.value),"ds6w:identifier"===e.name&&(t.identifier=e.value),"ds6wg:fullname"===e.name&&(t.name=e.value),"ds6w:label"===e.name&&(a=e.value),"type_icon_url"===e.name&&(t.icon=e.value),"groupuri"===e.name&&(o=e.value)}),"Group"===t.type&&(t.name=a,t.identifier=o)):(s.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(t.type=e.value,t.type.includes("foaf")&&(t.type=t.type.slice(5))),"resourceid"===e.name&&(t.id=e.value),"ds6w:identifier"===e.name&&(t.identifier=e.value),"ds6wg:fullname"===e.name&&(t.name=e.value),"ds6w:label"===e.name&&(a=e.value),"type_icon_url"===e.name&&(t.icon=e.value),"ds6w:resourceUid"===e.name&&(o=e.value)}),"Group"===t.type&&(t.name=a,t.identifier=o)),r.push(t)});e(r)},a.onFailure=function(e){t(e)}});return s.authenticatedRequest(n.get3DSearchUrl()+"/search",a),p}},classification:{getLibraries:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson(),t.timeout=o.TEN_MINUTES;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/v1/modeler/dslib/dslib:Library/search","&$mask=dslib:LibraryDetailsMask&$top=1000"),t),r},getClasses:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson(),t.timeout=o.TEN_MINUTES;var r=i.setPromise(t),a="/resources/v1/modeler/dslib/dslib:Library/"+e.libId;return s.authenticatedRequest(n.assembleURLFor3DSpace(a,"&$mask=dslib:ExpandClassesDetailsMask&$depth=20"),t),r},getClassIds:function(e){var r={method:"GET"};r.headers=i.getHeaderForJson({version:e.version}),r.timeout=o.TEN_MINUTES;var u=a.get("widget")||window.widget,c=a.get("component"),d=e.data.filter,p=[];if(!e.data.isFilterChange&&t.is(c.getSessionOrFilteredRoots,"function")?p=c.getSessionOrFilteredRoots():!0===d.session&&(p=u.getValue("roots")),p.length>0||!0===d.synchronize)return l.issues.retrieve({data:{objects:p.map(function(e){return{physicalId:e}})}}).then(function(e){return{success:!0,body:e.results.map(function(e){return e.body})}},function(e){return{success:!1,body:e}});var m="";["owned","assigned","reported","responsible","contributed","closed"].forEach(function(e){d[e]&&t.is(d[e],"boolean")?m+="&"+e+"="+d[e]:m+="&"+e+"=false"});var v=u.getValue("defaultFilterForAll");t.is(v,"string")&&v.length>0&&(m+="&defaultFilterForAll="+v),e.data.customAttrInfo&&(r.data=JSON.stringify({attribute:e.data.customAttrInfo})),r.onComplete=e.onComplete,r.onFailure=e.onFailure;var g=i.setPromise(r);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/classification/getclassids",m),r),g},getClassificationAttributesOfClass:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson(),t.timeout=o.TEN_MINUTES,t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t),a="/resources/v1/modeler/dslib/dslib:Class/"+e.id;return s.authenticatedRequest(n.assembleURLFor3DSpace(a,"&$mask=dslib:ClassAttributesMask"),t),r},getClassificationAttributesOfClassifiedItem:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson(),t.timeout=o.TEN_MINUTES,t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t),a="/resources/v1/modeler/dslib/dslib:ClassifiedItem/"+e.issueId;return s.authenticatedRequest(n.assembleURLFor3DSpace(a,"&$mask=dslib:ClassificationAttributesMask"),t),r},getcsrf:function(e){var t={method:"GET"};t.headers=i.getHeaderForJson(),t.timeout=o.TEN_MINUTES;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/v1/application/CSRF",""),t),r},classify:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.headers.ENO_CSRF_TOKEN=e.token,t.timeout=o.TEN_MINUTES;var r={ClassID:e.classID,ObjectsToClassify:[{identifier:e.issueID,relativePath:"/"+e.issueID}]};t.data=JSON.stringify(r),t.type="json",t.onComplete=e.onComplete,t.onFailure=e.onFailure,t.async=!1,t.mustEmbedInBody=!0;var a=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/v1/modeler/dslib/dslib:ClassifiedItem","&$nonPublicResource=true"),t),a},deClassify:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.headers.ENO_CSRF_TOKEN=e.token,t.timeout=o.TEN_MINUTES;var r={ClassID:e.classID,ObjectsToDeclassify:[{identifier:e.issueID,relativePath:"/"+e.issueID}]};t.data=JSON.stringify(r),t.type="json",t.onComplete=e.onComplete,t.onFailure=e.onFailure,t.async=!1,t.mustEmbedInBody=!0;var a=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/v1/modeler/dslib/dslib:ClassifiedItem/remove","&$nonPublicResource=true"),t),a},setClassificationAttributes:function(e){var t={method:"PATCH"};t.headers=i.getHeaderForJson({version:e.version}),t.headers.ENO_CSRF_TOKEN=e.csrf,t.timeout=o.TEN_MINUTES;var r=e.attributes;r.cestamp=e.cestamp,t.data=JSON.stringify(r),t.type="json",t.onComplete=e.onComplete,t.onFailure=e.onFailure,t.mustEmbedInBody=!0;var a=i.setPromise(t),u="/resources/v1/modeler/dslib/dslib:ClassifiedItem/"+e.issueId;return s.authenticatedRequest(n.assembleURLFor3DSpace(u,""),t),a},retrieve:function(e){var t={method:"POST"};t.headers=i.getHeaderForJson({version:e.version}),t.timeout=o.TEN_MINUTES;for(var r=[],a=Object.keys(e.data.objects),u=0;u<a.length;u++)r.push({id:u,method:"GET",url:"resources/issues/"+a[u]+"/classification",body:e.data.objects[a[u]]});t.data=JSON.stringify({requests:r}),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var l=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/issues/batch",""),t),l}},getTypesHierarchy:function(e){var t={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}},r={types:e.types};t.data=JSON.stringify(r),t.onComplete=e.onComplete,t.onFailure=e.onFailure;var a=i.setPromise(t),o="/resources/enong/dico/gettypeshierarchy?tenant="+i.getCurrentTenant();return s.authenticatedRequest(n.assembleURLFor3DSpace(o,""),t),a},getExpressionValue:function(e){var t={method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}};t.onComplete=e.onComplete,t.onFailure=e.onFailure;var r=i.setPromise(t);return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/v2/e6w/service/ExpresssionSearch/ISU*",""),t),r},type:{getSubType:function(e){var r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}};e=t.is(e)?e:{};var a=t.is(e.types,"object")?e.types:[o.ISSUE_TYPE];r.data=JSON.stringify(a),r.onComplete=e.onComplete,r.onFailure=e.onFailure;var u=i.setPromise(r),l="/resources/dictionary/getTypeInfo?tenant="+i.getCurrentTenant();return s.authenticatedRequest(n.assembleURLFor3DSpace(l,""),r),u},getClassExtensionInterface:function(t){return new e(function(e,s){let a={tenantId:i.getCurrentTenant(),lang:"en",onComplete:function(t){e(t)},onFailure:function(t){e(t)}};r.getExtensionsForClass(t,a)})},getProperties:function(t){var s=a.get("widget")||window.widget;return new e(function(e,a){let n={tenantId:i.getCurrentTenant(),lang:s.lang,onComplete:function(t){e(t)},onFailure:function(t){e(t)}};r.getPropertiesForClass(t,n)})},getSubTypeAttributes:function(e){var t={method:"GET",headers:{Accept:"application/json"}},r=e.type;t.onComplete=e.onComplete,t.onFailure=e.onFailure;var a=i.setPromise(t),o="/resources/dictionary/class/"+r+"/attributes?inherited=false&info=true&tenant="+i.getCurrentTenant();return s.authenticatedRequest(n.assembleURLFor3DSpace(o,""),t),a},getSubTypesAllAttributes:function(e){var t={method:"GET",headers:{Accept:"application/json"}},r=e.type;t.onComplete=e.onComplete,t.onFailure=e.onFailure;var a=i.setPromise(t),o="/resources/dictionary/class/"+r+"/attributes?inherited=true&info=true&tenant="+i.getCurrentTenant();return s.authenticatedRequest(n.assembleURLFor3DSpace(o,""),t),a},getSubTypesAttributes:function(e){var r={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}};e=t.is(e)?e:{};var a={classes:t.is(e.types,"array")?e.types:[o.ISSUE_TYPE]};r.data=JSON.stringify(a),r.onComplete=e.onComplete,r.onFailure=e.onFailure;var u=i.setPromise(r),l="/resources/dictionary/class/properties?inherited=false&info=true&tenant="+i.getCurrentTenant();return s.authenticatedRequest(n.assembleURLFor3DSpace(l,""),r),u}},getMembers:function(r){var a={method:"POST"};(r=t.is(r)?r:{}).isfederated=!0,a.headers=i.getHeaderForSearch({encode:!0});var o=r.text,u={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname"],select_file:["icon","thumbnail_2d"],query:"OnPremise"==n.getTenant()?'((([ds6w:type]:"Person" AND [ds6w:identifier]:(*'+o+'*)) OR ([ds6w:type]:"Person" AND [ds6wg:fullname]:(*'+o+'*)) OR ([ds6w:type]:"Person" AND [firstname]:(*'+o+'*)) OR ([ds6w:type]:"Person" AND [lastname]:(*'+o+'*))) AND policycurrent:"Person.Active") OR ((([ds6w:type]:"Group" AND [ds6w:label]:(*'+o+'*))) AND current:"Active")':'((([ds6w:type]:"Person" AND [ds6w:identifier]:(*'+o+'*)) OR ([ds6w:type]:"Person" AND [ds6wg:fullname]:(*'+o+'*))) AND policycurrent:"Person.Active") OR ([ds6w:type]:"foaf:Group" AND [ds6w:label]:(*'+o+"*))",order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:n.getTenant()};a.data=JSON.stringify(u);var l=new e(function(e,t){a.onComplete=function(t){t=JSON.parse(t);var r=[];t&&t.results&&Array.isArray(t.results)&&t.results.forEach(function(e){var t={},s=e.attributes,a="";"OnPremise"==n.getTenant()?(s.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(t.type=e.value),"resourceid"===e.name&&(t.id=e.value),"ds6w:identifier"===e.name&&(t.identifier=e.value),"ds6wg:fullname"===e.name&&(t.name=e.value),"ds6w:label"===e.name&&(a=e.value),"type_icon_url"===e.name&&(t.icon=e.value)}),"Group"===t.type&&(t.name=a,t.identifier=a)):(s.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(t.type=e.value,t.type.includes("foaf")&&(t.type=t.type.slice(5))),"resourceid"===e.name&&(t.id=e.value),"ds6w:identifier"===e.name&&(t.identifier=e.value),"ds6wg:fullname"===e.name&&(t.name=e.value),"ds6w:label"===e.name&&(a=e.value),"type_icon_url"===e.name&&(t.icon=e.value)}),"Group"===t.type&&(t.name=a,t.identifier=a)),r.push(t)});e(r)},a.onFailure=function(e){t(e)}});return s.authenticatedRequest(n.get3DSearchUrl()+"/search",a),l},getAdditionalObjectInfo:function(r){var a={method:"POST"};r=t.is(r)?r:{},a.headers={Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"};var o=r.pidArray.toString();a.data="$ids="+o;var i=new e(function(e,r){a.onComplete=function(r){var s;r=JSON.parse(r);var a=new Object;t.is(r)&&t.is(r.data)&&r.data.forEach(function(e){var t="";e.dataelements.firstname&&e.dataelements.lastname&&(t=e.dataelements.firstname+" "+e.dataelements.lastname),(s=new Object).pid=e.id,s.type=e.type,s.typeNLS=e.dataelements.typeNLS,s.objectName=e.dataelements.name,s.revision=e.dataelements.revision,s.objectTitle=e.dataelements.title,s.icon=e.dataelements.icon,s.image=e.dataelements.image,s.fileExtension=e.dataelements.fileExtension,s.policy=e.dataelements.policy,s.collabSpace=e.dataelements.collabSpace,s.collabSpaceTitle=e.dataelements.collabSpaceTitle,s.organizationTitle=e.dataelements.organizationTitle,s.ownerFullname=e.dataelements.ownerFullname,s.fullName=t,s.synopsis=e.dataelements.synopsis,s.revision=e.dataelements.revision,s.stateNLS=e.dataelements.stateNLS,a[e.id]=s});var n={};n.additionObjectInfo=a,e(n)},a.onFailure=function(e){r(e)}});return s.authenticatedRequest(n.assembleURLFor3DSpace("/resources/v2/e6w/service/ObjectInfo","&$fields=ownerFullname,collabSpace,collabSpaceTitle,policy,icon,image,synopsis,functionalname,organization,organizationTitle"),a),i},getRelatedObjects:function(r){var a={method:"POST"};(r=t.is(r)?r:{}).isfederated=!0,a.headers=i.getHeaderForSearch({encode:!0});var o=r.text,u={with_indexing_date:!0,with_nls:!1,label:"isu-related",locale:"en",select_predicate:["ds6w:label","resourceid","ds6w:identifier","ds6w:type","ds6wg:revision","type_icon_url","sourceid","ds6w:kind","ds6w:i3dx"],select_file:["icon","thumbnail_2d"],query:"[ds6w:label]:(*"+o+"*) OR [ds6w:identifier]:(*"+o+"*)",order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:n.getTenant()};a.data=JSON.stringify(u);var l=new e(function(e,t){a.onComplete=function(t){t=JSON.parse(t);var r=[];t&&t.results&&Array.isArray(t.results)&&t.results.forEach(function(e){var t={};e.attributes.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(t.type=e.value),"ds6w:i3dx"===e.name&&(t.id=e.value),"resourceid"===e.name&&null==t.id&&(t.id=e.value),"ds6w:identifier"===e.name&&(t.identifier=e.value),"ds6w:label"===e.name&&(t.label=e.value),"ds6wg:revision"===e.name&&(t.revision=e.value),"type_icon_url"===e.name&&(t.icon=e.value),"sourceid"===e.name&&(t.serviceId=e.value),"ds6w:what/ds6w:kind"===e.name&&(t.kind=e.value)}),r.push(t)});e(r)},a.onFailure=function(e){t(e)}});return s.authenticatedRequest(n.get3DSearchUrl()+"/search",a),l}};return l}),define("DS/IssueServices/utils/Views",["DS/i3DXCompassPlatformServices/OpenWith","DS/IssueServices/Contexts","DS/IssueServices/services/PlatformServices"],function(e,t,r){"use strict";return{getOpenWith:function(){return new e},getCompassPubSub:function(){return r.getCompassPubSub()}}}),define("DS/IssueServices/services/SwymServices",["UWA/Class/Promise","UWA/Core","DS/WAFData/WAFData","DS/IssueServices/Contexts","DS/IssueServices/services/PlatformServices"],function(e,t,r,s,a){"use strict";var n={getToken:function(){var n=s.get("widget")||window.widget;return new e(function(e,s){var o=a.assembleURLFor3DSwym("/api/index/tk"),i={method:"GET",headers:{}};i.headers.Accept="application/json",i.headers["Content-Type"]="application/json",i.headers["Accept-Language"]=n.lang,i.onComplete=function(r){var s;s=t.is(r,"string")?JSON.parse(r).result:r.result,e(s.ServerToken)},i.onFailure=function(e){var r;r=t.is(e,"string")?JSON.parse(e):e,s(r)},r.authenticatedRequest(o,i)})},find:function(o){var i=s.get("widget")||window.widget;return n.getToken().then(function(s){return new e(function(e,n){var u=a.assembleURLFor3DSwym("/api/user/find"),l={method:"POST",headers:{}};l.headers.Accept="application/json",l.headers["Content-Type"]="application/json",l.headers["Accept-Language"]=i.lang,l.headers["X-DS-SWYM-CSRFTOKEN"]=s,l.data=JSON.stringify({params:{hash_key:"",login:o.user}}),l.onComplete=function(r){r=t.is(r,"string")?JSON.parse(r):r,e(r)},l.onFailure=function(e){e=t.is(e,"string")?JSON.parse(e):e,n(e)},r.authenticatedRequest(u,l)})})}};return{_internals:n,users:{retrieve:function(e){return n.find({user:e.user}).then(function(e){var t=e.result;return{user:t.login,address:t.address,city:t.city,company:t.company,country:t.country,email:t.email,name:t.first_name+" "+t.last_name}})}}}}),define("DS/IssueServices/utils/Support",["UWA/Core","DS/Logger/Logger","DS/IssueServices/Contexts","DS/IssueServices/services/PlatformServices","i18n!DS/IssueServices/assets/nls/IssueServices"],function(e,t,r,s,a){"use strict";var n={UNKNOWN:a.support.unknown,BROWSERS:{Chrome:60,Firefox:52,IE:11}};return{checkBrowserSupport:function(){this._logger=t.getLogger("DS/IssueServices/Support"),this._logger.info("Checking the browser support");var e=this.utils.getBrowser();return n.BROWSERS[e.name]?!(parseFloat(e.version)<n.BROWSERS[e.name])||(this._logger.warn(a.replace(a.support.browser,{name:e.name,version:e.version,supported:this.utils.getSupportedBrowsers()})),!0):(this._logger.warn(a.replace(a.support.browser,{name:e.name,version:e.version,supported:this.utils.getSupportedBrowsers()})),!1)},checkSwymSupport:function(){return this._logger=t.getLogger("DS/IssueServices/Support"),this._logger.info("Checking Swym support"),""!==s.get3DSwymUrl()||(this._logger.error("Swym is not available on this server"),require(["DS/PADUtils/views/PADAlert"],function(e){e.displayNotification({msg:a.support.swym,eventID:"error"})}),!1)},utils:{getBrowser:function(){try{var e,t=navigator.userAgent,r=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(r[1])?{name:"IE",version:(e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""}:"Chrome"===r[1]&&null!==(e=t.match(/\b(OPR|Edge)\/(\d+)/))?{name:e[1].replace("OPR","Opera"),version:e[2]}:(r=r[2]?[r[1],r[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(e=t.match(/version\/(\d+)/i))&&r.splice(1,1,e[1]),{name:r[0],version:r[1]})}catch(e){return{name:n.UNKNOWN,version:n.UNKNOWN}}},getSupportedBrowsers:function(){var e=[];for(var t in n.BROWSERS)n.BROWSERS.hasOwnProperty(t)&&e.push(t+" ("+n.BROWSERS[t]+")");return e.join(", ")}}}}),define("DS/IssueServices/utils/LocalStorage",["UWA/Core","DS/Logger/Logger","DS/IssueServices/Contexts"],function(e,t,r){"use strict";return{setItem:function(e,s){this._logger=t.getLogger("DS/IssueServices/LocalStorage");var a=r.get("widget")||window.widget,n=a.id,o=a.name,i={};i[e]=s;try{if(null===localStorage.getItem(o+"/"+n))localStorage.setItem(o+"/"+n,JSON.stringify(i));else{var u=JSON.parse(localStorage.getItem(o+"/"+n));u[e]=s,localStorage.setItem(o+"/"+n,JSON.stringify(u))}}catch(t){this._logger.error("Cannot set the value %o for the key %s: %s",s,e,t.message)}},getItem:function(e){this._logger=t.getLogger("DS/IssueServices/LocalStorage");var s=r.get("widget")||window.widget,a=s.id,n=s.name;try{return JSON.parse(localStorage.getItem(n+"/"+a))[e]}catch(t){return this._logger.info("Cannot get the value for the key %s: %s",e,t.message),null}},clear:function(){this._logger=t.getLogger("DS/IssueServices/LocalStorage");var e=r.get("widget")||window.widget,s=e.id,a=e.name;localStorage.setItem(a+"/"+s,JSON.stringify({}))}}}),define("DS/IssueServices/utils/Migration",["UWA/Class/Promise","UWA/Core","DS/UIKIT/Input/Button","DS/Logger/Logger","DS/IssueServices/Contexts","DS/IssueServices/services/PlatformServices","DS/IssueServices/utils/LocalStorage","i18n!DS/IssueServices/assets/nls/IssueServices","css!DS/IssueServices/IssueServices.css"],function(e,t,r,s,a,n,o,i){"use strict";var u=500,l=function(){return t.createElement("div",{class:"placeholder-migration-container",html:[{tag:"div",class:"placeholder-migration-label",html:[{tag:"span",class:"migration-text saving",html:[i.migration.upgrading,{tag:"span",html:"."},{tag:"span",html:"."},{tag:"span",html:"."}]}]}]})},c=s.getLogger("DS/IssueServices/Migration");return{isUpToDate:function(){var e=a.get("widget")||window.widget,r=e.getValue("version");return r&&t.is(r,"number")?(c.info("Widget is not up-to-date (previous to 19x FD03)"),!1):r&&t.is(r,"string")?r<a.version?(c.info("Widget is not up-to-date"),!1):(c.info("Widget is up-to-date"),!0):(c.info("The version is not set (first initialization), we set it to version %s",a.version),e.setValue("version",a.version),!0)},upgrade:function(){var e=this,t=a.get("widget")||window.widget;return c.info("The widget is now upgrading"),l().inject(t.body),n.initPlatformServices().then(function(){var e=n.getSecurityContexts();t.addPreference({name:"pad_security_ctx",type:"list",label:"",options:e.cspaces,defaultValue:e.securityContext})}).then(function(){c.info("The platform services have been initialized");var s=null;e.reset().then(function(){return e.migrate()}).then(function(){c.info("Widget has been upgraded")}).catch(function(e){s=e,c.error(s)}).finally(function(){var e=new r({value:i.migration.refresh,icon:"arrows-ccw"});e.addEvent("onClick",function(){e.load(),setTimeout(function(){window.top.location.reload(!0)},u)}),t.body.getElement(".placeholder-migration-label").setContent([{tag:"span",class:"placeholder-migration-label-text",html:null!==s?i.migration.preferences.error:i.migration.upgrade},{tag:"div",class:"placeholder-migration-label-button",html:e}])})})},reset:function(){var t=a.get("widget")||window.widget;return c.info("Resetting the parameters"),new e(function(e){o.clear(),t.setValue("version",a.version),c.info("Preferences reset and version set to %s",a.version),e()})},migrate:function(){return new e(function(e){e()})},getVersion:function(){return a.version}}});