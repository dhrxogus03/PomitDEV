define("DS/ENODOManagementCmds/commands/PSEDOGenerationCommand",["UWA/Core","DS/ApplicationFrame/Command","DS/PADUtils/PADContext","i18n!DS/ENODOManagementCmdsLight/assets/nls/DOGeneratorCmd","DS/ENODOUtilsServices/DOServices"],function(e,t,i,r,n){"use strict";return t.extend({_retrieveSelectionAndFiltersCV1:function(e,t){var i,n={selections:[]},s=[],o=[];for(i=0;i<t.length;i++){var a=t[i],c=a.getOccurencePath(),l=a.getID(),h=new RegExp("^[0-9a-f.]+$");if(!UWA.is(l)||!h.test(l.toLowerCase()))throw r.error.invalidPhID;var d=a.getRoot().getID(),p=s.indexOf(d);if(-1===p){s.push(d);var g=[c];o.push(g)}else o[p]&&o[p].push(c)}var f,u={V1:{}};for(f=0;f<s.length;f++){if((g={}).paths=o[f],void 0!==e.HasFilter&&"function"==typeof e.HasFilter){var m=e.HasFilter(s[f]);if(UWA.is(m.hasFilter)&&!0===m.hasFilter&&UWA.is(e.GetFilterSpec(s[f],u).CVQuery)){var v=e.GetFilterSpec(s[f],u).CVQuery;g.filter=v}}n.selections.push(g)}return console.log(n),n},_retrieveSelectionAndFilters:function(e,t){var i={selections:[]},n=[],s=[];for(g=0;g<t.length;g++){var o=t[g],a=o.getOccurencePath(),c=o.getID(),l=new RegExp("^[0-9a-f.]+$");if(!UWA.is(c)||!l.test(c.toLowerCase()))throw r.error.invalidPhID;var h=o.getRoot().getID(),d=n.indexOf(h);if(-1===d){n.push(h);var p=[a];s.push(p)}else s[d]&&s[d].push(a)}for(var g=0;g<n.length;g++){p={};var f=[];f.push(n[g]),p.paths=f;var u={filter:{all:1}};if(e.GetFilterSpec){var m=this.prefixPath(s[g]);u=e.GetFilterSpec(n[g],{V2:{prefixPathArray:m}}),p.filter=u.filter}i.selections.push(p)}return console.log(i),i},prefixPath:function(e){return e.map(e=>({physical_id_path:e}))},init:function(e){this._parent(e);var t=i.get(),r=t.options.model?t.options.model:t.getPADTreeDocument();r.getXSO().onPostAdd(this._check_select.bind(this)),r.getXSO().onPostRemove(this._check_select.bind(this)),r.getXSO().onEmpty(this._check_select.bind(this))},_check_select:function(){!0===i.get().getPADTreeDocument().getXSO().get().length>0?this.enable():this.disable()},execute:function(){var e=this,t=i.get(),s=t.options.model?t.options.model:t.getPADTreeDocument();require(["DS/ENODOManagementCmdsLight/commands/GenericDOGenerationCmd"],function(i){var o=s.getSelectedNodes();try{var a;return a="ENOWSES_AP"==widget.data.appId?e._retrieveSelectionAndFiltersCV1(t,o):e._retrieveSelectionAndFilters(t,o),new i({command_id:e.options.ID,data:{selections:a.selections,context:widget.data.appId}})}catch(e){n._displayNotification("error",r.error.title,e)}})}})});