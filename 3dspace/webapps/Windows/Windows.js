var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Windows/DockingElement",["require","exports","UWA/Core","UWA/Utils/Client","DS/Controls/Abstract","DS/Controls/Tab","DS/Utilities/WUXUWAUtils","DS/Core/PointerEvents","DS/Utilities/Utils","DS/Utilities/Dom","DS/WebRecordEnabler/Adapter","DS/WebRecordBase/Constants","DS/Core/WebUXComponents","DS/Core/WebUXGlobalEnums","DS/WUXTypings/typings/UWA"],function(e,t,i,n,o,s,a,r,l,d,h,c,u,p){"use strict";function m(e){return!(!e||"object"!=typeof e||!e.content)}var g;!function(e){e[e.STANDARD=0]="STANDARD",e[e.FIXED_AREA=1]="FIXED_AREA",e[e.MOVABLE=2]="MOVABLE"}(g||(g={}));var f="wux-docking-element-hide-docking-zone",w="wux-docking-anim-collapse",_="wux-ui-3ds wux-ui-3ds-1x wux-windows-docking-element-collapseIcon",v="wux-ui-3ds wux-ui-3ds-lg wux-ui-3ds-menu wux-windows-docking-element-collapseIcon",y=1e3,b=300,D=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return a.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{dockingZoneSize:{defaultValue:100,type:"number",advancedSetter:!0,recordFlag:!0},minSize:{defaultValue:20,type:"number"},maxSize:{defaultValue:screen.width,advancedSetter:!0,type:"number"},side:{defaultValue:p.WUXDockAreaEnum.TopDockArea,type:"number",readOnly:!0},interactiveDockAreaVisibleFlag:{defaultValue:!1,type:"boolean"},collapsibleFlag:{defaultValue:!0,type:"boolean"},collapseDockingZoneFlag:{defaultValue:!1,advancedSetter:!0,type:"boolean",recordFlag:!0},overlayDockingZoneFlag:{defaultValue:!1,type:"boolean"},visibleCollapserFlag:{defaultValue:!0,type:"boolean"},collapserStyle:{defaultValue:0,type:"enum",category:"Appearance",readOnly:!0},visibleDockingZoneFlag:{defaultValue:!0,type:"boolean"},resizableFlag:{defaultValue:!0,type:"boolean"},dockingZoneContent:{defaultValue:null,type:"object"},freeZoneContent:{defaultValue:null,type:"object"},useBordersFlag:{defaultValue:!0,type:"boolean"},useBackgroundFlag:{defaultValue:!1,type:"boolean"},alignment:{defaultValue:"near",type:"string",category:"Appearance"},autoExpandFlag:{defaultValue:!0,type:"boolean"}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this._scrollBarSize=0,this._collapserSize=20,this.__forceCollapseDockingZoneFlagCpt=0,this._collapserVisibilityToBeChanged=!1,this._transitionInProgress=!1,e.prototype.init.apply(this,t)},t.prototype.buildView=function(){var e=this;this.elements.container.addClassName("wux-windows-docking-element"),h.setElementRecordMode(this.elements.container,c.RecordModes.DEFAULT_AND_CHILD),this.elements.dockingWithCollapserContainer=new i.Element("div",{class:"wux-windows-docking-and-collapser"}),this.elements.collapser=new i.Element("div",{class:"wux-windows-docking-element-collapser"}),n.Engine.ie||this.elements.collapser.addClassName("collapser-not-IE"),this.elements.dockingZoneMask=new i.Element("div",{class:"wux-windows-docking-element-docking-zone-mask"}),this.elements.fixedArea=new i.Element("div",{class:"wux-windows-docking-element-fixed-area"}).inject(this.elements.dockingZoneMask),this.elements.dockingZone=new i.Element("div",{class:"wux-windows-docking-element-docking-zone"}).inject(this.elements.dockingZoneMask),this.elements.resizeHandler=new i.Element("div",{class:"wux-windows-docking-element-resize-handler"}),this.elements.freeZone=new i.Element("div",{class:"wux-windows-docking-element-free-zone"}),this.elements.hackResize=new i.Element("div",{class:"wux-windows-docking-element-hack-resize"}).inject(this.elements.container),this.elements.hackResize.addClassName(f),this.elements.interactiveDockArea=new i.Element("div",{class:"wux-windows-docking-element-interactive-dock-area"}),this._pinnedFlag=!1,Object.defineProperty(this,"pinnedFlag",{get:function(){return e._pinnedFlag}}),this._onDocumentMouseMoveForAutoExpandBind=function(e){var t=this;l.isMouseOverElement(this.elements.dockingWithCollapserContainer,{x:e.clientX,y:e.clientY})?this._collapseTimer&&(clearTimeout(this._collapseTimer),this._collapseTimer=null):this._collapseTimer||(this._collapseTimer=setTimeout(function(){d.pushUserInteractionContext(),t.setPropertyFromUIInteraction("collapseDockingZoneFlag",!0),t.elements.dockingWithCollapserContainer.removeAttribute("expand-hover"),t.__collapseMemory=!1,d.popUserInteractionContext(),t._listenToMouseMove=!1,d.removeEventOnElement(t,document,r.POINTERMOVE,t._onDocumentMouseMoveForAutoExpandBind),t._collapseTimer=null},y))}.bind(this),this._onCollapserMouseEnterForAutoExpandBind=function(){var e=this;!0!==this.collapseDockingZoneFlag||this._expandTimer||(this._expandTimer=setTimeout(function(){d.pushUserInteractionContext(),e.setPropertyFromUIInteraction("collapseDockingZoneFlag",!1),e.elements.dockingWithCollapserContainer.setAttributeNode(document.createAttribute("expand-hover")),d.popUserInteractionContext(),e._listenToMouseMove=!0,d.addEventOnElement(e,document,r.POINTERMOVE,e._onDocumentMouseMoveForAutoExpandBind),e._expandTimer=null},b))}.bind(this),this._onCollapserMouseLeaveForAutoExpandBind=function(){this._expandTimer&&(clearTimeout(this._expandTimer),this._expandTimer=null)}.bind(this)},t.prototype.handleEvents=function(){(function(){var e=this,t=0,i=0,n=0,o=0,s=0,a="",l=function(r){r.preventDefault(),t=r[a]-o;var l=i+s*t,d=Math.max(e.minSize,Math.min(l,e.maxSize,n));e.setPropertyFromUIInteraction("dockingZoneSize",d),e.fire("dockIsResizing")},h=function(){document.body.removeAttribute("resizing"),d.removeEventOnElement(e,document,r.POINTERMOVE,l),d.removeEventOnElement(e,document,r.POINTERUP,h),e.elements.hackResize.setStyle("cursor","default"),e.elements.hackResize.addClassName(f),e.fire("dockResize")};d.addEventOnElement(this,this.elements.resizeHandler,r.POINTERDOWN,function(t){if(!1===e.collapseDockingZoneFlag&&!0===e.resizableFlag){document.body.setAttributeNode(document.createAttribute("resizing")),d.addEventOnElement(e,document,r.POINTERMOVE,l),d.addEventOnElement(e,document,r.POINTERUP,h);var c=e.getResizeInfos();n=c.maxPossibleSize,s=c.factor,a=c.directionProp,i=Math.min(e.dockingZoneSize,c.maxPossibleSize),o=t[a],e.elements.hackResize.setStyle("cursor",c.resizeCursor),e.elements.hackResize.removeClassName(f),e.fire("dockStartResize")}})}).call(this),A.call(this)},t.prototype._postBuildView=function(){var e=this._getCollapseDockingZoneFlagFromPreferences();e&&(this.collapseDockingZoneFlag=e.collapseDockingZoneFlag)},t.prototype._applySide=function(){var e=this._getClassName();this.elements.container.addClassName(e),this.elements.collapser.addClassName(e),this.elements.dockingWithCollapserContainer.addClassName(e),this.elements.dockingZoneMask.addClassName(e),this.elements.dockingZone.addClassName(e),this.elements.resizeHandler.addClassName(e),this.elements.freeZone.addClassName(e),this.elements.interactiveDockArea.addClassName(e),this.side&p.WUXDockAreaEnum.LeftDockArea||this.side&p.WUXDockAreaEnum.TopDockArea?(this.elements.collapser.inject(this.elements.dockingWithCollapserContainer),this.elements.dockingZoneMask.inject(this.elements.dockingWithCollapserContainer),this.elements.resizeHandler.inject(this.elements.dockingWithCollapserContainer),this.elements.dockingWithCollapserContainer.inject(this.elements.container),this.elements.freeZone.inject(this.elements.container)):(this.elements.resizeHandler.inject(this.elements.dockingWithCollapserContainer),this.elements.dockingZoneMask.inject(this.elements.dockingWithCollapserContainer),this.elements.collapser.inject(this.elements.dockingWithCollapserContainer),this.elements.freeZone.inject(this.elements.container),this.elements.dockingWithCollapserContainer.inject(this.elements.container)),this.elements.interactiveDockArea.inject(this.elements.dockingZoneMask)},t.prototype._preEditDockingZoneSize=function(e,t){return"100%"===t||(void 0!==this.maxSize&&t>this.maxSize?{validValue:this.maxSize}:!(void 0!==this.minSize&&t<this.minSize)||{validValue:this.minSize})},t.prototype._applyDockingZoneSize=function(e){this._updateDockingZoneSize()},t.prototype._applyIdentifier=function(){this.identifier&&(this.getContent().setAttribute("wux-identifier",this.identifier),this.elements.dockingWithCollapserContainer.setAttribute("wux-identifier",this.identifier))},t.prototype._getClassName=function(){switch(this.side){case p.WUXDockAreaEnum.LeftDockArea:return"wux-docking-element-left";case p.WUXDockAreaEnum.RightDockArea:return"wux-docking-element-right";case p.WUXDockAreaEnum.TopDockArea:return"wux-docking-element-top";case p.WUXDockAreaEnum.BottomDockArea:return"wux-docking-element-bottom"}return""},t.prototype._saveCollapseDockingZoneFlagInPreferences=function(){""!==this.identifier&&l.saveDataInLocalPreferences(this,this._getClassName(),"collapseDockingZoneFlag",{collapseDockingZoneFlag:this.collapseDockingZoneFlag})},t.prototype._getCollapseDockingZoneFlagFromPreferences=function(){if(""!==this.identifier)return l.getDataFromLocalPreferences(this,this._getClassName(),"collapseDockingZoneFlag")},t.prototype._applyInteractiveDockAreaVisibleFlag=function(){this.interactiveDockAreaVisibleFlag?this.elements.interactiveDockArea.setAttributeNode(document.createAttribute("displayed")):this.elements.interactiveDockArea.removeAttribute("displayed")},t.prototype._applyCollapsibleFlag=function(){this.collapsibleFlag||(this.__forceCollapseDockingZoneFlagCpt++,this.collapseDockingZoneFlag=!1,this.__forceCollapseDockingZoneFlagCpt--),this._updateSizes()},t.prototype.__shouldCollapserBeVisible=function(){return!(this.collapserStyle===t.COLLAPSER_STYLE.MOVABLE&&(this.pinnedFlag||!function(){if(!this.dockingZoneContent)return!1;if(!this.dockingZoneContent.match('[class^="wux-skeleton"]'))return!0;var e=this.dockingZoneContent.querySelector('[class$="container"]');return e&&e.hasChildNodes()}.call(this)))&&(!(this.collapserStyle===t.COLLAPSER_STYLE.FIXED_AREA&&!this.collapseDockingZoneFlag)&&(this.collapsibleFlag&&this.visibleDockingZoneFlag&&this.visibleCollapserFlag))},t.prototype._updateCollapserSize=function(){var e=this;this.__shouldCollapserBeVisible()?(this.collapserStyle===t.COLLAPSER_STYLE.MOVABLE?this._collapserSize=0:this._collapserSize=20,e._transitionInProgress&&!e._collapserVisibilityToBeChanged&&e.getContent().offsetParent?(e._collapserVisibilityToBeChanged=!0,e.addEventListener("dimensionsChanged",function(){e._collapserVisibilityToBeChanged&&(e._collapserVisibilityToBeChanged=!1,e.elements.collapser.removeClassName(f))},{once:!0})):(e._collapserVisibilityToBeChanged=!1,e.elements.collapser.removeClassName(f))):(this._collapserVisibilityToBeChanged=!1,this._collapserSize=0,this.elements.collapser.addClassName(f))},t.prototype.getCollasperSize=function(){return this._collapserSize},t.prototype._updateDockingZoneSize=function(){var e=this._hasScrollbar();e&&0===this._scrollBarSize?this._scrollBarSize=l.getScrollbarWidth():e||(this._scrollBarSize=0);var t,i,n,o,s,a=this.side,r=0;if(a===p.WUXDockAreaEnum.TopDockArea||a===p.WUXDockAreaEnum.BottomDockArea){t="height";var d=function(){return this.elements.fixedArea?this.elements.fixedArea.offsetHeight:0}.call(this);r=d,this.elements.dockingZone.setStyle("margin-top",d+"px"),i="100%"===this.dockingZoneSize?"100%":this.dockingZoneSize+this._scrollBarSize-d+"px"}else a!==p.WUXDockAreaEnum.LeftDockArea&&a!==p.WUXDockAreaEnum.RightDockArea||(t="width",i="100%"===this.dockingZoneSize?"100%":this.dockingZoneSize+this._scrollBarSize+"px");if("100%"!==i){var h=this.getResizeInfos();h.maxPossibleSize>0&&(i=Math.min(Number.parseInt(i),h.maxPossibleSize)+"px")}n=this.visibleDockingZoneFlag&&!this.collapseDockingZoneFlag?"100%"===i?"100%":(Number.parseInt(i)+r).toString()+"px":"0px",o=this.visibleDockingZoneFlag?this.visibleCollapserFlag?this.collapseDockingZoneFlag?this._collapserSize+"px":"100%"===i?"100%":Number.parseInt(n)+this._collapserSize+"px":n:"0px",s=!this.visibleDockingZoneFlag||this.collapseDockingZoneFlag&&0===this._collapserSize||this.overlayDockingZoneFlag?"100%":this.collapseDockingZoneFlag&&0!==this._collapserSize?"calc(100% - "+this._collapserSize+"px)":"calc(100% - "+("100%"===i?0:Number.parseInt(o))+"px)",this.elements.dockingZone.setStyle(t,i),this.elements.dockingZoneMask.setStyle(t,n),this.elements.dockingWithCollapserContainer.setStyle(t,o),this.elements.freeZone.setStyle(t,s)},t.prototype._updateSizes=function(){this._updateCollapserSize(),this._updateDockingZoneSize()},t.prototype._applyOverlayDockingZoneFlag=function(){if(this.overlayDockingZoneFlag){switch(this.side){case p.WUXDockAreaEnum.TopDockArea:this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-overlay-top");break;case p.WUXDockAreaEnum.BottomDockArea:this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-overlay-bottom");break;case p.WUXDockAreaEnum.LeftDockArea:this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-overlay-left");break;case p.WUXDockAreaEnum.RightDockArea:this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-overlay-right")}this.elements.container.addClassName("wux-windows-docking-element-overlayed")}else this.elements.dockingWithCollapserContainer.removeClassName("wux-windows-docking-element-overlay-top"),this.elements.dockingWithCollapserContainer.removeClassName("wux-windows-docking-element-overlay-bottom"),this.elements.dockingWithCollapserContainer.removeClassName("wux-windows-docking-element-overlay-left"),this.elements.dockingWithCollapserContainer.removeClassName("wux-windows-docking-element-overlay-right"),this.elements.container.removeClassName("wux-windows-docking-element-overlayed");this._updateDockingZoneSize()},t.prototype._applyVisibleCollapserFlag=function(){this._updateSizes()},t.prototype._applyCollapserStyle=function(){var e="";this.collapserStyle===t.COLLAPSER_STYLE.FIXED_AREA?(e="fixed-area",function(){this.elements.expanderBar=new i.Element("div",{class:"wux-windows-docking-element-expanderBar"}),this.elements.collapseIconContainer=new i.Element("div",{class:"wux-windows-docking-element-collapse-icon-container"}).inject(this.elements.expanderBar),this.elements.collapseIcon=new i.Element("span",{class:_}).inject(this.elements.collapseIconContainer),this.elements.expanderBar.inject(this.elements.dockingZone,"before")}.call(this)):this.collapserStyle===t.COLLAPSER_STYLE.MOVABLE?(e="movable",function(){var e=this;this.elements.collapseIcon=new i.Element("span",{class:v}).inject(this.elements.collapser);var t,n,o,s,a=this.elements.dockingWithCollapserContainer,l=this.elements.collapser;this._collapseIconPosSetByUser=!1;var d=null,h=function(i){i.preventDefault();var a=i.clientX,r=i.clientY,h=e.side===p.WUXDockAreaEnum.TopDockArea||e.side===p.WUXDockAreaEnum.BottomDockArea;if(!e._getCurrentTouchMode()||!(h&&Math.abs(a-o)<5||!h&&Math.abs(r-s)<5)){null===d&&(d=e.elements.freeZone.style.pointerEvents,e.elements.freeZone.style.pointerEvents="none"),e._collapserHasBeenMoved=!0,e._collapseIconPosSetByUser=!0;var c=Math.max(0,Math.min(t.height-42,r-t.top+n.y)),u=Math.max(0,Math.min(t.width-42,a-t.left+n.x));l.setStyle("top",c+"px"),l.setStyle("left",u+"px")}};l.addEventListener(r.POINTERDOWN,function(i){e._collapserHasBeenMoved=!1,t=a.getBoundingClientRect();var c=l.getBoundingClientRect();o=i.clientX,s=i.clientY,n={x:c.left-o,y:c.top-s},document.body.addEventListener(r.POINTERMOVE,h),document.body.addEventListener(r.POINTERUP,function(){document.body.removeEventListener(r.POINTERMOVE,h),null!==d&&(e.elements.freeZone.style.pointerEvents=d,d=null)},{once:!0})})}.call(this)):this.collapserStyle===t.COLLAPSER_STYLE.STANDARD&&(e="standard"),this.elements.container.setAttribute("collapser-style",e)},t.prototype._updateCollapserAutomaticPosition=function(e){if(void 0!==e&&!this._collapseIconPosSetByUser){var t=this.elements.collapser,i=this.elements.dockingWithCollapserContainer;t&&i&&(i.getBoundingClientRect(),t.setStyle("top",e+"px"))}},t.prototype._preEditCollapseDockingZoneFlag=function(){return this.__forceCollapseDockingZoneFlagCpt>0||this.collapsibleFlag},t.prototype._applyCollapseDockingZoneFlag=function(){var e=this;if(!l.browserIsIE()){var t=void 0;if(this.__onTransitionEnd=function(){e.elements.container&&(l.browserIsIE()||(e._transitionInProgress=!1,e.elements.dockingZone.removeClassName(w),e.elements.dockingZoneMask.removeClassName(w),e.elements.freeZone.removeClassName(w),e.elements.dockingWithCollapserContainer.removeClassName(w)),e.overlayDockingZoneFlag?d.removeEventOnElement(e,e.elements.dockingZone,"transitionend",e.__onTransitionEnd):d.removeEventOnElement(e,e.elements.freeZone,"transitionend",e.__onTransitionEnd),e.fire("dimensionsChanged"),clearTimeout(t))},this._transitionInProgress)this.__onTransitionEnd.call(this);else{this._transitionInProgress=!0;var i=this.overlayDockingZoneFlag?this.elements.dockingZone:this.elements.freeZone;d.addEventOnElement(this,i,"transitionend",this.__onTransitionEnd),t=setTimeout(this.__onTransitionEnd,500),this.elements.dockingZone.addClassName(w),this.elements.dockingZoneMask.addClassName(w),this.elements.freeZone.addClassName(w),this.elements.dockingWithCollapserContainer.addClassName(w)}}this._expandTimer||k.call(this,!this.collapseDockingZoneFlag),this.collapseDockingZoneFlag?E.call(this):F.call(this)},t.prototype._applyVisibleDockingZoneFlag=function(){this.visibleDockingZoneFlag?(!0!==this.resizableFlag||this.collapseDockingZoneFlag||this.elements.resizeHandler.removeClassName(f),this.elements.dockingZone.removeClassName(f),this.elements.dockingZoneMask.removeClassName(f)):(this.elements.resizeHandler.addClassName(f),this.elements.dockingZone.addClassName(f),this.elements.dockingZoneMask.addClassName(f)),this._updateSizes()},t.prototype._applyResizableFlag=function(){!1===this.resizableFlag?this.elements.resizeHandler.addClassName(f):!0!==this.visibleDockingZoneFlag||this.collapseDockingZoneFlag||this.elements.resizeHandler.removeClassName(f)},t.prototype._applyMinSize=function(){void 0!==this.minSize&&null!==this.minSize&&(void 0!==this.maxSize&&null!==this.maxSize&&this.minSize>this.maxSize&&(this.maxSize=this.minSize),"100%"!==this.dockingZoneSize&&this.minSize>this.dockingZoneSize&&(this.dockingZoneSize=this.minSize))},t.prototype._preEditMaxSize=function(e,t){return!(void 0!==this.minSize&&null!==this.minSize&&this.minSize>t)||{validValue:this.minSize}},t.prototype._applyMaxSize=function(){void 0!==this.maxSize&&null!==this.maxSize&&"100%"!==this.dockingZoneSize&&this.maxSize<this.dockingZoneSize&&(this.dockingZoneSize=this.maxSize)},t.prototype.getResizeInfos=function(){var e=function(){var e=this.elements.freeZone,t=!1;for(;!t;){t=!0;for(var i=e.getChildren(),n=0;n<i.length;n++)if(i[n].hasClassName("wux-windows-docking-element")){var o=i[n].dsModel;o&&(e=o.elements.freeZone,t=!1)}}return e}.call(this);switch(this.side){case p.WUXDockAreaEnum.TopDockArea:return{factor:1,resizeCursor:"ns-resize",directionProp:"pageY",maxPossibleSize:this.elements.dockingZoneMask.offsetHeight+e.offsetHeight-50};case p.WUXDockAreaEnum.BottomDockArea:return{factor:-1,resizeCursor:"ns-resize",directionProp:"pageY",maxPossibleSize:this.elements.dockingZoneMask.offsetHeight+e.offsetHeight-50};case p.WUXDockAreaEnum.LeftDockArea:return{factor:1,resizeCursor:"ew-resize",directionProp:"pageX",maxPossibleSize:this.elements.dockingZoneMask.offsetWidth+e.offsetWidth-50};case p.WUXDockAreaEnum.RightDockArea:return{factor:-1,resizeCursor:"ew-resize",directionProp:"pageX",maxPossibleSize:this.elements.dockingZoneMask.offsetWidth+e.offsetWidth-50}}},t.prototype._applyDockingZoneContent=function(e){e&&e.remove(),this.dockingZoneContent&&(i.is(this.dockingZoneContent,"element")&&(this._properties.dockingZoneContent.value=new i.extendElement(this.dockingZoneContent)),this.dockingZoneContent.inject(this.elements.dockingZone)),this.collapserStyle===t.COLLAPSER_STYLE.MOVABLE&&this._updateCollapserSize()},t.prototype.addContent=function(e,t){var i=this;t&&t.createNewTab&&m(e)?(this.elements._tab||(this.elements._tab=new s({tabBarDOMContainer:this.elements.collapser,tabPanelContainer:this.elements.dockingZone,_noCSSOnParent:!0,displayStyle:"panel"}),this.elements._tab.tabBar.centeredFlag=!1,d.addEventOnElement(this,this.elements._tab.tabBar,"click",function(e){e.stopPropagation()}),d.addEventOnElement(this,this.elements._tab.tabBar,r.POINTERDOWN,function(e){if(e.dsModel){var t=e.dsModel.value,n=i.elements._tab.getPageContentFromValue(t);n&&n.dsModel&&n.dsModel._onDragPointerDown(e)}})),this.elements._tab.add(e)):this.elements.dockingZone.appendChild(e)},t.prototype.containsContent=function(e){return d.firstParentWithClass(e,"wux-windows-docking-element-docking-zone")===this.elements.dockingZone},t.prototype.replaceContent=function(e,t){if(this.elements._tab){var n=m(t)?t.content:t;this.elements._tab.removeTab(n);var o=m(e)?e.content:e,s=this.elements._tab.getIndexOf(o);void 0!==s&&this.elements._tab.update(s,m(t)?t:{content:t})}else if(!m(e)){n=m(t)?t.content:t;i.is(n,"element")&&(n=new i.extendElement(n)),n.inject(e,"before"),e.remove()}},t.prototype.removeContent=function(e){this.elements._tab?this.elements._tab.removeTab(e):e.remove()},t.prototype.updateContentVisibility=function(e,t){if(this.elements._tab){var i=this.elements._tab.getIndexOf(e);if(i>=0){var n=this.elements._tab.getPageValueFromIndex(i);this.elements._tab._setTabVisibility(n,t)}}},t.prototype.activateTab=function(e){if(this.elements._tab){var t=this.elements._tab.getIndexOf(e);if(t>=0){var i=this.elements._tab.getPageValueFromIndex(t);this.elements._tab.tabBar.value=[i]}}},t.prototype.isContentActive=function(e){if(this.elements._tab){var t=this.elements._tab.getIndexOf(e);if(t>=0){var i=this.elements._tab.getPageValueFromIndex(t);return!!this.elements._tab._getTabVisibility(i)&&this.elements._tab.tabBar.value.indexOf(i)>-1}}return!0},t.prototype._applyFreeZoneContent=function(e){e&&e.remove(),this.freeZoneContent&&(i.is(this.freeZoneContent,"element")&&(this._properties.freeZoneContent.value=new i.extendElement(this.freeZoneContent)),this.freeZoneContent.inject(this.elements.freeZone))},t.prototype._applyUseBordersFlag=function(e){this.useBordersFlag?this.elements.dockingZone.addClassName("wux-docking-element-useBorders"):this.elements.dockingZone.removeClassName("wux-docking-element-useBorders")},t.prototype._applyUseBackgroundFlag=function(e){this.useBackgroundFlag?this.elements.dockingZone.addClassName("wux-docking-element-use-background"):this.elements.dockingZone.removeClassName("wux-docking-element-use-background")},t.prototype._applyAlignment=function(){"center"===this.alignment?(this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-near"),this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-far"),this.elements.dockingZoneMask.addClassName("wux-docking-element-align-center")):"far"===this.alignment?(this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-near"),this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-center"),this.elements.dockingZoneMask.addClassName("wux-docking-element-align-far")):(this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-center"),this.elements.dockingZoneMask.removeClassName("wux-docking-element-align-far"),this.elements.dockingZoneMask.addClassName("wux-docking-element-align-near"))},t.prototype._applyAutoExpandFlag=function(){this.autoExpandFlag?(d.addEventOnElement(this,this.elements.collapser,"mouseenter",this._onCollapserMouseEnterForAutoExpandBind),d.addEventOnElement(this,this.elements.collapser,"mouseleave",this._onCollapserMouseLeaveForAutoExpandBind)):(d.removeEventOnElement(this,this.elements.collapser,"mouseenter",this._onCollapserMouseEnterForAutoExpandBind),d.removeEventOnElement(this,this.elements.collapser,"mouseleave",this._onCollapserMouseLeaveForAutoExpandBind))},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("collapserStyle")&&this._applyCollapserStyle(),this.isDirty("side")&&this._applySide(),this.isDirty("dockingZoneSize")&&u._applyForAdvancedSetterProperty(this,"dockingZoneSize",t.dockingZoneSize,this.dockingZoneSize),this.isDirty("interactiveDockAreaVisibleFlag")&&this._applyInteractiveDockAreaVisibleFlag(),this.isDirty("resizableFlag")&&this._applyResizableFlag(),this.isDirty("dockingZoneContent")&&this._applyDockingZoneContent(),this.isDirty("freeZoneContent")&&this._applyFreeZoneContent(),this.isDirty("collapsibleFlag")&&this._applyCollapsibleFlag(),this.isDirty("visibleDockingZoneFlag")&&this._applyVisibleDockingZoneFlag(),this.isDirty("useBordersFlag")&&this._applyUseBordersFlag(t.useBordersFlag),this.isDirty("useBackgroundFlag")&&this._applyUseBackgroundFlag(t.useBackgroundFlag),this.isDirty("collapseDockingZoneFlag")&&u._applyForAdvancedSetterProperty(this,"collapseDockingZoneFlag",t.collapseDockingZoneFlag||!1,this.collapseDockingZoneFlag),this.isDirty("overlayDockingZoneFlag")&&this._applyOverlayDockingZoneFlag(),this.isDirty("visibleCollapserFlag")&&this._applyVisibleCollapserFlag(),this.isDirty("alignment")&&this._applyAlignment(),this.isDirty("autoExpandFlag")&&this._applyAutoExpandFlag()},t.prototype._getFixedArea=function(){return this.elements.fixedArea},t.prototype._getFixedAreaWidth=function(){return this.elements.fixedArea?this.elements.fixedArea.offsetWidth:0},t.prototype.getSensibilityDockArea=function(){return{x:0,y:0,width:0,height:0}},t.prototype._getDockingZoneDimensions=function(){var e=window.getComputedStyle(this.elements.dockingZoneMask),i=parseFloat(e.width),n=parseFloat(e.height);if(this.collapserStyle===t.COLLAPSER_STYLE.FIXED_AREA){var o=window.getComputedStyle(this.elements.expanderBar);i-=parseFloat(o.width)+1,n-=parseFloat(o.height)+1}return{width:i,height:n}},t.prototype._getScrollBarSize=function(){return this._scrollBarSize},t.prototype._scrollToBottom=function(){},t.prototype.__hasBackground=function(){return!1},t.prototype._pointerEventsAllIfOveflowY=function(){this.pointerEventsAllIfOverflow()},t.prototype._pointerEventsAllIfOverflow=function(){if(this.getContent().getComputedSize(),this.elements&&this.elements.dockingZone){var e=this.__hasBackground();this._hasScrollbar()?(this.elements.dockingZone.setStyle("pointer-events","all"),this.elements.dockingZoneMask.removeClassName("wux-windows-docking-element-has-background")):e?(this.elements.dockingZone.setStyle("pointer-events",""),this.elements.dockingZoneMask.addClassName("wux-windows-docking-element-has-background")):(this.elements.dockingZone.setStyle("pointer-events",""),this.elements.dockingZoneMask.removeClassName("wux-windows-docking-element-has-background"))}},t.prototype.pointerEventsAllIfOverflow=function(){this._pointerEventsAllIfOverflow()},t.prototype._hasScrollbar=function(){var e,t,i=this.elements.dockingZone;(void 0!==i.currentStyle&&(e=i.currentStyle.overflow),e)||(e=(n=window.getComputedStyle(i,""))?n.overflow:"");if("scroll"===e)return!0;var n,o=this.side==p.WUXDockAreaEnum.RightDockArea||this.side==p.WUXDockAreaEnum.LeftDockArea;o?(void 0!==i.currentStyle&&(t=i.currentStyle.overflowY),t||(t=(n=window.getComputedStyle(i,""))?n.overflowY:"")):(void 0!==i.currentStyle&&(t=i.currentStyle.overflowX),t||(t=(n=window.getComputedStyle(i,""))?n.overflowX:""));return"scroll"===t||0!==i.getChildren().length&&(!(!/^(visible|auto)$/.test(e)&&!/^(visible|auto)$/.test(t))&&(o?i.scrollHeight>i.offsetHeight:i.scrollWidth>i.offsetWidth))},t.COLLAPSER_STYLE=g,t}(o);function k(e){this._pinnedFlag!==e&&(this._pinnedFlag=e,this.collapserStyle===D.COLLAPSER_STYLE.FIXED_AREA&&function(){if(this.collapserStyle!==D.COLLAPSER_STYLE.FIXED_AREA)return;if(this.pinnedFlag){var e=_;this.side&p.WUXDockAreaEnum.RightDockArea?e+=" wux-ui-3ds-open-right":this.side&p.WUXDockAreaEnum.BottomDockArea?e+=" wux-ui-3ds-open-down":this.side&p.WUXDockAreaEnum.LeftDockArea?e+=" wux-ui-3ds-open-left":this.side&p.WUXDockAreaEnum.TopDockArea&&(e+=" wux-ui-3ds-open-up"),this.elements.collapseIcon.className=e}else this.elements.collapseIcon.className=_+" wux-ui-3ds-pin"}.call(this),this.collapserStyle===D.COLLAPSER_STYLE.MOVABLE&&this._updateSizes())}function A(){d.addEventOnElement(this,this.elements.collapser,"click",W.bind(this)),this.collapserStyle===D.COLLAPSER_STYLE.FIXED_AREA&&this.elements.expanderBar.addEventListener("click",W.bind(this))}function W(){this.collapserStyle===D.COLLAPSER_STYLE.MOVABLE&&this._collapserHasBeenMoved||(this._expandTimer?(clearTimeout(this._expandTimer),this._expandTimer=null,this.setPropertyFromUIInteraction("collapseDockingZoneFlag",!1)):this.autoExpandFlag&&!0===this._listenToMouseMove?(this._listenToMouseMove=!1,d.removeEventOnElement(this,document,r.POINTERMOVE,this._onDocumentMouseMoveForAutoExpandBind)):this.setPropertyFromUIInteraction("collapseDockingZoneFlag",!this.collapseDockingZoneFlag),k.call(this,!this.collapseDockingZoneFlag),this.elements.dockingWithCollapserContainer.removeAttribute("expand-hover"),this._saveCollapseDockingZoneFlagInPreferences())}function E(){this.getContent().setAttributeNode(document.createAttribute("collapsed")),this.elements.dockingWithCollapserContainer.setAttributeNode(document.createAttribute("collapsed")),this.resizableFlag&&this.elements.resizeHandler.addClassName(f),this.collapserStyle===D.COLLAPSER_STYLE.FIXED_AREA?this._updateSizes():this._updateDockingZoneSize();var e=-this.dockingZoneSize+"px";switch(this.side){case p.WUXDockAreaEnum.TopDockArea:this.elements.dockingZone.getStyle("top")===e&&"0px"===this.elements.dockingZoneMask.getStyle("height")?this.__onTransitionEnd():this.elements.dockingZone.setStyle("top",e);break;case p.WUXDockAreaEnum.BottomDockArea:"0px"===this.elements.dockingZoneMask.getStyle("height")&&this.__onTransitionEnd();break;case p.WUXDockAreaEnum.LeftDockArea:this.elements.dockingZone.getStyle("left")===e&&"0px"===this.elements.dockingZoneMask.getStyle("width")?this.__onTransitionEnd():this.elements.dockingZone.setStyle("left",e);break;case p.WUXDockAreaEnum.RightDockArea:"0px"===this.elements.dockingZoneMask.getStyle("width")&&this.__onTransitionEnd()}this.fire("collapse")}function F(){this.getContent().removeAttribute("collapsed"),this.elements.dockingWithCollapserContainer.removeAttribute("collapsed"),this.resizableFlag&&!0===this.visibleDockingZoneFlag&&this.elements.resizeHandler.removeClassName(f),this.collapserStyle===D.COLLAPSER_STYLE.FIXED_AREA?this._updateSizes():this._updateDockingZoneSize();switch(this.side){case p.WUXDockAreaEnum.TopDockArea:"0px"!==this.elements.dockingZone.getStyle("top")&&""!==this.elements.dockingZone.getStyle("top")||"0px"===this.elements.dockingZoneMask.getStyle("height")?this.elements.dockingZone.setStyle("top","0px"):this.__onTransitionEnd();break;case p.WUXDockAreaEnum.BottomDockArea:this.elements.dockingZoneMask.getStyle("height")===this.dockingZoneSize+"px"&&this.__onTransitionEnd();break;case p.WUXDockAreaEnum.LeftDockArea:"0px"!==this.elements.dockingZone.getStyle("left")&&""!==this.elements.dockingZone.getStyle("left")||"0px"===this.elements.dockingZoneMask.getStyle("width")?this.elements.dockingZone.setStyle("left","0px"):this.__onTransitionEnd();break;case p.WUXDockAreaEnum.RightDockArea:this.elements.dockingZoneMask.getStyle("width")===this.dockingZoneSize+"px"&&this.__onTransitionEnd()}this.fire("expand")}return h.register(D,"DS/ControlsRec/AbstractRec"),u.addClass(D,"dockingElement"),D}),define("DS/Windows/WindowActivator",["require","exports","DS/Utilities/Dom"],function(e,t,i){"use strict";return function(){function e(){}return e.FindFocusableInChildren=function(e,t){var i=null;if(null==e)return null;if(0==t&&(e.getAttribute("tabindex")||e.tabIndex>=0))return e;for(var n=e.childNodes,o=0;o<n.length;o++){var s=n[o];if(1==s.nodeType){if(s.getAttribute("tabindex")||s.tabIndex>=0){i=s;break}if(i=this.FindFocusableInChildren(s,!1))break}}return i},e.getFocusedWidget=function(e){var t=document.activeElement;return i.isElementInside(t,e)?t:null},e}()}),define("DS/Windows/WindowManager",["require","exports"],function(e,t){"use strict";return function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.setActiveWindow=function(t){return e.getInstance()._setActiveWindow(t)},e.prototype._setActiveWindow=function(e){if(this._activeWindow!==e){var t=this._activeWindow;this._activeWindow=e,this._activeWindow&&(this._activeWindow.activeFlag=!0),t&&(t.activeFlag=!1)}},e.getActiveWindow=function(){return e.getInstance()._activeWindow},e.bringToFront=function(t){return e.getInstance()._bringToFront(t)},e.prototype._bringToFront=function(e){if(e&&!e.getDockedFlag()&&!e.maximizedFlag){var t=e.getZIndex(),i=e.getFloatLayer()?e.getFloatLayer():"middle",n=-1,o=e.immersiveFrame;if(o){var s=[o];o._linkedImmersiveFrames&&s.push.apply(s,o._linkedImmersiveFrames);for(var a=0;a<s.length;a++){var r=s[a];for(var l in r.windows){var d=(u=r.windows[l]).getFloatLayer()?u.getFloatLayer():"middle";if(u&&!u.getDockedFlag()&&u!==e&&d===i){var h=u.getZIndex();n<h&&(n=h)}}}if("bottom"===i&&n>=100){var c=[];for(var l in o.windows){var u;d=(u=o.windows[l]).getFloatLayer()?u.getFloatLayer():"middle";u&&u!==e&&d===i&&c.push(u)}c.sort(function(e,t){return e.getZIndex()>t.getZIndex()?-1:1});for(a=0;a<c.length;a++)n=a+1,c[a].getContent().setStyle("z-index",n.toString())}}if(-1!==n&&n>=t){var p=n+1;e._setZIndex(p)}}},e}()});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Windows/Window",["require","exports","UWA/Core","DS/Core/WebUXGlobalEnums","DS/Core/PointerEvents","DS/Core/WebUXComponents","DS/Core/TooltipManager","DS/Utilities/WUXUWAUtils","DS/Utilities/Utils","DS/Utilities/Dom","DS/Utilities/KeyboardUtils","DS/Utilities/DeviceUtils","DS/Utilities/TouchUtils","DS/Controls/Abstract","DS/Controls/Button","DS/Controls/TooltipModel","DS/Windows/WindowActivator","DS/Windows/WindowManager","DS/Menu/ContextualMenu","i18n!DS/Windows/assets/nls/translation","DS/WUXTypings/typings/WEBUX","DS/WUXTypings/typings/UWA"],function(e,t,i,n,o,s,a,r,l,d,h,c,u,p,m,g,f,w,_,v){"use strict";var y="wux-windows-window";var b=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return r.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{title:{defaultValue:"",type:"string",category:"Appearance"},icon:{defaultValue:"",type:"object",category:"Appearance"},header:{defaultValue:null,type:"object",category:"Appearance"},content:{defaultValue:null,type:"object",category:"Behavior"},immersiveFrame:{defaultValue:null,type:"object",category:"Behavior"},position:{type:"object",category:"Appearance"},activeFlag:{defaultValue:!0,type:"boolean",category:"Behavior",advancedSetter:!0},movableFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},closeButtonFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},expandedFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},allowedDockAreas:{defaultValue:n.WUXDockAreaEnum.NoneDockArea,type:"integer",category:"Behavior"},currentDockArea:{defaultValue:n.WUXDockAreaEnum.NoneDockArea,type:"integer",category:"Behavior",advancedSetter:!0},windowGroup:{defaultValue:null,type:"object",category:"Behavior"},activeSnapArea:{defaultValue:n.WUXSnapAreaEnum.NoneArea,type:"integer",category:"Behavior"},resizableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},width:{defaultValue:-1,type:"integer",category:"Appearance",advancedSetter:!0},height:{defaultValue:-1,type:"integer",category:"Appearance",advancedSetter:!0},minWidth:{defaultValue:150,defaultTouchValue:200,advancedSetter:!0,type:"integer",category:"Appearance"},minHeight:{defaultValue:0,type:"integer",category:"Appearance"},maximizedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},allowMaximizeFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},maximizeButtonFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},horizontallyStretchableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},verticallyStretchableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},autoCloseFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},titleBarVisibleFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},usePaddingFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},ensureHeightDefinitionOnHierarchy:{defaultValue:!1,type:"boolean",category:"Behavior"},activateButtonsIfActionPerformed:{defaultValue:!0,type:"boolean",category:"Behavior"},buttons:{defaultValue:{},type:"object",category:"Behavior"},touchMode:{defaultValue:void 0,type:"boolean",category:"Accessibility",advancedSetter:!0},onContextualEvent:{defaultValue:function(e){return this._buildOrDelagateContextualMenu(e)},type:"function"},getDefaultFocusableElement:{defaultValue:void 0,type:"function",category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_floatLayer:{defaultValue:void 0,type:"string",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.init=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this._savedPreferencesKeys=["position","dimension","dockedDimensions","dockArea","maximizedFlag"],this._titleBarCenteredFlag=!1,this._buttonsVisibleFlag=!0,e.prototype.init.apply(this,t)},t.prototype.buildView=function(){this._defaultButton=null,this.defaultButton=null,this._escapeButton=null,this._prefRestorationState=n.WUXPreferenceRestorationStateEnum.NotRestored,this.elements.container.addClassName("wux-windows-window"),this.elements.container.id=i.Utils.getUUID(),this.elements._titleBarDiv=new i.Element("div",{class:"wux-windows-window-titlebar wux-element-contentbox"}),this.elements._titleBarDiv.inject(this.elements.container),this.elements._titleDiv=new i.Element("div",{class:"wux-windows-window-header-title"}).inject(this.elements._titleBarDiv),this.elements.iconPlaceholder=new i.Element("div",{class:"wux-window-icon-placeholder"}).inject(this.elements._titleDiv),this.elements._titleP=new i.Element("p",{text:this.title}),this.elements._titleP.inject(this.elements._titleDiv),this.elements._titlebarButtonsDiv=new i.Element("div",{class:"wux-windows-window-header-buttons-div"}),this.elements._titlebarButtonsDiv.inject(this.elements._titleBarDiv),this.elements._mainCollapsibleContainer=new i.Element("div",{class:"wux-windows-window-mask-content"}),this.elements._mainCollapsibleContainer.inject(this.elements.container),this.elements._mainContentDiv=new i.Element("div",{class:"wux-windows-window-maincontent wux-element-contentbox"}),this.elements._mainContentDiv.inject(this.elements._mainCollapsibleContainer),this.elements._headerDiv=new i.Element("div",{class:"wux-windows-window-header"}),this.elements._headerDiv.inject(this.elements._mainContentDiv),this.elements._contentDiv=new i.Element("div",{class:"wux-windows-window-content"}),this.elements._contentDiv.inject(this.elements._mainContentDiv),this.elements._ghostFloatableElement=new i.Element("div",{class:"wux-windows-window-ghost-floatable-element"});var e="wux-windows-window-resize-handler";this.elements._topResizeHandler=new i.Element("div",{class:e+" "+e+"-top "+e+"-side"}),this.elements._topResizeHandler.inject(this.elements.container),this.elements._topRightResizeHandler=new i.Element("div",{class:e+" "+e+"-top-right "+e+"-corner"}),this.elements._topRightResizeHandler.inject(this.elements.container),this.elements._rightResizeHandler=new i.Element("div",{class:e+" "+e+"-right "+e+"-side"}),this.elements._rightResizeHandler.inject(this.elements.container),this.elements._bottomRightResizeHandler=new i.Element("div",{class:e+" "+e+"-bottom-right "+e+"-corner"}),this.elements._bottomRightResizeHandler.inject(this.elements.container),this.elements._bottomResizeHandler=new i.Element("div",{class:e+" "+e+"-bottom "+e+"-side"}),this.elements._bottomResizeHandler.inject(this.elements.container),this.elements._bottomLeftResizeHandler=new i.Element("div",{class:e+" "+e+"-bottom-left "+e+"-corner"}),this.elements._bottomLeftResizeHandler.inject(this.elements.container),this.elements._leftResizeHandler=new i.Element("div",{class:e+" "+e+"-left "+e+"-side"}),this.elements._leftResizeHandler.inject(this.elements.container),this.elements._topLeftResizeHandler=new i.Element("div",{class:e+" "+e+"-top-left "+e+"-corner"}),this.elements._topLeftResizeHandler.inject(this.elements.container);var t="wux-windows-window-snap-area";this.elements._topSnapAreaDiv=new i.Element("div",{class:t+" "+t+"-top"}),this.elements._topSnapAreaDiv.inject(this.elements.container),this.elements._bottomSnapAreaDiv=new i.Element("div",{class:t+" "+t+"-bottom"}),this.elements._bottomSnapAreaDiv.inject(this.elements.container),this.elements._leftSnapAreaDiv=new i.Element("div",{class:t+" "+t+"-left"}),this.elements._leftSnapAreaDiv.inject(this.elements.container),this.elements._rightSnapAreaDiv=new i.Element("div",{class:t+" "+t+"-right"}),this.elements._rightSnapAreaDiv.inject(this.elements.container),this.elements._insideSnapAreaDiv=new i.Element("div",{class:t+" "+t+"-inside"}),this.elements._insideSnapAreaDiv.inject(this.elements._titleBarDiv)},t.prototype._postBuildView=function(){e.prototype._postBuildView.call(this),this._updateContentVisibleStateChange();var t=this;d.onNodeRendered(this.getContent(),function(){t._isRendered=!0,t&&t.elements&&t.elements.container&&(t._applyHeight(),t._updateTitleMaxWidth(),t._applyPosition(),!0===t.activeFlag&&t._setFocus())}),this._manageContextualMenu()},t.prototype._manageContextualMenu=function(){if(void 0===this._ctxMenuToken){this._launchWebUXContextMenu=!1;var e=this,t=function(t){if(!e._launchWebUXContextMenu){var i=t.offsetX,n=t.offsetY;e._activateWindowForContextMenu(t.target),e._launchWebUXContextMenu=!0;var o=document.createEvent("HTMLEvents");o.initEvent("contextmenu",!0,!1),o.pageX=t.target.getOffsets().x+i,o.pageY=t.target.getOffsets().y+n,t.target.dispatchEvent(o),e._launchWebUXContextMenu=!1}};if(c.isMobileiOS()){var i,n=function(){window.getSelection&&window.getSelection()?(window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges(),window.getSelection().empty&&window.getSelection().empty()):document.selection&&document.selection.empty&&document.selection.empty()};d.addEventOnElement(this,this.elements._titleBarDiv,"DSlonghold",function(e){a.hide(),t(e),i=setInterval(n,500)}),d.addEventOnElement(this,this.elements._titleBarDiv,o.POINTERUP,function(e){setTimeout(function(){clearInterval(i)},1e3)})}this._ctxMenuToken=_.addEventListener(this.elements._titleBarDiv,{callback:function(t){var i=[];return e._launchWebUXContextMenu?i=e.onContextualEvent.call(e,{context:t.context,window:e,infos:t.info,data:t.data}):i}}),d.addEventOnElement(this,this.elements._titleBarDiv,"contextmenu",function(e){t(e)})}},t.prototype._activateWindowForContextMenu=function(e){this.activeFlag=!0},t.prototype._buildOrDelagateContextualMenu=function(e){var t=[],i=e.window;return e&&i&&(t=i.buildDefaultContextualMenu(e)),t},t.prototype.buildDefaultContextualMenu=function(e,t){this._supportedMenus=["close","maximize"];t=i.extend({close:!0,maximize:!0},t);var n=this,o=[];return this._supportedMenus.forEach(function(i){if(!0===t[i]){var s=i.substring(0,1).toUpperCase()+i.substring(1,i.length),a=n["_create"+s+"ContextualMenu"](e);o=o.concat(a)}}),o},t.prototype._createCloseContextualMenu=function(e){var t=this,i=[],n=t._getMenuToAddData("close",e);return n.canbeAdded&&i.push({type:"PushItem",title:n.closeAll?v.get("closeAllContextualMenu"):v.get("close"),icon:{iconName:"close",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{callback:function(e){t._onCloseContextMenuAction(e.context)},context:n.menuTarget}}),i},t.prototype._createMaximizeContextualMenu=function(e){var t=this,i=[],n=this._getMenuToAddData("maximize",e),o=!!this.maximizedFlag;return n.canbeAdded&&i.push({type:"PushItem",title:o?v.get("restore"):v.get("maximize"),icon:{iconName:o?"resize-small":"resize-full",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{callback:function(e){t.maximizedFlag=!o}}}),i},t.prototype._getMenuToAddData=function(e,t){var i=!1;return"close"===e?i=this.closeButtonFlag:"maximize"===e&&(i=this.maximizeButtonFlag),{canbeAdded:i}},t.prototype._onCloseContextMenuAction=function(e){this.close()},t.prototype._applyTitle=function(e){this.elements._titleP.setText(this.title),this.title?this.elements._titleP.setStyle("padding-left",""):this.elements._titleP.setStyle("padding-left","0"),this.windowGroup&&this.windowGroup._updateTitle()},t.prototype._applyIdentifier=function(){this.identifier&&this.getContent().setAttribute("wux-identifier",this.identifier)},t.prototype._applyTouchMode=function(t){e.prototype._applyTouchMode.call(this,t),!0===this._getCurrentTouchMode()?this.elements._titleBarDiv.setAttributeNode(document.createAttribute("touch-mode")):this.elements._titleBarDiv.removeAttribute("touch-mode"),this._postEditTouchMode()},t.prototype._applyDisabled=function(t){e.prototype._applyDisabled.call(this,t),this.disabled?(this.elements.contentDisabler||(this.elements.contentDisabler=l.createContentDisablerDiv()),this.elements._mainCollapsibleContainer.appendChild(this.elements.contentDisabler)):this.elements.contentDisabler&&this.elements._mainCollapsibleContainer.removeChild(this.elements.contentDisabler)},t.prototype._postEditTouchMode=function(){var e=this._getCurrentTouchMode();this.windowGroup&&(this.windowGroup.touchMode=e),!0===e?this.minWidth===this.publishedProperties.minWidth.defaultValue&&(this.minWidth=this.publishedProperties.minWidth.defaultTouchValue):this.minWidth===this.publishedProperties.minWidth.defaultTouchValue&&(this.minWidth=this.publishedProperties.minWidth.defaultValue),this._applyWidth(),this._applyHeight(),this._applyPosition(),this._updateTitleMaxWidth()},t.prototype.getDefaultButtonLabel=function(e){var t;switch(e){case n.WUXStandardButtonEnum.Ok.name:t=v.get("ok");break;case n.WUXStandardButtonEnum.Open.name:t=v.get("open");break;case n.WUXStandardButtonEnum.Save.name:t=v.get("save");break;case n.WUXStandardButtonEnum.SaveAll.name:t=v.get("saveAll");break;case n.WUXStandardButtonEnum.Yes.name:t=v.get("yes");break;case n.WUXStandardButtonEnum.YesToAll.name:t=v.get("yesToAll");break;case n.WUXStandardButtonEnum.Retry.name:t=v.get("retry");break;case n.WUXStandardButtonEnum.Ignore.name:t=v.get("ignore");break;case n.WUXStandardButtonEnum.Cancel.name:t=v.get("cancel");break;case n.WUXStandardButtonEnum.Apply.name:t=v.get("apply");break;case n.WUXStandardButtonEnum.Reset.name:t=v.get("reset");break;case n.WUXStandardButtonEnum.RestoreDefaults.name:t=v.get("restoreDefaults");break;case n.WUXStandardButtonEnum.Help.name:t=v.get("help");break;case n.WUXStandardButtonEnum.No.name:t=v.get("no");break;case n.WUXStandardButtonEnum.NoToAll.name:t=v.get("noToAll");break;case n.WUXStandardButtonEnum.Abort.name:t=v.get("abort");break;case n.WUXStandardButtonEnum.Discard.name:t=v.get("discard");break;case n.WUXStandardButtonEnum.Close.name:t=v.get("close")}return t},t.prototype._applyIcon=function(e){if("object"==typeof this.icon)this.icon.iconClasses||(this.icon.iconClasses=""),this.icon.iconName||(this.icon.iconName=""),void 0===this.icon.fontIconFamily&&(this.icon.fontIconFamily=WUXManagedFontIcons.Font3DS),this.icon.fontIconSize||(this.icon.fontIconSize="1x");else if("string"==typeof this.icon&&""!==this.icon&&!d.isAPath(this.icon)){var t={iconName:this.icon};this.icon=t}(function(){this.elements.icon&&(this.elements.icon.remove(this.elements.iconPlaceholder),delete this.elements.icon);var e=d.generateIcon(this.icon);e?(this.elements.icon=e,this.elements.iconPlaceholder.show(),this.elements.icon.style.margin="0px",this.elements.icon.inject(this.elements.iconPlaceholder)):this.elements.iconPlaceholder.hide()}).call(this),this.icon?(this.elements.iconPlaceholder.setStyle("padding-left",""),this.elements.iconPlaceholder.setStyle("padding-right","")):(this.elements.iconPlaceholder.setStyle("padding-left","0"),this.elements.iconPlaceholder.setStyle("padding-right","0")),this.windowGroup&&this.windowGroup._updateTitle()},t.prototype._applyHeader=function(e){this.elements._headerDiv.setContent(this.header),this.header?this.elements._headerDiv.show():this.elements._headerDiv.hide(),this._applyPosition()},t.prototype._applyContent=function(e){this.elements._contentDiv.setContent(this.content),this._applyPosition()},t.prototype._applyPosition=function(e){if(this.position){var t=!1;if(this.getEmbeddedState()||this.maximizedFlag&&this.allowMaximizeFlag){if(this.windowGroup&&this.windowGroup.getGroupType()===n.WUXWindowGroupTypeEnum.GroupAsGrid){var i;(i=this._getCompletePosition())&&(t=l.setPosition(this,i,i.of===this.immersiveFrame.getContent()))}}else this._isRendered||this.isAWindowGroup()||l.setPosition(this,this._getDefaultPosition()),(i=this._getCompletePosition())&&(t=l.setPosition(this,i));this._isRendered?this._visibility||(this.fire("_preVisibilityChange"),this._visibility=!0,this.getContent().setStyle("visibility","visible"),this._fireAndBroadcast("visibilityChange",void 0,"visibility")):(this._visibility=!1,this.getContent().setStyle("visibility","hidden")),t&&this.fire("move")}else this.position={}},t.prototype._getCompletePosition=function(){var e=this._getDefaultPosition();return{my:this.position&&this.position.my?this.position.my:e.my,at:this.position&&this.position.at?this.position.at:e.at,of:this.position&&this.position.of?this.position.of:e.of,constraint:this.position&&this.position.constraint?this.position.constraint:e.constraint,offsetX:this.position&&void 0!==this.position.offsetX?this.position.offsetX:e.offsetX,offsetY:this.position&&void 0!==this.position.offsetY?this.position.offsetY:e.offsetY,collision:this.position&&this.position.collision?this.position.collision:e.collision}},t.prototype._preEditActiveFlag=function(e,t){return!this.isBeingClosed()},t.prototype._applyActiveFlag=function(){this.windowGroup||(this.activeFlag?w.getActiveWindow()!=this&&(w.setActiveWindow(this),this.bringToFront()):w.getActiveWindow()===this&&w.setActiveWindow(null)),this.activeFlag?(this.fire("activate"),this._setFocus(this._lastFocusedWidget)):(this.fire("deactivate"),this._unsetFocus())},t.prototype._setFocus=function(e){if(!this.disabled){var t=null;null!=e&&d.isElementInside(e,this.getContent())&&(t=e);var i=this.elements._contentDiv;if(this.visibleFlag){if(null==t&&null!=(t=f.getFocusedWidget(i)))return;if(null==t&&null==(t=this.getDefaultFocusableElement?this.getDefaultFocusableElement():f.FindFocusableInChildren(i,!0))&&(this._defaultButton&&(t=this._defaultButton.getContent()),null==t&&this._escapeButton&&(t=this._escapeButton.getContent())),t){if(u.getTouchMode()&&t instanceof HTMLInputElement)return;t.focus({preventScroll:!0})}this._lastFocusedWidget=t}}},t.prototype._unsetFocus=function(){var e=this._lastFocusedWidget;e&&(e.blur(),null!=e.dsModel&&null!=e.dsModel&&e.dsModel._resetFocus())},t.prototype._applyCloseButtonFlag=function(e){if(this.closeButtonFlag){var t=this;this.elements._closeButton||(this.elements._closeButton=new i.Element("button",{type:"button",class:"wux-windows-window-header-button wux-windows-window-header-close wux-ui-3ds wux-ui-3ds-wrong"}),this.elements._closeButton.tooltipInfos=new g({owner:this.elements._closeButton,shortHelp:v.get("close")}),d.addEventOnElement(t,t.elements._closeButton,"click",function(e){e.stopPropagation(),t._onCloseButtonClick()})),this.elements._closeButton.inject(this.elements._titlebarButtonsDiv,"bottom")}else this.elements._closeButton&&this.elements._closeButton.remove();this.windowGroup&&this.windowGroup._updateCloseButtonFlag(),this._updateTitleMaxWidth()},t.prototype._applyExpandedFlag=function(e){var t=this;if(this.expandedFlag)d.addEventOnElement(this,this.elements._mainContentDiv,"transitionend",function e(i){i.target===t.elements._mainContentDiv&&(i.stopPropagation(),d.removeEventOnElement(t,t.elements._mainContentDiv,"transitionend",e),t._managePointerEvents())}),this.elements._mainContentDiv.removeClassName("wux-windows-window-maincontent-force-collapse"),this.getContent().removeAttribute("collapsed"),this.elements._mainContentDiv.setStyles({"margin-top":"0px"}),this.expandedFlag&&!e&&this.fire("expand");else if(!this.expandedFlag){if(this.getCollapsibleState()){d.addEventOnElement(this,this.elements._mainContentDiv,"transitionend",function e(i){i.target===t.elements._mainContentDiv&&(i.stopPropagation(),t.elements._mainContentDiv.addClassName("wux-windows-window-maincontent-force-collapse"),d.removeEventOnElement(t,t.elements._mainContentDiv,"transitionend",e),t._managePointerEvents())});var i=this.elements._mainContentDiv.getSize().height;this.elements._mainContentDiv.setStyles({"margin-top":"-"+i+"px"}),this.getContent().setAttributeNode(document.createAttribute("collapsed"))}else this.expandedFlag=!0;!this.expandedFlag&&e&&this.fire("collapse")}void 0!==e&&this.expandedFlag!==e&&this._updateContentVisibleStateChange()},t.prototype._applyVisibleFlag=function(t){if(e.prototype._applyVisibleFlag.call(this),this.activeFlag&&this._setFocus(),this._updateContentVisibleStateChange(),this.fire("visibleStateChange"),this.immersiveFrame&&this.currentDockArea!==n.WUXDockAreaEnum.NoneDockArea){var i=this.immersiveFrame.getDockingElement(this.currentDockArea);i&&(i.updateContentVisibility(this.getContent(),this.visibleFlag),i._updateFromContainedWindows(),i._updateContainedWindows()),this._managePointerEvents()}this.visibleFlag&&this._readWindowPreferences(),this.windowGroup&&this.windowGroup._updateWindowVisibility(this),!1===t&&this.visibleFlag&&this._applyPosition()},t.prototype._applyMovableFlag=function(e){this.windowGroup&&this.windowGroup._updateMovableFlag()},t.prototype._applyEnsureHeightDefinitionOnHierarchy=function(e){this.ensureHeightDefinitionOnHierarchy?this.getContent().setAttribute("ensureheightdefinitiononhierarchy",""):this.getContent().removeAttribute("ensureheightdefinitiononhierarchy")},t.prototype._applyButtons=function(e){if(null!=this.elements._buttonsDiv)for(;this.elements._buttonsDiv.childNodes.length>0;){if(!((s=this.elements._buttonsDiv.childNodes[0])&&s.dsModel instanceof m))break;s.remove()}if(this._defaultButton=null,this.defaultButton=null,this._escapeButton=null,this.elements._headerPopup&&(void 0===this.elements._panelButtonsDiv&&(this.elements._panelButtonsDiv=new i.Element("div",{class:"wux-windows-expander-buttons"})),this.elements._panelButtonsDiv.inject(this.elements._buttonsDiv)),this.buttons){var t=Object.keys(this.buttons);t.sort(function(e,t){return n.WUXStandardButtonEnum[e]&&n.WUXStandardButtonEnum[t]?n.WUXStandardButtonEnum[e].value-n.WUXStandardButtonEnum[t].value:e-t});for(var o=0;o<t.length;o++){var s,a=t[o];if(a&&n.WUXStandardButtonEnum[a]){if(s=this.buttons[a]){var r=n.WUXStandardButtonEnum[a].role;r===n.WUXStandardButtonRoleEnum.AcceptRole||r===n.WUXStandardButtonRoleEnum.YesRole?this._defaultButton||(this._defaultButton=s,this.defaultButton=s):r!==n.WUXStandardButtonRoleEnum.RejectRole&&r!==n.WUXStandardButtonRoleEnum.NoRole||this._escapeButton||(this._escapeButton=s),s.value=a,s.dialog=this,null!=this.elements._buttonsDiv&&(this.elements._headerPopup&&this.elements._panelButtonsDiv?s.inject(this.elements._panelButtonsDiv):s.inject(this.elements._buttonsDiv))}}else console.log('Error in Window : "'+a+'" is not a valid standard button')}}this._applyPosition()},t.prototype._apply_floatLayer=function(e){this.getContent().removeAttribute("bottom-layer"),this.getContent().removeAttribute("top-layer"),"bottom"===this._floatLayer?this.getContent().setAttributeNode(document.createAttribute("bottom-layer")):"top"===this._floatLayer&&this.getContent().setAttributeNode(document.createAttribute("top-layer"))},t.prototype.getFloatLayer=function(){return this._floatLayer},t.prototype.getEmbeddedState=function(){return Boolean(null!==this.getContent().getAttribute("docked")||this.windowGroup)},t.prototype.getCollapsibleState=function(){return!1},t.prototype.getFloatableState=function(){return!0},t.prototype.getMovableState=function(){return this.movableFlag},t.prototype.getContentVisibleState=function(){var e=this.visibleFlag&&this.expandedFlag;if(this.windowGroup&&(e=e&&this.windowGroup.getWindowContentVisibleState(this)),this.getDockedFlag()&&this.immersiveFrame){var t=this.immersiveFrame.getDockingElement(this.currentDockArea);t&&(e=e&&!t.collapseDockingZoneFlag&&t.visibleDockingZoneFlag)}return e},t.prototype._updateContentVisibleStateChange=function(){var e=this.getContentVisibleState();this.contentVisibleState!==e&&(this.contentVisibleState=e,this.fire("contentVisibleStateChange",{contentVisibleState:this.contentVisibleState}))},t.prototype.getResizableFlag=function(){return this.resizableFlag},t.prototype._updateFromEmbeddedState=function(){this.getEmbeddedState()?this.getContent().setAttributeNode(document.createAttribute("embedded")):this.getContent().removeAttribute("embedded"),this._updateContentHeight()},t.prototype._updateFromCollapsibleState=function(){!this.getCollapsibleState()||!this.allowMaximizeFlag&&this.maximizedFlag?(this.getContent().removeAttribute("collapsible"),this.expandedFlag=!0):this.getContent().setAttributeNode(document.createAttribute("collapsible"))},t.prototype._preEditCurrentDockArea=function(e,t){return(t===n.WUXDockAreaEnum.NoneDockArea||t===n.WUXDockAreaEnum.TopDockArea||t===n.WUXDockAreaEnum.BottomDockArea||t===n.WUXDockAreaEnum.LeftDockArea||t===n.WUXDockAreaEnum.RightDockArea)&&(((this.allowedDockAreas&t)===t||t===n.WUXDockAreaEnum.NoneDockArea)&&!(t===n.WUXDockAreaEnum.NoneDockArea&&!this.getFloatableState()))},t.prototype._applyCurrentDockArea=function(e){null===this.immersiveFrame||void 0===this.immersiveFrame||this.isBeingClosed()||(this.currentDockArea===n.WUXDockAreaEnum.NoneDockArea?(this.currentDockArea!==e&&this.fire("prePlaceChange",{previousPlace:{currentDockArea:e}}),this.windowGroup&&this.windowGroup.currentDockArea===this.currentDockArea||(this.windowGroup=null,e&&(this.immersiveFrame.undockWindow(this,e),this._isCurrentlyCalledFromUIInteraction()&&this._updateAllWindowsPreferencesInOldDockingElement(e),this.activeFlag&&this.bringToFront())),this.getContent().removeAttribute("docked"),W.call(this,e)):(this.windowGroup&&this.windowGroup.currentDockArea!==this.currentDockArea&&(this.windowGroup=null),this.windowGroup||this._visibility||-1!==this.width&&(this.currentDockArea===n.WUXDockAreaEnum.LeftDockArea||this.currentDockArea===n.WUXDockAreaEnum.RightDockArea)||-1!==this.height&&(this.currentDockArea===n.WUXDockAreaEnum.TopDockArea||this.currentDockArea===n.WUXDockAreaEnum.BottomDockArea)?A.call(this,e):(this.addEventListener("_preVisibilityChange",A.bind(this,e),{once:!0}),this._moveToImmersiveFrame()),this._isCurrentlyCalledFromUIInteraction()&&this._updateAllWindowsPreferencesInOldDockingElement(this.currentDockArea)))},t.prototype._managePointerEvents=function(){this.immersiveFrame&&this.currentDockArea!==n.WUXDockAreaEnum.NoneDockArea&&this.immersiveFrame.getDockingElement(this.currentDockArea).pointerEventsAllIfOverflow()},t.prototype._applyImmersiveFrame=function(e){void 0!==e&&this.immersiveFrame!==e&&this.fire("prePlaceChange",{previousPlace:{immersiveFrame:e}}),e&&e.removeWindow(this),this.immersiveFrame&&(this.immersiveFrame.addWindow(this),this._readWindowPreferences(),this.activeFlag&&this.bringToFront(),this._properties.currentDockArea.dirty=!1,this._applyCurrentDockArea(),this.maximizedFlag&&(this._properties.maximizedFlag.dirty=!1,this._applyMaximizedFlag()),this._updateMaxWidth(),this._updateMaxHeight(),this._applyHeight()),void 0!==e&&this.immersiveFrame!==e&&this.fire("placeChange")},t.prototype._applyWindowGroup=function(e){if(void 0!==e&&this.windowGroup!==e&&this.fire("prePlaceChange",{previousPlace:{windowGroup:e}}),e&&(e.detachWindow(this,this._isCurrentlyCalledFromUIInteraction()),e._updateAllowedDockAreas()),this.windowGroup){if(this._moveTitleBar(!1,null),!this.windowGroup.containsWindow(this)){var t=null,i=this.windowGroup.getEmbeddedWindows();i&&(t=i[i.length-1]),this.windowGroup.attachWindow(this,t,n.WUXSnapAreaEnum.InsideArea)}var o=document.createAttribute("attached-to-group");switch(this.windowGroup.getGroupType()){case n.WUXWindowGroupTypeEnum.GroupAsGrid:o.value="grid";break;case n.WUXWindowGroupTypeEnum.GroupAsTab:o.value="tab"}this.getContent().setAttributeNode(o),this.windowGroup._updateAllowedDockAreas()}else this.getContent().removeAttribute("attached-to-group");this._updateFromEmbeddedState(),void 0!==e&&this.windowGroup!==e&&(this._updateContentVisibleStateChange(),this.fire("placeChange"))},t.prototype._applyActiveSnapArea=function(e){if(this.activeSnapArea===n.WUXSnapAreaEnum.NoneArea||this.activeSnapArea===n.WUXSnapAreaEnum.OutsideArea)this.getContent().removeAttribute("active-snap-area"),this.elements._titleBarDiv.removeAttribute("active-snap-area");else{var t=document.createAttribute("active-snap-area");switch(this.activeSnapArea){case n.WUXSnapAreaEnum.TopArea:t.value="top";break;case n.WUXSnapAreaEnum.BottomArea:t.value="bottom";break;case n.WUXSnapAreaEnum.LeftArea:t.value="left";break;case n.WUXSnapAreaEnum.RightArea:t.value="right";break;case n.WUXSnapAreaEnum.InsideArea:t.value="inside";var i=document.createAttribute("active-snap-area");i.value="inside",this.elements._titleBarDiv.setAttributeNode(i)}this.getContent().setAttributeNode(t)}},t.prototype._applyResizableFlag=function(e){!0===this.resizableFlag?(this.getContent().addClassName("wux-windows-window-vertically-resizable"),this.getContent().addClassName("wux-windows-window-horizontally-resizable")):"vertical"===this.resizableFlag?(this.getContent().addClassName("wux-windows-window-vertically-resizable"),this.getContent().removeClassName("wux-windows-window-horizontally-resizable")):"horizontal"===this.resizableFlag?(this.getContent().addClassName("wux-windows-window-horizontally-resizable"),this.getContent().removeClassName("wux-windows-window-vertically-resizable")):(this.getContent().removeClassName("wux-windows-window-vertically-resizable"),this.getContent().removeClassName("wux-windows-window-horizontally-resizable"))},t.prototype._preEditMinWidth=function(e,t){return null!=t&&!isNaN(t)},t.prototype._applyMinWidth=function(e){this._applyWidth(),this.windowGroup&&this.windowGroup._updateMinWidth(),!this.immersiveFrame||this.currentDockArea!==n.WUXDockAreaEnum.LeftDockArea&&this.currentDockArea!==n.WUXDockAreaEnum.RightDockArea||this.immersiveFrame.getDockingElement(this.currentDockArea)._updateFromContainedWindows()},t.prototype._updateMinWidth=function(){if(!this.windowGroup)if(!this.immersiveFrame||!this.immersiveFrame._ActionBar_V3||this.currentDockArea!==n.WUXDockAreaEnum.TopDockArea&&this.currentDockArea!==n.WUXDockAreaEnum.BottomDockArea||this.maximizedFlag)this._floatingMinWidth&&(this.minWidth=this._floatingMinWidth);else{var e=this.elements._titleDiv,t=window.getComputedStyle(e,null),i=parseInt(t.borderLeft.slice(0,-2)),o=parseInt(t.borderRight.slice(0,-2)),s=parseInt(t.paddingLeft.slice(0,-2)),a=parseInt(t.paddingRight.slice(0,-2)),r=d.computeStringWidth(this.title,parseInt(t.fontSize),t.fontFamily)+s+a+i+o+this._getDragZoneWidth()+3;r>this.minWidth&&(this._floatingMinWidth=this.minWidth,this.minWidth=r)}},t.prototype._preEditWidth=function(e,t){var i=this.minWidth;return!(-1!==t&&void 0!==i&&t<i)||(-1===e||e>i)&&{validValue:i}},t.prototype._applyWidth=function(e){this._updateMaxWidth();var t=this.width;t&&-1!==t?t<this.minWidth&&(t=this.minWidth):this.elements.container&&this.getContent().parentNode&&(i=window.getComputedStyle(this.getContent()))&&Math.round(parseInt(i.width))<t&&(t=this.minWidth);if(-1===t)this.getContent().setStyle("width","auto"),this.elements._mainContentDiv.setStyle("width","auto");else if(this.elements._mainContentDiv.setStyle("width",t+"px"),this.currentDockArea===n.WUXDockAreaEnum.NoneDockArea||this.currentDockArea===n.WUXDockAreaEnum.TopDockArea||this.currentDockArea===n.WUXDockAreaEnum.BottomDockArea){if(this.elements._footerDiv&&this.elements._buttonsDiv){var i=window.getComputedStyle(this.elements._footerDiv,null),o=parseInt(i.paddingLeft);this.elements._buttonsDiv.setStyle("max-width",t-o+"px")}}else this.elements._buttonsDiv&&this.elements._buttonsDiv.setStyle("max-width","");null!==this.header&&this._updateContentHeight(),void 0!==e&&t!==e&&this._fireAndBroadcast("resize",{bubbles:!1}),this.immersiveFrame&&this.immersiveFrame._updateAllDockingZoneSize(),this.windowGroup&&this.windowGroup.width!==t&&this.windowGroup._updateWidthAndHeight(),this._updateTitleBarWidth()},t.prototype._updateTitleBarWidth=function(){if(this.currentDockArea===n.WUXDockAreaEnum.TopDockArea&&this.immersiveFrame&&this.immersiveFrame._ActionBar_V3&&1===this.immersiveFrame.getDockingElement(n.WUXDockAreaEnum.TopDockArea).getContainedVisibleWindows().length){var e=-1!==this.width?this.width:Math.round(parseFloat(window.getComputedStyle(this.elements._mainContentDiv).width)),t=Math.round(parseFloat(window.getComputedStyle(this.immersiveFrame.getDockingElement(n.WUXDockAreaEnum.TopDockArea).elements.dockingZone).width));e>t&&(e=t),e=Math.round(e),this.elements._titleBarDiv.setStyle("width",e+"px")}else this.elements._titleBarDiv.setStyle("width","");this.elements._titleDiv.scrollWidth>this.elements._titleDiv.clientWidth?(this.elements._titleDiv.setAttributeNode(document.createAttribute("overflow")),this.elements._titleDiv.tooltipInfos=new g({shortHelp:this.title,owner:this.elements._titleDiv})):(this.elements._titleDiv.removeAttribute("overflow"),this.elements._titleDiv.tooltipInfos=void 0)},t.prototype._getDragZoneWidth=function(){return this._titleBarCenteredFlag?0:(this._getCurrentTouchMode()?36:22)+this.elements._titlebarButtonsDiv.clientWidth},t.prototype._updateTitleMaxWidth=function(){var e=0;this._titleBarCenteredFlag||(e=(this._getCurrentTouchMode()?36:24)+this.elements._titlebarButtonsDiv.clientWidth);this.elements._titleDiv.setStyle("max-width","calc(100% - "+e+"px)"),this._updateTitleBarWidth()},t.prototype._preEditHeight=function(e,t){if(null!=t&&-1!==t)if(t>=this.minHeight||!this.minHeight){var i=this._getFixedContentHeight(),n=this._getContentPadding();if(t<i+n)return this.height=i+n,!1}else if(this.minHeight&&t<this.minHeight)return this.height=this.minHeight,!1;return!0},t.prototype._applyHeight=function(e){this._updateMaxHeight(),null!==this.height&&void 0!==this.height&&(-1===this.height?this.elements._mainContentDiv.setStyle("height",""):this.elements._mainContentDiv.setStyle("height",this.height+"px"),this._updateContentHeight(),void 0!==e&&this.height!==e&&this._fireAndBroadcast("resize",{bubbles:!1})),this.immersiveFrame&&this.immersiveFrame._updateAllDockingZoneSize(),this._applyMinHeight(),this.windowGroup&&this.windowGroup._updateWidthAndHeight()},t.prototype.getMaxWidth=function(){return this.immersiveFrame.getContent().clientWidth},t.prototype.getMaxHeight=function(){if(this.immersiveFrame){var e=this.immersiveFrame.getContent().clientHeight;if(this.windowGroup){if(this.windowGroup.currentDockArea===n.WUXDockAreaEnum.TopDockArea||this.windowGroup.currentDockArea===n.WUXDockAreaEnum.BottomDockArea)return this.immersiveFrame.getDockingElement(this.windowGroup.currentDockArea).getResizeInfos().maxPossibleSize-this.immersiveFrame.getDockingElement(this.windowGroup.currentDockArea).getCollasperSize()-this.windowGroup._getTitleBarHeight();if(this.windowGroup.height>-1)return Math.min(this.windowGroup.height,e-this.windowGroup._getTitleBarHeight())}return e}},t.prototype._computeDropInsertionData=function(e){var t="after",i=this.immersiveFrame.getSnapTargetWindow();if(!e)return{targetWindow:i,beforeOrAfter:t};var n=this._getTitleWidth(),o=this.elements._titleDiv.getBoundingClientRect();return{targetWindow:i,beforeOrAfter:t=e.x<o.x+n/2?"before":"after"}},t.prototype._updateMaxWidth=function(){if(this.immersiveFrame&&this.immersiveFrame.elements&&this.immersiveFrame.elements.container&&this.immersiveFrame.getContent().clientWidth>0)if(this.currentDockArea!==n.WUXDockAreaEnum.NoneDockArea||this.windowGroup)this._titleBarCenteredFlag&&this.isAWindowGroup()&&this._updateMaxTabbarWidth(),this.getContent().setStyle("maxWidth",""),this.elements._titleBarDiv.setStyle("maxWidth",""),this.elements._mainContentDiv.setStyle("maxWidth","");else{var e=this.getMaxWidth();this.getContent().setStyle("maxWidth",e+"px"),this.elements._titleBarDiv.setStyle("maxWidth",e-2+"px"),this.elements._mainContentDiv.setStyle("maxWidth",e-2+"px")}},t.prototype._updateMaxTabbarWidth=function(){},t.prototype._updateMaxHeight=function(){if(this.immersiveFrame&&this.immersiveFrame.elements&&this.immersiveFrame.elements.container&&this.immersiveFrame.getContent().clientHeight>0)if(this.currentDockArea!==n.WUXDockAreaEnum.NoneDockArea||this.windowGroup)this.getContent().setStyle("maxHeight",""),this.elements._contentDiv.setStyle("maxHeight",""),this.elements._mainContentDiv.setStyle("maxHeight","");else{var e=this.getMaxHeight(),t=this._getTitleBarHeight(),i=this._getFixedContentHeight();this.getContent().setStyle("maxHeight",e+"px"),this.elements._mainContentDiv.setStyle("maxHeight",e-t+"px"),this.elements._contentDiv.setStyle("maxHeight",e-t-i+"px")}},t.prototype._getContentPadding=function(){var e=window.getComputedStyle(this.elements._contentDiv);return(e?parseInt(e.getPropertyValue("padding-top"),10):0)+(e?parseInt(e.getPropertyValue("padding-bottom"),10):0)},t.prototype._getFixedContentHeight=function(){return(this.header?this.elements._headerDiv.offsetHeight:0)+(this.elements._footerDiv?this.elements._footerDiv.offsetHeight:this.elements._buttonsDiv?this.elements._buttonsDiv.offsetHeight:0)},t.prototype._updateContentHeight=function(){var e=this._getFixedContentHeight(),t=this.currentDockArea;if(this.maximizedFlag&&!this.windowGroup&&this.allowMaximizeFlag||this.maximizedFlag&&this.windowGroup&&this.windowGroup.allowMaximizeFlag||t==n.WUXDockAreaEnum.TopDockArea||t==n.WUXDockAreaEnum.BottomDockArea||this.verticallyStretchableFlag&&(t==n.WUXDockAreaEnum.RightDockArea||t==n.WUXDockAreaEnum.LeftDockArea)){var i=0;this.elements._titleBarDiv.getParent()===this.elements.container&&(i=this._getTitleBarHeight()),0===i?this.elements._mainCollapsibleContainer.setStyle("height","100%"):this.elements._mainCollapsibleContainer.setStyle("height","calc(100% - "+i+"px)"),this.elements._contentDiv.setStyle("height","calc(100% - "+e+"px)")}else if(this.immersiveFrame&&this.windowGroup&&this.windowGroup.getGroupType()===n.WUXWindowGroupTypeEnum.GroupAsTab&&-1!==this.height&&this.currentDockArea===n.WUXDockAreaEnum.NoneDockArea){var o=this.getMaxHeight(),s=Math.min(this.height,o);this.elements._mainCollapsibleContainer.setStyle("height",s),this.elements._contentDiv.setStyle("height","calc(100% - "+e+"px)")}else this.elements._mainCollapsibleContainer.setStyle("height",""),-1==this.height?this.elements._contentDiv.setStyle("height","auto"):this.elements._contentDiv.setStyle("height",this.height-e+"px")},t.prototype._applyMinHeight=function(e){var t=this.minHeight;this.height&&-1!==this.height&&this.height<t&&(this.height=t);var i=this._getFixedContentHeight();void 0!==t?this.elements._contentDiv.setStyle("min-height",t-i+"px"):this.elements._contentDiv.setStyle("min-height",""),this.windowGroup&&this.windowGroup._updateMinHeight(),!this.immersiveFrame||this.currentDockArea!==n.WUXDockAreaEnum.TopDockArea&&this.currentDockArea!==n.WUXDockAreaEnum.BottomDockArea||this.immersiveFrame.getDockingElement(this.currentDockArea)._updateFromContainedWindows()},t.prototype._applyMaximizedFlag=function(e){if(this.immersiveFrame){if(this._updateFromCollapsibleState(),void 0!==e&&this.maximizedFlag!==e&&this.fire("prePlaceChange",{previousPlace:{maximizedFlag:e}}),this.maximizedFlag&&this.allowMaximizeFlag){var t=document.createAttribute("maximized");this.getContent().setAttributeNode(t),this.windowGroup?this.windowGroup.maximizedFlag=!0:this.immersiveFrame.moveWindowToMaximizeZone(this),this._updateMaximizeButtonIcon()}else if(!0===e){if(this.getContent().removeAttribute("maximized"),this.windowGroup&&this.windowGroup.maximizedFlag!==this.maximizedFlag&&(this.windowGroup=null),this.getDockedFlag()||this.windowGroup||this.currentDockArea!==n.WUXDockAreaEnum.NoneDockArea){if(!this.windowGroup&&this.currentDockArea!==n.WUXDockAreaEnum.NoneDockArea){var i=this.currentDockArea;this.currentDockArea=n.WUXDockAreaEnum.NoneDockArea,this.immersiveFrame.dockWindow(this,i,{restoreDockedPreferences:!0})}}else this._moveToImmersiveFrame(),this.bringToFront();this._updateMaximizeButtonIcon()}this._updateContentHeight(),void 0!==e&&this.maximizedFlag!==e&&(this._updateContentVisibleStateChange(),this.fire("placeChange"),this._fireAndBroadcast("resize",{bubbles:!1}))}},t.prototype._applyAllowMaximizeFlag=function(e){this.allowMaximizeFlag||(this.maximizedFlag=!1),this._applyMaximizeButtonFlag(),this.windowGroup&&this.windowGroup._updateAllowedDockAreas(),this._updateTitleMaxWidth()},t.prototype._updateMaximizeButtonIcon=function(){this.elements._maximizeButton&&(this.maximizedFlag?(this.elements._maximizeButton.addClassName("wux-ui-3ds-resize-small"),this.elements._maximizeButton.removeClassName("wux-ui-3ds-resize-full"),this.elements._maximizeButton.tooltipInfos.shortHelp=v.get("restore")):(this.elements._maximizeButton.addClassName("wux-ui-3ds-resize-full"),this.elements._maximizeButton.removeClassName("wux-ui-3ds-resize-small"),this.elements._maximizeButton.tooltipInfos.shortHelp=v.get("maximize")))},t.prototype._applyMaximizeButtonFlag=function(e){if(this.maximizeButtonFlag&&this.allowMaximizeFlag){if(!this.elements._maximizeButton){var t=this;this.elements._maximizeButton=new i.Element("button",{type:"button",class:"wux-windows-window-header-button wux-windows-window-header-maximize wux-ui-3ds"}),this.elements._maximizeButton.tooltipInfos=new g({owner:this.elements._maximizeButton,shortHelp:v.get("maximize")}),this._updateMaximizeButtonIcon(),d.addEventOnElement(t,t.elements._maximizeButton,"click",function(e){e.stopPropagation(),t._onMaximizeButtonClick(),t._saveMaximizeInPreferences()})}this.elements._maximizeButton.inject(this.elements._titlebarButtonsDiv,"top")}else this.elements._maximizeButton&&this.elements._maximizeButton.remove();this.windowGroup&&this.windowGroup._updateMaximizeButtonFlag(),this._updateTitleMaxWidth()},t.prototype._applyHorizontallyStretchableFlag=function(e){if(this.horizontallyStretchableFlag?(this.getContent().addClassName("wux-windows-window-horizontally-stretchable"),this.immersiveFrame&&this.immersiveFrame._ActionBar_V3&&this.elements._titleBarDiv.addClassName("wux-windows-window-horizontally-stretchable")):(this.getContent().removeClassName("wux-windows-window-horizontally-stretchable"),this.immersiveFrame&&this.immersiveFrame._ActionBar_V3&&this.elements._titleBarDiv.removeClassName("wux-windows-window-horizontally-stretchable")),this._applyResizableFlag(),this._managePointerEvents(),this.windowGroup&&this.windowGroup._updateHorizontallyStretchableFlag(),this.immersiveFrame){var t=this.currentDockArea;if(t===n.WUXDockAreaEnum.TopDockArea||t===n.WUXDockAreaEnum.BottomDockArea){var i=this.immersiveFrame.getDockingElement(t);i&&i._updateFitToChildState()}}this._updateTitleBarWidth()},t.prototype._applyVerticallyStretchableFlag=function(e){this.verticallyStretchableFlag?this.getContent().addClassName("wux-windows-window-vertically-stretchable"):this.getContent().removeClassName("wux-windows-window-vertically-stretchable"),this._applyResizableFlag(),this._updateContentHeight(),this._managePointerEvents(),this.windowGroup&&this.windowGroup._updateVerticallyStretchableFlag()},t.prototype._applyTitleBarVisibleFlag=function(e){this.elements._titleBarDiv&&(this.titleBarVisibleFlag?this.elements._titleBarDiv.removeClassName("wux-windows-unvisible"):this.elements._titleBarDiv.addClassName("wux-windows-unvisible"))},t.prototype._applyUsePaddingFlag=function(e){this.usePaddingFlag?this.getContent().removeAttribute("no-padding"):this.getContent().setAttributeNode(document.createAttribute("no-padding"))},t.prototype._applyAllowedDockAreas=function(e){if(this.windowGroup&&this.windowGroup._updateAllowedDockAreas(),!(this.getFloatableState()&&this.currentDockArea==n.WUXDockAreaEnum.NoneDockArea||this.currentDockArea&this.allowedDockAreas)){this.getFloatableState()&&(this.currentDockArea=n.WUXDockAreaEnum.NoneDockArea);for(var t=0,i=l.enumKeys(n.WUXDockAreaEnum);t<i.length;t++){var o=i[t];if(n.WUXDockAreaEnum[o]!==n.WUXDockAreaEnum.NoneDockArea&&n.WUXDockAreaEnum[o]&this.allowedDockAreas){this.currentDockArea=n.WUXDockAreaEnum[o];break}}}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("content")&&this._applyContent(t.content),this.isDirty("title")&&this._applyTitle(t.title),this.isDirty("_floatLayer")&&this._apply_floatLayer(t._floatLayer),this.isDirty("immersiveFrame")&&this._applyImmersiveFrame(t.immersiveFrame),this.isDirty("icon")&&this._applyIcon(t.icon),this.isDirty("header")&&this._applyHeader(t.header),this.isDirty("position")&&this._applyPosition(t.position),this.isDirty("activeFlag")&&this._applyActiveFlag(),this.isDirty("closeButtonFlag")&&this._applyCloseButtonFlag(),this.isDirty("currentDockArea")&&s._applyForAdvancedSetterProperty(this,"currentDockArea",t.currentDockArea,this.currentDockArea),this.isDirty("windowGroup")&&this._applyWindowGroup(t.windowGroup),this.isDirty("activeSnapArea")&&this._applyActiveSnapArea(t.activeSnapArea),this.isDirty("resizableFlag")&&this._applyResizableFlag(t.resizableFlag),this.isDirty("width")&&s._applyForAdvancedSetterProperty(this,"width",t.width,this.width),this.isDirty("height")&&s._applyForAdvancedSetterProperty(this,"height",t.height,this.height),this.isDirty("minWidth")&&s._applyForAdvancedSetterProperty(this,"minWidth",t.minWidth,this.minWidth),this.isDirty("minHeight")&&this._applyMinHeight(t.minHeight),this.isDirty("expandedFlag")&&this._applyExpandedFlag(t.expandedFlag),this.isDirty("maximizedFlag")&&this._applyMaximizedFlag(t.maximizedFlag),this.isDirty("horizontallyStretchableFlag")&&this._applyHorizontallyStretchableFlag(t.horizontallyStretchableFlag),this.isDirty("verticallyStretchableFlag")&&this._applyVerticallyStretchableFlag(t.verticallyStretchableFlag),this.isDirty("titleBarVisibleFlag")&&this._applyTitleBarVisibleFlag(t.titleBarVisibleFlag),this.isDirty("usePaddingFlag")&&this._applyUsePaddingFlag(t.usePaddingFlag),this.isDirty("buttons")&&this._applyButtons(t.buttons),this.isDirty("ensureHeightDefinitionOnHierarchy")&&this._applyEnsureHeightDefinitionOnHierarchy(),this.isDirty("touchMode")&&s._applyForAdvancedSetterProperty(this,"touchMode",t.touchMode,this.touchMode),this.isDirty("visibleFlag")&&this._applyVisibleFlag(),this._applyMaximizeButtonFlag()},t.prototype._setTitleBarCenteredFlag=function(e){this._titleBarCenteredFlag!==e&&(this._titleBarCenteredFlag=e,this.elements._titleBarDiv&&(this._titleBarCenteredFlag?(this.elements._titleBarDiv.addClassName("wux-windows-window-titlebar-align-center"),this.elements.container.addClassName("wux-windows-window-align-center")):(this.elements._titleBarDiv.removeClassName("wux-windows-window-titlebar-align-center"),this.elements.container.removeClassName("wux-windows-window-align-center"))),this._updateTitleMaxWidth()),this._setButtonsVisibleFlag(!e)},t.prototype._moveTitleBar=function(e,t){if(this.elements._titleBarDiv){var i=this.elements._titleBarDiv.getParent();if(e&&t){var n=t._getFixedArea();n&&i!==n&&this.elements._titleBarDiv.inject(n)}else i!==this.elements.container&&this.elements._titleBarDiv.inject(this.elements.container,"top")}},t.prototype._setButtonsVisibleFlag=function(e){this._buttonsVisibleFlag!==e&&(this._buttonsVisibleFlag=e,this.elements._titlebarButtonsDiv&&(this._buttonsVisibleFlag?this.elements._titlebarButtonsDiv.removeClassName("wux-windows-unvisible"):this.elements._titlebarButtonsDiv.addClassName("wux-windows-unvisible")))},t.prototype.getAbsolutePosition=function(){return this.windowGroup&&this.windowGroup.getGroupType()===n.WUXWindowGroupTypeEnum.GroupAsTab?this.windowGroup.getAbsolutePosition():this._getOwnAbsolutePosition()},t.prototype._getOwnAbsolutePosition=function(){if(this.elements&&this.elements.container){var e=this.getContent().getPosition(document.body);return this.windowGroup&&this.windowGroup.getGroupType()===n.WUXWindowGroupTypeEnum.GroupAsGrid&&(e.y-=1,0===parseInt(this.elements._mainContentDiv.getStyle("borderLeftWidth"))&&(e.x-=1)),e}},t.prototype.setAbsolutePosition=function(e){if(e){var t=this.getOffsetParentPosition(),i=this.getOffsetParentMargins(),n={x:e.x-t.x-i.left,y:e.y-t.y-i.top},o=this._getReferencePosRelativeToOffsetParent();this.position.offsetX=n.x-o.x,this.position.offsetY=n.y-o.y,this._applyPosition()}},t.prototype.getOffsetParentPosition=function(){var e=this.getContent().getOffsetParent(),t={x:0,y:0};return e&&(t=e.getPosition(document.body)),t},t.prototype.getOffsetParentMargins=function(){var e=this.getContent().getOffsetParent(),t={left:0,right:0,top:0,bottom:0};if(e){var i=window.getComputedStyle(e);""===i.marginLeft?t.left=0:t.left=parseInt(i.marginLeft,10),""===i.marginRight?t.right=0:t.right=parseInt(i.marginRight,10),""===i.marginTop?t.top=0:t.top=parseInt(i.marginTop,10),""===i.marginBottom?t.bottom=0:t.bottom=parseInt(i.marginBottom,10)}return t},t.prototype.getPositionRelativeToOffsetParent=function(){if(this.elements&&this.elements.container){var e=this.getContent().getOffsetParent();return this.getContent().getPosition(e)}},t.prototype.close=function(){this._isBeingClosed=!0,this.fire("close"),this.autoCloseFlag&&this.destroy(),this._isBeingClosed=!1},t.prototype.isBeingClosed=function(){return this._isBeingClosed},t.prototype.destroy=function(){this._isBeingClosed=!0,this.windowGroup&&(this.windowGroup=null),this.currentDockArea!==n.WUXDockAreaEnum.NoneDockArea&&this.immersiveFrame&&this.immersiveFrame.removeWindowFromDockingArea(this,this.currentDockArea),w.getActiveWindow()===this&&w.setActiveWindow(null),this._ctxMenuToken&&_.removeEventListener(this.elements.container,this._ctxMenuToken),this.immersiveFrame=null,e.prototype.destroy.call(this),this._isBeingClosed=!1},t.prototype.getDockedFlag=function(){return this.currentDockArea!==n.WUXDockAreaEnum.NoneDockArea},t.prototype.getZIndex=function(){var e=parseInt(getComputedStyle(this.getContent()).zIndex);return isNaN(e)&&(e=-1),e},t.prototype._setZIndex=function(e){this.getContent().setStyle("z-index",e.toString())},t.prototype.bringToFront=function(){this.windowGroup?this.windowGroup.bringToFront():w.bringToFront(this)},t.prototype.ensureVisible=function(){if(this.visibleFlag=!0,this.expandedFlag=!0,this.windowGroup&&(this.windowGroup.ensureVisible(),this.windowGroup.ensureWindowVisible(this)),this.getDockedFlag()&&this.immersiveFrame){var e=this.immersiveFrame.getDockingElement(this.currentDockArea);e&&(e.collapseDockingZoneFlag=!1,e.activateTab(this._getTopWindow().getContent()))}var t=this.getContent();t&&(t.parentNode.scrollTop=t.offsetTop,t.parentNode.scrollLeft=t.offsetLeft)},t.prototype.getTitleBar=function(){return this.elements._titleBarDiv},t.prototype._getTitleBarHeight=function(){return this.elements._titleBarDiv.offsetHeight},t.prototype._getTitleWidth=function(){return this.elements._titleDiv.offsetWidth},t.prototype._ensureTitleBarUnderPointer=function(e){var t=this.getOffsetParentPosition(),i=this.getOffsetParentMargins(),n=this.getContent().getSize(),o=this._getTitleBarHeight(),s=this.getPositionRelativeToOffsetParent();(s.x+t.x+n.width<e.x||s.x+t.x>=e.x)&&(s.x=e.x-n.width/2-t.x-i.left),(s.y+t.y+o<e.y||s.y+t.y>=e.y)&&(s.y=e.y-o/2-t.y-i.top);var a=this._getReferencePosRelativeToOffsetParent();this.position.offsetX=s.x-a.x,this.position.offsetY=s.y-a.y,this._applyPosition(),this._initialPointerPosition&&(this._initialPointerPosition.x=e.x,this._initialPointerPosition.y=e.y),this._initialWindowOffset&&(this._initialWindowOffset.x=this.position.offsetX,this._initialWindowOffset.y=this.position.offsetY)},t.prototype._canBeSnapSource=function(e,t){return!1},t.prototype._canBeSnapTarget=function(e,t){return!1},t.prototype.getBoundingClientRect=function(){var e=this.getContent().getBoundingClientRect(),t={top:e.top,left:e.left,bottom:e.bottom,right:e.right,x:e.x,y:e.y,width:e.width,height:e.height},i=this.currentDockArea;if((i===n.WUXDockAreaEnum.BottomDockArea||i===n.WUXDockAreaEnum.TopDockArea)&&this.elements._titleBarDiv.getParent()!==this.elements.container){var o=this._getTitleBarHeight();t.top-=o,t.height+=o}return t},t.prototype._getSnapAreaRect=function(e){var t=this.getBoundingClientRect();switch(e){case n.WUXSnapAreaEnum.OutsideArea:return t;case n.WUXSnapAreaEnum.TopArea:return{left:t.left,top:t.top,width:t.width,height:10};case n.WUXSnapAreaEnum.BottomArea:return{left:t.left,top:t.top+t.height-10,width:t.width,height:10};case n.WUXSnapAreaEnum.LeftArea:return{left:t.left,top:t.top,width:10,height:t.height};case n.WUXSnapAreaEnum.RightArea:return{left:t.left+t.width-10,top:t.top,width:10,height:t.height};case n.WUXSnapAreaEnum.InsideArea:var i=this._getTitleBarHeight();return{left:t.left,top:t.top,width:t.width,height:i}}},t.prototype.isAWindowGroup=function(){return Boolean(this.getContent().hasClassName("wux-windows-windowgroup"))},t.prototype._getTopWindow=function(){for(var e=this;e.windowGroup;)e=e.windowGroup;return e},t.prototype.attachToWindow=function(e,t,i){return this._attachToWindow(e,t,i,!1)},t.prototype._attachToWindow=function(e,t,i,o){var s=-1;if(this.elements&&this.elements.container){var a=this.isAWindowGroup();if(this.immersiveFrame&&e&&!o){var r=this._getDetachedFromPreferences();if(e.windowGroup||e.isAWindowGroup())for(var l=(e.isAWindowGroup()?e:e.windowGroup).getEmbeddedWindows(),d=0;d<l.length;d++){var h=l[d];if(h&&-1!==r.indexOf(h.identifier))return-1}else if(-1!==r.indexOf(e.identifier))return-1;if(t===n.WUXSnapAreaEnum.InsideArea){var c=this.__getBestWindowToMakeWindowGroupAsTabFromPref();void 0!==c&&(e=c.targetWindow,i=c.beforeOrAfter)}}if(e&&t!==n.WUXSnapAreaEnum.NoneArea&&t!==n.WUXSnapAreaEnum.OutsideArea&&this._canBeSnapSource(e,t)&&e._canBeSnapTarget(this,t)){var u=t===n.WUXSnapAreaEnum.InsideArea?n.WUXWindowGroupTypeEnum.GroupAsTab:n.WUXWindowGroupTypeEnum.GroupAsGrid,p=e.isAWindowGroup()?e:null;if((!p||p.getGroupType()!==u)&&(p=e.windowGroup)&&p.getGroupType()!==u){if(u===n.WUXWindowGroupTypeEnum.GroupAsGrid){var m=this.windowGroup;return m&&m===p?(m.detachWindow(this),s=this._attachToWindow(e,t,i,o),this._applyHeight(),this._applyWidth(),e._postEditTouchMode(),p._postEditTouchMode(),s):(s=this._attachToWindow(p,t,i,o),this._postEditTouchMode(),e._postEditTouchMode(),p._postEditTouchMode(),s)}p=null}if(!p&&e._createWindowGroup&&(p=e._createWindowGroup(u),e.windowGroup&&e.windowGroup.getGroupType()===n.WUXWindowGroupTypeEnum.GroupAsGrid&&(p.windowGroup=e.windowGroup,e.windowGroup.replaceWindow(e,p)),p&&(p.immersiveFrame=e.immersiveFrame,p._stackWindowNextTo(e,null,n.WUXSnapAreaEnum.NoneArea,i,o),e._postEditTouchMode(),p._postEditTouchMode())),p){if(e.isAWindowGroup()&&e.getGroupType()===u){var g=e.getEmbeddedWindows();e=g[g.length-1]}s=p._stackWindowNextTo(this,e,t,i,o);var f=!0,w=!1;for(d=0;d<p.getEmbeddedWindows().length;d++){var _=p.getEmbeddedWindows()[d];if(!1===_.allowMaximizeFlag){f=!1;break}!0===_.maximizeButtonFlag&&(w=!0)}p.maximizeButtonFlag=f&&w,p._postEditTouchMode()}s&&(!o||a&&0===this.getEmbeddedWindows().length||this._saveWindowGroupInPreferences())}}return s},t.prototype._moveToImmersiveFrame=function(){this.immersiveFrame&&this.immersiveFrame.moveWindowToImmersiveFrame(this)},t.prototype._getDefaultPosition=function(){return{my:"top left",at:"top left",of:this.immersiveFrame?this.immersiveFrame.getContent():document.body,constraint:this.immersiveFrame?this.immersiveFrame.getContent():document.body,offsetX:0,offsetY:0,collision:"fit"}},t.prototype._getReferencePosRelativeToOffsetParent=function(){var e=this._getCompletePosition();return e.offsetX=0,e.offsetY=0,l.getPositionRelativeToOffsetParent(this,e)},t.prototype._fireAndBroadcast=function(e,t,i){this.fire(e,t)},t.prototype._onDragPointerDown=function(e){if(this.getMovableState()){document.body.setAttributeNode(document.createAttribute("dragging"));var t=this;if(t._onDragPointerDownInfos={dimensions:{height:t.height,width:t.width},maximizedFlag:t.maximizedFlag},d.addEventOnElement(t,t,"close",function(e){d.removeEventOnElement(t,t.elements.container.ownerDocument,o.POINTERMOVE,r),d.removeEventOnElement(t,t.elements.container.ownerDocument,o.POINTERUP,l)}),!this.getFloatableState()){this.immersiveFrame&&this.elements._ghostFloatableElement.inject(this.immersiveFrame.elements.container),this.elements._ghostFloatableElement.setStyles({width:this.elements.container.getStyle("width"),height:this.elements.container.getStyle("height")}),this._initialGhostWindowOffset||(this._initialGhostWindowOffset={x:0,y:0});var i=this.getPositionRelativeToOffsetParent(),n=this._getReferencePosRelativeToOffsetParent();this._initialGhostWindowOffset.x=i.x-n.x,this._initialGhostWindowOffset.y=i.y-n.y}this._initialPointerPosition.x=e.clientX,this._initialPointerPosition.y=e.clientY;var s=this.getPositionRelativeToOffsetParent(),a=this._getReferencePosRelativeToOffsetParent();this._initialWindowOffset.x=s.x-a.x,this._initialWindowOffset.y=s.y-a.y,d.addEventOnElement(this,this.elements.container.ownerDocument,o.POINTERMOVE,r),d.addEventOnElement(this,this.elements.container.ownerDocument,o.POINTERUP,l),this.fire("startWindowDrag")}function r(e){e.preventDefault(),t._onDragPointerMove(e)}function l(e){t._onDragPointerUp(e),t.elements.container&&(d.removeEventOnElement(t,t.elements.container.ownerDocument,o.POINTERMOVE,r),d.removeEventOnElement(t,t.elements.container.ownerDocument,o.POINTERUP,l)),t._savePositionInPreferences(),t._onDragPointerDownInfos.dimensions.height===t.height&&t._onDragPointerDownInfos.dimensions.width===t.width||t._saveDimensionsInPreferences(),t._onDragPointerDownInfos.maximizedFlag!==t.maximizedFlag&&t._saveMaximizeInPreferences(),document.body.removeAttribute("dragging"),t.immersiveFrame&&t.immersiveFrame._resetStackedWindowData()}},t.prototype._onDragPointerMove=function(e){if(0===e.button){e.preventDefault();var t=e.clientX-this._initialPointerPosition.x,i=e.clientY-this._initialPointerPosition.y;if(0!==t||0!==i){var n={};if("top left"!==this.position.my||"top left"!==this.position.at){n.my="top left",n.at="top left",n.of=this.immersiveFrame?this.immersiveFrame.getContent():d.getDocumentOwner(this.getContent()).body;var o=this.getPositionRelativeToOffsetParent();this._initialWindowOffset.x=o.x,this._initialWindowOffset.y=o.y}if(n.offsetX=this._initialWindowOffset.x+t,n.offsetY=this._initialWindowOffset.y+i,this.modifyObjectFromUIInteraction("position",n),this.getFloatableState()){if(this.maximizedFlag&&(Math.abs(t)>15||Math.abs(i)>15)){this.setPropertyFromUIInteraction("maximizedFlag",!1),this._saveMaximizeInPreferences();var s={x:e.clientX,y:e.clientY};this._ensureTitleBarUnderPointer(s)}}else{if(!this.ghostPosition){var a=this._getCompletePosition();this.ghostPosition=a}this.ghostPosition.offsetX=this._initialGhostWindowOffset.x+t,this.ghostPosition.offsetY=this._initialGhostWindowOffset.y+i,l.setPosition(this.elements._ghostFloatableElement,this.ghostPosition),this.elements._ghostFloatableElement.show()}(this.immersiveFrame?this.immersiveFrame._computeFiringWindowDragEvents(this):this).fire("windowDrag",{x:e.clientX,y:e.clientY,deltaX:t,deltaY:i})}}},t.prototype._onDragPointerUp=function(e){this.elements._ghostFloatableElement.hide(),this._setFocus(this._lastFocusedWidget),this.fire("stopWindowDrag",{x:e.clientX,y:e.clientY})},t.prototype._onCloseButtonClick=function(){this.disabled||this.callMethodFromUIInteraction("close")},t.prototype._onMaximizeButtonClick=function(){this.allowMaximizeFlag&&this.setPropertyFromUIInteraction("maximizedFlag",!this.maximizedFlag)},t.prototype.handleEvents=function(){var e=this;d.addEventOnElement(this,document,"touchChange",function(){e._applyWidth(),e._applyHeight(),e._applyPosition()}),d.addEventOnElement(this,this.getContent(),"dimensionsChanged",function(t){if((-1===e.height||e.maximizedFlag||e.header)&&e._updateContentHeight(),-1!==e.height&&-1!==e.width||(e._applyPosition(),e.windowGroup?e.windowGroup._updateTitleBarWidth():e._updateTitleBarWidth()),e.currentDockArea!==n.WUXDockAreaEnum.NoneDockArea){var i=e.immersiveFrame.getDockingElement(e.currentDockArea);i&&i.pointerEventsAllIfOverflow()}t.stopPropagation()}),d.addEventOnElement(this,this.elements.container,"keydown",function(t){var i=null;switch(t.keyCode){case h.ENTER:i=e._defaultButton;break;case h.ESCAPE:i=e._escapeButton}i&&(e._buttonOnKeydownPressed=i,t.stopPropagation())}),d.addEventOnElement(this,this.elements.container,"keyup",function(t){var i=null;if(!t.altKey&&!t.shiftKey&&!t.ctrlKey){switch(t.keyCode){case h.ENTER:i=e._defaultButton;break;case h.ESCAPE:i=e._escapeButton}!i||t.keyCode===h.ENTER&&d.isElementInside(t.target,e.elements._buttonsDiv)||e._buttonOnKeydownPressed!==i||!e.activateButtonsIfActionPerformed&&t.actionPerformed||(i.getContent().click(),t.stopPropagation(),t.preventDefault()),e._buttonOnKeydownPressed=void 0}}),this._initialPointerPosition||(this._initialPointerPosition={x:0,y:0}),this._initialWindowOffset||(this._initialWindowOffset={x:0,y:0}),this._initialWindowSize||(this._initialWindowSize={height:0,width:0}),d.addEventOnElement(this,e.elements.container,o.POINTERDOWN,function(t){e.activeFlag||(e.setPropertyFromUIInteraction("activeFlag",!0),d.addEventOnElement(e,document.body,o.POINTERUP,function(t){d.isElementInside(t.target,e.getContent())&&!d.isElementInside(document.activeElement,e.getContent())&&e._setFocus(e._lastFocusedWidget)},{once:!0}))}),d.addEventOnElement(this,e.elements._titleBarDiv,o.POINTERDOWN,function(t){e.setPropertyFromUIInteraction("activeFlag",!0),d.isElementInside(t.target,e.elements._titlebarButtonsDiv)||e.elements._tabBarContainer&&d.isElementInside(t.target,e.elements._tabBarContainer)||0!==t.button||e._onDragPointerDown(t)}),d.addEventOnElement(this,e.elements._titleBarDiv,o.POINTERHIT,function(t){2===t.multipleHitCount&&(t.preventDefault(),!e.getCollapsibleState()||d.isElementInside(t.target,e.elements._titlebarButtonsDiv)||e.elements._tabBarContainer&&d.isElementInside(t.target,e.elements._tabBarContainer)||(t.stopPropagation(),e.setPropertyFromUIInteraction("expandedFlag",!e.expandedFlag)))});var t=function(t,i){e._deltaPositionY=t-e._initialPointerPosition.y;var n=e._getCompletePosition(),o=0;e.windowGroup&&(o=e.windowGroup._getResizeOffset(e,"top")),"fit"===n.collision&&e._initialBoundingRect.top-o+e._deltaPositionY<0&&(e._deltaPositionY=-e._initialBoundingRect.top+o),e._initialWindowSize.height-e._deltaPositionY<i&&(e._deltaPositionY=e._initialWindowSize.height-i)};function i(i){i.preventDefault();var n=e._getFixedContentHeight();t(i.clientY,n),e.setPropertyFromUIInteraction("height",e._initialWindowSize.height-e._deltaPositionY),e._deltaPositionY=e._initialWindowSize.height-e.height,D.call(e,null,"top","topHandlerPointerMove")}var s=function(t,i){e._deltaPositionY=t-e._initialPointerPosition.y;var n=e.immersiveFrame?e.immersiveFrame.getContent().clientHeight-e.immersiveFrame.getContent().clientTop:document.body.clientHeight||window.innerHeight,o=e._getCompletePosition(),s=0;e.windowGroup&&(s=e.windowGroup._getResizeOffset(e,"bottom"));var a=n-e._initialBoundingRect.bottom-e._deltaPositionY-s;"fit"===o.collision&&a<0&&(e._deltaPositionY=n-e._initialBoundingRect.bottom-s),e._initialWindowSize.height+e._deltaPositionY<i&&(e._deltaPositionY=i-e._initialWindowSize.height)};function a(t){t.preventDefault();var i=e._getFixedContentHeight();s(t.clientY,i),e.setPropertyFromUIInteraction("height",e._initialWindowSize.height+e._deltaPositionY),e._deltaPositionY=e.height-e._initialWindowSize.height,D.call(e,null,"bottom","bottomHandlerPointerMove")}var r=function(t){e._deltaPositionX=t-e._initialPointerPosition.x;var i=0;e.windowGroup&&(i=e.windowGroup._getResizeOffset(e,"right"));var n=e.immersiveFrame?e.immersiveFrame.getContent().clientWidth-e.immersiveFrame.getContent().clientLeft:document.body.clientWidth||window.innerWidth;"fit"===e._getCompletePosition().collision&&e._deltaPositionX>n-e._initialBoundingRect.right-i&&(e._deltaPositionX=n-e._initialBoundingRect.right-i),e._initialWindowSize.width+e._deltaPositionX<0&&(e._deltaPositionX=-e._initialWindowSize.width)};function l(t){t.preventDefault(),r(t.clientX);var i=e._deltaPositionX;e.currentDockArea===n.WUXDockAreaEnum.BottomDockArea&&"center"===e.immersiveFrame.getDockingElement(n.WUXDockAreaEnum.BottomDockArea).alignment&&(i=2*e._deltaPositionX);var o=e._initialWindowSize.width+i;e.windowGroup&&(o=e.windowGroup._getAcceptableWidthForEmbeddedWindowResize(e,o)),e.setPropertyFromUIInteraction("width",o),e._deltaPositionX=e.width-e._initialWindowSize.width,D.call(e,"right",null,"rightHandlerPointerMove")}var c=function(t){e._deltaPositionX=t-e._initialPointerPosition.x;var i=0;e.windowGroup&&(i=e.windowGroup._getResizeOffset(e,"left")),"fit"===e._getCompletePosition().collision&&e._initialBoundingRect.left+e._deltaPositionX+i<0&&(e._deltaPositionX=-e._initialBoundingRect.left-i),e._initialWindowSize.width-e._deltaPositionX<0&&(e._deltaPositionX=e._initialWindowSize.width)};function u(t){t.preventDefault(),c(t.clientX);var i=e._initialWindowSize.width-e._deltaPositionX;e.windowGroup&&(i=e.windowGroup._getAcceptableWidthForEmbeddedWindowResize(e,i)),e.setPropertyFromUIInteraction("width",i),e._deltaPositionX=e._initialWindowSize.width-e.width,D.call(e,"left",null,"leftHandlerPointerMove")}function p(t){i.call(e,t),u.call(e,t)}function m(t){i.call(e,t),l.call(e,t)}function g(t){a.call(e,t),l.call(e,t)}function f(t){a.call(e,t),u.call(e,t)}function w(t){(e._deltaPositionX=void 0,e._deltaPositionY=void 0,e.windowGroup&&e.windowGroup._onStopInteractiveResizeOfEmbeddedWindow(e),e._fireAndBroadcast("stopResize"),d.removeEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,i),d.removeEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,l),d.removeEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,a),d.removeEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,u),d.removeEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,p),d.removeEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,m),d.removeEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,g),d.removeEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,f),d.removeEventOnElement(e,e.elements.container.ownerDocument,o.POINTERUP,w),document.body.removeAttribute("resizing"),e.immersiveFrame)&&(e.immersiveFrame.getDockingElement(e.currentDockArea)&&e._managePointerEvents());e._saveDimensionsInPreferences(),e._savePositionInPreferences(),e._setFocus(e._lastFocusedWidget)}function _(t){document.body.setAttributeNode(document.createAttribute("resizing")),e.setPropertyFromUIInteraction("activeFlag",!0),e._initialPointerPosition.x=t.clientX,e._initialPointerPosition.y=t.clientY,e._initialBoundingRect=e.elements.container.getBoundingClientRect(),e.immersiveFrame&&e.currentDockArea===n.WUXDockAreaEnum.NoneDockArea&&(e._initialBoundingRect=k.call(e)),e._initialWindowSize.width=e.elements._mainContentDiv.clientWidth,e._initialWindowSize.height=e.elements._mainContentDiv.clientHeight;var i=e.getPositionRelativeToOffsetParent(),o=e._getReferencePosRelativeToOffsetParent();e._initialWindowOffset.x=i.x-o.x,e._initialWindowOffset.y=i.y-o.y}this.elements._resizeZone&&d.addEventOnElement(this,this.elements._resizeZone,o.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"bottom right",cursor:"nw-resize"}),_(t),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,g),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERUP,w)}),d.addEventOnElement(this,this.elements._topResizeHandler,o.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"top",cursor:"s-resize"}),_(t),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,i),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERUP,w)}),d.addEventOnElement(this,this.elements._bottomResizeHandler,o.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"bottom",cursor:"s-resize"}),_(t),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,a),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERUP,w)}),d.addEventOnElement(this,this.elements._rightResizeHandler,o.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"right",cursor:"w-resize"}),_(t),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,l),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERUP,w)}),d.addEventOnElement(this,this.elements._leftResizeHandler,o.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"left",cursor:"w-resize"}),_(t),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,u),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERUP,w)}),d.addEventOnElement(this,this.elements._topLeftResizeHandler,o.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"top left",cursor:"nw-resize"}),_(t),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,p),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERUP,w)}),d.addEventOnElement(this,this.elements._topRightResizeHandler,o.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"top right",cursor:"sw-resize"}),_(t),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,m),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERUP,w)}),d.addEventOnElement(this,this.elements._bottomRightResizeHandler,o.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"bottom right",cursor:"nw-resize"}),_(t),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,g),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERUP,w)}),d.addEventOnElement(this,this.elements._bottomLeftResizeHandler,o.POINTERDOWN,function(t){e._fireAndBroadcast("startResize",{side:"bottom left",cursor:"sw-resize"}),_(t),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERMOVE,f),d.addEventOnElement(e,e.elements.container.ownerDocument,o.POINTERUP,w)})},t.prototype._hasValidIdentifier=function(){if(""!==this.identifier){var e=Math.floor(Number(this.identifier));return e<0||String(e)!==this.identifier}return!1},t.prototype._saveDataInPreferences=function(e,t){this._hasValidIdentifier()&&l.saveDataInLocalPreferences(this,y,e,t)},t.prototype._getDataFromPreferences=function(e){var t=void 0;return this._hasValidIdentifier()&&(t=l.getDataFromLocalPreferences(this,y,e)),t},t.prototype._savePositionInPreferences=function(){if(this.identifier){var e=this;this.windowGroup&&(e=this.windowGroup);var t={my:e.position.my,at:e.position.at,collision:e.position.collision,offsetX:e.position.offsetX,offsetY:e.position.offsetY};this._saveDataInPreferences("position",t)}},t.prototype._getPositionFromPreferences=function(){return this._getDataFromPreferences("position")},t.prototype._saveDimensionsInPreferences=function(){if(this.identifier){var e={height:this.height,width:this.width};this._saveDataInPreferences("dimension",e)}},t.prototype._getDimensionsFromPreferences=function(){return this._getDataFromPreferences("dimension")},t.prototype._saveDockedDimensionsInPreferences=function(){if(this.identifier&&this.immersiveFrame){var e=void 0;this.currentDockArea===n.WUXDockAreaEnum.NoneDockArea?e={height:void 0,width:void 0}:((e=this._getDockedDimensionsFromPreferences())||(e={}),this.currentDockArea===n.WUXDockAreaEnum.LeftDockArea||this.currentDockArea===n.WUXDockAreaEnum.RightDockArea?e.width=this.immersiveFrame.getDockingElement(this.currentDockArea).dockingZoneSize:e.height=this.immersiveFrame.getDockingElement(this.currentDockArea).dockingZoneSize),this._saveDataInPreferences("dockedDimensions",e)}},t.prototype._getDockedDimensionsFromPreferences=function(){return this._getDataFromPreferences("dockedDimensions")},t.prototype._updateAllWindowsPreferencesInOldDockingElement=function(e,t){if(this.immersiveFrame){var i=[],o=[];e!==n.WUXDockAreaEnum.NoneDockArea&&((o=this.immersiveFrame.getDockingElement(e).getContainedVisibleWindows()).length>0&&o.map(function(e){if(e.isAWindowGroup()){var t=E(e);i.push(t)}else e._hasValidIdentifier()&&i.push(e.identifier)}),o.length>0&&o.map(function(n){if(n.isAWindowGroup())for(var o=n.getVisibleEmbeddedWindows(),s=0;s<o.length;s++){var a=o[s];a._saveDataInPreferences("dockAreaOrder",i),t&&a._saveDataInPreferences("dockArea",e)}else n._hasValidIdentifier()&&(n._saveDataInPreferences("dockAreaOrder",i),t&&n._saveDataInPreferences("dockArea",e))}))}},t.prototype._saveDockAreaInPreferences=function(){if(this.identifier&&this.immersiveFrame){var e=[];this.currentDockArea!==n.WUXDockAreaEnum.NoneDockArea&&(e=this.immersiveFrame.getDockingElement(this.currentDockArea).getContainedVisibleWindows());var t=this.currentDockArea;e.length>0?this._updateAllWindowsPreferencesInOldDockingElement(t,!0):this._saveDataInPreferences("dockAreaOrder",[]),this._saveDataInPreferences("dockArea",t)}},t.prototype._getDockAreaFromPreferences=function(){return this._getDataFromPreferences("dockArea")},t.prototype._getDockAreaOrderFromPreferences=function(){return this._getDataFromPreferences("dockAreaOrder")},t.prototype._getDockAreaIndexFromPreferences=function(){var e=this._getDockAreaOrderFromPreferences();if(e){for(var t=0;t<e.length;t++){if(e[t]===this.identifier)return t;if(Array.isArray(e[t])&&F(this.identifier,e[t]))return t}return e.indexOf(this.identifier)}},t.prototype._getMaximizedFlagFromPreferences=function(){return this._getDataFromPreferences("maximizedFlag")},t.prototype._saveMaximizeInPreferences=function(){if(this.identifier){var e=this.maximizedFlag;this._saveDataInPreferences("maximizedFlag",e)}},t.prototype._getWindowGroupAsTabFromPreferences=function(){var e=this._getDataFromPreferences("windowGroupAsTab");return e||(e=[]),e},t.prototype._saveWindowGroupAsTabInPreferences=function(e){this._saveDataInPreferences("windowGroupAsTab",e)},t.prototype.__getBestWindowToMakeWindowGroupAsTabFromPref=function(){var e=this._getWindowGroupAsTabFromPreferences();if(e&&e.length>0)for(var t=e.length-1;t>=0;t--){for(var i=e[t],n=void 0,o=void 0,s=void 0,a=0;a<i.length;a++){var r=i[a];if(r===this.identifier)n=a;else if(this.immersiveFrame.windows[r]){var l=this.immersiveFrame.windows[r];if(l.currentDockArea===this.currentDockArea&&l.maximizedFlag===this.maximizedFlag){if(void 0!==n){if(s){if(n-o>a-n){s=r,o=a;break}break}s=r,o=a;break}s=r,o=a}}}if(void 0!==n&&s&&void 0!==o){var d=n<o?"before":"after";return{targetWindow:this.immersiveFrame.windows[s],beforeOrAfter:d}}}},t.prototype._getSnappingFromPreferences=function(){var e=this._getDataFromPreferences("windowGroupAsGrid");return e||(e=[]),e},t.prototype._saveSnappingInPreferences=function(e){this._saveDataInPreferences("windowGroupAsGrid",e)},t.prototype._getDetachedFromPreferences=function(){var e=this._getDataFromPreferences("detachedFrom");return e||(e=[]),e},t.prototype._saveDetachedInPreferences=function(e){this._saveDataInPreferences("detachedFrom",e)},t.prototype._saveWindowGroupInPreferences=function(e){if(this.isAWindowGroup())for(var t=this.getEmbeddedWindows(),i=0;i<t.length;i++){(d=t[i])&&void 0!==d.identifier&&(!e||e.isAWindowGroup()&&0===e.getEmbeddedWindows().length||d._saveWindowGroupInPreferences(e))}else if(this.identifier)if(e){var o=this._getDetachedFromPreferences();if(e.isAWindowGroup())for(t=e.getEmbeddedWindows(),i=0;i<t.length;i++){if((d=t[i])&&void 0!==d.identifier){0!==o.length&&-1!==o.indexOf(d.identifier)||d.identifier===this.identifier||o.push(d.identifier);var s=d._getDetachedFromPreferences();0!==s.length&&-1!==s.indexOf(this.identifier)||(s.push(this.identifier),d._saveDetachedInPreferences(s))}}else{void 0===e.identifier||0!==o.length&&-1!==o.indexOf(e.identifier)||o.push(e.identifier);var a=e._getDetachedFromPreferences();0!==a.length&&-1!==a.indexOf(this.identifier)||void 0===e.identifier||(a.push(this.identifier),e._saveDetachedInPreferences(a))}if(this._saveDetachedInPreferences(o),e.isAWindowGroup())for(t=e.getEmbeddedWindows(),i=0;i<t.length;i++){(d=t[i])&&void 0!==d.identifier&&(this._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(this,d.identifier,this._getWindowGroupAsTabFromPreferences())),d._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(d,this.identifier,d._getWindowGroupAsTabFromPreferences())))}else void 0!==e.identifier&&(this._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(this,e.identifier,this._getWindowGroupAsTabFromPreferences())),e._saveWindowGroupAsTabInPreferences(this._locateAndRemoveWindowFromWGAsTabPreferencesArray(e,this.identifier,e._getWindowGroupAsTabFromPreferences())));this.windowGroup&&this._saveWindowGroupInPreferences()}else if(this.windowGroup){var r=this.windowGroup;if(r.getGroupType()===n.WUXWindowGroupTypeEnum.GroupAsTab){r.windowGroup&&r.windowGroup.getGroupType()===n.WUXWindowGroupTypeEnum.GroupAsGrid&&r.windowGroup;var l=E(r);for(t=r.getEmbeddedWindows(),i=0;i<t.length;i++){(d=t[i])&&void 0!==d.identifier&&d._saveWindowGroupAsTabInPreferences(d._addWGAsTabPreferences(l))}for(i=0;i<t.length;i++){var d;if((d=t[i])&&void 0!==d.identifier){o=d._getDetachedFromPreferences();if(d.identifier===this.identifier){for(var h=0;h<l.length;h++){var c=l[h];-1!==o.indexOf(c)&&o.splice(o.indexOf(c),1)}d._saveDetachedInPreferences(o)}else-1!==o.indexOf(this.identifier)&&(o.splice(o.indexOf(this.identifier),1),d._saveDetachedInPreferences(o))}}}else r.getGroupType()===n.WUXWindowGroupTypeEnum.GroupAsGrid&&r}else console.log("Saving the preferences of a Window that is being attached to nothing... failed")},t.prototype._locateAndRemoveWindowFromWGAsTabPreferencesArray=function(e,t,i){for(var n=0;n<i.length;n++){var o=i[n];if(-1!==o.indexOf(t)){o.splice(o.indexOf(t),1),1===o.length&&(o[0]===e.identifier?i.splice(n,1):console.log("There is a WindowGroup preferences that is composed of only one Window, but it is not the Window in question"));break}}return i},t.prototype._addWGAsTabPreferences=function(e){var t=this._getWindowGroupAsTabFromPreferences();if(-1===t.indexOf(e)){for(var i=0;i<e.length;i++){var n=e[i];n!==this.identifier&&(t=this._locateAndRemoveWindowFromWGAsTabPreferencesArray(this,n,t))}return t.push(e),t}console.log("preferences for this WindowGroup have already been saved : "+this.identifier)},t.prototype.arePreferencesRestored=function(){return this._prefRestorationState===n.WUXPreferenceRestorationStateEnum.Restored},t.prototype._readWindowPreferences=function(){if(this._hasValidIdentifier()&&this.visibleFlag&&this.immersiveFrame&&this.immersiveFrame.containsWindow(this)&&this._prefRestorationState===n.WUXPreferenceRestorationStateEnum.NotRestored){if(this._prefRestorationState=n.WUXPreferenceRestorationStateEnum.BeingRestored,this.visibleFlag){var e=this._getDimensionsFromPreferences();e&&(this._properties.height.dirty=!1,this._properties.width.dirty=!1,this.height=e.height,this.width=e.width)}var t=this._getDockAreaFromPreferences(),i=this._getDockAreaOrderFromPreferences();if(void 0!==t){this._properties.currentDockArea.dirty=!1;var o=this.immersiveFrame&&this.immersiveFrame.windows?this.immersiveFrame.windows:[];i&&i.length>0?i.map(function(e){var i=o[e];i&&(i.currentDockArea=t)}):this.currentDockArea=t}var s=this._getMaximizedFlagFromPreferences();void 0!==s&&(this._properties.maximizedFlag.dirty=!1,this.maximizedFlag=s);var a=this.__getBestWindowToMakeWindowGroupAsTabFromPref();void 0!==a&&this.attachToWindow(a.targetWindow,n.WUXSnapAreaEnum.InsideArea,a.beforeOrAfter);var r=this._getPositionFromPreferences();if(r){var l={at:r.at,collision:r.collision,my:r.my,offsetX:r.offsetX,offsetY:r.offsetY};this.windowGroup?this.windowGroup.position=l:(this._properties.position.dirty=!1,this.position=l)}this._prefRestorationState=n.WUXPreferenceRestorationStateEnum.Restored}},t.prototype.deleteWindowPreferences=function(){for(var e=0;e<this._savedPreferencesKeys.length;e++){var t=this._savedPreferencesKeys[e];l.deleteDataFromLocalPreferences(this,y,t)}var i=this._getDetachedFromPreferences();for(e=0;e<i.length;e++){var n=i[e],o=l.getDataFromLocalPreferences(n,y,"detachedFrom");o.splice(o.indexOf(this.identifier),1),l.saveDataInLocalPreferences(n,y,"detachedFrom",o)}l.deleteDataFromLocalPreferences(this,y,"detachedFrom");var s=this._getWindowGroupAsTabFromPreferences();for(e=0;e<s.length;e++)for(var a=s[e],r=0;r<a.length;r++){var d=a[r];if(d!==this.identifier){var h=l.getDataFromLocalPreferences(d,y,"windowGroupAsTab");if(h){for(var c=0;c<h.length;c++){var u=h[c];-1!==u.indexOf(this.identifier)&&u.splice(u.indexOf(this.identifier),1),u.length<=1&&h.splice(c,1)}l.saveDataInLocalPreferences(d,y,"windowGroupAsTab",h)}}}l.deleteDataFromLocalPreferences(this,y,"windowGroupAsTab"),this.immersiveFrame&&this._updateAllWindowsPreferencesInOldDockingElement(this.currentDockArea,!1),l.deleteDataFromLocalPreferences(this,y,"dockAreaOrder")},t}(p),D=function(e,t){var i=!1,n=void 0,o=void 0,s=this._getCompletePosition();if(t&&(this.height>=this.minHeight||void 0===this.minHeight&&this.height>=0)){var a=this._getFixedContentHeight();this.height>=a&&(s.my.indexOf(t)>-1&&(o=this._initialWindowOffset.y+this._deltaPositionY,i=!0),(s.my.indexOf("center")>-1||"left"===s.my||"right"===s.my)&&(o=this._initialWindowOffset.y+this._deltaPositionY/2,i=!0))}e&&(this.width>=this.minWidth||void 0===this.minWidth&&this.width>=0)&&(s.my.indexOf(e)>-1&&(n=this._initialWindowOffset.x+this._deltaPositionX,i=!0),(s.my.indexOf("center")>-1||"top"===s.my||"bottom"===s.my)&&(n=this._initialWindowOffset.x+this._deltaPositionX/2,i=!0));var r={};return void 0!==n&&(r.offsetX=n),void 0!==o&&(r.offsetY=o),this.modifyObjectFromUIInteraction("position",r),this.windowGroup&&this.windowGroup._onInteractiveResizeOfEmbeddedWindow(this,this._deltaPositionX,this._deltaPositionY,e,t),i},k=function(){if(this.immersiveFrame){var e=this.getContent().getBoundingClientRect().top-this.immersiveFrame.getContent().getBoundingClientRect().top,t=this.getContent().clientHeight,i=this.getContent().getBoundingClientRect().left-this.immersiveFrame.getContent().getBoundingClientRect().left,n=this.getContent().clientWidth;return{top:e,height:t,bottom:e+t,left:i,width:n,right:i+n}}};function A(e){if(this.currentDockArea!==n.WUXDockAreaEnum.NoneDockArea){this.currentDockArea!==e&&this.fire("prePlaceChange",{previousPlace:{currentDockArea:e}}),this.immersiveFrame.dockWindow(this,this.currentDockArea);var t=document.createAttribute("docked");switch(this.currentDockArea){case n.WUXDockAreaEnum.TopDockArea:t.value="top";break;case n.WUXDockAreaEnum.BottomDockArea:t.value="bottom";break;case n.WUXDockAreaEnum.LeftDockArea:t.value="left";break;case n.WUXDockAreaEnum.RightDockArea:t.value="right"}this.getContent().setAttributeNode(t),W.call(this,e)}}function W(e){this._applyResizableFlag(),this._updateFromCollapsibleState(),this._updateFromEmbeddedState(),this._updateMinWidth(),this._applyWidth(),this._applyHeight(),this._applyPosition(),this.currentDockArea!==e&&(this.fire("placeChange"),this._fireAndBroadcast("resize",{bubbles:!1}));var t=this.immersiveFrame.getDockingElement(e);t&&(!this.immersiveFrame._ActionBar_V3||e!==n.WUXDockAreaEnum.BottomDockArea&&e!==n.WUXDockAreaEnum.TopDockArea||this._moveTitleBar(!1,t),t._updateFromContainedWindows(),t._updateDockingZoneSize());var i=this.immersiveFrame.getDockingElement(this.currentDockArea);i?(i._updateFromContainedWindows(),i._updateContainedWindows()):e===n.WUXDockAreaEnum.BottomDockArea&&this._setTitleBarCenteredFlag(!1),this.immersiveFrame._manageAllPointerEventsOnDockingElements()}function E(e){for(var t=[],i=e.getEmbeddedWindows(),n=0;n<i.length;n++){var o=i[n];o&&void 0!==o.identifier&&t.push(o.identifier)}return t}function F(e,t){for(var i=0;i<t.length;i++){if(t[i]===e)return!0;if(Array.isArray(t[i]))return F(e,t[i])}}return s.addClass(b,"window"),window.WUXSnapAreaEnum=n.WUXSnapAreaEnum,window.WUXWindowGroupTypeEnum=n.WUXWindowGroupTypeEnum,window.WUXStandardButtonRoleEnum=n.WUXStandardButtonRoleEnum,window.WUXStandardButtonEnum=n.WUXStandardButtonEnum,b});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Windows/Dialog",["require","exports","UWA/Core","DS/Core/WebUXComponents","DS/Utilities/Dom","DS/Controls/Button","DS/Controls/Toggle","DS/Windows/Window","DS/Core/WebUXGlobalEnums"],function(e,t,i,n,o,s,a,r,l){"use strict";var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{modalFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},checkboxInfos:{defaultValue:void 0,type:"object",category:"Behavior"},customButtonsDefinition:{defaultValue:void 0,type:"object",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){var t=this;e.prototype.buildView.call(this),this.elements.container.addClassName("wux-windows-dialog"),this.elements._footerDiv=new i.Element("div",{class:"wux-windows-dialog-footer"}),this.elements._footerDiv.inject(this.elements._mainContentDiv),this.elements._buttonsDiv=new i.Element("div",{class:"wux-windows-dialog-buttons"}),this.elements._buttonsDiv.inject(this.elements._footerDiv),this.elements._resizeZone=new i.Element("div",{class:"wux-windows-dialog-resize-zone"}),this.elements._resizeZone.inject(this.elements._footerDiv),this._applyCurrentDockArea(),o.onNodeRendered(this.getContent(),function(){t.elements.container&&t._applyMinWidth()})},t.prototype._applyImmersiveFrame=function(t){e.prototype._applyImmersiveFrame.call(this,t),!this.immersiveFrame&&!this._isBeingClosed&&this.visibleFlag&&this.elements&&this.elements.container&&!this.elements.container.parentNode&&this.inject(document.body),this._applyModalFlag()},t.prototype._applyResizableFlag=function(t){e.prototype._applyResizableFlag.call(this,t),!0===this.resizableFlag?(this.elements._resizeZone.show(),this.elements._footerDiv.addClassName("resize-padding")):(this.elements._resizeZone.hide(),this.elements._footerDiv.removeClassName("resize-padding"))},t.prototype._applyButtons=function(t){if(e.prototype._applyButtons.call(this,t),this.buttons&&Object.keys(this.buttons).length>0)for(var i=Object.keys(this.buttons),n=0;n<i.length;n++){var o=i[n];if(o&&l.WUXStandardButtonEnum[o]){var a=this.buttons[o];if(a&&a instanceof s){a.label||(a.label=this.getDefaultButtonLabel(o)),this.recId&&!a.recId&&(a.recId=this.recId+"_"+o);var r=l.WUXStandardButtonEnum[o].role;r===l.WUXStandardButtonRoleEnum.AcceptRole||r===l.WUXStandardButtonRoleEnum.YesRole?a.emphasize="primary":a.emphasize="secondary"}}}else this.customButtonsDefinition&&this._applyCustomButtonsDefinition();0===this.elements._buttonsDiv.childNodes.length?this.elements._footerDiv.hide():this.elements._footerDiv.show(),this._applyMinWidth(),this._applyHeight()},t.prototype._applyCustomButtonsDefinition=function(e){if(this.customButtonsDefinition&&Array.isArray(this.customButtonsDefinition)&&(!this.buttons||0===Object.keys(this.buttons).length)){if(this._defaultButton=null,this._escapeButton=null,this._customButtons)for(var t=0;t<this._customButtons.length;t++)this._customButtons[t].destroy();if(this._customButtons=[],null!=this.elements._buttonsDiv)for(;this.elements._buttonsDiv.childNodes.length>0;){if(!((i=this.elements._buttonsDiv.childNodes[0])&&i.dsModel instanceof s))break;i.remove()}for(t=0;t<this.customButtonsDefinition.length;t++){var i=new s(this.customButtonsDefinition[t]);this._customButtons.push(i),i.dialog=this,null!=this.elements._buttonsDiv&&i.inject(this.elements._buttonsDiv),this.customButtonsDefinition[t].role&&(this.customButtonsDefinition[t].role===WUXCustomButtonRoleEnum.Validate?this._defaultButton=i:this.customButtonsDefinition[t].role===WUXCustomButtonRoleEnum.Escape&&(this._escapeButton=i))}0===this.elements._buttonsDiv.childNodes.length?this.elements._footerDiv.hide():this.elements._footerDiv.show(),this._applyMinWidth(),this._applyHeight()}},t.prototype.getCustomButtons=function(){if(this.customButtonsDefinition&&Array.isArray(this.customButtonsDefinition)&&(!this.buttons||0===Object.keys(this.buttons).length))return this._customButtons},t.prototype._applyCheckboxInfos=function(){if(this.elements._footerDiv.removeAttribute("has-checkbox"),this.checkboxInfos&&this.checkboxInfos.label){if(this.elements._footerDiv.setAttributeNode(document.createAttribute("has-checkbox")),this.elements._checkbox){this.elements._checkbox.visibleFlag=!0,this.elements._checkbox.label=this.checkboxInfos.label,this.elements._checkbox.checkFlag=!!this.checkboxInfos.checkFlag;t=this.checkboxInfos.tooltipInfos?this.checkboxInfos.tooltipInfos:{shortHelp:this.checkboxInfos.label};this.elements._checkbox.tooltipInfos=t}else{var e=this;this.elements._checkboxDiv=new i.Element("div",{class:"wux-windows-dialog-checkbox"}),this.elements._checkboxDiv.inject(this.elements._buttonsDiv,"before");var t=this.checkboxInfos.tooltipInfos?this.checkboxInfos.tooltipInfos:{shortHelp:this.checkboxInfos.label};this.elements._checkbox=new a({type:"checkbox",label:this.checkboxInfos.label,checkFlag:!!this.checkboxInfos.checkFlag,tooltipInfos:t}),this.elements._checkbox.addEventListener("change",function(t){e.checkboxInfos.checkFlag=e.elements._checkbox.checkFlag}),this.elements._checkbox.inject(this.elements._checkboxDiv)}this._applyMinWidth()}else this.elements._checkbox&&this.elements._checkbox.visibleFlag&&(this.elements._checkbox.visibleFlag=!1)},t.prototype._applyMinWidth=function(t){e.prototype._applyMinWidth.call(this,t);var i=h.call(this);i>this.minWidth&&(this.minWidth=i)},t.prototype._updateTitleMaxWidth=function(){var e=this.elements._titlebarButtonsDiv.clientWidth;this.elements._titleDiv.setStyle("max-width","calc(100% - "+e+"px)")},t.prototype._applyModalFlag=function(){if(void 0!==this.elements.container)if(!0===this.modalFlag){this.elements.container.setAttributeNode(document.createAttribute("modal"));var e=this.elements.container.parentNode;this.elements._modalDiv||(this.elements._modalDiv=new i.Element("div",{class:"wux-windows-modalDialog"}));var t=this.elements._modalDiv;e&&e!=t?e.removeChild(this.elements.container):!e&&this.immersiveFrame&&(e=this.immersiveFrame.getContent()),e&&e!==t&&(t.appendChild(this.elements.container),e.dsModel&&void 0!==e.dsModel.rootContainer&&(e=e.dsModel.rootContainer),e.appendChild(t)),t.show()}else{if(this.elements.container.removeAttribute("modal"),(t=this.elements._modalDiv)&&t.hasClassName("wux-windows-modalDialog")){if(this.immersiveFrame)this._moveToImmersiveFrame();else{var n=t.getParent();if(n){n.removeChild(t);var o=this.elements.container.parentNode;o&&o.removeChild(this.elements.container),n.appendChild(this.elements.container)}}t.destroy(),delete this.elements._modalDiv}else this._moveToImmersiveFrame()}},t.prototype._moveToImmersiveFrame=function(){this.immersiveFrame&&!this.modalFlag?this.immersiveFrame.moveWindowToImmersiveFrame(this):this.modalFlag&&this.elements._modalDiv.appendChild(this.elements.container)},t.prototype._applyVisibleFlag=function(t){if(!0===this.modalFlag){var i=this.elements._modalDiv;i&&(!1===this.visibleFlag?i.hide():i.show())}e.prototype._applyVisibleFlag.call(this,t),!this.immersiveFrame&&!this._isBeingClosed&&this.visibleFlag&&this.elements&&this.elements.container&&!this.elements.container.parentNode&&this.inject(document.body)},t.prototype._applyRecId=function(t){if(e.prototype._applyRecId.call(this,t),this.buttons)for(var i=Object.keys(this.buttons),n=0;n<i.length;n++){var o=i[n],a=this.buttons[o];a&&a instanceof s&&!a.recId&&(a.recId=this.recId+"_"+o)}},t.prototype._applyProperties=function(t){var i=this.isDirty("modalFlag");e.prototype._applyProperties.call(this,t),this.isDirty("customButtonsDefinition")&&this._applyCustomButtonsDefinition(t.customButtonsDefinition),i&&this._applyModalFlag(),this.isDirty("resizableFlag")&&this._applyResizableFlag(),this.isDirty("checkboxInfos")&&this._applyCheckboxInfos()},t.prototype._applyCurrentDockArea=function(t){e.prototype._applyCurrentDockArea.call(this,t);var i=this.elements._titleBarDiv.clientHeight;this.elements._buttonsDiv.childNodes.length>0&&(i+=this.elements._footerDiv.clientHeight),0!==i&&this.elements._mainCollapsibleContainer.setStyle("height","calc(100% - "+i+"px)")},t.prototype._applyMaximizedFlag=function(e){this.immersiveFrame&&(this._updateFromCollapsibleState(),void 0!==e&&this.maximizedFlag!==e&&this.fire("prePlaceChange",{previousPlace:{maximizedFlag:e}}),this.maximizedFlag&&this.allowMaximizeFlag?(this.getContent().setAttributeNode(document.createAttribute("maximized")),this._updateMaximizeButtonIcon()):(this.getContent().removeAttribute("maximized"),this._updateMaximizeButtonIcon()),this._updateContentHeight(),void 0!==e&&this.maximizedFlag!==e&&(this._updateContentVisibleStateChange(),this.fire("placeChange"),this._fireAndBroadcast("resize,",{bubbles:!1})))},t.prototype._getDefaultPosition=function(){return{my:"center",at:"center",of:this.immersiveFrame?this.immersiveFrame.getContent():document.body,constraint:this.immersiveFrame?this.immersiveFrame.getContent():document.body,offsetX:0,offsetY:0,collision:"fit"}},t}(r),h=function(){if(this.buttons){var e=0,t=0;for(var i in this.buttons){var n=window.getComputedStyle(this.buttons[i].getContent())?window.getComputedStyle(this.buttons[i].getContent()).getPropertyValue("min-width"):"",o=""===n?0:parseInt(n,10),s=window.getComputedStyle(this.buttons[i].getContent())?window.getComputedStyle(this.buttons[i].getContent()).getPropertyValue("margin-left"):"",a=""===s?0:parseInt(s,10),r=window.getComputedStyle(this.buttons[i].getContent())?window.getComputedStyle(this.buttons[i].getContent()).getPropertyValue("margin-right"):"";e=e+o+a+(""===r?0:parseInt(r,10))}var l=void 0,d=0;if(this.elements._footerDiv){var h=window.getComputedStyle(this.elements._footerDiv)?window.getComputedStyle(this.elements._footerDiv).getPropertyValue("padding-left"):"",c=window.getComputedStyle(this.elements._footerDiv)?window.getComputedStyle(this.elements._footerDiv).getPropertyValue("padding-right"):"";l=""===h?0:parseInt(h,10),d=""===c?0:parseInt(c,10),this.checkboxInfos&&(t=80)}return e=e+l+d+t}return 0};return n.addClass(d,"dialog"),d});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Windows/WindowGroup",["require","exports","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils","DS/Core/WebUXGlobalEnums","DS/Windows/Window"],function(e,t,i,n,o,s){"use strict";var a=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var o=e.apply(this,t)||this;return n.extendingClassFlag,o}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-windows-windowgroup"),this.elements._contentDiv.addClassName("wux-windows-windowgroup-content"),this.allowedDockAreas=o.WUXDockAreaEnum.TopDockArea|o.WUXDockAreaEnum.BottomDockArea|o.WUXDockAreaEnum.LeftDockArea|o.WUXDockAreaEnum.RightDockArea},t.prototype.destroy=function(){var t=this.getEmbeddedWindows();if(t.length>0)for(var i=0;i<t.length;i++)t[i].destroy();e.prototype.destroy.call(this)},t.prototype._applyImmersiveFrame=function(t){e.prototype._applyImmersiveFrame.call(this,t);for(var i=this.immersiveFrame,n=this.getEmbeddedWindows(),o=0;o<n.length;o++){var s=n[o];s&&(s.immersiveFrame=i)}},t.prototype._applyCurrentDockArea=function(t){e.prototype._applyCurrentDockArea.call(this,t);for(var i=this.currentDockArea,n=this.getEmbeddedWindows(),o=0;o<n.length;o++){var s=n[o];s&&(s.currentDockArea=i)}},t.prototype.getGroupType=function(){},t.prototype._updateWidthAndHeight=function(){},t.prototype._updateMinHeight=function(){},t.prototype._updateMaximizeButtonFlag=function(){},t.prototype._updateHorizontallyStretchableFlag=function(){},t.prototype._updateVerticallyStretchableFlag=function(){},t.prototype.ensureWindowVisible=function(e){},t.prototype.getWindowContentVisibleState=function(e){return e.visibleFlag},t.prototype._manageDrag=function(e,t){},t.prototype._stopDrag=function(){},t.prototype._applyHeight=function(t){e.prototype._applyHeight.call(this,t),this._updateContentHeight()},t.prototype.getFloatableState=function(){for(var e=!0,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&!(e=n.getFloatableState()))break}return e},t.prototype.getEmbeddedWindows=function(){return[]},t.prototype.getVisibleEmbeddedWindows=function(){return[]},t.prototype.getDisplayedWindows=function(){return[]},t.prototype.containsWindow=function(e){var t=!1;if(e)for(var i=this.getEmbeddedWindows(),n=i.length;n--;){if(i[n]===e){t=!0;break}}return t},t.prototype.attachWindow=function(e,t,i){return e?this._stackWindowNextTo(e,t,i,void 0):-1},t.prototype._stackWindowNextTo=function(e,t,i,n,o){return-1},t.prototype.detachWindow=function(e){return this._detachWindow(e,this._isCurrentlyCalledFromUIInteraction())},t.prototype._detachWindow=function(e,t){return-1},t.prototype._canBeSnapSource=function(e,t){for(var i=!0,n=this.getEmbeddedWindows(),o=0;o<n.length;o++){var s=n[o];if(s&&!(i=s._canBeSnapSource(e,t)))break}return i},t.prototype._canBeSnapTarget=function(e,t){for(var i=!0,n=this.getEmbeddedWindows(),o=0;o<n.length;o++){var s=n[o];if(s&&!(i=s._canBeSnapTarget(e,t)))break}return i},t.prototype._fireAndBroadcast=function(t,i,n){e.prototype._fireAndBroadcast.call(this,t,i);for(var o=this._getWindowsImpactedBy(n),s=0;s<o.length;s++){var a=o[s];a&&a._fireAndBroadcast(t,i)}},t.prototype._getWindowsImpactedBy=function(e){return this.getEmbeddedWindows()},t.prototype._updateTitle=function(){for(var e="",t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n)if(0===i?e="[":e+=", ",e+=n.title,i===t.length-1)e+="]";else if(5===i){e+=", ...]";break}}this.title=e},t.prototype._updateVisibleState=function(){for(var e=!1,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];n&&n.visibleFlag&&(e=!0)}this.visibleFlag=e},t.prototype._updateCloseButtonFlag=function(){for(var e=!1,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&n.closeButtonFlag){e=!0;break}}this.closeButtonFlag=e},t.prototype._updateAllowedDockAreas=function(){for(var e=o.WUXDockAreaEnum.LeftDockArea+o.WUXDockAreaEnum.TopDockArea+o.WUXDockAreaEnum.RightDockArea+o.WUXDockAreaEnum.BottomDockArea,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n)for(var s in o.WUXDockAreaEnum){var a=o.WUXDockAreaEnum[s];if(!(n.allowedDockAreas&a)&&e&a&&0===(e-=a))break}}this.allowedDockAreas=e},t.prototype._onCloseButtonClick=function(){var e=this.getVisibleEmbeddedWindows();if(e)for(var t=e.length-1;t>=0;t--){var i=e[t];i&&i.closeButtonFlag&&(i.disabled||i.callMethodFromUIInteraction("close"))}},t.prototype._updateMovableFlag=function(){for(var e=!0,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&!n.movableFlag){e=!1;break}}this.movableFlag=e},t.prototype._updateWindowVisibility=function(e){},t.prototype.close=function(){if(this.autoCloseFlag){var e=this.activeFlag,t=this.getEmbeddedWindows();if(t)for(var i=t.length-1;i>=0;i--){var n=t[i];n&&n.close()}(t=this.getEmbeddedWindows())&&t.length>1&&e&&(this.activeFlag=!0)}else this.fire("close")},t.prototype._saveDockAreaInPreferences=function(){for(var e=0;e<this.getEmbeddedWindows().length;e++){this.getEmbeddedWindows()[e]._saveDockAreaInPreferences()}},t.prototype._saveMaximizeInPreferences=function(){for(var e=0;e<this.getEmbeddedWindows().length;e++){this.getEmbeddedWindows()[e]._saveMaximizeInPreferences()}},t.prototype._savePositionInPreferences=function(){for(var e=0;e<this.getEmbeddedWindows().length;e++){this.getEmbeddedWindows()[e]._savePositionInPreferences()}},t.prototype._saveDimensionsInPreferences=function(){for(var e=0;e<this.getEmbeddedWindows().length;e++){this.getEmbeddedWindows()[e]._saveDimensionsInPreferences()}},t.prototype._saveDockedDimensionsInPreferences=function(){for(var e=0;e<this.getVisibleEmbeddedWindows().length;e++){this.getVisibleEmbeddedWindows()[e]._saveDockedDimensionsInPreferences()}},t.prototype._getDockedDimensionsFromPreferences=function(){for(var e={},t=this.getDisplayedWindows(),i=0;i<t.length;i++){var n=t[i]._getDockedDimensionsFromPreferences();n&&(n.width&&(!e.width||e.width<n.width)&&(e.width=n.width),n.height&&(!e.height||e.height<n.height)&&(e.height=n.height))}return e},t.prototype._getDockAreaIndexFromPreferences=function(){for(var e=this.getVisibleEmbeddedWindows(),t=0;t<e.length;t++){var i=e[t]._getDockAreaIndexFromPreferences();if(void 0!==i)return i}},t.prototype._getAcceptableWidthForEmbeddedWindowResize=function(e,t){return t},t.prototype._onInteractiveResizeOfEmbeddedWindow=function(e,t,i,n,o){},t.prototype._onStopInteractiveResizeOfEmbeddedWindow=function(e){},t.prototype._getResizeOffset=function(e,t){return 0},t}(s);return i.addClass(a,"windowgroup"),a});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Windows/WindowGroupAsGrid",["require","exports","UWA/Core","DS/Core/WebUXComponents","DS/Utilities/WUXUWAUtils","DS/Core/WebUXGlobalEnums","DS/Windows/WindowGroup"],function(e,t,i,n,o,s,a){"use strict";var r=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return o.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),this._embeddedWindowsInColumns=[]},t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-windows-windowgroupasgrid"),this.allowedDockAreas=s.WUXDockAreaEnum.TopDockArea|s.WUXDockAreaEnum.BottomDockArea|s.WUXDockAreaEnum.LeftDockArea|s.WUXDockAreaEnum.RightDockArea},t.prototype._updateWindowVisibility=function(e){this.manageEmbeddedWindowsCss()},t.prototype.manageEmbeddedWindowsCss=function(){for(var e=-1,t=0;t<this._embeddedWindowsInColumns.length;t++)for(var i=!1,n=!1,o=0;o<this._embeddedWindowsInColumns[t].length;o++){var s=this._embeddedWindowsInColumns[t][o];!i&&s.visibleFlag?(s.getContent().setAttribute("wux-first-visible-window-in-column",""),i=!0):s.getContent().removeAttribute("wux-first-visible-window-in-column"),s.visibleFlag&&-1===e&&(e=t),t===e?s.getContent().setAttribute("wux-window-in-first-visible-column",""):s.getContent().removeAttribute("wux-window-in-first-visible-column"),!n&&s.visibleFlag?(n=!0,s.getContent().setAttribute("lastvisiblewindowincolumn","")):s.getContent().removeAttribute("lastvisiblewindowincolumn")}this._manageInteriorBorders()},t.prototype.getGroupType=function(){return s.WUXWindowGroupTypeEnum.GroupAsGrid},t.prototype._stackWindowNextTo=function(e,t,i,n,o){var a=-1;if(e){if(this.containsWindow(e))return 1;if(e&&e._canBeSnapSource(t,i)&&e!==t&&(!t||function(e){return e===s.WUXSnapAreaEnum.LeftArea||e===s.WUXSnapAreaEnum.TopArea||e===s.WUXSnapAreaEnum.RightArea||e===s.WUXSnapAreaEnum.BottomArea}(i)&&t._canBeSnapTarget(e,i))){var r=e.activeFlag;if(t?a=t===this?1:this.containsWindow(t)?1:-1:0===this.getEmbeddedWindows().length&&(a=1),a<0)return a;var l=e.windowGroup;l&&l.getGroupType()===s.WUXWindowGroupTypeEnum.GroupAsTab?e=l:l&&l.getGroupType()===s.WUXWindowGroupTypeEnum.GroupAsGrid&&l.detachWindow(e),t&&e.getDockedFlag()&&(e.currentDockArea=s.WUXDockAreaEnum.NoneDockArea),e.expandedFlag=!0;var d=e.getAbsolutePosition(),h=e.getContent().offsetWidth,c=e.getContent().offsetHeight,u=this._addWindowToGroup(e,t,i);if(u<0)return u;if(e.windowGroup=this,this.getDockedFlag()?e.currentDockArea=this.currentDockArea:t||e.getDockedFlag()&&(this.currentDockArea=e.currentDockArea),t){if(i===s.WUXSnapAreaEnum.LeftArea&&0===this._getWindowPositionInGrid(e).column)(p=Object.assign({},this.position)).offsetX-=h-1,this.position=p;else if(i===s.WUXSnapAreaEnum.TopArea&&1===this._getNbColumn()){var p;(p=Object.assign({},this.position)).offsetY-=c-1,this.position=p}}else(p=Object.assign({},d)).y-=this._getTitleBarHeight()-1,this.setAbsolutePosition(p);this._updateVisibleState(),this._updateTitle(),this._updateCloseButtonFlag(),this._updateAllowedDockAreas(),this._postEditTouchMode(),this._updateMaximizeButtonFlag(),e.visibleFlag||this._updateWindowVisibility(e),this.manageEmbeddedWindowsCss(),(this.activeFlag||r)&&(this.activeFlag=!0)}}return a},t.prototype.replaceWindow=function(e,t){var i=this._getWindowPositionInGrid(e);return t.getContent().inject(e.getContent(),"after"),e.getContent().remove(),this._embeddedWindowsInColumns[i.column][i.row]=t,this.manageEmbeddedWindowsCss(),1},t.prototype._addWindowToGroup=function(e,t,i){var n;if(t){if(!(n=this._getWindowPositionInGrid(t)))return console.warn("Hum... This should not have happened"),-1}else n={column:0,row:0};n.column<0&&(console.warn("Hum... This should not have happened: snapTargetWindowPositionInGrid.column should be positive"),n.column=0),n.row<0&&(console.warn("Hum... This should not have happened: snapTargetWindowPositionInGrid.row should be positive"),n.row=0),this.fixPosition(n,i);var o=function(e,t){switch(t){case s.WUXSnapAreaEnum.BottomArea:return{column:e.column,row:e.row+1};case s.WUXSnapAreaEnum.LeftArea:return{column:e.column-1,row:e.row};case s.WUXSnapAreaEnum.TopArea:return{column:e.column,row:e.row-1};case s.WUXSnapAreaEnum.RightArea:return{column:e.column+1,row:e.row}}return{column:0,row:0}}(n,i);this._embeddedWindowsInColumns[o.column].splice(o.row,0,e),e.remove();var a=this._getColumnDiv(o.column),r=a.getChildren();o.row<0?e.getContent().inject(a,"top"):o.row>=r.length?e.getContent().inject(a,"bottom"):e.inject(r[o.row],"before")},t.prototype.fixPosition=function(e,t){switch(t){case s.WUXSnapAreaEnum.BottomArea:break;case s.WUXSnapAreaEnum.LeftArea:this._addEmptyColumnAt(e.column),e.column=e.column+1;break;case s.WUXSnapAreaEnum.TopArea:e.row=e.row+1;break;case s.WUXSnapAreaEnum.RightArea:this._addEmptyColumnAt(e.column+1)}this._embeddedWindowsInColumns.length<=e.column&&this._addEmptyColumnAt(e.column)},t.prototype._addEmptyColumnAt=function(e){this._embeddedWindowsInColumns.splice(e,0,[]);var t=this._createColumnDiv(),i=this._getAllColumnsDivs();e<0?t.inject(this.elements._contentDiv,"top"):e>=i.length?t.inject(this.elements._contentDiv,"bottom"):t.inject(i[e],"before")},t.prototype._getAllColumnsDivs=function(){return this.elements&&this.elements._contentDiv?this.elements._contentDiv.children:[]},t.prototype._getColumnDiv=function(e){return this._getAllColumnsDivs()[e]},t.prototype._removeColumnDiv=function(e){this._getAllColumnsDivs()[e].destroy()},t.prototype._createColumnDiv=function(){var e=new i.Element("div");return e.addClassName("wux-windows-windowgroupasgrid-column"),e},t.prototype._getNbColumn=function(){return this._embeddedWindowsInColumns.length},t.prototype._getNbWindowsInFirstColumn=function(){return this._embeddedWindowsInColumns[0].length},t.prototype._manageInteriorBorders=function(){if(this._embeddedWindowsInColumns.length>0)for(var e=this._getAllColumnsDivs(),t=0,i=0;i<e.length;i++){var n=e[i].getBoundingClientRect().height;n>t?(i>0&&e[i-1].removeAttribute("wux-column-border-right"),e[i].setAttribute("wux-column-border-left","")):(i>0&&e[i-1].setAttribute("wux-column-border-right",""),e[i].removeAttribute("wux-column-border-left")),0===i&&e[i].setAttribute("wux-column-border-left",""),i===this._embeddedWindowsInColumns.length-1&&e[i].setAttribute("wux-column-border-right",""),t=n}},t.prototype._detachWindow=function(e,t){var i=-1;if(e&&!e._isBeingDetached){if(!this.containsWindow(e))return i;i=1,e._isBeingDetached=!0;var n=this.activeFlag;this.activeFlag=!1,e.getContent().hide();var o=this.getEmbeddedWindows(),a=2===o.length?this.getEmbeddedWindows()[0]===e?this.getEmbeddedWindows()[1]:this.getEmbeddedWindows()[0]:this,r=o.length<=2,l=0===this._getWindowPositionInGrid(e).column&&1===this._getNbWindowsInFirstColumn()&&!r,d=0===this._getWindowPositionInGrid(e).row&&1===this._getNbColumn()&&!r,h=void 0;if(l?(h=Object.assign({},this._embeddedWindowsInColumns[1][0].position)).offsetY-=this._getTitleBarHeight()-1:d&&((h=Object.assign({},this._embeddedWindowsInColumns[0][1].position)).offsetY-=this._getTitleBarHeight()-1),e.getContent().remove(),e.windowGroup===this&&(e.windowGroup=null),t&&e._saveWindowGroupInPreferences(a),this._removeWindowFromEmbeddedWindows(e),e.isBeingClosed()||(this.immersiveFrame&&(e.getDockedFlag()?1===this.getEmbeddedWindows().length?this.immersiveFrame.dockWindow(e,e.currentDockArea):(e.currentDockArea=s.WUXDockAreaEnum.NoneDockArea,this.immersiveFrame.moveWindowToImmersiveFrame(e)):this.immersiveFrame.moveWindowToImmersiveFrame(e)),e.visibleFlag&&e.getContent().show(),e._updateFromEmbeddedState()),0===(o=this.getEmbeddedWindows()).length)return this.elements&&this.elements.container&&this.destroy(),void(e._isBeingDetached=!1);this._updateVisibleState(),this._applyResizableFlag(),1===o.length&&(a=o[0],this._detachWindow(a,t),a.maximizedFlag=this.maximizedFlag,a.currentDockArea=this.currentDockArea),o.length>=1&&(e.maximizedFlag=!1),n&&(e.activeFlag=!0),e._applyWidth(),e._applyHeight(),o.length>1&&(h?this.position=h:this.setAbsolutePosition(this.getAbsolutePosition()),this._updateTitle(),this._updateAllowedDockAreas(),this._updateMovableFlag()),this.manageEmbeddedWindowsCss(),e._isBeingDetached=!1}return i},t.prototype._canBeSnapSource=function(t,i){var n=!1;switch(i){case s.WUXSnapAreaEnum.InsideArea:n=!0;case s.WUXSnapAreaEnum.LeftArea:case s.WUXSnapAreaEnum.RightArea:n=!0;break;case s.WUXSnapAreaEnum.TopArea:case s.WUXSnapAreaEnum.BottomArea:1==this._getNbColumn()&&(n=!0)}return n&&(n=e.prototype._canBeSnapSource.call(this,t,i)),n},t.prototype._canBeSnapTarget=function(e,t){return!1},t.prototype._attachToWindow=function(e,t,n,o){var a=-1;if(e&&t!==s.WUXSnapAreaEnum.NoneArea&&t!==s.WUXSnapAreaEnum.OutsideArea&&this._canBeSnapSource(e,t)&&e._canBeSnapTarget(this,t)){if(a=1,t===s.WUXSnapAreaEnum.InsideArea)return-1;if(l(e))for(var r=e,d=this._getNbColumn(),h=function(e){for(var t=[],n=0;n<e.length;n++)t.push(i.clone(e[n],!1));return t}(this._embeddedWindowsInColumns),c=0;c<d;c++)for(var u=h[c],p=0;p<u.length;p++){var m=u[p];p>0?t=s.WUXSnapAreaEnum.BottomArea:c>0&&(t=s.WUXSnapAreaEnum.RightArea),m._attachToWindow(r,t,n,o),r=m}else{var g=function(e){switch(e){case s.WUXSnapAreaEnum.TopArea:return s.WUXSnapAreaEnum.BottomArea;case s.WUXSnapAreaEnum.RightArea:return s.WUXSnapAreaEnum.LeftArea;case s.WUXSnapAreaEnum.BottomArea:return s.WUXSnapAreaEnum.TopArea;case s.WUXSnapAreaEnum.LeftArea:return s.WUXSnapAreaEnum.RightArea}}(t),f=this._getEmbeddedWindowToAttach(g);e._attachToWindow(f,g,n,o)}}return a},t.prototype.getEmbeddedWindows=function(){for(var e=[],t=0;t<this._embeddedWindowsInColumns.length;t++)for(var i=0;i<this._embeddedWindowsInColumns[t].length;i++)e.push(this._embeddedWindowsInColumns[t][i]);return e},t.prototype._removeWindowFromEmbeddedWindows=function(e){for(var t=[],i=0;i<this._embeddedWindowsInColumns.length;i++)for(var n=0;n<this._embeddedWindowsInColumns[i].length;n++)this._embeddedWindowsInColumns[i][n]===e&&(this._embeddedWindowsInColumns[i].splice(n,1),0===this._embeddedWindowsInColumns[i].length&&t.push(i));for(i=t.length-1;i>=0;i--)this._embeddedWindowsInColumns.splice(t[i],1),this._removeColumnDiv(t[i]);return!1},t.prototype.getVisibleEmbeddedWindows=function(){for(var e=[],t=0;t<this._embeddedWindowsInColumns.length;t++)for(var i=0;i<this._embeddedWindowsInColumns[t].length;i++)this._embeddedWindowsInColumns[t][i].visibleFlag&&e.push(this._embeddedWindowsInColumns[t][i]);return e},t.prototype.getDisplayedWindows=function(){return this.getVisibleEmbeddedWindows()},t.prototype._getWindowPositionInGrid=function(e){for(var t=0;t<this._embeddedWindowsInColumns.length;t++)for(var i=0;i<this._embeddedWindowsInColumns[t].length;i++)if(this._embeddedWindowsInColumns[t][i]===e)return{column:t,row:i}},t.prototype._preEditHeight=function(e,t){return-1===t},t.prototype._applyHeight=function(e){},t.prototype._applyWidth=function(e){},t.prototype._applyPosition=function(t){e.prototype._applyPosition.call(this,t);for(var i=0,n=this.getVisibleEmbeddedWindows();i<n.length;i++){var o=n[i];o.setAbsolutePosition(o._getOwnAbsolutePosition())}},t.prototype._updateContentHeight=function(){},t.prototype._getDockedDimensionsFromPreferences=function(){for(var e={width:0,height:0},t=0;t<this._embeddedWindowsInColumns.length;t++){for(var i={width:0,height:0},n=0;n<this._embeddedWindowsInColumns[t].length;n++){var o=this._embeddedWindowsInColumns[t][n]._getDockedDimensionsFromPreferences();o&&(i.width=Math.max(i.width,o.width?o.width:0),i.height+=o.height?o.height:0)}e={width:e.width+i.width,height:Math.max(e.height,i.height)}}return e},t.prototype._applyActiveFlag=function(){e.prototype._applyActiveFlag.call(this);var t=this.getEmbeddedWindows();if(t)for(var i=0;i<t.length;i++){var n=t[i];n&&n.visibleFlag?n.activeFlag=this.activeFlag:n&&(n.activeFlag=!1)}},t.prototype._getEmbeddedWindowToAttach=function(e){switch(e){case s.WUXSnapAreaEnum.TopArea:return this._embeddedWindowsInColumns[0][0];case s.WUXSnapAreaEnum.RightArea:return this._embeddedWindowsInColumns[this._embeddedWindowsInColumns.length-1][0];case s.WUXSnapAreaEnum.BottomArea:return this._embeddedWindowsInColumns[0][this._embeddedWindowsInColumns[0].length-1];case s.WUXSnapAreaEnum.LeftArea:return this._embeddedWindowsInColumns[0][0]}},t.prototype._getAcceptableWidthForEmbeddedWindowResize=function(e,t){for(var i=0,n=0,o=this._getVisibleWindowsInSameColumn(e);n<o.length;n++){var s=o[n];i=Math.max(i,s.minWidth)}return t<i?i:t},t.prototype._onInteractiveResizeOfEmbeddedWindow=function(e,t,i,n,o){if(this.__initialPositionWhenResize||(this.__initialPositionWhenResize=Object.assign({},this.position)),"left"===n||"top"===o){var s=Object.assign({},this.__initialPositionWhenResize);"left"!==n||Number.isNaN(t)?s.offsetX=this.position.offsetX:s.offsetX+=t,"top"!==o||Number.isNaN(i)?s.offsetY=this.position.offsetY:s.offsetY+=i,this.position=s,this.setAbsolutePosition(this.getAbsolutePosition())}if(n)for(var a=0,r=this._getVisibleWindowsInSameColumn(e);a<r.length;a++){r[a].width=e.width}this._manageInteriorBorders()},t.prototype._onStopInteractiveResizeOfEmbeddedWindow=function(e){this.__initialPositionWhenResize=void 0},t.prototype._getResizeOffset=function(e,t){switch(t){case"top":return this._getTitleBarHeight();case"right":return this._getWidthOfWindowsOnTheRight(e);case"bottom":return this._getHeightOfWindowsUnderneath(e);case"left":return 0}},t.prototype._getHeightOfWindowsUnderneath=function(e){for(var t=this._getWindowPositionInGrid(e),i=0,n=t.row+1;n<this._embeddedWindowsInColumns[t.column].length;n++){var o=this._embeddedWindowsInColumns[t.column][n];o.visibleFlag&&(i+=o.getContent().offsetHeight)}return i},t.prototype._getWidthOfWindowsOnTheRight=function(e){for(var t=this._getWindowPositionInGrid(e),i=0,n=this._getAllColumnsDivs(),o=t.column+1;o<this._embeddedWindowsInColumns.length;o++){i+=n[o].offsetWidth}return i},t.prototype._getVisibleWindowsInSameColumn=function(e){var t=this._getWindowPositionInGrid(e);return this._embeddedWindowsInColumns[t.column].filter(function(e){return e.visibleFlag})},t}(a);function l(e){return e instanceof r?e:e.windowGroup?l(e.windowGroup):void 0}return n.addClass(r,"windowgroupasgrid"),r});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Windows/DockingElementForImmersiveFrame",["require","exports","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/Windows/DockingElement","DS/Core/WebUXGlobalEnums"],function(e,t,i,n,o,s){"use strict";var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.dockingWithCollapserContainer.addClassName("wux-windows-docking-element-immersiveFrameStyle"),this.elements.dockingZoneMask.addClassName("wux-windows-docking-element-immersiveFrameStyle")},t.prototype.handleEvents=function(){e.prototype.handleEvents.call(this),function(){var e=this;if(void 0!==this._observer||!this.elements.dockingZone)return;this._observer=new MutationObserver(function(t){for(var i=0,n=t;i<n.length;i++){var o=n[i];if("childList"===o.type){var s=void 0;o.addedNodes.length>0&&(s=Array.from(o.addedNodes).some(function(e){if(e.hasClassName("wux-windows-window")){var t=e.dsModel;return t&&t.visibleFlag}return!1})),o.removedNodes.length>0&&(r.call(e)||(s=!1)),void 0!==s&&(e.visibleDockingZoneFlag=s)}}}),this._observer.observe(this.elements.dockingZone,{childList:!0})}.call(this),function(){var e,t=this;i.addEventOnElement(this,this.getContent(),"dockStartResize",function(i){if(i.dsModel===t){var n,o,a=t.side;switch(a){case s.WUXDockAreaEnum.TopDockArea:n="bottom",o="ns-resize";break;case s.WUXDockAreaEnum.BottomDockArea:n="top",o="ns-resize";break;case s.WUXDockAreaEnum.LeftDockArea:n="right",o="ew-resize";break;case s.WUXDockAreaEnum.RightDockArea:n="left",o="ew-resize"}for(var r=t.getContainedWindows(),l=0;l<r.length;l++)r[l]._fireAndBroadcast("startResize",{side:n,cursor:o}),e||(e=r[l].immersiveFrame)}}),i.addEventOnElement(this,this.getContent(),"dockIsResizing",function(i){i.dsModel===t&&e&&e._updateAllDockingZoneSize()}),i.addEventOnElement(this,this.getContent(),"dockResize",function(e){if(e.dsModel===t){for(var i=t.getContainedWindows(),n=0;n<i.length;n++)i[n]._fireAndBroadcast("stopResize");t._saveDockingZoneSizeInPreferences()}}),i.addEventOnElement(this,this.getContent(),"change",function(e){if(t.elements._tab&&e.dsModel===t.elements._tab){var i=t.getDisplayedWindows();if(1===i.length){var n=d.call(t),o=i[0]._getDockedDimensionsFromPreferences();o&&o[n]&&(t.dockingZoneSize=o[n])}}})}.call(this)},t.prototype.destroy=function(){(function(){this._observer&&this._observer.disconnect()}).call(this),e.prototype.destroy.call(this)},t.prototype.getContainedWindows=function(){for(var e=this.elements.dockingZone.getChildren(),t=[],i=0;i<e.length;i++)e[i].hasClassName("wux-windows-window")&&t.push(e[i].dsModel);return t},t.prototype.getContainedVisibleWindows=function(){for(var e=this.elements.dockingZone.getChildren(),t=[],i=0;i<e.length;i++)e[i].hasClassName("wux-windows-window")&&!0===e[i].dsModel.visibleFlag&&t.push(e[i].dsModel);return t},t.prototype.getDisplayedWindows=function(){for(var e=this.elements.dockingZone.getChildren(),t=[],i=0;i<e.length;i++)e[i].hasClassName("wux-windows-window")&&!0===e[i].dsModel.visibleFlag&&this.isContentActive(e[i])&&t.push(e[i].dsModel);return t},t.prototype.shouldDockingZoneSizeChangeWhenDockingWindow=function(){return!!this.elements._tab||0===this.getContainedVisibleWindows().length},t.prototype._preEditDockingZoneSize=function(t,n){var o=e.prototype._preEditDockingZoneSize.call(this,t,n);if(!0===o&&!i.isCurrentlyCalledFromUIInteraction()&&0===this.getContainedWindows().length){var s=this._getDockingZoneSizeFromPreferences();if(s)return{validValue:s.size}}return o},t.prototype._applyDockingZoneSize=function(t){if(e.prototype._applyDockingZoneSize.call(this,t),void 0!==t&&this.dockingZoneSize!==t)for(var i=this.getContainedWindows(),n=0;n<i.length;n++)i[n]._fireAndBroadcast("resize",{bubbles:!1})},t.prototype._applyAlignment=function(){e.prototype._applyAlignment.call(this),this._updateContainedWindows(),this._updateFitToChildState()},t.prototype._applyCollapseDockingZoneFlag=function(){e.prototype._applyCollapseDockingZoneFlag.call(this),l.call(this)},t.prototype._applyCollapserStyle=function(){e.prototype._applyCollapserStyle.call(this),this.collapserStyle===o.COLLAPSER_STYLE.FIXED_AREA&&(this.useBordersFlag=!1,this.useBackgroundFlag=!1,this.alignment="near")},t.prototype._applyVisibleDockingZoneFlag=function(){e.prototype._applyVisibleDockingZoneFlag.call(this),l.call(this)},t.prototype._updateDockingZoneSize=function(){this.getDisplayedWindows().length>0&&this._updateContainedWindows(),e.prototype._updateDockingZoneSize.call(this)},t.prototype._updateContainedWindows=function(){this.collapserStyle!==o.COLLAPSER_STYLE.FIXED_AREA||this.side!==s.WUXDockAreaEnum.BottomDockArea&&this.side!==s.WUXDockAreaEnum.TopDockArea||function(){var e=null,t=this.getContainedVisibleWindows();1===t.length&&(e=t[0]);e&&(e._moveTitleBar(!0,this),e._updateTitleBarWidth());for(var i=this.getContainedWindows(),n=0;n<i.length;n++){var o=i[n];o&&o!==e&&(o._moveTitleBar(!1,this),o._updateTitleBarWidth())}}.call(this);for(var e=this.getContainedVisibleWindows(),t=0;t<e.length;t++)e[t]._updateContentHeight(),e[t]._setTitleBarCenteredFlag("center"===this.alignment),e[t].isAWindowGroup()&&(e[t]._updateMaxTabbarWidth(),e[t]._updateMinWidth())},t.prototype._updateFromContainedWindows=function(){this.collapserStyle===o.COLLAPSER_STYLE.FIXED_AREA&&function(){var e="near";if(this.side===s.WUXDockAreaEnum.BottomDockArea){var t=this.getContainedVisibleWindows();1===t.length&&(e="center")}this.alignment=e}.call(this),this._updateFitToChildState();var e=this.getContainedVisibleWindows(),t=24;if(e&&e.length>0)for(var i=this.side,n=e[0]._getTitleBarHeight(),a=0;a<e.length;a++){var r=e[a];r&&(i===s.WUXDockAreaEnum.LeftDockArea||i===s.WUXDockAreaEnum.RightDockArea?t=r.minWidth>t?r.minWidth:t:i!==s.WUXDockAreaEnum.TopDockArea&&i!==s.WUXDockAreaEnum.BottomDockArea||(t=r.minHeight+n>t?r.minHeight+n:t))}this.minSize=t,this._updateCollapserSize()},t.prototype._updateFitToChildState=function(){var e=!1;if("center"===this.alignment){var t=this.getContainedVisibleWindows();if(1===t.length){var i=t[0];e=!(i.horizontallyStretchableFlag&&(this.side==s.WUXDockAreaEnum.TopDockArea||this.side==s.WUXDockAreaEnum.BottomDockArea)||i.verticallyStretchableFlag&&(this.side==s.WUXDockAreaEnum.LeftDockArea||this.side==s.WUXDockAreaEnum.RightDockArea))}}e?this.elements.dockingZone.addClassName("wux-docking-element-fit-to-child"):this.elements.dockingZone.removeClassName("wux-docking-element-fit-to-child")},t.prototype._saveDockingZoneSizeInPreferences=function(){if(""!==this.identifier)for(var e=this.getDisplayedWindows(),t=0;t<e.length;t++)e[t]._saveDockedDimensionsInPreferences()},t.prototype._getDockingZoneSizeFromPreferences=function(){if(""!==this.identifier)for(var e=this.getDisplayedWindows(),t=d.call(this),i=0;i<e.length;i++){var n=e[i]._getDockedDimensionsFromPreferences();if(n&&n[t])return n[t]}},t.prototype.__shouldCollapserBeVisible=function(){return!(this.collapseDockingZoneFlag&&!r.call(this))&&e.prototype.__shouldCollapserBeVisible.call(this)},t.prototype.__hasBackground=function(){return this.side===s.WUXDockAreaEnum.TopDockArea},t}(o);function r(e){for(var t=this.elements.dockingZone.getChildren(),i=0;i<t.length;i++){if(!t[i].hasClassName("wux-windows-window"))return!0;if((!e||t[i].dsModel.getContent()!==e.getContent())&&t[i].dsModel.visibleFlag)return!0}return!1}function l(){for(var e=this.getContainedWindows(),t=0;t<e.length;t++)e[t]._updateContentVisibleStateChange()}function d(){return this.side===s.WUXDockAreaEnum.LeftDockArea||this.side===s.WUXDockAreaEnum.RightDockArea?"width":"height"}return n.addClass(a,"dockingElement"),a});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Windows/WindowGroupAsTab",["require","exports","UWA/Core","DS/Core/WebUXComponents","DS/Utilities/Dom","DS/Utilities/WUXUWAUtils","DS/Core/PointerEvents","DS/Core/WebUXGlobalEnums","DS/Utilities/Utils","DS/Controls/Tab","DS/Windows/WindowGroup","DS/Windows/WindowGroupAsGrid"],function(e,t,i,n,o,s,a,r,l,d,h,c){"use strict";var u=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return s.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{currentWindows:{defaultValue:[],type:"Array"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-windows-windowgroupAsTab"),this.elements._tabBarContainer=new i.Element("div",{class:"wux-windows-windowgroup-tab-bar-container"}),this.elements._tabBarContainer.inject(this.elements._titleDiv,"before"),this.elements._titleDiv.hide(),this.elements._draggableZoneDiv=new i.Element("div",{class:"wux-windows-windowgroup-draggable-zone"}),this.elements._draggableZoneDiv.inject(this.elements._titleP,"before"),this._tab=new d({tabBarDOMContainer:this.elements._tabBarContainer,tabPanelContainer:this.elements._contentDiv,multiSelFlag:!0,displayStyle:["panel","wide"],showComboBoxFlag:!0,autoCloseFlag:!1,reorderFlag:!1}),this._tab.tabBar.pinFlag=!0,this._tab.tabBar.centeredFlag=!1,this._tab.tabBar.closeButtonFlag=this.closeButtonFlag,this.allowedDockAreas=r.WUXDockAreaEnum.TopDockArea|r.WUXDockAreaEnum.BottomDockArea|r.WUXDockAreaEnum.LeftDockArea|r.WUXDockAreaEnum.RightDockArea},t.prototype.destroy=function(){this.currentDockArea!==r.WUXDockAreaEnum.NoneDockArea&&this.immersiveFrame&&this.immersiveFrame.removeWindowFromDockingArea(this,this.currentDockArea);var t=this.getEmbeddedWindows();if(t.length>0)for(var i=0;i<t.length;i++)t[i].destroy();else this._tab&&(this._tab.destroy(),this._tab=void 0),e.prototype.destroy.call(this)},t.prototype._applyTouchMode=function(){e.prototype._applyTouchMode.call(this),this._postEditTouchMode()},t.prototype._postEditTouchMode=function(){e.prototype._postEditTouchMode.call(this);var t=this._getCurrentTouchMode();this._tab&&(this._tab.touchMode=t),this._updateMaxTabbarWidth()},t.prototype._createWindowGroup=function(e){var i={immersiveFrame:this.immersiveFrame,activeFlag:!1,maximizedFlag:this.maximizedFlag};return e===r.WUXWindowGroupTypeEnum.GroupAsTab?new t(i):new c(i)},t.prototype._applyCurrentWindows=function(e){if(this._tab){var t=[],n=[],o=this._tab.tabBar.pinnedList;if(o&&(n=this._tab.getIndexesFromValues(o)),null!=this.currentWindows&&0!==this.currentWindows.length){if(this.currentWindows.length>=1)for(var s=0;s<this.currentWindows.length;s++){var a=this._getIndexFromWindow(this.currentWindows[s]),l=this._tab.getPageValueFromIndex(a);if(n.length>0){for(var d=!0,h=0;h<n.length;h++)a==n[h]&&(d=!1);(d||-1!=this._tab.tabBar.value.indexOf(l))&&t.push(l)}else t.push(l)}i.equals(this._tab.value,t)||(this._tab.value=t)}if(this._updateResizableFlag(),this._updateWidthAndHeight(),this._updateMinWidth(),this._updateMinHeight(),this._updateMovableFlag(),this._tab.tabBar._slideToValue(),e)for(h=0;h<e.length;h++){var c=e[h];c&&-1==this.currentWindows.indexOf(c)&&c.windowGroup===this&&(c.activeFlag=!1)}if(this._updateCurrentWindowsActiveFlag(),this.currentDockArea!=r.WUXDockAreaEnum.NoneDockArea){var u=this.immersiveFrame?this.immersiveFrame.getDockingElement(this.currentDockArea):null;u&&(u.pointerEventsAllIfOverflow(),u._updateDockingZoneSize())}}},t.prototype._updateCurrentWindowsActiveFlag=function(){var e=this.getEmbeddedWindows();if(e)for(var t=0;t<e.length;t++){var i=e[t];i&&this.currentWindows&&-1!=this.currentWindows.indexOf(i)?i.activeFlag=this.activeFlag:i&&(i.activeFlag=!1)}},t.prototype._applyActiveFlag=function(){e.prototype._applyActiveFlag.call(this),this._updateCurrentWindowsActiveFlag()},t.prototype._applyImmersiveFrame=function(t){e.prototype._applyImmersiveFrame.call(this,t);for(var i=this.immersiveFrame,n=this.getEmbeddedWindows(),o=0;o<n.length;o++){var s=n[o];s&&(s.immersiveFrame=i)}},t.prototype._applyCurrentDockArea=function(t){var i=this.currentDockArea;i===r.WUXDockAreaEnum.BottomDockArea||i===r.WUXDockAreaEnum.TopDockArea?this._setTabMultiSelLayout("horizontal"):this._setTabMultiSelLayout("vertical"),e.prototype._applyCurrentDockArea.call(this,t),this._updateWidthAndHeight(),this._updateMinWidth(),this._tab.tabBar.redrawTabBar()},t.prototype._applyMinWidth=function(t){if(e.prototype._applyMinWidth.call(this,t),this.currentDockArea===r.WUXDockAreaEnum.BottomDockArea&&this._tab&&this._tab.tabBar&&this._tab.tabBar.centeredFlag){var i=this.minWidth;void 0!==i?this.elements._mainContentDiv.setStyle("min-width",i+"px"):this.elements._mainContentDiv.setStyle("min-width","")}else this.elements._mainContentDiv.setStyle("min-width","")},t.prototype._applyWidth=function(e){null!==this.width&&(this._updateMaxWidth(),-1===this.width?(this.getContent().setStyle("width","auto"),this.elements._mainContentDiv.setStyle("width","auto"),this.elements._footerDiv&&this.elements._footerDiv.setStyle("width","calc(100% - 10px)")):void 0!==this.minWidth&&(this.width>=this.minWidth?(p.call(this,this.width),this.elements._mainContentDiv.setStyle("width",this.width+"px")):this.width=this.minWidth),e&&this.width!==e&&this._fireAndBroadcast("resize",{bubbles:!1})),this._tab&&this._tab.tabBar.redrawTabBar(),this._updateTitleBarWidth()},t.prototype._applyHeight=function(e){this._updateMaxHeight(),null!==this.height&&(-1===this.height?(this.elements._mainContentDiv.setStyle("height",""),this._updateContentHeight()):(this.height>=this.minHeight?(m.call(this,this.height),this._updateContentHeight()):this.height=this.minHeight,e&&this.height!==e&&this.fire("resize",{bubbles:!1})))},t.prototype._applyMaximizedFlag=function(t){if(e.prototype._applyMaximizedFlag.call(this,t),this.currentWindows)for(var i=0;i<this.getEmbeddedWindows().length;i++){this.getEmbeddedWindows()[i].maximizedFlag=this.maximizedFlag}this._updateTabCloseButtons()},t.prototype._applyCloseButtonFlag=function(){e.prototype._applyCloseButtonFlag.call(this),this._updateMaxTabbarWidth()},t.prototype._applyMaximizeButtonFlag=function(){e.prototype._applyMaximizeButtonFlag.call(this),this._updateMaxTabbarWidth()},t.prototype._applyAllowMaximizeFlag=function(){e.prototype._applyAllowMaximizeFlag.call(this),this._updateMaxTabbarWidth()},t.prototype._updateWidthAndHeight=function(){if(this.currentWindows.length>0)if(this._updateResizableFlag(),"horizontal"!==this._getTabMultiSelLayout()){for(var e=this.currentWindows[0].width,t=-1===this.currentWindows[0].height,i=t?parseInt(window.getComputedStyle(this.currentWindows[0].getContent()).height):this.currentWindows[0].height,n=1;n<this.currentWindows.length;n++){-1!==(r=this.currentWindows[n]).width&&(e=e>r.width?e:r.width),-1===r.height?i=i+parseInt(window.getComputedStyle(r.getContent()).height)+1:(t=!1,i=i+r.height+1)}this.width!==e?this.width=e:this._applyWidth(),t?this.height=-1:i&&this.height!==i?this.height=i:this._applyHeight()}else{var o=this.currentWindows[0].height,s=-1===this.currentWindows[0].width,a=s?parseInt(window.getComputedStyle(this.currentWindows[0].getContent()).width):this.currentWindows[0].width;for(n=1;n<this.currentWindows.length;n++){var r;!1!==(r=this.currentWindows[n]).resizableFlag&&"horizontal"!==r.resizableFlag||(o=o>r.height?o:this.currentWindows[n].height),-1===r.width?a=a+parseInt(window.getComputedStyle(r.getContent()).width)+1:(s=!1,a=a+r.width+1)}s?this.width=-1:a&&this.width!==a?this.width=a:this._applyWidth(),o&&this.height!==o?this.height=o:this._applyHeight()}},t.prototype._updateMaxTabbarWidth=function(){if(this._tab){var e=0;this.closeButtonFlag&&e++,this.maximizeButtonFlag&&this.allowMaximizeFlag&&e++;var t=24;if(this.touchMode&&(t=36),this._tab.tabBar.centeredFlag){var i="100%",n=this.immersiveFrame.getDockingElement(this.currentDockArea);n&&(i=n._getFixedAreaWidth()-t+"px"),this.elements._tabBarContainer.setStyle("max-width",i)}else this.elements._tabBarContainer.setStyle("max-width","calc(100% - "+t*(e+1)+"px)")}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("currentWindows")&&this._applyCurrentWindows(t.currentWindows),this._postEditTouchMode()},t.prototype.getGroupType=function(){return r.WUXWindowGroupTypeEnum.GroupAsTab},t.prototype._setTitleBarCenteredFlag=function(t){e.prototype._setTitleBarCenteredFlag.call(this,t),this._tab&&this._tab.tabBar&&(this._tab.tabBar.centeredFlag=t),this.elements._draggableZoneDiv&&(t?this.elements._draggableZoneDiv.hide():this.elements._draggableZoneDiv.show())},t.prototype._computeDropInsertionData=function(e){if(this._tab&&this._tab.tabBar){var t=-1,i="after",n=-1,o=this._tab.tabBar._getVisibleTabButtons(),s=this.elements._titleBarDiv.getBoundingClientRect().left,a=s;if(this._tab.tabBar.showComboBoxFlag&&this._tab.tabBar._tabComboBox&&this._tab.tabBar._tabComboBox.visibleFlag){var r=this._tab.tabBar._tabComboBox.getContent().getBoundingClientRect().right;if(e.x>r)return{movedWindowNewIndex:t,targetWindow:this._getWindowFromIndex(this.getEmbeddedWindows().length-1),beforeOrAfter:i,stopWindowGroupTabBarSliding:!0}}for(var l=0;l<o.length;l++){var d=this._tab.tabBar.getButtonFromValue(this._tab.getPageValueFromIndex(l)),h=d.getContent().getBoundingClientRect().left,c=d.getContent().getBoundingClientRect().right,u=0;if(!(c<=s)){if(u=h<=s?Math.abs(c-s):this._tab.tabBar.getWidthOfButton(d),e.x<a+u/2){t=l,n=l,i="before";break}if(e.x<a+u){t=l+1<o.length?l+1:l,n=l,i="after";break}a+=u}}return{movedWindowNewIndex:t,targetWindow:-1!=n?this._getWindowFromIndex(n):this._getWindowFromIndex(this.getEmbeddedWindows().length-1),beforeOrAfter:i}}},t.prototype.getCollapsibleState=function(){for(var e=0;e<this.currentWindows.length;e++)if(!this.currentWindows[e].collapsibleFlag)return!1;return this.currentDockArea!==r.WUXDockAreaEnum.TopDockArea&&this.currentDockArea!==r.WUXDockAreaEnum.BottomDockArea},t.prototype.getFloatableState=function(){for(var e=!0,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&!(e=n.getFloatableState()))break}return e},t.prototype.getEmbeddedWindows=function(){var e=[];if(this._tab)for(var t=this._tab.getPageCount(),i=0;i<t;i++){var n=this._getWindowFromIndex(i);e.push(n)}return e},t.prototype.getVisibleEmbeddedWindows=function(){var e=[];if(this._tab)for(var t=this._tab.getPageCount(),i=0;i<t;i++){var n=this._getWindowFromIndex(i);n.visibleFlag&&e.push(n)}return e},t.prototype.getDisplayedWindows=function(){return this.currentWindows.filter(function(e){return e.visibleFlag})},t.prototype.containsWindow=function(e){var t=!1;if(e)for(var i=this.getEmbeddedWindows(),n=i.length;n--;){if(i[n]===e){t=!0;break}}return t},t.prototype.attachWindow=function(e,t,i){return e?this._stackWindowNextTo(e,t,i,void 0):-1},t.prototype._stackWindowNextTo=function(e,i,n,s,l){var d=this,h=-1;if(e){if(this.containsWindow(e))return h;if(e&&e.isAWindowGroup()&&e instanceof t){var c=e.getEmbeddedWindows();for(var u in h=1,c){h=-1===c[u]._attachToWindow(i,n,s,l)?-1:h}return h}if(e&&e._canBeSnapSource(i,n)&&e!==i&&(!i||n===r.WUXSnapAreaEnum.InsideArea&&i._canBeSnapTarget(e,n))){var p=e.activeFlag;if(i?h=i===this?1:this.containsWindow(i)?1:-1:0===this.getEmbeddedWindows().length&&(h=1),h<0)return h;var m=e.windowGroup;if(m){if(m===this&&this.containsWindow(e))return 1;m.getAbsolutePosition();m.detachWindow(e)}i&&e.getDockedFlag()&&(e.currentDockArea=r.WUXDockAreaEnum.NoneDockArea),e.expandedFlag=!0,!0!==e.resizableFlag&&"true"!==e.resizableFlag&&"vertical"!==e.resizableFlag&&"horizontal"!==e.resizableFlag||n===r.WUXSnapAreaEnum.InsideArea&&(!0!==e.resizableFlag&&"true"!==e.resizableFlag&&"horizontal"!==e.resizableFlag||(e.width=this._getMonoSelectionWidth()),!0!==e.resizableFlag&&"true"!==e.resizableFlag&&"vertical"!==e.resizableFlag||(i.currentDockArea!==r.WUXDockAreaEnum.RightDockArea&&i.currentDockArea!==r.WUXDockAreaEnum.LeftDockArea||!i.verticallyStretchableFlag)&&(-1===i.height?e.height=i.elements._mainContentDiv.clientHeight:e.height=i.height)),e.setPropertyFromUIInteraction("maximizedFlag",this.maximizedFlag),!i&&e.getDockedFlag()&&(this.setPropertyFromUIInteraction("currentDockArea",e.currentDockArea),this.immersiveFrame&&this.immersiveFrame._replaceDockingZoneContent(e,this));var g=e.getAbsolutePosition();e.remove();var f=void 0;if(s){var w=this.getEmbeddedWindows();if(-1!==w.indexOf(i)){var _=w.indexOf(i);"before"===s?f=_:"after"===s&&(f=_+1)}}this._tab.addTab(e.title,e.getContent(),f,!0,void 0,e.icon,e.closeButtonFlag,e.showTitleFlag||!e.icon),e.windowGroup=this;var v=this._tab.tabBar.getButtonFromValue(this._tab.value[0]);v&&o.addEventOnElement(this,v,a.POINTERDOWN,function(t){e._onDragPointerDown(t),e._interactiveDrag=!0;var i=t.dsModel,n=d._getWindowFromIndex(d._tab.getPageIndexFromValue(i.value));e.addEventListener("stopWindowDrag",function(){(e._interactiveDrag=!1,i&&n&&!d.containsWindow(n))&&(i.destroy(),0===d.getEmbeddedWindows().length&&d.destroy())})}),this.getDockedFlag()?e.currentDockArea=this.currentDockArea:i||e.getDockedFlag()&&(this.currentDockArea=e.currentDockArea),i||this.setAbsolutePosition(g),this._updateVisibleState(),this._updateTitle(),this._updateCloseButtonFlag(),this._updateAllowedDockAreas(),this._updateResizableFlag(),this._updateMaximizedState(),this._postEditTouchMode(),this._updateTabCloseButtons(),this._updateMaximizeButtonFlag(),this._updateAllowMaximizeFlag(),e.visibleFlag||this._updateWindowVisibility(e),(this.activeFlag||p)&&(this.activeFlag=!0,this._updateCurrentWindows())}}return h},t.prototype._detachWindow=function(e,t){var n=-1;if(e){if(!this.containsWindow(e))return n;var o=this.getAbsolutePosition();n=1;var s=this.activeFlag;this.activeFlag=!1,e.getContent().hide();var a=2===this.getEmbeddedWindows().length?this.getEmbeddedWindows()[0]===e?this.getEmbeddedWindows()[1]:this.getEmbeddedWindows()[0]:this;t&&1!==this.getEmbeddedWindows().length&&e._interactiveDrag?this._tab.removeTab(e.getContent(),!0):this._tab.removeTab(e.getContent(),!1),e.windowGroup===this&&(e.windowGroup=null),t&&e._saveWindowGroupInPreferences(a),e.isBeingClosed()||(this.immersiveFrame&&(e.getDockedFlag()?1===this.getEmbeddedWindows().length?this.immersiveFrame.dockWindow(e,e.currentDockArea):(e.currentDockArea=r.WUXDockAreaEnum.NoneDockArea,this.immersiveFrame.moveWindowToImmersiveFrame(e)):this.immersiveFrame.moveWindowToImmersiveFrame(e)),e.visibleFlag&&e.getContent().show(),e._updateFromEmbeddedState());var l=this.getEmbeddedWindows();if(0===l.length){var d,h=this.windowGroup;if(h&&!e._isBeingClosed?(d=h.getAbsolutePosition(),n=h.attachWindow(e,this,r.WUXSnapAreaEnum.BottomArea)):this.immersiveFrame&&(this.currentDockArea===r.WUXDockAreaEnum.NoneDockArea?e._moveToImmersiveFrame():(this.immersiveFrame.dockWindow(e,this.currentDockArea),this.immersiveFrame._replaceDockingZoneContent(this,e))),t&&e._interactiveDrag?this.visibleFlag=!1:this.destroy(),h)return h.setAbsolutePosition(d),n}else this._updateVisibleState(),this._updateCloseButtonFlag(),this._updateMaximizeButtonFlag(),this._updateAllowMaximizeFlag(),this._applyResizableFlag(),1===l.length&&((a=l[0]).position=i.clone(this.position),this._detachWindow(a,t),e.visibleFlag&&e.getContent().show(),a.maximizedFlag=this.maximizedFlag,a.position=this.position),l.length>=1&&(e.maximizedFlag=!1);s&&(e.activeFlag=!0),e.setAbsolutePosition(o),e._applyWidth(),e._applyHeight(),l.length>1&&(this._updateTitle(),this._updateAllowedDockAreas(),this._updateMovableFlag())}return n},t.prototype._canBeSnapSource=function(e,t){for(var i=!0,n=this.getEmbeddedWindows(),o=0;o<n.length;o++){var s=n[o];if(s&&!(i=s._canBeSnapSource(e,t)))break}return i},t.prototype._canBeSnapTarget=function(e,t){for(var i=!0,n=this.getEmbeddedWindows(),o=0;o<n.length;o++){var s=n[o];if(s&&!(i=s._canBeSnapTarget(e,t)))break}return i},t.prototype._attachToWindow=function(i,n,o,s){var a=-1;if(i&&n!==r.WUXSnapAreaEnum.NoneArea&&n!==r.WUXSnapAreaEnum.OutsideArea&&this._canBeSnapSource(i,n)&&i._canBeSnapTarget(this,n))if(a=1,n===r.WUXSnapAreaEnum.InsideArea){for(var l=this.currentWindows.slice(),d=this.getEmbeddedWindows(),h=i,c=0;c<d.length;c++){var u=d[c];if(u){var p=u._attachToWindow(h,n,0===c?o:"after",s);h=u,p<0&&(a=p)}}i instanceof t?i.currentWindows=l:i.windowGroup instanceof t&&(i.windowGroup.currentWindows=l)}else a=e.prototype._attachToWindow.call(this,i,n,o,s);return a},t.prototype._updateWindowPinnedState=function(e){if(e&&-1!==this.getEmbeddedWindows().indexOf(e)){var t=this._tab.getPageValueFromIndex(this._getIndexFromWindow(e));this._tab.tabBar.pinTab(t)}},t.prototype._setTabMultiSelLayout=function(e){this._tab.multiSelLayout=e},t.prototype._getTabMultiSelLayout=function(){return this._tab.multiSelLayout},t.prototype._getWindowsImpactedBy=function(e){return"visibility"===e?this.getEmbeddedWindows():this.currentWindows},t.prototype._updateTitle=function(){e.prototype._updateTitle.call(this);for(var t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n){var o=this._tab.getPageValueFromIndex(this._getIndexFromWindow(n));this._tab.getOptionFromButton("label",o)!==n.title&&this._tab.setOptionFromButton("label",n.title,o),this._tab.getOptionFromButton("icon",o)!==n.icon&&this._tab.setOptionFromButton("icon",n.icon,o)}}},t.prototype._updateVisibleState=function(){for(var e=!1,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];n&&n.visibleFlag&&(e=!0)}this.visibleFlag=e},t.prototype._updateContentVisibleStateChange=function(){e.prototype._updateContentVisibleStateChange.call(this);for(var t=this.currentWindows,i=0;i<t.length;i++){t[i]._updateContentVisibleStateChange()}},t.prototype._updateCloseButtonFlag=function(){for(var e=!1,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&n.closeButtonFlag){e=!0;break}}this.closeButtonFlag=e,this.maximizedFlag&&this._updateTabCloseButtons()},t.prototype._updateTabCloseButtons=function(){for(var e=this.getEmbeddedWindows(),t=0;t<e.length;t++){var i=e[t];i&&this.maximizedFlag?this._tab.tabBar.setAllowClosableFlagOnValue(this._tab.getPageValueFromIndex(this._getIndexFromWindow(i)),i.closeButtonFlag):this._tab.tabBar.setAllowClosableFlagOnValue(this._tab.getPageValueFromIndex(this._getIndexFromWindow(i)),!1)}},t.prototype._updateMaximizeButtonFlag=function(){var e=!0;if(this.allowMaximizeFlag)for(var t=this._getCurrentAndPinnedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&(!n.maximizeButtonFlag||!n.allowMaximizeFlag)){e=!1;break}}else e=!1;this.maximizeButtonFlag=e},t.prototype._updateAllowMaximizeFlag=function(){for(var e=this.getEmbeddedWindows(),t=0;t<e.length;t++){var i=e[t];if(i&&!i.allowMaximizeFlag)return void(this.allowMaximizeFlag=!1)}this.allowMaximizeFlag=!0},t.prototype._updateAllowedDockAreas=function(){for(var e=r.WUXDockAreaEnum.LeftDockArea+r.WUXDockAreaEnum.TopDockArea+r.WUXDockAreaEnum.RightDockArea+r.WUXDockAreaEnum.BottomDockArea,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n)for(var o in r.WUXDockAreaEnum){var s=r.WUXDockAreaEnum[o];if(!(n.allowedDockAreas&s)&&e&s&&0===(e-=s))break}}this.allowedDockAreas=e},t.prototype._onCloseButtonClick=function(){var e=this.getVisibleEmbeddedWindows();if(e)for(var t=e.length-1;t>=0;t--){var i=e[t];i&&i.closeButtonFlag&&(i.disabled||i.callMethodFromUIInteraction("close"))}},t.prototype._updateMaximizedState=function(){for(var e=!1,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&n.maximizedFlag){e=!0;break}}this.maximizedFlag=e},t.prototype._updateResizableFlag=function(){var e=!1,t=this.currentWindows;if(1!==t.length){for(var i="horizontal"!==this._getTabMultiSelLayout(),n=0;n<t.length;n++){var o=t[n];if(o){if(i&&(!0===o.resizableFlag||"true"===o.resizableFlag||"horizontal"===o.resizableFlag)){e="horizontal";break}if(!i&&(!0===o.resizableFlag||"true"===o.resizableFlag||"horizontal"===o.resizableFlag)){e="vertical";break}}}this.resizableFlag=e}else this.resizableFlag=this.currentWindows[0].resizableFlag},t.prototype._updateMinWidth=function(){if(this.currentWindows&&this.currentWindows.length>0&&this.immersiveFrame&&this.immersiveFrame.isInsertedInDOM()){var e=void 0,t=0;if((this.currentDockArea===r.WUXDockAreaEnum.BottomDockArea||this.currentDockArea===r.WUXDockAreaEnum.TopDockArea)&&this._tab&&this._tab.tabBar){var i=void 0;if(this._tab.tabBar.centeredFlag)i=parseInt(window.getComputedStyle(this.elements._tabBarContainer).width)+2;else{i=this._tab.tabBar.getWidthOfAllVisibleButtons(),this._tab.tabBar._applyInheritWidthToButtons();var n=parseInt(window.getComputedStyle(this.elements._titleBarDiv).width),o=parseInt(window.getComputedStyle(this.elements._tabBarContainer).width);isNaN(n)||isNaN(o)||(i=i+n-o)}if(t=i,this.immersiveFrame){var s=this.immersiveFrame.getDockingElement(this.currentDockArea)._getDockingZoneDimensions();t>s.width&&(t=s.width-1)}}for(var a=0;a<this.currentWindows.length;a++)(e=this.currentWindows[a])&&-1!=e.width&&t<e.minWidth&&(t=e.minWidth);this.minWidth=t}},t.prototype._updateMinHeight=function(){if(this.currentWindows&&this.currentWindows.length>0){for(var e=void 0,t=this.currentWindows[0].minHeight,i=0;i<this.currentWindows.length;i++)(e=this.currentWindows[i])&&t<e.minHeight&&(t=e.minHeight);this.minHeight=t}},t.prototype._updateMovableFlag=function(){for(var e=!0,t=this.getEmbeddedWindows(),i=0;i<t.length;i++){var n=t[i];if(n&&!n.movableFlag){e=!1;break}}this.movableFlag=e},t.prototype._getMonoSelectionWidth=function(){var e=this._getCurrentAndPinnedWindows();if(1===e.length)return-1===this.width?parseInt(window.getComputedStyle(e[0].getContent()).width):this.width;if(e.length>1){for(var t=0;t<e.length;t++){var i=e[t];if(-1!==i.width)return i.width}return parseInt(window.getComputedStyle(e[0].getContent()).width)}return 0},t.prototype._getCurrentAndPinnedWindows=function(){if(this._tab){for(var e=this._tab.value,t=[],i=this._tab.getIndexesFromValues(e),n=0;n<i.length;n++){var o=i[n];if(o>=0)(r=this._getWindowFromIndex(o))&&t.push(r)}var s=this._tab.tabBar.pinnedList;if(s){var a=this._tab.getIndexesFromValues(s);for(n=0;n<a.length;n++){var r,l=a[n];if(l>=0&&-1==i.indexOf(l))(r=this._getWindowFromIndex(l))&&t.push(r)}}return t}},t.prototype._updateCurrentWindows=function(){var e=this._getCurrentAndPinnedWindows();this._updateHorizontallyStretchableFlag(),this._updateVerticallyStretchableFlag();var t=function(e,t){for(var i=[],n=e.concat(t),o=0;o<n.length;o++){var s=n[o];-1!==t.indexOf(s)&&-1!==e.indexOf(s)||i.push(s)}return i}(this.currentWindows,e);this.currentWindows=e;for(var i=0;i<t.length;i++){t[i]._updateContentVisibleStateChange()}this._applyPosition()},t.prototype._updateHorizontallyStretchableFlag=function(){for(var e=this._getCurrentAndPinnedWindows(),t=!1,i=0;i<e.length;i++)if(e[i]&&!0===e[i].horizontallyStretchableFlag){t=!0;break}this.horizontallyStretchableFlag=t},t.prototype._updateVerticallyStretchableFlag=function(){for(var e=this._getCurrentAndPinnedWindows(),t=!1,i=0;i<e.length;i++)if(e[i]&&!0===e[i].verticallyStretchableFlag){t=!0;break}this.verticallyStretchableFlag=t},t.prototype.ensureWindowVisible=function(e){var t=this.currentWindows;null!=t&&0!==t.length&&-1===t.indexOf(e)&&(this.currentWindows=[e])},t.prototype.getWindowContentVisibleState=function(e){var t=!1,i=this.currentWindows;return null!=i&&0!==i.length&&-1!==i.indexOf(e)&&(t=!0),t&&this.expandedFlag},t.prototype._getWindowFromIndex=function(e){var t=this._tab.getPageContentFromIndex(e);return t&&t.dsModel?t.dsModel:t},t.prototype._getIndexFromWindow=function(e){return this._tab.getIndexOf(e.getContent())},t.prototype._updateWindowVisibility=function(e){var t=e.visibleFlag;if(this._tab._setTabVisibility(this._tab.getPageValueFromIndex(this._getIndexFromWindow(e)),t),t)t&&0===this.currentWindows.length&&(this.currentWindows=[e]);else if(-1!==this.currentWindows.indexOf(e)&&this.currentWindows.splice(this.currentWindows.indexOf(e),1),0===this.currentWindows.length)for(var i=this.getEmbeddedWindows(),n=0;n<i.length;n++){var o=i[n];if(o.visibleFlag){this.currentWindows=[o];break}}this._updateVisibleState()},t.prototype._manageDrag=function(e,t){var i=this._getIndexFromWindow(e);if(this._tab.tabBar.showComboBoxFlag&&this._tab.tabBar._tabComboBox&&this._tab.tabBar._tabComboBox.visibleFlag){if(!l.isMouseOverElement(this._tab.tabBar._buttonGroup.getContent(),t))return void this._stopTabBarSliding();var n=this.elements._titleBarDiv.getBoundingClientRect().left,o=this._tab.tabBar._buttonGroup.getContent().getBoundingClientRect().right;Math.abs(t.x-n)<=7?this._startTabBarSliding("left"):Math.abs(t.x-o)<=7?this._startTabBarSliding("right"):this._stopTabBarSliding()}var s=this._computeDropInsertionData(t);if(s.stopWindowGroupTabBarSliding&&this._stopTabBarSliding(),i!==s.movedWindowNewIndex){this._tab.tabBar._exchangeTabs(this._tab.getPageValueFromIndex(i),this._tab.getPageValueFromIndex(s.movedWindowNewIndex)),this._tab.tabBar._slideToValue();for(var a=this.getEmbeddedWindows(),r=0;r<a.length;r++)a[r]._saveWindowGroupInPreferences()}},t.prototype.handleEvents=function(){var t=this;e.prototype.handleEvents.call(this),o.addEventOnElement(this,this._tab.tabBar,"pinStateChange",function(e){var i=t._getWindowFromIndex(t._tab.getPageIndexFromValue(e.options.value));i&&void 0!==e.options.pinnedFlag?(i._properties.pinnedFlag.value=e.options.pinnedFlag,void 0!==i.identifier&&i._savePinnedFlagInPreferences()):console.log(e)}),o.addEventOnElement(this,this._tab,"change",function(){t._applyPosition(),t._updateCurrentWindows()}),this._tab.tabBar.onRemoveTabEvent(function(e){t._getWindowFromIndex(e.index).close()}),this._tab.tabBar.onPinTab(function(e){t._updateCurrentWindows()}),this._tab.tabBar.onUnpinTab(function(e){t._updateCurrentWindows()}),o.addEventOnElement(this,this,"move",function(){t._tab&&t._tab.tabBar&&t._tab.tabBar._tabComboBox&&t._tab.tabBar._tabComboBox._hidePopup()})},t.prototype._buildOrDelagateContextualMenu=function(e){var t=[];if(e&&e.infos&&e.infos.target){var i=o.firstParentWithClass(e.infos.target,"wux-controls-button"),n=i?i.dsModel:void 0,s=n?n.value:this.currentWindows&&this.currentWindows.length>0?this._getIndexFromWindow(this.currentWindows[0]):0,a=this._getWindowFromIndex(this._tab.getPageIndexFromValue(s));e.isGroupTarget=!n,a&&(t=a.onContextualEvent(e))}return t},t.prototype._getMenuToAddData=function(e,t){var i,n=!1,s=!1;if(t.infos&&t.infos.target){var a=o.firstParentWithClass(t.infos.target,"wux-controls-button");i=a&&a.dsModel?a.dsModel:void 0,"close"===e?(n=i&&void 0!==i.value?void 0!==this._tab.tabBar.getButtonFromValue(i.value).elements._sideButton:this.closeButtonFlag,i||(s=!0)):"maximize"===e&&(n=this.maximizeButtonFlag)}return{canbeAdded:n,menuTarget:i,closeAll:s}},t.prototype._onCloseContextMenuAction=function(e){e?this._tab.tabBar._closeListener(e):this.close()},t.prototype._activateWindowForContextMenu=function(e){var t=o.firstParentWithClass(e,"wux-controls-button"),i=t?t.dsModel:void 0;i&&(this.activeFlag=!0,i.checkFlag=!0)},t.prototype._startTabBarSliding=function(e){var t=this;this._tabBarSlidingInterval||(this._tabBarSlidingInterval=window.setInterval(function(){t._tab&&t._tab.tabBar?t._tab.tabBar._slideTabBar(e):t._stopTabBarSliding()},900))},t.prototype._stopTabBarSliding=function(){this._tabBarSlidingInterval&&(window.clearInterval(this._tabBarSlidingInterval),delete this._tabBarSlidingInterval,this._tabBarSlidingInterval=null)},t.prototype._stopDrag=function(){this._stopTabBarSliding()},t.prototype._setZIndex=function(t){e.prototype._setZIndex.call(this,t);var i=this.getEmbeddedWindows();if(i.length>0)for(var n=0;n<i.length;n++)i[n]._setZIndex(t)},t}(h),p=function(e){if((!0===this.resizableFlag||"true"===this.resizableFlag||"horizontal"===this.resizableFlag)&&e>=this.minWidth)for(var t=this.getEmbeddedWindows(),i=0;i<t.length;i++)!0!==t[i].resizableFlag&&"true"!==t[i].resizableFlag&&"horizontal"!==t[i].resizableFlag||(t[i].width=e)},m=function(e){if((!0===this.resizableFlag||"true"===this.resizableFlag||"vertical"===this.resizableFlag)&&e>=this.minHeight)for(var t=this.getEmbeddedWindows(),i=0;i<t.length;i++)!0!==t[i].resizableFlag&&"true"!==t[i].resizableFlag&&"vertical"!==t[i].resizableFlag||(t[i].height=e)};return n.addClass(u,"windowgroupastab"),u});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Windows/Panel",["require","exports","UWA/Core","DS/Core/WebUXComponents","DS/Windows/Window","DS/Utilities/Utils","DS/Controls/Button","DS/Controls/Expander","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Core/WebUXGlobalEnums","DS/Windows/WindowGroupAsTab","DS/Windows/WindowGroupAsGrid","DS/Controls/TooltipModel","i18n!DS/Windows/assets/nls/translation"],function(e,t,i,n,o,s,a,r,l,d,h,c,u,p,m){"use strict";var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{collapsibleFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},snappableFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},floatableFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},headerPopupContent:{defaultValue:void 0,type:"Object",category:"Behavior"},pinnedFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},showTitleFlag:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this._savedPreferencesKeys.push("pinnedFlag"),this.elements.container.addClassName("wux-windows-panel wux-medium-background"),this.elements._titleBarDiv.addClassName("wux-windows-panel"),this.elements._buttonsDiv=new i.Element("div",{class:"wux-windows-panel-buttons"}),this.elements._buttonsDiv.inject(this.elements._mainContentDiv,"top"),this.elements._buttonsDiv.hide(),this.allowedDockAreas=h.WUXDockAreaEnum.TopDockArea|h.WUXDockAreaEnum.BottomDockArea|h.WUXDockAreaEnum.LeftDockArea|h.WUXDockAreaEnum.RightDockArea},t.prototype._applyHeaderPopupContent=function(e){var t=this;function n(e){if(t.elements._headerPopup&&t.elements._headerPopup.elements&&!d.isElementInside(e.target,t.elements._headerPopup.elements.header)&&!d.isElementInside(e.target,t.elements._headerPopup.elements.expanderContainer)){var i=Object.keys(t.buttons).length;void 0!==t.buttons&&i>0&&e.target.parentNode!==t.buttons.Ok.getContent()&&e.target!==t.buttons.Ok.getContent()&&e.target.parentNode!==t.buttons.Cancel.getContent()&&e.target!==t.buttons.Cancel.getContent()?t.elements._headerPopup.close():0===i&&t.elements._headerPopup.close()}}function o(e){if(t.elements._headerPopup&&t.elements._headerPopup.elements&&!d.isElementInside(e.target,t.elements._headerPopup.elements.header)&&!d.isElementInside(e.target,t.elements._headerPopup.elements.expanderContainer)){var i=Object.keys(t.buttons).length;void 0!==t.buttons&&i>0&&e.target.parentNode!==t.buttons.Ok.getContent()&&e.target!==t.buttons.Ok.getContent()&&e.target.parentNode!==t.buttons.Cancel.getContent()&&e.target!==t.buttons.Cancel.getContent()?(t.elements._headerPopup.close(),e.target!==t.elements._titleBarDiv&&e.stopPropagation()):0===i&&(t.elements._headerPopup.close(),e.stopPropagation())}}function s(e){t.elements._headerPopup.close()}if(this.headerPopupContent){if(this.headerPopupContent.content){this.elements._headerPopup&&(this.elements._headerPopup.hasClassName&&this.elements._headerPopup.hasClassName("wux-windows-panel-simplesuperfeature")||this.elements._headerPopup.getContent&&this.elements._headerPopup.getContent()&&this.elements._headerPopup.getContent().hasClassName("wux-windows-panel-simplesuperfeature"))&&(this.elements._headerPopup.destroy(),delete this.elements._headerPopup),this.elements._headerPopup?(this.elements._headerPopup.header=this.headerPopupContent.title,this.elements._headerPopup.body=this.headerPopupContent.content):this.elements._headerPopup=new r({header:this.headerPopupContent.title,body:this.headerPopupContent.content,style:"mode-selector"}),this.elements._buttonsDiv.removeClassName("wux-windows-panel-buttons"),this.elements._buttonsDiv.addClassName("wux-windows-panel-expander"),this.elements._mainContentDiv.style.background="",this.elements._contentDiv.style.animation="wux-unblur 0.3s forwards",this.elements._mainContentDiv.style.pointerEvents="all",document.removeEventListener(l.POINTERUP,n),document.removeEventListener(l.POINTERDOWN,o,!0),e&&e.content&&d.removeEventOnElement(this,e.content,"buttonclick",s),this.elements._buttonsDiv.show();var a=this;d.addEventOnElement(this,this.headerPopupContent.content,"buttonclick",s),d.addEventOnElement(this,this.elements._headerPopup,"transitionend",function(e){e.target===a.elements._headerPopup&&e.stopPropagation()}),d.addEventOnElement(this,this.elements._headerPopup,"expand",function(e){a.elements._mainContentDiv.style.background="rgba(255, 255, 255, 0.76)",a.elements._contentDiv.style.animation="wux-blur 0.3s forwards",a.elements._mainContentDiv.style.pointerEvents="none",document.addEventListener(l.POINTERUP,n),document.addEventListener(l.POINTERDOWN,o,!0)}),d.addEventOnElement(this,this.elements._headerPopup,"collapse",function(e){a.elements._mainContentDiv.style.background="",a.elements._contentDiv.style.animation="wux-unblur 0.3s forwards",a.elements._mainContentDiv.style.pointerEvents="all",document.removeEventListener(l.POINTERUP,n),document.removeEventListener(l.POINTERDOWN,o,!0)}),d.addEventOnElement(this,this.elements._titleBarDiv,l.POINTERDOWN,function(e){a.elements._headerPopup.close()})}else this.elements._headerPopup&&!this.elements._headerPopup.hasClassName("wux-windows-panel-simplesuperfeature")&&(this.elements._headerPopup.destroy(),delete this.elements._headerPopup),this.elements._headerPopup?this.elements._headerPopup.setText(this.headerPopupContent.title):(this.elements._headerPopup=new i.Element("div",{class:"wux-windows-panel-simplesuperfeature",text:this.headerPopupContent.title}),this.elements._buttonsDiv.addClassName("wux-windows-panel-buttons"),this.elements._buttonsDiv.removeClassName("wux-windows-panel-expander"));this.elements._headerPopup.inject(this.elements._buttonsDiv)}else this.elements._headerPopup&&(this.elements._headerPopup.destroy(),delete this.elements._headerPopup);this._applyButtons()},t.prototype._superFeatureCallback=function(e,t,i,n){return i&&(this.headerPopupContent={title:e.label,content:n}),e.checkFlag=!0,t&&t(),e.label},t.prototype.buildSuperFeature=function(e){var t=this,n=!e.title,o=void 0;if(this.elements._buttonsDiv.hasChildNodes()&&this.elements._headerPopup)for(var s=0;s<this.elements._buttonsDiv.childNodes.length;s++){var l=this.elements._buttonsDiv.childNodes[s];(l.dsModel&&l.dsModel instanceof r||l.hasClassName("wux-windows-panel-simplesuperfeature"))&&(l.remove(),this.elements._headerPopup=void 0)}if(e.content){(o=new i.Element("div",{class:"wux-windows-panel-superfeature"})).setStyles({display:"flex","justify-content":"space-around"});for(s=0;s<e.content.length;s++){var d=new a({type:"radio",label:e.content[s].label,icon:e.content[s].icon,value:s,displayStyle:"lite-borders",clickMode:1,onClick:function(i){t._superFeatureCallback(i.dsModel,e.content[i.dsModel.value].onSelect,n,o)}});d.inject(o),d.getContent().setStyle("flex-grow","1"),0===s&&this._superFeatureCallback(d,e.content[0].onSelect,n,o)}}return e.content||n?this.headerPopupContent={title:e.title?e.title:e.content[0].label,content:o}:this.headerPopupContent={title:e.title},this.headerPopupContent},t.prototype.buildStandardButtons=function(){var e=new a({icon:{iconName:"check",fontIconFamily:WUXManagedFontIcons.Font3DS},emphasize:"secondary"});e.elements.container.addClassName("wux-windows-panel-apply");var t=new a({icon:{iconName:"wrong",fontIconFamily:WUXManagedFontIcons.Font3DS}});t.elements.container.addClassName("wux-windows-panel-cancel"),this.buttons={Ok:e,Cancel:t},d.addEventOnElement(this,e,l.POINTERUP,function(e){e.stopPropagation()}),d.addEventOnElement(this,t,l.POINTERUP,function(e){e.stopPropagation()})},t.prototype.getCollapsibleState=function(){return this.collapsibleFlag&&this.currentDockArea!==h.WUXDockAreaEnum.TopDockArea&&this.currentDockArea!==h.WUXDockAreaEnum.BottomDockArea&&!this.maximizedFlag&&!(this.currentDockArea===h.WUXDockAreaEnum.LeftDockArea&&this.verticallyStretchableFlag)&&!(this.currentDockArea===h.WUXDockAreaEnum.RightDockArea&&this.verticallyStretchableFlag)},t.prototype.getFloatableState=function(){return this.floatableFlag},t.prototype.supportsGroupType=function(e){return e===h.WUXWindowGroupTypeEnum.GroupAsTab||this.immersiveFrame.__acceptsSnapping__&&e===h.WUXWindowGroupTypeEnum.GroupAsGrid},t.prototype._canBeSnapSource=function(e,t){var i=e&&this.snappableFlag&&e!==this||t===h.WUXSnapAreaEnum.OutsideArea||t===h.WUXSnapAreaEnum.NoneArea;if(i&&e&&(i=e.immersiveFrame===this.immersiveFrame),i&&t!==h.WUXSnapAreaEnum.OutsideArea&&t!==h.WUXSnapAreaEnum.NoneArea){var n=t===h.WUXSnapAreaEnum.InsideArea?h.WUXWindowGroupTypeEnum.GroupAsTab:h.WUXWindowGroupTypeEnum.GroupAsGrid;i=this.supportsGroupType(n)}return i&&e&&t!==h.WUXSnapAreaEnum.OutsideArea&&e.getDockedFlag()&&(i=(this.allowedDockAreas&e.currentDockArea)===e.currentDockArea),i&&e&&e.maximizedFlag&&!this.allowMaximizeFlag&&(i=!1),i},t.prototype._canBeSnapTarget=function(e,t){var i=e&&e!==this&&(t===h.WUXSnapAreaEnum.OutsideArea||this.snappableFlag);if(i&&t!==h.WUXSnapAreaEnum.OutsideArea&&t!==h.WUXSnapAreaEnum.NoneArea){var n=t===h.WUXSnapAreaEnum.InsideArea?h.WUXWindowGroupTypeEnum.GroupAsTab:h.WUXWindowGroupTypeEnum.GroupAsGrid;i=this.supportsGroupType(n)}if(i&&e&&(i=e.immersiveFrame===this.immersiveFrame),i&&this.getDockedFlag())switch(this.currentDockArea){case h.WUXDockAreaEnum.LeftDockArea:case h.WUXDockAreaEnum.RightDockArea:i=t===h.WUXSnapAreaEnum.OutsideArea||t===h.WUXSnapAreaEnum.TopArea||t===h.WUXSnapAreaEnum.BottomArea||t===h.WUXSnapAreaEnum.InsideArea;break;case h.WUXDockAreaEnum.TopDockArea:case h.WUXDockAreaEnum.BottomDockArea:i=t===h.WUXSnapAreaEnum.OutsideArea||t===h.WUXSnapAreaEnum.LeftArea||t===h.WUXSnapAreaEnum.RightArea||t===h.WUXSnapAreaEnum.InsideArea}return i},t.prototype._createWindowGroup=function(e){var t={immersiveFrame:this.immersiveFrame,activeFlag:!1,maximizedFlag:this.maximizedFlag};return e===h.WUXWindowGroupTypeEnum.GroupAsTab?new c(t):new u(t)},t.prototype._applyButtons=function(t){e.prototype._applyButtons.call(this,t),0==this.elements._buttonsDiv.childNodes.length?this.elements._buttonsDiv.hide():(this.elements._headerPopup||this.elements._buttonsDiv.addClassName("wux-windows-panel-buttons"),this.elements._buttonsDiv.show())},t.prototype._applyCollapsibleFlag=function(){this._updateFromCollapsibleState()},t.prototype._applyFloatableFlag=function(){if(!this.floatableFlag&&!this.currentDockArea){var e=h.WUXDockAreaEnum.LeftDockArea;if(!(e&this.allowedDockAreas))for(var t=0,i=s.enumKeys(h.WUXDockAreaEnum);t<i.length;t++){var n=i[t];h.WUXDockAreaEnum[n]!=h.WUXDockAreaEnum.NoneDockArea&&h.WUXDockAreaEnum[n]&this.allowedDockAreas&&(e=h.WUXDockAreaEnum[n])}this.windowGroup?this.windowGroup.currentDockArea=e:this.currentDockArea=e}},t.prototype._applyWindowGroup=function(t){e.prototype._applyWindowGroup.call(this,t),this.pinnedFlag&&this._applyPinnedFlag()},t.prototype._applyPinnedFlag=function(){this.windowGroup&&this.windowGroup instanceof c&&this.windowGroup._updateWindowPinnedState(this)},t.prototype._applyShowTitleFlag=function(){this.showTitleFlag||!this.icon||"object"==typeof this.icon&&""===this.icon.iconName?this.elements._titleP.setStyle("display",""):this.elements._titleP.setStyle("display","none"),this._updateTitleStyle()},t.prototype._applyIcon=function(t){e.prototype._applyIcon.call(this,t),this._applyShowTitleFlag(),this._updateTitleStyle()},t.prototype._applyTitle=function(t){e.prototype._applyTitle.call(this,t),this._applyShowTitleFlag(),this._updateTitleStyle()},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("headerPopupContent")&&this._applyHeaderPopupContent(),this.isDirty("floatableFlag")&&this._applyFloatableFlag(),this.isDirty("collapsibleFlag")&&this._applyCollapsibleFlag(),this.isDirty("showTitleFlag")&&this._applyShowTitleFlag()},t.prototype._applyVerticallyStretchableFlag=function(t){e.prototype._applyVerticallyStretchableFlag.call(this,t),this._applyCollapsibleFlag()},t.prototype._updateTitleStyle=function(){"none"===this.elements._titleP.style.display||""===this.title?this.elements.iconPlaceholder.addClassName("wux-windows-icon-no-title"):this.elements.iconPlaceholder.removeClassName("wux-windows-icon-no-title")},t.prototype._savePinnedFlagInPreferences=function(){var e={pinnedFlag:this.pinnedFlag};this._saveDataInPreferences("pinnedFlag",e)},t.prototype._getPinnedFlagFromPreferences=function(){return this._getDataFromPreferences("pinnedFlag")},t.prototype._readWindowPreferences=function(){e.prototype._readWindowPreferences.call(this);var t=this._getPinnedFlagFromPreferences();t&&(this.pinnedFlag=t.pinnedFlag)},t.prototype._showMessage=function(e,t,n,o){if(!this.elements._messageContainer&&this.elements._mainContentDiv&&(this.elements._messageContainer=new i.Element("div",{class:"wux-windows-window-message-container"}),this.elements._messageContainer.hide(),this.elements._messageContainer.inject(this.elements._mainContentDiv)),this.elements._messageContainer){var s=this;if(this._hideMessageTimeOut&&(clearTimeout(this._hideMessageTimeOut),this._hideMessageTimeOut=null),this.elements._messageIcon||(this.elements._messageIcon=new i.Element("div",{class:"wux-windows-window-message-icon"}),this.elements._messageIcon.inject(this.elements._messageContainer)),this.elements._messageIcon){switch(e){case h.WUXInformationLevelEnum.NoLevel:this.elements._messageContainer.removeAttribute("information-level"),this.elements._messageIcon.setAttribute("class","wux-windows-window-message-icon");break;case h.WUXInformationLevelEnum.Question:this.elements._messageContainer.setAttribute("information-level","question"),this.elements._messageIcon.setAttribute("class","wux-windows-window-message-icon wux-ui-3ds wux-ui-3ds-attention");break;case h.WUXInformationLevelEnum.Information:this.elements._messageContainer.setAttribute("information-level","information"),this.elements._messageIcon.setAttribute("class","wux-windows-window-message-icon wux-ui-3ds wux-ui-3ds-info");break;case h.WUXInformationLevelEnum.Warning:this.elements._messageContainer.setAttribute("information-level","warning"),this.elements._messageIcon.setAttribute("class","wux-windows-window-message-icon wux-ui-3ds wux-ui-3ds-attention");break;case h.WUXInformationLevelEnum.Error:this.elements._messageContainer.setAttribute("information-level","error"),this.elements._messageIcon.setAttribute("class","wux-windows-window-message-icon wux-ui-3ds wux-ui-3ds-error");break;case h.WUXInformationLevelEnum.Success:this.elements._messageContainer.setAttribute("information-level","success"),this.elements._messageIcon.setAttribute("class","wux-windows-window-message-icon wux-ui-3ds wux-ui-3ds-check")}e===h.WUXInformationLevelEnum.NoLevel?this.elements._messageIcon.hide():this.elements._messageIcon.show()}this.elements._messageDiv||(this.elements._messageDiv=new i.Element("div",{class:"wux-windows-window-message-text"}),this.elements._messageDiv.inject(this.elements._messageContainer)),this.elements._messageDiv.textContent=t,o||void 0===o?(this.elements._messageCloseButton||(this.elements._messageCloseButton=new i.Element("button",{type:"button",class:"wux-windows-window-message-close wux-ui-3ds wux-ui-3ds-wrong"}).inject(this.elements._messageContainer),this.elements._messageCloseButton.tooltipInfos=new p({shortHelp:m.get("close")}),this.elements._messageCloseButton.addEventListener(l.POINTERUP,function(e){s._hideMessage(),e.stopPropagation()})),this.elements._messageCloseButton.show()):this.elements._messageCloseButton&&this.elements._messageCloseButton.hide(),this.elements._messageContainer.show(),n>0&&(this._hideMessageTimeOut=setTimeout(function(){s._hideMessage()},1e3*n))}},t.prototype._hideMessage=function(){this._hideMessageTimeOut&&(clearTimeout(this._hideMessageTimeOut),this._hideMessageTimeOut=null),this.elements._messageContainer&&this.elements._messageContainer.hide()},t}(o);return n.addClass(g,"panel"),g});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Windows/ImmersiveFrame",["require","exports","UWA/Core","DS/Utilities/Utils","DS/Utilities/Dom","DS/Utilities/WUXUWAUtils","DS/Core/WebUXComponents","DS/Core/WebUXGlobalEnums","DS/Controls/Abstract","DS/Windows/Window","DS/Windows/DockingElement","DS/Windows/DockingElementForImmersiveFrame","DS/Windows/Panel","i18n!DS/Windows/assets/nls/translation"],function(e,t,i,n,o,s,a,r,l,d,h,c,u,p){"use strict";var m=22;function g(e,t){var i=null,o=r.WUXSnapAreaEnum.NoneArea;if(e)for(var s in this.windows){var a=this.windows[s];if(a){if(a.windowGroup&&a.windowGroup.getGroupType()===r.WUXWindowGroupTypeEnum.GroupAsTab)continue;if(a!==e){var l=a.getBoundingClientRect();if(n.rectContains(l,t)){var d=i?i._getTopWindow():void 0;a._isFakeWindowForStacking||!(!i||d.getZIndex()<a.getZIndex()||d.getDockedFlag()&&!a.getDockedFlag())||a.isAWindowGroup()&&a.getGroupType()===r.WUXWindowGroupTypeEnum.GroupAsGrid||(i=a)}}}}if(i){if(e._canBeSnapSource(i,r.WUXSnapAreaEnum.LeftArea)&&i._canBeSnapTarget(e,r.WUXSnapAreaEnum.LeftArea)){var h=i._getSnapAreaRect(r.WUXSnapAreaEnum.LeftArea);n.rectContains(h,t)&&(o=r.WUXSnapAreaEnum.LeftArea)}if(o===r.WUXSnapAreaEnum.NoneArea&&e._canBeSnapSource(i,r.WUXSnapAreaEnum.RightArea)&&i._canBeSnapTarget(e,r.WUXSnapAreaEnum.RightArea)){var c=i._getSnapAreaRect(r.WUXSnapAreaEnum.RightArea);n.rectContains(c,t)&&(o=r.WUXSnapAreaEnum.RightArea)}if(o===r.WUXSnapAreaEnum.NoneArea&&e._canBeSnapSource(i,r.WUXSnapAreaEnum.TopArea)&&i._canBeSnapTarget(e,r.WUXSnapAreaEnum.TopArea)){var u=i._getSnapAreaRect(r.WUXSnapAreaEnum.TopArea);n.rectContains(u,t)&&(o=r.WUXSnapAreaEnum.TopArea)}if(o===r.WUXSnapAreaEnum.NoneArea&&e._canBeSnapSource(i,r.WUXSnapAreaEnum.BottomArea)&&i._canBeSnapTarget(e,r.WUXSnapAreaEnum.BottomArea)){var p=i._getSnapAreaRect(r.WUXSnapAreaEnum.BottomArea);n.rectContains(p,t)&&(o=r.WUXSnapAreaEnum.BottomArea)}if(o===r.WUXSnapAreaEnum.NoneArea&&void 0===i._isFakeWindowForStacking&&e._canBeSnapSource(i,r.WUXSnapAreaEnum.InsideArea)&&i._canBeSnapTarget(e,r.WUXSnapAreaEnum.InsideArea)){var m=i._getSnapAreaRect(r.WUXSnapAreaEnum.InsideArea);n.rectContains(m,t)&&(o=r.WUXSnapAreaEnum.InsideArea)}}this._snapTargetWindow===i&&this._latestActiveSnapArea===o||(this._snapTargetWindow&&(this._snapTargetWindow.activeSnapArea=r.WUXSnapAreaEnum.NoneArea),this._snapTargetWindow=o!==r.WUXSnapAreaEnum.NoneArea?i:void 0,this._latestActiveSnapArea=o,i&&o!==r.WUXSnapAreaEnum.NoneArea&&(this._snapPointer=t,this._snapTargetWindow.activeSnapArea=o,e&&o===r.WUXSnapAreaEnum.InsideArea&&this._initStackingAsTabWindowsTimer(this._snapTargetWindow,e)))}function f(e,t,i){if(this._snapTargetWindow){var n=i||this._snapTargetWindow,o=this._snapTargetWindow.activeSnapArea;e._attachToWindow(n,o,t,!0),e.windowGroup&&(e.windowGroup.activeFlag=!0);var s=e.elements.container?e:n;s._saveWindowGroupInPreferences(),s._saveDockAreaInPreferences(),this._snapTargetWindow.activeSnapArea=r.WUXSnapAreaEnum.NoneArea,this._snapTargetWindow=null}else this._activeDockingElement&&(e.setPropertyFromUIInteraction("currentDockArea",this._activeDockingElement.side),e.currentDockArea===this._activeDockingElement.side&&(e._saveDockAreaInPreferences(),1===this._activeDockingElement.getDisplayedWindows().length&&this._activeDockingElement._saveDockingZoneSizeInPreferences()));this._activeDockingElement&&(this._activeDockingElement.interactiveDockAreaVisibleFlag=!1,this._activeDockingElement=null),e.elements.container&&e.elements.container.removeClassName("wux-windows-window-furtive")}function w(e){e&&(e.interactiveDockAreaVisibleFlag=!1,e.__collapseMemory&&(e.collapseDockingZoneFlag=!0,e.__collapseMemory=!1),0===e.getContainedVisibleWindows().length&&(e.visibleDockingZoneFlag=!1))}function _(e){var t=this.getContent().getBoundingClientRect(),i=this.getDockingElement(e).getContent().getBoundingClientRect();switch(e){case r.WUXDockAreaEnum.TopDockArea:return{x:t.left,y:i.top-m,width:t.width,height:2*m};case r.WUXDockAreaEnum.BottomDockArea:return{x:t.left,y:i.bottom-m,width:t.width,height:2*m};case r.WUXDockAreaEnum.LeftDockArea:return{x:i.left-m,y:t.top,width:2*m,height:t.height};case r.WUXDockAreaEnum.RightDockArea:return{x:i.right-m,y:t.top,width:2*m,height:t.height}}}function v(e,t,i,n){if(t.shouldDockingZoneSizeChangeWhenDockingWindow()){var s=t.dockingZoneSize,a=window.getComputedStyle(e.getTitleBar()),l=e._getDockedDimensionsFromPreferences(),d=i===r.WUXDockAreaEnum.LeftDockArea||i===r.WUXDockAreaEnum.RightDockArea?"width":"height";if((!o.isCurrentlyCalledFromUIInteraction()||n&&n.restoreDockedPreferences)&&l&&l[d])s=l[d];else if(e.arePreferencesRestored()&&t.side===r.WUXDockAreaEnum.TopDockArea||t.side==r.WUXDockAreaEnum.BottomDockArea){e.getContent().offsetParent||-1!==e.height||e.immersiveFrame.moveWindowToImmersiveFrame(e),s=-1===e.height?parseInt(window.getComputedStyle(e.getContent()).height):e.height+e._getTitleBarHeight(),0===parseInt(a.borderTop)&&s++,t.useBordersFlag&&s++}else if(e.arePreferencesRestored()){e.getContent().offsetParent||-1!==e.width||e.immersiveFrame.moveWindowToImmersiveFrame(e),s=(-1===e.width?parseInt(window.getComputedStyle(e.getContent()).width):e.width)+1,0===parseInt(a.borderLeft)&&s++,t.useBordersFlag&&s++}return s}}var y=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return s.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{dockingElementsPriority:{defaultValue:[r.WUXDockAreaEnum.LeftDockArea,r.WUXDockAreaEnum.RightDockArea,r.WUXDockAreaEnum.TopDockArea,r.WUXDockAreaEnum.BottomDockArea],type:"Array",readOnly:!0,category:"Behavior"},reactToPointerEventsFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},dockingElementsAutoExpandFlag:{defaultValue:!0,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_privateProperties",{get:function(){return{_ActionBar_V3:{defaultValue:!1,type:"boolean",category:"Appearance",noNeedToApplyFlag:!0}}},enumerable:!1,configurable:!0}),t.prototype.getSnapTargetWindow=function(){return this._snapTargetWindow},t.prototype.init=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this._insertedInDOM=!1,this._fakeStackedWindow=null,this._snapSourceWindow=null,this._stopDragOccured=!0,this.windows={},this.dockingElements=[],this.__acceptsSnapping__=!1,e.prototype.init.apply(this,t)},t.prototype._preBuildView=function(t){e.prototype._preBuildView.call(this,t),t&&t._ActionBar_V3&&this._properties.dockingElementsPriority&&(this._properties.dockingElementsPriority.value=[r.WUXDockAreaEnum.TopDockArea,r.WUXDockAreaEnum.BottomDockArea,r.WUXDockAreaEnum.LeftDockArea,r.WUXDockAreaEnum.RightDockArea])},t.prototype._postBuildView=function(){this.elements.container.addClassName("wux-windows-immersive-frame");for(var e=0;e<this.dockingElementsPriority.length;e++)this._addDockingZone(this.dockingElementsPriority[e],200);this.getFreeZone().addClassName("wux-windows-immersive-frame-freeZone"),this._snapTargetWindow=null,this._activeDockingElement=null,this.elements.pointerEventsDiv=new i.Element("div",{class:"wux-windows-immersive-frame-pointer-events"}).inject(this.elements.container),this.elements.pointerEventsDiv.hide();var t=this;o.onNodeRendered(this.getContent(),function(){t._insertedInDOM=!0,t._onResizeFun&&t._onResizeFun()})},t.prototype._applyIdentifier=function(e){this.identifier&&this.getContent().setAttribute("wux-identifier",this.identifier)},t.prototype.isInsertedInDOM=function(){return!!this._insertedInDOM},t.prototype._applyReactToPointerEventsFlag=function(e){this.reactToPointerEventsFlag?this.elements.container.removeClassName("wux-windows-immersive-frame-no-pointerevents"):this.elements.container.addClassName("wux-windows-immersive-frame-no-pointerevents")},t.prototype.dockWindow=function(e,t,i){var n,o=e._getDockAreaFromPreferences();if(e&&e.allowedDockAreas&&e.allowedDockAreas&t&&(this._isCurrentlyCalledFromUIInteraction()||i&&i.ignorePreferences||void 0===o||o===t)){var s=this.getDockingElement(t);if(s){var a=this.getWindowsInDockingElement(t),l=a[0]===e&&a.length>1?a[1]:a[0];if(!(i&&i.attachToOtherDockedWindow&&a.length>0&&l!==e)||e.windowGroup&&l.windowGroup&&e.windowGroup===l.windowGroup){if(!e.windowGroup||e.currentDockArea!=t){s.interactiveDockAreaVisibleFlag=!1,s.visibleDockingZoneFlag=!0,s.__onTransitionEnd();var d=void 0;if(s.shouldDockingZoneSizeChangeWhenDockingWindow()&&(d=v(e._getTopWindow(),s,t,i)),e.windowGroup&&(e.windowGroup=null),!s.containsContent(e.getContent()))if(this.__DockingTabsInBottomArea&&t===r.WUXDockAreaEnum.BottomDockArea){var h=this._getDockingTabProperties(e);h.isSelected=!0,i&&i.restoreDockedPreferences&&(h.index=e._getDockAreaIndexFromPreferences()),s.addContent(h,{createNewTab:!0})}else s.addContent(e.getContent());d&&!isNaN(d)&&(s.dockingZoneSize=d),s._saveDockingZoneSizeInPreferences()}}else n={targetWindow:a[0],beforeOrAfter:"after"};e.immersiveFrame=this,e.currentDockArea=t,n&&e.attachToWindow(n.targetWindow,r.WUXSnapAreaEnum.InsideArea,n.beforeOrAfter),s._updateFromContainedWindows(),s._updateContainedWindows()}}return e.currentDockArea===t?1:-1},t.prototype.getWindowsInDockingElement=function(e){for(var t=[],i=0,n=Object.values(this.windows);i<n.length;i++){var o=n[i];o.currentDockArea!==e||o.maximizedFlag||o.windowGroup||t.push(o)}return t},t.prototype.undockWindow=function(e,t){if(e){var i=e.currentDockArea,n=this.getDockingElement(i);if(e.isBeingClosed()){var o=e.getContent().getParent();o&&o.removeChild(e.getContent())}else{if(!e.windowGroup||i!==r.WUXDockAreaEnum.NoneDockArea){var s=e.getAbsolutePosition();n?this.removeWindowFromDockingArea(e,e.currentDockArea):void 0!==t&&t!==r.WUXDockAreaEnum.NoneDockArea&&this.removeWindowFromDockingArea(e,t),this.moveWindowToImmersiveFrame(e),e.getContent().setStyle("z-index",""),e.activeFlag&&e.bringToFront(),e.setAbsolutePosition(s)}e.currentDockArea=r.WUXDockAreaEnum.NoneDockArea}n&&(n._updateFromContainedWindows(),n._updateContainedWindows(),n.pointerEventsAllIfOverflow())}},t.prototype.getFreeZone=function(){return this.dockingElements[this.dockingElements.length-1].elements.freeZone},t.prototype.setContentInBackgroundLayer=function(e){e?(this.elements._backgroundLayerDiv||(this.elements._backgroundLayerDiv=new i.Element("div",{styles:{top:0,bottom:0,right:0,left:0,position:"absolute",width:"100%",height:"100%",pointerEvents:"all"}}),this.elements._backgroundLayerDiv.inject(this.getContent(),"top")),e.inject?e.inject(this.elements._backgroundLayerDiv):this.elements._backgroundLayerDiv.appendChild(e)):this.elements._backgroundLayerDiv&&(this.elements._backgroundLayerDiv.empty(),this.elements._backgroundLayerDiv.remove(),delete this.elements._backgroundLayerDiv)},t.prototype.setViewer=function(e){this._viewer=e},t.prototype.getViewer=function(){return this._viewer},t.prototype.moveWindowToMaximizeZone=function(e){e&&(e.currentDockArea!==r.WUXDockAreaEnum.NoneDockArea&&this.removeWindowFromDockingArea(e,e.currentDockArea),e.inject(this.getFreeZone()),!this._ActionBar_V3||e.currentDockArea!==r.WUXDockAreaEnum.TopDockArea&&e.currentDockArea!==r.WUXDockAreaEnum.BottomDockArea||e._moveTitleBar(!1,this.getDockingElement(e.currentDockArea)))},t.prototype.removeWindowFromDockingArea=function(e,t){var i=this.getDockingElement(t);i&&i.removeContent(e.getContent())},t.prototype.moveWindowToImmersiveFrame=function(e){e&&e.getContent().getParent()!==this.elements.container&&(e.inject(this.elements.container),this._ActionBar_V3&&(e.currentDockArea===r.WUXDockAreaEnum.TopDockArea||e.currentDockArea===r.WUXDockAreaEnum.BottomDockArea?e._moveTitleBar(!0,this.getDockingElement(e.currentDockArea)):e._moveTitleBar(!1,this.getDockingElement(e.currentDockArea))))},t.prototype._addDockingZone=function(e,t){var i="";switch(e){case r.WUXDockAreaEnum.LeftDockArea:i="LeftDockArea";break;case r.WUXDockAreaEnum.RightDockArea:i="RightDockArea";break;case r.WUXDockAreaEnum.TopDockArea:i="TopDockArea";break;case r.WUXDockAreaEnum.BottomDockArea:i="BottomDockArea"}var n={identifier:this.identifier+"_"+i,side:e,dockingZoneSize:t,visibleDockingZoneFlag:!1,collapseDockingZoneFlag:!1,recId:this.recId?i:void 0,autoExpandFlag:this.dockingElementsAutoExpandFlag,collapserStyle:this._ActionBar_V3?h.COLLAPSER_STYLE.FIXED_AREA:h.COLLAPSER_STYLE.STANDARD},o=new c(n);o.elements.container.addClassName("wux-immersive-frame-component"),this._ActionBar_V3||(o.useBackgroundFlag=!0),0===this.dockingElements.length?o.inject(this.elements.container):o.inject(this.dockingElements[this.dockingElements.length-1].elements.freeZone),this.dockingElements.push(o)},t.prototype._removeDockingZone=function(e){this.dockingElements.length<=e||e<0||(e!==this.dockingElements.length-1&&(0===e?this.dockingElements[e+1].inject(this.elements.container):this.dockingElements[e+1].inject(this.dockingElements[e-1].elements.freeZone)),this.dockingElements[e].hide(),this.dockingElements.splice(e,1))},t.prototype._updateAllDockingZoneSize=function(){for(var e=0;e<this.dockingElements.length;e++){var t=this.dockingElements[e];t&&t._updateDockingZoneSize()}},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("reactToPointerEventsFlag")&&this._applyReactToPointerEventsFlag(t.reactToPointerEventsFlag)},t.prototype.addWindow=function(e){var t=this;if(e.windowGroup&&this.addWindow(e.windowGroup),!this.containsWindow(e)){if(this.windows[t._computeUniqueIdentifier(e)]=e,e.currentDockArea!==r.WUXDockAreaEnum.NoneDockArea||e.maximizedFlag||e.windowGroup||this.moveWindowToImmersiveFrame(e),e.immersiveFrame=this,!e.immersiveFrame)return;e._applyPosition(),o.addEventOnElement(e,e,"windowDrag",function(e){t.elements.pointerEventsDiv.show();var i=e.dsModel;if(i){if(!1===i.visibleFlag)return;if((Math.abs(e.options.deltaX)>15||Math.abs(e.options.deltaY)>15)&&(i.getDockedFlag()||i.windowGroup)){var o=i.getContent().getSize();if(i.windowGroup){if(n.isMouseOverElement(i.windowGroup.elements._titleBarDiv,e.options))return void i.windowGroup._manageDrag(i,e.options);var s=i.windowGroup,a=void 0;if(2===s.getEmbeddedWindows().length)for(var l=0;l<2;l++){var d=s.getEmbeddedWindows()[l];if(d!==i){a=d;break}}i.windowGroup.activeSnapArea=r.WUXSnapAreaEnum.NoneArea,i.windowGroup._detachWindow(i,!0),t._clearStackingWindowsTimer(),t._stopDrag(),i=t._replaceFakedWindowByReallyMovedWindow(i),a?i._saveWindowGroupInPreferences(a):i._saveWindowGroupInPreferences(s)}i.getFloatableState()&&(i.currentDockArea=r.WUXDockAreaEnum.NoneDockArea,i._saveDockAreaInPreferences()),i.activeFlag=!0,i.bringToFront();var h=i.getContent().getSize();h.width===o.width&&h.height===o.height||i._ensureTitleBarUnderPointer(e.options)}i.windowGroup||(g.call(t,i,e.options),function(e,t){var i=null;if(e.immersiveFrame===this&&e.allowedDockAreas)for(var n=0;n<this.dockingElements.length;n++){var o=this.dockingElements[n];if(e.allowedDockAreas&o.side&&!this._snapTargetWindow&&!i){var s=_.call(this,o.side);if(t.x<s.x||t.x>=s.x+s.width||t.y<s.y||t.y>=s.y+s.height)w(o);else{if(o.collapseDockingZoneFlag&&(o.__collapseMemory=!0,o.collapseDockingZoneFlag=!1),!o.visibleDockingZoneFlag){if(0===o.getContainedVisibleWindows().length){var a=v(e,o,o.side);isNaN(a)||(o.dockingZoneSize=a)}o.visibleDockingZoneFlag=!0}o.interactiveDockAreaVisibleFlag=!0,i=o}}else o.interactiveDockAreaVisibleFlag=!1}this._activeDockingElement!==i&&(this._activeDockingElement&&w(this._activeDockingElement),this._activeDockingElement=i)}.call(t,i,e.options),t._snapTargetWindow||t._activeDockingElement?i.elements.container.addClassName("wux-windows-window-furtive"):i.elements.container.removeClassName("wux-windows-window-furtive"))}}),o.addEventOnElement(e,e,"stopWindowDrag",function(e){var i,n;if(t._stopDrag(),t._fakeStackedWindow&&t._snapSourceWindow.show(),t._fakeStackedWindow&&t._fakeStackedWindow.windowGroup){var o=t._fakeStackedWindow.windowGroup.getEmbeddedWindows(),s=o.indexOf(t._fakeStackedWindow);s<o.length-1?(n=o[s+1],i="before"):(n=o[s-1],i="after"),t._fakeStackedWindow.windowGroup._detachWindow(t._fakeStackedWindow),t.undockWindow(t._fakeStackedWindow),g.call(t,e.dsModel,e.options),t._fakeStackedWindow.hide()}f.call(t,e.dsModel,i,n),t._resetStackedWindowData(),t.elements.pointerEventsDiv.hide()}),o.addEventOnElement(e,e,"startResize",function(e){t.elements.pointerEventsDiv.show(),t.elements.pointerEventsDiv.setStyle("cursor",e.options.cursor)}),o.addEventOnElement(e,e,"stopResize",function(e){t.elements.pointerEventsDiv.hide(),t.elements.pointerEventsDiv.setStyle("cursor","default")}),o.addEventOnElement(e,e,"visibleStateChange",function(){if(e.currentDockArea!==r.WUXDockAreaEnum.NoneDockArea){var i=t.getDockingElement(e.currentDockArea);i&&(e.visibleFlag?i.visibleDockingZoneFlag=!0:0===i.getContainedVisibleWindows().length&&(i.visibleDockingZoneFlag=!1))}}),this.fire("addWindow",{window:e})}},t.prototype.removeWindow=function(e){if(e){for(var t in this.windows){var i=this.windows[t];if(i&&i===e){e.currentDockArea!==r.WUXDockAreaEnum.NoneDockArea&&this.undockWindow(e),e.position.of===this.getContent()&&(e.position.of=null),e.position.constraint===this.getContent()&&(e.position.constraint=null),this.elements&&this.elements.container&&e.remove(),delete this.windows[t],e.immersiveFrame=null;break}}this.fire("removeWindow",{window:e})}},t.prototype.getDockingElement=function(e){return this.dockingElements[this.dockingElementsPriority.indexOf(e)]},t.prototype.containsWindow=function(e){var t=!1;if(e)for(var i in this.windows){var n=this.windows[i];if(n&&n===e){t=!0;break}}return t},t.prototype.setSlidingWindowGroup=function(e){this._currentSlidingWindowGroup=e},t.prototype._stopDrag=function(){this._currentSlidingWindowGroup&&this._currentSlidingWindowGroup._stopDrag()},t.prototype._computeUniqueIdentifier=function(e){for(var t=void 0!==e.identifier&&""!==e.identifier?e.identifier:"1",i=2;void 0!==this.windows[t];)t=i.toString(),i++;return t},t.prototype._getWindowFromIdentifier=function(e){for(var t in this.windows)if(this.windows.hasOwnProperty(t)){var i=this.windows[t];if(i.identifier===e)return i}},t.prototype._onResizeFun=function(){if(this.elements.container){for(var e in this.windows){var t=this.windows[e];t&&t.visibleFlag&&(t._applyWidth(),t._applyHeight(),t._applyPosition())}this._manageAllPointerEventsOnDockingElements();for(var i=window.getComputedStyle(this.getContent()),o=parseInt(i.width)>480&&parseInt(i.height)>640,s=0,a=n.enumKeys(r.WUXDockAreaEnum);s<a.length;s++){var l=a[s],d=this.getDockingElement(r.WUXDockAreaEnum[l]);d&&(d.autoExpandFlag=o&&this.dockingElementsAutoExpandFlag)}}},t.prototype._resizeFreeZoneFun=function(){this.fire("freeZoneResize")},t.prototype.handleEvents=function(){var e=this;o.addEventOnElement(this,document,"touchChange",function(){e._manageAllPointerEventsOnDockingElements()});for(var t=0;t<e.dockingElements.length;t++){(d=e.dockingElements[t])&&o.addEventOnElement(d,d,"dockResize",function(t){e._manageAllPointerEventsOnDockingElements()})}o.addResizeListener(this.elements.container,this._onResizeFun.bind(this)),o.addResizeListener(this.getFreeZone(),this._resizeFreeZoneFun.bind(this)),o.removeEventOnElement(this,this.elements.pointerEventsDiv,"click",function(){e.elements.pointerEventsDiv.hide()});for(var i=function(){e._manageAllPointerEventsOnDockingElements(),e.removeEventListener("transitionend",i)},s=function(){o.addEventOnElement(e,e,"transitionend",i)},a=0,l=n.enumKeys(r.WUXDockAreaEnum);a<l.length;a++){var d,h=l[a];(d=this.getDockingElement(r.WUXDockAreaEnum[h]))&&(o.addEventOnElement(d,d,"collapse",s),o.addEventOnElement(d,d,"expand",s))}},t.prototype.destroy=function(){if(this.elements&&this.elements.container){if(o.removeResizeListener(this.elements.container,this._onResizeFun),o.removeResizeListener(this.getFreeZone(),this._resizeFreeZoneFun),this._fakeStackedWindowSaved&&(this._fakeStackedWindowSaved.destroy(),this._fakeStackedWindowSaved=null),this.windows)for(var t=Object.keys(this.windows),i=0;i<t.length;i++)this.windows[t[i]]&&this.windows[t[i]].destroy();var n=Object.keys(this.dockingElements);for(i=n.length-1;i>=0;i--){var s=this.dockingElements[n[i]];s.destroy&&s.destroy()}e.prototype.destroy.call(this)}},t.prototype.destroyAllWindows=function(){this.destroyWindows(this.windows)},t.prototype.destroyWindows=function(e){function t(e){e.destroy&&e.destroy()}if(Array.isArray(e))for(var i=0;i<e.length;i++)t(e[i]);else for(var n=Object.keys(e).length;n>0;)t(this.windows[Object.keys(e)[0]]),n=Object.keys(e).length},t.prototype._manageAllPointerEventsOnDockingElements=function(){this.getDockingElement(r.WUXDockAreaEnum.BottomDockArea).pointerEventsAllIfOverflow(),this.getDockingElement(r.WUXDockAreaEnum.TopDockArea).pointerEventsAllIfOverflow(),this.getDockingElement(r.WUXDockAreaEnum.LeftDockArea).pointerEventsAllIfOverflow(),this.getDockingElement(r.WUXDockAreaEnum.RightDockArea).pointerEventsAllIfOverflow()},t.prototype._initStackingAsTabWindowsTimer=function(e,t){this._clearStackingWindowsTimer();var i=this;this._stopDragOccured=!1,this._stackingTimeOut=setTimeout(function(){if(i._stopDragOccured||e.activeSnapArea!==r.WUXSnapAreaEnum.InsideArea)e&&(e.activeSnapArea=r.WUXSnapAreaEnum.NoneArea);else{var n=e._computeDropInsertionData(i._snapPointer),o=i._getOrCreateFakePanelForStacking(t);i._snapSourceWindow=t,f.call(i,o,n.beforeOrAfter,n.targetWindow),t.hide(),i._fakeStackedWindow.windowGroup&&(i._fakeStackedWindow.windowGroup.activeSnapArea=r.WUXSnapAreaEnum.InsideArea)}},400)},t.prototype._clearStackingWindowsTimer=function(){this._stackingTimeOut&&(clearTimeout(this._stackingTimeOut),this._stackingTimeOut=null)},t.prototype._getOrCreateFakePanelForStacking=function(e){var t,o,s,a;if(!this._fakeStackedWindow){if(this._fakeStackedWindow=this._fakeStackedWindowSaved,!this._fakeStackedWindow)a=new i.Element("div",{class:"wux-window-stacking-place-holder-container"}),new i.Element("div",{class:"wux-window-stacking-place-holder"}).inject(a).innerText=p.get("stackingPlaceHolder"),this._fakeStackedWindow=new u({resizableFlag:!0,immersiveFrame:this,content:a}),this._fakeStackedWindow._isFakeWindowForStacking=!0;this._fakeStackedWindowSaved||(this._fakeStackedWindowSaved=this._fakeStackedWindow)}return e.isAWindowGroup()?(t="( "+e.getEmbeddedWindows().length+" )",s="folder",o=!0):(t=e.title,o=e.showTitleFlag,s=e.icon),this._fakeStackedWindow.title=t,this._fakeStackedWindow.showTitleFlag=o,this._fakeStackedWindow.icon=s,n.setPosition(this._fakeStackedWindow,e.position),this._fakeStackedWindow.show(),this._fakeStackedWindow},t.prototype._computeFiringWindowDragEvents=function(e){var t=e;return this._fakeStackedWindow&&e!==this._fakeStackedWindow&&(t=this._fakeStackedWindow.visibleFlag?this._fakeStackedWindow:this._snapSourceWindow),t},t.prototype._replaceFakedWindowByReallyMovedWindow=function(e){return e===this._fakeStackedWindow?(this._fakeStackedWindow.hide(),n.setPosition(this._snapSourceWindow,e.position),this._snapSourceWindow.show(),this._snapSourceWindow.activeFlag=!0,this._snapSourceWindow):e},t.prototype._resetStackedWindowData=function(){this._fakeStackedWindow=null,this._snapSourceWindow=null,this._stopDragOccured=!0},t.prototype._onFocusReceived=function(){e.prototype._onFocusReceived.call(this);var t=document.activeElement;if(t){var i=this._getContainingWindow(t);i&&i._setFocus(t)}},t.prototype._getContainingWindow=function(e){for(var t=e;t;){if(t&&t.dsModel&&t.dsModel instanceof d)return t.dsModel;t=t.parentElement}return null},t.prototype._linkToOtherImmersiveFrame=function(e){this._linkedImmersiveFrames||(this._linkedImmersiveFrames=[]),-1===this._linkedImmersiveFrames.indexOf(e)&&(this._linkedImmersiveFrames.push(e),e._linkToOtherImmersiveFrame(this))},t.prototype._replaceDockingZoneContent=function(e,t){var i=this.getDockingElement(e.currentDockArea);if(i){var n=this._getDockingTabProperties(t);i.replaceContent(e.getContent(),n)}},t.prototype._getDockingTabProperties=function(e){var t=e.isAWindowGroup()?"folder":e.icon;return{content:e.getContent(),icon:t,label:!t&&e.title?e.title.substring(0,1):void 0}},t}(l);return a.addClass(y,"immersiveFrame"),y});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/Windows/ImmersiveWindow",["require","exports","DS/Windows/Panel","DS/Core/WebUXComponents","DS/Utilities/Dom","DS/Core/PointerEvents","DS/Core/WebUXGlobalEnums","UWA/Core"],function(e,t,i,n,o,s,a,r){"use strict";var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.__contentPointerDown=null,t.__gripPointerDown=null,t}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{useBackgroundFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},backgroundDraggableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},decorationFlag:{defaultValue:!0,type:"boolean",category:"Appearance"},opacity:{defaultValue:void 0,type:"number",category:"Appearance"},snappableFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},collapsibleFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},useGripFlag:{defaultValue:!1,type:"boolean",category:"Behavior"}}},enumerable:!1,configurable:!0}),t.prototype.buildView=function(){e.prototype.buildView.call(this),this.elements.container.addClassName("wux-windows-immersive-window"),this.allowedDockAreas=a.WUXDockAreaEnum.NoneDockArea},t.prototype._applyUseBackgroundFlag=function(){this.useBackgroundFlag?(this.getContent().removeAttribute("no-background"),this.elements._titleBarDiv.removeAttribute("no-background")):(this.getContent().setAttributeNode(document.createAttribute("no-background")),this.elements._titleBarDiv.setAttributeNode(document.createAttribute("no-background")))},t.prototype._applyBackgroundDraggableFlag=function(){var e=this;this.backgroundDraggableFlag?this.__contentPointerDown||(this.__contentPointerDown=function(t){t.target===e.elements._contentDiv&&e._onDragPointerDown(t)},o.addEventOnElement(this,this.elements._contentDiv,s.POINTERDOWN,this.__contentPointerDown)):this.__contentPointerDown&&(o.removeEventOnElement(this,this.elements._contentDiv,s.POINTERDOWN,this.__contentPointerDown),this.__contentPointerDown=null)},t.prototype._applyDecorationFlag=function(){this.decorationFlag?this.getContent().removeAttribute("no-decoration"):this.getContent().setAttributeNode(document.createAttribute("no-decoration"))},t.prototype._applyOpacity=function(){void 0!==this.opacity?this.getContent().setStyle("opacity",this.opacity.toString()):this.getContent().setStyle("opacity","")},t.prototype._applyUseGripFlag=function(){var e=this;if(this.useGripFlag){if(!this.elements._gripZone){if(!this.elements.container)return;this.elements._gripZone=new r.createElement("div",{class:"wux-windows-window-grip"}),this.elements._gripZoneContent=new r.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-drag-grip"}),this.elements._gripZoneContent.inject(this.elements._gripZone),this.elements._gripZone.inject(this.elements.container,"top")}this.elements._gripZone.style.display="block",this.__gripPointerDown||(this.__gripPointerDown=function(t){t.target===e.elements._gripZone&&e._onDragPointerDown(t)},this.elements._gripZone.addEventListener(s.POINTERDOWN,this.__gripPointerDown))}else this.elements._gripZone&&(this.elements._gripZone.style.display="none"),this.__gripPointerDown&&(this.elements._gripZone.removeEventListener(s.POINTERDOWN,this.__gripPointerDown),this.__gripPointerDown=null)},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("useBackgroundFlag")&&this._applyUseBackgroundFlag(),this.isDirty("backgroundDraggableFlag")&&this._applyBackgroundDraggableFlag(),this.isDirty("decorationFlag")&&this._applyDecorationFlag(),this.isDirty("opacity")&&this._applyOpacity(),this.isDirty("useGripFlag")&&this._applyUseGripFlag()},t}(i);return n.addClass(l,"immersiveWindow"),l});