define("DS/DELPPWPropertiesModule/PropertiesModule",["UWA/Core","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/constants/EditPropConstants","DS/DELWebInfrastructureControls/DELWebAddExtensionsWidget"],function(e,t,n,o,i){"use strict";return{behaviors:["UXFactoryBehavior","SelectionBehavior","ModelBehavior","ResourceBehavior","DocumentBehavior"],creator:function(r,c,a,s,l,u){var d,p,m,f,g,D,S,E,C,y,P,R,h,x,v,b,F=[];return C=function(){var n,i,E,C,y,R,h,x=r.getElement(),I=c.getComponent("WUXDockAreaEnum"),L=c.getComponent("WUXFrameWindowsManager").getFrameWindow(r.getAppContext());e.is(L)&&(n=L.getImmersiveFrame(),e.is(n)&&(h={position:{at:"top right"},side:I.RightDockArea,currentDockArea:I.RightDockArea,title:l.getNLSValue("Cmd.DisplayProperties.Title"),minWidth:450,height:300,content:x,resizableFlag:!0,visibleFlag:!1,collapsibleFlag:!0,floatableFlag:!0,verticallyStretchableFlag:!0},e.is(p)&&(h.domId=p),(d=c.create("Panel",h)).close=function(){r.notify("toggleCmdCheckHeaderState",{cmdName:"DisplayProperties",cmdState:!1})},d.immersiveFrame=n,R=n.getDockingElement(d.currentDockArea),e.is(R)&&(R.collapseDockingZoneFlag=!1),m=new t({className:"DisplayPropertiesPanel",typeOfDisplay:o.ALL,selectionType:o.NO_SELECTION,displayType:o.STANDARD,readOnly:!1,extraNotif:!0,editMode:!1,context:{getSecurityContext:function(){return{SecurityContext:s.getSecurityContext()}}},appId:widget.getValue("appId")}),f=(f=s.get3DSpaceUrl()).endsWith("/")?f.substring(0,f.length-1):f,g=s.getTenant(),(D={}).selectedId=s.getReferenceId(F[0]),D.platformUrl=f,D.platformTenant=g,D.getSecurityContext=function(){return s.getSecurityContext()},D.getSelectedRefId=function(){return v()},D.addDocument=function(e,t){u.addDocument(t,{silent:!0}),u.addDocumentConnection(e,t.id,t.relName,{silent:!0}),r.notify("documentAdded",[[e]]),r.notify("attachDocument",{})},D.deleteDocument=function(t,n,o){if(!e.is(o)){const e=u.getConnectedDocumentPIDs(t);Array.isArray(e)&&e.length>0&&(o=e.includes(`SpecificationDocument|${t}|${n}`)?"SpecificationDocument":"PLMDocConnection")}u.removeDocumentConnection(t,n,o),r.notify("attachDocument",{})},i=s.getReferenceModel(v()),e.is(i)&&"PRODUCT"!==i.get("PPRTYPE")&&m.addFacets([{require:"DS/DELPPWEnoDocuments/SpecificationsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"SpecificationDocuments",icon:"doc-log wux-ui-3ds",text:l.getNLSValue("SpecificationsFacet.Specifications")},options:{appContext:D}},{require:"DS/DELPPWEnoDocuments/AttachmentsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"RelatedDocuments",icon:"attach",text:l.getNLSValue("AttachmentsFacet.Attachments")},options:{appContext:D}}]),S&&(C=m.controller.skeleton.getFacetContent("properties"),E=c.getComponent("Button"),e.is(C)&&C.editPropertiesUI.subscribeEvt("editionSwitched",function(t){y=!1,1===a.getSelectedNodesCount()&&t&&(i=s.getReferenceModel(v()),e.is(i)&&"RESOURCE"===i.get("PPRTYPE")&&(y=!0)),y?b=new E({domId:"ManageResourceExtnBtn",label:l.getNLSValue("ResourceExtension.ManageCapacityResourceExtension"),onClick:P}).inject(widget.getElement(".TopButtonAdd"),"before"):e.is(b)&&b.remove()})),m.inject(x)))},P=function(){s.webServiceGETRequest("resources/DELWebInfrastructure/v0/interface/getImmediateDerivative?Extensions=DELRmiResourceModel/DELCapacityRscAbstract","GET",function(t){var n=t.security_ctx,o=null,c={serverName:"",serverUri:"",displayType:"editProp_standard",extraNotif:!1,context:null,events:{},tabId:"properties",eventThread:"CT27.properties",dialogTitle:l.getNLSValue("ResourceExtension.ManageCapacityResourceExtension"),jsonClassInterfaces:{interfaces:[]},multiSelect:!1,addOnReference:!1};e.is(t.Data)&&e.is(t.Data.DELCapacityRscAbstract)&&(t.Data.DELCapacityRscAbstract.forEach(e=>{c.jsonClassInterfaces.interfaces.push(e.name)}),m.controller&&m.controller.getModels&&(o=m.controller.getModels()[0])),c.addOnReference=s.isInstance(o.get("objectId")),new i(window.widget,this._parent,c,n,o,function(){m.controller.onRefresh()},function(e){r.warn(e)})},function(){console.warn(l.getNLSValue("ResourceExtension.ResourceExtensionFailure"))})},y=function(){return a.getSelections().reduce(function(e,t){return e.concat(t)},[]).map(e=>e.indexOf("|")<0?e:e.substring(e.lastIndexOf("|")+1))},v=function(){var e=y()[0];return s.getReferenceId(e)},R=function(){return y().map(function(e){return new n({tenant:s.getTenant(),service:"3DSpace",objectId:e})})},h=function(){var t,n,o,i,r=!1,c=!1;e.is(m)&&(S&&(1===a.getSelectedNodesCount()&&(n=s.getReferenceModel(v()),e.is(n)&&"RESOURCE"===n.get("PPRTYPE")&&(c=!0)),c?m.addFacets([{require:"DS/DELWebInfrastructureControls/DELWebResourceParameter/DELWebResourceParameterFacet",alwaysVisible:!0,services:["3DSpace"],facet:{name:"content_section_resource_parameter",text:l.getNLSValue("ResourceParameterFacet.ResourceParameters"),icon:"parameters"},options:{}}]):(o=m.elements.UI.getFacetContent("content_section_resource_parameter"),e.is(o)&&o.destroyComponent(),m.removeFacets(["content_section_resource_parameter"]))),E&&(1===a.getSelectedNodesCount()&&(n=s.getReferenceModel(v()),e.is(n)&&n.get("type").includes("Continuous")&&(r=!0)),r?m.addFacets([{require:"DS/ENOCharacteristicsApp/commands/ShowPerfSpecFacet",alwaysVisible:!0,services:["3DSpace"],facet:{name:"content_section_performance_specifications",text:l.getNLSValue("ShowPerfSpecFacet.Performances"),icon:"task-list"},options:{appContext:D,modelInfo:{maturity:n.get("current"),title:n.get("PLMEntity.V_Name")}}}]):(i=m.elements.UI.getFacetContent("content_section_performance_specifications"),e.is(i)&&i.destroyComponent(),m.removeFacets(["content_section_performance_specifications"]))),t=R(),m.initDatas(t))},x=function(){h()},{listenTo:function(){return{select:x}},onStart:function(t){S=!!e.is(t.dispalyResourceParameterExtension)&&t.dispalyResourceParameterExtension,E=!!e.is(t.displayShowPerfSpecExtension)&&t.displayShowPerfSpecExtension,e.is(t.identifier)&&(p=t.identifier),C(),h(),e.is(d)&&d.show()},onStop:function(){F=[],e.is(d)&&(d.hide(),e.is(m)&&(m.destroyComponent(),m=null),d.destroy(),d=null)}}}}});