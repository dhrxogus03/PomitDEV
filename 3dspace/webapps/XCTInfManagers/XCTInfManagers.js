define("DS/XCTInfManagers/XCTInfManagers",[],function(){}),define("DS/XCTInfManagers/XCTInfLoaderManager",["UWA/Core","UWA/Class/Model","UWA/Class","DS/XCTInfUtilsWeb/XCTLogger"],function(e,n,o,r){"use strict";return o.extend({init:function(){},postInitialize:function(){this.factory=this._experienceBase.Factory},readString:function(n,o,a){var t;try{t=JSON.parse(n)}catch(n){if(r.error("Invalid JSON"),e.is(a))return void a("Invalid JSON")}this.readJSON(t,o,a)},readJSON:function(n,o,a){e.is(o)?o(n):(r.error("Invalid JSON"),e.is(a)&&a("Invalid JSON"))},readJSONFile:function(n,o,r){var a=this;if(n.name.endsWith(".json")){var t=new FileReader;t.onloadend=function(e){a.readString(e.target.result,o,r)},t.readAsText(n)}else e.error("File must be a JSON")},read3DXContentCSI:function(e,n,o){o("Loading experience currently not supported")},read3DXContent:function(e,n,o){r.log(e,n,o),o("The dependencies to CAT3DExpModelerJavaScript and StudioModelCSIJavaScript had to be removed.")},GetType:function(){return"LoaderManager"}})}),define("DS/XCTInfManagers/XCTInfCommandManager",["UWA/Core","UWA/Class","UWA/Class/Promise","DS/CoreEvents/Events","DS/ApplicationFrame/CommandsManager","DS/XCTInfUtilsWeb/XCTLogger"],function(e,n,o,r,a,t){"use strict";return n.extend({initialize:function(){t.log("Init "+this.GetType())},postInitialize:function(){t.log("Postinit "+this.GetType())},getCommand:function(e,n){return a.getCommands(e)[n]},executeCommand:function(e,n,o){return t.warn("Deprecated. Use XCTInfCommandManager.beginCommand instead."),this.beginAndEndCommand(e,n,o)},disableCommand:function(e,n){this.getCommand(e,n).disable()},enableCommand:function(e,n){this.getCommand(e,n).enable()},enableAllCommands:function(e){var n=a.getCommands(e);Object.values(n).forEach(function(e){e.enable()})},beginCommand:function(n,o,a){a=e.extend({},a,!0);var i=this.getCommand(n,o);return t.log("XCTInfCommandManager.beginCommand",{context:n,commandName:o,command:i,options:a}),i.onEnd&&(this[o+"Token"]=i.onEnd(function(){r.unsubscribe(this[o+"Token"]),delete this[o+"Token"],a&&a.onEnd&&a.onEnd(i)}.bind(this))),i._experienceBase=this._experienceBase,i.appOptions=a,i.begin(),i},beginAndEndCommand:function(e,n,o){var r=this.beginCommand(e,n,o);return r.end(),r},GetType:function(){return"CommandManager"}})}),define("DS/XCTInfManagers/XCTInfDragAndDropManager",["UWA/Core","UWA/Class","DS/DataDragAndDrop/DataDragAndDrop","DS/XCTInfUtilsWeb/XCTLogger"],function(e,n,o,r){"use strict";return n.extend({init:function(){this.dropZones=[]},postInitialize:function(){this.specializationDragRunning=!1,this.specializationDragDropZone=null},register:function(n,a,t){var i=this;n._callbacks={enter:a.enter,leave:a.leave,over:a.over,drop:a.drop,fail:a.fail},n._allowedTypes=a.allowedTypes,n._forbiddenTypes=a.forbiddenTypes,n._owner=t,void 0===i.dropZones&&(i.dropZones=[]),i.dropZones.push(n);var s={enter:function(n,o){var r=i.dropZones.indexOf(n);-1!==r&&e.is(i.dropZones[r]._callbacks.enter)&&(o.origin=i.dragSource,i.dropZones[r]._callbacks.enter.call(i.dropZones[r]._owner,o))},leave:function(n,o){var r=i.dropZones.indexOf(n);-1!==r&&e.is(i.dropZones[r]._callbacks.leave)&&(o.origin=i.dragSource,i.dropZones[r]._callbacks.leave.call(i.dropZones[r]._owner,o))},over:function(n,o){var r=i.dropZones.indexOf(n);-1!==r&&e.is(i.dropZones[r]._callbacks.over)&&(o.origin=i.dragSource,i.dropZones[r]._callbacks.over.call(i.dropZones[r]._owner,o))},drop:function(n,o,a){var t=i.dropZones.indexOf(o);-1!==t&&e.is(i.dropZones[t]._callbacks.drop)&&(a.origin=i.dragSource,i.getFromDataTransfer(a.dataTransfer,function(n){e.is(i.dropZones[t]._callbacks.drop)&&(i.canDrop(n,i.dropZones[t])?i.dropZones[t]._callbacks.drop.call(i.dropZones[t]._owner,a,n):(r.error("cannot drop"),e.is(i.dropZones[t]._callbacks.fail)&&i.dropZones[t]._callbacks.fail.call(i.dropZones[t]._owner,"cannot drop this kind of object")))},function(n){e.is(i.dropZones[t]._callbacks.fail)&&i.dropZones[t]._callbacks.fail.call(i.dropZones[t]._owner,n)})),i.specializationDragRunning&&i.specializationDragDropZone!==o&&i.cancelDrag(i.specializationDragDropZone)}};o.droppable(n,s)},unRegister:function(n){if(e.is(this[n])){o.clean(n);var r=this.dropZones.indexOf(n);this.dropZones.splice(r,1),n._owner=null,n._callbacks=null}},makeDraggable:function(e,n){o.draggable(e,{data:n,start:function(e){this.dragSource=e,e.addClassName("dragged")}.bind(this),stop:function(e){e.removeClassName("dragged"),this.dragSource=void 0}.bind(this)})},canDrop:function(n,o){var r=!0;if(e.is(o._allowedTypes)){r=!1;for(var a=0;a<o._allowedTypes.length;a++)n.isKindOf&&n.isKindOf(o._allowedTypes[a])&&(r=!0)}if(r&&e.is(o._forbiddenTypes))for(var t=0;t<o._forbiddenTypes.length;t++)n.IsKindOf&&n.IsKindOf(o._forbiddenTypes[t])&&(r=!1);return r},cancelDrag:function(e){this.cleanDropZone(e),this.specializationDragRunning=!1,this.specializationDragDropZone=null},getFromFile:function(n,o,a){n.name.endsWith(".json")?this._experienceBase.getManager("LoaderManager").readJSONFile(n,o,a):(r.error("unsuported format "+n.type),e.is(a)&&a("unsuported format "+n.type))},getFromFiles:function(e,n,o){for(var r=0;r<e.length;r++){var a=e[r];this.getFromFile(a,n,o)}},getFromPlainText:function(n,o,a){var t;try{t=JSON.parse(n)}catch(n){if(r.error("Invalid JSON"),e.is(a))return void a()}"3DXContent"===t.protocol?this.getFrom3DXContent(t.version,t.source,t.data,o,a):"STUContent"===t.protocol?this.getFromSTUContent(t.version,t.source,t.data,o,a):(r.error("unknown protocol "+t.protocol),e.is(a)&&a())},getFromDataTransfer:function(e,n,o){this.getFromFiles(e.files,n,o);var r=e.getData("text/plain");r&&this.getFromPlainText(r,n,o)},getFrom3DXContent:function(n,o,r,a,t){for(var i=0;i<r.items.length;i++){var s=r.items[i];if("Stu3DExperience"===s.objectType)this._experienceBase.getManager("LoaderManager").read3DXContentCSI(s.objectId,a);else if("VPMReference"===s.objectType){var d=this._experienceBase.Factory.BuildComponent("Model_VPMReference_Spec");d.QueryInterface("CATI3DExperienceObject").SetValueByName("_varName",s.displayName),d.QueryInterface("CATI3DExperienceObject").SetValueByName("_physID",s.objectId),d.QueryInterface("CATI3DExperienceObject").SetValueByName("_service",s.serviceId),d.QueryInterface("CATI3DExperienceObject").SetValueByName("_objectType",s.objectType),a(d)}else e.is(t)&&t()}},getFromSTUContent:function(n,o,r,a){for(var t=0;t<r.items.length;t++){var i,s=r.items[t],d=s.sessionID;if(i=this._experienceBase.ComponentsMap.GetComponentFromID(d),e.is(i)&&e.is(a))a(i);else{var c=s.inlineContent;this._experienceBase.getManager("LoaderManager").readJSON(c,a)}}},cleanDropZone:function(e){o.clean(e,"drop"),e._evts={}},GetType:function(){return"DragAndDropManager"}})}),define("DS/XCTInfManagers/XCTInfCEFManager",["UWA/Core","UWA/Class","DS/XCTInfUtilsWeb/XCTLogger"],function(e,n,o){"use strict";return n.extend({initialize:function(){o.log("Init "+this.GetType())},postInitialize:function(){o.log("Postinit "+this.GetType()),this.setupInterface()},setupInterface:function(){window.logInConsole=function(e){o.log(e)}},send:function(){window.dscef&&window.dscef.sendString.apply(this,arguments)},GetType:function(){return"CEFManager"}})});