define("DS/MPFCompanyModel/CompanyMemberDataProxy",["DS/MPFDataProxy/DataProxy","UWA/Core"],function(t,e){"use strict";return t.extend({init:function(t){this._parent(t,"/mdpeoplecompany/companies/{0}/members")},request:function(t,e){"POST"!==e.method&&"PUT"!==e.method||(e.method="PATCH"),this._parent(t,e)},url:function(t,r,n){return this.connector.url(e.String.format(this.resourcePath,t.parentResourceId))},urlPatch:function(t){return this.connector.url(this.delegate.resourcePath+"/"+t.get("id"))}})}),define("DS/MPFCompanyModel/CompanyDataProxy",["UWA/Core","DS/MPFDataProxy/DataProxy"],function(t,e){"use strict";return e.extend({init:function(t,e){this._parent(t,"/mdpeoplecompany/companies",e)},urlGet:function(t,e){return e||(e={}),e.expand||(e.expand=["addresses","registrations"]),this._parent(t,e)}})}),define("DS/MPFCompanyModel/CompanyIndustryListModel",["DS/MPFModel/MPFModel"],function(t){"use strict";var e;return(e=t.extend({setup:function(t,e){this._type="CompanyIndustryListModel",this._parent(t,e)}})).Fields=Object.freeze({}),e}),define("DS/MPFCompanyModel/CheckVatDataProxy",["DS/MPFDataProxy/DataProxy","DS/MPFError/NotImplementedError"],function(t,e){"use strict";return t.extend({init:function(t,e){this._parent(t,"/mdpeoplecompany/check-vat",e)},buildPath:function(t){return this.resourcePath},urlPatch:e.emit,urlGet:e.emit,urlPut:e.emit,urlDelete:e.emit,doPatch:e.emit,doGet:e.emit,doPut:e.emit,doDelete:e.emit})}),define("DS/MPFCompanyModel/MeCompanyDataProxy",["DS/MPFDataProxy/DataProxy","DS/MPFError/NotImplementedError"],function(t,e){"use strict";return t.extend({init:function(t,e){this._parent(t,"/me/companies",e)},urlGet(){return this.connector.url(this.resourcePath)},urlPost(){return this.connector.url(this.resourcePath)},urlPut:e.emit,urlPatch:t.delegate,urlDelete:e.emit,doPut:e.emit,doPatch:t.delegate,doDelete:e.emit})}),define("DS/MPFCompanyModel/CompanyHelper",[],function(){"use strict";return{getCompanyFromPerson:function(t,e){var r,n,o;return(r=t.getCompany())&&(n=this.getIdFromUrl(r))&&(o=e.createModel("company",{id:n})),o},getIdFromUrl:function(t){return(t.match(/[0-9A-Z]{32}$/)||[""])[0]}}}),define("DS/MPFCompanyModel/CompanyIndustryListDataProxy",["DS/MPFDataProxy/DataProxy","DS/MPFError/NotImplementedError"],function(t,e){"use strict";return t.extend({init:function(t){this._parent(t,"/formats/industries")},urlPost:e.emit,urlPut:e.emit,urlPatch:e.emit,urlDelete:e.emit})}),define("DS/MPFCompanyModel/EligibleCompaniesDataProxy",["DS/MPFDataProxy/DataProxy","DS/MPFError/NotImplementedError"],function(t,e){"use strict";return t.extend({init:function(t){this._parent(t,"/me/eligibleCompanies")},urlGet(){return this.connector.url(this.resourcePath)},urlPost:e.emit,urlPut:e.emit,urlPatch:e.emit,urlDelete:e.emit,doPost:e.emit,doPut:e.emit,doPatch:e.emit,doDelete:e.emit})}),define("DS/MPFCompanyModel/MatchingCompaniesDataProxy",["DS/MPFDataProxy/DataProxy","DS/MPFError/NotImplementedError"],function(t,e){"use strict";return t.extend({init:function(t,e){this._parent(t,"/mdpeoplecompany/matching-companies",e)},buildPath:function(t){return this.resourcePath},urlPatch:e.emit,urlGet:e.emit,urlPut:e.emit,urlDelete:e.emit,doPatch:e.emit,doGet:e.emit,doPut:e.emit,doDelete:e.emit})}),define("DS/MPFCompanyModel/CompanyModel",["UWA/Core","DS/MPFModel/MPFModel","DS/MPFModel/ModelValidator","DS/MPFAddressModel/AddressFactory","DS/MPFAddressModel/AddressModel","i18n!DS/MPFCompanyModel/assets/nls/Company"],function(t,e,r,n,o,i){"use strict";const s=Object.freeze({NAME:"name",CEO_FIRST_NAME:"ceoFirstName",CEO_LAST_NAME:"ceoLastName",CEO_DATE_OF_BIRTH:"ceoDateOfBirth",CEO_PERSONAL_ID_NUMBER:"ceoPersonalId",TAX_REGISTRATION_ID:"taxRegistrationId",VAT_ID:"vatId",REGISTRATION_ID:"registrationId",IS_SELLER_DUE_TO_ONLINE_TAX:"isSellerDueToOnlineTax",COUNTRY:"country",EMP_NAME:"PrivateMPName",EMP_FILTER:"PrivateMPFilter",EMP_PROJECT_NAME:"PrivateMPProjectName",EMP_ALLOW_PUBLIC_SELLERS:"PrivateMPAllowPublicSellers",EMP_URL:"PrivateMPURL",UBO_PERSONS:"uboPersons",NO_SHAREHOLDER:"isSingleStakeHolder",DRUPAL_ID:"drupalId",SITE_ID:"siteId",BUSINESS_TYPE:"businessType",INDUSTRY:"industry",DESCRIPTION:"description",BUSINESS_WEBSITE_URL:"businessWebSiteUrl",EXECUTIVES_PROVIDED:"executivesProvided",DIRECTORS_PROVIDED:"directorsProvided",OWNERS_PROVIDED:"ownersProvided",MATCHING_COMPANIES:"matchingCompanies",BILL_TO_ADDRESS:"billToAddress",NO_VAT_ID:"noVatId",SPECIAL_ECONOMIC_ZONE:"specialEconomicZone",ACCOUNT_TOKEN:"accountToken",ADDRESS:"address"}),a=Object.freeze({COMPANY:"Company",NON_PROFIT:"NonProfil&Education"}),d=Object.freeze({[s.NAME]:null,[s.CEO_FIRST_NAME]:null,[s.CEO_LAST_NAME]:null,[s.TAX_REGISTRATION_ID]:null,[s.REGISTRATION_ID]:null,[s.IS_SELLER_DUE_TO_ONLINE_TAX]:null,[s.BUSINESS_TYPE]:a.COMPANY}),c=Object.freeze({ADDRESSES:"addresses"}),u=e.extend({defaults:d,init(t,e){this.addressFactory=e.addressFactory,this._parent(t,e)},setup:function(t,e){this.addressFactory=e.addressFactory,this._parent(t,e),this._type="CompanyModel",this.owner=null,this.addresses=null,this.constraints=e.constraints,this.validator=this._createValidator()},parse:function(e){const r=this;if(Array.isArray(e)){const o=e;(e={})[s.MATCHING_COMPANIES]=o.map(function(e){return e.billToAddress=t.is(r.addressFactory)?r.addressFactory.createModel(n.Types.COMPANY,e.billToAddress,{parse:!0,isCompanyAddress:!0}):e.billToAddress,r.parse(e)})}else{e.taxRegistrationId=t.is(e.taxRegistrationId)?e.taxRegistrationId:e.taxId,delete e.taxId,t.is(e.taxRegistrationId,"string")&&(e.taxRegistrationId=e.taxRegistrationId.trim());const r=e.owner;"object"==typeof r&&(this.owner=r),delete e.owner;const n=e.addresses;if(this.addressFactory&&"array"===t.typeOf(n))if(n.length>0&&"string"==typeof n[0]){this.addresses=this.addressFactory.createCollection("address");for(let t=0;t<n.length;t++){const e=this.addressFactory.createModel("address");e.set("id",n[t].split("/")[n[t].split("/").length-1]),e.fetch(),this.addresses.add(e)}}else this.addresses=this.addressFactory.createCollection("company",n,{parse:!0,isCompanyAddress:!0});e.hasOwnProperty("PrivateMPFilter")&&"string"==typeof e.PrivateMPFilter&&(e.PrivateMPFilter=""===e.PrivateMPFilter?[]:e.PrivateMPFilter.split(",")),delete e.addresses}return t.is(e.address)&&(e.address=new o(e.address,{dataProxy:"notNeeded",parse:!0,isCompanyAddress:!0})),e},toJSON:function(){const e=this._parent();for(const t in e)e.hasOwnProperty(t)&&null===e[t]&&delete e[t];e.hasOwnProperty("PrivateMPFilter")&&(e.PrivateMPFilter=e.PrivateMPFilter.join()),e.hasOwnProperty(s.BILL_TO_ADDRESS)&&(o.prototype.isPrototypeOf(e[s.BILL_TO_ADDRESS])?e[s.BILL_TO_ADDRESS]=e[s.BILL_TO_ADDRESS].toJSON():t.is(e[s.BILL_TO_ADDRESS],"object")&&(e[s.BILL_TO_ADDRESS].zipcode=e[s.BILL_TO_ADDRESS][o.Fields.POSTAL_CODE],delete e[s.BILL_TO_ADDRESS][o.Fields.POSTAL_CODE]));const r=e[s.NO_VAT_ID];return!0===r?e[s.NO_VAT_ID]="TRUE":!1===r&&(e[s.NO_VAT_ID]="FALSE"),e},validate:function(t){return this.validator.validate(t)},_isCeoPersonalIdNumberValid:function(t){let e=!0;const r=this.getCountryFromAddress();if(t&&r)switch(r){case"USA":e=t.test(/^(\d{4}|\d{9})$/);break;case"CAN":e=t.test(/^\d{9}$/)}return e},getID:function(){return this.getId()},setID:function(t){return this.setId(t)},getId:function(){return this.get("id")},setId:function(t){return this.set("id",t)},getOwner:function(){return this.owner},setOwner:function(t){this.owner=t},getAddresses:function(){return this.addresses},setAddresses:function(t){this.addresses=t},getName:function(){return this.get(s.NAME)},setName:function(t){return this.set(s.NAME,t)},getCeoFirstName:function(){return this.get(s.CEO_FIRST_NAME)},setCeoFirstName:function(t){return this.set(s.CEO_FIRST_NAME,t)},getCeoLastName:function(){return this.get(s.CEO_LAST_NAME)},setCeoLastName:function(t){return this.set(s.CEO_LAST_NAME,t)},getCeoFullName:function(){return this.getCeoFirstName()+" "+this.getCeoLastName()},getCeoDateOfBirth:function(){return this.get(s.CEO_DATE_OF_BIRTH)},getCeoPersonalIdNumber:function(){return this.get(s.CEO_PERSONAL_ID_NUMBER)},getRegistrationId:function(){return this.get(s.REGISTRATION_ID)},setRegistrationId:function(t){return this.set(s.REGISTRATION_ID,t)},getTaxRegistrationId:function(){return this.get(s.TAX_REGISTRATION_ID)},setTaxRegistrationId:function(t){return this.set(s.TAX_REGISTRATION_ID,t)},hasNoVatId:function(){return"TRUE"===this.get(s.NO_VAT_ID)},setNoVatId:function(t){return this.set(s.NO_VAT_ID,t?"TRUE":"FALSE")},getIsSellerDueToOnlineTax:function(){return this.get(s.IS_SELLER_DUE_TO_ONLINE_TAX)},setIsSellerDueToOnlineTax:function(t){this.set(s.IS_SELLER_DUE_TO_ONLINE_TAX,!0===t)},getCountry:function(){return this.get(s.COUNTRY)},setCountry:function(t){return this.set(s.COUNTRY,t)},getCountryFromAddress:function(){const t=this.getAddresses(),e=t&&t.first();return e&&e.getCountry()},getEmpProjectName:function(){return this.get(s.EMP_PROJECT_NAME)},getEmpName:function(){return this.get(s.EMP_NAME)},getEmpUrl:function(){return this.get(s.EMP_URL)},getUboPersons:function(){return this.get(s.UBO_PERSONS)},getNoShareHolder:function(){const t=this.get(s.NO_SHAREHOLDER);return!0===t||"TRUE"===t||"true"===t},getOwnersProvided:function(){const t=this.get(s.OWNERS_PROVIDED);return!0===t||"TRUE"===t||"true"===t},getEMPAllowPublicSellers:function(){return"TRUE"===this.get(s.EMP_ALLOW_PUBLIC_SELLERS)},getDrupalId:function(){return this.get(s.DRUPAL_ID)},getSiteId:function(){return this.get(s.SITE_ID)},getMatchingCompanies:function(){return this.get(s.MATCHING_COMPANIES)},getBillToAddress:function(){return this.get(s.BILL_TO_ADDRESS)},getAddress:function(){return this.get(s.ADDRESS)},isNonProfit:function(){return this.get(s.BUSINESS_TYPE)===a.NON_PROFIT},_createValidator:function(){return new r({model:this,validations:[{attribute:s.NAME,required:!0,requiredError:i.get("errorName")},{attribute:s.EMP_NAME,pattern:/^[A-Za-z0-9 ]*$/,required:!1,invalidError:i.get("noSpecialCharacterMessage")},{attribute:s.REGISTRATION_ID,pattern:/^(?!http:\/\/|https:\/\/|www\.).*(?!\.\w+)$/,required:!1,invalidError:i.get("errorRegistrationIdFormat")},{attribute:s.REGISTRATION_ID,pattern:/^.{0,30}$/,required:!1,invalidError:i.get("errorRegistrationIdFormat")},{attribute:s.TAX_REGISTRATION_ID,pattern:/^(?!http:\/\/|https:\/\/|www\.).*(?!\.\w+)$/,required:!1,invalidError:i.get("errorTaxRegId")},{attribute:s.CEO_FIRST_NAME,pattern:/^.{0,255}$/,required:!1,invalidError:i.get("errorCeoFirstName")},{attribute:s.CEO_LAST_NAME,pattern:/^.{0,255}$/,required:!1,invalidError:i.get("errorCeoLastName")},{attribute:s.BUSINESS_WEBSITE_URL,pattern:/^.+\..+$/,required:!1,invalidError:i.get("invalidURL")}]})}});return u.Fields=s,u.Expands=Object.freeze(c),u.BusinessTypes=Object.freeze(a),u}),define("DS/MPFCompanyModel/CompanyIndustryListFactory",["DS/MPFModelFactory/Factory","DS/MPFCompanyModel/CompanyIndustryListModel","DS/MPFCompanyModel/CompanyIndustryListDataProxy","DS/MPFError/NotImplementedError"],function(t,e,r,n){"use strict";var o={STRIPE:"Stripe"},i=t.extend({createModel:function(t,r,n){return t=t||o.STRIPE,this._parent(e,t,r,n)},createCollection:n.emit,getDataProxy:function(){return this.dataProxies[o.STRIPE]||(this.dataProxies[o.STRIPE]=new r(this.connector)),this.dataProxies[o.STRIPE]}});return i.Types=o,i}),define("DS/MPFCompanyModel/CompanyCollection",["UWA/Core","DS/MPFModel/MPFCollection","DS/MPFCompanyModel/CompanyModel"],function(t,e,r){"use strict";return e.extend({model:r,setup(t,e={}){this.constraints=e.constraints,this.addressFactory=e.addressFactory,this._parent(t,e)}})}),define("DS/MPFCompanyModel/CompanyFactory",["UWA/Promise","DS/MPFModelFactory/Factory","DS/MPFCompanyModel/CompanyDataProxy","DS/MPFCompanyModel/MeCompanyDataProxy","DS/MPFCompanyModel/MatchingCompaniesDataProxy","DS/MPFCompanyModel/EligibleCompaniesDataProxy","DS/MPFCompanyModel/CheckVatDataProxy","DS/MPFCompanyModel/CompanyModel","DS/MPFCompanyModel/CompanyCollection","DS/MPFCompanyConstraintsModel/CompanyConstraintsCollection","DS/MPFCompanyConstraintsModel/CompanyConstraintsDataProxy"],function(t,e,r,n,o,i,s,a,d,c,u){"use strict";const l={COMPANY:"COMPANY",MATCHING_COMPANIES:"MATCHING_COMPANIES",ELIGIBLE_COMPANIES:"ELIGIBLE_COMPANIES",CHECK_VAT:"CHECK_VAT",ME:"ME",CONSTRAINTS:"CONSTRAINTS"},P=e.extend({init:function(t,e={}){this._parent(t,e),this.addressFactory=e.addressFactory,this.loadConstraints=!1!==e.loadConstraints,this.companyConstraints=new c([],{dataProxy:this.getDataProxy("constraints")})},whenReady:function(){return this.companyConstraints.size()>0||!this.loadConstraints?t.resolve(this.companyConstraints):this.companyConstraints.fetchPromise()},createModel:function(t,e,r={}){return r.addressFactory=r.addressFactory||this.addressFactory,r.constraints=r.constraints||this.companyConstraints,this._parent(a,t,e,r)},createCollection:function(t,e,r={}){return r.addressFactory=r.addressFactory||this.addressFactory,r.constraints=r.constraints||this.companyConstraints,this._parent(d,t,e,r)},getDataProxy:function(t){let e;return(t=t&&t.toUpperCase())===l.ME?(this.dataProxies.me||(this.dataProxies.me=new n(this.connector,this.getDataProxy(l.COMPANY))),e=this.dataProxies.me):t===l.CONSTRAINTS?(this.dataProxies.constraints||(this.dataProxies.constraints=new u(this.connector)),e=this.dataProxies.constraints):t===l.MATCHING_COMPANIES?(this.dataProxies.matchingCompanies||(this.dataProxies.matchingCompanies=new o(this.connector)),e=this.dataProxies.matchingCompanies):t===l.ELIGIBLE_COMPANIES?(this.dataProxies.eligibleCompanies||(this.dataProxies.eligibleCompanies=new i(this.connector)),e=this.dataProxies.eligibleCompanies):t===l.CHECK_VAT?(this.dataProxies.checkVat||(this.dataProxies.checkVat=new s(this.connector)),e=this.dataProxies.checkVat):(this.dataProxies.company||(this.dataProxies.company=new r(this.connector)),e=this.dataProxies.company),e}});return P.Types=Object.freeze(l),P});