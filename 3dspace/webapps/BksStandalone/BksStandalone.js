define("DS/BksStandalone/Ajax",["DS/WAFData/WAFData","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUXUtil/private/CredentialsConverter"],(e,t,n)=>{return{getConnectedUser:function(a){var i=new Promise(async i=>{var s=await function(n){var a=new Promise(t=>{var a=n+"/api/v1/services?cors=true&xrequestedwith=xmlhttprequest",i={method:"GET",headers:{Accept:"application/json"},onComplete:e=>{var n=JSON.parse(e).platforms[0].services,a=null;n.every(e=>("space"===e.id&&(a=e.url),!a)),t(a)}};i.onFailure=t.bind(this,!1),i.onTimeout=t.bind(this,!1),e.authenticatedRequest(a,i)});return a.then(e=>{e||t.displayNotification({message:"Provided my apps url doesn't exist",className:"warning"})}),a}(a);if(s){var r=s+"/resources/modeler/pno/person?current=true&select=preferredcredentials&select=collabspaces",l={method:"GET",headers:{Accept:"application/json"},onComplete:e=>{var t=JSON.parse(e),a=n.computeCredentials(t,null,!1);a.user=t.name,i(a)}};l.onFailure=i.bind(this,!1),l.onTimeout=i.bind(this,!1),e.authenticatedRequest(r,l)}else i(null)});return i.then(e=>{e||null===e||t.displayNotification({message:"Can't find the current user",className:"warning"})}),i}}}),define("DS/BksStandalone/utils/Helper",[],()=>({readFromUrl:function(e){let t={},n="OnPremise",a=(e=e||location).host,i=e.pathname.split("/")[1]+"/";if(i.indexOf(".html")>0&&(i=""),e.host.indexOf("-space")>0){n=e.host.split("-")[0].toUpperCase(),a=e.host.replace("-space","-apps")}return t.myAppsUrl="https://"+a+"/"+i+"resources/AppsMngt",t.userId="all",t.securityContext=[""],t.tenantId=n,t}})),define("DS/BksStandalone/Parametrization",["DS/UIKIT/Form","UWA/Controls/Abstract","DS/Controls/Button"],(e,t,n)=>t.extend({defaultOptions:{oneTry:!1},init:function(){this._parent.apply(this,arguments),this.elements.container=UWA.createElement("div")},render:function(t){let a=[];for(var i in t){let e=t[i];var s={type:"boolean"==typeof e?"boolean":"text",name:i,label:i,value:e};if(Array.isArray(e)){s.type="select";let t=[];e.forEach(e=>{t.push({label:e,value:e})}),s.options=t,s.value=e[0]}a.push(s)}var r=this.elements.form=new e({className:"horizontal",grid:"3 9",fields:a});r.inject(this.elements.container),r.addEvent("onChange",(e,t,n)=>{this.dispatchEvent("onChange",[e,t,n])});var l=new n({label:"execute",onClick:e=>{var n=r.getValues();for(var a in n)"boolean"==typeof t[a]&&(n[a]="true"===n[a]);this.options.oneTry&&l.setProperties({disabled:!0}),this.dispatchEvent("execute",n)}});return l.inject(this.elements.container),this},updateValues:function(e){for(var t in e)if(Array.isArray(e[t])){var n=this.elements.form.getListInput(t),a=[];e[t].forEach(e=>{a.push({label:e,value:e})}),n.remove(),n.add(a),n.setValue(a[0]),delete e[t]}this.elements.form.setValues(e)}})),define("DS/BksStandalone/Standalone",["DS/Utilities/Utils","DS/BksStandalone/Parametrization","DS/Skeleton/SkeletonLayout","DS/BksStandalone/Ajax","DS/BksStandalone/utils/Helper","DS/Controls/Accordeon","DS/Controls/Button","css!DS/BksStandalone/BksStandalone.css","css!DS/UIKIT/UIKIT.css"],(Utils,Parametrization,SkeletonLayout,Ajax,Helper,Accordeon,Button)=>{let parameters={};function parseIt(e){let t=e;try{t=JSON.parse(e)}catch(e){}return t}function buildHistory(){let e=UWA.createElement("div",{class:"eventHistory"}),t=UWA.createElement("div"),n=UWA.createElement("div",{text:"Events",styles:{"font-weight":"bold","text-align":"center"}});var a=new Button({label:"Clean",showLabelFlag:!1,icon:{iconName:"broom",fontIconFamily:WUXManagedFontIcons.Font3DS}});a.addEventListener("buttonclick",function(){t.empty()}),a.inject(n),n.inject(e),t.inject(e);let i=[],s=null,r=[];return window.dscef={sendString:(e,t)=>{let n={event:e,content:t?parseIt(t):""};try{if(!(n=JSON.parse(e)).event){let e={event:"",content:""};for(let t in n)e.event+=t,e.content+=n[t];n=e}}catch(t){let a=e.indexOf("=");a>0&&(n={event:e.substr(0,a),content:JSON.parse(e.substr(a+1))})}window.dscef._buildEvent(n)},_buildEvent:e=>{s||(s=new Date),this.debounceEvents=this.debounceEvents?this.debounceEvents:Utils.debounce(()=>{if(i.length>0){let e=[];if(i.forEach(t=>{if(r.indexOf(t.event)<0){let n=UWA.createElement("div"),a=new Button({displayStyle:"normal",label:"Hide next",icon:{iconName:"eye-off",fontIconFamily:WUXManagedFontIcons.Font3DS}});a.addEventListener("buttonclick",function(){r.push(t.event)});let i=UWA.createElement("pre",{text:t.content?JSON.stringify(t.content,void 0,2):""});a.inject(n),i.inject(n),e.push({header:t.event,content:n})}}),e.length>0){let n=UWA.createElement("div");n.inject(t,"top"),UWA.createElement("div",{text:s.toLocaleTimeString()}).inject(n),new Accordeon({items:e,style:"simple"}).inject(n)}}i=[],s=null},100),this.debounceEvents(),i.push(e)},getEnv:e=>{if("MX_ONLINE_INSTANCE"===e)return parameters.tenantId}},e}function buildAPIsSelector(){if(window.exportCmd){let elements=[];for(let e in window.exportCmd)elements.push(e);let apiSelector=new Parametrization;return apiSelector.getContent().addClassName("APISelector"),apiSelector.render({API:elements,arguments:""}).addEvent("execute",value=>{let list=value.arguments.split("|"),finalList=[];list.forEach(e=>{let t=e;try{t=JSON.parse(e)}catch(e){}finalList.push(t)}),eval(value.API+".apply(null,"+JSON.stringify(finalList)+")")}),apiSelector}}function computeParams(e){return new Promise(async t=>{let n={},a=await Ajax.getConnectedUser(e);if(a){n.userId=a.user;let e=[];a.credentials.forEach(t=>{e.push(t.translate.value)}),e.push("empty"),n.securityContext=e}t(n)})}function getI18NAPIs(){return new Promise(e=>{require(["DS/UWPClientCode/I18n"],e)})}return e=>{let t=UWA.createElement("div",{class:"leftContainer",styles:{padding:"10px","text-align":"left"}}),n=UWA.createElement("div",{class:"widgetContainer"});widget.body=n,document.body.getElement("#tempDiv").inject(widget.body);let a=new SkeletonLayout({leftContainerContent:t,centerContainerContent:n,leftContainerCollapsedFlag:!1,leftContainerWidth:document.body.clientWidth/4,leftContainerMinWidth:50,leftContainerMaxWidth:document.body.clientWidth/2,navigationContainerVisibleFlag:!1,idCardContainerVisibleFlag:!1,statusContainerVisibleFlag:!1,identifier:"StandaloneLayout"});return a.getContent().addClassName("standaloneLayout"),a.inject(document.body),new Promise(async n=>{let a=new Parametrization({oneTry:!0}),i={};e.myAppsUrl||(i=Helper.readFromUrl());for(let t in e)i[t]=e[t];let s=await computeParams(i.myAppsUrl);for(let e in s)i[e]=s[e];i.lang||(i.lang="en"),a.inject(t).render(i).addEvent("execute",async e=>{console.log("Parameters sent to the widget: "),console.log(e),window.dsLang=e.lang?e.lang:navigator.language,(await getI18NAPIs()).setCurrentLanguage(window.dsLang,!0),"empty"===e.securityContext&&(e.securityContext=""),window.COMPASS_CONFIG={myAppsBaseUrl:e.myAppsUrl,userId:e.userId,lang:window.dsLang},parameters=e,n(e)}),a.getContent().addClassName("paramSelector"),a.addEvent("onChange",async(e,t)=>{if("myAppsUrl"===e){let e=await computeParams(t);a.updateValues(e)}});let r=buildAPIsSelector();r&&r.inject(t),buildHistory().inject(t)})}});