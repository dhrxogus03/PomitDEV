define("DS/TransferOwnershipWidget/TOSModel/TOSPublicTransfer",["UWA/Controls/Abstract"],function(e){"use strict";return e.extend({init:function(e){for(var t in this.contextId="",this.physicalId="",this.type="",this.title="",this.context="",this.targetSpace="",this.category="",this.isTOSPublicTransfer=!0,e)this[t]=e[t]},getPhysicalId:function(){return this.physicalId},getType:function(){return this.type},getTitle:function(){return this.title},getContext:function(){return this.context},getTargetSpace:function(){return this.targetSpace},getCategory:function(){return this.category},setPhysicalId:function(e){this.physicalId=e},setType:function(e){this.type=e},setTitle:function(e){this.title=e},setContext:function(e){this.context=e},setTargetSpace:function(e){this.targetSpace=e},setCategory:function(e){this.category=e}})}),define("DS/TransferOwnershipWidget/TransferOwnershipConstant",[],function(){"use strict";return{TransferCollabSpace:"CollabSpace",TransferCollabSpaceSoft:"CollabSpaceSoft",TransferFull:"full",TransferPerson:"Person",CSEOrgAndProjectURLService:"/resources/pno/ownership/ctxorgcollabspace/user",CSEUserURLService:"/resources/pno/ownership/owner"}}),define("DS/TransferOwnershipWidget/TOSModel/TOSSelectedItem",["UWA/Controls/Abstract"],function(e){"use strict";return e.extend({init:function(e){for(var t in this.physicalId="",this.urlIcon="",this.name="",this.type="",this.category="",this.isTOSSelectedItem=!0,e)this[t]=e[t]},getPhysicalId:function(){return this.physicalId},getUrlIcon:function(){return this.owner},getName:function(){return this.name},getType:function(){return this.type},getCategory:function(){return this.category}})}),define("DS/TransferOwnershipWidget/TOSModel/TOSSummaryModel",["UWA/Controls/Abstract"],function(e){"use strict";return e.extend({init:function(e){this.PREFIX_TYPE_BUS="Class",this.PREFIX_TYPE_REL="RelationClass";for(var t in this.isTOSSummaryModel=!0,e)this[t]=e[t]},getPhysicalId:function(){return this.physicalId},getTitle:function(){return this.title},getType:function(){return this.type},getProject:function(){return this.project},getOrganization:function(){return this.organization},getOwner:function(){return this.owner},getPrefixType:function(){return this.prefixType},getOldOwner:function(){return this.old_owner},getError:function(){return this.error},getOldContext:function(){return this.oldContext},getCurrentContext:function(){return this.currentContext}})}),define("DS/TransferOwnershipWidget/component/TransferOwnershipWidget",["UWA/Core","UWA/Controls/Input","UWA/Controls/Abstract","UWA/Json","DS/DataDragAndDrop/DataDragAndDrop","DS/PlatformAPI/PlatformAPI","DS/WAFData/WAFData","DS/TransferOwnershipWidget/TransferOwnershipConstant","DS/SearchWidget/SearchWidget","DS/SearchWidget/SearchWidgetConstant","DS/ErrorWidget/ErrorWidget","DS/DataGridWidget/DataGridWidget","DS/WidgetServices/WidgetServices","DS/WidgetServices/securityContextServices/SecurityContextServices","DS/WarningWidget/WarningWidget","DS/MVAInput/searchPeopleInput/MVASearchPeopleInput","DS/TransferOwnershipWidget/TOSModel/TOSSelectedItem","DS/WidgetServices/CollabPerfTimer","DS/UIKIT/Input/Button","DS/UIKIT/Input/Select","DS/UIKIT/Spinner","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Modal","DS/UIKIT/Input/Toggle","DS/Controls/Editor","DS/UIKIT/Scroller","DS/ENOFloatingPanel/ENOFloatingPanel","DS/Controls/Toggle","UWA/Widget","text!DS/TransferOwnershipWidget/assets/TOSettings.json","css!DS/TransferOwnershipWidget/component/TransferOwnershipWidget.css","i18n!DS/TransferOwnershipWidget/assets/nls/TOSNls","DS/ReportingPanel/ReportingPanel","DS/ENOCollabToolsUI/tracker/ENOCollabTracker","DS/ENOCollabToolsUI/tracker/ENOCollabTrackerBackEnd"],function(e,t,r,i,n,s,a,o,c,h,l,d,g,u,p,O,f,S,m,T,v,C,y,W,w,I,b,P,D,_,E,A,j,U,M){"use strict";var x=g.getProdLevel();UWA.i18n("TOS_SelectedItems");return r.extend({itemListHasPriority:!1,defaultOptions:{className:"",context:null,ForbiddenChar:'"#$@%*,?\\<>[]|:',showTopBar:!0,setCloseButton:!1,topClassHeight:"TOS_MasterContain",transferType:o.TransferFull,launchTransfer:!0,genericTransfer:!1,serverName:"",serverUri:"",activeExpandWholeStructure:!1,activeDnD:!1,activeOptions:!1,activeAdminCheckBox:!1,activeSummaryButton:!1,activeHistoryButton:!1,activeFirstLineTable:!1,displaySoftDialog:!0,model:!0,wintop:!1,odtMode:!1},init:function(e,t,r){this.defaultOptions.activeAdminCheckBox=widget.getBool("admin"),x=g.getProdLevel(),this.widget=e,this.parentWidget=t,this.SelectedItems=[],this.listID=[],this.currentTransfer=null,this.listOfIds=[],this.listOfCSFlag=[],this.listOfOrgFlag=[],this.listOfRespFlag=[],this.listOfError=[],this.listOfFailedIds=[],this.listOfIdsWithResult=[],this.listOfIdsWithData=JSON.parse("[]"),this.listOfOwnerWithData=JSON.parse("[]"),this.isHiddenResponsibleSearch=!0,this.isHiddenCollaborativeSpaceSearch=!0,this.isHiddenOrganizationSearch=!0,this._perfTimer=S,this._perfTimer.init("TOS"),this._perfTimer.start("CommandUIDurationChangeOwnerMove"),this.objectIds={},this.ctxObjectIds=[],this._parent(r),this.setSecurityContext(r.securityContext),this.caHeader={},this.SelectedInstance=[],this.isCSE=!1,this.searchSection=null,this.searchSectionOrg=null,this.searchSectionProject=null,this.searchOwnerTitle=null,this.searchSectionProject=null,this.searchProjectTitle=null,this.searchSectionOrganization=null,this.searchOrgTitle=null,this.searchWidgetOrg=null,this.searchWidgetProject=null,this.searchWidget=null,this.searchWidgetOwnerDiv=null,this.marginForOwnerToggle=null,this.currentSearchedUser="",this.currentLoginUser="",this.showMismatchButton=!1,this.listOwnerOrgToId={},this.listOwnerCSToId={},this.listCSOrgToId={},this.hideProject=!1,this.hideOrg=!1,this.changeOwnerToggle=null,this.addMsgToggle=null,this.commentBox=null,this.textArea=null,this.mismatchToggle=null,this.boutonMismatch=null,this.listOfInvalidIds=null;A.get("TOS_Panel_Status");var i=A.get("TOS_Panel_Title"),n=A.get("TOS_Panel_Type"),s=A.get("TOS_Panel_Revision"),a=A.get("TOS_Panel_Organization"),c=A.get("TOS_Panel_CollabSpace"),h=A.get("TOS_Panel_Responsible"),l=A.get("TOS_Panel_CompletionStatus");this.cols=[{text:"ID",dataIndex:"ID",isHidden:!0},{text:"StatusToolTipColumn",dataIndex:"statusTooltip",isHidden:!0,tooltipColumn:"Status"},{text:A.TOS_STATUS,dataIndex:"Status",typeRepresentation:"icon"},{text:i,dataIndex:i},{text:n,dataIndex:n},{text:s,dataIndex:s},{text:a,dataIndex:a},{text:c,dataIndex:c},{text:h,dataIndex:h},{text:l,dataIndex:l}],this.ListOfEC=JSON.parse("[]"),this.ListOfAggrObj=JSON.parse("[]"),this.selectedItemsCS={},this.selectedItemsORG={},this.targetOrgTitle=null,this.targetCollabSpaceTitle=null,this.options.transferType!=o.TransferCollabSpaceSoft&&this._initUI(),this._perfTimer.stop("CommandUIDurationChangeOwnerMove")},setSecurityContext:function(e){this.securityContext=e},onRefresh:function(){},_IsDisableApply:function(){if(null!=this.searchWidgetProject&&null!=this.searchWidgetOrg){if(null==this.searchWidget.getNewOwner().person&&null==this.searchWidgetProject.getNewOwner().collabSpace&&null==this.searchWidgetOrg.getNewOwner().organization)return!0;var e=!0,t=!0,r=!0;return r=!!(this.searchWidget.getNewOwner()&&this.searchWidget.getNewOwner().hasOwnProperty("person")&&this.searchWidget.getNewOwner().person&&""!=this.searchWidget.container.searchInput.elements.content.value),t=!!(this.searchWidgetProject.getNewOwner()&&this.searchWidgetProject.getNewOwner().hasOwnProperty("collabSpace")&&this.searchWidgetProject.getNewOwner().collabSpace&&""!=this.searchWidgetProject.container.searchInput.elements.content.value),e=!!(this.searchWidgetOrg.getNewOwner()&&this.searchWidgetOrg.getNewOwner().hasOwnProperty("organization")&&this.searchWidgetOrg.getNewOwner().organization&&""!=this.searchWidgetOrg.container.searchInput.elements.content.value),!(r||t||e)}return""===this.searchWidget.container.searchInput.elements.content.value||!(this.searchWidget.getNewOwner()&&this.searchWidget.getNewOwner().hasOwnProperty("person")&&this.searchWidget.getNewOwner().person)},_initUI:function(){var e=this,t=this.container=UWA.createElement("div",{name:"TOS_MasterContain",class:"TOS_MasterContain "+e.options.className,id:"TOS_MasterContain",styles:{height:"100%",width:"100%",position:"relative",padding:"3px"}});this.globalDiv=UWA.createElement("div",{class:"TOS_GlobalContain",id:"TOS_GlobalContain"}).inject(t);var r="TOS_ManageButtonDiv";1==e.options.wintop&&(r="TOS_ManageButtonDiv_WebInWin"),this.ManageButtonDiv=UWA.createElement("table",{class:r,html:{}});var i="TOS_ManageButtonRight";1==e.options.wintop&&(i="TOS_ManageButtonRight_WebInWin"),e.ManageButtonRight=UWA.createElement("td",{class:i});var n="TOS_ManageButtonLeft";1==e.options.wintop&&(n="TOS_ManageButtonLeft_WebInWin"),e.ManageButtonLeft=UWA.createElement("td",{class:n});var a=null;a=this.options.transferType==o.TransferPerson?A.get("TOS_ChangeOwner"):A.get("TOS_moveTitle");var d=null;e.boutonValid=new m({attributes:{title:UWA.i18n("")},name:"TopButtonValid",value:UWA.i18n(a),className:"default medium TOS_buttonTop primary",disabled:!0}),d=new m({attributes:{title:UWA.i18n("")},name:"TopButtonCancel",value:UWA.i18n("TOS_Cancel"),className:"default medium TOS_buttonTop"}),e.boutonValid.addEvents({onClick:function(){e._perfTimer.start("CommandExecutionDurationChangeOwnerMove"),u.getInstance().getSecurityContext({onSuccess:function(t){d.setValue(UWA.i18n("Close")),d.setDisabled(!0),e.boutonValid.setDisabled(!0),e._prepareTransferOwnership(t)},onFailure:function(t){e.setError(t),e._perfTimer.stop("CommandExecutionDurationChangeOwnerMove"),e._perfTimer.printTime("CommandUIDurationChangeOwnerMove"),e._perfTimer.printTime("CommandExecutionDurationChangeOwnerMove")}}),this.setDisabled(!0)}}),d.addEvents({onClick:function(){s.publish("TOS_SummaryResult",{listId:[]}),e.dispatchEvent("onCancel"),e._perfTimer.printTime("CommandUIDurationChangeOwnerMove")}}),e.boutonValid.inject(e.ManageButtonRight),0!=this.options.setCloseButton&&d.inject(e.ManageButtonRight),e.ManageButtonLeft.inject(this.ManageButtonDiv),e.ManageButtonRight.inject(this.ManageButtonDiv),!0===e.options.showTopBar&&0==e.options.wintop&&this.ManageButtonDiv.inject(e.globalDiv),this.mainDiv=UWA.createElement("div",{class:"TOS_MainContain"}).inject(e.globalDiv),e.mainInterface=UWA.createElement("div",{class:"TOS_MainInterface"}).inject(this.mainDiv).hide(),e.mainLoading=UWA.createElement("div",{class:"TOS_MainLoading"}).inject(this.mainDiv),e.mainError=UWA.createElement("div",{class:"TOS_MainError"}).inject(this.mainDiv).hide(),e.loadingArea32=new v({visible:!0,className:"large"}),e.loadingArea32.inject(e.mainLoading),2==x&&!0!==this.options.activeExpandWholeStructure||(this.expandWholeStruct=new W({type:"checkbox",value:UWA.i18n("TOS_Expand"),className:"primary TOS_ExpandAllCB"}),this.expandWholeStruct.inject(UWA.createElement("td").inject(e.mainInterface))),e.itemsArea=new UWA.createElement("span",{class:"TOS_itemsList"}),e.itemsArea.inject(e.mainInterface),this.itemListHasPriority=!0,e.table=null,e.errorOverlay=new l(widget,e.container,{className:"errorComponent_TransferOwnership"});var g=UWA.i18n("TOS_ownerTitle");e.titleTargetOwnership=UWA.createElement("h5",{class:"TOS_SelectedItemTitle",html:g}),e.titleTargetOwnership.hide(),e.searchWidgetContainer=UWA.createElement("div",{class:"TOS_searchWidgetContainer"}).inject(this.mainInterface);var p=e.options.ForbiddenChar;h.TYPE_PERSON;1==this.options.activeFirstLineTable&&h.TYPE_FULL;var O={user:"",org:"",collabSpace:""};c.FULL;switch(1==e.isCSE&&c.RESTRICTED,this.options.transferType){case o.TransferPerson:e.hideOrg=!0,e.hideProject=!0,h.TYPE_PERSON;break;case o.TransferCollabSpaceSoft:case o.TransferCollabSpace:h.TYPE_PROJECT;break;case o.TransferFull:h.TYPE_FULL}if(0==e.hideProject&&0==e.hideOrg){e.searchWidgetProject=c.getSearchWidget(c.FULL,{className:"searchProject_TransferOwnership",ForbiddenChar:p,MaxNumber:"5",MaxSize:"300",position:"auto",serverName:this.options.serverName,serverUri:this.options.serverUri,showEmptyCategory:!1,hint:UWA.i18n("Search Collaborative Space"),methodType:"PUT",urlService:"/resources/v1/collabServices/base/transferOwnership/canUserChangePOV_ChecksWithUserQuery/"+h.TYPE_PROJECT,type:h.TYPE_PROJECT,CSE:e.isCSE,IsMoveSearch:!0,currentUser:e.currentSearchedUser,webParams:{getQueryParams:function(){return O}},odtMode:this.options.odtMode,events:{onValid:function(){var t=e.searchWidgetProject.getNewOwner();if(1==e.isCSE&&e.searchWidgetOrg){var r=e.searchWidgetOrg.container.currentChoice,i=t.collabSpace.collabSpaceID;if(r){var n=e.searchWidgetProject.CSEListOfOrg[i];Array.isArray(n)&&-1!=n.indexOf(r)||(e.searchWidgetOrg.listOwner=[],e.searchWidgetOrg.CSEListOfCs={},e.searchWidgetOrg.container.searchInput.value="",e.searchWidgetOrg.setValue(""),e.searchWidgetOrg.container.currentChoice="",e.searchWidgetOrg.container.currentOwner=null)}}u.getInstance().getSecurityContext({onSuccess:function(t){var r=e._getTransferDataForSearch();e.transferPreCheck(t,r)},onFailure:function(t){e.setError(t)}}),e._ManageValidButton(!0)},onUnvalid:function(){if(null!=e.searchWidgetProject){var t=e.searchWidgetProject.container.searchInput.elements.content.value;O.collabSpace=t,null===e.searchWidgetOrg.container.currentChoice?O.org="":O.org=e.searchWidgetOrg.container.currentChoice,e.searchWidget.container.currentChoice?O.user=e.searchWidget.container.currentChoice:O.user="",""==t?(e.boutonMismatch&&e.boutonMismatch.hide(),e.mismatchToggle&&e.mismatchToggle.hide(),e.searchWidget&&e.searchWidgetOrg&&(e.searchWidget.container.currentChoice||e.searchWidgetOrg.container.currentChoice)&&u.getInstance().getSecurityContext({onSuccess:function(t){var r=e._getTransferDataForSearch();e.transferPreCheck(t,r)},onFailure:function(t){e.setError(t)}})):(e.boutonMismatch&&e.boutonMismatch.hide(),e.mismatchToggle&&e.mismatchToggle.hide()),e._IsDisableApply()?e._ManageValidButton(!1):e._ManageValidButton(!0)}},onError:function(t){e.setError(t)}}});var f=UWA.createElement("div",{class:"TOS_SearchSectionProject"});e.searchSectionProject=f;var S=UWA.i18n(A.get("ChangeCollab_mainTile"));e.searchCollabTitle=UWA.createElement("h5",{class:"TOS_SelectedItemTitle",html:S}).inject(e.searchWidgetContainer),e.searchWidgetProject.inject(f),f.inject(e.searchWidgetContainer),e.marginAfterSearchProj=UWA.createElement("div",{class:"TOS_marginCorrector"}).inject(this.searchWidgetContainer);var T=UWA.i18n(A.get("ChangeOrg_mainTitle"));e.searchOrgTitle=UWA.createElement("h5",{class:"TOS_SelectedItemTitle",html:T}).inject(e.searchWidgetContainer),e.searchWidgetOrg=c.getSearchWidget(c.FULL,{className:"searchOrg_TransferOwnership",ForbiddenChar:p,MaxNumber:"5",MaxSize:"300",position:"auto",serverName:this.options.serverName,serverUri:this.options.serverUri,showEmptyCategory:!1,hint:UWA.i18n("Search Organization"),methodType:"PUT",urlService:"/resources/v1/collabServices/base/transferOwnership/canUserChangePOV_ChecksWithUserQuery/"+h.TYPE_ORGANIZATION,type:h.TYPE_ORGANIZATION,CSE:e.isCSE,IsMoveSearch:!0,currentUser:e.currentSearchedUser,webParams:{getQueryParams:function(){return O}},odtMode:this.options.odtMode,events:{onValid:function(){if(null!=e.searchWidgetOrg){var t=e.searchWidgetOrg.getNewOwner();if(1==e.isCSE){var r=e.searchWidgetProject.container.currentChoice,i=t.organization.orgID;if(r&&i){var n=e.searchWidgetOrg.CSEListOfCs[i];(!Array.isArray(n)||-1==n.indexOf(r)&&e.searchWidgetProject)&&(e.searchWidgetProject.CSEListOfOrg={},e.searchWidgetProject.listOwner=[],e.searchWidgetProject.container.searchInput.value="",e.searchWidgetProject.setValue(""),e.searchWidgetProject.container.currentChoice="",e.searchWidgetProject.container.currentOwner=null)}}u.getInstance().getSecurityContext({onSuccess:function(t){var r=e._getTransferDataForSearch();e.transferPreCheck(t,r)},onFailure:function(t){e.setError(t)}}),e._ManageValidButton(!0)}},onUnvalid:function(){if(null!=e.searchWidgetOrg){var t=e.searchWidgetOrg.container.searchInput.elements.content.value;O.org=t,e.searchWidget.container.currentChoice?O.user=e.searchWidget.container.currentChoice:O.user="",null===e.searchWidgetProject.container.currentChoice?O.collabSpace="":O.collabSpace=e.searchWidgetProject.container.currentChoice,""==t?(e.boutonMismatch&&e.boutonMismatch.hide(),e.mismatchToggle&&e.mismatchToggle.hide(),e.searchWidget&&e.searchWidgetProject&&(e.searchWidget.container.currentChoice||e.searchWidgetProject.container.currentChoice)&&u.getInstance().getSecurityContext({onSuccess:function(t){var r=e._getTransferDataForSearch();e.transferPreCheck(t,r)},onFailure:function(t){e.setError(t)}})):(e.boutonMismatch&&e.boutonMismatch.hide(),e.mismatchToggle&&e.mismatchToggle.hide())}e._IsDisableApply()?e._ManageValidButton(!1):e._ManageValidButton(!0)},onError:function(t){e.setError(t)}}});var C=UWA.createElement("div",{class:"TOS_SearchSectionOrg"});T=UWA.i18n(A.get("ChangeOrg_mainTitle"));e.searchSectionOrganization=C,e.searchWidgetOrg.inject(C),C.inject(e.searchWidgetContainer),e.marginAfterSearchOrg=UWA.createElement("div",{class:"TOS_marginCorrector"}).inject(this.searchWidgetContainer)}var y=UWA.createElement("div",{class:"TOS_SearchSectionOwner"});e.searchSection=y;var b=A.get("TOS_ownerTitle"),D=c.FULL;if(e.options.transferType!=o.TransferPerson){var _=UWA.createElement("div",{class:"TOS_SearchSectionOwner"});_.setStyle("display","none"),e.searchWidgetOwnerDiv=_,e.changeOwnerToggle=new P({type:"checkbox",label:b,checkFlag:!1,"font-weight":"bold"}),e.changeOwnerToggle.addEventListener("buttonclick",function(t){1==t.dsModel.checkFlag?(e.searchWidgetOwnerDiv&&e.searchWidgetOwnerDiv.setStyle("display","contents"),e.marginAfterSearchUser&&e.marginAfterSearchUser.setStyle("display","inline-block")):(e.searchWidgetOwnerDiv&&e.searchWidgetOwnerDiv.setStyle("display","none"),e.marginAfterSearchUser&&e.marginAfterSearchUser.setStyle("display","none"),!0===e.isCSE&&e.searchWidget&&e.searchWidget.container.searchInput.elements.content.value&&(e.searchWidget.container.searchInput.elements.content.value="",e.searchWidget.container.currentChoice=null,e.searchWidget.clearInput(),e.searchWidgetProject&&e.searchWidgetOrg&&(e.searchWidgetProject.getNewOwner().collabSpace&&(e.searchWidgetProject.container.currentChoice=null,e.searchWidgetProject.container.searchInput.elements.content.value="",e.searchWidgetProject.clearInput()),e.searchWidgetOrg.getNewOwner().organization&&(e.searchWidgetOrg.container.currentChoice=null,e.searchWidgetOrg.container.searchInput.elements.content.value="",e.searchWidgetOrg.clearInput())),e._ManageValidButton(!1)),e.searchWidget&&e.searchWidget.container.searchInput.elements.content.value&&(e.searchWidget.container.searchInput.elements.content.value="",e.searchWidget.container.currentChoice=null,e.searchWidget.clearInput(),e._IsDisableApply()&&e._ManageValidButton(!1),e.boutonMismatch&&e.boutonMismatch.hide(),e.mismatchToggle&&e.mismatchToggle.hide(),e.searchWidgetProject&&e.searchWidgetOrg?(e.searchWidgetProject.container.currentChoice||e.searchWidgetOrg.container.currentChoice)&&u.getInstance().getSecurityContext({onSuccess:function(t){var r=e._getTransferDataForSearch();e.transferPreCheck(t,r)},onFailure:function(t){e.setError(t)}}):(e.boutonMismatch&&e.boutonMismatch.hide(),e.mismatchToggle&&e.mismatchToggle.hide())))}),e.changeOwnerToggle.inject(e.searchSection)}else D=c.RESTRICTED,e.titleTargetOwnership.inject(e.searchSection),e.titleTargetOwnership.show();switch(e.searchWidget=c.getSearchWidget(D,{className:"searchPeople_TransferOwnership",ForbiddenChar:p,MaxNumber:"5",MaxSize:"300",position:"auto",serverName:this.options.serverName,serverUri:this.options.serverUri,showEmptyCategory:!1,hint:UWA.i18n("Search Responsible"),methodType:"PUT",urlService:"/resources/v1/collabServices/base/transferOwnership/canUserChangePOV_ChecksWithUserQuery/"+h.TYPE_PERSON,type:h.TYPE_PERSON,webParams:{getQueryParams:function(){return O}},CSE:e.isCSE,IsMoveSearch:!0,currentUser:e.currentSearchedUser,odtMode:this.options.odtMode,events:{onValid:function(){var t;e.searchWidget.getNewOwner();t=this.currentChoice,u.getInstance().getSecurityContext({onSuccess:function(r){if(1==e.isCSE){e.currentSearchedUser=null==t||""==t?e.currentLoginUser:t;var i={};i.currentUser=e.currentSearchedUser,e.searchWidgetProject&&(e.searchWidgetProject.addOptions(i),e.searchWidgetProject.CSEListOfOrg={},e.searchWidgetProject.listOwner=[],e.searchWidgetProject.container.searchInput.value="",e.searchWidgetProject.setValue(""),e.searchWidgetProject.container.currentChoice="",e.searchWidgetProject.container.currentOwner=null),e.searchWidgetOrg&&(e.searchWidgetOrg.addOptions(i),e.searchWidgetOrg.listOwner=[],e.searchWidgetOrg.CSEListOfCs={},e.searchWidgetOrg.container.searchInput.value="",e.searchWidgetOrg.setValue(""),e.searchWidgetOrg.container.currentChoice="",e.searchWidgetOrg.container.currentOwner=null)}var n=e._getTransferDataForSearch();e.transferPreCheck(r,n)},onFailure:function(t){e.setError(t)}}),e._ManageValidButton(!0),1==e.isCSE&&e.searchWidgetProject&&e.searchWidgetOrg&&(e.searchWidgetProject.clearInput(),e.searchWidgetOrg.clearInput())},onUnvalid:function(){if(null!=e.searchWidgetOrg){var t=e.searchWidget.container.searchInput.elements.content.value;O.user=t,null===e.searchWidgetOrg.container.currentChoice?O.org="":O.org=e.searchWidgetOrg.container.currentChoice,null===e.searchWidgetProject.container.currentChoice?O.collabSpace="":O.collabSpace=e.searchWidgetProject.container.currentChoice,""==t?(e.boutonMismatch&&e.boutonMismatch.hide(),e.mismatchToggle&&e.mismatchToggle.hide(),e.searchWidgetProject&&e.searchWidgetOrg&&(e.searchWidgetProject.container.currentChoice||e.searchWidgetOrg.container.currentChoice)&&u.getInstance().getSecurityContext({onSuccess:function(t){var r=e._getTransferDataForSearch();e.transferPreCheck(t,r)},onFailure:function(t){e.setError(t)}})):(e.boutonMismatch&&e.boutonMismatch.hide(),e.mismatchToggle&&e.mismatchToggle.hide()),e._IsDisableApply()?e._ManageValidButton(!1):e._ManageValidButton(!0)}else{t=e.searchWidget.container.getCurrentValue(),Object.keys(e.selectedItemsCS),Object.keys(e.selectedItemsORG);O.user=t,e._IsDisableApply()?e._ManageValidButton(!1):e._ManageValidButton(!0)}},onError:function(t){e.setError(t)}}}),null!==e.searchWidgetOwnerDiv?(e.searchWidget.inject(e.searchWidgetOwnerDiv),e.searchWidgetOwnerDiv.inject(y)):e.searchWidget.inject(y),y.inject(e.searchWidgetContainer),e.marginAfterSearchUser=UWA.createElement("div",{class:"TOS_ownerMarginCorrector"}).inject(this.searchWidgetContainer),e.marginAfterSearchUser.setStyle("display","none"),null!==e.changeOwnerToggle&&(e.searchSection.hide(),e.searchWidgetOwnerDiv&&e.searchWidgetOwnerDiv.setStyle("display","none"),e.marginAfterSearchUser&&e.marginAfterSearchUser.setStyle("display","none")),this.options.transferType){case o.TransferPerson:e.hideProject=!0,e.hideOrg=!0}var E=UWA.i18n(A.get("TOS_TitleComment"));if(e.options.transferType!=o.TransferPerson?(e.addMsgToggle=new P({type:"checkbox",label:E,checkFlag:!1,class:"TOS_SelectedItemTitle"}),e.addMsgToggle.domId="TOS_addMsgToggle",e.addMsgToggle.addEventListener("buttonclick",function(t){1==t.dsModel.checkFlag?e.commentBox.show():(e.commentBox.hide(),e.textArea&&(e.textArea.value=""))}),e.addMsgToggle.inject(e.searchWidgetContainer)):(e.marginAfterSearchUser&&e.marginAfterSearchUser.setStyle("display","inline-block"),e.commentTitle=UWA.createElement("h5",{class:"TOS_SelectedItemTitle",html:E}).inject(e.searchWidgetContainer)),e.commentBox=UWA.createElement("div",{class:"TOS_CommentBox"}).inject(this.searchWidgetContainer),e.textArea=new w({placeholder:UWA.i18n(A.get("TOS_Comment")),value:"",widthInCharNumber:63,nbRows:5,newLineMode:"enter"}),e.textArea.domId="TOS_CommentTextEditor",e.textArea.inject(e.commentBox),e.options.transferType!=o.TransferPerson&&e.commentBox.hide(),e.marginAfterAddMsg=UWA.createElement("div",{class:"TOS_marginCorrector"}).inject(this.searchWidgetContainer),this.options.transferType==o.TransferFull)UWA.createElement("Div",{class:"TOS_AdvAdminOption"}).inject(e.mainInterface);1==e.options.wintop&&e.ManageButtonDiv.inject(e.mainInterface);new I({element:e.mainInterface}).inject(e.globalDiv);this.trackerEventBeginTime=Date.now()},transferPreCheck:function(e,t){this.dispatchEvent("onTransferStart");var r=this,n="",s=(this.options.serverName,this.options.serverUri,this.options.launchTransfer);this.caHeader;r._perfTimer.start("ChangeOnwerMove: transferOwnershipPreCheck"),g.get3DSpaceUrlAsync({onComplete:function(e){var a={Accept:"application/json","content-type":"application/json"};a.SecurityContext=encodeURIComponent(r.securityContext),r.caHeader&&(r.caHeader["DS-Change-Authoring-Context"]&&(a["DS-Change-Authoring-Context"]=r.caHeader["DS-Change-Authoring-Context"]),r.caHeader["DS-Configuration-Authoring-Context"]&&(a["DS-Configuration-Authoring-Context"]=r.caHeader["DS-Configuration-Authoring-Context"]));var o=r.parseDataForPreCheck(t);n=g.getRealPath("assets/transferOwnership.json",widget);var c="",h="GET",l="";2==x&&(n=e+"/resources/v1/collabServices/base/transferOwnership/transferOwnershipPreCheck?admin=true",l="passport",h="PUT",c=i.encode({requests:o}));var d={requests:o};if(r.dispatchEvent("onValidation",d),!0===s){r.displayLoadingArea(),a["Accept-Language"]=widget.lang;var u=g.getTenantID();u&&(n+="&tenant="+u),r._ManageValidButton(!0),!0===r.options.wintop&&r.ManageButtonLeft.setStyle("display","contents"),g.partitionedAuthenticatedRequest(n,{type:"json",method:h,proxy:l,headers:a,maxChunkSize:19,cancelCallback:function(){return!1},partisionedProgressLabel:A.get("TOS_Prechecking"),progressBarContext:r.ManageButtonLeft,progressBarWaitContext:r.container,chunkify:function(e,t,r){var i=[];0==e&&(e=3),i.push(r[0]),i.push(r[1]),i.push(r[2]);for(var n=e;n<e+t&&n<r.length;n++)i.push(r[n]);return i},data:c,timeout:36e5,onComplete:function(e){r._perfTimer.stop("ChangeOnwerMove: transferOwnershipPreCheck"),!0===r.options.wintop&&r.ManageButtonLeft.setStyle("display","none"),r._ManageValidButton(!0),r._preCheckResult(e,t)},onFailure:function(e,t,i){r._perfTimer.stop("ChangeOnwerMove: transferOwnershipPreCheck"),!0===r.options.wintop&&r.ManageButtonLeft.setStyle("display","none"),r._ManageValidButton(!0),r._onFailure(e,t,i)},onTimeout:function(e){r._onTimeout(),r._perfTimer.stop("ChangeOnwerMove: transferOwnershipPreCheck")}})}}})},_preCheckResult:function(e,t,r){var i=this,n=[],s=[],a=[],o="",c="",h=[];if(e.results.length>0)for(var l=0;l<e.results.length;l++){if(null!=e.results[l].TransferFlag&&n.push(e.results[l].TransferFlag),null!=e.results[l].ErrorList&&"success"!==e.results[l].ErrorList){var d={Error:e.results[l].ErrorList,physicalId:e.results[l].physicalId};a.push(d)}null!=e.results[l].VALIDTRIPLE&&!1===e.results[l].VALIDTRIPLE&&(-1==s.indexOf(e.results[l].physicalId)&&s.push(e.results[l].physicalId),e.results[l].user,o=e.results[l].project,c=e.results[l].org)}if(s.length>0){var g=Object.keys(i.listOfIdsWithData).length,u=s.length,p=A.get("TOS_Of"),O=A.get("TOS_Mismatch_Toggle_Label")+u+p+g+A.get("TOS_Mismatch_Toggle_Label_2");null==i.mismatchToggle?(i.mismatchToggle=new P({type:"checkbox",className:"LCMismatchToggle",label:O,checkFlag:!1,"font-weight":"bold"}),i.mismatchToggle.addEventListener("buttonclick",function(e){1==e.dsModel.checkFlag?i._ManageValidButton(!0):i._ManageValidButton(!1)}),i.mismatchToggle.inject(i.searchWidgetContainer)):(i.mismatchToggle.label=O,i.mismatchToggle.show()),i._ManageValidButton(!1);var f=A.get("TOS_Show_Mismatches_Btn");null==i.boutonMismatch?(i.boutonMismatch=new m({attributes:{title:UWA.i18n("")},name:"LCMismatch",value:f,className:"LCMismatch default medium TOS_buttonTop primary",disabled:!1}),i.boutonMismatch.addEvents({onClick:function(){for(var e=0;e<s.length;e++){var t=[],r=s[e];t.push(r),t.push(A.TOS_FailStatus),t.push("Failed"),t.push(i.listOfIdsWithData[r].Title),t.push(i.listOfIdsWithData[r].typeDisplayName),t.push(i.listOfIdsWithData[r].Revision),t.push(i.listOfIdsWithData[r].OrganizationTitle),t.push(i.listOfIdsWithData[r].CollaborativeSpaceTitle),t.push(i.listOfIdsWithData[r].Responsible);var n=i.listOfIdsWithData[r].Responsible;if(i.searchWidgetOrg&&i.searchWidgetOrg.searchWidgetUI.searchInput){var a=i.searchWidgetOrg.searchWidgetUI.searchInput.getValue();c=null==a||""==a?i.listOfIdsWithData[r].OrganizationTitle:a}if(i.searchWidgetProject&&i.searchWidgetProject.searchWidgetUI.searchInput){var a=i.searchWidgetProject.searchWidgetUI.searchInput.getValue();o=null==a||""==a?i.listOfIdsWithData[r].CollaborativeSpaceTitle:a}if(i.searchWidget&&i.searchWidget.searchWidgetUI.searchInput)n=null==(a=i.searchWidget.searchWidgetUI.searchInput.getValue())||""==a?i.listOfIdsWithData[r].Responsible:a;var l=n+A.get("TOS_Mismatch_Msg")+o+"/"+c;t.push(l);var d=A.get("TOS_FailStatus");t.push(d),h.push(t)}if(j.launchReportingPanel(h,i.cols,null),0==i.options.wintop)i.dispatchEvent("onCancel");else{var g={error:!0,OKdata:"",KOdata:h,reportingPanelColumns:i.cols,listOfPids:Object.keys(i.listOfIdsWithData)};i.dispatchEvent("onLaunchReportingPanel",g)}}}),i.boutonMismatch.inject(i.ManageButtonLeft)):i.boutonMismatch.show()}i.hideLoadingArea()},parseDataForPreCheck:function(e){var t=[];return null!=e&&e.hasOwnProperty("owner")&&null!=e.owner&&e.owner.hasOwnProperty("person")&&""!=e.owner.person?t.push(e.owner.person.personID):t.push(""),null!=e&&e.hasOwnProperty("owner")&&null!=e.owner&&e.owner.hasOwnProperty("collabSpace")&&""!=e.owner.collabSpace?t.push(e.owner.collabSpace.collabSpaceID):t.push(""),null!=e&&e.hasOwnProperty("owner")&&null!=e.owner&&e.owner.hasOwnProperty("organization")&&""!=e.owner.organization?t.push(e.owner.organization.orgID):t.push(""),e.tosBusinessObject.forEach(function(e){t.push(e.id)}),e.hasOwnProperty("tosRelationObject")&&e.tosRelationObject.forEach(function(e){t.push(e.id)}),t},destroy:function(){this.searchWidget&&this.searchWidget.destroy(),this.searchWidgetProject&&this.searchWidgetProject.destroy(),this.searchWidgetOrg&&this.searchWidgetOrg.destroy(),this._parent()},actionOnMove:function(){this.searchWidget&&this.searchWidget.actionOnMove(),this.searchWidgetProject&&this.searchWidgetProject.actionOnMove(),this.searchWidgetOrg&&this.searchWidgetOrg.actionOnMove()},getcanUserChangePOV:function(e){var t=this;this.options.serverName,this.options.serverUri;t._perfTimer.start("ChangeOnwerMove: canUserChangePOV"),g.get3DSpaceUrlAsync({onComplete:function(r){var n={"content-type":"application/json",Accept:"application/json"},s=g.getRealPath("assets/summary.json",widget),a="GET",o="",c=t.parseDataForCanUserChangePOV(e);if(2==x){s=r+"/resources/v1/collabServices/base/transferOwnership/canUserChangePOV",o="passport",a="PUT";var h=i.encode({requests:c})}t.displayLoadingArea();var l=g.getTenantID();l&&(s+="?tenant="+l),!0===t.options.wintop&&t.ManageButtonLeft.setStyle("display","contents"),n["Accept-Language"]=widget.lang,n.SecurityContext=encodeURIComponent(t.securityContext),g.partitionedAuthenticatedRequest(s,{type:"json",method:a,proxy:o,headers:n,maxChunkSize:19,cancelCallback:function(){return!1},partisionedProgressLabel:A.get("TOS_CanChangeOwnership"),progressBarContext:t.ManageButtonLeft,progressBarWaitContext:t.container,symultaneousRequest:!0,data:h,timeout:36e5,onComplete:function(e){t._perfTimer.stop("ChangeOnwerMove: canUserChangePOV"),t._listcanUserChangePOV(e)},onFailure:function(e,r,i){t._perfTimer.stop("ChangeOnwerMove: canUserChangePOV"),t._onFailure(e,r,i)},onTimeout:function(e){t._perfTimer.stop("ChangeOnwerMove: canUserChangePOV"),t._onTimeout()}})}})},parseDataForCanUserChangePOV:function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].physicalId);return t},_listcanUserChangePOV:function(e){var t=[],r=[],i=[],n=this,a=!0,c=!0,h=!0,l=0,d=0,g=0,p=0,O=0,f=0,S={};if(e.results.length>0){for(var T=0;T<e.results.length;T++){if(this.options.transferType!=o.TypePerson&&null!=e.results[T].CSTransferFlag){var v={physicalId:e.results[T].physicalId,CSTransferFlag:e.results[T].CSTransferFlag};this.listOfCSFlag.push(v),"OK"==e.results[T].CSTransferFlag&&0;var C={objectID:e.results[T].physicalId};i.push(C),"OK"==e.results[T].CSTransferFlag&&0==l?(0==this.hideProject&&null!=this.searchWidgetProject&&this.searchWidgetProject.show(),this.titleTargetOwnership.show(),a=!1,this.isHiddenCollaborativeSpaceSearch=!1,l=1):g++}if(this.options.transferType!=o.TypePerson&&null!=e.results[T].OrgTransferFlag){v={physicalId:e.results[T].physicalId,OrgTransferFlag:e.results[T].OrgTransferFlag};this.listOfOrgFlag.push(v);C={objectID:e.results[T].physicalId};r.push(C),"OK"==e.results[T].OrgTransferFlag&&0,"OK"==e.results[T].OrgTransferFlag&&0==d?(0==this.hideOrg&&null!=this.searchWidgetOrg&&this.searchWidgetOrg.show(),this.titleTargetOwnership.show(),c=!1,this.isHiddenOrganizationSearch=!1,d=1):p++}if(null!=e.results[T].RespTransferFlag){v={physicalId:e.results[T].physicalId,RespTransferFlag:e.results[T].RespTransferFlag};this.listOfRespFlag.push(v);C={objectID:e.results[T].physicalId};t.push(C),"OK"==e.results[T].RespTransferFlag&&f++,"OK"==e.results[T].RespTransferFlag?(null!==this.changeOwnerToggle&&1==this.changeOwnerToggle.checkFlag?(this.searchWidgetOwnerDiv&&this.searchWidgetOwnerDiv.setStyle("display","contents"),this.marginAfterSearchUser&&this.marginAfterSearchUser.setStyle("display","inline-block"),this.titleTargetOwnership.show()):null!==this.changeOwnerToggle&&0==this.changeOwnerToggle.checkFlag&&(this.titleTargetOwnership.hide(),this.searchWidgetOwnerDiv&&this.searchWidgetOwnerDiv.setStyle("display","none"),this.marginAfterSearchUser&&this.marginAfterSearchUser.setStyle("display","none")),h=!1,this.isHiddenResponsibleSearch=!1,1):"KO"==e.results[T].RespTransferFlag&&(this.titleTargetOwnership.hide(),h=!0,this.isHiddenResponsibleSearch=!0,O++)}if(null!=e.results[T].ErrorList){if("success"!=e.results[T].ErrorList){v={physicalId:e.results[T].physicalId,Error:e.results[T].ErrorList};this.listOfError.push(v)}S[e.results[T].physicalId]=e.results[T].ErrorList}e.results[T].hasOwnProperty("CSE")&&(this.isCSE=e.results[T].CSE),e.results[T].hasOwnProperty("LifecycleCheckCommand")&&(this.LifecycleCheckCommand=e.results[T].LifecycleCheckCommand)}if(this.searchWidget&&this.searchWidget.setSelectedItemList(t),0==n.hideProject&&0==n.hideOrg&&null!=this.searchWidgetOrg&&null!=this.searchWidgetProject&&(this.searchWidgetProject.setSelectedItemList(i),this.searchWidgetOrg.setSelectedItemList(r)),h&&c&&a&&(this.textArea.disabled=!0),0==h&&0==c&&1==a&&0==n.hideProject&&0==n.hideOrg&&(this.searchWidgetProject.hiddenCS="true",this.searchWidgetOrg.hiddenOrg="false",this.searchWidget.hiddenUser="false"),0==a&&0==c&&1==h&&0==n.hideProject&&0==n.hideOrg&&(this.searchWidget.hiddenUser="true",this.searchWidgetOrg.hiddenOrg="false",this.searchWidgetProject.hiddenCS="false"),0==h&&0==a&&1==c&&0==n.hideProject&&0==n.hideOrg&&(this.searchWidgetOrg.hiddenOrg="true",this.searchWidgetProject.hiddenCS="false",this.searchWidget.hiddenUser="false"),0==h&&c&&a&&0==n.hideProject&&0==n.hideOrg&&(this.searchWidgetProject.hiddenCS="true",this.searchWidgetOrg.hiddenOrg="true",this.searchWidget.hiddenUser="false"),0==c&&h&&a&&0==n.hideProject&&0==n.hideOrg&&(this.searchWidgetProject.hiddenCS="true",this.searchWidget.hiddenUser="true",this.searchWidgetOrg.hiddenOrg="false"),0==a&&c&&h&&0==n.hideProject&&0==n.hideOrg&&(this.searchWidget.hiddenUser="true",this.searchWidgetOrg.hiddenOrg="true",this.searchWidgetProject.hiddenCS="false"),1==this.isCSE){this.currentLoginUser=s.getUser().login+"_PRJ",this.currentSearchedUser=this.currentLoginUser;var y={},W={CSE:!0,autocomplete:"off",methodType:"GET",urlService:o.CSEOrgAndProjectURLService,currentUser:this.currentSearchedUser,webParams:{method:"GET",getQueryParams:function(){return y}}};if(this.searchWidgetProject&&(this.searchWidgetProject.addOptions(W),this.searchWidgetProject.show(),this.searchWidgetProject.options.CSE=this.isCSE),this.searchWidgetOrg&&(this.searchWidgetOrg.addOptions(W),this.searchWidgetOrg.show(),this.searchWidgetOrg.options.CSE=this.isCSE),this.searchWidget){var w={CSE:!0,autocomplete:"off",methodType:"POST",urlService:o.CSEUserURLService,currentUser:this.currentSearchedUser,webParams:{method:"POST",getQueryParams:function(){return y}}};this.searchWidget.addOptions(w),this.searchWidgetOwnerDiv&&this.searchWidgetOwnerDiv.setStyle("display","contents"),this.marginAfterSearchUser&&this.marginAfterSearchUser.setStyle("display","inline-block"),this.searchWidget.options.CSE=this.isCSE}this.titleTargetOwnership.show(),this.isHiddenOrganizationSearch=!1,this.isHiddenCollaborativeSpaceSearch=!1,this.isHiddenResponsibleSearch=!1,this.hideLoadingArea(),this.searchWidgetProject&&(this.searchWidgetProject.options.CSE=this.isCSE),this.searchWidgetOrg&&(this.searchWidgetOrg.options.CSE=this.isCSE),this.searchWidget.options.CSE=this.isCSE}1==n.LifecycleCheckCommand&&(n.boutonLifecycleCheck=new m({attributes:{title:UWA.i18n("")},name:"TopButtonLCCheck",value:UWA.i18n("Check"),className:"default medium TOS_buttonTop ",disabled:!1}),n.boutonLifecycleCheck.addEvents({onClick:function(){u.getInstance().getSecurityContext({onSuccess:function(e){n.listDataForDebug(e)},onFailure:function(e){n.setError(e)}}),this.setDisabled(!0)}}),n.boutonLifecycleCheck.inject(n.ManageButtonRight))}var I=this.SelectedItems.length;if(!this.isCSE&&g==I&&p==I){if(f!=I){var b,P=A.get("securityDenied"),D=[],_=[];_=Object.keys(this.listOfIdsWithData);for(var E=0;E<_.length;E++){var U=[],M=_[E],x="";S[k=this.listOfIdsWithData[M].TOS_Id]&&(P="success"!=(x=S[k])?x:A.get("TOS_Panel_Denied_Policy_Message"));var R=P;U.push(k),U.push(A.TOS_FailStatus),U.push("Failed"),U.push(this.listOfIdsWithData[M].Title),U.push(this.listOfIdsWithData[M].typeDisplayName),U.push(this.listOfIdsWithData[M].Revision),U.push(n.listOfIdsWithData[k].OrganizationTitle),U.push(n.listOfIdsWithData[k].CollaborativeSpaceTitle),U.push(this.listOfIdsWithData[M].Responsible),U.push(R);var F=A.get("TOS_FailStatus");U.push(F),D.push(U)}if(j.launchReportingPanel(D,this.cols,null),0==n.options.wintop)n.dispatchEvent("onCancel");else{n.dispatchEvent("onMaskUnmask",{mask:!1,message:""});var L={error:!0,OKdata:"",KOdata:D,reportingPanelColumns:this.cols,listOfPids:Object.keys(this.listOfIdsWithData)};n.dispatchEvent("onLaunchReportingPanel",L)}return(b={}).message=A.get("TOS_Panel_Denied_Policy_Message"),void this.setError(b)}this.searchWidgetProject&&this.searchWidgetProject.container.searchInput.disable(),this.searchWidgetOrg&&this.searchWidgetOrg.container.searchInput.disable(),this.changeOwnerToggle&&(this.changeOwnerToggle.checkFlag=!0,this.changeOwnerToggle.disabled=!0),this.searchWidgetOwnerDiv&&this.searchWidgetOwnerDiv.setStyle("display","contents"),this.marginAfterSearchUser&&this.marginAfterSearchUser.setStyle("display","inline-block"),this.titleTargetOwnership.show()}if(this.isCSE||g!=I||null!=this.searchWidgetProject&&null!=this.searchWidgetProject.container.searchInput&&this.searchWidgetProject.container.searchInput.disable(),this.isCSE||p!=I||null!=this.searchWidgetOrg&&null!=this.searchOrgTitle&&this.searchWidgetOrg.container.searchInput.disable(),!this.isCSE&&O==I){if(this.options.transferType==o.TransferPerson){P=A.get("securityDenied"),D=[],_=[];_=Object.keys(this.listOfIdsWithData);for(E=0;E<_.length;E++){U=[],M=_[E],x="";S[k=this.listOfIdsWithData[M].TOS_Id]&&(P="success"!=(x=S[k])?x:A.get("TOS_Panel_Denied_Policy_Message"));R=P;U.push(k),U.push(A.TOS_FailStatus),U.push("Failed"),U.push(this.listOfIdsWithData[M].Title),U.push(this.listOfIdsWithData[M].typeDisplayName),U.push(this.listOfIdsWithData[M].Revision),U.push(n.listOfIdsWithData[k].OrganizationTitle),U.push(n.listOfIdsWithData[k].CollaborativeSpaceTitle),U.push(this.listOfIdsWithData[M].Responsible),U.push(R);F=A.get("TOS_FailStatus");U.push(F),D.push(U)}return j.launchReportingPanel(D,this.cols,null),void(0==n.options.wintop&&n.dispatchEvent("onCancel"))}this.changeOwnerToggle&&(this.changeOwnerToggle.checkFlag=!0,this.changeOwnerToggle.disabled=!0),this.searchWidget&&(this.searchWidgetOwnerDiv&&this.searchWidgetOwnerDiv.setStyle("display","contents"),this.marginAfterSearchUser&&this.marginAfterSearchUser.setStyle("display","inline-block"),this.searchWidget.container.searchInput.disable())}this.isCSE||g!=I&&p!=I&&O!=I||this.options.transferType!=o.TransferPerson&&((b={}).message=A.get("TOS_Panel_Denied_Policy_Message"),this.setError(b));if(0!==this.listOfError.length&&1!=this.isCSE){if(this.listOfError.length==this.listOfIds.length){for(D=[],E=0;E<this.listOfError.length;E++){U=[];var k=this.listOfError[E].physicalId;P=this.listOfError[E].Error,x="";S[k]&&(P="success"!=(x=S[k])?x:A.get("TOS_Panel_Denied_Policy_Message")),U.push(this.listOfError[E].physicalId),U.push(A.TOS_FailStatus),U.push("Failed"),U.push(this.listOfIdsWithData[k].Title),U.push(this.listOfIdsWithData[k].typeDisplayName),U.push(this.listOfIdsWithData[k].Revision),U.push(this.listOfIdsWithData[k].Organization),U.push(this.listOfIdsWithData[k].CollaborativeSpace),U.push(this.listOfIdsWithData[k].Responsible),U.push(P);F=A.get("TOS_FailStatus");U.push(F),D.push(U)}if(j.launchReportingPanel(D,this.cols,null),0==n.options.wintop)n.dispatchEvent("onCancel");else{L={error:!0,OKdata:"",KOdata:D,reportingPanelColumns:this.cols,listOfPids:Object.keys(this.listOfIdsWithData)};n.dispatchEvent("onLaunchReportingPanel",L)}}n.onResize(),n.hideLoadingArea()}},_setListOfIds:function(e,t){for(var r=0;r<e.length;r++)this.listOfIds.push(e[r])},_getListOfIds:function(){return this.listOfIds},_parseForGenericService:function(e){var t=[];e.length>0&&null!=e[0].owner&&(e[0].owner.hasOwnProperty("person")&&""!=e[0].owner.person&&t.push({op:"replace",path:"owner",value:e[0].owner.person.personID}),e[0].owner.hasOwnProperty("organization")&&""!=e[0].owner.organization&&t.push({op:"replace",path:"organization",value:e[0].owner.organization.orgID}),e[0].owner.hasOwnProperty("collabSpace")&&""!=e[0].owner.collabSpace&&t.push({op:"replace",path:"project",value:e[0].owner.collabSpace.collabSpaceID})),t.push({op:"replace",path:"TOSComment",value:this.textArea.value});for(var r=[],i=0;i<e.length;i++)e[i].tosBusinessObject.forEach(function(n){var s="bus";n.hasOwnProperty("category")&&(s=n.category),"Class"===s&&(s="bus");var a="",o="",c="",h="";n.hasOwnProperty("organization")&&(a=n.organization),n.hasOwnProperty("owner")&&(o=n.owner),n.hasOwnProperty("project")&&(c=n.project),n.hasOwnProperty("type")&&(h=n.type);var l={method:"PATCH",path:"model/"+s+"/"+n.id,body:t,category:s,organization:a,owner:o,project:c,type:h};e[i].options&&(l.transferParams=e[i].options),r.push(l)});return r},_getTransferData:function(){var e=null,t=null;if(null!=this.searchWidget&&(t=i.decode(i.encode(this.searchWidget.getNewOwner()))),null!=this.searchWidgetOrg&&null!=this.searchWidgetProject){var r=i.decode(i.encode(this.searchWidgetProject.getNewOwner())),n=i.decode(i.encode(this.searchWidgetOrg.getNewOwner()));n.hasOwnProperty("organization")&&(t.organization={orgID:n.organization.orgID},n.organization.hasOwnProperty("orgTitle")&&n.organization.orgTitle&&(this.targetOrgTitle=n.organization.orgTitle)),r.hasOwnProperty("collabSpace")&&(t.collabSpace={collabSpaceID:r.collabSpace.collabSpaceID},r.collabSpace.hasOwnProperty("collabSpaceTitle")&&r.collabSpace.collabSpaceTitle&&(this.targetCollabSpaceTitle=r.collabSpace.collabSpaceTitle))}t.hasOwnProperty("person")&&(t.person.personID=t.person.personID.replace(/_PRJ$/,""));var s,a=[];s=this._getListOfIds();for(var o=0;o<s.length;o++)a.push({id:s[o].id,category:s[o].category,type:s[o].Type,organization:s[o].Organization,project:s[o].project,owner:s[o].owner});return a=this._removeDuplicateItemsToMove(a),e={tosBusinessObject:a=this._removeFailedIds(a),owner:t,options:{expandAll:!1,expandFolder:!1,expandSubFolder:!1,selectReference:!0,selectInstance:!1}},0==a.length&&(this.boutonValid.setDisabled(!0),e=""),e},_getTransferDataForSearch:function(){var e=null,t=null;if(null!=this.searchWidget&&(t=i.decode(i.encode(this.searchWidget.getNewOwner()))),null!=this.searchWidgetOrg&&null!=this.searchWidgetProject){var r=i.decode(i.encode(this.searchWidgetProject.getNewOwner())),n=i.decode(i.encode(this.searchWidgetOrg.getNewOwner()));n.hasOwnProperty("organization")&&(t.organization={orgID:n.organization.orgID}),r.hasOwnProperty("collabSpace")&&(t.collabSpace={collabSpaceID:r.collabSpace.collabSpaceID})}t.hasOwnProperty("person")&&(t.person.personID=t.person.personID.replace(/_PRJ$/,""));var s,a=[];s=this._getListOfIds();for(var o=0;o<s.length;o++)a.push({id:s[o].id,category:s[o].category});return a=this._removeDuplicateItemsToMove(a),e={tosBusinessObject:a=this._removeFailedIds(a),owner:t,options:{expandAll:!1,expandFolder:!1,expandSubFolder:!1,selectReference:!0,selectInstance:!1}},0==a.length&&(this.boutonValid.setDisabled(!0),e=""),e},_isItemInItemsToMoveList:function(e,t){for(var r=t.length,i=0;i<r;i++){var n=t[i];if(n.id==e.id&&n.category==e.category)return!0}return!1},_removeDuplicateItemsToMove:function(e){for(var t=[],r=e.length,i=0;i<r;i++){var n=e[i];this._isItemInItemsToMoveList(n,t)||t.push(n)}return t},_removeFailedIds:function(e){var t=[],r=!1,i=e.length;if(0==this.listOfFailedIds.length)return e;for(var n=0;n<i;n++){r=!1;for(var s=0;s<this.listOfFailedIds.length;s++)e[n].id==this.listOfFailedIds[s]&&(r=!0);r||t.push(e[n])}return t},_prepareTransferOwnership:function(e){var t="";null!=e&&""!=e&&e.hasOwnProperty("SecurityContext")&&(t=e.SecurityContext);var r=this._getTransferData();if(""!=r)this._transferOwnership(t,r);else{this._perfTimer.stop("CommandExecutionDurationChangeOwnerMove");this._perfTimer.printTimeShowDialogAndProcess(["CommandUIDurationChangeOwnerMove","CommandExecutionDurationChangeOwnerMove","ChangeOnwerMove: transferOwnershipPreCheck","ChangeOnwerMove: canUserChangePOV","ChangeOnwerMove: update","ChangeOwnerMove: checkData"],t)}},_commitTransferOwnership:function(e,t){this.dispatchEvent("onTransferStart");var r=this,n="",s=(this.options.serverName,this.options.serverUri,this.options.launchTransfer),a=(this.caHeader,""),c="",h="",l="";t[0].hasOwnProperty("owner")&&(t[0].owner.hasOwnProperty("person")&&(a=t[0].owner.person.personFullName,l=t[0].owner.person.personID),t[0].owner.hasOwnProperty("organization")&&(c=t[0].owner.organization.orgID),t[0].owner.hasOwnProperty("collabSpace")&&(h=t[0].owner.collabSpace.collabSpaceID));var d=A.get("TOS_UpdatingOwnership");d=r.options.transferType==o.TransferPerson?A.get("TOS_ChangingResponsible"):t[0].owner.hasOwnProperty("organization")||t[0].owner.hasOwnProperty("collabSpace")?A.get("TOS_UpdatingOwnership"):A.get("TOS_ChangingResponsible"),r._perfTimer.start("ChangeOnwerMove: update"),g.get3DSpaceUrlAsync({onComplete:function(e){var o={Accept:"application/json","content-type":"application/json"};o.SecurityContext=encodeURIComponent(r.securityContext),r.caHeader&&(r.caHeader["DS-Change-Authoring-Context"]&&(o["DS-Change-Authoring-Context"]=r.caHeader["DS-Change-Authoring-Context"]),r.caHeader["DS-Configuration-Authoring-Context"]&&(o["DS-Configuration-Authoring-Context"]=r.caHeader["DS-Configuration-Authoring-Context"]));var u=r._parseForGenericService(t);n=g.getRealPath("assets/transferOwnership.json",widget);var p="",O="GET",f="",S="admin=true";if(null!=r.adminCheckBox&&r.adminCheckBox.isChecked()||(S=""),2==x){for(var m in n=e+"/resources/v1/collabServices/attributes/op/update?"+S,f="passport",O="PUT",u)u[m].queryParams={select:["physicalid","type","current"]};var T={withUpdatedValues:!1,requests:u};M.enrichRequestWithMetricsWebInWin(T,{UXName:r.getUXNameForTracker(),isWebInWin:r.options.wintop}),p=i.encode(T)}var v="";t.length>0&&(v=t[0].owner);var C={requests:u,owner:v};if(r.dispatchEvent("onValidation",C),!0===s){r.displayLoadingArea(),o["Accept-Language"]=widget.lang;var y=g.getTenantID();y&&(n+="&tenant="+y),!0===r.options.wintop&&r.ManageButtonLeft.setStyle("display","contents"),g.partitionedAuthenticatedRequest(n,{type:"json",method:O,proxy:f,headers:o,maxChunkSize:19,cancelCallback:function(){return!1},partisionedProgressLabel:d,progressBarContext:r.ManageButtonLeft,progressBarWaitContext:r.container,data:p,timeout:36e5,onComplete:function(e){r._perfTimer.stop("ChangeOnwerMove: update"),r._onSucceedGenericTransfer(e,a,c,h,l)},onFailure:function(e,t,i){r._perfTimer.stop("ChangeOnwerMove: update"),r._onFailure(e,t,i)},onTimeout:function(e){r._perfTimer.stop("ChangeOnwerMove: update"),r._onTimeout()}})}}})},_transferOwnership:function(e,t){this._goTransferOwnership(e,t)},_goTransferOwnership:function(e,t){if(!0!==this.options.genericTransfer);else{for(var r=[],i=0;i<t.tosBusinessObject.length;i++){var n=[];n.push(t.tosBusinessObject[i]),r.push({tosBusinessObject:n,owner:t.owner,options:{expandAll:t.options.expandAll,expandFolder:t.options.expandFolder,expandSubFolder:t.options.expandSubFolder,selectReference:t.options.selectReference,selectInstance:t.options.selectInstance}})}this._commitTransferOwnership(e,r)}},_onSucceedGenericTransfer:function(e,t,r,i,n){var s=this,a={},o=[],c={};e.results&&e.results.forEach(function(e){if(e.status>=200&&e.status<306);if(e.status>=200&&e.status<306){if(null==e.body.sameOwner){var t=!1;if(e.body&&e.body.errors)(r=e.body.errors.length)>0&&(t=e.body.errors[r-1]);c[e.body.physicalid]||(e.body.cestamp?o.push({id:e.body.physicalid,type:e.body.type,current:e.body.current,cestamp:e.body.cestamp,error:t}):o.push({id:e.body.physicalid,type:e.body.type,current:e.body.current,cestamp:"",error:t}),c[e.body.physicalid]="processed")}else if(1==e.body.sameOwner)return!1}else{var r;t={message:UWA.i18n("cannot move selection"),code:"ERROR"};if(e.body&&e.body.errors)(r=e.body.errors.length)>0&&(t=e.body.errors[r-1]);if(500==e.status&&e.body&&e.body.errors&&e.body.physicalid){var i=e.body.physicalid;if(null!=s.ListOfEC[i])return c[e.body.physicalid]||(o.push({id:e.body.physicalid,type:e.body.type,current:e.body.current,error:t}),c[e.body.physicalid]="processed"),!0;if(null!=s.ListOfAggrObj[i])return c[e.body.physicalid]||(o.push({id:e.body.physicalid,type:e.body.type,current:e.body.current,cestamp:"",error:t}),c[e.body.physicalid]="processed"),!0}null!=e.body.physicalid&&(c[e.body.physicalid]||(o.push({id:e.body.physicalid,type:e.body.type,current:e.body.current,cestamp:"",error:t}),c[e.body.physicalid]="processed"))}return!0});Object.keys(s.ListOfEC).forEach(function(e){if(void 0===c[e]){var t={message:UWA.i18n(A.get("TOS_selectOwningProduct")),code:"ERROR"};o.push({id:e,type:"ERROR",current:e,cestamp:"",error:t})}});Object.keys(s.ListOfAggrObj).forEach(function(e){if(void 0===c[e]){var t={message:UWA.i18n(A.get("TOS_selectOwningProduct")),code:"ERROR"};o.push({id:e,type:"ERROR",current:e,cestamp:"",error:t})}}),o.length>0&&(a.listId=o),this._transferSucceedForUpdate(a,t,r,i,n)},_transferSucceedForUpdate:function(e,t,r,i,n){var a=this;a.hideLoadingArea();var o=JSON.parse("[]"),c=[],h=[];for(I=0;I<e.listId.length;I++){var l=e.listId[I].id,d="";if(e.listId[I].hasOwnProperty("cestamp")&&(d=e.listId[I].cestamp),o[l]=I,!e.listId[I].error){var g={physicalid:e.listId[I].id,cestamp:d,type:e.listId[I].type,owner:n,project:i,organization:r};c.push(g)}}var p=[];if(e.listId&&e.listId.length>0)for(var O=0;O<e.listId.length;O++){var f=[],S=e.listId[O].id;if(void 0!==a.listOfIdsWithData[S]){if(-1!=f.indexOf(e.listId[O].id))continue;if(f.push(e.listId[O].id),e.listId[O].error){f.push(A.TOS_FailStatus),f.push("Failed"),f.push(a.listOfIdsWithData[S].Title),f.push(a.listOfIdsWithData[S].typeDisplayName),f.push(a.listOfIdsWithData[S].Revision),f.push(a.listOfIdsWithData[S].OrganizationTitle),f.push(a.listOfIdsWithData[S].CollaborativeSpaceTitle),f.push(a.listOfIdsWithData[S].Responsible),e.listId[O].error.originalMessage&&""!=e.listId[O].error.originalMessage?f.push(e.listId[O].error.originalMessage):f.push(e.listId[O].error.message);var m=A.get("TOS_FailStatus");f.push(m),h.push(f)}else{f.push(A.TOS_SuccessStatus),f.push("Success"),f.push(a.listOfIdsWithData[S].Title),f.push(a.listOfIdsWithData[S].typeDisplayName),f.push(a.listOfIdsWithData[S].Revision),null!=a.targetOrgTitle?f.push(a.targetOrgTitle):f.push(a.listOfIdsWithData[S].OrganizationTitle),null!=a.targetCollabSpaceTitle?f.push(a.targetCollabSpaceTitle):f.push(a.listOfIdsWithData[S].CollaborativeSpaceTitle),""!=t?f.push(t):f.push(a.listOfIdsWithData[S].Responsible);m=A.get("TOS_SuccessStatus");f.push(m)}p.push(f)}}var T=[],v=[],C={};require(["DS/PADUtils/PADCommandProxy","DS/PADUtils/PADContext"],function(t,r){var i=r.get();null==i&&(i=a.options.context);var n=[],s=[],o=[];(null!=e&&void 0!==e&&Array.isArray(e.listId)&&e.listId.forEach(function(e){if(void 0!==e.error&&e.hasOwnProperty("error")){var t=null!=e.id.value?e.id.value:e.id;v.push(t),"Workspace"==e.type?n.push(t):"PRIVATE"==e.current||"#DENIED!"==e.current?o.push(t):s.push(t)}}),n.length>0)&&((c={}).deleted=n,(h={}).authored=c,i.author(!0),i.onRefresh(h),(l=t.create()).destroy());if(s.length>0||o.length>0){var c,h;(c={}).modified=s,c.deleted=o,(h={}).authored=c;var l;(l=t.create()).authored({authored:!0}),l.refresh(h),l.destroy()}});var y=Object.keys(a.listOfIdsWithData);null!=e&&void 0!==e&&Array.isArray(e.listId)&&e.listId.forEach(function(e){T.push(e.id);var s=e.id;if("PRIVATE"==e.current||"#DENIED!"==e.current)C[e.id]={id:e.id,newOwnerFullName:t,newOrganization:r,newCollabSpace:i,newOwnerId:n,error:!1,removeFromUI:!0};else if(e.hasOwnProperty("error")&&null!=e.error)if(0==e.error)C[e.id]={id:e.id,newOwnerFullName:t,newOrganization:r,newCollabSpace:i,newOwnerId:n,error:!1,removeFromUI:!1};else if(void 0!==a.listOfIdsWithData[s]&&null!==a.listOfIdsWithData[s]){var o=e.id;C[e.id]={id:o,newOwnerFullName:a.listOfIdsWithData[o].Responsible,newOrganization:a.listOfIdsWithData[o].Organization,newCollabSpace:a.listOfIdsWithData[o].CollaborativeSpace,newOwnerId:n,error:!0,removeFromUI:!1}}});var W=Math.floor(Date.now());s.publish("DS/Object/update",{metadata:{appId:widget.id,appName:widget.name,timestamp:W,options:{force:!0}},data:{paths:T,attributes:C},version:"1.0"}),s.publish("ENOLC_MOVE_CMD_UPDATE",{metadata:{appId:widget.id,appName:widget.name,timestamp:W,options:{force:!0}},data:{paths:T,attributes:C},version:"1.0"}),a.container.setStyle("opacity","1"),this.dispatchEvent("onTransferSucceed"),a.container.setStyle("opacity","1"),this.dispatchEvent("onTransferFail");if(e.hasOwnProperty("error")){p=[];if(e.hasOwnProperty("listId"))for(var w=e.listId,I=0;I<w.length;I++){f=[];var b=w[I].id,P=a.listOfIdsWithData[b];if(null!=P){f.push(b),f.push(A.TOS_FailStatus),f.push("Failed"),f.push(a.listOfIdsWithData[b].Title),f.push(a.listOfIdsWithData[b].typeDisplayName),f.push(a.listOfIdsWithData[b].Revision),f.push(a.listOfIdsWithData[b].OrganizationTitle),f.push(a.listOfIdsWithData[b].CollaborativeSpaceTitle),f.push(a.listOfIdsWithData[b].Responsible),e.error.originalMessage&&""!=e.error.originalMessage?f.push(e.error.originalMessage):f.push(e.error.message);m=A.get("TOS_FailStatus");f.push(m),p.push(f)}}if(0==p.length){y=Object.keys(a.listOfIdsWithData);for(var D=0;D<y.length;D++){(f=[]).push(y[D]),f.push(A.TOS_FailStatus),f.push("Failed"),f.push(a.listOfIdsWithData[y[D]].Title),f.push(a.listOfIdsWithData[y[D]].typeDisplayName),f.push(a.listOfIdsWithData[y[D]].Revision),f.push(a.listOfIdsWithData[y[D]].OrganizationTitle),f.push(a.listOfIdsWithData[y[D]].CollaborativeSpaceTitle),f.push(a.listOfIdsWithData[y[D]].Responsible),e.error.originalMessage&&""!=e.error.originalMessage?f.push(e.error.originalMessage):f.push(e.error.message);m=A.get("TOS_FailStatus");f.push(m),p.push(f)}}if(j.launchReportingPanel(p,this.cols,null),1==a.options.wintop){var _=c.length,E=[];for(D=0;D<_;D++)E.push(c[D].physicalid);var U={error:!0,OKdata:c,KOdata:"",reportingPanelColumns:this.cols,listOfPids:E};a.dispatchEvent("onLaunchReportingPanel",U)}return null!=a.table&&a.table.clearAllLine(),s.publish("TOS_SummaryResult",{listId:[]}),void(0==a.options.wintop?a.dispatchEvent("onCancel"):a.dispatchEvent("onLaunchReportingPanel",T))}if(j.launchReportingPanel(p,this.cols,null),null!=a.table&&a.table.clearAllLine(),s.publish("TOS_SummaryResult",{listId:[]}),0==a.options.wintop)a.dispatchEvent("onCancel");else if(e.listId&&Array.isArray(e.listId)){var M=[];for(I=0;I<e.listId.length;I++)M.push(e.listId[I].id);U={error:!0,OKdata:c,KOdata:"",reportingPanelColumns:this.cols,listOfPids:M};a.dispatchEvent("onLaunchReportingPanel",U)}else{U={error:!0,OKdata:"",KOdata:p,reportingPanelColumns:this.cols,listOfPids:Object.keys(this.listOfIdsWithData)};a.dispatchEvent("onLaunchReportingPanel",U)}if(a._perfTimer.stop("CommandExecutionDurationChangeOwnerMove"),a.securityContext&&a.securityContext.trim().length>0){a._perfTimer.printTimeShowDialogAndProcess(["CommandUIDurationChangeOwnerMove","CommandExecutionDurationChangeOwnerMove","ChangeOnwerMove: transferOwnershipPreCheck","ChangeOnwerMove: canUserChangePOV","ChangeOnwerMove: update","ChangeOwnerMove: checkData"],a.securityContext)}else u.getInstance().getSecurityContext({onSuccess:function(e){a._perfTimer.printTimeShowDialogAndProcess(["CommandUIDurationChangeOwnerMove","CommandExecutionDurationChangeOwnerMove","ChangeOnwerMove: transferOwnershipPreCheck","ChangeOnwerMove: canUserChangePOV","ChangeOnwerMove: update","ChangeOwnerMove: checkData"],e)},onFailure:function(e){a.setError(e),a._perfTimer.printTime("CommandUIDurationChangeOwnerMove"),a._perfTimer.printTime("CommandExecutionDurationChangeOwnerMove")}})},getTopBar:function(){return this.ManageButtonDiv},onResize:function(){this.container.getSize(),this.mainInterface.getSize();null!==this.searchSection&&(this.searchWidget&&this.searchWidget.hasOwnProperty("hiddenUser")||(this.searchSection.setStyle("width","100%"),this.searchSection.setStyle("display","block"))),null!==this.searchSectionProject&&(this.searchWidgetProject&&this.searchWidgetProject.hasOwnProperty("hiddenCS")||(this.searchSectionProject.setStyle("width","100%"),this.searchSectionProject.setStyle("display","block"))),null!==this.searchSectionOrganization&&(this.searchWidgetOrg&&this.searchWidgetOrg.hasOwnProperty("hiddenOrg")||(this.searchSectionOrganization.setStyle("width","100%"),this.searchSectionOrganization.setStyle("display","block")))},_ManageValidButton:function(e){var t=e;null==e&&(t=!1),t?this.boutonValid.setDisabled(!1):this.boutonValid.setDisabled(!0)},initData:function(e,t){u.getInstance().getSecurityContext(),this.SelectedItems=[],this._addData(e),this.caHeader=t;_.contains("1");this.trackAppContent();for(var r=[],i=[],n=0;n<e.length;n++){e[n].hasOwnProperty("organizationTitle")&&null!=e[n].organizationTitle&&null!=e[n].organizationTitle||(e[n].organizationTitle,e[n].organization),e[n].hasOwnProperty("projectTitle")&&null!=e[n].projectTitle&&null!=e[n].projectTitle||(e[n].projectTitle,e[n].project),null!=e[n].projectTitle&&null!=e[n].projectTitle||(e[n].projectTitle,e[n].project);var s={TOS_Id:e[n].physicalId,Title:e[n].name,Type:e[n].type,Revision:e[n].Revision,Organization:e[n].organization,OrganizationTitle:e[n].organizationTitle,CollaborativeSpace:e[n].project,CollaborativeSpaceTitle:e[n].projectTitle,project:e[n].project,Responsible:e[n].responsibleName,typeDisplayName:e[n].typeDisplayName,Responsible:e[n].responsibleName,owner:e[n].owner,Status:"",physicalId:e[n].physicalId};this.listOfIdsWithData[e[n].physicalId]=s;var a={id:e[n].physicalId,category:e[n].category,mainRevisionId:e[n].physicalId,TOS_Id:e[n].physicalId,Title:e[n].name,Type:e[n].type,Revision:e[n].Revision,Organization:e[n].organization,OrganizationTitle:e[n].organizationTitle,CollaborativeSpace:e[n].project,CollaborativeSpaceTitle:e[n].projectTitle,project:e[n].project,Responsible:e[n].responsibleName,typeDisplayName:e[n].typeDisplayName,Responsible:e[n].responsibleName,owner:e[n].owner,Status:""};if(1==e[n].v_IsEmbeddedComponent){var o=e[n].physicalId;this.ListOfEC[o]=!0}else if(1==e[n].aggrObj){o=e[n].physicalId;this.ListOfAggrObj[o]=!0}else 0==e[n].v_IsEmbeddedComponent?r.push(a):0==e[n].aggrObj&&r.push(a);if(0==e[n].v_IsEmbeddedComponent&&0==e[n].aggrObj){o=e[n].physicalId;i.push({physicalId:o})}var c=e[n].owner,h=e[n].project,l=e[n].organization,d=c+"."+h,g=c+"."+l;if(null==this.listOwnerCSToId[d]||void 0===this.listOwnerCSToId[d]){var p=[];o=e[n].physicalId;p.push(o),this.listOwnerCSToId[d]=p}else{o=e[n].physicalId;this.listOwnerCSToId[d].push(o)}if(null==this.listOwnerOrgToId[g]||void 0===this.listOwnerOrgToId[g]){p=[],o=e[n].physicalId;p.push(o),this.listOwnerOrgToId[g]=p}else{o=e[n].physicalId;this.listOwnerOrgToId[g].push(o)}var O=h+"."+l;if(null==this.listCSOrgToId[O]||void 0===this.listCSOrgToId[O]){p=[],o=e[n].physicalId;p.push(o),this.listCSOrgToId[O]=p}else{o=e[n].physicalId;this.listCSOrgToId[O].push(o)}}if(this._setListOfIds(r),"editProperties_TransferOwnershipPopup"!=this.options.oldClassName&&this.listOfIdsWithData&&Array.isArray(this.listOfIdsWithData)){var f=Object.values(this.listOfIdsWithData);this.getcanUserChangePOV(f)}},_addData:function(e){this.hideMainErrorArea();var t=[],r=this;null!=e&&(t=e.slice()),g.removeDuplicate(t,function(e){return e.physicalId}),t.forEach(function(e){var t=new f(e);g.arrayContains(r.SelectedItems,t,function(e){return e.physicalId})<0&&r.SelectedItems.push(t)}),this.displayMainLoadingArea(),this._AddSelectedItem(r.SelectedItems),this.displayMainInterfaceArea();var i=[];r.SelectedItems.forEach(function(e){i.push({objectID:e.getPhysicalId()})}),null!=this.searchWidget&&this.searchWidget.setSelectedItemList(i),this.onResize()},_AddSelectedItem:function(e){this._manageAccessList()},_manageAccessList:function(){var e=1,t="";this.SelectedItems&&this.SelectedItems.length>1?e=this.SelectedItems.length:this.SelectedItems&&1==this.SelectedItems.length&&(t=" - "+this.SelectedItems[0].name);var r="";this.options.transferType==o.TransferFull?r+=UWA.i18n("TOS_mainTile"):this.options.transferType==o.TransferPerson?r+=UWA.i18n("ChangeResp_mainTile"):this.options.transferType==o.TransferCollabSpace&&(r+=UWA.i18n("ChangeCollab_mainTile")),0==e?this.itemsArea.hide():1==e?(this.itemsArea.hide(),r+=t):(this.itemsArea.hide(),r+=" - "+e+" "+UWA.i18n("TOS_Objects")),this.dispatchEvent("onTitleChange",r)},showNotification:function(e,t){null==t&&(t=""),null!=this.errorOverlay&&this.errorOverlay.addSuccess(e,t)},showInfoNotification:function(e,t){null==t&&(t=""),null!=this.errorOverlay&&this.errorOverlay.addInfo(e,t)},setError:function(e){this.addError(e)},addError:function(e){if(null!=this.errorOverlay&&e&&e.hasOwnProperty("message")){UWA.i18n(e.message);this.errorOverlay.displayJSONError(i.encode(e))}},displayLoadingArea:function(){null!=this.loadingArea&&this.loadingArea.show()},hideLoadingArea:function(){null!=this.loadingArea&&this.loadingArea.hide()},displayMainInterfaceArea:function(){this.hideAllAreas(),null!=this.mainInterface&&this.mainInterface.show(),null!=this.boutonValid&&this.boutonValid.show()},displayMainLoadingArea:function(){this.hideAllAreas(),null!=this.mainLoading&&this.mainLoading.show()},hideMainComponent:function(){this.hideLoadingArea(),null!=this.mainInterface&&this.mainInterface.hide(),null!=this.boutonValid&&this.boutonValid.hide()},hideMainLoadingArea:function(){null!=this.mainLoading&&this.mainLoading.hide()},hideMainErrorArea:function(){null!=this.mainError&&this.mainError.hide()},hideAllAreas:function(){this.hideMainLoadingArea(),this.hideMainComponent()},addMainError:function(e){null!=this.mainError&&new UWA.createElement("div",{text:e}).inject(this.mainError)},clearAllMainError:function(){null!=this.mainError&&this.mainError.setContent("")},_createSelectedTable:function(){},_createNewLine:function(e){},_onFailure:function(e,t,r){this.dispatchEvent("onTransferFail"),this.hideLoadingArea();var n={};i.isJson(t)&&(t=i.decode(t)),null!=t&&t.hasOwnProperty("error")?n.message=t.error:n={message:UWA.i18n("UnknownError"),code:"ERROR"},this.setError(n)},_onTimeout:function(){this.dispatchEvent("onTransferFail"),this.hideLoadingArea();var e={message:UWA.i18n("ErrorTimeOut"),code:"TO"};this.setError(e)},listDataForDebug:function(e){var t=this;t._perfTimer.start("ChangeOwnerMove: checkData"),g.get3DSpaceUrlAsync({onComplete:function(e){var r={Accept:"application/json"},n=g.getRealPath("assets/transferOwnership.json",widget),s="",a="GET",o="",c=Object.values(t.listOfIdsWithData),h=t.parseDataForCanUserChangePOV(c);2==x&&(n=e+"/resources/v1/collabServices/base/transferOwnership/checkData",o="passport",a="PUT",s=i.encode({requests:h})),t.displayLoadingArea(),r["Accept-Language"]=widget.lang;var l=g.getTenantID();l&&(n+="?tenant="+l),!0===t.options.wintop&&t.ManageButtonLeft.setStyle("display","contents"),r["Accept-Language"]=widget.lang,r.SecurityContext=encodeURIComponent(t.securityContext),g.partitionedAuthenticatedRequest(n,{type:"json",method:a,proxy:o,headers:r,maxChunkSize:19,cancelCallback:function(){return!1},partisionedProgressLabel:"Getting data for check..",progressBarContext:t.ManageButtonLeft,progressBarWaitContext:t.container,symultaneousRequest:!0,data:s,timeout:36e5,onComplete:function(e){t._perfTimer.stop("ChangeOwnerMove: checkData"),t._onLifecycleDataCheckSucceed(e)},onFailure:function(e,r,i){t._perfTimer.stop("ChangeOwnerMove: checkData"),t._onFailure(e,r,i)},onTimeout:function(e){t._perfTimer.stop("ChangeOwnerMove: checkData"),t._onTimeout()}})}})},_onLifecycleDataCheckSucceed:function(e){var t=null;if(e.hasOwnProperty("success")&&!0===e.success&&e.hasOwnProperty("data")&&(t=e.data),null!=t){var r=function(e){return(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),'<span class="'+t+'">'+e+"</span>"})}(JSON.stringify(t,void 0,4)),i=new D;i.body=UWA.extend(document.body);var n="<head><style>pre {outline: 1px solid #ccc; padding: 5px; margin: 5px; overflow-y:scroll; height: 100%; width: 100% } .string { color: green; } ";n+=" .number { color: darkorange; } .boolean { color: blue; } .null { color: magenta; } .key { color: red; }</style></head><body>",new b({className:"LifecycleCommandCheck_Dlg ",title:"Report",body:n+="<pre>"+r+"</pre>",overlay:!0,escapeToClose:!0,closable:!0,animate:!0,resizable:!0,maximizable:!0,autocenter:!0,visible:!0,limitParent:!0}).inject(i.body)}},trackAppContent:function(){var e={UXName:this.getUXNameForTracker(),models:this.SelectedItems};this.trackerEvent=U.createInitActionEvent(e,this.trackerEvent),U.checkAndTrackPageEvent(this.trackerEvent)},getUXNameForTracker:function(){var e="TransferOwnership";switch(this.options.transferType){case o.TransferCollabSpace:e="Change Collaborative Space";break;case o.TransferPerson:e="Change Owner";break;case o.TransferCollabSpaceSoft:e="Change Collaborative Space Soft";break;case o.TransferFull:e="Move"}return e}})}),define("DS/TransferOwnershipWidget/TransferOwnershipWidget",["DS/TransferOwnershipWidget/component/TransferOwnershipWidget"],function(e){}),define("DS/TransferOwnershipWidget/popup/TransferOwnershipPopup",["UWA/Controls/Abstract","DS/TransferOwnershipWidget/component/TransferOwnershipWidget","DS/TransferOwnershipWidget/TransferOwnershipConstant","DS/ENOFloatingPanel/ENOFloatingPanel","DS/UIKIT/Mask","css!DS/TransferOwnershipWidget/popup/TransferOwnershipPopup.css"],function(e,t,r,i,n){"use strict";return e.extend({defaultOptions:{className:"",context:null,ForbiddenChar:'"#$@%,?\\<>[]|:',transferType:r.TransferFull,serverName:"",serverUri:"",launchTransfer:!0,genericTransfer:!1,activeDnD:!1,activeOptions:!1,activeSummaryButton:!1,activeHistoryButton:!1,activeAdminCheckBox:!1,removeAtClose:!0,odtMode:!1},init:function(e,t,r,i){this.defaultOptions.activeAdminCheckBox=widget.getBool("admin"),this._parent(t),this.initUI(e,widget,i)},onRefresh:function(){null!=this.TOSWidget&&this.TOSWidget.onRefresh()},onResize:function(){null!=this.TOSWidget&&this.TOSWidget.onResize()},actionOnMove:function(){this.TOSWidget&&this.TOSWidget.actionOnMove()},destroy:function(){this.TOSWidget&&this.TOSWidget.destroy(),this._parent()},setSecurityContext:function(e){this.TOSWidget.setSecurityContext(e)},initUI:function(e,s,a){var o=this;o.widgetPere=e;var c="TOSP_PopupDial";o.options&&o.options.transferType===r.TransferPerson&&(c="TOSP_PopupDial_Change_Owner"),o.TOSWidget=new t(o.widgetPere,a,{className:"transferOwnership_innerComponent",context:o.options.context,ForbiddenChar:o.options.ForbiddenChar,setCloseButton:!0,showTopBar:!1,transferType:o.options.transferType,launchTransfer:o.options.launchTransfer,genericTransfer:o.options.genericTransfer,topClassHeight:c,serverName:this.options.serverName,serverUri:this.options.serverUri,activeDnD:this.options.activeDnD,activeOptions:this.options.activeOptions,activeSummaryButton:this.options.activeSummaryButton,activeHistoryButton:this.options.activeHistoryButton,activeAdminCheckBox:this.options.activeAdminCheckBox,oldClassName:this.options.className,securityContext:this.options.securityContext,odtMode:this.options.odtMode,persistId:"transferOwnershipDialogId",id:"transferOwnership_innerComponent",events:{onCancel:function(){o._close(),o.dispatchEvent("onCancel")},onValidation:function(e){o.dispatchEvent("onValidation",e)},onTitleChange:function(e){o.container.setTitle(e)},onMaskUnmask:function(e){if(e)if(1==e.mask){var t="";e.message&&(t=e.message),n.mask(o.container.elements.wrapper,t)}else n.unmask(o.container.elements.wrapper)}}}),o.container=new i({title:"ENOVIA",className:c+" "+this.options.className,footer:o.TOSWidget.getTopBar(),body:o.TOSWidget,overlay:!0,closable:!0,animate:!0,resizable:!0,events:{onResizeFloating:function(){o.onResize(),o.actionOnMove(),o.TOSWidget&&o.centerIt()},onMove:function(){o.actionOnMove()},onClose:function(){o._close()},onHide:function(){o._close()}}}),o.container.inject(e);var h=e.offsetHeight>420?420:e.offsetHeight-100,l=e.offsetWidth>350?350:e.offsetWidth;o.options.transferType===r.TransferPerson&&(h=e.offsetHeight>400?400:e.offsetHeight),o.container.setNewSize({height:h}),o.container.setNewSize({width:l})},_changeLeft:function(e){this.__changeValue("left",e)},_changeTop:function(e){this.__changeValue("top",e)},__changeValue:function(e,t){var r="auto"===t;this.container.elements.container.setStyle(e,r?t:t+"px")},centerIt:function(){var e=this.container.elements.container;if(e){var t=this.container.elements.container.parentElement;this.parent&&(t=this.parent);var r=t.getSize(),i=e.getSize(),n=r.width/2-i.width/2,s=r.height/2-i.height/2;this._changeLeft(n),this._changeTop(s)}},show:function(e,t){this.container.show(),this.TOSWidget.initData(e,t)},close:function(){this.container.hide(),!0===this.options.removeAtClose&&this.destroy()},_close:function(){this.dispatchEvent("onClose"),this.close()}})});