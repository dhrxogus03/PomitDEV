define("DS/DELPPWLinksModule/UsagePointsManagerUI",["UWA/Core"],function(e){"use strict";return function(t,n,i){var o,s,a,r,l,c,d,g,u=i.getComponent("Button"),f=[];return l=function(s){c(),e.is(i)?(o=i.create("Dialog",{title:n.getNLSValue("LinksUI.CreateUsagePoints"),domId:"UsagePoints-UI",content:a,modalFlag:!1,resizableFlag:!0,width:400,minWidth:300,height:300,minHeight:200,buttons:{Cancel:new u({onClick:function(){o.close()}}),Ok:new u({emphasize:"primary",onClick:function(){e.is(s,"function")&&e.is(r.getSelectedItemsIds())&&r.getSelectedItemsIds().length>0?(o.close(),s(r.getSelectedItemsIds())):g(n.getNLSValue("UsagePointsManagerUI.SubmitWithoutSelection.Error"),"error")}})}})).close=function(){e.is(a)&&a.destroy(),this.destroy(),o=null}:t.debug("uxFactoryBehavior is not available.")},c=function(){a=i.createElement("div",{class:"UsagePointsManagerUI-Dialog"}),s=i.createElement("div",{class:"objects-section"}).inject(a),r=i.create("SelectionControl",{message:n.getNLSValue("UsagePointsManagerUI.SelectServiceItems"),renderTo:s,multiSelection:!0,displayMultiSelection:!0,itemsWithOptions:!0})},d=function(t){e.is(t)&&r.updateLabel(t)},g=function(n,i){e.is(n)&&e.is(i)&&("info"===i?o.info(n):"warning"===i?o.warning(n):"error"===i?o.error(n):t.debug("type of message is invalid"))},{prepareParamObj:function(e){f.push({instId:e.instanceId,path:e.path})},buildSkeleton:function(t){e.is(o)||l(function(n){var i,o,s=[];for(i=0;i<n.length;i++)o=f.find(e=>e.instId===n[i]),e.is(o)&&e.is(o.path)&&s.push(o.path);e.is(t,"function")&&e.is(s)&&s.length>0&&t(s)})},updateLabels:function(e){d(e)},isVisible:function(){return!!e.is(o)&&o.visibleFlag},showMessages:function(e,t){g(e,t)},clearMessages:function(){o.clearMessages()},destroyDialog:function(){e.is(o)&&(o.destroy(),o=null)}}}}),define("DS/DELPPWLinksModule/LinksUI",["UWA/Core","DS/DELPPWLinksModule/UsagePointsManagerUI"],function(e,t){"use strict";return function(n,i,o,s,a,r,l,c){const d="PLMInstance.PLM_ExternalID";var g,u,f,p,h,m,P,I,b,y,S,L,v,E,U,k,C,D,R,w,A,T,M,N,O,V,F,W,j={className:"Links MGA-linksUIContainer disableContentselection"},x=new t(n,o,i),B=o.getNLSValue("LinksUI.PanelTitle"),Y={},_=null,H={title:"",labelAttribute:"PLMEntity.V_Name",reference:{model:null},instance:{model:null,absPath:""},whereUsed:{isFetched:!1,references:[],instances:[]}};return U=function(){e.is(_)&&(_.title=B+H.title)},k=function(){var t,o,s,a,r=i.getComponent("WUXFrameWindowsManager").getFrameWindow(n.getAppContext());(_=i.create("Panel",{position:{my:"center",at:"center"},domId:"RelationsPanel",immersiveFrame:r.getImmersiveFrame(),resizableFlag:!0,visibleFlag:!1})).close=function(){e.is(f)?n.notify("toggleCmdCheckHeaderState",{cmdName:f,cmdState:!1}):A()},I=i.create("Element","div",{class:j.className}),t=i.create("Element","div",{class:"linksPanel-Container"}),o=i.create("Element","div",{class:"module-messages"}),s=C(),a=D(),o.inject(t),s.inject(t),a.inject(t),t.inject(I)},C=function(){var e;return e=i.create("Element","div",{class:"linkView-toolbar"}),(b=i.create("Filter",{filterToolbarSections:m})).inject(e),b.addEvent("onChange",function(e,t){t&&"PARENT"===e&&!1===H.whereUsed.isFetched&&T(),t&&Y[e].pprTypeDiv.getChildren().length>0?Y[e].pprTypeDiv.show():Y[e].pprTypeDiv.hide()}),e},D=function(){var t,n;for(n in t=i.create("Element","div",{class:"LinksUI-menuDiv"}),(P=i.create("WUXLoader")).inject(t),Y)Object.hasOwnProperty.call(Y,n)&&(Y[n].pprTypeDiv=new e.Element("div",{class:"pprTypeDiv"}).inject(t));return t},R=function(t,n,a,r,l,c){var d,g=o.getNLSValue("LinksUI.ConfirmationDialog.Header"),u=o.getNLSValue("LinksUI.ConfirmationDialog.Text");d=function(i){e.is(i,"boolean")&&i&&s.switchScope(t,n,a,r,l,c)},i.showConfirmation(g,u,null,d)},w=function(t,n){var s,a,r,l=i.createElement("div",{class:"selectInstance-dialog-container"}),c=[],g=i.getComponent("ComboBox"),u=i.getComponent("Button"),f=o.getNLSValue("LinksUI.SelectInstanceDialog.Header");for(s=0;s<t.length;s++)c.push({label:t[s].get(d),value:t[s]});(r=new g({elementsList:c,enableSearchFlag:!1,actionOnClickFlag:!1})).inject(l),(a=i.create("Dialog",{domId:"selectInstance-dialog",title:f,content:l,resizableFlag:!0,modalFlag:!0,width:400,minWidth:290,buttons:{Cancel:new u({onClick:function(){a.close()}}),Ok:new u({disabled:!1,emphasize:"primary",onClick:function(){a.close(),e.is(n,"function")&&n(r.currentValue)}})}})).close=function(){this.destroy()}},A=function(){_.hide()},T=function(){var t,i=!1,o=!1,r=[],l=[],c=[],d=H.reference.model,g=H.instance.model,u=H.labelAttribute,f=!1,p=null,h=[],m=function(){var t,s,h,m,I,b;i&&o&&(t=r,s=l,h=c,m={},I=[],b=function(){m=N(t,d,g,u,m),m=O(s,h,d,g,u,m),M(m),P.hide(),n.notify("RelationsPanelLoaded")},Object.keys(Y).forEach(e=>{m[e]=[]}),W(),a.isNavigateOnDemand()||t.forEach(function(t){e.is(t.get("usagePoint"))&&t.get("usagePoint").length>0&&!e.is(a.getInstance(t.get("usagePoint")[0][t.get("usagePoint")[0].length-1]))&&I.push(...t.get("usagePoint").map(e=>e[e.length-1]))}),I.length>0?a.fetchInstancesAndTheirReferences(I,{onComplete:function(){b()},silentMode:"true"}):b()),f&&n.notify("updateRelationsColumn",p)},I=function(e){i=!0,r=e,m()};t=b.getSelectedItems(),!0!==H.whereUsed.isFetched?e.is(d)&&-1!==t.indexOf("PARENT")?(a.getWhereUsedReferences(d,function(t,n){o=!0,e.is(H.whereUsed)&&(H.whereUsed.isFetched=!0,H.whereUsed.references=t,H.whereUsed.instances=n),l=t,c=n,m()}),H.whereUsed.isFetched=!0):o=!0:(e.is(d)&&-1!==t.indexOf("PARENT")&&(l=H.whereUsed.references||[],c=H.whereUsed.instances||[]),o=!0),W(),e.is(g)&&(f=f||a.needToQueryForConnections(g),e.is(p)||(p=g.get("PID"))),e.is(d)&&(f=f||a.needToQueryForConnections(d),e.is(p)||(p=d.get("PID"))),P.show(),a.isNavigateOnDemand()?(e.is(g)?h.push({id:g.get("PID"),path:H.instance.absPath}):e.is(d)&&h.push({id:d.get("PID"),path:[]}),h.length>0&&s.getRelations(h).then(function(){var t,n;n=e.is(g)?g.get("PID"):d.get("PID"),t=s.getImpactedConnections(n),I(t)})):s.getConnectionsByModel(d,g,{silentMode:!0,onComplete:I})},M=function(t){var n,s,r,l,c,d,g,u,f,p,h,m,P;for(r in h=b.getSelectedItems(),t)if(Object.hasOwnProperty.call(t,r)){if(l=t[r],s=Y[r].pprTypeDiv,0===l.length){s.setStyle("display","none");continue}for(h.indexOf(r)>-1?s.show():s.hide(),s.addClassName("pprTypeMarg"),new e.Element("div",{class:"pprTypeTitleDiv",text:Y[r].title}).inject(s),n=0;n<t[r].length;n++){if(g=i.create("Element","div",{class:"connectionDiv default"}),p=(c=t[r][n]).type,e.is(p)&&("SecondaryCandidateResourceLink"===p&&(g.className="connectionDiv secondaryRecource"),f=c.iconDirection,e.is(f)&&(-1!==p.indexOf("_inverse")?f.tooltipInfos=i.create("TooltipModel",{shortHelp:o.getNLSValue("LinksUI.BackwardIcon")}):f.tooltipInfos=i.create("TooltipModel",{shortHelp:o.getNLSValue("LinksUI.ForwardIcon")}),f.inject(g)),u=c.icon,e.is(u)&&(u.tooltipInfos=i.create("TooltipModel",{shortHelp:o.getNLSValue(p)}),u.inject(g))),(d=i.create("Element","div",{class:"connectionLabel",text:c.label,styles:{display:"inline-block"}})).tooltipInfos=i.create("TooltipModel",{shortHelp:c.label}),d.inject(g),e.is(H.reference)&&e.is(H.reference.model)){const e=H.reference.model;m=a.isReferencesHasReadOnlyType(e)}m||((P=i.create("Button",{label:"",icon:"bars",iconSize:"2x",displayStyle:"lite",onClick:V}).inject(g)).getContent().setStyles({float:"right"}),P.getContent().setData("pid",c.pid),P.getContent().setData("linkedReferencePID",c.linkedReferencePID)),g.inject(s),e.is(c.usagePoint)&&c.usagePoint.length>0&&c.usagePoint.forEach(function(e){E(s,e)})}}},E=function(t,n){var s,a,r,l;s=i.create("Element","div",{class:"connectionDiv default usagePoint"}),a=n.icon,e.is(a)&&(a.tooltipInfos=i.create("TooltipModel",{shortHelp:o.getNLSValue("LinksUI.UsagePoint")}),a.inject(s)),(r=i.create("Element","div",{class:"connectionLabel",text:n.label,styles:{display:"inline-block"}})).tooltipInfos=i.create("TooltipModel",{shortHelp:n.label}),r.inject(s),(l=i.create("Button",{label:"",icon:"close",iconSize:"2x",displayStyle:"lite",onClick:function(){v(n.connPID,n.targetPathInstIds)}})).tooltipInfos=i.create("TooltipModel",{shortHelp:o.getNLSValue("LinksUI.DeleteUsagePoint")}),l.inject(s),l.getContent().setStyles({float:"right"}),s.inject(t)},N=function(t,i,r,l,g){var f,p,h,m,P,I,b,y,S,L,v,E,U,k,C,D,R,w,A=u,T=e.is(i)?i.id:"",M=e.is(r)?r.id:"";for(f=0;f<t.length;f++){switch(p=(y=t[f]._attributes).type){case"DELLmiTimeConstraintCnx":p=s.getLinkInfo(t[f]).subType;break;case"DELAsmProcessCanUseCnx":s.getSecondaryRscLinksFromPrimaryLink(t[f]).forEach(function(e){(w=e.clone()).set("from",y.from),t.splice(f+1,0,w)});break;case"SecondaryCandidateResourceLink":if(R=s.getConnection(y.from),e.is(R)){(w=t[f].clone()).set("from",R.get("from")),t.splice(f+1,0,w),(w=t[f].clone()).set("from",R.get("to")),t.splice(f+1,0,w);continue}}if(E=y.to,!("ProcessImplementLinkOcc"===y.type&&e.is(y.from,"array")&&e.is(y.to,"array")&&e.is(H.instance.absPath))||c.isImplementLinkValidForOccPath(y.from,y.to,H.instance.absPath))if(D=!!e.is(y.to,"array")&&M===y.to[y.to.length-1],T===y.to||M===y.to||D?(E=y.from,p+="_inverse",L=o.getIconElem("LinkInverse")):L=o.getIconElem("Link"),U=a.getReference(E),e.is(U)||((v=e.is(E,"array")?a.getInstance(E[E.length-1]):a.getInstance(E))?U=a.getReference(v.get("isInstanceOf")||v.get("to")):n.debug("No linked instance !!!")),e.is(U)){if(S="OPERATION"===(S=U.get("PPRTYPE"))?"SYSTEM":S,b=U.get("type"),!Object.hasOwnProperty.call(Y,S)){n.debug("Linked object PPRTYPE is not authorized in Relations Panel :"+b);continue}if(e.is(A[b])&&e.is(A[b].Attribute)){k=A[b].Attribute,k=e.is(k,"array")?k:[k];const t=A[b].separator||" ";!e.is(v)||"ProcessImplementLink"!==p&&"PartialProcessImplementLink"!==p||!e.is(y.to,"array")&&v.id!==y.to?m=k.map(t=>{var n=e.is(t.dicoType)?t.dicoType+"."+t.name:t.name;return U.get(n)}).join(t):(m="("+v.get(d)+") ",m+=k.map(t=>{var n=e.is(t.dicoType)?t.dicoType+"."+t.name:t.name;return U.get(n)}).join(t))}else m=U.get(l);if(e.is(A[p])&&e.is(A[p].Attribute)){k=A[p].Attribute,k=e.is(k,"array")?k:[k];const t=A[p].separator||")(";let n=!1;for(P=[],C=0;C<k.length;C++)if(I=e.is(k[C].dicoType)?k[C].dicoType+"."+k[C].name:k[C].name,"ProcessImplementLinkOcc"!==p&&"ProcessImplementLinkOcc_inverse"!==p||"PLMEntity.V_usage"!==I){if("ProcessImplementLinkOcc"!==p&&"ProcessImplementLinkOcc_inverse"!==p||!I.contains("V_ContQuantity")&&!I.contains("V_UsageQuantityRatio"))P.push(y[I]);else if(!n){let t=c.getQuantityFromModel(y.PID);n=!0,e.is(t)&&P.push(t)}}else{let e=c.getRoleFromModelOrComputed(y.PID);P.push(e.nlsText)}m="("+P.join(t)+")"+m}h=o.getIconElem(p),Object.hasOwnProperty.call(g,S)&&(g[S].push({label:m,icon:h,iconDirection:L,pid:y.PID,linkedReferencePID:U.get("PID"),type:p}),("ProcessImplementLink"===p||"ProcessImplementLink_inverse"===p)&&e.is(y.usagePoint)&&y.usagePoint.length>0&&y.usagePoint.forEach(function(t){var i,s=o.getIconElem("UsagePoint"),r=a.getInstance(t[t.length-1]);e.is(r)?(i=r.get(d),e.is(g[S][f].usagePoint)||(g[S][f].usagePoint=[]),g[S][f].usagePoint.push({label:i,icon:s,targetPathInstIds:t,connPID:y.PID})):n.debug("Cannot retrieve the targeted instance of the Usage Point")}))}else n.debug("No linked reference !!!")}return g},O=function(t,i,s,a,r,l){var c,d,g,f,p,h,m,P,I,b,y,S=u;for(c=0;c<t.length;c++){if(h=(I=t[c]).get("type"),e.is(S[h])&&e.is(S[h].Attribute))for(y=S[h].Attribute,y=e.is(y,"array")?y:[y],P=S[h].separator||" ",f="",d=0;d<y.length;d++)m=e.is(y[d].dicoType)?y[d].dicoType+"."+y[d].name:y[d].name,0!==d&&(f+=P),f+=I.get(m);else f=I.get(r);for(g=o.getIconElem(h),p="Type."+h,d=0;d<i.length;d++)if(i[d].get("isAggregatedBy")===I.get("PID")){b=i[d];break}e.is(b)?l.PARENT.push({label:f,icon:g,pid:b.get("PID"),linkedReferencePID:I.get("PID"),type:p}):n.debug("Instance of reference id:"+I.get("PID")+" not found.")}return l},y=function(t){var n,i;n=s.getConnection(t),e.is(n)?s.deleteConnection(t):(i=a.getInstance(t),e.is(i)&&a.deleteInstance([i],{askDeleteConfirmation:!1}))},S=function(t){var i,r,l,d,g,u,f,p,h,m=!0,P=[];if(i=s.getConnection(t),e.is(i)){if(f=!!a.isInstance(i.get("to")),g=i.get("type"),r=i.get("from"),f)l=a.getInstance(i.get("to")).get("isInstanceOf"),d=i.get("to");else if(l=i.get("to"),u=a.getParentInstancesFromCollection(l),"PartialProcessImplementLink"===g&&(P=c.findInstanceWhoseParentIsScoped(H.instance.absPath).scopeLinks),0!==u.length)if(u.length>1&&0===P.length)w(u,function(e){e&&(d=e.get("PID"),l&&d&&!f&&s.switchScope(r,l,d,g,f,i))});else if(u.length>1&&P.length>0)for(h=0;h<P.length;h++)P[h].get("to").toString()===i.get("to").toString()?w(u,function(e){if(e&&(d=e.get("PID"),l&&d&&!f))for(s.switchScope(r,l,d,g,f,i),h=0;h<P.length;h++)g=P[h].get("type"),s.switchScope(P[h].get("from"),l,d,g,f,P[h])}):a.isInstance(P[h].get("to"))&&(d=P[h].get("to"));else u[0].get("isInstanceOf")===l&&(d=u[0].get("PID"));else n.warn(o.getNLSValue("LinksUI.SwitchScopeCallback.Warn"));if(l&&d&&f)"ProcessImplementLink"===g&&(p=a.getAllChildrenFromCollection(r),a.getReferencesFromArray(p.referencesPID).forEach(function(e){var t;if("DELLmiHeaderOperationReference"===e.get("type"))for(t=c.getPartialScopeLinks(e.id),h=0;h<t.length;h++)a.isInstance(t[h].get("to"))&&t[h].get("to").toString()===i.get("to").toString()&&(m=!1)})),m?R(r,l,d,g,f,i):n.warn(o.getNLSValue("LinksUI.SwitchScopeCallback.PreventScope"));else if(l&&d&&!f&&(s.switchScope(r,l,d,g,f,i),P.length>0))for(h=0;h<P.length;h++)P[h].get("to").toString()===i.get("to").toString()&&(g=P[h].get("type"),s.switchScope(P[h].get("from"),l,d,g,f,P[h]))}},L=function(t){var i=s.getConnection(t);e.is(i)&&(g=i.get("to"),x.destroyDialog(),x.buildSkeleton(function(a){e.is(a)&&(e.is(i.get("usagePoint"))&&JSON.stringify(i.get("usagePoint"))===JSON.stringify(a)?(n.warn(o.getNLSValue("LinksUI.UsagePointsAlreadyExisting.Warn")),_.close()):(s.setUsagePoints(t,a,null),_.close()))}))},v=function(t,n){var i=[];e.is(n)&&(i.push(n),s.deleteUsagePoint(t,i))},V=function(t){var l,c,d,g,u,f,m,P,I=[],b=this.getData("pid"),v=s.getConnection(b),E=this.getData("linkedReferencePID"),U=a.getReference(E),k=U.get("PPRTYPE"),C=t.currentTarget.getOffsets().x,D=t.currentTarget.getOffsets().y+25;c=e.is(v),d={icon:"url("+o.getIconURLFromKey("GeneralDelete")+")",label:o.getNLSValue("LinksUI.DeleteLink"),sensitivity:c?s.canDeleteRelation(b)?"enabled":"disabled":"enabled",callback:function(){y(b)}},g={icon:"url("+o.getIconURLFromKey("SwitchScope")+")",label:o.getNLSValue("LinksUI.SwitchScope"),sensitivity:"enabled",callback:function(){S(b)}},l={icon:"url("+o.getIconURLFromKey("EditAttribute")+")",label:o.getNLSValue("LinksUI.EditAttribute"),sensitivity:r.hasEditConfiguration(b)?"enabled":"disabled",callback:function(){r.editConfiguredAttributes(b)}},u={icon:"url("+o.getIconURLFromKey("showAuxiliaryView")+")",label:o.getNLSValue("LinksUI.ShowInAuxiliaryView"),sensitivity:"enabled",callback:function(){n.notify("addToAuxiliaryView",U)}},s.isUsagePointManagementEnabled()&&(f={icon:"url("+o.getIconURLFromKey("UsagePoint")+")",label:o.getNLSValue("LinksUI.CreateUsagePoints"),sensitivity:"enabled",callback:function(){L(b)}}),Object.keys(p).indexOf(k)>-1&&(m={icon:"url("+o.getIconURLFromKey(p[k].icon)+")",label:o.getNLSValue("LinksUI.ShowInNaturalView",{view:o.getNLSValue(p[k].view)}),sensitivity:"enabled",callback:function(){n.notify("referenceAdded",[U,null,{withLinksResolved:!0}])}}),P={icon:"url("+o.getIconURLFromKey("ExploreInWebApp")+")",label:o.getNLSValue("ExploreInWebApp",null,"Cmd","Title"),sensitivity:"enabled",callback:function(){n.notify("ExploreInWebApp",[[{referencePID:E}]])}},c?(I.push(d),I.push(l),s.isUsagePointManagementEnabled()&&("ProcessImplementLink"!==v.get("type")||!e.is(H.reference.model)||"DELLmiServiceWorkPlanSystemReference"!==H.reference.model.get("type")&&"DELLmiServiceWorkPlanSystemReference"!==U.get("type")||"SERVICE"!==k&&"SYSTEM"!==k||I.push(f))):e.is(H.reference.model)&&"PRODUCT"!==H.reference.model.get("PPRTYPE")&&I.push(d),"Installation"!==U.get("PLMEntity.V_discipline")&&"Transform"!==U.get("PLMEntity.V_discipline")||I.push(g),I.push(u),e.is(m,"object")&&I.push(m),s.isExploreWebAppEnabled()&&h&&I.push(P),i.getComponent("ContextualMenuManager").show({nodes:I},[C,D])},F=function(){var e;for(e in Y)Object.hasOwnProperty.call(Y,e)&&("PARENT"===e?b.unselectItem(e,!0):b.selectItem(e,!0))},W=function(){Object.values(Y).forEach(function(e){e.pprTypeDiv.empty()})},{init:function(t){j=e.extend(j,t),u=t.relAttributeConfig,f=e.is(t.relatedCmdId)?t.relatedCmdId:null,p=e.is(t.acceptedTypes)?t.acceptedTypes:null,h=!e.is(t.exploreInWebApp)||t.exploreInWebApp,m=e.is(t.filterToolbarSections)?t.filterToolbarSections:null,Array.isArray(m)?m.forEach(function(e){Y[e]={title:o.getNLSValue("PPRTYPE."+e)}}):Y={PART:{title:o.getNLSValue("PPRTYPE.PART")},PRODUCT:{title:o.getNLSValue("PPRTYPE.PRODUCT")},SERVICE:{title:o.getNLSValue("PPRTYPE.SERVICE")},PROCESS:{title:o.getNLSValue("PPRTYPE.PROCESS")},SYSTEM:{title:o.getNLSValue("PPRTYPE.SYSTEM")},RESOURCE:{title:o.getNLSValue("PPRTYPE.RESOURCE")},PARENT:{title:o.getNLSValue("PPRTYPE.PARENT")},ORGANIZATION:{title:o.getNLSValue("PPRTYPE.ORGANIZATION")}},k()},destroy:function(){this.isActive()&&A(),e.is(_)&&(_.destroy(),_=void 0)},showModal:function(t){H=e.extend(H,t),T(),_.show(),U(),_.content=I},isActive:function(){return!!e.is(_)&&_.visibleFlag},isUsagePointsDialogVisible:function(){return x.isVisible()},clear:function(){H={title:"",reference:{model:null},instance:{model:null,absPath:""},whereUsed:{isFetched:!1,references:[],instances:[]}},U(),W()},hideUI:function(){_.hide()},updateWhereUsed:function(t){var n,i,o=-1;if(e.is(t)&&(n=t.isInstance()?t.get("isAggregatedBy"):t.get("PID"),e.is(H.whereUsed.references,"array"))){for(i=0;i<H.whereUsed.references.length;++i)if(H.whereUsed.references[i].id===n){o=i;break}-1!==o?H.whereUsed.references.splice(o,1):t.isInstance()&&(H.whereUsed.instances.push(t),H.whereUsed.references.push(a.getReference(n))),T()}},updateUsagePointsSelectionUI:function(t){var n=[];t.forEach(function(t){var i=a.getReference(t.referenceId),s=a.getInstance(t.instanceId),r=e.is(i)&&e.is(s),l=!1;t.path.forEach(function(e,n){var i=a.getInstance(e);return 0===n&&i.get("isAggregatedBy")===g?l=!0:i.get("isInstanceOf")===g?e===t.instanceId?l=!1:(t.path.splice(i,t.path.length-1),l=!0):void 0}),r?a.isAKindOf(i,"DELServicePartReference")||a.isAKindOf(i,"DELServiceAssemblyReference")||a.isAKindOf(i,"DELServiceKitReference")?e.is(l)&&l?(n.push(s),x.prepareParamObj(t),x.clearMessages()):x.showMessages(o.getNLSValue("UsagePointsManagerUI.SelectionNotSupported.Warn"),"warning"):x.showMessages(o.getNLSValue("UsagePointsManagerUI.ServiceItemNotSupported.Warn"),"warning"):x.showMessages(o.getNLSValue("UsagePointsManagerUI.SelectionNotSupported.Warn"),"warning")}),n.length>0&&x.updateLabels(n)},getCurrentModel:function(){return H},updateTitle:function(e){H.title=e,U()},resetFilter:function(){F()}}}}),define("DS/DELPPWLinksModule/LinksModule",["UWA/Core","DS/DELPPWLinksModule/LinksUI"],function(e,t){"use strict";return{behaviors:["UXFactoryBehavior","ResourceBehavior","SelectionBehavior","LinkBehavior","ModelBehavior","EditAttributeBehavior","ProductImplementBehavior","ProcessImplementBehavior","ProductFlowLinkBehavior"],creator:function(n,i,o,s,a,r,l,c,d,g){var u,f,p,h,m,P,I,b,y=null;return h=function(t,n){a.getXMLValues(u.relationsDialogDisplayAttributeConfigXML,function(n){var i=n.convert("DisplayAttributeDescriptionList.Type","name")||{},o=n.convert("DisplayAttributeDescriptionList.Relation","linkName")||{};f=e.merge(i,o),t()},function(e){n(e)})},m=function(t){var n,i,o,s=[];return e.is(t,"array")&&t.forEach(function(t){n=r.getInstance(t.id),o=e.is(n)?n.get("isInstanceOf"):t.id,i=e.is(n)?n.get("PID"):null,s.push({referenceId:o,instanceId:i,path:t.path})}),s},P=function(t){var n=!1,i=y.getCurrentModel(),o=e.is(i.reference.model)?i.reference.model.id:"",s=e.is(i.instance.model)?i.instance.model.id:"";return t!==o&&t!==s||(n=!0),n},I=function(t){var i={instModel:{},refModel:{},absPath:""},o=t.id?t.id:t.instancePID,s=t.id?t.id:t.referencePID;return i.instModel=r.getInstance(o),e.is(i.instModel)?(i.absPath=t.path?t.path:t.absPath,i.refModel=r.getReferenceModelFromInstance(i.instModel)):(i.refModel=r.getReference(s),e.is(i.refModel)||n.debug("Object with reference PID:"+o+" and instance PID:"+s+" not found.")),i},p=function(t){var n,i,o,a,r={title:"",reference:{model:null},instance:{model:null,absPath:""},whereUsed:{isFetched:!1,references:[],instances:[]}};return e.is(t)?(n=I(t),i=n.refModel,o=n.instModel,a=n.absPath):1===s.getSelectedNodesCount()&&s.getSelectionsWithPaths().forEach(function(t){e.is(t)&&1===t.length&&t.forEach(function(e){n=I(e),i=n.refModel,o=n.instModel,a=n.absPath})}),r.title=e.is(i)?i.get("PLMEntity.V_Name"):"",r.reference.model=i,r.instance.model=o,r.instance.absPath=a,r},b=function(){y.isActive()&&(y.resetFilter(),y.showModal(p()))},{name:"LinksModule",listenTo:function(){return{select:this.onSelect,Relations:this.onShowRelations,instanceAdded:this.onAddInstance,connectionAdded:this.onAddConnections,connectionRemoved:this.onRemoveConnections,referenceRemoved:this.onRemoveRefOrInst,referenceChanged:this.onChangeRefOrInst,instanceRemoved:this.onRemoveRefOrInst,refreshImpacted:this.reloadUI,connectionChanged:this.reloadUI}},onStart:function(s,g){if(u=s||{},!e.is(u.relationsDialogDisplayAttributeConfigXML))return n.debug("LinksModule loading failed : relationsDialogDisplayAttributeConfigXML options are undefined"),void g();Promise.all([new Promise(h.bind(this))]).then(function(){(y=new t(n,i,o,a,r,l,c,d)).init({relAttributeConfig:f,relatedCmdId:u.relatedCmdId,acceptedTypes:u.pprTypes,exploreInWebApp:u.exploreInWebApp,filterToolbarSections:u.filterToolbarSections}),y.showModal(p(u.node)),g()},function(e){n.debug("LinksModule loading failed :"+e),g()})},onStop:function(){y.destroy(),y=void 0},onRemoveRefOrInst:function(t){(t=Array.isArray(t)?t:[t]).forEach(function(t){e.is(t)&&y.isActive()&&(P(t.id)?y.clear():y.updateWhereUsed(t))})},onChangeRefOrInst:function(t){var n;(t=Array.isArray(t)?t:[t]).forEach(function(t){y.isActive()&&e.is(t)&&t.isReference()&&P(t.id)&&(n=t.changedAttributes(),e.is(n)&&n.hasOwnProperty("PLMEntity.V_Name")&&y.updateTitle(n["PLMEntity.V_Name"]))})},onShowRelations:function(t){var n;n=e.is(t)?e.is(t,"array")?t[0]:t:null,e.is(n)&&y.isActive()&&y.showModal(p(n))},onSelect:function(e){var t={},n=[];e&&y.isUsagePointsDialogVisible()&&!0===e.changed.isSelected?(n.push({id:e.changed.nodeId,path:e.changed.absPath}),(t=m(n))&&y.updateUsagePointsSelectionUI(t)):y.isUsagePointsDialogVisible()||b()},onAddConnections:function(t){var n,i,o;y.isActive()&&(o=function(t){return!!(e.is(t)&&(n=t.getAttribute("from"),i=t.getAttribute("to"),P(n)&&P(i)))},(e.is(t,"array")?t.some(o):o(t))&&y.showModal(y.getCurrentModel()))},onRemoveConnections:function(t){var n,i,o;y.isActive()&&(o=function(t){var o,s,r,l;if(e.is(t))if(n=t.getAttribute("from"),i=t.getAttribute("to"),"SecondaryCandidateResourceLink"===t.get("type")){if(o=a.getConnection(n),!e.is(o))return!1;if(s=o.getAttribute("from"),r=o.getAttribute("to"),l=i,P(s)||P(r)||P(l))return!0}else if(P(n)||P(i))return!0;return!1},(e.is(t,"array")?t.some(o):o(t))&&y.showModal(y.getCurrentModel()))},onAddInstance:function(t){e.is(t)&&y.isActive()&&P(t.get("isInstanceOf"))&&y.updateWhereUsed(t)},reloadUI:function(){b()}}}}});