define("DS/CAT3DPlayMUCScenario/CAT3DPlayMUCScenario",["DS/3DPlay/3DPlayScenario","DS/ApplicationFrame/CommandsManager"],function(e,n){"use strict";return e.extend({init:function(e){this._parent(e),e.scenarioManager&&(this._experience=e.scenarioManager.getExperience()),this.setScenarioResetActionBarPolicy(!0)},isMobileCompatible:function(){return!0},launch:function(){if(this.loadWorkbench({module:"CAT3DPlayMUCScenario",name:"CAT3DPlayMUCScenario"},!0),this._experience){let e=this._experience.frmWindow.getActionBar();this.token_launch=e.onActionBarReady(()=>{let i=n.getCommand("CAT3DPlayMUCCmd",this._experience.ctx);i&&!i.isRunning()&&(i.begin(),this.token_launch&&(e.removeCallback(this.token_launch),this.token_launch=void 0))})}},stop:function(){if(this._experience&&this._experience.frmWindow){if(this.token_launch){let e=this._experience.frmWindow.getActionBar();e&&(e.removeCallback(this.token_launch),this.token_launch=void 0)}if(this._experience){let e=n.getCommand("CAT3DPlayMUCCmd",this._experience.ctx);e&&e.isRunning()&&e.end()}}else console.error("3DPlay : Navigation Scenario --\x3e Cound not stop.")}})}),define("DS/CAT3DPlayMUCScenario/CAT3DPlayMUCRegister",["DS/3DPlay/3DPlayRegister","DS/CAT3DPlayMUCScenario/CAT3DPlayMUCScenario","DS/WAFData/WAFData","UWA/Utils","DS/ZipJS/inflate"],function(e,n,i,t,a){"use strict";return e.extend({init:function(e){this._parent(e),this._initScenarios();var n=this;this._experience=this.scenarioManager.getExperience(),this._experience&&(this._experience.EventDisposer.add(this._experience.subscribe("ASSET/LOADINGFINISHED",e=>{const a=function(e){let i=e&&""!==e;n.scenarioManager.setAvailability(i,{iRegisterID:n.registerID,iScenarioID:n.scenarioID}),!window.cdsJSON&&e&&(window.cdsJSON=e)},o=function(e){let n=e.contextid?e.contextid:"preferred",o=e.serverurl+"/resources/v1/model/bus/"+e.physicalid+"?select="+encodeURIComponent("attribute[CDSSolverData]"),r={Accept:"application/json","content-type":"application/json"};r["Accept-Language"]=widget.lang,r.SecurityContext=n?encodeURIComponent(n):null;let s={headers:r,method:"GET",type:"json",timeout:36e5,proxy:"passport",onComplete:function(e){let n=function(e){let n="";try{n=t.base64Decode(e)}catch(e){}let i=new ArrayBuffer(n.length),a=new Uint8Array(i);for(let e=0;e<n.length;e++)a[e]=n.charCodeAt(e);let o=gztools.getInflater(),r=o.append(a);return o.flush(),String.fromCharCode.apply(null,r)}(e["attribute[CDSSolverData]"]);a(n)}.bind(this),onCancel:function(e){a(null),console.error("ERROR: WAFData request failed while opening data.")}.bind(this),onFailure:function(e){a(null),console.error("ERROR: WAFData request failed while opening data.")}.bind(this)};i.authenticatedRequest(o,s)};"EV6"===e.loadAssetInfo.provider?(window.is3dxml=!1,o(e.loadAssetInfo)):(window.is3dxml=!0,a(window.cdsJSON))})),this._experience.EventDisposer.add(this._experience.subscribe("ASSET/LOADINGSTARTED",e=>{window.is3dxml=void 0,window.cdsJSON=void 0})))},_initScenarios:function(){this.scenarioID=this.scenarioManager.addScenario({registerID:this.registerID,scenario:n,available:!0,name:"MUC"})}})});