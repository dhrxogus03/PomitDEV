<!DOCTYPE HTML>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <head>
    <script type="text/javascript" src="../AmdLoader/AmdLoader.js"></script>
    <script type="text/javascript" src="../WebappsUtils/WebappsUtils.js"></script>
    <script type="text/javascript" src="../c/UWA/js/UWA_Frame_Alone.js"></script>
    <script type="text/javascript">
    define('DS/W3DDriveApp/widget', ['UWA/Utils','DS/UWPClientCode/PublicAPI', 'DS/MessageBus/MessageBus'], function (Utils) {
        'use strict';

        return {
            getValue: function (property) {
                switch (property) {
                    case "3ddrive_uuid":
                        return 'C-' + Utils.getUUID();
                        break;
                    default:
                        return null;
                }
            },
            setValue: function (key,pref) {
                return;
            },
            hasPreference: function (key) {
                return false;
            },
            addPreference: function (key, value) {
                return;
            }
        };
    });

    // This variable needs to be global for native apps integration using cef javascript handlers (js events). CEF: Chromium Embedded Framework.
    let shareWithExternalView;

    (function () {
        'use strict';

        require([
            'DS/W3DDriveShare/views/ShareWithExternalView',
            'DS/i3DXCompass/Data',
            'DS/W3DDriveApp/widget'
        ], function (
            ShareWithExternalView,
            CompassData
        ) {
            const urlSearchParams = new URLSearchParams(window.location.search);

            CompassData.initialize({
                myAppsBaseUrl: urlSearchParams.get('myAppsUrl'),
                userId: 'USER_ID',
                lang: urlSearchParams.get('lang')
            });

            shareWithExternalView = new ShareWithExternalView({
                platformId: urlSearchParams.get('platformId'),
                inodeId: urlSearchParams.get('inodeId'),
                contextAppId: urlSearchParams.get('contextAppId'),
                automaticLinkActivation: urlSearchParams.get('automaticLinkActivation'),
                automaticCommentsActivation: urlSearchParams.get('automaticCommentsActivation'),
                automaticRestrictAccessActivation: urlSearchParams.get('automaticRestrictAccessActivation')
            });
            shareWithExternalView.inject(document.body);
        });
    }());
    </script>
    <body>
    </body>
</html>
