define("DS/VCXWebExperienceBase/VCXIRessourceAsset",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebExperienceBase/VCXComponentOccurrenceExperience",["require","exports","DS/VCXWebComponents/VCXWebComponentOccurrence"],function(e,t,r){"use strict";r=__importDefault(r);class i extends r.default{constructor(){super(),this._tooltip="$(##Actor.Name)",this._hyperlinkID=-1,this._eFreeze=0}set tooltip(e){this._tooltip=e}get tooltip(){return this._tooltip}set hyperlinkID(e){this._hyperlinkID=e}get hyperlinkID(){return this._hyperlinkID}set eFreeze(e){this._eFreeze=e}get eFreeze(){return this._eFreeze}}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentOccurrenceExperience"}}),i}),define("DS/VCXWebExperienceBase/VCXWebBaseKernelTools",[],function(){"use strict";Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null===this)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(0===i)return!1;for(var n=0|t,a=Math.max(n>=0?n:i-Math.abs(n),0);a<i;){if(r[a]===e)return!0;a++}return!1}}),String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)})}),define("DS/VCXWebExperienceBase/VCXSceneGraphOverridesServices",["DS/SceneGraphOverrides/SceneGraphOverrideSet","DS/Visualization/IdPath"],function(e,t){"use strict";return{createAndPushSceneGraphOverrideSet:function(t,r,i){var n=null;if(i||(i=t.getManager("VCXContextManager").getRootNode()),i&&(r||(r=t.getManager("VCXContextManager").getMainViewer()),r)){var a=r.getSceneGraphOverrideSetManager();let t=void 0;widget.enopadViewer&&(t="rootBag"),n=new e(i,t),a.pushSceneGraphOverrideSet(n)}return n},removeSceneGraphOverrideSet:function(e,t,r){var i=!1;if(!e||!t)return i;if(r);else r=e.getManager("VCXContextManager").getMainViewer();r&&(r.getSceneGraphOverrideSetManager().removeSceneGraphOverrideSet(t),i=!0);return i},getSceneGraphOverride:function(e,r,i){var n=null;if(e)if(r){const i=new t(["rootBag",...r]),a=e.getOverridesFromIdPath(i);(n=a&&a[0])||(n=e.createIdPathOverride(i))}else(n=e.getUniqueOverrideFromPathElement(i))||(n=e.createOverride(i));return n}}}),define("DS/VCXWebExperienceBase/VCXBaseDictionary",[],function(){"use strict";var e={VCXComponentOccurrenceExt:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableOccurrence",VCXIContextualContent:"DS/VCXWebKernel/VCXContextualContentOccurenceExt",VCXIModifiableFormatPainter:"DS/VCXWebExperienceBase/VCXModifiableOccurrenceExt"},VCXComponentOccurrenceExperience:{VCXIContextualContent:"DS/VCXWebKernel/VCXContextualContentOccurenceExperience"},VCXWebComponentOccurrence:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableOccurrence",VCXIModifiableView:"DS/VCXWebModifiablesImpl/VCXModifiableViewOccurrence",VCXIVisibility:"DS/VCXWebVisibilityImpl/VCXVisibilityOccurrence",VCXIModelNavigable:"DS/WebApplicationBase/VCXAModelNavigable",W3AISGNodeHolder:"DS/WebApplicationBase/W3AASGNodeHolder"},VCXScenario:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableScenario",VCXIModifiableView:"DS/VCXWebModifiablesImpl/VCXModifiableViewScenario",VCXIReadiness:"DS/WebApplicationBase/VCXAReadiness"},VCXScenarioSequence:{VCXIModifiable:"DS/VCXWebSequenceManager/VCXModifiableSequence",VCXIModifiableView:"DS/VCXWebModifiables/VCXModifiableView",VCXISensible:"DS/VCXWebComposer/VCXASensible"},VCXContextManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXAnalyticsTrackerBaseManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXScenarioManager:{VCXIModifiable:"DS/VCXWebScenarioManager/VCXModifiableScenarioManager",VCXIModifiableView:"DS/VCXWebModifiables/VCXModifiableView",W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXSequenceManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXDocManager:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableDocManager",VCXIModifiableView:"DS/VCXWebModifiables/VCXModifiableView",W3AIManager:"DS/WebApplicationBase/W3AAManager",VCXIReadiness:"DS/WebApplicationBase/VCXAReadiness"},VCXCommandManager:{VCXIModifiable:"DS/VCXWebModifiablesImpl/VCXModifiableCommandManager",VCXIModifiableView:"DS/VCXWebModifiables/VCXModifiableView",W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXMetaPropertyManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXLinkedPropertyManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXUnitManager:{VCXIModifiable:"DS/VCXWebUnits/VCXUnitManagerModifiable",VCXIModifiableView:"DS/VCXWebModifiables/VCXModifiableView",W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXModelChangeListener:{W3AIManager:"DS/WebApplicationBase/W3AAManager"},VCXPlayManager:{W3AIManager:"DS/WebApplicationBase/W3AAManager",VCXIModifiable:"DS/VCXWebExperienceBase/VCXPlayManagerModifiable"}},t={VCXIModifiable:"DS/VCXWebModifiables/VCXIModifiable",VCXIModifiableView:"DS/VCXWebModifiables/VCXIModifiableView",VCXIVisibility:"DS/VCXWebVisibility/VCXIVisibility",W3AISGNodeHolder:"DS/WebApplicationBase/W3AISGNodeHolder",W3AIManager:"DS/WebApplicationBase/W3AIManager",VCXIModelNavigable:"DS/WebApplicationBase/VCXIModelNavigable",VCXIContextualContent:"DS/VCXWebKernel/VCXIContextualContent",VCXIModifiableFormatPainter:"DS/VCXWebModifiables/VCXIModifiableFormatPainter",VCXIReadiness:"DS/WebApplicationBase/VCXIReadiness"},r={VCXScenario:"DS/VCXKeyFramer/VCXScenario",VCXScenarioSequence:"DS/VCXWebSequenceManager/VCXScenarioSequence",VCXWebComponentOccurrence:"DS/VCXWebComponents/VCXWebComponentOccurrence",VCXDocManager:"DS/VCXWebExperienceBase/VCXDocManager",VCXScenarioManager:"DS/VCXWebScenarioManager/VCXScenarioManager",VCXSequenceManager:"DS/VCXWebSequenceManager/VCXSequenceManager",VCXCommandManager:"DS/VCXWebKernelCommands/VCXCommandManager",VCXContextManager:"DS/VCXWebExperienceBase/VCXContextManager",VCXAnalyticsTrackerBaseManager:"DS/VCXWebKernelTools/VCXAnalyticsTrackerBaseManager",VCXMetaPropertyManager:"DS/VCXWebModifiables/VCXMetaPropertyManager",VCXLinkedPropertyManager:"DS/VCXWebModifiables/VCXLinkedPropertyManager",VCXUnitManager:"DS/VCXWebUnits/VCXUnitManager",VCXModelChangeListener:"DS/VCXWebModifiables/VCXModelChangeListener",VCXPlayManager:"DS/VCXWebExperienceBase/VCXPlayManager"};return{GetDictionary:function(){return{interfaces:t,components:r,extensions:e}}}}),define("DS/VCXWebExperienceBase/VCXNLSManager",["UWA/Class"],function(e){"use strict";var t=e.extend({init:function(){this._NLSMap={}},initialize:function(){},unInitialize:function(){},GetNLS:function(e){return this._NLSMap[e]},AddNLS:function(e,t){this._NLSMap[e]=t}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXNLSManager"}}),t}),define("DS/VCXWebExperienceBase/VCXPathElementTools",["UWA/Class","DS/Visualization/PathElement"],function(e,t){"use strict";return e.singleton({getMesh3dPathElements:function(e,r){var i=[];if(!e.externalPath||!e.externalPath.length)return i;"Mesh3D"===e.getLastElement().getNodeType()&&i.push(e);for(var n=new t,a=0;a<e.externalPath.length;++a)n.addElement(e.externalPath[a]);var o=n.getLastElement();for(a=0;a<o.children.length;++a){for(var s=!0,c=0;c<r.length;++c)if(r[c]===o.children[a].productType){s=!1;break}if(s){var l=n.clone();l.addElement(o.children[a]);var p=this.getMesh3dPathElements(l,r);p&&p.length&&(i=i.concat(p))}}return i},getLeafNameOfPathElement:function(e){if(!e)return"";var t=e.externalPath.length-1;if(t<0)return"";do{var r=e.externalPath[t].getName();if(r&&""!==r)return r;t-=1}while(t>0);return""},buildPathElement:function(e,t){if(!e)return null;for(var r=[],i=t;i&&e.getLastElement()&&i.id!==e.getLastElement().id;)r.push(i),i=i.parents[0];for(var n=e.clone(),a=r.length-1;a>=0;--a)n.addElement(r[a]);return n}})}),define("DS/VCXWebExperienceBase/VCXPlayManagerModifiable",["UWA/Core","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueBoolean"],function(e,t,r,i,n){"use strict";return t.extend({init:function(){this._parent(),this._properties=new Map},BuildProperty:function(e,t,n){return new r(new i(e,i.EBehaviorType.Singleton),new t(n))},Build:function(){this._parent();let e=[this.BuildProperty("VCXPlayManager.progressiveLoading",n,!1),this.BuildProperty("VCXPlayManager.showActionBar",n,!1),this.BuildProperty("VCXPlayManager.immersiveNav",n,!0),this.BuildProperty("VCXPlayManager.showScenePanel",n,!1),this.BuildProperty("VCXPlayManager.showPropertiesPanel",n,!1),this.BuildProperty("VCXPlayManager.showAssemblyPanel",n,!1),this.BuildProperty("VCXPlayManager.showDressupPanel",n,!1),this.BuildProperty("VCXPlayManager.showSelection",n,!1),this.BuildProperty("VCXPlayManager.showPreHighlight",n,!0),this.BuildProperty("VCXPlayManager.showPreHighlightOnlyInteractiveActor",n,!0),this.BuildProperty("VCXPlayManager.showCanvas",n,!1),this.BuildProperty("VCXPlayManager.showPlayStopButton",n,!0),this.BuildProperty("VCXPlayManager.autoPlay",n,!1),this.BuildProperty("VCXPlayManager.showBlackBorderPreview",n,!0),this.BuildProperty("VCXPlayManager.showRobot",n,!1),this.BuildProperty("VCXPlayManager.showAuthoringTooltip",n,!1)];this.BuildProperties(e)},BuildProperties:function(e){for(let t of e)this._properties.set(t.GetPropertyInfo().GetPropertyName(),t),this.OnChangeProperty(t.GetPropertyInfo().GetPropertyName(),t.GetPropertyValue())},OnChangeProperty:function(e,t,r){if(r||(r={}),r.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;let i=this._properties.get(e);return i?(i.SetPropertyValue(t),!0):(r.fromChildClass=!0,this._parent(e,t,r))},OnChangePropertiesEnd:function(){},GetProperty:function(e){let t=this._properties.get(e);return t?new r(t.GetPropertyInfo(),t.GetPropertyValue()):(vcxproperty=this._parent(e),vcxproperty)},GetPropertyValue:function(e){let t=this.GetProperty(e);if(!t)throw new Error("Illegal Property");return t.GetPropertyValue().GetValue()},GetProperties:function(){var e=this._parent();for(let t of Array.from(this._properties.keys()))e.AddOrModifyProperty(this.GetProperty(t));return e}})}),define("DS/VCXWebExperienceBase/VCXERessourceKeyFramerAsset",["require","exports","DS/WebComponentModeler/WebExtensionBase"],function(e,t,r){"use strict";return class extends r{async getURL(){let e=this.QueryInterface("CATI3DXKeyframerResourceAsset");if(!e)throw new Error("Invalid extension");return await e.getKey()}async updateAsset(e,t){var r,i=(null===(r=this.GetObject())||void 0===r?void 0:r._experienceBase.getManager("VCXContextManager").getRootComponent()).QueryInterface("CATICXPResourcesMgr");await i.UpdateURLResource(this,e)}}}),define("DS/VCXWebExperienceBase/VCXModifiableViewOccurrenceExperience",["DS/VCXWebModifiablesImpl/VCXModifiableViewOccurrence","DS/VCXWebProperties/VCXPropertyGroup","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,r){"use strict";return e.extend({init:function(){this._parent()},getPropertyGroups:function(e){e||(e={}),this._parent(e);var i=this.getGroupPropertiesOrders();e["Group.Actions"]||(e["Group.Actions"]=new t({groupID:"Group.Actions"}),e["Group.Actions"].i18nGroup=r),e["Group.Actions"].setPropertiesOrder(i["Group.Actions"]),e["Group.Actions"].priority=50,e["Group.Actions"].addProperty({propertyName:"Actor.Hyperlink",i18n:r});var n=this.GetObject().QueryInterface("VCXIPulseBehavior");return n&&n.getPropertyGroups(e),e},getGroupPropertiesOrders:function(){var e={"Group.Actions":["Actor.Hyperlink"]},t=this.GetObject().QueryInterface("VCXIPulseBehavior");t&&(e["Group.Effect"]=t.getGroupPropertiesOrders());var r=this._parent()||{};for(const t in e)r[t]=e[t];return r}})}),require(["DS/VCXWebExperienceBase/VCXWebBaseKernelTools"],function(e){}),define("DS/VCXWebExperienceBase/VCXExperienceBase",["DS/WebApplicationBase/WebApplicationBase","DS/VCXWebExperienceBase/VCXBaseDictionary","DS/VCXWebKernelCommands/VCXCmdChangeComponent"],function(e,t,r){"use strict";var i=e.extend({init:function(){this._parent()},initialize:async function(e){await this.AddDictionaryDescription(t.GetDictionary()),e&&(e._experienceBase=this,e.addDictionaries&&await e.addDictionaries());var i=this.Factory.BuildComponent("VCXCommandManager");i.SetID("VCXCommandManagerID"),i.SetPersistency(1),this._ManagerSet.addManager("VCXCommandManager",i);var n=this.Factory.BuildComponent("VCXScenarioManager");n.SetID("VCXScenarioManagerID"),n.SetPersistency(1),this._ManagerSet.addManager("VCXScenarioManager",n);var a=this.Factory.BuildComponent("VCXDocManager");a.SetID("VCXDocManagerID"),a.SetPersistency(1),this._ManagerSet.addManager("VCXDocManager",a);var o=this.Factory.BuildComponent("VCXContextManager");o.SetID("VCXContextManagerID"),o.SetPersistency(1),this._ManagerSet.addManager("VCXContextManager",o);var s=this.Factory.BuildComponent("VCXMetaPropertyManager");s.SetID("VCXMetaPropertyManagerID"),s.SetPersistency(1),this._ManagerSet.addManager("VCXMetaPropertyManager",s);var c=this.Factory.BuildComponent("VCXLinkedPropertyManager");c.SetID("VCXLinkedPropertyManagerID"),c.SetPersistency(1),this._ManagerSet.addManager("VCXLinkedPropertyManager",c);var l=this.Factory.BuildComponent("VCXUnitManager");l.SetID("VCXUnitManagerID"),l.SetPersistency(1),this._ManagerSet.addManager("VCXUnitManager",l);var p=this.Factory.BuildComponent("VCXModelChangeListener");p.SetID("VCXModelChangeListenerID"),p.SetPersistency(1),this._ManagerSet.addManager("VCXModelChangeListener",p);var u=this.Factory.BuildComponent("VCXSequenceManager");u.SetID("VCXSequenceManagerID"),u.SetPersistency(1),this._ManagerSet.addManager("VCXSequenceManager",u);var d=new r(this.getManager("VCXCommandManager"),this.ComponentsMap);d.AddComponents([i,n,a,o,s,c,u]),this.getManager("VCXCommandManager").Do(d),this._bModifiablesAdvancedProperties=!1},Clean:function(){this._parent()}});return Object.defineProperty(i.prototype,"ModifiablesAdvancedProperties",{enumerable:!0,get:function(){return this._bModifiablesAdvancedProperties},set:function(e){this._bModifiablesAdvancedProperties=e}}),Object.defineProperty(i.prototype,"isValid",{enumerable:!0,get:function(){return this._ManagerSet&&this._ManagerSet._loopReady}}),i}),define("DS/VCXWebExperienceBase/VCXDocManager",["DS/CoreEvents/Events","UWA/Class","DS/VCXWebProperties/VCXPropertyValuePath","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueLink","DS/VCXWebProperties/VCXPropertyValueDocId","DS/VCXWebProperties/VCXPropertyValueHyperlinkId","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebKernelCommands/VCXCmdChangeNeutralProperties"],function(e,t,r,i,n,a,o,s,c,l){"use strict";var p=t.extend({initialize:function(){this._map=[],this._defaultImageIdx=-1,this.actorDocManager=null,this._initializingResMan=!1,this._promisesMap={},this._unInitialize=!1},_addUrl:function(e,t){var o=new r,s=0;if(-1!=e.search("KeyFramer://")&&(e=e.substring("KeyFramer://".length)),-1!=e.search("play://"))s=0;else if(-1!=e.search("scenario://"))s=0;else if(-1!=e.search("GoToScenario://")){s=1;var l=e.substring("GoToScenario://".length);(p=new a).SetValue(l),o.SetValueLink(p),e=""}else if(-1!=e.search("PlayFromMarker://")){s=2;l=e.substring("PlayFromMarker://".length);(p=new a).SetValue(l),o.SetValueLink(p),e=""}else if(-1!=e.search("PlayScenario://")){s=2;l=e.substring("PlayScenario://".length);(p=new a).SetValue(l),o.SetValueLink(p),e=""}else if(-1!=e.search("GoToMarker://")){s=3;l=e.substring("GoToMarker://".length);(p=new a).SetValue(l),o.SetValueLink(p),e=""}else if(-1!=e.search("PlayUntilMaker://[Current position]"))s=4,e="[Current position]";else if(-1!=e.search("PlayMakerSequence://")){s=4;l=e.substring("PlayMakerSequence://".length);(p=new a).SetValue(l),o.SetValueLink(p),e=""}else if(-1!=e.search("PlayScenarioUntilMaker://")){s=4;var p;l=e.substring("PlayScenarioUntilMaker://".length);(p=new a).SetValue(l),o.SetValueLink(p),e=""}var u=new i;u.SetValue(s),o.SetPathType(u);var d=new c;d.SetValue(!0),o.SetValueBool(d);var h=new n;h.SetValue(e),o.SetValueURL(h),this.AddOrModifyDoc(o,void 0,parseInt(t))},addResourcesFromResManager:async function(e){const t=e.QueryInterface("CATI3DExperienceObject");if(!t)throw new Error("ERROR : CATI3DExperienceObject for resource");{const r=t.GetValueByName("_varName");if(isNaN(parseInt(r)))return;let i=e.QueryInterface("VCXIRessourceAsset");if(!i)throw new Error("Illegal Argument");const n=await i.getURL();this._addUrl(n,r)}},initFromResourcesManager:async function(){this._initializingResMan=!0,console.log("Initialization of DocManager from ResourceManager");var e=[],t=this._experienceBase.getManager("VCXContextManager").getRootComponent().QueryInterface("CATICXPResourcesMgr");if(t){var r=t.ListResources();console.log("NbRes in ResManager :"+r.length);for(var i=0;i<r.length;i++)e.push(this.addResourcesFromResManager(r[i]))}else console.log("CATICXPResourcesMgr FAILED");await UWA.Promise.allSettled(e),this._initializingResMan=!1},initActorDocManager:async function(){if(!this.actorDocManager&&(console.log("First creation a ActorDocManager"),this._experienceBase.getManager("VCXCAT3DXModelManager")&&!this._experienceBase.getManager("VCXContextManager").IsLocalMode())){var e=this._experienceBase.getManager("VCXContextManager").getRootComponent();if(!e)throw new Error("Missing father experience !");{let t=await this._experienceBase.getManager("VCXCAT3DXModelManager").CreateActor("VCXActorDocManager",void 0,e);if(!t)throw new Error("VCXActorDocManager not built !");this.actorDocManager=t,this.actorDocManager.QueryInterface("VCXIModifiable").GetProperties()}}},unInitialize:function(){this._map=[],this._defaultImageIdx=-1,this._initializingResMan=!1,this._promisesMap={},this._unInitialize=!0},postInitialize:function(){},SetDefaultImageIndex:function(e){this._defaultImageIdx=e},GetDefaultImageIndex:function(){return this._defaultImageIdx},AddOrModifyDoc:function(t,r,i,n){if(null!==t){var a=this.AddOrModifyDocInt(t,r,i,n),s=new o;return s.SetValue(a),e.publish({event:"VCX_DOC_ADDED",data:{docID:a}}),s}console.log("DocManager::AddOrModifyDoc vcxPropPath NULL !!")},AddOrModifyDocInt:function(e,t,r,i){var n=this.HasDocInt(e),a=0;if(n>=0)a=n;else{if(void 0!==r&&r>=0)a=r;else for(;this._map[a];)a++;this._map[a]=e}if(this.actorDocManager)if(this._experienceBase.getManager("VCXContextManager").IsLocalMode()||!this._experienceBase.getManager("VCXContextManager").getUseResourcesManager())this.actorDocManager.AddDocToBase64Map(a,e,t);else if(!this._initializingResMan){if(i)return this.UpdatePersistentResourcesToEMS().then(function(){return a});console.warn("The method AddOrModifyDocInt is ASYNC."),this.UpdatePersistentResourcesToEMS()}return i?UWA.Promise.resolve(a):a},RemoveDocument:function(e){delete this._map[e],this.actorDocManager&&this.actorDocManager.RemoveDocument(e)},AddOrModifyHyperlink:function(t){var r=new s;if(null!==t){var i=this.AddOrModifyDocInt(t);r.SetValue(i),e.publish({event:"VCX_DOC_ADDED",data:{docID:i}})}else r.SetValue(-1);return r},HasDocInt:function(e){for(var t=-1,r=!1,i=0;i<this._map.length&&!r;i++){var n=this._map[i];e&&e.IsEqualTo(n)&&(r=!0,t=i)}return t},GetPropPath:function(e){return this._map[e]},IsEmpty:function(){return!(this._map.length>0)},NumberOfDoc:function(){return this._map.length},BuildPathFromString:function(e,t){if("string"==typeof e){var a=new r,o=new i;o.SetValue(0),a.SetPathType(o);var s=new n;if(s.SetValue(e),a.SetValueURL(s),e.indexOf("blob:")>=0){t||(t="");var c=new n;c.SetValue(t),a.SetFileName(c)}return a}console.log("DocManager: strData is empty !!")},BuildPathFromLink:function(e,t){var n=null;if(!e)return n;var o=new a;o.SetValue(e);var s=new i,c=1;return t&&(c=t),s.SetValue(c),(n=new r).SetPathType(s),n.SetValueLink(o),n},AddFileNameToDoc:function(e,t){if("undefined"!==e&&t){t.indexOf(".")<0&&(t="."+t);var r=e+t,i=this._map[e],a=i.GetFileName();a||(a=new n),a.SetValue(r),i.SetFileName(a)}},GetDocMapClone:function(){var e={};for(var t in this._map)if(this._map.hasOwnProperty(t)){var r=this._map[t];e[t]=r.Clone()}return e},_updateResourceToEMS:async function(e,t){var r=this._experienceBase.getManager("VCXContextManager").getRootComponent().QueryInterface("CATICXPResourcesMgr");if(t.GetValueBool().GetValue()){var i="";t.GetFileName()&&(i=t.GetFileName().GetValue());var n,a=i.split(".").pop();""==a&&(a="jpg"),a=a.toLowerCase();var o=t.GetValueURL().GetValue();if(o.indexOf("blob:")>=0)n="CXPPictureResource_Spec";else{var s=t.GetPathType().GetValue();if(0==s)-1!=(o=t.GetValueURL().GetValue()).search("play://")?o="KeyFramer://"+o:-1!=o.search("scenario://")&&(o="KeyFramer://"+o);else if(1==s)o="KeyFramer://GoToScenario://"+t.GetValueLink().GetValue();else if(2==s){var c=t.GetValueLink().GetValue();(l=this._experienceBase.ComponentsMap.GetComponentFromID(c))?o="VCXComponentMarker"==l.GetType()?"KeyFramer://PlayFromMarker://"+c:"KeyFramer://PlayScenario://"+c:console.log("warning : scenario or marker unknown")}else if(3==s)o="KeyFramer://GoToMarker://"+t.GetValueLink().GetValue();else if(4==s){var l;if(""==(c=t.GetValueLink().GetValue()))o="KeyFramer://PlayUntilMaker://[Current position]";else(l=this._experienceBase.ComponentsMap.GetComponentFromID(c))?o="VCXComponentMarker"==l.GetType()?"KeyFramer://PlayMakerSequence://"+c:"KeyFramer://PlayScenarioUntilMaker://"+c:console.log("warning : scenario or marker unknown")}n=-1!=o.search("KeyFramer://")?"CXPKeyframerResource_Spec":"CXPURLResource_Spec"}var p=e.toString(),u=r.GetResourceByName(p);if(u&&u.GetType()!=n&&(await r.DeleteResource(u),u=null),u){let e=u.QueryInterface("VCXIRessourceAsset");if(!e)throw new Error("Illegal Argument");await e.getURL()!==o&&await e.updateAsset(o,a)}else await this.CreateRessouce(n,p,o,a)}},UpdateResoucesToEMS:async function(e){var t=this.GetPropPath(e);t&&(this._promisesMap[e]=!0,await this._updateResourceToEMS(e,t),delete this._promisesMap[e])},CreateRessouce:async function(e,t,r,i){var n=this._experienceBase.getManager("VCXContextManager").getRootComponent().QueryInterface("CATICXPResourcesMgr");try{switch(e){case"CXPPictureResource_Spec":await n.CreateBinaryResource(t,r,i,!0);break;default:await n.CreateURLResource(t,r)}}catch(r){throw console.log("CreateResource FAIL: "+e+" "+t),r}},RemoveResourcesFromResMan:function(){for(var e=[],t=this._experienceBase.getManager("VCXContextManager").getRootComponent().QueryInterface("CATICXPResourcesMgr"),r=t.ListResources(),i=0;i<r.length;i++){var n=r[i],a=n.QueryInterface("CATI3DExperienceObject");if(a){var o=a.GetValueByName("_varName"),s=parseInt(o);this.GetPropPath(s)||e.push(t.DeleteResource(n))}}return UWA.Promise.allSettled(e)},UpdateResourcesManagerToEMS:async function(){if(this._experienceBase.getManager("VCXContextManager").getRootComponent().QueryInterface("CATICXPResourcesMgr")){console.log("updating resource manager"),await this.RemoveResourcesFromResMan();for(var e=[],t=this.NumberOfDoc(),r=0;r<t;r++)this._promisesMap[r]||e.push(this.UpdateResoucesToEMS(r));return UWA.Promise.allSettled(e)}var i=new Error("No ResourceManager !! CATICXPResourcesMgr failed : check your dictionnary");return console.error(i),UWA.Promise.reject(i)},RemoveActorDocManagerNeutrals:function(){var e=this.actorDocManager;if(e){var t=e.QueryInterface("VCXIModifiable");console.log("capturing neutral properties of actorDocManager"),this._experienceBase.getManager("VCXContextManager").IsLocalMode()||!this._experienceBase.getManager("VCXContextManager").getUseResourcesManager()||this._experienceBase.getManager("VCXScenarioManager").RemoveNeutrals(t.GetHashing());var r=new l(this._experienceBase.getManager("VCXScenarioManager"));r.CaptureNeutralProperties(t),r.Do()}},UpdatePersistentResourcesToEMS:async function(){if(this._experienceBase.getManager("VCXContextManager").getUseResourcesManager()){var e=this.QueryInterface("VCXIReadiness");if(this.updateFunction)return this.updateFunction;this.updateFunction=new Promise(async(e,t)=>{try{if(!this._experienceBase.isValid)return void e();await this.UpdateResourcesManagerToEMS(),this.RemoveActorDocManagerNeutrals()}catch(e){return void t(e)}e()}),e&&e.registerPromise(this.updateFunction),await this.updateFunction,this.updateFunction=null}}});return Object.defineProperty(p.prototype,"componentType",{enumerable:!0,get:function(){return"VCXDocManager"}}),p});__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebExperienceBase/VCXPlayManager",["require","exports","DS/WebApplicationBase/W3AAManager","DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebVisu/VCXModifiablesAccess","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebVisibility/VCXIVisibility"],function(e,t,r,i,n,a,o,s){"use strict";o=__importDefault(o),s=__importDefault(s);class c extends r{constructor(){super(),this._oldPaperVisiblity=!1,this._isPlayMode=!1}initialize(){this._isPlayMode=!1,this._eventPreAdd=i.subscribe({event:"VCX_PREHIGHLIGHT_PREADD"},e=>{if(this._isPlayMode&&this.QueryInterface("VCXIModifiable").GetPropertyValue("VCXPlayManager.showPreHighlightOnlyInteractiveActor")&&e&&Array.isArray(e)){let u=this._experienceBase.getManager("VCXContextManager").getActivePartList(),d=Array.from(e);for(let h=d.length-1;h>=0;h--){let g=!1;var t=d[h].pathElement,r=a.GetModifiableFromPathElement(t,this._experienceBase);if(r){if(u&&u.QueryInterface("VCXIVisibility").GetVisibility()===s.default.EVisState.Visible){var i;if(r._bIsCallout&&r.GetComputedStringProperty)i=r.GetComputedStringProperty("Collab.Text");else{var n=r.GetProperty("Actor.PartList.ID");n&&(i=n.GetPropertyValue().Value)}i&&(g=!0)}if(!g){var o=null;let e=!1;var c=r.GetObject().GetID(),l=null;if(this._experienceBase.getManager("VCXHotspotManager")&&(l=this._experienceBase.getManager("VCXHotspotManager").GetEnabledHotspotFromComponentID(c,!0)),l){o=l.QueryInterface("VCXIModifiable").GetProperty("Actor.Hyperlink").GetPropertyValue().GetValue()}else{var p=r.GetProperty("Actor.Hyperlink").GetPropertyValue().GetValue();o=parseInt(p,10)}o>=0&&(e=!0),e&&(g=!0)}g||e.splice(h,1)}}}})}unInitialize(){this._eventPreAdd&&(i.unsubscribe(this._eventPreAdd),delete this._eventPreAdd)}getInitPhase(){return 1}setPlayMode(e){e!==this._isPlayMode&&(this._isPlayMode=e,this._isPlayMode?this._activatePlayMode():this._deactivatePlayMode())}_activatePlayMode(){this._activateInfraPlayMode(),this._activateGUI(),this.applyOptions()}_deactivatePlayMode(){this._deactivateInfraPlayMode(),this._deactivateGUI()}_activateInfraPlayMode(){var e;this._experienceBase.getManager("VCXVisuManager").setUsableInteractors(!1),this._experienceBase.getManager("VCXHyperlinkManager").setActive(!0),this._experienceBase.getManager("VCXPulseManager").setActive(!0),null===(e=this._experienceBase.getManager("VCXContextualContentManager"))||void 0===e||e.setEnableContextualBar(!1),this._experienceBase.getManager("VCXDressupManager").toggleVisiblityDressupGroup(["MagnetLineID","GridsID"],!1)}applyHighlights(){let e=this._experienceBase,t=e.getManager("VCXContextManager").getMainViewer(),r=e.getManager("VCXPlayManager").QueryInterface("VCXIModifiable");r.GetPropertyValue("VCXPlayManager.showSelection")||e.getManager("VCXSelectionManager").setOverrideStyle(t,!1,{colorEnabled:!1,haloEnabled:!1,outlineEnabled:!1,priority:-100}),r.GetPropertyValue("VCXPlayManager.showPreHighlight")||e.getManager("VCXSelectionManager").setOverrideStyle(t,!0,{colorEnabled:!1,haloEnabled:!1,outlineEnabled:!1,priority:-100})}_deactivateInfraPlayMode(){var e,t,r,i,n;null===(e=this._experienceBase.getManager("VCXVisuManager"))||void 0===e||e.setUsableInteractors(!0),null===(t=this._experienceBase.getManager("VCXHyperlinkManager"))||void 0===t||t.setActive(!1),null===(r=this._experienceBase.getManager("VCXPulseManager"))||void 0===r||r.setActive(!1),this._experienceBase.getManager("VCXContextManager").getMainViewer().setReferenceAxisSystem(!0);let a=this._experienceBase.getManager("VCXContextManager").getMainViewer();this._experienceBase.getManager("VCXSelectionManager").resetOverrideStyle(a,!0),this._experienceBase.getManager("VCXSelectionManager").resetOverrideStyle(a,!1),null===(i=this._experienceBase.getManager("VCXGUIManager"))||void 0===i||i.setTooltipDisplay(!0),null===(n=this._experienceBase.getManager("VCXContextualContentManager"))||void 0===n||n.setEnableContextualBar(!0),this._experienceBase.getManager("VCXDressupManager").toggleVisiblityDressupGroup(["MagnetLineID","GridsID"],!0)}_activateGUI(){let e=this._experienceBase,t=e.getManager("VCXGUIManager");e.getManager("VCXPaperManager").AutoFit=!0,t.updateUsableArea(),t.SetVisibilityPlay(!0)}_deactivateGUI(){let e=this._experienceBase,t=e.getManager("VCXGUIManager"),r=e.getManager("VCXPaperManager");r.AutoFit=!0,t.updateUsableArea(),t.SetVisibilityPlay(!1),r.setPreviewModeStyle(!1),r.setPaperVisibility(this._oldPaperVisiblity)}applyOptions(){let e=this._experienceBase,t=e.getManager("VCXGUIManager"),r=e.getManager("VCXPaperManager");this._oldPaperVisiblity=r.getPaperVisibility();let i=this.GetObject().QueryInterface("VCXIModifiable");r.setPaperVisibility(i.GetPropertyValue("VCXPlayManager.showCanvas")),r.setPreviewModeStyle(i.GetPropertyValue("VCXPlayManager.showBlackBorderPreview")),this._experienceBase.getManager("VCXGUIManager").setTooltipDisplay(i.GetPropertyValue("VCXPlayManager.showAuthoringTooltip")),this._experienceBase.getManager("VCXContextManager").getMainViewer().setReferenceAxisSystem(i.GetPropertyValue("VCXPlayManager.showRobot"));let n=null==t?void 0:t._vcxPlayCtrl;n&&n.setupPlayer();let a=e.getManager("VCXContextManager").getFrameWindow();i.GetPropertyValue("VCXPlayManager.showActionBar")||(t.preDocksHidingConfig||(t.preDocksHidingConfig={}),t.preDocksHidingConfig.actionBar=t.getGUIServices().hideActionBar(a,!0)),this.applyHighlights()}saveProperty(e,t){const r=this._experienceBase.getManager("VCXCommandManager"),i=this._experienceBase.getManager("VCXScenarioManager"),a=new n(i,r);let s=this.GetObject().QueryInterface("VCXIModifiable"),c=s.GetProperty(e);c.SetPropertyValue(new o.default(t)),a.ChangeProperty(s,c),this._experienceBase.getManager("VCXCommandManager").Do(a)}}return Object.defineProperty(c.prototype,"componentType",{enumerable:!0,get:function(){return"VCXPlayManager"}}),c}),define("DS/VCXWebExperienceBase/VCXERessourcePictureAsset",["require","exports","DS/WebComponentModeler/WebExtensionBase"],function(e,t,r){"use strict";return class extends r{async getURL(){let e=this.QueryInterface("CATI3DXPictureResourceAsset");if(!e)throw new Error("Invalid extension");return(await e.getPicture()).src}async updateAsset(e,t){var r,i=(null===(r=this.GetObject())||void 0===r?void 0:r._experienceBase.getManager("VCXContextManager").getRootComponent()).QueryInterface("CATICXPResourcesMgr");try{await i.UpdateBinaryResource(this,e,t,!0)}catch(e){console.log(e)}}}}),define("DS/VCXWebExperienceBase/VCXERessourceURLAsset",["require","exports","DS/WebComponentModeler/WebExtensionBase"],function(e,t,r){"use strict";return class extends r{async getURL(){let e=this.QueryInterface("CATI3DXURLResourceAsset");if(!e)throw new Error("Invalid extension");return await e.getURL()}async updateAsset(e,t){var r,i=(null===(r=this.GetObject())||void 0===r?void 0:r._experienceBase.getManager("VCXContextManager").getRootComponent()).QueryInterface("CATICXPResourcesMgr");await i.UpdateURLResource(this,e)}}}),define("DS/VCXWebExperienceBase/VCXContextManager",["DS/CoreEvents/Events","UWA/Class","DS/Visualization/Node3D","DS/WebappsUtils/WebappsUtils","DS/SceneGraphOverrides/SceneGraphOverrideSet","DS/Visualization/PathElement"],function(e,t,r,i,n,a){"use strict";var o=t.extend({init:function(){this._showRoomMode=!1,this._playerMode=!1,this._openSMG=!1,this._openSMGXML=!1,this._prodHighMode=!1,this._ExperienceIn3DPlay=!1,this._ExperienceInGuidedTour=!1,this._ExperienceInConnectedPlayer=!1,this.useTraverseGraph=!1,this._trapSelectionPick=null,this._trapSelectionPrePick=null,this.setSupported("DisplayUI",!0),this.setSupported("DisplayUIAssemblyPanel",!0),this.setSupported("DisplayUIDressupsPanel",!0),this.setSupported("DisplayUIScenariosPanel",!0),this.setSupported("DisplayUIPropertiesPanel",!0),this.setSupported("DisplayUIPlay",!1),this.setSupported("SceneControlV2",!1),this.setSupported("VCXMaterialPanel",!1),this.setSupported("VCXAmbiencePanel",!1),this.setSupported("Paper",!0),this.setSupported("PaperControlV2",!1),this.setSupported("PropertyPanelV2",!0),this.setSupported("Section",!1),this.setSupported("CameraDisplay",!0),this.setSupported("EnvironmentDisplay",!0),this.setSupported("ViewpointCamera",!1),this.setSupported("Paths",!1),this.setSupported("DisplayPaperCtrlBtns",!0),this.setSupported("FrameUnboxing",!1),this.setSupported("SimpleTapContextualMenu",!1),this.setSupported("PropAndScnPanelExpandOverride",!1),this.setSupported("ScenarioPanelExpand",!0),this.setSupported("PropertiesPanelExpand",!0),this._rootInfos={componentType:"VCXWebComponentOccurrence",productType:"Reference3D",name:"Experience",id:"VCX_Root"},this._openProduct=!1,this._openAmbience=!1,this._openMaterial=!1,this._simulatePlayMode=!1,this._applicationMode=o.EApplicationMode.FILE,this.InitApplicationMode()},initialize:function(){this._nRootNode=null,this._nPartsNode=null,this.viewers=[],this._UseOverrideSet=!0,this.getUseResourcesManager()||widget.setTitle("!!! NO RESOURCES MANAGER !!!")},postInitialize:function(){delete this._activeCamera,delete this._activeGround,delete this._activeViewport,delete this._currentWorkingRoot,delete this._activeBOM,delete this._activePartList;var e=this.getMainViewer();e&&("boolean"!=typeof this._trapSelectionPick&&e.picking&&(this._trapSelectionPick=Boolean(e.picking.trapSelection)),"boolean"!=typeof this._trapSelectionPrePick&&e.pPicking&&(this._trapSelectionPrePick=Boolean(e.pPicking.trapSelection))),this.InitEventListeners(),this.traverseGraphMustBePerformed=!0},getUpdatePriority:function(){return-8},unInitialize:function(){if(this._SharedSceneGraphOverrideSet){var e=this.getMainViewer();if(e)e.getSceneGraphOverrideSetManager().removeSceneGraphOverrideSet(this._SharedSceneGraphOverrideSet);e.clearScene(),this._SharedSceneGraphOverrideSet=null}if(this.UnInitEventListeners(),this._nRootNode&&(this.isSupported("3DSync")||this._experienceBase.getManager("VCXContextManager").getMainViewer().removeNode(this._nRootNode),this._nRootNode=null,this._nPartsNode=null,this._pRootPathElement=null),this._currentWorkingRoot=null,this._activeCamera=null,this._activeGround=null,this._activeBOM=null,this._activePartList=null,this._activeViewport=null,this._cRootComponent){var t=this._cRootComponent.QueryInterface("VCXIModelNavigable");t&&t.clear(),this._cRootComponent=null}this._playerMode=!1,this._openSMG=!1,this._openSMGXML=!1,this._prodHighMode=!1,this._showRoomMode=!1,this._ExperienceIn3DPlay=!1,this._ExperienceInConnectedPlayer=!1,this._trapSelectionPick=null,this._trapSelectionPrePick=null},isErrorTolerantMode:function(){var e=this.getUrlVars("ErrorTolerantMode");return void 0===e||"false"!==e},getUrlVars:function(e){return o.getUrlVars(e)},useOverrideSet:function(e){this._UseOverrideSet=e},setPlayerMode:function(){this._playerMode=!0},getPlayerMode:function(){return this._playerMode},setOpenSMG:function(){this._openSMG=!0},getOpenSMG:function(){return this._openSMG},setOpenSMGXML:function(){this._openSMGXML=!0},getOpenSMGXML:function(){return this._openSMGXML},setSmgXmlRoot:function(e){this._smgXmlRoot=e},getSmgXmlRoot:function(){return this._smgXmlRoot},setProdHighMode:function(){this._prodHighMode=!0},getProdHighMode:function(){return this._prodHighMode},setSimulatePlayMode:function(){this._simulatePlayMode=!0,console.log("SET SIMULATE PLAY!")},getSimulatePlayMode:function(){return this._simulatePlayMode},setTrapSelectionRequirements:function(e){e&&("boolean"==typeof e.pick&&(this._trapSelectionPick=e.pick),"boolean"==typeof e.prePick&&(this._trapSelectionPrePick=e.prePick))},getTrapSelectionRequirements:function(){return{pick:this._trapSelectionPick,prePick:this._trapSelectionPrePick}},setExperienceIn3DPlay:function(){this._ExperienceIn3DPlay=!0},getExperienceIn3DPlay:function(){return this._ExperienceIn3DPlay},setExperienceInGuidedTour:function(){this._ExperienceInGuidedTour=!0},getExperienceInGuidedTour:function(){return this._ExperienceInGuidedTour},setExperienceInConnectedPlayer:function(){this._ExperienceInConnectedPlayer=!0},getExperienceInConnectedPlayer:function(){return this._ExperienceInConnectedPlayer},getIfStanAlonePlayerIsInDevMode:function(){var e=!1;return!this._ExperienceInConnectedPlayer&&this._ExperienceIn3DPlay&&"true"===localStorage.getItem("DS_Composer_Player_Standalone_DevMode")&&(e=!0),e},InitEventListeners:function(){this.event_VCX_PROPERTIES_CHANGED=e.subscribe({event:"VCX_PROPERTIES_CHANGED"},e=>{this.renderAll()}),this.event_VCX_MODIFIABLE_CHANGED=e.subscribe({event:"VCX_MODIFIABLE_CHANGED"},()=>{this.renderAll({updateInfinitePlane:!0})}),this._animStarted=(()=>{this._experienceBase.getManager("VCXVisuManager").hideDecorations("Transition",this.getMainViewer()),this.applyToViewers(function(e){e.setGroundShadowAutomaticUpdate(!1)})}),this._animStopped=(()=>{this.applyToViewers(function(e){e.setGroundShadowAutomaticUpdate(!0)}),this._experienceBase.getManager("VCXVisuManager").showDecorations("Transition",this.getMainViewer()),this.renderAll({updateInfinitePlane:!0})}),this.event_VCX_BEGIN_TRANSITION=e.subscribe({event:"VCX_BEGIN_TRANSITION"},this._animStarted),this.event_VCX_START_PLAY=e.subscribe({event:"VCX_START_PLAY"},this._animStarted),this.event_VCX_END_TRANSITION=e.subscribe({event:"VCX_END_TRANSITION"},this._animStopped),this.event_VCX_STOP_PLAY=e.subscribe({event:"VCX_STOP_PLAY"},this._animStopped),this.event_VCX_PAUSE_PLAY=e.subscribe({event:"VCX_PAUSE_PLAY"},this._animStopped)},setShowRoomMode:function(){this._showRoomMode=!0},getShowRoomMode:function(){return this._showRoomMode},UnInitEventListeners:function(){e.unsubscribe(this.event_VCX_PROPERTIES_CHANGED),delete this.event_VCX_PROPERTIES_CHANGED,e.unsubscribe(this.event_VCX_MODIFIABLE_CHANGED),delete this.event_VCX_MODIFIABLE_CHANGED,e.unsubscribe(this.event_VCX_BEGIN_TRANSITION),delete this.event_VCX_BEGIN_TRANSITION,e.unsubscribe(this.event_VCX_START_PLAY),delete this.event_VCX_START_PLAY,e.unsubscribe(this.event_VCX_END_TRANSITION),delete this.event_VCX_END_TRANSITION,e.unsubscribe(this.event_VCX_STOP_PLAY),delete this.event_VCX_STOP_PLAY,e.unsubscribe(this.event_VCX_PAUSE_PLAY),delete this.event_VCX_PAUSE_PLAY,delete this._animStopped,delete this._animStarted},setFrameWindow:function(e){void 0===this.frameWindow&&(this.frameWindow=e),this.addViewer("MainViewer",this.getMainViewer())},getFrameWindow:function(){return this.frameWindow},getContext:function(){return this.getFrameWindow()&&this.getFrameWindow().options&&this.getFrameWindow().options.context},getUIFrame:function(){return this.getFrameWindow().getUIFrame()},getViewers:function(){return this.viewers},addViewer:function(t,r){r.viewerID=t,this.viewers||(this.viewers=[]),this.viewers.push(r),e.publish({event:"VCX_VIEWER_ADDED",data:{viewer:r}})},removeViewer:function(t){for(var r=0;r<this.viewers.length;r++)if(this.viewers[r].viewerID===t)return e.publish({event:"VCX_VIEWER_BEFORE_REMOVED",data:{viewer:this.viewers[r]}}),this.viewers[r]=null,void this.viewers.splice(r,1)},applyToViewers:function(e){if(e)for(var t=0;t<this.viewers.length;t++)e(this.viewers[t])},getMainViewer:function(){return this.frameWindow?this.frameWindow.getViewer():null},setActiveCamera:function(e){this._activeCamera=e},getActiveCamera:function(){if(this._activeCamera||null===this._activeCamera)return this._activeCamera;var e=this._experienceBase.ComponentsMap.GetComponentFromType("CXPCameraActor_Spec");if(e&&e.length>0)return this._activeCamera=e[0],e[0];var t=this._experienceBase.ComponentsMap.GetComponentFromType("VCXWebComponentCamera");return t&&t.length>0?(this._activeCamera=t[0],t[0]):void 0},setActiveViewport:function(e){this._activeViewport=e},getActiveViewport:function(){if(this._activeViewport||null===this._activeViewport)return this._activeViewport;var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXViewport_Spec");return e&&e.length>0?(this._activeViewport=e[0],this._activeViewport):null},setActiveGround:function(e){this._activeGround=e},getActiveGround:function(){return this._activeGround},setActivePartList:function(e){this._activePartList=e},getActivePartList:function(){if(this._activePartList||null===this._activePartList)return this._activePartList;var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXPartList_Spec");return e&&1===e.length&&(this._activePartList=e[0]),this._activePartList},setActiveBOM:function(e){this._activeBOM=e},getActiveBOM:function(){if(this._activeBOM||null===this._activeBOM)return this._activeBOM;var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXBOM_Spec");return e&&1===e.length&&(this._activeBOM=e[0]),this._activeBOM},getActionBar:function(){return this.frameWindow.getActionBar()},setRootNode:function(e){if(!this._nRootNode||!e||this._nRootNode.id!==e.id){if(this._nRootNode=e,this._SharedSceneGraphOverrideSet){var t=this.getMainViewer();if(t)t.getSceneGraphOverrideSetManager().removeSceneGraphOverrideSet(this._SharedSceneGraphOverrideSet);this._SharedSceneGraphOverrideSet=null}if(this.getRootComponent()){var r=this.getRootComponent().QueryInterface("W3AISGNodeHolder");r&&(this._pRootPathElement=new a([this._nRootNode]),r.setPathElement(this._pRootPathElement))}}},getRootComponent:function(){if(!this._cRootComponent){var t,r=this.getRootComponentType();if(this._cRootComponent=this._experienceBase.Factory.BuildComponent(r),this._cRootComponent)this._cRootComponent.SetPersistency(0),this._cRootComponent.SetID("VCX_Root"),(t=this._cRootComponent.QueryInterface("VCXIModelNavigable")).setWorkingRoot(t),this._currentWorkingRoot||(this._currentWorkingRoot=t),this._experienceBase.ComponentsMap.AddComponent(this._cRootComponent),e.publish({event:"VCX_ROOT_COMPONENT_CREATED",data:{RootComponent:this._cRootComponent}}),this.getRootNode()}return this._cRootComponent},getRootComponentName:function(){var e=null,t=this.getRootComponent();if(!t)return e;for(var r=t.QueryInterface("VCXIModelNavigable").getChildren(),i=0;i<r.length;++i){var n=t.QueryInterface("VCXIModelNavigable").getChildren()[i];if(n){var a=n.QueryInterface("VCXIModifiable");if(a){var o=a.GetProperty("Actor.AssetID");if(o){var s=o.GetPropertyValue().Value;if(s&&s.lastIndexOf(".")>0){var c=s.lastIndexOf(".");e=s.substr(0,c);break}}}}}return e},getRootComponentType:function(){return this._rootInfos.componentType},getRootNode:function(){if(!this._nRootNode){var e=new r;e.productType=this._rootInfos.productType,e.name=this._rootInfos.name,e.VCX_ROOT_ID=this._rootInfos.id,this.getMainViewer().addNode(e),this.setRootNode(e)}return this._nRootNode},getRootPathElement:function(){return this._pRootPathElement||this.getRootNode(),this._pRootPathElement},_extractModuleFromUrl:function(e){return e.split("/")[0]},_loadCssRessource:function(e,t){for(var r=document.getElementsByTagName("head")[0],n=r.getElementsByTagName("link"),a=null,o=0;o<n.length;o++)if((a=n[o]).href.search(e)>-1)return void(a.disabled=!1);(a=document.createElement("link")).type="text/css",a.rel="stylesheet",a.href=void 0===t?e:i.getWebappsBaseUrl()+e,r.appendChild(a)},loadCssFile:function(e,t){var r=this._extractModuleFromUrl(e);this._loadCssRessource(e,t);var i=r+"/"+r+".css";i!==e&&this._loadCssRessource(i,t)},unloadCssFile:function(e){var t=this._extractModuleFromUrl(e);this._unloadCssRessource(e);var r=t+"/"+t+".css";r!==e&&this._unloadCssRessource(r)},_unloadCssRessource:function(e){for(var t=document.getElementsByTagName("head")[0].getElementsByTagName("link"),r=0;r<t.length;r++){var i=t[r];if(i.href.search(e)>-1)return void(i.disabled=!0)}},renderAll:function(e){this.applyToViewers(function(t){t.render(e)})},setAllViewerSensitive:function(e){var t=this._experienceBase.getManager("VCXPaperManager");this.applyToViewers(function(r){r.setManipulators({activated:e,preActivate:e}),r.currentViewpoint.setControlActive({viewpoint:e,picking:e}),t&&(t.Lock=!e)})},takeReleaseControlActive:function(e){e||(e=this.getMainViewer()),this.setAllViewerSensitive(!1),e.setManipulators({activated:!0,preActivate:!0}),e.currentViewpoint.setControlActive({viewpoint:!0,picking:!0})},getSharedSceneGraphOverrideSet:function(){if(this._UseOverrideSet&&!this._SharedSceneGraphOverrideSet){var e=this.getRootNode(),t=this.getMainViewer();if(e&&t){let r=void 0;widget.enopadViewer&&(r="rootBag"),this._SharedSceneGraphOverrideSet=new n(e,r),t.getSceneGraphOverrideSetManager().pushSceneGraphOverrideSet(this._SharedSceneGraphOverrideSet)}}return this._SharedSceneGraphOverrideSet},getSharedSceneGraphOverride:function(e,t){let r;if(e){var i=this.getSharedSceneGraphOverrideSet();if(i)if(e&&e.ids){const n=i.getOverridesFromIdPath(e);(r=n&&n[0])||void 0!==t&&!t||(r=i.createIdPathOverride(e))}else(r=i.getUniqueOverrideFromPathElement(e))||void 0!==t&&!t||(r=i.createOverride(e))}return r},update:function(e){if(this._parent(e),this.traverseGraphMustBePerformed&&this.useTraverseGraph){var t=this.getRootComponent();t&&t.TraverseGraph&&(t.TraverseGraph(null,null,null,0),this.traverseGraphMustBePerformed=!1),this.odtPerfo||this.renderAll()}this.odtPerfo&&this.renderAll()},postUpdate:function(e){this._parent(e),this.partHasMoved=!1},zoomFitAll:function(){this.applyToViewers(function(e){e.currentViewpoint.reframe(null,0)})},setRootOptions:function(e){var t={componentType:!0,productType:!0,name:!0,id:!0};for(var r in e)e.hasOwnProperty(r)&&t[r]&&(this._rootInfos[r]=e[r])},CheckInputFile:function(e,t){var r={supported:!0};if(this._experienceBase.getManager("VCXCAT3DXModelManager")){var i=this.GetApplicationMode();e||0===i?e&&0===i&&(r.supported=!1,r.message="Feature not supported: open file from collabspace (file mode)."):t&&this.isSupported("Import3DXML")&&"3dxml"===t[0]||(r.supported=!1,r.message="Feature not supported: open file from disk.")}else e&&(r.supported=!1,r.message="Feature not supported: open file from collabspace (file mode).");return r},CheckInputExtension:function(e){var t={supported:!0},r=this.getProdHighMode(),i=this.getPlayerMode(),n=this.getExperienceIn3DPlay();return"smgxml"!==e&&"smg"!==e&&"smgs"!==e&&"smggeom"!==e&&"3dxml"!==e&&"json"!==e&&"exprd"!==e||r||i||n||(t.supported=!1,t.message="Extension not supported in CityIllustration."),"tga"===e&&(t.supported=!1,t.message="Feature not supported: creation of 2D panel with TGA image"),t},isSupported:function(e){let t=this.getUrlVars("_ForceSupportedFeature_");if(t){if("1"===this.getUrlVars(e)||"true"===this.getUrlVars(e))return!0;if("0"===this.getUrlVars(e)||"false"===this.getUrlVars(e))return!1}if(null!==(t=localStorage.getItem(e))){if("1"===t||"true"===t)return!0;if("0"===t||"false"===t)return!1}return!!this._supportedFeatures&&this._supportedFeatures[e]},setSupported:function(e,t){this._supportedFeatures||(this._supportedFeatures={}),this._supportedFeatures[e]=void 0===t||t},getCat3DXIntegration:function(){return this.isSupported("Cat3DXIntegration")},SetApplicationMode:function(e){this._applicationMode=e},GetApplicationMode:function(){return null===this._applicationMode&&console.warn("Application mode is missing."),this._applicationMode},getUseResourcesManager:function(){var e=this.getUrlVars("resManager");return void 0===e||"false"!==e||(console.log("! ========== WARNING : Resources Manager desactivated ======== !"),console.log("! ========== WARNING : Resources Manager desactivated ======== !"),console.log("! ========== WARNING : Resources Manager desactivated ======== !"),!1)},InitApplicationMode:function(){localStorage.setItem("EWS_AuthoringV2","true"),"true"===localStorage.getItem("EWS_AuthoringV2")?console.log("*** JSONV2 enabled ***"):console.log("*** JSONV2 disabled ***");var e=this.getUrlVars("file");if(console.log(" window.loading3DXML = "+window.loading3DXML),"undefined"==typeof widget||widget.isLocalMode||e||window.loading3DXML)return this.SetApplicationMode(o.EApplicationMode.FILE),void console.log("APPLICATION MODE: FILE + "+this.GetApplicationMode());this.SetApplicationMode(o.EApplicationMode.EMS),console.log("APPLICATION MODE: EMS + "+this.GetApplicationMode())},IsLocalMode:function(){return this.GetApplicationMode()===o.EApplicationMode.FILE},IsEMSMode:function(){return this.GetApplicationMode()===o.EApplicationMode.EMS}});return o.getUrlVars=function(e){if(e&&o._UrlVars)return o._UrlVars[e];var t,r={},i={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,t,i){r[t]=decodeURIComponent(i)});return r.widgetDomain?t=r.widgetDomain:r.uwaUrl&&(t=r.uwaUrl),t?t.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,t,r){i[t]=r}):i=r,e?(o._UrlVars=i||null,i[e]):i},o.EApplicationMode={FILE:0,EMS:1},Object.defineProperty(o.prototype,"componentType",{enumerable:!0,get:function(){return"VCXContextManager"}}),o}),define("DS/VCXWebExperienceBase/VCXModifiableOccurrenceExperience",["DS/VCXWebModifiablesImpl/VCXModifiableOccurrence","DS/VCXWebVisu/VCXModifiablesAccess","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueHyperlinkId","DS/VCXWebProperties/VCXPropertyValueEnum","DS/WebComponentModeler/WebComponentBase","i18n!DS/VCXWebExperienceBase/assets/nls/VCXWebExperienceBase"],function(e,t,r,i,n,a,o,s,c,l){"use strict";return e.extend({init:function(){this._parent(),this._requestedHyperlinkID=-1},OnChangeProperty:function(e,t,r){if(r||(r={}),r.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;const i=this.GetObject();if(i.IsKindOf("VCXVolatileComponentOccurrenceComposer")&&i.GetPersistency()===c.EPersistencyType.notPersistent&&!i.isRegisteredToPersistent()){let r=!0;"Actor.Visibility.Opacity"===e&&(r=!1),"Actor.Visibility"!==e||t.GetValue()||(r=!1),r&&i.registerToPersistent()}switch(e){case"Actor.Hyperlink":var n=t.GetValue();return void 0!==n&&(this._requestedHyperlinkID=n),!0;case"Actor.ToolTip":var a=t.GetValue();return i.tooltip!==a&&(i.tooltip=a),!0;case"Actor.Freeze":var o=t.GetValue();return void 0!==o&&(i.eFreeze=o),!0;default:var s=!1,l=i.QueryInterface("VCXIPulseBehavior");return l&&(s=l.OnChangeProperty(e,t,r)),!!s||(r.fromChildClass=!0,this._parent(e,t,r))}return!1},OnChangePropertiesEnd:function(){let e=this.GetObject();if(e.hyperlinkID!==this._requestedHyperlinkID){e.hyperlinkID=this._requestedHyperlinkID;var t=e._experienceBase.getManager("VCXHyperlinkManager");t&&(e.hyperlinkID>=0?t.RegisterInteractableObject(this.GetObject()):t.UnRegisterInteractableObject(this.GetObject()))}return this._parent()},GetProperty:function(e){var c=null;if("Actor.Hyperlink"===e){var p=this.GetObject(),u=new o;u.SetValue(p.hyperlinkID),(M=new i(e,0,!0,l)).SetGroupId("Group.Actions"),c=new r(M,u)}else if("Actor.ToolTip"===e){p=this.GetObject();(V=new a).SetValue(p.tooltip),(c=new r(new i(e,0,!0,l),V)).GetPropertyInfo().IsVisible()&&c.GetPropertyInfo().SetVisible(!1)}else if(e.endsWith("._ComputedText")){var d=e.substring(0,e.length-"._ComputedText".length),h=this.GetProperty(d),g="";if(h){var C=h.GetPropertyValue().ToString();C&&(g=t.ValuateLinkedProperties(C,this.GetObject()._experienceBase,this.GetObject().GetID(),this.GetObject().GetID(),null))}var V=new a(g),M=new i(d,1,!1);c=new r(M,V)}else if("Actor.Freeze"===e){p=this.GetObject();var f=new s;f.SetValue(p.eFreeze);var y=new n(e,1,!1,l);y.AddOrModifyChoice(0,"Freeze.NoFreeze"),y.AddOrModifyChoice(1,"Freeze.Freeze"),y.AddOrModifyChoice(2,"Freeze.FreezeInPlay"),c=new r(y,f)}else{var _=this.GetObject().QueryInterface("VCXIPulseBehavior");_&&(c=_.GetProperty(e))}return c||(c=this._parent(e)),c},GetProperties:function(e){var t=this._parent();t.AddOrModifyProperty(this.GetProperty("Actor.ToolTip")),t.AddOrModifyProperty(this.GetProperty("Actor.Hyperlink"));var r=this.GetObject().QueryInterface("VCXIPulseBehavior");return r&&r.GetProperties(t),t}})}),define("DS/VCXWebExperienceBase/VCXInteractableObjectsManager",["UWA/Class","DS/VCXWebModifiablesServices/VCXModifiablesServices","DS/VCXWebModifiables/VCXModelChangeListener","DS/VCXWebVisibility/VCXIVisibility"],function(e,t,r,i){"use strict";var n=e.extend({initialize:function(){this._registredInteractableObjects=[],this._bActiveInteraction=!1,this._dirty=!1,this._sorted=!1},GetActiveInteraction:function(){if(this._experienceBase.getManager("VCXModelChangeListener")&&this._dirty){this._dirty=!1,this._sorted=!1,this._bActiveInteraction=!1;for(var e=0;e<this._registredInteractableObjects.length;e++){var t=this._experienceBase.ComponentsMap.GetComponentFromID(this._registredInteractableObjects[e]);if(t)if("VCXComponentHotspot"===t.GetType()){if(t.QueryInterface("VCXIModifiable").GetProperty("Actor.Enable").GetPropertyValue().GetValue()){this._bActiveInteraction=!0;break}}else{var r=t.QueryInterface("VCXIVisibility");if(r&&r.GetVisibility()!==i.EVisState.Hidden){var n=t.QueryInterface("VCXIModifiable").GetProperty("Actor.Opacity");if(n&&n.GetPropertyValue()&&n.GetPropertyValue().Value){this._bActiveInteraction=!0;break}}}}}return this._bActiveInteraction},update:function(e){var t=this._experienceBase.getManager("VCXModelChangeListener");t&&t.hasChanged(r.FChangeFlag.Visibility)&&(this._sorted=!1,this._dirty=!0)},RegisterInteractableObject:function(e){this._registredInteractableObjects.push(e.GetID()),this._sorted=!1,this._dirty=!0},UnRegisterInteractableObject:function(e){var t=this._registredInteractableObjects.indexOf(e.GetID());t>-1&&(this._registredInteractableObjects.splice(t,1),this._dirty=!0)},GetSortedInteractableObjects:function(){return this._sorted||(this._registredInteractableObjects=t.sortListDisplayPriority(this._experienceBase,this._registredInteractableObjects),this._sorted=!0),this._registredInteractableObjects}});return Object.defineProperty(n.prototype,"componentType",{enumerable:!0,get:function(){return"VCXInteractableObjectsManager"}}),n}),define("DS/VCXWebExperienceBase/VCXHyperlinkManagerBase",["DS/VCXWebExperienceBase/VCXInteractableObjectsManager","DS/VisuEvents/EventsManager","DS/VCXWebVisu/VCXModifiablesAccess"],function(e,t,r){"use strict";var i=e.extend({init:function(){this._strEventToListen=""},initialize:function(){this._parent()},postInitialize:function(){var e=this;this.onVisuEvent=function(t){if(e.GetActiveInteraction()){var i=r.GetModifiableFromEvent(t,e._experienceBase);if(i){var n=i.GetObject().GetID();e._experienceBase.getManager("VCXAPIManager").ActivateHyperlink(n)}}},this._strEventToListen&&t.addEvent(this._experienceBase.getManager("VCXContextManager").getMainViewer().div,this._strEventToListen,this.onVisuEvent)},unInitialize:function(){this._parent(),t.removeEvent(this._experienceBase.getManager("VCXContextManager").getMainViewer().div,this._strEventToListen,this.onVisuEvent),this._strEventToListen=""},OpenHyperlink:function(e){},_getHyperlinkInfos:function(e){var t=null;e&&(t=this._getPropertyPathFromModifiable(e));var r={};return t&&(r=this._getHyperlinkInfosFromProperty(t)),r},_getPropertyPathFromModifiable:function(e){if(e){var t=null,r=-1,i=e.GetProperty("Actor.Hyperlink"),n=!1;if(i){var a=i.GetPropertyValue();(r=parseInt(a.GetValue(),10))>=0&&(n=!0)}if(n){var o=this._experienceBase.getManager("VCXDocManager");o&&(t=o.GetPropPath(r))}return t}},_getHyperlinkInfosFromProperty:function(e){var t={},r=-1;e&&(r=e.GetPathType().GetValue());0===r&&(t={url:e.GetValueURL().GetValue(),filename:e.GetFileName().GetValue()});return t},BuildPropertyForHyperlink:function(e,t){var r=-1,i="";t.indexOf("blob:")<0?r=0:i=t.toLowerCase(),i.indexOf("http")>=0&&(r=0);var n=!1;if(0===r){n=!0;var a=this._experienceBase.getManager("VCXDocManager").BuildPathFromString(t,"");t=this._experienceBase.getManager("VCXDocManager").AddOrModifyHyperlink(a).GetValue()}return n||(t=e.GetProperty("Actor.Hyperlink").GetPropertyValue().GetValue()),t}});return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXHyperlinkManagerBase"}}),i}),define("DS/VCXWebExperienceBase/VCXModifiableOccurrenceExt",["DS/VCXWebExperienceBase/VCXModifiableOccurrenceExperience","DS/VCXWebComponents/VCXWebComponentOccurrence","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueFloat","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueBoolean","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,r,i,n,a,o,s,c,l){"use strict";return e.extend({OnChangeProperty:function(e,t,r){if(r||(r={}),r.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;switch(e){case"Actor.LayerOpacity":this.GetObject().layerOpacity=t.GetValue();break;case"Actor.Rendering":this.GetObject().renderingMode=t.GetValue();break;case"Actor.Priority":this.GetObject().priority=t.GetValue();break;default:return r.fromChildClass=!0,this._parent(e,t,r)}return!0},OnChangePropertiesEnd:function(){var e=this.GetObject();if(e.getDirtyFlag(t.FDirty.Priority)){var r=e._experienceBase.getManager("VCXVisuManager");r&&r.dirtifyRenderPriority()}return this._parent()},GetProperty:function(e){var s=null;if("Actor.LayerOpacity"===e){var c=this.GetObject().layerOpacity,p=new o;p.SetValue(c),(g=new i(e,0,!0,l)).SetBounds(0,1,.1),g.SetGroupId("Group.CustomRendering"),s=new r(g,p)}else if("Actor.Rendering"===e){var u=this.GetObject()._experienceBase.getManager("VCXContextManager"),d=this.GetObject().renderingMode,h=new a;h.SetValue(d),(g=new n(e,0,!0,l)).AddOrModifyChoice(t.ERenderingMode.Smooth,"Actor.Rendering.Smooth"),g.AddOrModifyChoice(t.ERenderingMode.SmoothOutline,"Actor.Rendering.SmoothOutline"),u.isSupported("3DSync")||(g.AddOrModifyChoice(t.ERenderingMode.Technical,"Actor.Rendering.Technical"),g.AddOrModifyChoice(t.ERenderingMode.FlatTechnical,"Actor.Rendering.FlatTechnical")),g.AddOrModifyChoice(t.ERenderingMode.Silhouette,"Actor.Rendering.Silhouette"),g.SetGroupId("Group.CustomRendering"),s=new r(g,h)}else if("Actor.Priority"===e){var g,C=this.GetObject().priority,V=new a;V.SetValue(C),(g=new n(e,0,!0,l)).AddOrModifyChoice(0,"Actor.Priority.VeryLow"),g.AddOrModifyChoice(1,"Actor.Priority.Low"),g.AddOrModifyChoice(2,"Actor.Priority.Normal"),g.AddOrModifyChoice(3,"Actor.Priority.High"),g.AddOrModifyChoice(4,"Actor.Priority.VeryHigh"),g.SetGroupId("Group.CustomRendering"),s=new r(g,V)}else s=this._parent(e);return s},GetProperties:function(e){var t=this._parent();return t.AddOrModifyProperty(this.GetProperty("Actor.LayerOpacity")),t.AddOrModifyProperty(this.GetProperty("Actor.Rendering")),t.AddOrModifyProperty(this.GetProperty("Actor.Priority")),t},getPropertiesFormatPainter:function(){var e=this.GetProperties(),t=[];if(e)for(var r in e._map)"Actor.Position"!=r&&"Actor.Name"!=r&&"Actor.Name.ReferenceTitle"!=r&&t.push(r);return t},RequestModification:function(e,t){if(e){const n=e.GetPropertyInfo().GetPropertyName();if("Actor.Name"===n&&""===e.GetPropertyValue().GetValue().trim()){var r=this.GetProperty("Actor.Name"),i=new s;let n=this.GetProperty("Actor.Name.ReferenceTitle").GetPropertyValue().GetValue(),a=this.GetProperty("Actor.Name.InstanceTitle").GetPropertyValue().GetValue();return""===a.trim()?i.Value=n:i.Value=n+" ("+a+")",r.SetPropertyValue(i),t.AddOrModifyProperty(this.GetHashing(),r),this._parent(e,t)}if("Actor.Color"===n){if((r=this.GetProperty("Actor.Color.Defined"))&&!1===r.GetPropertyValue().Value)(i=new c).Value=!0,r.SetPropertyValue(i);return t.AddOrModifyProperty(this.GetHashing(),r),t.AddOrModifyProperty(this.GetHashing(),e),this._parent(e,t)}if("Actor.Opacity"===n){if((r=this.GetProperty("Actor.Opacity.Defined"))&&!1===r.GetPropertyValue().Value)(i=new c).Value=!0,r.SetPropertyValue(i);return t.AddOrModifyProperty(this.GetHashing(),r),t.AddOrModifyProperty(this.GetHashing(),e),this._parent(e,t)}}return this._parent(e,t)}})}),define("DS/VCXWebExperienceBase/VCXModifiableViewOccurrenceExt",["DS/VCXWebExperienceBase/VCXModifiableViewOccurrenceExperience","DS/VCXWebProperties/VCXPropertyGroup","DS/VCXWebComponents/VCXWebComponentOccurrence","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,r,i){"use strict";return e.extend({getPropertyGroups:function(e){e||(e={}),this._parent(e);var n=this.getGroupPropertiesOrders();e["Group.CustomRendering"]||(e["Group.CustomRendering"]=new t({groupID:"Group.CustomRendering"}),e["Group.CustomRendering"].i18nGroup=i),e["Group.CustomRendering"].setPropertiesOrder(n["Group.CustomRendering"]),e["Group.CustomRendering"].priority=60;var a={};a[r.ERenderingMode.Smooth]="Actor.Rendering.Smooth",a[r.ERenderingMode.SmoothOutline]="Actor.Rendering.SmoothOutline",a[r.ERenderingMode.Technical]="Actor.Rendering.Technical",a[r.ERenderingMode.FlatTechnical]="Actor.Rendering.FlatTechnical",a[r.ERenderingMode.Silhouette]="Actor.Rendering.Silhouette",e["Group.CustomRendering"].addProperties([{propertyName:"Actor.LayerOpacity",i18n:i},{propertyName:"Actor.Rendering",i18n:i,mapChoiceEnum:a},{propertyName:"Actor.Priority",i18n:i,mapChoiceEnum:{0:"Actor.Priority.VeryLow",1:"Actor.Priority.Low",2:"Actor.Priority.Normal",3:"Actor.Priority.High",4:"Actor.Priority.VeryHigh"}}])},getGroupPropertiesOrders:function(){var e=this._parent()||{};return UWA.extend(e,{"Group.CustomRendering":["Actor.Rendering","Actor.Priority","Actor.LayerOpacity"]}),e},getCollapsedGroupsNames:function(){return this._parent().concat(["Group.CustomRendering"])}})});__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebExperienceBase/VCXComponentOccurrenceExt",["require","exports","DS/VCXWebVisu/VCXVisuTools","DS/VCXWebExperienceBase/VCXComponentOccurrenceExperience","DS/VCXWebComponents/VCXWebComponentOccurrence"],function(e,t,r,i,n){"use strict";r=__importDefault(r),i=__importDefault(i);class a extends i.default{constructor(){super(),this._renderingMode=0,this._layerOpacity=.5,this._priority=2,this._localMaterial=null,this._globalMaterial=null,this.localColorIsDefined=null}descriptionDump(){var e=function(e){return e&&{name:e.name,type:e.getType&&e.getType(),subType:e.getSubType&&e.getSubType()}},t=function(e){return e&&{faceMode:e._faceMode,mask:e._renderMode&&e._renderMode._mask,outlineWidth:e._renderMode&&e._renderMode._outlineWidth,renderLineMask:e._renderMode&&e._renderMode._useRenderLineMask,renderFaceMask:e._renderMode&&e._renderMode._useRenderFaceMask,renderPointMask:e._renderMode&&e._renderMode._useRenderPointMask}},i=this._experienceBase.getManager("VCXContextManager"),n=i&&i.getMainViewer(),a=r.default.buildGraphicPropertiesStructure(this,n,{getAll:!0});return a[0].objectName=a[0].object.name,delete a[0].object,delete a[0].pathElement,a[0].cad&&a[0].cad.Material&&(a[0].cad.Material=e(a[0].cad.Material)),a[0].visible&&a[0].visible.Material&&(a[0].visible.Material=e(a[0].visible.Material)),a[0].override&&a[0].override.Material&&(a[0].override.Material=e(a[0].override.Material)),a[0].cad&&a[0].cad.RenderStyle&&(a[0].cad.RenderStyle=t(a[0].cad.RenderStyle)),a[0].visible&&a[0].visible.RenderStyle&&(a[0].visible.RenderStyle=t(a[0].visible.RenderStyle)),a[0].override&&a[0].override.RenderStyle&&(a[0].override.RenderStyle=t(a[0].override.RenderStyle)),a[0]}set layerOpacity(e){this._layerOpacity!==e&&(this._layerOpacity=e,this._dirtyMask|=n.default.FDirty.LayerOpacity)}get layerOpacity(){return this._layerOpacity}set renderingMode(e){this._renderingMode!==e&&(this._renderingMode=e,this._dirtyMask|=n.default.FDirty.RenderingMode|n.default.FDirty.Priority)}get renderingMode(){return this._renderingMode}set priority(e){this._priority!==e&&(this._priority=e,this._dirtyMask|=n.default.FDirty.Priority)}get priority(){return this._priority}set localMaterial(e){this._localMaterial=e,this._dirtyMask|=n.default.FDirty.Material|n.default.FDirty.Color|n.default.FDirty.Alpha}get localMaterial(){return this._localMaterial}get globalMaterial(){return this._globalMaterial}}return(n=__importDefault(n)).default.addDirtyFlags(["LayerOpacity","RenderingMode","Priority","Material"]),Object.defineProperty(a.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentOccurrenceExt"}}),a}),define("DS/VCXWebExperienceBase/VCXOverridesChangeServices",["DS/Visualization/ThreeJS_DS","DS/VCXWebExperienceBase/VCXPathElementTools","DS/VCXWebExperienceBase/VCXSceneGraphOverridesServices"],function(e,t,r){"use strict";return{Ghost:function(e,i,n,a,o,s){var c=!1;let l;if(!(l=i?[i]:t.getMesh3dPathElements(n,["Instance3D"])))return!1;void 0===a&&(a=!0),a&&void 0===o&&(o=.1),void 0===s&&(s=2);for(var p=0;p<l.length;++p){var u=r.getSceneGraphOverride(e,i,l[p]);u&&(c=!0,a&&u.setOpacity(o,!0),1===s?u.setPickability("PICKABLE"):2===s&&u.setPickability("IGNORED"))}return c},UnGhost:function(e,i,n){let a;if(!(a=i?[i]:t.getMesh3dPathElements(n,["Instance3D"])))return!1;for(var o=0;o<a.length;++o){var s=r.getSceneGraphOverride(e,i,a[o]);s&&e.deleteOverride(s)}}}});