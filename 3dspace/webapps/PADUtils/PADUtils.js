/*!  COPYRIGHT DASSAULT SYSTEMES 2015   */
define("DS/PADUtils/views/PADDropInvit_disabled",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Options"],function(e,t,n){"use strict";return t.extend(n,{name:"pad_invite",active_invite:"",init:function(e){},show:function(e){this.active_invite=e},hide:function(e){this.active_invite=""}})}),define("DS/PADUtils/PADClipboard",["UWA/Class","UWA/Class/Events","DS/Logger/Logger"],function(e,t,n){"use strict";var i=n.getLogger("DS/PADUtils/PADClipboard"),s={OBJECT:null,POSITION:null},o=e.extend(t,{init:function(){this._parent();var e=this;document&&document.addEventListener&&document.addEventListener("keyup",function(t){27===t.keyCode&&(i.log("Clear the Clipboard"),e.clear())})},_checkpageAndThrow:function(e){if(i.debug('Checking if "%s" is a valid page',e),!s.hasOwnProperty(e))throw i.error("Check failed"),new Error('"'+e+'" is not a valid page')},setData:function(e,t){i.info('Setting data in page "%s"',e),i.debug("  Data %o",t),this._checkpageAndThrow(e),this.dispatchEvent("pre_setData",arguments),s[e]=UWA.clone(t),this.dispatchEvent("post_setData",arguments)},getData:function(e){return i.info('Getting data in page "%s"',e),this._checkpageAndThrow(e),UWA.clone(s[e])},consumeData:function(e,t){i.info('Consuming data in page "%s"',e);var n=this.getData(e);return t&&this.clear(e),n},clear:function(e){if(e)i.info('Clearing clipboard page "%s"',e),this._checkpageAndThrow(e),this.dispatchEvent("pre_clear",arguments),s[e]=void 0;else for(var t in i.info("Clearing clipboard"),this.dispatchEvent("pre_clear",arguments),s)s.hasOwnProperty(t)&&(s[t]=void 0);this.dispatchEvent("post_clear",arguments)},isEmpty:function(e){if(e){if(this._checkpageAndThrow(e),s[e])return!1}else for(var t in s)if(s.hasOwnProperty(t)&&s[t])return!1;return!0}}).singleton({init:function(){this._parent()}});for(var a in s)s.hasOwnProperty(a)&&(o[a]=a);return o}),define("DS/PADUtils/Configuration",["text!DS/PADUtils/assets/GlobalConfiguration.json","UWA/Core","UWA/Class"],function(e,t,n){"use strict";var i=JSON.parse(e);return n.singleton({notFlagInit:!0,initialize:function(e){this.notFlagInit&&(this.notFlagInit=!1,window.__karma__&&window.__karma__.config.json&&window.__karma__.config.json.Configuration&&this.mergeConfig(window.__karma__.config.json.Configuration))},getConfig:function(e){return this.initialize(),!!i.settings[e]&&i.settings[e].value},mergeConfig:function(e){i=t.extend(i,e,!0)},getWebAPIOptions:function(e){return i.webapiDefaults[e]?t.clone(i.webapiDefaults[e],!0):{}}})}),define("DS/PADUtils/views/PADColorPicker",["DS/PADServices/views/private/ColorPicker"],function(e){"use strict";return console.warn("DS/PADUtils/views/PADColorPicker is a private component"),e}),define("DS/PADUtils/PADIndexedDb",["UWA/Core","UWA/Class"],function(e,t){"use strict";return t.singleton({name:"PADIndexedDb",userStore:"user",scStore:"sc",_dbName:"eno_apps_2021x",_db:null,_version:1,_storeNames:["user","sc"],_keyPath:"id",_columns:{user:["id","dashboards","activeDashboard","preferredSC","timestamp"],sc:["id","userId","dashboardId","activeSC","timestamp"]},init:function(t){var n,i;t=t||{},this._parent(t);let s=this;e.is(s._db)||(this.dbReady=new Promise(e=>{(n=indexedDB.open(s._dbName,s._version)).onupgradeneeded=function(e){s._db=e.target.result,s._storeNames.forEach(function(e){i=s._db.createObjectStore(e,{keyPath:s._keyPath}),s._columns[e].forEach(function(e){i.createIndex(e,e,{unique:"id"===e})})})},n.onsuccess=function(t){s._db=t.target.result,e()},n.onerror=function(e){console.log("no db error",e.target.errorCode)}}))},isReady:function(){return this.dbReady},get:function(t){var n;e.is(this._db)&&((n=this._db.transaction([t.storeName]).objectStore(t.storeName).get(t.id)).onsuccess=function(n){e.is(n.target.result)?e.is(t.foundCallback)&&t.foundCallback(n.target.result):e.is(t.notFoundCallback)&&t.notFoundCallback({msg:"no data found"})},n.onerror=function(n){console.log("error",n.target.errorCode),e.is(t.notFoundCallback)&&t.notFoundCallback({msg:"no data"})})},put:function(t){var n,i;n={id:t.id,timestamp:Date.now()},t.hasOwnProperty("dashboards")&&(n.dashboards=t.dashboards),t.hasOwnProperty("activeDashboard")&&(n.activeDashboard=t.activeDashboard),t.hasOwnProperty("userId")&&(n.userId=t.userId),t.hasOwnProperty("dashboardId")&&(n.dashboardId=t.dashboardId),t.hasOwnProperty("activeSC")&&(n.activeSC=t.activeSC),t.hasOwnProperty("preferredSC")&&(n.preferredSC=t.preferredSC),e.is(this._db)&&((i=this._db.transaction([t.storeName],"readwrite").objectStore(t.storeName).put(n)).onsuccess=function(n){e.is(t.callback)&&t.callback(n.target.result)},i.onerror=function(n){console.log("put error",n.target.errorCode),e.is(t.callback)&&t.callback(n.target.errorCode)})},getUser:function(e){e.storeName||(e.storeName=this.userStore),this.get(e)},addUser:function(e){e.storeName||(e.storeName=this.userStore),this.put(e)},getSC:function(e){e.storeName||(e.storeName=this.scStore),this.get(e)},addSC:function(e){let t=this;e.storeName||(e.storeName=t.scStore),t.put(e)},updateUser:function(t){var n=this;if(e.is(n._db)){t.storeName||(t.storeName=n.userStore);var i=n._db.transaction([t.storeName],"readwrite").objectStore(t.storeName),s=i.get(t.id);s.onerror=function(e){console.log("error in get User data to update")},s.onsuccess=function(s){var o=s.target.result;if(o){t.hasOwnProperty("dashboards")&&(o.dashboards=t.dashboards),t.hasOwnProperty("activeDashboard")&&(o.activeDashboard=t.activeDashboard),t.hasOwnProperty("preferedSC")&&(o.preferedSC=t.preferedSC),o.timestamp=Date.now();var a=i.put(o);a.onerror=function(e){console.warn("update user error")},a.onsuccess=function(n){e.is(t.callback,"function")&&t.callback(n.target.result)}}else n.addUser(t)}}}})}),define("DS/PADUtils/views/PADTenantMgt",["css!DS/UIKIT/UIKIT","css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Class/Events","UWA/Controls/Abstract","DS/UIKIT/Modal","DS/Controls/Button","DS/UIKIT/Tooltip"],function(e,t,n,i,s,o,a,r){return s.extend(i,{name:"PadTenantMgt",_command_id:"",init:function(e){var t=this;this._parent(e),e.renderTo||(e.renderTo=document.body);var i=UWA.createElement("div",{class:"padcustomizeview_instruction",content:n.platformChangeMsg}),s=UWA.createElement("div",{class:"footerModal"});changeButton=new a({label:n.change,emphasize:"primary",touchMode:!0,onClick:function(){t.options.currentTenant.isClearView=!0,t.options.callback(t.options.currentTenant),t.modal.hide(),t.modal.destroy()}}),changeButton.inject(s),new a({label:n.cancel,touchMode:!0,onClick:function(){t.options.currentTenant.isMultiTenant=!0,t.options.callback(t.options.currentTenant),t.modal.hide(),t.modal.destroy()}}).inject(s),this.modal=new o({className:"padtenantmgt",closable:!0,visible:!0,header:n.platformChangeTitle,body:i,footer:s}).inject(e.renderTo)}})}),define("DS/PADUtils/views/PADDropInvit",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options"],function(e,t,n,i,s){"use strict";return i.extend(s,{name:"pad_invite",available_invite:{drop:{fonticon:"down-circled",nls:"drop"},add:{fonticon:"plus-circled",nls:"add"},insert:{fonticon:"plus-circled",nls:"insert"},find:{fonticon:"search",nls:"find"}},active_invite:"drop",init:function(e){for(var n in this._parent(e),this.elements.container=UWA.createElement("div",{class:this.getClassNames("_container")}),this.available_invite)this.available_invite.hasOwnProperty(n)&&(this.elements.container[n]=UWA.createElement("div",{class:this.getClassNames("_display "+n),draggable:!1}),UWA.createElement("span",{class:this.getClassNames("_img fonticon fonticon-3x fonticon-"+this.available_invite[n].fonticon)}).inject(this.elements.container[n]),UWA.createElement("h5",{class:this.getClassNames("_txt font-3dsregular "+n),text:t["PADDropInvit_"+this.available_invite[n].nls]}).inject(this.elements.container[n]),this.elements.container[n].inject(this.elements.container),this.active_invite!==n&&this.elements.container[n].hide());this.getOption("renderTo")&&this.elements.container.inject(this.getOption("renderTo"))},show:function(e){this.active_invite!=e&&(UWA.is(e,"string")?(this.active_invite!==e&&""!=this.active_invite&&this.elements.container[this.active_invite].hide(),this.active_invite=e):this.active_invite="drop",this.elements.container[this.active_invite].show(),this.elements.container.show())},hide:function(e){UWA.is(e,"string")?""!=this.active_invite&&this.active_invite===e&&(this.elements.container[this.active_invite].hide(),this.elements.container.hide()):""!=this.active_invite&&(this.elements.container[this.active_invite].hide(),this.elements.container.hide()),this.active_invite=""}})}),define("DS/PADUtils/views/PADDropTooltip",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events"],function(e,t,n,i,s,o){"use strict";return i.extend(s,o,{name:"paddrop_tooltip",defaultOptions:{tooltips:{add_in_context:{nls:"add_in_context",icon:"plus"},add_as_object:{nls:"add_as_object",icon:"plus"},insert:{nls:"insert",icon:"plus"},find:{icon:"search",nls:"find"}}},_active_tooltip:null,_isDisplayed:!1,_fonticon:null,_label:null,init:function(e){this._parent(e),this.elements.container=UWA.createElement("div",{class:"padutils_dropTooltip wux-afr-contextual-bar"});var t=UWA.createElement("table",{class:"enopad3Dviewer_dropTooltip_table"}).inject(this.elements.container).insertRow(0);this._fonticon=t.insertCell(0),this._label=t.insertCell(1),this._fonticon.appendChild(UWA.createElement("span",{class:"padutils_dropTooltip_ftIcon wux-ui-3ds wux-ui-3ds-plus"})),this._label.appendChild(UWA.createElement("div",{class:"wux-afr-label"}))},show:function(e){var n=this.elements.container.getDimensions(),i=n.width,s=n.height,o=this.getOption("renderTo");if(!this._isDisplayed&&o&&(this.elements.container.inject(o),this._isDisplayed=!0),e.intent!==this._active_tooltip){for(;this._fonticon.firstChild;)this._fonticon.removeChild(this._fonticon.firstChild);this._fonticon.appendChild(UWA.createElement("span",{class:"padutils_dropTooltip_ftIcon wux-ui-3ds wux-ui-3ds-"+this.options.tooltips[e.intent].icon})),this._label.textContent=t["PADDropInvit_"+this.options.tooltips[e.intent].nls],this._active_tooltip=e.intent}o.clientWidth<=i+e.x+15?this.elements.container.setStyles({left:o.clientWidth-i}):this.elements.container.setStyles({left:e.x+15}),o.clientHeight<=s+e.y+25?this.elements.container.setStyles({top:o.clientHeight-s}):this.elements.container.setStyles({top:e.y+25+"px"})},hide:function(){var e=this.getOption("renderTo");this._isDisplayed&&e&&(e.removeChild(this.elements.container),this._isDisplayed=!1)}})}),define("DS/PADUtils/PADPredicatesNls",["UWA/Core","UWA/Class","UWA/Class/Options","DS/PADServices/utils/DictionaryAccess"],function(e,t,n,i){"use strict";return t.singleton(n,{init:function(){this._nlsManager=i},updateColumnsWithNLS:function(e,t){this._nlsManager&&this._nlsManager.updateColumnsWithNLS(e,t)},updateNLS:function(e){this._nlsManager&&this._nlsManager.updateNLS(e)}})}),define("DS/PADUtils/views/PADProgressBar",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","DS/Controls/Loader","DS/Controls/Button"],function(e,t,n,i,s,o,a){"use strict";return i.singleton(s,{name:"pad_progressBar",_UILoader:null,_counter:0,_offTimeout:null,_onTimeout:null,_isCustomTextDisplayed:!1,_defaultText:"",_customText:"",_buttonCB:null,init:function(e){this._parent(e),this._defaultText=t.PADProgressBar_loading,this.elements.container=UWA.createElement("div",{class:"topBarContainer"}),this.render(e),this.elements.viewContainer=UWA.createElement("div",{class:"progressBarContainer"}).inject(this.elements.container),this._UILoader=new o({fadeDuration:0,showButtonFlag:!1}).inject(this.elements.viewContainer),this._button=new a({label:t.PADProgressBar_cancel,emphasize:"primary"}).inject(this._UILoader.elements.container);var n=this;this._button.elements.container.addClassName("PADProgressBar_cancelButton"),this._button.addEventListener("buttonclick",function(e){n._buttonCB&&n._buttonCB()}),n.elements.container.hide()},render:function(e){var t=e&&e.renderTo?e.renderTo:document.body;this.elements.container.inject(t)},destroy:function(){this._UILoader&&(this._UILoader.destroy(),delete this._UILoader),this._counter=0,this._offTimeout=null,this._isCustomTextDisplayed=!1,this._text="",this._customText="",this._2sTimeout&&(clearTimeout(this._2sTimeout),this._2sTimeout=null),this._10sTimeout&&(clearTimeout(this._10sTimeout),this._10sTimeout=null),this._parent()},on:function(e,n,i){var s=this;s.elements.container.show(),n?(this._buttonCB=n,this._button.label=void 0!==i?i:t.PADProgressBar_cancel,this._button.show()):this._button.hide(),this._defaultText=e||t.PADProgressBar_loading,this._customText=this._defaultText,this._isCustomTextDisplayed?this._UILoader.text=this._text:this._UILoader.text=this._defaultText,this._counter++,this._offTimeout&&clearTimeout(this._offTimeout),this._2sTimeout||(this._2sTimeout=setTimeout(function(){s.elements.viewContainer.addClassName("progressBarShown"),s._10sTimeout||(s._10sTimeout=setTimeout(function(){s._isCustomTextDisplayed=!0,s._UILoader.text=s._customText},8e3))},2e3)),s._UILoader.on()},off:function(){var e=this;this._counter--,0===this._counter&&(e._offTimeout=setTimeout(function(){e._2sTimeout&&clearTimeout(e._2sTimeout),e._10sTimeout&&clearTimeout(e._10sTimeout),e.elements.viewContainer.removeClassName("progressBarShown"),e._offTimeout=null,e._isCustomTextDisplayed=!1,e._2sTimeout=null,e._10sTimeout=null,e._customText="",e._buttonCB=null,setTimeout(function(){0===e._counter&&(e.elements.container.hide(),e._UILoader.off())},1e3)}))},update:function(e){this._UILoader&&this._UILoader.update(e)},setText:function(e){this._UILoader&&e&&(this._customText=e,this._isCustomTextDisplayed&&(this._UILoader.text=this._customText))}})}),define("DS/PADUtils/views/PADThumbnail",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Class","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger","DS/UIKIT/Modal"],function(e,t,n,i,s,o,a){"use strict";var r=n.extend(i,{name:"padthumbnail",_logger:null,_modal:null,options:{},init:function(e){this._logger=o.getLogger(r),this._logger.log("init"),this._parent(e),this.setOptions(e),e.renderTo||(e.renderTo=document.body);var t=UWA.createElement("div",{class:this.name+"_main",styles:{"background-image":e.cellModel.options?e.cellModel.options.value:"url('"+e.cellModel+"')"}}),n=this;this._modal=new a({className:this.name+"_modal",closable:!1,body:t,visible:!0}),setTimeout(function(){n._modal.elements.container.addEventListener("click",function(e){n._modal.destroy()}),n._modal.elements.content.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),!1}),document.onkeydown=function(e){27===(e=e||window.event).keyCode&&n._modal.destroy()}},500),this._modal.elements.wrapper.setStyle("width","350px"),this._modal.inject(e.renderTo)}});return r}),define("DS/PADUtils/PADCommandProxy",["DS/PADServices/utils/CommandProxy"],function(e){"use strict";return e}),define("DS/PADUtils/views/PADFilterCancel",["css!DS/UIKIT/UIKIT","css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","DS/UIKIT/SuperModal","DS/UIKIT/Input/Button","DS/Utilities/Utils"],function(e,t,n,i,s,o,a,r,l){return s.extend(o,{name:"filterCancel",defaultOptions:{},init:function(e){this.cancelModal=new a({className:this.name+"_modal",closable:!0,okButtonText:n.addObject,koButtonText:n.cancel,animate:!0,renderTo:document.body});var t={};t.title=n.filterCancel,t.message=n.filterCancelMessage,t.callback=function(t){e.callback(t)},this.cancelModal.fromProxy=!1,this.cancelModal.confirm(t)}})}),define("DS/PADUtils/views/PADAlert",["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/PADServices/utils/PADTrackerManager"],function(e,t,n){"use strict";return{_notif_manager:null,displayNotification:function(i){null===this._notif_manager&&(this._notif_manager=e,t.setNotificationManager(this._notif_manager),t.setStackingPolicy(5));var s="info";if(UWA.is(i.eventID)&&"primary"!==i.eventID&&(s=i.eventID),this._notif_manager.addNotif({level:s,title:void 0!==i.title?i.title:void 0,subtitle:void 0!==i.subtitle?i.subtitle:void 0,message:i.msg,sticky:!1,allowUnsafeHTML:!1}),"error"===s||"warning"===s){var o=n.getPADTracker({eventCategory:"usage",eventAction:"notification"});o&&(o.setEventData({eventLabel:i.key?i.key:"no-key",eventValue:"error"===s?1:2}),o.trackPageEvent())}},displayAdvancedNotification:function(i){null===this._notif_manager&&(this._notif_manager=e,t.setNotificationManager(this._notif_manager),t.setStackingPolicy(5));var s="info";if(UWA.is(i.eventID)&&"primary"!==i.eventID&&(s=i.eventID),this._notif_manager.addNotif({level:s,title:i.title,subtitle:i.subtitle,message:i.message,sticky:!1,allowUnsafeHTML:!1}),"error"===s||"warning"===s){var o=n.getPADTracker({eventCategory:"usage",eventAction:"notification"});o&&(o.setEventData({eventLabel:i.key?i.key:"no-key",eventValue:"error"===s?1:2}),o.trackPageEvent())}}}}),define("DS/PADUtils/views/PADInstanceMatrix",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Class","UWA/Class/Options","UWA/Drivers/Alone","DS/UIKIT/Modal","DS/Handlebars/Handlebars"],function(e,t,n,i,s,o,a){"use strict";console.warn("PADInstanceMatrix is deprecated. Please don't use it.");var r=a.compile('<div class="positionMatrix">                            <table class="matrix rotation">                                <tr>                                  <td title="{{x1}}">{{x1}}</td>                                  <td title="{{x2}}">{{x2}}</td>                                  <td title="{{x3}}">{{x3}}</td>                                </tr>                                <tr>                                  <td title="{{y1}}">{{y1}}</td>                                  <td title="{{y2}}">{{y2}}</td>                                  <td title="{{y3}}">{{y3}}</td>                                </tr>                                <tr>                                  <td title="{{z1}}">{{z1}}</td>                                  <td title="{{z2}}">{{z2}}</td>                                  <td title="{{z3}}">{{z3}}</td>                                </tr>                            </table>                            <table class="matrix translation">                                <tr>                                  <td title="{{t1}}">{{t1}}</td>                                </tr>                                <tr>                                  <td title="{{t2}}">{{t2}}</td>                                </tr>                                <tr>                                  <td title="{{t3}}">{{t3}}</td>                                </tr>                          </table>                    </div>');return n.extend(i,{name:"padinstancematrix",_modal:null,options:{},init:function(e){var t;this._parent(e),this.setOptions(e),e.renderTo||(e.renderTo=document.body),t=e.cellModel&&e.cellModel.options?e.cellModel.options.value.split(","):e.cellModel.split(",");var n={x1:Number(t[0]).toFixed(16),x2:Number(t[1]).toFixed(16),x3:Number(t[2]).toFixed(16),y1:Number(t[3]).toFixed(16),y2:Number(t[4]).toFixed(16),y3:Number(t[5]).toFixed(16),z1:Number(t[6]).toFixed(16),z2:Number(t[7]).toFixed(16),z3:Number(t[8]).toFixed(16),t1:Number(t[9]).toFixed(16),t2:Number(t[10]).toFixed(16),t3:Number(t[11]).toFixed(16)},i=r(n),s=this;if(this._modal=new o({className:this.name+"_modal",closable:!1,body:i,visible:!0}),e.position&&e.position.top&&e.position.right&&e.position.left&&e.position.bottom){var a=document.body.getBoundingClientRect(),l=a.right-e.position.right,c=a.bottom-e.position.bottom;c>=100&&l>=350?(e.position.left=e.position.left+"px",e.position.top=e.position.top+30+"px",this._modal.elements.wrapper.setStyle("top",e.position.top),this._modal.elements.wrapper.setStyle("left",e.position.left)):c>=100&&l<=350?(e.position.right=l+380-a.right+"px",e.position.top=e.position.top+30+"px",this._modal.elements.wrapper.setStyle("top",e.position.top),this._modal.elements.wrapper.setStyle("right",e.position.right)):c<=100&&l<=350?(e.position.right=l+380-a.right+"px",e.position.bottom=c+160-a.bottom+"px",this._modal.elements.wrapper.setStyle("bottom",e.position.bottom),this._modal.elements.wrapper.setStyle("right",e.position.right)):(e.position.left=e.position.left+20+"px",e.position.bottom=c+160-a.bottom+"px",this._modal.elements.wrapper.setStyle("bottom",e.position.bottom),this._modal.elements.wrapper.setStyle("left",e.position.left))}setTimeout(function(){s._modal.elements.container.addEventListener("click",function(e){s._modal.destroy()}),s._modal.elements.content.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),!1}),document.onkeydown=function(e){27===(e=e||window.event).keyCode&&s._modal.destroy()}},500),this._modal.elements.wrapper.setStyle("width","356px"),this._modal.inject(e.renderTo)}})}),define("DS/PADUtils/PADPromise",["UWA/Promise"],function(e){"use strict";var t=[];return{getPromises:function(){for(var e=[],n=0;n<t.length;n++)t[n].isFulfilled&&t[n].isFulfilled()||e.push(t[n]);return t=e},createPromise:function(t,n,i){var s=new e(t),o=this._makeIntrospectablePromise(s,n);return void 0!==i&&!0!==i||this.getPromises().push(o),o},empty:function(){t=[]},_makeIntrospectablePromise:function(e,t){if(e.isResolved)return e;var n=!0,i=!1,s=!1,o=e.then(function(e){return s=!0,n=!1,e},function(e){return i=!0,n=!1,e});return o.isFulfilled=function(){return s},o.isPending=function(){return n},o.isRejected=function(){return i},o.name=t,o}}}),define("DS/PADUtils/PADContext",["UWA/Class","UWA/Class/Options"],function(e,t){"use strict";return e.singleton(t,{name:"PADContext",init:function(){this._context=null},set:function(e){null===this._context&&(this._context=e)},get:function(e){return null===this._context?void 0===e?null:e:this._context},reset:function(){this._context=null}})}),define("DS/PADUtils/views/PADDropConfirm",["css!DS/UIKIT/UIKIT","css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","DS/UIKIT/SuperModal","DS/UIKIT/Input/Button","DS/Utilities/Utils"],function(e,t,n,i,s,o,a,r,l){return s.extend(o,{name:"dropConfirm",defaultOptions:{},init:function(e){var t={MOVE:n.MOVE_label,COPY:n.COPY_label,Reorder:n.Reorder_label},i={top:n.before_label,bottom:n.after_label},s=t[e.copyMode];e.isOutsideWidget?s=t.COPY:(e.isReordering&&(s=t.Reorder),"COPY"===e.copyMode&&(s=t.COPY));var o=i[e.dropPosition]||"before",r=new a({className:this.name+"_modal",closable:!0,okButtonText:s,koButtonText:n.cancel,animate:!0,renderTo:document.body}),l={};l.title=s,e.isReordering?l.message=n.replace(n.get("confirmation_message_reorder"),{dndMode:s.toLowerCase(),source:e.dropName,position:o,target:e.targetName}):l.message=n.replace(n.get("confirmation_message"),{dndMode:s.toLowerCase(),source:e.dropName,target:e.targetName}),l.callback=function(t){e.callback(t)},r.confirm(l)}})}),define("DS/PADUtils/PADModelEvents",["DS/CoreEvents/ModelEvents"],function(e){console.warn("Deprecated module DS/PADUtils/PADModelEvents use DS/PADServices/utils/GlobalModelEvents");var t=new e;return{getModelEvents:function(){return t},publish:function(e){return t.publish(e)},subscribe:function(e,n){return t.subscribe(e,n)},unsubscribe:function(e){return t.unsubscribe(e)},unsubscribeAll:function(e){return t.unsubscribeAll(e)}}}),define("DS/PADUtils/views/PADLevelSel",["css!DS/PADUtils/PADUtils","css!DS/UIKIT/UIKIT","UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Modal","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/LineEditor","DS/Controls/SpinBox"],function(e,t,n,i,s,o,a,r,l){"use strict";return i.extend({name:"pad_level_sel",defaultOptions:{current_level:1},init:function(e){this._parent(e);var t=this,n=UWA.createElement("div",{class:this.getClassNames()}),i=new l({value:t.options.current_level,minValue:1,stepValue:1,pageStepValue:1,typingFilter:!0,decimals:0}).inject(n);i.getContent().addClassName(this.getClassNames("_spinbox")),this.elements.level_selector=i,i.getContent().addEvent("change",this._updateDownState.bind(this));var o=new a({icon:"check",emphasize:"success"}).inject(n);o.getContent().addClassName(this.getClassNames("_okbtn")),o.getContent().setStyle("width","22px"),i.addEventListener("change",function(e){t.options.current_level=parseInt(e.dsModel.value)}),i.elements.inputField&&i.elements.inputField.addEventListener("keyup",function(e){if(13===e.keyCode){var n=t.options.current_level.toString();t.dispatchEvent("onApply",[n]),d.destroy()}}),o.addEventListener("click",function(){var e=t.options.current_level.toString();t.dispatchEvent("onApply",[e]),d.destroy()});var r,c=UWA.is(e.css_style)?" "+e.css_style:"",d=new s({className:this.getClassNames("_modal")+c,closable:!1,body:n,visible:!0});d.elements.wrapper.setStyle("padding-top","calc("+(r="500px",document.body.scrollHeight>40&&(r=document.body.scrollHeight+"px"),r)+" - 80px)"),d.elements.scrollableContent&&d.elements.scrollableContent.setStyle("width","155px"),d.elements.container.addEventListener("click",function(e){d.destroy()}),d.elements.content.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),!1}),d.inject(document.body),this._updateDownState()},_updateDownState:function(){var e=this.elements.level_selector.value,t=this.elements.level_selector.minValue,n=this.elements.level_selector.elements.down;e<=t?n.addClassName("pad_level_sel_down_arrow_disabled"):n.removeClassName("pad_level_sel_down_arrow_disabled")}})}),define("DS/PADUtils/PADTransactionManager",["UWA/Class","UWA/Class/Events"],function(e,t){"use strict";var n=function(e,t,n){this.getId=function(){return t},this.isNested=function(){return n};var i=this;this.end=function(){e(i)}};return e.extend(t,{_transactionStack:[],startTransaction:function(e){var t=Boolean(this._transactionStack.length>0),i=this;var s=new n(function(e){var t=i._transactionStack.indexOf(e),n=e.getId();if(t<0)throw new Error('This "'+n+'" transaction is not part of the transaction stack, may be it has already been ended');if(t!==i._transactionStack.length-1)throw new Error('Cannot end this "'+n+'" transaction as it is not the innermost transaction');i._transactionStack.pop();var s=e.isNested();i.dispatchEvent("onTransactionEnd",[n,s])},e,t);return this._transactionStack.push(s),t=s.isNested(),this.dispatchEvent("onTransactionStart",[e,t]),s},wrapInTransaction:function(e,t){var n=this.startTransaction(t);try{UWA.is(e,"function")&&e()}finally{n.end()}}})}),define("DS/PADUtils/commands/PADAddRoot_cmd",["DS/ApplicationFrame/Command"],function(e){"use strict";return e.extend({execute:function(e){require(["DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADTypesMgt","DS/PADUtils/views/PADAlert"],function(e,t,n,i,s){for(var o="",a=t.getSetting("authorized_root_types")?t.getSetting("authorized_root_types"):t.getSetting("authorized_types"),r=a.length,l=0;l<r;l++){var c=a[l];o=""===o?o+'type:"'+c+'"':o+' OR type:"'+c+'"'}var d={fts_value:o,callback:function(t){var n=e.get(),i=t.selected_data;n.openDroppedObjects({notifPerObjects:!0,displayNotif:!1,unserializedData:i,broadcast:!0,version:"2.0"})},cancel:function(){}};n.inAppsSearch(d)})}})}),define("DS/PADUtils/commands/PADOpenInCADFromSearch",["text!DS/PADUtils/assets/PADOpenCommandsSettings.json","UWA/Core","UWA/Controls/Abstract","DS/PlatformAPI/PlatformAPI"],function(e,t,n,i){"use strict";return n.extend({name:"PADOpenInCADFromSearch",_compass_socket:null,_role_check_promise:null,_context:null,init:function(e){e&&e.addinmode&&(this._context=e.addinmode)},availableForTypes:function(){var t=[],n=JSON.parse(e);return this._context&&n["openInCAD_"+this._context+"_supported_types"]&&(t=n["openInCAD_"+this._context+"_supported_types"]),t},getActionForObject:function(n,i){if(this._context){var s=this,o=JSON.parse(e);require(["i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(e){var a=[],r=null;if(n.taxonomies){var l=null;if(t.is(n.taxonomies,"string"))l=n.taxonomies;else if(t.is(n.taxonomies,"array"))for(var c=0;c<n.taxonomies.length;c++)if(t.is(n.taxonomies[c],"string")&&0===n.taxonomies[c].indexOf("types/")){l=n.taxonomies[c];break}t.is(l)&&(r=l.split("/"))}else r=[n["ds6w:type_value"]];if(t.is(r,"array"))for(var d=!1,p=r.length-1;p>=0;p--){var u=r[p];if(o["openInCAD_"+s._context+"_supported_types"].indexOf(u)>-1&&!d){a.push({icon:"fonticon fonticon-open",id:s.name,multisel:!1,title:e.PAD_CMDOpenInCAD,callback:s.launchCustoAction.bind(s)}),d=!0;break}}i.call(null,a)})}else i.call(null,[])},launchCustoAction:function(e){i.publish("webinwin:web:notification",JSON.stringify({operation:"open/setObject",operationVersion:"1.0",content:[{phid:e.object_ids[e.object_ids.length-1]}]}))}})}),define("DS/PADUtils/PADWebInWinServices",["UWA/Core","UWA/Class"],function(e,t){"use strict";return t.singleton({_widget:null,_addinmode:null,initialize:function(e){this._widget=e.widget,this._addinmode=this._widget?this._widget.getValue("addinmode"):"undefined"!=typeof widget?widget.getValue("addinmode"):""},isWebInWinContext:function(){return"solidworks"===this._addinmode||"catiav5"===this._addinmode}})}),define("DS/PADUtils/PADSecurityCtxConverter",["UWA/Class","UWA/Promise","DS/PADUtils/views/PADAlert"],function(e,t,n){"use strict";return e.singleton({init:function(e){this._parent(e)},buildSecurityContext:function(e,t,n){return"ctx::"+n+"."+t+"."+e},buildDisplayString:function(e,t,n,i){return i?e+" ● "+n:e+" ● "+t+" ● "+n},extractCouple:function(e){var t="",n="",i="",s="";for(var o in e){var a=e[o];switch(o){case"organization":t=a.name,n=a.title?a.title:t;break;case"role":i=a.name,s=a.nls?a.nls:i}}return{org:t,orgTitle:n,role:i,roleNls:s}},prepareForStorage:function(e){var t,n,i,s="ctx:",o=e.pid,a=[];for(var r in e.preferredcredentials){var l=e.preferredcredentials[r];switch(r){case"collabspace":t=l.name,l.title?l.title:t;break;case"organization":n=l.name;break;case"role":i=l.name}}s=this.buildSecurityContext(t,n,i);for(var c=!1,d=function(e,t){for(var n=[],i=0;i<e.collabspaces.length;i++)for(var s=e.collabspaces[i],o=0;o<s.couples.length;o++){var a=t.extractCouple(s.couples[o]);-1===n.indexOf(a.org)&&n.push(a.org)}return 1===n.length}(e,this),p=0;p<e.collabspaces.length;p++)for(var u=e.collabspaces[p],h=0;h<u.couples.length;h++){var g=this.extractCouple(u.couples[h]),f=this.buildSecurityContext(u.name,g.org,g.role),_=u.title?u.title:u.name,m={csName:_,label:this.buildDisplayString(_,g.orgTitle,g.roleNls,d),value:f};s===f&&(m.isDefault=!0,c=!0),a.push(m)}if(!c&&a.length){var v=a[0];v.isDefault=!0,s=v.value}return a.sort(function(e,t){return e.label<t.label?-1:e.label>t.label?1:0}),{userId:o,securityContext:s,cspaces:a}},getSecurityContext:function(e){var i=e.callback,s=e.tenant,o=this;"undefined"!=typeof widget&&widget.lang;require(["DS/PADUtils/PADWSAccess"],function(e){new t(function(t,i){e.getscandcollab({tenant:s,onComplete:function(e){var n=UWA.is(e,"string")?JSON.parse(e):e,i=o.prepareForStorage(n);t({securityContext:i.securityContext,securityContextList:i.cspaces})},onFailure:function(e,t){var s,o;if(UWA.is(t,"string")&&t.length>0){try{s=JSON.parse(t)}catch(e){o=t}s&&s.error&&s.error.message?n.displayNotification({msg:s.error.message,eventID:"error",key:"padUtils-getSecurityContext-server-error"}):n.displayNotification({msg:o,eventID:"error",key:"padUtils-getSecurityContext-server-error"})}i(e,t)}})}).then(function(e){i(e)}).catch(function(e){i(null)})})},setSecurityContext:function(e){e&&require(["DS/PADUtils/PADUtilsServices"],function(t){var n=t.getPlatformId(),i=JSON.parse(sessionStorage.getItem("PADSecurityCtx_"+n)),s=e.replace("ctx::","");i!==s&&sessionStorage.setItem("PADSecurityCtx_"+n,JSON.stringify(s))})}})}),define("DS/PADUtils/PADSettingsMgt",["text!DS/PADUtils/assets/PADSettingsMgt.json","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Class","UWA/Class/Options","UWA/Class/Events","DS/PADUtils/views/PADAlert","DS/PADUtils/PADContext","DS/PADUtils/views/PADTenantMgt","DS/PADUtils/Configuration","DS/PADServices/utils/GlobalModelEvents","DS/PADServices/utils/WidgetProxy","DS/PADServices/settings/AppSettings"],function(e,t,n,i,s,o,a,r,l,c,d,p,u){"use strict";function h(e,t,n){e.splice(n,0,e.splice(t,1)[0])}function g(e,t){for(var n=0;n<e.length;n++){if(e[n].name===t)return n}return null}const f=1,_=0;var m=function(e){return"true"===e.toLowerCase()},v={widgetDomain:null},S=i.singleton(s,o,{app_context:null,version:"1.0",defaultOptions:{run_options:{},debug_options:{},session_options:{},webapi_options:{},layout_options:{}},with_security_context:!1,init:function(e){this._parent(e),this.setOptions(this.defaultOptions)},destroy:function(){this.app_context=null,this.version="1.0",this.options.run_options={},this.options.debug_options={},this.options.session_options={},this.options.webapi_options={},this.options.layout_options={}},setApp:async function(e,t,n){return new Promise(i=>{var s=n||!1;this.set_app_context(t,s);var o=e;UWA.is(o.common)&&(this.options.debug_options=UWA.is(o.common.debug_options)?o.common.debug_options:this.options.debug_options,this.options.run_options=UWA.is(o.common.run_options)?o.common.run_options:this.options.run_options,this.options.webapi_options=UWA.is(o.common.webapi_options)?o.common.webapi_options:this.options.webapi_options,this.options.layout_options=UWA.is(o.common.layout_options)?o.common.layout_options:this.options.layout_options),UWA.is(t,"string")&&UWA.is(o[t],"object")&&(this.options=UWA.extend(this.options,o[t],!0)),require(["DS/PADServices/settings/AppSettings"],e=>{e.initializeSettings({padsettingsInit:UWA.clone(this.options)}).then(i)})})},set_app_context:function(t,n){var i=JSON.parse(e),s=!UWA.is(n,"boolean")||!n;if(!UWA.is(t,"string"))throw new Error("Invalid app context");this.app_context=t,this.version=i.version,this.options=UWA.extend(this.options,i.common,!0),UWA.is(i[t],"object")&&(this.options=UWA.extend(this.options,i[t],!0)),this.with_security_context=s||!1,!0===this.with_security_context&&(this.options=UWA.extend(i.security_ctx,this.options,!0))},build_preferences:function(e){var t=Object.getOwnPropertyNames(e),n=0,i=[];for(n=0;n<t.length;n++){var s=t[n],o=e[s];if(UWA.is(o.preference,"object")&&!0!==o.notAddedByDefault){var a=!0;if(UWA.is(o.activatedBySetting,"string"))!1===S.getSetting(o.activatedBySetting,!0)&&(a=!1);else if(UWA.is(o.activatedBySetting,"object")){S.getSetting(o.activatedBySetting.name,!0)!==o.activatedBySetting.value&&(a=!1)}else UWA.is(o.activatedByWidgetPreference,"object")&&"undefined"!=typeof widget&&widget.getValue(o.activatedByWidgetPreference.name)&&widget.getValue(o.activatedByWidgetPreference.name)!==o.activatedByWidgetPreference.value&&(a=!1,S.setSetting(s,!1));if(!0===a){var r=UWA.merge({name:s,defaultValue:o.value},o.preference);i.push(r)}}}return i},orderWidgetPreferences:function(){widget&&function(e){for(var t,n,i,s,o,a=e.getPreferences(),r=[],l=!1,c=a.length,d=0;d<c;d++){var p=a[d];"pad_security_ctx"===p.name&&d!==f&&r.push({prop:"pad_security_ctx",from:d,to:f}),"x3dPlatformId"===p.name&&c>1&&(l=!0,d!==_&&r.push({prop:"x3dPlatformId",from:d,to:_}))}if(!l&&r.length){let e={prop:"pad_security_ctx",from:r[0].from,to:_};r.pop(),r.push(e)}if(r.sort(function(e,t){return e.from>t.from?-1:e.from<t.from?1:e.from===t.from?0:void 0}),r.length){for(var u=r.length,m=0;m<u;m++){var v=r[m];0!==m&&(v.from=g(a,v.prop)),u-1===m?(t=a,n=v.from,i=v.to,s=void 0,o=void 0,s=t.splice(n,1)[0],o=t.splice(i,1)[0],t.splice(n,0,o),t.splice(i,0,s)):h(a,v.from,v.to)}e.setPreferences(a)}}(widget)},getWidgetPreferences:function(){var e=[];if(null===this.app_context)throw new Error("Set the app context before using the PADSettingsMgt");if(widget&&(e=e.concat(S.build_preferences(this.options.run_options)),"1"===widget.getValue("debug_me"))){var t=S.build_preferences(this.options.debug_options);e=e.concat(t)}return e},getSpecificWidgetPreference:function(e){if(!UWA.is(e,"string")||0===e.length)throw new Error("getSpecificWidgetPreference: Invalid input parameter");var t=null;if(this.options.run_options.hasOwnProperty(e))t=this.options.run_options[e];else{if(!this.options.debug_options.hasOwnProperty(e))throw console.error("getSpecificWidgetPreference: Unknown setting ["+e+"]"),new Error("getSpecificWidgetPreference: Unknown setting ["+e+"]");t=this.options.debug_options[e]}if(!UWA.is(t.preference,"object"))throw new Error("getSpecificWidgetPreference: setting ["+e+"] has no prefence defined");return[UWA.merge({name:e,defaultValue:t.value},t.preference)]},getSecurityPreferences:function(){if(this.options.run_options.x3dPlatformId&&this.options.run_options.pad_security_ctx)return S.build_preferences({x3dPlatformId:this.options.run_options.x3dPlatformId,pad_security_ctx:this.options.run_options.pad_security_ctx});throw new Error("Invalid call - Security Context hasn't been declared")},updateSecuritySettings:function(e,t,n,i,s){s=void 0===s||s;for(var o,a=-1===n.indexOf("ctx::")?"ctx::"+n:n,r=!1,l=0;l<i.length;l++){var c=i[l];0===l&&(o=c.value),c.value===a&&(r=!0)}r||(a=o),s&&p.addPreference({name:"pad_security_ctx",type:"list",label:"pad_security_ctx",defaultValue:a,options:i}),!0===this._dynamicUpdate?p.dispatchEvent("onEdit"):(S.updateTenantSettings(e,t,s),p.setValue("pad_security_ctx",a),p.setValue("xPref_CREDENTIAL",a.replace("ctx::","")),this.setSetting("pad_security_ctx",a,!0))},updateTenantSettings:function(e,t,n){if(void 0!==window.widget){var i,s,o={name:"x3dPlatformId",type:"list",label:"pad_tenant",defaultValue:e,options:t,onchange:"onPlatformIdChange"};if(1===t.length&&(o.disabled=!0),e&&"OnPremise"!==e)i=!0;else{var a=widget.getValue("x3dPlatformId");a&&"OnPremise"!==a&&(i=!0)}widget.getValue("noCompass")&&(s=!0),s||(i&&n&&widget.addPreference(o),this.orderWidgetPreferences()),widget.setValue("x3dPlatformId",e),this.setSetting("x3dPlatformId",e),widget.setValue("pad_tenant",e),this.setSetting("pad_tenant",e)}else this.setSetting("x3dPlatformId",e),this.setSetting("pad_tenant",e)},updateTenantPreference:function(e){if(null===this.app_context)throw new Error("Set the app context before using the PADSettingsMgt");var n=this,i=r.get();if(i&&UWA.is(i.empty,"function")){var s=!1;UWA.is(i.getPADTreeDocument,"function")?s=0!==i.getPADTreeDocument().getRoots().length:UWA.is(i.getRoots,"function")?s=0!==i.getRoots().length:console.warn("Unknown context");var o=n.getSetting("x3dPlatformId");if(s){var c=n.getSetting("pad_security_ctx");if(o!==e.value)new l({id:"PadTenantMgt",currentTenant:{isMultiTenant:!1,isClearView:!1},callback:function(s){let r=!1;if(s.isClearView)r=!0,i.empty(),n.setSetting(e.name,e.value),a.displayNotification({msg:t.PlatformChange,eventID:"success"});else{var l={tenant:o,padsecurityctx:c};require("DS/PADUtils/PADUtilsServices").updateWidgetSecPref(l),n.setSetting(e.name,n.getSetting("x3dPlatformId"))}d.publish({event:"ENXApp/tenantDialog/complete",data:{skipRefresh:r}})}})}else n.setSetting(e.name,e.value),o!==e.value&&a.displayNotification({msg:t.PlatformChange,eventID:"success"})}else n.setSetting(e.name,e.value)},updateTenantSecPreference:function(e,t){this._dynamicUpdate=t;var n={tenant:e,withPreference:!0,dynamicUpdate:t};require("DS/PADUtils/PADUtilsServices").updateWidgetSecPref(n)},updateWidgetPreferences:function(e){if(this._dynamicUpdate=null,!e||!1!==e.submitted){if(null===this.app_context)throw new Error("Set the app context before using the PADSettingsMgt");var t=this;widget&&widget.getPreferences().forEach(function(e){"x3dPlatformId"===e.name?S.updateTenantPreference(e):t.setSetting(e.name,e.value)})}},getSetting:function(e,t){var n;return this.options.run_options.hasOwnProperty(e)?n=this.options.run_options[e].value:this.options.debug_options.hasOwnProperty(e)?(!0===t&&this.options.debug_options[e].activatedByWidgetPreference&&"undefined"!=typeof widget&&widget.getValue(this.options.debug_options[e].activatedByWidgetPreference.name)&&widget.getValue(this.options.debug_options[e].activatedByWidgetPreference.name)!==this.options.debug_options[e].activatedByWidgetPreference.value&&(this.options.debug_options[e].value=!1),n=this.options.debug_options[e].value):n=!!this.options.session_options.hasOwnProperty(e)&&this.options.session_options[e].value,n},setSetting:function(e,t,n){var i;if(this.options.run_options.hasOwnProperty(e)?i=this.options.run_options[e]:this.options.debug_options.hasOwnProperty(e)?i=this.options.debug_options[e]:this.options.session_options[e]={value:t},i){var s=t;i.preference&&"boolean"===i.preference.type&&UWA.is(t,"string")?s=m(t):t&&UWA.is(t.toLowerCase,"function")&&("true"===t.toLowerCase()||"false"===t.toLowerCase())&&(s=m(t)),i.value!==s&&(i.value=s,!0===i.dispatch&&this.dispatchEvent(function(e){return"on"+e.charAt(0).toUpperCase()+e.slice(1)}(e),s)),n&&"undefined"!=typeof widget&&widget.setValue(e,s)}u.setSetting(e,t)},dispatchEvent:function(e,t){this._parent(e,t),d.publish({event:"ENXApp/SettingsModification/"+e,data:t})},getWebAPI_Options:function(e){var t={};return this.options.webapi_options.hasOwnProperty(e)&&(t=this.options.webapi_options[e]),t},setWebAPI_Options:function(e,t){this.options.webapi_options.hasOwnProperty(e)&&(this.options.webapi_options[e]=t)},getLayout_options:function(e){var t={};return this.options.layout_options.hasOwnProperty(e)&&(t=this.options.layout_options[e]),t},getURLParameter:function(e){return null===v.widgetDomain&&(v.widgetDomain=decodeURIComponent((new RegExp("[?|&]widgetDomain=([^&;]+?)(&|#|;|$)").exec(location.search)||[null,""])[1].replace(/\+/g,"%20"))||null),v.widgetDomain&&decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(v.widgetDomain)||[null,""])[1].replace(/\+/g,"%20"))||null},hasSetting:function(e,t){return!!this.options.run_options.hasOwnProperty(e)||!(!t||!this.options.debug_options.hasOwnProperty(e))}});return S.addEvent("onPad_security_ctx",function(e){require("DS/PADServices/utils/GlobalUtils").setSecurityContext(e),"undefined"!=typeof widget&&widget.setValue("xPref_CREDENTIAL",widget.getValue("pad_security_ctx").replace("ctx::",""))}),S}),define("DS/PADUtils/Utility",["DS/PADUtils/PADSettingsMgt"],function(e){"use strict";var t=/(\d+)\/(\d+)\/(\d+)@\d+:\d+:\d+:\w+/;function n(e,t,n,i){var s=-1;return function(){if(++s<=e.length-1){var o=e[s];n(o,t)}else i()}}function i(e,t){for(var n=[],i=e.length,s=0;s<i;s+=t)n.push(e.slice(s,s+t));return n}return{compareValue:function(e,t){return e||(e=""),t||(t=""),require("DS/WidgetServices/WidgetServices").compareValue(t,e)},convertDateTime:function(n){var i="";if("NULL"===n)i="";else{t.test(n)&&(n=require("DS/WidgetServices/WidgetServices").formatDateObj(n).toUTCString());var s=Date.parse(n);isNaN(s)||(i=new Date(s).toLocaleString(e.getSetting("lang")))}return i},batchBreakup:i,createStepper:n,createBatchStepper:function(e,t,s,o,a){let r,l;return r=e.length>=t?i(e,s):[e],l=n(r,null,function(e){new Promise(function(t,n){o(e,t)}).then(l)},function(){a()})},elementIsOrIsWithin:function(e,t){return e===t||t.contains(e)||e.contains(t)},getBIColor:function(e,t,n){var i="rgba(255, 255, 255, 0.3)";if("date"===e){var s=n.substring(0,n.indexOf("T")).split("-"),o=[];o.push([s[0],s[1],s[2]].join("/")),o.push([s[0],s[1]].join("/")),o.push(s[0]);for(var a=!0,r=0,l=o.length;r<l&&a;r++)void 0!==t.map[o[r]]&&(a=!1,i=t.map[o[r]])}else if("boolean"===e&&"boolean"==typeof n){var c=n?"TRUE":"FALSE";i=t.map[c]}else void 0!==t.map[n]&&(i=t.map[n]);return i}}}),define("DS/PADUtils/PADUtilsServices",["i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Utils/InterCom","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/i3DXCompassServices/i3DXCompassPubSub","DS/PADUtils/PADSettingsMgt","DS/PADUtils/views/PADAlert","DS/PADUtils/views/PADTenantMgt","DS/PADUtils/PADContext","DS/PADUtils/PADIndexedDb","DS/PADServices/utils/WidgetProxy","DS/PlatformAPI/PlatformAPI","DS/PADServices/utils/PADTrackerManager","DS/ENOXParser/modules/Numbers","require","DS/WAFData/WAFData"],function(e,t,n,i,s,o,a,r,l,c,d,p,u,h,g){"use strict";var f,_,m,v=null,S=null,D=!1,P=!1,y={registrationOpts:function(){return{title:e.ENOPAD_title,mode:"furtive",default_with_precond:!0,widget_id:widget.id,app_socket_id:"enopad_"+widget.id,idcard_activated:!1,advanced_search:{showByDefault:!1},tenant:A.getPlatformId()}},dropdata_from_node:function(e,t){var n,i=[e.options.type];return t&&t[e.options.type]&&(i=t[e.options.type]),n=!0===e.isRelationsObjectNode?void 0:e.getOccurencePathWithType?e.getOccurencePathWithType():void 0,{envId:A.getPlatformId(),serviceId:"3DSpace",contextId:s.getSetting("pad_security_ctx")?s.getSetting("pad_security_ctx"):void 0,objectId:e.getID(),objectType:e.options.type,objectTaxonomies:i,displayName:e.options.display?e.options.display:e.getLabel(),displayType:e.options.grid["ds6w:type"],path:n}},get_current_tenant_idx:function(e){if(e){var t=e;if(!UWA.is(_)||m[_].platformId!==t)for(var n=0;n<m.length;n++)if(m[n].platformId===t){_=n;break}}else if("undefined"!=typeof widget&&f!==widget.getValue("x3dPlatformId")&&(f=widget.getValue("x3dPlatformId")),UWA.is(f)){t=f;if(!UWA.is(_)||m[_].platformId!==t)for(n=0;n<m.length;n++)if(m[n].platformId===t){_=n;break}}return UWA.is(_)||(_=0),_},set_current_tenant:function(e){f=e},set_current_security_ctx:function(e){e;require(["DS/PADUtils/PADSecurityCtxConverter"],function(t){t.setSecurityContext(e)})},_getSecurityContext:function(e){var t=e.user,n=e.callback,i=e.tenant;require(["DS/PADUtils/PADSecurityCtxConverter"],function(e){e.getSecurityContext({user:t,callback:n,tenant:i})})},update_user_history:function(e){Date.now();var t,n,i,s,o,a=!1,r={},c=A.getUser(),d=A.getUserLogin(),p={id:d,foundCallback:function(e){r=e,t=e.preferredSC||""},notFoundCallback:function(e){a=!0}};try{l.getUser(p)}catch(e){console.error("getUser:",e)}if(c&&c.properties&&UWA.is(c.properties.dashboards,"string")&&(n=Object.keys(JSON.parse(c.properties.dashboards)),i=c.properties.lastOpenedDashboardId||""),r?(s=r.dashboards,o=r.activeDashboard,s&&s===n&&o&&o===i||(a=!0)):a=!0,a){var u={id:d,dashboards:n||s,preferredSC:t||e.currentSC,activeDashboard:i||o,callback:e.callback||function(e){}};try{l.updateUser(u)}catch(e){console.error("updateuser error:",e)}}},update_user_sc_history:function(e){Date.now();var t,n,i,s,o=e.currentSC,a=A.getUser(),r=A.getUserLogin();if(a&&a.properties&&(s=a.properties.lastOpenedDashboardId),r&&s&&(i=r+"_"+s),i){var c={id:i,foundCallback:function(e){n=e.activeSC},notFoundCallback:function(e){t=!0}};try{l.getSC(c)}catch(e){console.error("getSC:",e)}if(n?o&&o!==n&&(t=!0):t=!0,o&&t){var d={id:i,userId:r,dashboardId:s,activeSC:o,callback:e.callback||function(e){}};try{l.addSC(d)}catch(e){console.error("updateSC error",e)}}}},getUserActiveSC:function(e){var t,n,i,s=Date.now(),o=e.user||A.getUser(),a=A.getUserLogin();if(o&&o.properties&&(n=o.properties.lastOpenedDashboardId),a&&n&&(i=a+"_"+n),i){var r={id:i,foundCallback:function(n){t=n.activeSC,UWA.is(e.cb)&&e.cb({activeSC:t})},notFoundCallback:function(t){UWA.is(e.cb)&&e.cb({activeSC:""})}};try{l.getSC(r)}catch(e){console.error(s,"getSC:",e)}}else UWA.is(e.cb)&&e.cb({activeSC:""})},fillSecurityPreferences:function(e){var t,n;Date.now();function i(i){if(P=!1,i)if(""!==i.securityContext&&i.securityContextList.length>0){if(e.padsecurityctx&&0!==e.padsecurityctx.length)s.updateSecuritySettings(o,a,e.padsecurityctx,i.securityContextList,e.withPreference);else{var r=s.getSetting("pad_security_ctx")?s.getSetting("pad_security_ctx"):i.securityContext;o&&"OnPremise"===o&&t&&(r=t),n=r,s.updateSecuritySettings(o,a,r,i.securityContextList,e.withPreference)}t||y.update_user_sc_history({currentSC:n}),e.resolve&&e.resolve()}else 0===i.securityContextList.length&&s.setSetting("noSecurityContext",!0);else s.setSetting("noSecurityContext",!0)}if(e.user&&e.user.properties&&e.user.properties.lastOpenedDashboardId&&y.getUserActiveSC({user:e.user,cb:function(e){t=e.activeSC}}),e.user||(e.user=A.getUser()),!1===P&&!0!==e.dynamicUpdate){P=!0;var o,a=A.getTenantsPreference();e.tenant?(o=e.tenant,c.setValue("x3dPlatformId",o),c.setValue("pad_tenant",o)):c.getValue("x3dPlatformId")?o=c.getValue("x3dPlatformId"):(o=a[0].value,c.setValue("x3dPlatformId",o),c.setValue("pad_tenant",o)),this._getSecurityContext({user:e.user,callback:i,tenant:o})}else 1==e.dynamicUpdate&&this._getSecurityContext({user:e.user,callback:i,tenant:e.tenant})}},A={getPCSPrefix:function(){return"undefined"==typeof widget?"ODTFallbackPrefix":widget.id+"_"+widget.title},dropdata_from_selected_nodes:function(e){var t={protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):"ENOSTDE_AP",widgetId:A.getWidgetId(),data:{items:[]}};let n=e.filter(function(e){return!0!==e.isGroupingNode});return t.data.items=n.map(function(e){return y.dropdata_from_node(e)}),t},contentOpenWith:function(e,t){var n=[];e.forEach(function(e){-1===n.indexOf(e.options.type)&&n.push(e.options.type)}),require(["DS/PADUtils/PADTypesMgt"],function(i){i.retrieveHierarchy(n,function(n){var i={protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):"ENOSTDE_AP",widgetId:A.getWidgetId(),data:{items:[]}};e.forEach(function(e){!0!==e.isGroupingNode&&i.data.items.push(y.dropdata_from_node(e,n))}),t(i)})})},dropdata_from_selected_ids:function(e){var t={protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):"ENOPSTR_AP",widgetId:A.getWidgetId(),data:{items:[]}};return e.forEach(function(e){t.data.items.push({envId:A.getPlatformId(),serviceId:"3DSpace",contextId:s.getSetting("pad_security_ctx")?s.getSetting("pad_security_ctx"):void 0,objectId:e.physicalid,objectType:e.type,displayType:e.displayType,displayName:e.label})}),t},retrieveDroppedDataType:function(e){for(var t,n="unknown",i={},s=UWA.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",o="",a=["text/searchitems","text/plain","Text"],r=0;r<a.length&&""===o;r++){var l=e.dataTransfer.types[s](a[r]);(UWA.is(l,"number")&&l>=0||UWA.is(l,"boolean")&&!0===l)&&(o=a[r])}if(""!==o){t=e.dataTransfer.getData(o);try{"3DXContent"===(i=JSON.parse(t)).protocol&&(n=i.protocol)}catch(e){console.warn("Unknown data format")}}return n},deserializeDroppedData:function(e){for(var t,n={data:{items:[]}},i=UWA.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",s="",o=["text/searchitems","text/plain","Text"],a=0;a<o.length&&""===s;a++){var r=e.dataTransfer.types[i](o[a]);(UWA.is(r,"number")&&r>=0||UWA.is(r,"boolean")&&!0===r)&&(s=o[a])}if(""!==s){t=e.dataTransfer.getData(s);try{n=JSON.parse(t)}catch(e){}}return n},retrieveDroppedData:function(t,n,i){function o(t,n){require(["DS/PADUtils/views/PADAlert"],function(i){i.displayNotification({msg:e.replace(e.get("unsupported_type"),{type:t,name:n}),eventID:"warning"})})}n=void 0===n||n;var a={},r=[];if(a=A.deserializeDroppedData(t),!0===s.getSetting("accept_all_types")||!0===i)console.log("Accept all types");else{var l=s.getSetting("authorized_types"),c=0;if(UWA.is(l,"array")){if(UWA.is(a.data)&&UWA.is(a.data.items,"array")&&a.data.items.length>0)do{var d=a.data.items[c].objectType;if(a.data.items[c].path&&a.data.items[c].path.length>0){var p="WITHOUT_CONTEXT";t&&(p=t.shiftKey?"WITHOUT_CONTEXT":"WITH_CONTEXT");var u=1;"WITHOUT_CONTEXT"===p&&(u=a.data.items[c].path.length),a.data.items[c].path[u-1].type&&(d=a.data.items[c].path[u-1].type)}if(-1===l.indexOf(d)){if(console.warn("Unsupported type ["+d+"]"),n)o(a.data.items[c].displayType?a.data.items[c].displayType:a.data.items[c].objectType,a.data.items[c].displayName);r=r.concat(a.data.items.splice(c,1))}else c++}while(c<a.data.items.length)}else console.warn("Unknown property authorized_types")}return{unserializedData:a,unsupportedObjects:r}},retrieveDroppedDataAsync:function(e,t,n,i){n=void 0===n||n;var o=A.deserializeDroppedData(e);!0===s.getSetting("accept_all_types")||!0===i?(console.log("Accept all types"),t({unserializedData:o,unsupportedObjects:[]})):require(["DS/PADUtils/PADTypesMgt"],function(n){n.retrieveAuthorizedObjects({notifPerObjects:!0,displayNotif:!1,dnd_event:e,unserializedData:o,version:"2.0",callback:function(e){t({unserializedData:o,unsupportedObjects:e.unauthorized_objects,authorized_objects:e.authorized_objects,source_data:e.source_data,authorizedWithKind:e.authorizedWithKind})}})})},getTenantsPreference:function(){var e=[];if(!UWA.is(m,"array"))throw new Error("Platform services not initialize yet");return m.forEach(function(t){e.push({label:t.displayName,value:t.platformId})}),e},getTenantId:function(){return console.warn("Deprecated method. Should use getPlatformId()"),A.getPlatformId()},updatePlatformId:function(e){e&&("undefined"!=typeof widget&&(widget.setValue("x3dPlatformId",e),widget.setValue("pad_tenant",e)),y.set_current_tenant(e),s.setSetting("x3dPlatformId",e),s.setSetting("pad_tenant",e))},get3DSearchUrl:function(){if(!UWA.is(m,"array"))throw new Error("Platform services not initialize yet");var e=y.get_current_tenant_idx();return-1===m[e]["3DSearch"].indexOf("/federated",m[e]["3DSearch"].length-"/federated".length)?m[e]["3DSearch"]+"/federated":m[e]["3DSearch"]},get3DSpaceUrl:function(e){if(!UWA.is(m,"array"))throw new Error("Platform services not initialize yet");var t=0;return t=e?y.get_current_tenant_idx(e):y.get_current_tenant_idx(),void 0===m[t]["3DSpace"]&&console.warn("No 3DSpace URL available for this tenant"),m[t]["3DSpace"]},getPlatformURL:function(e,t){if(!UWA.is(m,"array"))throw new Error("Platform services not initialize yet");var n=0;return n=t?y.get_current_tenant_idx(t):y.get_current_tenant_idx(),void 0===m[n][e]?(console.error("No "+e+" URL available for this tenant. Returning 3DSpace URL as failsafe"),A.get3DSpaceUrl(t)):m[n][e]},setOption:function(e,t){console.warn("DEPRECATED: Invalid call: please use DS/PADUtils/PADSettingsMgt.setSetting"),s.setSetting(e,t)},getOption:function(e){console.warn("DEPRECATED: Invalid call: please use DS/PADUtils/PADSettingsMgt.getSetting"),s.getSetting(e)},getGrantedRoles:function(e){n.getGrantedRoles(function(t){e(t)})},getVISnVIOStatus:function(e,t){if(this.isCloud()){if(void 0===t&&(t=0),void 0===this.getPlatformURL("3dvisucontentjobmgmt")){console.error("No URL for 3dvisucontentjobmgmt service available. Disabling Elastic loading capability");var n=p.getPADTracker({eventCategory:"usage",eventAction:"call_failure"});return n&&(n.setEventData({eventLabel:"getVISnVIOStatus-no-service-url-available"}),n.trackPageEvent()),void e({hasLicense:!1})}var i=this.getPlatformURL("3dvisucontentjobmgmt")+"/api/v1/activation/license",s={method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},timeout:3e4,onComplete:function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch{t={hasLicense:!1};var n=p.getPADTracker({eventCategory:"usage",eventAction:"call_failure"});n&&(n.setEventData({eventLabel:"getVISnVIOStatus-response-parsing-failed"}),n.trackPageEvent())}var i=p.getPADTracker({eventCategory:"usage",eventAction:"vik_usage"});i&&(i.setEventData({eventLabel:t&&!0===t.hasLicense?"activated":"deactivated"}),i.trackPageEvent()),e(t)}};s.onFailure=function(){var n;++t>5?(console.warn("/!\\ getVISnVIOStatus failed, stopping retry, setting hasLicense = false... /!\\ "),(n=p.getPADTracker({eventCategory:"usage",eventAction:"call_failure"}))&&(n.setEventData({eventLabel:"getVISnVIOStatus-noResponse-after-n-retry-set-false"}),n.persDim.pd2=""+t-1,n.trackPageEvent()),e({hasLicense:!1})):(console.warn("/!\\ getVISnVIOStatus failed, retry n°"+t+"... /!\\ "),(n=p.getPADTracker({eventCategory:"usage",eventAction:"call_failure"}))&&(n.setEventData({eventLabel:"getVISnVIOStatus-retry-on-failure"}),n.persDim.pd2=""+t,n.trackPageEvent()),setTimeout(function(t){this.getVISnVIOStatus(e,t)}.bind(this,t),1e3*Math.pow(t,2)))}.bind(this),s.onTimeout=function(){var n;++t>5?(console.warn("/!\\ getVISnVIOStatus timeout, stopping retry, setting hasLicense = false... /!\\ "),(n=p.getPADTracker({eventCategory:"usage",eventAction:"call_failure"}))&&(n.setEventData({eventLabel:"getVISnVIOStatus-noResponse-after-n-retry-set-false"}),n.persDim.pd2=""+t-1,n.trackPageEvent()),e({hasLicense:!1})):(console.warn("/!\\ getVISnVIOStatus timeout, retry n°"+t+"... /!\\ "),(n=p.getPADTracker({eventCategory:"usage",eventAction:"call_failure"}))&&(n.setEventData({eventLabel:"getVISnVIOStatus-retry-on-timeout"}),n.persDim.pd2=""+t,n.trackPageEvent()),setTimeout(function(t){this.getVISnVIOStatus(e,t)}.bind(this,t),1e3*Math.pow(t,2)))}.bind(this),s.onCancel=function(){var n;++t>5?(console.warn("/!\\ getVISnVIOStatus canceled, stopping retry, setting hasLicense = false... /!\\ "),(n=p.getPADTracker({eventCategory:"usage",eventAction:"call_failure"}))&&(n.setEventData({eventLabel:"getVISnVIOStatus-noResponse-after-n-retry-set-false"}),n.persDim.pd2=""+t-1,n.trackPageEvent()),e({hasLicense:!1})):(console.warn("/!\\ getVISnVIOStatus canceled, retry n°"+t+"... /!\\ "),(n=p.getPADTracker({eventCategory:"usage",eventAction:"call_failure"}))&&(n.setEventData({eventLabel:"getVISnVIOStatus-retry-on-cancel"}),n.persDim.pd2=""+t,n.trackPageEvent()),setTimeout(function(t){this.getVISnVIOStatus(e,t)}.bind(this,t),1e3*Math.pow(t,2)))}.bind(this),g.authenticatedRequest(i,s)}else e({hasLicense:!1})},app_initialization:function(t,i,a){if(a=void 0===a||a,!UWA.is(t,"function"))throw new Error("Invalid callback for the PAD app initialization");var r=require("DS/PADUtils/PADProbes").createProbe("_getPlatformServices"),l="undefined"==typeof widget||null==widget.data||null==widget.data.addPlatformPref||widget.data.addPlatformPref;if("undefined"!=typeof widget&&widget.addEvent("onPlatformIdChange",function(e,t){"x3dPlatformId"===e&&s.updateTenantSecPreference(t,!0)}),void 0!==i){var c=this.getUser();if(r.end(),r=null,m=i,!0===s.with_security_context)y.fillSecurityPreferences({user:c,withPreference:a});else{var d=A.getTenantsPreference(),p="undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):d[0].value;1==l&&a&&s.updateTenantSettings(p,d)}t.call(null)}else{var u=!1;"undefined"!=typeof widget&&widget.getValue("noCompass")&&(u=!0),n.getPlatformServices({onComplete:function(i){r.end(),r=null,m=[];var c=!1;if(!u&&"undefined"!=typeof widget&&i&&i.length>1){var d=i[0].platformId;d&&-1===["OnTenant1","odt_tenant","OnPremise"].indexOf(d)&&(c=!0)}if(c)n.getAppInfo({appId:A.getAppId(),onComplete:function(n){var r=!!n.tenantAware&&n.tenantAware;if(r){for(var c=0;c<n.platforms.length;c++)for(var d=0;d<i.length;d++)if(!r||i[d].platformId===n.platforms[c].id){m.push(i[d]);break}if(0===n.platforms.length)for(d=0;d<i.length;d++)if(!r||i[d].platformId===n.platformId){m.push(i[d]);break}}else m=i;var p=A.getTenantsPreference();if("undefined"!=typeof widget){let t=A.getPlatformId(),n=!0;for(let e=0;e<m.length&&n;e++)m[e].platformId===t&&(n=!1);n&&(A.updatePlatformId(p[0].value),o.displayNotification({msg:e.replace(e.get("notAccessibleTenant"),{tenant:t,switchedTenant:p[0].label}),eventID:"warning",key:"notAccessibleTenant"}))}if("ENOPSTR_AP"===A.getAppId()){var u=A.getPlatformId();s.updateTenantSettings(u,p,!0)}if(!0===s.with_security_context)y.fillSecurityPreferences({user:A.getUser(),withPreference:a});else{var h="undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):p[0].value;1==l&&a&&(console.info("tenants",p),console.info("current_tenant",h),s.updateTenantSettings(h,p,!0))}t({success:!0})},onFailure:function(e){console.error("Cannot retrieve the App Info"),t({success:!1})}});else{if(m=i,!0===s.with_security_context)y.fillSecurityPreferences({user:A.getUser(),withPreference:a});else{var p=A.getTenantsPreference(),h="undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):p[0].value;1==l&&a&&h&&s.updateTenantSettings(h,p)}t({success:!0})}},onFailure:function(e){r.end(),r=null,t({success:!1})}})}},in_apps_search:function(e){console.warn("DEPRECATED: Invalid call: please use DS/PADUtils/PADUtilsServices.inAppsSearch()");var n=UWA.extend(y.registrationOpts(),e),i=new t.Socket(n.app_socket_id,{dispacthRetryInterval:0});!0===e.debug_mode&&i.setDebugMode(!0),UWA.is(e.parent_window)?i.subscribeServer("SearchComServer",window):i.subscribeServer("SearchComServer"),i.dispatchEvent("RegisterContext",n),UWA.is(e.context_name)&&(n.context_title=e.context_name);var s=[];n.default_search_criteria=e.fts_value,i.dispatchEvent("InContextSearch",n),i.addListener("Selected_Objects_search",function(e){s=e}),i.addListener("closeTransient",function(t){"in_app_ok"===t.command_id?e.callback.call(null,s):"in_app_apply"===t.command_id?e.apply?e.apply.call(null,s):e.callback.call(null,s):e.cancel&&e.cancel.call(null),i.dispatchEvent("UnregisterContext",{widget_id:n.widget_id})}),i.addListener("onCloseTransient",function(t){e.cancel&&e.cancel.call(null),i.dispatchEvent("UnregisterContext",{widget_id:n.widget_id})})},inAppsSearch:function(e){var n=UWA.extend(y.registrationOpts(),e),i=new t.Socket(n.app_socket_id,{dispacthRetryInterval:0});!0===e.debug_mode&&i.setDebugMode(!0),UWA.is(e.parent_window)?i.subscribeServer("SearchComServer",window):i.subscribeServer("SearchComServer"),i.dispatchEvent("RegisterContext",n),UWA.is(e.context_name)&&(n.context_title=e.context_name),n.default_search_criteria=e.fts_value,i.dispatchEvent("InContextSearch",n),i.addListener("InContextSearch_Response",function(t){switch(t.selected_command){case"in_app_ok":e.callback.call(null,t);break;case"in_app_apply":e.apply?e.apply.call(null,t):e.callback.call(null,t);break;default:e.cancel&&e.cancel.call(null)}i.dispatchEvent("UnregisterContext",{widget_id:n.widget_id})}),i.addListener("onCloseTransient",function(t){e.cancel&&e.cancel.call(null),i.dispatchEvent("UnregisterContext",{widget_id:n.widget_id})})},subscribeCfgModifyEvent(e){var t="cfgEffectivityModifications_"+this.getWidgetId();d.subscribe(t,function(t){UWA.is(t,"string")&&(t=JSON.parse(t)),console.info("cfg==>",t.commandName),e.handler?e.handler(t):console.info("some random event",t)})},getWidgetId:function(){return"undefined"!=typeof widget?widget.id:-1},getAppId:function(){if("undefined"!=typeof widget)return widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):widget.getValue("appId")},getSharedId:function(){return"undefined"!=typeof widget?widget.getValue("x3dSharedId")?widget.getValue("x3dSharedId"):this.getAppId():-1},getPlatformId:function(){return"undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):s.getSetting("x3dPlatformId")},getRequestLabel:function(){return A.getUserLogin()+"-"+A.getAppId()+"-"+Date.now()},showTransientWidget:function(e,t,n,i){require(["DS/TransientWidget/TransientWidget"],function(s){s.showWidget(e,t,n,i)})},setObject_on_compass:function(e){var n=UWA.is(widget)&&widget.id?"padcompassSocket_"+widget.id:"padcompassSocket";if(!UWA.is(e.nodes_2_open,"array"))throw new Error("setObject_on_compass: Invalid init parameter nodes_2_open");null===v&&(v=new t.Socket(n)).subscribeServer("com.ds.compass",window.parent);var i=null;if(0===e.nodes_2_open.length)v.dispatchEvent("onResetX3DContent",{},n);else{null===i&&(i=require("DS/PADUtils/PADSettingsMgt"));var s=A.dropdata_from_selected_nodes(e.nodes_2_open);0===s.data.items.length?v.dispatchEvent("onResetX3DContent",{},n):v.dispatchEvent("onSetX3DContent",s,n)}},setStructure_4_open_in_cv5:function(e){var t,n,o=[];if(!UWA.is(e.nodes_2_open,"array")&&!UWA.is(e.completeselection))throw new Error("setStructure_4_open_in_cv5: Invalid init parameter nodes_2_open");if(e.completeselection)o=e.completeselection;else if(s.getSetting("open_in_v5_v2"))o=A.buildOpenJson(e.nodes_2_open,e.selected_paths);else{var a=[];e.nodes_2_open.forEach(function(e){var i=e.getParents(),s=e.getAllDescendants();for(t=0;t<i.length;t++)n=i[t].getID(),-1===a.indexOf(n)&&(o.push({physicalid:n,isroot:i[t].isRoot()}),a.push(n));if("CgrViewable"!==e.options.grid["ds6w:type"]&&"ThumbnailViewable"!==e.options.grid["ds6w:type"])for(n=e.getID(),-1===a.indexOf(n)&&(o.push({physicalid:n,isroot:e.isRoot()}),a.push(n)),t=0;t<s.length;t++)"CgrViewable"!==s[t].options.grid["ds6w:type"]&&"ThumbnailViewable"!==s[t].options.grid["ds6w:type"]&&(n=s[t].getID(),-1===a.indexOf(n)&&(o.push({physicalid:n,isroot:s[t].isRoot()}),a.push(n)))})}var r=JSON.stringify(o);i.publish("setStructure",{structure:r})},buildOpenJson:function(e,t){var n,i,s={version:"1",structures:{references:[],connections:[],trees:{}}},o=[],a="",r=0,l=0,c={},d=[];t&&t.forEach(function(e){d.push(e[e.length-1])});var p=function(e){var t=c[e];UWA.is(n[t.localid])||(n[t.localid]={},t.selected&&(n[t.localid].selected=t.selected)),n=n[t.localid]},u=function(e){var t=e.isSelected();return d.length&&(t=-1!==d.indexOf(e.getID())),t};return e.forEach(function(e){var t=e.getParents(),d=e.getAllDescendants();for(r=0;r<t.length;r++)(a=t[r].getRelationID()).length>0&&-1===o.indexOf(a)&&(s.structures.connections.push({physicalid:a,localid:l+""}),c[a]={localid:l,selected:u(t[r])},l++,o.push(a)),a=t[r].getID(),-1===o.indexOf(a)&&(s.structures.references.push({physicalid:a,type:t[r].options.type,localid:l+""}),c[a]={localid:l},l++,o.push(a));for((a=e.getRelationID()).length>0&&-1===o.indexOf(a)&&(s.structures.connections.push({physicalid:a,localid:l+""}),c[a]={localid:l,selected:u(e)},l++,o.push(a)),a=e.getID(),-1===o.indexOf(a)&&(s.structures.references.push({physicalid:a,type:e.options.type,localid:l+""}),c[a]={localid:l},e.isRoot()&&u(e)&&(c[a].selected=u(e)),l++,o.push(a)),r=0;r<d.length;r++)(a=d[r].getRelationID()).length>0&&-1===o.indexOf(a)&&(s.structures.connections.push({physicalid:a,localid:l+""}),c[a]={localid:l,selected:u(d[r])},l++,o.push(a)),a=d[r].getID(),-1===o.indexOf(a)&&(s.structures.references.push({physicalid:a,type:d[r].options.type,localid:l+""}),c[a]={localid:l},l++,o.push(a));var h=e.getLeaves();if(h.length>0)for(var g=0;g<h.length;g++)n=s.structures.trees,(i=h[g].getOccurencePath()).forEach(p);else i=e.getOccurencePath(),n=s.structures.trees,i.forEach(p)}),s},open_app:function(e,n){var i=UWA.is(widget)&&widget.id?"padcompassSocket_"+widget.id:"padcompassSocket";null===v&&(v=new t.Socket(i)).subscribeServer("com.ds.compass",window.parent),v.addListener("launchApp",function(e){UWA.is(n,"function")&&n(e)}),v.dispatchEvent("onLaunchApp",e,i)},launchApp:function(e,t){var n={appId:e.appId,widgetId:e.widgetId};i.publish("launchApp",n,function(e){UWA.is(t,"function")&&t(e)})},updateWidgetSecPref:function(e){UWA.is(m,"array")&&y.fillSecurityPreferences(e)},multiTenantMgt:function(t,n,i,s){var l=[],c=r.get(),d={isMultiTenant:!1,isClearView:!1};d.tenant=t[0].envId,d.padsecurityctx=t[0].contextId,""!==d.tenant&&void 0!==d.tenant||(d.tenant="OnPremise");var p=A.getTenantsPreference().find(({value:e})=>e.toLowerCase()===d.tenant.toLowerCase());if(p&&A.getTenantsPreference().length>1&&A.getPlatformId()!==d.tenant)if(0===n.length)l.push(new Promise(function(e){var t={tenant:d.tenant,padsecurityctx:d.padsecurityctx,resolve:e,withPreference:s};y.fillSecurityPreferences(t)})),l&&Promise.all(l).then(function(){o.displayNotification({msg:e.PlatformChange,eventID:"success"}),i(d)});else{var u=require("DS/PADServices/utils/GlobalModelEvents");u.publish({event:"ENXApp/possibleTenantChange"});new a({id:"PadTenantMgt",currentTenant:d,callback:function(t){t.isClearView?(c.empty(void 0,!0),l.push(new Promise(function(e){var t={tenant:d.tenant,padsecurityctx:d.padsecurityctx,resolve:e,withPreference:s};y.fillSecurityPreferences(t)})),l&&Promise.all(l).then(function(){o.displayNotification({msg:e.PlatformChange,eventID:"success"}),i(t)})):(u.publish({event:"ENXApp/cancelTenantChange"}),i(t))}})}else p?i(d):(d.isMultiTenant=!0,d.invalidTenant=!0,o.displayNotification({msg:e.replace(e.invalidTenant,{tenant:d.tenant}),eventID:"warning",key:"invalidTenant"}),i(d))},authoringCtxAvailable:function(){D=!0},isAuthoringCtxAvailable:function(){return D},setTypesForOFW:function(e){console.warn("/! PADUtilsServices.setTypesForOFW:: Internal and Obsolete Code")},_setpadsocketToNull:function(){v=null},getUser:function(){return null==S&&(S=d.getUser()),S},getUserLogin:function(){var e=A.getUser(),t="";return e&&(t=e.login),t},getUserName:function(){var e=A.getUser(),t="";return e&&(t=e.firstName+" "+e.lastName),t},printWindow:void 0,printWindowOpen:function(){return void 0!==A.printWindow&&null!==A.printWindow&&!1===A.printWindow.closed},printhtml:function(e){A.printWindowOpen()&&A.printWindow.close();setTimeout(function(){A.printWindow=window.open("","PrintWindow","width=1024, height=768"),void 0!==A.printWindow&&(A.printWindow.document.write(e),A.printWindow.document.close(),A.printWindow.focus(),A.printWindow.print(),A.printWindow.close())},0)},customizationWindowChange:function(e){require(["DS/ApplicationFrame/CommandsManager"],function(t){var n=e.id,i=e.open;if(void 0!==n&&void 0!==i){var s=t.getCommand(n);s&&(i?s.disable():s.enable())}})},downloadfile:function(e,t,n){var i=document,s=i.createElement("a");if(UWA.is(e)&&UWA.is(t)&&UWA.is(n)){if(n=n||"application/octet-stream",navigator.msSaveBlob&&!this.odtMode)return navigator.msSaveBlob(new Blob([e],{type:n}),t);if("download"in s){var o=URL.createObjectURL(new Blob([e],{type:n}));return s.setAttribute("href",o),s.setAttribute("download",t),s.innerHTML="downloading...",i.body.appendChild(s),setTimeout(function(){s.click(),i.body.removeChild(s),URL.revokeObjectURL(o)},66),!0}}},downloadfileURL:function(e,t){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(n.response,t);else{var e=document.createElement("a");e.href=window.URL.createObjectURL(n.response),t&&(e.download=t),e.style.display="none",document.body.appendChild(e),e.click(),e=void 0}},n.send()},getSecurityContext:function(e){var t=A.getTenantsPreference(),n="undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):t[0].value,i=this.getUser();y._getSecurityContext({user:i,callback:e,tenant:n})},isTouchDevice:function(){return"ontouchstart"in document.documentElement},isSurface:function(){return navigator.maxTouchPoints>0},isMobileDevice:function(){return navigator.userAgent.match(/Android|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i)||A.isIOSDesktopMode()},isIPad:function(){return navigator.userAgent.match(/iPad/i)||isIOSDesktopMode()},isIOSDesktopMode:function(){return"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1},isCloud:function(){var e;return void 0===e&&(e=!1,"undefined"!=typeof widget&&"OnPremise"!==widget.getValue("x3dPlatformId")&&(e=!0)),e},isCompassAvailable:function(){var e=document.querySelector("#compass_ctn")||document.querySelector(".topbar-compass");return!e&&window.parent&&(e=window.parent.document.querySelector("#compass_ctn")||window.parent.document.querySelector(".topbar-compass")),!e&&window.top&&(e=window.top.document.querySelector("#compass_ctn")||window.top.document.querySelector(".topbar-compass")),!!e},checkNotIdentity:u.checkNotIdentity};return s.addEvent("onX3dPlatformId",function(e){y.set_current_tenant(e)}),s.addEvent("onPad_security_ctx",function(e){Date.now();var t,n={cb:function(e){t=e.activeSC}};y.getUserActiveSC(n),!e&&t&&(e=t),e&&(y.update_user_history({currentSC:e}),y.update_user_sc_history({currentSC:e}),y.set_current_security_ctx(e))}),A}),define("DS/PADUtils/PADRelatedDocuments",["DS/WAFData/WAFData","DS/PADUtils/PADUtilsServices"],function(e,t){"use strict";return{getRelatedCADDocuments:function(n){console.warn("Deprecated method PADRelatedDocuments.getRelatedCADDocuments");var i=require("DS/PADUtils/PADSettingsMgt"),s=n||{},o=t.get3DSpaceUrl()+"/cvservlet/navigate";s.method="POST",s.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":i.getSetting("lang")},s.timeout||(s.timeout=i.getSetting("webapi_timeout"));var a=i.getSetting("pad_security_ctx");UWA.is(a,"string")&&(s.headers.SecurityContext=a,o=o+"?SecurityContext="+a),s.data.primitives=[{navigate_from_rel:{id:1,filter:{rel_type:["VPMInstance"]}}},{navigate_to_sr:{id:2,filter:{role:["6"],semantics:["5"]}}},{navigate_from_sr:{id:3}},{navigate_from_rel:{id:4,filter:{rel_type:["XCADBaseDependency"]}},navigate_to_rel:{id:5,filter:{rel_type:["XCADBaseDependency"]}}}],s.data.patterns={RELATEDCADDOCS_TO:[{id:2}],RELATEDCADDOCS_FROM:[{id:3}],RELATEDXCADDOCS_FROM:[{id:4}],RELATEDXCADDOCS_TO:[{id:5}]},s.data.patternTypeFilters={RELATEDCADDOCS_TO:{typesToNotReturn:["PGPRep","VPMPort"]},RELATEDCADDOCS_FROM:{typesToNotReturn:["PGPRep","VPMPort"]}},s.data.version=3,s.data.attributes=["ds6w:label","ds6w:type","ds6w:responsible","ds6wg:revision","ds6w:identifier"],s.data.label=t.getRequestLabel(),s.data=JSON.stringify(s.data),e.authenticatedRequest(o,s)}}}),define("DS/PADUtils/PADSharedSettings",["text!DS/PADUtils/assets/PADSharedSettings.json","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADSettingsMgt","DS/PADUtils/Configuration","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADCommandProxy"],function(e,t,n,i,s,o){"use strict";var a={debouncePrefSynchro:{},cbFuncLocal:{},cbFuncShared:{},proxy:null,appWidget:null},r={sharedSettings:JSON.parse(e),usedSharedSettings:[],destroy:function(){a.appWidget=null,a.proxy&&(a.proxy.destroy(),a.proxy=null),a.debouncePrefSynchro={},a.cbFuncLocal={},a.cbFuncShared={},r.usedSharedSettings=[]},listAvailableSharedSettings:function(){return Object.getOwnPropertyNames(r.sharedSettings)},addSharedSettings:function(e,t){if(e){if(a.appWidget||(a.appWidget=e),a.appWidget!==e)throw new Error("Unexpected widget");var i=(UWA.is(t,"array")?t:r.listAvailableSharedSettings()).filter(function(e){return-1===r.usedSharedSettings.indexOf(e)});if(0===i.length)return;if(-1!==i.indexOf("pad_security_ctx")&&(n.with_security_context=!0),-1!==i.indexOf("enopad3dviewer_CGRorTHB")){var l=e.getValue("enopad3dviewer_CGRorTHB");"boolean"==typeof l&&(l?e.setValue("enopad3dviewer_CGRorTHB","HIGH"):e.setValue("enopad3dviewer_CGRorTHB","OPTIMIZED"))}if(-1!==i.indexOf("autoreload")){var c=e.getValue("Cockpit_RootIds");"null"===c&&(c=null),(c||e.getValue("3dmigrated"))&&(r.sharedSettings.autoreload.value=!0,e.setValue("autoreload",!0),e.deleteValue("3dmigrated"))}var d,p={},u=[];for(d=0;d<i.length;d++)if(UWA.is(r.sharedSettings[i[d]],"object")){if(("ENOPSTE_AP"===e.data.appId||"ENOSC2D_AP"===e.data.appId)&&!0===r.sharedSettings[i[d]].only3D){i.splice(d,1);continue}n.options.run_options[i[d]]=r.sharedSettings[i[d]],!0!==i[d].notAddedByDefault&&(p[i[d]]=r.sharedSettings[i[d]]),r.usedSharedSettings.push(i[d]),u.push(i[d])}else console.warn("Unknown shared setting "+i[d]);var h=n.build_preferences(p);if(a.appWidget.mergePreferences(h),-1!==i.indexOf("pad_security_ctx")&&s.updateWidgetSecPref({user:s.getUser()}),!a.proxy){var g=function(e){a.debouncePrefSynchro[e.name]=!0,a.appWidget.setValue(e.name,e.value),n.setSetting(e.name,e.value)};a.proxy=o.create({events:{onPreferenceModification:function(e){void 0===a.cbFuncLocal[e.name]&&-1!==r.usedSharedSettings.indexOf(e.name)&&(a.cbFuncLocal[e.name]=g),a.cbFuncLocal[e.name]&&a.cbFuncLocal[e.name](e)}}})}var f=function(e){!0!==a.debouncePrefSynchro[e.name]&&a.proxy?a.proxy.preferenceModification({name:e.name,value:e.value}):a.debouncePrefSynchro[e.name]=!1};for(d=0;d<u.length;d++){!function(e){var t="on"+e.charAt(0).toUpperCase()+e.slice(1);n.addEvent(t,function(t){var n={name:e,value:t};void 0===a.cbFuncShared[n.name]&&(a.cbFuncShared[n.name]=f),a.cbFuncShared[n.name](n)})}(u[d])}}},resetDebounceFlags:function(){a.debouncePrefSynchro={}}};return r}),define("DS/PADUtils/PADSettings",["DS/PADUtils/PADUtilsServices"],function(e){"use strict";return console.warn("Deprecated module DS/PADUtils/PADSettings use DS/PADUtils/PADUtilsServices instead for the services methods or DS/PADUtils/PADSettingsMgt for settings mgt"),e}),define("DS/PADUtils/commands/RightSidePanel",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","UWA/Promise","DS/PADUtils/PADContext","DS/PADUtils/PADUtilsServices","DS/Utilities/Utils","UWA/Class/Model","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(e,t,n,i,s,o,a,r){"use strict";var l,c,d=[],p=!1;return void 0!==i.get&&null!==i.get()&&void 0!==i.get().getEditMode&&!0!==i.get().getEditMode()&&(p=!0),t.extend({_context:null,_propertiesWdg:null,_xso:null,_readOnly:p,_tkAdd:null,_tkRemove:null,_tkEmpty:null,init:function(e){this._parent(e,{}),this._context=i.get();var t=this;e.arguments.length&&e.arguments.forEach(function(e){"PropertiesReadOnly"===e.ID&&"true"===e.Value&&(t._readOnly=!0)});var n=o.debounce(function(){let e=t.getXSO().get(),n=!0;for(let t=0;t<e.length&&n;t++)"function"==typeof e[t].isSupplemental&&e[t].isSupplemental()||(n=!1);n&&0!==e.length?(t.disable(),t._propertiesWdg&&t._propertiesWdg.initDatas([])):(t.enable(),!0===t.getState()&&t._selectionChange())},100);this._tkAdd=this.getXSO().onPostAdd(n),this._tkRemove=this.getXSO().onPostRemove(n),this._tkEmpty=this.getXSO().onEmpty(n),this._buildView(),require(["DS/PADServices/utils/GlobalModelEvents"],function(e){e.subscribe({event:"ENXViews/Triptych/onOverlayClick"},function(e){e&&"right"===e&&!0===t.getState()&&(t.toggleState(),t.getTriptych().togglePanel("right"))})})},_selectionChange:function(){var e=this,t=this.getXSO().get(),i=new n(function(i){n.all(d).then(function(){var s=[];let o=[];t.length&&t.forEach(function(t){if(e.isNodeValid(t)){"r2vsurvey"===e.getServiceId(t)?o.push(e.__r2vsurveyPropModel(t)):o.push(e.__defaultPropNodeModel(t));let n=e._propertiesWdg.controller.getUI()._lFacets;for(let e=0;e<n.length;e++)switch(n[e].facet.name){case"specificationdocuments":case"referencedocuments":"Document"===t.type?n[e].alwaysVisible=!1:n[e].alwaysVisible=!0}}}),n.all(o).then(t=>{s=t,e._propertiesWdg.initDatas(s)}).catch(()=>{console.warn("Cannot retrieve properties model")}),i()})});d.push(i)},__defaultPropNodeModel:function(e){var t=this;return new n(n=>{if(t.__facetToSetVisible&&t.__facetToSetVisible.length){let e=this._propertiesWdg.controller.getUI()._lFacets;for(let n=0;n<e.length;n++)-1!==t.__facetToSetVisible.indexOf(e[n].facet.name)&&(e[n].alwaysVisible=!0);delete this.__facetToSetVisible}"function"!=typeof e.getID&&(e.getID=function(){return t.getID(this)}),"function"!=typeof e.getRelationID&&(e.getRelationID=function(){return t.getRelationID(this)}),void 0===e.type&&(e.options&&e.options.type?e.type=e.options.type:e.type=t.getType(e)),n(t.EditPropUtils.getModelFromSelectedNode(e))})},__r2vsurveyPropModel:function(e){return new n((t,n)=>{require(["DS/PADServices/utils/R2VProperties"],i=>{this.__facetToSetVisible=[];let s=this._propertiesWdg.controller.getUI()._lFacets;for(let e=0;e<s.length;e++)switch(s[e].facet.name){case"properties":break;default:!0===s[e].alwaysVisible&&(this.__facetToSetVisible.push(s[e].facet.name),s[e].alwaysVisible=!1)}i.getPropModel({objectId:this.getID(e),type:this.getType(e),serviceId:this.getServiceId(e)}).then(t).catch(n)})})},_buildView:function(){var t=this;if(t.getTriptych()){var i=t.getTriptych().getRightPanelContainer().querySelector(".rightSidePanel");if(i&&null===i.firstElementChild){var o=new n(function(o){require(["DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/utils/EditPropUtils","DS/EditPropWidget/constants/EditPropConstants"],function(a,d,p){t.EditPropUtils=d,c=t.EditPropUtils;var u=t._context.getPropertiesFacet();l?t._propertiesWdg=l:(t._propertiesWdg=new a({className:"enxpropertiestab",setEditButton:!t._readOnly,readOnly:t._readOnly,typeOfDisplay:p.ALL,selectionType:p.NO_SELECTION,warningOnUnsaved:!1,multiselection:p.MULTISEL_NO,collapseTabs:!1,context:t._context,appId:"undefined"!=typeof widget&&null!==widget?widget.getValue("appId"):"",actions:[{name:"action_close_panel",text:r.closeProperties,icon:"close",handler:function(){t.setState(!1)}}]}),t._propertiesWdg.removeFacets([p.FACET_VIEWS]),t._propertiesWdg.removeFacets([p.FACET_DERIVEDOUTPUT]),t._context.addEvent("onParentResize",t._propertiesWdg.onResize.bind(t._propertiesWdg)),t._context.addEvent("editModeModified",function(e){void 0!==t._propertiesWdg.setReadonlyStatus&&t._propertiesWdg.setReadonlyStatus(!e)})),l=t._propertiesWdg.inject(i),!0===t.getState()&&t._selectionChange();for(var h=[],g=0;g<u.length;g++){var f=u[g],_=new n(function(i){var o=f;n.all(h).then(function(){if(e.is(o,"string")&&"relations"===o){require(["DS/ENORIPE_Relations/RelationsTabSettings"],function(n){var o={getPlatformID:function(){return s.getPlatformId()},getServiceID:function(){return"3DSpace"}};n.isAvailable(o,{isDraggable:!0}).then(function(n){e.is(n,"object")&&e.is(n.facetInfo)?(n.facetInfo.options={defaultProfile:"Designer"},n.facetInfo.position=2,t._propertiesWdg.addFacets([n.facetInfo])):console.log("facets info is NOT in good format"),i()},function(){console.log("this facet is not available for this context = "+n),i()})},function(e){console.warn("Cannot load "+e.requireModules),i()})}else if(o.facet){if(o.facet.text||(o.facet.text=r[o.facet.name+"_cmd_title"]),o.actions&&o.actions.length>0)for(var n=0;n<o.actions.length;n++)o.actions[n].text=r[o.facet.name+o.actions[n].text];t._propertiesWdg.addFacets([o]),i()}else i()})});h.push(_)}t._propertiesWdg.stopSelection(!t.getState()),o()})});d.push(o)}else i&&null!==i.firstElementChild&&i.getElement&&i.getElement(".enxpropertiestab")&&(t._propertiesWdg=l,t._propertiesWdg.options&&t._propertiesWdg.options.actions&&e.is(t._propertiesWdg.options.actions,"array")&&"action_close_panel"===t._propertiesWdg.options.actions[0].name&&(t._propertiesWdg.options.actions[0].handler=function(){t.setState(!1)}),t.EditPropUtils=c);t.onStateChange(function(){t.getTriptych().getRightOpen()&&t.getState()||!t.getTriptych().getRightOpen()&&!t.getState()||(t._propertiesWdg.stopSelection(!t.getState()),!0===t.getState()&&t._selectionChange(),t.getTriptych().togglePanel("right"))}),t.getTriptych().getRightOpen()&&t.setState(!0)}else{console.log("Triptych not ready yet. Wait for it to complete the side panel");var a=new n(function(e){t.onTriptychReady(t._buildView.bind(t)),e()});d.push(a)}},getXSO:function(){throw new Error("This function must be reimplemented")},getID:function(e){throw new Error("This function must be reimplemented")},getRelationID:function(e){throw new Error("This function must be reimplemented")},getType:function(e){throw new Error("This function must be reimplemented")},getTriptych:function(e){throw new Error("This function must be reimplemented")},onTriptychReady:function(){throw new Error("This function must be reimplemented")},isNodeValid:function(e){return!0},getServiceId:function(e){return"3DSpace"},destroy:function(){this.getXSO().unsubscribe(this._tkAdd),this.getXSO().unsubscribe(this._tkRemove),this.getXSO().unsubscribe(this._tkEmpty)}})}),define("DS/PADUtils/views/PADPager",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","UWA/Core","UWA/Controls/Abstract","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADCommandProxy","DS/CoreEvents/ModelEvents","DS/Controls/Button","DS/Controls/ButtonGroup","DS/UIKIT/Tooltip"],function(e,t,n,i,s,o,a,r,l,c){"use strict";var d=i.extend({renderTo:null,visible:!1,_modelEvents:null,init:function(e){this.renderTo=e.renderTo?e.renderTo:document.body,this.callbacks=e.callbacks?e.callbacks:{},this.injectNow=e.injectNow?e.injectNow:void 0,this._parent(e),this._buildSkeleton(),this._commandProxy=o.create({events:{onPadPagerSync:this.padPagerSync.bind(this)}}),this._modelEvents=new a;require(["DS/PADServices/utils/GlobalModelEvents"],function(e){e.subscribe({event:"ENXViews/PADPager/close"},function(e){this.getModelEvents().publish({event:"close"})}.bind(this))}.bind(this))},show:function(){!1===this.visible&&(this.elements.container.inject(this.renderTo),this.visible=!0)},hide:function(e=!1){if(!0===this.visible){this.renderTo.removeChild(this.elements.container),this.visible=!1;let t={operation:"close",sharedID:s.getSharedId()};this._commandProxy.padPagerSync(t),e||this.padPagerSync(t)}this.injectNow&&this.destroy()},padPagerSync:function(e){e&&e.operation&&("next"===e.operation&&this.callbacks.onNext?this.callbacks.onNext():"previous"===e.operation&&this.callbacks.onPrevious?this.callbacks.onPrevious():"selectAll"===e.operation&&this.callbacks.onSelectAll?this.callbacks.onSelectAll():"reframeAll"===e.operation&&this.callbacks.onReframeAll?this.callbacks.onReframeAll():"close"===e.operation&&this.callbacks.onClose&&this.callbacks.onClose())},setLabel:function(e){this.elements.textInfo&&(this.elements.textInfo.innerHTML=e)},publish:function(e){this.getModelEvents().publish(e)},subscribe:function(e,t){return this.getModelEvents().subscribe(e,t)},unsubscribe:function(e){this.getModelEvents().unsubscribe(e)},getModelEvents:function(){return this._modelEvents},_buildSkeleton:function(){var e=this;this.elements.container=UWA.createElement("div",{class:"PADPagerContainer"}),this.elements.topBarContainer=UWA.createElement("span",{class:"PADSelectionNavigatiorTopBar"}).inject(this.elements.container),this.elements.textInfo=UWA.createElement("div",{class:"PADPagerLabel wux-afr-label"}).inject(this.elements.topBarContainer),this.elements.navActions=UWA.createElement("span",{class:"PADSelectionNavigateActions"}).inject(this.elements.topBarContainer),this.elements.navBtnGrp=new l({}).inject(this.elements.navActions),this.elements.previousButton=new r({title:t.PADSearchView_previous,type:"standard",icon:{iconName:"chevron-up",fontIconFamily:1}}),this.elements.previousButton.getContent().addClassName("PADPager3DPreviousButton PADPager-controls-button"),this.elements.previousButtonTooltip=new c({target:this.elements.previousButton.elements.button,position:"bottom"}),this.elements.previousButtonTooltip.setBody(t.PADSearchView_previous),this.elements.nextButton=new r({title:t.PADSearchView_next,type:"standard",icon:{iconName:"chevron-down",fontIconFamily:1}}),this.elements.nextButton.getContent().addClassName("PADPager3DNextButton PADPager-controls-button"),this.elements.nextButtonTooltip=new c({target:this.elements.nextButton.elements.button,position:"bottom"}),this.elements.nextButtonTooltip.setBody(t.PADSearchView_next),this.elements.navBtnGrp.addChild(this.elements.previousButton),this.elements.navBtnGrp.addChild(this.elements.nextButton),this.elements.selectButton=new r({title:t.PADSearchView_select,type:"standard",icon:{iconName:"select-on",fontIconFamily:1}}).inject(this.elements.topBarContainer),this.elements.selectButton.getContent().addClassName("PADPager3DSelectButton PADPager-controls-button"),this.elements.selectButtonTooltip=new c({target:this.elements.selectButton.elements.button,position:"bottom"}),this.elements.selectButtonTooltip.setBody(t.PADSearchView_select),this.callbacks.onReframeAll&&(this.elements.reframeButton=new r({title:t.PADSearchView_reframe,type:"standard",icon:{iconName:"zoom-fit",fontIconFamily:1}}).inject(this.elements.topBarContainer),this.elements.reframeButton.getContent().addClassName("PADPager3DReframeButton PADPager-controls-button"),this.elements.reframeButtonTooltip=new c({target:this.elements.reframeButton.elements.button,position:"bottom"}),this.elements.reframeButtonTooltip.setBody(t.PADSearchView_reframe)),s.isMobileDevice()?(this.elements.selectButton.getContent().setStyle("margin-top","0px"),this.elements.reframeButton&&this.elements.reframeButton.getContent().setStyle("margin-top","0px"),this.elements.previousButton.addEventListener("touchend",function(t){e.padPagerSync({operation:"previous"}),e._commandProxy.padPagerSync({operation:"previous"})}),this.elements.nextButton.addEventListener("touchend",function(t){e.padPagerSync({operation:"next"}),e._commandProxy.padPagerSync({operation:"next"})}),this.elements.selectButton.addEventListener("touchend",function(t){e.padPagerSync({operation:"selectAll"}),e._commandProxy.padPagerSync({operation:"selectAll"})}),this.elements.reframeButton&&this.elements.reframeButton.addEventListener("touchend",function(t){e.padPagerSync({operation:"reframeAll"}),e._commandProxy.padPagerSync({operation:"reframeAll"})})):s.isTouchDevice()?(this.elements.previousButton.addEventListener("click",function(t){e.padPagerSync({operation:"previous"}),e._commandProxy.padPagerSync({operation:"previous"})}),this.elements.nextButton.addEventListener("click",function(t){e.padPagerSync({operation:"next"}),e._commandProxy.padPagerSync({operation:"next"})}),this.elements.selectButton.addEventListener("click",function(t){e.padPagerSync({operation:"selectAll"}),e._commandProxy.padPagerSync({operation:"selectAll"})}),this.elements.reframeButton&&this.elements.reframeButton.addEventListener("click",function(t){e.padPagerSync({operation:"reframeAll"}),e._commandProxy.padPagerSync({operation:"reframeAll"})}),this.elements.previousButton.addEventListener("touchend",function(t){e.padPagerSync({operation:"previous"}),e._commandProxy.padPagerSync({operation:"previous"})}),this.elements.nextButton.addEventListener("touchend",function(t){e.padPagerSync({operation:"next"}),e._commandProxy.padPagerSync({operation:"next"})}),this.elements.selectButton.addEventListener("touchend",function(t){e.padPagerSync({operation:"selectAll"}),e._commandProxy.padPagerSync({operation:"selectAll"})}),this.elements.reframeButton&&this.elements.reframeButton.addEventListener("touchend",function(t){e.padPagerSync({operation:"reframeAll"}),e._commandProxy.padPagerSync({operation:"reframeAll"})})):(this.elements.previousButton.addEventListener("click",function(t){e.padPagerSync({operation:"previous"}),e._commandProxy.padPagerSync({operation:"previous"})}),this.elements.nextButton.addEventListener("click",function(t){e.padPagerSync({operation:"next"}),e._commandProxy.padPagerSync({operation:"next"})}),this.elements.reframeButton&&this.elements.reframeButton.addEventListener("click",function(t){e.padPagerSync({operation:"reframeAll"}),e._commandProxy.padPagerSync({operation:"reframeAll"})}),this.elements.selectButton.addEventListener("click",function(t){e.padPagerSync({operation:"selectAll"}),e._commandProxy.padPagerSync({operation:"selectAll"})})),this.elements.closeButton=UWA.createElement("span",{class:"fonticon fonticon-wrong PADPagerCloseButton","data-toggle":"tooltip","data-placement":"top",title:t.PADSearchView_close}).inject(this.elements.topBarContainer),s.isTouchDevice()&&this.elements.closeButton.addClassName("CloseButtonTouch"),this.elements.closeButton.addEventListener("click",function(t){let n={operation:"close",sharedID:s.getSharedId()};e._commandProxy.padPagerSync(n),e.padPagerSync(n)})},destroy:function(){this._commandProxy&&(this._commandProxy.padDestroy(),this._commandProxy.destroy(),delete this._commandProxy)}});return UWA.namespace("DS/PADUtils/commands/PADPager",d)}),define("DS/PADUtils/views/PADStatusBar",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Drivers/Alone","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADSettingsMgt","DS/UIKIT/Tooltip","DS/Controls/ProgressBar","DS/WebappsUtils/WebappsUtils","DS/PADUtils/PADUtilsServices","DS/ENOXInterWdgCom/LinkManager"],function(e,t,n,i,s,o,a,r,l,c,d,p){"use strict";return n.extend(i,{name:"pad_status",_tooltipInfo:null,_latestNotification:null,_icons:["filter","change","info","warning","error","widgetLinkSync","sgiActivation","startupView","latestNotification","perfoDebug"],_previousLabel:null,_isPaused:!1,_isFreezed:!1,_widgetLinkPanelOpened:!1,init:function(e){this._parent(e),this._tooltipCBForTouch=function(){this&&this.toggle()},this._onDragEvent=e.onDragEvent;var t=d.isTouchDevice()?" touch-mode":"";this.elements.container=UWA.createElement("div",{class:"pad_status_footer"+t}),this.elements.container.dataset.open=!0,this.elements.footerLeft=new UWA.Element("div",{class:"pad_status_footer_left"}).inject(this.elements.container),this.elements.selectionTextContainer=UWA.createElement("div",{class:"pad_status_footer_selection_text_container"}).inject(this.elements.footerLeft),this.elements.selectionText=UWA.createElement("span",{class:"selection_text"}).inject(this.elements.selectionTextContainer);if(this.elements.selectionText.innerHTML='<span class="fonticon fonticon-select-off"></span>',this._selectionTooltip=new r({target:this.elements.selectionText,position:"top left"}),this._selectionTooltip.setBody(o.PADStatusInfos_noSelection),e.withLoader){this.elements.loaderContainer=UWA.createElement("div",{class:"pad_status_footer_loader_container"}).inject(this.elements.footerLeft),this.elements.loaderFeedbackIcon=UWA.createElement("span",{}).inject(this.elements.loaderContainer);var n=c.getWebappsAssetUrl("PADUtils","icons/32/spinner.gif");this.elements.progressbarContainer=UWA.createElement("div",{class:"pad_status_footer_progress_bar hidden"}).inject(this.elements.loaderContainer),this._progressBar=UWA.createElement("img",{class:"pad_status_footer_progress_loader hidden",src:n}).inject(this.elements.progressbarContainer),this.elements.progressbarLabel=UWA.createElement("div",{class:"pad_status_footer_progress_label"}).inject(this.elements.loaderContainer),this.elements.progressbarLabel.innerHTML="",d.isTouchDevice()||(this.elements.progressbarLabel.innerHTML=o.PADStatus_readyToLoad),this.elements.playPause3DloadingFonticonContainer=UWA.createElement("div",{class:"pad_status_footer_play_button_container",events:{click:function(){this._isFreezed||("play"===this.elements.playPause3DloadingFonticonContainer.status?(e.onPause(),this.pause()):(e.onPlay(),this.resume()))}.bind(this)}}).inject(this.elements.loaderContainer),this.elements.playPause3DloadingFonticon=UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-pause pad_status_font_icon pad_status_fonticon_playPause3Dloading"}).inject(this.elements.playPause3DloadingFonticonContainer),this.elements.playPause3DloadingFonticonContainer.status="play",this._playPause3DloadingFonticonTooltip=new r({target:this.elements.playPause3DloadingFonticonContainer,position:"top left"}),this._playPause3DloadingFonticonTooltip.setBody(o.PADStatusInfos_lock3DLoadingTooltip),d.isTouchDevice()&&this._playPause3DloadingFonticonTooltip.options.target.addEventListener("touchend",this._tooltipCBForTouch.bind(this._playPause3DloadingFonticonTooltip))}this.elements.infoContainer=UWA.createElement("div",{class:"pad_status_footer_right"}).inject(this.elements.container);for(var i=this._icons.length-1;i>=0;--i)switch(this._icons[i]){case"change":this.elements.changeFonticonContainer=UWA.createElement("div",{class:"hidden"+t}).inject(this.elements.infoContainer),this.elements.changeFonticon=UWA.createElement("span",{class:"fonticon fonticon fonticon-change-action-workunder pad_status_font_icon pad_status_fonticon_change empty"}).inject(this.elements.changeFonticonContainer);break;case"info":this.elements.infoFonticonContainer=UWA.createElement("div",{class:"hidden"+t}).inject(this.elements.infoContainer),this.elements.infoFonticon=UWA.createElement("span",{class:"fonticon fonticon-info pad_status_font_icon pad_status_fonticon_info empty"}).inject(this.elements.infoFonticonContainer);break;case"warning":this.elements.warningFonticonContainer=UWA.createElement("div",{class:"hidden"+t}).inject(this.elements.infoContainer),this.elements.warningFonticon=UWA.createElement("span",{class:"fonticon fonticon-attention pad_status_font_icon pad_status_fonticon_warning empty"}).inject(this.elements.warningFonticonContainer);break;case"error":this.elements.errorFonticonContainer=UWA.createElement("div",{class:"hidden"+t}).inject(this.elements.infoContainer),this.elements.errorFonticon=UWA.createElement("span",{class:"fonticon fonticon-alert pad_status_font_icon pad_status_fonticon_error empty"}).inject(this.elements.errorFonticonContainer);break;case"filter":this.elements.filterFonticonContainer=UWA.createElement("div",{class:"hidden"+t}).inject(this.elements.infoContainer),this.elements.filterFonticon=UWA.createElement("span",{class:"fonticon fonticon-filter pad_status_font_icon pad_status_fonticon_filter empty"}).inject(this.elements.filterFonticonContainer);break;case"widgetLinkSync":this.elements.widgetLinkOptionsFonticonContainer=UWA.createElement("div",{class:"status_bar_action widgetLinkOptionsFonticonContainer hidden",events:{click:function(){e.onWidgetLinkOptionsClicked()&&e.onWidgetLinkOptionsClicked()}.bind(this)}}).inject(this.elements.infoContainer),this.elements.widgetLinkSyncFonticon=UWA.createElement("span",{class:"wux-ui-3ds fonticon-link-ok pad_status_font_icon pad_status_fonticon_startupView"}).inject(this.elements.widgetLinkOptionsFonticonContainer);break;case"startupView":this.elements.startupViewFonticonContainer=UWA.createElement("div",{class:"status_bar_action startupViewFonticonContainer hidden",events:{click:function(){e.onSetStartupViewClicked()&&e.onSetStartupViewClicked()}.bind(this)}}).inject(this.elements.infoContainer),this.elements.startupViewFonticon=UWA.createElement("span",{class:"wux-ui-3ds fonticon-space-rocket pad_status_font_icon pad_status_fonticon_startupView"}).inject(this.elements.startupViewFonticonContainer),this._startupViewFonticonTooltip=new r({target:this.elements.startupViewFonticonContainer,position:"top right"}),this._startupViewFonticonTooltip.setBody(o.PADStatusInfos_startupViewTooltip);break;case"latestNotification":var s=this;this.elements.latestNotificationFonticonContainer=UWA.createElement("div",{class:"hidden"+t}).inject(this.elements.infoContainer),this.elements.latestNotificationFonticon=UWA.createElement("span",{class:"fonticon fonticon-bell-alt pad_status_font_icon pad_status_fonticon_latestNotification empty",events:{click:function(){require(["DS/PADUtils/views/PADAlert"],function(e){s._latestNotification&&e.displayNotification(s._latestNotification),d.isTouchDevice()&&(s.elements.latestNotificationFonticon.removeClassName("new"),s._latestNotification?s.elements.latestNotificationFonticon.addClassName("old"):s.elements.latestNotificationFonticon.addClassName("empty"))})}}}).inject(this.elements.latestNotificationFonticonContainer),this._latestNotificationTooltip=new r({target:this.elements.latestNotificationFonticonContainer,position:"top right",events:{onHide:function(){s.elements.latestNotificationFonticon.removeClassName("new"),s._latestNotification?s.elements.latestNotificationFonticon.addClassName("old"):s.elements.latestNotificationFonticon.addClassName("empty")}}}),this._latestNotificationTooltip.setBody(o.PADStatusInfos_showLatestNotification),d.isTouchDevice()&&this._latestNotificationTooltip.options.target.addEventListener("touchend",this._tooltipCBForTouch.bind(this._latestNotificationTooltip));break;case"perfoDebug":if(e.onPerfoClicked&&e.perfoDebug){s=this;this.elements.perfoDebugFonticonContainer=UWA.createElement("div",{class:"pad_status_perfo_icon"+t,styles:"cursor: pointer;"}).inject(this.elements.infoContainer),this.elements.perfoDebugFonticon=UWA.createElement("span",{class:"fonticon fonticon-chart-gauge-angular pad_status_font_icon",events:{click:function(){e.onPerfoClicked()}}}).inject(this.elements.perfoDebugFonticonContainer),this._perfoDebugTooltip=new r({target:this.elements.perfoDebugFonticonContainer,position:"top right"}),this._perfoDebugTooltip.setBody(o.PADStatusInfos_debugPerformance),d.isTouchDevice()&&this._perfoDebugTooltip.options.target.addEventListener("touchend",this._tooltipCBForTouch.bind(this._perfoDebugTooltip))}break;case"sgiActivation":let n=require("DS/PADServices/settings/AppSettings");this.elements.sgiActivationFonticonContainer=UWA.createElement("div",{class:"status_bar_action sgiActivation "+(!0!==this.options.sgiActivation?"hidden":""),events:{click:function(){e.onToggleSGI()}.bind(this)}}).inject(this.elements.infoContainer),this.elements.sgiActivation=UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-warning-symbol-biohazard pad_status_font_icon pad_status_fonticon_sgiActivation "+(n.getSetting("redirectQueryToSGI")?"activated":"")}).inject(this.elements.sgiActivationFonticonContainer),this._sgiActivationFonticonTooltip=new r({target:this.elements.sgiActivationFonticonContainer,position:"top right"}),this._sgiActivationFonticonTooltip.setBody(o.PADStatusInfos_sgiActivationTooltip)}this.getOption("renderTo")&&this.inject(this.getOption("renderTo")),this.resetPreviousLabel()},destroy:function(){a.removeEvent("onX3dPlatformId")},setLoader:function(e){e&&"on"===e.status?(this.resetProgressLabel(),this._progressBar&&(this._progressBar.classList.remove("hidden"),this.elements.progressbarContainer&&this.elements.progressbarContainer.classList.contains("hidden")&&this.elements.progressbarContainer.classList.remove("hidden"))):e&&"off"===e.status?(this.resetProgressLabel(),this._progressBar&&(this._progressBar.classList.add("hidden"),this.elements.progressbarContainer&&this.elements.progressbarContainer.classList.add("hidden"))):e&&"show"===e.status?this.elements.progressbarContainer&&!this._progressBar.classList.contains("hidden")&&this.elements.progressbarContainer.classList.remove("hidden"):e&&"hide"===e.status&&this.elements.progressbarContainer&&this.elements.progressbarContainer.classList.add("hidden")},setProgressLabel:function(e){!0===this._isPaused?this._previousLabel=e:this.elements.progressbarLabel.innerHTML=e},setCustomProgressLabel:function(e){if(e&&e.label&&e.tooltip&&e.severity){switch(this.elements.loaderFeedbackIcon.className="pad_status_loader_fedback fonticon",e.severity){case"warning":this.elements.loaderFeedbackIcon.classList.add("fonticon-attention");break;case"error":this.elements.loaderFeedbackIcon.classList.add("fonticon-alert");break;case"info":this.elements.loaderFeedbackIcon.classList.add("fonticon-info");break;case"success":this.elements.loaderFeedbackIcon.classList.add("fonticon-check");break;default:this.elements.loaderFeedbackIcon.classList.add("fonticon-info")}!0===this._isPaused?(this._previousLabel=UWA.createElement("div",{class:"pad_status_footer_progress_label"}),this._previousLabel=e.label):(this.elements.progressbarLabel.innerHTML="",this.elements.progressbarLabel.innerHTML=e.label),this._progressLabelTooltip&&this._progressLabelTooltip.destroy(),this._progressLabelTooltip=new r({target:this.elements.loaderFeedbackIcon,position:"left"}),this._progressLabelTooltip.setBody(e.tooltip),d.isTouchDevice()&&this._progressLabelTooltip.options.target.addEventListener("touchend",this._tooltipCBForTouch.bind(this._progressLabelTooltip))}},pauseProgresslabel:function(){this._previousLabel=this.elements.progressbarLabel.innerHTML,this.elements.progressbarLabel.innerHTML=o.PADStatus_loadingPaused},restorePreviousLabel:function(){this.elements.progressbarLabel.innerHTML=this._previousLabel},resetPreviousLabel:function(){this._previousLabel=o.PADStatus_readyToLoad},resetProgressLabel:function(){this.elements.loaderFeedbackIcon.className="",!1===this._isPaused&&(this.elements.progressbarLabel.innerHTML=o.PADStatus_readyToLoad,this._progressLabelTooltip&&(d.isTouchDevice()&&this._progressLabelTooltip.options.target.removeEventListener("touchend",this._tooltipCBForTouch),this._progressLabelTooltip.destroy(),this._progressLabelTooltip=null))},pause:function(){this._isFreezed||(this._isPaused=!0,this.elements.playPause3DloadingFonticonContainer.status="pause",this.elements.playPause3DloadingFonticon.removeClassName("wux-ui-3ds-pause"),this.elements.playPause3DloadingFonticon.addClassName("wux-ui-3ds-play"),this._playPause3DloadingFonticonTooltip.setBody(o.PADStatusInfos_unlock3DLoadingTooltip),this.setLoader({status:"hide"}))},resume:function(){this._isFreezed||(this._isPaused=!1,this.elements.playPause3DloadingFonticonContainer.locked=!1,this.elements.playPause3DloadingFonticonContainer.status="play",this.elements.playPause3DloadingFonticon.removeClassName("wux-ui-3ds-play"),this.elements.playPause3DloadingFonticon.addClassName("wux-ui-3ds-pause"),this._playPause3DloadingFonticonTooltip.setBody(o.PADStatusInfos_lock3DLoadingTooltip),this.setLoader({status:"show"}))},enableProgress:function(){this._isFreezed=!1,this.resume(),this.elements.progressbarLabel.innerHTML=this._previousLabel,this.elements.playPause3DloadingFonticonContainer.classList.remove("freezed")},disableProgress:function(){this.pause(),this._isFreezed=!0,this._previousLabel=this.elements.progressbarLabel.innerHTML,this.elements.progressbarLabel.innerHTML=o.PADStatus_loadingFreezed,this.elements.playPause3DloadingFonticonContainer.classList.add("freezed")},setError:function(e){if(e&&e.message){this.elements.errorFonticon.addClassName("new"),this._errorTooltip&&(this._errorTooltip.destroy(),this._errorTooltip=null);var t=this;this._errorTooltip=new r({target:this.elements.errorFonticonContainer,position:"top right",events:{onHide:function(){t.elements.errorFonticon.removeClassName("new"),t.elements.errorFonticon.addClassName("old")}}}),this._errorTooltip.setBody(e.message),this.elements.errorFonticonContainer.removeClassName("hidden"),d.isTouchDevice()&&this.elements.errorFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._errorTooltip))}},clearError:function(){this.elements.errorFonticonContainer.addClassName("hidden"),this.elements.errorFonticon.removeClassName("new"),this.elements.errorFonticon.removeClassName("old"),this._errorTooltip&&(this._errorTooltip.destroy(),this._errorTooltip=null,d.isTouchDevice()&&this.elements.errorFonticon.removeEventListener("touchend",this._tooltipCBForTouch))},setWarning:function(e){if(e&&e.message){this.elements.warningFonticon.addClassName("new"),this._warningTooltip&&(this._warningTooltip.destroy(),this._warningTooltip=null);var t=this;this._warningTooltip=new r({target:this.elements.warningFonticonContainer,position:"top right",events:{onHide:function(){t.elements.warningFonticon.removeClassName("new"),t.elements.warningFonticon.addClassName("old")}}}),this._warningTooltip.setBody(e.message),this.elements.warningFonticonContainer.removeClassName("hidden"),d.isTouchDevice()&&this.elements.warningFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._warningTooltip))}},clearWarning:function(){this.elements.warningFonticonContainer.addClassName("hidden"),this.elements.warningFonticon.removeClassName("new"),this.elements.warningFonticon.removeClassName("old"),this._warningTooltip&&(this._warningTooltip.destroy(),this._warningTooltip=null,d.isTouchDevice()&&this.elements.warningFonticon.removeEventListener("touchend",this._tooltipCBForTouch))},setChange:function(e){if(e&&e.message){this.elements.changeFonticon.addClassName("new"),this._changeTooltip&&(this._changeTooltip.destroy(),this._changeTooltip=null);var t=this;this._changeTooltip=new r({target:this.elements.changeFonticonContainer,position:"top right",events:{onHide:function(){t.elements.changeFonticon.removeClassName("new"),t.elements.changeFonticon.addClassName("old")}}}),this._changeTooltip.setBody(e.message),this.elements.changeFonticonContainer.removeClassName("hidden"),d.isTouchDevice()&&this.elements.changeFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._changeTooltip))}},clearChange:function(){this.elements.changeFonticonContainer.addClassName("hidden"),this.elements.changeFonticon.removeClassName("new"),this.elements.changeFonticon.removeClassName("old"),this._changeTooltip&&(this._changeTooltip.destroy(),this._changeTooltip=null,d.isTouchDevice()&&this.elements.changeFonticon.removeEventListener("touchend",this._tooltipCBForTouch))},setSelection:function(e){if(e&&e.length){this.elements.selectionText.innerHTML='<span class="fonticon fonticon-select-on"></span>'+e.length,!0===a.getSetting("padstatusbar_allowSelectionDragging")&&(this.elements.selectionText.classList.add("has-selection"),this.elements.selectionText.parentNode.setAttribute("draggable",!0),this.elements.selectionText.parentNode.addEventListener("dragstart",this._onDragEvent)),this._selectionTooltip&&(this._selectionTooltip.destroy(),this._selectionTooltip=null),this._selectionTooltip=new r({target:this.elements.selectionText,position:"top left"}),this._selectionTooltip.setBody(e.length+o.PADStatusInfos_nbObjectsSelected),d.isTouchDevice()&&this.elements.selectionText.addEventListener("touchend",this._tooltipCBForTouch.bind(this._selectionTooltip))}},clearSelection:function(e){this.elements.selectionText.innerHTML='<span class="fonticon fonticon-select-off"></span>',!0===a.getSetting("padstatusbar_allowSelectionDragging")&&(this.elements.selectionText.classList.remove("has-selection"),this.elements.selectionText.parentNode.removeAttribute("draggable"),this.elements.selectionText.parentNode.removeEventListener("dragstart",this._onDragEvent)),this._selectionTooltip&&(this._selectionTooltip.setBody(o.PADStatusInfos_noSelection),d.isTouchDevice()&&this.elements.selectionText.removeEventListener("touchend",this._tooltipCBForTouch))},setInfo:function(e){if(e&&e.message){this.elements.infoFonticon.addClassName("new"),this._infoTooltip&&(this._infoTooltip.destroy(),this._infoTooltip=null);var t=this;this._infoTooltip=new r({target:this.elements.infoFonticonContainer,position:"top right",events:{onHide:function(){t.elements.infoFonticon.removeClassName("new"),t.elements.infoFonticon.addClassName("old")}}}),this._infoTooltip.setBody(e.message),this.elements.infoFonticonContainer.removeClassName("hidden"),d.isTouchDevice()&&this.elements.infoFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._infoTooltip))}},clearInfo:function(){this.elements.infoFonticonContainer.addClassName("hidden"),this.elements.infoFonticon.removeClassName("old"),this.elements.infoFonticon.removeClassName("new"),this._infoTooltip&&(this._infoTooltip.destroy(),this._infoTooltip=null,d.isTouchDevice()&&this.elements.infoFonticon.removeEventListener("touchend",this._tooltipCBForTouch))},setFilter:function(e){if(e&&e.message){this.elements.filterFonticon.addClassName("new"),this._filterTooltip||(this._filterTooltip=new r({target:this.elements.filterFonticonContainer,position:"top right",events:{onHide:function(){this.elements.filterFonticon.removeClassName("new"),this.elements.filterFonticon.addClassName("old")}.bind(this)}}),this._filterTooltip.elements.body.innerHTML="");for(var t=!1,n=this._filterTooltip.elements.body,i=0;i<n.children.length;++i)n.children[i].id==="statusbar-filter-"+e.id&&(t=!0);if(!1===t){var s=c.getWebappsAssetUrl("ENOPAD3DViewer","icons/32/I_DefineFilter.png"),o='<div id="statusbar-filter-'+e.id+'" class="filter-tooltip"><img src="'+s+'" /><p>'+e.message+"</p></div>";this._filterTooltip.elements.body.innerHTML+=o,this.elements.filterFonticonContainer.removeClassName("hidden"),this.elements.filterFonticonContainer.addEventListener("click",this._tooltipCBForTouch.bind(this._filterTooltip)),d.isTouchDevice()&&this.elements.filterFonticonContainer.addEventListener("touchend",this._tooltipCBForTouch.bind(this._filterTooltip))}}},clearFilter:function(e){var t=function(){this.elements.filterFonticonContainer.addClassName("hidden"),this.elements.filterFonticon.removeClassName("old"),this.elements.filterFonticon.removeClassName("new"),this._filterTooltip&&(this._filterTooltip.destroy(),this._filterTooltip=null,d.isTouchDevice()&&this.elements.filterFonticon.removeEventListener("touchend",this._tooltipCBForTouch))}.bind(this),n=function(e){if(this._filterTooltip){for(var n=this._filterTooltip.elements.body,i=n.children.length-1;i>=0;--i)n.children[i].id==="statusbar-filter-"+e&&n.removeChild(n.children[i]);0===n.children.length&&t()}}.bind(this);if(e&&e.id)n(e.id);else if(e&&e.ids)for(var i=0;i<e.ids.length;++i)n(e.ids[i]);else t()},toggleWidgetLinkOptions:function(e){!0===e?this.elements.widgetLinkOptionsFonticonContainer.removeClassName("hidden"):this.elements.widgetLinkOptionsFonticonContainer.addClassName("hidden")},toggleStartupView:function(e){!0===e?this.elements.startupViewFonticonContainer.removeClassName("hidden"):this.elements.startupViewFonticonContainer.addClassName("hidden")},setStartupView:function(e){if(this.elements.startupViewFonticon){this.elements.startupViewFonticon.addClassName("new"),e.icon=e.icon?e.icon:"";var t='<div id="statusbar-startupView-'+e.id+'" class="filter-tooltip"><img src="'+e.icon+'" /><p>'+e.name+"</p></div>";setTimeout(function(){this._startupViewFonticonTooltip.setBody(t)}.bind(this),100)}},clearStartupView:function(){this.elements.startupViewFonticon&&(this.elements.startupViewFonticon.removeClassName("new"),this._startupViewFonticonTooltip.setBody(o.PADStatusInfos_startupViewTooltip))},setLatestNotification:function(e){e&&e.notification&&(this.elements.latestNotificationFonticon.addClassName("new"),this._latestNotification=e.notification),this.elements.latestNotificationFonticonContainer.removeClassName("hidden")},clearLatestNotification:function(){this.elements.latestNotificationFonticonContainer.addClassName("hidden"),this.elements.latestNotificationFonticon.removeClassName("new"),this.elements.latestNotificationFonticon.removeClassName("old"),this._latestNotification=null},toggle:function(){"true"===this.elements.container.dataset.open?this.close():this.open()},open:function(){this.elements.container.classList.remove("closed"),this.elements.container.dataset.open=!0,this.elements.container.style.display="block"},close:function(){this.elements.container.classList.add("closed"),this.elements.container.dataset.open=!1,this.elements.container.style.display="none"},setIsPaused:function(e){this._isPaused=e},updateSGIActivationStatus:function(e){!0===e?this.elements.sgiActivation.addClassName("activated"):this.elements.sgiActivation.removeClassName("activated")}})}),define("DS/PADUtils/PADDictionaryAccess",["UWA/Promise","DS/Utilities/Utils","DS/FedDictionaryAccess/FedDictionaryAccessAPI","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices"],function(e,t,n,i,s,o){"use strict";var a={nodes2update:[],idx:0,nlsInProgress:[]},r=t.debounce(function(t){l.idx=0;var i,r,c={},d=new e(function(l){var d=a.nodes2update;a.nodes2update=[],e.all(a.nlsInProgress).then(function(){var e=require("DS/PADServices/utils/AttributesMgt"),a=e.getAvailableColumns();if(a&&d.length){for(i=0;i<t.length;i++){var p=Object.getOwnPropertyNames(t[i].options.grid);for(r=0;r<p.length;r++)"ds6w:reserved"!==p[r]&&UWA.is(t[i].options.grid[p[r]])&&""!==t[i].options.grid[p[r]]&&!0===e.isAttributeColumn(p[r])&&-1!==a.indexOf(p[r])&&(void 0===c[p[r]]&&(c[p[r]]=[]),-1===c[p[r]].indexOf(t[i].options.grid[p[r]])&&c[p[r]].push(t[i].options.grid[p[r]]))}n.getNlsOfPropertiesValues(JSON.stringify(c),{tenantId:o.getPlatformId(),lang:s.getSetting("lang"),apiVersion:"R2019x",onComplete:function(e){var t=UWA.is(e,"string")?JSON.parse(e):e,n=Object.getOwnPropertyNames(t);function s(e){var i=!1,s={grid:e.options.grid};for(r=0;r<n.length;r++)s.grid[n[r]]&&t[n[r]][s.grid[n[r]]]&&t[n[r]][s.grid[n[r]]]!==s.grid[n[r]]&&0!==t[n[r]][s.grid[n[r]]].indexOf("emxFramework")&&(i=!0,s.grid[n[r]]=t[n[r]][s.grid[n[r]]]);return{updated:i,options:s}}var o=d[0].getTreeDocument();if(o)o.withTransactionUpdate(function(){for(i=0;i<d.length;i++){var e=d[i],t=s(e);!0===t.updated&&(delete e._treatingNLS,e.updateOptions(t.options))}d=[]});else{for(i=0;i<d.length;i++){var a=d[i],c=s(a);!0===c.updated&&(delete a._treatingNLS,a.updateOptions(c.options))}d=[]}l()},onFailure:function(e){console.warn("Cannot retrieve NLS"),e&&console.warn("data="+e),d=[],l()}})}})});a.nlsInProgress.push(d)},100),l={updateColumnsWithNLS:function(t,a){var r,l=this,c=[];for(l.completeResponse={},r=0;r<t.length;r++){var d=null;t[r].xnav_options&&t[r].xnav_options.name?d=t[r].xnav_options.name:t[r].ds6w&&(d=t[r].ds6w),d&&(-1!==d.indexOf(":")?c.push(d):t[r].xnav_options&&!0===t[r].xnav_options.hardcoded?l.completeResponse[d]={nlsName:i[d],lang:s.getSetting("lang")}:i[d]?l.completeResponse[d]={nlsName:i[d],lang:s.getSetting("lang")}:console.warn("PADDictionaryAccess##FedDictionaryAccessAPI.getResourcesInfo Unknown attribute type:"+t[r].dataIndex))}new e(function(e){var t={tenantId:o.getPlatformId(),lang:s.getSetting("lang"),apiVersion:"R2019x",onComplete:function(t){if(UWA.is(t,"array"))for(var n=0;n<t.length;n++)l.completeResponse[t[n].curi]={nlsName:t[n].label,lang:s.getSetting("lang")};e()},onFailure:function(t){var n=UWA.clone(c);if(UWA.is(t,"array")){for(var i=0;i<t.length;i++){var o=n.indexOf(t[i].curi);-1!==o&&n.splice(o,1),l.completeResponse[t[i].curi]={nlsName:t[i].label,lang:s.getSetting("lang")}}if(n.length){console.log("PADDictionaryAccess## FedDictionaryAccessAPI.getResourcesInfo can't find NLS for",JSON.stringify(n));for(i=0;i<n.length;i++)l.completeResponse[n[i]]={nlsName:n[i],lang:s.getSetting("lang")}}}e()}};n.getResourcesInfo(c.join(","),t)}).then(function(){for(r=0;r<t.length;r++){var e=null;if(t[r].xnav_options?e=t[r].xnav_options.name:t[r].ds6w&&(e=t[r].ds6w),e&&l.completeResponse[e]&&l.completeResponse[e].nlsName)t[r].text=l.completeResponse[e].nlsName;else if(e&&-1!==e.indexOf("ds6w"))console.warn("PADDictionaryAccess## ds6w attribute ["+e+"] not found by FedDictionaryAccessAPI.getResourcesInfo");else if(e){var n=e.split(":"),i="";!0===require("DS/PADServices/utils/AttributesMgt").isAttributeColumn(e)&&(i=n&&2===n.length?n[1]:e),t[r].text=i}}a({status:"success",columns:t})})},updateNLS:function(e){e._treatingNLS=!0,a.nodes2update.push(e),r(a.nodes2update)},getPropertiesForClass:function(e,t){n.getPropertiesForClass(e,t)},getVocabularyClasses:function(e,t){n.getVocabularyClasses(e,t)},getNlsOfPropertiesValues:function(e,t){n.getNlsOfPropertiesValues(e,t)},getResourcesInfo:function(e,t){n.getResourcesInfo(e,t)},predicates_nls_names:function(e,t){n.getVocabularyProperties(e,t)}};return l}),define("DS/PADUtils/PADSession",["UWA/Class","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADSettingsMgt","DS/PADUtils/views/PADAlert","DS/CoreEvents/ModelEvents","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(e,t,n,i,s,o){"use strict";return e.singleton({_modelEvents:null,_notSilent:!0,_onlyIndex:!1,init:function(){var e=this;function i(t){if("enxscene"!==require("DS/PADUtils/PADSettingsMgt").app_context){if(UWA.is(t.authored,"boolean")){var n=t.authored_reason;!n&&t.authored&&(n=o.PADSession_disabling_index_authoring),e.setAuthoringState(t.authored,n,!1)}if(UWA.is(t.useIndexPreference,"boolean")){var i=t.useIndexPreference_reason;e.setUseIndexPreference(t.useIndexPreference,i,!1)}}}this._modelEvents=new s,n.addEvent("onUseIndexAccleration",function(e){this.setUseIndexPreference(e)}.bind(this)),this._commandProxy=t.create({events:{onAuthored:i,onSessionStateChange:i}}),this._authored=!1,this._useIndexPreference=!0,this._callCounter=0},setUseIndexPreference:function(e,t,n){var i={useIndexPreference:e,useIndexPreference_reason:t};e!==this._useIndexPreference?(this._useIndexPreference=e,!1!==n&&this._commandProxy.sessionStateChange(i),this.publish({event:"useIndexPreferenceModified",data:{useIndexPreference:e}})):!0===n&&this._commandProxy.sessionStateChange(i)},setAuthoringState:function(e,t,s,a){var r=!1;if(UWA.is(e,"boolean")&&e!==this._authored){if(t&&this._notSilent&&!0===this._useIndexPreference){var l=o[t]||t;i.displayNotification({title:l.title?l.title:"",msg:l.msg?l.msg:l,eventID:"primary"})}this._authored=e,r=!0,e&&(this._lastAuthoredTime=Date.now()),this.publish({event:"authoringStateModified",data:{authored:this._authored}})}(r&&void 0===s||!0===s)&&this._commandProxy.authored({authored:this._authored,authored_reason:t,instanceId:a}),n.getSetting("activateAutoSwitchAuthoringToIndex")&&e&&this.publish({event:"applySwitchTimeout",data:{authored:this._authored,useIndexPreference:this._useIndexPreference}})},getLastAuthoredTimeStamp:function(){return this._lastAuthoredTime?this._lastAuthoredTime:NaN},isAuthoring:function(){return this._authored&&!this._onlyIndex},isUsingIndex:function(){return console.warn("The method PADSession.determineAuthoredFlag is clearer than isUsingIndex"),Boolean(this._useIndexPreference&&!(this._authored&&!this._onlyIndex))},determineAuthoredFlag:function(){return!this._useIndexPreference||this._authored&&!this._onlyIndex},softInit:function(e,t){!0===e&&(this._notSilent=!e),!0===t&&(this._onlyIndex=t)},getModelEvents:function(){return this._modelEvents},publish:function(e){this.getModelEvents().publish(e)},subscribe:function(e,t){return this.getModelEvents().subscribe(e,t)},unsubscribe:function(e){this.getModelEvents().unsubscribe(e)},onAuthoringMode:function(e){return this.getModelEvents().subscribe({event:"authoringStateModified"},e)}})}),define("DS/PADUtils/commands/SwitchAuthoringIndex",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/PADUtils/PADContext","DS/CoreEvents/ModelEvents","DS/PADUtils/PADSession","DS/PADUtils/PADSettingsMgt","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(e,t,n,i,s,o,a){"use strict";return t.extend({_context:null,_triggerFromCmd:!1,init:function(e){this._parent(e,{}),this._context=n.get(),this._sessionCBTokens=[],s.isAuthoring()?!1===this.getState()&&this.setState(!0,!1):!0===this.getState()&&this.setState(!1,!1),!1===o.getSetting("useIndexAccleration")&&"undefined"!=typeof widget&&void 0!==widget.getPreference("useIndexAccleration")?(this.disable(),s.determineAuthoredFlag()&&!1===this.getState()&&s.setAuthoringState(!0)):this.enable();var t=this;this._sessionCBTokens.push(s.subscribe({event:"authoringStateModified"},function(e){!0===t._triggerFromCmd?t._triggerFromCmd=!1:s.isAuthoring()?!1===t.getState()&&t.setState(!0,!1):!0===t.getState()&&t.setState(!1,!1)})),this._sessionCBTokens.push(s.subscribe({event:"useIndexPreferenceModified"},function(e){!0===e.useIndexPreference?(t.enable(),s.setAuthoringState(!1)):(t.disable(),s.setAuthoringState(!0))})),this.onStateChange(function(){t._triggerFromCmd=!1;var e,n=t.getState();e=n?a.PADSession_enabling_authoring_mode:a.PADSession_disabling_authoring_mode,s.setAuthoringState(n,e)})}})}),define("DS/PADUtils/views/PADStatusInfos",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/UIKIT/Tooltip","DS/Controls/Loader","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSession"],function(e,t,n,i,s,o,a,r,l,c,d){"use strict";var p=n.extend(i,{name:"pad_status",_logger:null,_tooltipInfo:null,init:function(e){this._logger=o.getLogger(p),this._logger.log("init"),this._parent(e),e.withProgress?(this.elements.container=UWA.createElement("div",{class:this.getClassNames()+" with_progress"}),this.elements.loaderContainer=UWA.createElement("div",{class:"pad_status_loader_div"}).inject(this.elements.container),this._loader=(new l).inject(this.elements.loaderContainer),this.elements.fonticonInfoContainer=UWA.createElement("div",{class:"pad_status_fonticon_info_div"}).inject(this.elements.container),this.elements.fonticonInfo=UWA.createElement("i",{class:"fonticon fonticon-info pad_status_span"}).inject(this.elements.fonticonInfoContainer),this._tooltipInfo=new r({className:this.getClassNames("_tooltipInfo"),target:this.elements.container,position:"top",trigger:"touch",events:e.events}),this.elements.fonticonAttentionContainer=UWA.createElement("div",{class:"pad_status_fonticon_attention_div"}).inject(this.elements.container),this.elements.fonticonAttention=UWA.createElement("i",{class:"fonticon fonticon-attention pad_status_span"}).inject(this.elements.fonticonAttentionContainer),this._tooltipAttention=new r({className:this.getClassNames("_tooltipAttention"),target:this.elements.fonticonAttention,position:"top left",trigger:"touch",events:e.events}),this.getOption("status")&&this._tooltipInfo.setBody(this.getOption("status")),this.getOption("renderTo")&&this.inject(this.getOption("renderTo")),this.getOption("attention")&&this._tooltipAttention.setBody(this.getOption("attention")),this.showLoader=function(e){if(e){var t=this;this._isloading=!0,t._loadingText=e.nlsTooltip,setTimeout(function(){!0===t._isloading&&t._loader&&(t._loader.on(),t.elements.fonticonInfoContainer.style.display="",t.elements.fonticonAttentionContainer.style.display="none",e.fonticon&&(t._replacedFonticon=e.fonticon,t.elements.fonticonInfo.removeClassName("fonticon-info"),t.elements.fonticonInfo.addClassName(e.fonticon)),t._addLoading(),!1===t._tooltipInfo.isVisible&&t._tooltipInfo.toggle())},e.timeout?e.timeout:0)}else this._loader&&(this._loader.on(),this.elements.fonticonInfoContainer.style.display="",this.elements.fonticonAttentionContainer.style.display="none")},this.hideLoader=function(e){this._isloading=!1,this._loader&&(this._loader.off(),e&&!0===e.memoryFull&&(this.elements.fonticonAttentionContainer.style.display="",this.elements.fonticonInfoContainer.style.display="none")),!0===this._tooltipInfo.isVisible&&this._tooltipInfo.toggle(),this.elements.fonticonInfo.addClassName("fonticon-info"),this.elements.fonticonInfo.removeClassName(this._replacedFonticon),this._removeLoading()},this.elements.fonticonAttentionContainer.style.display="none"):(this.elements.container=UWA.createElement("span",{class:this.getClassNames()+" fonticon fonticon-info"}),this._tooltipInfo=new r({className:this.getClassNames("_tooltipInfo"),target:this.elements.container,position:"top left",trigger:"touch",events:e.events}),this.getOption("status")&&this._tooltipInfo.setBody(this.getOption("status")),this.getOption("renderTo")&&this.inject(this.getOption("renderTo")))},setStatus:function(e){this._tooltipInfo.setBody(e),this._isloading&&this._addLoading()},_addLoading:function(){var e=this._tooltipInfo.getBody(),t=UWA.createElement("div",{id:"loadingTooltip",text:this._loadingText});null===e.querySelector("loadingTooltip")&&t.inject(e)},_removeLoading:function(){var e=this._tooltipInfo.getBody().querySelector("loadingTooltip");null!==e&&e.remove(e)}});return p.buildStatus=function(e){var t=UWA.createElement("div",{class:"pad_status_msg"});if(e.tree_content){if(!UWA.is(e.tree_content.nbObjectsSelected))throw new Error("Invalid status. Parameter nbObjectsSelected missing");void 0!==e.tree_content.nbObjectsInTree?e.tree_content.nbObjectsInTree>0?(1===e.tree_content.nbObjectsInTree?UWA.createElement("div",{text:a.PADStatusInfos_oneObjectInTree}).inject(t):UWA.createElement("div",{text:e.tree_content.nbObjectsInTree+a.PADStatusInfos_nbObjectsInTree}).inject(t),UWA.createElement("div",{text:e.tree_content.nbObjectsSelected+a.PADStatusInfos_nbObjectsSelected}).inject(t)):UWA.createElement("div",{text:a.PADStatusInfos_noObjectInTree}).inject(t):null!=e.tree_content.nbObjectsSelected?UWA.createElement("div",{text:e.tree_content.nbObjectsSelected+a.PADStatusInfos_nbObjectsSelected}).inject(t):UWA.createElement("div",{text:a.PADStatusInfos_noObjectInTree}).inject(t);var n=d.isAuthoring()?a.PADStatusInfos_authoringModeEnabled:a.PADStatusInfos_authoringModeDisabled;UWA.createElement("div",{text:n,style:"border-top: 1px;"}).inject(t)}var i=c.getTenantsPreference();return e.Tenant&&i.length>1&&UWA.createElement("div",{text:a.PADStatusInfos_Tenant+e.Tenant}).inject(t),t},p}),define("DS/PADUtils/views/PADDnDInvite",["css!DS/PADUtils/PADUtils","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/Core/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","UWA/Utils/Client","DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADWebInWinServices","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSession"],function(e,t,n,i,s,o,a,r,l,c,d,p){"use strict";return i.extend(s,o,{name:"paddnd_invite",defaultOptions:{mode:"dynamic",invites:{drop:{nls:"drop",icon:"drag-drop"},add_in_context:{nls:"add_in_context",icon:"plus"},add_as_object:{nls:"add_as_object",icon:"plus"},insert:{icon:"plus",nls:"insert"},find:{icon:"search",nls:"find"}},active_invite:"drop",isTouchActivated:!1},init:function(e){switch(this._parent(e),this.options.isTouchActivated=l.getSetting("touchDropInvite")&&a.Features.touchEvents&&!a.Features.pointerEvents,this.options.isTouchActivated&&(this.options.invites.drop={nls:"add_as_object",icon:"touch"}),this.getMode()){case"none":break;case"drop_here":this._createDropHereInvite();break;case"dynamic":this._createDynamicInvite();break;case"inviteWithFilter":void 0===e.filterActive||!0===e.filterActive?this._createDynamicInvite(!0):this._createDynamicInvite(!1);break;default:console.warn("Unknown mode ["+this.getMode()+"]"),this._createDynamicInvite()}},dataTransferDropEffect:function(e){e.dataTransfer&&("copyMove"!==e.dataTransfer.effectAllowed&&"copy"!==e.dataTransfer.effectAllowed||(e.dataTransfer.dropEffect="copy",e.preventDefault()),"copy"!==e.dataTransfer.dropEffect&&"move"!==e.dataTransfer.dropEffect||(e.dataTransfer.dropEffect="copy",e.preventDefault()))},_createDynamicInvite:function(e){var n=this;this.elements.container=UWA.createElement("div",{class:this.getClassNames("_container")});var i=Object.getOwnPropertyNames(this.options.invites);if(this.elements.container.informationDiv=UWA.createElement("div",{class:this.getClassNames("_informationMain"),draggable:!1}),this.elements.container.informationDiv.inject(this.elements.container),this.options.isTouchActivated){this.elements.container.className+=" touch_look",this.elements.container.informationDiv.style.pointerEvents="auto",this.elements.container.informationDiv.addEventListener("touchend",function(e){require(["DS/ApplicationFrame/CommandsManager"],function(e){e.getCommand("AddRoot","Default").begin()})})}for(var s=0;s<i.length;s++){var o=i[s];this.elements.container[o]=UWA.createElement("div",{class:this.getClassNames("_display "+o),draggable:!1}),UWA.createElement("i",{class:this.getClassNames("_img wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-"+this.options.invites[o].icon)}).inject(this.elements.container[o]),UWA.createElement("h5",{class:this.getClassNames("_txt font-3dsregular "+o),text:t["PADDropInvit_"+this.options.invites[o].nls]}).inject(this.elements.container[o]),this.elements.container[o].inject(this.elements.container.informationDiv),this.options.active_invite!==o&&this.elements.container[o].hide()}if(!0===e){this.elements.container.style.pointerEvents="auto",this.elements.container.addEventListener("dragover",function(e){return e.dataTransfer.dropEffect="move",e.preventDefault(),e.stopPropagation(),n.dataTransferDropEffect(e),!1});var a=0;this.elements.container.addEventListener("dragenter",function(e){require("DS/PADUtils/PADSession").determineAuthoredFlag()?(n.elements.container.removeClassName("withFilterOpen"),n.elements.container.filterDiv.style.display="none"):(e.preventDefault(),e.stopPropagation(),a++,n.elements.container.addClassName("withFilterOpen"),n.elements.container.filterDiv.style.display="block"),n.dataTransferDropEffect(e)}),this.elements.container.addEventListener("dragleave",function(e){if(!1===require("DS/PADUtils/PADSession").determineAuthoredFlag())return e.preventDefault(),e.stopPropagation(),--a<=0&&(n.elements.container.removeClassName("withFilterOpen"),n.elements.container.filterDiv.style.display="none",a=0),!1}),this.elements.container.addEventListener("drop",function(e){return a=0,!1===require("DS/PADUtils/PADSession").determineAuthoredFlag()&&(n.elements.container.removeClassName("withFilterOpen"),n.elements.container.filterDiv.style.display="none"),UWA.is(n.options.dropOnInvite,"function")&&(l.setSetting("changeControlDlgOpen",!0),n.options.dropOnInvite(e)),!1}),this.elements.container.filterDiv=UWA.createElement("div",{class:this.getClassNames("_filterMain"),draggable:!1}),this.elements.container.filterDiv.style.display="none",this.elements.container.filterDiv.inject(this.elements.container);o="filter";this.elements.container[o]=UWA.createElement("div",{class:this.getClassNames("_display "+o)}),UWA.createElement("i",{class:this.getClassNames("_img wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-filter")}).inject(this.elements.container[o]),UWA.createElement("h5",{class:this.getClassNames("_txt font-3dsregular "+o),text:t.PADDropInvit_filter}).inject(this.elements.container[o]),this.elements.container[o].inject(this.elements.container.filterDiv);var r=function(e){a=0,this._dropFilterCB(e)}.bind(this);this.elements.container.filterDiv.addEventListener("dragover",function(e){return e.dataTransfer.dropEffect="move",e.preventDefault(),e.stopPropagation(),n.dataTransferDropEffect(e),!1}),this.elements.container.filterDiv.addEventListener("drop",r)}else UWA.is(n.options.dropOnInvite,"function")&&(this.elements.container.addEventListener("dragover",function(e){return e.preventDefault(),e.stopPropagation(),n.dataTransferDropEffect(e),!1}),this.elements.container.addEventListener("drop",function(e){return n.options.dropOnInvite(e),!1}));this.getOption("renderTo")&&this.elements.container.inject(this.getOption("renderTo"))},_dropFilterCB:function(e){e.preventDefault(),e.stopPropagation(),this.elements.container.removeClassName("withFilterOpen"),this.elements.container.filterDiv.style.display="none";var t=r.get();if(e.dataTransfer.files&&e.dataTransfer.files.length>0){var n=t?t.options.model:null;return n&&0===n.getRoots().length?this.show("drop"):this.hide(),!1}let i=!1;t&&t.publish?t.publish({event:"onFilterDropped"}):i=!0;var s=d.deserializeDroppedData(e);return"wafr"!==l.getSetting("eno3dviewer_infrastructure_version")||i?require(["DS/ApplicationFrame/CommandsManager"],function(e){var n=e.getCommand("FilterDropObjects","function"==typeof t.getCommandContext?t.getCommandContext():null);if(n)if(i){let e={isWP:!1,fromProxy:!1,loadWithFilter:!0};n.execute(s,e)}else n.execute(s);else console.error("PADDnDInvite : _dropFilterCB() - The command PAD3DViewerFilterDropObjectsHdr is undefined");this.hide()}.bind(this)):t.loadSource("DS/ENOPAD3DViewer/commands/PAD3DViewerFilterDropObjectsCmd").then(e=>{(new e).execute(s)}).catch(e=>{console.error("PADDnDInvite : _dropFilterCB() - The command PAD3DViewerFilterDropObjectsCmd is undefined")}),!1},_createDropHereInvite:function(){this.elements.container=UWA.createElement("div",{class:this.getClassNames("_drop_here"),draggable:!1}),UWA.createElement("i",{class:this.getClassNames("_img wux-ui-3ds wux-ui-3ds-4x wux-ui-3ds-drag-drop")}).inject(this.elements.container),UWA.createElement("h5",{class:this.getClassNames("_txt drop_here"),text:t.PADDropInvit_drop_here}).inject(this.elements.container),this.getOption("renderTo")&&this.elements.container.inject(this.getOption("renderTo"))},show:function(e){switch(this.getMode()){case"none":break;case"drop_here":"drop"===e?(this.elements.container.show(),this.dispatchEvent("toggleInvite",!0)):"block"===this.elements.container.getStyle("display")&&(this.elements.container.hide(),this.dispatchEvent("toggleInvite",!0));break;default:this.options.active_invite!==e&&(UWA.is(e,"string")?(this.options.active_invite!==e&&""!==this.options.active_invite&&this.elements.container[this.options.active_invite].hide(),this.options.active_invite=e):this.options.active_invite="drop","drop"===this.options.active_invite?this.elements.container.informationDiv.style.pointerEvents="auto":this.elements.container.informationDiv.style.pointerEvents="none",this.elements.container[this.options.active_invite].show(),this.elements.container.show(),this.dispatchEvent("toggleInvite",!0))}},hide:function(e){switch(this.getMode()){case"none":this.options.active_invite="";break;case"drop_here":"block"===this.elements.container.getStyle("display")&&(this.elements.container.hide(),this.dispatchEvent("toggleInvite",!0));break;default:UWA.is(e,"string")?""!==this.options.active_invite&&this.options.active_invite===e&&(this.elements.container[this.options.active_invite].hide(),this.elements.container.hide()):""!==this.options.active_invite&&(this.elements.container[this.options.active_invite].hide(),this.elements.container.hide()),this.options.active_invite="",this.dispatchEvent("toggleInvite",!1)}},getMode:function(){return c.isWebInWinContext()?"none":this.options.mode},isEventInside:function(e){if("none"===this.getMode())return!1;var t,n,i,s,o,a=(n=0,i=0,(t=e).pageX||t.pageY?(n=t.pageX,i=t.pageY):(t.clientX||t.clientY)&&(n=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:n,y:i});if(!this.elements.container.isHidden()){var r=this.elements.container.getBoundingClientRect();if((s=a).y>=(o=r).top&&s.y<=o.bottom&&s.x>=o.left&&s.x<=o.right)return!0}return!1}})}),define("DS/PADUtils/PADTypesMgt",["i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADUtils/views/PADAlert"],function(e,t,n,i){"use strict";var s={},o={authorized_types:[],type_kind:{},type_kind_setting:{},types_hierarchies:{},displayNotification:function(t,n){i.displayNotification({msg:e.replace(e.get("unsupported_type"),{type:t,name:n||""}),eventID:"warning"})},retrieveKind:function(e){var t;for(var n in o.type_kind)if(-1!==o.type_kind[n].indexOf(e)){t=n;break}if(!t){for(var i in o.type_kind_setting)if(-1!==o.type_kind_setting[i].indexOf(e)){t=i,o.type_kind[i]||(o.type_kind[i]=[]),o.type_kind[i].includes(e)||o.type_kind[i].push(e);break}t||(t="Product")}return t}};return s.isTypesAuthorized=function(e,n,i,s,a){var r=[],l=[],c={},d=t.getSetting("authorized_root_types");o.type_kind_setting=t.getSetting("type_kind");var p={},u=!0===s?[]:t.getSetting("unsupported_root_types");u||(u=[]),e.forEach(function(e){if(-1!==o.authorized_types.indexOf(e.type)||-1!==d.indexOf(e.type)){if(r.push(e.type),"2.0"===a){p.supportedTypes||(p.supportedTypes={});var t=o.retrieveKind(e.type);t?(p.supportedTypes[t]||(p.supportedTypes[t]=[]),p.supportedTypes[t].push(e.type),o.type_kind[t]||(o.type_kind[t]=[]),o.type_kind[t].push(e.type)):(p.supportedTypes.Product||(p.supportedTypes.Product=[]),p.supportedTypes.Product.push(e.type),o.type_kind.Product||(o.type_kind.Product=[]),o.type_kind.Product.push(e.type))}}else l.push(e.type),c[e.type]=e.displayType}),console.debug("process unknown_types",l),l.length?require(["DS/PADUtils/PADWSAccess"],function(e){e.getTypesHierarchy({types:l,onComplete:function(e){var t=!1;(UWA.is(e,"string")?JSON.parse(e):e).types_hierarchies.forEach(function(e){let n=e.type;o.types_hierarchies[n]||(o.types_hierarchies[n]=e.hierarchy,o.types_hierarchies[n].push(n));for(var l,h=!1,g=0;g<e.hierarchy.length&&!1===h;g++){let t=e.hierarchy[g];if(-1!==d.indexOf(e.hierarchy[g]))if(-1!==u.indexOf(n))h=!1;else{h=!0,l=t;let e=o.retrieveKind(l);e&&(console.debug(n," add to ",e),o.type_kind[e]||(o.type_kind[e]=[]),o.type_kind[e].includes(n)||o.type_kind[e].push(n))}}if(!0===h){if(!0!==s&&o.authorized_types.push(e.type),r.push(e.type),"2.0"===a){p.supportedTypes||(p.supportedTypes={});var f=o.retrieveKind(l);f?(p.supportedTypes[f]||(p.supportedTypes[f]=[]),p.supportedTypes[f].includes(e.type)||p.supportedTypes[f].push(e.type),o.type_kind[f]||(o.type_kind[f]=[]),o.type_kind[f].includes(e.typ)||o.type_kind[f].push(e.typ)):(p.supportedTypes.Product||(p.supportedTypes.Product=[]),p.supportedTypes.Product.push(e.type),o.type_kind.Product||(o.type_kind.Product=[]),o.type_kind.Product.push(l))}}else i&&(o.displayNotification(c[e.type],""),t=!0)}),t&&(p.unsupportedDropNotified=!0),n(r,p)},onFailure:function(e){n(r,p)}})}):n(r,p)},s.retrieveAuthorizedObjects=function(a){var r;r=a.X3DContentId?a.X3DContentId:a.unserializedData?a.unserializedData:n.deserializeDroppedData(a.dnd_event);var l=[],c={authorized_objects:[],unauthorized_objects:[]},d="WITHOUT_CONTEXT";a.dnd_event?d=a.dnd_event.shiftKey?"WITHOUT_CONTEXT":"WITH_CONTEXT":a.behavior&&(d=a.behavior),c.source_data=UWA.clone(r),delete c.source_data.data;var p=void 0===a.displayNotif||a.displayNotif;UWA.is(r.data)&&UWA.is(r.data.items,"array")&&r.data.items.length>0?!0===t.getSetting("accept_all_types")?(console.log("Accept all types"),c.authorized_objects=r.data.items,a.callback(c)):("2.0"===a.version&&(c.authorizedWithKind={}),r.data.items.forEach(function(e){var t=e.objectType;UWA.is(e.objectType_Internal)&&(t=e.objectType_Internal);var n=e.displayType;"WITH_CONTEXT"===d&&e.path&&e.path.length>1&&e.path[0].type&&l.push({type:e.path[0].type,displayType:e.path[0].type}),t&&0!==t.length?-1===l.indexOf(t)&&l.push({type:t,displayType:n}):(console.warn("No type available ==> Object not supported"),c.unauthorized_objects.push(e))}),s.isTypesAuthorized(l,function(t,n){n&&n.unsupportedDropNotified&&(c.unsupportedDropNotified=!0),r.data.items.forEach(function(n){var s=n.objectType;if(UWA.is(n.objectType_Internal)&&(s=n.objectType_Internal),"WITH_CONTEXT"===d&&n.path&&n.path.length>1&&n.path[0].type&&(-1===t.indexOf(n.path[0].type)?n.path=[{resourceid:n.objectId,type:s}]:s=n.path[0].type),-1!==t.indexOf(s)){if("2.0"===a.version){var r=o.retrieveKind(s);c.authorizedWithKind[r]||(c.authorizedWithKind[r]=[]),c.authorizedWithKind[r].push(n)}c.authorized_objects.push(n)}else c.unauthorized_objects.push(n),!0===a.notifPerObjects&&(i.displayNotification({msg:e.replace(e.get("unsupported_type"),{type:n.displayType,name:n.displayName}),eventID:"warning"}),c.unsupportedDropNotified=!1)}),a.callback(c)},p,a.isFindInCtx,a.version)):(c.unsupportedDropNotified=!0,a.callback(c))},s.retrieveHierarchy=function(e,t){for(var n={},i=[],s=0;s<e.length;s++)o.types_hierarchies[e[s]]?n[e[s]]=UWA.clone(o.types_hierarchies[e[s]]):i.push(e[s]);i.length>0?require(["DS/PADUtils/PADWSAccess"],function(e){e.getTypesHierarchy({types:i,onComplete:function(e){(UWA.is(e,"string")?JSON.parse(e):e).types_hierarchies.forEach(function(e){void 0===o.types_hierarchies[e.type]&&(o.types_hierarchies[e.type]=e.hierarchy,o.types_hierarchies[e.type].push(e.type)),n[e.type]=e.hierarchy,n[e.type].push(e.type),t(n)})},onFailure:function(e){console.warn("Cannot retrieve hierarchy"),i.forEach(function(e){n[e]=[e],t(n)})}})}):t(n)},s}),define("DS/PADUtils/commands/PADOpenInCADBaseCmd",["DS/ApplicationFrame/Command","DS/PlatformAPI/PlatformAPI","DS/PADUtils/PADWebInWinServices"],function(e,t,n){"use strict";return e.extend({_context:null,init:function(e){this._parent(e),"undefined"!=typeof widget&&(this._context=widget.getValue("addinmode"))},getSelection:function(e){console.error("This method must be overloaded to give your selection back"),console.error("Data given in input of the callback must respect 'setTypes' schema")},execute:function(){this.getSelection(function(e){UWA.is(e.setObject,"object")?t.publish("webinwin:web:notification",JSON.stringify({operation:"open/setObject",operationVersion:"1.0",content:[{phid:e.setObject.objectId}]})):t.publish("webinwin:web:notification",JSON.stringify({operation:"open/setTypes",operationVersion:"1.0",content:e}))})},isAvailable:function(){return n.isWebInWinContext()}})}),define("DS/PADUtils/commands/PADOpenInCAD",["text!DS/PADUtils/assets/PADOpenCommandsSettings.json","DS/ApplicationFrame/Command","DS/PADUtils/commands/PADOpenInCADBaseCmd","DS/PADUtils/PADContext","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","require"],function(e,t,n,i,s,o,a){"use strict";return n.extend({init:function(e){this._parent(e)},getSelection:function(t){var n,r=i.get().getPADTreeDocument().getSelectedNodesForOFW(),l=JSON.parse(e);null==l["openInCAD_"+this._context+"_expand_at_open"]||l["openInCAD_"+this._context+"_expand_at_open"];if(o.isAuthoringCtxAvailable())try{n=a("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext").get()}catch(e){console.warn("CfgAuthoringContext throw an error")}if("solidworks"!==this._context&&("catiav5"!==this._context||1!==r.length||!r[0].isRoot()||UWA.is(r[0].options.config_filter)||UWA.is(r[0].options.sequence_filter)||UWA.is(n)&&""!==n.change.id||!0!==s.getSetting("directOpenPCS")))a(["DS/ENXNav/utils/OFW"],e=>{e.buildDataForSetTypes(r,i.get().getPADTreeDocument()).then(e=>{t(e)})});else{var c={setObject:{objectId:r[0].getID(),envId:o.getPlatformId(),contextId:s.getSetting("pad_security_ctx")}};t(c)}}})}),define("DS/PADUtils/PADProbes",["UWA/Core","UWA/Class","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/PADServices/utils/PADTrackerManager"],function(e,t,n,i,s){"use strict";var o=t.singleton({initialize:function(e){},createProbe:function(e,t){var i={end:function(){},dump:function(){}};return this._initialized||(this._isActivated=n.getSetting("probes_activated"),this._initialized=!0),this._isActivated&&(i=new a(e,t)),i},networkprobe:function(e){var t,n,i=e.request_options,o=e.wsName?e.wsName:function(e){var t=e.split("/");if(t.length>5){var n=t[t.length-1],i=t[t.length-1].indexOf("?");return-1!==i&&(n=n.substring(0,i),t[t.length-1]=n),t.slice(4,t.length).join("/")}return 0===t[t.length-1].length?t[t.length-2]:t[t.length-1]}(e.url),a=o,r=this.createProbe("query_"+o,a);return r.txKey=e.txKey,i.onComplete=(t=i.onComplete,function(e){if(r.end(),r.eventName){var n=s.getPADTracker({eventCategory:"usage",eventAction:"query"}),i=r.startTime&&r.finishTime?r.finishTime-r.startTime:void 0;n.setEventData({eventLabel:r.eventName,eventValue:i,txKey:r.txKey}),n.trackPageEvent()}if(UWA.is(t,"function"))return t.apply(this,Array.prototype.slice.call(arguments))}),i.onFailure=(n=i.onFailure,function(e){if(r.end(),r.eventName){var t=s.getPADTracker({eventCategory:"usage",eventAction:"queryFailed"}),i=r.startTime&&r.finishTime?r.finishTime-r.startTime:void 0;t.setEventData({eventLabel:r.eventName,eventValue:i}),t.trackPageEvent()}if(UWA.is(n,"function"))return n.apply(this,Array.prototype.slice.call(arguments))}),i}});function a(e,t){this.id=i.getPCSPrefix()+"_"+e,this.inprogress=!0,this.stamp=window.top.performance.now(),this.beginMark=this.id+"__begin_"+this.stamp,this.endMark=this.id+"__end_"+this.stamp,window.top.performance.mark(this.beginMark),this.startTime=Date.now(),void 0!==t&&(this.eventName=t)}return a.prototype.end=function(){!0===this.inprogress&&(this.inprogress=!1,window.top.performance.mark(this.endMark),this.finishTime=Date.now(),window.top.performance.measure(this.id,this.beginMark,this.endMark))},a.prototype.dump=function(){console.log(window.top.performance.getEntriesByName(this.id))},o}),define("DS/PADUtils/utilsWS/WSUtils",["DS/WAFData/WAFData","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADProbes","DS/PADUtils/Configuration"],function(e,t,n,i){"use strict";function s(e,t){for(var n=0;n<t.length;n++)-1===e.indexOf(t[n])&&e.push(t[n]);return e}var o={executeRequest:function(i,s,o,a){var r=require("DS/PADUtils/PADSettingsMgt").getSetting("pad_security_ctx");if(UWA.is(r,"string")&&!0!==o&&(s.headers.SecurityContext=r,!0!==a)){var l=t.getUser();l&&l.login&&(s.headers.SecurityToken=l.login+"|"+r+"|preferred")}n.networkprobe({url:i,request_options:s,wsName:s.wsName,txKey:s.txKey});return e.authenticatedRequest(i,s)},completeWebAPIPayload:function(e,t,n){var o=i.getWebAPIOptions(e);if(t=UWA.extend(o.config,t),!0===n.withThumbnail2D&&t.select_file.push("thumbnail_2D"),o.mandatoryAttr)for(var a=Object.getOwnPropertyNames(o.mandatoryAttr),r=0;r<a.length;r++){var l=a[r];if(void 0===t[l])t[l]=o.mandatoryAttr[l];else if(UWA.is(t[l],"array")&&UWA.is(o.mandatoryAttr[l],"array"))for(var c=0;c<o.mandatoryAttr[l].length;c++)-1===t[l].indexOf(o.mandatoryAttr[l][c])&&t[l].push(o.mandatoryAttr[l][c]);else console.warn("##WSUtils: Unknown kind of property to complete")}var d=require("DS/PADServices/utils/AttributesMgtV2").createOutputsRequest(e);return t.select_bo&&(t.select_bo=s(t.select_bo,d.select_object)),t.select_predicate&&(t.select_predicate=s(t.select_predicate,d.select_object)),t.select_rel&&(t.select_rel=s(t.select_rel,d.select_relation)),!0===require("DS/PADUtils/PADSettingsMgt").getSetting("pgpFromServer")&&(t.select_pgp=["Show"],t.select_bo&&-1===t.select_bo.indexOf("bo.PGPShowExtension.V_PGP_Show")&&t.select_bo.push("bo.PGPShowExtension.V_PGP_Show"),t.select_rel&&-1===t.select_rel.indexOf("ro.PGPShowExtension.V_PGP_Show")&&t.select_rel.push("ro.PGPShowExtension.V_PGP_Show"),t.select_predicate&&-1===t.select_predicate.indexOf("bo.PGPShowExtension.V_PGP_Show")&&t.select_predicate.push("bo.PGPShowExtension.V_PGP_Show"),"explore_2D"!==t.intent&&(t.select_pgp=["Show","Color","Opacity"],t.select_bo&&-1===t.select_bo.indexOf("bo.PGPColorExtension.V_PGP_ColorRGB.Asstring")&&t.select_bo.push("bo.PGPColorExtension.V_PGP_ColorRGB.Asstring"),t.select_rel&&-1===t.select_rel.indexOf("ro.PGPColorExtension.V_PGP_ColorRGB.Asstring")&&t.select_rel.push("ro.PGPColorExtension.V_PGP_ColorRGB.Asstring"),t.select_predicate&&-1===t.select_predicate.indexOf("bo.PGPColorExtension.V_PGP_ColorRGB.Asstring")&&t.select_predicate.push("bo.PGPColorExtension.V_PGP_ColorRGB.Asstring"),t.select_bo&&-1===t.select_bo.indexOf("bo.PGPOpacityExtension.V_PGP_Opacity")&&t.select_bo.push("bo.PGPOpacityExtension.V_PGP_Opacity"),t.select_rel&&-1===t.select_rel.indexOf("ro.PGPOpacityExtension.V_PGP_Opacity")&&t.select_rel.push("ro.PGPOpacityExtension.V_PGP_Opacity"),t.select_predicate&&-1===t.select_predicate.indexOf("bo.PGPOpacityExtension.V_PGP_Opacity")&&t.select_predicate.push("bo.PGPOpacityExtension.V_PGP_Opacity"),t.select_bo&&-1===t.select_bo.indexOf("bo.PGPInheritanceExtension.V_PGP_Inheritance")&&t.select_bo.push("bo.PGPInheritanceExtension.V_PGP_Inheritance"),t.select_rel&&-1===t.select_rel.indexOf("ro.PGPInheritanceExtension.V_PGP_Inheritance")&&t.select_rel.push("ro.PGPInheritanceExtension.V_PGP_Inheritance"),t.select_predicate&&-1===t.select_predicate.indexOf("bo.PGPInheritanceExtension.V_PGP_Inheritance")&&t.select_predicate.push("bo.PGPInheritanceExtension.V_PGP_Inheritance"))),t},executeSplittedRequest:function(e,t,n){({pattern:n,max:void 0===n.max?10:n.max,url:e,options:UWA.clone(t,!1),onComplete:t.onComplete,onFailure:t.onFailure,onTimeout:t.onTimeout||t.onFailure,onCancel:t.onCancel||t.onFailure,execute:function(){void 0!==this.pattern.init&&(this.data=this.options.data,this.data=UWA.is(this.data,"string")?JSON.parse(this.data):this.data,this.options.onComplete=function(e,t){var n=(e=UWA.is(e,"string")?JSON.parse(e):e)[this.pattern.init.response.packets];void 0!==n?this.executePackets(n):void 0!==this.onComplete&&this.onComplete(e,t)}.bind(this),UWA.extend(this.data,this.pattern.init.query,!0),this.options.data=JSON.stringify(this.data),o.executeRequest(this.url,UWA.clone(this.options,!1)))},executePackets:function(e){if(this.packets=e,this.pending=0,this.response={},this.stopped=!1,void 0!==this.pattern.init&&void 0!==this.pattern.init.query)for(var t in this.pattern.init.query)delete this.data[t];if(void 0!==this.pattern.packet.query.remove)for(var n=0;n<this.pattern.packet.query.remove.length;n++)delete this.data[this.pattern.packet.query.remove[n]];this.options.onComplete=this.onPacketComplete.bind(this),this.options.onFailure=this.onPacketFailure.bind(this),this.options.onTimeout=this.onPacketTimeout.bind(this),this.options.onCancel=this.onPacketCancel.bind(this),this.executePacket()},executePacket:function(){for(;this.pending<this.max&&void 0!==this.packets&&this.packets.length>0;)this.data[this.pattern.packet.query.packet]=this.packets.shift(),this.options.data=JSON.stringify(this.data),this.pending++,o.executeRequest(this.url,UWA.clone(this.options,!1))},onPacketCancel:function(e){this.stopped||(this.stopped=!0,void 0!==this.onCancel&&this.onCancel(e))},onPacketTimeout:function(e){this.stopped||(this.stopped=!0,void 0!==this.onTimeout&&this.onTimeout(e))},onPacketFailure:function(e){this.stopped||(this.stopped=!0,void 0!==this.onFailure&&this.onFailure(e))},onPacketComplete:function(e,t){if(this.pending--,!this.stopped){e=UWA.is(e,"string")?JSON.parse(e):e;var n=this.pattern.packet.response.concat;if(void 0!==n)for(var i=0;i<n.length;i++){this.response[n[i]]=this.response[n[i]]||[];var s=this.updateResponsePacket(e[n[i]]);this.response[n[i]]=this.response[n[i]].concat(s)}var o=this.pattern.packet.response.copy;if(void 0!==o)for(var a=0;a<o.length;a++)"full_path"!==o[a]||!1!==this.response[o[a]]&&!1!==e[o[a]]?this.response[o[a]]=e[o[a]]:this.response[o[a]]=!1;0===this.packets.length&&0===this.pending?void 0!==this.onComplete&&this.onComplete(this.response,t):this.executePacket()}},updateResponsePacket:function(e){for(var t=[],n=Date.now(),i=0;i<e.length;i++){var s=e[i],o=0;if(s.attributes){for(o=0;o<s.attributes.length;o++)"did"===s.attributes[o].name&&(s.attributes[o].value=n+"-"+s.attributes[o].value)}else if(s.path)for(o=0;o<s.path.length;o++)s.path[o]=n+"-"+s.path[o];else if(s.pgp_overload){var a=Object.getOwnPropertyNames(s.pgp_overload);for(o=0;o<a.length;o++){for(var r=a[o].split(","),l=0;l<r.length;l++)r[l]=n+"-"+r[l];s.pgp_overload[r.toString()]=s.pgp_overload[a[o]],delete s.pgp_overload[a[o]]}}t.push(s)}return t}}).execute()},MassChunkedRequests:function(e){var t,n,i,s,o=e.chunkSize||30,a=[],r=0,l=0,c=0,d=!1,p=this;this.process=function(){if(r!==s&&"function"==typeof e.cbOnProcess){var t=n.slice(l,l+o);e.cbOnProcess(p,t)}},this.reprocess=function(){if(!d&&"function"==typeof e.cbOnProcess){var t=n.slice(l,l+o);e.cbOnProcess(p,t)}},this.setAnswer=function(n,u){if(!d){if(r++,t?i.push({request:n,answer:u}):i[n]=u,a.push(u),"function"==typeof e.cbOnProgress){var h=r/s;e.cbOnProgress(p,h,n)}r>c&&(l=c+1,(c+=o)>=s&&(c=s-1),this.process()),r>=s&&"function"==typeof e.cbOnComplete&&(e.cbOnComplete(p),d=!0)}},this.getAnswer=function(e){if(void 0!==t){if(!t)return i[e];for(var n=JSON.stringify(e),s=0,o=i.length;s<o;s++){if(n===JSON.stringify(i[s].request))return i[s].answer}}},this.getAnswers=function(){if(void 0!==t)return{results:a}},this.cancel=function(){d=!0,"function"==typeof e.cbOnComplete&&e.cbOnComplete(p),e.cbOnCancel&&"function"==typeof e.cbOnCancel&&e.cbOnCancel(p)},this.start=function(){if(void 0!==e.requests&&Array.isArray(e.requests)&&(s=e.requests.length)>0&&("string"==typeof e.requests[0]?(t=!1,i={},n=e.requests.filter(function(e,t,n){return n.indexOf(e)==t}),s=n.length):"object"==typeof e.requests[0]&&(t=!0,i=[],n=e.requests),void 0!==t))return l=0,(c=o-1)>=s&&(c=s-1),void this.process();"function"==typeof e.cbOnComplete&&e.cbOnComplete(p)},this.start()},MassChunkedRequestsLWC:function(e){var t,n,i,s,o=e.chunkSize||30,a=[],r=[],l=0,c=!1,d=this;this.process=function(){if(r.length!==s&&"function"==typeof e.cbOnProcess){var t=n.slice(l,l+o);e.cbOnProcess(d,t)}},this.reprocess=function(){if(!c&&"function"==typeof e.cbOnProcess){var t=n.slice(l,l+o);e.cbOnProcess(d,t)}},this.setAnswer=function(n,o){if(!c){var l;if(0,t?i.push({request:n,answer:o}):i[n]=o,o.path&&(l=o.path.join("_"),r.push(l)),a.push(o),"function"==typeof e.cbOnProgress){var p=r.length/s;e.cbOnProgress(d,p,n)}r.length===s&&"function"==typeof e.cbOnComplete&&(e.cbOnComplete(d),c=!0)}},this.setAnswers=function(t,n){if(a=n,r=t,"function"==typeof e.cbOnProgress){var i=r.length/s;e.cbOnProgress(d,i,t)}"function"==typeof e.cbOnComplete&&(e.cbOnComplete(d),c=!0)},this.getAnswer=function(e){if(void 0!==t){if(!t)return i[e];for(var n=JSON.stringify(e),s=0,o=i.length;s<o;s++){if(n===JSON.stringify(i[s].request))return i[s].answer}}},this.getAnswers=function(){if(void 0!==t)return{results:a}},this.cancel=function(){c=!0,"function"==typeof e.cbOnComplete&&e.cbOnComplete(d),e.cbOnCancel&&"function"==typeof e.cbOnCancel&&e.cbOnCancel(d)},this.start=function(){if(void 0!==e.requests&&Array.isArray(e.requests)&&(s=e.requests.length)>0&&("string"==typeof e.requests[0]?(t=!1,i={},n=e.requests.filter(function(e,t,n){return n.indexOf(e)==t}),s=n.length):"object"==typeof e.requests[0]&&(t=!0,i=[],n=e.requests),void 0!==t))return l=0,o-1>=s&&s-1,void this.process();"function"==typeof e.cbOnComplete&&e.cbOnComplete(d)},this.start()}};return o}),define("DS/PADUtils/utilsWS/PADLWCAccess",["UWA/Core","DS/PADUtils/PADSession","DS/PADUtils/PADUtilsServices","DS/PADUtils/utilsWS/WSUtils"],function(e,t,n,i){"use strict";var s={url:"/resources/enopad/lwc/fetch",verb:"POST"},o={url:"/resources/enopad/lwc/expand",verb:"POST"},a={url:"/resources/enopad/lwc/refresh",verb:"POST"};return{fetch:function(e){var o,a=e,r=require("DS/PADUtils/PADSettingsMgt");r.getSetting("pad_security_ctx")&&r.getSetting("pad_security_ctx");if(!UWA.is(a,"object"))throw new Error("Invalid inputs for PADLWCAccess.fetch");a.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":r.getSetting("lang")},a.timeout||(a.timeout=r.getSetting("webapi_timeout"));var l=s,c=void 0!==a.data.authored?a.data.authored:t.determineAuthoredFlag();a.method=l.verb,o=n.get3DSpaceUrl()+l.url+"?tenant="+n.getPlatformId();var d=[];a.pids.forEach(function(e){UWA.is(e,"array")&&e.length>1?d.push(e[e.length-1]):d.push(e)});var p={label:n.getRequestLabel(),query:"physicalid:"+d.join(" OR physicalid:"),intent:a.data.intent,nresults:a.pids.length,tenant:n.getPlatformId(),authored:c,select_file:a.data.select_file,fcs_url_mode:void 0!==a.data.fcs_url_mode?a.data.fcs_url_mode:void 0};return void 0===p.include_param_Attributes&&r.getSetting("readsettingsv2")&&(p.include_param_Attributes=!0),!0===r.getSetting("pgpFromServer")&&(p.select_pgp=["Show"],!0===r.getSetting("pgpColorFromServer")&&(p.select_pgp=["Show","Color","Opacity"])),a.data=JSON.stringify(p),a.onTimeout=a.onTimeout||a.onFailure,i.executeRequest(o,a)},expand:function(e){var s,a=e,r=require("DS/PADUtils/PADSettingsMgt");r.getSetting("pad_security_ctx")&&r.getSetting("pad_security_ctx");if(!UWA.is(a,"object"))throw new Error("Invalid inputs for PADLWCAccess.fetch");a.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":r.getSetting("lang")},a.timeout||(a.timeout=r.getSetting("webapi_timeout"));var l=o;void 0!==a.data.authored?a.data.authored:t.determineAuthoredFlag();if(a.method=l.verb,s=n.get3DSpaceUrl()+l.url+"?tenant="+n.getPlatformId(),r.getSetting("readsettingsv2")&&(a.data.include_param_Attributes=!0),!UWA.is(a.data.roots)&&UWA.is(a.data.root_physicalid)?a.data.roots=[{id:a.data.root_physicalid}]:!UWA.is(a.data.paths)&&UWA.is(a.data.root_path_physicalid)&&(a.data.paths=a.data.root_path_physicalid),UWA.is(a.data.level)||(a.data.level=a.data.expand_iter),UWA.is(a.data.intent)||(a.data.intent="explore_2D"),UWA.is(a.data.source)||(a.data.source="cstorage"),UWA.is(a.data.authored)||UWA.is(a.data.find_path_filter)||(a.data.authored=void 0!==a.data.authored?a.data.authored:t.determineAuthoredFlag()),a.data.label=n.getRequestLabel(),!0===r.getSetting("pgpFromServer")&&(a.data.select_pgp=["Show"],!0===r.getSetting("pgpColorFromServer")&&(a.data.select_pgp=["Show","Color","Opacity"])),delete a.data.root_physicalid,delete a.data.expand_iter,delete a.data.enopad_webapis,delete a.data.select_bo,delete a.data.select_rel,delete a.data.select_ds6w_facet,!UWA.is(a.data.roots)&&!UWA.is(a.data.paths))throw new Error("## PADWSv1.navigate: Invalid inputs: no root_physical_id or no root_path_physicalid found");return a.onTimeout=a.onTimeout||a.onFailure,a.data=JSON.stringify(a.data),i.executeRequest(s,a)},refresh:function(e){var s=require("DS/PADUtils/PADSettingsMgt"),o=a,r=n.get3DSpaceUrl()+o.url+"?tenant="+n.getPlatformId();if(!UWA.is(r)||!UWA.is(e,"object"))throw new Error("## PADWSv1.refresh: Invalid inputs");if(!UWA.is(e.data,"object"))throw new Error("## PADWSv1.refresh: Invalid inputs - options.data not found");e.method=o.verb,e.headers={Accept:"application/json","Content-Type":"application/json"},UWA.is(e.data.intent)||(e.data.intent="explore_2D"),UWA.is(e.data.source)||(e.data.source="cstorage"),s.getSetting("readsettingsv2")&&(e.data.include_param_Attributes=!0),e.data.authored=e.data.authored?e.data.authored:!t.isUsingIndex(),e.data.label=n.getRequestLabel(),!0===s.getSetting("pgpFromServer")&&(e.data.select_pgp=["Show"],!0===s.getSetting("pgpColorFromServer")&&(e.data.select_pgp=["Show","Color","Opacity"])),e.onTimeout=e.onTimeout||e.onFailure,e.data=JSON.stringify(e.data),i.executeSplittedRequest(r,e,{max:1,init:{query:{split:!0},response:{packets:"packets"}},packet:{query:{packet:"packet",remove:[]},response:{concat:["results"],copy:["full_path"]}}})}}}),define("DS/PADUtils/utilsWS/WSAdmin",["DS/WAFData/WAFData","DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/Configuration","DS/PADUtils/PADUtilsServices"],function(e,t,n,i){"use strict";var s={url:"/resources/modeler/pno/person?current=true&select=preferredcredentials&select=collabspaces",verb:"GET"},o={url:"/resources/6WVocab/access/PredicatesNLSNames",verb:"GET"},a={url:"/resources/AppsMngt/user/preference",verb:"GET"},r={url:"/resources/AppsMngt/user/preference",verb:"PUT"},l={url:"/resources/enopad/admin/readsettings/v2",verb:"GET"},c={url:"/resources/enong/dico/gettypeshierarchy",verb:"POST"},d={url:"/resources/dictionary/getTypeInfo",verb:"POST"},p={url:"/resources/dictionary/class/interfaces",verb:"POST"};return{getscandcollab:function(e){var n=require("DS/PADUtils/PADSettingsMgt"),o=e,a=s,r=o.tenant?o.tenant:i.getPlatformId(),l=i.get3DSpaceUrl(r)+a.url+"&tenant="+r;return o.method=a.verb,o.headers={Accept:"application/json","Accept-Language":n.getSetting("lang"),"Content-Type":"application/json"},o.cache=-1,t.executeRequest(l,o,!0)},predicates_nls_names:function(e){var n=require("DS/PADUtils/PADSettingsMgt");if(!0===n.getSetting("FedDictionnaryAccess"))throw new Error("## WSAdmin.predicates_nls_names: Call new FedDictionaryAccessAPI instead");var s=o,a=i.get3DSpaceUrl()+s.url,r=e;return r.method=s.verb,r.headers={Accept:"application/json","Accept-Language":n.getSetting("lang")},r.data="name="+e.name+"&tenant="+i.getPlatformId(),t.executeRequest(a,r)},getElementsNLSNames:function(t){if(!0===require("DS/PADUtils/PADSettingsMgt").getSetting("FedDictionnaryAccess"))throw new Error("## WSAdmin.getElementsNLSNames: Call new FedDictionaryAccessAPI instead");var n=t||{},s=i.get3DSpaceUrl()+"/resources/6WVocab/access/ElementsNLSNames?tenant="+i.getPlatformId();n.method="POST",n.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":t.lang},n.data=t.elementsNLSNames,e.authenticatedRequest(s,n)},getPredicates:function(t){var n=require("DS/PADUtils/PADSettingsMgt");if(!0===n.getSetting("FedDictionnaryAccess"))throw new Error("## WSAdmin.getElementsNLSNames: Call new FedDictionaryAccessAPI instead");var s=t||{},o=i.get3DSpaceUrl()+"/resources/6WVocab/access/Predicates?tenant="+i.getPlatformId();s.method="POST",s.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":n.getSetting("lang")},s.data=t.classURIs,e.authenticatedRequest(o,s)},getVocabularyClasses:function(t){var n=require("DS/PADUtils/PADSettingsMgt");if(!0===n.getSetting("FedDictionnaryAccess"))throw new Error("## WSAdmin.getElementsNLSNames: Call new FedDictionaryAccessAPI instead");var s=t||{},o=i.get3DSpaceUrl()+"/resources/6WVocab/access/VocabularyClasses?tenant="+i.getPlatformId();s.method="GET",s.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":n.getSetting("lang")},s.timeout=6e4,s.data="name="+t.vocabularyname,e.authenticatedRequest(o,s)},getTypeInfo:function(e){var n=require("DS/PADUtils/PADSettingsMgt"),s=d,o=i.get3DSpaceUrl()+s.url+"?tenant="+i.getPlatformId(),a=e;if(a.url_parameters){for(var r=Object.getOwnPropertyNames(e.url_parameters),l=0;l<r.length;l++)o=o+"&"+r[l]+"="+e.url_parameters[r[l]];delete a.url_parameters}return a.method=s.verb,a.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":n.getSetting("lang")},a.data=JSON.stringify(a.body),delete a.body,t.executeRequest(o,a)},interfaces:function(e){var n=require("DS/PADUtils/PADSettingsMgt"),s=p,o=i.get3DSpaceUrl()+s.url+"?tenant="+i.getPlatformId(),a=e;return a.method=s.verb,a.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":n.getSetting("lang")},a.data=JSON.stringify(a.data),t.executeRequest(o,a)},getMyAppsTemplate:function(e){require("DS/PADUtils/PADSettingsMgt");var n=a,s=i.getPlatformURL("3DCompass")+n.url,o=e;return o.method=n.verb,o.headers={Accept:"application/json, text/plain"},o.data={name:e.preference_name},t.executeRequest(s,o,!0)},saveMyAppsTemplate:function(e){require("DS/PADUtils/PADSettingsMgt");var n=r,s=i.getPlatformURL("3DCompass")+n.url,o=e;return o.method=n.verb,o.headers={Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},o.data={name:e.preference_name,value:e.value},t.executeRequest(s,o,!0)},padtreelistOpts:function(e){require("DS/PADUtils/PADSettingsMgt");var n=l,s=i.get3DSpaceUrl()+n.url+"?tenant="+i.getPlatformId(),o=e;if(o.method=n.verb,o.headers={Accept:"application/json"},void 0===e.data.intent||void 0===e.data.app)throw new Error("Invalid inputs for WSAdmin.padtreelistOpts");return o.data="intent="+e.data.intent+"&app="+e.data.app+"&reset="+(!0===e.data.reset?"true":"false"),t.executeRequest(s,o)},getTypesHierarchy:function(e){require("DS/PADUtils/PADSettingsMgt");var n=c,s=i.get3DSpaceUrl()+n.url+"?tenant="+i.getPlatformId(),o=e;return o.method=n.verb,o.headers={Accept:"application/json","Content-Type":"application/json"},o.data=JSON.stringify({types:e.types}),t.executeRequest(s,o)},getsecuritycontext:function(e){e.onFailure("DEPRECATED METHOD")},availablesecuritycontext:function(e){e.onFailure("DEPRECATED METHOD")},catalogs:function(e){e.onFailure("DEPRECATED METHOD")}}}),define("DS/PADUtils/utilsWS/WS4DECModel",["DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSession"],function(e,t,n){"use strict";var i={modify:{url:"/resources/enopad/authoring/modify",verb:"POST"},insertexisting:{url:"/resources/enopad/authoring/insertexisting",verb:"POST"},replace:{url:"/resources/enopad/authoring/replace",verb:"POST"},reorder:{url:"/resources/enopad/authoring/reorder",verb:"POST"},reparent:{url:"/resources/enopad/authoring/reparent",verb:"POST"},unparent:{url:"/resources/enopad/authoring/unparent",verb:"POST"},deleteinstance:{url:"/resources/enopad/authoring/deleteinstance",verb:"POST"},composite:{url:"/resources/enopad/authoring/composite",verb:"POST"},editability:{url:"/resources/enopad/navigate/editability",verb:"POST"},navigate:{url:"/resources/enopad/navigate/navigate",verb:"POST"},completeselection:{url:"/resources/enov5ma/productstructure/completeselection",verb:"POST"}},s=function(n,s){var o=require("DS/PADUtils/PADSettingsMgt"),a=i[s],r=UWA.clone(n,!1);r.method=a.verb,r.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":o.getSetting("lang")},"object"==typeof r.data&&(r.data=JSON.stringify(r.data));var l=t.get3DSpaceUrl()+a.url+"?tenant="+t.getPlatformId();return console.group(),console.error("======================================="),console.error("=== DEPRECATED USAGE OF THIS WEBAPI ==="),console.error("===    ["+s+"]    ==="),console.error("======================================="),console.groupEnd(),e.executeRequest(l,r)};return{modify:function(n){if(!UWA.is(n,"object"))throw new Error("No parameter defined");if(!UWA.is(n.data,"array"))throw new Error("No input data defined");if(!UWA.is(n.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(n.onFailure,"function"))throw new Error("No onFailure callback function defined");var s={nodes:n.data,commit:!0},o=i.modify,a=t.get3DSpaceUrl();a=a+o.url+"?tenant="+t.getPlatformId();var r={};return r.method=o.verb,r.headers={Accept:"application/json","Content-Type":"application/json"},r.data=JSON.stringify(s),r.onComplete=n.onComplete,r.onFailure=n.onFailure,r.onTimeout=n.onTimeout||n.onFailure,console.group(),console.error("======================================="),console.error("=== DEPRECATED USAGE OF THIS WEBAPI ==="),console.error("===           [modify]              ==="),console.error("======================================="),console.groupEnd(),e.executeRequest(a,r)},insertExisting:function(e){s(e,"insertexisting")},replace:function(e){s(e,"replace")},reorder:function(e){s(e,"reorder")},reParent:function(e){s(e,"reparent")},detach:function(e){s(e,"unparent")},deleteInstance:function(e){s(e,"deleteinstance")},composite:function(e){s(e,"composite")},getEditability:function(s){if(!UWA.is(s,"object"))throw new Error("No options defined");if(!UWA.is(s.data,"object"))throw new Error("No data defined");if(!UWA.is(s.data.ids,"array"))throw new Error("No physicalids defined");if(!UWA.is(s.data.intent,"string"))throw new Error("No intent defined");if(!UWA.is(s.data.name,"array"))throw new Error("No criteria defined");if(!UWA.is(s.data.authored,"boolean"))throw new Error("No authored defined");if(!UWA.is(s.data.lang,"string"))throw new Error("No language defined");if(!UWA.is(s.onComplete,"function"))throw new Error("No onComplete defined");if(!UWA.is(s.onFailure,"function"))throw new Error("No onFailure defined");var o=i.editability,a=t.get3DSpaceUrl()+o.url+"?tenant="+t.getPlatformId();return s.method=o.verb,s.headers={Accept:"application/json","Content-Type":"application/json"},"move"===s.data.name[0]&&"explore_3D"===s.data.intent&&(s.data.rel_physicalid=s.data.ids,delete s.data.ids),UWA.is(s.data.source)||(s.data.source="cstorage"),s.data.authored=s.data.authored?s.data.authored:!n.isUsingIndex(),s.onTimeout=s.onTimeout||s.onFailure,s.data=JSON.stringify(s.data),console.group(),console.error("======================================="),console.error("=== DEPRECATED USAGE OF THIS WEBAPI ==="),console.error("===        [getEditability]         ==="),console.error("======================================="),console.groupEnd(),e.executeRequest(a,s)},navigateOnLinks:function(s){if(!UWA.is(s,"object"))throw new Error("No options defined");if(!UWA.is(s.data,"object"))throw new Error("No data defined");if(!UWA.is(s.data.intent,"string"))throw new Error("No intent defined");if(!UWA.is(s.data.authored,"boolean"))throw new Error("No authored defined");if(!UWA.is(s.data.nav_pattern,"array"))throw new Error("No nav_pattern defined");if(!UWA.is(s.data.nav_pattern[0].name,"string"))throw new Error("No criteria defined");if(!UWA.is(s.data.nav_pattern[0].direction,"string"))throw new Error("No direction defined");if(!UWA.is(s.data.nav_pattern[0].physicalid,"array"))throw new Error("No ids defined");if(!UWA.is(s.onComplete,"function"))throw new Error("No onComplete defined");if(!UWA.is(s.onFailure,"function"))throw new Error("No onFailure defined");var o=i.navigate,a=t.get3DSpaceUrl()+o.url+"?tenant="+t.getPlatformId();if(!UWA.is(a))throw new Error("Invalid inputs for PADWSAccess.navigateOnLinks");return s.method=o.verb,s.headers={Accept:"application/json","Content-Type":"application/json"},UWA.is(s.data.source)||(s.data.source="cstorage"),s.data.authored=s.data.authored?s.data.authored:!n.isUsingIndex(),s.onTimeout=s.onTimeout||s.onFailure,s.data=JSON.stringify(s.data),console.group(),console.error("======================================="),console.error("=== DEPRECATED USAGE OF THIS WEBAPI ==="),console.error("===        [navigateOnLinks]        ==="),console.error("======================================="),console.groupEnd(),e.executeRequest(a,s)},completeselection:function(n){var s=i.completeselection,o=t.get3DSpaceUrl()+s.url+"?tenant="+t.getPlatformId();return n.method=s.verb,n.headers={Accept:"application/json","Content-Type":"application/json"},n.onTimeout=n.onTimeout||n.onFailure,n.data=JSON.stringify(n.data),console.group(),console.error("======================================="),console.error("=== DEPRECATED USAGE OF THIS WEBAPI ==="),console.error("===       [completeselection]       ==="),console.error("======================================="),console.groupEnd(),e.executeRequest(o,n)}}}),define("DS/PADUtils/utilsWS/CVServletServices",["UWA/Core","DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","DS/PADServices/settings/AppSettings"],function(e,t,n,i){"use strict";var s={fetch:{url:"/cvservlet/fetch/v2",verb:"POST"},expand3D:{url:"/cvservlet/expand3d",verb:"POST"},expandv2:{url:"/cvservlet/progressiveexpand/v2",verb:"POST"},progressiveExpand:{url:"/cvservlet/progressiveexpand",verb:"POST"},search:{url:"/search",verb:"POST"},searchv2:{url:"/cvservlet/progressiveexpand/v2",verb:"POST"},indexingdate:{url:"/cvservlet/indexingdate",verb:"POST"}},o=function(e,t){e.push("show"),e.push("hide"),e.push("color"),e.push("opacity"),t.select_bo.push("bo.PGPShowExtension.V_PGP_Show"),t.select_bo.push("bo.PGPColorExtension.V_PGP_ColorRGB.Asstring"),t.select_bo.push("bo.PGPOpacityExtension.V_PGP_Opacity"),t.select_bo.push("bo.PGPInheritanceExtension.V_PGP_Inheritance"),t.select_rel.push("ro.PGPShowExtension.V_PGP_Show"),t.select_rel.push("ro.PGPColorExtension.V_PGP_ColorRGB.Asstring"),t.select_rel.push("ro.PGPOpacityExtension.V_PGP_Opacity"),t.select_rel.push("ro.PGPInheritanceExtension.V_PGP_Inheritance")};return{_logger:{nbCalls:0,inputDataSize:[],outputDataSize:[],inputDataSizeLog:[],outputDataSizeLog:[]},fetch:function(o){var a=require("DS/PADUtils/PADSettingsMgt"),r=a.getSetting("pad_security_ctx")?a.getSetting("pad_security_ctx"):"preferred";let l="";!0===i.getSetting("redirectQueryToSGI")&&(l="&redirectQueryToSGI=true");var c=n.get3DSpaceUrl()+s.fetch.url+"?SecurityContext="+r+"&tenant="+n.getPlatformId()+l,d=o.data;delete o.data;var p=e.extend({method:s.fetch.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":a.getSetting("lang")},timeout:o.timeout?o.timeout:a.getSetting("webapi_timeout")},o),u=e.extend({label:n.getRequestLabel(),physicalid:o.pids,locale:a.getSetting("lang"),tenant:n.getPlatformId()},d);return!0!==o.noCompletion&&(u="fetch_3D"===u.intent?t.completeWebAPIPayload("fetch3d",u,o):t.completeWebAPIPayload("fetch2d",u,o)),delete p.pids,delete p.enopad_webapis,delete u.intent,delete u.authored,u.select_predicate&&(u.select_predicate=u.select_predicate.filter(function(e,t,n){return n.indexOf(e)===t})),p.data=JSON.stringify(u),p.onTimeout=p.onTimeout||p.onFailure,t.executeRequest(c,p)},refresh:function(e){e.data.expand_iter||(e.data.expand_iter="1"),delete e.data.session;for(var t=[],n=[],i=0;i<e.data.root_path_physicalid.length;i++){var s=e.data.root_path_physicalid[i];s.length>1&&(s=s.slice(0,-2));var o=JSON.stringify(s);-1===n.indexOf(o)&&(t.push(s),n.push(o))}e.data.root_path_physicalid=t,this.expand(e)},expand:function(){console.error("Invalid call to PADWSAccess.expand")},expand3d:function(i){var o=require("DS/PADUtils/PADSettingsMgt"),a=o.getSetting("pad_security_ctx")?o.getSetting("pad_security_ctx"):"preferred",r=n.get3DSpaceUrl()+s[i.expand3DType].url+"?SecurityContext="+a+"&tenant="+n.getPlatformId();"progressiveExpand"===i.expand3DType&&(r+="&output_format=cvjson");var l=i.data;l.fcs_url_mode=o.getSetting("enopad3dviewer_useStaticURL")?"REDIRECT":void 0,delete i.data;var c,d=e.extend({method:s[i.expand3DType].verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":o.getSetting("lang")},timeout:i.timeout?i.timeout:o.getSetting("webapi_timeout")},i);l.root_path_physicalid?c=l.root_path_physicalid:l.paths?c=l.paths:l.root_physicalid?c=[[l.root_physicalid]]:console.error("## CVServletServices.expand3d: No roots defined in input");var p=e.extend({label:n.getRequestLabel(),locale:o.getSetting("lang"),tenant:n.getPlatformId(),root_path_physicalid:c},l);return p=t.completeWebAPIPayload("expand3d",p,i),delete d.expand3DType,delete d.enopad_webapis,delete p.intent,delete p.root_physicalid,delete p.authored,delete p.debug,p.select_bo=p.select_bo.filter(function(e,t,n){return n.indexOf(e)===t}),d.data=JSON.stringify(p),d.onTimeout=d.onTimeout||d.onFailure,t.executeRequest(r,d)},getRootStats:function(e){var a={},r=require("DS/PADUtils/PADSettingsMgt"),l=r.getSetting("pad_security_ctx")?r.getSetting("pad_security_ctx"):"preferred";let c="",d=!1;!0===i.getSetting("redirectQueryToSGI")&&(c="&redirectQueryToSGI=true",c+="&expandIndexUnit=3DSpaceTransformedForIFC",d=!0);var p=n.get3DSpaceUrl()+s.expandv2.url+"?output_format=cvjson&SecurityContext="+l+"&tenant="+n.getPlatformId()+c,u=this._buildPredefinedComputation(e.data.compute_select_bo),h=this._buildPrefixPath(e.data.rootPhID,e.data.root_path_physicalid),g=!1,f=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{}});let _=[];void 0===f?f={all:1}:(Array.isArray(f.aggregation_processors)&&f.aggregation_processors.length>0&&(_=f.aggregation_processors),f=f.filter,g=!0);var m=[{truncate:{max_distance_from_prefix:0,prefix_filter:{prefix_path:h}}}],v=[];g&&(v.push({bounding_box:{name:"ProgressiveExpand_FilteredBBox",sampling:r.getSetting("enopad3dviewer_filteredBBoxSampling_progressiveExpand")}}),_.length>0&&(v=v.concat(_))),v.push({synthesis:{name:"ProgressiveExpand_FlatSynthesis",mode:"flat"}}),v.push({synthesis:{name:"ProgressiveExpand_OccSynthesis",mode:"occurence"}}),v.push({synthesis:{name:"ProgressiveExpand_LeafSynthesis",mode:"tree_leaf",synthesis_only:1}});var S,D=void 0;e.data.get_materials&&void 0!==e.data.materialParameters&&(m.push(e.data.materialParameters.aggregationProcessors),D=e.data.materialParameters.materialAttributes),!0===r.getSetting("pgpFromServer")&&o(S=[],e.data),e.data.select_bo=e.data.select_bo.filter(function(e,t,n){return n.indexOf(e)===t}),e.data.select_rel=e.data.select_rel.filter(function(e,t,n){return n.indexOf(e)===t});let P=void 0;r.getSetting("enopad3dviewer_flexibleAssemblySupportActivated")&&(P=1);var y={batch:{expands:[{label:"ProgressiveExpand_Synthesis_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},parameters:{limit_max_path:e.maxLeaves,apply_flexible_assembly_matrix:P||void 0},filter:f,graph:r.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:v,shatteredExpand:!!d||void 0},{label:"ProgressiveExpand_Expand0_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},filter:{prefix_filter:{prefix_path:h}},graph:r.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:m,parameters:P?{apply_flexible_assembly_matrix:1}:void 0,shatteredExpand:!!d||void 0}]},outputs:{select_object:e.data.select_bo,select_relation:e.data.select_rel,select_material:D,select_pgp:S,hits:{predefined_computation:u},synthesis:["ProgressiveExpand_FlatSynthesis","ProgressiveExpand_OccSynthesis","ProgressiveExpand_LeafSynthesis"],bounding_box:g?["ProgressiveExpand_FilteredBBox"]:void 0,select_flexible_assembly_matrix:P?1:void 0}};return a.onComplete=e.onComplete,a.onFailure=e.onFailure,a.onTimeout=e.onTimeout||e.onFailure,a.timeout=6e4,a.method=s.expandv2.verb,a.headers={Accept:"application/json","Content-Type":"application/json"},a.wsName="getRootStats",a.txKey=e.data.rootPhID,a.data=JSON.stringify(y),t.executeRequest(p,a)},getStaticMappingExcludedOccurrences:function(e){var o={},a=require("DS/PADUtils/PADSettingsMgt"),r=a.getSetting("pad_security_ctx")?a.getSetting("pad_security_ctx"):"preferred";let l="",c=!1;!0===i.getSetting("redirectQueryToSGI")&&(l="&redirectQueryToSGI=true",l+="&expandIndexUnit=3DSpaceTransformedForIFC",c=!0);var d=n.get3DSpaceUrl()+s.expandv2.url+"?output_format=cvjson&SecurityContext="+r+"&tenant="+n.getPlatformId()+"&disable_implicit_static_mapping_filter=true"+l,p=this._buildPrefixPath(e.data.rootPhID,e.data.root_path_physicalid);let u=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:p,staticMapping:1}});u=u||{};let h=[];e.intent&&"explore_2D"===e.intent&&(h=[{truncate:{compute_matching_subpaths_lengths:1,match_only_refs:1,or:{filters:[{and_not:{left:{and:{filters:[{all:1}]}},right:{and:{filters:[{static_mapping_filter:1}]}}}}]}}}]),Array.isArray(u.aggregation_processors)&&u.aggregation_processors.length>0&&(h=h.concat(u.aggregation_processors));var g={batch:{expands:[{label:"ProgressiveExpand_ExpandAll_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},parameters:{disable_occurrence_output:1},filter:u.filter,graph:a.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:[{synthesis:{name:"ProgressiveExpand_FlatSynthesis",mode:"flat"}}],shatteredExpand:!!c||void 0},{label:"ProgressiveExpand_ExpandAll_ExcludedOccurences_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},filter:{or:{filters:[{and_not:{left:{and:{filters:[{counted_by_flat_synthesis_filter:{synthesis_name:"ProgressiveExpand_FlatSynthesis"}},{prefix_filter:{prefix_path:[{physical_id_path:[e.data.rootPhID]}]}}]}},right:u.filter}}]}},graph:a.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:h.length>0?h:void 0,shatteredExpand:!!c||void 0}]},outputs:{format:"occurrence_path",select_object:e.data.select_bo,select_relation:e.data.select_rel,matching_lengths:e.intent&&"explore_2D"===e.intent?1:void 0}};return o.onComplete=e.onComplete,o.onFailure=e.onFailure,o.onTimeout=e.onTimeout||e.onFailure,o.timeout=3e5,o.method=s.expandv2.verb,o.headers={Accept:"application/json","Content-Type":"application/json"},o.wsName="getStaticMappingExcludedOccurrences",o.txKey=e.data.rootPhID,o.data=JSON.stringify(g),t.executeRequest(d,o)},progressiveExpand:function(e){var a={},r=require("DS/PADUtils/PADSettingsMgt"),l=r.getSetting("pad_security_ctx")?r.getSetting("pad_security_ctx"):"preferred";let c="",d=!1;!0===i.getSetting("redirectQueryToSGI")&&(c="&redirectQueryToSGI=true",c+="&expandIndexUnit=3DSpaceTransformedForIFC",d=!0);var p=n.get3DSpaceUrl()+s.expandv2.url+"?output_format=cvjson&SecurityContext="+l+"&tenant="+n.getPlatformId()+c,u=void 0===e.withFrustumFilter||e.withFrustumFilter,h=this._buildPredefinedComputation(e.data.compute_select_bo),g=this._buildPrefixPath(e.data.rootPhID,e.data.root_path_physicalid),f=this._buildMatriceOverloads(e.data.rootPhID,e.overrides),_=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:g,inFrustumObj:u&&e.data.frustumDefinition&&void 0!==e.data.frustumDefinition.angle?e.data.frustumDefinition:void 0,inParallelFrustumObj:u&&e.data.frustumDefinition&&void 0!==e.data.frustumDefinition.left?e.data.frustumDefinition:void 0}}),m=void 0,v=void 0;e.data.get_materials&&void 0!==e.data.materialParameters&&(m=[e.data.materialParameters.aggregationProcessors],v=e.data.materialParameters.materialAttributes);var S,D=-1;e.data.expand_iter&&(D=parseInt(e.data.expand_iter))>-1&&(void 0===m&&(m=[]),m.push({truncate:{max_distance_from_prefix:D,prefix_filter:{prefix_path:g}}})),Array.isArray(_.aggregation_processors)&&_.aggregation_processors.length>0&&(void 0===m&&(m=[]),m=m.concat(_.aggregation_processors)),!0===r.getSetting("pgpFromServer")&&o(S=[],e.data),e.data.select_bo=e.data.select_bo.filter(function(e,t,n){return n.indexOf(e)===t}),e.data.select_rel=e.data.select_rel.filter(function(e,t,n){return n.indexOf(e)===t});let P=void 0;r.getSetting("enopad3dviewer_flexibleAssemblySupportActivated")&&(P={apply_flexible_assembly_matrix:1});var y={batch:{expands:[{label:u?"ProgressiveExpand_ExpandFullVP_"+n.getRequestLabel():-1!=D?"ProgressiveExpand_Expand"+e.data.expand_iter+"_"+n.getRequestLabel():"ProgressiveExpand_ExpandAll_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},matrices_overloads:u&&f.length?f:void 0,filter:_.filter,graph:r.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:m,parameters:void 0!==P?P:void 0,shatteredExpand:!!d||void 0}]},outputs:{select_object:e.data.select_bo,select_relation:e.data.select_rel,select_material:v,select_pgp:S,hits:{predefined_computation:h},select_flexible_assembly_matrix:void 0!==P?1:void 0}};return a.onComplete=e.onComplete,a.onFailure=e.onFailure,a.onTimeout=e.onTimeout||e.onFailure,a.timeout=6e5,a.method=s.expandv2.verb,a.headers={Accept:"application/json","Content-Type":"application/json"},a.data=JSON.stringify(y),a.wsName="expandv2",a.txKey=e.data.rootPhID,t.executeRequest(p,a)},multiexpand:function(e){console.warn("/! PADWSAccess.multiexpand:: Internal and Obsolete Code"),e.onFailure()},volumeQuery:function(e){console.warn("/! PADWSAccess.volumeQuery:: Internal and Obsolete Code"),e.onFailure()},volumeQueryV2:function(e){var a={},r=require("DS/PADUtils/PADSettingsMgt"),l=r.getSetting("pad_security_ctx")?r.getSetting("pad_security_ctx"):"preferred";let c="",d=!1;!0===i.getSetting("redirectQueryToSGI")&&(c="&redirectQueryToSGI=true",c+="&expandIndexUnit=3DSpaceTransformedForIFC",d=!0);let p=n.get3DSpaceUrl()+s.expandv2.url+"?output_format=cvjson&SecurityContext="+l+"&tenant="+n.getPlatformId()+c;var u,h,g=this._buildPredefinedComputation(e.data.compute_select_bo),f=this._buildMatriceOverloads(e.data.rootPhID,e.data.overrides),_=this._buildPrefixPath(e.data.rootPhID,e.data.root_path_physicalid),m=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:_,volumeObj:[e.data.volume_filter]}}),v=void 0;e.data.get_materials&&void 0!==e.data.materialParameters&&(v=[e.data.materialParameters.aggregationProcessors],u=e.data.materialParameters.materialAttributes),Array.isArray(m.aggregation_processors)&&m.aggregation_processors.length>0&&(void 0===v&&(v=[]),v=v.concat(m.aggregation_processors)),!0===r.getSetting("pgpFromServer")&&o(h=[],e.data),e.data.select_bo=e.data.select_bo.filter(function(e,t,n){return n.indexOf(e)===t}),e.data.select_rel=e.data.select_rel.filter(function(e,t,n){return n.indexOf(e)===t});let S=void 0;r.getSetting("enopad3dviewer_flexibleAssemblySupportActivated")&&(S=1);let D={limit_max_path:e.data.max_output_paths?e.data.max_output_paths:void 0,apply_flexible_assembly_matrix:S||void 0};D.limit_max_path||D.apply_flexible_assembly_matrix||(D=void 0);var P={applicationID:void 0!==e.data.applicationID?e.data.applicationID:void 0,batch:{expands:[{label:"ProgressiveExpand_VolumeQuery_"+n.getRequestLabel(),parameters:D,root:{physical_id:e.data.rootPhID},matrices_overloads:f.length?f:void 0,filter:m.filter,graph:r.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:v,shatteredExpand:!!d||void 0}]},outputs:{select_object:e.data.select_bo,select_relation:e.data.select_rel,select_material:u,select_pgp:h,hits:{predefined_computation:g},format:"entity_relation_occurrence",select_flexible_assembly_matrix:void 0!==S?1:void 0}};return a.onComplete=e.onComplete,a.onFailure=e.onFailure,a.onTimeout=e.onTimeout||e.onFailure,a.timeout=6e4,a.method=s.searchv2.verb,a.headers={Accept:"application/json","Content-Type":"application/json"},a.data=JSON.stringify(P),a.wsName="volumeQueryV2",a.txKey=e.data.rootPhID,t.executeRequest(p,a)},search:function(e){console.warn("/! PADWSAccess.search:: Internal and Obsolete Code"),e.onFailure()},searchV2:function(e){var i={},a=require("DS/PADUtils/PADSettingsMgt"),r=a.getSetting("pad_security_ctx")?a.getSetting("pad_security_ctx"):"preferred",l=n.get3DSpaceUrl()+s.searchv2.url+"?output_format=cvjson&SecurityContext="+r+"&tenant="+n.getPlatformId(),c=this._buildPredefinedComputation(e.data.compute_select_bo),d=this._buildPrefixPath(e.data.rootPhID);e.data.max_count_path&&(e.data.max_count_path=parseInt(e.data.max_count_path),e.data.max_count_path===parseInt(a.getSetting("enopad3dviewer_max_count_in_search"))&&(e.data.max_count_path=e.data.max_count_path+1));var p=null,u=[];if(e.data.subPaths){p=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:d,find_subpaths:e.data.subPaths}});const t={truncate:e.FBIProxy.buildSpecFromAppIntent({V2:{find_subpaths:e.data.subPaths}})};t.truncate.max_distance_from_prefix=0,t.truncate.compute_matching_subpaths_lengths=1,t.truncate.match_only_refs=1,u=[t]}else if(e.data.taggerSelect){p=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:d,tagger_select:e.data.taggerSelect}});const t={truncate:e.FBIProxy.buildSpecFromAppIntent({V2:{tagger_select:e.data.taggerSelect}})};t.truncate.max_distance_from_prefix=0,t.truncate.compute_matching_subpaths_lengths=1,t.truncate.match_only_refs=1,u=[t]}else if(e.data.searchQuery){p=e.FBIProxy.GetFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:d,find_in_context:e.data.searchQuery}});const t={truncate:e.FBIProxy.buildSpecFromAppIntent({V2:{find_in_context:e.data.searchQuery}})};t.truncate.max_distance_from_prefix=0,t.truncate.compute_matching_subpaths_lengths=1,t.truncate.match_only_refs=1,u=[t]}var h,g=void 0;e.data.get_materials&&void 0!==e.data.materialParameters&&(u.push(e.data.materialParameters.aggregationProcessors),g=e.data.materialParameters.materialAttributes),!0===a.getSetting("pgpFromServer")&&o(h=[],e.data),Array.isArray(p.aggregation_processors)&&p.aggregation_processors.length>0&&(u=u.concat(p.aggregation_processors)),e.data.select_bo=e.data.select_bo.filter(function(e,t,n){return n.indexOf(e)===t}),e.data.select_rel=e.data.select_rel.filter(function(e,t,n){return n.indexOf(e)===t});let f=void 0;a.getSetting("enopad3dviewer_flexibleAssemblySupportActivated")&&(f=1);let _={limit_max_path:e.data.max_count_path?e.data.max_count_path:void 0,apply_flexible_assembly_matrix:void 0!==f?f:void 0};_.limit_max_path||_.apply_flexible_assembly_matrix||(_=void 0);var m={batch:{expands:[{label:"ProgressiveExpand_SearchV2_"+n.getRequestLabel(),parameters:_,root:{physical_id:e.data.rootPhID},filter:p.filter,graph:a.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:u}]},outputs:{select_object:e.data.select_bo,select_relation:e.data.select_rel,select_material:g,select_pgp:h,hits:{predefined_computation:c},matching_lengths:1,format:"entity_relation_occurrence",select_flexible_assembly_matrix:void 0!==f?1:void 0}};return i.onComplete=e.onComplete,i.onFailure=e.onFailure,i.onTimeout=e.onTimeout||e.onFailure,i.timeout=6e4,i.method=s.searchv2.verb,i.headers={Accept:"application/json","Content-Type":"application/json"},i.wsName="searchV2",i.txKey=e.data.rootPhID,i.data=JSON.stringify(m),t.executeRequest(l,i)},getMinMaxDistanceCandidates:function(e){var a={},r=require("DS/PADUtils/PADSettingsMgt"),l=r.getSetting("pad_security_ctx")?r.getSetting("pad_security_ctx"):"preferred";let c="",d=!1;!0===i.getSetting("redirectQueryToSGI")&&(c="&redirectQueryToSGI=true",c+="&expandIndexUnit=3DSpaceTransformedForIFC",d=!0);var p=n.get3DSpaceUrl()+s.expandv2.url+"?output_format=cvjson&SecurityContext="+l+"&tenant="+n.getPlatformId()+c,u=this._buildPredefinedComputation(e.data.compute_select_bo),h=this._buildMatriceOverloads(e.data.rootPhID,e.data.overrides),g=e.data.sets[0].paths;g=g.concat(e.data.sets[1].paths);var f,_,m=this._buildPrefixPath(e.data.rootPhID,g),v=e.FBIProxy.getFilterSpec(e.data.rootPhID,{V2:{prefixPathArray:m}}),S=[this._buildMinMaxSets(e.data.mode,e.data.sets)];e.data.get_materials&&void 0!==e.data.materialParameters&&(S.push(e.data.materialParameters.aggregationProcessors),f=e.data.materialParameters.materialAttributes),!0===r.getSetting("pgpFromServer")&&o(_=[],e.data),Array.isArray(v.aggregation_processors)&&v.aggregation_processors.length>0&&(S=S.concat(v.aggregation_processors)),e.data.select_bo=e.data.select_bo.filter(function(e,t,n){return n.indexOf(e)===t}),e.data.select_rel=e.data.select_rel.filter(function(e,t,n){return n.indexOf(e)===t});let D=void 0;r.getSetting("enopad3dviewer_flexibleAssemblySupportActivated")&&(D={apply_flexible_assembly_matrix:1});var P={batch:{expands:[{label:"ProgressiveExpand_MinMaxDistance_"+n.getRequestLabel(),root:{physical_id:e.data.rootPhID},matrices_overloads:h.length?h:void 0,filter:v.filter,graph:r.getSetting("enopad3dviewer_graphDefinitionForExpand"),aggregation_processors:S,parameters:D||void 0,shatteredExpand:!!d||void 0}]},outputs:{select_object:e.data.select_bo,select_relation:e.data.select_rel,select_material:f,select_pgp:_,hits:{predefined_computation:u},format:"entity_relation_occurrence",select_flexible_assembly_matrix:D?1:void 0}};return a.onComplete=e.onComplete,a.onFailure=e.onFailure,a.onTimeout=e.onTimeout||e.onFailure,a.timeout=6e4,a.method=s.searchv2.verb,a.headers={Accept:"application/json","Content-Type":"application/json"},a.data=JSON.stringify(P),t.executeRequest(p,a)},_buildMinMaxSets:function(e,t){var n={},i=0,s={set_a_label:t[0].id,set_a_filter:{prefix_filter:{prefix_path:[]}},set_b_label:t[1].id,set_b_filter:{prefix_filter:{prefix_path:[]}}};for(i=0;i<t[0].paths.length;i++)s.set_a_filter.prefix_filter.prefix_path.push({physical_id_path:t[0].paths[i]});for(i=0;i<t[1].paths.length;i++)s.set_b_filter.prefix_filter.prefix_path.push({physical_id_path:t[1].paths[i]});return"min"===e?n.min_distance=s:"max"===e&&(n.max_distance=s),n},_buildPredefinedComputation:function(e){var t=["boundingbox"];return-1!==e.indexOf("thumbnail_3d")?t.push("thumbnail_3d_fallback_cgr"):-1!==e.indexOf("stepcgr")?t.push("urlstream|cgr|stepcgr"):t=t.concat(e),t},_buildPrefixPath:function(e,t){var n=null,i=0;if(t&&t.length)for(n=[],i=0;i<t.length;i++)n.push({physical_id_path:t[i]});else n=[{physical_id_path:[e]}];return n},_buildMatriceOverloads:function(e,t){var n=[],i=0;if(t)for(i=0;i<t.length;i++){var s=t[i];s.idPath&&s.value&&16===s.value.length&&(s.idPath.splice(0,1),s.idPath[0]===e&&n.push({path:{physical_id_path:s.idPath},matrix:[s.value[0],s.value[1],s.value[2],s.value[4],s.value[5],s.value[6],s.value[8],s.value[9],s.value[10],s.value[12],s.value[13],s.value[14]]}))}return n},getIndexingDate:function(i){var o={select_service:i.service},a=require("DS/PADUtils/PADSettingsMgt"),r=a.getSetting("pad_security_ctx")?a.getSetting("pad_security_ctx"):"preferred",l=n.get3DSpaceUrl()+s.indexingdate.url+"?SecurityContext="+r+"&tenant="+n.getPlatformId(),c=e.extend({method:s.indexingdate.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":a.getSetting("lang")},timeout:a.getSetting("webapi_timeout")},i);return c.data=JSON.stringify(o),t.executeRequest(l,c)}}}),define("DS/PADUtils/utilsWS/WSMiscellaneous",["DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","require"],function(e,t,n){"use strict";var i={url:"/resources/enopad/navigate/getstreamurl",verb:"POST"},s={url:"/resources/v1/collabServices/attributes/op/read",verb:"POST"},o={url:"/resources/v1/collabServices/attributes/op/update",verb:"PUT"},a={url:"/resources/enopad/getfcsurls",verb:"POST"},r={url:"/resources/SNAPI/pq_services/pqs",verb:"GET"},l={url:"/resources/FilterBIAPI/Filter/getFiltersFromIds",verb:"POST"};return{getFcsUrls:function(n){var i=require("DS/PADUtils/PADSettingsMgt"),s=i.getSetting("pad_security_ctx")?i.getSetting("pad_security_ctx"):"preferred";s=encodeURIComponent(s);var o=t.get3DSpaceUrl()+a.url+"?SecurityContext="+s+"&tenant="+t.getPlatformId(),r=n;return r.method=a.verb,r.headers={Accept:"application/json","Content-Type":"application/json"},r.data=JSON.stringify(r.data),e.executeRequest(o,r)},getDownloadUrl:function(n){var s=t.get3DSpaceUrl()+i.url+"?tenant="+t.getPlatformId(),o=n;return o.method=i.verb,o.headers={Accept:"application/json","Content-Type":"application/json"},o.data=JSON.stringify(o.data),e.executeRequest(s,o)},read:function(i){var o,a=i,r=t.get3DSpaceUrl()+s.url+"?tenant="+t.getPlatformId();if(a.method=s.verb,t.isAuthoringCtxAvailable())try{o=n("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext").get()}catch(e){console.warn("CfgAuthoringContext throw an error")}return a.headers={Accept:"application/json","Content-Type":"application/json"},o&&""!==o.change.id&&(a.headers["DS-Change-Authoring-Context"]="pid:"+o.change.id),o&&null!==o.AuthoringContextHeader&&UWA.extend(a.headers,o.AuthoringContextHeader),a.cache=-1,delete a.ids,a.onTimeout=a.onTimeout||a.onFailure,a.data=JSON.stringify(a.data),e.executeRequest(r,a)},update:function(i){var s,a=i,r=t.get3DSpaceUrl()+o.url+"?tenant="+t.getPlatformId();if(a.method=o.verb,t.isAuthoringCtxAvailable())try{s=n("DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext").get()}catch(e){console.warn("CfgAuthoringContext throw an error")}return a.headers={Accept:"application/json","Content-Type":"application/json"},s&&""!==s.change.id&&(a.headers["DS-Change-Authoring-Context"]="pid:"+s.change.id),s&&null!==s.AuthoringContextHeader&&UWA.extend(a.headers,s.AuthoringContextHeader),a.cache=-1,a.onTimeout=a.onTimeout||a.onFailure,a.data=JSON.stringify(a.data),e.executeRequest(r,a)},retrievePQ:function(n){var i=require("DS/PADUtils/PADSettingsMgt"),s=n,o=t.get3DSpaceUrl()+r.url+"?tenant="+t.getPlatformId();return s.method=r.verb,s.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":i.getSetting("lang")},s.cache=-1,s.onTimeout=s.onTimeout||s.onFailure,e.executeRequest(o,s,!1,!0)},getFiltersFromIds:function(n){var i=n,s=t.get3DSpaceUrl()+l.url+"?tenant="+t.getPlatformId();return i.method=l.verb,i.headers={Accept:"application/json","Content-Type":"application/json"},i.cache=-1,i.onTimeout=i.onTimeout||i.onFailure,i.data=JSON.stringify(n.data),e.executeRequest(s,i,!0,!0)}}}),define("DS/PADUtils/utilsWS/PADWSv1",["UWA/Core","DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","DS/PADUtils/PADSession","require"],function(e,t,n,i,s){"use strict";var o={url:"/resources/enopad/navigate/fetch",verb:"POST"},a={url:"/resources/enopad/navigate/expand",verb:"POST"},r={url:"/resources/enopad/navigate/refresh",verb:"POST"};return{fetch:function(a){var r="",l=a,c=require("DS/PADUtils/PADSettingsMgt");if(!0!==c.getSetting("useLWCWebServices")||!0!==a.enopad_webapis||"stream_2D"===a.data.intent){c.getSetting("pad_security_ctx")&&c.getSetting("pad_security_ctx");if(e.is(a.enopad_webapis)||(a.enopad_webapis=!1),l.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":c.getSetting("lang")},l.timeout||(l.timeout=c.getSetting("webapi_timeout")),!a.enopad_webapis)throw new Error("## PADWSv1.fetch: Invalid inputs enopad_webapis should be set to true");var d=o,p=void 0!==l.data.authored?l.data.authored:i.determineAuthoredFlag();l.method=d.verb,r=n.get3DSpaceUrl()+d.url+"?tenant="+n.getPlatformId();var u={query:"physicalid:"+l.pids.join(" OR physicalid:"),intent:l.data.intent,nresults:l.pids.length,tenant:n.getPlatformId(),authored:p};return void 0===u.include_param_Attributes&&c.getSetting("readsettingsv2")&&(u.include_param_Attributes=!0),l.data=JSON.stringify(u),l.onTimeout=l.onTimeout||l.onFailure,t.executeRequest(r,l)}s(["DS/PADUtils/utilsWS/PADLWCAccess"],function(e){e.fetch(a)})},navigate:function(o){var r=n.get3DSpaceUrl(),l=o,c=require("DS/PADUtils/PADSettingsMgt");if(!0!==c.getSetting("useLWCWebServices")||!0!==o.enopad_webapis){var d=a,p=c.getSetting("pad_security_ctx")?c.getSetting("pad_security_ctx"):"preferred";if(e.is(o.enopad_webapis)||(o.enopad_webapis=!1),o.enopad_webapis)r=r+d.url+"?tenant="+n.getPlatformId();else if("explore_2D"===l.data.intent)r=r+"/cvservlet/expand?SecurityContext="+p+"&tenant="+n.getPlatformId();else{switch(o.expand3DType=void 0===o.expand3DType?"expand3D":o.expand3DType,o.expand3DType){case"expand3D":r=r+"/cvservlet/expand3d?SecurityContext="+p+"&tenant="+n.getPlatformId();break;case"wrap":r=r+"/cvservlet/wrap?SecurityContext="+p+"&tenant="+n.getPlatformId();break;case"progressiveExpand":r=r+"/cvservlet/progressiveexpand?SecurityContext="+p+"&tenant="+n.getPlatformId()}delete o.expand3DType,l.data.fcs_url_mode=c.getSetting("enopad3dviewer_useStaticURL")?"REDIRECT":void 0}if(!e.is(r)||!e.is(l,"object"))throw new Error("## PADWSv1.navigate: Invalid inputs");if(!e.is(l.data,"object"))throw new Error("## PADWSv1.navigate: Invalid inputs options.data not found");if(l.method=d.verb,l.headers={Accept:"application/json","Content-Type":"application/json"},l.timeout||(l.timeout=c.getSetting("webapi_timeout")),c.getSetting("readsettingsv2")&&(l.data.include_param_Attributes=!0),o.enopad_webapis){if(c.getSetting("use_gen_expand")&&(l.data.activate="use_gen_expand"),!e.is(l.data.roots)&&e.is(l.data.root_physicalid)?l.data.roots=[{id:l.data.root_physicalid}]:!e.is(l.data.paths)&&e.is(l.data.root_path_physicalid)&&(l.data.paths=l.data.root_path_physicalid),e.is(l.data.level)||(l.data.level=l.data.expand_iter),e.is(l.data.intent)||(l.data.intent="explore_2D"),e.is(l.data.source)||(l.data.source="cstorage"),e.is(l.data.authored)||e.is(l.data.find_path_filter)||(l.data.authored=void 0!==l.data.authored?l.data.authored:i.determineAuthoredFlag()),delete l.data.root_physicalid,delete l.data.expand_iter,delete l.data.enopad_webapis,delete l.data.compute_select_bo,delete l.data.select_bo,delete l.data.select_rel,delete l.data.select_ds6w_facet,!e.is(l.data.roots)&&!e.is(l.data.paths))throw new Error("## PADWSv1.navigate: Invalid inputs: no root_physical_id or no root_path_physicalid found")}else{delete l.data.intent,delete l.data.authored;var u=c.getWebAPI_Options("navigate");if(!e.is(l.data.root_physicalid)&&!e.is(l.data.root_path_physicalid)&&!e.is(l.data.paths))throw new Error("## PADWSv1.navigate: Invalid inputs: no root_physical_id or no root_path_physicalid found");!e.is(l.data.root_path_physicalid)&&e.is(l.data.paths)&&(l.data.root_path_physicalid=l.data.paths),e.is(l.data.expand_iter)||e.is(l.find_in_ctx)||(l.data.expand_iter=c.getSetting("expand_iter")),e.is(l.data.select_bo)||(l.data.select_bo=u.select_bo),e.is(l.data.select_rel)||(l.data.select_rel=u.select_rel)}return l.onTimeout=l.onTimeout||l.onFailure,l.data=JSON.stringify(l.data),t.executeRequest(r,l)}s(["DS/PADUtils/utilsWS/PADLWCAccess"],function(e){e.expand(o)})},refresh:function(o){var a=require("DS/PADUtils/PADSettingsMgt");if(!0===a.getSetting("useLWCWebServices"))s(["DS/PADUtils/utilsWS/PADLWCAccess"],function(e){e.refresh(o)});else{var l=r,c=n.get3DSpaceUrl()+l.url+"?tenant="+n.getPlatformId();if(!e.is(c)||!e.is(o,"object"))throw new Error("## PADWSv1.refresh: Invalid inputs");if(!e.is(o.data,"object"))throw new Error("## PADWSv1.refresh: Invalid inputs - options.data not found");o.method=l.verb,o.headers={Accept:"application/json","Content-Type":"application/json"},a.getSetting("use_gen_expand")&&(o.data.activate="use_gen_expand"),e.is(o.data.intent)||(o.data.intent="explore_2D"),e.is(o.data.source)||(o.data.source="cstorage"),a.getSetting("readsettingsv2")&&(o.data.include_param_Attributes=!0),o.data.authored=o.data.authored?o.data.authored:!i.isUsingIndex(),o.onTimeout=o.onTimeout||o.onFailure,o.data=JSON.stringify(o.data),t.executeSplittedRequest(c,o,{max:1,init:{query:{split:!0},response:{packets:"packets"}},packet:{query:{packet:"packet",remove:["session"]},response:{concat:["results"],copy:["full_path"]}}})}},getDerivedOutputs:function(t){if(!e.is(t)||!e.is(t.pids))throw new Error("## PADWSv1.getDerivedOutputs: Invalid inputs");require("DS/PADUtils/PADSettingsMgt");t.enopad_webapis=!0,e.is(t.data)||(t.data={}),t.data.intent="stream_2D",this.fetch(t)}}}),define("DS/PADUtils/PADWSProxy",["UWA/Core","DS/WAFData/WAFData","DS/PADUtils/PADUtilsServices","UWA/Promise","DS/PADUtils/utilsWS/WSUtils","require"],function(e,t,n,i,s,o){function a(e,t,n){return new i(function(i,o){t.onComplete=function(e){var t=function(e){return"string"==typeof e?JSON.parse(e):e}(e),s=t;n&&(s=n(t)),i(s)},t.onFailure=function(e){o(e)},t.data&&(t.data=JSON.stringify(t.data)),s.executeRequest(e,t,!1)})}return{getcainfo:function(e){var t=o("DS/PADUtils/PADSettingsMgt"),i=e||{},s=n.get3DSpaceUrl()+"/resources/modeler/change/changeaction/pid:"+e.id+"?attributes=1&context=1&people=1&applicability=1&proposed=1&realized=1";return i.method="GET",i.headers={Accept:"application/json","Content-Type":"application/json","Accept-Language":t.getSetting("lang")},a(s,i)}}}),define("DS/PADUtils/PADChangeActionHandler",["DS/PADUtils/PADWSProxy","DS/PADUtils/views/PADAlert","UWA/Promise","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(e,t,n,i){function s(e,t){for(var n,i=[],s=0;s<e.length;s++){var a=e[s],r=a.id;!0===t&&(r=a.where.id),o(i,(n=r).substr(n.indexOf(":")+1))}return i}function o(e,t){-1===e.indexOf(t)&&e.push(t)}function a(e,t){for(var n=0;n<t.length;n++)o(e,t[n])}return{extractIds:s,extractRealizedAndProposed:function(e){var t=s(e.changeaction.realized,!0);return a(t,s(e.changeaction.proposed,!0)),t},getInfos:function(s,o,a){for(var r=[],l=0;l<s.length;l++){var c=e.getcainfo({id:s[l]});r.push(c)}n.all(r).then(function(e){o(e)}).catch(function(e){t.displayNotification({eventID:"error",msg:i.generic_service_failure,key:"padUtils-getInfos-generic-service-failure"}),console.error(e),a&&a(e)})},determineExecution:function(e,n){if(e.changeaction.context.length>0&&e.changeaction.realized.length>0)n.addAndFind(e);else{var o=(c=(l=(l=[]).concat(s((r=e).changeaction.context))).length,a(l,s(r.changeaction.realized,!0)),l.length>c&&a(l,s(r.changeaction.proposed,!0)),l);o.length>0?n.add(o):(t.displayNotification({eventID:"warning",msg:i.WARN_empty_change_action}),n.wasEmpty())}var r,l,c}}}),define("DS/PADUtils/utilsWS/LWCDirectAccess",["UWA/Core","DS/PADUtils/utilsWS/WSUtils","DS/PADUtils/PADUtilsServices","DS/PADServices/settings/AppSettings","DS/PADServices/utils/PConfigUtils","DS/PADServices/utils/PlatformURL"],function(e,t,n,i,s,o){"use strict";var a,r={url:"/resources/enoauthoring/fetch/v1",verb:"POST"},l={url:"/resources/enoauthoring/expand/v1",verb:"POST"},c={url:"/resources/enoauthoring/expand/v2",verb:"POST"},d={url:"/resources/enoauthoring/expand/v2/progressive",verb:"POST"};return{fetch:function(i){var s=require("DS/PADUtils/PADSettingsMgt"),o=s.getSetting("pad_security_ctx")?s.getSetting("pad_security_ctx"):"preferred";o=encodeURIComponent(o);var a=n.get3DSpaceUrl()+r.url+"?SecurityContext="+o+"&tenant="+n.getPlatformId(),l=i.data;delete i.data;var c=e.extend({method:r.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":s.getSetting("lang")},timeout:i.timeout?i.timeout:s.getSetting("webapi_timeout")},i),d=require("DS/PADServices/utils/AttributesMgtV2"),p=e.extend({label:n.getRequestLabel(),physicalid:i.pids,locale:s.getSetting("lang"),tenant:n.getPlatformId(),types:d.getSelectedTypes(),extensions:d.getSelectedExtensions()},l);return p="fetch_3D"===p.intent?t.completeWebAPIPayload("fetch3d",p,i):t.completeWebAPIPayload("fetch2d",p,i),delete c.pids,delete c.enopad_webapis,delete p.intent,delete p.authored,p.select_predicate=p.select_predicate.filter(function(e,t,n){return n.indexOf(e)===t}),c.data=JSON.stringify(p),c.onTimeout=c.onTimeout||c.onFailure,t.executeRequest(a,c)},expand:function(i){var s=require("DS/PADUtils/PADSettingsMgt"),o=s.getSetting("pad_security_ctx")?s.getSetting("pad_security_ctx"):"preferred";o=encodeURIComponent(o);require("DS/PADServices/utils/PConfigUtils");var a=require("DS/PADServices/settings/AppSettings"),r=n.get3DSpaceUrl()+l.url+"?SecurityContext="+o+"&tenant="+n.getPlatformId(),c=i.data;delete i.data;var d=e.extend({method:l.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":s.getSetting("lang")},timeout:i.timeout?i.timeout:s.getSetting("webapi_timeout")},i),p=[];e.is(c.roots)?p=c.roots:e.is(c.root_physicalid)?p=[[c.root_physicalid]]:e.is(c.paths)?p=c.paths:e.is(c.root_path_physicalid)&&(p=c.root_path_physicalid);let u,h=a.getSetting("authoringFilterEnabled"),g=a.getSetting("authoringFilterEnabledForMultiRoot"),f=[],_="",m="",v=0,S=!1;if(h&&(g||1===i.FBIProxy._mRootsDataInSession.size)&&1===p.length&&i.FBIProxy&&i.FBIProxy._mRootsDataInSession){for(var D=i.FBIProxy._mRootsDataInSession.get(p[0].at(0)),P=D?D.filterInfos.objQueryV2.batch.expands:[],y=0;y<P.length;y++){if(P[y].filter&&P[y].filter.or.filters&&1===P[y].filter.or.filters.length&&P[y].filter.or.filters[0].and)for(var A=P[y].filter.or.filters[0].and.filters,b=0;b<A.length;b++){if(A[b].assembly_shape_filter||A[b].sequence_filter){_="",m="";break}A[b].prefix_filter?v++:A[b].config_filter?(_=A[b].config_filter,m="Compiled"):A[b].config_filter_id&&(_=A[b].config_filter_id.physical_id,m="PhysicalId")}v<1&&_&&m&&(S=!0);var x={isValid:S,config_filter:_,configCompiledForm:m};x.isValid&&f.push(x)}f&&1===f.length&&(u=f[0])}var C=require("DS/PADServices/utils/AttributesMgtV2"),w=e.extend({label:n.getRequestLabel(),root_path_physicalid:p,locale:s.getSetting("lang"),tenant:n.getPlatformId(),types:C.getSelectedTypes(),extensions:C.getSelectedExtensions()},c);return w="explore_3d"===w.intent.toLowerCase()?t.completeWebAPIPayload("expand3d",w,i):t.completeWebAPIPayload("expand",w,i),u&&u.isValid&&(u.config_filter&&(w.config_filter=u.config_filter),u.configCompiledForm&&(w.configCompiledForm=u.configCompiledForm)),w.static_mapping=a.getSetting("staticMappingEnabled"),delete d.pids,delete d.enopad_webapis,delete w.intent,delete w.authored,delete w.root_physicalid,w.select_bo=w.select_bo.filter(function(e,t,n){return n.indexOf(e)===t}),w.select_rel=w.select_rel.filter(function(e,t,n){return n.indexOf(e)===t}),d.data=JSON.stringify(w),d.onTimeout=d.onTimeout||d.onFailure,t.executeRequest(r,d)},expandV2:function(s){var o=require("DS/PADUtils/PADSettingsMgt"),a=o.getSetting("pad_security_ctx")?o.getSetting("pad_security_ctx"):"preferred";a=encodeURIComponent(a);var r=n.get3DSpaceUrl()+c.url+"?SecurityContext="+a+"&tenant="+n.getPlatformId(),d=s.data;delete s.data;var p=e.extend({method:l.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":o.getSetting("lang")},timeout:s.timeout?s.timeout:o.getSetting("webapi_timeout")},s),u=[];e.is(d.roots)?u=d.roots:e.is(d.root_physicalid)?u=[[d.root_physicalid]]:e.is(d.paths)?u=d.paths:e.is(d.root_path_physicalid)&&(u=d.root_path_physicalid);let h,g=i.getSetting("authoringFilterEnabled"),f=i.getSetting("authoringFilterEnabledForMultiRoot"),_=[],m="",v="",S=0,D=!1;if(g&&(f||1===s.FBIProxy._mRootsDataInSession.size)&&1===u.length&&s.FBIProxy&&s.FBIProxy._mRootsDataInSession){for(var P=s.FBIProxy._mRootsDataInSession.get(u[0].at(0)),y=P?P.filterInfos.objQueryV2.batch.expands:[],A=0;A<y.length;A++){if(y[A].filter&&y[A].filter.or.filters&&1===y[A].filter.or.filters.length&&y[A].filter.or.filters[0].and)for(var b=y[A].filter.or.filters[0].and.filters,x=0;x<b.length;x++){if(b[x].assembly_shape_filter||b[x].sequence_filter){m="",v="";break}b[x].prefix_filter?S++:b[x].config_filter?(m=b[x].config_filter,v="Compiled"):b[x].config_filter_id&&(m=b[x].config_filter_id.physical_id,v="PhysicalId")}S<1&&m&&v&&(D=!0);var C={isValid:D,config_filter:m,configCompiledForm:v};C.isValid&&_.push(C)}_&&1===_.length&&(h=_[0])}var w=require("DS/PADServices/utils/AttributesMgtV2"),U=e.extend({label:n.getRequestLabel(),root_path_physicalid:u,locale:o.getSetting("lang"),tenant:n.getPlatformId(),types:w.getSelectedTypes(),extensions:w.getSelectedExtensions()},d);return U="explore_3d"===U.intent.toLowerCase()?t.completeWebAPIPayload("expand3d",U,s):t.completeWebAPIPayload("expand",U,s),h&&(h.config_filter&&(U.config_filter=h.config_filter),h.configCompiledForm&&(U.configCompiledForm=h.configCompiledForm)),U.static_mapping=i.getSetting("staticMappingEnabled"),delete p.pids,delete p.enopad_webapis,delete U.intent,delete U.authored,delete U.root_physicalid,U.select_bo=U.select_bo.filter(function(e,t,n){return n.indexOf(e)===t}),U.select_rel=U.select_rel.filter(function(e,t,n){return n.indexOf(e)===t}),p.data=JSON.stringify(U),p.onTimeout=p.onTimeout||p.onFailure,t.executeRequest(r,p)},configFilterFn:function(t){a=null;var n=t.data,s=[];e.is(n.roots)?s=n.roots:e.is(n.root_physicalid)?s=[[n.root_physicalid]]:e.is(n.paths)?s=n.paths:e.is(n.root_path_physicalid)&&(s=n.root_path_physicalid);let o,r=i.getSetting("authoringFilterEnabled"),l=i.getSetting("authoringFilterEnabledForMultiRoot"),c=[],d="",p="",u=0,h=!1;if(r&&(l||1===t.FBIProxy._mRootsDataInSession.size)&&1===s.length&&t.FBIProxy&&t.FBIProxy._mRootsDataInSession){for(var g=t.FBIProxy._mRootsDataInSession.get(s[0].at(0)),f=g?g.filterInfos.objQueryV2.batch.expands:[],_=0;_<f.length;_++){if(f[_].filter&&f[_].filter.or.filters&&1===f[_].filter.or.filters.length&&f[_].filter.or.filters[0].and)for(var m=f[_].filter.or.filters[0].and.filters,v=0;v<m.length;v++){if(m[v].assembly_shape_filter||m[v].sequence_filter){d="",p="";break}m[v].prefix_filter?u++:m[v].config_filter?(d=m[v].config_filter,p="Compiled"):m[v].config_filter_id&&(d=m[v].config_filter_id.physical_id,p="PhysicalId")}u<1&&d&&p&&(h=!0);var S={isValid:h,config_filter:d,configCompiledForm:p};S.isValid&&c.push(S)}c&&1===c.length&&(o=c[0])}a=o},expandV2progressive:function(s){var o=require("DS/PADUtils/PADSettingsMgt");let r=d;var c=o.getSetting("pad_security_ctx")?o.getSetting("pad_security_ctx"):"preferred";c=encodeURIComponent(c);var p=n.get3DSpaceUrl()+r.url+"?tenant="+n.getPlatformId();c&&(p+="&SecurityContext="+c);var u=s.data,h=e.extend({method:l.verb,headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":o.getSetting("lang")},timeout:s.timeout?s.timeout:o.getSetting("webapi_timeout")},s);s.data.boundingbox;var g=[];e.is(u.roots)?g=u.roots:e.is(u.root_physicalid)?g=[[u.root_physicalid]]:e.is(u.paths)?g=u.paths:e.is(u.root_path_physicalid)&&(g=u.root_path_physicalid);var f,_=require("DS/PADServices/utils/AttributesMgtV2"),m=e.extend({label:n.getRequestLabel(),root_path_physicalid:g,locale:o.getSetting("lang"),tenant:n.getPlatformId(),types:_.getSelectedTypes(),extensions:_.getSelectedExtensions()},u);this.configFilterFn(s),(m=m.intent&&"explore_3d"===m.intent.toLowerCase()?t.completeWebAPIPayload("expand3d",m,s):t.completeWebAPIPayload("expand",m,s)).select_bo=m.select_bo.filter(function(e,t,n){return n.indexOf(e)===t}),m.select_rel=m.select_rel.filter(function(e,t,n){return n.indexOf(e)===t}),a&&(a.config_filter&&(m.config_filter=a.config_filter),a.configCompiledForm&&(m.configCompiledForm=a.configCompiledForm)),m.static_mapping=i.getSetting("staticMappingEnabled"),delete h.pids,delete h.enopad_webapis,delete m.intent,delete m.authored,delete m.root_physicalid,!0===i.getSetting("pgpFromServer")&&(f=["show","hide","color","opacity"]);var v=["boundingbox","thumbnail_3d_fallback_cgr"];var S={batch:{expands:[{label:"ProgressiveExpand_Expand_All_"+n.getRequestLabel(),root:{physical_id:s.data.root_path_physicalid},filter:{or:{filters:[{and:{filters:[{prefix_filter:{prefix_path:[{physical_id_path:s.data.root_path_physicalid}]}}]}}]}},graph:o.getSetting("enopad3dviewer_graphDefinitionForExpand"),parameters:{apply_flexible_assembly_matrix:1}}]},outputs:{select_object:s.data.select_bo,select_relation:s.data.select_rel,select_pgp:f,select_flexible_assembly_matrix:1,hits:{predefined_computation:v}}},D={batch:{expands:[{label:"ProgressiveExpand_Expand_All_"+n.getRequestLabel(),root:{physical_id:s.data.root_path_physicalid},filter:{all:1},parameters:{limit_max_path:20001,apply_flexible_assembly_matrix:1},graph:{descending_condition:{uql:"availability:2"},descending_condition_object:{uql:'[ds6w:globaltype]:"ds6w:Document" OR [ds6w:globaltype]:"ds6w:Part"'},descending_condition_relation:{uql:'NOT (flattenedtaxonomies:"reltypes/XCADBaseDependency")'}},aggregation_processors:[{synthesis:{name:"ProgressiveExpand_FlatSynthesis",mode:"flat"}},{synthesis:{name:"ProgressiveExpand_OccSynthesis",mode:"occurence"}},{synthesis:{name:"ProgressiveExpand_LeafSynthesis",mode:"tree_leaf",synthesis_only:1}}]}]},outputs:{select_object:s.data.select_bo,select_relation:s.data.select_rel,select_pgp:f,select_flexible_assembly_matrix:1,hits:{predefined_computation:v},synthesis:["ProgressiveExpand_FlatSynthesis","ProgressiveExpand_OccSynthesis","ProgressiveExpand_LeafSynthesis"]}};"0"!==m.expand_iter&&(S.outputs.select_object&&S.outputs.select_object.push("cestamp"),S.outputs.select_relation&&S.outputs.select_relation.push("cestamp")),"0"===m.expand_iter&&(S=D);let P={cv:S,db:m};return h.data=JSON.stringify(P),h.onTimeout=h.onTimeout||h.onFailure,t.executeRequest(p,h)},refresh:function(t){var n=[],i=[];e.is(t.data.session)&&t.data.session.length>0&&t.data.session.forEach(function(e){e.forEach(function(t){if(t.length>2){var s=t.filter(function(e,t,i){return t%2==0&&t<i.length-2&&!n.includes(e)});n=n.concat(s)}1==e.length&&1==t.length&&(i.push(t[0]),n.push(t[0]))})});var s=[];if(n.forEach(function(e){s.push(new Array(e))}),i.length>0){var o=e.extend({pids:i},t),a=o.onComplete;o.onComplete=function(t){var n=e.is(t,"string")?JSON.parse(t):t;n.full_path=!0,n.results.forEach(function(e){for(var t=0;t<e.attributes.length;t++)if("physicalid"===e.attributes[t].name||"resourceid"===e.attributes[t].name){var i=e.attributes[t].value;e.attributes.push({name:"did",value:i}),n.results.push({path:[i]});break}}),t=JSON.stringify(n),e.is(a,"function")&&a(t)},this.fetch(o)}var r=t;r.data.sessions=r.data.session,delete r.data.session,r.data=e.extend({root_path_physicalid:s,expand_iter:"1"},t.data);a=r.onComplete;r.onComplete=function(t){var n=e.is(t,"string")?JSON.parse(t):t;n.full_path=!1,t=JSON.stringify(n),e.is(a,"function")&&a(t)},this.expand(r)},getDerivedOutputs:function(e){console.group(),console.log("======================================="),console.log("== LWCDirectAccess.getDerivedOutputs =="),console.log("== Fallback on WSAccessV1            =="),console.log("======================================="),console.groupEnd(),require(["DS/PADUtils/utilsWS/WSAccessV1"],function(t){t.getDerivedOutputs(e)})}}}),define("DS/PADUtils/utilsWS/WSAccessV1",["UWA/Core","DS/PADUtils/PADSession","DS/PADUtils/Configuration","DS/PADUtils/utilsWS/WSAdmin","DS/PADUtils/utilsWS/WSMiscellaneous","DS/PADUtils/utilsWS/WS4DECModel","DS/PADUtils/utilsWS/CVServletServices","DS/PADUtils/utilsWS/PADWSv1"],function(e,t,n,i,s,o,a,r){"use strict";var l={fetch:function(e){return!0!==n.getConfig("readOnlyApp")&&!0===e.enopad_webapis||!0===e.forceAuthoringCall?r.fetch(e):a.fetch(e)},navigate:function(e){if(!0===n.getConfig("readOnlyApp")||!0!==e.enopad_webapis){var t="explore_2D"===e.data.intent?"expand":void 0===e.expand3DType?"expand3D":e.expand3DType;return"expand"===t?a.expand(e):(e.expand3DType=t,a.expand3d(e))}return r.navigate(e)},progressiveExpand:function(e){return a.progressiveExpand(e)},searchV2:function(e){return a.searchV2(e)},multiexpand:function(e){var i=!1;return!1===n.getConfig("readOnlyApp")&&(i=e.data&&void 0!==e.data.authored?e.data.authored:t.determineAuthoredFlag()),!0===i&&console.warn("No multiexpand in authoring mode. Call on the index instead"),a.multiexpand(e)},volumeQuery:function(e){return a.volumeQuery(e)},refresh:function(e){return e.data.deepRefresh?a.refresh(e):r.refresh(e)},getDerivedOutputs:function(e){require(["DS/PADUtils/utilsWS/PADWSv1"],function(t){t.getDerivedOutputs(e)})}};return l=e.extend(l,i),l=e.extend(l,s),l=e.extend(l,o)}),define("DS/PADUtils/utilsWS/WSAccessV2",["UWA/Core","DS/PADUtils/PADSession","DS/PADUtils/Configuration","DS/PADUtils/utilsWS/WSAdmin","DS/PADUtils/utilsWS/WSMiscellaneous","DS/PADUtils/utilsWS/LWCDirectAccess","DS/PADUtils/utilsWS/CVServletServices","DS/PADUtils/utilsWS/WS4DECModel","DS/PADUtils/PADSettingsMgt"],function(e,t,n,i,s,o,a,r,l){"use strict";var c={version:2,fetch:function(e){var i=!1;return!1===n.getConfig("readOnlyApp")&&(i=e.data&&void 0!==e.data.authored?e.data.authored:t.determineAuthoredFlag()),!0===i?o.fetch(e):a.fetch(e)},navigate:function(e){var i=!1;if(!1===n.getConfig("readOnlyApp")&&!0===e.enopad_webapis&&(i=e.data&&void 0!==e.data.authored?e.data.authored:t.determineAuthoredFlag()),!0===i)return e.data.timeout&&(e.timeout=e.data.timeout),o.expand(e);var s="explore_2D"===e.data.intent?"expand":void 0===e.expand3DType?"expand3D":e.expand3DType;return"expand"===s?a.expand(e):(e.expand3DType=s,a.expand3d(e))},navigateV2:function(e){return!0===l.getSetting("activateFUN142888")?o.expandV2progressive(e):o.expandV2(e)},multiexpand:function(e){var i=!1;return!1===n.getConfig("readOnlyApp")&&(i=e.data&&void 0!==e.data.authored?e.data.authored:t.determineAuthoredFlag()),!0===i&&console.warn("No multiexpand in authoring mode. Call on the index instead"),a.multiexpand(e)},progressiveExpand:function(e){var n=null;if(!e.readOnly&&t.determineAuthoredFlag()){var i={data:{select_rel:e.data.select_rel,select_bo:e.data.select_bo,compute_select_bo:e.data.compute_select_bo,boundingbox:e.data.boundingbox,root_path_physicalid:e.data.root_path_physicalid,fcs_url_mode:e.data.fcs_url_mode,expand_iter:e.data.expand_iter,intent:"explore_3d"},onComplete:e.onComplete,onFailure:e.onFailure,onTimeout:e.onTimeout,timeout:6e4,FBIProxy:e.FBIProxy};n=this.navigateV2(i)}else n=a.progressiveExpand(e);return n},getRootStats:function(e){var n=null;if(!e.readOnly&&t.determineAuthoredFlag()){var i={data:{select_rel:e.data.select_rel,select_bo:e.data.select_bo,compute_select_bo:e.data.compute_select_bo,boundingbox:!0,root_path_physicalid:e.data.root_path_physicalid?e.data.root_path_physicalid:[[e.data.rootPhID]],fcs_url_mode:e.data.fcs_url_mode,expand_iter:"0",intent:"explore_3d"},onComplete:function(e,t,n){try{var i="string"==typeof n?JSON.parse(n):n;i.results&&i.results.length&&(i.results.push({synthesis:{name:"ProgressiveExpand_FlatSynthesis",value:-1}}),i.results.push({synthesis:{name:"ProgressiveExpand_OccSynthesis",value:-1}}),i.results.push({synthesis:{name:"ProgressiveExpand_LeafSynthesis",value:-1}})),e(JSON.stringify(i))}catch(e){t()}}.bind(this,e.onComplete,e.onFailure),onFailure:e.onFailure,onTimeout:e.onTimeout,timeout:6e4,FBIProxy:e.FBIProxy};n=this.navigateV2(i)}else n=a.getRootStats(e);return n},getStaticMappingExcludedOccurrences:function(e){return a.getStaticMappingExcludedOccurrences(e)},getFlexibleAssemblies:function(e){return a.getFlexibleAssemblies(e)},volumeQuery:function(e){return a.volumeQuery(e)},volumeQueryV2:function(e){return a.volumeQueryV2(e)},getMinMaxDistanceCandidates:function(e){return a.getMinMaxDistanceCandidates(e)},search:function(e){return a.search(e)},searchV2:function(e){return a.searchV2(e)},getIndexingDate:function(e){return a.getIndexingDate(e)},refresh:function(e){if(e.data.deepRefresh)return a.refresh(e);var i=!1;if(!1===n.getConfig("readOnlyApp")&&(i=e.data&&void 0!==e.data.authored?e.data.authored:t.determineAuthoredFlag()),!i&&e.data.session){for(var s=[],r=0;r<e.data.session.length;r++)s=s.concat(e.data.session[r]);return e.data.root_path_physicalid=s,a.refresh(e)}return o.refresh(e)},getDerivedOutputs:function(e){return o.getDerivedOutputs(e)}};return c=UWA.extend(c,i),c=UWA.extend(c,s),c=UWA.extend(c,r)}),define("DS/PADUtils/PADWSAccess",["DS/PADUtils/Configuration","DS/PADUtils/utilsWS/WSAccessV1","DS/PADUtils/utilsWS/WSAccessV2"],function(e,t,n){return!0===e.getConfig("WSAccessV2")?n:t}),define("DS/PADUtils/views/PADSearchView",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Class/View","UWA/Drivers/Alone","DS/Logger/Logger","DS/PADUtils/PADCommandProxy","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/Handlebars/Handlebars","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADTypesMgt","DS/PADUtils/PADContext","UWA/Event"],function(e,t,n,i,s,o,a,r,l,c,d,p){"use strict";var u=n.extend({name:"PADSearchView",_searchTriggered:!1,className:"pad_global_ctn_search",_selected_paths:[],_insertReplaceNode:null,_insertParams:null,domEvents:{"click div.run_ctn_search":"_onSearch","click span.fonticon-check":"_onConfirmSelect","click div.clear_ctn_search":"_onClearSearch","click span.fonticon-up-open":"_onPrevious","click span.fonticon-down-open":"_onNext","keyup input.input_search":"_onSearchInputKeyUp","paste input.input_search":"_onSearchInputPaste","keydown input.input_search":"_onSearchInputKeyDown"},template:null,_logger:null,setup:function(e){var t=this;d.get().getPADTreeDocument()._insertFlag=!0;this._logger=s.getLogger(u),this._logger.log("setup"),!0===e.navigate_onresult?this.template=r.compile('<div class="left_ctn_search ctn_search"></div>    <div class="input_ctn_search ctn_search search_css_temp">        <div class="input_search_div with_nav" id="input_search_div">        <input class="input_search" id="input_search_input" type="text" placeholder="Search" ondrop="event.preventDefault ? event.preventDefault() : event.returnValue = false">        </div>        <div class="pad_count_ctn" id="pad_count_ctn"><div class="pad_count" id="pad_count"></div></div>        <div class="right_search">            <div class="nav_ctn_search ctn_search"><span class="fonticon fonticon-up-open ctn_search pad_nav"  style="display:none;" title="Previous"></span></div>            <div class="nav_ctn_search ctn_search"><span class="fonticon fonticon-down-open ctn_search pad_nav"  style="display:none;" title="Next"></span></div>            <div class="clear_ctn_search ctn_search"><div class="clear_btn_search" style="display:none;"></div></div>            <div class="run_ctn_search ctn_search"><div class="run_btn_search" style="opacity:0.1;"></div></div>            <div class="right_ctn_search ctn_search"></div>        </div>    </div>'):this.template=r.compile('<div class="left_ctn_search ctn_search"></div>    <div class="input_ctn_search ctn_search search_css_temp">        <div class="input_search_div" id="input_search_div">        <input class="input_search" id="input_search_input" type="text" placeholder="Search" ondrop="event.preventDefault ? event.preventDefault() : event.returnValue = false">        </div>        <div class="right_search">            <div class="clear_ctn_search ctn_search"><div class="clear_btn_search" style="display:none;"></div></div>            <div class="nav_ctn_search ctn_search"><span class="fonticon fonticon-check fonticon-1x"  style="opacity:0;"></span></div>            <div class="run_ctn_search ctn_search"><div class="run_btn_search"  style="opacity:0.1;"></div></div>            <div class="right_ctn_search ctn_search"></div>        </div>    </div>'),this._searchTriggered=!1,this._parent(e),this._commandProxy=o.create({events:{onSelect:function(e,n){function i(){t.$clearSearchButton.style.display="inline-block",t.$searchInput.value=t._insertParams["ds6w:label"],t.input_text=t.$searchInput.value,t.$searchButton.style.opacity=1,t.$checkButton.style.opacity=1,d.get().getPADTreeDocument()._insertSelected=!0}if(d.get().getPADTreeDocument()._insertFlag&&!0===d.get().getPADTreeDocument().options.insert_replace&&e.paths[0]){var s=e.paths[0],o=s[s.length-1],r=[];r.push({type:e.attributes[o].type}),c.isTypesAuthorized(r,function(n){n.length>0&&(t._selected_paths=e.paths[0],t._insertReplaceNode=t._selected_paths[t._selected_paths.length-1],t._insertParams={"ds6w:type":e.attributes[t._insertReplaceNode].type,"ds6w:label":e.attributes[t._insertReplaceNode].label},UWA.is(t._insertParams["ds6w:label"])?i():require(["DS/PADUtils/PADWSAccess"],function(e){t._insertParams["ds6w:label"]=a.PADProgressBar_loading,i();var n=l.getWebAPI_Options("fetch");e.fetch({enopad_webapis:l.getSetting("enopad_webapis"),data:n,pids:[t._selected_paths[t._selected_paths.length-1]],onComplete:function(e){var n=UWA.is(e,"string")?JSON.parse(e):e;if(n.results&&1===n.results.length){var s,o=n.results[0],a=null,r=o.attributes.length;for(s=0;s<r&&!a;s++)"ds6w:label"===o.attributes[s].name&&(a=o.attributes[s].value);t._insertParams["ds6w:label"]=a,i()}else t._insertParams["ds6w:label"]=null,i()},onFailure:function(){t._insertParams["ds6w:label"]=null,i()}})}))})}}}})},render:function(){this._logger.log("render");var e=this.template();return this.container.setContent(e),function(e,n,i){var s,o,a;if(!t.is(e,"object"))return e;for(s=0,o=(a=Object.keys(e)).length;s<o;s++)n.call(i,e[a[s]],a[s],e)}({searchInput:"input.input_search",searchButton:"div.run_btn_search",checkButton:"span.fonticon-check",searchOptionButton:".option_ctn_search",clearSearchButton:"div.clear_btn_search",onprevious:"span.fonticon-up-open",onnext:"span.fonticon-down-open",padcount:"div.pad_count"},function(e,t){this["$"+t]=this.getElement(e)},this),this.$onprevious&&(this.$onprevious.title=a.PADSearchView_previous),this.$onnext&&(this.$onnext.title=a.PADSearchView_next),this.$clearSearchButton&&(this.$clearSearchButton.title=a.PADSearchView_clear),this.$searchButton&&(this.$searchButton.title=a.PADSearchView_search),this.$checkButton&&(this.$checkButton.title=a.PADSearchView_check),!0===d.get().getPADTreeDocument().options.insert_replace?(this.$searchInput.placeholder=a.PADSearchView_search_select,this.$searchInput.title=a.PADSearchView_search_select):(this.$searchInput.placeholder=a.PADSearchView_search,this.$searchInput.title=a.PADSearchView_search),setTimeout(function(){this.$searchInput.focus()}.bind(this),500),this},setCount:function(e){this.$padcount.setContent(e.index+"/"+e.total),null!==this.$onprevious&&null!==this.$onnext&&(this.$onprevious.setStyle("display","inline-block"),this.$onnext.setStyle("display","inline-block"))},_onConfirmSelect:function(e){!0===d.get().getPADTreeDocument()._insertSelected&&(UWA.is(this.options.callbacks.onSearch,"function")&&this.options.callbacks.onSearch.call(null,[{search_value:this.$searchInput.value,resourceid:this._insertReplaceNode,"ds6w:type":this._insertParams["ds6w:type"],"ds6w:type_value":this._insertParams["ds6w:type"],"ds6w:label":this._insertParams["ds6w:label"]}]),d.get().getPADTreeDocument()._insertSelected=!1,d.get().getPADTreeDocument()._insertFlag=!1)},_onSearch:function(e){d.get().getPADTreeDocument()._insertSelected=!1,this._logger.log("_onSearch"),this.$searchInput.blur(),UWA.is(this.options.callbacks.onSearch,"function")&&this.options.callbacks.onSearch.call(null,{search_value:this.$searchInput.value}),d.get().getPADTreeDocument()._insertFlag=!1},_onClearSearch:function(e){this._logger.log("_onClearSearch"),this.$searchInput.value="",this.$clearSearchButton.hide(),this.$checkButton&&this.$checkButton.setStyle("opacity","0"),this.$searchButton.setStyle("opacity","0.1"),this._searchTriggered=!1,null!==this.$onprevious&&null!==this.$onnext&&null!==this.$padcount&&(this.$onprevious.hide(),this.$onnext.hide(),this.$padcount.setContent("")),UWA.is(this.options.callbacks.onClear,"function")&&this.options.callbacks.onClear.call(null)},_onSearchInputKeyUp:function(e){this.$searchInput.value?(this.$searchButton.setStyle("opacity","1"),this.$clearSearchButton.setStyle("display","inline-block"),null!==this.$onprevious&&null!==this.$onnext&&!0===this._searchTriggered&&(this.$onprevious.setStyle("display","inline-block"),this.$onnext.setStyle("display","inline-block"))):(this.$clearSearchButton.hide(),null!==this.$onprevious&&null!==this.$onnext&&null!==this.$padcount&&(this.$onprevious.hide(),this.$onnext.hide(),this.$padcount.setContent("")),this.$searchButton.setStyle("opacity","0.1")),this.$checkButton&&this.input_text!==this.$searchInput.value&&(d.get().getPADTreeDocument()._insertSelected=!1,this.$checkButton.setStyle("opacity","0.2"))},_onSearchInputPaste:function(e){var t=this;setTimeout(function(){t._onSearchInputKeyUp()},200)},_onPrevious:function(){UWA.is(this.options.callbacks.onPrevious,"function")&&this.options.callbacks.onPrevious.call(null)},_onNext:function(){UWA.is(this.options.callbacks.onNext,"function")&&this.options.callbacks.onNext.call(null)},_onSearchInputKeyDown:function(e){"return"!==p.whichKey(e)&&"Enter"!==e.keyIdentifier&&"return"!==e.keyIdentifier||(!0===d.get().getPADTreeDocument()._insertSelected?(UWA.is(this.options.callbacks.onSearch,"function")&&this.options.callbacks.onSearch.call(null,[{search_value:this.$searchInput.value,resourceid:this._insertReplaceNode,"ds6w:type":this._insertParams["ds6w:type"],"ds6w:type_value":this._insertParams["ds6w:type"],"ds6w:label":this._insertParams["ds6w:label"]}]),d.get().getPADTreeDocument()._insertSelected=!1,d.get().getPADTreeDocument()._insertFlag=!1):this._onSearch()),p.stopPropagation(e)}});return u}),define("DS/PADUtils/views/PADModalChooser",["css!DS/PADUtils/PADUtils","UWA/Core","UWA/Class","UWA/Class/Options","UWA/Drivers/Alone","DS/Logger/Logger","i18n!DS/PADUtils/assets/nls/PADUtils.json","DS/PADUtils/views/PADSearchView","DS/UIKIT/Modal","css!UIKIT/UIKIT.css","DS/PADUtils/PADContext","DS/PADUtils/PADUtilsServices","DS/PADServices/utils/SearchUtils"],function(e,t,n,i,s,o,a,r,l,c,d,p,u){"use strict";return n.extend(i,{name:"padmodalchooser",_logger:null,_modal:null,options:{},init:function(e){if(this._logger=o.getLogger(r),this._logger.log("init"),this._parent(e),this.setOptions(e),!e.renderTo){var t=document.getElementsByClassName("xnav_component");t&&1===t.length?e.renderTo=t[0]:e.renderTo=document.body}var n=UWA.createElement("div"),i=this,s=new r({callbacks:{onSearch:this._onPADSearch.bind(this)}});if(s.render().inject(n),document.addEventListener("keyup",function(e){27===e.keyCode&&(i._modal.destroy(),d.get().getPADTreeDocument()._insertFlag=!1)}),this._modal=new l({className:this.name+"_modal",closable:!1,body:n,visible:!0,overlay:!UWA.is(this.getOption("overlay"))||this.getOption("overlay")}),e.position)if(e.position.top&&e.position.left)this._modal.elements.content.setStyle("top",e.position.top),this._modal.elements.content.setStyle("left",e.position.left);else switch(e.position){case"above_action_bar":var a=e.renderTo.getBoundingClientRect();this._modal.elements.wrapper.setStyle("padding-top","calc("+a.height+"px - 80px)"),this._modal.elements.wrapper.setStyle("padding-left","calc(50% - 135px)");break;default:this._logger.log("unknown style")}this._modal.elements.container.addEventListener("click",function(e){console.log("view click",e),i._modal.destroy(),d.get().getPADTreeDocument()._insertFlag=!1}),this._modal.elements.content.addEventListener("click",function(e){return e.preventDefault(),e.stopPropagation(),!1}),this._modal.inject(e.renderTo),s.$searchInput.focus()},close:function(){this._modal.destroy()},_onPADSearch:function(e){this._logger.log("_onPADSearch with "+JSON.stringify(e));var t=this;if(!0===d.get().getPADTreeDocument()._insertSelected)t._modal.destroy(),this.getOption("in_apps_search").in_apps_callback.call(null,e);else if(e.search_value.length){var n,i=this.getOption("in_apps_search");if(!0===this.getOption("retrieveSearchValue")){n=e.search_value,t._modal.destroy();var s=this.getOption("searchValueCallback");UWA.is(s,"function")&&s.call(null,{searchValue:n})}else i&&(n=e.search_value,i.fts_value=n,i.callback=function(e){t._logger.log("In Apps Search callback"),t._modal.destroy(),UWA.is(i.in_apps_callback,"function")&&i.in_apps_callback.call(null,e)},i.cancel=function(){t._logger.log("In Apps Search Cancel callback"),t._modal.destroy()},u.inAppsSearch(i))}else this._logger.log("No search done since no string inside the input"),this._modal.destroy()}})});