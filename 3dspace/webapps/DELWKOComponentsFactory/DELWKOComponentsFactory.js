define("DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessDataCollectionUI",["UWA/Core","DS/DELWKOViewBehaviors/DELWKOFormUI","DS/DELPPWModelServices_FD02/BehaviorUtil","text!DS/DELPPWViewBehaviors_FD02/assets/json/TypeMapping.json"],function(e,t,n,i){"use strict";return function(r,o,a,l,s,c,u){var d,f,g,p=null,m=null,y=null,C=null,v=null,L=null,T=null,h=null,I=null,S={},V=null,D=null,b=!1,w=!1,F=new e.Element("div",{class:"Form-Sections-Container"}),E=a.getComponent("ComboBox"),O=a.getComponent("Accordeon"),U=a.getComponent("TooltipModel"),N=e.Json.decode(i),W=function(t){var n;y=t.dsModel.currentValue,n=p.concat("/",y),d.type=n,I.destroy(),e.is(V)&&V.destroy(),null===D&&B(),A(function(e){j(e)}),d.onTypeChange(y,F)},k=function(e){m=e.dsModel.currentValue,D.destroy(),D=null,W(e)},P=function(e){L=e.dsModel.currentValue},M=function(e){e.sort(function(e,t){return e.label.localeCompare(t.label,widget.lang,{numeric:!0})})},x=function(t){var n,i,r=[];return n={elementsList:r=t.elementsList.map(function(e){return{labelItem:e.label,valueItem:e.value}}),actionOnClickFlag:!1,enableSearchFlag:!1},e.is(t.selected)&&(n.selectedIndex=r.findIndex(function(e){return e.valueItem===t.selected})),(i=new E(n)).fieldType=t.fieldType,S[t.name]=i,e.is(t.onChange,"function")&&i.addEventListener("change",t.onChange),i},B=function(){var t=function(){var t,i,o,a,s,c,d,f,p,C,v,T,I,S={},V=[];e.is(h,"object")&&e.owns(h,y)&&(S=h[y]),C=function(t){let n={},i=[];return e.is(S,"object")&&e.owns(S,"Type")&&(n=function(t,n){let i;return Array.isArray(t.Type)&&(i=t.Type.find(function(e){return e.name===n})),e.is(i)?i:{}}(S,t)),e.is(n,"object")&&(e.owns(n,"visibility")&&"true"===n.visibility||!e.owns(n,"visibility"))&&(p=u.getTypeInfo(t),u.isAKindOf(t,"Resource")?(e.owns(p,"isOOTB")&&"false"===p.isOOTB||e.owns(p,"Newable")&&function(e){let t=e.toUpperCase();return["NEW","ALL"].some(e=>t.includes(e))}(p.Newable))&&i.push({value:t,label:l.getNLSValue(t,null,"Type")}):i.push({value:t,label:l.getNLSValue(t,null,"Type")})),i},V=V.concat(C(y)),e.is(m)&&m!==y?(V=V.concat(C(m)),f=u.getTypeHierarchy(m)):f=u.getTypeHierarchy(y),e.is(f,"array")&&f.forEach(function(e){e!==y&&(V=V.concat(C(e)))}),M(V),d=new e.Element("div",{class:"section-container"}),t=new e.Element("div",{class:"wux-field-container inline-container"}).inject(d),a=new e.Element("div",{class:"wux-field-container inline-container"}).inject(d),o=new e.Element("h6",{class:"wux-type-textElement",text:l.getNLSValue("General.Type")}).inject(t),i=x({name:"V_Type",elementsList:V,fieldType:"select",selected:y,onChange:W}),o.tooltipInfos=new U({shortHelp:l.getNLSValue("General.Type")}),i.inject(t),!1===n.isCloud()&&(c=new e.Element("h6",{class:"wux-type-textElement",text:l.getNLSValue("General.Credentials")}).inject(a),s=function(){var t=r.getService("ConfigService").getSecurityContext(),n=t.getAllSC(),i=r.getConfig().isFacet&&!t.getSCFromPreferences().includes("ctx::")?"ctx::"+t.getSCFromPreferences():t.getSCFromPreferences(),o=new E({elementsList:n.map(function(e){return{labelItem:e.label,valueItem:e.value}}),actionOnClickFlag:!1,enableSearchFlag:!1,selectedIndex:n.findIndex(function(e){return e.value===i})});return L=i,e.is(P,"function")&&o.addEventListener("change",P),o}(),c.tooltipInfos=new U({shortHelp:l.getNLSValue("General.Credentials")}),s.inject(a)),v="Section.General",T=d,I=new e.Element("div",{class:"Type-Section-Container"}).inject(F),new O({items:[{header:l.getNLSValue(v)?l.getNLSValue(v):v,content:T,expandedFlag:!0}],style:"filled-separate"}).inject(I),T.addEvent("resize",function(){var t,n,i,r;r=T.getElements(".wux-field-container"),(i=T.clientWidth)<290?(t="inline-container",n="block-container"):i>290&&"block-container"===g?(t="inline-container",n="block-container"):(t="block-container",n="inline-container"),e.is(r)&&r.forEach(function(e){e.removeClassName(t),e.addClassName(n)})}),D=I};e.is(h)?t():s.getXMLValues(r.getConfig().resource.ItemOOTBFiltering,function(n){e.owns(N,o.getId())&&(h=n.convert("Config.Preferences."+N[o.getId()].section+".OOTBType","name")),t()},function(e){w=!0,o.debug("failed to get ItemOOTBFiltering XML. Error Desc: "+e)})},A=function(t){var n=function(){var n,i=T[y]||{};if(e.owns(i,"Section")||(i.Section={},i.Section.name=l.getNLSValue("Section.Attributes"),i.Section.Attribute=[{dicoType:"PLMEntity",name:"V_Name",mandatory:!0},{dicoType:"PLMEntity",name:"V_description"}]),"ProcessContinuousProvide"===y&&e.is(f)&&!1===f){switch(C){case"LENGTH":n="DELFmiContQuantity_Length";break;case"MASS":n="DELFmiContQuantity_Mass";break;case"AREA":n="DELFmiContQuantity_Area";break;case"VOLUME":n="DELFmiContQuantity_Volume";break;default:n=null}i.Section.Attribute.push({dicoType:n,name:"V_ContQuantity",readOnly:!1})}t(i)};e.is(T)?n():s.getXMLValues(r.getConfig().resource.createWorkOrderFromProcessFormAttributeXML,function(e){T=e.convert("AttributesDescriptionList.Type","name"),n()},function(e){b=!0,o.debug("failed to get createWorkOrderFromProcessFormAttributeXML XML. Error Desc: "+e)})},j=function(n){I=new t(r,o,a,l,c,u),V=new e.Element("div",{class:"Form-container"}),I.createUI({sections:n,type:d.type,renderTo:V,defaultValues:v}),V.inject(F),g=I.getFormStyle()},R=function(){return b||w};return{createUI:function(t){d=t||{},e.is(d.type)&&e.is(d.renderTo)&&(b=!1,w=!1,y=d.type.split("/")[1]||"",p=d.type.split("/")[0],C=d.dimension,d.defaultValues&&(v=d.defaultValues[0]),e.is(d.createRoot)&&(f=d.createRoot),A(function(t){var n,i=[];if(e.is(t.Section)){var r=t.Section;if(e.is(r)){var o=r.Attribute,a=(n=o,new e.Promise(function(t,i){var r=0,o=0;n.forEach(n=>{e.is(n.implementation)&&(r++,require([n.implementation],function(e){o++,n.customUI=e,o===r&&t()}))}),0===r&&t()}));i.push(a)}}e.Promise.all(i).then(function(n){var i,r,o,a;e.is(d.baseTypes)&&(a=d.baseTypes.map(function(e){return{value:e,label:l.getNLSValue(e,null,"Type")}}),M(a),i=new e.Element("div",{class:"top-container inline-container"}).inject(F),r=new e.Element("h6",{class:"wux-type-textElement",text:l.getNLSValue("Base.Type")}).inject(i),o=x({name:"V_BaseType",elementsList:a,fieldType:"select",selected:d.selectedBaseType,onChange:k}),r.tooltipInfos=new U({shortHelp:l.getNLSValue("Base.Type")}),o.inject(i),m=d.selectedBaseType),B(),j(t)})}),R()&&e.is(d.onFailure,"function")&&d.onFailure({invalidXML:!0}),F.inject(d.renderTo))},destroy:function(){e.is(I)&&I.destroy(),e.is(V)&&V.destroy(),e.is(F)&&F.destroy()},getValues:function(){var t,n={};return e.owns(S,"V_Type")&&e.is("V_Type")&&(S.V_Type.currentValue?(n.V_Type=p.concat("/",S.V_Type.currentValue),n.type=y):(n.V_Type=S.V_Type,n.type=y)),t=I.getValues(),e.extend(t,n),t},getSecurityContextOverride:function(){return L},validate:function(){return R()?{result:!1,message:l.getNLSValue("ModelBehavior.CreateReference.Failure.InvalidXML")}:I?I.validate():{result:!0,message:null}},updateToDefaultValues:function(e){I&&I.updateToDefaultValues(e)}}}}),define("DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessUI",["UWA/Core","DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessDataCollectionUI"],function(e,t){"use strict";return function(t,n,i,r){var o,a=1,l=2,s=3,c=1,u=2,d=3,f=n.getComponent("Element"),g=n.getComponent("Button"),p=null,m=null,y=null,C=!1,v=function(t){e.is(t)&&e.is(t.invalidXML)&&(C=t.invalidXML)},L=function(e,t){var n;switch(o){case u:return n="InsertUI.ReplaceByNewDialog.Title",i.getNLSValue(n,{type:i.getNLSValue(e,null,"Type")});case d:return n="InsertUI.ContinuousProvidedMaterial.Title",i.getNLSValue(n,{dimension:i.getNLSValue(t,null,"Dimension")});default:return n="InsertUI.CreateDialog.Title",i.getNLSValue(n,{type:i.getNLSValue(e,null,"Type")})}},T=function(c,d,f,v,T){var h,I,S,V,D,b,w,F,E,O=e.is(T)&&e.is(T.fatherPID,"string")&&T.fatherPID.length>0?T.fatherPID:null,U=e.is(T)&&e.is(T.transactionUUID,"string")&&T.transactionUUID.length>0?T.transactionUUID:null,N={transactionUUID:U,requestedCreation:0},W=t.getPreferenceValue("showDialog")&&(!e.is(f,"boolean")||f);switch(F=function(){!0!==(S=p.validate()).result?(I=i.getNLSValue("ModelBehavior.CreateReference.Failure.ReferenceNotCreated")+S.message,t.warn(I),y.close()):(E=p.getSecurityContextOverride(),h=p.getValues(),y.close(),d(h,{securityContextOverride:E,fatherPID:O,transactionUUID:U}))},D=function(n){var i=function(){return S=p.validate(),E=p.getSecurityContextOverride(),!0!==S.result?(e.is(S.message)&&y.error(S.message),!1):(y.clearMessages(),h=p.getValues(),d(h,{securityContextOverride:E,fatherPID:O,transactionUUID:U}),!0)},r=function(){y.close()};switch(n){case a:return function(){S=null,r(),e.is(U)&&t.notify("objectCreationUIClosed",N)};case s:return function(){e.is(U)&&N.requestedCreation++,i()};case l:return function(){i()&&(r(),e.is(U)&&(N.requestedCreation++,t.notify("objectCreationUIClosed",N)))};default:t.log("wrong option")}},o){case u:V={No:new g({label:i.getNLSValue("InsertUI.Close.Title"),onClick:D(a)}),Yes:new g({label:i.getNLSValue("InsertUI.ReplaceAndClose.Title"),onClick:D(l)})};break;default:V={No:new g({label:i.getNLSValue("InsertUI.Close.Title"),onClick:D(a)}),Apply:new g({label:i.getNLSValue("InsertUI.Create.Title"),onClick:D(s)}),Yes:new g({label:i.getNLSValue("InsertUI.CreateAndClose.Title"),onClick:D(l)})}}e.is(n)?(w={title:L(c.split("/")[1]||"",v),domId:"CreateWorkOrder-dialog",content:m,resizableFlag:!0,modalFlag:!0,minWidth:290,buttons:V,visibleFlag:W},e.is(r)&&(b=c.indexOf("/")>-1?c.split("/")[1]:c,r.getPPRTypeFromType(b),w=e.merge({position:{my:"top",at:"top"},height:520,width:600},w)),(y=n.create("Dialog",w)).close=function(){e.is(p)&&(p.destroy(),p=null),e.is(m)&&m.destroy(),this.destroy(),y=null},W?C&&y.error(i.getNLSValue("ModelBehavior.CreateReference.Failure.InvalidXML")):F()):t.debug("uxFactoryBehavior is not available.")},h=function(e){y.title=L(e),y.clearMessages()};return{createDialog:function(t,i,r,a,l,s){o=c,e.is(a)&&(o=d),m=new f("div",{class:"Insert-Command-Container"}),e.is(y)||(e.is(p)||(p=n.create("DELWKOCreateWorkOrderFromProcessDataCollectionUI",{type:t,onTypeChange:h,renderTo:m,dimension:a,createRoot:l,onFailure:v})),T(t,i,r,a,s))},createDialogForReplaceByNew:function(t,i,r,a){o=u,m=new f("div",{class:"Insert-Command-Container"}),e.is(y)||(e.is(p)||(p=n.create("DataCollectionUI",{type:r,baseTypes:t,selectedBaseType:i,onTypeChange:h,renderTo:m,onFailure:v})),T(r,a))},isActive:function(){return!!e.is(y)&&y.visibleFlag},destroyUI:function(){e.is(y)&&y.close()}}}}),define("DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessCmdModule",["UWA/Core","DS/DELWKOComponentsFactory/DELWKOCreateWorkOrderFromProcessUI"],function(e,t){"use strict";return{behaviors:["UXFactoryBehavior","DELWKOModelBehavior","LinkBehavior","ResourceBehavior","SelectionBehavior","SearchBehavior","ReplaceBehavior"],creator:function(n,i,r,o,a,l,s,c){var u,d,f,g,p={},m=null,y=null;return g=function(){var t,n,i;if(i=l.getSelections(),e.is(i,"array")&&i.length>0)for(n=0;n<i.length;n++)if(t=i[n][0],e.is(t))return t},d=function(e,t){g(),r.createWorkOrderFromProcess(e,void 0,t)},f=function(t,n){e.is(n.newRef)&&c.replace("replaceByNew",n.newRef.id)},function(e,t){t.onComplete=f,t.silent=!0,r.createRefOrInst(e,null,t)},u=function(t){var n,i,r,o=t.arguments,a="",l=[];m.isActive()&&m.destroyUI(),y=null,e.is(o,"array")&&0<o.length&&o.forEach(function(t){if(e.is(t)&&e.is(t.ID,"string")&&e.is(t.Value,"string"))switch(t.ID){case"ReferenceType":a=t.Value;break;case"ShowDialog":n="false"!==t.Value;break;case"DisplayedInTableView":e.is(this._displayedInTableView,"array")||(l=[]),l.push(t.Value);break;case"V_DimensionType":y=t.Value}},this),e.is(y)&&(r=g(),e.is(r)&&(i=!1)),a="DELLmiWorkOrder/DELLmiWorkOrderReference",m.createDialog(a,d,n,y,i)},{listenTo:function(){return{CreateWorkOrderFromProcessCmd:u}},onStart:function(o,l){p=e.extend(p,o),e.is(p.createWorkOrderFromProcessFormAttributeXML)||(n.debug("CreateWorkOrderFromProcess Module loading failed : insertFormAttributeXML option is undefined"),l()),m=new t(n,i,a,r),l()},onStop:function(){m.isActive()&&m.destroyUI(),m=void 0}}}}});