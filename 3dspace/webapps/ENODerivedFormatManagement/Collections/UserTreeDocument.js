define("DS/ENODerivedFormatManagement/Collections/UserTreeDocument",["DS/TreeModel/TreeNodeModel","DS/TreeModel/TreeDocument","DS/ENODerivedFormatManagement/Utils/DerivedFormatUtil"],function(e,t,r){return t.extend({x3dsearch:function(e,t){var a=this;return a.options.uuid=t,a.options.query=e,new UWA.Promise(function(n,s){if(a.options.key){var l={query:a.options.query,label:"convuser-search-"+r.unique(),locale:window.widget?window.widget.lang:"en",tenant:widget.getValue("x3dPlatformId"),order_by:"desc",order_field:"relevance",select_predicate:["ds6w:resourceUid","ds6w:label","preview_url","ut_state"],specific_source_parameter:{swym:{additional_query:'[ds6w:type]:("pno:Person")'}},source:["swym"]};r.server({url:r.getPlatformURL("3DSearch")+"/search?tenant="+widget.getValue("x3dPlatformId")+"&xrequestedwith=xmlhttprequest",method:"POST",data:JSON.stringify(l),onComplete:a.onSuccess.bind(null,a,e,t,n),onFailure:a.onFailure.bind(null,a,s)})}})},onSuccess:function(t,a,n,s,l){var o,u=(l=l&&JSON.parse(l)).results,i=null;if(u&&(t.prepareUpdate(),t.empty(),u.forEach(r=>{var a=r.attributes.reduce((e,t)=>(e[t.name]=t.value,"ut_state"==t.name&&(o=t.value),"ds6w:resourceUid"==t.name&&(c=t.value),e),{});if(a["ds6w:label"]&&1==a.ut_state){i={id:a.resourceid,label:a["ds6w:label"],value:a.resourceid,uuid:a["ds6w:resourceUid"]};var n=new e(i);t.addRoot(n)}}),t.pushUpdate()),a.contains("ds6w:resourceUid"))if(null==i){var d,c=n;r.getUserInformation(c).then(function(e){d={label:e.label,status:e.status},s(d)})}else d={label:i.label,status:o},s(d);else s()},onFailure:function(e,t){t()},parse:null,addUser:function(e,t){this.prepareUpdate(),this.addRoot({label:e,value:t}),this.pushUpdate()}})});