define("DS/RTUserPresenceAPI/RTUPavatar",["UWA/Class/View","DS/UIKIT/Tooltip"],function(e){"use strict";return e.extend({tagName:"div",className:"RTUPavatar",render:function(){return this.container.setContent([{tag:"img",class:"img-responsive img-rounded",src:this.model.get("avatarUrl"),alt:this.model.get("username")}]),this},inject:function(e){return this.container.inject(e),this},destroy:function(){return this.stopListening(),this._parent()},setup:function(){this.listenTo(this.model,"onChange:avatarUrl",this.render)}})}),define("DS/RTUserPresenceAPI/RTUPuser",["UWA/Class/Model"],function(e){"use strict";return e.extend({defaults:{login:"noLogin",presence:"Offline",username:"username",noAvatar:!1,avatarUrl:"./resources/en/1/webapps/InstantMessaging/assets/avatarDefault.png"}})}),define("DS/RTUserPresenceAPI/RTUPbadge",["UWA/Class/View","DS/UIKIT/Tooltip"],function(e,t){"use strict";const s={offline:"#d1d4d4",online:"#57B847",busy:"#EA4F37",away:"#E87B00"};return e.extend({tagName:"div",className:"RTUPbadge",render:function(e){var t,n=(this.model.get("presence")||"Unknown").toLowerCase(),r=s[n]||s.offline;switch(n){case"away":t="fonticon-cancel";break;case"offline":t="";break;case"busy":t="fonticon-minus";break;case"online":t="fonticon-check";break;default:t="fonticon-3ds-why"}return this.container.setContent([{tag:"span",class:"fonticon "+t,styles:{background:r}}]),this.container.getElement(".fonticon").addClassName=function(){},"fonticon-3ds-why"==t?this.hide():this.show(),this},setup:function(){this.listenTo(this.model,"onChange:presence",this.render)},inject:function(e){return this.container.inject(e),this},destroy:function(){return this.stopListening(),this._parent()}})}),define("DS/RTUserPresenceAPI/RTUserPresenceAPI",["UWA/Class/View","UWA/Class/Events","UWA/Class/Listener","DS/RTUserPresenceAPI/RTUPbadge","DS/RTUserPresenceAPI/RTUPavatar","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/RTAPIManager/RTAPIManager","DS/RTAPIManager/RTAPIuserModel","css!../RTUserPresenceAPI/RTUserPresenceAPI.css"],function(e,t,s,n,r,i,a,o){"use strict";return e.extend({tagName:"div",className:"RTUPAPI",setup:function(e){if(!e.login)return console.error("RTUserPresenceAPI needs login");if(!e.tenantId)return console.error("RTUserPresenceAPI needs tenantId");e.tenant=e.tenantId;var t,s=a.setUser(e);this.user=s,this.tenant=e.tenantId,this.noAvatar=e.noAvatar,this.swymUrl=e.swymUrl;try{this.swymUrl=this.swymUrl||document.IMCall.vmCall.$store.state.swymUrl}catch(e){this.swymUrl=this.swymUrl}if(e.devEnv)s.set({avatarUrl:"./assets/avatarDefault.png"});else if(this.swymUrl||e.noAvatar||s.get("hasAvatar")||!e.tenantId){if(!this.swymUrl)return console.error("RTUserPresenceAPI impossible to compute avatar url");this.user.set({avatarUrl:this.swymUrl+"/api/user/getpicture/login/"+e.login}),this.user.set({hasAvatar:!0})}else i.getServiceUrl({serviceName:"3DSwym",platformId:e.tenantId,onComplete:(t=this,function(s){t.user.set({avatarUrl:s+"/api/user/getpicture/login/"+e.login}),t.user.set({hasAvatar:!0}),t.swymUrl=s}),onFailure:function(e){console.error("RTUserPresenceAPI failed to retrieved 3DSwym url via i3DXCompassPlatformServices.getServiceUrl")}});return this.noAvatar||(this.avatar=new r({model:s,id:"AvatarView-"+s.cid})),this.badge=new n({model:s,id:"BadgeView-"+s.cid}),e.size&&(this.container.style.width=e.size,this.container.style.height=e.size,"80px"==e.size&&this.container.addClassName("big")),e.onclick&&(this.container.onclick=e.onclick,this.container.addClassName("clickable")),e.renderTo?this.render().inject(e.renderTo):this.render(),this},platformListener:function(e){return a._platformListener(e)},render:function(){return this.container.setContent([]),!this.noAvatar&&this.avatar&&this.avatar.render().inject(this.container),this.badge.render({noAvatar:this.noAvatar}).inject(this.container),this},inject:function(e){return this.container.inject(e)},destroy:function(){return this.stopListening(),this.avatar&&this.avatar.destroy(),this.badge&&this.badge.destroy(),this._parent()}})});