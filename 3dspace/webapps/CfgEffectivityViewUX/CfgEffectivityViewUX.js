define("DS/CfgEffectivityViewUX/scripts/CfgEffectivityView",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/UIKIT/Iconbar","DS/Controls/ComboBox","DS/Controls/TooltipModel","DS/Controls/Expander","DS/Controls/Toggle","DS/Handlebars/Handlebars4","DS/CfgEvolutionUX/CfgEvolutionViewSelector","DS/CfgEvolutionUX/CfgEvolutionCriteriaBaseView","DS/CfgBaseUX/scripts/CfgUtility","text!DS/CfgEffectivityViewUX/scripts/CfgEffectivityViewTemplate.html","text!DS/CfgEffectivityViewUX/scripts/CfgEvolutionToolbarTemplate.html","text!DS/CfgEffectivityViewUX/scripts/CfgEvolutionViewTemplate.html","text!DS/CfgEffectivityViewUX/scripts/CfgVariantViewTemplate.html","text!DS/CfgEffectivityViewUX/scripts/CfgOccurrenceToolbarTemplate.html","text!DS/CfgEffectivityViewUX/scripts/CfgOccurrenceViewTemplate.html","i18n!DS/CfgEffectivityViewUX/assets/nls/CfgEffectivityView","css!DS/CfgEffectivityViewUX/styles/CfgEffectivityView.css"],function(e,t,o,i,n,r,c,l,a,s,f,u,d,p,m,h,E,x,v){"use strict";return t.extend({tagName:"div",className:"cfg-eff-view",init:function(e){var t=this;this._parent(e),this.effViewData=e.effViewData,this.effViewPanelTemplate=a.compile(d),this.evolutionToolbarPanelTemplate=a.compile(p),this.evolutionViewPanelTemplate=a.compile(m),this.variantViewPanelTemplate=a.compile(h),this.occurrenceToolbarPanelTemplate=a.compile(E),this.occurrenceViewPanelTemplate=a.compile(x),this.modelComboboxData=[],this.effViewData.effModels.forEach(function(e){1!=e.criteria.length||"MV"!=e.criteria[0].name&&"MP"!=e.criteria[0].name||""!=e.variantDisplayExpression?e.monoCriteria=!1:e.monoCriteria=!0,t.modelComboboxData.push({valueItem:e.modelName,labelItem:e.modelLabel})}),this.textGraphComboboxData=[{valueItem:"TEXT",labelItem:v.TEXT_LABEL,iconItem:"text"},{valueItem:"GRAPH",labelItem:v.GRAPH_LABEL,iconItem:"graph-egraph-list"}],this.textOnlyComboboxData=[{valueItem:"TEXT",labelItem:v.TEXT_LABEL,iconItem:"text"}],this.displayCompactMode=null==t.options.displayCompactMode||null==t.options.displayCompactMode||0!=t.options.displayCompactMode},adjustResponsiveView:function(){this.options.parentElement.getDimensions&&(this.options.parentElement.getDimensions().width<360?(this.createAndSetTextGraphViewCombobox(this.evolutionViewCombobox.elementsList,this.evolutionViewCombobox.selectedIndex,!0),this.container.getElement(".model-ux-switch-section").setAttributeNode(document.createAttribute("mobile-device")),this.container.getElement(".model-section").setAttributeNode(document.createAttribute("mobile-device")),this.container.getElement(".ux-switch-section").setAttributeNode(document.createAttribute("mobile-device"))):(this.createAndSetTextGraphViewCombobox(this.evolutionViewCombobox.elementsList,this.evolutionViewCombobox.selectedIndex,!1),this.evolutionViewCombobox.mainElementVisibleFlag=!0,this.container.getElement(".model-ux-switch-section").removeAttribute("mobile-device"),this.container.getElement(".model-section").removeAttribute("mobile-device"),this.container.getElement(".ux-switch-section").removeAttribute("mobile-device")))},render:function(){var e=this;if(this.evolutionToolbar=UWA.createElement("div"),this.evolutionView=UWA.createElement("div"),this.variantView=UWA.createElement("div"),this.isViewLoadingFirstTime=!0,this.evolutionToolbar.setHTML(this.evolutionToolbarPanelTemplate()),this.evolutionView.setHTML(this.evolutionViewPanelTemplate({NO_EVOLUTION_EFF_MSG:v.NO_EVOLUTION_EFF_MSG})),this.variantView.setHTML(this.variantViewPanelTemplate({NO_VARIANT_EFF_MSG:v.NO_VARIANT_EFF_MSG})),this.container.setHTML(this.effViewPanelTemplate({NO_EFF_MSG:v.NO_EFF_MSG})),this.container.inject(this.options.parentElement),this.options.parentElement.addEvent&&this.options.parentElement.addEvent("resize",function(){e.adjustResponsiveView()}),this.noEffPage=this.container.getElement(".no-eff-section"),this.noEffPage.tooltipInfos=new r({shortHelp:v.NO_EFF_MSG}),this.mainViewPage=this.container.getElement(".main-view-page"),0==this.effViewData.effModels.length)return this.mainViewPage.hide(),void this.noEffPage.show();this.mainViewPage.show(),this.noEffPage.hide(),0==this.effViewData.isXRevisionEffectivity&&(this.modelLabelHolder=this.mainViewPage.getElement(".model-label"),this.modelComboboxHolder=this.mainViewPage.getElement(".model-combobox-component"),this.modelLabelHolder.setContent(v.MODEL_LABEL),this.modelCombobox=new n({selectedIndex:0,enableSearchFlag:!1,elementsList:e.modelComboboxData,touchMode:!e.displayCompactMode}),this.modelCombobox.addEventListener("change",function(t){e.updateEvolutionCriteriaView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel}),e.updateVariantView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel})}),this.modelCombobox.addEventListener("show",function(e){document.getElementsByClassName("wux-controls-combobox-popup")[0].setStyle("zIndex","99999")}),e.modelComboboxData.length>1?(this.modelComboboxHolder.setContent(this.modelCombobox),this.modelComboboxHolder.removeClassName("expression-text")):(this.modelComboboxHolder.setContent(this.modelComboboxData[0].labelItem),this.modelComboboxHolder.addClassName("expression-text")),this.uxSwitchToggleHolder=this.mainViewPage.getElement(".ux-switch-toggle"),this.uxSwitchToggle=new l({touchMode:!e.displayCompactMode,type:"switch",label:v.UX_MULTICONTEXT,value:0,checkFlag:!1}),this.uxSwitchToggle.tooltipInfos=new r({shortHelp:v.UX_MULTICONTEXT_TP}),this.uxSwitchToggle.addEventListener("change",function(t){0==e.uxSwitchToggle.value?(e.uxSwitchToggle.value=1,e.enableMultiContextTextView()):1==e.uxSwitchToggle.value&&(e.uxSwitchToggle.value=0,e.disableMultiContextTextView())}),this.uxSwitchToggleHolder.setContent(this.uxSwitchToggle)),this.evolutionViewSelectorHolder=this.evolutionToolbar.getElement(".evolution-view-selection"),this.evolutionViewSwitcherHolder=this.evolutionToolbar.getElement(".evolution-view-switcher"),this.evolutionViewSelectorOptions={officialViewLabel:v.OFFICIAL_LABEL,officialViewHandler:function(){e.manageOfficialProjectedView(e)},projectedViewLabel:v.PROJECTED_LABEL,projectedViewHandler:function(){e.manageOfficialProjectedView(e)},displayCompactMode:e.displayCompactMode},this.evolutionViewSelector=new s(this.evolutionViewSelectorOptions),this.evolutionViewSelectorHolder.setContent(this.evolutionViewSelector.render()),1==this.effViewData.isSearchKO&&u.showwarning(v.SEARCH_FAIL,"error"),0==this.effViewData.isXRevisionEffectivity?(this.createAndSetTextGraphViewCombobox(1==e.effViewData.isSearchKO?e.textOnlyComboboxData:e.textGraphComboboxData,0),this.evolutionViewSwitcherHolder.show(),this.evolutionViewSelectorHolder.show()):(this.createAndSetTextGraphViewCombobox(e.textOnlyComboboxData,0),this.evolutionViewSwitcherHolder.hide(),this.evolutionViewSelectorHolder.hide()),this.evolutionMultiContextSection=this.evolutionView.getElement(".evolution-multi-context"),this.evolutionByContextSection=this.evolutionView.getElement(".evolution-by-context"),this.noEvolutionEffSection=this.evolutionView.getElement(".no-evolution-eff-section"),this.noEvolutionEffSection.tooltipInfos=new r({shortHelp:v.NO_EVOLUTION_EFF_MSG}),this.noCritEffSection=this.evolutionView.getElement(".no-crit-eff-expression"),this.evolutionSection=this.evolutionView.getElement(".evolution-section"),this.evolutionCriteriaViewHolder=this.evolutionView.getElement(".evolution-criteria-view-holder"),this.evolutionCriteriaViewHolder.setContent(""),this.setMultiContextEvolutionExpression(this.effViewData.effData.officialJSEvolutionDisplayExpression),this.variantMultiContextSection=this.variantView.getElement(".variant-multi-context"),this.variantByContextSection=this.variantView.getElement(".variant-by-context"),this.noVariantEffSection=this.variantView.getElement(".no-variant-eff-section"),this.noVariantEffSection.tooltipInfos=new r({shortHelp:v.NO_VARIANT_EFF_MSG}),this.variantSection=this.variantView.getElement(".variant-section"),this.variantExpressionTextHolder=this.variantView.getElement(".variant-expression-text"),this.variantExpressionTextHolder.setContent(""),this.setMultiContextVariantExpression(this.effViewData.effData.variantJSDisplayExpression,this.effViewData.effData.variantDisplayExpression),this.evolutionExpander=new c({header:v.EVOLUTION_LABEL,customHeader:e.evolutionToolbar,body:e.evolutionView,expandedFlag:!0,touchMode:!e.displayCompactMode}),this.evolutionExpander.getContent().addEventListener("expand",function(){e.evolutionViewSelector.enable(),e.evolutionViewCombobox.disabled=!1,e.manageNoEvolutionEffectivity({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel})}),this.evolutionExpander.getContent().addEventListener("collapse",function(){e.evolutionViewSelector.disable(),e.evolutionViewCombobox.disabled=!0,e.manageNoEvolutionEffectivity({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel})}),this.variantExpander=new c({header:v.VARIANT_LABEL,body:e.variantView,expandedFlag:!0,touchMode:!e.displayCompactMode}),this.variantExpander.tooltipInfos=new r({shortHelp:v.VARIANT_LABEL}),this.effViewExpanderHolder=this.mainViewPage.getElement(".expander-section"),this.effViewExpanderHolder.setContent(""),this.evolutionExpander.inject(this.effViewExpanderHolder),this.variantExpander.inject(this.effViewExpanderHolder),this.effViewExpanderHolder.getElement(".wux-controls-expander-header-container").tooltipInfos=new r({shortHelp:v.EVOLUTION_LABEL}),this.applyCompactComfortableMode(),0==this.effViewData.isXRevisionEffectivity?(this.updateEvolutionCriteriaView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel}),this.updateVariantView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel}),this.disableMultiContextTextView()):(this.updateXRevisionEvolutionCriteriaView(),this.disablexRevisionMultiContextTextView()),this.adjustResponsiveView(),1==this.options.onlyConsolidatedView&&(this.uxSwitchToggle.checkFlag=!0,this.uxSwitchToggle.disabled=!0,this.uxSwitchToggle.value=1,this.enableMultiContextTextView())},renderOccurrenceInfo:function(){let e=this;this.occurrenceToolbar=UWA.createElement("div"),this.occurrenceView=UWA.createElement("div"),this.occurrenceToolbar.setHTML(e.occurrenceToolbarPanelTemplate()),this.occurrenceView.setHTML(e.occurrenceViewPanelTemplate({NO_OCCURRENCE_EFF_MSG:v.EMPTY_OCCURRENCE_EFF_MSG})),null==e.evolutionViewSelector&&(this.occurrenceViewSelectorHolder=this.occurrenceToolbar.getElement(".occurrence-view-selection"),this.occurrenceViewSelectorOptions={officialViewLabel:v.OFFICIAL_LABEL,officialViewHandler:function(){e.manageOfficialProjectedOccurrenceView(e)},projectedViewLabel:v.PROJECTED_LABEL,projectedViewHandler:function(){e.manageOfficialProjectedOccurrenceView(e)},displayCompactMode:e.displayCompactMode},this.occurrenceViewSelector=new s(this.occurrenceViewSelectorOptions),this.occurrenceViewSelectorHolder.setContent(this.occurrenceViewSelector.render()),this.occurrenceViewSelector.disable()),this.occurrenceMultiContextSection=this.occurrenceView.getElement(".occurrence-multi-context"),this.occurrenceByContextSection=this.occurrenceView.getElement(".occurrence-by-context"),this.occurrenceByContextSection.addClassName("occurrence-by-context"),this.noOccurrenceEffSection=this.occurrenceView.getElement(".no-occurrence-eff-section"),this.noOccurrenceEffSection.tooltipInfos=new r({shortHelp:v.NO_OCCURRENCE_EFF_MSG}),this.occurrenceSection=this.occurrenceView.getElement(".occurrence-section"),this.occurrenceExpressionTextHolder=this.occurrenceView.getElement(".occurrence-expression-text"),this.occurrenceExpressionTextHolder.setContent(""),this.occurrenceExpander=new c({header:v.OCCURRENCE_LABEL,customHeader:e.occurrenceToolbar,body:e.occurrenceView,expandedFlag:!0,touchMode:!e.displayCompactMode}),this.occurrenceExpander.getContent().addEventListener("expand",function(){null!=e.occurrenceViewSelector&&e.occurrenceViewSelector.enable()}),this.occurrenceExpander.getContent().addEventListener("collapse",function(){null!=e.occurrenceViewSelector&&e.occurrenceViewSelector.disable()}),this.occurrenceExpander.tooltipInfos=new r({shortHelp:v.OCCURRENCE_LABEL}),null!=e.modelCombobox&&e.modelCombobox.addEventListener("change",function(){e.updateOccurrenceView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel})}),null!=e.uxSwitchToggle&&e.uxSwitchToggle.addEventListener("change",function(t){0==e.uxSwitchToggle.value?(e.occurrenceMultiContextSection.hide(),e.occurrenceByContextSection.show(),e.manageOfficialProjectedOccurrenceView(e)):1==e.uxSwitchToggle.value&&(e.occurrenceMultiContextSection.show(),e.occurrenceByContextSection.hide())}),null!=this.effViewExpanderHolder?this.occurrenceExpander.inject(this.effViewExpanderHolder):(this.effViewExpanderHolder=e.mainViewPage.getElement(".expander-section"),this.occurrenceExpander.inject(this.effViewExpanderHolder)),this.occurrenceMultiContextSection.hide(),this.occurrenceByContextSection.show()},updateOccurrenceInfo:function(e){let t=this;if(t.effViewData=e,t.effViewData.isOccurrenceDataAvailable=!0,t.occurrenceByContextSection.removeClassName("occurrence-by-context"),0==t.effViewData.effModels.length){if(t.effViewData.occuEffModels.forEach(function(e){null==e[0]||1!=e[0].criteria.length||"MV"!=e[0].criteria[0].name&&"MP"!=e[0].criteria[0].name||""!=e[0].variantDisplayExpression?e[0].monoCriteria=!1:e[0].monoCriteria=!0,t.modelComboboxData.push({valueItem:e[0].modelName,labelItem:e[0].modelLabel})}),0==t.effViewData.occuEffModels.length)return t.mainViewPage.hide(),void t.noEffPage.show();t.mainViewPage.show(),t.noEffPage.hide(),t.modelLabelHolder=t.mainViewPage.getElement(".model-label"),t.modelComboboxHolder=t.mainViewPage.getElement(".model-combobox-component"),t.modelLabelHolder.setContent(v.MODEL_LABEL),this.modelCombobox=new n({selectedIndex:0,enableSearchFlag:!1,elementsList:t.modelComboboxData,touchMode:!t.displayCompactMode}),this.modelCombobox.addEventListener("change",function(e){t.updateOccurrenceView({modelName:t.modelCombobox.currentValue,modelLabel:t.modelCombobox.currentLabel})}),this.modelCombobox.addEventListener("show",function(e){document.getElementsByClassName("wux-controls-combobox-popup")[0].setStyle("zIndex","99999")}),t.modelComboboxData.length>1?(this.modelComboboxHolder.setContent(this.modelCombobox),this.modelComboboxHolder.removeClassName("expression-text")):(this.modelComboboxHolder.setContent(t.modelComboboxData[0].labelItem),this.modelComboboxHolder.addClassName("expression-text")),this.uxSwitchToggleHolder=t.mainViewPage.getElement(".ux-switch-toggle"),this.uxSwitchToggle=new l({touchMode:!t.displayCompactMode,type:"switch",label:v.UX_MULTICONTEXT,value:0,checkFlag:!1}),this.uxSwitchToggle.tooltipInfos=new r({shortHelp:v.UX_MULTICONTEXT_TP}),this.uxSwitchToggle.addEventListener("change",function(e){0==t.uxSwitchToggle.value?(t.uxSwitchToggle.value=1,t.modelLabelHolder.hide(),t.modelComboboxHolder.hide(),t.manageOfficialProjectedOccurrenceView(t),t.occurrenceMultiContextSection.show(),t.occurrenceByContextSection.hide()):1==t.uxSwitchToggle.value&&(t.uxSwitchToggle.value=0,t.modelLabelHolder.show(),t.modelComboboxHolder.show(),t.occurrenceMultiContextSection.hide(),t.occurrenceByContextSection.show(),t.updateOccurrenceView({modelName:t.modelCombobox.currentValue,modelLabel:t.modelCombobox.currentLabel}))}),this.uxSwitchToggleHolder.setContent(this.uxSwitchToggle),null!=t.occurrenceViewSelector&&t.occurrenceViewSelector.enable()}null!=t.effViewData.effOccuData?t.setMultiContextOccurrenceExpression(t.effViewData.effOccuData.officialJSOccurrenceDisplayExpression,t.effViewData.effOccuData.officialOccurrenceDisplayExpression):t.setMultiContextOccurrenceExpression("",""),t.updateOccurrenceView({modelName:t.modelCombobox.currentValue,modelLabel:t.modelCombobox.currentLabel})},createAndSetTextGraphViewCombobox:function(e,t,o){var i=this;if(null==o||null==o){if(this.options.parentElement.getDimensions)o=this.options.parentElement.getDimensions().width<360}this.evolutionViewCombobox=new n({selectedIndex:t,enableSearchFlag:!1,elementsList:e,mainElementVisibleFlag:!o,touchMode:!i.displayCompactMode}),this.evolutionViewCombobox.addEventListener("change",function(e){i.manageTextGraphView(i.evolutionViewCombobox.currentValue)}),this.evolutionViewCombobox.addEventListener("click",function(e){e.stopPropagation()}),this.evolutionViewCombobox.addEventListener("show",function(e){document.getElementsByClassName("wux-controls-combobox-popup")[0].setStyle("zIndex","99999")}),this.evolutionViewSwitcherHolder.setContent(""),this.evolutionViewSwitcherHolder.setContent(this.evolutionViewCombobox)},setMultiContextEvolutionExpression:function(e,t){""==e?(this.evolutionMultiContextSection.innerHTML=v.NO_EVOLUTION_EFF_MSG,this.evolutionMultiContextSection.tooltipInfos=new r({shortHelp:v.NO_EVOLUTION_EFF_MSG}),this.evolutionMultiContextSection.addClassName("no-eff-msg")):(this.evolutionMultiContextSection.innerHTML=e,this.evolutionMultiContextSection.tooltipInfos=new r({shortHelp:t}),this.evolutionMultiContextSection.removeClassName("no-eff-msg"))},setMultiContextVariantExpression:function(e,t){""==e?(this.variantMultiContextSection.innerHTML=v.NO_VARIANT_EFF_MSG,this.variantMultiContextSection.tooltipInfos=new r({shortHelp:v.NO_VARIANT_EFF_MSG}),this.variantMultiContextSection.addClassName("no-eff-msg")):(this.variantMultiContextSection.innerHTML=e,this.variantMultiContextSection.tooltipInfos=new r({shortHelp:t}),this.variantMultiContextSection.removeClassName("no-eff-msg"))},setMultiContextOccurrenceExpression:function(e,t){""==e?(this.occurrenceMultiContextSection.innerHTML=v.NO_OCCURRENCE_EFF_MSG,this.occurrenceMultiContextSection.tooltipInfos=new r({shortHelp:v.NO_OCCURRENCE_EFF_MSG}),this.occurrenceMultiContextSection.addClassName("no-eff-msg")):(this.occurrenceMultiContextSection.innerHTML=e,this.occurrenceMultiContextSection.tooltipInfos=new r({shortHelp:t}),this.occurrenceMultiContextSection.removeClassName("no-eff-msg"))},enableMultiContextTextView:function(){this.modelLabelHolder.hide(),this.modelComboboxHolder.hide(),this.evolutionViewSwitcherHolder.hide(),this.evolutionMultiContextSection.show(),this.evolutionByContextSection.hide(),this.variantMultiContextSection.show(),this.variantByContextSection.hide(),this.manageOfficialProjectedView(this)},disablexRevisionMultiContextTextView:function(){this.variantByContextSection.hide()},disableMultiContextTextView:function(){this.modelLabelHolder.show(),this.modelComboboxHolder.show(),this.evolutionViewSwitcherHolder.show(),this.evolutionMultiContextSection.hide(),this.evolutionByContextSection.show(),this.variantMultiContextSection.hide(),this.variantByContextSection.show(),this.updateEvolutionCriteriaView({modelName:this.modelCombobox.currentValue,modelLabel:this.modelCombobox.currentLabel}),this.updateVariantView({modelName:this.modelCombobox.currentValue,modelLabel:this.modelCombobox.currentLabel})},manageOfficialProjectedView:function(e){if(0==this.effViewData.isXRevisionEffectivity){if(1==this.uxSwitchToggle.value)return void("Official"==this.evolutionViewSelector.get().view?(this.setMultiContextEvolutionExpression(e.effViewData.effData.officialJSEvolutionDisplayExpression,e.effViewData.effData.officialEvolutionDisplayExpression),null!=e.effViewData.isOccurrenceDataAvailable&&1==e.effViewData.isOccurrenceDataAvailable&&null!=e.effViewData.effOccuData&&this.setMultiContextOccurrenceExpression(e.effViewData.effOccuData.officialJSOccurrenceDisplayExpression,e.effViewData.effOccuData.officialOccurrenceDisplayExpression)):"Projected"==this.evolutionViewSelector.get().view&&(this.setMultiContextEvolutionExpression(e.effViewData.effData.projectedJSEvolutionDisplayExpression,e.effViewData.effData.projectedEvolutionDisplayExpression),null!=e.effViewData.isOccurrenceDataAvailable&&1==e.effViewData.isOccurrenceDataAvailable&&null!=e.effViewData.effOccuData&&this.setMultiContextOccurrenceExpression(e.effViewData.effOccuData.projectedJSOccurrenceDisplayExpression,e.effViewData.effOccuData.projectedOccurrenceDisplayExpression)));e.updateEvolutionCriteriaView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel}),null!=e.effViewData.isOccurrenceDataAvailable&&1==e.effViewData.isOccurrenceDataAvailable&&e.updateOccurrenceView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel})}},manageOfficialProjectedOccurrenceView:function(e){1!=this.uxSwitchToggle.value?e.updateOccurrenceView({modelName:e.modelCombobox.currentValue,modelLabel:e.modelCombobox.currentLabel}):null!=e.effViewData.effOccuData&&("Official"==this.occurrenceViewSelector.get().view?this.setMultiContextOccurrenceExpression(e.effViewData.effOccuData.officialJSOccurrenceDisplayExpression,e.effViewData.effOccuData.officialOccurrenceDisplayExpression):"Projected"==this.occurrenceViewSelector.get().view&&this.setMultiContextOccurrenceExpression(e.effViewData.effOccuData.projectedJSOccurrenceDisplayExpression,e.effViewData.effOccuData.projectedOccurrenceDisplayExpression))},manageTextGraphView:function(e){"GRAPH"==e?this.loadGraphView():"TEXT"==e&&this.loadTextView()},loadTextView:function(){this.criteriaView&&this.criteriaView.xr_criteria&&(this.evolutionSection.getElement(".mv-graph-component").hide(),this.evolutionSection.getElement(".mv-component").show(),0==this.evolutionViewCombobox.selectedIndex&&this.evolutionMultiContextSection.show()),this.criteriaView&&this.criteriaView.mv_criteria&&(this.evolutionSection.getElement(".mv-graph-component").hide(),this.evolutionSection.getElement(".mv-component").show()),this.criteriaView&&this.criteriaView.mp_criteria&&(this.evolutionSection.getElement(".mp-graph-component").hide(),this.evolutionSection.getElement(".mp-component").show())},loadGraphView:function(){var e=this,t=!1;0==e.effViewData.isXRevisionEffectivity&&this.effViewData.effModels.forEach(function(o){o.modelName===e.modelCombobox.currentValue&&o.modelLabel===e.modelCombobox.currentLabel&&("Official"==e.evolutionViewSelector.get().view&&1==o.isUnsupportedForGraph||"Projected"==e.evolutionViewSelector.get().view&&1==o.isProjectedUnsupportedForGraph)&&(t=!0)}),1!=t&&(this.criteriaView&&this.criteriaView.mp_criteria&&(this.evolutionSection.getElement(".mp-component").hide(),this.evolutionSection.getElement(".mp-graph-component").show(),this.evolutionSection.getElement(".mp-graph-component").setContent(""),this.criteriaView.clickCriteriaComponent("MP")),this.criteriaView&&this.criteriaView.mv_criteria&&(this.evolutionSection.getElement(".mv-component").hide(),this.evolutionSection.getElement(".mv-graph-component").show(),this.evolutionSection.getElement(".mv-graph-component").setContent(""),this.criteriaView.clickCriteriaComponent("MV")),this.criteriaView&&this.criteriaView.xr_criteria&&(this.evolutionSection.getElement(".mv-component").hide(),this.evolutionSection.getElement(".mv-graph-component").show(),this.evolutionSection.getElement(".mv-graph-component").setContent(""),this.criteriaView.clickCriteriaComponent("XR")))},manageNoEvolutionEffectivity:function(e){var t=this;0==this.effViewData.isXRevisionEffectivity?this.effViewData.effModels.forEach(function(o){o.modelName===e.modelName&&o.modelLabel===e.modelLabel&&("Official"==t.evolutionViewSelector.get().view&&o.criteria&&o.criteria.length>0||"Projected"==t.evolutionViewSelector.get().view&&o.projectedCriteria&&o.projectedCriteria.length>0?(t.noEvolutionEffSection.hide(),t.noCritEffSection.hide(),t.evolutionToolbar.show(),t.evolutionSection.show()):(t.evolutionSection.hide(),"FALSE"==o.displayExpression||"FALSE"==o.projectedDisplayExpression||"TRUE"==o.displayExpression||"TRUE"==o.projectedDisplayExpression||o.caTooltipInfo||o.noCritProjectedExpression?(t.evolutionToolbar.show(),t.noEvolutionEffSection.hide()):(t.evolutionToolbar.hide(),t.noEvolutionEffSection.show())))}):(t.noEvolutionEffSection.hide(),t.noCritEffSection.hide(),t.evolutionToolbar.show(),t.evolutionSection.show())},updateXRevisionEvolutionCriteriaView:function(){let e=this;if(this.manageNoEvolutionEffectivity(),e.evolutionCriteriaViewHolder.setContent(""),this.effViewData.effModels.length>0){let t=this.effViewData.effModels[0];t.mode="EFF_VIEW",t.parentElement=e.evolutionCriteriaViewHolder,t.displayCompactMode=e.displayCompactMode,e.criteriaView=null,"Official"==e.evolutionViewSelector.get().view?t.evolutionView="Official":"Projected"==e.evolutionViewSelector.get().view&&(t.evolutionView="Projected"),1==t.monoCriteria?"GRAPH"!=e.evolutionViewCombobox.currentValue?e.evolutionViewCombobox.currentValue="GRAPH":e.loadGraphView():e.manageTextGraphView(e.evolutionViewCombobox.currentValue)}},updateEvolutionCriteriaView:function(e){var t=this;this.manageNoEvolutionEffectivity(e),this.effViewData.effModels.forEach(function(o){if(o.modelName!==e.modelName||o.modelLabel!==e.modelLabel);else{if(t.evolutionCriteriaViewHolder.setContent(""),o.mode="EFF_VIEW",o.parentElement=t.evolutionCriteriaViewHolder,o.displayCompactMode=t.displayCompactMode,t.criteriaView=null,"Official"==t.evolutionViewSelector.get().view){if(o.caTooltipInfo)return t.evolutionToolbar.show(),t.noCritEffSection.setContent(o.caTooltipInfo),t.noCritEffSection.show(),t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex),void(t.noCritEffSection.tooltipInfos=new r({shortHelp:o.caTooltipInfo}));if(o.evolutionView="Official",o.criteria&&o.criteria.length>0&&!o.noCritOfficialExpression){t.criteriaView=new f(o),t.criteriaView.render();var i=!1,n=!1;t.effViewData.effData.officialEvolutionExpression.indexOf("###")>0&&(n=!0),o.criteria.forEach(function(e){"MV"!=e.name&&"MP"!=e.name||(i=!0)}),1==i&&0==n?t.createAndSetTextGraphViewCombobox(t.textGraphComboboxData,t.evolutionViewCombobox.selectedIndex):t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex)}else"FALSE"==o.displayExpression||"TRUE"==o.displayExpression?(t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex),t.noEvolutionEffSection.hide(),t.noCritEffSection.show(),t.noCritEffSection.setContent("FALSE"==o.displayExpression?v.FALSE:v.TRUE),t.noCritEffSection.tooltipInfos=new r({shortHelp:"FALSE"==o.displayExpression?v.FALSE:v.TRUE})):o.caTooltipInfo?(t.createAndSetTextGraphViewCombobox(t.textGraphComboboxData,t.evolutionViewCombobox.selectedIndex),t.noEvolutionEffSection.hide(),t.noCritEffSection.show(),t.noCritEffSection.setContent(o.caTooltipInfo),t.noCritEffSection.tooltipInfos=new r({shortHelp:o.caTooltipInfo})):o.noCritOfficialExpression&&""!=o.noCritOfficialExpression&&(t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex),t.noEvolutionEffSection.hide(),t.noCritEffSection.show(),t.noCritEffSection.setContent(o.noCritOfficialExpression),t.noCritEffSection.tooltipInfos=new r({shortHelp:o.noCritOfficialExpression}))}else if("Projected"==t.evolutionViewSelector.get().view)if(o.evolutionView="Projected",o.orProjectedExpression)t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex),t.evolutionToolbar.show(),t.noEvolutionEffSection.hide(),t.noCritEffSection.show(),t.noCritEffSection.setContent(o.orProjectedExpression),t.noCritEffSection.tooltipInfos=new r({shortHelp:o.orProjectedExpression});else if(o.noCritProjectedExpression)t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex),t.evolutionToolbar.show(),t.noEvolutionEffSection.hide(),t.noCritEffSection.show(),t.noCritEffSection.setContent(o.noCritProjectedExpression),t.noCritEffSection.tooltipInfos=new r({shortHelp:o.noCritProjectedExpression});else if(o.projectedCriteria&&o.projectedCriteria.length>0){t.criteriaView=new f(o),t.criteriaView.render();var c=!1;o.projectedCriteria.forEach(function(e){"MV"!=e.name&&"MP"!=e.name||(c=!0)});n=!1;t.effViewData.effData.projectedEvolutionExpression.indexOf("###")>0&&(n=!0),1==c&&0==n?t.createAndSetTextGraphViewCombobox(t.textGraphComboboxData,t.evolutionViewCombobox.selectedIndex):t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex)}else"FALSE"!=o.projectedDisplayExpression&&"TRUE"!=o.projectedDisplayExpression||(t.createAndSetTextGraphViewCombobox(t.textOnlyComboboxData,t.evolutionViewCombobox.selectedIndex),t.evolutionToolbar.show(),t.noEvolutionEffSection.hide(),t.noCritEffSection.show(),t.noCritEffSection.setContent("FALSE"==o.projectedDisplayExpression?v.FALSE:v.TRUE),t.noCritEffSection.tooltipInfos=new r({shortHelp:"FALSE"==o.projectedDisplayExpression?v.FALSE:v.TRUE}));1==o.monoCriteria?"GRAPH"!=t.evolutionViewCombobox.currentValue&&t.isViewLoadingFirstTime?(t.evolutionViewCombobox.currentValue="GRAPH",t.isViewLoadingFirstTime=!1):"GRAPH"==t.evolutionViewCombobox.currentValue&&t.loadGraphView():t.manageTextGraphView(t.evolutionViewCombobox.currentValue)}})},manageNoVariantEffectivity:function(e){var t=this;this.effViewData.effModels.forEach(function(o){o.modelName===e.modelName&&o.modelLabel===e.modelLabel&&(""==o.variantDisplayExpression?(t.variantSection.hide(),t.noVariantEffSection.show()):(t.noVariantEffSection.hide(),t.variantSection.show()))})},manageNoOccurrenceEffectivity:function(e){let t=this;this.effViewData.occuEffModels.length>0?this.effViewData.occuEffModels.forEach(function(o){o[0].modelName===e.modelName?null==t.occurrenceViewSelector&&("Official"==t.evolutionViewSelector.get().view&&o[0].criteria&&o[0].criteria.length>0||"Projected"==t.evolutionViewSelector.get().view&&o[0].projectedCriteria&&o[0].projectedCriteria.length>0)?(t.occurrenceExpressionTextHolder.setContent(""),o[0].criteria.length>0&&""==o[0].criteria[0].value?(t.occurrenceSection.hide(),t.noOccurrenceEffSection.show(),t.noOccurrenceEffSection.addClassName("no-eff-msg"),t.noOccurrenceEffSection.setContent(v.NO_OCCURRENCE_EFF_MSG),t.noOccurrenceEffSection.tooltipInfos=new r({shortHelp:v.NO_OCCURRENCE_EFF_MSG})):o[0].criteria.length>0&&""!=o[0].criteria[0].value&&(t.occurrenceSection.show(),t.noOccurrenceEffSection.hide())):(null!=t.occurrenceViewSelector&&"Official"==t.occurrenceViewSelector.get().view&&o[0].criteria&&o[0].criteria.length>0||null!=t.occurrenceViewSelector&&"Projected"==t.occurrenceViewSelector.get().view&&o[0].projectedCriteria&&o[0].projectedCriteria.length>0)&&(t.occurrenceExpressionTextHolder.setContent(""),o[0].criteria.length>0&&""==o[0].criteria[0].value&&(t.occurrenceSection.hide(),t.noOccurrenceEffSection.show(),t.noOccurrenceEffSection.addClassName("no-eff-msg"),t.noOccurrenceEffSection.setContent(v.NO_OCCURRENCE_EFF_MSG),t.noOccurrenceEffSection.tooltipInfos=new r({shortHelp:v.NO_OCCURRENCE_EFF_MSG}))):"###"===e.modelName&&(t.occurrenceSection.hide(),t.noOccurrenceEffSection.show(),t.noOccurrenceEffSection.addClassName("no-eff-msg"),t.noOccurrenceEffSection.setContent(v.NO_OCCURRENCE_EFF_MSG),t.noOccurrenceEffSection.tooltipInfos=new r({shortHelp:v.NO_OCCURRENCE_EFF_MSG}))}):(t.occurrenceSection.hide(),t.noOccurrenceEffSection.show())},updateVariantView:function(e){var t=this;this.manageNoVariantEffectivity(e),this.effViewData.effModels.forEach(function(o){o.modelName!==e.modelName||o.modelLabel!==e.modelLabel||("FALSE"==o.variantDisplayExpression?(t.variantExpressionTextHolder.setContent(v.FALSE),t.variantExpressionTextHolder.tooltipInfos=new r({shortHelp:v.FALSE})):(t.variantExpressionTextHolder.setContent(o.variantDisplayExpression),t.variantExpressionTextHolder.tooltipInfos=new r({shortHelp:o.variantDisplayExpression})))})},updateOccurrenceView:function(e){var t=this;this.manageNoOccurrenceEffectivity(e),this.effViewData.occuEffModels.length>0?this.effViewData.occuEffModels.forEach(function(o){if(o[0].modelName!==e.modelName);else if(o[0].mode="EFF_VIEW",o[0].parentElement=t.occurrenceExpressionTextHolder,o[0].displayCompactMode=t.displayCompactMode,t.criteriaViewOccurrence=null,null!=t.occurrenceViewSelector&&"Official"==t.occurrenceViewSelector.get().view||null==t.occurrenceViewSelector&&"Official"==t.evolutionViewSelector.get().view){if(o[0].caTooltipInfo)return t.occurrenceExpressionTextHolder.setContent(o[0].caTooltipInfo),void(t.occurrenceExpressionTextHolder.tooltipInfos=new r({shortHelp:o[0].caTooltipInfo}));o[0].evolutionView="Official",o[0].criteria&&o[0].criteria.length>0&&""!=o[0].criteria[0].value&&!o[0].noCritOfficialExpression?(t.criteriaViewOccurrence=new f(o[0]),t.criteriaViewOccurrence.render()):"FALSE"==o[0].displayExpression||"TRUE"==o[0].displayExpression?(t.occurrenceExpressionTextHolder.setContent("FALSE"==o[0].displayExpression?v.FALSE:v.TRUE),t.occurrenceExpressionTextHolder.tooltipInfos=new r({shortHelp:"FALSE"==o[0].displayExpression?v.FALSE:v.TRUE})):""!=o[0].noCritOfficialExpression&&(t.occurrenceExpressionTextHolder.setContent(o[0].noCritOfficialExpression),t.occurrenceExpressionTextHolder.tooltipInfos=new r({shortHelp:o[0].noCritOfficialExpression}))}else(null!=t.occurrenceViewSelector&&"Projected"==t.occurrenceViewSelector.get().view||null==t.occurrenceViewSelector&&"Projected"==t.evolutionViewSelector.get().view)&&(o[0].evolutionView="Projected",o[0].projectedCriteria&&o[0].projectedCriteria.length>0&&""!=o[0].projectedCriteria[0].value?(t.criteriaViewOccurrence=new f(o[0]),t.criteriaViewOccurrence.render()):"FALSE"==o[0].projectedDisplayExpression||"TRUE"==o[0].projectedDisplayExpression?(t.occurrenceExpressionTextHolder.setContent("FALSE"==o[0].projectedDisplayExpression?v.FALSE:v.TRUE),t.occurrenceExpressionTextHolder.tooltipInfos=new r({shortHelp:"FALSE"==o[0].projectedDisplayExpression?v.FALSE:v.TRUE})):o[0].orProjectedExpression?(t.occurrenceExpressionTextHolder.setContent(o[0].orProjectedExpression),t.occurrenceExpressionTextHolder.tooltipInfos=new r({shortHelp:o[0].orProjectedExpression})):o[0].noCritProjectedExpression&&(t.occurrenceExpressionTextHolder.setContent(o[0].noCritProjectedExpression),t.occurrenceExpressionTextHolder.tooltipInfos=new r({shortHelp:o[0].noCritProjectedExpression})))}):(t.noOccurrenceEffSection.addClassName("no-eff-msg"),t.noOccurrenceEffSection.setContent(v.NO_OCCURRENCE_EFF_MSG),t.noOccurrenceEffSection.tooltipInfos=new r({shortHelp:v.NO_OCCURRENCE_EFF_MSG}))},applyCompactComfortableMode:function(){0==this.displayCompactMode?(this.container.getElements(".section-label").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),this.container.getElements(".expression-text").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),this.container.getElements(".section-in-filler").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),this.container.getElements(".section-out-filler").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),this.container.getElements(".in-x-filler").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),this.container.getElements(".model-label").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))}),this.container.getElements(".no-eff-msg").forEach(function(e){e.setAttributeNode(document.createAttribute("touch-mode"))})):(this.container.getElements(".section-label").forEach(function(e){e.removeAttribute("touch-mode")}),this.container.getElements(".expression-text").forEach(function(e){e.removeAttribute("touch-mode")}),this.container.getElements(".section-in-filler").forEach(function(e){e.removeAttribute("touch-mode")}),this.container.getElements(".section-out-filler").forEach(function(e){e.removeAttribute("touch-mode")}),this.container.getElements(".in-x-filler").forEach(function(e){e.removeAttribute("touch-mode")}),this.container.getElements(".model-label").forEach(function(e){e.removeAttribute("touch-mode")}),this.container.getElements(".no-eff-msg").forEach(function(e){e.removeAttribute("touch-mode")}))}})}),define("DS/CfgEffectivityViewUX/scripts/CfgEffectivityViewFactory",["DS/CfgEffectivityViewUX/scripts/CfgEffectivityView","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CfgBaseUX/scripts/CfgXMLServices","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgController","i18n!DS/CfgBaseUX/assets/nls/CfgBaseUX"],function(e,t,o,i,n,r){"use strict";return UWA.Class.extend({createInstance:function(t,i,n){let r=!1;return t.effData.officialEvolutionExpression.indexOf("<OR>")>0&&t.effData.officialEvolutionExpression.indexOf("</OR>")>0&&(r=!0),1==t.isXRevisionEffectivity?t.effModels=o.getExpressionXRevisionView(t.effData.officialEvolutionExpression,t.effData.projectedEvolutionExpression,t.effData.variantExpression,t.modelData):t.effModels=o.getExpressionView(t.effData.officialEvolutionExpression,t.effData.projectedEvolutionExpression,t.effData.variantExpression,t.modelData),new e({effViewData:t,parentElement:i,displayCompactMode:n,onlyConsolidatedView:r})},loadEffectivities:function(e,t,o){var r=this;return new Promise(function(c,l){var a={instanceID:[e],effData:{variantExpression:"",variantDisplayExpression:"",variantJSDisplayExpression:"",officialEvolutionExpression:"",projectedEvolutionExpression:"",officialEvolutionDisplayExpression:"",projectedEvolutionDisplayExpression:"",officialJSEvolutionDisplayExpression:"",projectedJSEvolutionDisplayExpression:""},modelData:[],effModels:[],isSearchKO:!1,isXRevisionEffectivity:!1},s={version:"2.0",targetFormat:"XML",withDescription:"YES",view:"ALL",domains:"ALL",pidList:[e]};require(["DS/EditPropWidget/changeAction/passThruJS"],function(l){l.onReady(function(l){l.get2(function(l){null!=l&&null!=l.configurationRevision&&(s.configurationRev=l.configurationRevision),i.isDefined(window.enoviaServerFilterWidget)&&"Native"==window.enoviaServerFilterWidget.mode?i.populateDisplayExpressionXSLT().then(async function(t){await i.checkDecouplingActivation(),null!=o&&(s.configurationRev=o),r.getEffectivities(s,a,e).then(function(e){c(e)},function(e){return Promise.reject(e)})},function(e){return Promise.reject(e)}):(n.init(null,"","3DDashboard"),enoviaServerFilterWidget.tenant=t,i.populate3DSpaceURL().then(function(t){i.populateSecurityContext().then(function(t){i.populateDisplayExpressionXSLT().then(async function(t){await i.checkDecouplingActivation(),r.getEffectivities(s,a,e).then(function(e){c(e)},function(e){return Promise.reject(e)})},function(e){return Promise.reject(e)})},function(e){return Promise.reject(e)})},function(e){return Promise.reject(e)}))})})})})},getOccurrenceEffectivities:function(e,t){return new Promise(function(o,n){let r={version:"1.0",modelPID:e,view:"All",format:"XML",occurrences:t},c=JSON.stringify(r);i.makeWSCall("/resources/modeler/configuration/navigationServices/getOccurrencesEffectivities","POST","enovia","application/json",c,function(e){o(e)},function(e,t){let o=t||e;console.log("KO error response for getOccurrencesEffectivities= "+o),n(o)},!0,null)})},setOccurrenceDispayEffectivities:function(e){e.effOccuData={};let t="",i="",n="",c="";for(let l=0;l<e.occuEffModels.length;l++){let a="",s="",f=e.occuEffModels[l][0].modelLabel;""==f&&(f=e.occuEffModels[l][0].modelName);let u="",d="";if(""!=e.occuEffModels[l].current_evolution_expression){"FALSE"==(u=o.getEvolutionXmlByContext(e.occuEffModels[l].current_evolution_expression)[0].evolutionDisplayExpression)?u=r.FALSE:"TRUE"==u&&(u=r.TRUE)}if(""!=e.occuEffModels[l].projected_evolution_expression){"FALSE"==(d=o.getEvolutionXmlByContext(e.occuEffModels[l].projected_evolution_expression)[0].evolutionDisplayExpression)?d=r.FALSE:"TRUE"==d&&(d=r.TRUE)}l==e.modelData.length-1?(a='<div class="last-model-consolidated-section">',s='<div class="last-model-consolidated-section">',t+=f+": "+u,i+=f+": "+d):(a='<div class="model-consolidated-section">',s='<div class="model-consolidated-section">',t+=f+": "+u+"\n",i+=f+": "+d+"\n"),a+='<div class="section-label">'+f+"</div>",a+='<div class="expression-text">'+u+"</div>",s+='<div class="section-label">'+f+"</div>",s+='<div class="expression-text">'+d+"</div>",n+=a+="</div>",c+=s+="</div>"}return e.effOccuData.officialOccurrenceDisplayExpression=t,e.effOccuData.projectedOccurrenceDisplayExpression=i,e.effOccuData.officialJSOccurrenceDisplayExpression=n,e.effOccuData.projectedJSOccurrenceDisplayExpression=c,e},_getContextDataDetails:function(e){let t=this;return new Promise(function(o,n){let r={version:"1.0",pidList:e,modelMask:"Read",enabledCriteria:"YES",cfgCtxt:"YES"};r=JSON.stringify(r);i.makeWSCall("/resources/modeler/configuration/navigationServices/getMultipleConfigurationContextInfo","POST","enovia","application/ds-json",r,function(e){let n=[],r=[],c=[];if(null!=e.referencesInfo)for(let t=0;t<e.referencesInfo.length;t++)null!=e.referencesInfo[t]&&"YES"==e.referencesInfo[t].hasConfigContext&&c.push(e.referencesInfo[t].pid);if(null!=e.contextInfo)for(let t=0;t<e.contextInfo.length;t++){let o=e.contextInfo[t].contextOf;c.every(e=>o.includes(e))&&r.push(e.contextInfo[t].content.results)}if(r.length>0){let e=r,o=enoviaServerFilterWidget.baseURL;for(let r=0;r<e.length;r++){let c=e[r][0];if(null!=c&&null!=c.notification&&"ERROR"==c.notification.type){i.showwarning(c.notification.message,"error"),t.enable();break}null!=e[r][0].type_icon_url&&-1==e[r][0].type_icon_url.indexOf(o)&&(e[r][0].type_icon_url=o+e[r][0].type_icon_url),null!=e[r][0].type_icon_large_url&&-1==e[r][0].type_icon_large_url.indexOf(o)&&(e[r][0].type_icon_large_url=o+e[r][0].type_icon_large_url);let l=e[r][0].physicalID,a=e[r][0].data[0].value[0],s=e[r][0].computed.label.value[0],f=e[r][0].type_icon_url;n.push({modelID:l,modelLabel:a,modelName:s,modelIcon:f})}}o(n)},function(e){t.enable(),n(e)},!0)})},loadOccurrenceEffectivities:async function(e){let t=this,i=e.occurrencesIds,n=e.effViewData;if(e.modelOccurrenceData=[],0==n.effModels.length){let o=e.referencePathIds;e.modelOccurrenceData=await t._getContextDataDetails(o)}if(null!=e.modelOccurrenceData){let r=[];for(let e=0;e<i.length;e++)r.push({identifier:i[e]});let c={path1:r};n.effModels.length>0&&(e.modelOccurrenceData=n.modelData);try{n.occuEffModels=[];for(let i=0;i<e.modelOccurrenceData.length;i++){let r=e.modelOccurrenceData[i].modelID,l=await t.getOccurrenceEffectivities(r,c);if(null!=l.occurrences&&null!=l.occurrences.path1){let t=o.getExpressionView(l.occurrences.path1.current_evolution_expression,l.occurrences.path1.projected_evolution_expression,n.effData.variantExpression,[e.modelOccurrenceData[i]]);t.current_evolution_expression=l.occurrences.path1.current_evolution_expression,t.projected_evolution_expression=l.occurrences.path1.projected_evolution_expression,n.occuEffModels.push(t)}else{let t=[{modelName:e.modelOccurrenceData[i].modelLabel,modelLabel:e.modelOccurrenceData[i].modelName,modelIcon:e.modelOccurrenceData[i].modelIcon,modelID:e.modelOccurrenceData[i].modelID,variantExpression:"",variantDisplayExpression:"",isCAUnsupportedForGraph:!1,isUnsupportedForGraph:!1,criteria:[{isCheckboxRequired:!1,isReadOnly:!0,name:"",value:"",valueJson:""}],displayExpression:"",isOfficailUnsupportedForGraph:!1,projectedCriteria:[{isCheckboxRequired:!1,isReadOnly:!0,name:"",value:"",valueJson:""}],projectedDisplayExpression:"",isProjectedUnsupportedForGraph:!1,current_evolution_expression:"",projected_evolution_expression:""}];n.occuEffModels.push(t)}}n.occuEffModels.length>0&&(n=t.setOccurrenceDispayEffectivities(n))}catch(e){return n}}return n},getEffectivities:function(e,t,n){return new Promise(function(r,c){i.getMultipleFilterableObjectInfo(e).then(function(e){var c=e.expressions;if("ERROR"===c[n].status&&Promise.reject("ERROR"),"YES"===c[n].hasEffectivity||"YES"===c[n].hasConfigRevEffectivity){if(null!=c[n].content.Variant&&(t.effData.variantExpression=c[n].content.Variant,t.effData.variantDisplayExpression=i.getDisplayExpressionUsingXSLT(t.effData.variantExpression)),null!=c[n].content.Evolution)if("YES"===c[n].hasConfigRevEffectivity){var l={Current:c[n].content.Evolution,Projected:c[n].content.Evolution};c[n].content.Evolution=l,t.effData.officialEvolutionExpression=t.effData.projectedEvolutionExpression=c[n].content.Evolution.Current,t.effData.officialEvolutionDisplayExpression=t.effData.projectedEvolutionDisplayExpression=i.getDisplayExpressionUsingXSLT(t.effData.officialEvolutionExpression)}else null!=c[n].content.Evolution.Current&&(t.effData.officialEvolutionExpression=c[n].content.Evolution.Current,t.effData.officialEvolutionDisplayExpression=i.getDisplayExpressionUsingXSLT(t.effData.officialEvolutionExpression)),null!=c[n].content.Evolution.Projected&&(t.effData.projectedEvolutionExpression=c[n].content.Evolution.Projected,t.effData.projectedEvolutionDisplayExpression=i.getDisplayExpressionUsingXSLT(t.effData.projectedEvolutionExpression));null!=c[n].content.ConfigChange&&(null!=c[n].content.ConfigChange.Current&&(t.effData.officialEvolutionExpression=c[n].content.ConfigChange.Current,t.effData.officialEvolutionDisplayExpression=i.getDisplayExpressionUsingXSLT(t.effData.officialEvolutionExpression)),null!=c[n].content.ConfigChange.Projected&&(t.effData.projectedEvolutionExpression=c[n].content.ConfigChange.Projected,t.effData.projectedEvolutionDisplayExpression=i.getDisplayExpressionUsingXSLT(t.effData.projectedEvolutionExpression)))}t.effData.officialJSEvolutionDisplayExpression=o.buildJSDisplayExpression(t.effData.officialEvolutionExpression,"EVOLUTION"),t.effData.projectedJSEvolutionDisplayExpression=o.buildJSDisplayExpression(t.effData.projectedEvolutionExpression,"EVOLUTION"),t.effData.variantJSDisplayExpression=o.buildJSDisplayExpression(t.effData.variantExpression,"VARIANT"),t.modelData=o.getModelsFromExpression(t.effData.officialEvolutionExpression,t.effData.variantExpression),t.effData.officialEvolutionExpression.indexOf("</XRevision>")>=0?t.isXRevisionEffectivity=!0:t.isXRevisionEffectivity=!1,i.getModelDataUsingSearchService(t.modelData).then(function(e){t.modelData=[],e.results&&e.results.forEach(function(e){t.modelData.push({modelID:i.getAttributeValue(e.attributes,"resourceid"),modelLabel:i.getAttributeValue(e.attributes,"ds6w:label"),modelName:i.getAttributeValue(e.attributes,"ds6w:identifier"),modelIcon:i.getAttributeValue(e.attributes,"type_icon_url")})}),r(t)},function(e){t.isSearchKO=!0,r(t)})},function(e){return Promise.reject(e)})})}})});