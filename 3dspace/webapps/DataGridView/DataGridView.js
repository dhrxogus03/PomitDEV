define("DS/DataGridView/DataGridViewFilterPopup",["UWA/Core","DS/Core/BaseComponent","DS/Utilities/Dom","DS/Core/PointerEvents","DS/Controls/Popup","DS/Controls/Accordeon","DS/Controls/Button","DS/TreeModel/ConditionAndSetBaseFilter","DS/Controls/TooltipModel","DS/Utilities/KeyboardUtils","i18n!DS/DataGridView/assets/nls/translation"],function(e,t,i,n,o,l,r,s,a,d,u){"use strict";var h=function(e){const t=void 0!==e?e:this.filter.filterModel;return this._isModelServerSide()||this.filter&&this.filterId!==this.filter.getFilterByValuesId()&&!Array.isArray(t)?"ByConditions":"ByValues"},c=function(){if(this.filter instanceof s&&!this._isModelServerSide()){this._accordion=new l({exclusive:!0,collapsibleFlag:!1,style:"divided",stretchableChildrenFlag:!0,items:[{header:u.get("FilterView").FilterByValues,content:null,weight:1},{header:u.get("FilterView").FilterByConditions,content:null}]}),this._accordion.getContent().style.flex="1 1 0px";var e=this;i.addEventOnElement(this,this._accordion,"expand",function(t){t&&t.options&&0==t.options.expanderIndex?(e.filterMode="ByValues",e.elements._popup.resizableFlag=!0,e.elements._popup.getContent().style.minHeight="320px"):(e.filterMode="ByConditions",e.elements._popup.resizableFlag=!1,e.elements._popup.getContent().style.minHeight="",e._initialPopupSize&&(e.elements._popup.getContent().style.width=e._initialPopupSize.width.toString()+"px",e.elements._popup.getContent().style.height=e._initialPopupSize.height.toString()+"px"));var i=e.getActiveFilterView();i&&i.focusContentView()}),0==this._accordion.expanderIndex?this.elements._popup.getContent().style.minHeight="320px":this.elements._popup.getContent().style.minHeight=""}else this._accordion=null;return this.filterMode=h.call(this),this._accordion},g=function(){var t=new e.Element("div",{class:"wux-datagridview-filter-footer"}),o=this;this._resetLabel=e.createElement("span",{class:"wux-datagridview-filter-reset"}),this._resetLabel.textContent=u.get("FilterView").Reset,this._resetLabel.inject(t),i.addEventOnElement(this,this._resetLabel,n.POINTERHIT,function(e){if(o.filter){var t=o.getActiveFilterView();if(t){var i=t.buildFilterModelFromView();if(!o.filter.filterModelsAreEqual(o.filter.defaultFilterModel,i)){var n=h.call(o,o.filter.defaultFilterModel);o.filterMode!==n&&(o.filterMode=n,t=o.getActiveFilterView()),t&&t.refreshContentView(void 0!==o.filter.defaultFilterModel?o.filter.defaultFilterModel:null)}}}}),this._OKButton=new r({label:u.get("FilterView").OK,emphasize:"primary",onClick:function(e){o.validateView(),o.elements._popup&&(o.elements._popup.visibleFlag=!1)}});let l=e.createElement("div");l.addClassName("wux-datagridview-filter-buttons-container"),l.inject(t),this._OKButton.getContent().addClassName("wux-datagridview-filter-ok"),this._OKButton.inject(l);var s=new r({label:u.get("FilterView").Cancel,onClick:function(e){o.elements._popup&&(o.elements._popup.visibleFlag=!1)}});return s.getContent().addClassName("wux-datagridview-filter-cancel"),s.inject(l),i.addEventOnElement(this,this.elements._popup,"keydown",function(e){d.ENTER===e.keyCode&&o._OKButton&&!o._OKButton.disabled&&o._OKButton.onClick()}),t};return t.inherit({name:"DataGridViewFilterPopup",publishedProperties:{filterViewManager:{defaultValue:void 0,type:"object",readOnly:!0},filterId:{defaultValue:"",type:"string",readOnly:!0},propertyId:{defaultValue:"",type:"string",readOnly:!0},validFlag:{defaultValue:!0,type:"boolean"},filter:{defaultValue:null,type:"object",readOnly:!0},filterMode:{defaultValue:"ByValues",type:"string"},filterViewOptions:{defaultValue:void 0,type:"object"}},destroy:function(){this._parent()},showPopup:function(){if(this.elements._popup||function(){if(this.elements._popup)return;var t=this;let n=this.propertyId+"_popup_datagridview_filter";this.elements._popup=new o({identifier:n,target:this.getContent(),position:"bottom",offset:{x:0,y:4},alignment:"near",className:"wux-controls-popup wux-datagridview-filter-popup",constraint:"screen",overlap:!1,trigger:"click",beforeDisplayCallback:function(){t._refreshIconView()}});var l=new e.Element("div");i.onNodeRendered(this.elements._popup.getContent(),()=>{t._initialPopupSize||(t._initialPopupSize={height:t.elements._popup.getContent().clientHeight,width:t.elements._popup.getContent().clientWidth})}),l.style.height="100%",l.style.display="flex",l.style.flexDirection="column";var r=c.call(this);r&&r.inject(l,"top"),this._footerDiv=g.call(this),this._footerDiv.inject(l,"bottom"),this.elements._popup.setBody(l);t=this;this.elements._popup.addEventListener("show",function(e){if("popup"===e.dsModel.name){t._displayModalContainer(),t.refreshView();var i=t.getActiveFilterView();i&&i.focusContentView()}}),this.elements._popup.addEventListener("hide",function(e){"popup"===e.dsModel.name&&(t._refreshIconView(),t._removeModalContainer())})}.call(this),this.elements._popup){this._applyFilterMode();var t=this.getActiveFilterView();t&&(t._dataGridViewPossibleValues&&(this.elements._popup.resizableFlag=!0,this.elements._popup.getContent().style.minHeight="270px"),this.elements._popup.visibleFlag=!0,this._displayModalContainer(),t.focusContentView())}},refreshView:function(){var e=this.getActiveFilterView();e&&(e.filterViewOptions=this.filterViewOptions,e.refreshContentView()),this._refreshIconView()},validateView:function(){this.validFlag&&this._updateFilterModelFromView()},clearView:function(){this.validFlag=!0;var e=this.getActiveFilterView();e&&(e.clearFilterViewContent(),this._updateFilterModelFromView())},_build:function(){this._parent(),this.elements.container=new e.Element("div",{styles:{flex:"0 0 auto",display:"inline-block"}}),this.elements.container.dsModel=this,this._filterViewByValues=null,this._filterViewByConditions=null,this._OKButton=null,this.__decorationFlag=!1,this.handleEvents()},_postBuild:function(){const e=this.filterViewManager.view;if(e){const t=e.getColumnOrGroup("label"===this.propertyId?"tree":this.propertyId);this.__decorationFlag=t&&t.filterOptions&&t.filterOptions.readOnly}if(this.__decorationFlag)this.elements.container.setAttributeNode(document.createAttribute("decoration"));else{const e=t=>{this.showPopup(),i.removeEventOnElement(this,this.elements.container,n.POINTERHIT,e),t.stopPropagation()};i.addEventOnElement(this,this.elements.container,n.POINTERHIT,e)}this._refreshIconView()},handleEvents:function(){},getActiveFilterId:function(){if(this.filter)return"ByConditions"===this.filterMode?this.filter.getFilterByConditionId():this.filter.getFilterByValuesId()},getActiveFilterView:function(){return"ByValues"===this.filterMode?this._filterViewByValues:this._filterViewByConditions},_getOrCreateActiveFilterView:function(){var e=this.getActiveFilterView();if(!e&&this.filterViewManager&&this.elements._popup){var t=this.getActiveFilterId(),n=this.filterViewManager.getFilterViewClassName(t);if(n){var o=this.filter;(e=new n({filterViewManager:this.filterViewManager,propertyId:this.propertyId,filterId:t,filter:o,filterViewOptions:this.filterViewOptions})).elements._popup=this.elements._popup,e.buildContentView();var l=this;i.addEventOnElement(this,e,"validFlagChange",function(){l._updateValidFlag()}),i.addEventOnElement(this,e,"change",function(){l._updateResetState()}),o&&t===o.getFilterByValuesId()?this._filterViewByValues=e:this._filterViewByConditions=e}else console.log("Cannot create the filter view for Id: "+t)}return e},_updateFilterModelFromView:function(){var e=this.getActiveFilterView();if(e&&this.filterViewManager){var t=this.filterViewManager.filterManager;if(t){var i,n=e.buildFilterModelFromView();this.filterViewManager.disableUpdateView();var o=t.getFilters();if(o){var l=o[this.propertyId];l&&(i=l.filterOptions)}t.setPropertyFilterModel(this.propertyId,{filterId:this.filterId,filterModel:n,filterOptions:i},{isUserInteraction:!0}),(o=t.getFilters())&&o[this.propertyId]&&e.filter!==o[this.propertyId]&&(e.filter&&e.filter.destroy(),e.filter=o[this.propertyId]),this.filterViewManager.enableUpdateView(),this._refreshIconView()}}},_updateValidFlag:function(){var e=this.getActiveFilterView();e&&(this.validFlag=e.validFlag)},_updateResetState:function(){if(this.filter&&this._resetLabel){var e=this.getActiveFilterView();if(e){var t=e.buildFilterModelFromView();this.filter.filterModelsAreEqual(this.filter.defaultFilterModel,t)?this._resetLabel.setAttributeNode(document.createAttribute("disabled")):this._resetLabel.removeAttribute("disabled")}}},_refreshIconView:function(){var e;this.elements.container&&this.filter&&(this.filter.isEmpty()?this.elements._popup&&this.elements._popup.visibleFlag?(this.elements.container.className="wux-datagridview-columnheader-icons wux-datagridview-filter wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-search-filter",e=u.get("FilterView").FilterValues):this.elements.container.className="":this.__decorationFlag?(this.elements.container.className="wux-datagridview-columnheader-icons wux-datagridview-filter wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-filter",e=u.get("FilterView").ReadOnlyFilter):(this.elements.container.className="wux-datagridview-columnheader-icons wux-datagridview-filter wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-filter",e=u.get("FilterView").ModifyFilter),this.tooltipInfos=new a({shortHelp:e}))},_applyValidFlag:function(e){this._OKButton&&(this._OKButton.disabled=!this.validFlag)},_applyFilterMode:function(e){var t=this._getOrCreateActiveFilterView();if(t)if(t.refreshContentView(),this._accordion){var i="ByValues"===this.filterMode?0:1,n=t.getPopupContentDiv();n&&this._accordion.updateItem(i,{body:n}),this._accordion.expandItem(i)}else if(this.elements._popup&&this._footerDiv){var o=t===this._filterViewByValues?this._filterViewByConditions:this._filterViewByValues;if(o){var l=o.getPopupContentDiv();l&&l.remove()}var r=t.getPopupContentDiv();r&&r.inject(this._footerDiv,"before")}this._updateValidFlag(),this._updateResetState()},_applyProperties:function(e){this._parent()},_displayModalContainer:function(){if(this.filterViewManager){var e=this.filterViewManager.view;e&&e.displayModalContainer(null,{transparentFlag:!0})}},_removeModalContainer:function(){if(this.filterViewManager){var e=this.filterViewManager.view;e&&e.removeModalContainer()}},_isModelServerSide:function(){var e=!1;return this.filterViewManager&&this.filterViewManager.view&&this.filterViewManager.view._rowModel&&(e=this.filterViewManager.view._rowModel._isServerSide()),e}})}),define("DS/DataGridView/DataGridViewCustomViewsDialog",["UWA/Core","DS/Utilities/Dom","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/Button","DS/Tweakers/TweakerBoolean","DS/Tweakers/TypeUtils","DS/Tweakers/GeneratedToolbar","DS/Controls/TooltipModel","DS/Controls/ComboBox","DS/Controls/LineEditor","DS/Controls/SelectionChips","DS/Core/PointerEvents","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","i18n!DS/DataGridView/assets/nls/translation"],function(e,t,i,n,o,l,r,s,a,d,u,h,c,g,p,m,f){"use strict";const C=[{identifier:"DefaultConfiguration",label:f.get("DefaultView")}];function _(e){if(e)return"string"==typeof e?e:e.label?e.label:e.identifier}function w(t){w.prototype._setSortModel=function(e){let t=this._customViewsDialog._customViewsSortModels&&this._customViewsDialog._customViewsSortModels[this._customViewsDialog.getCurrentEditedCustomViewIndex()];this._sortModel=[].concat(e||t||this._dataGridView._rowModel._originalSortModel||[]);const i=this._dataGridView.sortOptions?this._dataGridView.sortOptions.maxSortedColumnsCount:void 0;"number"==typeof i&&this._sortModel.length>i&&(this._sortModel.length=i)},w.prototype.reset=function(){for(;this._table.rows.length;)this._table.deleteRow(-1);this._selectedDataIndexMap.clear()},w.prototype.getComboBoxAtLine=function(e){return e<this._table.rows.length?this._table.rows[e].cells[0].firstElementChild.dsModel:void 0},w.prototype.getTweakerBooleanAtLine=function(e){return e<this._table.rows.length&&this._table.rows[e].cells.length>1?this._table.rows[e].cells[1].firstElementChild.dsModel:void 0},w.prototype.addLine=function(e){const t=this._dataGridView.sortOptions?this._dataGridView.sortOptions.maxSortedColumnsCount:void 0;if("number"==typeof t&&this._table.rows.length>=t)return;let i=this._table.insertRow(),n=void 0,o=!0;void 0!==e&&(n=e.dataIndex,o=Boolean("asc"===e.sort));const l=[{label:"-- "+f.get("DataGridViewCustomViewsDialog").SortByComboxBoxFirstLine+" --",value:0}],a=this._dataGridView.layout.getLeafColumns();for(let e=0;e<a.length;e++){const t=a[e];if(this._dataGridView.layout.getColumnSortableFlag(t.dataIndex)){const e=void 0!==t.text&&""!==t.text?t.text:t.dataIndex;l.push({label:e,value:t.dataIndex})}}const d=new u({enableSearchFlag:!1,elementsList:l,value:n});d.getContent().classList.add("wux-datagridview-custom-views-combo"),d.inject(i.insertCell());let h="";const c=e=>{if(d.value!==h)if(this._selectedDataIndexMap.get(d.value))d.value=h;else{if(h&&this._selectedDataIndexMap.set(h,!1),i.cells.length>1&&i.deleteCell(1),d.value){let t=this._dataGridView.getColumnOrGroup(d.selectedIndex-1).typeRepresentation,n=s.getSortingIconDefinition(t,this._dataGridView.getTypeRepresentationFactory(),"asc"),o=s.getSortingIconDefinition(t,this._dataGridView.getTypeRepresentationFactory(),"desc"),l=new r({value:void 0===e||e,displayStyle:"toggleIcon",possibleValues:[{value:"true",icon:n},{value:"false",icon:o},{value:"undefined",icon:""}]});l.inject(i.insertCell()),l.addEventListener("change",()=>{this._selectedDataIndexMap.set(d.value,l.value?"asc":"desc"),this._customViewsDialog._customViewsSortModels[this._customViewsDialog.getCurrentEditedCustomViewIndex()]=this.getSortModel(),this._customViewsDialog._updateButtonsState()}),this._selectedDataIndexMap.set(d.value,l.value?"asc":"desc"),0===h&&this.addLine()}else{const e=this._dataGridView.sortOptions?this._dataGridView.sortOptions.maxSortedColumnsCount:void 0;if("number"==typeof e){if(e){let t=this.getComboBoxAtLine(this._table.rows.length-1);d!==t&&this._table.deleteRow(i.rowIndex),t.value&&this._table.rows.length===e-1&&this.addLine()}}else this._table.deleteRow(i.rowIndex)}h=d.value,this._customViewsDialog._updateButtonsState()}};n?c(o):(h=d.value,this._customViewsDialog._updateButtonsState()),d.addEventListener("change",()=>{c(),this._customViewsDialog._customViewsSortModels[this._customViewsDialog.getCurrentEditedCustomViewIndex()]=this.getSortModel(),this._customViewsDialog._updateButtonsState()})},w.prototype.loadSortModel=function(e){this.reset(),this._setSortModel(e);for(let e=0;e<this._sortModel.length;e++)this.addLine(this._sortModel[e]);this.addLine(),this._customViewsDialog._customViewsSortModels[this._customViewsDialog.getCurrentEditedCustomViewIndex()]=e},w.prototype.getSortModel=function(){let e=[];for(let t=0;t<this._table.rows.length;++t){let i=this.getComboBoxAtLine(t).value;i&&e.push({dataIndex:i,sort:this._selectedDataIndexMap.get(i)})}return e},w.prototype.inject=function(e){this._container.inject(e)},w.prototype.setUpdateFromCurrentView=function(e){this._statusVisualFeedback.style.backgroundColor=e?"#E87B00":"transparent"},this._customViewsDialog=t,this._dataGridView=t.dataGridView,this._container=e.createElement("div",{class:"wux-datagridview-custom-views-part wux-datagridview-custom-views-sort-container"}),this._statusVisualFeedback=e.createElement("div",{class:"wux-datagridview-custom-sortmodel-status-feedback"}),this._statusVisualFeedback.inject(this._container);let i=e.createElement("div",{class:"wux-datagridview-custom-sortmodel-label"});i.innerHTML=f.get("DataGridViewCustomViewsDialog").SortByTitle,i.inject(this._container),this._table=e.createElement("table"),this._table.inject(this._container),this._selectedDataIndexMap=new Map,this._setSortModel()}return i.inherit({name:"DataGridViewCustomViewsDialog",publishedProperties:{dataGridView:{defaultValue:null,type:"object"},title:{defaultValue:f.get("DataGridViewCustomViewsDialog").Title,type:"string",category:"Appearance"},modalFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},autoCloseFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},resizableFlag:{defaultValue:!0,type:"boolean",category:"Behavior"},activateButtonsIfActionPerformed:{defaultValue:!1,type:"boolean",category:"Behavior"},width:{defaultValue:600,type:"integer",category:"Appearance",advancedSetter:!0,recordFlag:!0},height:{defaultValue:530,type:"integer",category:"Appearance",advancedSetter:!0,recordFlag:!0},minWidth:{defaultValue:330,defaultTouchValue:330,advancedSetter:!0,type:"integer",category:"Appearance"}},_preBuild:function(){this._parent(),this._densityComboBox=null,this._editedCustomViews=[],this._selectedCustomView=null,this._treeDocuments=[],this._layoutDensities=[],this._customViewsGroupingOptions=[],this._customViewsSortModels=[],this._updateFromCurrentViewButton=null,this._sortModelView=null},_postBuildView:function(){this._parent();let n=this,o=e.createElement("div",{class:"wux-datagridview-custom-views-maindiv"}),r=this.dataGridView.getCustomViewsManager().getCurrentCustomViewIndex(),s=e.createElement("div",{});this.elements._toolbar=new a({items:a.prototype.createTreeDocument({entries:[{id:"ViewLabel",dataElements:{typeRepresentation:"customEnumMember",label:f.get("DataGridViewCustomViewsDialog").SelectedView,displayLabel:!0,value:void 0,possibleValues:n._getAllPossibleCustomViews(),onNodeUpdate:function(e){let t=n._getCustomViewIndex(e.getAttributeValue("data"));n.loadCustomView(t,!1),n.elements._toolbar.updateNodeModel("RenameView",{disabled:t<=0}),n.elements._toolbar.updateNodeModel("DeleteView",{disabled:t<=0}),n._updateButtonsState()}}},{id:"EditLabel",dataElements:{typeRepresentation:"string",label:f.get("DataGridViewCustomViewsDialog").SelectedView,displayLabel:!0,value:_(this._selectedCustomView),visibleFlag:!1,placeholder:f.get("DataGridViewCustomViewsDialog").RenameViewEditor.placeHolder,requiredFlag:!0,onNodeUpdate:function(t,i){if(i&&i.data){let i=e.String.unescapeHTML(t.getAttributeValue("data"));n._selectedCustomView&&""!==i&&_(n._selectedCustomView)!=i&&(n.getCustomViewFromLabel(i)?n._displayNotificationMessage(f.get("DataGridViewCustomViewsDialog.ViewAlreadyExists",{configurationLabel:i})):void 0!==n._selectedCustomView.label?n._selectedCustomView.label=i:n._selectedCustomView.identifier=i,n._updateModelFromCustomViews()),!0===t.options.visibleFlag&&(n.elements._toolbar.updateNodeModel("ViewLabel",{visibleFlag:!0}),n.elements._toolbar.updateNodeModel("EditLabel",{visibleFlag:!1}))}},onViewBlur:function(e){!0===e.options.visibleFlag&&(n.elements._toolbar.updateNodeModel("ViewLabel",{visibleFlag:!0}),n.elements._toolbar.updateNodeModel("EditLabel",{visibleFlag:!1}))}}},{id:"RenameView",dataElements:{typeRepresentation:"functionIcon",value:function(){n.renameCurrentCustomView()},icon:{iconName:"pencil",fontIconFamily:WUXManagedFontIcons.Font3DS},disabled:0===r,tooltip:{shortHelp:f.get("DataGridViewCustomViewsDialog").RenameView.ShortHelp,longHelp:f.get("DataGridViewCustomViewsDialog").RenameView.LongHelp}}},{id:"DeleteView",dataElements:{typeRepresentation:"functionIcon",value:function(){if(n._selectedCustomView){let t=new i({immersiveFrame:n.dataGridView.getContainingImmersiveFrame(),modalFlag:!0,title:f.get("DataGridViewCustomViewsDialog").DeleteView.ShortHelp,content:f.get("DataGridViewCustomViewsDialog.DeleteView.ConfirmationQuestion",{configurationLabel:e.String.unescapeHTML(_(n._selectedCustomView))}),buttons:{Yes:new l({onClick:function(e){n.deleteCustomView(n.getCurrentEditedCustomViewIndex()),t.close()}}),No:new l({onClick:function(e){t.close()}})}})}},icon:{iconName:"trash",fontIconFamily:WUXManagedFontIcons.Font3DS},disabled:0===r,tooltip:{shortHelp:f.get("DataGridViewCustomViewsDialog").DeleteView.ShortHelp,longHelp:f.get("DataGridViewCustomViewsDialog").DeleteView.LongHelp}}},{id:"CreateView",dataElements:{typeRepresentation:"functionIcon",value:function(){n.createNewCustomView(),n.renameCurrentCustomView()},icon:{iconName:"plus",fontIconFamily:WUXManagedFontIcons.Font3DS},tooltip:{shortHelp:f.get("DataGridViewCustomViewsDialog").CreateView.ShortHelp,longHelp:f.get("DataGridViewCustomViewsDialog").CreateView.LongHelp}}}]})}).inject(s),s.inject(o),e.createElement("div",{html:f.get("DataGridViewCustomViewsDialog").Description,class:"wux-datagridview-custom-views-part"}).inject(o);{let i=e.createElement("div",{class:"wux-datagridview-custom-views-part wux-datagridview-custom-views-datagridview"}),l=require("DS/DataGridView/DataGridView");this._attributesDataGridView=new l({identifier:this.dataGridView.identifier+"_CustomViews",cellDragEnabledFlag:!0,rowDragEnabledFlag:!0,rowReorderEnabledFlag:!0,showRowIndexFlag:!1,showSelectionCheckBoxesFlag:!1,showOutlineFlag:!0,rowSelection:"none",cellSelection:"none",showModelChangesFlag:!0,columns:[{text:f.get("DataGridViewCustomViewsDialog").ColumnsName,dataIndex:"tree",editableFlag:!1,resizableFlag:!0,selectableFlag:!1,width:"auto",getCellClassName:function(e){if(e.nodeModel&&e.nodeModel.hasChildren())return"wux-datagridview-custom-views-column-group"}},{text:f.get("DataGridViewCustomViewsDialog").ColumnsVisibleFlag,dataIndex:"visibleFlag",typeRepresentation:"boolean",editionPolicy:"EditionInPlace",width:80,getCellEditableState:function(e){return n._getNodeModelVisibleFlagEditableState(e.nodeModel)},getCellValue:function(e){return n._getNodeModelVisibleFlag(e.nodeModel)}},{text:f.get("DataGridViewCustomViewsDialog").ColumnsWidth,dataIndex:"width",typeRepresentation:"integer",width:this._getCurrentTouchMode()?120:80,editionPolicy:"EditionOnDoubleClick",allowResetToUndefinedByUIFlag:!0,getCellEditableState:function(e){let t=!1;if(!e.nodeModel.hasChildren()){let i=e.nodeModel.getAttributeValue("dataIndex");t=!!n.dataGridView.layout.getColumnResizableFlag(i)}return t}},{text:f.get("DataGridViewCustomViewsDialog").ColumnsPinnedState,dataIndex:"pinned",typeRepresentation:"pinnedEnum",width:"auto",editionPolicy:"EditionOnOver",getCellValue:function(e){return n._getNodeModelPinned(e.nodeModel)}}],defaultColumnDef:{minWidth:30,editableFlag:!0,resizableFlag:!1,editionPolicy:"EditionOnOver",sortableFlag:!1,getCellKPIColor:function(e){let t=void 0;if(e.nodeModel&&!e.nodeModel.hasChildren()){n.dataGridView.layout;let i=e.nodeModel.getAttributeValue("dataIndex");if(1===e.columnID&&e.nodeModel.getAttributeValue("visibleFlag")!==n.dataGridView.layout.getColumnVisibleFlag(i))t="#e87b00";else if(2===e.columnID){let o=e.nodeModel.getAttributeValue("width"),l=n.dataGridView.layout.getColumnWidth(i);o==l||void 0===o&&"auto"===l||(t="#e87b00")}else 3===e.columnID&&e.nodeModel.getAttributeValue("pinned")!==n.dataGridView.layout.getColumnPinned(i)&&(t="#e87b00")}return t}}}),this._attributesDataGridView.buildDefaultContextualMenu=function(e,t){return n._attributesDataGridView._contextualMenuBuilder.buildMenu(e,{filter:!0,pin:!1,firstColumnsVisibility:!1,columnsManagement:!1,sizeColumnToFit:!1,insertRow:!1})};let r=function(e,t){if(t.droppedNodes&&t.droppedNodes.length>0){let i=t.droppedNodes[0],o=t.nodeModel,l="top"===t.dropPosition?"before":"after";if(i&&o){let r=i.getTreeDocument();r&&r.options.shouldAcceptDrop({dropPosition:t.dropPosition,draggedTreeNodeModel:i,dropNode:o})&&(r.prepareUpdate(),r.setUseChangeTransactionMode(!1),n._extractNodeModel(i),n._insertNodeModelNextTo(r,i,o,l),n._mergeChildren(r._getTrueRoot()),r.setUseChangeTransactionMode(!0),r.pushUpdate(),n._attributesDataGridView.flashEffectOnNodeModel("ui-modified",i),i.processDescendants({onlyVisibleNodes:!0,processNode:function(e){n._attributesDataGridView.flashEffectOnNodeModel("ui-modified",e.nodeModel)}}),e.preventDefault())}}};this._attributesDataGridView.onDropCell=function(e,t){return r(e,t)},this._attributesDataGridView.onDropRowHeader=function(e,t){return r(e,t)},t.addEventOnElement(this,this._attributesDataGridView,g.POINTERHIT,function(e,t){2===e.multipleHitCount&&t&&t.nodeModel&&t.nodeModel.hasChildren()&&(t.nodeModel.isExpanded()?t.nodeModel.collapse():t.nodeModel.expand())});let s={"":"unpinned"};s[f.get("DataGridViewCustomViewsDialog").LeftPinned]="left",s[f.get("DataGridViewCustomViewsDialog").RightPinned]="right",this._attributesDataGridView.getTypeRepresentationFactory().registerEnum("pinnedEnum",s),this._attributesDataGridView.inject(i),i.inject(o)}if(this.dataGridView.rowGroupingEnabledFlag){let t=e.createElement("div",{class:"wux-datagridview-custom-views-part"}),i=function(e,t){let i=n.dataGridView.getDraggedRowData(e);if(i){let e={label:i.label,value:i.grid.dataIndex,index:void 0},o=t.chipCellView?t.chipCellView.associatedModelItem:void 0;if(o){let i=t.dropPosition;"left"===i?e.index=n._groupingSelectionChips.getChipPosition(o.chipOptions.label):"right"===i&&(e.index=n._groupingSelectionChips.getChipPosition(o.chipOptions.label)+1)}n._groupingSelectionChips.addChip(e)}return e.preventDefault(),!0};this._groupingSelectionChips=new c({placeholder:f.get("DataGridViewCustomViewsDialog").GroupingPlaceholder,onDropCell:function(e,t){return i(e,t)},onDropBlank:function(e,t){return i(e,t)}}),this._groupingSelectionChips.addEventListener("change",function(e){let t=n._groupingSelectionChips.getAllChipsOptions().map(function(e){return e.value});n._customViewsGroupingOptions[n.getCurrentEditedCustomViewIndex()]={dataIndexesToGroup:t},n._updateButtonsState()}),this._groupingSelectionChips.inject(t),t.inject(o)}let h=e.createElement("div",{class:"wux-datagridview-custom-views-sub-container"});this._sortModelView=new w(this),this._sortModelView.inject(h);let p=e.createElement("div",{class:"wux-datagridview-custom-views-layout-density wux-datagridview-custom-views-part"});e.createElement("div",{class:"wux-datagridview-custom-views-layout-density-label",html:f.get("DataGridViewCustomViewsDialog").LayoutDensity}).inject(p),this._densityComboBox=new u({enableSearchFlag:!1}),this._densityComboBox.getContent().classList.add("wux-datagridview-custom-views-combo"),this._densityComboBox.elementsList=[f.get("DataGridViewCustomViewsDialog").Compact,f.get("DataGridViewCustomViewsDialog").Comfortable],this._densityComboBox.addEventListener("change",function(){n._layoutDensities[n.getCurrentEditedCustomViewIndex()]=1===n._densityComboBox.selectedIndex?"comfortable":"compact",n._updateButtonsState()}),this._densityComboBox.inject(p),p.inject(h),h.inject(o);{let t=e.createElement("div",{class:"wux-datagridview-custom-views-part wux-datagridview-custom-views-footer"});this._resetToDefaultButton=new l({label:f.get("DataGridViewCustomViewsDialog").ResetPreferences,onClick:function(e){n.resetToDefault()}}),this._resetToDefaultButton.getContent().addClassName("wux-datagridview-custom-views-flushButton"),this._resetToDefaultButton.inject(t),this._updateFromCurrentViewButton=new l({label:f.get("DataGridViewCustomViewsDialog").UpdateFromCurrentView.Label,emphasize:"medium-attention"}),this._updateFromCurrentViewButton.getContent().classList.add("wux-datagridview-custom-views-update-button"),this._updateFromCurrentViewButton.tooltipInfos=new d({shortHelp:f.get("DataGridViewCustomViewsDialog").UpdateFromCurrentView.ShortHelp,longHelp:f.get("DataGridViewCustomViewsDialog").UpdateFromCurrentView.LongHelp}),this._updateFromCurrentViewButton.inject(t),this._updateFromCurrentViewButton.addEventListener("buttonclick",function(e){n.updateFromCurrentView()}),t.inject(o)}this.content=o,this.buttons={Ok:new l({label:f.get("DataGridViewCustomViewsDialog").SaveAndApply,onClick:function(e){n.saveCustomViews(!0),n.visibleFlag=!1}}),Save:new l({onClick:function(e){n.saveCustomViews(),n.visibleFlag=!1}}),Cancel:new l({onClick:function(e){n.visibleFlag=!1}})},this.buttons.Save.emphasize="secondary",this.addEventListener("close",function(e){n.visibleFlag=!1})},_applyVisibleFlag:function(){this._parent(),this.visibleFlag||(this.elements._toolbar.updateNodeModel("ViewLabel",{visibleFlag:!0}),this.elements._toolbar.updateNodeModel("EditLabel",{visibleFlag:!1}))},loadCustomViews:function(){this._editedCustomViews=e.clone(this.dataGridView.getCustomViewsManager().getCustomViews()),0===this._editedCustomViews.length&&(this._editedCustomViews=[...C]),this._layoutDensities=[],this._customViewsGroupingOptions=[],this._customViewsSortModels=[],this._treeDocuments=[];for(let e=0;e<this._editedCustomViews.length;e++)this._createNewTreeDocument();let t=this.dataGridView.getCustomViewsManager().getCurrentCustomViewIndex();t<0&&(t=0),this.loadCustomView(t,!0),this._updateModelFromCustomViews()},_createNodeModelFromColumnOrGroup:function(e,t,i,n){let l;if(e){let r={dataIndex:e.dataIndex||""};e.children||(r.visibleFlag=t,r.width="auto"===i?void 0:i,r.pinned=n||"unpinned"),l=new o({label:e.text,icons:e.icon&&""!==e.icon?[e.icon]:[],grid:r})}return l},_generateTreeDocumentFromCustomView:function(e,t){if(e&&t){e.prepareUpdate();let i=this.dataGridView.layout,n=i.getLeafColumns(),o=i._getOrderedColumnIndexesFromChanges(t),l=null;for(let r=0;r<n.length;r++){let s=n[o[r]];if(s){let n=s.dataIndex;if(this.dataGridView.getColumnOrGroup(n)){let o,r,a;o=t.columnsVisibleFlag&&void 0!==t.columnsVisibleFlag[n]?t.columnsVisibleFlag[n]:i._getOriginalColumnOptionValue(n,"visibleFlag"),r=t.columnsWidth&&void 0!==t.columnsWidth[n]?t.columnsWidth[n]:i._getOriginalColumnOptionValue(n,"width"),a=t.columnsPinnedState&&void 0!==t.columnsPinnedState[n]?t.columnsPinnedState[n]:i._getOriginalColumnOptionValue(n,"pinned");let d=this._createNodeModelFromColumnOrGroup(s,o,r,a);this._insertNodeModelNextTo(e,d,l,"after"),l=d}}}e.setUseChangeTransactionMode(!0),e.expandAll(),e.pushUpdate()}},_extractNodeModel:function(e){if(e){let t=e.getParent();if(t)for(t.removeChild(e,!0);t&&!t.hasChildren();){let e=t.getParent();e&&e.removeChild(t,!0),t=e}}},_getColumnOrGroupFromNodeModel:function(e){let t;if(e&&this.dataGridView){let i=e.getAttributeValue("dataIndex");t=this.dataGridView.getColumnOrGroup(i)}return t},_insertNodeModelNextTo:function(e,t,i,n){if(e&&t){this.dataGridView.layout;let o=this._getColumnOrGroupFromNodeModel(t);if(o){let l,r=o._parent;for(;r&&(!r.dataIndex||""===r.dataIndex);)r=r._parent;if(r){let o=t.getAttributeValue("pinned"),s=i?i.getAttributeValue("pinned"):void 0,a=null;if(l=i?i.getParent():null,o===s)for(a=l;a&&!this._isNodeModelMatchingColumnOrGroup(a,r)&&!(a&&a.getParent()&&a.getParent()._isTrueRoot());)a=a.getParent();let d=a;if(a&&this._isNodeModelMatchingColumnOrGroup(a,r))l=a;else{a=this._createNodeModelFromColumnOrGroup(r);let t=l?l.getParent():null,o=l?t&&!t._isTrueRoot()?t:l:null,s=r._parent;for(;s;){if(o&&this._isNodeModelMatchingColumnOrGroup(o,s)){o.addChild(a,"before"===n?0:void 0);break}if(s.dataIndex&&""!==s.dataIndex){let e;e=this._isNodeModelMatchingColumnOrGroup(d,s)?d:this._createNodeModelFromColumnOrGroup(s),a.getParent()?o&&e.addChild(o,"before"===n?0:void 0):e.addChild(a,"before"===n?0:void 0),e.expand(),o=e}if(!s._parent)break;s=s._parent}let u=this._getNodeModelLocalIdInHierarchy(i,e._getTrueRoot());void 0!==u&&"after"===n&&u++,!o||o.getParent()||o._isTrueRoot()?a.getParent()||e.addRoot(a,u):e.addRoot(o,u),l=a}}r&&l||(l=e._getTrueRoot());let s=this._getNodeModelLocalIdInHierarchy(i,l);void 0!==s&&"after"===n&&s++,l.addChild(t,s),l.expand()}}},_getNodeModelFromDataIndex:function(e,t){let i=null;return e&&e.processDescendants({processNode:function(e){if(e.nodeModel.getAttributeValue("dataIndex")===t)return i=e.nodeModel,{stopProcessing:!0}}}),i},_getNodeModelLocalIdInHierarchy:function(e,t){let i;if(e&&t){let n=e;for(;n;){if(n.getParent()===t){i=n._getLocalID();break}n=n.getParent()}}return i},_isNodeModelMatchingColumnOrGroup:function(e,t){let i=!1;for(;e&&t;){if(t.dataIndex&&""!==t.dataIndex){if(!(i=e.getAttributeValue("dataIndex")===t.dataIndex))break;e=e.getParent()}t=t._parent}return i},_getNodeModelVisibleFlagEditableState:function(e){let t=this,i=!1;if(e.hasChildren())e.processDescendants({processNode:function(e){if(t._getNodeModelVisibleFlagEditableState(e.nodeModel))return i=!0,{stopProcessing:!0}}});else{let n=e.getAttributeValue("dataIndex");i=!t.dataGridView.layout.getColumnAlwaysVisibleFlag(n)}return i},_getNodeModelVisibleFlag:function(e){let t=this,i=void 0;return e&&(e.hasChildren()?e.processDescendants({processNode:function(e){let n=t._getNodeModelVisibleFlag(e.nodeModel);return void 0===n?(i=void 0,{stopProcessing:!0}):void 0!==i&&i!==n?(i=void 0,{stopProcessing:!0}):void(i=n)}}):i=e.getAttributeValue("visibleFlag")),i},_getNodeModelPinned:function(e){let t="unpinned";return e&&(t=e.hasChildren()?this._getNodeModelPinned(e.getChildren()[0]):e.getAttributeValue("pinned")),t},_mergeChildren:function(e){if(e){let t=e.getChildren();if(t){if(t.length>1)for(let i=t.length-1;i>0;i--){let n=t[i],o=t[i-1];if(n&&n.hasChildren()&&o&&o.hasChildren()&&n.getAttributeValue("dataIndex")===o.getAttributeValue("dataIndex")){if(this._getNodeModelPinned(n)===this._getNodeModelPinned(o)){let t=n.getChildren().slice();for(let e=0;e<t.length;e++)o.addChild(t[e]);e.removeChild(n)}}}for(let e=0;e<t.length;e++)this._mergeChildren(t[e])}}},loadCustomView:function(e,t){let i=this._editedCustomViews[e];if(i&&(this._selectedCustomView!==i||t)){if(this._selectedCustomView=i,this._groupingSelectionChips){this._groupingSelectionChips.removeAllChips(),(!this._customViewsGroupingOptions[e]||this._customViewsGroupingOptions[e].dataIndexesToGroup&&0===this._customViewsGroupingOptions[e].dataIndexesToGroup.length)&&(this._customViewsGroupingOptions[e]=i.groupingOptions||{dataIndexesToGroup:[]});let t=this._customViewsGroupingOptions[e];if(t&&t.dataIndexesToGroup)for(let e=0;e<t.dataIndexesToGroup.length;e++){let i=t.dataIndexesToGroup[e];this._groupingSelectionChips.addChip({label:this.dataGridView.layout.getColumnOptionValue(i,"text"),value:i})}}let t=this._treeDocuments[e];if(t){let e=t.getChildren();e&&0!==e.length||this._generateTreeDocumentFromCustomView(t,i)}this._attributesDataGridView.treeDocument=t,this._attributesDataGridView.setActiveCell(-1),this._attributesDataGridView.setScrollerPosition({x:0,y:0}),this._customViewsSortModels[e]||(this._customViewsSortModels[e]=i.columnsSortModel),this._sortModelView.loadSortModel(this._customViewsSortModels[e]),this._layoutDensities[e]||(this._layoutDensities[e]=i.layoutDensity||this.dataGridView.layout._getOriginalLayoutDensity());let n=this._layoutDensities[e];this._densityComboBox.selectedIndex="comfortable"===n?1:0,this._updateButtonsState()}},resetToDefault:function(){if(this.dataGridView){let e=this.dataGridView.layout,t=this._attributesDataGridView.getTreeDocument();if(t){t.prepareUpdate();let i=e.getLeafColumns();for(let n=0;n<i.length;n++){let o=i[n].dataIndex,l=this._getNodeModelFromDataIndex(t,o);if(l){let t=e._getOriginalColumnOptionValue(o,"visibleFlag"),i=e._getOriginalColumnOptionValue(o,"width"),n=e._getOriginalColumnOptionValue(o,"pinned");l.updateOptions({grid:{visibleFlag:t,width:"auto"===i?void 0:i,pinned:n||"unpinned"}})}}t._getTrueRoot().sortChildren({isRecursive:!0,sortFunction:function(t,i){for(;t.hasChildren();)t=t.getChildren()[0];for(;i.hasChildren();)i=i.getChildren()[0];let n=t.getAttributeValue("dataIndex"),o=i.getAttributeValue("dataIndex"),l=e.getColumnIndex(n),r=e.getColumnIndex(o);return e._originalOrderedColumnsReverseIndexes[l]-e._originalOrderedColumnsReverseIndexes[r]}}),t.pushUpdate()}this._groupingSelectionChips&&this._groupingSelectionChips.removeAllChips(),this._customViewsSortModels[this.getCurrentEditedCustomViewIndex()]=[],this._sortModelView.loadSortModel(this.dataGridView._rowModel._originalSortModel||[]),this._densityComboBox.selectedIndex="comfortable"===e._getOriginalLayoutDensity()?1:0,this._resetToDefaultButton.disabled=!0}},updateFromCurrentView:function(){let e=this._attributesDataGridView.getTreeDocument();if(e){e.prepareUpdate();let t=this.dataGridView.layout,i=(t.getOrderedColumnsIndexes(),t.getLeafColumns());for(let n=0;n<i.length;n++){let o=i[n].dataIndex,l=this._getNodeModelFromDataIndex(e,o);if(l){let e=t.getColumnVisibleFlag(o),i=t.getColumnWidth(o),n=t.getColumnPinned(o);l.updateOptions({grid:{visibleFlag:e,width:"auto"===i?void 0:i,pinned:n||"unpinned"}})}}if(e._getTrueRoot().sortChildren({isRecursive:!0,sortFunction:function(e,i){if(e.hasChildren())return e._getRowID()-i._getRowID();{let n=e.getAttributeValue("dataIndex"),o=i.getAttributeValue("dataIndex"),l=t.getColumnIndex(n),r=t.getColumnIndex(o);return t._orderedColumnsReverseIndexes[l]-t._orderedColumnsReverseIndexes[r]}}}),e.pushUpdate(),this._selectedCustomView&&(this._customViewsSortModels[this.getCurrentEditedCustomViewIndex()]=this.dataGridView._rowModel.sortModel),this._groupingSelectionChips){this._groupingSelectionChips.removeAllChips();let e=this.dataGridView.getGroupingOptions();if(e)for(let t=0;t<e.dataIndexesToGroup.length;t++){let i=e.dataIndexesToGroup[t];this._groupingSelectionChips.addChip({label:this.dataGridView.layout.getColumnOptionValue(i,"text"),value:i})}}this._sortModelView.loadSortModel(this.dataGridView.sortModel),this._densityComboBox.selectedIndex="comfortable"===t.layoutDensity?1:0,this._updateFromCurrentViewButton&&(this._updateFromCurrentViewButton.disabled=!0,this._updateFromCurrentViewButton.emphasize=void 0)}},_checkIfResetToDefaultIsPossible:function(){let e=!1,t=this.dataGridView.layout,i=this._attributesDataGridView.getTreeDocument();if(i){let n=t._getOriginalOrderedColumnsIndexes(),o=0;i.processDescendants({processNode:function(i){if(i.nodeModel&&!i.nodeModel.hasChildren()){let l=i.nodeModel.getAttributeValue("dataIndex");if(n[o]!==t.getColumnIndex(l))return e=!0,{stopProcessing:!0};let r=i.nodeModel.getAttributeValue("visibleFlag"),s=i.nodeModel.getAttributeValue("width"),a=i.nodeModel.getAttributeValue("pinned");if(!e&&r!==t._getOriginalColumnOptionValue(l,"visibleFlag"))return e=!0,{stopProcessing:!0};if(!e){let i=t._getOriginalColumnOptionValue(l,"width");if(parseFloat(s)!=parseFloat(i)&&(void 0!==s||"auto"!==i))return e=!0,{stopProcessing:!0}}if(!e&&a!==t._getOriginalColumnOptionValue(l,"pinned"))return e=!0,{stopProcessing:!0};o++}}})}if(!e&&this._selectedCustomView){let t=this.dataGridView._rowModel._originalSortModel||[],i=this._sortModelView.getSortModel();Array.isArray(i)&&Array.isArray(t)&&JSON.stringify(i)!==JSON.stringify(t)&&(e=!0)}if(!e&&this._groupingSelectionChips&&this._groupingSelectionChips.getNumberOfChips()>0&&(e=!0),!e){let i="comfortable"===t._getOriginalLayoutDensity()?1:0;this._densityComboBox.selectedIndex!==i&&(e=!0)}return this._resetToDefaultButton&&(this._resetToDefaultButton.disabled=!e),e},_checkIfUpdateFromCurrentViewIsPossible:function(){let e=!1,t=this.dataGridView.layout,i=[];if(this._groupingSelectionChips){let e=this._groupingSelectionChips.getAllChipsOptions();i=e.map(function(e){return e.value})}let n=this._attributesDataGridView.getTreeDocument();if(n){let o=this,l=t.getOrderedColumnsIndexes(),r=0;n.processDescendants({processNode:function(n){if(n.nodeModel&&!n.nodeModel.hasChildren()){let s=n.nodeModel.getAttributeValue("dataIndex");if(l[r]!==t.getColumnIndex(s))return e=!0,{stopProcessing:!0};t.getColumnAlwaysVisibleFlag(s);let a=n.nodeModel.getAttributeValue("visibleFlag")&&(!o.dataGridView.rowGroupingEnabledFlag||!o.dataGridView.rowGroupingOptions.hideGroupedColumns||"tree"===s||i.indexOf(s)<0),d=n.nodeModel.getAttributeValue("width"),u=n.nodeModel.getAttributeValue("pinned");if(!e&&a!==t.getColumnVisibleFlag(s))return e=!0,{stopProcessing:!0};if(!e){let i=t.getColumnWidth(s);if(d!=i&&(void 0!==d||"auto"!==i))return e=!0,{stopProcessing:!0}}if(!e&&u!==t.getColumnPinned(s))return e=!0,{stopProcessing:!0};r++}}})}if(this._selectedCustomView){let t=this.dataGridView.sortModel,i=this._sortModelView.getSortModel();!t&&i&&i.length>0||!i&&t&&t.length>0||Array.isArray(t)&&Array.isArray(i)&&JSON.stringify(i)!==JSON.stringify(t)?(e=!0,this._sortModelView.setUpdateFromCurrentView(!0)):this._sortModelView.setUpdateFromCurrentView(!1)}if(!e&&this._groupingSelectionChips){let t=this._groupingSelectionChips.getAllChipsOptions().map(function(e){return e.value}),i=this.dataGridView.getGroupingOptions();(!i&&t.length>0||i&&!i.dataIndexesToGroup.equals(t))&&(e=!0)}if(!e){let i="comfortable"===t.layoutDensity?1:0;this._densityComboBox.selectedIndex!==i&&(e=!0)}return this._updateFromCurrentViewButton&&(this._updateFromCurrentViewButton.disabled=!e,this._updateFromCurrentViewButton.emphasize=e?"medium-attention":void 0),e},_checkIfSaveAndApplyArePossible:function(){let e=!1,t=!1,i=this.dataGridView.layout,n=[];if(this._groupingSelectionChips){let i=this._groupingSelectionChips.getAllChipsOptions();n=i.map(function(e){return e.value});for(let t=0;t<this._editedCustomViews.length;++t){let i=this._editedCustomViews[t].groupingOptions||{dataIndexesToGroup:[]};if(i=JSON.stringify(i),void 0!==this._customViewsGroupingOptions[t]&&JSON.stringify(this._customViewsGroupingOptions[t])!==i){e=!0;break}}let o=this.dataGridView.getGroupingOptions()?JSON.stringify(this.dataGridView.getGroupingOptions()):JSON.stringify({dataIndexesToGroup:[]});(this._customViewsGroupingOptions[this.getCurrentEditedCustomViewIndex()]?JSON.stringify(this._customViewsGroupingOptions[this.getCurrentEditedCustomViewIndex()]):JSON.stringify({dataIndexesToGroup:[]}))!==o&&(t=!0)}if(!e)for(let t=0;t<this._treeDocuments.length;t++){let n=this._treeDocuments[t],o=this._editedCustomViews[t];if(n&&o){let t=i._getOrderedColumnIndexesFromChanges(o),l=0;n.processDescendants({processNode:function(n){if(n.nodeModel&&!n.nodeModel.hasChildren()){let r=n.nodeModel.getAttributeValue("dataIndex"),s=n.nodeModel.getAttributeValue("pinned");if(t[l]!==i.getColumnIndex(r))return e=!0,{stopProcessing:!0};let a=n.nodeModel.getAttributeValue("visibleFlag");if(a!==i._getOriginalColumnOptionValue(r,"visibleFlag")&&(!o.columnsVisibleFlag||!o.columnsVisibleFlag.hasOwnProperty(r))||o.columnsVisibleFlag&&o.columnsVisibleFlag.hasOwnProperty(r)&&o.columnsVisibleFlag[r]!==a)return e=!0,{stopProcessing:!0};let d=n.nodeModel.getAttributeValue("width");if(void 0===d&&(d="auto"),d!=i._getOriginalColumnOptionValue(r,"width")&&(!o.columnsWidth||!o.columnsWidth.hasOwnProperty(r))||o.columnsWidth&&o.columnsWidth.hasOwnProperty(r)&&o.columnsWidth[r]!=d)return e=!0,{stopProcessing:!0};if(s!==i._getOriginalColumnOptionValue(r,"pinned")&&(!o.columnsPinnedState||!o.columnsPinnedState.hasOwnProperty(r))||o.columnsPinnedState&&o.columnsPinnedState.hasOwnProperty(r)&&o.columnsPinnedState[r]!==s)return e=!0,{stopProcessing:!0};l++}}})}}let o=this._selectedCustomView.columnsSortModel||this.dataGridView._rowModel._originalSortModel||[],l=this._customViewsSortModels[this.getCurrentEditedCustomViewIndex()];Array.isArray(o)&&Array.isArray(l)&&JSON.stringify(o)!==JSON.stringify(l)&&(e=!0);let r=this.dataGridView.getCustomViewsManager().getCurrentCustomViewIndex();this.getCurrentEditedCustomViewIndex()!==r&&r>=0&&(t=!0);let s=this.dataGridView.getCustomViewsManager().getCustomViews();if(this._editedCustomViews.length!==s.length)e=!0;else for(let t=0;t<this._editedCustomViews.length;++t)if(this._editedCustomViews[t].identifier!==s[t].identifier||_(this._editedCustomViews[t])!==_(s[t])){e=!0;break}if(!e)for(let t=0;t<this._editedCustomViews.length;++t){let n=this._editedCustomViews[t].layoutDensity||i._getOriginalLayoutDensity();void 0!==this._layoutDensities[t]&&this._layoutDensities[t]!==n&&(e=!0)}if(!t){let e="comfortable"===i.layoutDensity?1:0;this._densityComboBox.selectedIndex!==e&&(t=!0)}if(!t){let e=this._attributesDataGridView.getTreeDocument();if(e){let o=i.getOrderedColumnsIndexes(),l=0,r=this;e.processDescendants({processNode:function(e){if(e.nodeModel&&!e.nodeModel.hasChildren()){let s=e.nodeModel.getAttributeValue("dataIndex");if(o[l]!==i.getColumnIndex(s))return t=!0,{stopProcessing:!0};i.getColumnAlwaysVisibleFlag(s);let a=e.nodeModel.getAttributeValue("visibleFlag")&&e.nodeModel.getAttributeValue("visibleFlag")&&(!r.dataGridView.rowGroupingEnabledFlag||!r.dataGridView.rowGroupingOptions.hideGroupedColumns||"tree"===s||n.indexOf(s)<0),d=e.nodeModel.getAttributeValue("width"),u=e.nodeModel.getAttributeValue("pinned");if(!t&&a!==i.getColumnVisibleFlag(s))return t=!0,{stopProcessing:!0};if(!t){let e=i.getColumnWidth(s);if(d!=e&&(void 0!==d||"auto"!==e))return t=!0,{stopProcessing:!0}}if(!t&&u!==i.getColumnPinned(s))return t=!0,{stopProcessing:!0};l++}}})}if(!t&&this._selectedCustomView){let e=this.dataGridView.sortModel||[],i=this._sortModelView.getSortModel();Array.isArray(e)&&Array.isArray(i)&&JSON.stringify(e)!==JSON.stringify(i)&&(t=!0)}}let a=this.buttons.Ok;a&&(a.disabled=!t,a.label=e?f.get("DataGridViewCustomViewsDialog").SaveAndApply:f.get("DataGridViewCustomViewsDialog").Apply);let d=this.buttons.Save;return d&&(d.disabled=!e),e&&t},_displayNotificationMessage:function(e){m.getNotificationManager()||(m.setNotificationManager(p),m.setRemoveStackOnFirstTimeoutFlag(!0),m.setStackingPolicy(31)),p.addNotif({level:"info",subtitle:e})},_updateButtonsState:function(){this._checkIfResetToDefaultIsPossible(),this._checkIfUpdateFromCurrentViewIsPossible(),this._checkIfSaveAndApplyArePossible()},_createNewTreeDocument:function(){let e=this,t=new n({shouldAcceptDrop:function(t){if("middle"!==t.dropPosition&&t.draggedTreeNodeModel&&t.dropNode&&e.dataGridView){let i=e._getNodeModelPinned(t.draggedTreeNodeModel);if(e._getNodeModelPinned(t.dropNode)===i&&!t.draggedTreeNodeModel.isAscendantOf(t.dropNode)&&!t.dropNode.isAscendantOf(t.draggedTreeNodeModel)){let i="top"===t.dropPosition?"before":"after",n=t.dropNode;for(;n&&n.hasChildren();)n=n.getChildren()[0],i="before";if(n){let o=e._getColumnOrGroupFromNodeModel(t.draggedTreeNodeModel),l=n.getAttributeValue("dataIndex");if(e.dataGridView.layout._columnMoveIsPossible(o,l,i))return!0}}}return!1}});t.setFilterModel({label:{filterId:"string"},visibleFlag:{filterId:"set"},width:{filterId:"numberWithCondition"},pinned:{filterId:"set"}}),t.onUpdate(function(t){t.options.updateType!==WUXModelUpdateTypes.Selection&&t.options.updateType!==WUXModelUpdateTypes.PreSelection&&e._updateButtonsState()}),t.onNodeModelUpdate(function(t){if(!e._inNodeModelUpdate){e._inNodeModelUpdate=!0;let i=t.data.nodeModel,n=i.getTreeDocument();if(t.data&&t.data.attributes&&void 0!==t.data.attributes.pinned){let o=e._getTopNonSplittableGroupNodeModel(i);o&&(i=o),n.prepareUpdate(),i.hasChildren()&&i.processDescendants({treeTraversalOrder:"postOrder",processNode:function(e){e.nodeModel.setAttribute("pinned",t.data.attributes.pinned)}}),n.setUseChangeTransactionMode(!1),e._extractNodeModel(i);let l=null,r="before",s=e._getPreviousAndNextNodeModelInOriginalView(i,t.data.attributes.pinned);if(s)s.previous?(l=s.previous,r="after"):s.next&&(l=s.next);else if("left"===t.data.attributes.pinned||"unpinned"===t.data.attributes.pinned)if(l=e._getLastNodeModelWithPinnedState(n,"left"))r="after";else if(l=e._getFirstNodeModelWithPinnedState(n,"unpinned"))r="before";else{if(!(l=e._getFirstNodeModelWithPinnedState(n,"right")))return;r="before"}else if("right"===t.data.attributes.pinned)if(l=e._getFirstNodeModelWithPinnedState(n,"right"))r="before";else if(l=e._getLastNodeModelWithPinnedState(n,"unpinned"))r="after";else{if(!(l=e._getLastNodeModelWithPinnedState(n,"left")))return;r="after"}e._insertNodeModelNextTo(n,i,l,r),e._mergeChildren(n._getTrueRoot()),n.setUseChangeTransactionMode(!0),n.pushUpdate(),e._attributesDataGridView.ensureNodeModelVisible(i,!0,!1,void 0,!0),i.processDescendants({onlyVisibleNodes:!0,processNode:function(t){e._attributesDataGridView.flashEffectOnNodeModel("ui-modified",t.nodeModel)}})}else if(t.data&&t.data.attributes&&void 0!==t.data.attributes.visibleFlag){let o=e._attributesDataGridView.layout,l=o.getColumnIndex("visibleFlag"),r={updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1};if(i.hasChildren()){i.processDescendants({treeTraversalOrder:"postOrder",processNode:function(i){let n=i.nodeModel.getAttributeValue("dataIndex");e.dataGridView.layout.getColumnAlwaysVisibleFlag(n)||i.nodeModel.setAttribute("visibleFlag",t.data.attributes.visibleFlag)}});let n=o.getCellIDFromCoordinates({rowID:i._getRowID(),columnID:l});e._attributesDataGridView.updateCellView(n,r)}let s=n._getTrueRoot(),a=i.getParent();for(;a&&a!==s;){let t=o.getCellIDFromCoordinates({rowID:a._getRowID(),columnID:l});e._attributesDataGridView.updateCellView(t,r),a=a.getParent()}}e._updateButtonsState(),e._inNodeModelUpdate=!1}}),this._treeDocuments.push(t)},_getPreviousAndNextNodeModelInOriginalView:function(e,t){let i=new n;this._generateTreeDocumentFromCustomView(i,{});let o=this._getNodeModelFromDataIndex(i,e.getAttributeValue("dataIndex")),l=o.getAttributeValue("pinned")||"unpinned";if(o&&l===t){let e,n,l=o;for(;l;){let i,n,o=l.getPreviousNode();if(!o)break;if(i=o.getAttributeValue("dataIndex"),n=o.getAttributeValue("pinned")||"unpinned",!i||n!==t)break;if(!(e=this._getNodeModelFromDataIndex(this._attributesDataGridView.getTreeDocument(),i)))break;if((e.getAttributeValue("pinned")||"unpinned")===t)break;l=o}for(l=o;l;){let e,i,o=l.getNextNode();if(!o)break;if(e=o.getAttributeValue("dataIndex"),i=o.getAttributeValue("pinned")||"unpinned",!e||i!==t)break;if(!(n=this._getNodeModelFromDataIndex(this._attributesDataGridView.getTreeDocument(),e)))break;if((n.getAttributeValue("pinned")||"unpinned")===t)break;l=o}return i.destroy(),!(!e&&!n)&&{previous:e,next:n}}return i.destroy(),!1},_clearCustomView:function(e){if(e)for(let t in e)e.hasOwnProperty(t)&&"identifier"!==t&&"label"!==t&&delete e[t]},_setCustomViewPropertyValue:function(e,t,i,n){e&&(e[t]||(e[t]={}),e[t][i]=n)},getCurrentEditedCustomViewIndex:function(){return this._editedCustomViews.indexOf(this._selectedCustomView)},getEditedCustomView:function(e){let t;if("string"!=typeof e)return this._editedCustomViews[e];for(let i=0;i<this._editedCustomViews.length;i++){let n=this._editedCustomViews[i];if(n&&n.identifier===e){t=n;break}}return t},getCustomViewFromLabel:function(e){let t,i=e;"object"==typeof e&&(i=e.label);for(let e=0;e<this._editedCustomViews.length;e++){let n=this._editedCustomViews[e];if(n&&_(n)===i){t=n;break}}return t},_addEditedCustomView:function(e){const t=this._editedCustomViews.reduce((e,t,i)=>(e[t.identifier]=i,e),{}),i=e=>{void 0===t[e.identifier]&&this._editedCustomViews.push(e)};if(Array.isArray(e))for(const t of e)i(t);else i(e)},createNewCustomView:function(){let e=1,t="CustomConfiguration"+e,i=this.getEditedCustomView(t);for(;i;)t="CustomConfiguration"+ ++e,i=this.getEditedCustomView(t);let n=f.get("CustomViewDefaultName"),o=1,l=n+" "+o;for(i=this.getCustomViewFromLabel(l);i;)l=n+" "+ ++o,i=this.getCustomViewFromLabel(l);let r={identifier:"CustomConfiguration"+e,label:n+" "+o};this._addEditedCustomView(r),this._createNewTreeDocument();let s=this._getCustomViewIndex(r.identifier);return this.loadCustomView(s),this._updateModelFromCustomViews(),r},renameCurrentCustomView:function(){this._selectedCustomView&&this.elements._toolbar&&(this.elements._toolbar.updateNodeModel("ViewLabel",{visibleFlag:!1}),this.elements._toolbar.updateNodeModel("EditLabel",{grid:{data:_(this._selectedCustomView)}}),this.elements._toolbar.updateNodeModel("EditLabel",{visibleFlag:!0}),this.elements._toolbar.giveFocusTo("EditLabel"))},deleteCustomView:function(e){let t=this.getEditedCustomView(e);this._editedCustomViews.splice(e,1),this._treeDocuments.splice(e,1),this._selectedCustomView===t&&(this._selectedCustomView=this._editedCustomViews.length>0?this._editedCustomViews[0]:null,this.loadCustomView(0,!0)),this._updateModelFromCustomViews()},saveCustomViews:function(t){let i=this.getCurrentEditedCustomViewIndex();this.dataGridView.prepareUpdateView();let n={};for(let e=0;e<this._editedCustomViews.length;e++)this.saveCustomView(e,e===i&&t);let o=e.clone(this._editedCustomViews),l=o[this.getCurrentEditedCustomViewIndex()].identifier;if(this.dataGridView.getCustomViewsManager().setCustomViews(o,l,t,!0),this.dataGridView.rowGroupingEnabledFlag&&this._groupingSelectionChips&&t){let e=this._groupingSelectionChips.getAllChipsOptions().map(function(e){return e.value});this.dataGridView.getGroupingOptions()&&this.dataGridView.getGroupingOptions().dataIndexesToGroup.equals(e)||(n={updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},this.dataGridView.groupRows({dataIndexesToGroup:e}))}this.dataGridView.pushUpdateView(n),this._updateButtonsState()},saveCustomView:function(e,t){let i=this._editedCustomViews[e];if(i){let n=this.dataGridView.layout;t&&n.deleteDataGridViewPreferences();let o=i.layoutDensity||n._getOriginalLayoutDensity(),l=i.columnsSortModel,r=i.groupingOptions,s={},a=this._treeDocuments[e];if(a){let e=a.getChildren();e&&0!==e.length||this._generateTreeDocumentFromCustomView(a,i),this._clearCustomView(i);let t=0,o=this;a.processDescendants({processNode:function(e){if(e.nodeModel&&!e.nodeModel.hasChildren()){let l=e.nodeModel.getAttributeValue("dataIndex"),r=e.nodeModel.getAttributeValue("visibleFlag");r!==n._getOriginalColumnOptionValue(l,"visibleFlag")&&o._setCustomViewPropertyValue(i,"columnsVisibleFlag",l,r);let a=e.nodeModel.getAttributeValue("width");void 0===a&&(a="auto"),a!==n._getOriginalColumnOptionValue(l,"width")&&o._setCustomViewPropertyValue(i,"columnsWidth",l,a);let d=e.nodeModel.getAttributeValue("pinned");d!==n._getOriginalColumnOptionValue(l,"pinned")&&(o._setCustomViewPropertyValue(i,"columnsPinnedState",l,d),o._saveColumnOrderInCustomView(l,d,t,i));let u=n._originalOrderedColumnsReverseIndexes[n.getColumnIndex(l)];t!==u&&s[t]!==u&&(s[u]=t,o._saveColumnOrderInCustomView(l,d,t,i)),t++}}})}if(this._groupingSelectionChips){let t=this._customViewsGroupingOptions[e]||r;void 0!==t&&Array.isArray(t.dataIndexesToGroup)&&t.dataIndexesToGroup.length>0&&(i.groupingOptions=t)}let d=this.dataGridView._rowModel._originalSortModel||[],u=this._customViewsSortModels[e]||l;Array.isArray(d)&&Array.isArray(u)&&JSON.stringify(d)!==JSON.stringify(u)&&(i.columnsSortModel=u);let h=this._layoutDensities[e]||o;h!==n._getOriginalLayoutDensity()&&(i.layoutDensity=h)}},_getTreeDocumentFromCustomView:function(e){let t=null,i=this._editedCustomViews.indexOf(e);return i>=0&&(t=this._treeDocuments[i]),t},_getFirstNodeModelWithPinnedState:function(e,t){let i=null;return e.processDescendants({processNode:function(e){if(i)return{stopProcessing:!0};if(e.nodeModel&&!e.nodeModel.hasChildren()){if(e.nodeModel.getAttributeValue("pinned")===t)return i=e.nodeModel,{stopProcessing:!0}}}}),i},_getLastNodeModelWithPinnedState:function(e,t){let i=null;return e.processDescendants({processNode:function(e){if(e.nodeModel&&!e.nodeModel.hasChildren()){let n=e.nodeModel.getAttributeValue("pinned");if(n===t)i=e.nodeModel;else if("left"===t||"unpinned"===t&&"right"===n)return{stopProcessing:!0}}}}),i},_getFirstOrLastUnpinnedColumnIndex:function(e,t){let i=0,n=0;return e.processDescendants({processNode:function(e){if(e.nodeModel&&!e.nodeModel.hasChildren()){let t=e.nodeModel.getAttributeValue("pinned");"left"===t?n++:"right"===t?0:i++}}}),"undefined"===t||"left"===t?n:"right"===t?n+i-1:-1},_getNumberOfColumnsToTheLeft:function(e){return{left:0,unpinned:this._getFirstOrLastUnpinnedColumnIndex(e,"left"),right:this._getFirstOrLastUnpinnedColumnIndex(e,"right")+1}},_getTopNonSplittableGroupNodeModel:function(e){let t,i=e;for(;i;){let e=this._getColumnOrGroupFromNodeModel(i);e&&!1===e.splittableFlag&&(t=i),i=i.getParent()}return t},_saveColumnOrderInCustomView:function(e,t,i,n){let o=this._getTreeDocumentFromCustomView(n);if(o){let l="unpinned"===t?"unpinnedColumnsOrder":"pinnedColumnsOrder",r=this._getNumberOfColumnsToTheLeft(o);this._setCustomViewPropertyValue(n,l,e,i-r[t])}},_getAllPossibleCustomViews:function(){let e=[];for(let t=0;t<this._editedCustomViews.length;t++)e.push({value:this._editedCustomViews[t].identifier,label:_(this._editedCustomViews[t])});return e},_updateModelFromCustomViews:function(){let e=this._getAllPossibleCustomViews();this.elements._toolbar.updateNodeModel("ViewLabel",{possibleValues:e,grid:{data:this._selectedCustomView.identifier}});let t=this.getCurrentEditedCustomViewIndex();this.elements._toolbar.updateNodeModel("RenameView",{disabled:0===t}),this.elements._toolbar.updateNodeModel("DeleteView",{disabled:0===t})},_getCustomViewIndex:function(e){if(this.elements._toolbar&&e){let t=this._getAllPossibleCustomViews();for(let i=0;i<t.length;i++)if(t[i].value===e)return i}return-1}})}),define("DS/DataGridView/DataGridViewBaseFilterView",["UWA/Core","DS/Controls/Abstract"],function(e,t){"use strict";return t.inherit({name:"datagridviewbasefilterview",publishedProperties:{filterViewManager:{defaultValue:void 0,type:"object",readOnly:!0},filterId:{defaultValue:"",type:"string",readOnly:!0},propertyId:{defaultValue:"",type:"string",readOnly:!0},validFlag:{defaultValue:!0,type:"boolean"},filter:{defaultValue:null,type:"object"},filterViewOptions:{defaultValue:void 0,type:"object",noNeedToApplyFlag:!0}},buildContentView:function(){},buildFilterModelFromView:function(){},clearFilterViewContent:function(){},refreshContentView:function(e){},focusContentView:function(){},_build:function(){this._parent(),this.elements.container=new e.Element("div"),this.elements.container.dsModel=this,this._popupContentDiv=new e.Element("div")},_applyValidFlag:function(e){this.fire("validFlagChange")},getPopupContentDiv:function(){return this._popupContentDiv}})}),define("DS/DataGridView/RowModelBase",["DS/Core/BaseComponent","DS/TreeModel/ModelUtils","DS/Utilities/StringUtils","DS/CollectionView/ModelBase"],function(e,t,i,n){"use strict";return n.inherit({name:"RowModelBase",publishedProperties:{dataGridView:{defaultValue:null,type:"object"}},_applyProperties:function(e){this.isDirty("dataGridView")&&this._applyDataGridView(e.dataGridView)},_applyDataGridView:function(e){this.collectionView=this.dataGridView},_applySortModel:function(e){var t=this.dataGridView;t._isCurrentlyCalledFromUIInteraction()||t._currentlyCalledFromApplyPreferencesFlag||t.__preferencesRestored||(this._originalSortModel=this.sortModel?[].concat(this.sortModel):this.sortModel)},_preBuild:function(){this.modelEventsListener=[],this.xsoEventsListener=[],this.pxsoEventsListener=[],this._latestGroupingOptions=[]},_syncModel:function(e,t){var i=this.dataGridView,n=this;i._hasFlatTreeState=!0;var o=[];n._DGVRowIDNodeModelMapping.clear(),n._DGVNodeModelRowIDMapping.clear();var l=0;if(n._getTreeDocument()){n._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!0,processNode:function(e){var t=e.nodeModel;if(t&&i.shouldNodeBeRepresented(t)){if(o.push(t),void 0!==t.options.multipleNodesRep)for(var r=0;r<t.options.multipleNodesRep;r++)n._DGVRowIDNodeModelMapping.set(l,t),0===r&&n._DGVNodeModelRowIDMapping.set(t,l),l++;else n._DGVRowIDNodeModelMapping.set(l,t),n._DGVNodeModelRowIDMapping.set(t,l),l++;t.getChildren()&&(i._hasFlatTreeState=!1)}}}),i.prepareUpdateView();var r=!(!e||!(e.updateType&WUXModelUpdateTypes.Addition||e.updateType&WUXModelUpdateTypes.Removal||e.updateType&WUXModelUpdateTypes.Expand));r&&!n._isModelBeingFetched()&&UWA.equals(i.model,o)?i.updateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}):e&&e.updateType&WUXModelUpdateTypes.Filtering&&UWA.equals(i.model,o)?i.updateRowView(-1,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}):i.model=o,r&&i._applyMaxVisibleRowCount(void 0,i.maxVisibleRowCount,!0),!i.findStr||""===i.findStr||i._muteFind||t||i.setFindStr(i.findStr,i.matchCase,i._rowModel._computeFindEditorCurrentValue(),!0,!0,!0),i.pushUpdateView(void 0,void 0)}},_updateModel:function(){this._syncModel({updateType:WUXModelUpdateTypes.Addition})},_getCurrentPaginationOptions:function(){var e,t=this.dataGridView;if(t&&t.paginationManager){e={};var i=t.paginationManager.pageSize;e.nodeMin=(t.paginationManager.currentPage-1)*i,e.nodeMax=e.nodeMin+i-1,e.paginationNodeDepth=t.paginationManager.nodeDepth,e.currentPage=t.paginationManager.currentPage,e.pageSize=i}return e},getRowModelLength:function(e){if(void 0===e)return this.dataGridView.getModelLength();if(!this._rowModelLength){var t=0;this._getTreeDocument()&&this._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!0,processNode:function(i){if(-1===e)t++;else if(i.nodeModel.getNodeDepth()===e)return t++,{shouldProcessDescendants:!1}}}),this._rowModelLength=t}return this._rowModelLength},modelLengthModified:function(){this._rowModelLength=void 0},getNodesXSO:function(){var e=null,t=this._getTreeDocument();return t&&(e=t.getXSO()),e},getNodesPXSO:function(){var e=null,t=this._getTreeDocument();return t&&(e=t.getPXSO()),e},shouldBeSelected:function(e){var t=this._getTreeDocument();return!(t&&!t.options.shouldBeSelected.call(t,e))},_reapplyRowGrouping:function(){let e=this._getGroupingOptions();e&&e.dataIndexesToGroup&&(this._doGroupingOnModel(e),this.modelLengthModified())},_getGroupingOptions:function(){return this.dataGridView?this.dataGridView.getGroupingOptions():void 0},groupRows:function(e){var t=this.dataGridView;if(e&&e.dataIndexesToGroup){e.dataIndexesToGroup=e.dataIndexesToGroup.filter(function(e){return t.layout.getColumnOptionValue(e,"groupableFlag")});var i=this._latestGroupingOptions||[];if(this.dataGridView._setGroupingOptions(e),0===e.dataIndexesToGroup.length&&0===i.length)return;e.dataIndexesToGroup.length>0&&0===i.length?t.disableRowReordering():0===e.dataIndexesToGroup.length&&i.length>0&&t.enableRowReordering(),t.rowGroupingOptions.hideGroupedColumns&&(e.dataIndexesToGroup.forEach(function(e){if("tree"!==e){var n=i.indexOf(e);-1!==n&&i.splice(n,1),t.layout.setColumnVisibleFlag(e,!1)}}),i.forEach(function(e){t.layout.setColumnVisibleFlag(e,!0)})),this._latestGroupingOptions=e.dataIndexesToGroup||[],this._reapplyRowGrouping()}},_listenToTreeDocument:function(){var e=this,i=this.dataGridView,n=this._getTreeDocument();if(!n)return;var o=n.onUpdate(function(t){var n=!0;t.options.updateType===WUXModelUpdateTypes.Expand&&(n=!1),t.options.updateType&&(t.options.updateType&WUXModelUpdateTypes.Addition||t.options.updateType&WUXModelUpdateTypes.Removal||t.options.updateType&WUXModelUpdateTypes.Expand||t.options.updateType&WUXModelUpdateTypes.VisibilityChange)&&e.modelLengthModified(),t.options.updateType!==WUXModelUpdateTypes.Selection&&t.options.updateType!==WUXModelUpdateTypes.PreSelection&&t.options.updateType!==WUXModelUpdateTypes.AttributesChange&&e._syncModel(t.options,n),e._isModelBeingFetched()||(i.model&&0===i.getModelLength()?i._displayEmptyContentMessage():i._removeEmptyContentMessage()),e._mustClearViewSelection&&(i.getCellsXSO().empty(),e._mustClearViewSelection=!1)});this.modelEventsListener.push(o),e._syncModel({updateType:WUXModelUpdateTypes.Addition}),e._isModelBeingFetched()||(i.model&&0===i.getModelLength()?i._displayEmptyContentMessage():i._removeEmptyContentMessage()),o=n.onNodeModelUpdate(function(e){var t=e.data.nodeModel;if(t){var n=i.layout,o=t._getRowID(),l=i.getActiveCellID(),r=e.data.attributes,s=r&&Object.keys(r).length>0&&l>=0&&i.isCellInEdition(l);if(r)for(var a in r)if(r.hasOwnProperty(a)){var d=n.getCellIDFromCoordinates({rowID:o,columnID:a});d>=0&&d==l&&(s=!1)}i.updateRowView(o,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0,ignoreActiveCell:s}),n._useVariableRowHeight&&n.resetRowHeight(o)}}),this.modelEventsListener.push(o);var l=function(e){if(i._updateCounter>0)i._updateNeeded=!0;else{var t=e.target;if(t&&!t._isTrueRoot()&&!t.isExpanded()){var n=t.getChildren();if("addChild"===e.event&&n&&1===n.length||"removeChild"===e.event&&(!n||0===n.length)){var o=i.layout.getColumnIndex("tree");if(void 0===o)return;i.updateCellView(i.layout.getCellIDFromCoordinates({rowID:t._getRowID(),columnID:o}),{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}}}},r=function(e){var t=e.target;t&&i.updateCellView(i.layout.getCellIDFromCoordinates({rowID:t._getRowID(),columnID:i.layout.getColumnIndex("tree")}),{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})},s=function(e,t){var n=e.target;if(n){var o=n._getRowID();i.updateRowView(o,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})}};o=n.addModelEventListener("addChild",l),this.modelEventsListener.push(o),o=n.addModelEventListener("removeChild",l),this.modelEventsListener.push(o),o=n.addModelEventListener("highlight",s),this.modelEventsListener.push(o),o=n.addModelEventListener("unhighlight",s),this.modelEventsListener.push(o),o=n.addModelEventListener("matchSearch",r),this.modelEventsListener.push(o),o=n.addModelEventListener("unmatchSearch",r),this.modelEventsListener.push(o),o=n.addModelEventListener("documentRemoveRoots",function(e){t.destroyTreeDocumentOrderSnapshot(n)}),this.modelEventsListener.push(o),this._manageTreeDocumentSelection(),this._manageTreeDocumentPreSelection()},_manageTreeDocumentSelection:function(){var e=this.dataGridView,t=this.dataGridView.layout,i=this.getNodesXSO(),n=i.onPostAdd(function(n){var o=t.getMinMaxVisibleRowIDs();n.forEach(function(t){var n=t._getRowID();if("number"==typeof n&&n>=o.minRowID&&n<=o.maxRowID){e._updateRenderedRowCellsAttributes(n);var l=e._getRowSelectionCheckBox(n);if(l){var r=l.preventTriggeringChangeEvent;l.preventTriggeringChangeEvent=!0,l.mixedState=!1,l.checkFlag=!0,l.preventTriggeringChangeEvent=r}}if(!e.selectionBehavior.showMixedStateOnParents)return;let s,a=t.getParents(!1);for(;s=a.shift();)if(s._nbSelectedDescendants?s._nbSelectedDescendants++:s._nbSelectedDescendants=1,"number"==typeof(n=s._getRowID())&&n>=o.minRowID&&n<=o.maxRowID){if(!i.isIn(s)){let t=e._getRowSelectionCheckBox(n);if(t){let e=t.preventTriggeringChangeEvent;t.preventTriggeringChangeEvent=!0,t.mixedState=!0,t.checkFlag=!0,t.preventTriggeringChangeEvent=e}}e._updateRenderedRowCellsAttributes(n)}}),e._updateSelectAllCheckBox()});this.xsoEventsListener.push(n),n=i.onPostRemove(function(n){var o=t.getMinMaxVisibleRowIDs();n.forEach(function(t){var n=t._getRowID();if("number"==typeof n&&n>=o.minRowID&&n<=o.maxRowID&&(e._updateRenderedRowCellsAttributes(n),a=e._getRowSelectionCheckBox(n))){var l=a.preventTriggeringChangeEvent;a.preventTriggeringChangeEvent=!0,a.mixedState=t._nbSelectedDescendants>0,a.checkFlag=t._nbSelectedDescendants>0,a.preventTriggeringChangeEvent=l}if(!e.selectionBehavior.showMixedStateOnParents)return;let r,s=t.getParents(!1);for(;r=s.shift();){var a;if(r._nbSelectedDescendants?r._nbSelectedDescendants--:r._nbSelectedDescendants=0,0===r._nbSelectedDescendants&&!i.isIn(r))if("number"==typeof(n=r._getRowID())&&n>=o.minRowID&&n<=o.maxRowID)if(e._updateRenderedRowCellsAttributes(n),a=e._getRowSelectionCheckBox(n)){l=a.preventTriggeringChangeEvent;a.preventTriggeringChangeEvent=!0,a.mixedState=!1,a.checkFlag=!1,a.preventTriggeringChangeEvent=l}}}),e._updateSelectAllCheckBox()}),this.xsoEventsListener.push(n)},_manageTreeDocumentPreSelection:function(){const e=this.dataGridView,t=this.dataGridView.layout,i=this.getNodesPXSO();let n=i.onPostAdd(function(i){const n=t.getMinMaxVisibleRowIDs();i.forEach(function(t){const i=t._getRowID();i>=n.minRowID&&i<=n.maxRowID&&e._updateRenderedRowCellsAttributes(i)})});this.pxsoEventsListener.push(n),n=i.onPostRemove(function(i){const n=t.getMinMaxVisibleRowIDs();i.forEach(function(t){const i=t._getRowID();i>=n.minRowID&&i<=n.maxRowID&&e._updateRenderedRowCellsAttributes(i)})}),this.pxsoEventsListener.push(n)},prepareUpdate:function(){this._getTreeDocument().prepareUpdate()},pushUpdate:function(){this._getTreeDocument().pushUpdate()},_removeModelEvents:function(e){if(e&&e.getModelEvents()){for(var t=0;t<this.modelEventsListener.length;t++)e.getModelEvents().unsubscribe(this.modelEventsListener[t]);this.modelEventsListener.splice(0,this.modelEventsListener.length)}},_removeXSOEventsListener:function(e){var t=e?e.getXSO():null;if(t){for(var i=0;i<this.xsoEventsListener.length;i++)t.unsubscribe(this.xsoEventsListener[i]);this.xsoEventsListener.splice(0,this.xsoEventsListener.length)}},_removePXSOEventsListener:function(e){const t=e?e.getPXSO():null;if(t){for(let e=0;e<this.pxsoEventsListener.length;e++)t.unsubscribe(this.pxsoEventsListener[e]);this.pxsoEventsListener.splice(0,this.pxsoEventsListener.length)}},getFilterViewManager:function(){return this._filterViewManager||(this._filterViewManager=new DataGridViewFilterViewManager({view:this.dataGridView})),this._filterViewManager},destroy:function(){this._removeModelEvents(this._getTreeDocument()),this._removeXSOEventsListener(this._getTreeDocument()),this._removePXSOEventsListener(this._getTreeDocument()),this._parent()},_findAllCellIDsMatchingFindStrInClientSide:function(e,t,n){var o=this.dataGridView,l=o.layout;if(o._matchingFoundArrays=[],o._matchingCellIDsArray=[],o._matchingCellIDsMap={},o._matchingNodeModelsArray=[],o._matchingNodeModelsMap={},o._matchingAllNodeModelsArray=[],!n){var r=o.getNodeModelToProcessForFind;if(r)n=r.call(o,e,t);else n=[],this._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(e){var t=e.nodeModel;t&&!1===t.isHidden()&&!1===t.isFiltered()&&n.push(t)}})}if(0!==n.length)for(var s=this._getColumnsToProcessForFindData(o,e,t),a=s.findableColumnsDataIndexes,d=s.areFindableColumnsModified,u=i.toComparable(o.findStr.toString(),{toLowerCase:!t}),h=[],c=[],g=0;g<n.length;g++){var p=n[g];if(p&&p.hasRowID()/*!nodeModel.hasNoRepresentation()*/)for(var m=p.isVisible(),f=!(!m||null!==p._getRowID())||void 0,C=p._getRowID(f),_=0;_<a.length;_++){var w=a[_];if(!0!==d||-1!==a.indexOf(w)){var v;h[_]?v=h[_]:(v=l.getColumnIndex(w),h[_]=v);var D,I=l.getCellIDFromCoordinates({rowID:C,columnID:v}),V=!1===m?-1:I,y=this._getNodeCellInfos(p,m,I,o,l,v);c[_]?D=c[_]:(D=o.layout.getColumnOptionValue(v,"getCellValueAsStringForFind"),c[_]=D);var b=o._getCellValueAsStringForFind(D,y,w,l.getColumnTypeRepresentation(w));if(b&&UWA.is(b,"string")){var M=i.toComparable(b.toString(),{toLowerCase:!t}),x=o._getIndexesOfMatchingString(M,u);if(x.length>0){o._matchingFoundArrays.push(x),o._matchingCellIDsArray.push(V);var S=p.buildStringIdentifierArray;p._idForFind=S,o._matchingAllNodeModelsArray.push(p),-1!==V&&(o._matchingCellIDsMap[V]=o._matchingCellIDsArray.length-1),-1===o._matchingNodeModelsArray.indexOf(p)&&o._matchingNodeModelsArray.push(p),void 0!==p._getRowID()&&null!==p._getRowID()&&void 0===o._matchingNodeModelsMap[p._getRowID()]&&(o._matchingNodeModelsMap[p._getRowID()]=o._matchingNodeModelsArray.length-1)}}}}}},_getNodeCellInfos:function(e,t,i,n,o,l){var r=!1===t?-1:i;if(-1!=r)return n.getCellInfosAt(r);var s,a={columnID:l,nodeModel:e},d=o.getColumnHasCellValue(l);if(!d||d.call(n,a)){var u=o.getColumnGetCellValue(l);u&&(s=u.call(n,a))}if(e&&!s){var h=o.getDataIndexFromColumnIndex(l);if("tree"===h)"string"===o._getCellTypeRepresentation({columnID:a.columnID,cellModel:e.options.label,nodeModel:e})&&(s=e.options.label);s||(s=e.getAttributeValue(h))}return a.cellModel=s,a},_updateClientModelFromFind:function(e,t,i,n,o,l){return n?n.call(this,i,o,l):0},_computeNextMatchingData:function(e,t){var i=-1;if("substring"===e.findNavigationMode)i=e._currentMatchingStringIndex===this._computeMatchingStringsCount(t)-1?0:e._currentMatchingStringIndex+1;else if("cell"===e.findNavigationMode){var n=e._currentMatchingCellIDIndex;n===e._matchingCellIDsArray.length-1?n=0:n+=1,i=e._getMatchingStringIndexFromMatchingCellIDIndex(n)}else{var o=e._currentMatchingRowIDIndex;o===e._matchingNodeModelsArray.length-1?o=0:o+=1,i=e._getMatchingStringIndexFromMatchingRowIDIndex(o)}return i},_computeMatchingStringsCount:function(){for(var e=0,t=0;t<this.dataGridView._matchingFoundArrays.length;t++)e+=this.dataGridView._matchingFoundArrays[t].length;return e},_computePreviousMatchingData:function(e){var t=-1;if("substring"===e.findNavigationMode)t=0===e._currentMatchingStringIndex?e.matchingStringCount-1:e._currentMatchingStringIndex-1;else if("cell"===e.findNavigationMode){var i=e._currentMatchingCellIDIndex;0===i?i=e._matchingCellIDsArray.length-1:i-=1,t=e._getMatchingStringIndexFromMatchingCellIDIndex(i)}else{var n=e._currentMatchingRowIDIndex;0===n?n=e._matchingNodeModelsArray.length-1:n-=1,t=e._getMatchingStringIndexFromMatchingRowIDIndex(n)}return t},_getColumnsToProcessForFindData:function(e,t,i){var n=!1,o=e.getColumnsToProcessForFind,l=[];if(o&&(l=o.call(e,t,i),n=!0),!1===n){e.layout.getVisibleOrderedColumnsIndexes();for(var r=e.layout.getVisibleOrderedLeafColumns(),s=[],a=0;a<r.length;a++)!1!==r[a].findableFlag&&s.push(r[a].dataIndex);l=s}return{areFindableColumnsModified:n,findableColumnsDataIndexes:l}}})}),define("DS/DataGridView/DataGridViewContextualMenuBuilder",["DS/Utilities/Dom","DS/TreeModel/TreeNodeModel","i18n!DS/DataGridView/assets/nls/translation"],function(e,t,i){"use strict";var n=function(e){this._collectionView=e,this._supportedMenus=["filter","pin","sizeColumnToFit","firstColumnsVisibility","columnsManagement","expandCollapse","insertRow","deleteSelectedRows"]};return n.prototype.buildMenu=function(e,t){if(!this._collectionView)return console.log("A collection view is mandatory to build its contextual menu"),[];t=UWA.extend({filter:!0,pin:!0,firstColumnsVisibility:!0,columnsManagement:!0,sizeColumnToFit:!0,expandCollapse:!1,insertRow:!1},t);var i=this,n=[];return this._supportedMenus.forEach(function(o){if(!0===t[o]){var l="_create"+(o.substring(0,1).toUpperCase()+o.substring(1,o.length))+"ContextualMenu";if(i[l]instanceof Function){var r=i[l](e);r.length>0&&n.length>0&&n.push({type:"SeparatorItem",title:""}),n=n.concat(r)}}}),n},n.prototype.showCustomViewsDialog=function(){this._collectionView.showCustomViewsDialog()},n.prototype._createFilterContextualMenu=function(e){var t=[];if(this._collectionView&&e.cellInfos&&e.cellInfos.rowID<=-1&&e.cellInfos.columnID>-1){var n=this._collectionView.layout.getDataIndexFromColumnIndex(e.cellInfos.columnID),o=this._collectionView.getFilterViewManager();if(o){var l=o.filterManager;if(l){var r="tree"===n?"label":n;let a=l.getFilters(),d=a[r];if(d){var s=o.getFilterPopups()[r];if(s){let n={type:"PushItem",title:i.get("ContextualMenuBuilder").FilterColumn,icon:{iconName:"filter",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{context:{cellInfos:e.cellInfos},callback:function(e){s.showPopup()}}},o=this._collectionView.filterOptions?this._collectionView.filterOptions.maxAppliedFilterCount:void 0,l=d.canBeReset();if("number"==typeof o&&!l){let e=0;Object.keys(a).forEach(t=>{a[t].canBeReset()&&++e}),e>=o&&(n.state="disabled",n.tooltip=i.ContextualMenuBuilder.MaxFilterColumn)}t.push(n),l&&t.push({type:"PushItem",title:i.get("ContextualMenuBuilder").ResetColumnFilter,icon:{iconName:"filter-delete",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{context:{cellInfos:e.cellInfos},callback:function(e){e&&e.context&&e.context.cellInfos&&d.reset()}}})}}}}}return t},n.prototype._createPinContextualMenu=function(e){var t=this,n=[];if(e.cellInfos&&e.cellInfos.rowID<=-1&&e.cellInfos.columnID>-1){var o,l;-1===e.cellInfos.rowID?o=this._collectionView.layout.getColumnPinned(e.cellInfos.columnID):(l=t._collectionView.layout.getColumnOrGroupFromCoordinates({rowID:e.cellInfos.rowID,columnID:e.cellInfos.columnID}),o=this._collectionView.layout.getColumnOrGroupPinned(l));var r=[];r.push({type:"RadioItem",title:i.get("ContextualMenuBuilder").PinLeft,state:"left"===o?"selected":"unselected",action:{callback:function(i){l?t._collectionView.layout.setColumnOrGroupPinned(l,"left",{isUserInteraction:!0}):t._collectionView.layout.setColumnPinned(e.cellInfos.columnID,"left",{isUserInteraction:!0})}}}),r.push({type:"RadioItem",title:i.get("ContextualMenuBuilder").PinRight,state:"right"===o?"selected":"unselected",action:{callback:function(i){l?t._collectionView.layout.setColumnOrGroupPinned(l,"right",{isUserInteraction:!0}):t._collectionView.layout.setColumnPinned(e.cellInfos.columnID,"right",{isUserInteraction:!0})}}}),r.push({type:"RadioItem",title:i.get("ContextualMenuBuilder").NoPin,state:"left"!==o&&"right"!==o?"selected":"unselected",action:{callback:function(i){l?t._collectionView.layout.setColumnOrGroupPinned(l,"unpinned",{isUserInteraction:!0}):t._collectionView.layout.setColumnPinned(e.cellInfos.columnID,"unpinned",{isUserInteraction:!0})}}}),n.push({type:"PushItem",title:i.get("ContextualMenuBuilder").PinMenu,icon:{iconName:"pin",fontIconFamily:WUXManagedFontIcons.Font3DS},submenu:r})}return n},n.prototype._createFirstColumnsVisibilityContextualMenu=function(t){var i=[],n=t.cellInfos&&-1===t.cellInfos.rowID;if(!n&&t.infos&&t.infos.target&&(n=e.firstParentWithClass(t.infos.target,"wux-layouts-header")),n)for(var o=void 0,l=this._collectionView.layout,r=l.getLeafColumns(),s=0;s<r.length&&s<8;s++){o=r[l._orderedColumnsIndexes[s]];var a=l.getColumnVisibleFlag(o.dataIndex)?"selected":"unselected";i.push({type:"CheckItem",title:o.text,icon:o.icon,state:l.getColumnAlwaysVisibleFlag(o.dataIndex)?"disabled|"+a:a,action:{callback:function(e){if(e&&e.context&&e.context.id){var t=l.getColumnVisibleFlag(e.context.id);l.setColumnVisibleFlag(e.context.id,!t,{isUserInteraction:!0})}},context:{id:o.dataIndex}}})}return i},n.prototype._createColumnsManagementContextualMenu=function(t){var n=this,o=[],l=t.cellInfos&&-1===t.cellInfos.rowID;return!l&&t.infos&&t.infos.target&&(l=e.firstParentWithClass(t.infos.target,"wux-layouts-header")),l&&o.push({type:"PushItem",title:i.get("ContextualMenuBuilder").CustomViews,action:{callback:function(e){n.showCustomViewsDialog()}}}),o},n.prototype._createSizeColumnToFitContextualMenu=function(t){var n=[],o=t.cellInfos&&-1===t.cellInfos.rowID;return!o&&t.infos&&t.infos.target&&(o=e.firstParentWithClass(t.infos.target,"wux-layouts-header")),o&&t.cellInfos&&(n.push({type:"PushItem",title:t.cellInfos.rowID<-1?i.get("ContextualMenuBuilder").SizeGroupToFit:i.get("ContextualMenuBuilder").SizeToFit,icon:{iconName:"table-column-size",fontIconFamily:WUXManagedFontIcons.Font3DS},state:!1===this._collectionView.layout.getColumnResizableFlag(t.cellInfos.columnID)?"disabled":"",action:{context:{cellInfos:t.cellInfos},callback:function(e){if(e&&e.context&&e.context.cellInfos){var t=e.context.cellInfos.manager,i=(t.layout,e.context.cellInfos.columnID),n=e.context.cellInfos.rowID;t&&i>=0&&t.sizeColumnOrGroupToFit(i,n,{isUserInteraction:!0,computeColumnHeader:!0})}}}}),n.push({type:"PushItem",title:i.get("ContextualMenuBuilder").SizeAllToFit,icon:{iconName:"table-column-size-all",fontIconFamily:WUXManagedFontIcons.Font3DS},action:{context:{cellInfos:t.cellInfos},callback:function(e){e&&e.context&&e.context.cellInfos&&e.context.cellInfos.manager.sizeAllColumnsToFit({isUserInteraction:!0,computeColumnHeader:!0})}}})),n},n.prototype._createExpandCollapseContextualMenu=function(e){var t=[];return e.cellInfos&&e.cellInfos.columnID===e.collectionView.layout.getColumnIndex("tree")&&e.cellInfos.rowID>-1&&(e.cellInfos.nodeModel.canBeExpanded()&&(e.cellInfos.nodeModel.isExpanded()?t.push({type:"PushItem",title:i.get("Collapse"),action:{callback:function(t){e.cellInfos.nodeModel.collapse()}}}):t.push({type:"PushItem",title:i.get("Expand"),action:{callback:function(t){e.cellInfos.nodeModel.expand()}}})),e.cellInfos.nodeModel.canBeExpandedAll()&&(t.push({type:"PushItem",title:i.get("ExpandAll"),action:{callback:function(t){e.cellInfos.nodeModel.expandAll()}}}),t.push({type:"PushItem",title:i.get("CollapseAll"),action:{callback:function(t){e.cellInfos.nodeModel.collapseAll()}}}))),t},n.prototype._createInsertRowContextualMenu=function(e){var n=[];if(!e.cellInfos||e.cellInfos.rowID<=-1)return n;var o=function(i,n){if(i&&i.context&&i.context.cellInfos){var o=i.context.cellInfos.manager,l=o.getTreeDocument();l.prepareUpdate();var r=new t,s=i.context.cellInfos.nodeModel._getLocalID();i.context.cellInfos.nodeModel.getParent().addChild(r,"before"===n?s:s+1),l.pushUpdate(WUXModelUpdateTypes.Addition);var a=r._getRowID();o.insertRowCallback(r,a,e.cellInfos),o.ensureNodeModelVisible(r,!0),o.flashEffectOnNodeModel("ui-modified",r)}};return n.push({type:"PushItem",title:i.get("ContextualMenuBuilder").InsertRowBefore,action:{context:{cellInfos:e.cellInfos},callback:function(e){o(e,"before")}}}),n.push({type:"PushItem",title:i.get("ContextualMenuBuilder").InsertRowAfter,action:{context:{cellInfos:e.cellInfos},callback:function(e){o(e,"after")}}}),n},n.prototype._createDeleteSelectedRowsContextualMenu=function(e){var t=[];return!e.cellInfos||e.cellInfos.rowID<=-1?t:e.collectionView&&e.collectionView.getNodesXSO()&&!e.collectionView.getNodesXSO().isEmpty()?(t.push({type:"PushItem",title:i.get("ContextualMenuBuilder").DeleteSelectedRows,action:{context:{cellInfos:e.cellInfos},callback:function(e){e&&e.context&&e.context.cellInfos&&e.context.cellInfos.manager._askForDeletion()}}}),t):t},n}),define("DS/DataGridView/ModelMassUpdateDialog",["UWA/Core","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Controls/Button","DS/Controls/Toggle","DS/Controls/ButtonGroup","i18n!DS/DataGridView/assets/nls/translation"],function(e,t,i,n,o,l,r,s){"use strict";return t.inherit({name:"ModelMassUpdateDialog",publishedProperties:{treeDocument:{defaultValue:null,type:"object"},attributes:{defaultValue:[],type:"array"},setNodeModelValueFunction:{defaultValue:null,type:"function"}},destroy:function(){this._dataGridView&&(this._dataGridView.destroy(),this._dataGridView=null),this._parent()},_postBuildView:function(){this._parent();var t=e.createElement("div",{class:"wux-model-mass-update-maindiv"}),i=e.createElement("div",{class:"wux-model-mass-update-description"});e.createElement("div",{html:s.get("ModelMassUpdate").Description,class:"wux-model-mass-update-description-label"}).inject(i);this._selectionButtonGroup=new r({type:"radio"}),this._selectionButtonGroup.getContent().addClassName("wux-model-mass-update-target"),this._selectionButtonGroup.addChild(new l({type:"radio",label:s.get("ModelMassUpdate").ApplyToSelected,value:0,checkFlag:!0})),this._selectionButtonGroup.addChild(new l({type:"radio",label:s.get("ModelMassUpdate").ApplyToAll,value:1})),this._selectionButtonGroup.inject(i),i.inject(t),this._selectionButtonGroup.addEventListener("change",function(e){a._updateButtonsDisableState()});var n=require("DS/DataGridView/DataGridView");this._dataGridView=new n({identifier:this.identifier+"_DataGridView",height:"auto",treeDocument:null,columns:[{text:"Name",dataIndex:"tree",typeRepresentation:"string",alignment:"far",width:"250",minWidth:"50",alwaysVisibleFlag:!0,editableFlag:!1},{text:"Value",dataIndex:"value",getCellTypeRepresentation:function(e){return e.nodeModel?e.nodeModel.getAttributeValue("typeRepresentation"):"string"},getCellSemantics:function(e){if(e.nodeModel)return e.nodeModel.getAttributeValue("semantics")},resizableFlag:!1,width:"auto",minWidth:"100",alwaysVisibleFlag:!0,editableFlag:!0,editionPolicy:"EditionInPlace"}],cellSelection:"none",selectionBehavior:{selectNodeModelOnCellSelection:!1},focusNextEditableCellOnTabFlag:!0,showBackgroundFlag:!1,cellActivationFeedback:"none",cellPreselectionFeedback:"none",columnDragEnabledFlag:!1,showAlternateBackgroundFlag:!1,showRowIndexFlag:!1,showSelectionCheckBoxesFlag:!0,showRowHeaderBackgroundFlag:!1,defaultColumnDef:{minWidth:30,sortableFlag:!1}}),this._dataGridView.layout.columnsHeader=!1,this._dataGridView.layout.rowSpacing=6,this._applyAttributes();var a=this;this._dataGridView.addEventListener("liveChange",function(e,t){var i=a._dataGridView.model[t.rowID];i&&i.select()}),this._dataGridView.addEventListener("change",function(e,t){if(t.columnID===a._dataGridView.layout.getColumnIndex("value")){var i=a._dataGridView.model[t.rowID];i&&i.select()}}),this._dataGridView.inject(t),this.content=t,this.title=s.get("ModelMassUpdate").Title;a=this;this.buttons={Ok:new o({onClick:function(e){a.applyAttributesValues(),a.visibleFlag=!1}}),Apply:new o({onClick:function(e){a.applyAttributesValues()}}),Close:new o({onClick:function(e){a.visibleFlag=!1}})},this.addEventListener("close",function(e){a.visibleFlag=!1})},_applyProperties:function(e){this._parent(e),this.isDirty("treeDocument")&&this._applyTreeDocument(e.treeDocument),this.isDirty("attributes")&&this._applyAttributes(e.attributes)},_applyTreeDocument:function(e){if(this.treeDocument){var t=this.treeDocument.getXSO();if(t){var i=this;t.onPostAdd(function(e){i._updateButtonsDisableState()}),t.onPostRemove(function(e){i._updateButtonsDisableState()})}}},_applyAttributes:function(e){if(this._dataGridView){var t=new i,o=this.attributes;if(o)for(var l=0;l<o.length;l++){var r=o[l],s=r.label?r.label:r.name,a=this._getDefaultValue(r.typeRepresentation);t.addRoot(new n({label:s,grid:{name:r.name,typeRepresentation:r.typeRepresentation,semantics:r.semantics,value:a}}))}this._dataGridView.treeDocument=t;var d=this.buttons.Ok;d&&(d.disabled=!0);var u=this.buttons.Apply;u&&(u.disabled=!0);var h=t.getXSO();if(h){var c=this;h.onPostAdd(function(e){c._updateButtonsDisableState()}),h.onPostRemove(function(e){c._updateButtonsDisableState()})}c=this;var g=this._dataGridView.addEventListener("allCellsRendered",function(){c._dataGridView.removeEventListener("allCellsRendered",g),c._dataGridView.sizeColumnToFit("tree",{isUserInteraction:!1,computeAllRows:!0})})}},_getDefaultValue:function(e){var t=void 0;if(this._dataGridView){var i,n=this._dataGridView.getTypeRepresentationFactory(),o=n.getRegisteredTypeRepresentation(e);(i=o&&o.semantics&&o.semantics.possibleValues?o.semantics.possibleValues:n.getRegisteredEnum(e))&&(t=Array.isArray(i)?i[0]:i[Object.keys(i)[0]])}return t},resetAttributesValues:function(){if(this._dataGridView){for(var e=0;e<this._dataGridView.model.length;e++){var t=this._dataGridView.model[e];if(t){var i=t.getAttributeValue("typeRepresentation"),n=this._getDefaultValue(i);t.setAttribute("value",n)}}this._dataGridView.unselectAll()}},_applyAttributesValues:function(e,t){if(e&&t)if(this.setNodeModelValueFunction)for(var i=0;i<t.length;i++){if(r=t[i]){var n=r.getAttributeValue("name"),o=r.getAttributeValue("value");this.setNodeModelValueFunction(e,n,o)}}else{var l={grid:{}};for(i=0;i<t.length;i++){var r;if(r=t[i]){n=r.getAttributeValue("name"),o=r.getAttributeValue("value");l.grid[n]=o}}e.updateOptions(l)}},applyAttributesValues:function(){if(this._dataGridView&&this.treeDocument){var e=1==this._selectionButtonGroup.value[0],t=this._dataGridView.getNodesXSO().get();if(t.length>0){var i=this;this.treeDocument.prepareUpdate(),e?this.treeDocument.processDescendants({onlyVisibleNodes:!0,processNode:function(e){i._applyAttributesValues(e.nodeModel,t)}}):this.treeDocument.processSelectedNodes({processNode:function(e){i._applyAttributesValues(e.nodeModel,t)}}),this.treeDocument.pushUpdate({updateType:WUXModelUpdateTypes.AttributesChange})}}},_updateButtonsDisableState:function(){var e=!0;if(this.treeDocument&&this._dataGridView&&this._dataGridView.treeDocument){var t=this.treeDocument.getXSO(),i=this._dataGridView.treeDocument.getXSO();if(t&&i)e=1==this._selectionButtonGroup.value[0]?i.isEmpty():t.isEmpty()||i.isEmpty()}var n=this.buttons.Ok;n&&(n.disabled=e);var o=this.buttons.Apply;o&&(o.disabled=e)}})}),define("DS/DataGridView/DataGridViewCell",["DS/CollectionView/CollectionViewCell"],function(e){"use strict";return e.inherit({name:"DataGridViewCell",publishedProperties:{showKPIColorFlag:{defaultValue:!1,type:"boolean"},KPIColor:{defaultValue:void 0,type:"string"}},_applyShowKPIColorFlag:function(e){this._updateKPIColor()},_applyKPIColor:function(e){this._updateKPIColor()},_updateKPIColor:function(){this.showKPIColorFlag?(this.elements.KPIColorDiv?this.elements.KPIColorDiv.show():this.elements.KPIColorDiv=new UWA.Element("div",{class:"wux-layouts-datagridview-kpi-color"}),void 0!==this.KPIColor?(this.elements.KPIColorDiv.style.background=this.KPIColor,this.elements.KPIColorDiv.style.outlineColor=this.KPIColor,this.elements.KPIColorDiv.style.visibility=""):this.elements.KPIColorDiv.style.visibility="hidden",this.elements.KPIColorDiv.parentNode||this.elements.KPIColorDiv.inject(this.elements.container,"top")):this.elements.KPIColorDiv&&this.elements.KPIColorDiv.hide()},_applyProperties:function(e){this._parent(e),this.isDirty("showKPIColorFlag")&&this._applyShowKPIColorFlag(e.showKPIColorFlag),this.isDirty("KPIColor")&&this._applyKPIColor(this.KPIColor)},blackBoxFlag:!0,getInitialClassName:function(){return this._parent()+" wux-layouts-datagridview-cell"},getCleaningMode:function(){return 1},isRow:function(){return!1}})}),define("DS/DataGridView/DataGridViewLayout",["DS/CollectionView/layouts/CollectionViewGridLayout","DS/Utilities/Utils","DS/Utilities/TreeUtils","DS/TreeModel/ModelUtils","DS/Utilities/Dom","DS/Utilities/Array","DS/TreeModel/TreeNodeModel"],function(e,t,i,n,o,l,r){"use strict";return e.inherit({name:"CollectionViewDataGridLayout",publishedProperties:{columns:{defaultValue:[],type:"array"},cellWidth:{defaultValue:100,type:"integer"},cellHeight:{defaultValue:26,type:"integer"},layoutDensity:{defaultValue:"compact",type:"string"},columnsHeader:{defaultValue:!0,type:"boolean"},columnHeaderHeight:{defaultValue:27,type:"integer"},rowsHeader:{defaultValue:!0,type:"boolean"},rowSpacing:{defaultValue:0,type:"integer"},addCellCoordinates:{defaultValue:!1,type:"boolean"},useLastColumnWidthAutoFlag:{defaultValue:!1,type:"boolean"},preferencesToApply:{defaultValue:void 0,type:"string",readOnly:!0}},_dataGridViewPrefKey:"wux-collectionView-dataGridView",init:function(e){this._parent(e),this._balancedColumnTree=[],this._columnItemsByDepth=[],this._leafColumns=[],this._leafColumnsCount=0,this._orderedColumnsIndexes=[],this._computedColumns=[],this._computedRows=[],this._computedHeadersHeights=new Map,this._columnTreeItemCount=0,this._columnHeaderCellCount=3+(this.rowsHeader?1:0),this._hasAutoWidthColumnWithAutoRowHeightFlag=!1,this._autoRowHeightColumnIndexes=[],this._autoHeaderHeightColumnIndexes=[]},_applyProperties:function(e){this._parent(e),this.isDirty("layoutDensity")&&this._applyLayoutDensity(e.layoutDensity)},prepareLayout:function(){var e=this.rowsHeader,t=this.getLeafColumns();this._leafColumnsCount=t.length+(e?1:0),this._columnHeaderCellCount=this._columnTreeItemCount+(e?1:0)+3,this._computeColumnsWidth(),this._leftPinnedRowColumnID=e?-4:-3,this._unpinnedRowColumnID=e?-3:-2,this._rightPinnedRowColumnID=e?-2:-1,this._isInvalid=!1},_applyColumnGroupsExpandedFlag:function(){if(this._columnItemsByDepth&&this._columnItemsByDepth.length>0)for(var e=0;e<this._columnItemsByDepth.length-1;e++)for(var t=this._columnItemsByDepth[e],i=0;i<t.length;i++){var n=t[i],o=n.children;if(o&&o.length>0)for(var l=0;l<o.length;l++){var r=o[l];"closed"!==r.columnGroupShow&&"open"!==r.columnGroupShow||(n.expandedFlag=!1)}}},_applyColumns:function(e,t){this._balancedColumnTree=i.createBalancedTree(this.columns),this._columnItemsByDepth=i.computeItemsByDepth(this._balancedColumnTree);var n=!!this.collectionView.defaultColumnDef&&this.collectionView.defaultColumnDef.autoRowHeightFlag;if(this._leafColumns=[],this._hasAutoWidthColumnWithAutoRowHeightFlag=!1,this._autoRowHeightColumnIndexes=[],this._autoHeaderHeightColumnIndexes=[],this._columnItemsByDepth&&this._columnItemsByDepth.length>0)for(var o=this._columnItemsByDepth[this._columnItemsByDepth.length-1],r=0;r<o.length;r++){var s=o[r];void 0!==s.dataIndex?(void 0!==s.pinned&&"left"!==s.pinned&&"right"!==s.pinned&&"unpinned"!==s.pinned&&(s.pinned="unpinned"),this._leafColumns.push(s),(n||s.autoRowHeightFlag)&&(this._autoRowHeightColumnIndexes.push(r),"auto"===this.getColumnWidth(r)&&(this._hasAutoWidthColumnWithAutoRowHeightFlag=!0)),s.customHeader&&(this._autoHeaderHeightColumnIndexes.push(r),this.collectionView._registerColumnHeaderReusableCellContent(s))):console.warn("The leaf column at index "+r+" does not have a defined dataIndex")}if(this._autoRowHeightColumnIndexes.length>0||this._autoHeaderHeightColumnIndexes.length>0)if(this.getRowHeightFunction)this.resetRowHeights();else{this.collectionView.virtuallyLoadAllModelItems&&this.collectionView._rowModel&&this.collectionView._rowModel._isServerSide()?(console.warn("Warning, autoRowHeightFlag is not supported with 'virtuallyLoadAllModelItems' mode. You should implement getRowHeightFunction function on DataGridView layout options"),this.getRowHeightFunction=null):this.getRowHeightFunction=this.getRowHeightFromCellContents}else this.getRowHeightFunction===this.getRowHeightFromCellContents&&(this.getRowHeightFunction=null);if(e!==t)this._originalLeafColumns=i.cloneTree(this._leafColumns),this._computeOriginalOrderedColumnsIndexes();else if(this._originalLeafColumns&&this._leafColumns&&this._originalLeafColumns.length!==this._leafColumns.length){for(let e=this._originalLeafColumns.length-1;e>=0;e--)-1===l.getIndexOfElement(this._leafColumns,"dataIndex",this._originalLeafColumns[e].dataIndex)&&this._originalLeafColumns.splice(e,1);for(let e=0;e<this._leafColumns.length;e++)-1===l.getIndexOfElement(this._originalLeafColumns,"dataIndex",this._leafColumns[e].dataIndex)&&this._originalLeafColumns.splice(e,0,UWA.clone(this._leafColumns[e],!1));this._computeOriginalOrderedColumnsIndexes()}this._updateColumnTreeFromOrderedIndexes(),this._computeColumnsWidth(),this._applyColumnGroupsExpandedFlag(),this._applyPreferencesOnColumns(),(e&&e.length>0||t)&&this.invalidate({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})},applyColumns:function(){this.collectionView.prepareUpdateView(),this._applyColumns(),this.invalidate({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),this.collectionView.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},!0)},_computeColumnItems:function(){this._mergeColumnGroups(this._balancedColumnTree,this.collectionView._draggedColumnOrGroup),this._columnItemsByDepth=i.computeItemsByDepth(this._balancedColumnTree),this._columnTreeItemCount=i.countItem(this._balancedColumnTree);var e=this.rowsHeader,t=this.getLeafColumns();this._leafColumnsCount=t.length+(e?1:0),this._columnHeaderCellCount=this._columnTreeItemCount+(e?1:0)+3,this._computeColumnsReverseIndexes(),this._computeOrderedColumnsIndexes()},_mergeColumnGroups:function(e,t){if(e.length>1)for(var i=e.length-1;i>0;i--){var n=e[i],o=e[i-1];if(n&&n.children&&o&&o.children&&n.dataIndex===o.dataIndex&&(!t||n!==t&&o!==t)){var l=this.getColumnOrGroupPinned(n),r=this.getColumnOrGroupPinned(o);if(l===r||void 0===l&&"unpinned"===r||"unpinned"===l&&void 0===r){o.children=o.children.concat(n.children);for(var s=0;s<n.children.length;s++)n.children[s]._parent=o;e.splice(i,1)}}}for(i=0;i<e.length;i++){var a=e[i];a&&a.children&&this._mergeColumnGroups(a.children,t)}},_updateColumnTreeFromOrderedIndexes:function(){for(var e=this.getLeafColumns(),t=[],n=0;n<this._orderedColumnsIndexes.length;n++){var o=e[this._orderedColumnsIndexes[n]],l=i.extractItemHierarchy(o,this._balancedColumnTree,!1);l&&t.push(l)}this._balancedColumnTree=t,this._computeColumnItems()},_applyRowsHeader:function(e,t){this.invalidate({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})},getDefaultCellHeight:function(){return this.collectionView._getCurrentTouchMode()||"comfortable"===this.layoutDensity?40:26},_applyCellHeight:function(e,t){if(t<26)return this.cellHeight=26,void(this.collectionView&&this.collectionView._applyMaxVisibleRowCount(void 0,this.collectionView.maxVisibleRowCount));this.resetRowHeights(),this.collectionView&&this.collectionView._applyMaxVisibleRowCount(void 0,this.collectionView.maxVisibleRowCount)},_applyLayoutDensity:function(e,t){this.collectionView&&(this.collectionView._isCurrentlyCalledFromUIInteraction()||this.collectionView._currentlyCalledFromApplyPreferencesFlag)||(this._originalLayoutDensity=this.layoutDensity),this.collectionView&&this.collectionView.getContent()&&(this.collectionView.getContent().setAttribute("layout-density",this.layoutDensity),this.collectionView._applyMaxVisibleRowCount(void 0,this.collectionView.maxVisibleRowCount,!0)),this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})},_getOriginalLayoutDensity:function(){return this._originalLayoutDensity||this.layoutDensity},_applyColumnsHeader:function(e,t){this.invalidate({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})},_applyColumnHeaderHeight:function(e,t){if(t<27)return this.columnHeaderHeight=27,void(this.collectionView&&this.collectionView._applyMaxVisibleRowCount(void 0,this.collectionView.maxVisibleRowCount));this.collectionView&&this.collectionView._applyMaxVisibleRowCount(void 0,this.collectionView.maxVisibleRowCount),this.invalidate({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!1})},_applyRowSpacing:function(e,t){this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})},_applyAddCellCoordinates:function(e,t){this.invalidate({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})},_applyUseLastColumnWidthAutoFlag:function(e,t){this.invalidate({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})},getLeafColumns:function(){return this._leafColumns},getVisibleOrderedLeafColumns:function(){if(!this._leafColumns)return[];for(var e=[],t=this.getLeafColumns(),i=this.getVisibleOrderedColumnsIndexes(),n=0;n<i.length;n++){var o=t[i[n]];e.push(o)}return e},_getColumnTreeDepth:function(){return this._columnItemsByDepth?this._columnItemsByDepth.length:0},_getOriginalLeafColumns:function(){return this._originalLeafColumns},getColumnOptionValue:function(e,t){var i,n=this.getColumnIndex(e);if(n>-1){var o=this.getLeafColumns()[n];if(o&&(i=o[t]),void 0===i){var l=this.collectionView.defaultColumnDef;l&&(i=l[t])}}return i},_getOriginalColumnOptionValue:function(e,t){var i;if((e=this.getColumnIdentifiers(e).columnIndex)>-1){var n=this._getOriginalLeafColumns()[e];n&&(i=n[t]),void 0===i&&this.collectionView.defaultColumnDef&&(i=this.collectionView.defaultColumnDef[t])}return i},_computeColumnsReverseIndexes:function(){this._columnsReverseIndexes={};for(var e=this.getLeafColumns(),t=0,i=e.length;t<i;t++){var n=e[t].dataIndex;void 0!==n&&(this._columnsReverseIndexes[n]=t)}this._columnsReverseIndexes.rowHeader=-1},_computeOriginalOrderedColumnsIndexes:function(){for(var e=this._getOriginalLeafColumns().length,t=[],i=[],n=[],o=0;o<e;o++){var l=this.getColumnPinned(o);"left"===l?t.push(o):"right"===l?n.push(o):i.push(o)}this._orderedColumnsIndexes=t.concat(i).concat(n),this._originalOrderedColumnsIndexes=this._orderedColumnsIndexes.slice(0),this._computeOrderedColumnsReverseIndexes(),this._originalOrderedColumnsReverseIndexes=this._orderedColumnsReverseIndexes.slice(0)},_getOriginalOrderedColumnsIndexes:function(){return this._originalOrderedColumnsIndexes},_computeOrderedColumnsIndexes:function(){if(this._orderedColumnsIndexes=[],this._columnItemsByDepth&&this._columnItemsByDepth.length>0)for(var e=this._columnItemsByDepth[this._columnItemsByDepth.length-1],t=0;t<e.length;t++){var i=e[t];this._orderedColumnsIndexes.push(this.getColumnIndex(i.dataIndex))}this._computeOrderedColumnsReverseIndexes()},getOrderedColumnsIndexes:function(){return this._orderedColumnsIndexes},getOrderedColumnsReverseIndexes:function(){return this._orderedColumnsReverseIndexes},_computeOrderedColumnsReverseIndexes:function(){this._orderedColumnsReverseIndexes=[];for(var e=0;e<this._orderedColumnsIndexes.length;e++)this._orderedColumnsReverseIndexes[this._orderedColumnsIndexes[e]]=e},hasCellsInLeftContainer:function(){return void 0!==this._firstLeftPinnedColumnIndex},hasCellsInRightContainer:function(){return void 0!==this._firstRightPinnedColumnIndex},_computeColumnsWidth:function(){this._firstUnpinnedColumnIndex=void 0,this._lastUnpinnedColumnIndex=void 0,this._firstLeftPinnedColumnIndex=void 0,this._lastLeftPinnedColumnIndex=void 0,this._firstRightPinnedColumnIndex=void 0,this._lastRightPinnedColumnIndex=void 0;var e=this.collectionView.getViewportDimensions(),i=this.collectionView.getDimensions(),n=this._getEstimatedVirtualHeight(!0)>e.height?t.getScrollbarWidth():0,o=i.width-n-(this.rowsHeader?this.getRowHeaderWidth():0);this.getRightContainerWidth()>0&&o--,this.getLeftContainerWidth()>0&&o--;var l=void 0;if(this.useLastColumnWidthAutoFlag)for(var r=this.getColumnIndex("ContextualMenuColumn"),s=this._orderedColumnsIndexes.length-1;s>=0;s--){if((w=this._orderedColumnsIndexes[s])!==r)if(c=this.getColumnVisibleState(w))if("right"!==(D=this.getColumnPinned(w))&&"left"!==D){l=w;break}}for(var a=0,d=this.getLeafColumns(),u=(s=0,d.length);s<u;s++){var h=!1,c=this.getColumnVisibleState(s);void 0===(v=this.getColumnWidth(s))&&(v="auto"),this.useLastColumnWidthAutoFlag&&s===l&&(v="auto");let e=0;d[s].customHeader&&c&&(e=this._computeRenderedHeaderMinWidth(d[s].dataIndex));var g=this.getColumnMinWidth(s);c?("string"==typeof v&&("auto"===v?(v=0,h=!0,a++):v=v.indexOf("%")>-1?Math.floor(i.width*(parseInt(v,10)/100)):parseInt(v,10)),v=Math.max(0,v),g&&!h&&(v=Math.max(g,v)),e&&"number"==typeof e&&(v=Math.max(v,e))):v=0,o-=v,this._setColumnComputedWidth(s,v)}var p=this.cellWidth,m=0,f=0,C=0,_=0;for(s=0;s<this._orderedColumnsIndexes.length;s++){var w=this._orderedColumnsIndexes[s],v=(g=this.getColumnMinWidth(w),c=this.getColumnVisibleState(w),this.getColumnWidth(w));this.useLastColumnWidthAutoFlag&&w===l&&(v="auto");var D=this.getColumnPinned(w);if("auto"===v&&c){var I=Math.floor(o/(a-_)),V=Math.max(p,I);g&&(V=Math.max(g,V)),o-=V,this._setColumnComputedWidth(w,V),_++}var y=0,b=this.getColumnComputedWidth(w);"left"===D?(y=m,m+=b,void 0===this._firstLeftPinnedColumnIndex&&c&&(this._firstLeftPinnedColumnIndex=w),c&&(this._lastLeftPinnedColumnIndex=w)):"right"===D?(y=f,f+=b,void 0===this._firstRightPinnedColumnIndex&&c&&(this._firstRightPinnedColumnIndex=w),c&&(this._lastRightPinnedColumnIndex=w)):(y=C,C+=b,void 0===this._firstUnpinnedColumnIndex&&c&&(this._firstUnpinnedColumnIndex=w),c&&(this._lastUnpinnedColumnIndex=w)),this._setColumnPosition(w,y)}},_setColumnPosition:function(e,t){this._computedColumns[e]||(this._computedColumns[e]={}),this._computedColumns[e].position=t},getColumnPosition:function(e){return this._computedColumns[e]?this._computedColumns[e].position:0},getColumnOrGroupPosition:function(e){var t=0;return e&&(t=e.children?this.getColumnOrGroupPosition(e.children[0]):this.getColumnPosition(this.getColumnIndex(e.dataIndex))),t},moveColumn:function(e,t,i){var n=this.getLeafColumns()[this.getColumnIndex(e)];return this.moveColumnOrGroup(n,t,i)},moveColumnOrGroup:function(e,t,n){if(!e)return!1;"string"==typeof t&&(t=this.getColumnIndex(t));var o=this.getLeafColumns()[t];if(!o)return!1;var l=this.getFirstLeafColumnIndex(e),r=this.getLastLeafColumnIndex(e),s=this._orderedColumnsReverseIndexes[l],a=this._orderedColumnsReverseIndexes[t],d=n&&n.insertBeforeOrAfter?n.insertBeforeOrAfter:s<a?"after":"before";if(!this._columnMoveIsPossible(e,t,d))return!1;this.collectionView._draggedColumnOrGroupPreviousFather=e._parent;var u=i.getLeafItems(e),h=this._getPreviousVisibleColumnID(l),c=this._getNextVisibleColumnID(r),g=this._columnTreeItemCount,p=i.getCommonParent(e,o);p||(p=this._balancedColumnTree);var m=i.extractItemHierarchy(e,p,!0);if(m){i.splitParentAtItemIndex(o,p,d);var f=i.getIndexInRootParent(o,p),C="after"===d?f+1:f;p&&p!==this._balancedColumnTree?i.addChild(p,m,C):this._balancedColumnTree.splice(C,0,m)}this._computeColumnItems();for(var _=this.getColumnPinned(t),w=this._orderedColumnsReverseIndexes[l]<this._orderedColumnsReverseIndexes[h]?l:c,v=this._orderedColumnsReverseIndexes[l]<this._orderedColumnsReverseIndexes[h]?h:l,D=this._orderedColumnsReverseIndexes[w];D<=this._orderedColumnsReverseIndexes[v];D++){var I=this._orderedColumnsIndexes[D];if(this.getColumnVisibleState(I))this.getColumnPinned(I)===_&&this.collectionView._freeUpColumnCells(I,1)}if(n&&n.isUserInteraction){for(D=0;D<u.length;D++)this._saveColumnOrderInPreferences(u[D].dataIndex);this._updateAllOrderInPreferences(e)}this.collectionView._updateColumnHeaderCells({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0});var V=!1;this._columnTreeItemCount!==g&&(V=!0);var y=!1;return this.collectionView._draggedColumnOrGroup&&(y=!0),this.invalidate({updateCellContent:V,updateCellLayout:!0,updateCellAttributes:y}),this.collectionView.fire("columnOrderChange"),!0},_columnMoveIsPossible:function(e,t,n){var o=!1;"string"==typeof t&&(t=this.getColumnIndex(t));var l=this.getLeafColumns()[t];if(l&&e){for(var r=i.getLeafItems(e),s=0;s<r.length;s++){if(r[s]===l)return!1}if("before"!==n&&"after"!==n){var a=this.getFirstLeafColumnIndex(e);n=this._orderedColumnsReverseIndexes[a]<this._orderedColumnsReverseIndexes[t]?"after":"before"}var d=i.getCommonParent(e,l);d||(d=this._balancedColumnTree);var u=i.getParents(e);for(s=u.length-1;s>=0;s--){var h=u[s];if(h===d)break;if(!1===h.splittableFlag)return!1}var c=i.getParents(l);for(s=c.length-1;s>=0;s--){var g=c[s];if(g===d)break;if(!1===g.splittableFlag&&("after"===n&&t!==this.getLastLeafColumnIndex(g)||"before"===n&&t!==this.getFirstLeafColumnIndex(g)))return!1}o=!0}return o},getColumnShowTextFlag:function(e){return this.getColumnOptionValue(e,"showTextFlag")},getColumnAutoRowHeightFlag:function(e){return this.getColumnOptionValue(e,"autoRowHeightFlag")},setColumnAutoRowHeightFlag:function(e,t){var i=this.getColumnIndex(e),n=this.getLeafColumns();n[i].autoRowHeightFlag!==t&&(n[i].autoRowHeightFlag=t,this.applyColumns())},hasAutoWidthColumn:function(){for(var e=!1,t=(this.layout,this.getLeafColumns()),i=0;i<t.length;i++){var n=this.getColumnPinned(i);if("left"!==n&&"right"!==n&&"auto"===this.getColumnWidth(i)&&this.getColumnVisibleState(i)){e=!0;break}}return e},hasColumnWithAutoRowHeightFlag:function(){return this._autoRowHeightColumnIndexes&&this._autoRowHeightColumnIndexes.length>0},hasAutoWidthColumnWithAutoRowHeightFlag:function(){return this._hasAutoWidthColumnWithAutoRowHeightFlag},getColumnVisibleState:function(e){return this.getColumnAlwaysVisibleFlag(e)||this.getColumnVisibleFlag(e)&&this._isColumnDisplayedByHierarchy({rowID:-1,columnID:e})},getColumnVisibleFlag:function(e){return this.getColumnOptionValue(e,"visibleFlag")},setColumnVisibleFlag:function(e,t,i){var n=this.getColumnIndex(e);if(!(n<0||void 0===n)){var o=this.getLeafColumns();if(o[n].visibleFlag!==t){if(!t&&this.getColumnAlwaysVisibleFlag(e))return;o[n].visibleFlag=t,(this.getColumnAutoRowHeightFlag(n)||this.hasAutoWidthColumnWithAutoRowHeightFlag())&&this.resetRowHeights({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!0}),t&&this.collectionView.requestDelayedModelData("OnShowColumn"),o[n].customHeader&&this.resetRowHeight(-1),this.getColumnAutoRowHeightFlag(n)||this.hasAutoWidthColumnWithAutoRowHeightFlag()||this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!0}),this._updateAutoWidthStyle(),this.collectionView.findStr&&""!=this.collectionView.findStr&&!this.collectionView._muteFind&&this.collectionView.setFindStr(this.collectionView.findStr,this.collectionView.matchCase,this.collectionView._currentMatchingStringIndex,!0,!0),this.collectionView.fire("columnVisibleStateChange",{visibleState:t,columnID:e});var l=o[n]._parent;if(l&&void 0!==l.expandedFlag){var r=this.getColumnOrGroupCellCoordinates(l);this.collectionView.updateCellView(this.getCellIDFromCoordinates(r),{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}}i&&i.isUserInteraction&&this._saveColumnVisibleFlagInPreferences(n)}},_resetComputedRows:function(){this._computedHeadersHeights&&this._computedHeadersHeights.clear(),this._parent()},resetRowHeight:function(e){if(e<0){let n=this._computedHeadersHeights.get(e);if(n){var t=n;if(this._computedHeadersHeights.set(e,void 0),this._computeColumnHeadersHeight(e)!==t){for(var i=e+1;i<0;i++)this._computedHeadersHeights.get(i)&&this._computedHeadersHeights.set(i,void 0);this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!0})}}}else this._parent(e)},getColumnAlwaysVisibleFlag:function(e){return this.getColumnOptionValue(e,"alwaysVisibleFlag")},getColumnOrGroupVisibleState:function(e){var t=!1;if(e)if(e.children)for(var i=0;i<e.children.length;i++){var n=e.children[i];if(t=this.getColumnOrGroupVisibleState(n))break}else t=this.getColumnVisibleState(e.dataIndex);return t},getColumnOrGroupSelectableState:function(e){var t=!1;if(e&&this.getColumnOrGroupVisibleState(e))if(e.children)for(var i=0;i<e.children.length;i++){var n=e.children[i];if(t=this.getColumnOrGroupSelectableState(n))break}else t=this.getColumnSelectableFlag(e.dataIndex);return t},getColumnOrGroupPrintableState:function(e){var t=!1;if(e&&this.getColumnOrGroupVisibleState(e))if(e.children)for(var i=0;i<e.children.length;i++){var n=e.children[i];if(t=this.getColumnOrGroupPrintableState(n))break}else t=this.getColumnPrintableFlag(e.dataIndex);return t},_getVisibleLeafCount:function(e){var t=0;if(e&&e.children)for(var i=0;i<e.children.length;i++){var n=e.children[i];n.children?t+=this._getVisibleLeafCount(n):this.getColumnOrGroupVisibleState(n)&&t++}return t},setColumnOrGroupProperties:function(e,t){this.collectionView.prepareUpdateView();var i=!1;if((t.hasOwnProperty("text")||t.hasOwnProperty("icon"))&&(o=this.collectionView.getColumnOrGroup(e))){t.hasOwnProperty("text")&&(o.text=t.text),t.hasOwnProperty("showTextFlag")&&(o.showTextFlag=t.showTextFlag),t.hasOwnProperty("icon")&&(o.icon=t.icon);var n=this.getColumnOrGroupCellCoordinates(o);this.collectionView.updateCellView(this.getCellIDFromCoordinates(n),{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}t.hasOwnProperty("editableFlag")&&((o=this.collectionView.getColumnOrGroup(e))&&(o.editableFlag=t.editableFlag),i=!0);t.hasOwnProperty("disabled")&&((o=this.collectionView.getColumnOrGroup(e))&&(o.disabled=t.disabled),i=!0);if(t.hasOwnProperty("pinned")&&this.setColumnPinned(e,t.pinned),t.hasOwnProperty("width")||t.hasOwnProperty("minWidth")){var o;if(t.hasOwnProperty("minWidth"))(o=this.collectionView.getColumnOrGroup(e))&&(o.minWidth=t.minWidth);this.setColumnWidth(e,t.width)}if(t.hasOwnProperty("typeRepresentation")&&this.setColumnTypeRepresentation(e,t.typeRepresentation),t.hasOwnProperty("visibleFlag")&&this.setColumnVisibleFlag(e,t.visibleFlag),t.hasOwnProperty("autoRowHeightFlag")&&this.setColumnAutoRowHeightFlag(e,t.autoRowHeightFlag),t.hasOwnProperty("alignment")){var l=this.getColumnIndex(e);if(l<0)return;var r=this.getLeafColumns();r[l].alignment!==t.alignment&&(r[l].alignment=t.alignment),i=!0}if(t&&t.hasOwnProperty("description")){const n=this.collectionView.getColumnOrGroup(e);n&&(n.description=t.description),i=!0}i&&this.collectionView.updateColumnView(e,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),this.collectionView.pushUpdateView()},getColumnEditableFlag:function(e){return this.getColumnOptionValue(e,"editableFlag")},getColumnEditionPolicy:function(e){return this.getColumnOptionValue(e,"editionPolicy")},getColumnDisabled:function(e){return this.getColumnOptionValue(e,"disabled")},getColumnResizableFlag:function(e){return this.getColumnOptionValue(e,"resizableFlag")},getColumnSelectableFlag:function(e){return this.getColumnOptionValue(e,"selectableFlag")},getColumnSortableFlag:function(e){return this.getColumnOptionValue(e,"sortableFlag")},getColumnFindableFlag:function(e){return this.getColumnOptionValue(e,"findableFlag")},getColumnPrintableFlag:function(e){return this.getColumnOptionValue(e,"printableFlag")},getColumnMassUpdateAllowedFlag:function(e){return this.getColumnOptionValue(e,"massUpdateAllowedFlag")},getColumnCompareFunction:function(e){return this.getColumnOptionValue(e,"compareFunction")},getColumnIcon:function(e){return this.getColumnOptionValue(e,"icon")},getColumnWidth:function(e){return this.getColumnOptionValue(e,"width")},setColumnWidth:function(e,t,i){if(isNaN(t)&&"auto"!==t)console.log("The width given for column "+e+" is not a Number");else{var n=this.getColumnIndex(e),o=this.getLeafColumns(),l=this.getColumnMinWidth(n);if(l&&"number"==typeof t&&(t=Math.max(t,l)),o[n].width!==t){o[n].width=t,"number"==typeof t?this._setColumnComputedWidth(n,t):this._computeColumnsWidth();var r=this.getColumnPinned(n);"left"!==r&&"right"!==r||this.collectionView._updateViewportDimensions(),i&&!i.isUserInteraction&&(this.getColumnAutoRowHeightFlag(n)||this.hasAutoWidthColumnWithAutoRowHeightFlag())?this.resetRowHeights():this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1}),e===this._lastLeftPinnedColumnIndex&&this.collectionView.elements.leftScroller?this.collectionView.elements.leftScroller.setPosition({x:this.getLeftContainerWidth()},!0):e===this._firstRightPinnedColumnIndex&&this.collectionView.elements.rightScroller&&this.collectionView.elements.rightScroller.setPosition({x:0},!0),"left"!==r&&"right"!==r&&this._updateAutoWidthStyle(),this.collectionView.fire("columnWidthChange",{columnID:e})}i&&i.isUserInteraction&&this._saveColumnWidthInPreferences(n)}},setColumnOrGroupWidth:function(e,t){if(!e.children||0===e.children.length){var i=this.getColumnOrGroupCellCoordinates(e);return this.setColumnWidth(i.columnID,t)}for(var n=0,o=[],l=0;l<e.children.length;l++)this._isColumnOrGroupResizable(e.children[l],t)?(n++,o.push(1)):o.push(0);if(0!==n)for(var r=(t-this.getColumnOrGroupComputedWidth(e))/n,s=0;s<o.length;s++)1===o[s]&&this.setColumnOrGroupWidth(e.children[s],this.getColumnOrGroupComputedWidth(e.children[s])+r)},_isColumnOrGroupResizable:function(e,t){if(e.children){for(var i=0;i<e.children.length;i++){var n=e.children[i];if(this._isColumnOrGroupResizable(n,t))return!0}return!1}var o=this.getColumnMinWidth(e.dataIndex);return o&&"string"==typeof o&&(o=parseFloat(o,10)),!1!==e.resizableFlag&&(!o||o<=t)},setColumnsWidth:function(e,t){for(var i=this.getLeafColumns(),n=Object.keys(e),o=[],l=!1,r=!1,s=0;s<n.length;s++){var a=n[s],d=e[a];if(isNaN(d)&&"auto"!==d)return void console.log("The width given for column "+columnID+" is not a Number");var u=this.getColumnIndex(a),h=this.getColumnMinWidth(u);if(h&&"number"==typeof d&&(d=Math.max(d,h)),i[u].width!==d){if(i[u].width=d,"number"==typeof d?this._setColumnComputedWidth(u,d):this._computeColumnsWidth(),!l){var c=this.getColumnPinned(u);"left"!==c&&"right"!==c||(l=!0)}r||!t||t.isUserInteraction||!this.getColumnAutoRowHeightFlag(u)&&!this.hasAutoWidthColumnWithAutoRowHeightFlag()||(r=!0),t&&t.isUserInteraction&&this._saveColumnWidthInPreferences(u),o.push(a)}}l&&this.collectionView._updateViewportDimensions(),this._updateAutoWidthStyle(),r?this.resetRowHeights():this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1}),this.collectionView.fire("columnWidthChange",{columnIDs:o})},_updateAutoWidthStyle:function(){this.hasAutoWidthColumn()?this.collectionView.getContent().setAttribute("has-auto-width-column",""):this.collectionView.getContent().removeAttribute("has-auto-width-column")},_setColumnComputedWidth:function(e,t){this._computedColumns[e]||(this._computedColumns[e]={}),this._computedColumns[e].width=t},getColumnComputedWidth:function(e){var t=this.getColumnIndex(e);if(-1===t)return this.rowsHeader?this.getRowHeaderWidth():0;var i=this._computedColumns[t]?this._computedColumns[t].width:0;return void 0===i||isNaN(i)?0:i},getColumnOrGroupComputedWidth:function(e){var t=0;if(e)if(e.children)for(var i=0;i<e.children.length;i++){var n=e.children[i];t+=this.getColumnOrGroupComputedWidth(n)}else t=this.getColumnComputedWidth(e.dataIndex);return t},getColumnMinWidth:function(e){return this.getColumnOptionValue(e,"minWidth")},getColumnPinned:function(e){return this.getColumnOptionValue(e,"pinned")},setColumnPinned:function(e,t,i){var n=this.getColumnIndex(e);this.setColumnOrGroupPinned(this._leafColumns[n],t,i)},setColumnOrGroupPinned:function(e,t,n){if(e&&this._isGroupInBalancedTree(e)){var o=this.getFirstLeafColumnIndex(e),l=this.getDataIndexFromColumnIndex(o);"right"!==t&&"left"!==t&&(t="unpinned");var r=this.getLeafColumns(),s=i.getLeafItems(e);if(r[o].pinned!==t){var a=this._getTopNonSplittableGroup(e);if(a)return this.setColumnOrGroupPinned(a,t,n);var d=o;if("unpinned"===t){var u=this._getUnpinnedColumnsOrderInPreferences();if(u&&"number"==typeof u[l]){var h=this._getNumberOfColumnsToTheLeft(),c=u[l]+h[t];"left"===r[o].pinned&&(c-=1),d=this._orderedColumnsIndexes[c]}else{var g=this._orderedColumnsIndexes[this._originalOrderedColumnsReverseIndexes[o]],p=this.getColumnPinned(g);if("unpinned"===p)d=g;else(m=this._getFirstOrLastUnpinnedColumnIndex(p,!0))>=0&&(p===r[o].pinned&&"left"===p?m-=1:p===r[o].pinned&&"right"===p&&(m+=1),d=this._orderedColumnsIndexes[m])}}else{var m;(m=this._getFirstOrLastUnpinnedColumnIndex(t,!0))>=0&&(d=this._orderedColumnsIndexes[m])}for(var f=0;f<s.length;f++)s[f].pinned=t;i.splitParentAtItemIndex(s[0],this._balancedColumnTree,"before"),i.splitParentAtItemIndex(s[s.length-1],this._balancedColumnTree,"after"),this.moveColumnOrGroup(e,d,n),n&&!1===n.mergeGroups||this._updateColumnTreeFromOrderedIndexes(),this._updateAutoWidthStyle(),this.collectionView._updateViewportDimensions(),this.invalidate({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})}if(n&&n.isUserInteraction){for(f=0;f<s.length;f++){var C=this.getColumnIndex(s[f].dataIndex);this._saveColumnPinnedStateInPreferences(C),this._saveColumnOrderInPreferences(C)}this._updateAllOrderInPreferences()}}else console.warn("setColumnOrGroupPinned has been called on a column or Group that does not exist in the DataGridView")},getColumnOrGroupPinned:function(e){var t;if(e)if(e.children){t=this.getColumnOrGroupPinned(e.children[0]);for(var i=1;i<e.children.length;i++)if(t!==this.getColumnOrGroupPinned(e.children[i]))return}else t=this.getColumnPinned(this.getColumnIndex(e.dataIndex));return t},getColumnAutoSizePadding:function(e){return this.getColumnOptionValue(e,"autoSizePadding")},getColumnAllowUnsafeHTMLContent:function(e){return this.getColumnOptionValue(e,"allowUnsafeHTMLContent")},getColumnShouldCellAllowUnsafeHTMLContentAt:function(e){return this.getColumnOptionValue(e,"shouldCellAllowUnsafeHTMLContentAt")},getColumnTypeRepresentation:function(e){return this.getColumnOptionValue(e,"typeRepresentation")},getColumnGetCellTypeRepresentation:function(e){return this.getColumnOptionValue(e,"getCellTypeRepresentation")},_getCellTypeRepresentation:function(e){if(e){if(e.nodeModel&&e.nodeModel.getNodeSource()===r.NODE_SOURCE.GROUPING)if("tree"===this.getDataIndexFromColumnIndex(e.columnID))return"string";var t=this.getColumnGetCellTypeRepresentation(e.columnID);return t?t.call(this.collectionView,e):void 0}},setColumnTypeRepresentation:function(e,t){var i=this.getColumnIndex(e),n=this.getLeafColumns();n[i].typeRepresentation!==t&&(n[i].typeRepresentation=t,this.getColumnAutoRowHeightFlag(e)&&this.collectionView._resetRowHeightsOnAllCellsRendered(),this.collectionView.updateColumnView(i,{updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}))},getColumnOnCellRequest:function(e){return this.getColumnOptionValue(e,"onCellRequest")},getColumnGetCellEditableState:function(e){return this.getColumnOptionValue(e,"getCellEditableState")},getColumnGetCellSelectableState:function(e){return this.getColumnOptionValue(e,"getCellSelectableState")},getColumnGetCellActivableState:function(e){return this.getColumnOptionValue(e,"getCellActivableState")},getColumnGetCellGroupingKey:function(e){return this.getColumnOptionValue(e,"getCellGroupingKey")},getColumnHasCellValue:function(e){return this.getColumnOptionValue(e,"hasCellValue")},getColumnGetCellValue:function(e){return this.getColumnOptionValue(e,"getCellValue")},getColumnSetCellValue:function(e){return this.getColumnOptionValue(e,"setCellValue")},getColumnGetCellTooltip:function(e){return this.getColumnOptionValue(e,"getCellTooltip")},getColumnGetCellIcons:function(e){return this.getColumnOptionValue(e,"getCellIcons")},getColumnGetCellSemantics:function(e){return this.getColumnOptionValue(e,"getCellSemantics")},getColumnSemantics:function(e){return this.getColumnOptionValue(e,"semantics")},getColumnGetCellKPIColor:function(e){return this.getColumnOptionValue(e,"getCellKPIColor")},getColumnClassName:function(e){return this.getColumnOptionValue(e,"className")},getColumnGetCellClassName:function(e){return this.getColumnOptionValue(e,"getCellClassName")},getColumnGetCellAttributes:function(e){return this.getColumnOptionValue(e,"getCellAttributes")},_getFirstVisibleColumnID:function(){for(var e=0;e<this._orderedColumnsIndexes.length;){if(this.getColumnVisibleState(this._orderedColumnsIndexes[e]))return this._orderedColumnsIndexes[e];e+=1}return-1},_getLastVisibleColumnID:function(){for(var e=this._orderedColumnsIndexes.length-1;e>=0;){if(this.getColumnVisibleState(this._orderedColumnsIndexes[e]))return this._orderedColumnsIndexes[e];e-=1}return-1},_getFirstOrLastUnpinnedColumnIndex:function(e,t){var i=-1;if("right"===e)for(var n=i=this._orderedColumnsIndexes.length-1;n>=0;n--){if("right"!==(o=this.getColumnPinned(this._orderedColumnsIndexes[n])))return"left"===o?t?i:-1:i;i--}else if("left"===e){i=0;for(n=0;n<this._orderedColumnsIndexes.length;n++){var o;if("left"!==(o=this.getColumnPinned(this._orderedColumnsIndexes[n])))return"right"===o?t?i:-1:i;i++}}return t?i:-1},_getNumberOfColumnsToTheLeft:function(){return{left:0,unpinned:this._getFirstOrLastUnpinnedColumnIndex("left"),right:this._getFirstOrLastUnpinnedColumnIndex("right")+1}},_getNumberOfColumnsToTheLeftFromChanges:function(e){if(e){for(var t=0,i=0,n=e.columnsPinnedState,o=this.getLeafColumns(),l=0;l<o.length;l++){var r,s=o[l].dataIndex;"left"===(r=n&&n.hasOwnProperty(s)?n[s]:this._getOriginalColumnOptionValue(s,"pinned"))?i++:"right"===r?0:t++}return{left:0,unpinned:i,right:i+t}}},getVisibleOrderedColumnsIndexes:function(){for(var e=[],t=0;t<this._orderedColumnsIndexes.length;t++)this.getColumnVisibleState(this._orderedColumnsIndexes[t])&&e.push(this._orderedColumnsIndexes[t]);return e},getDisplayedColumnsIndexes:function(){for(var e=-1,t=-1,i=this.collectionView.getViewportDimensions(),n=this.collectionView.getScrollerPosition(),o=n.x,l=n.x+i.width,r=this.getVisibleOrderedColumnsIndexes(),s=0;s<r.length;s++){var a=r[s],d=this.getColumnPinned(a);if("left"!==d&&"right"!==d){var u=this.getColumnPosition(a);if(u<=o&&(e=a),!(u<l))break;t=a}}var h=[];if(e>=0&&t>=0)for(var c=!0,g=e;g>=0&&c;){if(h.push(g),g===t){c=!1;break}g=this._getNextVisibleColumnID(g)}return this._getListOfVisiblePinnedColumnIDs("left").concat(h).concat(this._getListOfVisiblePinnedColumnIDs("right"))},_getNumberOfInvisibleColumnsBetween:function(e,t){for(var i=Math.min(e,t),n=Math.max(e,t),o=0,l=i+1;l<n;l++)this.getColumnVisibleState(this._orderedColumnsIndexes[l])||o++;return o},_getPreviousVisibleColumnID:function(e){if(-1===e)return-1;var t=this._orderedColumnsReverseIndexes[e];if(void 0===t||0===t)return-1;for(var i=t-1;i>=0;){if(this.getColumnVisibleState(this._orderedColumnsIndexes[i]))return this._orderedColumnsIndexes[i];i-=1}return-1},_getPreviousVisibleGroupOrColumnID:function(e,t){if(e>=-1)return this._getPreviousVisibleColumnID(t);for(var i=this.getColumnOrGroupFromCoordinates({rowID:e,columnID:t}),n=0;n<this._columnItemsByDepth.length;n++)for(var o,l=this._columnItemsByDepth[n],r=0;r<l.length;r++){if(l[r]===i)return o?this.getColumnOrGroupCellCoordinates(o).columnID:void 0;o=l[r]}},_getNextVisibleColumnID:function(e){var t=this.getColumnIndex(e);if(-1===t)return-1;var i=this._orderedColumnsReverseIndexes[t];if(void 0===i||i===this._orderedColumnsIndexes.length-1)return-1;for(var n=i+1;n<this._orderedColumnsIndexes.length;){if(this.getColumnVisibleState(this._orderedColumnsIndexes[n]))return this._orderedColumnsIndexes[n];n+=1}return-1},_getNextVisibleGroupOrColumnID:function(e,t){if(e>=-1)return this._getNextVisibleColumnID(t);for(var i=this.getColumnOrGroupFromCoordinates({rowID:e,columnID:t}),n=0;n<this._columnItemsByDepth.length;n++)for(var o,l=this._columnItemsByDepth[n],r=l.length-1;r>=0;r--){if(l[r]===i)return o?this.getColumnOrGroupCellCoordinates(o).columnID:void 0;o=l[r]}},_getListOfVisiblePinnedColumnIDs:function(e){for(var t=[],i="left"===e?this._getFirstVisibleColumnID():this._getLastVisibleColumnID(),n="left"===e?this._getNextVisibleColumnID:this._getPreviousVisibleColumnID;i>=0;){if(this.getColumnPinned(i)!==e)return t;t.push(i),i=n.call(this,i)}return t},_getLeafColumnsCount:function(e){if(e){if(e.children){for(var t=0,i=0;i<e.children.length;i++)t+=this._getLeafColumnsCount(e.children[i]);return t}return 1}return this._leafColumnsCount},_getLeafChildrenFromGroup:function(e){if(!e)return[];let t=[],i=this.getLeafColumns();if(e.children)for(let i=0;i<e.children.length;i++)t=t.concat(this._getLeafChildrenFromGroup(e.children[i]));else i.indexOf(e)>-1&&t.push(e);return t},_getColumnTreeItemCount:function(){return this._columnTreeItemCount},_getColumnHeaderCellCount:function(){return this._columnHeaderCellCount},getRowHeaderWidth:function(){var e=this.collectionView._getCurrentTouchMode(),t=this._cachedRowHeaderStringWidth?this._cachedRowHeaderStringWidth:10,i=this.collectionView.showSelectionCheckBoxesFlag;if(this.collectionView.showRowIndexFlag){if(this.isValid()&&this.collectionView.getModelLength()>0){var n=this.getMinMaxVisibleRowIDs();if(n){var l=this.collectionView.getCellInfosAt(this.getCellIDFromCoordinates({rowID:n.maxRowID,columnID:-1}));if(l){var r=12;e&&(r=14);var s=5;e&&(s=10),t=s+Math.ceil(o.computeStringWidth(l.cellModel,r,"Arial",!1,!1))+s}}this._cachedRowHeaderStringWidth=t}i&&(e||"OnOver"!==i)&&(t+=18)}else i&&(t=e?40:30);if(this.collectionView.showNodeKPIColorFlag&&(t+=6),this.collectionView.rowDragEnabledFlag&&(t+=e?16:12),i){var a=this.collectionView.rowDragEnabledFlag?34:24;t=Math.max(t,a)}return t},_getXSORectangularShape:function(){var e=this.collectionView.getCellsXSO();if(!e.isEmpty()){for(var t,i,n,o,l,r,s=e.get(),a=0;a<s.length;a++){var d=s[a];if(d){var u={rowID:d.rowID,columnID:this.getColumnIndex(d.columnDataIndex)};if(void 0===t)o=this._orderedColumnsReverseIndexes[u.columnID],i=this._orderedColumnsReverseIndexes[u.columnID],l=u.columnID,r=u.columnID,n=u.rowID,t=u.rowID;else{var h=this._orderedColumnsReverseIndexes[u.columnID];h>o&&(o=h,l=u.columnID),h<i&&(i=h,r=u.columnID),u.rowID>n&&(n=u.rowID),u.rowID<t&&(t=u.rowID)}}}return(o+1-i-this._getNumberOfInvisibleColumnsBetween(r,l))*(n+1-t)===s.length?{minColumnID:r,width:o-i+1-this._getNumberOfInvisibleColumnsBetween(r,l),minRowID:t,height:n-t+1}:void 0}},getDataIndexFromColumnIndex:function(e){var t=this.getLeafColumns();return e>=0&&e<t.length?t[e].dataIndex:"rowHeader"},getColumnIndex:function(e){if(null!=e){let t=-1;return"string"==typeof e?(this._columnsReverseIndexes||this._computeColumnsReverseIndexes(),t=this._columnsReverseIndexes[e]):t=e,t}},getColumnIdentifiers:function(e){var t,i;return"string"==typeof e?(i=e,t=this.getColumnIndex(e)):"object"==typeof e?(i=e.dataIndex?e.dataIndex:this.getDataIndexFromColumnIndex(e.columnIndex),t=e.columnIndex?e.columnIndex:this.getColumnIndex(e.dataIndex)):(t=e,i=this.getDataIndexFromColumnIndex(e)),{dataIndex:i,columnIndex:t}},getRowHeightFromCellHeight:function(){var e=this.getDefaultCellHeight();return Math.max(this.cellHeight,e)},getRowHeightFromCellContents:function(e){let t=this.getRowHeightFromCellHeight(),i=e>=0?this._autoRowHeightColumnIndexes:this._autoHeaderHeightColumnIndexes;if(i)for(var n=0;n<i.length;n++){var o=i[n];if(this.getColumnVisibleState(o)){let i=this._computeRenderedCellHeight(e,o);t<i&&(t=i)}}return t},_computeRenderedCellHeight:function(e,t){return this.__computeRenderedCellDimension(e,t,"height")},_computeRenderedHeaderMinWidth:function(e){return this.__computeRenderedCellDimension(-1,e,"minWidth")},__computeRenderedCellDimension:function(e,t,i){let n=0;var o=this.getCellIDFromCoordinates({rowID:e,columnID:t}),l=!1,r=this.collectionView._getRenderedCellAt(o);if(r||(r=this.collectionView._renderCell(o,{updateCellContent:!1,updateCellLayout:"ignore",updateCellAttributes:!1}),l=!0),r&&r.component){var s=r.component.getReusableContent();if(s){const o=r.component.getContent().style,l=o.width,a=this.getColumnComputedWidth(t);o.width=a+"px";const d=o.height,u=o.lineHeight,h=o.display;o.height="",o.lineHeight="",("tree"!==this.getDataIndexFromColumnIndex(t)||e<0)&&(o.display="block"),o.overflow="visible";let c=s;if(s.getContent&&(c=s.getContent()),"height"===i){const t=r.component.getContent().offsetHeight;let i=c.offsetHeight,o=c.querySelector("textarea");o&&(i=o.scrollHeight+2),i!==t&&-1!==e&&(i+=2),n=i}else"minWidth"===i&&(n=parseInt(window.getComputedStyle(c,null).getPropertyValue("min-width"),10));o.width=l,o.display=h,o.height=d,o.lineHeight=u}else if("height"===i){var a=this.collectionView.getCellInfosAt(o);this.collectionView.hasCellValue(a)&&this.collectionView._resetRowHeightsOnAllCellsRendered()}l&&this.collectionView._freeUpCell(o,1)}return n},getRowSpacing:function(){return this.rowSpacing},getDefaultRowHeight:function(){return this.getRowHeightFromCellHeight()},getRowPosition:function(e){if(e<0){let t=0;for(let i=-this._getColumnTreeDepth();i<e;i++)t+=this._computeColumnHeadersHeight(i);return t}return this._parent(e)},_computeColumnHeadersHeight:function(e){if(-1!==e||!this._autoHeaderHeightColumnIndexes.length)return this.getColumnHeaderHeight();if(!this._computedHeadersHeights)throw"_computedHeadersHeights not defined on DataGridViewLayout";let t=this._computedHeadersHeights.get(e);if(null==t){let o=this.getColumnHeaderHeight();var i=0;if("function"==typeof this.getRowHeightFunction){var n=this.getRowHeightFunction(e);i=void 0!==n?n:o}t=i||o,this.collectionView._initialized&&this._computedHeadersHeights.set(e,t)}return t},_getEstimatedVirtualHeight:function(e){var t=0,i=this.collectionView.getModelLength();if(0===i)return t=1;var n=this.rowSpacing;if(this._useVariableRowHeight&&(!e||!this._autoRowHeightColumnIndexes||0===this._autoRowHeightColumnIndexes.length||this._computedRows[i-1]&&void 0!==this._computedRows[i-1].top)){for(var o=-1,l=this._computedRows.length-1;l>=0;l--)if(void 0!==this._computedRows[l].top&&void 0!==this._computedRows[l].height){o=l;break}var r=0,s=0;o>=0?(r=this._computedRows[o].top+this._computedRows[o].height+(this.collectionView.showRowBorderFlag?1:0),s=parseInt(r/(o+1))):s=this.getRowHeight()+n,t=r+(i-(o+1)==0?0:(i-(o+1))*s-n)}else{var a=this._getNumberOfItems();t=a*this.getRowHeight()+(a-1)*n}return t},_getNumberOfItems:function(){return this.collectionView.paginationManager?this.collectionView.paginationManager.getNumberOfItemsOnPage():this.collectionView.getRowModelLength()},getCellCoordinatesAt:function(e){var t=-1,i=-1,n=this.rowsHeader,o=(this.columnsHeader,this._getFirstCellIDInScroller());if(e<o)if(e<0)t=-this._columnItemsByDepth.length-1,i=-4-(n?1:0);else{t=-this._columnItemsByDepth.length;var l=3+(n?1:0);if(e<l)i=e-l;else for(var r=0,s=0;s<this._columnItemsByDepth.length;s++){var a=this._columnItemsByDepth[s];if(e<r+a.length+l){i=e-r-l;break}t++,r+=a.length}}else{var d=this._getNumberOfColumns();t=Math.floor((e-o)/d),i=(e-o)%d-3-(n?1:0)}return{rowID:t,columnID:i}},getCellIDFromCoordinates:function(e){var i=-1,n=this.rowsHeader;if(e.columnID=this.getColumnIndex(e.columnID),!t.isUndefinedNullNaN(e.columnID)&&!t.isUndefinedNullNaN(e.rowID)){if(e.rowID<0)if(e.columnID<0)i=e.rowID<-this._columnItemsByDepth.length?-1:e.columnID+3+(n?1:0);else{for(var o=3+(n?1:0),l=0,r=0;r<=this._columnItemsByDepth.length+e.rowID;r++){var s=this._columnItemsByDepth[r];r<this._columnItemsByDepth.length+e.rowID?l+=s.length:l+=e.columnID}i=o+l}else{var a=this._getNumberOfColumns();i=this._getFirstCellIDInScroller()+a*e.rowID+e.columnID+3+(n?1:0)}return i<-1&&(i=-1),i}},getColumnOrGroupFromCoordinates:function(e){var t=null;if(-1===e.rowID)t=this._leafColumns[e.columnID];else{var i=this._columnItemsByDepth[this._columnItemsByDepth.length+e.rowID];i&&(t=i[e.columnID])}return t},getColumnOrGroupCellCoordinates:function(e){var t=-1,n=-1;if(e&&this._balancedColumnTree){var o=i.computeFirstBranchDepth(e);if(o>1){var l=this._getColumnTreeDepth(),r=this._columnItemsByDepth[l-o];if(r)for(var s=0;s<r.length;s++)if(r[s]===e){t=-o,n=s;break}}else t=-1,n=this.getColumnIndex(e.dataIndex)}return{rowID:t,columnID:n}},getFirstLeafColumnIndex:function(e,t){var i=-1;if(e)if(e.children){var n=null;if(t)for(var o=0;o<e.children.length;o++){var l=e.children[o];if(l&&this.getColumnOrGroupVisibleState(l)){n=l;break}}else n=e.children[0];n&&(i=this.getFirstLeafColumnIndex(n,t))}else i=this.getColumnIndex(e.dataIndex);return i},getLastLeafColumnIndex:function(e,t){var i=-1;if(e)if(e.children){var n=null;if(t)for(var o=e.children.length-1;o>=0;o--){var l=e.children[o];if(l&&this.getColumnOrGroupVisibleState(l)){n=l;break}}else n=e.children[e.children.length-1];n&&(i=this.getLastLeafColumnIndex(n,t))}else i=this.getColumnIndex(e.dataIndex);return i},isRow:function(e){var t=this.getCellCoordinatesAt(e);return t.columnID===this._leftPinnedRowColumnID||t.columnID===this._unpinnedRowColumnID||t.columnID===this._rightPinnedRowColumnID},getContentDimensions:function(){for(var e=this._getEstimatedVirtualHeight(),t=0,i=this.getLeafColumns(),n=0;n<i.length;n++){var o=this.getColumnPinned(n);if("left"!==o&&"right"!==o)this.getColumnVisibleState(n)&&(t+=this.getColumnComputedWidth(n))}return{width:t,height:e}},getLayoutStylesForCellAt:function(e){var t={},i=this.getCellCoordinatesAt(e),n=i.columnID===this._leftPinnedRowColumnID||i.columnID===this._unpinnedRowColumnID||i.columnID===this._rightPinnedRowColumnID,o=this.collectionView.showRowBorderFlag?1:0,l=this.getDefaultCellHeight();if(n){var r=this.getRowHeight(i.rowID);r!==l+o&&(t.height=r+"px");var s=this.getRowPosition(i.rowID);t.transform="translateY("+s+"px)"}else{var a=0;if(i.columnID>-1){var d=this.getColumnOrGroupFromCoordinates(i);a=d?this.getColumnOrGroupPosition(d):this.getColumnPosition(i.columnID)}var u=this.getDimensionsForCellAt(e);t.width=u.width+"px";var h=-1===i.columnID?l+o:l;if(u.height!==h){var c=u.height+"px";t.height=c;var g=u.height-2;i.rowID<=-1&&(g+=1),t.lineHeight=g+"px"}if(i.columnID>=0&&i.rowID>=0)t.left=a+"px";else{s=this.getRowPosition(i.rowID);t.transform="translate3d("+a+"px,"+s+"px,0)"}}return t},getLayoutAttributesForCellAt:function(e){var t,i=this.getCellCoordinatesAt(e),n=this.getColumnOrGroupFromCoordinates(i),o=i.columnID===this._leftPinnedRowColumnID||i.columnID===this._unpinnedRowColumnID||i.columnID===this._rightPinnedRowColumnID,l={"cell-id":e},r=!1;if(this.addCellCoordinates?r=!0:window.__karma__&&window.__karma__.config&&window.__karma__.config.json?r=window.__karma__.config.json.ADD_CELL_COORDINATES:!window.__karma__&&navigator.webdriver&&(r=!0),r&&(l["row-id"]=i.rowID,l["column-id"]=i.columnID),this.rowsHeader&&-1===i.columnID&&(l["row-header"]=""),!o){if(i.rowID<=-1){l["column-header"]="";var s=n?this.getFirstLeafColumnIndex(n,!0):i.columnID;s!==this._firstUnpinnedColumnIndex&&s!==this._firstLeftPinnedColumnIndex&&s!==this._firstRightPinnedColumnIndex||(l["first-column"]="")}if(i.rowID<=-1||this.collectionView.showColumnBorderFlag){var a=n?this.getLastLeafColumnIndex(n,!0):i.columnID;a!==this._lastUnpinnedColumnIndex&&a!==this._lastLeftPinnedColumnIndex&&a!==this._lastRightPinnedColumnIndex||(l["last-column"]="")}this.getColumnAutoRowHeightFlag(i.columnID)&&(l["auto-height"]="")}return"left"!==(t=i.columnID===this._leftPinnedRowColumnID?"left":i.columnID===this._rightPinnedRowColumnID?"right":-1===i.columnID?"left":n?this.getColumnOrGroupPinned(n):this.getColumnPinned(i.columnID))&&"right"!==t||(l.pinned=t),o&&(i.rowID%2==0?l["even-row"]="":l["odd-row"]=""),l},_getFirstCellIDInScroller:function(){return this.columnsHeader?this._getColumnHeaderCellCount():0},_getNumberOfColumns:function(){return this._getLeafColumnsCount()+3},_getLastCellIDInScroller:function(){return this._getNumberOfItems()*this._getNumberOfColumns()-1},renderListOfVisibleCellsInViewport:function(e){if(e&&e.render){var i=this.collectionView;if(i&&i.elements&&i.elements.container){var n,l=!1;e.allottedTime>0&&(n=window.performance?performance.now():Date.now());var r=this.getMinMaxVisibleCellIDs(),s=this.getCellCoordinatesAt(r.minCellID),a=this.getCellCoordinatesAt(r.maxCellID),d=this.columnsHeader,u=this.rowsHeader,h=this._getFirstCellIDInScroller();0,i._listOfRenderedCells.forEach(function(e,t){if(t<r.minCellID&&t>=h||t>r.maxCellID){var n=e&&e.component?e.component.getCleaningMode():1;if(i._freeUpCell(t,n),e&&e.component&&e.component.isRow()){var l=e.component;o.empty(l.getContent())}}});for(var c=void 0!==this._firstLeftPinnedColumnIndex,g=void 0!==this._firstRightPinnedColumnIndex,p=s.rowID,m=a.rowID,f=p;f<=m;f++){if(c){var C=this.getCellIDFromCoordinates({rowID:f,columnID:this._leftPinnedRowColumnID});e.render(C,{cellType:f%2==0?"__left_even_row__":"__left_odd_row__"})}if(g){C=this.getCellIDFromCoordinates({rowID:f,columnID:this._rightPinnedRowColumnID});e.render(C,{cellType:f%2==0?"__right_even_row__":"__right_odd_row__"})}C=this.getCellIDFromCoordinates({rowID:f,columnID:this._unpinnedRowColumnID});e.render(C,{cellType:f%2==0?"__even_row__":"__odd_row__"})}if(d){u&&e.render(3,{cellType:"__topleft_row_header__"});var _=3+(this.rowsHeader?1:0),w=this.collectionView.getViewportDimensions(),v=this.collectionView.getScrollerPosition(),D=v.x,I=v.x+w.width;for(f=0;f<this._columnItemsByDepth.length;f++)for(var V=this._columnItemsByDepth[f],y=0;y<V.length;y++){var b;if(b=f===this._columnItemsByDepth.length-1?this._leafColumns[y]:V[y],this.getColumnOrGroupVisibleState(b)){var M=!1;if((c||g)&&("left"!==(j=this.getColumnOrGroupPinned(b))&&"right"!==j||(M=!0)),!M){var x=this.getColumnOrGroupPosition(b);x+this.getColumnOrGroupComputedWidth(b)>=D&&x<I&&(M=!0)}if(M)B="left"===j?"__topleft_item__":"right"===j?"__topright_item__":"__top_item__",e.render(_,{cellType:B})}_++}}if(u){for(var S=[],F=p;F<=m;F++){_=this.getCellIDFromCoordinates({rowID:F,columnID:-1});(z=e.render(_,{cellType:"__row_header__"}))&&z.component&&!z.component.getContent().parentNode&&S.push(z.component.getContent())}S.length>0&&t.appendToParent(i.elements.rowHeaderExtensionPoolContainer,S)}var R=this.getDisplayedColumnsIndexes(),O=[],P=[],A=[],N=[],G=[],E=[];for(F=p;F<=m;F++){var T,L,k=i._getViewAt(this.getCellIDFromCoordinates({rowID:F,columnID:this._unpinnedRowColumnID}));if(c&&(T=i._getViewAt(this.getCellIDFromCoordinates({rowID:F,columnID:this._leftPinnedRowColumnID}))),g&&(L=i._getViewAt(this.getCellIDFromCoordinates({rowID:F,columnID:this._rightPinnedRowColumnID}))),!e.lightRendering&&!l){if(e.allottedTime>0)(window.performance?performance.now():Date.now())-n>e.allottedTime&&(l=!0);if(!l){k&&(k.getContent().hasChildNodes()||k.getContent().remove()),T&&(T.getContent().hasChildNodes()||T.getContent().remove()),L&&(L.getContent().hasChildNodes()||L.getContent().remove());for(var U=0;U<R.length;U++){var H=R[U];if(H>-1){_=this.getCellIDFromCoordinates({rowID:F,columnID:H});var B,W,q,j=this.getColumnPinned(H);B="tree"===this.getDataIndexFromColumnIndex(H)?"__tree_item__":"__item__","left"===j?(W=T,q=G):"right"===j?(W=L,q=E):(W=k,q=N);var X=W&&"function"==typeof W.getCellPool?W.getCellPool():void 0,z=e.render(_,{cellType:B,cellPool:X});q&&z&&z.component&&z.component.getContent().parentNode!==W.getContent()&&q.push(z.component.getContent())}}k&&N.length>0&&(t.appendToParent(k.getContent(),N),N=[]),T&&G.length>0&&(t.appendToParent(T.getContent(),G),G=[]),L&&E.length>0&&(t.appendToParent(L.getContent(),E),E=[])}}O&&k&&!k.getContent().parentNode&&O.push(k.getContent()),P&&T&&!T.getContent().parentNode&&P.push(T.getContent()),A&&L&&!L.getContent().parentNode&&A.push(L.getContent())}return O.length>0&&t.appendToParent(i.elements.poolContainer,O),P.length>0&&t.appendToParent(i.elements.leftPoolContainer,P),A.length>0&&t.appendToParent(i.elements.rightPoolContainer,A),{taskInterrupted:l}}}},getCellType:function(e){var t,i=this.getCellCoordinatesAt(e);if(i.columnID>-1){var n=this.getColumnOrGroupFromCoordinates(i);t=n?this.getColumnOrGroupPinned(n):this.getColumnPinned(i.columnID)}var o=i.rowID%2==0;if(i.rowID<=-1)return-1===i.columnID?"__topleft_row_header__":"left"===t?"__topleft_item__":"right"===t?"__topright_item__":"__top_item__";if(i.columnID===this._leftPinnedRowColumnID)return o?"__left_even_row__":"__left_odd_row__";if(i.columnID===this._unpinnedRowColumnID)return o?"__even_row__":"__odd_row__";if(i.columnID===this._rightPinnedRowColumnID)return o?"__right_even_row__":"__right_odd_row__";if(-1===i.columnID)return"__row_header__";var l=this.getLeafColumns();return l[i.columnID]&&"tree"===l[i.columnID].dataIndex?"left"===t?"__left_tree_item__":"right"===t?"__right_tree_item__":"__tree_item__":"left"===t?"__left_item__":"right"===t?"__right_item__":"__item__"},getColumnHeaderHeight:function(e){if(void 0===e){var t=this.collectionView._getCurrentTouchMode()?40:26;return Math.max(this.columnHeaderHeight,t+1)}return this._computeColumnHeadersHeight(e)},getHeaderContainerHeight:function(){let e=0;for(let t=-this._getColumnTreeDepth();t<0;t++)e+=this._computeColumnHeadersHeight(t);return this.columnsHeader?e:0},getLeftContainerWidth:function(){for(var e=0,t=this.getLeafColumns(),i=0;i<t.length;i++){if("left"===this.getColumnPinned(i))this.getColumnVisibleState(i)&&(e+=this.getColumnComputedWidth(i))}return e},getRightContainerWidth:function(){for(var e=0,t=this.getLeafColumns(),i=0;i<t.length;i++){if("right"===this.getColumnPinned(i))this.getColumnVisibleState(i)&&(e+=this.getColumnComputedWidth(i))}return e},computeCenterContainerSideMargin:function(e,t,i){var n;if("left"===e){var o=this.rowsHeader?this.getRowHeaderWidth():0;n=(l=t+o)>i+o?i+o:l}else if("right"===e){var l;n=(l=t)>i?i:l}return n},computeSideContainerMaxWidth:function(e,t,i,n){var o=this.rowsHeader?this.getRowHeaderWidth():0;return this._parent(e,t-o,i,n)},computeCenterContainerMinWidth:function(e,t,i){var n=this.rowsHeader?this.getRowHeaderWidth():0;return this._parent(e,t,i-n)},computeSideContainerWidth:function(e,t,i){var n=0;if("left"===e){const e=i||1;n=t+(t?e:0)}else"right"===e&&(n=this._parent(e,t,i));return n},getPositionForCellAt:function(e){var t={top:0,left:0},i=this.getCellCoordinatesAt(e);if(t.top=this.getRowPosition(i.rowID),i.columnID>-1){var n=this.getColumnOrGroupFromCoordinates(i);t.left=n?this.getColumnOrGroupPosition(n):this.getColumnPosition(i.columnID)}return t},getCellIDFromPositionInView:function(e){var t=-1;if(e){var i=this.getHeaderContainerHeight();if(e.top>=i){var n=this._getRowIDFromPosition(e.top-i);if(n<this.collectionView.getModelLength()){var o=this.collectionView.getViewportDimensions(),l=this.rowsHeader?this.getRowHeaderWidth():0,r=this.getLeftContainerWidth(),s=(this.getRightContainerWidth(),0),a="unpinned";e.left<=l+r?(a="left",s=l):e.left>=l+r+o.width?(a="right",s=l+r+o.width):s=l+r;var d=-1;if(e.left>=s)for(var u=0;u<this._orderedColumnsIndexes.length;u++){var h=this._orderedColumnsIndexes[u],c=this.getColumnVisibleState(h),g=this.getColumnPinned(h);if(c&&g===a&&(s+=this.getColumnComputedWidth(h),e.left<=s)){d=h;break}}n>=0&&d>=0&&(t=this.getCellIDFromCoordinates({rowID:n,columnID:d}))}}}return t},getDimensionsForCellAt:function(e){var t=this.getCellCoordinatesAt(e),i=t.columnID===this._leftPinnedRowColumnID||t.columnID===this._unpinnedRowColumnID||t.columnID===this._rightPinnedRowColumnID,n=0;if(t.columnID>=-1){var o=this.getColumnOrGroupFromCoordinates(t);n=o?this.getColumnOrGroupComputedWidth(o):this.getColumnComputedWidth(t.columnID)}else if(t.columnID===this._leftPinnedRowColumnID)n=this.collectionView._leftContainerWidth;else if(t.columnID===this._unpinnedRowColumnID){n=this.collectionView.getViewportDimensions().width}else t.columnID===this._rightPinnedRowColumnID&&(n=this.collectionView._rightContainerWidth);var l,r=this.getRowHeight(t.rowID);if(i)l=r;else if(t.rowID<=-1)l=-1===t.columnID?this.getHeaderContainerHeight():this.getColumnHeaderHeight(t.rowID);else if(-1===t.columnID)l=r;else{l=r-(this.collectionView.showRowBorderFlag?1:0)}return{width:n,height:l}},computeCellRange:function(e,t){var i=[],n=this.getCellCoordinatesAt(e),o=this.getCellCoordinatesAt(t);n.columnID<0&&(n.columnID=0),o.columnID<0&&(o.columnID=0);var l=this._orderedColumnsReverseIndexes[n.columnID],r=this._orderedColumnsReverseIndexes[o.columnID];if(void 0!==l&&void 0!==r){for(var s=Math.min(l,r),a=Math.max(l,r),d=Math.min(n.rowID,o.rowID),u=Math.max(n.rowID,o.rowID),h=d;h<=u;h++)for(var c=s;c<=a;c++){var g=this._orderedColumnsIndexes[c];if(this.getColumnVisibleState(g)){var p=this.getCellIDFromCoordinates({rowID:h,columnID:g});i.push(p)}}return i}},isCellInRange:function(e,t,i){var n=!1,o=this.getCellCoordinatesAt(e),l=this.getCellCoordinatesAt(t),r=this.getCellCoordinatesAt(i),s=Math.min(l.rowID,r.rowID),a=Math.max(l.rowID,r.rowID);if(o.rowID>=s&&o.rowID<=a){var d=this._compareColumnIDs(l.columnID,r.columnID)<0?l.columnID:r.columnID,u=d===l.columnID?r.columnID:l.columnID;this._compareColumnIDs(o.columnID,d)>=0&&this._compareColumnIDs(o.columnID,u)<=0&&(n=!0)}return n},isNodeModelInRange:function(e,t,i){var n=!1;if(e){var o=e._getRowID(),l=this.getCellCoordinatesAt(t),r=this.getCellCoordinatesAt(i),s=Math.min(l.rowID,r.rowID),a=Math.max(l.rowID,r.rowID);n=o>=s&&o<=a}return n},getCellsFromNodeModel:function(e,t){var i=[];if(e){var n=e._getRowID();if(t){var o=this.getVisibleOrderedColumnsIndexes();for(r=0;r<o.length;r++)i.push(this.getCellIDFromCoordinates({rowID:n,columnID:o[r]}))}else for(var l=this.getLeafColumns().length,r=0;r<l;r++)i.push(this.getCellIDFromCoordinates({rowID:n,columnID:r}))}return i},_compareColumnIDs:function(e,t){var i=this.getColumnPinned(e),n=this.getColumnPinned(t);if(i===n){var o=this.getColumnIdentifiers(e),l=this.getColumnIdentifiers(t);return o.columnIndex===l.columnIndex?0:o.columnIndex<l.columnIndex?-1:1}return"left"===i?-1:"right"===i?1:"left"===n?1:-1},_computeCellIDFromCell:function(e,t,i,n){var o=e,l=this.getCellCoordinatesAt(e);if(l.rowID>=0&&l.columnID>=0){var r=-1,s=-1;if("up"===t)r=l.rowID>0?l.rowID-1:l.rowID,s=l.columnID;else if("right"===t)r=l.rowID,s="row"===this.collectionView.cellActivationFeedback?this.getColumnIndex("tree"):this._getNextVisibleColumnID(l.columnID);else if("down"===t)r=l.rowID<this.collectionView.getModelLength()-1?l.rowID+1:l.rowID,s=l.columnID;else if("left"===t)r=l.rowID,s="row"===this.collectionView.cellActivationFeedback?this.getColumnIndex("tree"):this._getPreviousVisibleColumnID(l.columnID);else if("tab"===t){if(n?(r=l.rowID,(s=this._getPreviousVisibleColumnID(l.columnID))<0&&r>0&&(r--,s=this._getLastVisibleColumnID())):(r=l.rowID,(s=this._getNextVisibleColumnID(l.columnID))<0&&r<this.collectionView.getModelLength()-1&&(r++,s=this._getFirstVisibleColumnID())),this.collectionView.focusNextEditableCellOnTabFlag){var a=this.getCellIDFromCoordinates({rowID:r,columnID:s});if(!this.collectionView.getCellEditableState(a))for(;;){var d=a;if((a=this._computeCellIDFromCell(a,t,i,n))===d){r=-1,s=-1;break}if(this.collectionView.getCellEditableState(a)){var u=this.getCellCoordinatesAt(a);r=u.rowID,s=u.columnID;break}}}}else if("pageup"===t){this.collectionView.getViewportDimensions();var h=(c=this.getMinMaxVisibleRowIDs()).maxRowID-c.minRowID;r=Math.max(0,l.rowID-h),s=l.columnID}else if("pagedown"===t){var c;this.collectionView.getViewportDimensions(),h=(c=this.getMinMaxVisibleRowIDs()).maxRowID-c.minRowID;r=Math.min(this.collectionView.getModelLength()-1,l.rowID+h),s=l.columnID}else if("home"===t)if(r=i||"row"===this.collectionView.cellActivationFeedback?0:l.rowID,"row"===this.collectionView.cellActivationFeedback){const e=this._getRowFirstVisibleCellWithActivableState(r);s=this.getCellCoordinatesAt(e).columnID}else s=this._getFirstVisibleColumnID();else if("end"===t)if(r=i||"row"===this.collectionView.cellActivationFeedback?this.collectionView.getModelLength()-1:l.rowID,"row"===this.collectionView.cellActivationFeedback){const e=this._getRowFirstVisibleCellWithActivableState(r);s=this.getCellCoordinatesAt(e).columnID}else s=this._getLastVisibleColumnID();else"enter"===t&&(r=l.rowID,s=l.columnID,this.collectionView.selectNextCellOnEnterFlag&&(n?r>0&&r--:r<this.collectionView.getModelLength()-1&&r++));r>=0&&s>=0&&(o=this.getCellIDFromCoordinates({rowID:r,columnID:s}))}return o},_hasValidIdentifier:function(){if(""!==this.identifier){var e=Math.floor(Number(this.identifier));return e<0||String(e)!==this.identifier}return!1},exportPreferencesInJson:function(e){return e&&e.onlyCustomViewsFlag?JSON.stringify({customViews:this._getDataFromPreferences("customViews")}):JSON.stringify(this._getDataFromPreferences(void 0))},importJsonPreferences:function(e,t){if(!e&&"string"!=typeof e)return;t||(t={importOnlyCustomViews:!1,importCurrentCustomViewId:!1});let i=JSON.parse(e);t.importOnlyCustomViews?(this.collectionView.getCustomViewsManager().addCustomView(i.customViews),this._saveDataInPreferences("customViews",this.collectionView.getCustomViewsManager()._customViews)):Object.keys(i).forEach(e=>{"customViews"===e?(this.collectionView.getCustomViewsManager().addCustomView(i.customViews),this._saveDataInPreferences("customViews",this.collectionView.getCustomViewsManager()._customViews)):(t.importCurrentCustomViewId||"currentCustomViewId"!==e)&&this._saveDataInPreferences(e,i[e])}),this._applyPreferencesOnColumns()},_getDataFromPreferences:function(e){var i=void 0;return this._hasValidIdentifier()&&(i=t.getDataInPreferences(this.collectionView,this._dataGridViewPrefKey,e,this.collectionView.useWidgetPreferencesFlag)),i},_saveDataInPreferences:function(e,i){this._hasValidIdentifier()&&(t.saveDataInPreferences(this.collectionView,this._dataGridViewPrefKey,e,i,!!this.collectionView&&this.collectionView.useWidgetPreferencesFlag),this.collectionView&&this.collectionView.fire("userPreferencesChange"))},_saveColumnOptionValueInPreferences:function(e,t,i){var n=this._getDataFromPreferences(i);n||(n={});var o=this.getColumnIdentifiers(e);n[o.dataIndex]=this.getColumnOptionValue(o.columnIndex,t),this._saveDataInPreferences(i,n)},_saveParentColumnGroupsExpandedStateInPreferences:function(e){e&&(void 0!==e.columnGroupShow&&this._saveColumnGroupExpandedStateInPreferences(e),this._saveColumnGroupExpandedStateInPreferences(e._parent))},_saveColumnGroupExpandedStateInPreferences:function(e){if(e){var t=e.expandedFlag;if(void 0!==t){var i=this._getColumnGroupIndexInItsRow(e);if(-1!==i){var n="columnGroupsExpandedStates",o=e.dataIndex+"_"+i,l=this._getDataFromPreferences(n);l||(l={}),l[o]=t?1:0,this._saveDataInPreferences(n,l)}}}},_updateColumnGroupExpandedStateInPreferences:function(e,t){for(var i="columnGroupsExpandedStates",n=0;n<e.numberOfDataIndexOccurences.length;n++)if(!(0===e.childrenCount&&0===t.childrenCount&&e.childrenCountInParent>1&&t.childrenCountInParent>1))if(e.numberOfDataIndexOccurences[n]<t.numberOfDataIndexOccurences[n]){(s=this._getDataFromPreferences(i))||(s={});for(var o=t.columnGroupDataIndexes[n],l=t.numberOfDataIndexOccurences[n]-1;l>=t.indexInParent[n];l--){if(void 0!==s[c=o+"_"+l.toString()]){var r=s[c];delete s[c],s[h=o+"_"+(l+1).toString()]=r,this._saveDataInPreferences(i,s)}}}else if(e.numberOfDataIndexOccurences[n]>t.numberOfDataIndexOccurences[n]){(s=this._getDataFromPreferences(i))||(s={});for(o=t.columnGroupDataIndexes[n],l=t.indexInParent[n];l<e.numberOfDataIndexOccurences[n];l++){if(void 0!==s[c=o+"_"+l.toString()]){r=s[c];delete s[c],s[h=o+"_"+(l-1).toString()]=r,this._saveDataInPreferences(i,s)}}}else{var s;(s=this._getDataFromPreferences(i))||(s={});var a=[],d=[],u=[];o=t.columnGroupDataIndexes[n];if(t.indexInParent[n]>e.indexInParent[n])for(l=t.indexInParent[n];l>=e.indexInParent[n];l--){if(void 0!==(r=s[c=o+"_"+(e.indexInParent[n]+t.indexInParent[n]-l).toString()])){a.push(c),u.push(r);var h=o+"_"+l.toString();d.push(h)}}else for(l=t.indexInParent[n];l<=e.indexInParent[n];l++){var c;if(void 0!==(r=s[c=o+"_"+(l===t.indexInParent[n]?e.indexInParent[n]:l-1).toString()])){a.push(c),u.push(r);h=o+"_"+l.toString();d.push(h)}}for(var g=0;g<a.length;g++)delete s[a[g]];for(g=0;g<d.length;g++)s[d[g]]=u[g];this._saveDataInPreferences(i,s)}},checkPresenceOfDataGridViewPreferences:function(){return!!this._hasValidIdentifier()&&t.checkPresenceOfPreferences(this.collectionView,this._dataGridViewPrefKey,this.collectionView.useWidgetPreferencesFlag)},deleteDataGridViewPreferences:function(){t.deleteDataFromPreferences(this.collectionView,this._dataGridViewPrefKey,this.collectionView.useWidgetPreferencesFlag)},deleteDataGridViewKeyPreference:function(e){t.deleteDataFromPreferences(this.collectionView,this._dataGridViewPrefKey,e,this.collectionView.useWidgetPreferencesFlag)},_getColumnsVisibleFlagInPreferences:function(){return this._getDataFromPreferences("columnsVisibleFlag")},_saveColumnVisibleFlagInPreferences:function(e){this._saveColumnOptionValueInPreferences(e,"visibleFlag","columnsVisibleFlag")},_getUnpinnedColumnsOrderInPreferences:function(){return this._getDataFromPreferences("unpinnedColumnsOrder")},_getPinnedColumnsOrderInPreferences:function(){return this._getDataFromPreferences("pinnedColumnsOrder")},_getcolumnGroupsExpandedStatesInPreferences:function(){return this._getDataFromPreferences("columnGroupsExpandedStates")},_saveColumnOrderInPreferences:function(e){var t=this.getColumnPinned(e),i="unpinned"===t?this._getUnpinnedColumnsOrderInPreferences():this._getPinnedColumnsOrderInPreferences();i||(i={});var n=this._getNumberOfColumnsToTheLeft(),o=this.getColumnIdentifiers(e),l=this._orderedColumnsReverseIndexes[o.columnIndex];l-=n[t],i[o.dataIndex]=l;var r="unpinned"===t?"unpinnedColumnsOrder":"pinnedColumnsOrder";this._saveDataInPreferences(r,i)},_updateAllOrderInPreferences:function(e){for(var t=this._getUnpinnedColumnsOrderInPreferences(),i=this._getPinnedColumnsOrderInPreferences(),n=this._getNumberOfColumnsToTheLeft(),o=0;o<this._orderedColumnsIndexes.length;o++){var l=this._orderedColumnsIndexes[o],r=this.getDataIndexFromColumnIndex(l);if(this.getColumnVisibleState(r)){var s=this.getColumnPinned(r);t&&"unpinned"===s&&null!=t[r]?t[r]=o-n[s]:i&&"unpinned"!==s&&null!=i[r]&&(i[r]=o-n[s])}}this._saveDataInPreferences("unpinnedColumnsOrder",t),this._saveDataInPreferences("pinnedColumnsOrder",i)},isInGroup:function(e,t){var i=this.getColumnIdentifiers(e);if(t){if(!t.children)return t.dataIndex===i.dataIndex;for(var n=0;n<t.children.length;n++)if(this.isInGroup(e,t.children[n]))return!0}return!1},_isGroupInBalancedTree:function(e){return this.getColumnOrGroupCellCoordinates(e).columnID>=0},_getTopNonSplittableGroup:function(e){var t;if(e)for(var n=i.getParents(e),o=0;o<n.length;o++)if(n[o]&&!1===n[o].splittableFlag){t=n[o];break}return t},_getColumnsWidthInPreferences:function(){return this._getDataFromPreferences("columnsWidth")},_saveColumnWidthInPreferences:function(e){this._saveColumnOptionValueInPreferences(e,"width","columnsWidth")},_hasColumn:function(e){return this._columnsReverseIndexes||this._computeColumnsReverseIndexes(),void 0!==this._columnsReverseIndexes[e]},_getColumnsPinnedStateInPreferences:function(){return this._getDataFromPreferences("columnsPinnedState")},_saveColumnPinnedStateInPreferences:function(e){this._saveColumnOptionValueInPreferences(e,"pinned","columnsPinnedState")},_getColumnsSortModelInPreferences:function(){return this._getDataFromPreferences("columnsSortModel")},saveColumnSortModelInPreferences:function(){this._saveDataInPreferences("columnsSortModel",this.collectionView.sortModel)},_saveColumnSortModelInPreferences:function(){this.saveColumnSortModelInPreferences()},_getGroupingOptionsInPreferences:function(){return this._getDataFromPreferences("groupingOptions")},_saveGroupingOptionsInPreferences:function(){this._saveDataInPreferences("groupingOptions",this.collectionView.getGroupingOptions())},_getOrderedColumnIndexesFromChanges:function(e){var i,n=this._originalOrderedColumnsIndexes.slice(0),o=e.unpinnedColumnsOrder,l=e.pinnedColumnsOrder,r=e.columnsPinnedState;i=t.concatenateObjects(l,o);var s=[],a=[],d=[],u=this._getNumberOfColumnsToTheLeftFromChanges(e);for(var h in i){var c;if("left"===(c=r&&r.hasOwnProperty(h)?r[h]:this.getColumnPinned(h))){if(l&&void 0!==l[h]){var g=l[h];s.push({dataIndex:h,columnIndexInPref:g})}}else if("right"===c){if(l&&void 0!==l[h]){g=l[h];a.push({dataIndex:h,columnIndexInPref:g+u[c]})}}else if("unpinned"===c&&o&&void 0!==o[h]){g=o[h];d.push({dataIndex:h,columnIndexInPref:g+u[c]})}}var p=function(e,t){for(var i=0;i<e.length;i++)if(e[i]===t)return void e.splice(i,1)},m=s.concat(d).concat(a),f=[];for(var C in m)if(m.hasOwnProperty(C)&&this._hasColumn(m[C].dataIndex)){var _=this.getColumnIndex(m[C].dataIndex);f[m[C].columnIndexInPref]=_,p(n,_)}for(var w=0;w<this._orderedColumnsIndexes.length;w++){if(f.length<w)return f.concat(n);void 0===f[w]&&n.length>0&&(f[w]=n[0],n.splice(0,1))}return f=f.filter(function(e){return void 0!==e})},_getCurrentViewChanges:function(){var e={columnsVisibleFlag:void 0,columnsWidth:void 0,columnsPinnedState:void 0,columnsSortModel:void 0,layoutDensity:void 0,groupingOptions:void 0,unpinnedColumnsOrder:void 0,pinnedColumnsOrder:void 0,columnGroupsExpandedStates:void 0},i=this.collectionView.getCustomViewsManager().getCurrentCustomView();i&&(e.columnsVisibleFlag=i.columnsVisibleFlag,e.columnsWidth=i.columnsWidth,e.columnsPinnedState=i.columnsPinnedState,e.columnsSortModel=i.columnsSortModel,e.layoutDensity=i.layoutDensity,e.groupingOptions=i.groupingOptions,e.unpinnedColumnsOrder=i.unpinnedColumnsOrder,e.pinnedColumnsOrder=i.pinnedColumnsOrder);var n=this._getColumnsVisibleFlagInPreferences();(e.columnsVisibleFlag||n)&&(e.columnsVisibleFlag=t.concatenateObjects(e.columnsVisibleFlag,n));var o=this._getColumnsWidthInPreferences();(e.columnsWidth||o)&&(e.columnsWidth=t.concatenateObjects(e.columnsWidth,o));var l=this._getColumnsPinnedStateInPreferences();(e.columnsPinnedState||l)&&(e.columnsPinnedState=t.concatenateObjects(e.columnsPinnedState,l));var r=this._getColumnsSortModelInPreferences();e.columnsSortModel||(e.columnsSortModel=r),e.layoutDensity||(e.layoutDensity=this._getOriginalLayoutDensity());var s=this._getGroupingOptionsInPreferences();(e.groupingOptions||s)&&(e.groupingOptions=t.concatenateObjects(e.groupingOptions,s));var a=this._getUnpinnedColumnsOrderInPreferences();(e.unpinnedColumnsOrder||a)&&(e.unpinnedColumnsOrder=t.concatenateObjects(e.unpinnedColumnsOrder,a));var d=this._getPinnedColumnsOrderInPreferences();(e.pinnedColumnsOrder||d)&&(e.pinnedColumnsOrder=t.concatenateObjects(e.pinnedColumnsOrder,d));var u=this._getcolumnGroupsExpandedStatesInPreferences();return u&&(e.columnGroupsExpandedStates=u),e},_getOrderedColumnIndexesFromPreferences:function(){var e=this._getCurrentViewChanges();return this._getOrderedColumnIndexesFromChanges(e)},_applyPreferencesOnColumns:function(){this.collectionView.getCustomViewsManager().getCustomViews();for(var e=this._getCurrentViewChanges(),t=!1,i=Object.keys(e).map(function(t){return e[t]}),o=0;o<i.length;o++)if(void 0!==i[o]){t=!0;break}if(this.collectionView.prepareUpdateView(),t){var l=this.getLeafColumns();for(o=0;o<l.length;o++)e.columnsVisibleFlag&&e.columnsVisibleFlag.hasOwnProperty(l[o].dataIndex)&&this.setColumnVisibleFlag(o,e.columnsVisibleFlag[l[o].dataIndex]),e.columnsWidth&&e.columnsWidth.hasOwnProperty(l[o].dataIndex)&&this.setColumnWidth(o,e.columnsWidth[l[o].dataIndex]),e.columnsPinnedState&&e.columnsPinnedState.hasOwnProperty(l[o].dataIndex)&&this.setColumnPinned(o,e.columnsPinnedState[l[o].dataIndex])}if(this._orderedColumnsIndexes=this._getOrderedColumnIndexesFromPreferences(),this._computeOrderedColumnsReverseIndexes(),this._updateColumnTreeFromOrderedIndexes(),this.collectionView._currentlyCalledFromApplyPreferencesFlag=!0,e.columnsSortModel&&(!this.collectionView._useTreeDocumentRestoration||this.collectionView.sortModel&&0!==this.collectionView.sortModel.length||n.saveTreeDocumentOrder(this.collectionView.treeDocument),this.collectionView.sortModel=e.columnsSortModel),e.layoutDensity&&(this.layoutDensity=e.layoutDensity),e.groupingOptions){var r=e.groupingOptions.dataIndexesToGroup;this.collectionView._setGroupingOptions(e.groupingOptions),this.collectionView.getGroupingOptions()&&this.collectionView.getGroupingOptions().dataIndexesToGroup.equals(r)||this.collectionView.groupRows(e.groupingOptions)}if(e.columnGroupsExpandedStates)for(var s in e.columnGroupsExpandedStates){var a=0!==e.columnGroupsExpandedStates[s],d=s.split("_");if(d&&d.length>0){var u=d[d.length-1],h=d.slice(0,d.length-1).join("_"),c=this.collectionView.getColumnOrGroup(h,parseInt(u,10));c&&(c.expandedFlag=a)}}this.collectionView._currentlyCalledFromApplyPreferencesFlag=!1,this.collectionView.__preferencesRestored=!0,this.collectionView.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},!0)},_getRowFirstVisibleCellWithActivableState:function(e){let t,i=0;for(;-1!==i&&(i>=0&&i>=0&&(t=this.getCellIDFromCoordinates({rowID:e,columnID:i})),!this.collectionView.getCellActivableState(t));)i=this._getNextVisibleColumnID(i);return-1===i&&(t=-1),t},setColumnGroupExpandedFlag:function(e,t,i,n){var o=this.getColumnOrGroupFromCoordinates({rowID:e,columnID:t});if(o){o.expandedFlag=i;let e=!1,t=!1,l=this._getLeafChildrenFromGroup(o);for(let i=0;i<l.length;i++)if(l[i].customHeader){t=!0,e=!0;break}e&&this.resetRowHeight(-1),this.invalidate({updateCellContent:t,updateCellLayout:!0,updateCellAttributes:!0}),n&&n.isUserInteraction&&this._saveColumnGroupExpandedStateInPreferences(o)}},_isColumnDisplayedByHierarchy:function(e){var t=e.columnID,i=this.getColumnIndex(t),n=this.getColumnOrGroupFromCoordinates({rowID:e.rowID,columnID:i});if(n){if(!n._parent)return!0;var o=this.getColumnOrGroupCellCoordinates(n._parent);if(void 0===n.columnGroupShow)return this._isColumnDisplayedByHierarchy(o);if("open"===n.columnGroupShow)return(!0===n._parent.expandedFlag||!0===n._parent.isExpanderHidden)&&this._isColumnDisplayedByHierarchy(o);if("closed"===n.columnGroupShow)return(!1===n._parent.expandedFlag||!0===n._parent.isExpanderHidden)&&this._isColumnDisplayedByHierarchy(o)}return!1},_getColumnGroupIndexInItsRow:function(e){if(!this._columnItemsByDepth||!this._columnItemsByDepth.length)return-1;for(var t=0;t<this._columnItemsByDepth.length;t++)for(var i=this._columnItemsByDepth[t],n=0,o=0;o<i.length;o++){if(e===i[o])return n;e.dataIndex===i[o].dataIndex&&n++}return-1},_getDataIndexOccurrenceNumberInRow:function(e){for(var t=0,i=0;i<this._columnItemsByDepth.length;i++){for(var n=this._columnItemsByDepth[i],o=0;o<n.length;o++)e.dataIndex===n[o].dataIndex&&t++;if(t>0)break}return t},_getColumnOrGroupPositionData:function(e){for(var t=[],i=[],n=[],o=e._parent?e._parent.children.length:-1;e&&e.dataIndex;)e.children&&e.children.length>0&&(t.push(this._getDataIndexOccurrenceNumberInRow(e)),i.push(this._getColumnGroupIndexInItsRow(e)),n.push(e.dataIndex)),e=e._parent;return{numberOfDataIndexOccurences:t,indexInParent:i,columnGroupDataIndexes:n,childrenCountInParent:o}},_getColumnIDInLeafColumnHierarchyAtRowID:function(e,t){if(t>=-1)return e;var i=-1,n=this.getColumnOrGroupFromCoordinates({rowID:i,columnID:e});if(!n)return e;for(;;){if(i--,!(n=n._parent))return e;if(i===t)return this.getColumnOrGroupCellCoordinates(n).columnID}}})}),define("DS/DataGridView/DataGridViewPaginationManager",["DS/CollectionView/CollectionViewPaginationManager"],function(e){"use strict";return e.inherit({name:"dataGridViewPaginationManager",publishedProperties:{nodeDepth:{defaultValue:0,type:"integer"}},_id:0,_applyNodeDepth:function(){this.updatePagination()},_applyProperties:function(e){this._parent(e),this.isDirty("pageSize")||this.isDirty("currentPage")||!this.isDirty("nodeDepth")||this.updatePagination()},getPageNumber:function(){if(this._collectionView){var e=this._collectionView.getRowModelLength(this.nodeDepth);if(e)return Math.ceil(e/this.pageSize);if(0===e)return 1}},getNumberOfItemsOnPage:function(e){void 0===e&&(e=this.currentPage);var t=this._collectionView.getRowModelLength(this.nodeDepth),i=Math.max(Math.ceil(t/this.pageSize),1);return e>i||e<0?void 0:e===i?t-(i-1)*this.pageSize:this.pageSize}})}),define("DS/DataGridView/DataGridViewServerSideBridge",["DS/TreeModel/DataSourceBase","DS/Utilities/UUID","DS/Utilities/Debug"],function(e,t,i){"use strict";return class{constructor(t,i,n,o,l){this.dataGridView=t,this.modelId=n,this.communicationComponent=i,this.requestsMap={},this._xsoListeningDisabled=0,this._modelChangeListeningDisabled=0,this._onNodeModelUpdateCB=o;let r=new e;r.getModelItems=function(e){this._request("ModelItems",e)}.bind(this),r.getModelStructure=function(e){this._request("ModelStructure",e)}.bind(this),this._onNodeModelUpdateCB&&(r.onNodeModelUpdate=this._onNodeModelUpdateCB),this.dataGridView.dataSource=r,t.addEventListener("allCellsRendered",function(){this._sendInfo("allCellsRendered",{request:{}})}.bind(this));let s=t.getTreeDocument();s&&(s.onNodeModelUpdate(function(e){if(!(this._modelChangeListeningDisabled>0)){var t=e.data.nodeModel;if(t){let i={request:{operationType:"nodesChanged",nodes:[{indexPath:this.buildStructureIndexArray(t),properties:e.data.attributes}]},successCallback:function(e){if(e&&"nodesChanged"===e.operationType&&Array.isArray(e.nodes)&&e.nodes.length>0){s.prepareUpdate(),this._modelChangeListeningDisabled++;for(var t=0;t<e.nodes.length;t++){var i=e.nodes[t];if(i){let e=s.getNodeFromStructurePath(i.indexPath);e&&e.updateOptions({grid:i.properties})}}this._modelChangeListeningDisabled--,s.pushUpdate()}}.bind(this)};this._request("ModelChange",i)}}}.bind(this)),s.onPreCollapse(e=>{if(!e||!e.data||!e.data.nodeModel)return;if(this._modelChangeListeningDisabled>0)return;let t={request:{nodesToCollapse:[e.data.nodeModel.buildStringIdentifierArray()]},successCallback:function(e){e&&((e.nodesToExpand||[]).forEach(e=>{let t=s.getNodeFromStructurePath(e);t&&t.expand()}),e.nodesToCollapse&&e.nodesToCollapse.length&&window.console.warn("Error in collapseCorrection"))}};this._request("ModelCollapseExpand",t)}));let a=function(e){let t=[];return e.forEach(function(e){let i=this.buildStructureIndexArray(e);t.push(i)},this),t}.bind(this),d=e=>{let i=[];return e.forEach(function(e){i.push(t.getCellIDFromXSOElement(e))}),i},u=e=>{this._handleSelectionChange(e)},h=t.getNodesXSO();h&&(h.onPostAdd(e=>{if(this._xsoListeningDisabled)return;let t={request:{addedNodes:a(e)},successCallback:u};this._request("SelectionChange",t)}),h.onPostRemove(e=>{if(this._xsoListeningDisabled)return;let t={request:{removedNodes:a(e)},successCallback:u};this._request("SelectionChange",t)}));let c=t.getCellsXSO();c&&(c.onPostAdd(e=>{if(this._xsoListeningDisabled)return;let t={request:{addedCells:d(e)},successCallback:u};this._request("SelectionChange",t)}),c.onPostRemove(e=>{if(this._xsoListeningDisabled)return;let t={request:{removedCells:d(e)},successCallback:u};this._request("SelectionChange",t)})),l&&(t.onContextualEvent=(e=>{if(e&&e.cellInfos&&e.cellInfos.nodeModel)return new Promise(t=>{this.requestContextualMenu(e.cellInfos.nodeModel,function(e){t(e&&e.menu)})})}))}_handleSelectionChange(e){if(e&&this.dataGridView){let t=this.dataGridView.getTreeDocument();if(t){let i=this.dataGridView.getNodesXSO();if(i){let n=[],o=[],l=e.addedNodes;if(l)for(let e=0;e<l.length;e++){let i=l[e],o=t.getNodeFromStructurePath(i);o&&n.push(o)}let r=e.removedNodes;if(r)for(let e=0;e<r.length;e++){let i=r[e],n=t.getNodeFromStructurePath(i);n&&o.push(n)}this._xsoListeningDisabled++,n.length>0&&i.add(n),o.length>0&&i.remove(o),this._xsoListeningDisabled--}}}}answerToAServerRequest(e,t){if("WIN_ModelChange"===e){if(this.dataGridView&&t){let i=t.data;if(Array.isArray(i))for(let e=0;e<i.length;e++){let t=i[e];if(t&&"nodesChanged"===t.operationType&&Array.isArray(t.nodes)&&t.nodes.length>0){let e=t.nodes[0];e&&(t.nodesNumber=1,t.nodesPath=e.indexPath,t.modifications=e.properties)}}this._modelChangeListeningDisabled++,this._xsoListeningDisabled++,this.dataGridView.dataSource.pushUpdatesNotifications(t.data,function(i){this._answer(e,t,i),this._modelChangeListeningDisabled--,this._modelChangeListeningDisabled<0&&(window.console.warn("Error in WIN_ModelChange : this._modelChangeListeningDisabled = "+this._modelChangeListeningDisabled),this._modelChangeListeningDisabled=0),this._xsoListeningDisabled--}.bind(this))}return}let i;switch(e){case"WIN_getColumnsData":i=this.dataGridView.columns;break;case"WIN_getLoadedRows":i=this.dataGridView&&this.dataGridView.getTreeDocument()?this.dataGridView.getTreeDocument().dump():{error:"No TreeDocument"};break;case"WIN_setColumnsData":this.dataGridView?this.dataGridView.columns=t:i={error:"No DataGridView"};break;case"WIN_SelectionChange":t?this._handleSelectionChange(t):i={error:"No selection input"}}this._answer(e,t,i)}serverRequest(e,t){if(e.includes("WIN_"))this.answerToAServerRequest(e,t);else switch(e){case"WEB_ModelItems_ANSWER":case"WEB_ModelStructure_ANSWER":case"WEB_ModelChange_ANSWER":case"WEB_SelectionChange_ANSWER":this._xsoListeningDisabled++,this._modelChangeListeningDisabled++,this._receiveAnswer(e,t),this._modelChangeListeningDisabled--,this._xsoListeningDisabled--;break;default:this._receiveAnswer(e,t)}}_sendInfo(e,i){i.successCallback&&(i.request.uuid=t.createUUID(),this.requestsMap[i.request.uuid]=i);let n=i?i.request:{};this.communicationComponent&&this.communicationComponent.sendCommand(this,"WEBInfo_"+e,n,this.modelId)}_request(e,i){i.successCallback&&(i.request.uuid=t.createUUID(),this.requestsMap[i.request.uuid]=i),this.communicationComponent&&this.communicationComponent.sendCommand(this,"WEB_"+e,i.request,this.modelId)}_answer(e,t,n){let o={data:n};if(t&&t.winId)return o.winId=t.winId,void(this.communicationComponent&&this.communicationComponent.sendCommand(this,e+"_ANSWER",o,this.modelId));i.log("WUXDGVServerSideBridge","[DGV ServerSideBridge] "+e+" has no input")}_receiveAnswer(e,t){t&&t.uuid&&this.requestsMap[t.uuid]&&(this.requestsMap[t.uuid].successCallback(t),delete this.requestsMap[t.uuid])}buildStructureIndexArray(e){let t=e.getStructurePath().split("/");t=t.slice(0,t.length-1);let i=[];return t.forEach(e=>i.push(Number(e))),i}requestPointerEvent(e,t){if(!e||!e.nodeModel)return;let i={idsPath:e.nodeModel.buildStringIdentifierArray()};["type","pointerType","button","hitCount"].forEach(t=>{e.hasOwnProperty(t)&&(i[t]=e[t])});let n=0;e.shiftKey&&(n|=1),e.altKey&&(n|=2),e.ctrlKey&&(n|=4),n&&(i.modifiers=n);let o={request:i};t&&(o.successCallback=t),this._request("PointerEvent",o)}}}),define("DS/DataGridView/DataGridViewTreeNodeCell",["UWA/Core","DS/Core/Core","DS/DataGridView/DataGridViewCell","DS/Utilities/Dom","DS/Core/PointerEvents"],function(e,t,i,n,o){"use strict";var l=function(e){e.stopPropagation(),e.preventDefault()};function r(t){if(t){if(!this.nodeModel||!this.nodeModel.hasBadges())return this._latestAddedBadges={},t;var i;i="string"==typeof t?n.isAPath(t)?{iconPath:t}:{iconName:t}:e.clone(t);var o=s.call(this,t);return i.badges=o,this._latestAddedBadges=o,i}}function s(t){if(t){var i=t.badges?e.clone(t.badges):{},n=this.nodeModel.getBadges();if(n){var o={};Object.keys(n).forEach(function(e){n[e]&&(o[e]=n[e])}),e.merge(i,o)}return i}return{}}return i.inherit({name:"DataGridViewTreeNodeCell",publishedProperties:{nodeModel:{defaultValue:null,type:"object",category:"Model"},readOnly:{defaultValue:!0,type:"boolean",category:"Model"},buildLinks:{defaultValue:!0,type:"boolean",category:"Appearance"},depthIncrement:{defaultValue:22,type:"integer"},showIconsFlag:{defaultValue:!0,type:"boolean"},expanderStyle:{defaultValue:"classic",type:"string"},flatTreeFlag:{defaultValue:!1,type:"boolean"},icons:{defaultValue:void 0,type:"Array"},getNodeDepth:{defaultValue:function(e){return e.getNodeDepth()},type:"function",noNeedToApplyFlag:!0}},_applyNodeModel:function(e){var t=this.nodeModel;t&&(this.__applyExpanderState(t.getState()),this.__applyDepth(this.getNodeDepth.call(this,t)))},_applyReadOnly:function(e){this._reusableContent&&(this._reusableContent.readOnly=this.readOnly)},_applyShowIconsFlag:function(e){this.elements.iconsContainer&&(this.showIconsFlag?this.elements.iconsContainer.show():this.elements.iconsContainer.hide())},_applyFlatTreeFlag:function(e){!this.isDirty("nodeModel")&&this.nodeModel&&this.__applyDepth(this.nodeModel.getNodeDepth()),this.flatTreeFlag?this.elements.expanderContainer.hide():this.elements.expanderContainer.show()},_applyExpanderStyle:function(e){this.elements.container.setAttribute("expander-style",this.expanderStyle)},_applyBuildLinks:function(e){!this.isDirty("nodeModel")&&this.nodeModel&&this.__applyDepth(this.nodeModel.getNodeDepth()),!1===this.buildLinks?this.elements.expanderContainer.setAttributeNode(document.createAttribute("no-link")):this.elements.expanderContainer.removeAttribute("no-link")},_applyProperties:function(e){this.isDirty("nodeModel")&&this._applyNodeModel(this.nodeModel),this.isDirty("icons")&&this._applyIcons(this.icons),this.isDirty("readOnly")&&this._applyReadOnly(e.readOnly),this.isDirty("showIconsFlag")&&this._applyShowIconsFlag(e.showIconsFlag),this.isDirty("flatTreeFlag")&&this._applyFlatTreeFlag(e.flatTreeFlag),this.isDirty("expanderStyle")&&this._applyExpanderStyle(e.expanderStyle),this.isDirty("buildLinks")&&this._applyBuildLinks(e.buildLinks),this._parent(e)},buildView:function(){this.elements.linksContainer=new e.Element("div",{class:"wux-layouts-treeview-links"}).inject(this.elements.container),this.elements.expanderContainer=new e.Element("div",{class:"wux-layouts-treeview-expander"}).inject(this.elements.container),this.elements.tweakerContainer=new e.Element("div",{class:"wux-layouts-datagridview-tweaker-container"}).inject(this.elements.container),this.__observeEvents()},_getContentContainer:function(){return this.elements.tweakerContainer},__observeEvents:function(){this.nodeModel;var e=this;this.elements.expanderContainer.addEvent(o.POINTERHIT,function(t){t.stopPropagation(),"touchend"===t.type&&t.preventDefault(),1!==t.which&&"touchend"!==t.type||e.nodeModel.getChildren()&&"noExpandState"!==e.nodeModel._expandState&&"expandingState"!==e.nodeModel._expandState&&(e.nodeModel.isExpanded()&&"partiallyExpandedState"!==e.nodeModel._expandState?e.nodeModel.collapse():(e.__applyExpanderState("expanding"),e.nodeModel.expand()))}),this.elements.expanderContainer.addEventListener("contextmenu",l),this.elements.expanderContainer.addEventListener(o.LONGHOLD,l)},__applyDepth:function(e){var t=this.nodeModel,i=this.elements;void 0===e&&(e=t.getParents().length);var n=this.depthIncrement;if(this.buildLinks&&e>0){for(var o,l,r,s,a=t.isLastChild(),d=[t],u=t,h=1;h<e;h++)u=u?u.getParent():void 0,d.push(u);var c=0,g="";for(o=0;o<e;o++){var p=a&&o===e-1;r=(o===e-1?0:n)-1,s=(0===o?n:0)+c,""===(l=!p&&d[e-1-o]&&d[e-1-o].isLastChild()?"border-color:transparent":"")?(c=0,g=g+"<li"+(' data-depth="'+o+"/"+(e-1)+'"')+' style="'+l+";height: "+(p?"50%":"100%")+";margin-right:"+r+"px;margin-left:"+s+'px" class="wux-layouts-treeview-link"></li>'):c=r+s+1}g="<span>"+g+"</span>",i.linksContainer.innerHTML!==g&&(i.linksContainer.innerHTML=g)}else i.linksContainer.innerHTML="";var m=this.flatTreeFlag?0:this.collectionView.getCurrentRootMargin(),f=n*e;i.linksContainer.setStyles({"margin-left":m,"min-width":f}),this._nodeOffsetX=f+m+2,i.container.setAttribute("data-node-depth",e)},__applyExpanderState:function(e){e&&(e.indexOf("noChildren")>-1&&(e="noChildren"),this.elements.expanderContainer.setAttribute("data-wux-state",e))},__applyLabel:function(e){"number"==typeof e&&(e=e.toString()),this._reusableContent&&(this._reusableContent.disableEvents(),this._reusableContent.value=e,this._reusableContent.enableEvents())},checkBadges:function(){return!(!this.icons||this.icons.length<=0)&&(this._latestAddedBadges||(this._latestAddedBadges={}),!e.equals(s.call(this,this.icons[0]),this._latestAddedBadges))},_applyIcons:function(){var t,i=this;this.elements.iconsContainer&&(this.elements.iconsContainer.removeAttribute("wux-icon-name"),(t=this.elements.iconsContainer.getChildren())&&t.forEach(function(e){e.hasClassName("wux-layouts-datagridview-icon")&&e.remove()}));this.elements.rightIconsContainer&&(this.elements.rightIconsContainer.removeAttribute("wux-icon-name"),(t=this.elements.rightIconsContainer.getChildren())&&t.forEach(function(e){e.hasClassName("wux-layouts-datagridview-icon")&&e.remove()}));var n=this.icons;if(n&&(Array.isArray(n)&&n.length>0||"string"==typeof n&&""!==n)){if(this.elements.iconsContainer||(this.elements.iconsContainer=new e.Element("div",{class:"wux-layouts-treeview-icons"})),Array.isArray(n)&&n.length>0){var o=document.createDocumentFragment(),l=document.createDocumentFragment();n.forEach(function(e,t){var s=e;if(0===t&&(s=r.call(i,n[0])),s){var a=i.__buildIcon(s);!e.hasOwnProperty("position")||e.position&&"near"===e.position?o.appendChild(a):"far"===e.position&&l.appendChild(a)}}),this.elements.iconsContainer.appendChild(o),l.children.length>0&&(this.elements.rightIconsContainer||(this.elements.rightIconsContainer=new e.Element("div",{class:"wux-layouts-treeview-icons wux-layouts-treeview-right-icons"})),this.elements.rightIconsContainer.appendChild(l))}else if("string"==typeof n&&""!==n){var s=r.call(this,n);i.__addIcon(s,"css")}this._applyShowIconsFlag(),this.elements.iconsContainer.parentNode||(this.elements.tweakerContainer?this.elements.iconsContainer.inject(this.elements.tweakerContainer,"before"):this.elements.iconsContainer.inject(this.elements.container)),this.elements.rightIconsContainer&&!this.elements.rightIconsContainer.parentNode&&(this.elements.tweakerContainer?this.elements.rightIconsContainer.inject(this.elements.tweakerContainer,"after"):this.elements.rightIconsContainer.inject(this.elements.container))}else this.elements.iconsContainer&&this.elements.iconsContainer.hide()},__addIcon:function(e,t){this.__buildIcon(e,t).inject(this.elements.iconsContainer)},__buildIcon:function(e,t){var i=n.createElement("div",{class:"wux-layouts-datagridview-icon"});switch(t){case"css":i.setAttribute("icon-type","css"),i.setAttribute("wux-icon-name",e);break;default:"string"==typeof e&&i.setAttribute("icon-type","css"),n.generateIcon(e,{target:i})}return i},computeContentSize:function(){var e=this.elements.expanderContainer&&this.elements.expanderContainer.offsetWidth>0?this.elements.expanderContainer.offsetWidth+3:0,t=this.elements.iconsContainer?this.elements.iconsContainer.offsetWidth:0,i=this._nodeOffsetX+e+t,n=this.getReusableContent();return n&&n.computeContentSize&&(i+=n.computeContentSize()),Math.ceil(i)},getFontSize:function(){var e=window.getComputedStyle(this.getContent(),null).getPropertyValue("font-size");return parseFloat(e)},getFontFamily:function(){return"arial"},getInitialClassName:function(){return this._parent()+" wux-layouts-datagridview-tree-node-cell wux-tree-treelistview"},destroy:function(){this.elements&&this.elements.expanderContainer&&(this.elements.expanderContainer.removeEventListener("contextmenu",l),this.elements.expanderContainer.removeEventListener(o.LONGHOLD,l)),this._parent()}})}),define("DS/DataGridView/DataGridViewConditionBaseFilterView",["DS/DataGridView/DataGridViewBaseFilterView","DS/Utilities/Dom","DS/Core/PointerEvents","i18n!DS/DataGridView/assets/nls/translation"],function(e,t,i,n){"use strict";function o(e){for(let t=e;t<this._numberOfConditionDisplayed;t++){const e=this._conditionsElements[t];e.container&&e.container.remove(),this.resetConditionElements(e)}this._numberOfConditionDisplayed=e,0===e&&this.displayConditionElements(0)}function l(){"and"===this._operator?this._operatorLabel.innerHTML=n.get("FilterView_Condition_All"):this._operatorLabel.innerHTML=n.get("FilterView_Condition_Any"),t.addEventOnElement(this,this._operatorLabel.querySelector("#conditionToggle"),i.POINTERHIT,()=>{"and"===this._operator?this._operator="or":this._operator="and",l.call(this)})}return e.inherit({name:"datagridviewconditionbasefilterview",publishedProperties:{},buildConditionElements:function(e){},refreshConditionElements:function(e,t){},resetConditionElements:function(e){},buildConditionFilterModel:function(e){},isConditionEmpty:function(e){return!0},focusConditionElements:function(e){},_build:function(){this._parent(),this._operatorLabel=null,this._conditionsElements=[],this._numberOfConditionDisplayed=0,this._operator="and"},buildContentView:function(){var e=this._popupContentDiv;e&&(e.addClassName("wux-datagridview-filter-conditions"),this._operatorLabel=document.createElement("div"),this._operatorLabel.classList.add("wux-datagridview-filter-operator"),e.appendChild(this._operatorLabel),this.refreshContentView())},hideConditionElements:function(e){const t=e>=0?e:this._numberOfConditionDisplayed-1;this._conditionsElements.length>0&&t>0&&this._numberOfConditionDisplayed>t&&this._conditionsElements.length>=this._numberOfConditionDisplayed&&o.call(this,t)},displayConditionElements:function(e){var t=this._popupContentDiv;if(t&&!(e>3)){if(this._conditionsElements.length<=e){const e=this.buildConditionElements(this._conditionsElements.length);return e.container.classList.add("wux-datagridview-filter-condition"),t.appendChild(e.container),this._conditionsElements.push(e),this._numberOfConditionDisplayed++,e}if(this._numberOfConditionDisplayed<=e){const e=this._conditionsElements[this._numberOfConditionDisplayed];return t.appendChild(e.container),this._numberOfConditionDisplayed++,e}return this._conditionsElements[e]}},isConditionElementsDisplayed:function(e){return e<this._numberOfConditionDisplayed},resetFilterViewContent:function(){this._operator="and",l.call(this),o.call(this,0)},clearFilterViewContent:function(){this.resetFilterViewContent()},refreshContentView:function(e){if(this.filter&&this.elements._popup){var t=void 0!==e?e:this.filter.filterModel;if(!t||Array.isArray(t))return void this.resetFilterViewContent();this._operator=t.operator||"and",l.call(this);const i=Object.keys(t).length-(void 0!==t.operator?1:0);for(let e=0;e<i;e++){const i=this.displayConditionElements(e);if(i){const n=t["condition"+(e+1)];this.refreshConditionElements(i,n)}}const n=this.displayConditionElements(i);this.resetConditionElements(n),i+1<this._conditionsElements.length&&o.call(this,i+1)}},focusContentView:function(){this._conditionsElements[0]&&this.focusConditionElements(this._conditionsElements[0])},buildFilterModelFromView:function(){if(0===this._numberOfConditionDisplayed)return this.filter&&this.filter.filterModel;let e={};for(let t=0;t<this._numberOfConditionDisplayed;t++){const i=this._conditionsElements[t];if(this.isConditionEmpty(i))break;e["condition"+(t+1)]=this.buildConditionFilterModel(i)}return Object.keys(e).length>=2&&(e.operator=this._operator),e}})}),define("DS/DataGridView/DataGridViewSetFilterView",["DS/Controls/TooltipModel","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CollectionView/CollectionViewStatusBar","DS/DataGridView/DataGridViewBaseFilterView","DS/Controls/LineEditor","DS/Controls/Toggle","DS/TreeModel/ModelUtils","i18n!DS/DataGridView/assets/nls/translation"],function(e,t,i,n,o,l,r,s,a){"use strict";const d=function(){return Object.keys(this._mappedIdsStruct).length>0},u=function(e){let t=e;const i=a.get("FilterView")[e+""];"Blank"===e?t="("+i+")":void 0!==i&&(t=i);const n=d.call(this);let o=0;n?this._mappedIdsStruct[e].ids.forEach(e=>{o+=this._idsStruct[e].count}):o=this._idsStruct[e].count;const l=this._insertNewNode(t,o,e);n?this._mappedIdsStruct[e].nodeModel=l:this._idsStruct[e].nodeModel=l},h=function(e){if(e&&this.filter){const t=this.filter.getListOfFilteredData();if(t)return t.includes(e)}return!1},c=function(){const e=this.filterViewManager.filterManager.model;this._unseenIdsStruct={},this._idsStruct={},e.processDescendants({processNode:e=>{const t=e.nodeModel;if(this.filterViewOptions&&this.filterViewOptions.ignoreGroupingNodes&&t.getNodeSource()!==i.NODE_SOURCE.MODEL)return;const n=function(e){return null==e?[e]:Array.isArray(e)?Array.from(e):[e]}(t.options.getAttributeValueForFiltering(this.propertyId));this._getIdsFromValues(n).forEach((e,i)=>{0===t.getFilteredCount()||1===t.getFilteredCount()&&h.call(this,t)?this._idsStruct[e]?(this._idsStruct[e].values.add(n[i]),this._idsStruct[e].count++):(this._idsStruct[e]={values:new Set,count:1,nodeModel:null},this._idsStruct[e].values.add(n[i])):h.call(this,t)||(this._unseenIdsStruct[e]?this._unseenIdsStruct[e].add(n[i]):(this._unseenIdsStruct[e]=new Set,this._unseenIdsStruct[e].add(n[i])))})}}),this._notDisplayedAndNotFilteredByMe=[];for(let e in this._unseenIdsStruct)this._idsStruct[e]||this._notDisplayedAndNotFilteredByMe.push(...this._unseenIdsStruct[e])},g=function(){this._numberOfSelectedEntries=0;const e=this._dataGridViewPossibleValues.elements.statusBar.getNodeModelByID("selectedItems"),t=this._treeDocumentPossibleValues._numberOfNodesInDocument,i=this._treeDocumentPossibleValues.getXSO().get();this._filterOnlyOnVisibleNode?this._numberOfSelectedEntries=i.reduce((e,t)=>t.isVisible()?++e:e,0):this._numberOfSelectedEntries=i.length,e.updateOptions({grid:{data:`${this._numberOfSelectedEntries} of ${t} selected`}}),this.validFlag=this._numberOfSelectedEntries>0};return o.inherit({name:"datagridviewsetfilterview",publishedProperties:{},_build:function(){this._parent(),this._treeDocumentPossibleValues=null,this._searchLineEditor=null,this._dataGridViewPossibleValues=null,this._refreshInProgress=0},buildContentView:function(){var i=this._popupContentDiv;if(!i)return;i.addClassName("wux-datagridview-filter-set"),this._searchLineEditor=new l({placeholder:a.get("FilterView").AttributeValuePlaceHolder,displayClearFieldButtonFlag:!0,tooltipInfos:new e({getAllInformationCB:()=>({model:{shortHelp:""!==this._searchLineEditor.valueToCommit?a.get("FilterView").AttributeValuePlaceHolder:void 0},updateModel:!1})})}).inject(i),this._searchLineEditor.getContent().addClassName("wux-datagridview-filter-set-editor"),this._searchLineEditor.addEventListener("uncommittedChange",()=>{""!==this._searchLineEditor.valueToCommit?(i.setAttributeNode(document.createAttribute("refined-toggle-visible")),i.insertBefore(this._filterOnlyOnVisibleNodeToggle.getContent(),this._dataGridViewPossibleValues.getContent())):(i.removeAttribute("refined-toggle-visible"),this._filterOnlyOnVisibleNodeToggle.remove(),i.style.height=i.style.height),this._treeDocumentPossibleValues.setFilterModel({label:{filterId:"stringRegexp",filterModel:{condition1:{type:"contains",filter:this._searchLineEditor.valueToCommit}},filterOptions:{keepChildren:!0,onlyVisibleNodes:!0}}}),g.call(this),this._filterOnlyOnVisibleNode&&this.fire("change")}),this._filterOnlyOnVisibleNodeToggle=new r({label:a.get("FilterView").FilterOnlyRefinedValues,checkFlag:!1,tooltipInfos:new e({shortHelp:a.get("FilterView").FilterOnlyRefinedValuesTooltip})}),this._filterOnlyOnVisibleNodeToggle.getContent().addClassName("wux-datagridview-filter-set-toggle"),this._filterOnlyOnVisibleNodeToggle.addEventListener("change",()=>{this._filterOnlyOnVisibleNode=this._filterOnlyOnVisibleNodeToggle.checkFlag,g.call(this),this.fire("change")}),this._idsStruct={},this._mappedIdsStruct={},this._notDisplayedAndNotFilteredByMe=[],this._treeDocumentPossibleValues=new t({shouldSelectDescendants:function(e){return!0},shouldUnselectDescendants:function(e){return!0},shouldSelectParents:function(e){return!0},shouldUnselectParents:function(e){return!0}});const o=this._treeDocumentPossibleValues.getXSO(),s=()=>{this._xsoListeningDisabled||(g.call(this),this.fire("change"))};o.onPostAdd(s),o.onPostRemove(s);const d=require("DS/DataGridView/DataGridView");this._dataGridViewPossibleValues=new d({treeDocument:this._treeDocumentPossibleValues,height:150,columns:[{text:a.get("FilterView").ValuesList,dataIndex:"tree",editableFlag:!1,resizableFlag:!1,width:"auto",filterOptions:{readOnly:!0}}],showRowIndexFlag:!1,showSelectionCheckBoxesFlag:!0,sortModel:[{dataIndex:"tree",sort:"asc"}],getCellTooltip:e=>e.rowID<0&&e.columnID<0?{getAllInformationCB:()=>({model:{shortHelp:""===this._searchLineEditor.valueToCommit?a.get("FilterView").SelectAll:a.get("FilterView").SelectAllRefinedResults},updateModel:!1})}:this._dataGridViewPossibleValues.getCellDefaultTooltip(e),onContextualEvent:function(){return[]},selectionBehavior:{toggle:!0,unselectAllOnEmptyArea:!1,unselectAllOnEscapeKey:!1,selectNodeModelOnCellSelection:!0,showMixedStateOnParents:!0},cellSelection:"none",rowSelection:"multiple",cellActivationFeedback:!1}).inject(i),this._dataGridViewPossibleValues.__selectAllOnlyOnVisibleNodes=!0,this._dataGridViewPossibleValues.buildStatusBar([{type:n.STATUS.CUSTOM,position:"near",id:"selectedItems",dataElements:{typeRepresentation:"string",value:a.get("FilterView").NoStatus,tooltip:"Selected filter entries"}}]),this.refreshContentView()},clearFilterViewContent:function(){this._treeDocumentPossibleValues.selectAll(),this._searchLineEditor&&(this._searchLineEditor.value="")},refreshContentView:function(e){this.filter&&this.elements._popup&&(this._refreshInProgress++,c.call(this),new Promise(async(t,i)=>{await async function(){this._mappedIdsStruct={};const e=this.filterViewManager.view;if(e){const t=e.getColumnOrGroup("label"===this.propertyId?"tree":this.propertyId);if(t&&t.filterOptions&&t.filterOptions.mapPossibleValues){const e=t.filterOptions.mapPossibleValues;if(e instanceof Function){const t=Object.keys(this._idsStruct),i=e.call(this,t);let n=void 0;if(i instanceof Promise){if(this._dataGridViewPossibleValues&&(this._dataGridViewPossibleValues.displayModalLoader(a.get("Loading")),this._dataGridViewPossibleValues.placeholder=""),n=await i,this._dataGridViewPossibleValues&&(this._dataGridViewPossibleValues.removeModalLoader(a.get("Loading")),this._dataGridViewPossibleValues.placeholder=a.get("NoObjectsFound")),this._refreshInProgress>1)return this._refreshInProgress--,0}else n=i;(function(e,t){if(e.length===t.length)for(var i=0;i<t.length;i++){const n=t[i],o=e[i];this._mappedIdsStruct[o]?this._mappedIdsStruct[o].ids.push(n):this._mappedIdsStruct[o]={ids:[n],nodeModel:null}}}).call(this,n,t)}}}return 1}.call(this)?(this._refreshInProgress--,this._cleanBeforeReset(),function(){if(this._xsoListeningDisabled=!0,this._treeDocumentPossibleValues.prepareUpdate(),this._treeDocumentPossibleValues.empty(),d.call(this))for(let e in this._mappedIdsStruct)u.call(this,e);else for(let e in this._idsStruct)u.call(this,e);this._treeDocumentPossibleValues.pushUpdate(),this._xsoListeningDisabled=!1}.call(this),function(e){let t=[],i=null,n=()=>!1;const o=d.call(this);for(var l in o?(i=this._mappedIdsStruct,n=(t=>this._mappedIdsStruct[t].ids.some(t=>this._shouldSelectPossibleValue(e,t)))):(i=this._idsStruct,n=(t=>this._shouldSelectPossibleValue(e,t))),i){const e=i[l].nodeModel;if(e&&n(l)){t.push(e);const i=s.getNodesToPreselectOrSelect(this._treeDocumentPossibleValues,e,t);i.length&&(t=t.concat(i))}}this._treeDocumentPossibleValues.getXSO().add(t),g.call(this)}.call(this,void 0!==e?e:this.filter.filterModel),this._dataGridViewPossibleValues&&this._dataGridViewPossibleValues.reapplySortModel(),this._searchLineEditor&&(this._searchLineEditor.value=""),t()):i()}).catch(e=>{}).finally(()=>{this.fire("change")}))},focusContentView:function(){this._searchLineEditor&&this._searchLineEditor.focus()},buildFilterModelFromView:function(){if(!this._dataGridViewPossibleValues||this._refreshInProgress>0)return this.filter&&this.filter.filterModel;const e=this._treeDocumentPossibleValues.getXSO(),t=[];e.get().forEach(e=>{if(!(e&&e.options&&e.options instanceof Object))return;if(!e.options.hasOwnProperty("attributeId")||this._filterOnlyOnVisibleNode&&e.isFiltered())return;const i=e.options.attributeId;d.call(this)?this._mappedIdsStruct[i].ids.forEach(e=>{t.push(...this._idsStruct[e].values)}):t.push(...this._idsStruct[i].values)});const i=new Set(t);this._filterOnlyOnVisibleNode||this._notDisplayedAndNotFilteredByMe.forEach(e=>i.add(e));const n=Array.from(i);return this.filter.isEmpty(n)?[]:n},_cleanBeforeReset:function(){},_insertNewNode:function(e,t,n){if(!e||t<=0||!n||!this._treeDocumentPossibleValues)return;const o=new i({label:e+" ("+t+")",attributeId:n});return this._treeDocumentPossibleValues&&this._treeDocumentPossibleValues.addRoot(o),o},_shouldSelectPossibleValue:function(e,t){if(!e||0===e.length||!Array.isArray(e))return!0;if("Blank"===t)return-1!==e.indexOf(void 0)||-1!==e.indexOf(null)||-1!==e.indexOf("");return[...this._idsStruct[t].values].some(t=>(function(e,t){return!!Array.isArray(e)&&-1!==e.indexOf(t)})(e,t))},_getIdsFromValues:function(e){return Array.from(e,e=>null==e||""===e?"Blank":e.toString())}})}),define("DS/DataGridView/DataGridViewNumberFilterView",["DS/Utilities/Dom","DS/DataGridView/DataGridViewConditionBaseFilterView","DS/Controls/ComboBox","DS/Controls/SpinBox","i18n!DS/DataGridView/assets/nls/translation"],function(e,t,i,n,o){"use strict";return t.inherit({name:"datagridviewnumberfilterview",publishedProperties:{},buildConditionElements:function(t){const l={container:null,chooser:null,editor:null,rangeLabels:[],rangeMaxEditor:null};l.container=document.createElement("div"),l.chooser=new i({enableSearchFlag:!1,elementsList:[{label:this.getConditionLabel("range"),value:"range"},{label:this.getConditionLabel("equal"),value:"equal"},{label:this.getConditionLabel("notEqual"),value:"notEqual"},{label:this.getConditionLabel("lessThan"),value:"lessThan"},{label:this.getConditionLabel("lessThanOrEqual"),value:"lessThanOrEqual"},{label:this.getConditionLabel("greaterThan"),value:"greaterThan"},{label:this.getConditionLabel("greaterThanOrEqual"),value:"greaterThanOrEqual"},{label:this.getConditionLabel("empty"),value:"empty"},{label:this.getConditionLabel("notEmpty"),value:"notEmpty"}],value:"range"}).inject(l.container);var r=this,s={allowUndefinedFlag:!0,value:void 0,placeholder:" "};this.filter&&void 0!==this.filter.filterOptions&&Object.assign(s,this.filter.filterOptions),l.editor=this.buildEditor(s),l.editor&&l.editor.inject(l.container);const a=()=>{""!==l.editor.valueToCommit&&void 0!==l.editor.valueToCommit&&("range"!==l.chooser.value||""!==l.rangeMaxEditor.valueToCommit&&void 0!==l.rangeMaxEditor.valueToCommit)?this.displayConditionElements(t+1):this.hideConditionElements(t+1),r.fire("change")},d=()=>{this.isConditionEmpty(l)?this.hideConditionElements(t+1):this.displayConditionElements(t+1),r.fire("change")};l.editor instanceof n&&l.editor.addEventListener("uncommittedChange",a),l.editor.addEventListener("change",d);const u=()=>{if("empty"===l.chooser.value||"notEmpty"===l.chooser.value?(l.editor.remove(),l.editor.value=void 0):l.editor.inject(l.container),"range"===l.chooser.value){if(null===l.rangeMaxEditor){l.rangeMaxEditor=this.buildEditor(s),l.rangeMaxEditor instanceof n&&l.rangeMaxEditor.addEventListener("uncommittedChange",a),l.rangeMaxEditor.addEventListener("change",d);const e=document.createElement("div");e.textContent=o.get("FilterView_Number_Range_From"),l.rangeLabels.push(e);const t=document.createElement("div");t.textContent=o.get("FilterView_Number_Range_To"),l.rangeLabels.push(t)}l.container.insertBefore(l.rangeLabels[0],l.editor.getContent()),l.container.appendChild(l.rangeLabels[1]),l.rangeMaxEditor.inject(l.container)}else null!==l.rangeMaxEditor&&(l.rangeLabels[0].remove(),l.rangeLabels[1].remove(),l.rangeMaxEditor.remove());r.fire("change"),d()};return e.addEventOnElement(this,l.chooser,"change",u),u(),l},refreshConditionElements:function(e,t){t?e.container&&(e.chooser.value=t.type,Array.isArray(t.filter)&&"range"===t.type?(e.editor.value=t.filter[0],e.rangeMaxEditor.value=t.filter[1]):e.editor.value=t.filter):this.resetConditionElements(e)},resetConditionElements:function(e){e&&e.container&&(e.chooser.selectedIndex=0,e.editor.value=void 0,e.rangeMaxEditor&&(e.rangeMaxEditor.value=void 0))},buildConditionFilterModel:function(e){const t={type:e.chooser.value};return"range"===t.type?t.filter=[e.editor.value,e.rangeMaxEditor.value]:"empty"!==t.type&&"notEmpty"!==t.type&&(t.filter=e.editor.value),t},isConditionEmpty:function(e){if(!e.container)return!0;if("empty"===e.chooser.value||"notEmpty"===e.chooser.value)return!1;if(void 0===e.editor.value||null===e.editor.value||""===e.editor.value)return!0;if("range"===e.chooser.value){if(void 0===e.rangeMaxEditor.value||null===e.rangeMaxEditor.value||""===e.rangeMaxEditor.value)return!0;if(e.rangeMaxEditor.value<e.editor.value)return!0}return!1},focusConditionElements:function(e){e&&e.editor&&e.editor.focus()},buildContentView:function(){var e=this._popupContentDiv;e&&(e.addClassName("wux-datagridview-filter-number"),this._parent())},buildEditor:function(e){return new n(e)},getConditionLabel:function(e){let t="";switch(e){case"range":t=o.get("FilterView_Number_Range");break;case"equal":t=o.get("FilterView_Number_Equals");break;case"notEqual":t=o.get("FilterView_Number_DoesNotEqual");break;case"lessThan":t=o.get("FilterView_Number_LessThan");break;case"lessThanOrEqual":t=o.get("FilterView_Number_LessThanOrEqual");break;case"greaterThan":t=o.get("FilterView_Number_GreaterThan");break;case"greaterThanOrEqual":t=o.get("FilterView_Number_GreaterThanOrEqual");break;case"empty":t=o.get("FilterView_Number_Empty");break;case"notEmpty":t=o.get("FilterView_Number_NotEmpty");break;default:return!0}return t}})}),define("DS/DataGridView/DataGridViewStringRegExpFilterView",["DS/DataGridView/DataGridViewConditionBaseFilterView","DS/Controls/ComboBox","DS/Controls/LineEditor","DS/Utilities/Dom","i18n!DS/DataGridView/assets/nls/translation"],function(e,t,i,n,o){"use strict";return e.inherit({name:"datagridviewstringregexpfilterview",publishedProperties:{},buildConditionElements:function(e){var l=this;const r={container:null,chooser:null,editor:null};r.container=document.createElement("div"),r.chooser=new t({enableSearchFlag:!1,elementsList:[{label:o.get("FilterView_String_Contains"),value:"contains"},{label:o.get("FilterView_String_DoesNotContain"),value:"notContain"},{label:o.get("FilterView_String_Equals"),value:"equal"},{label:o.get("FilterView_String_DoesNotEqual"),value:"notEqual"},{label:o.get("FilterView_String_StartsWith"),value:"startsWith"},{label:o.get("FilterView_String_EndsWith"),value:"endsWith"},{label:o.get("FilterView_String_Empty"),value:"empty"},{label:o.get("FilterView_String_NotEmpty"),value:"notEmpty"}],value:"contains"}).inject(r.container);let s={};this.filter&&void 0!==this.filter.filterOptions&&Object.assign(s,this.filter.filterOptions),s.displayClearFieldButtonFlag=!0,r.editor=new i(s).inject(r.container);const a=t=>{this.isConditionEmpty(r)?l.hideConditionElements(e+1):l.displayConditionElements(e+1),l.fire("change")};n.addEventOnElement(this,r.editor,"uncommittedChange",a);return n.addEventOnElement(this,r.chooser,"change",function(e){"empty"===r.chooser.value||"notEmpty"===r.chooser.value?(r.editor.remove(),r.editor.value=""):r.editor.inject(r.container),l.fire("change"),a()}),r},resetConditionElements:function(e){e&&e.container&&(e.chooser.value="contains",e.editor.value="")},refreshConditionElements:function(e,t){t?e.container&&(e.chooser.value=t.type,e.editor.value=t.filter):this.resetConditionElements(e)},buildConditionFilterModel:function(e){const t={type:e.chooser.value};return"empty"!==t.type&&"notEmpty"!==t.type&&(t.filter=e.editor.valueToCommit),t},isConditionEmpty:function(e){return"empty"!==e.chooser.value&&"notEmpty"!==e.chooser.value&&(void 0===e.editor.valueToCommit||null===e.editor.valueToCommit||""===e.editor.valueToCommit)},focusConditionElements:function(e){e&&e.editor&&e.editor.focus()},buildContentView:function(){var e=this._popupContentDiv;e&&(e.addClassName("wux-datagridview-filter-string"),this._parent())}})}),define("DS/DataGridView/DataGridViewDateFilterView",["DS/Utilities/Dom","DS/DataGridView/DataGridViewNumberFilterView","DS/Controls/DatePicker","i18n!DS/DataGridView/assets/nls/translation"],function(e,t,i,n){"use strict";return t.inherit({name:"datagridviewdatefilterview",publishedProperties:{},buildContentView:function(){var e=this._popupContentDiv;e&&(e.addClassName("wux-datagridview-filter-date"),this._parent())},buildEditor:function(e){return new i(e)},getConditionLabel:function(e){let t="";switch(e){case"range":t=n.get("FilterView_Date_Range");break;case"equal":t=n.get("FilterView_Number_Equals");break;case"notEqual":t=n.get("FilterView_Number_DoesNotEqual");break;case"lessThan":t=n.get("FilterView_Date_LessThan");break;case"lessThanOrEqual":t=n.get("FilterView_Date_LessThanOrEqual");break;case"greaterThan":t=n.get("FilterView_Date_GreaterThan");break;case"greaterThanOrEqual":t=n.get("FilterView_Date_GreaterThanOrEqual");break;case"empty":t=n.get("FilterView_Number_Empty");break;case"notEmpty":t=n.get("FilterView_Number_NotEmpty");break;default:return!0}return t}})}),define("DS/DataGridView/DataGridViewRow",["DS/CollectionView/CollectionViewCell","DS/Utilities/ReusableContentsManager","DS/DataGridView/DataGridViewCell","DS/DataGridView/DataGridViewTreeNodeCell"],function(e,t,i,n){"use strict";return e.inherit({name:"DataGridViewRow",publishedProperties:{},_postBuildView:function(){this._parent(),this._cellPool=new t;var e=this.collectionView,o=e&&e.cellClass?e.cellClass:i;this._registerPool("__item__",o);var l=e&&e.treeNodeCellOptions&&e.treeNodeCellOptions.cellClass?e.treeNodeCellOptions.cellClass:n;this._registerPool("__tree_item__",l)},_registerPool:function(e,t){var i=this;this._cellPool.register({id:e,buildContent:function(){return new t({collectionView:i.collectionView,cellType:e})}})},destroy:function(){this._parent(),this._cellPool&&(this._cellPool.destroy(),this._cellPool=null)},getCellPool:function(){return this._cellPool},getInitialClassName:function(){return this._parent()+" wux-layouts-datagridview-row"},getCleaningMode:function(){return 2},isRow:function(){return!0}})}),define("DS/DataGridView/DataGridViewDateSetFilterView",["DS/Core/Core","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridViewSetFilterView","DS/Utilities/StringUtils","DS/Utilities/DateUtils"],function(e,t,i,n,o){"use strict";return i.inherit({name:"datagridviewdatesetfilterview",publishedProperties:{},_build:function(){this._yearNodes={},this._monthFormat=new Intl.DateTimeFormat(e.currentLanguage,{month:"long"}),this._parent()},buildContentView:function(){this._parent();const e=new Intl.Collator;this._dataGridViewPossibleValues&&(this._dataGridViewPossibleValues.columns[0].compareFunction=function(t,i,o,l,r){return o.isRoot()?n.compareLocal(t,i,{intlCollator:e}):o.options.value-l.options.value})},_cleanBeforeReset:function(e){this._yearNodes={},this._parent(e)},_insertNewNode:function(e,i,n){if(!e||i<=0||!n||!this._treeDocumentPossibleValues)return;const o=new Date(n);if(o.getTime()==o.getTime()){let e=o.getFullYear(),l=null;this._yearNodes&&(l=this._yearNodes[e]),l||(l=new t({label:e.toString(),value:e}),this._yearNodes[e]=l,this._treeDocumentPossibleValues.addRoot(l));let r=o.getMonth(),s=this._getMonthNodeModel(l,r);s||(s=new t({label:this._monthFormat?this._monthFormat.format(o):r,value:r}),l.addChild(s),l.sortChildren({isRecursive:!1,sortFunction:function(e,t){return e.options.value-t.options.value}}));let a=o.getDate();const d=new t({label:a+" ("+i+")",attributeId:n,value:a});return s.addChild(d),d}return this._parent(e,i,n)},_getMonthNodeModel:function(e,t){let i=null;if(e&&void 0!==t){let n=e.getChildren();if(n)for(let e=0;e<n.length;e++){let o=n[e];if(o&&o.options.value===t){i=o;break}}}return i},_shouldSelectPossibleValue:function(e,t){if(!e)return!0;if(!Array.isArray(e))return!1;if(0===e.length)return!0;const i=o.convertToDate(t);return-1!==e.map(e=>Number(o.convertToDate(e))).indexOf(Number(i))},_getIdsFromValues:function(e){return Array.from(e,e=>{if(null==e||""===e)return"Blank";let t=o.convertToDate(e);return t&&(t=new Date(t.getFullYear(),t.getMonth(),t.getDate())),t.toString()})}})}),define("DS/DataGridView/DataGridViewFilterViewManager",["DS/Core/BaseComponent","DS/DataGridView/DataGridViewFilterPopup","DS/DataGridView/DataGridViewStringRegExpFilterView","DS/DataGridView/DataGridViewSetFilterView","DS/DataGridView/DataGridViewDateSetFilterView","DS/DataGridView/DataGridViewNumberFilterView","DS/DataGridView/DataGridViewDateFilterView"],function(e,t,i,n,o,l,r){"use strict";var s=function(e,i){var n=0,o=this._listOfFilterPopups[e];if(!i)return o&&(o.destroy(),this._listOfFilterPopups[e]=void 0,delete this._listOfFilterPopups[e]),0;if(void 0!==o){if(o.filterId===i.filterId)return o.filterViewOptions=this.view&&this.view.filterViewOptions?this.view.filterViewOptions:void 0,o.refreshView(),3;o.destroy(),this._listOfFilterPopups[e]=void 0,delete this._listOfFilterPopups[e],n=1}return this._listOfFilterPopups[e]=new t({filterViewManager:this,propertyId:e,filterId:i.filterId,filter:i,filterViewOptions:this.view&&this.view.filterViewOptions?this.view.filterViewOptions:void 0}),1+n};return e.inherit({name:"datagridviewfilterviewmanager",publishedProperties:{view:{defaultValue:void 0,type:"object",readOnly:!0},filterManager:{defaultValue:void 0,type:"object"}},registerFilterView:function(e,t){this.FILTERVIEWS_MAP[e]=t},refreshFilterViews:function(){if(this.filterManager){var e=this,t=Object.keys(this._listOfFilterPopups),i=this.filterManager.getFilters();Object.keys(i).forEach(function(n){s.call(e,n,i[n]);var o=t.indexOf(n);-1!==o&&t.splice(o,1)}),t.forEach(function(t){e._listOfFilterPopups[t].destroy(),delete e._listOfFilterPopups[t]})}},getFilterPopups:function(){return this._listOfFilterPopups},getFilterViews:function(){var e={},t=this;return Object.keys(this._listOfFilterPopups).forEach(function(i){var n=t._listOfFilterPopups[i];if(n){var o=n.getActiveFilterView();o&&(e[i]=o)}}),e},isEmpty:function(){var e=this;return Object.keys(this._listOfFilterPopups).every(function(t){return!e._listOfFilterPopups[t].filter||e._listOfFilterPopups[t].filter.isEmpty()})},disableUpdateView:function(){this._preventUpdateView++},enableUpdateView:function(){this._preventUpdateView--},getFilterViewClassName:function(e){return this.FILTERVIEWS_MAP[e]},_build:function(){this.FILTERVIEWS_MAP={set:n,dateSet:o,stringStdexp:i,stringRegexp:i,numberWithCondition:l,dateWithCondition:r},this._listOfFilterPopups={},this._onFilterModelChangeToken=void 0,this._preventUpdateView=0},_applyFilterManager:function(e){var t=this;this._onFilterModelChangeToken&&e&&e.unsubscribe(this._onFilterModelChangeToken);var i=Object.keys(this._listOfFilterPopups);i.length>0&&i.forEach(function(e){t._listOfFilterPopups[e].destroy(),delete t._listOfFilterPopups[e]}),this.filterManager&&(this._onFilterModelChangeToken=this.filterManager.subscribe("filterModelChange",function(e){t._preventUpdateView>0||(e?s.call(t,e.propertyId,e.filter):t.refreshFilterViews())}),this.refreshFilterViews())},_applyProperties:function(e){this._parent(e),this.isDirty("filterManager")&&this._applyFilterManager(e.filterManager)}})}),define("DS/DataGridView/CustomViewsManager",["DS/DataGridView/DataGridViewCustomViewsDialog","DS/Utilities/Utils","DS/TreeModel/ModelUtils","DS/Utilities/Dom","i18n!DS/DataGridView/assets/nls/translation"],function(e,t,i,n,o){"use strict";let l=o.get("DefaultConfiguration");const r=[{identifier:"DefaultConfiguration",label:l}];var s=function(e){this.collectionView=e.collectionView?e.collectionView:void 0,this.name="CustomViewsManager",this._customViews=[...r],this._currentCustomViewIdentifier=void 0,this._customViewsDialog=void 0,this._prefsLoaded=!1};return s.prototype.getCustomViews=function(){return 0!==this._customViews.length&&!1!==this._prefsLoaded||this._loadCustomViewsFromPreferences(),this._customViews},s.prototype.getCustomView=function(e){return this._getCustomViewInArray(this._customViews,e)},s.prototype.getCurrentCustomView=function(){return this.getCustomView(this.getCurrentCustomViewIdentifier())},s.prototype.getCurrentCustomViewIdentifier=function(){return this._currentCustomViewIdentifier},s.prototype.getCurrentCustomViewIndex=function(){for(var e=0;e<this._customViews.length;e++)if(this._customViews[e].identifier===this.getCurrentCustomViewIdentifier())return e;return-1},s.prototype._setCustomViews=function(e){this._customViews=e,t.saveDataInPreferences(this.collectionView,this.collectionView.layout._dataGridViewPrefKey,"customViews",this._customViews,this.collectionView.useWidgetPreferencesFlag)},s.prototype.setCurrentCustomView=function(e){this._currentCustomViewIdentifier=e;var t=this.getCustomView(e);if(t){var o=this.collectionView.layout;this.collectionView.prepareUpdateView();for(var l=!1,r=t.columnsVisibleFlag,s=t.columnsWidth,a=t.columnsPinnedState,d=o.getLeafColumns(),u=0;u<d.length;u++){var h=d[u].dataIndex,c=r?r[h]:void 0,g=o._getOriginalColumnOptionValue(h,"visibleFlag"),p=o.getColumnVisibleFlag(h);void 0!==c&&c!==p?o.setColumnVisibleFlag(h,c,{isUserInteraction:!0}):void 0===c&&p!==g&&o.setColumnVisibleFlag(h,g);var m=s?s[h]:void 0,f=o._getOriginalColumnOptionValue(h,"width"),C=o.getColumnWidth(h);void 0!==m&&m!=C?o.setColumnWidth(h,m,{isUserInteraction:!0}):void 0===m&&C!=f&&o.setColumnWidth(h,f);var _=a?a[h]:void 0,w=o._getOriginalColumnOptionValue(h,"pinned"),v=o.getColumnPinned(h);void 0!==_&&_!==v?o.setColumnPinned(h,_,{isUserInteraction:!0}):void 0===_&&v!==w&&o.setColumnPinned(h,w)}var D=o._getOrderedColumnIndexesFromChanges(t);UWA.equals(o._orderedColumnsIndexes,D)||(o._orderedColumnsIndexes=D.slice(0),o._computeOrderedColumnsReverseIndexes(),o._updateColumnTreeFromOrderedIndexes(),this.collectionView.invalidateLayout(),l=!0);var I=this.collectionView._rowModel._originalSortModel||[],V=this.collectionView.sortModel||[],y=t.columnsSortModel,b=this.collectionView.sortModel;Array.isArray(V)&&Array.isArray(y)&&JSON.stringify(V)!==JSON.stringify(y)?b=y:void 0===y&&JSON.stringify(V)!==JSON.stringify(I)&&(b=I),n.isCurrentlyCalledFromUIInteraction()&&(this.collectionView.sortModel&&this.collectionView.sortModel.length>0&&(!b||0===b.length)?i.restoreTreeDocumentOrder(this.collectionView.treeDocument):b&&b.length>0&&(!this.collectionView.sortModel||0===this.collectionView.sortModel.length)&&i.saveTreeDocumentOrder(this.collectionView.treeDocument)),this.collectionView.sortModel=b;var M=t.layoutDensity||o._getOriginalLayoutDensity();if(o.layoutDensity=M,this.collectionView.invalidateLayout(),l=!0,o._saveColumnSortModelInPreferences(),(M=t.layoutDensity)&&o.layoutDensity!==M&&(o.layoutDensity=M),this.collectionView.rowGroupingEnabledFlag&&t.groupingOptions){var x=t.groupingOptions;this.collectionView.getGroupingOptions()&&this.collectionView.getGroupingOptions().dataIndexesToGroup.equals(x)||(l=!0,this.collectionView.groupRows(x))}this._modifyDataGridViewPreferences(t),this.collectionView.layout._saveDataInPreferences("currentCustomViewId",this.getCurrentCustomViewIdentifier());var S={};l&&(S={updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),this.collectionView.pushUpdateView(S)}},s.prototype.createNewCustomView=function(){let e=1,t="CustomConfiguration"+e,i=this.getEditedCustomView(t);for(;i;)t="CustomConfiguration"+ ++e,i=this.getEditedCustomView(t);let n=o.get("CustomViewDefaultName"),l=1,r=n+" "+l;for(i=this.getCustomViewFromLabel(r);i;)r=n+" "+ ++l,i=this.getCustomViewFromLabel(r);let s={identifier:t,label:r};return this.addCustomView(s),this.setCurrentCustomView(s.identifier),s},s.prototype.addCustomView=function(e,t=!1){const i=this._customViews.reduce((e,t,i)=>(e[t.identifier]=i,e),{}),n=e=>{e.identifier&&e.identifier===l&&(e.identifier="DefaultConfiguration",e.label=l);const n=i[e.identifier];void 0===n?this._customViews.push(e):(!0===t||"DefaultConfiguration"===this._customViews[n].identifier&&1===Object.keys(this._customViews[n]).length)&&(this._customViews[n]=e)};if(Array.isArray(e))for(const t of e)n(t);else n(e)},s.prototype.deleteCustomView=function(e){for(var t=0;t<this._customViews.length&&this._customViews[t].identifier!==e;t++);this._customViews.splice(t,1),this._currentCustomViewIdentifier===e&&(this._currentCustomViewIdentifier=void 0)},s.prototype._loadCustomViewsFromPreferences=function(){if(0===this._customViews.length||!1===this._prefsLoaded){const o=t.getDataInPreferences(this.collectionView,this.collectionView.layout._dataGridViewPrefKey,"customViews",this.collectionView.useWidgetPreferencesFlag);o&&o.length>0&&this.addCustomView(o,!0),this._currentCustomViewIndex=-1;var e=t.getDataInPreferences(this.collectionView,this.collectionView.layout._dataGridViewPrefKey,"currentCustomViewId",this.collectionView.useWidgetPreferencesFlag);if(e)for(var i=0;i<this._customViews.length;i++){var n=this._customViews[i];if(n&&n.identifier===e){this._currentCustomViewIdentifier=e,this._currentCustomViewIndex=i;break}}this._prefsLoaded=!0}},s.prototype.setCustomViews=function(e,t,i,n){e&&(this._setCustomViews(e),i&&this.setCurrentCustomView(t),n&&(this.onCustomViewsSave&&this.onCustomViewsSave.call(this,e,t),this.collectionView.onCustomViewsSave&&this.collectionView.onCustomViewsSave.call(this,e,this.getCurrentCustomViewIndex())),i&&this.collectionView.layout._applyPreferencesOnColumns())},s.prototype._getCustomViewInArray=function(e,t){var i;if(e)for(var n=0;n<e.length;n++){var o=e[n];if(o&&o.identifier===t){i=o;break}}return i},s.prototype._modifyDataGridViewPreferences=function(e){for(var t=["columnsPinnedState","columnsVisibleFlag","columnsWidth","pinnedColumnsOrder","unpinnedColumnsOrder","columnsSortModel"],i=this.collectionView.layout,n=0;n<t.length;n++)i.deleteDataGridViewKeyPreference(t[n]),e[t[n]]&&i._saveDataInPreferences(t[n],e[t[n]])},s.prototype.showCustomViewsDialog=function(){var t=!!(this.collectionView&&this.collectionView.customViewsOptions&&this.collectionView.customViewsOptions.dialogMaximizedFlag);return this._customViewsDialog||(this._customViewsDialog=new e({identifier:this.collectionView.identifier+"_CustomViewsDialog",dataGridView:this.collectionView,maximizeButtonFlag:!0,allowMaximizeFlag:!0,maximizedFlag:t,immersiveFrame:this.collectionView&&this.collectionView.getContainingImmersiveFrame?this.collectionView.getContainingImmersiveFrame():void 0})),this._customViewsDialog.loadCustomViews(),this._customViewsDialog.immersiveFrame=this.collectionView.getContainingImmersiveFrame(),this._customViewsDialog.visibleFlag=!0,this._customViewsDialog.maximizedFlag=t,this._customViewsDialog},s.prototype.destroy=function(){this._customViewsDialog&&(this._customViewsDialog.destroy(),this._customViewsDialog=null),this._customViews=void 0,this._currentCustomViewIdentifier=void 0,this.collectionView=void 0},s}),define("DS/DataGridView/DataGridViewRowHeaderCell",["UWA/Core","DS/Core/Core","DS/DataGridView/DataGridViewCell","DS/Utilities/Utils","DS/Utilities/Dom","DS/Controls/Toggle"],function(e,t,i,n,o,l){"use strict";return i.inherit({name:"DataGridViewRowHeaderCell",publishedProperties:{},buildView:function(){this._parent(),new e.Element("div",{class:"wux-datagridview-selection-label"}).inject(this.elements.container)},buildDragGrip:function(){this.elements._dragGrip||(this.elements._dragGrip=o.generateIcon({iconName:"drag-grip",fontIconFamily:WUXManagedFontIcons.Font3DS}),this.elements._dragGrip.classList.add("wux-datagridview-drag-grip"),this.elements._dragGrip.setAttribute("draggable",!0),this.elements._dragGrip.inject(this.elements.container,"top"))},buildSelectionCheckBox:function(){this.elements._selectionCheckBox||(this.elements._selectionCheckBox=new l({type:"checkbox",checkFlag:!1,fireOnlyFromUIInteractionFlag:!0}),this.elements._selectionCheckBox.getContent().classList.add("wux-datagridview-selection-checkbox"),this.elements._selectionCheckBox.inject(this.elements.container))},getSelectionCheckBox:function(){return this.elements._selectionCheckBox},getInitialClassName:function(){return this._parent()+" wux-layouts-datagridview-row-header-cell"},getCleaningMode:function(){return 2}})}),define("DS/DataGridView/RowModelClientSide",["DS/DataGridView/RowModelBase","DS/DataGridView/DataGridViewFilterViewManager","DS/Utilities/StringUtils","DS/Utilities/Dom","i18n!DS/DataGridView/assets/nls/translation"],function(e,t,i,n,o){"use strict";function l(e){return null==e||""===e}return e.inherit({name:"RowModelClientSide",publishedProperties:{dataGridView:{defaultValue:null,type:"object"},treeDocument:{defaultValue:null,type:"object"},sortModel:{defaultValue:null,type:"array"}},_applyProperties:function(e){this._parent(e),this.isDirty("treeDocument")&&this._applyTreeDocument(e.treeDocument),this.isDirty("sortModel")&&this._applySortModel(e.sortModel)},_getTreeDocument:function(){return this.treeDocument},getVisibleNodeModel:function(e){return this.dataGridView.getNodeModelAtRowID(e)},_isModelBeingFetched:function(){return!1},_applyTreeDocument:function(e){if(this._removeModelEvents(e),this._removeXSOEventsListener(e),this.treeDocument){var i=this.dataGridView;i&&(i._rowModel=this);var n=this.treeDocument.getFilterManager();n&&(this._filterViewManager?this._filterViewManager.filterManager=n:this._filterViewManager=new t({view:this.dataGridView,filterManager:n})),this._listenToTreeDocument()}},_syncModel:function(e){var t=this.dataGridView;t._hasFlatTreeState=!0;var i=[],n=0,o=this._getCurrentPaginationOptions();if(this._getTreeDocument()){this._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!0,processNode:function(e){if(t.shouldNodeBeRepresented(e.nodeModel)){if(o){if(n<o.nodeMin)return-1===o.paginationNodeDepth||e.nodeModel.getNodeDepth()===o.paginationNodeDepth?(n++,{shouldProcessDescendants:-1===o.paginationNodeDepth}):void 0;if(n>o.nodeMax&&(-1===o.paginationNodeDepth||e.nodeModel.getNodeDepth()<=o.paginationNodeDepth))return{stopProcessing:!0};-1!==o.paginationNodeDepth&&e.nodeModel.getNodeDepth()!==o.paginationNodeDepth||n++}i.push(e.nodeModel),e.nodeModel.getChildren()&&(t._hasFlatTreeState=!1)}}}),t.prepareUpdateView();var l=!(!e||!(e.updateType&WUXModelUpdateTypes.Addition||e.updateType&WUXModelUpdateTypes.Removal||e.updateType&WUXModelUpdateTypes.Expand));l&&UWA.equals(t.model,i)?UWA.equals(t.model,i)&&t.updateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}):e&&e.updateType&WUXModelUpdateTypes.Filtering&&UWA.equals(t.model,i)?t.updateRowView(-1,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}):t.model=i,l&&t._applyMaxVisibleRowCount(void 0,t.maxVisibleRowCount,!0),t._rowModel&&t.findStr&&""!==t.findStr&&!t._muteFind&&t.setFindStr(t.findStr,t.matchCase,t._rowModel._computeFindEditorCurrentValue(),!0,!0),t.pushUpdateView()}},_applySortModel:function(e){this._parent();var t=this.dataGridView;if(this.sortModel&&this.sortModel.length>0){var n=this.treeDocument;if(n){for(var o=t.layout,r=[],s=new Intl.Collator,a=0;a<this.sortModel.length;a++){var d=this.sortModel[a].dataIndex,u=o.getColumnIndex(d);if(u>-1){var h=o.getColumnCompareFunction(u);h||h||(h=function(e,t,n,o,r){return"string"==typeof e&&"string"==typeof t?i.compareLocal(e,t,{intlCollator:s}):UWA.equals(e,t)||l(e)&&l(t)?0:e>t?1:e<t?-1:l(e)&&!l(t)?-1:1});var c="desc"===this.sortModel[a].sort?-1:1;r.push({dataIndex:d,compareFunction:h,reverseFactor:c})}t.updateRowView(-1,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})}n._getTrueRoot().sortChildren({isRecursive:!0,sortFunction:function(e,i){for(var n=0,o=0;o<r.length&&0===n;){var l=r[o],s=t._getCellValueForSort(e,l.dataIndex),a=t._getCellValueForSort(i,l.dataIndex);n=l.reverseFactor*l.compareFunction(s,a,e,i,l.dataIndex),o++}return 0===n?e._getID()-i._getID():n}})}}else t.updateRowView(-1,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})},_doGroupingOnModel:function(e){var t=this,i=t.treeDocument,l=this.dataGridView;const r=l._isCurrentlyCalledFromUIInteraction();l.displayModalLoader(o.get("UpdatingGrouping"),function(){i.prepareUpdate();const s=i.addEventListener("groupNodes",()=>{i.removeEventListener(s),r&&n.pushUserInteractionContext(),t._applySortModel(),r&&n.popUserInteractionContext(),i.pushUpdate(),l.removeModalLoader(o.get("UpdatingGrouping"))}),a=function(e,t){const i=l.layout.getColumnGetCellValue(t);if(i){const n=l.layout.getColumnIdentifiers(t),o={cellID:l.layout.getCellIDFromCoordinates({rowID:e._getRowID(),columnID:n.columnIndex}),columnID:n.columnIndex,rowID:e._getRowID(),nodeModel:e};return i.call(l,o)}return e.getAttributeValue("tree"===t?"label":t)},d={propertiesToGroup:e.dataIndexesToGroup,canNodeBeGrouped:e=>!l.rowGroupingOptions.canNodeBeGrouped||l.rowGroupingOptions.canNodeBeGrouped(e),mapGroupingKeys:l.rowGroupingOptions.mapGroupingKeys,getNodeGroupingKey:function(e,t){var i=l.layout.getColumnGetCellGroupingKey(t);if(i){var n=l.layout.getColumnIdentifiers(t),o=l.layout.getCellIDFromCoordinates({rowID:e._getRowID(),columnID:n.columnIndex}),r=l.getLightCellInfosAt(o);return r.nodeModel=e,i.call(l,r,t)}return l.rowGroupingOptions.getNodeGroupingKey?l.rowGroupingOptions.getNodeGroupingKey(e,t):a(e,t)},updateGroupingNodeOptions:function(e){const t=this.getProperty();let i,n;if(l.rowGroupingOptions.getGroupingNodeLabel)i=l.rowGroupingOptions.getGroupingNodeLabel.call(l,this);else{let e=this.getIdentifier();"NA"===e&&(e=o.get("GroupingEmptyValueLabel"));const n=l.layout.getColumnOptionValue(t,"text");i=(n?n+": ":"")+e+" ("+this.getOriginalChildrenInformation().notHiddenNotFilteredChildrenCount+")"}l.rowGroupingOptions.getGroupingNodeIcons&&(n=l.rowGroupingOptions.getGroupingNodeIcons.call(l,this));const r={label:i,icons:n,grid:{}};l.rowGroupingOptions.getGroupingNodeOptions?r.grid=l.rowGroupingOptions.getGroupingNodeOptions.call(l,this,e):l.layout.getLeafColumns().forEach(function(t){var i=l.layout.getColumnOptionValue(t.dataIndex,"getGroupingNodeOptions");if(i)if("string"==typeof i)switch(i){case"sum":var n=0;e.forEach(function(e){n+=parseInt(a(e,t.dataIndex),10)}),r.grid[t.dataIndex]=n;break;case"avg":n=0,e.forEach(function(e){n+=parseInt(a(e,t.dataIndex),10)}),r.grid[t.dataIndex]=n/e.length;break;case"min":var o=void 0;e.forEach(function(e){var i=a(e,t.dataIndex);(void 0===o||i<o)&&(o=i)}),r.grid[t.dataIndex]=o;break;case"max":var s=void 0;e.forEach(function(e){var i=a(e,t.dataIndex);(void 0===s||i>s)&&(s=i)}),r.grid[t.dataIndex]=s;break;case"first":r.grid[t.dataIndex]=a(e[0],t.dataIndex);break;case"last":r.grid[t.dataIndex]=a(e[e.length-1],t.dataIndex)}else{var d=[];e.forEach(function(e){d.push(a(e,t.dataIndex))}),r.grid[t.dataIndex]=i.call(l,d)}}),this.updateOptions(r)}},u=l.rowGroupingOptions.depth;i.groupNodes(u,d)})},_computeMatchingCellIDsCount:function(){return this.dataGridView._matchingCellIDsArray.length},_computeMatchingNodeModelsCount:function(){return this.dataGridView._matchingNodeModelsArray.length},_computeCurrentMatchingStringIndex:function(e,t){var i;return i=t>0?t-1:0,"cell"===e.findNavigationMode?e._getMatchingStringIndexFromMatchingCellIDIndex(i):"row"===e.findNavigationMode?e._getMatchingStringIndexFromMatchingRowIDIndex(i):i},_computeFindEditorCurrentValue:function(){return"substring"===this.dataGridView.findNavigationMode?this.dataGridView._currentMatchingStringIndex+1:"cell"===this.dataGridView.findNavigationMode?this.dataGridView._currentMatchingCellIDIndex+1:this.dataGridView._currentMatchingRowIDIndex+1},_getNodeModelsToProcessFromMatchCaseChange:function(){return this.dataGridView._matchingNodeModelsArray},_isServerSide:function(){return!1},_getNodeModelAtRowID:function(e){if(this.dataGridView.model&&Array.isArray(this.dataGridView.model))return this.dataGridView.model[e]},_getDataGridViewModelDisplayedLength:function(){return this.dataGridView.model&&Array.isArray(this.dataGridView.model)?this.dataGridView.model.length:0}})}),define("DS/DataGridView/RowModelServerSide",["DS/DataGridView/RowModelBase","DS/TreeModel/TreeNodeModel","DS/Utilities/Object","DS/DataGridView/DataGridViewFilterViewManager","UWA/Core","DS/TreeModel/FilterManager"],function(e,t,i,n,o,l){"use strict";function r(e){return e._treeDocument&&e._treeDocument.options.nodeModelClass?e._treeDocument.options.nodeModelClass:t}function s(e){let t=e.groupedRequests,n=e.startRow,o=e.parentNode,l=e.currentTimeStamp,s=e.rowModel,a=e.rowModel.dataGridView;if(!t||!t.length){t=[];let e={request:{}};e.request.startRow=n,e.parentNode=o,t.push(e)}return{successCallback:(e,d,u)=>{if(!a.elements||!a.elements.container)return;let h=void 0,c=-1,g=0,p={},m=0;if(e instanceof Array)h=e,c=d,g=u,m=1,p.rows=[h],p.lastRow=[c],p.numberOfChildren=[g];else if(e.groupedRequestResult){if(m=e.groupedRequestResult.rows?e.groupedRequestResult.rows.length:0,t.length!==m)throw new Error("ERROR: returned grouped request result count does not match input request count.");p=e.groupedRequestResult}else h=e.rows,c=e.lastRow,g=e.numberOfChildren,m=1,p.rows=h,p.lastRow=c,p.numberOfChildren=g;if(l&&l!==s._lastModelRequestTimeStamp)return;let f=!1,C=r(s),_=s._treeDocument.getUseChangeTransactionMode();s._treeDocument.setUseChangeTransactionMode(!1);let w=[];for(let e=0;e<m;e++){let l=t&&e<t.length?t[e].parentNode:o;if(!l||!l.getParent()&&!l._isTrueRoot())continue;let r=t&&e<t.length?t[e].request.startRow:n,d=p.rows[e],u=p.lastRow?p.lastRow[e]:void 0,h=p.numberOfChildren[e];if(0!==h&&0!==u){let e=r,t=[],n=[];if(!0===s.virtuallyLoadAllModelItems){if(void 0===h)throw new Error("Error : need to provide total number of children (numberOfChildren) for all nodes when virtuallyLoadAllModelItems is set to true.");if(s._getCurrentPaginationOptions()&&(r-=s._getCurrentPaginationOptions().nodeMin),s.dataGridView.model.length&&(e=s._getRealPositionInParentNode(l,r)),s._loadedUnloadedNodesMap){let e=s._loadedUnloadedNodesMap.get(l);if(e)for(let t=1;t<e.length;t++)n.push(e[t])}t=s._updateLoadedUnloadedData(l,h,r,d.length,s._loadedUnloadedNodesMap)}let o=e;f||(s.prepareUpdate(),f=!0);let c=[];for(let e=0;e<d.length;e++){let t=r+e;c.push(s._getFakeNodeExpandedChildrenInClientModel(l,t))}let g=l.getChildren()?l.getChildren().length:0,p=[],m=[],_=[],D=0;for(let e=0;e<g;e++){let t=l.getChildren()[e];if(void 0!==t.options.multipleNodesRep){if(D+=t.options.multipleNodesRep,t.isExpanded()){p.push(t),m.push(D);let e=t.buildStringIdentifierArray().join(";");_.push(e)}}else D++}for(let e=0;e<d.length;e++){let t=d[e],a=r+e,u=l.getChildren()?l.getChildren().length:0,h=!0===s.virtuallyLoadAllModelItems?s._isNodeAlreadyLoaded(a,n):r+e<u,g=s._createNodeModelFromData(t,C);if(c[e]){for(let t=c[e].length-1;t>=0;t--){let i=c[e][t];if(i){let e=i.getParent();if(e){let t=s._loadedUnloadedNodesMap.get(e);t&&(s._loadedUnloadedNodesMap.set(g,t),s._rowRequestManager.set(g,t))}g.addChild(i,0)}}g.setState({state:"expanded"})}if(h){if(!s._currentMatchingNodeModel||!i.areEquals(s._currentMatchingNodeModel.options.grid,g.options.grid)){var v=s._getNodeInClientModel(l,a);v&&s.dataSource.onNodeModelUpdate(v,t,!1),g.destroy&&g.destroy(),o++;continue}l.removeChild(s._currentMatchingNodeModel),s._currentMatchingNodeModel=g}s.dataSource.onNodeModelUpdate(g,t,!0),l.addChild(g,o),o++;let f=g.buildStringIdentifierArray().join(";"),D=_.indexOf(f);if(-1!==D&&(p.splice(D,1),m.splice(D,1),_.splice(D,1)),t.wux_isSelected&&w.push(g),t.isExpanded&&g.getChildren()&&!g.getChildren().length&&g.expand(),s._providePushNotifVisualFeedBack){let e=g._getRowID();null!=e&&s.dataGridView._flashEffectOnRow("ui-modified-push-notif",e)}}s._providePushNotifVisualFeedBack=!1,!0===s.virtuallyLoadAllModelItems&&s._updateMultipleNodesRep(l,t),s._insertBackFakeExpandedNodes(l,p,m);let I=s._rowRequestManager.get(l);if(s.virtuallyLoadAllModelItems||void 0!==I&&s._rowRequestManager.set(l,Math.min(I,l.getNumberOfChildren(!0)-s.dataSource.rowsOffsetToTriggerRequest)),h&&(l._dgv_numberOfChildren=h,a.paginationManager&&l===s._getTreeDocument()._getTrueRoot()&&a.paginationManager.pageNumberModified()),u>-1&&((!s.virtuallyLoadAllModelItems||1===t.length&&t[0]===h)&&(l._dgv_allRowsLoaded=!0),!l._dgv_numberOfChildren&&l===s._getTreeDocument()._getTrueRoot())){let e=s._getCurrentPaginationOptions();if(e){let t=(e.currentPage-1)*e.pageSize;l._dgv_numberOfChildren=l._options.children?l._options.children.length:0,l._dgv_numberOfChildren+=t,a.paginationManager.pageNumberModified()}else l._dgv_numberOfChildren=l._options.children?l._options.children.length:0}0===e&&l.preExpandDone()}}for(let e=0;e<w.length;e++){let t=w[e];t&&t.select()}f?(s._treeDocument._indexRowIndexes(),s._syncModel({updateType:WUXModelUpdateTypes.Addition}),!0===s._modalLoaderDisplayed&&(a.removeModalLoader(),s._modalLoaderDisplayed=!1),a.model&&0===a.model.length?a._displayEmptyContentMessage():a._removeEmptyContentMessage(),s._gettingRowsFlag=!1,s._treeDocument.setUseChangeTransactionMode(_),s._getGroupingOptions()&&s._getGroupingOptions().dataIndexesToGroup&&s._getTreeDocument().getModelEvents().publish({event:"groupNodes"}),s.pushUpdate()):!0===s._modalLoaderDisplayed&&(a.removeModalLoader(),s._modalLoaderDisplayed=!1)},failCallback:function(e){!0===s._modalLoaderDisplayed&&(a.removeModalLoader(),s._modalLoaderDisplayed=!1),e&&console.warn(e),s._gettingRowsFlag=!1}}}return e.inherit({name:"RowModelServerSide",publishedProperties:{dataGridView:{defaultValue:null,type:"object"},dataSource:{defaultValue:null,type:"object"},sortModel:{defaultValue:null,type:"array"},virtuallyLoadAllModelItems:{defaultValue:!1,type:"boolean"}},_preBuild:function(){this._parent(),this._rowRequestManager=new Map,this._loadedUnloadedNodesMap=new Map,this._DGVRowIDNodeModelMapping=new Map,this._DGVNodeModelRowIDMapping=new Map},_applyProperties:function(e){this._parent(e),this.isDirty("dataSource")&&this._applyDataSource(e.dataSource),this.isDirty("sortModel")&&this._applySortModel(e.sortModel)},_updateModel:function(){this._resetTreeDocument()},_loadGroupOfRows:function(e){let t=this.dataGridView,i=[],n=t.layout.getMinMaxVisibleRowIDs(),o=Math.max(n.minRowID-this.dataSource.rowsOffsetToTriggerRequest,0),l=Math.min(n.maxRowID+this.dataSource.rowsOffsetToTriggerRequest,this.getRowModelLength());for(let t=0;t<e.length;t++){let n=e[t],s=n.parentNode;if(s._dgv_allRowsLoaded)continue;if(!s||!s.getParent()&&!s._isTrueRoot())continue;let u=s._getRowID(),h=n.requestData.startRow,c=n.requestData.endRow,g=u+h,p=u+c;"number"==typeof n.requestData.absoluteStartRow&&(p=(g=n.requestData.absoluteStartRow)+Math.abs(c-h));let m=Math.min(g,p),f=!1;if((Math.max(g,p)<o||m>l)&&(f=!0),f){var r,a=this._loadedUnloadedNodesMap.get(s);if(a){r=[];for(var d=0;d<a.length;d++)r.push(a[d])}this._rowRequestManager.set(s,r);continue}let C=s.buildStringIdentifierArray(),_={startRow:h,endRow:c,sortModel:this.sortModel,rowGrouping:this._getGroupingOptions(),groupKeys:C,filterModel:this.getFilterManager()?this.getFilterManager().filterModel:void 0};i.push({request:_,parentNode:s})}let u=i.sort(function(e,t){let i=e.request.groupKeys.length,n=t.request.groupKeys.length;return i>n?-1:n>i?1:0});if(u.length>0){let e={},i=[];for(let e=0;e<u.length;e++)i.push(u[e].request);e.groupedRequest=i;let n=s({groupedRequests:u,rowModel:this});this._gettingRowsFlag=!0,0!==t.model.length||this._modalLoaderDisplayed||(t.displayModalLoader("Loading data"),this._modalLoaderDisplayed=!0),this.dataSource.getModelItems({request:e,successCallback:n.successCallback,failCallback:n.failCallback})}return!0},_loadRows:function(e,t,i,n){if(!this._treeDocument)return!1;if(e||(e=this._treeDocument._getTrueRoot()),!e)return!1;void 0===i&&(i=0,this._providePushNotifVisualFeedBack=!1);var o=this.dataGridView;if(e._dgv_allRowsLoaded&&(!o.paginationManager||e!==this._getTreeDocument()._getTrueRoot()))return!1;var l,r,a=e.buildStringIdentifierArray(),d=this._getCurrentPaginationOptions();if(d&&e===this._treeDocument._getTrueRoot()){var u=(d.currentPage-1)*d.pageSize;if(r=(l=n?n.startRow+u:e.getChildren()?e.getChildren().length+u:u)+this.dataSource.numberOfRowsPerRequest-1,l=l<d.nodeMin?d.nodeMin:l,(r=r>d.nodeMax?d.nodeMax:r)<l)return!1;if(e===this._getTreeDocument()._getTrueRoot()&&e._dgv_numberOfChildren){if(l===e._dgv_numberOfChildren)return!1;r=r>e._dgv_numberOfChildren?e._dgv_numberOfChildren:r}}else!0===this.virtuallyLoadAllModelItems&&void 0!==n?(l=n.startRow,r=n.endRow):r=(l=e.getChildren()?e.getChildren().length:0)+this.dataSource.numberOfRowsPerRequest-1;var h={startRow:l,endRow:r,sortModel:this.sortModel,rowGrouping:this._getGroupingOptions(),groupKeys:a,filterModel:this.getFilterManager()?this.getFilterManager().filterModel:void 0};!0===this.virtuallyLoadAllModelItems&&(h.requestDataForVirtualLoading={});let c=s({startRow:l,parentNode:e,currentTimeStamp:t,rowModel:this});return this._gettingRowsFlag=!0,0!==o.model.length||this._modalLoaderDisplayed||(o.displayModalLoader("Loading data"),this._modalLoaderDisplayed=!0),this.dataSource.getModelItems({request:h,successCallback:c.successCallback,failCallback:c.failCallback}),!0},getRowModelLength:function(){var e=this._getTreeDocument();if(e){var t=e._getTrueRoot();if(t){if(!this.virtuallyLoadAllModelItems||this._getCurrentPaginationOptions()){if(void 0!==t._dgv_numberOfChildren)return t._dgv_numberOfChildren;var i=this._getCurrentPaginationOptions();return i?(i.currentPage-1)*i.pageSize+this.dataGridView.model.length:this.dataGridView.model.length}var n=0;return this._loadedUnloadedNodesMap.forEach(function(e,i){i&&(i===t||i.isVisible()&&i.isExpanded())&&(n+=i.getAllDirectChildrenCount())}),n}}return 0},getVisibleNodeModel:function(e,t){if(!(e<0||this._preventNodesLoading)){if(this._requestModelStructureFlag&&!this._getCurrentPaginationOptions())return this._requestModelStructureFlag=!1,void this._requestModelStructure(this._getTreeDocument()._getTrueRoot());var i=this.dataGridView,n=void 0,o=i.model;e<this._getDataGridViewModelDisplayedLength()&&(n=this._getNodeModelAtRowID(e));var l=n;!l&&o.length&&(l=o[o.length-1]);var r=void 0;if(n&&(r=l.getParent()),r||(r=this._treeDocument._getTrueRoot()),l&&r){let i=this._getVirtualLocalIDInParentNodeFromRowID(e);if(void 0===i)return;let n=this._rowRequestManager.get(r);this.virtuallyLoadAllModelItems||void 0!==n||(n=this.dataSource.numberOfRowsPerRequest-this.dataSource.rowsOffsetToTriggerRequest);let o,l=!1;if(this.virtuallyLoadAllModelItems){let t=!1,i=this._needToLoadRows(e,r,this.dataSource.numberOfRowsPerRequest,t);l=i.needLoadingRequest,o=i.requestData}else l=i>n;if(!0===l)if(this.virtuallyLoadAllModelItems){var s=this._getUnloadedItemsAfterIncludingRowID(e,r,this.dataSource.numberOfRowsPerRequest,this._rowRequestManager.get(r)),a=this._getUnloadedItemsBefore(e,r,this.dataSource.numberOfRowsPerRequest,this._rowRequestManager.get(r)),d=s.number,u=a.number,h=d>0&&u>0?this.dataSource.rowsOffsetToTriggerRequest:0,c=void 0!==r._getRowID()&&null!==r._getRowID()?r._getRowID()+1:0,g=Math.max(c,e-h),p=this._needToLoadRows(g,r,this.dataSource.numberOfRowsPerRequest);if(l=p.needLoadingRequest,o=p.requestData,!0===p.needLoadingRequest){this._requestToDo||(this._requestToDo=[],this._parentNodesArray=[]);var m={parentNode:r,rowID:e,rowIDToLoad:g,currentTimeStamp:t,requestData:o};if(this._requestToDo.push(m),this._parentNodesArray.push(r),this._requestToDo.length>1&&this.dataSource.getModelStructure)return;var f=this;setTimeout(function(){if(f.dataSource.getModelStructure)f._loadGroupOfRows(f._requestToDo),f._parentNodesArray=[],f._requestToDo=[];else{if(f._requestToDo.length>1)return void f._requestToDo.splice(0,1);if(1===f._parentNodesArray.length){var e=f._requestToDo[0];f._parentNodesArray=[],f._requestToDo=[],f._loadRows(e.parentNode,e.currentTimeStamp,e.rowIDToLoad,e.requestData)}else{for(var t=0;t<f._parentNodesArray.length;t++){var i=f._loadedUnloadedNodesMap.get(f._parentNodesArray[t]);if(i)for(var n=[],l=0;l<i.length;l++)n.push(i[l]);f._rowRequestManager.set(f._parentNodesArray[t],n)}var r=f._parentNodesArray[f._parentNodesArray.length-1];f._parentNodesArray=[];e=f._requestToDo[0];var s=f._getUnloadedItemsAfterIncludingRowID(e.rowID,r,f.dataSource.numberOfRowsPerRequest,f._rowRequestManager.get(r)),a=f._getUnloadedItemsBefore(e.rowID,r,f.dataSource.numberOfRowsPerRequest,f._rowRequestManager.get(r)),d=s.number,u=a.number,h=d>0&&u>0?f.dataSource.rowsOffsetToTriggerRequest:0,c=void 0!==r._getRowID()&&null!==r._getRowID()?r._getRowID()+1:0,g=Math.max(c,e.rowID-h),p=f._needToLoadRows(e.rowIDToLoad,e.parentNode,f.dataSource.numberOfRowsPerRequest);f._requestToDo=[],o=p.requestData,f._loadRows(e.parentNode,e.currentTimeStamp,g,o)}}},500)}}else this._rowRequestManager.set(r,r.getNumberOfChildren(!0)+(this.dataSource.numberOfRowsPerRequest-this.dataSource.rowsOffsetToTriggerRequest)),this._loadRows(r,t,e,o)}else if(!n||n!=l){var C=this._getCurrentPaginationOptions();if(!C||C.nodeMax-C.nodeMin>=i.model.length){let i=!1,n=this._rowRequestManager.get(r);if(this.virtuallyLoadAllModelItems){i=this._needToLoadRows(e,r,this.dataSource.numberOfRowsPerRequest,!1).needLoadingRequest}else void 0===n&&(this._rowRequestManager.set(r,r.getNumberOfChildren(!0)+(this.dataSource.numberOfRowsPerRequest-this.dataSource.rowsOffsetToTriggerRequest)),i=!0);i&&this._loadRows(r,t,e)}}return n}},_isModelBeingFetched:function(){return this._gettingRowsFlag},_getTreeDocument:function(){if(!this._treeDocument){this._treeDocument=new this.dataGridView.documentClassForServerSide({useAsyncPreExpand:!0,nodeModelClass:this.dataGridView.nodeModelClass||this.dataGridView.documentClassForServerSide.prototype.defaultOptions.nodeModelClass||t}),this._listenToTreeDocument();var e=this;this._treeDocument.onPreExpand(function(t){var i=!1,n=t.target;if(n&&void 0!==n.getChildren()&&0===n.getChildren().length){n.setState({state:"expanding"});let o=t.data&&t.data.expandAll?-1:t.data.numberOfLevelsToExpand;i=e._requestModelStructure(n,o)}i||n.preExpandDone()}),this._treeDocument.onPostExpand(function(t){var i=t.target;e._updateLoadedNodeWithoutChildExpander(i)}),this._treeDocument.onPostCollapse(function(t){var i=t.target;e._updateLoadedNodeWithoutChildExpander(i)})}return this._treeDocument},_resetTreeDocument:function(){this.dataGridView.getCellsXSO().empty(),this._rowRequestManager.clear(),this._loadedUnloadedNodesMap.clear(),this._DGVRowIDNodeModelMapping.clear(),this._DGVNodeModelRowIDMapping.clear();let e=!0;const t=()=>{var e=performance.now();this._lastModelRequestTimeStamp=e,this._requestModelStructureFlag=!0,this.getVisibleNodeModel(0,e),this._preventNodesLoading=!1};if(this._treeDocument){var i=this._treeDocument.getUseChangeTransactionMode();if(this._treeDocument.setUseChangeTransactionMode(!1),this._treeDocument._getTrueRoot()._dgv_allRowsLoaded=!1,this._getCurrentPaginationOptions()||(this._treeDocument._getTrueRoot()._dgv_numberOfChildren=void 0),this._treeDocument._updateCnt>0){e=!1;const i=this._treeDocument.onUpdate(()=>{this._treeDocument.unsubscribe(i),t()})}this._treeDocument.empty(),this._treeDocument.setUseChangeTransactionMode(i)}this.dataSource&&(this._getTreeDocument(),e&&t())},_applyDataSource:function(e){var t=this;this.dataGridView._isReady&&this._resetTreeDocument(),e&&e._modelEvents&&this._dataSourceModelEventListenerArray&&(this._cleanDataSourceEventListener(),e._getRowModelFilterManager=void 0),this.dataSource&&(this._rowRequestManager.clear(),this._loadedUnloadedNodesMap.clear(),this._DGVRowIDNodeModelMapping.clear(),this._DGVNodeModelRowIDMapping.clear(),this._dataSourceModelEventListenerArray||(this._dataSourceModelEventListenerArray=[]),this._dataSourceModelEventListenerArray.push(this.dataSource._modelEvents.subscribe({event:"pushUpdatesNotifications"},function(e){t._onPushUpdatesNotifications(e.dataToUpdateArray,e.callback)})),this._dataSourceModelEventListenerArray.push(this.dataSource._modelEvents.subscribe({event:"executePendingNotifications"},function(){t.dataGridView.executePendingNotifications()})),this._dataSourceModelEventListenerArray.push(this.dataSource._modelEvents.subscribe({event:"flushPendingNotifications"},function(){t.dataGridView.flushPendingNotifications()})),this._dataSourceModelEventListenerArray.push(this.dataSource._modelEvents.subscribe({event:"filterModelChange"},function(e){t.setFilterModel(e.filterModel)})),this._dataSourceModelEventListenerArray.push(this.dataSource._modelEvents.subscribe({event:"reapplyFilterModel"},function(){t.reapplyFilterModel()})),this.dataSource._getRowModelFilterManager=this.getFilterManager.bind(this),this._setFilterViewManager())},_applyVirtuallyLoadAllModelItems:function(){if(this.dataGridView._isReady){if(this._getTreeDocument()){var e=this;this._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(t){if(t.nodeModel){var i=[];if(e._loadedUnloadedNodesMap){var n=e._loadedUnloadedNodesMap.get(t.nodeModel.getParent());if(n)for(var o=1;o<n.length;o++)i.push(n[o]);e._rowRequestManager.clear(),e._loadedUnloadedNodesMap.clear(),e._DGVRowIDNodeModelMapping.clear(),e._DGVNodeModelRowIDMapping.clear()}e._updateMultipleNodesRep(t.nodeModel.getParent(),i)}}})}this._syncModel()}},_applySortModel:function(e){this._parent(),this.dataGridView._isReady&&this._resetTreeDocument()},_doGroupingOnModel:function(e){this.dataGridView._isReady&&this._resetTreeDocument()},_updateLoadedUnloadedData:function(e,t,i,n,o,l){var r=o.get(e),s=[];if(r)for(var a=1;a<r.length;a++)s.push(r[a]);var d=[];if(0===s.length){var u;if(i>0)d.push(0),d.push(i),d.push(n),(u=t-n-i)>0&&d.push(u);else d.push(Math.min(n,t)),(u=t-n)>0&&d.push(u)}else{for(var h=[],c=[],g=n,p=0,m=0,f=i,C=0;C<s.length;C++){var _;if(m=p,p+=s[C],C%2==0){if(h.push(s[C]),f<p&&g>0)g-=_=Math.min(p-f,g),f=p}else if(f<p&&g>0)g-=_=Math.min(p-f,g),f-m>0?(c.push(f-m),h.push(_)):h[h.length-1]+=_,c.push(p-(f+_)),f=p;else c.push(s[C])}d=this._removeNullValues(void 0,h,c)}d.unshift(t),!1!==l&&o.set(e,d);for(var w=[],v=1;v<d.length;v++)w.push(d[v]);return w},_removeNullValues:function(e,t,i){if(!t){t=[],i=[];for(var n=0;n<e.length;n++)n%2==0?t.push(e[n]):i.push(e[n])}for(var o=[],l=!1,r=!1,s=0;s<t.length;s++)!1===l?0!==t[s]||0===s?o.push(t[s]):r=!0:(o[o.length-1]+=t[s],l=!1),s<i.length?!1===r?0!==i[s]?o.push(i[s]):l=!0:(o[o.length-1]+=i[s],r=!1):l=!0;return o},_modifyLoadedUnloadedNodes:function(e,t,i,n,o){var l=o.get(e);l||(l=[0,0]);var r=[],s=l[0];if(0===s&&!1===i)return-1;for(var a=1;a<l.length;a++)r.push(l[a]);for(var d=0,u=!1,h=0;h<r.length;h++)if((d+=r[h])>=t){if(h%2==0){let e=[];if(i)n?r[h]=r[h]+1:(e.push(r[h]-(d-t)),e.push(1),e.push(d-t),r.splice(h,1,e[0]),r.splice(h+1,0,e[1]),r.splice(h+2,0,e[2]),r=this._removeNullValues(r));else{if(d===t)continue;if(1===r[h])if(0===h)r[h]=0;else{var c=h+1<r.length?r[h+1]:0,g=r[h-1]+c;r.splice(h-1,3,g)}else r[h]>0?r[h]=r[h]-1:(h<r.length-1&&(r[h+1]=r[h+1]-1),r=this._removeNullValues(r))}u=!0;break}if(i)n?(r.splice(h,1,r[h]-(d-t)),r.splice(h+1,0,1),r.splice(h+2,0,d-t),r=this._removeNullValues(r)):r[h]=r[h]+1;else{if(d===t)continue;if(1===r[h]){c=h+1<r.length?r[h+1]:0,g=r[h-1]+c;r.splice(h-1,3,g)}else r[h]=r[h]-1}u=!0;break}var p=s;return!1===u?console.log("Warning, trying to insert or remove a node at location",t," whereas parentNode called ",e.options.label," only owns ",d," items (loaded or unloaded)"):(p=i?s+1:s-1)?(r.unshift(p),o.set(e,r)):(o.delete(e),delete e._dgv_allRowsLoaded),p},_addItemInLoadedUnloadedData:function(){},_insertBackFakeExpandedNodes:function(e,t,i){let n=r(this);for(let o=0;o<t.length;o++){let l=t[o],r=i[o],s=e.getChildren()?e.getChildren():[],a=0,d=0;for(let t=0;t<s.length;t++){let i=s[t];if(void 0!==i.options.multipleNodesRep){if(a+i.options.multipleNodesRep>=r){let t=r-a-1,o=i.options.multipleNodesRep-t-1;if(i.options.multipleNodesRep=t,e.addChild(l,d+1),o>0){let t=new n({label:"",multipleNodesRep:o});e.addChild(t,d+2)}let s=this._loadedUnloadedNodesMap.get(l);s&&this._rowRequestManager.set(l,s);break}a+=i.options.multipleNodesRep}else a++;d++}for(let t=s.length-1;t>=0;t--){let i=s[t];void 0!==i.options.multipleNodesRep&&0===i.options.multipleNodesRep&&e.removeChild(i)}}},_updateMultipleNodesRep:function(e,t){this.prepareUpdate();let i=e.isExpanded();var n=e.getChildren();if(n)for(var o=n.length-1;o>=0;o--){var l=n[o];void 0!==l.options.multipleNodesRep&&e.removeChild(l)}if(!0===this.virtuallyLoadAllModelItems)for(var s=r(this),a=0,d=0;d<t.length;d++)if(d%2==0)a+=t[d];else{var u=new s({label:"",multipleNodesRep:t[d]});e.addChild(u,a),a+=1}i&&e.setState({state:"expanded"}),this.pushUpdate()},_getTotalChildrenCount:function(e){let t=e.getChildren(),i=0;if(t)for(let e=0;e<t.length;e++)i+=void 0!==t[e].options.multipleNodesRep?t[e].options.multipleNodesRep:1;return i},_getVirtualLocalIDInParentNodeFromRowID:function(e){var t=this.dataGridView.model;if(this.virtuallyLoadAllModelItems){var i;if(!(i=this._getNodeModelAtRowID(e)))return;if(!i.getParent())return;for(var n=i.getParent().getChildren(),o=0,l=0,r=0;r<n.length;r++){if(n[r]===i){o=l;break}void 0===n[r].options.multipleNodesRep?l++:l+=n[r].options.multipleNodesRep}return e-this._DGVNodeModelRowIDMapping.get(i)+o}return(i=t[e])?i._getLocalID():void 0},_getRealPositionInParentNode:function(e,t){var i=e.getChildren(),n=0;if(!i||0===i.length)return 0;for(var o=0;o<=i.length;o++){if(t<=n)return o;if(o===i.length)return t;void 0===i[o].options.multipleNodesRep?n++:n+=i[o].options.multipleNodesRep}},_needToLoadRows:function(e,t,i,n){var o=this._computeRowsToLoad(e,t,i,this._rowRequestManager.get(t)),l=o.startRow,r=o.numberToLoad?o.numberToLoad:o.endRow-l==0?0:o.endRow-l+1;let s=this._getCurrentPaginationOptions();if(!(d=this._loadedUnloadedNodesMap.get(t))&&!s)return{needLoadingRequest:!0,requestData:o};let a=this._loadedUnloadedNodesMap.get(t)?this._loadedUnloadedNodesMap.get(t)[0]:s?s.pageSize:0;var d,u=[];if(d=this._rowRequestManager.get(t))for(var h=1;h<d.length;h++)u.push(d[h]);else u=this._updateLoadedUnloadedData(t,a,l,0,this._rowRequestManager);for(var c=0,g=0;g<u.length;g++){var p=c+=u[g];if(u.length>g+1&&(p+=u[g+1]),r>0&&l>=c&&l<p)return g%2==1?{needLoadingRequest:!1}:(this._updateLoadedUnloadedData(t,a,l,r,this._rowRequestManager,n),{needLoadingRequest:!0,requestData:o})}return{needLoadingRequest:!1}},_getUnloadedItemsBefore:function(e,t,i,n){var o=0,l=e,r=e,s=e,a=e,d=this._getDataGridViewModelDisplayedLength();if(this.dataGridView&&this.dataGridView.model&&e<d){for(var u=i+this.dataSource.rowsOffsetToTriggerRequest,h=Math.max(0,e-1-u),c=e-1;c>=h;c--){var g=this._getNodeModelAtRowID(c);if(this._isNodeLoadedOrLoading(g,t,c,n)||g.getParent()!==t){if(o)break}else 0===o&&(r=c),l=c,o++;if(g.getParent()!==t)break;if(c<=e-this.dataSource.rowsOffsetToTriggerRequest&&0===o){o=0;break}}s=this._getVirtualLocalIDInParentNodeFromRowID(l),a=this._getVirtualLocalIDInParentNodeFromRowID(r)}return{number:o,startingRowID:s,endingRowID:a,absoluteStartRowID:l,absoluteEndRowID:r}},_getUnloadedItemsAfterIncludingRowID:function(e,t,i,n){var o=0,l=e,r=e,s=e,a=e,d=this._getDataGridViewModelDisplayedLength();if(this.dataGridView&&this.dataGridView.model&&e<d){for(var u=i+this.dataSource.rowsOffsetToTriggerRequest,h=Math.min(d,e+u),c=e;c<h;c++){var g=this._getNodeModelAtRowID(c);if(this._isNodeLoadedOrLoading(g,t,c,n)||g.getParent()!==t){if(o)break}else 0===o&&(l=c),r=c,o++;if(g.getParent()!==t)break;if(c>=e+this.dataSource.rowsOffsetToTriggerRequest&&0===o){o=0;break}}s=this._getVirtualLocalIDInParentNodeFromRowID(l),a=this._getVirtualLocalIDInParentNodeFromRowID(r)}return{number:o,startingRowID:s,endingRowID:a,absoluteStartRowID:l,absoluteEndRowID:r}},_computeRowsToLoad:function(e,t,i,n){if(n&&n.length>2){var o=this._getUnloadedItemsAfterIncludingRowID(e,t,i,n);if(o.number>=i)return{absoluteStartRow:o.absoluteStartRowID,startRow:o.startingRowID,endRow:o.startingRowID+i-1};var l=this._getUnloadedItemsBefore(e,t,i,n);if(o.number>0){if(l.number>0&&l.endingRowID===o.startingRowID-1){let e=Math.max(l.startingRowID,o.endingRowID-i+1);return{startRow:e,endRow:o.endingRowID,absoluteStartRow:o.absoluteEndRowID-(o.endingRowID-e)}}return{absoluteStartRow:o.absoluteStartRowID,startRow:o.startingRowID,endRow:Math.min(o.startingRowID+i-1,o.endingRowID),numberToLoad:o.number}}let r=Math.max(l.endingRowID-i+1,l.startingRowID);return{startRow:r,endRow:l.endingRowID,absoluteStartRow:l.absoluteEndRowID-(l.endingRowID-r)}}return n&&2===n.length?{startRow:0,endRow:0}:{absoluteStartRow:e,startRow:0,endRow:i-1}},_isNodeLoadedOrLoading:function(e,t,i,n){if(e.options.multipleNodesRep){if(!n)return!1;for(var o=this._getVirtualLocalIDInParentNodeFromRowID(i),l=0,r=1;r<n.length;r++)if(o<(l+=n[r]))return r%2==1;return!1}return!0},_updateClientModelFromFind:function(e,t,i,n,o,l){if(e!==this._findStr&&(this._findCurrentResultValue=void 0,this._findStr=e),!this._isRequestNeededForNextFindValue(i,t))return this._findCurrentResultValue=i,this._parent(e,t,i,n,!0,!0);this._findMatchCase=t,this._findCurrentResultValue=i;var s=this;s._launchServerFindTimeout&&clearTimeout(s._launchServerFindTimeout),s._launchServerFindTimeout=setTimeout(function(){if(s._launchServerFindTimeout=null,!0!==s.virtuallyLoadAllModelItems)throw'Error : Find cannot be launched on a Server side model if "virtuallyLoadAllModelItems" of dataGridView is not applied.';var o=s.dataGridView,l=s._getColumnsToProcessForFindData(o,e,t).findableColumnsDataIndexes,a={findStr:e,matchCase:t,findCurrentValue:i,findNavigationMode:s.dataGridView.findNavigationMode,sortModel:s.sortModel,rowGrouping:s._getGroupingOptions(),requestDataForFindOnServer:{findCurrentValue:i,findRequestTimeStamp:s._lastFindRequestTimeStamp},filterModel:s.getFilterManager()?s.getFilterManager().filterModel:void 0,findableColumnsDataIndexes:l};let d=function(e){let t=e.rowModel,i=e.rowModel.dataGridView,n=e.applyFindOnClientModelCB;return{successCallback:function(e,o,l,s,a,d){if(d.findRequestTimeStamp===t._lastFindRequestTimeStamp){var u=d.findCurrentValue;if(u>=s&&(u=0),t._findCurrentResultValue=u,t._findcurrentValueIndexInRow=a,e&&Array.isArray(e)&&e.length>0){if(e.length!==o.length||o.length!==l.length)throw"ERROR in Find server side returned values : all returned array must have the same length. Please check your returned arrays.";var h=t._treeDocument.getUseChangeTransactionMode();t._treeDocument.setUseChangeTransactionMode(!1);var c=t._getTreeDocument()._getTrueRoot();t.prepareUpdate();for(var g=r(t),p=0;p<e.length;p++){var m=e[p],f=o[p],C=l[p],_=t._getNodeInClientModel(c,f);if(_)c=_;else{var w=t._updateLoadedUnloadedData(c,C,f,1,t._loadedUnloadedNodesMap);t._updateLoadedUnloadedData(c,C,f,1,t._rowRequestManager);var v=t.dataGridView.getGroupingOptions(),D=v&&v.dataIndexesToGroup?v.dataIndexesToGroup.length:0;let i;i=t._treeDocument.createModelNode?t._treeDocument.createModelNode({label:m.tree,icons:m.icons,grid:m,children:p!==e.length-1||p<D?[]:void 0}):new g({label:m.tree,icons:m.icons,grid:m,children:p!==e.length-1||p<D?[]:void 0}),m.stringIdentifier&&(i.stringIdentifier=m.stringIdentifier);var I=f;t.dataGridView.model.length&&(I=t._getRealPositionInParentNode(c,f)),c.addChild(i,I),t._updateMultipleNodesRep(c,w),c=i}c&&p==e.length-1&&(t._currentMatchingNodeModel=c)}t._treeDocument._indexRowIndexes(),t._syncModel({updateType:WUXModelUpdateTypes.Addition},!0),!0===t._modalLoaderDisplayed&&(i.removeModalLoader(),t._modalLoaderDisplayed=!1),i.model&&0===i.model.length?i._displayEmptyContentMessage():i._removeEmptyContentMessage(),t._gettingRowsFlag=!1,t._treeDocument.setUseChangeTransactionMode(h),t.pushUpdate(),t._getGroupingOptions()&&t._getGroupingOptions().dataIndexesToGroup&&t._getTreeDocument().getModelEvents().publish({event:"groupNodes"})}t._findResultNumber=s,t._matchingStringCount=s,"cell"===t.dataGridView.findNavigationMode?t._matchingCellIDsCount=s:"row"===t.dataGridView.findNavigationMode&&(t._matchingRowsCount=s),n&&n.call(t,u)}},failCallback:function(e){!0===t._modalLoaderDisplayed&&(i.removeModalLoader(),t._modalLoaderDisplayed=!1),e&&console.warn(e),t._gettingRowsFlag=!1}}}({rowModel:s,applyFindOnClientModelCB:n});s._gettingRowsFlag=!0,0!==o.model.length||s._modalLoaderDisplayed||(o.displayModalLoader("Loading data"),s._modalLoaderDisplayed=!0),s.dataSource.getCurrentFindResult({request:a,successCallback:d.successCallback,failCallback:d.failCallback})},500)},_getNodeInClientModel:function(e,t){var i=e.getChildren(),n=-1;if(i)for(var o=0;o<i.length;o++)if(void 0===i[o].options.multipleNodesRep||1===i[o].options.multipleNodesRep&&i[o].isExpanded()){if(++n===t)return i[o]}else if((n+=i[o].options.multipleNodesRep)>=t)return},_getFakeNodeExpandedChildrenInClientModel(e,t){let i=e.getChildren(),n=-1;if(i)for(let e=0;e<i.length;e++)if(void 0===i[e].options.multipleNodesRep){if(++n===t)return}else if((n+=i[e].options.multipleNodesRep)===t)return i[e].isExpanded()?i[e].getChildren():void 0},_isNodeAlreadyLoaded:function(e,t){for(var i=0,n=0;n<t.length;n++)if(i+=t[n],n%2==0){if(e<i)return!0}else if(e<i)return!1},_computeMatchingStringsCount:function(e){return e?this._parent(e):this._matchingStringCount},_computeMatchingCellIDsCount:function(){return this._matchingCellIDsCount},_computeMatchingNodeModelsCount:function(){return this._matchingRowsCount},_computeCurrentMatchingStringIndex:function(e,t){return this._getCurrentSubstringAndCellIDIndexFromNodeModelOccurrence(e,this._currentMatchingNodeModel,this._findcurrentValueIndexInRow)},_getCurrentSubstringAndCellIDIndexFromNodeModelOccurrence:function(e,t,i){var n=e._matchingAllNodeModelsArray.indexOf(t);if(-1===n)throw"ERROR : given nodeModel is not found among found nodeModels.";var o,l=0;if("cell"===e.findNavigationMode){for(var r=0;r<e._matchingCellIDsArray.length;r++){var s=e._matchingCellIDsArray[r];if(e.getCellInfosAt(s).nodeModel===t)break;l++}var a=l+i;o=e._getMatchingStringIndexFromMatchingCellIDIndex(a)}else if("row"===e.findNavigationMode)l=e._matchingNodeModelsArray.indexOf(t),o=e._getMatchingStringIndexFromMatchingRowIDIndex(l);else{for(r=0;r<n;r++)l+=e._matchingFoundArrays[r].length;o=l+i}return o},_computeNextMatchingData:function(e,t){return t?this._parent(e,t):this._getCurrentSubstringAndCellIDIndexFromNodeModelOccurrence(this.dataGridView,this._currentMatchingNodeModel,this._findcurrentValueIndexInRow)},_computePreviousMatchingData:function(e,t){return t?this._parent(e):this._getCurrentSubstringAndCellIDIndexFromNodeModelOccurrence(this.dataGridView,this._currentMatchingNodeModel,this._findcurrentValueIndexInRow)},_computeFindEditorCurrentValue:function(){return this._findCurrentResultValue+1},_getNodeModelsToProcessFromMatchCaseChange:function(){},_isRequestNeededForNextFindValue:function(e,t){var i=this._findCurrentResultValue;if(void 0===i)return!0;if(this._findMatchCase!==t)return!0;var n,o=this.dataGridView,l=e-i;if(0===l)return!1;if(1===l||i===this._findResultNumber-1&&0===e)n=this._computeNextMatchingData(o,!0);else{if(-1!==l&&(0!==i||e!==this._findResultNumber-1))throw"Find increment is not possible : problem!!!!!!";n=this._computePreviousMatchingData(o,!0)}if(n===o._currentMatchingStringIndex)return!0;var r,s,a=o._getMatchingCellIDIndexFromMatchingStringIndex(n);if((a-o._currentMatchingCellIDIndex)*l<0)return!0;var d=o._getMatchingCellID(o._currentMatchingCellIDIndex),u=o._getMatchingCellID(a);if(a>o._currentMatchingCellIDIndex?(r=o.getNodeModelAt(d),s=o.getNodeModelAt(u)):(r=o.getNodeModelAt(u),s=o.getNodeModelAt(d)),!r||!s)return!0;if(r._getID()===s._getID())return!1;var h=!1,c=!1,g=!1;return this._getTreeDocument()._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(e){var t=e.nodeModel;if(t)if(t._getID()===r._getID()){if(c=!0,Array.isArray(t._options.children)&&0===t._options.children.length)return h=!0,g=!0,{stopProcessing:!0}}else{if(t._getID()===s._getID()&&!g)return h=!1,g=!0,{stopProcessing:!0};if(!0===c&&!g&&(void 0!==t.options.multipleNodesRep||Array.isArray(t._options.children)&&0===t._options.children.length))return h=!0,g=!0,{stopProcessing:!0}}}}),h},_isServerSide:function(){return!0},_setFilterViewManager:function(){var e=this,t=this.getFilterManager();t&&(this._currentFilters=this._getFiltersModelData(this.dataSource),t.subscribe("filterModelChange",function(t){var n=e._getFiltersModelData(e.dataSource);i.areEquals(e._currentFilters,n)||(e.dataGridView.findCtx?e.dataGridView.findCtx.close():e.dataGridView.findWidget&&e.dataGridView.findWidget.close(),e._resetTreeDocument()),e._currentFilters=n}),this._filterViewManager?this._filterViewManager.filterManager=t:this._filterViewManager=new n({view:this.dataGridView,filterManager:t}))},_getFiltersModelData:function(){var e={};if(this.getFilterManager()&&this.getFilterManager().getFilters())for(var t in this.getFilterManager().getFilters())e[t]=o.clone(this.getFilterManager().getFilters()[t].filterModel,!0);return e},setFilterModel:function(e){if(this._filterManager&&o.equals(this._filterManager.filterModel,e))return;this.getFilterManager().filterModel=e,this.dataGridView.updateRowView(-1,{updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})},getFilterManager:function(){return this._filterManager||this._createFilterManager(),this._filterManager},reapplyFilterModel:function(){if(this._filterManager){var e=this._filterManager.filterModel;this._filterManager.filterModel={},this._filterManager.filterModel=e}},_createFilterManager:function(e){this._filterManager||(this._filterManager=new l({model:this.dataSource,filterModel:e||{}}))},_updateLoadedNodeWithoutChildExpander:function(e){if(e&&!0===e._dgv_allRowsLoaded&&(null===e.getChildren()||0===e.getChildren().length)){var t=this.dataGridView;this.dataGridView.updateCellView(t.layout.getCellIDFromCoordinates({rowID:e._getRowID(),columnID:t.layout.getColumnIndex("tree")}),{updateCellContent:!0})}},destroy:function(){this._cleanDataSourceEventListener(),this._parent()},_cleanDataSourceEventListener:function(){if(this._dataSourceModelEventListenerArray)for(var e=0;e<this._dataSourceModelEventListenerArray.length;e++)this.dataSource._modelEvents.unsubscribe(this._dataSourceModelEventListenerArray[e])},_onPushUpdatesNotifications:function(e,t){var i=0;if(e&&Array.isArray(e))if(this.dataGridView.syncClientModelOnDemand){this._pendingPushNotificationsArray||(this._pendingPushNotificationsArray=[]);for(var n=0;n<e.length;n++)this._pendingPushNotificationsArray.push(e[n])}else{var o=this.dataSource.convertPushUpdatesNotificationsWithContext(e,{sortModel:this.sortModel,filterModel:this.getFilterManager()?this.getFilterManager().filterModel:void 0,rowGrouping:this.dataGridView.getGroupingOptions()});i=this._synchronizeTreeDocumentFromDataSourceUpdate(o)}t&&t.call(this.dataSource,{treatedNotificationsNodesNumber:i})},_hasPendingNotifications:function(){return this._pendingPushNotificationsArray&&this._pendingPushNotificationsArray.length>0},_getPendingNotifications:function(){return this._pendingPushNotificationsArray},_synchronizeTreeDocumentFromDataSourceUpdate:function(e){let t=0;if(e&&e.length>0){this.dataGridView.findCtx?this.dataGridView.findCtx.close():this.dataGridView.findWidget&&this.dataGridView.findWidget.close();let o=[],l=new Set;this._parentNodeMapForNodesAdding?this._parentNodeMapForNodesAdding.clear():this._parentNodeMapForNodesAdding=new Map,this.prepareUpdate(),this.dataGridView.prepareUpdateView();let r=this._treeDocument.getUseChangeTransactionMode();this._treeDocument.setUseChangeTransactionMode(!1),this._providePushNotifVisualFeedBack=!1;for(let i=0;i<e.length;i++){let n=this._treatNotification(e[i]);if(n){if(n.treatedNotificationsNodesNumber&&(t+=n.treatedNotificationsNodesNumber),n.modifiedNodes&&(o=o.concat(n.modifiedNodes)),n.nodesToRemove)for(let e=0;e<n.nodesToRemove.length;e++)l.add(n.nodesToRemove[e]);this._syncModel(),"nodesRemoved"!==e[i].operationType&&(this._providePushNotifVisualFeedBack=!0)}}function i(e,t){return e-t}for(const[e,t]of this._parentNodeMapForNodesAdding){let n=t.sort(i),o=[],l=[];o.push(l);for(let e=0;e<n.length;e++)if(0===e&&o[0].push(n[0]),n[e+1])if(n[e+1]-n[e]==1)o[o.length-1].push(n[e+1]);else{let t=[n[e+1]];o.push(t)}for(let t=o.length-1;t>=0;t--)for(let i=0;i<o[t].length;i++)this._addNodeToParentAtPosition(e,o[t][i])}this._parentNodeMapForNodesAdding.clear(),l.forEach(e=>{e.getParent()&&this._removeNode(e)}),this._treeDocument.setUseChangeTransactionMode(r);let s="ui-removed";for(let e=0;e<o.length;e++){let t=o[e];null!=t&&this.dataGridView._flashEffectOnRow(s,t)}this.pushUpdate(),this.dataGridView.pushUpdateView();var n=this;setTimeout(function(){n._providePushNotifVisualFeedBack=!1},2e3)}return t},_executePendingNotifications:function(e){if(this._pendingPushNotificationsArray&&Array.isArray(this._pendingPushNotificationsArray)){var t=this.dataSource.convertPushUpdatesNotificationsWithContext(this._pendingPushNotificationsArray,{sortModel:this.sortModel,filterModel:this.getFilterManager()?this.getFilterManager().filterModel:void 0,rowGrouping:this.dataGridView.getGroupingOptions()}),i=0;t&&Array.isArray(t)&&(i=this._synchronizeTreeDocumentFromDataSourceUpdate(t)),this._flushPendingNotifications()}e&&e.call(this.dataSource,{treatedNotificationsNodesNumber:i})},_flushPendingNotifications:function(){this._pendingPushNotificationsArray=[]},_treatNotification:function(e){switch(e.operationType){case"nodesAdded":return this._addNodesFromDataSourceRequest(e.nodesNumber,e.nodesPath);case"nodesRemoved":return this._removeNodesFromDataSourceRequest(e.nodesNumber,e.nodesPath);case"nodesChanged":return this._changeNodesFromDataSourceRequest(e);case"reset":return this._resetTreeDocument(),!0;default:console.warn("Warning in RowModelServerSide._treatNotification ; notification.operationType unknown : "+e.operationType)}},_getNodeLocationData:function(e){var t,i,n=this._getTreeDocument()._getTrueRoot();if(!e.length)return{node:n};for(var o=0;o<e.length;o++){i=e[o];var l=this._getNodeInClientModel(n,i);if(!l){o!==e.length-1&&(n=void 0);break}o<e.length-1?n=l:o===e.length-1&&(t=l)}return{parentNode:n,node:t,indexInParentNode:i}},_addNodesFromDataSourceRequest:function(e,t){return this._modifyNodesFromDataSourceRequest(e,t,"add")},_modifyNodesFromDataSourceRequest:function(e,t,i,n){if(!e)return{treatedNotificationsNodesNumber:0};let o=e,l=this._getNodeLocationData(t),r=l.parentNode,s=Boolean(r),a=l.indexInParentNode,d=[];if(r&&Array.isArray(r.getChildren())&&0===r.getChildren().length&&(s=!1),s)for(var u=0;u<e;u++){let e=this._loadedUnloadedNodesMap.get(r)?this._loadedUnloadedNodesMap.get(r)[0]:0,l="add"===i?e+u:e-1;if(a<0||a>l)console.warn("Warning, given index is outside parent bounds."),o--;else if("add"===i){let e=this._parentNodeMapForNodesAdding.get(r);e||(e=[]),e.push(a),this._parentNodeMapForNodesAdding.set(r,e),a++}else if("remove"===i){let e=this._preRemoveNode(r,a);void 0!==e&&(d.push(e),a++)}else if(this._removeNodeAtLocation(r,a),n){if(void 0===n[u]){for(var h=[],c=0;c<t.length;c++)c!==t.length-1?h.push(t[c]):h.push(a+u);n[u]=h}}else this._addNodeToParentAtPosition(r,a),a++}if(n){var g=n.sort(function(e,t){for(var i=Math.min(e.length,t.length),n=0;n<i;n++){if(e[n]<t[n])return-1;if(e[n]>t[n])return 1}});for(u=0;u<g.length;u++){var p=g[u];this._modifyNodesFromDataSourceRequest(1,p,"add")}}return{treatedNotificationsNodesNumber:o,nodesToRemove:d}},_addNodeToParentAtPosition:function(e,t){var i=this._modifyLoadedUnloadedNodes(e,t,!0,!1,this._loadedUnloadedNodesMap);return this._modifyLoadedUnloadedNodes(e,t,!0,!1,this._rowRequestManager),e._dgv_numberOfChildren=i,e._dgv_allRowsLoaded=!1,this._updateRealAndUnloadedDataAfterUnitOperation(e),[]},_updateRealAndUnloadedDataAfterUnitOperation:function(e){let t=this._loadedUnloadedNodesMap.get(e),i=[],n=t?t.length:0;for(var o=1;o<n;o++)i.push(t[o]);let l=e.getChildren()?e.getChildren().length:0,r=[],s=[],a=0;for(let t=0;t<l;t++){let i=e.getChildren()[t];void 0!==i.options.multipleNodesRep?(a+=i.options.multipleNodesRep,i.isExpanded()&&(r.push(i),s.push(a))):a++}this._updateMultipleNodesRep(e,i),this._insertBackFakeExpandedNodes(e,r,s),this._treeDocument._indexRowIndexes()},_removeNodesFromDataSourceRequest:function(e,t){return e&&t.length?this._modifyNodesFromDataSourceRequest(e,t,"remove"):{treatedNotificationsNodesNumber:0}},_preRemoveNode:function(e,t){var i,n=this._getNodeInClientModel(e,t);if(t<(this._loadedUnloadedNodesMap.get(e)?this._loadedUnloadedNodesMap.get(e)[0]:0)){if(void 0!==n){var o=t;this.dataGridView.model.length&&(o=this._getRealPositionInParentNode(e,t));var l=e.getChildren()[o];l&&(i=l)}i||(this._modifyLoadedUnloadedNodes(e,t,!1,void 0,this._loadedUnloadedNodesMap),this._modifyLoadedUnloadedNodes(e,t,!1,void 0,this._rowRequestManager),this._updateRealAndUnloadedDataAfterUnitOperation(e))}return i},_removeNode:function(e){if(!e)return;let t=e.getParent(),i=e._getLocalID();t.removeChild(e),this._modifyLoadedUnloadedNodes(t,i,!1,void 0,this._loadedUnloadedNodesMap),this._modifyLoadedUnloadedNodes(t,i,!1,void 0,this._rowRequestManager),this._updateRealAndUnloadedDataAfterUnitOperation(t)},_removeNodeAtLocation:function(e,t){var i,n=this._getNodeInClientModel(e,t);if(t<(this._loadedUnloadedNodesMap.get(e)?this._loadedUnloadedNodesMap.get(e)[0]:0)){if(void 0!==n){var o=t;this.dataGridView.model.length&&(o=this._getRealPositionInParentNode(e,t));var l=e.getChildren()[o];l&&(l.isVisible()&&(i=l._getRowID()),e.removeChild(l))}this._modifyLoadedUnloadedNodes(e,t,!1,void 0,this._loadedUnloadedNodesMap),this._modifyLoadedUnloadedNodes(e,t,!1,void 0,this._rowRequestManager),this._updateRealAndUnloadedDataAfterUnitOperation(e)}return i},_changeNodesFromDataSourceRequest:function(e){let t=e.nodesNumber,i=e.nodesPath,n=e.childrenOrder,o=e.nodesLocationsArrayAfterChange;if(!t||!i.length&&!n)return{treatedNotificationsNodesNumber:0};if(e.modifications){let t={},n=this._getNodeLocationData(i).node;if(n){for(const i of Object.keys(e.modifications)){if("wux_group"===i)if(e.modifications[i])n.getChildren()||n.setHasAsyncChildren(!0);else{let e=n.getChildren();e&&e.length||n.setHasAsyncChildren(!1)}else{if("isExpanded"===i){!0!==e.modifications[i]||n.isExpanded()?!1===e.modifications[i]&&n.isExpanded()&&n.collapse():n.expand();continue}"tree"===i?t.label=e.modifications[i]:"icons"===i&&(t[i]=e.modifications[i])}t.grid||(t.grid={}),t.grid[i]=e.modifications[i]}n.updateOptions(t),this.dataSource.onNodeModelUpdate(n,t.grid,!1)}return[]}if(n){let e=this._getNodeLocationData(i).node;if(!e)return{treatedNotificationsNodesNumber:0};let t=0;return e.withTransactionUpdate(()=>{let i=e.getChildren(),o=this._loadedUnloadedNodesMap.get(e),l=o&&o.length?o[0]:0;if(!l||l!==n.length)return;let r=[],s=!1;r.length=l;for(let e=0;e<i.length;++e){let t=i[e];if(!t.stringIdentifier||void 0!==t.options.multipleNodesRep)continue;let o=n.indexOf(t.stringIdentifier);if(-1!==o){if(r[o]&&window.console.error("At least 2 children share the same stringIdentifier"),r[o]=t,i.length===l&&o===e)continue;s=!0}else window.console.error("A node with an id is not in the new nodes order")}if(s){i.length=0,this._loadedUnloadedNodesMap.delete(e),this._rowRequestManager.delete(e);for(let t=e.stringIdentifier?this._requestToDo.length-1:-1;t>=0;--t){this._requestToDo[t].parentNode.stringIdentifier===e.stringIdentifier&&(this._requestToDo.splice(t,1),this._parentNodesArray.splice(t,1))}for(let t=0;t<l;++t){let n=r[t];n?(i.push(n),this._modifyLoadedUnloadedNodes(e,t,!0,!0,this._loadedUnloadedNodesMap),this._modifyLoadedUnloadedNodes(e,t,!0,!0,this._rowRequestManager)):this._addNodeToParentAtPosition(e,t)}return this._treeDocument._indexRowIndexes(),t=l,{updateType:WUXModelUpdateTypes.Sorting}}}),{treatedNotificationsNodesNumber:t}}return this._modifyNodesFromDataSourceRequest(t,i,"change",o)},_getDataGridViewModelDisplayedLength:function(){if(!this.dataGridView.model||!Array.isArray(this.dataGridView.model))return 0;if(!this.dataGridView.virtuallyLoadAllModelItems)return this.dataGridView.model.length;var e=0;this.dataGridView.model.forEach(function(t){t&&(void 0!==t.options.multipleNodesRep?e+=t.options.multipleNodesRep:t.isHidden()||(e+=1))});let t=this._getCurrentPaginationOptions();return t&&t.pageSize<e?t.pageSize:e},_getNodeModelAtRowID:function(e){if(this.dataGridView.model&&Array.isArray(this.dataGridView.model))return this.dataGridView.virtuallyLoadAllModelItems?this._DGVRowIDNodeModelMapping?this._DGVRowIDNodeModelMapping.get(e):void 0:this.dataGridView.model[e]},_createNodeModelFromData:function(e,t){let i;return i=this._treeDocument.createModelNode?this._treeDocument.createModelNode({label:e.tree,icons:e.icons,nodeType:e.nodeType,grid:e,children:e.wux_group?[]:void 0}):new t({label:e.tree,icons:e.icons,grid:e,children:e.wux_group?[]:void 0}),e.stringIdentifier&&(i.stringIdentifier=e.stringIdentifier),e.dragTransferData&&(i.dragTransferData=e.dragTransferData),i},_createNodeModelsFromStructure:function(e,t){let i=t.numberOfChildren;if(void 0===i&&(i=0),i>0){this._updateLoadedUnloadedData(e,i,0,0,this._loadedUnloadedNodesMap);let n=t.children;n&&t.isExpanded||(n=[]);let o=0==n.length?i:0;for(let t=0;t<n.length;t++){let i=n[t];if(i)if(i&&i.isExpanded&&i.children&&Array.isArray(i.children)){o>0&&(this.__createFakeNode(e,{stringIdentifier:void 0,wux_group:!1},o),o=0);let t=this.__createFakeNode(e,i,1);this._createNodeModelsFromStructure(t,i)}else o++}o>0&&this.__createFakeNode(e,{stringIdentifier:void 0,wux_group:!1},o)}e.preExpandDone()},__createFakeNode:function(e,t,i){let n=r(this);let o;this._uniqueIdentifierCounter||(this._uniqueIdentifierCounter=0),this._uniqueIdentifierCounter++,this.__uniqueIdentifier||(this.__uniqueIdentifier="uniqueTreeNodeModelIdentifier_");let l=this.__uniqueIdentifier+this._uniqueIdentifierCounter.toString();return(o=this._treeDocument.createModelNode?this._treeDocument.createModelNode({label:(t.stringIdentifier,""),children:t.wux_group?[]:void 0,nodeType:"DefaultObject"}):new n({label:(t.stringIdentifier,""),children:t.wux_group?[]:void 0,nodeType:"DefaultObject"})).options.multipleNodesRep=i,o.stringIdentifier=t.stringIdentifier?t.stringIdentifier:l,e.addChild(o),e.setState({state:"expanded"}),o},_requestModelStructure:function(e,t,i){if(this.dataSource.getModelStructure){if(!this.virtuallyLoadAllModelItems)throw'Error : getModelStructure function cannot be launched on a Server side model if "virtuallyLoadAllModelItems" of dataGridView is not applied.';let o=this.dataGridView,l=function(e){let t=e.parentNode,i=e.rowModel,n=e.rowModel.dataGridView,o=e.currentTimeStamp;return{successCallback:function(e){o&&o!==i._lastModelRequestTimeStamp||(n.prepareUpdateView(),i.prepareUpdate(),i._createNodeModelsFromStructure(t,e),i.pushUpdate(),n.pushUpdateView(),!0===i._modalLoaderDisplayed&&(n.removeModalLoader(),i._modalLoaderDisplayed=!1),n.model&&0===n.model.length?n._displayEmptyContentMessage():n._removeEmptyContentMessage(),i._readyForGroupedRequests=!0)},failCallback:function(e){!0===i._modalLoaderDisplayed&&(n.removeModalLoader(),i._modalLoaderDisplayed=!1),e&&console.warn(e)}}}({rowModel:this,parentNode:e,currentTimeStamp:i});var n={groupKeys:e?e.buildStringIdentifierArray():[],expandNLevels:t,sortModel:this.sortModel,rowGrouping:this._getGroupingOptions(),filterModel:this.getFilterManager()?this.getFilterManager().filterModel:void 0};return 0!==o.model.length||this._modalLoaderDisplayed||(o.displayModalLoader("Loading data"),this._modalLoaderDisplayed=!0),this.dataSource.getModelStructure({request:n,successCallback:l.successCallback,failCallback:l.failCallback}),!0}return this._loadRows(e,i)}})}),define("DS/DataGridView/DataGridViewColumnHeaderCell",["UWA/Core","DS/DataGridView/DataGridViewCell","DS/Utilities/Dom","DS/Controls/Toggle","DS/Core/PointerEvents","DS/Tweakers/TypeUtils"],function(e,t,i,n,o,l){"use strict";var r=t.inherit({name:"DataGridViewColumnHeaderCell",publishedProperties:{filterView:{defaultValue:void 0,type:"DS/DataGridView/DataGridViewBaseFilterView",category:"Appearance"},sortModel:{defaultValue:void 0,type:Object,category:"Appearance"},customHeader:{defaultValue:void 0,type:Object,category:"Appearance"},columnHeadersLayout:{defaultValue:0,type:"enum"}},buildView:function(){this._getRightButtonsContainer()},_getRightButtonsContainer:function(){return!this.elements.buttonsContainer&&this.elements.container&&(this.elements.buttonsContainer=new e.Element("div",{class:"wux-layouts-datagridview-column-header-icons"}).inject(this.elements.container,"bottom")),this.elements.buttonsContainer},_applyColumnHeadersLayout:function(t){this.columnHeadersLayout!==t&&void 0!==t&&this.elements.container&&(this.columnHeadersLayout!==r.COLUMN_HEADERS_LAYOUT.SELECTION_FIRST||this.elements.leftButtonsContainer||(this.elements.leftButtonsContainer=new e.Element("div",{class:"wux-layouts-datagridview-column-header-left-icons"}).inject(this.elements.container,"top"),this.elements._selectionCheckBox&&(this.customHeader&&this.customHeader.getSelectionCheckBoxContainer?this._injectInContainer(this.elements._selectionCheckBox,0,this.customHeader.getSelectionCheckBoxContainer(this.getReusableContent())):this.columnHeadersLayout===r.COLUMN_HEADERS_LAYOUT.DEFAULT?this._injectInContainer(this.elements._selectionCheckBox,0,this._getRightButtonsContainer()):this._injectInLeftButtonsContainer(this.elements._selectionCheckBox,0))))},_applyFilterView:function(e){var t=this.filterView;if(t){if(e!==t){let e=this.customHeader&&this.customHeader.getFilterViewContainer?this.customHeader.getFilterViewContainer(this.getReusableContent()):this._getRightButtonsContainer();this._injectInContainer(t,1,e)}}else this.elements.buttonsContainer&&void 0!==e&&e.elements&&e.elements.container&&e.remove()},_applySortModel:function(){if(this.sortModel&&this.sortModel.sortDirection&&this.collectionView){let t=this._createSortIconDefinition(this.sortModel);this.elements.sortIcon?(i.generateIcon(t,{target:this.elements.sortIcon}),this.customHeader&&this.customHeader.getSortIconContainer?this._injectInContainer(this.elements.sortIcon,0,this.customHeader.getSortIconContainer(this.getReusableContent())):this.elements.sortIcon.isInjected(this._getRightButtonsContainer())||this._injectInContainer(this.elements.sortIcon,3,this._getRightButtonsContainer())):(this.elements.sortIcon=i.generateIcon(t),this.customHeader&&this.customHeader.getSortIconContainer?this._injectInContainer(this.elements.sortIcon,0,this.customHeader.getSortIconContainer(this.getReusableContent())):this._injectInContainer(this.elements.sortIcon,3,this._getRightButtonsContainer())),this.getContent().setAttribute("sort-direction",this.sortModel.sortDirection),void 0!==this.sortModel.sortOrder?(this.elements.sortOrderNumber?this.elements.sortOrderNumber.setContent(this.sortModel.sortOrder+1):this.elements.sortOrderNumber=new e.Element("span",{content:this.sortModel.sortOrder+1,class:"wux-datagridview-columnheader-sortcount"}),this._injectInContainer(this.elements.sortOrderNumber,2,this._getRightButtonsContainer()),this.getContent().setAttribute("sort-order",this.sortModel.sortOrder+1)):this.elements.sortOrderNumber&&(this.elements.sortOrderNumber.remove(),this.getContent().removeAttribute("sort-order"))}else this.getContent().removeAttribute("sort-direction"),this.getContent().removeAttribute("sort-order"),this.elements.sortIcon&&this.elements.sortIcon.remove(),this.elements.sortOrderNumber&&this.elements.sortOrderNumber.remove()},_createSortIconDefinition:function(e){let t;return e&&e.sortDirection&&this.collectionView&&((t=l.getSortingIconDefinition(e.typeRepresentation,this.collectionView.getTypeRepresentationFactory(),e.sortDirection)).className="wux-datagridview-columnheader-icons",t.fontIconSize="12px"),t},_injectInContainer:function(e,t,i){(e.getContent?e.getContent():e)._dgv_expected_place=t;let n,o=i.children;for(let e=0;e<o.length;e++){if(o[e]._dgv_expected_place>t){n=o[e];break}if(o[e]._dgv_expected_place===t){o[e].remove(),e<o.length&&(n=o[e]);break}}n?e.inject(n,"before"):e.inject(i)},_injectInLeftButtonsContainer:function(t,i){this.elements.leftButtonsContainer||(this.elements.leftButtonsContainer=new e.Element("div",{class:"wux-layouts-datagridview-column-header-left-icons"}).inject(this.elements.container,"top")),this._injectInContainer(t,i,this.elements.leftButtonsContainer)},_buildContentContainer:function(){!this.elements.tweakerContainer&&this.elements.container&&(this.elements.tweakerContainer=new e.Element("div",{class:"wux-layouts-datagridview-tweaker-container"}),this.elements.leftButtonsContainer?this.elements.tweakerContainer.inject(this.elements.leftButtonsContainer,"after"):this.elements.tweakerContainer.inject(this.elements.container,"top"))},_getContentContainer:function(){return this.elements.tweakerContainer||this._buildContentContainer(),this.customHeader?this.elements.tweakerContainer.addClassName("wux-datagridview-custom-column-header"):this.elements.tweakerContainer.removeClassName("wux-datagridview-custom-column-header"),this.elements.tweakerContainer},buildSelectionCheckBox:function(){this.elements.container&&(this.elements._selectionCheckBox||(this.elements._selectionCheckBox=new n({type:"checkbox",checkFlag:!1,fireOnlyFromUIInteractionFlag:!0}),this.elements._selectionCheckBox.getContent().classList.add("wux-datagridview-selection-checkbox"),i.addEventOnElement(this,this.elements._selectionCheckBox,o.POINTERHIT,function(e,t){e.stopPropagation()})),this.customHeader&&this.customHeader.getSelectionCheckBoxContainer?this._injectInContainer(this.elements._selectionCheckBox,0,this.customHeader.getSelectionCheckBoxContainer(this.getReusableContent())):this.columnHeadersLayout===r.COLUMN_HEADERS_LAYOUT.DEFAULT?this._injectInContainer(this.elements._selectionCheckBox,0,this._getRightButtonsContainer()):this._injectInLeftButtonsContainer(this.elements._selectionCheckBox,0))},buildColumnGroupExpander:function(t,n){var l=n.expandedFlag;if(!this.elements._columnGroupExpander&&this.elements.container){if(void 0===l)return;var r=t,s=t.layout;this.elements._columnGroupExpander=new e.Element("div",{class:"wux-column-group-expander"}),this.elements.tweakerContainer?this.elements._columnGroupExpander.inject(this.elements.tweakerContainer,"after"):this.elements._columnGroupExpander.inject(this.elements.container,"top"),i.addEventOnElement(this,this.elements._columnGroupExpander,o.POINTERHIT,function(e,t){var i=e.target;if(i){var n,o=i.getAttribute("expanded");if("true"===o?(n=!1,i.setAttribute("expanded","false")):"false"===o&&(n=!0,i.setAttribute("expanded","true")),void 0!==n)(t=r.getCellInfosFromHtmlElement(i))&&s.setColumnGroupExpandedFlag(t.rowID,t.columnID,n,{isUserInteraction:!0})}})}n.isExpanderHidden=void 0,this.elements._columnGroupExpander.removeAttribute("expander");var a=n.children?n.children.length:0;if(!0===l||!1===l){for(var d=!1,u=!1,h=!1,c=0;c<a;c++){var g=t.layout.getColumnOrGroupVisibleState(n.children[c]);if(void 0===n.children[c].columnGroupShow&&g){if(d=!0,u||h)break}else if("open"===n.children[c].columnGroupShow&&!1!==n.children[c].visibleFlag){if(u=!0,d||h)break}else if("closed"===n.children[c].columnGroupShow&&!1!==n.children[c].visibleFlag&&(h=!0,u||d))break}!(d&&u||d&&h||u&&h)&&(this.elements._columnGroupExpander.setAttribute("expander","hidden"),n.isExpanderHidden=!0)}!0===l?this.elements._columnGroupExpander.setAttribute("expanded","true"):!1===l?this.elements._columnGroupExpander.setAttribute("expanded","false"):this.elements._columnGroupExpander.setAttribute("expanded","")},getSelectionCheckBox:function(){return this.elements._selectionCheckBox},getInitialClassName:function(){return this._parent()+" wux-layouts-datagridview-column-header-cell"},_applycustomHeader:function(e){this.customHeader?((this.customHeader.getSelectionCheckBoxContainer||this.customHeader.getFilterViewContainer||this.customHeader.getSortIconContainer)&&(this.elements.buttonsContainer&&this.elements.buttonsContainer.remove(),this.elements.buttonsContainer=void 0,this.elements.leftButtonsContainer&&this.elements.leftButtonsContainer.remove(),this.elements.leftButtonsContainer=void 0,this.elements._columnGroupExpander&&this.elements._columnGroupExpander.remove(),this.elements._columnGroupExpander=void 0,this.elements._selectionCheckBox=void 0),this.elements.tweakerContainer&&this.elements.tweakerContainer.addClassName("wux-datagridview-custom-column-header")):(this._getRightButtonsContainer(),this.elements.tweakerContainer&&this.elements.tweakerContainer.removeClassName("wux-datagridview-custom-column-header"))},clean:function(){this.filterView=void 0,this.elements&&this.elements._selectionCheckBox&&this.customHeader&&this.customHeader.getSelectionCheckBoxContainer&&(this.elements._selectionCheckBox=void 0)}});return r.COLUMN_HEADERS_LAYOUT={DEFAULT:0,SELECTION_FIRST:1},r}),define("DS/DataGridView/DataGridView",["UWA/Core","UWA/Utils/Client","DS/CollectionView/CollectionView","DS/DataGridView/DataGridViewLayout","DS/DataGridView/RowModelClientSide","DS/DataGridView/RowModelServerSide","DS/Core/PointerEvents","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/ModelUtils","DS/Tweakers/TypeRepresentationFactory","DS/DataGridView/DataGridViewRow","DS/DataGridView/DataGridViewCell","DS/DataGridView/DataGridViewColumnHeaderCell","DS/DataGridView/DataGridViewRowHeaderCell","DS/DataGridView/DataGridViewTreeNodeCell","DS/DataGridView/CustomViewsManager","DS/Utilities/Dom","DS/Utilities/Utils","DS/Utilities/TreeUtils","DS/Menu/ContextualMenu","DS/DataGridView/DataGridViewContextualMenuBuilder","DS/Controls/SelectionChips","DS/Controls/Button","DS/Tweakers/GeneratedToolbar","DS/CollectionView/edition/CollectionViewEditionOnDoubleClick","DS/CollectionView/edition/CollectionViewEditionOnClick","DS/CollectionView/edition/CollectionViewDelayedEditionOnClick","DS/CollectionView/edition/CollectionViewEditionOnOver","DS/CollectionView/edition/CollectionViewEditionInPlace","i18n!DS/DataGridView/assets/nls/translation","DS/DataGridView/ModelMassUpdateDialog","DS/Windows/Dialog","DS/Selection/XSO","DS/WebappsUtils/WebappsUtils","DS/Core/WebUXComponents"],function(e,t,i,n,o,l,r,s,a,d,u,h,c,g,p,m,f,C,_,w,v,D,I,V,y,b,M,x,S,F,R,O,P,A,N,G){"use strict";var E,T,L,k,U=!1,H=t.Engine,B=4,W=!1,q=!1,j=!1;let X="COLUMNHEADER_";function z(e){return X+e}const K=Object.freeze({showIconsFlag:!0,buildLinks:!0,expanderStyle:"classic",depthIncrement:22,rootMargin:{mouse:18,touch:25},cellClass:m});function J(e,t){if(window.notifs){var i={level:"info",title:R[e],message:R[t],sticky:!1};window.notifs.addNotif(i)}}function Y(t){var i=void 0;if("object"==typeof t.cellModel?i=t.cellModel instanceof Date?t.cellModel.toLocaleDateString():JSON.stringify(t.cellModel):"string"==typeof t.cellModel?i=t.cellModel:void 0!==t.cellModel&&(i=t.cellModel.toString()),void 0!==t.cellModel&&this.layout.getColumnAllowUnsafeHTMLContent(t.columnID)){var n=e.createElement("div");n.innerHTML=i,i=n.innerText}return i}function Q(e,t){return"object"==typeof e.cellModel&&null!==e.cellModel?e.cellModel instanceof Date?new Date(t):JSON.parse(t):t}function $(e,t){var i;return(i="tree"===t?e.options.label:e.options.grid[t])instanceof Object&&i.hasOwnProperty("label")&&(i=i.label),i}function Z(t,i){if(j){var n=this.layout,o="middle"===t.dropPosition?n.getRowHeight(t.rowID):2,l=0;l="top"===t.dropPosition?n.getRowPosition(t.rowID):"bottom"===t.dropPosition?n.getRowPosition(t.rowID)+n.getRowHeight(t.rowID):n.getRowPosition(t.rowID);var r,s,a=n.getHeaderContainerHeight()+l-this.getScrollerPosition().y,d=n.getColumnIndex("tree"),u=-1;if(void 0!==d){var h=n.getCellIDFromCoordinates({rowID:t.rowID,columnID:d}),c=this._getViewAt(h);if(c){var g=c.elements.linksContainer.getBoundingClientRect(),p=this.getContent().getBoundingClientRect();u=g.right-p.left+1}}this._rowReorderDnDInfos.elements.line||(this._rowReorderDnDInfos.elements.line=new e.Element("div",{class:"wux-datagridview-drag-row-feedback"}),this._rowReorderDnDInfos.elements.chip=new e.Element("div",{class:"wux-datagridview-drag-row-feedback-chip"}).inject(this._rowReorderDnDInfos.elements.line),this._rowReorderDnDInfos.elements.line.inject(this.getContent())),"middle"===t.dropPosition?(r="none",s=!0===i?"1px solid #368ec4":!1===i?"1px solid #844138":"1px solid #E87B00"):(r=!0===i?"#368ec4":!1===i?" #844138":"#E87B00",s="none"),this._rowReorderDnDInfos.elements.line.setStyles({display:"block",top:a,height:o,border:s,background:r}),this._rowReorderDnDInfos.elements.chip.setStyles({display:"middle"===t.dropPosition||-1===u?"none":"block",left:u,background:r})}}function ee(){this._rowReorderDnDInfos.elements.line&&this._rowReorderDnDInfos.elements.line.hide()}function te(e,t){var i;if(t.cellView){var n=0,o=0,l=t.cellView.getContent().getBoundingClientRect(),r=!0,s=this.getTreeDocument();if(s){var a=s.usesAsyncDndCallbacks(),d=Object.getPrototypeOf(this).__rowReorderDnDInfos;if(d&&d.nodes&&d.nodes.length>0)for(var u=0;u<d.nodes.length;u++){if(d.nodes[u].isAscendantOf(t.nodeModel)||!a&&"function"==typeof s.options.shouldAcceptDrop&&!s.options.shouldAcceptDrop({parentTreeNodeModel:t.nodeModel,draggedTreeNodeModel:d.nodes[u],draggedNodes:d.nodes,dropNode:t.nodeModel,dropPosition:"middle"})){r=!1;break}}}r?(n=l.top+l.height/3,o=l.top+2*l.height/3):n=o=l.top+l.height/2,i=e.clientY<n?"top":e.clientY>=o?"bottom":"middle"}return i}function ie(t,i){if(!(i.draggedNodes&&0!==i.draggedNodes.length||t.defaultPrevented))return!1;this._rowReorderDnDInfos.dropPosition=i.dropPosition;var n=this,o=!1,l=this.getTreeDocument();if(l&&i.draggedNodes){var r={parentTreeNodeModel:"middle"===i.dropPosition?i.nodeModel:i.nodeModel.getParent(),draggedNodes:i.draggedNodes,dropPosition:i.dropPosition,dropNode:i.nodeModel};if(e.equals(r,this._latestShouldAcceptDropOptions))o=this._rowReorderDnDInfos.dropAccepted;else if(this._latestShouldAcceptDropOptions=r,l.usesAsyncDndCallbacks()){o=null;new Promise(function(e,t){l.options.shouldAcceptDrop(r,e,t)}).then(function(e){e||(t.dataTransfer.dropEffect="none"),n._rowReorderDnDInfos.dropAccepted=e,Z.call(n,i,e)})}else{o=!0;for(var s=0;s<i.draggedNodes.length;s++){var a=i.draggedNodes[s].isAscendantOf(i.nodeModel);if(r.draggedTreeNodeModel=i.draggedNodes[s],a||"function"==typeof l.options.shouldAcceptDrop&&!l.options.shouldAcceptDrop(r)){o=!1;break}}}}return this._rowReorderDnDInfos.dropAccepted=o,Z.call(this,i,o),this._rowReorderDnDInfos.dropAccepted}function ne(e,t){var i=Object.getPrototypeOf(this).__rowReorderDnDInfos;if(!i||i.source!==this._uuid||!i.nodes)return!1;var n=this.getDraggedRowData(e);if(n&&n.rowID!==t.rowID&&this._rowReorderDnDInfos.dropAccepted){var o=t.nodeModel.getTreeDocument();if(o){o.prepareUpdate(),this.prepareUpdateView();var l=o.getUseChangeTransactionMode();o.setUseChangeTransactionMode(!1);let e="middle"===this._rowReorderDnDInfos.dropPosition?0:"top"===this._rowReorderDnDInfos.dropPosition?-1:1;var r=d.moveNodes(i.nodes,t.nodeModel,{direction:e,ensureVisible:!0});if(o.pushUpdate(),this.sortModel=[],this.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),r.isExpanded()||r._isTrueRoot()){for(var s=0;s<i.nodes.length;s++){var a=i.nodes[s];a&&this.flashEffectOnNodeModel("ui-modified",a)}this.ensureNodeModelVisible(i.nodes[0],!0,!0,.5)}else this.flashEffectOnNodeModel("ui-modified",r),this.ensureNodeModelVisible(r,!0,!0,.5);o.setUseChangeTransactionMode(l)}else this._flashEffectOnRow("ui-notmodified",n.rowID)}return!0}function oe(e,t){var i,n={},o={};for(i=t.offsetParent,n.x=e.touches?e.touches[0].pageX:e.pageX,n.y=e.touches?e.touches[0].pageY:e.pageY,o.left=t.offsetLeft,o.top=t.offsetTop;i;)o.left+=i.offsetLeft,o.top+=i.offsetTop,i=i.offsetParent;return{x:n.x-o.left,y:n.y-o.top}}function le(){null!==this._autoScrollInfos.interval&&(clearInterval(this._autoScrollInfos.interval),this._autoScrollInfos.interval=null)}function re(e,t){var i=this._getScroller().getContent(),n=oe(e,i),o=this.getScrollerPosition();if(this._autoScrollInfos.moveY=0,this._autoScrollInfos.moveX=0,n.x>=-this._leftContainerWidth&&n.x<=i.clientWidth+this._rightContainerWidth&&n.y>=0&&n.y<=i.clientHeight){n.y<40&&0!==o.y?this._autoScrollInfos.moveY=n.y-40:n.y>i.clientHeight-40&&Math.abs(o.y+i.clientHeight-i.scrollHeight)>=1&&(this._autoScrollInfos.moveY=n.y-(i.clientHeight-40))}if(t&&t.rowID<0){let t=this.elements.headerScrollContainer,i=oe(e,t);if(i.x>=0&&i.x<=t.clientWidth){let e=60;i.x<e&&0!==o.x?this._autoScrollInfos.moveX=i.x-e:i.x>t.clientWidth-e&&Math.abs(o.x+t.clientWidth-t.scrollWidth)>=1&&(this._autoScrollInfos.moveX=i.x-(t.clientWidth-e))}}return this._autoScrollInfos.interval||0===this._autoScrollInfos.moveY&&0===this._autoScrollInfos.moveX||this._infoOnTouchDown&&(this._infoOnTouchDown.clientX===e.clientX||this._infoOnTouchDown.clientY===e.clientY)?0===this._autoScrollInfos.moveX&&0===this._autoScrollInfos.moveY&&le.call(this):function(e){var t=this;this._disableAutoScroll();var i={x:e.x,y:e.y};this._autoScrollInfos.interval=setInterval(function(){i.x+=t._autoScrollInfos.moveX,i.y+=t._autoScrollInfos.moveY,t.setScrollerPosition(i)},60)}.call(this,o),0!==this._autoScrollInfos.moveY}function se(e){if(this._draggedColumnOrGroup&&this._draggedColumnOrGroup._isMoving){this._draggedColumnOrGroup._isMoving=!1,w.processTreeChildren(this._draggedColumnOrGroup.children,function(e){e._isMoving=!1});for(var t=w.getLeafItems(this._draggedColumnOrGroup),i=0;i<t.length;i++){var n=t[i];0===i&&(n._isFirstColumnMoving=!1)}if(e){var o=this.layout;this._updateColumnHeaderCells({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0});for(i=0;i<t.length;i++){n=t[i];var l=o.getColumnIndex(n.dataIndex);this.updateColumnView(l,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})}}}}function ae(t){var i=R.Menu,n=this._getCurrentTouchMode(),o=n?14:12,l=n?28:14,r={completed:!0,text:i,dataIndex:"ContextualMenuColumn",pinned:"right",editableFlag:!1,sortableFlag:!1,groupableFlag:!1,resizableFlag:!1,selectableFlag:!1,printableFlag:!1,width:Math.max(Math.ceil(C.computeStringWidth(i,o,"Arial",!1,!1))+l,45),alignment:"center",getCellValue:function(e){return{}}};let s=e.merge(t,r);return s.typeRepresentation="chevronMenuIcon",s}var de=new u;function ue(){this._rowModel&&this._rowModel._isServerSide()&&(this.findWidget&&this.findWidget.close?this.findWidget.close():this.findCtx&&this.findCtx.findWidget&&(void 0!==this.findCtx.findWidget.visibleFlag?this.findCtx.findWidget.visibleFlag=!1:this.findCtx.findWidget.close instanceof Function&&this.findCtx.findWidget.close()))}function he(){let e=this.getTreeDocument();if(e){let i=e.getXSO().get();for(var t=0;t<i.length;t++)i[t].remove()}}return i.inherit({name:"dataGridView",publishedProperties:{useWidgetPreferencesFlag:{defaultValue:!1,type:"boolean",readOnly:!0},maxVisibleRowCount:{defaultValue:void 0,type:"number",category:"Behavior"},treeDocument:{defaultValue:null,type:"object"},dataSource:{defaultValue:null,type:"object"},layoutOptions:{defaultValue:null,type:"object",readOnly:!0},virtuallyLoadAllModelItems:{defaultValue:!1,type:"boolean"},syncClientModelOnDemand:{defaultValue:!1,type:"boolean"},cellSelection:{defaultValue:"multiple",type:"string"},defaultColumnDef:{defaultValue:{showTextFlag:!0,description:"",typeRepresentation:"string",getCellTypeRepresentation:function(e){var t=this.layout;return t?t.getColumnTypeRepresentation(e.columnID):"string"},width:"auto",minWidth:40,autoRowHeightFlag:!1,visibleFlag:!0,editableFlag:!1,disabled:!1,editionPolicy:"EditionOnDoubleClick",resizableFlag:!0,selectableFlag:!0,sortableFlag:!0,groupableFlag:!0,printableFlag:!0,massUpdateAllowedFlag:!0,pinned:"unpinned",autoSizePadding:0,allowUnsafeHTMLContent:!1,shouldCellAllowUnsafeHTMLContentAt:function(e){var t=this.layout;return!!t&&t.getColumnAllowUnsafeHTMLContent(e.columnID)},allowResetToUndefinedByUIFlag:!1,className:"",getCellClassName:function(e){var t=this.layout;return!!(t&&e.rowID>=0)&&t.getColumnClassName(e.columnID)},getCellIcons:function(e){if(e.nodeModel&&e.nodeModel.getIcons)return e.nodeModel.getIcons()}},type:"object"},columns:{defaultValue:[],type:"array"},sortModel:{defaultValue:null,type:"array",advancedSetter:!0},sortOptions:{defaultValue:void 0,type:"object"},layout:{defaultValue:null,type:"object"},cellClass:{defaultValue:c,type:"object"},rowGroupingOptions:{defaultValue:{depth:0,hideGroupedColumns:!0,canNodeBeGrouped:null,getNodeGroupingKey:null,getGroupingNodeOptions:null,getGroupingNodeLabel:null,getGroupingNodeIcons:null,mapGroupingKeys:null},type:"object"},onContextualEvent:{defaultValue:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e)),t},type:"function"},columnSelection:{defaultValue:"none",type:"string"},rowReorderEnabledFlag:{defaultValue:!0,type:"boolean",noNeedToApplyFlag:!0},rowGroupingEnabledFlag:{defaultValue:!0,type:"boolean",noNeedToApplyFlag:!0},columnDragEnabledFlag:{defaultValue:!0,type:"boolean"},onDragStartColumnHeader:{defaultValue:void 0,type:"function"},onDragEndColumnHeader:{defaultValue:void 0,type:"function"},onDragEnterColumnHeader:{defaultValue:void 0,type:"function"},onDragLeaveColumnHeader:{defaultValue:void 0,type:"function"},onDragColumnHeader:{defaultValue:void 0,type:"function"},onDragOverColumnHeader:{defaultValue:void 0,type:"function"},onDropColumnHeader:{defaultValue:void 0,type:"function"},rowDragEnabledFlag:{defaultValue:!1,type:"boolean"},onDragStartRowHeader:{defaultValue:void 0,type:"function"},onDragEndRowHeader:{defaultValue:void 0,type:"function"},onDragEnterRowHeader:{defaultValue:void 0,type:"function"},onDragLeaveRowHeader:{defaultValue:void 0,type:"function"},onDragRowHeader:{defaultValue:void 0,type:"function"},onDragOverRowHeader:{defaultValue:void 0,type:"function"},onDropRowHeader:{defaultValue:void 0,type:"function"},cellDragEnabledFlag:{defaultValue:!1,type:"boolean"},onDragStartCell:{defaultValue:void 0,type:"function"},onDragEndCell:{defaultValue:void 0,type:"function"},onDragEnterCell:{defaultValue:void 0,type:"function"},onDragLeaveCell:{defaultValue:void 0,type:"function"},onDragCell:{defaultValue:void 0,type:"function"},onDragOverCell:{defaultValue:void 0,type:"function"},onDropCell:{defaultValue:void 0,type:"function"},onDragStartBlank:{defaultValue:void 0,type:"function"},onDragEndBlank:{defaultValue:void 0,type:"function"},onDragEnterBlank:{defaultValue:void 0,type:"function"},onDragLeaveBlank:{defaultValue:void 0,type:"function"},onDragBlank:{defaultValue:void 0,type:"function"},onDragOverBlank:{defaultValue:void 0,type:"function"},onDropBlank:{defaultValue:void 0,type:"function"},focusNextEditableCellOnTabFlag:{defaultValue:!1,type:"boolean",noNeedToApplyFlag:!0},selectNextCellOnEnterFlag:{defaultValue:!0,type:"boolean",noNeedToApplyFlag:!0},cellActivationFeedback:{defaultValue:"cell",type:"string"},showEditableFeedbackFlag:{defaultValue:!0,type:"boolean"},showRequiredFeedbackFlag:{defaultValue:!0,type:"boolean"},showRowBorderFlag:{defaultValue:!1,type:"boolean"},showColumnBorderFlag:{defaultValue:!1,type:"boolean"},showModelChangesFlag:{defaultValue:!1,type:"boolean"},showAlternateBackgroundFlag:{defaultValue:!0,type:"boolean"},showRowIndexFlag:{defaultValue:!0,type:"boolean"},showSelectionCheckBoxesFlag:{defaultValue:"OnOver",type:"string"},showOutlineFlag:{defaultValue:!1,type:"boolean"},showRowHeaderBackgroundFlag:{defaultValue:!0,type:"boolean"},showContextualMenuColumnFlag:{defaultValue:!1,type:"boolean"},treeNodeCellOptions:{defaultValue:void 0,type:"TreeNodeCellOptions",advancedSetter:!0},showNodeKPIColorFlag:{defaultValue:!1,type:"boolean"},placeholder:{defaultValue:R.get("NoObjectsFound"),type:"string"},getCellTooltip:{defaultValue:null,type:"function",noNeedToApplyFlag:!1},useAsyncPreExpand:{defaultValue:void 0,type:"boolean"},selectionStyle:{defaultValue:"",type:"string"},findNavigationMode:{defaultValue:"substring",type:"string"},showMatchingCellBackgroundFlag:{defaultValue:!1,type:"boolean"},shouldNodeBeRepresented:{defaultValue:function(e){return!0},type:"function",noNeedToApplyFlag:!0},nodeModelClass:{defaultValue:void 0,type:"function",noNeedToApplyFlag:!0},documentClassForServerSide:{defaultValue:s,type:"function",noNeedToApplyFlag:!0},customViewsOptions:{defaultValue:void 0,type:"object",noNeedToApplyFlag:!0},filterViewOptions:{defaultValue:void 0,type:"object"},deleteOptions:{defaultValue:void 0,type:"object",noNeedToApplyFlag:!0},columnHeadersLayout:{defaultValue:g.COLUMN_HEADERS_LAYOUT.DEFAULT,type:"enum"}},_useTreeDocumentRestoration:!0,_currentlyCalledFromApplyPreferencesFlag:!1,__preferencesRestored:!1,_manageKeyboard:function(){this._parent();const t=Object.assign({},this.commands);let i=this.commands.deleteKeyPressed;e.extend(t,{rightMove:function(){const e=this.computeCellIDFromActiveCell("right");if("row"===this.cellActivationFeedback){const t=this.getCellInfosAt(e);t&&t.nodeModel&&t.nodeModel.getChildren()&&"noExpandState"!==t.nodeModel._expandState&&"expandingState"!==t.nodeModel._expandState&&(!t.nodeModel.isExpanded()||"partiallyExpandedState"===t.nodeModel._expandState)&&t.nodeModel.expand()}else this.selectionBehavior.toggle?this.setActiveCell(e):this.selectCell(e,!1,!1);return{preventDefault:!0}},leftMove:function(){const e=this.computeCellIDFromActiveCell("left");if("row"===this.cellActivationFeedback){const t=this.getCellInfosAt(e);t&&t.nodeModel&&t.nodeModel.getChildren()&&"noExpandState"!==t.nodeModel._expandState&&"expandingState"!==t.nodeModel._expandState&&t.nodeModel.isExpanded()&&"partiallyExpandedState"!==t.nodeModel._expandState&&t.nodeModel.collapse()}else this.selectionBehavior.toggle?this.setActiveCell(e):this.selectCell(e,!1,!1);return{preventDefault:!0}},deleteKeyPressed:function(){this.deleteOptions&&this.deleteOptions.deleteSelectionOnKeyPress&&this._askForDeletion(),i.call(this)}}),this.commands=t},getCurrentRootMargin:function(){return this._getCurrentTouchMode()?this.treeNodeCellOptions.rootMargin.touch:this.treeNodeCellOptions.rootMargin.mouse},_preBuildView:function(e){this._initialized=!1,this._editionManagers=[],this._useClipboardFlag=!0,this._properties.layout.value=new n(e?e.layoutOptions:e),this._properties.treeNodeCellOptions.value=Object.assign({},K),this._contextualMenuBuilder=new D(this),this._selectAllCheckBoxListenChange=!0,this._hasFlatTreeState=!0,this._tweakerToGenerateCount=0,this._inOnAllCellsRendered=!1,this._resetRowHeightsOnAllCellsRenderedFlag=!1,this._modelMassUpdateDialog=null,this._asyncExpandSubscribed=!1,this._asyncExpandToken=null,this._customViewsManager=new f({collectionView:this}),this._rowReorderDnDInfos={elements:{line:null,chip:null},direction:-1,dropAccepted:!1},this._disableRowReorderCpt=0,this._autoScrollInfos={interval:null,moveX:0,moveY:0},this._parent(e)},buildView:function(){this._parent(),this.getContent().classList.add("wux-layouts-datagridview"),this.elements.rowHeaderExtension=new e.Element("div",{class:"wux-datagridview-layouts-row-header-extension"}),this.elements.rowHeaderExtensionHeaderPoolContainer=new e.Element("div",{class:"wux-datagridview-layouts-row-header-extension-header-poolcontainer"}).inject(this.elements.rowHeaderExtension),this.elements.rowHeaderExtensionScrollContainer=new e.Element("div",{class:"wux-datagridview-layouts-row-header-extension-scroll-container"}),this.elements.rowHeaderExtensionPoolContainer=new e.Element("div",{class:"wux-datagridview-layouts-row-header-extension-poolcontainer"}).inject(this.elements.rowHeaderExtensionScrollContainer),this.elements.rowHeaderExtensionScrollContainer.inject(this.elements.rowHeaderExtension),this.elements.rowHeaderExtension.inject(this.elements.container)},_handleEvents:function(){this._parent();var e=this.elements.scroller;C.addEventOnElement(this,this.elements.rowHeaderExtensionPoolContainer,"wheel",function(t){var i=t.deltaY;t.deltaMode&&1===t.deltaMode&&(i*=this.layout.cellHeight),e.setPosition({y:e.elements.container.scrollTop+i},!0)});const t=function(e,t){if(this._isCurrentlyCalledFromUIInteraction()&&t&&t.columnID>=0&&("change"===e.type||"liveChange"===e.type&&!0===this.layout.getColumnOptionValue(t.columnID,"liveUpdateFlag"))&&t.cellView&&t.rowID>=0){ue.call(this);var i=t.cellView.getReusableContent();if(i){var n=i.value,o=i.referenceValue;this.setModelAt(t.cellID,n,o),this._matchingCellIDsArray&&!this._muteFind&&this.setFindStr(this.findStr,this.matchCase,this._rowModel._computeFindEditorCurrentValue(),!0,!0)}}};C.addEventOnElement(this,this,"change",t.bind(this)),C.addEventOnElement(this,this,"liveChange",t.bind(this))},_applyProperties:function(e){this._parent(e),this.isDirty("dataSource")&&this._applyDataSource(e.dataSource),this.isDirty("virtuallyLoadAllModelItems")&&this._applyVirtuallyLoadAllModelItems(e.virtuallyLoadAllModelItems),this.isDirty("treeDocument")&&this._applyTreeDocument(e.treeDocument),this.isDirty("defaultColumnDef")&&this._applyDefaultColumnDef(e.defaultColumnDef),this.isDirty("layout")&&this._applyLayout(e.layout),this.isDirty("columns")&&this._applyColumns(e.columns),this.isDirty("showContextualMenuColumnFlag")&&this._applyShowContextualMenuColumnFlag(e.showContextualMenuColumnFlag),this.isDirty("sortModel")&&G._applyForAdvancedSetterProperty(this,"sortModel",e.sortModel,this.sortModel),this.isDirty("columnSelection")&&this._applyColumnSelection(e.columnSelection),this.isDirty("columnDragEnabledFlag")&&this._applyColumnDragEnabledFlag(e.columnDragEnabledFlag),this.isDirty("rowDragEnabledFlag")&&this._applyRowDragEnabledFlag(e.rowDragEnabledFlag),this.isDirty("cellDragEnabledFlag")&&this._applyCellDragEnabledFlag(e.cellDragEnabledFlag),this.isDirty("cellActivationFeedback")&&this._applyCellActivationFeedback(e.cellActivationFeedback),this.isDirty("showEditableFeedbackFlag")&&this._applyShowEditableFeedbackFlag(e.showEditableFeedbackFlag),this.isDirty("showRequiredFeedbackFlag")&&this._applyShowRequiredFeedbackFlag(e.showRequiredFeedbackFlag),this.isDirty("showRowBorderFlag")&&this._applyShowRowBorderFlag(e.showRowBorderFlag),this.isDirty("showColumnBorderFlag")&&this._applyShowColumnBorderFlag(e.showColumnBorderFlag),this.isDirty("showAlternateBackgroundFlag")&&this._applyShowAlternateBackgroundFlag(e.showAlternateBackgroundFlag),this.isDirty("showRowIndexFlag")&&this._applyShowRowIndexFlag(e.showRowIndexFlag),this.isDirty("showSelectionCheckBoxesFlag")&&this._applyShowSelectionCheckBoxesFlag(e.showSelectionCheckBoxesFlag),this.isDirty("showOutlineFlag")&&this._applyShowOutlineFlag(e.showOutlineFlag),this.isDirty("showRowHeaderBackgroundFlag")&&this._applyShowRowHeaderBackgroundFlag(e.showRowHeaderBackgroundFlag),this.isDirty("treeNodeCellOptions")&&G._applyForAdvancedSetterProperty(this,"treeNodeCellOptions",e.treeNodeCellOptions,this.treeNodeCellOptions),this.isDirty("showNodeKPIColorFlag")&&this._applyShowNodeKPIColorFlag(e.showNodeKPIColorFlag),this.isDirty("rowGroupingOptions")&&this._applyRowGroupingOptions(e.rowGroupingOptions),this.isDirty("placeholder")&&this._applyPlaceholder(e.placeholder),this.isDirty("useAsyncPreExpand")&&this._applyUseAsyncPreExpand(e.useAsyncPreExpand),this.isDirty("selectionStyle")&&this._applySelectionStyle(e.selectionStyle),this.isDirty("findNavigationMode")&&this._applyFindNavigationMode(e.findNavigationMode),this.isDirty("showMatchingCellBackgroundFlag")&&this._applyShowMatchingCellBackgroundFlag(e.showMatchingCellBackgroundFlag),this.isDirty("filterViewOptions")&&this._applyFilterViewOptions(e.filterViewOptions)},_applyColumnHeadersLayout:function(e){this.columnHeadersLayout!==e&&void 0!==e&&this.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})},_applyMaxVisibleRowCount:function(){if(void 0!==this.maxVisibleRowCount){var e=this._rowModel?this._rowModel.getRowModelLength():0,t=0===e?0:this.layout.getRowHeight(0),i=0===e?0:this.layout.rowSpacing,n=this.layout.getHeaderContainerHeight(),o=Math.min(this.maxVisibleRowCount,e);this._heightForGivenRowCount=t*o+i*(o-1)+n,this.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})}},_applyTouchMode:function(){this._parent();let e=this._getCurrentTouchMode();B=e?8:4,this._isReady&&(this._applyMaxVisibleRowCount(void 0,this.maxVisibleRowCount),this.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}))},_applyVirtualViewportSize:function(){this._parent(),void 0!==this.maxVisibleRowCount&&void 0!==this._heightForGivenRowCount&&(this._hasLeftContainerHorizontalOverflow||this._hasCenterContainerHorizontalOverflow||this._hasRightContainerHorizontalOverflow?this.height=this._heightForGivenRowCount+_.getScrollbarWidth():this.height=this._heightForGivenRowCount);var e=this.layout,t=this.getStatusBarContainerHeight();this.elements.rowHeaderExtension.setStyle("bottom",t+"px");var i=e.rowsHeader?e.getRowHeaderWidth():0;e.rowsHeader?(this.elements.rowHeaderExtension.removeAttribute("hideBorder"),this.elements.rowHeaderExtension.style.width=i+"px"):(this.elements.rowHeaderExtension.setAttribute("hideBorder",""),this.elements.rowHeaderExtension.style.width="0px");var n=this._headerContainerHeight;this._rowHeaderExtensionHeaderContainerHeight!==n&&(this._rowHeaderExtensionHeaderContainerHeight=n,this.elements.rowHeaderExtensionHeaderPoolContainer.setStyle("height",this._headerContainerHeight));var o=this.__cachedContentDimensions.height+(this._hasCenterContainerHorizontalOverflow?0:1);this._rowHeaderExtensionContainerHeight!==o&&(this._rowHeaderExtensionContainerHeight=o,this.elements.rowHeaderExtensionScrollContainer.setStyle("height",o),this.elements.rowHeaderExtensionPoolContainer.setStyle("height",o));var l=this.getScrollerPosition();if(this.elements.rowHeaderExtensionPoolContainer.setStyle("top",(l?-l.y:0)+"px"),this.hasLeftContainer()&&this._rowHeaderWidth!==i){this._rowHeaderWidth=i;var r=i;this.elements.leftHeaderScrollContainer.setStyle("left",r),this.elements.leftScrollContainer.setStyle("left",r),this.elements.leftSpacerContainer.setStyle("left",r)}},_applyModel:function(e){this._parent(e),this.layout&&(this.layout.resetRowHeights(),this.layout.hasColumnWithAutoRowHeightFlag()&&this._resetRowHeightsOnAllCellsRendered());var t=this._activeCellStableID;this._updateXSOElements(),this._updateActiveCell(t)},_applyHeight:function(e){e!==this.height&&(this._parent(),"inherit"!==this.height&&(this.elements.container.style.position&&"static"!==this.elements.container.style.position||(this.elements.container.style.position="relative")))},_applyFilterViewOptions:function(e){let t=this.getFilterViewManager();t&&t.refreshFilterViews()},_flashEffectOnRow:function(e,t){var i=this.getNodeModelAtRowID(t);i&&this.flashEffectOnNodeModel(e,i)},getFilterViewManager:function(){if(this._rowModel)return this._rowModel.getFilterViewManager()},getUseClipboardFlag:function(){return this._useClipboardFlag},setUseClipboardFlag:function(e){this._useClipboardFlag=e},_applyDataSource:function(e){if(this.dataSource&&e!==this.dataSource){void 0===this._rowModel&&(this._rowModel=new l({dataGridView:this,sortModel:this.sortModel,rowGroupingOptions:this.rowGroupingOptions,virtuallyLoadAllModelItems:this.virtuallyLoadAllModelItems})),this.dataSource&&this.dataSource!==this._rowModel.dataSource&&(this._rowModel.dataSource=this.dataSource);var t=this.getTreeDocument();t&&this._subscribeToPreExpand(t),this.getGroupingOptions()&&this.groupRows(this.getGroupingOptions())}},_applyVirtuallyLoadAllModelItems:function(e){this._rowModel&&this._rowModel.dataSource&&(this._rowModel.virtuallyLoadAllModelItems=this.virtuallyLoadAllModelItems)},_applyTreeDocument:function(e){e&&this.treeDocument!==e&&(this._unsubscribeToPreExpand(e),this._useTreeDocumentRestoration&&d.destroyTreeDocumentOrderSnapshot(e)),this.treeDocument&&(void 0===this._rowModel?this._rowModel=new o({dataGridView:this,sortModel:this.sortModel,rowGroupingOptions:this.rowGroupingOptions,treeDocument:this.treeDocument}):this._rowModel.treeDocument=this.treeDocument,this.treeDocument!==e&&this._subscribeToPreExpand(this.treeDocument),this.getGroupingOptions()&&this.groupRows(this.getGroupingOptions()))},_applyUseAsyncPreExpand:function(e){var t=this.getTreeDocument();t&&void 0!==this.useAsyncPreExpand&&(t.options.useAsyncPreExpand=this.useAsyncPreExpand)},_applySelectionStyle:function(e){"lightSelectionEdging"===this.selectionStyle?this.getContent().setAttribute("selection-style",this.selectionStyle):this.getContent().removeAttribute("selection-style")},_applyFindNavigationMode:function(e){if(this.getContent().setAttribute("find-navigation-mode",this.findNavigationMode),this.findStr&&""!=this.findStr&&!this._muteFind){var t=void 0===this._currentMatchingStringIndex?0:this._currentMatchingStringIndex+1;this.setFindStr(this.findStr,this.matchCase,t,!0,!0)}},_applyShowMatchingCellBackgroundFlag:function(e){this.showMatchingCellBackgroundFlag?this.getContent().setAttribute("show-matching-cell-background",""):this.getContent().removeAttribute("show-matching-cell-background")},_unsubscribeToPreExpand:function(e){e&&this._asyncExpandToken&&e.getModelEvents()&&e.getModelEvents().unsubscribe(this._asyncExpandToken),this._asyncExpandSubscribed=!1,this._asyncExpandToken=null},_subscribeToPreExpand:function(e){if(e&&!this._asyncExpandSubscribed){this._asyncExpandSubscribed=!0;var t=this;this._asyncExpandToken=e.getModelEvents().subscribe({event:"preExpandPrivate"},function(i){if(e.options&&e.options.useAsyncPreExpand&&1===e.getExpandingCounter()){var n=i.target,o=t.layout.getColumnIndex("tree");if(void 0!==o){var l=t.layout.getCellIDFromCoordinates({rowID:n._getRowID(),columnID:o}),r=t._getViewAt(l);r&&(r.elements.expanderContainer.setAttribute("data-wux-state","expanding"),e.getModelEvents().subscribeOnce({event:"PRE_EXPAND_DONE"},function(e){var t=n.getChildren();"collapsed"===n.getState()?r.elements.expanderContainer.setAttribute("data-wux-state","collapsed"):t&&0!==t.length?"partiallyExpanded"===n.getState()?r.elements.expanderContainer.setAttribute("data-wux-state","partiallyExpanded"):r.elements.expanderContainer.setAttribute("data-wux-state","expanded"):r.elements.expanderContainer.setAttribute("data-wux-state","noChildren")}))}}})}},hasFlatTreeState:function(){return this._hasFlatTreeState},_applyDefaultColumnDef:function(e){var t=this.defaultColumnDef;void 0===t.showTextFlag&&(t.showTextFlag=!0),void 0===t.description&&(t.description=""),void 0===t.typeRepresentation&&(t.typeRepresentation="string"),void 0===t.getCellTypeRepresentation&&(t.getCellTypeRepresentation=function(e){var t=this.layout;return t?t.getColumnTypeRepresentation(e.columnID):"string"}),void 0===t.width&&(t.width="auto"),void 0===t.minWidth&&(t.minWidth=40),void 0===t.autoRowHeightFlag&&(t.autoRowHeightFlag=!1),void 0===t.visibleFlag&&(t.visibleFlag=!0),void 0===t.editableFlag&&(t.editableFlag=!1),void 0===t.disabled&&(t.disabled=!1),void 0===this.defaultColumnDef.editionPolicy&&(this.defaultColumnDef.editionPolicy="EditionOnDoubleClick"),void 0===t.resizableFlag&&(t.resizableFlag=!0),void 0===t.selectableFlag&&(t.selectableFlag=!0),void 0===t.sortableFlag&&(t.sortableFlag=!0),void 0===t.findableFlag&&(t.findableFlag=!0),void 0===t.groupableFlag&&(t.groupableFlag=!0),void 0===t.printableFlag&&(t.printableFlag=!0),void 0===t.massUpdateAllowedFlag&&(t.massUpdateAllowedFlag=!0),void 0===t.pinned&&(t.pinned="unpinned"),void 0===t.autoSizePadding&&(t.autoSizePadding=0),void 0===t.allowUnsafeHTMLContent&&(t.allowUnsafeHTMLContent=!1),void 0===t.shouldCellAllowUnsafeHTMLContentAt&&(t.shouldCellAllowUnsafeHTMLContentAt=function(e){var t=this.layout;return!!t&&t.getColumnAllowUnsafeHTMLContent(e.columnID)}),void 0===t.allowResetToUndefinedByUIFlag&&(t.allowResetToUndefinedByUIFlag=!1),void 0===t.className&&(t.className=""),void 0===t.getCellClassName&&(t.getCellClassName=function(e){var t=this.layout;return!!(t&&e.rowID>=0)&&t.getColumnClassName(e.columnID)}),void 0===t.getCellIcons&&(t.getCellIcons=function(e){if(e.nodeModel&&e.nodeModel.getIcons)return e.nodeModel.getIcons()})},_applyColumns:function(e){var t=this.layout;if(t){if(this.showContextualMenuColumnFlag){var i=this._getColumnOrGroup(this.columns,"ContextualMenuColumn");i?i.completed||ae.call(this,i):(i=ae.call(this,{}),this.columns.push(i))}t.columns!==this.columns?t.columns=this.columns:t._applyColumns(),t.hasAutoWidthColumn()?this.getContent().setAttribute("has-auto-width-column",""):this.getContent().removeAttribute("has-auto-width-column"),t._getColumnTreeDepth()>1?this.getContent().setAttribute("has-column-groups",""):this.getContent().removeAttribute("has-column-groups")}},_applyShowContextualMenuColumnFlag:function(e){var t=this.layout;this.showContextualMenuColumnFlag&&!this._getColumnOrGroup(this.columns,"ContextualMenuColumn")&&this._applyColumns(this.columns),this._getColumnOrGroup(this.columns,"ContextualMenuColumn")&&t.setColumnVisibleFlag("ContextualMenuColumn",!0===this.showContextualMenuColumnFlag)},_getColumnOrGroup:function(e,t,i){for(var n,o=0;o<e.length;o++){var l=e[o];if(l){if(!(l.dataIndex!==t||i&&i!==this.layout._getColumnGroupIndexInItsRow(l))){n=l;break}if(l.children&&(n=this._getColumnOrGroup(l.children,t,i)))break}}return n},getColumnOrGroup:function(e,t){var i=this.layout,n="string"==typeof e?e:i.getColumnIdentifiers(e).dataIndex;return this._getColumnOrGroup(i._balancedColumnTree,n,t)},_addColumnOrGroup:function(e,t,i){for(let n of t){let t=!1;if(n.dataIndex)for(let o of e)if(n.dataIndex===o.dataIndex){t=!0,n.children&&(o.children?this._addColumnOrGroup(o.children,n.children,i):o.children=n.children);break}if(!t){let t=void 0===i||i>e.length?e.length:i;e.splice(t,0,n)}}},addColumnOrGroup:function(e,t){var i=this.columns;i||(this.columns=[],i=this.columns),this._addColumnOrGroup(i,[e],t),this.layout.applyColumns(),this.requestDelayedModelData("OnAddColumn")},_removeColumnOrGroup:function(e,t){for(var i=0,n=0;n<e.length;n++){var o=e[n];if(o){if(o.dataIndex===t){e.splice(n,1),o._parent=null,i=1;break}if(o.children&&(i=this._removeColumnOrGroup(o.children,t))){0===o.children.length&&delete o.children;break}}}return i},removeColumnOrGroup:function(e){var t=this.layout.getColumnIdentifiers(e).dataIndex;this._removeColumnOrGroup(this.columns,t)&&this.layout.applyColumns()},_preEditSortModel:function(e,t){const i=this.sortOptions?this.sortOptions.maxSortedColumnsCount:void 0;if(!(!t||"number"!=typeof i||t.length<=i)){const n=this.sortOptions.onOutOfBoundSortRequest;n&&C.isCurrentlyCalledFromUIInteraction()&&n({currentSortModel:e,rejectedSortModel:t});let o=[...t];return o.length=i,{validValue:o}}return!0},_applySortModel:function(e){this._rowModel&&(this._rowModel.sortModel=this.sortModel,this.fire("sortModelChange"))},_applySortOptions(e,t){if(t&&"number"==typeof t.maxSortedColumnsCount){let e=this.sortModel;!this.isDirty("sortModel")&&e&&e.length>t.maxSortedColumnsCount&&(e.length=t.maxSortedColumnsCount)}},_applyLayout:function(e){this._parent(e),e&&this._applyColumns()},_applyColumnSelection:function(){if(this.getContent().setAttribute("column-selection",this.columnSelection),"none"===this.columnSelection||this._columnsXSO)"none"===this.columnSelection&&this._columnsXSO&&this._columnsXSO.empty();else{var e=this;this._columnsXSO=new A({useUniqueID:!0,getElementID:this.getXSOColumnID}),this._columnsXSO.onPostAdd(function(t){if(t.forEach(function(t){const i=t;e.updateColumnView(i,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})}),e._updateColumnHeaderCells({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0}),e._modelMassUpdateDialog){const t=e._buildMassUpdateDialogAttributes();e._modelMassUpdateDialog.attributes=t,e._modelMassUpdateDialog.resetAttributesValues()}}),this._columnsXSO.onPostRemove(function(t){if(t.forEach(function(t){const i=t;e.updateColumnView(i,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})}),e._updateColumnHeaderCells({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0}),e._modelMassUpdateDialog){const t=e._buildMassUpdateDialogAttributes();e._modelMassUpdateDialog.attributes=t,e._modelMassUpdateDialog.resetAttributesValues()}})}this._isReady&&this._renderViewport({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})},_applyColumnDragEnabledFlag:function(e){},_applyRowDragEnabledFlag:function(e){this._updateFromRowDragEnabledState(),this.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!1})},_applyCellDragEnabledFlag:function(e){},_applyCellActivationFeedback:function(e){this.cellActivationFeedback&&"none"!==this.cellActivationFeedback?this.getContent().setAttribute("cell-activation-feedback",this.cellActivationFeedback):this.getContent().removeAttribute("cell-activation-feedback")},_applyRowSelection:function(e){this._parent(e),this._applyCellPreselectionFeedback()},_applyCellSelection:function(e){this._parent(e),this._applyCellPreselectionFeedback()},_applyCellPreselectionFeedback:function(e){this._parent(e);var t=this.getUsedCellPreselectionFeedback();t&&"none"!==t?this.getContent().setAttribute("cell-preselection-feedback",t):this.getContent().removeAttribute("cell-preselection-feedback")},_applyShowEditableFeedbackFlag:function(e){this.invalidateLayout({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})},_applyShowRequiredFeedbackFlag:function(e){this.invalidateLayout({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})},_applyShowRowBorderFlag:function(e,t){this.showRowBorderFlag?this.getContent().setAttribute("show-row-border",""):this.getContent().removeAttribute("show-row-border"),this.layout&&this.layout.resetRowHeights()},_applyShowColumnBorderFlag:function(e,t){this.showColumnBorderFlag?this.getContent().setAttribute("show-column-border",""):this.getContent().removeAttribute("show-column-border")},_applyShowModelChangesFlag:function(e){this.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})},_applyShowAlternateBackgroundFlag:function(e){this.showAlternateBackgroundFlag?this.getContent().setAttribute("show-alternate-background",""):this.getContent().removeAttribute("show-alternate-background")},_applyShowRowIndexFlag:function(e){this.showRowIndexFlag?this.getContent().setAttribute("show-row-index",""):this.getContent().removeAttribute("show-row-index"),this.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})},_applyShowSelectionCheckBoxesFlag:function(e){!1!==this.showSelectionCheckBoxesFlag?this.getContent().setAttribute("show-selection-check-boxes",this.showSelectionCheckBoxesFlag):this.getContent().removeAttribute("show-selection-check-boxes"),this.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})},_applyShowOutlineFlag:function(e){this.showOutlineFlag?this.getContent().setAttribute("show-outline",""):this.getContent().removeAttribute("show-outline")},_applyShowRowHeaderBackgroundFlag:function(e){this.showRowHeaderBackgroundFlag?this.getContent().setAttribute("show-row-header-background",""):this.getContent().removeAttribute("show-row-header-background")},_preEditTreeNodeCellOptions:function(e,t){if(void 0===t)return{validValue:Object.assign({},K)};return{validValue:Object.assign({},K,e,t)}},_applyTreeNodeCellOptions:function(e){if(this._isReady){var t=this.layout.getColumnIndex("tree");t>=0&&this.updateColumnView(t,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}},_applyShowNodeKPIColorFlag:function(e){this.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})},_applyPlaceholder:function(e){this.model&&0===this.model.length&&(this._removeEmptyContentMessage(),this.placeholder&&""!==this.placeholder&&this._displayEmptyContentMessage())},_updateFromRowDragEnabledState:function(){this.rowDragEnabledFlag?this.getContent().setAttribute("row-drag-enabled",""):this.getContent().removeAttribute("row-drag-enabled")},reapplySortModel:function(){this._rowModel&&this._rowModel._applySortModel(this.sortModel)},initialize:function(){if(!this._initialized){this._initialized=!0;0,this.getContent().setAttribute("layout-density",this.layout.layoutDensity),this._manageCellRequests(),this.dataSource&&this._applyDataSource(),this.treeDocument&&this._applyTreeDocument(),this.sortModel?this.reapplySortModel():this._rowModel&&this._rowModel._resetTreeDocument&&this._rowModel._resetTreeDocument(),!this.hasLeftContainer()&&this.layout.hasCellsInLeftContainer()&&this._createLeftFixedContainer(),!this.hasRightContainer()&&this.layout.hasCellsInRightContainer()&&this._createRightFixedContainer(),this._manageUserInteractions(),this._manageDragAndDrop(),this.paginationManager&&this.paginationManager.updatePagination(),void 0!==this.maxVisibleRowCount&&(this.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1}),this._updateDimensions())}},getCustomViewsManager:function(){return this._customViewsManager},destroy:function(){this._unsubscribeToPreExpand(this.getTreeDocument()),this._modelMassUpdateDialog&&(this._modelMassUpdateDialog.destroy(),this._modelMassUpdateDialog=null),this._rowModel&&this._rowModel.destroy(),this._rowModel=null,this._customViewsManager&&(this._customViewsManager.destroy(),this._customViewsManager=null),this.layout.destroy(),this._toolbar=null,this._parent()},_displayEmptyContentMessage:function(){if(!this.elements.poolContainerSync.querySelector(".wux-datagridview-emptycontentmessage")){var t=e.createElement("div",{class:"wux-datagridview-emptycontentmessage"}),i=e.createElement("div");void 0!==this.placeholder&&null!==this.placeholder||(this.placeholder=""),"string"==typeof this.placeholder?i.textContent=this.placeholder:(e.is(this.placeholder,"element")&&(this.placeholder=new e.extendElement(this.placeholder)),this.placeholder.inject(i)),i.inject(t),t.inject(this.elements.poolContainerSync)}},_removeEmptyContentMessage:function(){var e=this.elements.poolContainerSync.querySelector(".wux-datagridview-emptycontentmessage");e&&e.parentElement&&e.parentElement.removeChild(e)},_registerPools:function(){this._parent(),this._registerPool("__row_header__",null,p),this._registerPool("__topleft_row_header__",this.elements.rowHeaderExtensionHeaderPoolContainer,p),this._registerPool("__top_item__",this.elements.headerPoolContainer,g);var e=this.treeNodeCellOptions&&this.treeNodeCellOptions.cellClass?this.treeNodeCellOptions.cellClass:m;this._registerPool("__tree_item__",this.elements.poolContainer,e),this._registerPool("__odd_row__",null,h),this._registerPool("__even_row__",null,h)},_createLeftFixedContainer:function(){this._parent(),this._registerPool("__topleft_item__",this.elements.leftHeaderPoolContainer,g);var e=this.treeNodeCellOptions&&this.treeNodeCellOptions.cellClass?this.treeNodeCellOptions.cellClass:m;this._registerPool("__left_tree_item__",this.elements.leftPoolContainer,e),this._registerPool("__left_odd_row__",null,h),this._registerPool("__left_even_row__",null,h)},_createRightFixedContainer:function(){this._parent(),this._registerPool("__topright_item__",this.elements.rightHeaderPoolContainer,g);var e=this.treeNodeCellOptions&&this.treeNodeCellOptions.cellClass?this.treeNodeCellOptions.cellClass:m;this._registerPool("__right_tree_item__",this.elements.rightPoolContainer,e),this._registerPool("__right_odd_row__",null,h),this._registerPool("__right_even_row__",null,h)},getTreeDocument:function(){return this._rowModel?this._rowModel._getTreeDocument():void 0},getTypeRepresentationFactory:function(){return de},supportsKeyboardNavigation:function(){return!0},supportsSelection:function(){return!0},supportsLightRendering:function(){return!0},supportsCustomScrolling:function(){return!0},setToolbar:function(e){var t="object"==typeof e?e:JSON.parse(e),i=this.getTypeRepresentationFactory();if(t.enums)for(var n in t.enums)i.registerEnum(n,t.enums[n]);t.typeRepresentations&&i.registerTypeRepresentations(t.typeRepresentations);var o=y.prototype.createTreeDocument(t);return this._toolbar=new y({items:o,overflowManagement:"dropdown",direction:"horizontal",typeRepresentationFactory:i,executionContext:this}),this._toolbar},getToolbar:function(){return this._toolbar},getCellCssClassesAt:function(e){var t=this.layout,i=this._parent(e),n=t.getColumnGetCellClassName(e.columnID);if(n){var o=n.call(this,e);o&&""!=o&&(i+=" "+o)}return i},getCellAttributesAt:function(e){var t=this.layout,i=this._parent(e);if(e.rowID<=-1){if(this.columnDragEnabledFlag){i.draggable=!0;var n=this.columnSelection,o=t.getColumnOrGroupFromCoordinates(e);e.columnID>=0&&("single"===n&&e.rowID<-1||!t.getColumnOrGroupSelectableState(o))&&(i.unselectable=!0),this._draggedColumnOrGroup&&o&&o._isMoving&&(i["is-moving"]=!0)}if(-1===e.rowID){var l=t._getCellTypeRepresentation(e);l&&(i["type-representation"]=l)}}else{var r=this.getNodeModelAtRowID(e.rowID);if(r&&(r.getChangeStates()&WUXModelChangeStates.NodeToBeRemoved?i["to-be-removed"]=!0:r.getChangeStates()&WUXModelChangeStates.NodeAdded&&(i.added=!0),-1===e.columnID?this._rowModel&&!this._rowModel.shouldBeSelected(r)&&(i.unselectable=!0):e.columnID>=0&&this.cellDragEnabledFlag&&(this.isCellInEdition(e.cellID)||(i.draggable=!0)),!this._muteFind&&this._currentMatchingCellIDIndex>=0&&("row"===this.findNavigationMode?(this._currentMatchingRowIDIndex>=0&&this._matchingNodeModelsArray.length>this._currentMatchingRowIDIndex&&this._matchingNodeModelsArray[this._currentMatchingRowIDIndex]._getRowID()===e.rowID&&(i["current-matching-cell"]=""),this._matchingNodeModelsMap&&void 0!==this._matchingNodeModelsMap[e.rowID]&&(i["match-search"]="")):e.cellID===this._getMatchingCellID(this._currentMatchingCellIDIndex)&&(i["current-matching-cell"]=""),this._matchingCellIDsMap&&void 0!==this._matchingCellIDsMap[e.cellID]&&(i["match-search"]=""))),e.columnID>=0){var s=t.getColumnEditionPolicy(e.columnID);"EditionInPlace"!==s&&(i.lite=""),this.showRequiredFeedbackFlag&&this.getCellRequiredState(e.cellID)&&(i["is-required"]=""),this.showEditableFeedbackFlag&&"EditionInPlace"!==s&&this.getCellEditableState(e.cellID)&&(i["is-editable"]="")}if(this._draggedColumnOrGroup){var a=t.getLeafColumns()[e.columnID];a&&a._isMoving&&(i["is-moving"]=!0,a._isFirstColumnMoving&&(i["is-first-column-moving"]=!0))}var d=t.getColumnGetCellAttributes(e.columnID);if(d)for(var u=d.call(this,e),h=Object.keys(u),c=0;c<h.length;c++)i[h[c]]=u[h[c]]}return i},setPreselectedCell:function(e){if(!this._getCurrentTouchMode()||!1===this._preventPreSelectionForTouchMode){var t=this.getPreselectedCellID();if(this._parent(e),t!==e){this._preselectedCellStableID=void 0!==e?this._getXSOElementFromCellID(e):void 0;var i,n=this._preselectedRowID;if(void 0!==e)i=this.layout.getCellCoordinatesAt(e).rowID;n!==i&&(this._preselectedRowID=i,void 0!==n&&this._updateRenderedRowCellsAttributes(n),void 0!==this._preselectedRowID&&this._updateRenderedRowCellsAttributes(this._preselectedRowID));const l=this.getPreselectedCellID(),r=this.getUsedCellPreselectionFeedback();function o(e){const t=this.layout.getCellCoordinatesAt(e),i=this.layout.getCellIDFromCoordinates({rowID:-1,columnID:t.columnID}),n=this.layout.getCellIDFromCoordinates({rowID:t.rowID,columnID:-1});this._updateRenderedCellAttributes(i),this._updateRenderedCellAttributes(n)}t!==l&&"cell"===r&&(void 0!==n&&o.call(this,t),void 0!==l&&o.call(this,l))}}},_updateRenderedRowCellsAttributes:function(e){var t=this.layout,i=e<0;if(!i){var n=t.getMinMaxVisibleRowIDs();e>=n.minRowID&&e<=n.maxRowID&&(i=!0)}if(i)for(var o=t.getLeafColumns().length,l=t._leftPinnedRowColumnID;l<o;l++)this._updateRenderedCellAttributes(t.getCellIDFromCoordinates({rowID:e,columnID:l}))},_updateRenderedActiveCell:function(e){if(this._updateRenderedCellAttributes(e),"row"===this.cellActivationFeedback){var t=this.layout,i=t.getCellCoordinatesAt(e);this._updateRenderedCellAttributes(t.getCellIDFromCoordinates({rowID:i.rowID,columnID:t._leftPinnedRowColumnID})),this._updateRenderedCellAttributes(t.getCellIDFromCoordinates({rowID:i.rowID,columnID:t._unpinnedRowColumnID})),this._updateRenderedCellAttributes(t.getCellIDFromCoordinates({rowID:i.rowID,columnID:t._rightPinnedRowColumnID}))}},updateRenderedRow:function(e,t){return this.updateRowView(e,t)},updateRowView:function(e,t){var i=this.layout,n=e<0;if(!n){var o=i.getMinMaxVisibleRowIDs();e>=o.minRowID&&e<=o.maxRowID&&(n=!0)}if(n){this._isPrivateRendering(!0);for(var l=this.getActiveCellID(),r=i.getLeafColumns().length,s=i._leftPinnedRowColumnID;s<r;s++){var a=i.getCellIDFromCoordinates({rowID:e,columnID:s});t&&t.ignoreActiveCell&&a==l||this.updateCellView(a,t)}this._isPrivateRendering(!1)}},updateRenderedColumn:function(e,t){return this.updateColumnView(e,t)},updateColumnView:function(e,t){this._isPrivateRendering(!0);for(var i=this.layout,n=i.getMinMaxVisibleRowIDs(),o=n.minRowID;o<=n.maxRowID;o++)this.updateCellView(i.getCellIDFromCoordinates({rowID:o,columnID:e}),t);this._isPrivateRendering(!1)},_updateColumnHeaderCells:function(e){for(var t=this.layout,i=3+(t.rowsHeader?1:0),n=0;n<t._columnItemsByDepth.length;n++)for(var o=t._columnItemsByDepth[n],l=0;l<o.length;l++)this.updateCellView(i,e),i++},_freeUpColumnCells:function(e,t){for(var i=this.layout,n=this.getModelLength(),o=i.columnsHeader?-1:0;o<n;o++)this._freeUpCell(i.getCellIDFromCoordinates({rowID:o,columnID:e}),t)},_endRendering:function(){this._parent(),0!==this._tweakerToGenerateCount||this._activeScroller||this._onAllCellsRendered()},_onAllCellsRendered:function(){if(!this._inOnAllCellsRendered&&this.isInitialized()){if(this._inOnAllCellsRendered=!0,this._resetRowHeightsOnAllCellsRenderedFlag&&(this._resetRowHeightsOnAllCellsRenderedFlag=!1,this.layout.resetRowHeights()),this._inOnAllCellsRendered=!1,this._allCellsRenderedCallBacks)for(var e=this._allCellsRenderedCallBacks.length-1;e>=0;e--){var t=this._allCellsRenderedCallBacks[e];this._allCellsRenderedCallBacks.pop(),t&&t.call()}this.fire("allCellsRendered")}},subscribeOnceToAllCellsRendered:function(e){this._allCellsRenderedCallBacks||(this._allCellsRenderedCallBacks=[]),this._allCellsRenderedCallBacks.unshift(e)},_addTweakerToGenerate:function(){this._tweakerToGenerateCount++},_removeTweakerToGenerate:function(){this._tweakerToGenerateCount--,this._isRendering()||this._isPrivateRendering()||0!=this._tweakerToGenerateCount||this._onAllCellsRendered()},_isPrivateRendering:function(e){if(void 0===e)return void 0!==this.__isPrivateRendering&&this.__isPrivateRendering;this.__isPrivateRendering=e},hasPendingCellsToRender:function(){return this._isRendering()||this._tweakerToGenerateCount>0&&!this._isPrivateRendering()},_resetRowHeightsOnAllCellsRendered:function(){this._resetRowHeightsOnAllCellsRenderedFlag=!0},isCellHighlighted:function(e){return!!(e&&e.cellView&&e.cellView.isRow()&&e.nodeModel)&&e.nodeModel.isHighlighted()},isCellPreselected:function(e){let t=!1;if(this._getCurrentTouchMode()&&!1!==this._preventPreSelectionForTouchMode)return t;const i=this.layout,n=this.getUsedCellPreselectionFeedback(),o=i.getCellCoordinatesAt(e);if(o.rowID>-1)if("cell"===n)if(-1===o.columnID){const e=i.getCellCoordinatesAt(this.getPreselectedCellID());t=o.rowID===e.rowID}else t=this.getPreselectedCellID()===e;else if("row"===n){if(!(t=o.rowID===this._preselectedRowID)){const i=this.getNodeModelAt(e);if(i){const e=this.getNodesPXSO();e&&(t=e.isIn(i))}}}else t=o.rowID===this._preselectedRowID&&-1===o.columnID;else if(-1===o.rowID&&"cell"===n){const e=i.getCellCoordinatesAt(this.getPreselectedCellID());e.rowID>=-1&&(t=o.columnID===e.columnID)}else t=this.getPreselectedCellID()===e;return t},isCellActive:function(e){var t=!1,i=this.getActiveCellID();if(i>=0)if("row"===this.cellActivationFeedback){var n=this.layout,o=n.getCellCoordinatesAt(e);if(o.columnID===n._leftPinnedRowColumnID||o.columnID===n._unpinnedRowColumnID||o.columnID===n._rightPinnedRowColumnID){var l=n.getCellCoordinatesAt(i);t=o.rowID===l.rowID}else t=e===i}else t=e===i;return t},sizeColumnToFit:function(e,t){var i=this.layout;this._isPrivateRendering(!0);var n=this._getMaxContentSizeInfo([e],t),o=n[Object.keys(n)[0]];return this._isPrivateRendering(!1),void 0!==o.maxContentSize&&o.isWidthComputed&&i.setColumnWidth(e,o.maxContentSize,{isUserInteraction:!(!t||!t.isUserInteraction)}),o.maxContentSize},sizeColumnOrGroupToFit:function(e,t,i){var n=this.layout;this.prepareUpdateView(),i||(i={}),i.minMax=n.getMinMaxVisibleRowIDs();var o=n.getColumnOrGroupFromCoordinates({rowID:t,columnID:e});if(o.children&&o.children.length)for(var l=0;l<o.children.length;l++){var r=n.getColumnOrGroupCellCoordinates(o.children[l]).columnID;this.sizeColumnOrGroupToFit(r,t+1,i)}else this.sizeColumnToFit(e,i);this.pushUpdateView({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1},!0)},sizeColumnsToFit:function(e,t){var i=this.layout;"object"==typeof columnIDs&&w.getLeafItems(columnIDs),this._isPrivateRendering(!0);for(var n={},o=this._getMaxContentSizeInfo(e,t),l=Object.keys(o),r=0;r<l.length;r++){var s=l[r];void 0!==o[s].maxContentSize&&o[s].isWidthComputed&&(n[s]=o[s].maxContentSize)}return this._isPrivateRendering(!1),i.setColumnsWidth(n,{isUserInteraction:!(!t||!t.isUserInteraction)}),n},_getMaxContentSizeInfo:function(t,i){var n,o=this.layout,l=this;i=e.extend({isUserInteraction:!1,computeAllRows:!1,computeColumnHeader:!1},i),n=i.computeAllRows?{minRowID:0,maxRowID:this.getModelLength()-1}:i.minMax?i.minMax:o.getMinMaxVisibleRowIDs();for(var r={},s=0;s<t.length;s++){var a=o.getColumnIdentifiers(t[s]),d=o.getColumnMinWidth(a.columnIndex),u=o.getColumnAutoSizePadding(a.columnIndex);r[a.dataIndex]={maxContentSize:d,autoSizePadding:u,isWidthComputed:!1}}var h=[],c=[];function g(e,t){var i=l.layout.getCellIDFromCoordinates({rowID:t,columnID:e}),n=l._getRenderedCellAt(i);n||(n=l._renderCell(i,{updateCellContent:!1,updateCellLayout:"ignore",updateCellAttributes:!1}),c.push(i)),h.push({cell:n,columnID:e})}if(n.minRowID>=0&&n.maxRowID>=0||i.computeColumnHeader){var p=500,m=(n.maxRowID+1-n.minRowID)*t.length,f=Math.ceil(m/p),C=(Object.keys(r),{columnIndex:0,rowID:n.minRowID});function _(){for(var e=0;e<p;e++){if(g(o.getColumnIdentifiers(t[C.columnIndex]).dataIndex,C.rowID),-1===C.rowID){if(C.columnIndex===t.length-1)break;C.columnIndex+=1,C.rowID=n.minRowID}else if(C.rowID===n.maxRowID)if(i.computeColumnHeader)C.rowID=-1;else{if(C.columnIndex===t.length-1)break;C.columnIndex+=1,C.rowID=n.minRowID}else C.rowID+=1}for(e=0;e<h.length;e++){var s=h[e].columnID,a=h[e].cell;if(s&&a&&a.component){r[s].isWidthComputed=!0;var d=a.component.computeContentSize()+2+r[s].autoSizePadding;d>r[s].maxContentSize&&(r[s].maxContentSize=d)}}h=[];for(var u=0;u<c.length;u++)l._freeUpCell(c[u],1);c=[]}for(var w=0;w<f;w++)_()}return r},sizeAllColumnsToFit:function(e){var t=this.layout;t.isValid()||t.prepareLayout();var i=this.layout.getLeafColumns();this.prepareUpdateView(),e||(e={}),e.minMax=t.getMinMaxVisibleRowIDs(),this.sizeColumnsToFit(i,e),this.pushUpdateView({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1},!0)},_applyRowGroupingOptions:function(t){this._properties.rowGroupingOptions.value=e.extend({depth:0,hideGroupedColumns:!0,canNodeBeGrouped:null,getNodeGroupingKey:null,getGroupingNodeOptions:null,getGroupingNodeLabel:null,getGroupingNodeIcons:null,mapGroupingKeys:null},this.rowGroupingOptions)},getFindableAttributes:function(){return this.layout.getVisibleOrderedLeafColumns().map(e=>e.text?e.text:"")},_getCellValueAsStringForFind:function(e,t,i,n){if(e)return e.call(this,t);var o=this.layout._getCellTypeRepresentation(t),l=this.getTypeRepresentationFactory(),r={touchMode:this._getCurrentTouchMode(),readOnly:!this.isCellInEdition(t.cellID),semantics:{showReferenceValueFlag:this.showModelChangesFlag,allowUnsafeHTMLContent:a}},s=l.getRegisteredTypeRepresentation(o);s||(s={semantics:{possibleValues:l.getRegisteredEnum(o)}}),s.semantics&&(s.semantics.possibleValues&&(r.semantics.possibleValues=s.semantics.possibleValues),s.semantics.valueType&&(r.semantics.valueType=s.semantics.valueType));var a=this.layout.getColumnShouldCellAllowUnsafeHTMLContentAt(t.columnID).call(this,t);r.typePath=o,r.context="inlinedTemplate",r.semantics.executionContext=t;var d=l._getTypeData(r.typePath,r.semantics,t.cellModel),u=l.getTemplateIdentifierFromTypeRep(d.typeRep,r.context),h=l.options.directory.getRegisteredTemplate(u);if(h&&h.src){var c=h.src.prototype;if(c._properties={},c.elements={},c.possibleValues=r.semantics.possibleValues,c.valueType=r.semantics.valueType,c.isValueDisplayedAsString(h.options.displayStyle)){c._properties={},c.elements={},c.possibleValues=r.semantics.possibleValues,c.valueType=r.semantics.valueType;var g="progress"===n?"%":"percentage"===n?" %":"",p=c.getStringFromValue(t.cellModel)+g;return c.possibleValues=void 0,c.valueType=void 0,c._properties=void 0,c.elements=void 0,p}}},groupRows:function(e){this._rowModel&&this._rowModel.groupRows(e)},reapplyRowGrouping:function(){this._rowModel&&this._rowModel._reapplyRowGrouping()},createGroupingUI:function(){var e=this,t=void 0,i=function(t,i){-1===e._draggedRowID&&e.rowGroupingEnabledFlag&&t.preventDefault()},n=function(i,n){var o=e.getDraggedColumnData(i);if(o&&-1===o.rowID&&e.layout.getColumnOptionValue(o.columnID,"groupableFlag")){var l={label:o.label,value:e.layout.getColumnOptionValue(o.columnID,"dataIndex"),index:void 0},r=n.chipCellView?n.chipCellView.associatedModelItem:void 0;if(r){var s=n.dropPosition;"left"===s?l.index=t.getChipPosition(r.chipOptions.label):"right"===s&&(l.index=t.getChipPosition(r.chipOptions.label)+1)}t.addChip(l)}return i.preventDefault(),!0};t=new I({placeholder:R.get("GroupingUIPlaceholder"),onDragOverCell:function(e,t){return i(e)},onDragOverBlank:function(e,t){return i(e)},onDropCell:function(e,t){return n(e,t)},onDropBlank:function(e,t){return n(e,t)}});let o=!0,l=!0;t.getContent().addEventListener("change",function(t){if(t&&t.dsModel&&o){var i=[];t.dsModel.getAllChipsOptions().forEach(function(e){i.push(e.value)}),l=!1,e.groupRows({dataIndexesToGroup:i}),e.layout._saveGroupingOptionsInPreferences(),l=!0}}),t.getContent().addEventListener("onPostRemove",function(t){C.isCurrentlyCalledFromUIInteraction()&&ue.call(e)});var r=this.getTreeDocument();if(r){const e=()=>{if(l&&this.getGroupingOptions()&&this.getGroupingOptions().dataIndexesToGroup){o=!1,t.removeAllChips();for(let e=0;e<this.getGroupingOptions().dataIndexesToGroup.length;e++){const i=this.getGroupingOptions().dataIndexesToGroup[e];t.addChip({label:this.layout.getColumnOptionValue(i,"text"),value:i})}o=!0}};r.addEventListener("groupNodes",e),e()}return t},setCellInEdition:function(e){if(!this.getCellEditableState(e))return!1;var t=this.setActiveCell(e,!0);if(this._getViewAt(e)){var i=this._setEditionMode(e,!0);return this.setFocusOnCellContentFlag(!0),i}if(t){var n=this;return new Promise(function(t,i){n.subscribeOnceToAllCellsRendered(function(){var i=n._setEditionMode(e,!0);n.setFocusOnCellContentFlag(!0),t(i)})})}},getCellEditableState:function(e){var t=this.layout,i=t.getCellCoordinatesAt(e);if(-1===i.columnID||i.rowID<=-1)return!1;var n=t.getColumnGetCellEditableState(i.columnID),o=this.getNodeModelAtRowID(i.rowID);if(o){if(n){var l=this.getLightCellInfosAt(e);return l.nodeModel=o,n.call(this,l)}var r=o.getTreeDocument();if(r&&r.options&&r.options.shouldBeEditable&&!r.options.shouldBeEditable(o))return!1}return t.getColumnEditableFlag(i.columnID)},getCellActivableState:function(e){var t=this.layout,i=t.getCellCoordinatesAt(e);if(-1===i.columnID||i.rowID<=-1)return!0;var n=t.getColumnGetCellActivableState(i.columnID);if(n){var o=this.getLightCellInfosAt(e);return o.nodeModel=this.getNodeModelAtRowID(i.rowID),n.call(this,o)}return!0},_resetFocus:function(e){if(this._parent(e),e&&C.isASystemEvent(e)){var t=e.relatedTarget?e.relatedTarget:document.activeElement;if(!t||!C.isElementInside(t,this.getContent(),{lookInPopup:!0})){var i=this.getActiveCellID();i>=0&&this._setEditionMode(i,!1)}}},getCellRequiredState:function(e){return!1},_getCellSemantics:function(e){var t=this.layout;if(e.columnID>-1&&e.rowID>-1){var i=t.getColumnGetCellSemantics(e.columnID);return i?i.call(this,e):t.getColumnSemantics(e.columnID)}return null},_getCellKPIColor:function(e){var t=this.layout;if(e.columnID>-1&&e.rowID>-1){var i=t.getColumnGetCellKPIColor(e.columnID);if(i)return i.call(this,e)}return null},computeCellIDFromActiveCell:function(e,t,i){var n=this.getActiveCellID();return i&&this._getLastRangeCellID()>=0&&("up"===e||"right"===e||"down"===e||"left"===e||"pageup"===e||"pagedown"===e)&&(n=this._getLastRangeCellID()),this.layout._computeCellIDFromCell(n,e,t,i)},onDragStartCellDefault:function(e,t){this.getRowReorderEnabledState()&&(ue.call(this),this._serializeDragAndDropEvent(e,t))},onDragEndCellDefault:function(e,t){},onDragEnterCellDefault:function(e,t){if(t.nodeModel&&this.getRowReorderEnabledState()&&t.draggedNodes){var i=ie.call(this,e,t);(i||null===i)&&e.preventDefault()}},onDragLeaveCellDefault:function(e,t){ee.call(this)},onDragCellDefault:function(e,t){},onDragOverCellDefault:function(e,t){if(t.nodeModel&&this.getRowReorderEnabledState()){var i=ie.call(this,e,t);(i||null===i)&&e.preventDefault()}else e.defaultPrevented&&(this._draggedColumnOrGroup?e.dataTransfer.dropEffect="none":(t.dropPosition="middle",Z.call(this,t,!0)))},onDragOverBlankDefault:function(e,t){this._draggedColumnOrGroup||(this.elements.scroller.elements.container.setAttribute("highlightTopBottom",""),this.hasLeftContainer()&&(""===this.elements.leftScrollContainer.getAttribute("empty")&&this.elements.scroller.elements.container.setAttribute("highlightLeft",""),this.elements.leftScrollContainer.setAttribute("highlight",""),this.elements.leftSpacerContainer.setAttribute("highlight","")),this.hasRightContainer()&&(""===this.elements.rightScrollContainer.getAttribute("empty")&&this.elements.scroller.elements.container.setAttribute("highlightRight",""),this.elements.rightScrollContainer.setAttribute("highlight",""),this.elements.rightSpacerContainer.setAttribute("highlight","")))},onDragLeaveBlankDefault:function(e,t){this.elements.scroller.elements.container.removeAttribute("highlightTopBottom"),this.elements.scroller.elements.container.removeAttribute("highlightLeft"),this.elements.scroller.elements.container.removeAttribute("highlightRight"),this.hasLeftContainer()&&(this.elements.leftScrollContainer.removeAttribute("highlight"),this.elements.leftSpacerContainer.removeAttribute("highlight")),this.hasRightContainer()&&(this.elements.rightScrollContainer.removeAttribute("highlight"),this.elements.rightSpacerContainer.removeAttribute("highlight"))},onDropBlankDefault:function(e,t){this.elements.scroller.elements.container.removeAttribute("highlightTopBottom"),this.elements.scroller.elements.container.removeAttribute("highlightLeft"),this.elements.scroller.elements.container.removeAttribute("highlightRight"),this.hasLeftContainer()&&(this.elements.leftScrollContainer.removeAttribute("highlight"),this.elements.leftSpacerContainer.removeAttribute("highlight")),this.hasRightContainer()&&(this.elements.rightScrollContainer.removeAttribute("highlight"),this.elements.rightSpacerContainer.removeAttribute("highlight"))},onDropCellDefault:function(e,t){if(t.nodeModel&&this.getRowReorderEnabledState()&&ne.call(this,e,t))return void e.preventDefault()},getRowReorderEnabledState:function(){return this.rowDragEnabledFlag&&this.rowReorderEnabledFlag&&0===this._disableRowReorderCpt},enableRowReordering:function(){this._disableRowReorderCpt--},disableRowReordering:function(){this._disableRowReorderCpt++},_serializeDragAndDropEvent:function(t,i){if(i&&i.draggedNodes){var n;if(t.dataTransfer&&"string"==typeof t.dataTransfer.getData("text")&&t.dataTransfer.getData("text").length>0)try{n=JSON.parse(t.dataTransfer.getData("text"))}catch(t){return}var o=[];i.draggedNodes.forEach(function(e){o.push(e._getID())});var l={source:{uuid:this._uuid,amd:"DS/DataGridView/DataGridView"},data:{DataGridView_Row_Options:{"dswebux/x-datagridview.rows+json":o,"dswebux/x-datagridview.row+number":i.nodeModel._getID(),"dswebux/x-datagridview.row.options.label+json":i.nodeModel.options.label,"dswebux/x-datagridview.row.options.icons+json":i.nodeModel.options.icons,"dswebux/x-datagridview.row.options.grid+json":i.nodeModel.options.grid,"dswebux/x-datagridview.row.id+json":i.rowID}}};n&&(l=e.extend(l,n,!0)),t.dataTransfer.setData("text",JSON.stringify(l))}},onDragStartRowHeaderDefault:function(e,t){if(this.rowDragEnabledFlag&&(ue.call(this),this._serializeDragAndDropEvent(e,t),e.dataTransfer.setDragImage)){var i=this.layout.getColumnIndex("tree");if(void 0!==i){var n=this.layout.getCellIDFromCoordinates({rowID:t.rowID,columnID:i}),o=!1,l=this._getRenderedCellAt(n);if(l||(l=this._renderCell(n,{updateCellContent:!1,updateCellLayout:"ignore",updateCellAttributes:!1}),o=!0),l&&l.component&&e.dataTransfer.setDragImage(l.component.getContent(),10,10),o){var r=this;setTimeout(function(){r._freeUpCell(n,1)},0)}}}},onDragEndRowHeaderDefault:function(e,t){},onDragEnterRowHeaderDefault:function(e,t){},onDragLeaveRowHeaderDefault:function(e,t){ee.call(this)},onDragRowHeaderDefault:function(e,t){},onDragOverRowHeaderDefault:function(e,t){t.nodeModel&&this.getRowReorderEnabledState()&&t.draggedNodes&&(ie.call(this,e,t)&&e.preventDefault())},onDropRowHeaderDefault:function(e,t){if(t.nodeModel&&this.getRowReorderEnabledState()&&ne.call(this,e,t))return void e.preventDefault()},onDragStartColumnHeaderDefault:function(e,t){if(this.columnDragEnabledFlag){var i=this.layout;if(this._draggedColumnOrGroup=i.getColumnOrGroupFromCoordinates({rowID:t.rowID,columnID:t.columnID}),this._draggedColumnOrGroupPreviousPositionData=i._getColumnOrGroupPositionData(this._draggedColumnOrGroup),this._draggedRowID=t.rowID,this._draggedColumnOrGroup){this._draggedColumnOrGroup._isMoving=!0,w.processTreeChildren(this._draggedColumnOrGroup.children,function(e){e._isMoving=!0}),this._updateColumnHeaderCells({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0});for(var n=w.getLeafItems(this._draggedColumnOrGroup),o=0;o<n.length;o++){var l=n[o];0===o&&(l._isFirstColumnMoving=!0);var r=i.getColumnIndex(l.dataIndex);this.updateColumnView(r,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})}}}var s={source:{uuid:this._uuid,amd:"DS/DataGridView/DataGridView"},data:{DataGridView_Column_Options:{"dswebux/x-datagridview.column.label+json":t.cellModel,"dswebux/x-datagridview.row.id+json":t.rowID,"dswebux/x-datagridview.column.id+json":t.columnID}}};e.dataTransfer.setData("text",JSON.stringify(s))},onDragEndColumnHeaderDefault:function(e,t){if(this._draggedColumnOrGroup){var i=this.layout;se.call(this,!1);var n=this._draggedColumnOrGroup;this._draggedColumnOrGroup=null;var o=i._getColumnTreeItemCount();i._computeColumnItems();var l=this._draggedColumnOrGroupPreviousPositionData,r=i._getColumnOrGroupPositionData(n);i._updateColumnGroupExpandedStateInPreferences(l,r),i._saveParentColumnGroupsExpandedStateInPreferences(n);var s=!1;i._getColumnTreeItemCount()!==o&&(s=!0),this.invalidateLayout({updateCellContent:s,updateCellLayout:!0,updateCellAttributes:!0})}},onDragEnterColumnHeaderDefault:function(e,t){this._draggedColumnOrGroup&&(e.preventDefault(),e.dataTransfer.dropEffect="move"),ee.call(this)},onDragLeaveColumnHeaderDefault:function(e,t){},onDragColumnHeaderDefault:function(e,t){ue.call(this)},onDragOverColumnHeaderDefault:function(e,t){if(this.columnDragEnabledFlag&&this._draggedColumnOrGroup&&(e.dataTransfer.dropEffect="move",e.preventDefault(),this._draggedColumnOrGroup)){var i,n,o=this.layout,l=!1,r=o.getColumnOrGroupFromCoordinates({rowID:t.rowID,columnID:t.columnID}),s=function(e,t){var i=(t=t||e.target||e.srcElement).getBoundingClientRect();return{offsetX:e.clientX?e.clientX-i.left:0,offsetY:e.clientY?e.clientY-i.top:0}}(e).offsetX;if(-1===t.rowID)i=t.columnID,n=s;else for(var a=0,d=w.getLeafItems(r),u=0;u<d.length;u++){var h=d[u],c=o.getColumnIndex(h.dataIndex),g=o.getColumnComputedWidth(c);if(s<=a+g){i=c,n=s-a;break}a+=g}if(void 0!==i){var p=o.getColumnOrGroupPinned(this._draggedColumnOrGroup),m=o.getColumnPinned(i),f=o.getColumnOrGroupComputedWidth(this._draggedColumnOrGroup),C=o.getColumnComputedWidth(i),_=o.getFirstLeafColumnIndex(this._draggedColumnOrGroup,!0),v=o.getOrderedColumnsReverseIndexes(),D=v[_],I=v[i],V=n>C/2?"after":"before";D<I&&n>C/2&&n>C-f||D>I&&n<C/2&&n<f?l=!0:p!==m&&(l=!0);var y=o._columnMoveIsPossible(this._draggedColumnOrGroup,i,V);if(l&&y){if(p!==m){var b=w.computeFirstBranchDepth(this._draggedColumnOrGroup),M=o.getLeafColumns()[_];if(o.setColumnOrGroupPinned(this._draggedColumnOrGroup,m,{isUserInteraction:!0,mergeGroups:!1}),M){var x=M;for(u=0;u<b-1&&x;u++)x=x._parent;x&&(this._draggedColumnOrGroup=x)}}o.moveColumnOrGroup(this._draggedColumnOrGroup,i,{insertBeforeOrAfter:V,isUserInteraction:!0})}if(!y){var S=!0,F=o.getLeafColumns()[i];for(d=w.getLeafItems(this._draggedColumnOrGroup),u=0;u<d.length;u++){if((h=d[u])===F){S=!1;break}}S&&(e.dataTransfer.dropEffect="none")}}}},onDropColumnHeaderDefault:function(e,t){e.preventDefault(),this._draggedColumnOrGroup&&this.onDragEndColumnHeaderDefault(e,t)},onDragEnterBlankDefault:function(e,t){ee.call(this)},_processDragAndDropCallbacks:function(e,t){var i=t||{};if("dragstart"===e.type){if(j=!0,t){var n=this.getEditionManager(t.cellID);n&&n.onCellDragStart(t.cellID);var o=this.getTreeDocument();if(t.nodeModel&&o&&!o.options.shouldAcceptDrag(t.nodeModel))return void e.preventDefault()}if(e.dataTransfer){var l=e.target.getBoundingClientRect(),r=e.clientX-l.left,s=e.clientY-l.top;if("function"==typeof e.dataTransfer.setDragImage){var a=e.target;t.cellView&&(a=t.cellView.getContent()),e.dataTransfer.setDragImage(a,r,s)}}if(t&&t.rowID>=0){t.nodeModel&&!t.nodeModel.isSelected()&&this.selectNodeModel(t.nodeModel);var u=[],h=this.getNodesXSO();h&&(u=h.get().concat(),d.sortNodesByRowID(u)),u&&0!==u.length||(u=[t.nodeModel]),i.draggedNodes=u,Object.getPrototypeOf(this).__rowReorderDnDInfos={source:this._uuid,nodes:u}}}else if("dragover"===e.type||"drag"===e.type||"dragenter"===e.type||"dragleave"===e.type){if(j=!0,"dragover"===e.type||"dragleave"===e.type||"dragenter"===e.type)if(re.call(this,e,t))return;(c=Object.getPrototypeOf(this).__rowReorderDnDInfos)&&c.nodes&&(i.draggedNodes=c.nodes),i.dropPosition=te.call(this,e,i)}else if("drop"===e.type){j=!1,(c=Object.getPrototypeOf(this).__rowReorderDnDInfos)&&c.source===this._uuid&&(i.droppedNodes=c.nodes),i.dropPosition=te.call(this,e,i),le.call(this),ee.call(this)}else if("dragend"===e.type){var c;j=!1,(c=Object.getPrototypeOf(this).__rowReorderDnDInfos)&&c.nodes&&(i.draggedNodes=c.nodes),this._rowReorderDnDInfos.dropAccepted||ne.call(this,e,t),Object.getPrototypeOf(this).__rowReorderDnDInfos=null,le.call(this),ee.call(this)}var g={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"}[e.type],p=this;function m(t,n){var o=!0,l=p[t+n],r=p[t+n+"Default"];l?(o=l.call(p,e,i),U&&console.info("[dnd]",t+n,">",o,e.target)):r||U&&console.warn("[dnd]","cannot find",t+n,"callback"),r&&o&&(U&&(l&&o?console.info("\t>[dnd]","dev want to continue to the default behavior for ",t+n," callback"):console.info("\t>[dnd]","use the default behavior for ",t+n," callback")),r.call(p,e,i))}t&&void 0!==t.columnID&&void 0!==t.rowID?-1===t.columnID?m(g,"RowHeader"):t.rowID<=-1?m(g,"ColumnHeader"):m(g,"Cell"):m(g,"Blank")},_manageDragAndDrop:function(){C.addEventOnElement(this,this,"dragstart",this._processDragAndDropCallbacks.bind(this)),C.addEventOnElement(this,this,"drop",this._processDragAndDropCallbacks.bind(this)),C.addEventOnElement(this,this,"dragover",this._processDragAndDropCallbacks.bind(this)),C.addEventOnElement(this,this,"drag",this._processDragAndDropCallbacks.bind(this)),C.addEventOnElement(this,this,"dragend",this._processDragAndDropCallbacks.bind(this)),C.addEventOnElement(this,this,"dragleave",this._processDragAndDropCallbacks.bind(this)),C.addEventOnElement(this,this,"dragenter",this._processDragAndDropCallbacks.bind(this))},getDraggedRowData:function(e){var t=e.dataTransfer.getData("text");try{if(void 0!==t&&""!==t){var i=JSON.parse(t);if(i&&i.data&&void 0!==i.data.DataGridView_Row_Options)return{uuid:i.source.uuid,listOfDumpedNodes:i.data.DataGridView_Row_Options["dswebux/x-datagridview.rows+json"],nodeModel:i.data.DataGridView_Row_Options["dswebux/x-datagridview.row+number"],label:i.data.DataGridView_Row_Options["dswebux/x-datagridview.row.options.label+json"],icons:i.data.DataGridView_Row_Options["dswebux/x-datagridview.row.options.icons+json"],grid:i.data.DataGridView_Row_Options["dswebux/x-datagridview.row.options.grid+json"],rowID:i.data.DataGridView_Row_Options["dswebux/x-datagridview.row.id+json"]}}}catch(e){console.warn('the element being in dataTransfer type "DataGridView_Row_Options" is not parsable usable JSON.parse')}},getDraggedColumnData:function(e){var t=e.dataTransfer.getData("text");try{if(void 0!==t&&""!==t){var i=JSON.parse(t);if(i&&void 0!==i.data.DataGridView_Column_Options)return{uuid:i.source.uuid,label:i.data.DataGridView_Column_Options["dswebux/x-datagridview.column.label+json"],rowID:i.data.DataGridView_Column_Options["dswebux/x-datagridview.row.id+json"],columnID:i.data.DataGridView_Column_Options["dswebux/x-datagridview.column.id+json"]}}}catch(e){console.warn('the element being in dataTransfer type "DataGridView_Column_Label" is not parsable usable JSON.parse')}},_getSelectionCheckBox:function(e){var t,i=this.layout.getCellIDFromCoordinates(e),n=this._getViewAt(i);return n&&"function"==typeof n.getSelectionCheckBox&&(t=n.getSelectionCheckBox()),t},_getRowSelectionCheckBox:function(e){return this._getSelectionCheckBox({rowID:e,columnID:-1})},_getColumnSelectionCheckBox:function(e){return this._getSelectionCheckBox({rowID:-1,columnID:e})},_updateSelectAllCheckBox:function(){if(this.layout.columnsHeader){var e=this._getRowSelectionCheckBox(-1);if(e){var t=this.getTreeDocument();if(t){var i=0===t.getRoots().length;e.disabled=i;var n=t.getXSO();if(n){var o=n.isEmpty();e.checkFlag=!o;var l=this.isEveryVisibleNodeSelected(),r=this._selectAllCheckBoxListenChange;this._selectAllCheckBoxListenChange=!1,e.mixedState=!o&&!l,this._selectAllCheckBoxListenChange=r}}}}},_getCellTooltip:function(e){if(this.getCellTooltip)return this.getCellTooltip(e);var t=this.layout.getColumnGetCellTooltip(e.columnID);return t?t(e):this.getCellDefaultTooltip(e)},getCellDefaultTooltip:function(e,t){var i=this,n=t;return{getAllInformationCB:function(){var t,o=i.layout,l=!0===n&&n,r="";if(e.rowID<0&&e.columnID<0&&!l)l=!0,r=e.cellModel?e.cellModel.toString():void 0;else if(e.rowID<0&&!l){var s=o.getColumnOrGroupFromCoordinates(e);s&&(s.description?(l=!0,r=s.description):(l=!o.getColumnShowTextFlag(e.columnID)&&o.getColumnIcon(e.columnID))&&(r=s.text))}if(!l&&!e.cellModel)return{model:{shortHelp:""},updateModel:!1};if(!l&&((g=e.cellView.getReusableContent())&&g.computeContentSize)){var a,d;if(g._computeContentDimensions){var u=g._computeContentDimensions();a=u.width,d=u.height}else a=g.computeContentSize(),d=void 0;var h=g.getTweakerPadding();h>2&&(a=a-h+2);var c=e.cellView._getContentContainer();(c&&c.offsetWidth<a||void 0!==d&&c.offsetHeight<d)&&(l=!0)}if(l){var g;if(""===r)if(g=e.cellView.getReusableContent())g.value instanceof Function||(r=g.getStringFromValue(g.value));const n=o.getColumnShouldCellAllowUnsafeHTMLContentAt(e.columnID);t=!1,n&&(t=_.getUnsafeHTMLContentValueToApply(n.call(i,e)))}return void 0!==t?{model:{shortHelp:r,allowUnsafeHTMLShortHelp:t,allowUnsafeHTMLLongHelp:t,allowUnsafeHTMLTitle:t},updateModel:!1}:{model:{shortHelp:r},updateModel:!1}}}},defaultOnCellRequest:function(t){var i=this.layout,n=i.getLeafColumns()[t.columnID],o=!1;if(t.rowID>=0&&t.columnID>=0){var l=this.getNodeModelAtRowID(t.rowID);if("tree"===n.dataIndex){var r=t.cellView;r.setProperties(this.treeNodeCellOptions),r.flatTreeFlag=this.hasFlatTreeState(),r.nodeModel!==l?r.nodeModel=l:r._applyNodeModel(l);var s=this.layout.getColumnGetCellIcons(t.columnID);if(s){var a=s(t);e.equals(r.icons,a)?r.nodeModel&&r.checkBadges()&&r._applyIcons():r.icons=a}this._setTweakerForCell(t),o=!0}else{if(i._getCellTypeRepresentation(t))this._setTweakerForCell(t),o=!0;else{var d=t.cellModel;"number"==typeof d&&(d+=""),t.cellView.setReusableContent(null),_.getUnsafeHTMLContentValueToApply(i.getColumnShouldCellAllowUnsafeHTMLContentAt(t.columnID).call(this,t))?t.cellView.getContent().setHTML(d):t.cellView.getContent().textContent=d}}t.cellView._updateTooltip(this._getCellTooltip(t))}else if(-1===t.columnID&&i.rowsHeader){if("none"!==this.rowSelection&&"function"==typeof t.cellView.buildSelectionCheckBox&&t.cellView.buildSelectionCheckBox(),this.rowDragEnabledFlag&&"function"==typeof t.cellView.buildDragGrip&&t.cellView.buildDragGrip(),t.cellView&&"function"==typeof t.cellView.getSelectionCheckBox){var u=t.cellView.getSelectionCheckBox();if(u){var h=this.getNodesXSO();if(h){var c=u.preventTriggeringChangeEvent;if(u.preventTriggeringChangeEvent=!0,t.rowID>=0){let e=t.nodeModel&&h.isIn(t.nodeModel),i=this.selectionBehavior.showMixedStateOnParents&&t.nodeModel&&t.nodeModel._nbSelectedDescendants>0;u.checkFlag=e||Boolean(i),u.mixedState=!e&&i,this._rowModel&&i&&(u.disabled=!this._rowModel.shouldBeSelected(t.nodeModel))}else{var g=h.isEmpty();u.checkFlag=!g;var p=this.isEveryVisibleNodeSelected();u.mixedState=!g&&!p}u.preventTriggeringChangeEvent=c}}t.cellView._updateTooltip(this._getCellTooltip(t))}var m=t.cellView.getContent().querySelector(".wux-datagridview-selection-label");m&&(m.textContent=t.cellModel),t.cellView.showKPIColorFlag=this.showNodeKPIColorFlag,t.cellView.KPIColor=t.nodeModel?t.nodeModel.options.color:void 0}else t.rowID<=-1&&t.columnID>=0?o=this.DefaultOnColumnHeaderRequest(t):t.cellView.setReusableContent(null);t.columnID>=0&&(o?t.cellView.getContent().removeAttribute("no-tweaker"):t.cellView.getContent().setAttribute("no-tweaker",""))},DefaultOnColumnHeaderRequest:function(e){let t,i=this.layout,n=i.getLeafColumns()[e.columnID],o=!0;if(e.cellView&&(e.cellView.customHeader=-1===e.rowID?n.customHeader:void 0,e.cellView.columnHeadersLayout=this.columnHeadersLayout),-1===e.rowID&&n.customHeader&&n.customHeader.buildContent){this._registerColumnHeaderReusableCellContent(n);let t=z(n.dataIndex),i=this.reuseCellContent(t);if(e.cellView.setReusableContent(i),n.customHeader.updateContent){let e;this.treeDocument?this.treeDocument.getFilterManager()&&(e=this.treeDocument.getFilterManager().filterModel):this._rowModel&&this._rowModel.getFilterManager()&&(e=this._rowModel.getFilterManager().filterModel);let t={sortModel:this.sortModel,filterModel:e};n.customHeader.updateContent(i,t)}}else{if(-1===e.rowID){let t=i.getColumnComputedWidth(e.columnID);e.cellView.getContent().style.width=t.toString()+"px"}this._setTweakerForCell(e),o=!0}if(-1===e.rowID&&this._rowModel&&this._rowModel._filterViewManager&&n){let e="tree"===n.dataIndex?"label":n.dataIndex;t=this._rowModel._filterViewManager.getFilterPopups()[e]}e.cellView.filterView=t,"none"!==this.columnSelection&&"function"==typeof e.cellView.buildSelectionCheckBox&&e.cellView.buildSelectionCheckBox();let l,r,s=i.getColumnOrGroupFromCoordinates(e);if(e.cellView&&"function"==typeof e.cellView.getSelectionCheckBox&&(l=e.cellView.getSelectionCheckBox())&&this._columnsXSO){let e=l.preventTriggeringChangeEvent;l.preventTriggeringChangeEvent=!0;let t=this.isColumnOrGroupSelected(s);l.checkFlag=!1!==t,l.mixedState="mixedState"===t,l.preventTriggeringChangeEvent=e}if(-1===e.rowID&&this.sortModel)for(let t=0;t<this.sortModel.length;t++)if(this.sortModel[t].dataIndex===i.getDataIndexFromColumnIndex(e.columnID)){r={sortDirection:this.sortModel[t].sort,sortOrder:1===this.sortModel.length?void 0:t,typeRepresentation:i.getColumnTypeRepresentation(e.columnID)};break}return e.cellView.sortModel=r,s&&"function"==typeof e.cellView.buildColumnGroupExpander&&e.cellView.buildColumnGroupExpander(this,s),e.cellView._updateTooltip(this._getCellTooltip(e)),o},_registerColumnHeaderReusableCellContent:function(e){let t=e.dataIndex,i=z(t),n=this;this.isReusableCellContentRegistered(i)||this.registerReusableCellContent({id:i,buildContent:function(){let i=n.layout.getCellIDFromCoordinates({rowID:-1,columnID:t}),o=n.getCellInfosAt(i);if(o.cellView=n._getViewAt(i),e.customHeader){if(!e.customHeader.buildContent)throw"ERROR, customHeader is declared, but customHeader.buildContent function is not implemented!!!!!!";return e.customHeader.buildContent(o)}},cleanContent:function(e){let i=n.layout.getCellIDFromCoordinates({rowID:-1,columnID:t}),o=n.getCellInfosAt(i);o.cellView=n._getViewAt(i),o.cellView&&o.cellView.clean&&o.cellView.clean()}})},_manageCellRequests:function(){var t=this;t.onCellRequest(function(i){if(i.rowID>=0&&i.columnID>=0){var n=t.layout,o=n.getLeafColumns()[i.columnID],l=t.layout.getColumnOnCellRequest(i.columnID);if(l){if(o&&"tree"===o.dataIndex){var r=i.cellView;r.setProperties(t.treeNodeCellOptions),r.flatTreeFlag=t.hasFlatTreeState(),r.nodeModel!==i.nodeModel?r.nodeModel=i.nodeModel:r._applyNodeModel(i.nodeModel);var s=n.getColumnGetCellIcons(i.columnID);if(s){var a=s(i);e.equals(r.icons,a)?r.nodeModel&&r.checkBadges()&&r._applyIcons():r.icons=a}}return l.call(t,i)}}t.defaultOnCellRequest(i)})},_setTweakerForCell:function(t,i){var n,o,l,r=this,s=this.layout,a=t.cellModel,d=!1,u=!1;if(t.rowID<=-1&&t.columnID>=0){n="string";var h=s.getColumnOrGroupFromCoordinates(t);o=h?h.icon:s.getColumnIcon(t.columnID),void 0===a&&void 0===o||(u=!0)}else{n=s._getCellTypeRepresentation(t);var c=this.getNodeModelAtRowID(t.rowID);if(c){var g=c.options.grid,p=s.getLeafColumns()[t.columnID],m=s.getColumnHasCellValue(t.columnID),f=m&&!m.call(this,t),w=s.getColumnGetCellValue(t.columnID);f||!g.hasOwnProperty(p.dataIndex)&&void 0===a&&!w||(u=!0,"tree"===p.dataIndex&&"string"===n&&void 0===w?d=void 0!==(l=c.getReferenceLabel()):(l=c.getReferenceValue(p.dataIndex),d=c.hasReferenceValue(p.dataIndex),void 0===l&&void 0!==a&&(d||(l=e.clone(a,!1)))))}}var v=Date.now();if(t.cellView&&(t.cellView._currentTimeStamp=v),n&&u){var D,I=t.cellView.getReusableContent();if(I&&I.__disposable__){var V=de.getRegisteredTypeRepresentation(n);V||(V={semantics:{possibleValues:de.getRegisteredEnum(n)}}),D=de.getTemplateIdentifierFromTypeRep(V,"inlinedTemplate")}var y=s.getColumnShouldCellAllowUnsafeHTMLContentAt(t.columnID).call(this,t),b=s.getColumnOptionValue(t.columnID,"allowResetToUndefinedByUIFlag"),M=s.getColumnOptionValue(t.columnID,"disabled"),x=s.getColumnOptionValue(t.columnID,"hyperlinkTarget"),S={touchMode:this._getCurrentTouchMode(),readOnly:!this.isCellInEdition(t.cellID),semantics:{showReferenceValueFlag:this.showModelChangesFlag,allowUnsafeHTMLContent:y}};if(t.rowID<=-1&&t.columnID>=0&&(S.semantics.icon=o),void 0!==l&&(S.semantics.referenceValue=l),void 0!==b&&(S.semantics.allowResetToUndefinedByUIFlag=b),void 0!==M&&(S.semantics.disabled=M),t.rowID>-1){var F=s.getColumnOptionValue(t.columnID,"alignment");"near"!==F&&"center"!==F&&"far"!==F||(S.semantics.alignment=F)}void 0!==x&&(S.semantics.hyperlinkTarget=x);var R=this._getCellSemantics(t);R&&(R=e.clone(R,!1),S.semantics=e.merge(R,S.semantics)),i&&(S=e.merge(i,S)),S.semantics.executionContext=t;var O=void 0;if(!this._muteFind&&this._matchingCellIDsArray&&this._matchingCellIDsArray.length>0){var P;(P=this._matchingCellIDsMap[t.cellID])>=0&&(O={label:this.findStr,isARegExp:this._hasARegExpFilter,indexes:this._matchingFoundArrays[P],selectedIndex:this._getSelectedIndexFromMatchingCellIDIndex(P)})}S.semantics.highlightModel=O,I&&I.__disposable__&&I.__disposable__.identifier===D?(I.disableEvents(),S.semantics.value=a,S.semantics.readOnly=S.readOnly,C.callOutsideUserinteraction(function(){_.setTweakerProperties(I,S.semantics,n,de)}),I.enableEvents()):(S.typePath=n,S.context="inlinedTemplate",S.semantics.executionContext=t,S.needToCreateViewAfterRequireEnded=function(){return!(!t.cellView||t.cellView._currentTimeStamp!==v)},r._addTweakerToGenerate(),S.onViewCreated=function(e){if(t.cellView.setReusableContent(e),t.columnID>=0&&t.rowID>=0&&r.cellDragEnabledFlag&&!r.isCellInEdition(t.cellID)){var i=e.getContent?e.getContent():e;i&&i.setAttribute("draggable",!0)}r._removeTweakerToGenerate()},S.onFailure=function(e){r._removeTweakerToGenerate()},C.callOutsideUserinteraction(function(){de.generateView(a,S)}))}else t.cellView.setReusableContent(null);var A=this._getCellKPIColor(t);A?(t.cellView.KPIColor=A,t.cellView.showKPIColorFlag=!0):t.cellView.showKPIColorFlag=!1},_manageUserInteractions:function(){var e=this;C.addEventOnElement(e,e,"buttonclick",function(t,i){if(t.target.hasClassName("wux-datagridview-selection-checkbox")&&e._selectAllCheckBoxListenChange){var n=t.target.dsModel;if(n){if(i.rowID<0)if(i.columnID<0)n.checkFlag?e.selectAllVisibleNodes():e.unselectAll();else{var o=e.layout.getColumnOrGroupFromCoordinates(i);o&&(t.options.shiftKey||e.setActiveCell(i.cellID),n.checkFlag?e.selectColumnOrGroup(o,!0,t.options.shiftKey):e.unselectColumnOrGroup(o))}e._selectAllCheckBoxListenChange=!0}}}),this._managePointerEvents(),this._manageContextualMenu()},_manageContextualMenu:function(){var e=this;void 0===e._ctxMenuToken&&(e._ctxMenuToken=v.addEventListener(this.elements.container,{callback:function(t){if(le.call(e),se.call(e,!0),!t.info.target||!C.hasClass(t.info.target,"wux-datagridview-drag-grip")){C.pushUserInteractionContext();var i=e.getCellInfosFromHtmlElement(t.info.target);if(e.selectionBehavior.selectOnContextualEvent)if(i)e.setActiveCell(i.cellID,!0,!0),e.isCellSelected(i.cellID)||e.selectCell(i.cellID,!1);else e.setActiveCell(-1);if(i&&e.isCellInEdition(i.cellID)&&t.data.target.getTagName){var n=t.data.target.getTagName();if("input"===n||"textarea"===n)return}var o=e.onContextualEvent.call(e,{context:t.context,collectionView:e,infos:t.info,data:t.data,cellInfos:i});return C.popUserInteractionContext(),o}}}))},buildDefaultContextualMenu:function(e,t){return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e,t):[]},loadCustomViews:function(e,t){"number"==typeof t&&(t<e.length?t=e[t].identifier:console.log("You are trying to set a customView that does not exist")),this.getCustomViewsManager().setCustomViews(e,t,!0)},showCustomViewsDialog:function(){return this.getCustomViewsManager()?this.getCustomViewsManager().showCustomViewsDialog():null},_buildMassUpdateDialogAttributes:function(){const e=this.layout;let t,i;const n=e.getOrderedColumnsReverseIndexes();t=this._columnsXSO&&(i=[...this._columnsXSO.get()])&&i.length>0?i.sort((e,t)=>n[e]-n[t]):e.getVisibleOrderedColumnsIndexes();const o=[],l=e.getLeafColumns();for(const i of t)if(e.getColumnEditableFlag(i)&&e.getColumnMassUpdateAllowedFlag(i)){const t=l[i];if(t){const n={name:t.dataIndex,label:t.text,typeRepresentation:e.getColumnTypeRepresentation(i),semantics:e.getColumnSemantics(i)};o.push(n)}}return o},showModelMassUpdateDialog:function(){if(!this._modelMassUpdateDialog){const e=this;this._modelMassUpdateDialog=new O({identifier:this.identifier+"_MassUpdate",immersiveFrame:this.getContainingImmersiveFrame(),treeDocument:this.getTreeDocument(),setNodeModelValueFunction:function(t,i,n){if("tree"===i||t.options.grid.hasOwnProperty(i)||void 0!==e.layout.getColumnGetCellValue(i)){const o=e.layout.getCellIDFromCoordinates({rowID:t._getRowID(),columnID:e.layout.getColumnIndex(i)});e.getCellEditableState(o)&&(e.setNodeModelValue(t,i,n),e.flashEffectOnCell("ui-modified",o))}},autoCloseFlag:!1,resizableFlag:!0,width:500,height:500})}const e=this._buildMassUpdateDialogAttributes();this._modelMassUpdateDialog.attributes=e,this._modelMassUpdateDialog.resetAttributesValues(),this._modelMassUpdateDialog.immersiveFrame=this.getContainingImmersiveFrame(),this._modelMassUpdateDialog.visibleFlag=!0,this._modelMassUpdateDialog.bringToFront()},getContainingImmersiveFrame:function(){var e=C.firstParentWithClass(this.getContent(),"wux-windows-immersive-frame");return e?e.dsModel:void 0},_onPrivateScrollEnd:function(){0===this._tweakerToGenerateCount&&!this._renderingTaskInterrupted&&this.elements&&this.elements.container&&this._onAllCellsRendered()},_onPrivateReady:function(){0===this._tweakerToGenerateCount&&this._onAllCellsRendered()},_onEndResizeListener:function(){var e=this.layout;e&&e.hasAutoWidthColumnWithAutoRowHeightFlag()&&(e._computedRows=[]),this._parent()},requestDelayedModelData:function(e,t){if(this.onDelayedModelDataRequest&&this._rowModel){var i=this.layout;if(this.getViewportDimensions().height>0||t){var n=0,o=0;if(t){n=0,o=this.getRowModelLength()-1}else{var l=i.getMinMaxVisibleRowIDs();n=l.minRowID,o=l.maxRowID}var r=t?i.getOrderedColumnsIndexes():i.getDisplayedColumnsIndexes();this._rowModel.prepareUpdate(),this.onDelayedModelDataRequest.call(this,{collectionView:this,startNodeIndex:n,endNodeIndex:o,displayedColumnsIndexes:r,context:e}),this._rowModel.pushUpdate()}}},cellShouldBeSelected:function(e){var t=this.layout.getCellCoordinatesAt(e);return t.rowID>=0&&(!this.layout.rowsHeader||-1!==t.columnID)},getEditionManager:function(e){var t=this.layout.getCellCoordinatesAt(e),i=this.layout.getColumnEditionPolicy(t.columnID);if(!this._editionManagers[i]){if("EditionOnDoubleClick"===i)this._editionManagers[i]=new b;else if("EditionOnClick"===i)this._editionManagers[i]=new M;else if("DelayedEditionOnClick"===i)this._editionManagers[i]=new x;else if("EditionOnOver"===i)this._editionManagers[i]=new S;else{if("EditionInPlace"!==i)return null;this._editionManagers[i]=new F}this._editionManagers[i]&&(this._editionManagers[i].collectionView=this)}return this._editionManagers[i]},_onEditionModeChanged:function(e,t){var i=this.layout;if((l=i.getCellCoordinatesAt(e)).columnID>=0&&l.rowID>=0&&this.cellDragEnabledFlag){var n=this._getViewAt(e).getReusableContent(),o=n.getContent?n.getContent():n;o&&o.setAttribute("draggable",!t)}if(!t){var l=i.getCellCoordinatesAt(e);i.getColumnAutoRowHeightFlag(l.columnID)&&i.resetRowHeight(l.rowID)}},_managePointerEvents:function(){var e=this;this._selectionHasBeenDoneOnDown=!1,C.addEventOnElement(this,this,r.POINTERDOWN,function(t,i){e.callMethodFromUIInteraction("_onCapturePointerDown",t,i)},!0),C.addEventOnElement(this,this,r.POINTERMOVE,function(t,i){e.callMethodFromUIInteraction("_onPointerMove",t,i)}),C.addEventOnElement(this,this,r.POINTERUP,function(t,i){e.callMethodFromUIInteraction("_onPointerUp",t,i)}),C.addEventOnElement(this,this,r.POINTERHIT,function(t,i){e.callMethodFromUIInteraction("_onPointerHit",t,i)}),C.addEventOnElement(this,this,"dblclick",function(t,i){if(W){var n=e.layout,o=n.getLeafColumns();E>=0&&E<o.length&&!0===n.getColumnResizableFlag(E)&&(e.sizeColumnOrGroupToFit(E,T,{isUserInteraction:!0,computeColumnHeader:!0}),(n.getColumnAutoRowHeightFlag(E)||n.hasAutoWidthColumnWithAutoRowHeightFlag())&&n.resetRowHeights())}})},_onPointerHit:function(e,t){if(!e.target.hasClassName||!e.target.hasClassName("wux-layouts-treeview-expander")){if(this.PointerHitScope=!0,t&&t.rowID>-1&&t.columnID>-1&&(1!==e.multipleHitCount||this._selectionHasBeenDoneOnDown||this._manageCellSelection(e,t,"up")),this._selectionHasBeenDoneOnDown=!1,t&&-1===t.rowID){if(!W){var i=this.layout;if(i.getColumnSortableFlag(t.columnID)){ue.call(this);var n,o=i.getDataIndexFromColumnIndex(t.columnID),l=[],r=this.sortModel;let a=!1;if(r&&r.length>0)for(var s=0;s<r.length;s++)if(r[s].dataIndex===o){if(this._useTreeDocumentRestoration&&"desc"===r[s].sort){a=!0;continue}if(n="asc"===r[s].sort?"desc":"asc",l.push({dataIndex:o,sort:n}),!e.ctrlKey)break}else e.ctrlKey&&l.push(r[s]);0===l.length&&this._useTreeDocumentRestoration&&(a?d.restoreTreeDocumentOrder(this.treeDocument):r&&0!==r.length||d.saveTreeDocumentOrder(this.treeDocument)),void 0!==n||a||(n="asc",l.push({dataIndex:o,sort:n})),this.sortModel=l,i.saveColumnSortModelInPreferences()}}}else if(t&&-1===t.columnID&&this.showSelectionCheckBoxesFlag){if(t.nodeModel){if(this._selectAllCheckBoxListenChange=!1,t.rowID>=0)if(t.nodeModel.isSelected())this.unselectNodeModel(t.nodeModel);else{var a=this.getTreeDocument();a&&a.options.shouldBeSelected.call(a,t.nodeModel)&&(e.shiftKey||this.setActiveCell(t.cellID),this.selectNodeModel(t.nodeModel,!0,e.shiftKey))}this._selectAllCheckBoxListenChange=!0}}else if((!t||t.columnID<-1)&&2!==e.multipleHitCount){var u=!1;if(e.target===this.elements.scroller.getContent()||this.hasRightContainer()&&e.target===this.elements.rightScroller.getContent()||this.hasLeftContainer()&&e.target===this.elements.leftScroller.getContent()){const t=e.target.getDimensions(),i=_.getScrollbarWidth();let n=!1,o=!1;if(e.target===this.elements.scroller.getContent()){const e=this.layout.getContentDimensions();n=t.width<e.width,o=0===this.layout.getRightContainerWidth()&&t.height<e.height}else if(this.hasRightContainer()&&e.target===this.elements.rightScroller.getContent()){const e=this.layout.getRightContainerWidth();n=t.width<e;const i=this.layout.getContentDimensions();o=t.height<i.height}else if(this.hasLeftContainer()&&e.target===this.elements.leftScroller.getContent()){const e=this.layout.getLeftContainerWidth();n=t.width<e,o=!1}(n&&e.offsetY>=t.height-i&&e.offsetY<=t.height||o&&e.offsetX>=t.width-i&&e.offsetX<=t.width)&&(u=!0)}u||(!this.selectionBehavior.unselectAllOnEmptyArea||e.ctrlKey||e.shiftKey||this.unselectAll(),this.setFocusOnCellContentFlag(!1),this.setActiveCell(-1))}this.PointerHitScope=!1}},_onPointerUp:function(e,t){q&&void 0!==E&&(this.layout._saveColumnWidthInPreferences(E),(this.layout.getColumnAutoRowHeightFlag(E)||this.layout.hasAutoWidthColumnWithAutoRowHeightFlag())&&this.layout.resetRowHeights()),q=!1,k=void 0,this.getContent().removeAttribute("is-resizing-column")},_onPointerMove:function(e,t){if(q&&void 0!==E){var i,n;T<-1?(i=this.layout.getColumnOrGroupFromCoordinates({columnID:E,rowID:T}),n=this.layout.getColumnOrGroupPinned(i)):n=this.layout.getColumnPinned(E);var o=0;return o="right"===n?k+(L-e.clientX):k+(e.clientX-L),o=Math.max(0,o),void(i?this.layout.setColumnOrGroupWidth(i,o):this.layout.setColumnWidth(E,o))}this._computeResizedColumnID(e,t)},_onCapturePointerDown:function(e,t){if(!e.target.hasClassName||!e.target.hasClassName("wux-layouts-treeview-expander")){if(this.PointerDownScope=!0,this._computeResizedColumnID(e,t),W&&void 0!==E&&E>=0)if(q=!0,e.preventDefault(),L=e.clientX,T<-1){var i=this.layout.getColumnOrGroupFromCoordinates({rowID:T,columnID:E});k=this.layout.getColumnOrGroupComputedWidth(i)}else k=this.layout.getColumnComputedWidth(E);else if(t&&-1!==t.rowID&&t.columnID>=-1){if(!e.ctrlKey&&!e.shiftKey){var n=this.getEditionManager(t.cellID);n&&n.onCellPointerDown(t.cellID)}this._selectionHasBeenDoneOnDown=!1,!(t.columnID>-1)||r.isTouchEvent(e)||this.selectionBehavior&&this.selectionBehavior.selectOnPointerUp||(this._selectionHasBeenDoneOnDown=this._manageCellSelection(e,t,"down"))}this.PointerDownScope=!1}},_manageCellSelection:function(e,t,i){var n=this.layout.getColumnGetCellSelectableState(t.columnID);if(n&&!n.call(this,t))return this.setActiveCell(t.cellID),!0;var o=this.selectionBehavior.toggle||e.ctrlKey,l={cellID:this.getActiveCellID(),nodeModel:this.getNodeModelAt(this.getActiveCellID())};if(!e.shiftKey&&t.cellView&&t.cellView._reusableContent&&t.cellView._reusableContent.manageSelection&&t.cellView._reusableContent.manageSelection(e,o,l))return this.setActiveCell(t.cellID),!0;var r=this.isCellSelected(t.cellID);return r&&(this.isCellInEdition(t.cellID)||"ContextualMenuColumn"===this.layout.getColumnIdentifiers(t.columnID).dataIndex)?(this.setActiveCell(t.cellID),!0):r&&o&&"up"===i?(this.unselectCell(t.cellID),this.setActiveCell(t.cellID),!0):!r||"up"===i||e.shiftKey?(this.selectCell(t.cellID,o,e.shiftKey),e.shiftKey&&t.cellView&&t.cellView._reusableContent&&t.cellView._reusableContent.manageSelection&&t.cellView._reusableContent.manageSelection(e,o,l),!0):(!r||e.shiftKey||e.ctrlKey||this.setActiveCell(t.cellID),!1)},_computeResizedColumnID:function(e,t){var i=this.layout;if(t&&t.columnID>-1&&(t.rowID<=-1||t.columnID===i._lastLeftPinnedColumnIndex||t.columnID===i._firstRightPinnedColumnIndex||t.columnID===i._firstUnpinnedColumnIndex)){E=-1,T=-1;var n,o,l,r,s=i.getColumnOrGroupFromCoordinates(t);let a=C.firstParentWithClass(e.target,"wux-layouts-collectionview-cell");if(a){let d=a.getBoundingClientRect().x;s?(n=i.getColumnOrGroupComputedWidth(s),o=i.getColumnOrGroupPinned(s),T=t.rowID,l=t.columnID,r=t.columnID):(n=i.getColumnComputedWidth(t.columnID),o=i.getColumnPinned(t.columnID),l=t.columnID,r=t.columnID),e.clientX-d>=-1&&e.clientX-d<=B?"right"===o?E=l:(t.rowID<=-1||t.columnID===i._firstUnpinnedColumnIndex)&&(E=i._getPreviousVisibleGroupOrColumnID(T,l)):e.clientX-d>=n-B&&e.clientX-d<=n&&("right"===o?t.rowID<=-1&&(E=i._getNextVisibleGroupOrColumnID(T,r)):(t.rowID<=-1||t.columnID===i._lastLeftPinnedColumnIndex)&&(E=r))}}else E=void 0,this.hasLeftContainer()&&(e.target===this.elements.leftHeaderScrollContainer||e.target===this.elements.leftScrollContainer||e.target===this.elements.leftScroller.getContent()||e.target===this.elements.leftSpacerContainer)&&e.offsetX>=this.elements.leftScrollContainer.clientWidth-B?E=i._getColumnIDInLeafColumnHierarchyAtRowID(i._lastLeftPinnedColumnIndex,T):e.target===this._getScroller().getContent()&&e.offsetX<=B?E=i._getColumnIDInLeafColumnHierarchyAtRowID(i._lastLeftPinnedColumnIndex,T):this.hasRightContainer()&&(e.target===this.elements.rightHeaderScrollContainer||e.target===this.elements.rightScrollContainer||e.target===this.elements.rightScroller.getContent()||e.target===this.elements.rightSpacerContainer)&&e.offsetX<=B&&(E=i._getColumnIDInLeafColumnHierarchyAtRowID(i._firstRightPinnedColumnIndex,T));E>=0&&i.getColumnResizableFlag(E)?(W=!0,this._preventScroll=!0,this.getContent().setAttribute("is-resizing-column","true")):(W=!1,this._preventScroll=!1,E=void 0,this.getContent().removeAttribute("is-resizing-column"))},getRowModelLength:function(e){return this._rowModel?this._rowModel.getRowModelLength(e):0},getNodeModelAt:function(e){var t=this.layout.getCellCoordinatesAt(e);if(this._rowModel)return this._rowModel.getVisibleNodeModel(t.rowID)},hasCellValue:function(e){var t=this.layout,i=!1,n=e.nodeModel;if(n){var o=n.options.grid,l=t.getDataIndexFromColumnIndex(e.columnID);if("tree"===l||o.hasOwnProperty(l)){i=!0;var r=t.getColumnHasCellValue(e.columnID);r&&(i=r.call(this,e))}}return i},getModelAt:function(e){var t=this.layout,i=t.getCellCoordinatesAt(e);if(!(i.rowID<=-1)){if(-1===i.columnID)return""+(i.rowID+1);if(i.columnID>-1){var n=this.getLightCellInfosAt(e);if((n.nodeModel&&n.nodeModel.getNodeSource())===a.NODE_SOURCE.GROUPING){if("tree"===(n.nodeModel&&t.getDataIndexFromColumnIndex(i.columnID)))return n.nodeModel.options.label}var o=t.getColumnHasCellValue(i.columnID);if(!o||o.call(this,n)){var l=t.getColumnGetCellValue(i.columnID);if(l)return l.call(this,n)}var r=n.nodeModel;if(r){var s=t.getDataIndexFromColumnIndex(i.columnID);return"tree"===s&&void 0!==r.options.label?r.options.label:r.getAttributeValue(s)}return this._rowModel&&this._rowModel.dataSource||window.console.log("!! No TreeNodeModel at rowID = "+i.rowID),""}return""}var d=t.getColumnOrGroupFromCoordinates(i);if(d){var u="";return i.columnID>-1&&(i.rowID<-1||t.getColumnShowTextFlag(i.columnID)||!t.getColumnIcon(i.columnID))&&(u=d.text),u}},setModelAt:function(e,t,i){var n=this.layout,o=n.getCellCoordinatesAt(e),l=this.getNodeModelAtRowID(o.rowID);if(l){var r=n.getDataIndexFromColumnIndex(o.columnID),s=this.setNodeModelValue(l,r,t,i);s&&s.updateCellView&&this.updateCellView(e,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}else-1!==o.rowID&&console.log("!! setModelAt NO TreeNodeModel at rowID = "+o.rowID+" cellID = "+e)},setNodeModelValue:function(t,i,n,o){if(t){var l=this.layout,r=t._getRowID(),s=l.getColumnIndex(i),a=l.getCellIDFromCoordinates({rowID:r,columnID:s}),d=l.getColumnSetCellValue(i);if(d){var u=this.getCellInfosAt(a);return void 0===o&&void 0===(o=t.getReferenceValue(i))&&void 0===(o=u.cellModel)&&(o=e.clone(n,!1)),t.setReferenceValue(i,o),d.call(this,u,n)}if("tree"===i)"string"===l._getCellTypeRepresentation({cellID:a,columnID:s,rowID:r,cellModel:n,nodeModel:t})&&(t.setLabel(n),void 0!==o&&t.setReferenceLabel(o));t.setAttribute(i,n)}},getCellInfosAt:function(e){var t=this.getModelAt(e),i=this.layout.getCellCoordinatesAt(e),n=this.getNodeModelAtRowID(i.rowID);return{cellID:e,columnID:i.columnID,rowID:i.rowID,cellModel:t,nodeModel:n}},getLightCellInfosAt:function(e){var t=this.layout.getCellCoordinatesAt(e),i=this.getNodeModelAtRowID(t.rowID);return{cellID:e,columnID:t.columnID,rowID:t.rowID,nodeModel:i}},getXSOElementID:function(e){return e?e.id:void 0},_getXSOElementFromCellID:function(e){var t=this.layout,i=t.getCellCoordinatesAt(e),n=t.getDataIndexFromColumnIndex(i.columnID),o=this.getNodeModelAtRowID(i.rowID);return{id:i.rowID+"_"+n,rowID:i.rowID,columnDataIndex:n,nodeModel:o}},getCellIDFromXSOElement:function(e){var t=-1;if(e){var i=e.rowID,n=this.layout,o=n.getColumnIndex(e.columnDataIndex);t=n.getCellIDFromCoordinates({rowID:i,columnID:o})}return t},_updateXSOElements:function(){var e=this.getCellsXSO();if(e){var t=e.get(),i=this;t.forEach(function(e){if(i.getNodeModelAtRowID(e.rowID)!==e.nodeModel&&(i.unselectCell(i.getCellIDFromXSOElement(e)),e.nodeModel.isVisible())){var t=i.layout.getCellIDFromCoordinates({rowID:e.nodeModel._getRowID(),columnID:i.layout.getColumnIndex(e.columnDataIndex)});i.selectCell(t,!0,!1,!1)}})}},_updateActiveCell:function(e){if(e){if(!e.nodeModel)return void this.setActiveCell(-1);var t=void 0;if(e.rowID>=0&&e.rowID<this.getModelLength()&&(t=this.getNodeModelAtRowID(e.rowID)),t!==e.nodeModel)if(e.nodeModel.isVisible()){var i=this.layout.getCellIDFromCoordinates({rowID:e.nodeModel._getRowID(),columnID:this.layout.getColumnIndex(e.columnDataIndex)});this.setActiveCell(i,!1,!0)}else this.setActiveCell(-1)}},_shouldHandleCopy:function(e){if(!this._parent())return!1;var t=this.getActiveCellID();if(this.isCellInEdition(t)&&e.target.getTagName){var i=e.target.getTagName();if("input"===i||"textarea"===i)return!1}return!0},_copyToPlainText:function(){var e=this.getNodesXSO(),t="",i=void 0;if(e.isEmpty()||(i=e.get().filter(function(e){return e.isVisible()})),i&&i.length>0){d.sortNodesByRowID(i);for(var n=0;n<i.length;n++){for(var o=i[n],l=this.layout.getCellsFromNodeModel(o,!0),r=0;r<l.length;r++){var s=this.getCellInfosAt(l[r]);void 0!==(g=this._getCellValueForCopy(s))&&(t+=g),r<l.length-1&&(t+="\t")}n<i.length-1&&(t+="\n")}}else{if(!this.getCellsXSO().isEmpty()){var a=this.layout._getXSORectangularShape();if(void 0===a)J("ClipboardError","ClipboardActionKoMultipleSelection");else for(var u=a.minRowID;u<a.minRowID+a.height;u++){for(var h=a.minColumnID,c=0;c<a.width;c++){var g,p={rowID:u,columnID:h},m=this.layout.getCellIDFromCoordinates(p),f=this.getCellInfosAt(m);void 0!==(g=this._getCellValueForCopy(f))&&(t+=g),c<a.width-1&&(t+="\t"),h=this.layout._getNextVisibleColumnID(h)}u<a.minRowID+a.height-1&&(t+="\n")}}}return t},_pasteFromPlainText:function(e){var t=function(e){"\n"===e[e.length-1]&&(e=e.slice(0,e.length-2));for(var t=e.split("\n"),i=0;i<t.length;i++)t[i]=t[i].split("\t");return t}(e);if(t&&t.length&&t[0]&&t[0].length){for(var i=t.length,n=t[0].length,o=1;o<i;o++)if(t[o].length!==n)return void J("ClipboardError","InconsistentNbColumnsPerRowsInClipboard");var l=this,r=function(e,t){if(l.getCellEditableState(t)){var i=l.getCellInfosAt(t);l.setModelAt(t,l._processCellValueFromPaste(i,e)),l.flashEffectOnCell("ui-modified",t)}else l.flashEffectOnCell("ui-notmodified",t)},s=this.getNodesXSO(),a=void 0;if(s.isEmpty()||(a=s.get().filter(function(e){return e.isVisible()})),a&&a.length>0){var u=this.layout.getVisibleOrderedColumnsIndexes();if(u.length!==n){if(1===n&&1===i)r(t[0][0],this.getActiveCellID());else J("ClipboardError","NbColumnsOfClipboardNotEqualToNbVisibleColumns");return}d.sortNodesByRowID(a),this._rowModel.prepareUpdate(),this.prepareUpdateView();for(var h=0,c=0;c<u.length;c++){for(var g=u[c],p=0,m=0;m<t.length;m++){var f={rowID:a[m+p]._rowID,columnID:g},C=this.layout.getCellIDFromCoordinates(f);if(r(t[m][h],C),m+p===a.length-1)break;m===t.length-1&&a.length>t.length&&(m=-1,p+=t.length)}h++}this._rowModel.pushUpdate(),this.pushUpdateView()}else{var _=this.getCellsXSO(),w=this.getActiveCellID(),v=_.get(),D=void 0;if(v.length>1){if(void 0===(D=this.layout._getXSORectangularShape()))return void J("ClipboardError","MultipleSelection");w=this.layout.getCellIDFromCoordinates({rowID:D.minRowID,columnID:D.minColumnID})}else 1===v.length&&(w=this.getCellIDFromXSOElement(v[0]));this._rowModel.prepareUpdate(),this.prepareUpdateView();var I=this.layout.getCellCoordinatesAt(w);for(p=0,m=0;m<t.length;m++){var V=I.columnID;for(h=0;h<t[m].length;h++){f={rowID:I.rowID+m+p,columnID:V},C=this.layout.getCellIDFromCoordinates(f);if(r(t[m][h],C),-1===(V=this.layout._getNextVisibleColumnID(V)))break;if(D&&h===D.width-1)break}if(D){if(m+p===D.height-1)break;m===t.length-1&&D.height>t.length&&(m=-1,p+=t.length)}}this._rowModel.pushUpdate(),this.pushUpdateView()}}},getCellIDAsString:function(e){var t=this.layout,i=t.getCellCoordinatesAt(e),n=-1;i.columnID>-1&&(n=t.getOrderedColumnsReverseIndexes()[i.columnID]);return i.rowID+":"+n},getAsCSV:function(e){var t=this.getNodesXSO(),i=this.layout,n="\ufeff",o=void 0;if(e&&e.onlySelectedRows?t.isEmpty()||(o=t.get().slice(),d.sortNodesByRowID(o)):(this.requestDelayedModelData("OnExport",!0),o=this.model),o){var l=e?e.columnKeys:void 0,r=i.getLeafColumns();if(l)for(var s=0;s<l.length;s++)l[s]=i.getColumnIndex(l[s]);else if(e&&e.allColumns){l=new Array(r.length);for(var a=0;a<r.length;a++)l[a]=a}else l=i.getVisibleOrderedColumnsIndexes();var u,h,c,g,p,m=e&&e.columnSeparator?e.columnSeparator:",",f=[],C=[];for(u=0;u<l.length;u++){for(f=[],g=i.getColumnOrGroupFromCoordinates({rowID:-1,columnID:l[u]});g;)f.push(g),g=g._parent;var _=i._getColumnTreeDepth();for(h=0;h<_;h++){if(C[h]||(C[h]="",e&&e.addLevelInformation&&(0===h?e&&e.forceQuotes?C[h]+='"'+R.get("Level")+'"':C[h]+=R.get("Level"):e&&e.forceQuotes&&(C[h]+='""'),C[h]+=m)),h>0)c=f[h]&&f[h].text?f[h].text:"";else{var w=i.getCellIDFromCoordinates({rowID:-1,columnID:l[u]}),v=this.getCellInfosAt(w);c="string"==typeof(y=this._getCellValueForExport(v))?y:f[h]&&f[h].text?f[h].text:""}c=c.replace(/\"/g,'""'),e&&e.forceQuotes||-1!==c.search(m)?C[h]+='"'+c+'"':C[h]+=c,u<l.length-1&&(C[h]+=m)}}for(p=C.length-1;p>=0;p--)n+=C[p],n+="\n";for(var D=0;D<o.length;D++){var I=o[D];if(!e||"function"!=typeof e.canNodeModelBeExported||e.canNodeModelBeExported(I)){var V=!1;for(s=0;s<l.length;s++){var y;w=i.getCellIDFromCoordinates({rowID:I._rowID,columnID:l[s]}),v=this.getCellInfosAt(w);e&&e.addLevelInformation&&!V&&v&&v.nodeModel&&(V=!0,n+=v.nodeModel.getNodeDepth(),n+=m),"string"==typeof(y=this._getCellValueForExport(v))&&(y=y.replace(/\"/g,'""'),e&&e.forceQuotes||-1!==y.search(m)||y.indexOf("\n")>-1?n+='"'+y+'"':n+=y),s<l.length-1&&(n+=m)}D<o.length-1&&(n+="\n")}}return n}},isCellSelected:function(e){var t=!1,i=this.layout,n=i.getCellCoordinatesAt(e);if(n.columnID===i._leftPinnedRowColumnID||n.columnID===i._unpinnedRowColumnID||n.columnID===i._rightPinnedRowColumnID||-1===n.columnID){if(l=this.getNodeModelAt(e)){var o=this.getNodesXSO();o&&(t=o.isIn(l))}}else t=this._parent(e);if(!t&&this.isColumnSelected(n.columnID)){var l=this.getNodeModelAt(e),r=this.getTreeDocument();l&&r&&r.options.shouldBeSelected.call(r,l)&&(t=!0)}return t},selectColumn:function(e,t,i){var n=this.layout,o=this.columnSelection;if(this._columnsXSO&&("single"===o||"multiple"===o)&&n.getColumnSelectableFlag(e)){var l=n.getColumnIndex(e);if(i&&"multiple"===o){var r=n.getOrderedColumnsIndexes();if(r&&r.length>0){var s=r[0],a=this.getActiveCellID();a>=0&&(s=n.getCellCoordinatesAt(a).columnID);var d=n.getOrderedColumnsReverseIndexes(),u=Math.min(d[s],d[l]),h=Math.max(d[s],d[l]);if(!t){var c=[];this._columnsXSO.get().forEach(function(e){var t=e;(d[t]<u||d[t]>h)&&c.push(t)}),c.length>0&&this._columnsXSO.remove(c)}for(var g=[],p=u;p<=h;p++){var m=r[p];!this._columnsXSO.isIn(m)&&n.getColumnSelectableFlag(m)&&g.push(m)}g.length>0&&this._columnsXSO.add(g)}}else t&&"multiple"===o?this._columnsXSO.add(l):this._columnsXSO.unique(l)}},unselectColumn:function(e){if(this._columnsXSO){var t=this.layout.getColumnIndex(e);this._columnsXSO.remove(t)}},selectColumnOrGroup:function(e,t,i){var n=this.layout;if(n._isGroupInBalancedTree(e))if(e&&e.children){if(n.getColumnOrGroupSelectableState(e))for(var o=w.getLeafItems(e),l=0;l<o.length;l++){var r=o[l];this.selectColumn(n.getColumnIndex(r.dataIndex),t,i)}}else this.selectColumn(n.getColumnIndex(e.dataIndex),t,i);else console.warn("selectColumnOrGroup has been called on a column or Group that does not exist in the DataGridView")},unselectColumnOrGroup:function(e){var t=this.layout;if(t._isGroupInBalancedTree(e))if(e&&e.children)for(var i=w.getLeafItems(e),n=0;n<i.length;n++){var o=i[n];this.unselectColumn(t.getColumnIndex(o.dataIndex))}else this.unselectColumn(t.getColumnIndex(e.dataIndex));else console.warn("unselectColumnOrGroup has been called on a column or Group that does not exist in the DataGridView")},isColumnSelected:function(e){var t=!1;if(this._columnsXSO&&"none"!==this.columnSelection){var i=this.layout.getColumnIndex(e);this._columnsXSO.isIn(i)&&(t=!0)}return t},isColumnOrGroupSelected:function(e){var t=!1,i=!1;if(e&&e.children){var n=this.layout;if(n.getColumnOrGroupSelectableState(e)){t=void 0;for(var o=0;o<e.children.length;o++){var l=e.children[o];if(n.getColumnOrGroupSelectableState(l)){var r=this.isColumnOrGroupSelected(l);if(r?!1===t||"mixedState"===r?i=!0:t=!0:(t&&(i=!0),t=!1),i)break}}}}else e&&(t=this.isColumnSelected(e.dataIndex));return i?"mixedState":t},getColumnsXSO:function(){return this._columnsXSO},getXSOColumnID:function(e){return e},unselectAll:function(){this._parent(),this._columnsXSO&&this._columnsXSO.empty()},_getCellValueForExport:function(e){var t=this.layout.getColumnOptionValue(e.columnID,"getCellValueForExport");return t instanceof Function||(t=Y),t.call(this,e)},_getCellValueForCopy:function(e){var t=void 0;return e.nodeModel&&!e.nodeModel._isFromOriginalModel()||(t=this.layout.getColumnOptionValue(e.columnID,"getCellValueForCopy")),t instanceof Function||(t=Y),t.call(this,e)},_getCellValueForSort:function(e,t){var i=this.layout.getColumnOptionValue(t,"getCellValueForSort");return i instanceof Function||(i=$),i.call(this,e,t)},_processCellValueFromPaste:function(e,t){var i=void 0;return e.nodeModel&&!e.nodeModel._isFromOriginalModel()||(i=this.layout.getColumnOptionValue(e.columnID,"processCellValueFromPaste")),i instanceof Function||(i=Q),i.call(this,e,t)},insertRowCallback:function(e,t,i){},openPrintableViewWindow:function(e){var t=this;this.displayModalLoader(R.get("GeneratingPrintableView"),function(){var i="<!DOCTYPE html>";i+=t.generatePrintableViewHTML();var n=N.getWebappsAssetUrl("DataGridView","index-datagridview-print.htm");n=n.replace("assets/","");var o,l=!1;if(navigator.userAgent&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(l=!0),e&&!l){var r=document.createElement("iframe");document.body.appendChild(r),r.src="#"+(new Date).getTime(),r.style.border=0,r.style.position="absolute",r.style.width="0px",r.style.height="0px",r.style.right="0px",r.style.top="0px",r.doc=null,r.doc=r.contentDocument?r.contentDocument:r.contentWindow?r.contentWindow.document:r.document,o={win:r.contentWindow,doc:r.doc,elem:r}}else{var s=window.open(n,"_blank","scrollbars=yes,toolbar=yes,location=no,resizable=yes,width=1200,height=800");o={win:s,doc:s.document,elem:s}}if(o){o.doc.open("text/html","_blank");for(var a=window.document.styleSheets,d=0;d<a.length;d++){var u=a[d];o.doc.write('<link rel="stylesheet" type="text/css" href="'+u.href+'" />')}if(o.doc.write(i),o.doc.close(),o.doc.title=R.get("PrintableView"),o.doc.body&&(o.doc.body.style.overflow="auto"),e){t.displayModalLoader(R.get("GeneratingPrintableView"));var h=function(){o.win.focus(),o.win.onafterprint=function(){o.elem.parentElement.removeChild(r)},t.removeModalLoader(R.get("GeneratingPrintableView")),o.win.print()};H.ie?setTimeout(h,1e3):o.win.onload=h}}t.removeModalLoader(R.get("GeneratingPrintableView"))})},generatePrintableViewHTML:function(){this.requestDelayedModelData("OnPrint",!0);var e='<table class="wux-layouts-datagridview wux-print-datagridview-table">';e+=this._generatePrintableColumnHeaders();this.model;for(var t=0;t<this.getModelLength();t++){e+=this._generatePrintableRow(t)}return"</tbody>",e+="</table>"},_generatePrintableColumnHeaders:function(){for(var e=this.layout,t="<thead>",i=new g,n=0;n<e._columnItemsByDepth.length;n++){var o=e._columnItemsByDepth[n];t+="<tr>",this.hasFlatTreeState()||(t+='<th class="wux-layouts-collectionview-cell wux-layouts-datagridview-cell wux-layouts-datagridview-column-header-cell" column-header>',n===e._columnItemsByDepth.length-1&&(t+=R.get("Level")),t+="</th>");for(var l=0;l<o.length;l++){var r=o[l];if(e.getColumnOrGroupPrintableState(r)){var s,a=-e._columnItemsByDepth.length+n;s=a<-1?l:e.getColumnIndex(r.dataIndex);var d=e.getCellIDFromCoordinates({rowID:a,columnID:s}),u=this.getCellInfosAt(d);u.cellView=i,t+=this._generatePrintableCell(u)}}t+="</tr>"}return t+="</thead>",i.setReusableContent(null),i.destroy(),t},_generatePrintableRow:function(e){var t=this.layout,i=this.getNodeModelAtRowID(e),n=i.getNodeDepth(),o="<tr";0===n&&i.hasChildren()&&(o+=" root-node"),o+=">";var l=new c;if(!this.hasFlatTreeState()){o+='<td class="wux-layouts-collectionview-cell wux-layouts-datagridview-cell" align="center">';var r=i.hasChildren()&&(0===n||!i.isExpanded());if(n>0){if(r&&(o+='<div class="wux-print-datagridview-expander">'),o+='<div class="wux-tweakers wux-tweakers-string wux-tweakers-string-label">',o+=n,o+="</div>",r){var s=i.isExpanded()?"chevron-down":"chevron-right";o+=C.generateIcon({iconName:s,fontIconFamily:WUXManagedFontIcons.Font3DS}).outerHTML,o+="</div>"}}else if(r){s=i.isExpanded()?"chevron-down":"chevron-right";o+=C.generateIcon({iconName:s,fontIconFamily:WUXManagedFontIcons.Font3DS}).outerHTML}o+="</td>"}for(var a=t.getVisibleOrderedColumnsIndexes(),d=0;d<a.length;d++){var u=a[d];if(t.getColumnPrintableFlag(u)){var h=t.getCellIDFromCoordinates({rowID:e,columnID:u}),g=this.getCellInfosAt(h);g.cellView=l,o+=this._generatePrintableCell(g)}}return o+="</tr>",l.setReusableContent(null),l.destroy(),o},_generatePrintableCell:function(e){var t,i=this.layout;if(e.rowID<0){t='<th class="wux-layouts-collectionview-cell wux-layouts-datagridview-cell wux-layouts-datagridview-column-header-cell" column-header';var n=i.getColumnOrGroupFromCoordinates(e),o=i._getVisibleLeafCount(n);o>1&&(t+=' colspan="'+o+'"'),t+=">"}else{t='<td class="wux-layouts-collectionview-cell wux-layouts-datagridview-cell"';var l=i.getColumnOptionValue(e.columnID,"alignment");"center"===l?t+=' align="center"':"far"===l&&(t+=' align="right"'),t+=">"}this._setTweakerForCell(e,{readOnly:!0});var r=e.cellView.getReusableContent();r&&r.getContent&&(t+=r.getContent().outerHTML);return e.rowID<0?t+="</th>":t+="</td>",t},executePendingNotifications:function(e){if(this._rowModel&&this._rowModel._executePendingNotifications)return this._rowModel._executePendingNotifications(e)},flushPendingNotifications:function(){this._rowModel&&this._rowModel._flushPendingNotifications&&this._rowModel._flushPendingNotifications()},hasPendingNotifications:function(){if(this._rowModel&&this._rowModel._hasPendingNotifications)return this._rowModel._hasPendingNotifications()},getPendingNotifications:function(){if(this._rowModel&&this._rowModel._getPendingNotifications)return this._rowModel._getPendingNotifications()},getGroupingOptions:function(){return this._groupingOptions},_setGroupingOptions:function(e){this._groupingOptions=e},resetTreeDocument:function(){if(this._rowModel&&this._rowModel._isServerSide())return this._rowModel._resetTreeDocument()},getNodeModelAtRowID:function(e){if(this._rowModel)return this._rowModel._getNodeModelAtRowID(e)},getModelLength:function(){return this._rowModel?this._rowModel._getCurrentPaginationOptions()&&this._onPaginationChangeAsyncLoadModelCB?this._asyncPaginationInitialized?this.getWholeModelLengthForAsyncPagination():0:this._rowModel._getDataGridViewModelDisplayedLength():0},_updateModel:function(){this._rowModel&&this._rowModel._updateModel()},_hasUniformRowHeight:function(){return!this.columns.autoRowHeightFlag||!this.layout.getRowHeight},_getFindModel:function(){return this._rowModel},_askForDeletion:function(){this.deleteOptions&&this.deleteOptions.showConfirmationDialog?this.elements.deletionDialog?this.elements.deletionDialog.show():this.elements.deletionDialog=new P({title:R.get("DeleteDialogTitle"),identifier:this.identifier+"_DeletionDialog",immersiveFrame:this.getContainingImmersiveFrame(),content:R.get("DeleteDialogContent"),autoCloseFlag:!1,buttons:{Yes:new V({onClick:e=>{he.call(this),this.elements.deletionDialog.hide()}}),No:new V({onClick:e=>{this.elements.deletionDialog.hide()}})}}):he.call(this)}})});