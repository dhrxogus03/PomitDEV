define("DS/ENOCharacteristicsApp/controls/CharacteristicsControl",["UWA/Class","DS/ENOCharacteristicsApp/controls/CreateCharacteristics","DS/ENOCharacteristicsApp/controls/CreateSpecification","DS/ENOCharacteristicsApp/controls/DeleteCharacteristics","DS/ENOCharacteristicsApp/utils/CharacteristicsUtils","DS/ENOCharacteristicsApp/service/CharacteristicsServiceWrapper","DS/ENOCharacteristicsApp/utils/Constants","DS/XSRCommonComponents/utils/InformationPanel","DS/XSRCommonComponents/service/XSpecsActionsFactory","DS/XSRCommonComponents/components/EditProp/XSpecProperties","DS/ENOCharacteristicsApp/utils/Notification","DS/Controls/Button","DS/Windows/Dialog","DS/Windows/Panel","i18n!DS/ENOCharacteristicsApp/assets/nls/ENOCharacteristicsApp"],function(e,t,i,a,s,n,r,o,c,l,d,p,h,m,u){"use strict";return e.extend({init:function(e){this.charGrid=e.charGrid,this.dataGrid=e.dataGrid,this.itemTitle=e.itemTitle,this.itemMaturity=e.itemMaturity,this.modelEvents=e.modelEvents,this.specViewerModelEvents=e.specViewerModelEvents},launchCreateForm:function(e,a){var s={};if(s.charContainer=e.charContainer,s.modelEvents=this.modelEvents,"CreateSpecification"===a){s.parentId=e.parentId,s.title=this.itemTitle,s.createCloseAction=s.createAction=function(e,t){e&&null!=e&&t.modelEvents.publish({event:"specification-created",data:{specRowData:e}})},new i(s).loadFields()}else{if(s.isSpecificationLimitsDisabled=e.isSpecificationLimitsDisabled,s.isRoutineReleaseLimitsDisabled=e.isRoutineReleaseLimitsDisabled,!this.dataGrid.getTreeDocument().getSelectedNodes()||1!==this.dataGrid.getTreeDocument().getSelectedNodes().length)return void d.displayNotification({eventID:"info",msg:u.MultipleItemSelected});s.parentId=this.dataGrid.getTreeDocument().getSelectedNodes()[0].getPhysicalId(),s.title=this.dataGrid.getTreeDocument().getSelectedNodes()[0].getTitle(),s.createCloseAction=s.createAction=function(e,t){e&&null!=e&&t.modelEvents.publish({event:"characteristic-created",data:{specRowData:e}})},new t(s).loadFields()}},deleteCharNodes:function(e){var t={};t.parentId=e.parentId,t.modelEvents=e.modelEvents,t.container=e.container,t.selectedNodes=this.dataGrid.getTreeDocument().getSelectedNodes(),new a(t).deleteCharacteristics()},testMethodsDialog:function(e){var t=this;console.log("Test Methods Dialog"),console.log(e);var i=e.selectedNodes[0];t.facetsArr=[];var a=UWA.createElement("div",{class:"testMethods-char-container",styles:{height:"inherit"}});t.specProp=new l,t.editPropView=t.specProp.init({id:i.getID(),container:a,readOnly:!1,facets:t.facetsArr,enableChangeRequired:!1,specModel:i});var s=new h({title:"Test Methods",content:a,height:600,width:500,activeFlag:!1,modalFlag:!0,buttons:{Cancel:new p({onClick:function(e){s.close()}})}});s.addEventListener("close",function(e){t.specViewerModelEvents.publish({event:"xsr-slide-in-facet-destroy-updated"})}),t.specProp._addCustomFacet(e.appCore)},informationDialog:function(e){if(console.log("Information Dialog"),console.log(e),null!=e&&0!=e.length)if(e.length>1)d.displayNotification({eventID:"info",msg:"Select a single Performance Specification"});else if("PerformanceSpec"===e[0].getTypeActualName()){var t=e[0];this.facetsArr=["Properties","Change","Comments"];var i=UWA.createElement("div",{class:"properties-char-container",styles:{height:"inherit"}});this.specProp=new l,this.editPropView=this.specProp.init({id:t.getID(),container:i,readOnly:!1,facets:this.facetsArr,enableChangeRequired:!0,specModel:t});var a=new h({title:"Properties",content:i,height:600,width:500,activeFlag:!1,modalFlag:!0,buttons:{Cancel:new p({onClick:function(e){a.close()}})}})}else d.displayNotification({eventID:"info",msg:"Select a Performance Specification"});else d.displayNotification({eventID:"info",msg:"Select a Performance Specification"})},syncPerformanceSpecs:function(e){let t=this,i=new n;i.getScopedEngItem(e).then(a=>{if(a.totalItems>0){let s=a.member[0].ScopeEngItem?a.member[0].ScopeEngItem.identifier:"";i.syncPerformanceSpecs(e,{scopeEngItem:s}).then(e=>{let i=e.data;i&&t.modelEvents.publish({event:"sync-specifications",data:{specsList:i,engItemId:s}})})}}).catch(e=>{d.clearNotifications(),d.displayNotification({eventID:"error",msg:e?e.errorMessage:"An Error Occured."})})},duplicateCharNodes:function(e){var t=this,i=[],a=1,o=!1,c="";if(e.forEach(function(e){if(!(r.MEASUREMENT_CHAR!==e.getTypeActualName()||s.dimensionDisplayUnitMap[e.getDimensionId()]&&s.displayUnitIdToObjMap[e.getDisplayUnitId()]))return o=!0,void(c+=`${e.getTitle()}, `)}),o)return d.clearNotifications(),void d.displayNotification({eventID:"error",msg:`${u.Err_Duplicate_Unsupported} : ${c.replace(/,\s*$/,"")}`});e.forEach(function(e){var t=e.getParent().getID(),s=e.getParent().getChildren().length+a;a+=1;var r={};r.type=e.getTypeActualName(),r.charId=e.getID(),r.sequence=s;var o=(new n).duplicateInstances(t,r);i.push(o)}),Promise.allSettled(i).then(function(e){if(e&&e.length>0){for(var i=[],a=0,n=0;n<e.length;n++)if("fulfilled"===e[n].status){var r=JSON.parse(e[n].value),o=s.createDupCharData(r.data.data);i.push(o)}else a++;a>0?d.displayNotification({eventID:"error",msg:u.Err_DuplicateChar}):(t.modelEvents.publish({event:"dup-characteristic-created",data:{specRowData:i}}),d.displayNotification({eventID:"success",msg:u.Success_DuplicateChar}))}}).catch(function(e){d.displayNotification({eventID:"error",msg:e?e.message:"An Error Occured."}),t._closeDialog()})},personalize:function(){this.charGrid.personalize()},exportGrid:function(){var e;e=this.itemTitle&&this.itemMaturity?this.itemTitle+"_"+this.itemMaturity+"_"+u.label_PerformanceSpec+"_"+(new Date).toString().split(" ").splice(1,4).join(" "):u.label_Characteristics+"_"+(new Date).toString().split(" ").splice(1,4).join(" "),this.charGrid.exportGrid(e)},maturityStateControl:function(e){c.showMaturityGraph(e)},revisionControl:function(e){c.launchVersionExplorer(e)}})});