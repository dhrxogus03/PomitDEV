define("DS/ENOCharacteristicsApp/controls/CreateSpecification",["UWA/Core","UWA/Controls/Abstract","DS/Controls/TooltipModel","DS/ENOCharacteristicsApp/view/NewDialog","DS/ENOCharacteristicsApp/view/CreateCharacteristicsForm","DS/ENOCharacteristicsApp/service/CharacteristicsServiceWrapper","DS/ENOCharacteristicsApp/utils/Notification","DS/ENOCharacteristicsApp/utils/Constants","DS/ENOCharacteristicsApp/utils/CharacteristicsUtils","DS/ENOCharacteristicsApp/utils/CharacteristicsMask","text!DS/ENOCharacteristicsApp/assets/config/CreateSpecificationFields.json","i18n!DS/ENOCharacteristicsApp/assets/nls/ENOCharacteristicsApp"],function(e,i,t,a,s,r,o,n,c,l,d,p){"use strict";return i.extend({newForm:null,formFields:null,defaultDimensionModel:null,target:null,options:null,dialog:null,init:function(e){this._parent(e),this.target=widget.body,this.createCloseAction=e.createCloseAction,this.createAction=e.createAction,this.parentId=e.parentId,this.container=widget.body,this.modelEvents=e.modelEvents,this.mTestMethodIds=[]},loadFields:function(){var e=JSON.parse(d);l.maskLoader(this.container),this.initCreatForm(e)},initCreatForm:function(e){var i=e;this.newForm=new s(i).render(),this.formFields=this.newForm.formfieldControls;var t=this,o=this.options;o.Title=p.label_Performance_Specifications,o.Content=this.newForm.container,o.width=580,o.renderTo=this.target,l.unmaskLoader(this.container),this.dialog=new a(o),this.dialog.destroyPrevDialog(),this.dialog.render(),this.newForm.listenTo(this.newForm,"CONTAINS_DIRTY_FIELD",function(e){t.formFields.Type.inputfield.value&&t.formFields.Title.inputfield.value?t.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!0):t.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!1)}),this.newForm.listenTo(this.newForm,"UNCOMMITTED_TYPE",function(){t.newForm.updateField(c.allTypeSet,"Type",!1)});var n=function(){var e={};return e.formFields=t.formFields,e.parentId=t.parentId,e};this.dialog.listenTo(this.dialog,"EVENT_CLICK_CHAR_OK",function(){t.enableOrDisableDialogButtons(!0);var e;e=n();var i={};(i.title=e.formFields.Title.inputfield.value,i.description=e.formFields.Description.inputfield.value,i.notes=e.formFields.Notes.inputfield.value,i.type=e.formFields.Type.inputfield.value,t.specData=i,i)?(new r).createSpecification(i,e.parentId).then(t.createSpecCallBack.bind(t),t.onError.bind(t)):(console.log("Unable to get input parameters for create characteristics."),t.stopLoader())}),this.dialog.listenTo(this.dialog,"EVENT_CLICK_CHAR_APPLY",function(){t.enableOrDisableDialogButtons(!0);var e;e=n();var i={};(i.title=e.formFields.Title.inputfield.value,i.description=e.formFields.Description.inputfield.value,i.notes=e.formFields.Notes.inputfield.value,i.type=e.formFields.Type.inputfield.value,t.specData=i,i)?(new r).createSpecification(i,e.parentId).then(t.createSpecCallBackCreate.bind(t),t.onError.bind(t)):(console.log("Unable to get input parameters for create characteristics."),t.stopLoader())}),this.initTypeList()},enableOrDisableDialogButtons:function(e){e?this.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!1):this.dialog.dispatchEvent("CONTAINS_DIRTY_FIELD",!0)},createSpecCallBack:function(e){this.specData.physicalid=e.data.physicalid;var i=c.createSpecData(this.specData);if(null==e){l.unmaskLoader(this.container);var t=e.message;return o.clearNotifications(),void o.displayNotification({eventID:"error",msg:t||p.SpecificationCreateFailure})}void 0!==e&&(this.createCloseAction(i,this),this.dialog.closeDialog(),this.showCreateLoader(),o.clearNotifications(),o.displayNotification({eventID:"success",msg:p.SpecificationCreateSuccess})),setTimeout(this.stopLoader(),1e3)},createSpecCallBackCreate:function(e){this.specData.physicalid=e.data.physicalid;var i=c.createSpecData(this.specData);if(null==e){l.unmaskLoader(this.container);var t=e.message;return o.clearNotifications(),void o.displayNotification({eventID:"error",msg:t||p.SpecificationCreateFailure})}void 0!==e&&(this.createCloseAction(i,this),this.showCreateLoader(),o.clearNotifications(),o.displayNotification({eventID:"success",msg:p.SpecificationCreateSuccess})),this.newForm.resetFields(),setTimeout(this.stopLoader(),1e3)},onError:function(e){this.enableOrDisableDialogButtons(!1),this.stopLoader(),this.newForm.resetFields(),l.unmaskLoader(this.container),o.clearNotifications(),o.displayNotification({eventID:"error",msg:p.Message_Error_CreateSpecAccess||e})},showCreateLoader:function(){l.maskLoader(this.container)},stopLoader:function(){l.unmaskLoader(this.container)},initTypeList:function(){this.newForm.updateField(c.allTypeSet,"Type",!1),1==c.allTypeSet.length&&(this.formFields.Type.inputfield.value=c.allTypeSet[0].valueItem,this.formFields.Type.inputfield.disabled=!0)}})});