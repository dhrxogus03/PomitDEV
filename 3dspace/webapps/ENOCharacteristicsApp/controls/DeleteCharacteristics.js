define("DS/ENOCharacteristicsApp/controls/DeleteCharacteristics",["UWA/Core","UWA/Controls/Abstract","DS/ENOCharacteristicsApp/view/DeleteCharacteristicsDialog","DS/ENOCharacteristicsApp/service/CharacteristicsServiceWrapper","DS/ENOCharacteristicsApp/utils/CharacteristicsMask","DS/Controls/TooltipModel","DS/XSRCommonComponents/createform/view/NewDialog","DS/ENOCharacteristicsApp/utils/Notification","i18n!DS/ENOCharacteristicsApp/assets/nls/ENOCharacteristicsApp"],function(e,t,s,a,i,r,n,o,l){"use strict";return t.extend({init:function(e){this.nodes=e.selectedNodes,this.modelEvents=e.modelEvents,this.parentId=e.parentId,this.container=e.container},deleteCharacteristics:function(){if(this.nodes&&this.nodes.length>0){var e=this;this.confirmationBox(function(){var t=e.nodes;t.length>1?t=e.deleteDialog(t):i.maskLoader(e.container,l.DeletingProgess),function(t){t.length>0&&new a({parentid:e.parentId}).deleteInstances(t).then(function(s){var a=JSON.parse(s).data.reduce(function(e,t){return Object.assign(e,t)},{}),r=t.filter(function(e){return a[e.getPhysicalId()]}),n=t.filter(function(e){return!a[e.getPhysicalId()]});if(n.length>0&&t.length>r.length){var c=l.Message_DeleteCharError;o.clearNotifications(),o.displayNotification({eventID:"error",msg:c}),t.length>1&&e._updateStatus(n,c,!1,!1)}r&&r.length>0&&(t.length>0&&e._updateStatus(r,l.get("DeletePerformanceSpec"),!0,!1),e._removeNode(r),i.unmaskLoader(e.container))}).catch(function(s){var a;i.unmaskLoader(e.container),e.dialog&&e.dialog.closeDialog(),t[0].getPolicy(),a=l.Message_Error_DeleteCharAccess,o.clearNotifications(),o.displayNotification({eventID:"error",msg:s.failedCharMsgsfailureMsg||a})})}(t)})}},deleteDialog:function(t){if(t){var s=Object.create(t),a=e.createElement("div",{class:"xsr-mass-delete-operation"}),i=e.createElement("div",{class:"xsr-mass-delete-header-section"}).inject(a);e.createElement("div",{class:"xsr-mass-delete-header mass-delete-title",text:l.label_Title}).inject(i),e.createElement("div",{class:"xsr-mass-delete-header mass-delete-status",text:l.label_Status}).inject(i);for(var o=0;o<s.length;o++){var c=s[o],d=e.createElement("div",{class:"xsr-mass-delete-rows-section"}).inject(a),u=c.getTitle?c.getTitle():c.title;e.createElement("div",{class:"xsr-mass-delete-row mass-delete-title",text:u}).inject(d).tooltipInfos=new r({shortHelp:u,allowUnsafeHTMLShortHelp:!1}),c.rowStatus=e.createElement("div",{class:"xsr-mass-delete-row mass-delete-status",text:""}).inject(d);e.createElement("div",{class:"deleting-icon wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash"}).inject(c.rowStatus),e.createElement("div",{class:"mass-deleting-msg",text:l.DeletingProgess}).inject(c.rowStatus)}var h=Math.round(34*s.length)>widget.getView().height?widget.getView().height-100:Math.round(34*s.length)+150,g={position:{at:"center",my:"center"}};return g.Title=l.DeleteStatus,g.Content=a,g.width=450,g.height=h,g.renderTo=this.container,g.NoButtons=!0,g.closeButtonFlag=!1,this.dialog=new n(g),this.dialog.render(),s}},_removeNode:function(e){this.modelEvents.publish({event:"chargrid-delete-node-successfull-characterstics",data:e})},_updateStatus:function(t,s,a,n){for(let n=0;n<t.length;n++){let c=t[n];if(c&&c.rowStatus){c.rowStatus.empty();e.createElement("div",{class:"xsr-delete-message",text:l.replace(s,{title:c.options.grid.title})}).inject(c.rowStatus);c.rowStatus.tooltipInfos=new r({shortHelp:s,allowUnsafeHTMLShortHelp:!1}),a?(c.rowStatus.addClassName("wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-check"),c.rowStatus.getParent().addClassName("xsr-mass-delete-row-success")):(c.rowStatus.addClassName("wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-close"),c.rowStatus.getParent().addClassName("xsr-mass-delete-row-failed")),delete c.rowStatus}else o.displayNotification({eventID:a?"success":"error",msg:l.replace(s,{title:c.options.grid.title})});n==t.length-1&&this.dialog&&this.dialog.dispatchEvent("XSR_SHOW_DIALOG_CLOSE_BUTTON",{Close:!0}),i.unmaskLoader(this.container)}},confirmationBox:function(e){var t=new s(this.nodes).renderDialog();t.listenTo(t,"EVENT_CLICK_CHAR_OK",function(){e(),t.closeDialog()})},deleteTestMethod:function(e){}})});