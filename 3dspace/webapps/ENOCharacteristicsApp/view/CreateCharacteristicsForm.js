define("DS/ENOCharacteristicsApp/view/CreateCharacteristicsForm",["UWA/Core","UWA/Class/View","UWA/Element","DS/ENOCharacteristicsApp/utils/Constants","DS/ENOCharacteristicsApp/utils/Notification","DS/ENOCharacteristicsApp/view/NewInputFields","DS/ENOCharacteristicsApp/utils/CharacteristicsUtils","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","text!DS/ENOCharacteristicsApp/assets/config/CreateCharacteristicsFields.json","i18n!DS/ENOCharacteristicsApp/assets/nls/ENOCharacteristicsApp","css!DS/ENOCharacteristicsApp/view/CreateCharacteristicsForm.css"],function(e,i,t,n,l,a,r,s,o,d,c){"use strict";return i.extend({_control:{},container:null,inputField:null,_fields:{},setup:function(e){this._fields={},this._parentView=e,this.formStyle=e&&e.formStyle?e.formStyle:"horizontal"},render:function(){this.elements.mContainer=new e.createElement("div",{class:"char-create-dialog"}),this.maincontainer=this.elements.mContainer,this._control={};return this.createInputFields=new a(this),this.createFields(this._parentView),this},_clearButton:function(i,t){var n=new e.createElement("div",{class:"clear-btn wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-reset"});return n.currentfield=i,n.fieldoptions=i.fieldoptions,n.tooltipInfos=new WUXTooltipModel({shortHelp:c.Clear,allowUnsafeHTMLShortHelp:!1}),n.addEventListener("click",function(e){if(Array.isArray(this.currentfield))for(var i=0;i<this.currentfield.length;i++)this.currentfield[i].value=void 0;else this.currentfield.value=void 0;t&&t.setStyle("display","none")}),n},_buildFieldLabels:function(i,t){var n,l;if(n=c[t.label]||c[t.fieldLabel],t.isFieldMandatory||t.isMandatory){l=new e.Element("span",{text:n}).inject(i);new e.Element("span",{class:"char-mandatory-flag",text:"*"}).inject(l)}else l="label_AllowedValuesList"===t.label?new e.Element("span",{text:""}).inject(i):new e.Element("span",{text:n}).inject(i);return l},_buildFieldControls:function(i,t,n,l,a,r,s){var o={},d=this._getUIControl(t);o.fieldControl=d,null!=r?(a.inject(r),o.inlineContainer=r,o.expander=l):(a.inject(s),o.expander=l),o.inputfield=null;var c=t.fieldName.toLowerCase();if(this.inputField=d,this._fields[c]=this.inputField,e.is(this.inputField)&&(this.inputField.fieldoptions=t),o.parentfield=a,o.groupContainer=s,e.is(this.inputField)&&(o.inputfield=this.inputField,d.inject(n)),"true"===t.clearButton){var u=new e.createElement("div",{class:"wux-control-inline-container clear-button"}).inject(n),f=this.inputField;this._clearButton(f,void 0).inject(u),o.ClearButton=u}return this._control[t.fieldName]=o,this.inputField=null,o},_buildFields:function(i,t,n,l,a){var r,s,o,d=this;!function(i,t,n){if(r=i.createField,o=d.formStyle?new e.createElement("div",{class:"new-char-field "+d.formStyle}):new e.createElement("div",{class:"new-char-field"}),""!==i.label){var c=new e.createElement("div",{class:"new-char-field-header wux-control-inline-container",id:"charLabel_"+i.label.split("_")[1]}).inject(o);d._buildFieldLabels(c,i),h=new e.createElement("div",{class:"new-char-input-field wux-control-inline-container"}).inject(o),p=new e.createElement("div",{class:"new-char-input-field-control"}).inject(h),r.direction&&"vertical"===r.direction&&p.addClassName("field-control-view-vertical");for(var u=0;u<r.length;u++){var f=i.label;s=r[u],d._buildFieldControls(f,s,p,a,o,n,l)}}else if(""==i.label)for(u=0;u<r.length;u++){var p,h;(s=r[u]).commonLabel?""!=!s.fieldLabel||"LowerTarget"!=s.fieldName&&"UpperTarget"!=s.fieldName?""===s.fieldLabel&&new e.Element("span",{text:""}).inject(c):((c=new e.createElement("div",{class:"new-char-field-multi-header wux-control-inline-container"}).inject(o)).addClassName(s.fieldName),d._buildFieldLabels(c,s)):""==!s.fieldLabel&&s.visible&&((c=new e.createElement("div",{class:"new-char-field-dual-header wux-control-inline-container"}).inject(o)).addClassName(s.fieldName),d._buildFieldLabels(c,s)),f=s.fieldLabel,d._buildFieldControls(f,s,o,a,o,n,l)}}(i,0,n)},_getUIControl:function(e){if(e)return this.createInputFields.render(e)},_buildGroupFields:function(i,t,n){var l,a,r;if(void 0!==i&&""!==i){r=new e.createElement("div",{class:"char-group-container"});var s={type:"expander"};s.groupName=i,s.groupContainer=r,(a=this.createInputFields.render(s)).inject(n)}if("AcceptanceCriteria"===t.groupName||"RoutineReleaseLimit"===t.groupName||"SpecificationLimit"===t.groupName){var o=new e.createElement("div",{class:"input-field-error-icon",id:t.groupName.toLowerCase()+"_error_icon",html:{tag:"span",class:"wux-ui-3ds-attention wux-ui-3ds xsr-attention-icon"}}).inject(r);new e.createElement("div",{class:"input-field-error-message",id:t.groupName.toLowerCase()+"_error_msg"}).inject(o)}var d=this,c=function(i,t){var n;d.formStyle,n=new e.createElement("div",{class:"char-inline-container"}),r&&void 0!==n&&n.inject(r),d._buildFields(t,d.maincontainer,n,r,a)};for(l=0;l<t.fieldsInfo.length;l++)c(t.groupLabel,t.fieldsInfo[l])},_buildSingleFields:function(i,t){var n,l,a=this;l=i,a.formStyle,(n=new e.createElement("div",{class:"char-inline-container"})).inject(t),a._buildFields(l,a.maincontainer,n)},_buildExpanderHeader:function(i,t){var n=c[i],l=new e.Element("div",{class:"char-toggle-accordeon-container"});new WUXExpander({header:n,allowUnsafeHTMLHeader:!1,body:t,expandedFlag:!0,style:"filled-separate"}).inject(l);return l},_message:function(i,t){var n=new e.createElement("span",{class:"char-message-field",text:i});return e.is(t)&&n.addClassName(t),n},_insertFields:function(i){var t,n=new e.Element("div",{class:"char-mandatory-flag-message"}).inject(this.maincontainer);if(new e.Element("span",{class:"char-mandatory-flag",text:"*"}).inject(n),this._message(c.MandatoryFieldIndicator,"").inject(n),i.fields.groupHeader){var l=i.fields.groupHeader;for(t=0;t<l.length;t++){var a=l[t],r=a.groupLabel,s=a.inline||a;this._buildGroupFields(r,s,this.maincontainer)}}else{l=i.fields.fieldsInfo;for(t=0;t<l.length;t++)this._buildSingleFields(l[t],this.maincontainer)}},createFields:function(e){this._insertFields(e);var i=this._control;this._control={},this.formfieldControls=i,this.container=this.maincontainer},messageField:function(i,t){var n=new e.createElement("span",{class:"char-message-field",text:i});return e.is(t)&&n.addClassName(t),n},checkDirtyFields:function(){var e=this._fields,i=!0;for(var t in e){if(e[t].hasDirtyField){i=!0;break}i=!1}this.dispatchEvent("CONTAINS_DIRTY_FIELD",{hasDirtyField:i})},resetFields:function(){var e,i=this.formfieldControls;for(e in i){let t,n;Array.isArray(i[e].inputfield)?(t=i[e].inputfield[0],n=i[e].inputfield[1].fieldoptions.type):(t=i[e].inputfield,n=i[e].inputfield.fieldoptions.type),["singleselect","text","textarea","autocomplete","integer","spinbox"].includes(n)?("Type"!==t.fieldoptions.fieldName&&"Category"!==t.fieldoptions.fieldName&&(t.value=void 0),"MissedTargetAction"===t.fieldoptions.fieldName&&(t.value="No Action Required"),"DisplayUnit"===t.fieldoptions.fieldName&&this.updateField("","DisplayUnit",!1)):["ckeditor"].includes(n)?t.ckRef.setData(""):["boolean","toggle"].includes(n)&&(t.checkFlag=!1)}},updateField:function(e,i,t){if(!i)return null;var n=function(e,i){return new o({label:e,value:i})};let l=this.formfieldControls[i];if(t)l.inputfield.elementsTree=e;else{let i;(i=Array.isArray(l.inputfield)?l.inputfield[0].elementsTree:l.inputfield.elementsTree).prepareUpdate(),i.empty(),null!=e&&Object.keys(e).forEach(function(t){var l=n(e[t].labelItem,e[t].valueItem);i.addRoot(l)}),i.pushUpdate()}},toggleErrorMessage:function(e,i,t){let n=document.getElementById(e+"_error_msg"),l=document.getElementById(e+"_error_icon");n&&t?(n.setText(i),l.setStyle("visibility","visible")):(n.setText(""),l.setStyle("visibility","hidden"))}})});