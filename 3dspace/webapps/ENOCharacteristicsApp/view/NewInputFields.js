define("DS/ENOCharacteristicsApp/view/NewInputFields",["UWA/Core","UWA/Class/View","UWA/Element","DS/WUXAutoComplete/AutoComplete","DS/Controls/Button","DS/Controls/ComboBox","DS/Controls/LineEditor","DS/Controls/Editor","DS/Controls/Expander","DS/Controls/TooltipModel","DS/Controls/Toggle","DS/Controls/SpinBox","DS/Controls/SelectionChips","DS/Controls/Slider","DS/Controls/Label","DS/TreeModel/TreeDocument","DS/ENOCharacteristicsApp/utils/Constants","DS/ENOCharacteristicsApp/utils/Notification","DS/ENOCharacteristicsApp/utils/CharacteristicsValidation","i18n!DS/ENOCharacteristicsApp/assets/nls/ENOCharacteristicsApp","css!DS/ENOCharacteristicsApp/view/CreateCharacteristicsForm.css"],function(e,t,a,i,l,n,d,o,r,s,c,u,h,m,p,C,v,E,f,b){"use strict";return t.extend({_control:{},container:null,inputField:null,addInputField:null,_fields:{},setup:function(e){this._fields={},this.createFormContext=e},render:function(e){return this._getUIType(e)},_getUIType:function(e){var t;switch(e.type.toLowerCase()){case v.TEXTONLY:t=this._buildTextOnly(e);break;case v.TEXT:t=this._buildLineEditCtrl(e);break;case v.TEXTAREA:t=this._buildEditerCtrl(e);break;case v.COMBOBOX:t=this._buildComboBox(e);break;case v.TOGGLE:t=this._buildToggleButtons(e);break;case v.AUTOCOMPLETE:t=this._buildAutoCompleteField(e);break;case v.SELECTIONCHIP:t=this._buildSelectionChipsField(e);break;case v.EXPANDER:t=this._buildExpanderHeader(e);break;case v.BUTTON:t=this._buildButtonField(e);break;case v.SINGLESELECT:t=this._buildSelectAutoCompleteField(e);break;case v.SPINBOX:t=this._buildSpinBox(e);break;case v.SLIDER:t=this._buildSlider(e);break;case v.WUX_LABEL:t=this._buildWUXLabel(e)}return t},_buildExpanderHeader:function(t){var a=t.groupName,i=t.groupContainer,l=b[a],n=new e.Element("div",{class:"char-toggle-accordeon-container"});new r({header:l,allowUnsafeHTMLHeader:!1,body:i,expandedFlag:!0,style:"filled-separate"}).inject(n);return n},_buildLineEditCtrl:function(t){var a=this.createFormContext,i=t.fieldName.toLowerCase(),l=t.placeHolder,n=new d({value:e.is(t.value)?t.value:"",disabled:"true"===t.disabled,domId:t.domId||"charLineEditor"+i,pattern:void 0,placeholder:b[l]});t.visible||n.elements.container.addClassName("xsr-char-hidden"),n.elements.container.addClassName("char-line-editor"),a.inputField=n,a.inputField.hasDirtyField=!(!t.mandatory||a.isValid(t.value)),a._fields[i]=a.inputField;var o=a._fields[i],r=function(e){var i;o.hasDirtyField=!(!t.visible||!t.isMandatory||f.isValid(e))&&t.isMandatory;var l=a.formfieldControls;v.FORBIDDEN_CHARS;return""!=e&&f.hasNumericValueFields(t.fieldName)&&(i=f.validateLimitsValuesNew(l,"warning")),a.checkDirtyFields.call(a),!1!==i||i};return t.fieldName===v.PRIORITY&&(n.pattern="^[+]?[0-9]*$"),null!=t.fieldName&&n.addEventListener("onfocusout",function(e){var t=e.dsModel.valueToCommit;r.call(this,t)}),n.addEventListener("change",function(e){var t=e.dsModel.value;r.call(this,t)?(o.value&&E.clearNotifications(),a.dispatchEvent("SELECT_CHANGE_EVENT",i)):o.value=""}),t.type===v.TEXT&&t.isMandatory&&n.addEventListener("uncommittedChange",function(e){e.dsModel.value=e.dsModel.valueToCommit}),n},_buildTextOnly:function(t){return e.createElement("div",{class:"xsr-text-only",text:t.value,id:"textOnly"+t.fieldName})},_buildEditerCtrl:function(t){var a=this.createFormContext,i=t.fieldName.toLowerCase(),l=t.placeHolder,n=new o({value:e.is(t.value)?t.value:"",disabled:"true"===t.disabled,domId:t.domId||"charEditor"+i,placeholder:b[l],nbRows:t.nbRows||3,newLineMode:"enter"});n.elements.container.addClassName("char-editor"),a.inputField=n,a.inputField.hasDirtyField=!(!t.mandatory||a.isValid(t.value)),a._fields[i]=a.inputField;var d=a._fields[i];return t.visible||n.elements.container.addClassName("xsr-char-hidden"),n.addEventListener("change",function(e){var i=e.dsModel.value;(function(e){d.hasDirtyField=!(!t.visible||!t.isMandatory||f.isValid(e))&&t.isMandatory,a.checkDirtyFields.call(a)}).call(this,i)}),n},_buildSelectAutoCompleteField:function(e){var t=this.createFormContext,a=e.fieldName;let l=b[e.placeHolder]||e.placeHolder;null==l&&(l=b["label_"+e.name]);var n=new C,d=new i({domId:"charAutoComplete"+a,placeholder:l,multiSearchMode:!1,elementsTree:n,allowFreeInputFlag:!1,disabled:e.disabled,allowResetToUndefinedByUIFlag:e.clearIcon});e.visible||d.elements.container.addClassName("xsr-char-hidden"),t.inputField=d,t._fields[a]=t.inputField;var o=t._fields[a];t.inputField.hasDirtyField=e.isMandatory;var r=function(a){o.hasDirtyField=!(!e.isMandatory||a),t.checkDirtyFields.call(t)};return d.addEventListener("change",function(){d.selectedItems?(r(!0),t.dispatchEvent("SELECT_CHANGE_EVENT",a)):(t.dispatchEvent("SELECT_CHANGE_EMPTY_EVENT",a),r(!1))}),"Type"===e.fieldName&&d.addEventListener("focusout",function(e){t.dispatchEvent("UNCOMMITTED_TYPE")}),"Dimension"===e.fieldName&&d.addEventListener("uncommittedChange",function(e){var a=e.dsModel.valueToCommit;""===a&&null===a||t.dispatchEvent("UNCOMMITTED_AUTOCOMPLETE",a)}),d},_buildAutoCompleteField:function(e){this.createFormContext;var t=e.fieldName.toLowerCase(),a=e.placeHolder,l=new C({});return new i({domId:"charAutoComplete"+t,placeholder:b[a],multiSearchMode:!0,value:void 0,elementsTree:l,minLengthBeforeSearch:4,allowFreeInputFlag:!1})},_buildSpinBox:function(t){this.createFormContext;var a=t.fieldName?t.fieldName.toLowerCase():"",i=t.placeHolder,l=void 0,n=new u({domId:"xsrSpinBox"+a,value:e.is(t.value)?parseInt(t.value):null,disabled:t.disabled,placeholder:b[i],stepValue:t.stepValue?t.stepValue:1,decimals:t.decimals?t.decimals:0,allowUndefinedFlag:!0});return n.addEventListener("change",function(e){var t=e.dsModel.value;void 0!==t&&(!Number.isInteger(t)||t<0||isNaN(t))?e.dsModel.value=l:t&&5<t.toString().length?(e.dsModel.value=l,E.displayNotification({eventID:"error",msg:b.err_priorityLength})):l=e.dsModel.value}),n},_buildButtonField:function(e){var t=this.createFormContext,a=e.fieldName.toLowerCase(),i=e.placeHolder,n=new l({allowUnsafeHTMLLabel:!1,domId:"CharButton"+a,label:"",icon:e.buttonIcon});return n.tooltipInfos=new s({shortHelp:b[i]}),n.addEventListener("click",function(a){"AddAuthorizedValues"===e.fieldName&&t.dispatchEvent("EVENT_ALLOWED_VALUE_ADD_BUTTON_CLICK",this),"DimensionSearchButton"===e.fieldName&&t.dispatchEvent("EVENT_DIMENSION_BUTTON_CLICK",this),"SearchTestMethod"===e.fieldName&&t.dispatchEvent("EVENT_TEST_METHOD_BUTTON_CLICK",this)}.bind(this)),n},_buildSelectionChipsField:function(e){var t=this.createFormContext,a=e.placeHolder,i=e.fieldName.toLowerCase(),l=new h({height:"auto",domId:"CharSelectionChips"+i,placeholder:b[a]});return l.elements.container.addClassName("charSelectionChip"),l.addEventListener("onPostRemove",function(e){t.dispatchEvent("EVENT_ALLOWED_VALUE_REMOVE_BUTTON_CLICK",this)}.bind(this)),l},_buildToggleButtons:function(e){var t,a=this.createFormContext,i=e.fieldName.toLowerCase(),l=e.toggletype,n=e.placeHolder;t=e.toggleLabel?b[e.toggleLabel]:"";var d=new c({type:l,disabled:"true"===e.disabled,label:t,domId:e.domId||"charToggleButton"+i,value:void 0,checkFlag:!1,allowUnsafeHTMLLabel:!1});return d.elements.container.addClassName("char-toggle-button"),d.tooltipInfos=new s({shortHelp:b[n]}),d.addEventListener("change",function(e){a.dispatchEvent("CONTAINS_DIRTY_FIELD",this);var t=a.formfieldControls;f.validateLimitsValuesNew(t,"warning")||(e.dsModel.checkFlag=!e.dsModel.checkFlag)}.bind(this)),d},_buildComboBox:function(t){var a,i=t.fieldName.toLowerCase(),l=this.createFormContext,d=t.placeHolder;if(t.typeInput){var o=new C({});a=new n({elementsTree:o,enableSearchFlag:!0,domId:t.domId||"charComboBox"+i,value:e.is(t.value)?t.value:"",placeholder:b[d],disabled:"true"===t.disabled,selectedIndex:0,generateRegexpString:function(e){return e}})}else{var r=[];"alttarget"===i&&(r=[b.label_YES,b.label_NO]),a=new n({elementsList:r,enableSearchFlag:!0,domId:t.domId||"charComboBox"+i,value:e.is(t.value)?t.value:"",placeholder:b[d],disabled:"true"===t.disabled,selectedIndex:0,generateRegexpString:function(e){return e}})}a.elements.container.addClassName("charComboBox"),this.inputField=a,this.inputField.hasDirtyField=!(!t.mandatory||this.isValid(t.value)),this._fields[i]=this.inputField;var s=this._fields[i];return a.addEventListener("change",function(e){e.stopPropagation(),e.preventDefault();var a=e.dsModel.value;f.isValid(a)?s.hasDirtyField=!1:s.hasDirtyField=!0,l.dispatchEvent("EVENT_TYPE_CHANGE",{field:t.fieldName}),l.checkDirtyFields.call(l)}),a},_buildSlider:function(e){let t,a=this.createFormContext,i=e.fieldName.toLowerCase();return(t=new m({value:e.value||0,minValue:e.minValue||0,maxValue:e.maxValue||10,stepValue:e.stepValue||1,domId:e.domId||"slider"+i})).elements.container.addClassName("char-slider"),t.addEventListener("change",function(e){a.dispatchEvent("SLIDER_CHANGE_EVENT",{fieldName:i,value:e.dsModel.value})}),e.visible||t.elements.container.addClassName("xsr-char-hidden"),t},_buildWUXLabel:function(e){this.createFormContext;let t,a=e.fieldName.toLowerCase();return t=new p({value:"",domId:e.domId||"wuxLabel"+a,emphasize:e.emphasize||"secondary"}),e.visible||t.elements.container.addClassName("xsr-char-hidden"),t}})});