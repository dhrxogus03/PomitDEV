define("DS/VCXWebModifiables/VCXModifiableServer",["UWA/Class"],function(e){"use strict";return e.extend({init:function(){this._HashTableModifiable={},this._maxID=0},unInitialize:function(){this._HashTableModifiable={},this._maxID=0},GetHashTable:function(){return this._HashTableModifiable},AddModifiable:function(e){var t=e.GetHashing();if(t){if(this._HashTableModifiable[t])return;var r=parseInt(t,16);r&&r>this._maxID&&(console.log("HASHING : update max ID, we should not go here anymore"),this._maxID=r)}else t=(this._maxID+1).toString(16),e.SetHashing(t),this._maxID++;this._HashTableModifiable[t]=e},RemoveModifiable:function(e){delete this._HashTableModifiable[e]},GetModifiableFromHashing:function(e){var t=this._HashTableModifiable[e];return void 0===t?null:t}})}),define("DS/VCXWebModifiables/VCXIModifiableView",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/VCXWebModifiables/VCXAModifiableFormatPainter",["UWA/Class"],function(e){"use strict";return e.extend({init:function(){this._parent()},getPropertiesFormatPainter:function(){return[]}})}),define("DS/VCXWebModifiables/VCXLinkedPropertyManager",["DS/CoreEvents/Events","UWA/Class","DS/VCXWebProperties/VCXColor"],function(e,t,r){"use strict";var i=t.extend({init:function(){this._links={},this._invertedlinks={},this._isInFollow=!1},initialize:function(){},unInitialize:function(){this._links={},this._invertedlinks={},this._isInFollow=!1},AddLink:function(t,r,i,n,o){var a=this._links[t];a||(this._links[t]=a={});var s=a[r];s||(a[r]=s={});var p=s[i];p||(s[i]=p={});var l=p[n];l||(p[n]=l={}),p[n]=l=o;var f=this._invertedlinks[i];f||(this._invertedlinks[i]=f={}),f[n]=!0,e.publish({event:"VCX_LINKS_ADDED"})},RemoveLink:function(e,t,r,i){var n,o=this._links[e];if(o){var a=o[t];if(a){var s=a[r];if(s&&void 0!==(n=s[i])){delete s[i],0==Object.keys(a[r]).length&&(delete a[r],0==Object.keys(o[t]).length&&(delete o[t],0==Object.keys(this._links[e]).length&&delete this._links[e]));var p=this._invertedlinks[r];p&&p[i]&&(delete p[i],0==Object.keys(this._invertedlinks[r]).length&&delete this._invertedlinks[r])}}}return n},RemoveLinks:function(t){for(var r=0;r<t.length;r++)this.RemoveLink(t[r].inID,t[r].inProp,t[r].outID,t[r].outProp);e.publish({event:"VCX_LINKS_REMOVED"})},GetLinksFromPropertyName:function(e,t){var r=[];for(var i in this._links)if(this._links.hasOwnProperty(i)){var n=this._links[i];if(n)for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];if(a)for(var s=0;s<t.length;s++){var p=t[s];if(a.hasOwnProperty(p))if(a[p].hasOwnProperty(e)){var l={inID:i,inProp:o,outID:p,outProp:e};r.push(l)}}}}return r},GetLinksFromInComponentID:function(e){var t=[],r=this._links[e];if(r)for(var i in r)if(r.hasOwnProperty(i)){var n=r[i];if(n)for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];for(var s in a)if(a.hasOwnProperty(s)){var p={inID:e,inProp:i,outID:o,outProp:s};t.push(p)}}}return t},IsLinkedAndNotInFollow:function(e,t){if(!0===this._isInFollow)return!1;var r=this._invertedlinks[e];return!(!r||!r[t])},Follow:function(e,t,i){var n=this._experienceBase.ComponentsMap,o=this._isInFollow;this._isInFollow=!0;var a=this._links[e];if(a){var s=a[t];if(s)for(var p in s)if(s.hasOwnProperty(p)){var l=n.GetComponentFromID(p);if(l){var f=l.QueryInterface("VCXIModifiable");if(f){var u=s[p];for(var d in u)if(u.hasOwnProperty(d)){var c=f.GetProperty(d);if(c){var h=c.GetPropertyValue().GetType();if(i.GetType()===h)f.OnChangeProperty(d,i);else if("VCXPropertyValueInt"!==i.GetType()&&"VCXPropertyValueFloat"!==i.GetType()||"VCXPropertyValueColor"!==h){var y=i.ToString();c.GetPropertyValue().FromString(y),f.OnChangeProperty(d,c.GetPropertyValue())}else{var P,b,G=100-100*i.GetValue()/100;G<0&&(G=0),G>99?(P=255,b=0):G<50?(P=Math.floor(G/50*255),b=255):(P=255,b=Math.floor((50-G%50)/50*255)),0;var M=new r;M.SetRGBA(P/255,b/255,0,1),c.GetPropertyValue().SetValue(M),f.OnChangeProperty(d,c.GetPropertyValue())}f.OnChangePropertiesEnd()}}}}}}this._isInFollow=o},UpdateProperties:function(){var e=this._experienceBase.ComponentsMap;for(var t in this._links){var r=e.GetComponentFromID(t);if(r){var i=r.QueryInterface("VCXIModifiable");if(i&&this._links.hasOwnProperty(t)){var n=this._links[t];if(n)for(var o in n){var a=i.GetProperty(o);if(a){var s=a.GetPropertyValue();this.Follow(t,o,s)}}}}}}});return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXLinkedPropertyManager"}}),i}),define("DS/VCXWebModifiables/VCXMetaPropertyDef",["UWA/Class"],function(e){"use strict";return e.extend({init:function(e,t){this._propertyInfo=e,this._strType=t,this._strDefaultLabel=null},SetDefaultLabel:function(e){e&&(this._strDefaultLabel=e)},GetDefaultLabel:function(){return this._strDefaultLabel},SetPropertyInfo:function(e){this._propertyInfo=e},GetPropertyInfo:function(){return this._propertyInfo},SetType:function(e){this._strType=e},GetType:function(){return this._strType}})}),define("DS/VCXWebModifiables/VCXIModifiableFormatPainter",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/VCXWebModifiables/VCXAModifiableView",["UWA/Class","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t){"use strict";return e.extend({init:function(){},getTranslatedProperty:function(e){let r={},i=e.group;i||(i=e.groupName&&this.getPropertyGroups()[e.groupName]);let n=e.propertyName;if(!n||"string"==typeof n){let t=this.QueryInterface("VCXIModifiable");n=e.propertyName&&t.GetProperty(e.propertyName)}let o,a,s,p=n&&n.GetPropertyInfo();if(i&&i.i18nGroup&&(o=i.i18nGroup),p&&p.Geti18n()&&(a=p.Geti18n()),p&&"Modifiable.Style"===p.GetPropertyName()&&(s=t),i&&(r.groupName=o&&o[i.getName()],r.groupName||(p&&p.Geti18n()?r.groupName=p.Geti18n()[i.getName()]:(console.warn("Group '"+i.getName()+"' 's translation not found in "),r.groupName=null))),n){o&&a&&o===a&&(r.propertyName=o[n.GetPropertyInfo().GetNLSID()]),o&&a&&o!==a&&(r.propertyName=a[n.GetPropertyInfo().GetNLSID()]),o&&o[n.GetPropertyInfo().GetNLSID()]&&(r.propertyName=o[n.GetPropertyInfo().GetNLSID()]),a&&a[n.GetPropertyInfo().GetNLSID()]&&(r.propertyName=a[n.GetPropertyInfo().GetNLSID()]),r.propertyName||(console.warn("Property '"+n.GetPropertyInfo().GetNLSID()+"' 's translation not found in "),r.propertyName=n.GetPropertyInfo().GetNLSID());let e=p&&p.GetMapChoiceEnum&&p.GetMapChoiceEnum();if(e){r.choice={};for(let t in e)a&&a[e[t]]&&(r.choice[t]=a[e[t]]),!r.choice[t]&&o&&o[e[t]]&&(r.choice[t]=o[e[t]]),!r.choice[t]&&s&&s[e[t]]&&(r.choice[t]=s[e[t]]),r.choice||console.warn(e[t]+" 's translation not found in i18nGroup file "+o+", neither in i18nProperty file "+a)}}return r},getAdditionalPropertySettings:function(){return this._parent()||{}}})}),define("DS/VCXWebModifiables/VCXEnumTools",["UWA/Class"],function(e){"use strict";var t=e.singleton({init:function(){}});return t.generateMapChoiceFromEnumAndId=function(e,t,r){const i={},n=Array.isArray(r)&&r,o=Object.keys(e).filter(e=>Number.isNaN(+e)&&(!n||!n.includes(e)));return o&&o.forEach(r=>{const n=t?t+".":"";i[e[r]]=n+r}),i},t}),define("DS/VCXWebModifiables/VCXMetaPropertyManager",["UWA/Class"],function(e){"use strict";var t=e.extend({init:function(){this._MetaPropertyDef={}},initialize:function(){},unInitialize:function(){this._MetaPropertyDef={}},AddMetaPropertyDef:function(e){var t=e.GetPropertyInfo().GetPropertyName();this._MetaPropertyDef[t]=e},GetMetaPropertyDef:function(e){return this._MetaPropertyDef[e]}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXMetaPropertyManager"}}),t}),define("DS/VCXWebModifiables/VCXIModifiable",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/VCXWebModifiables/VCXModelChangeListener",["UWA/Class"],function(e){"use strict";var t=e.extend({initialize:function(){this._changesFlag=-1},unInitialize:function(){},hasChanged:function(e,t){return t&&(this._changesFlag|=e),this._changesFlag&e},postUpdate:function(e){this._parent(e),this._changesFlag=0}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXModelChangeListener"}}),t.FChangeFlag={BomID:1,Visibility:2,DressupVisibility:4,PartListID:8,PartListEnabled:16,PartListDescription:32},t}),define("DS/VCXWebModifiables/VCXModifiableView",["DS/VCXWebModifiables/VCXAModifiableView","DS/VCXWebProperties/VCXPropertyGroup","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,r){"use strict";return e.extend({init:function(){},getAdditionalPropertySettings:function(){const e=this.QueryInterface("VCXIStylesHolder");if(e){let t={};return e.getAdditionalPropertySettings(t,r)}},getPropertyGroups:function(e){e||(e={});var i=this.getGroupPropertiesOrders();e["Group.Essentials"]||(e["Group.Essentials"]=new t({groupID:"Group.Essentials"}),e["Group.Essentials"].i18nGroup=r),e["Group.Essentials"].setPropertiesOrder(i["Group.Essentials"]),e["Group.Essentials"].priority=0;const n=this.QueryInterface("VCXIStylesHolder");if(n&&n.getPropertyGroups(e),this.GetObject()._experienceBase.ModifiablesAdvancedProperties&&(e["Group.Introspection"]||(e["Group.Introspection"]=new t({groupID:"Group.Introspection"}),e["Group.Introspection"].i18nGroup=r),e["Group.Introspection"].setPropertiesOrder(i["Group.Introspection"]),e["Group.Introspection"].priority=90,e["Group.Introspection"].addProperties([{propertyName:"Modifiable.ID",i18n:r},{propertyName:"Modifiable.Type",i18n:r},{propertyName:"Modifiable.Hashing",i18n:r},{propertyName:"Modifiable.Level",i18n:r},{propertyName:"Modifiable.HasChildren",i18n:r}])),this.GetObject().QueryInterface("VCXIModifiable")._metaPropSet){var o=[];if(this.GetObject().QueryInterface("VCXIModifiable")._metaPropSet.GetListPropertyNames(o),0!==o.length){var a=this.GetObject().QueryInterface("VCXIModifiable")._metaPropSet.GetProperty(o[0]);a||console.log("Missing first of the meta properties...");var s=a.GetPropertyInfo();let r=s.Geti18nGroup();e["Group.UserProperties"]||(e["Group.UserProperties"]=new t({groupID:"Group.UserProperties"}),e["Group.UserProperties"].i18nGroup=r,e["Group.UserProperties"].priority=5);for(var p=0;p<o.length;++p){var l=o[p];let t=(s=(a=this.GetObject().QueryInterface("VCXIModifiable")._metaPropSet.GetProperty(l)).GetPropertyInfo()).Geti18n();e["Group.UserProperties"].addProperty({propertyName:l,i18n:t})}}}return e},getGroupPropertiesOrders:function(){return{"Group.Essentials":["Modifiable.Style"],"Group.Introspection":["Modifiable.ID","Modifiable.Type","Modifiable.Hashing","Modifiable.Level","Modifiable.HasChildren"]}},getCollapsedGroupsNames:function(){return[]}})}),define("DS/VCXWebModifiables/VCXModifiable",["UWA/Class","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebModifiables/VCXEnumTools","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,r,i,n,o,a,s,p){"use strict";return e.extend({init:function(){this._metaPropSet=null,this._scenarioManager=null,this._linkedPropertyManager=null},GetMetaProperties:function(e){this._metaPropSet&&e.Merge(this._metaPropSet)},Build:function(){var e=this.GetObject();e._experienceBase&&e._experienceBase.getManager("VCXScenarioManager")&&e._experienceBase.getManager("VCXScenarioManager").ModifiableServer.AddModifiable(this)},GetType:function(){return"VCXModifiable"},SetHashing:function(e){this._hashing=e},GetHashing:function(){return this._hashing},OnChangeProperty:function(e,r){const n=this.QueryInterface("VCXIStylesHolder");if(n){const t=n.OnChangeProperty(e,r);if(t)return t}if("Meta."===e.slice(0,5)){null===this._metaPropSet&&(this._metaPropSet=new i);var o=this._metaPropSet.GetProperty(e);if(o)return o.SetPropertyValue(r.Clone()),!0;var a=this.GetObject()._experienceBase.getManager("VCXMetaPropertyManager").GetMetaPropertyDef(e);if(a){var s=new t(a.GetPropertyInfo().Clone(),r.Clone());return this._metaPropSet.AddOrModifyProperty(s),!0}return!1}return!1},OnChangePropertiesEnd:function(){},GetInterpolator:function(e){return null},GetProperty:function(e){const i=this.QueryInterface("VCXIStylesHolder");if(i){const t=i.GetProperty(e,p);if(t)return t}var s=null;if("Modifiable."===e.slice(0,11)){if("Modifiable.ID"===e)(l=new n).SetValue(this.GetObject().GetID()),(P=new r(e,1,!1,p)).SetGroupId("Group.Introspection"),s=new t(P,l);else if("Modifiable.Type"===e){(l=new n).SetValue(this.GetObject().GetType()),(P=new r(e,1,!1,p)).SetGroupId("Group.Introspection"),s=new t(P,l)}else if("Modifiable.Hashing"===e){var l;(l=new n).SetValue(this.GetHashing()),(P=new r(e,1,!1,p)).SetGroupId("Group.Introspection"),s=new t(P,l)}else if("Modifiable.Level"===e){var f=-1;if((c=this.GetObject()).IsKindOf("VCXWebComponentOccurrence")&&!c.IsDressup)do{if(f++,!(h=c.QueryInterface("VCXIModelNavigable")))break;var u=h.getParent();if(!u)break;c=u.GetObject()}while(null!==c);var d=new o;d.SetValue(f),(P=new r(e,1,!1,p)).SetGroupId("Group.Introspection"),s=new t(P,d)}else if("Modifiable.HasChildren"===e){var c,h,y=!1;if((c=this.GetObject()).IsKindOf("VCXWebComponentOccurrence")&&!c.IsDressup)(h=c.QueryInterface("VCXIModelNavigable"))&&(y=h.getChildren().length>0);var P,b=new a;b.SetValue(y),(P=new r(e,1,!1,p)).SetGroupId("Group.Introspection"),s=new t(P,b)}}else if("Meta."===e.slice(0,5)&&this._metaPropSet){var G=this._metaPropSet.GetProperty(e);G&&(s=G.Clone())}return s},GetProperties:function(e){var t=new i;const r=this.QueryInterface("VCXIStylesHolder");return r&&r.GetProperties(t,p),this.GetMetaProperties(t),this.GetObject()._experienceBase.ModifiablesAdvancedProperties&&(t.AddOrModifyProperty(this.GetProperty("Modifiable.ID")),t.AddOrModifyProperty(this.GetProperty("Modifiable.Type")),t.AddOrModifyProperty(this.GetProperty("Modifiable.Hashing")),t.AddOrModifyProperty(this.GetProperty("Modifiable.Level")),t.AddOrModifyProperty(this.GetProperty("Modifiable.HasChildren"))),t},RequestModification:function(e,t){if(e){t.AddOrModifyProperty(this.GetHashing(),e);const r=this.QueryInterface("VCXIStylesHolder");r&&r.RequestModification(e,t)}},GetRequiredPropertiesForTransition:function(){return null},GetModifiedProperties:function(){return this._modifiedProperties},OnChangePropertyBegin:function(e,t){var r=this.GetObject(),i=this.GetHashing();if(this._scenarioManager||(this._scenarioManager=r._experienceBase.getManager("VCXScenarioManager")),this._scenarioManager.AddPropertyToRestoreSet(i,e),this._modifiedProperties||(this._modifiedProperties={}),this._modifiedProperties[e]=!0,this._linkedPropertyManager||(this._linkedPropertyManager=r._experienceBase.getManager("VCXLinkedPropertyManager")),this._linkedPropertyManager){if(this._linkedPropertyManager.IsLinkedAndNotInFollow(r.GetID(),e)){var n=r.QueryInterface("VCXIPulseBehavior");return!n||!n.GetIsPulsing()}this._linkedPropertyManager.Follow(r.GetID(),e,t)}return!1},IsLiving:function(){return!0},_generateMapChoiceFromEnumAndId:function(e,t,r){return s.generateMapChoiceFromEnumAndId(e,t,r)}})});