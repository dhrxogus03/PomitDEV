define("DS/ENOProjectMgmtCommonComponents/views/CalendarsView",["UWA/Core","DS/Controls/Calendar"],function(e,t){"use strict";return t.extend({_uwaClassName:"CalendarsView",parentView:void 0,init:function(e,t){this.parentView=e,this._parent(t)},_redrawCalendar:function(){this._parent.apply(this),this.parentView.repaintCalendarDates()}})}),define("DS/ENOProjectMgmtCommonComponents/config/DefaultGridConfig",[],function(){"use strict";return{_uwaClassName:"DefaultGridConfig",height:"200px",defaultColumnDef:{width:"auto",typeRepresentation:"string"},showRowIndexFlag:!1,showAlternateBackgroundFlag:!0,showSelectionCheckBoxesFlag:!0,rowSelection:"multiple",cellSelection:"none",cellPreselectionFeedback:"row",selectionStyle:"",cellActivationFeedback:"row",showModelChangesFlag:!1,columnsHeader:!0,rowHeader:!1,showOutlineFlag:!1,focusNextEditableCellOnTabFlag:!0,selectionBehavior:{selectNodeModelOnCellSelection:!0},showBackgroundFlag:!0,columnDragEnabledFlag:!1,showRowHeaderBackgroundFlag:!1,showContextualMenuColumnFlag:!0,layoutOptions:{columnsHeader:!0,rowsHeader:!0},sortModel:[{dataIndex:"modified",sort:"desc"}]}}),define("DS/ENOProjectMgmtCommonComponents/constants/Constants",[],function(){"use strict";return{COLLABSPACE:"collabspace",X_PREF_CREDENTIAL:"xPref_CREDENTIAL",COLLABSTORAGE:"collabstorage",X3D_PLATFORMID:"x3dPlatformId",TENANT:"tenant",CTX_PREFIX:"ctx::",SPACE_SOURCE:"3DSpace",DEFAULT:"DEFAULT",DEFAULT_OPPORTUNITY:"DEFAULT_OPPORTUNITY",CONTEXT_CHANGE:"contextChange",CONTEXT_REMOVE:"contextRemove"}}),define("DS/ENOProjectMgmtCommonComponents/config/KanbanViewConfig",["UWA/Core","UWA/Class"],function(e,t){}),define("DS/ENOProjectMgmtCommonComponents/utils/Constants",["DS/WebappsUtils/WebappsUtils"],function(e){"use strict";return{BASE_URL:e.getWebappsBaseUrl()+"ENOProjectMgmtCommonComponents/assets/",PERSON:"Person",ADD_NODE:"Add Node",REMOVE:"remove",SET_FOCUS:"Set Focus",SUCCESS:"Success",CREATE:"Created",CLASSIFICATION_BASE_URL:"resources/v1/modeler/dslib",LIBRARY_BASE_URL:"resources/v1/modeler/dslib/dslib:Library",LIBRARY_SEARCH_URL:"resources/v1/modeler/dslib/dslib:Library/search",CLASSIFIED_ITEM_URL:"resources/v1/modeler/dslib/dslib:ClassifiedItem",EDIT:"edit",ASSIGN_TO_SELF:"assignToSelf",REMOVE_ASSIGN_TO_SELF:"removeSelfassign",COMPLETE:"complete",RE_OPEN:"re-open",DELETE:"delete",LINK:"link",RELATIONS:"relations",REMOVE_ASSIGNEE:"removeAssignee",ASSIGNEE_ATTR:"assignees",CONTEXT_ATTR:"context",MATRIX_CONFIG_ATTR:"matrixConfiguration",COMPLETE_STATE:"Complete",IN_WORK_STATE:"Active",DEFAULT_SOURCE:"3dspace",XPLAN_SOURCE:"3dplan",DRIVE_SOURCE:"3DDrive",XPLAN_APP_ID:"ENXPLAN_AP",XPLAN_RESOURCE_SHARING_API:"invoke/dsxplan:getResourceSharing",XPLAN_MODIFY_DATA:"dsaccess:Operation.Shareable.Modify",PROJECT:"Project",XPROJECT:"dsplan:xProject",STATE_ATTR:"state",RELATIONS_WIDGET_APP_ID:"ENORIPE_AP",COMPLETED_PREFERENCE:"completedPreference",MATURITY:"maturity",DUPLICATE:"duplicate",COLLABSPACE:"collabspace",CHANGE_OWNER:"changeOwner",EXPORT:"export",DEFINITION:"Definition",BOOKMARK_URL:"URL"}}),define("DS/ENOProjectMgmtCommonComponents/config/MassUpdateToolbarConfig",[],function(){"use strict";return{fetchOptions:{fields:"name,modified,state,actualStartDate,actualFinishDate,owner,ownerInfo.name,ownerInfo.firstname,ownerInfo.lastname,modifyAccess,deleteAccess",includeFields:"ownerInfo"}}}),define("DS/ENOProjectMgmtCommonComponents/config/CustomGridDefaultConfig",[],function(){"use strict";return{_uwaClassName:"CustomGridDefaultConfig",customViews:[{identifier:"projectMgmtCustomViewComfortable",layoutDensity:"comfortable",isDefault:!0}]}}),define("DS/ENOProjectMgmtCommonComponents/utils/CommonUtils",["UWA/Core","DS/E6WCommonUI/Search","DS/LifecycleControls/EditPropDialog","DS/i3DXCompassServices/i3DXCompassPubSub","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/utils/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a){"use strict";let l={"3dspace":"3DSpace"},r={getAlertManager:function(){return window.widget.projectMgmtAlertManager},launchProperties:function(e,t){let n=t&&t.model;var a=n&&n.serviceId,r=o.get("tenant"),c=n&&n.physicalId||e;let d={model:{objectId:c,tenant:r,source:l[a]||a}};switch(a){case s.XPLAN_SOURCE:d.model.sourceName=a,d.model.source="fedsearch",d.model.objectId='uri:"<'+c+'>"',d.model["ds6w:type"]=n.get("type")||n.get("dsxplan:jsType")}return new i({ID:"propFor"+e}).launchProperties(d),!0},downloadFile:function(e,t){var i=document.createElement("a"),n=i.href=URL.createObjectURL(new Blob(["\ufeff"+e],{encoding:"UTF-8",type:"text/json;charset=UTF-8"}));i.setAttribute("download",t),document.body.appendChild(i),i.click(),setTimeout(function(){document.body.removeChild(i),URL.revokeObjectURL(n)},0)},getSpecialCharSepartedStringFromObjects:function(e,t){let i="";t=(t||",")+" ";let n=Object.keys(e);return n&&n.length&&n.forEach(n=>{let o=e[n],s=r.getSpecialCharSepartedStringFromArray(o,t);s&&(i+=n+' "'+s+'" ')}),i},getSpecialCharSepartedStringFromArray:function(e,t){return e.length&&e.join(t).replace(/,(?!.*,)/gim," "+a.AND+" ")||""},formatRangeValuesForSelectView:function(t,i,n,o){let s,a,l,c,d=[],h=t&&t.length,u=r.pushEmptyRangeValue(o);u&&d.push(u);let m=r.pushNoneRangeValue(o);if(m&&d.push(m),h){let o=e.is(i,"function")&&i,r=e.is(n,"function")&&n;t.forEach(e=>{c=e.get,s=e.name||e.title||c&&(e.get("name")||e.get("title")),a=o&&o(e)||e[i]||c&&e.get(i),l=r&&r(e)||e[n]||c&&e.get(n),d.push({name:s||"",actualValue:a,displayValue:l})})}return d},pushEmptyRangeValue:function(t){let i=e.clone(t||{},!1);if(i.blankRange){let e=i.blankRangeDisplayValue;return e&&(e=a.INVALID_ICON+" "+e),{actualValue:i.blankRangeActualValue||"",displayValue:e||a.NONE}}},pushNoneRangeValue:function(t){let i=e.clone(t||{},!1);if(i.noneRange)return{actualValue:i.noneRangeActualValue||"0",displayValue:i.noneRangeDisplayValue||a.NONE}},launchApp:function(t,i){let o;i&&!e.is(i,"array")&&(i=[i]),i&&i.length&&i.forEach(e=>{o=e.getTransferObject(o)}),n.publish("setX3DContent",o),n.publish("launchApp",{appId:t})},addOpenMenuItem:function(e,t,i){i||(i=(i=require("DS/ENOProjectMgmtCommonComponents/config/ViewConfigBase"))&&i.prototype);let n=i&&i.getOpenWithInfo();n&&n._appsList&&(n.set3DXContent(t.getTransferObject()).render(e),!n._getCompatibleApps().length&&t.isSpaceObject()&&e.addItem(r.getWebAppOpenMenuItem(t.id)))},getWebAppGoToLinkMenuItem:function(e){return{text:a.GO_TO_LINK,fonticon:"open",handler:function(){window.open(e)}}},getWebAppOpenMenuItem:function(e){let t=this;return{text:a.OPEN,fonticon:"open",handler:function(){window.open(t.getDPMAppURL(e))}}},getDPMAppURL:function(e){let t=o.get("3DSpace");var i=encodeURIComponent(o.get("tenant")),n=t+"/emxLogin.jsp?physicalId="+encodeURIComponent(e);return n+="&tenant="+i,n+="&x3dPlatformId="+i},getDashboardUrl:function(e){let t=o.get("appId");return o.get("3DDashboard")+"#app:"+t+"/content:ids="+encodeURIComponent(e)},getRelationsButton:function(t){let i=e.clone(t||{},!1).model;if(!i||!i.isPersonType())return{text:a.RELATIONS_LABEL,name:"relationsButton",fonticon:"object-related",className:i&&i.isSpaceObject()?"":"disabled",handler:function(){r.launchApp(s.RELATIONS_WIDGET_APP_ID,i)}}},getPreviewButton:function(t){let i,n=e.clone(t||{},!1),o=n.model,s=n.handler;return i={text:a.PREVIEW,fonticon:"eye",name:"preview",className:o?"":" disabled",handler:s}},getLinkEditButton:function(t){let i,n=e.clone(t||{},!1),o=n.model,s=n.handler;return i={text:a.EDIT,fonticon:"pencil",name:"edit",className:o?"":" disabled",handler:s}},getCopyLinkURL:function(e){e&&r.copyTextToClipboard(r.getDashboardUrl(e.id))},getconcatenatedActualDisplayValue:function(e){return e.value+"-"+(e.nls[widget.lang]||e.name)},_compare:(e,t,i)=>e[i].toLowerCase()<t[i].toLowerCase()?-1:e[i].toLowerCase()>t[i].toLowerCase()?1:0,sort:function(e,t){let i=this;e.sort((e,n)=>i._compare(e,n,t))},addExistingSearch:function(e){new t("",!1,"furtive").activate(e)},loadLinksView:function(t){if(!this.linkPopupInvoked){let i=this;this.linkPopupInvoked=!0;let n=e.clone(t||{},!1);e.extend(n,{closureFunc:function(){delete i.linkPopupInvoked}}),this.loadJSDependency("DS/ENOProjectMgmtCommonComponents/views/LinkViewPopup").then(e=>{new e(n).render()})}},getFontIconElement:function(t,i){let n=e.clone(i||{},!1);return e.createElement("div",{html:{tag:"i",class:"fonticon "+t+(n.additionalClass?" "+n.additionalClass:"")}})},easeInOutSineProjectMgmt:function(e){return-.5*(Math.cos(Math.PI*e)-1)}};return r}),define("DS/ENOProjectMgmtCommonComponents/components/TriptychWrapper",["UWA/Class","UWA/Drivers/Alone","DS/ENOXTriptych/js/ENOXTriptych","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n){"use strict";return e.extend({_triptych:void 0,_isCollapsed:!1,_isMobile:void 0,parentView:void 0,init:function(e){this._left=t.createElement("div"),this._left.classList.add("triptych-wrapper-left"),this._main=t.createElement("div"),this._main.classList.add("triptych-wrapper-main"),this._right=t.createElement("div"),this._right.classList.add("triptych-wrapper-right"),this._triptych=new i;let n={left:{resizable:!1,originalState:"close",overMobile:!0},right:{resizable:!1,originalSize:435,originalState:"close",overMobile:!0,withClose:!1},borderRight:!0,borderLeft:!0,container:e,withtransition:!1};this._triptych.init(n,this._left,this._main,this._right),this.registerListeners()},build:function(e){this.parentView=e},_getTriptych:function(){return this._triptych},destroy:function(){this._triptych.destroy()},hideRightPanel:function(){this._triptych._hidePanel("right")},showRightPanel:function(){this._triptych._showPanel("right")},registerListeners:function(){this._isMobile=n.isMobile()}})}),define("DS/ENOProjectMgmtCommonComponents/config/ConfigBase",["UWA/Core","UWA/Class/Model","DS/CollectionView/CollectionViewStatusBar","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Utils/FederatedSearch","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a){"use strict";let l=t.extend({_uwaClassName:"ConfigBase",setValues:Function.prototype,setColumnInfo:function(){let e=this;e.columnInfo={},this.values.forEach((t,i)=>{e._setColumnInfoForField(t,i)})},_setColumnInfoForField:function(e,t){let i;i="list"===this.type?e.dataIndex:"tab"===this.type||"facet"===this.type?e.key:e.dataIndex||e.name,this.columnInfo[i]=e,this.columnInfo[i].valueIndex=t,e.fieldDefinitionName&&(this.columnInfo[e.fieldDefinitionName]=this.columnInfo[i]),e.customContentId&&(this.customContentColumnInfo[e.dataIndex]=e,this.customContentColumnInfo[e.dataIndex].valueIndex=t)},handleCustomFieldConfigs:function(t,i,n,o){let s=this.cloneConfig(!0),a=e.clone(s.options||{},!1);a.initializeCustomAttributes&&n.initializeCustomAttributes(i.model.getCustAttrFieldDefinitionSource(),i.get("type"),s,o);let l=!1,r=s.values;if(r.length)for(let n=0;n<r.length;n++){let o=!1,c=r[n],d=c.name,h=i.get(d);if(t){if(c.isCustomField){let t=c.values;o=e.is(t,"array")&&t.length<=1}!h&&c.hasOwnProperty("defaultValue")&&i.set(d,c.defaultValue)}else if(a.initializeCustomAttributes&&!i.model.has(d))o=!0;else if(c.showFieldOnlyIfValueExists&&(o=!0,h)){o=!(h instanceof e.Class.Collection||e.is(h,"array"))&&e.is(h,"object")?!Boolean(h&&Object.keys(h).length):!Boolean(h&&h.length)}o&&(l=!0,s.values.splice(n,1),n--)}return l&&s.setColumnInfo(),s},getDefaultTab:function(e){for(let t in this.values){let i=this.values[t];if(e?i.key===e:i.checkFlag)return i}},cloneConfig:function(t){if(t){let i=new this.constructor;return i._uwaClassName=i._uwaClassName+"Cloned",i.values=[],i.options=this.options,this.values.forEach(n=>{n.config?n.config=n.config.cloneConfig&&n.config.cloneConfig(t):n=e.clone(n),i.values.push(n)}),i.setColumnInfo(),i}{let t={values:[],columnInfo:{}};return this.values.forEach(i=>{t.values.push(e.clone(i)),t.columnInfo[i.dataIndex||i.name]=i}),t}},setRangeValues:function(e,t){this.values[e.valueIndex].values=t,this.values[e.valueIndex].defaultValues=t,this.values[e.valueIndex].defaultValue=t[0]?t[0].actualValue:"",this._setColumnInfoForField(e,e.valueIndex)},getPersonSearchSource:function(){return n.get("3DSwym")?["swym"]:["3dspace"]},getPersonSearchSourceTypes:function(e){return"swym"===e.toString()?{swym:["pno:Person"]}:{"3dspace":["Person"]}},getObjectSearchSource:function(e){let t=["3dspace","3dplan"];return e&&(t=t.concat("drive")),o.filterSearchSources(t)},getPanelViewConfig:function(){return this.leftPanel||this.mainPanel},getStatusBarOptions:function(){return[{type:i.STATUS.NB_SELECTED_ROWS},{position:"far",type:i.STATUS.NB_VISIBLE_ITEMS}]},getSpecificViewConfig:function(e,t){let i=this._getSpecificViewConfig(this.leftPanel,"group1",e);if(i||(i=this._getSpecificViewConfig(this.mainPanel,"group1",e)),i&&t){let e=this._getSpecificViewConfig(i,"group3",t);e&&(e.separator=!0)}return i},_getSpecificViewConfig:function(e,t,i){return e&&e.toolbarConfig[t].find(e=>e.name===i)},addAdditionalValues:Function.prototype});return l.assigneesCustomButtons=[{id:"assignToSelf",iconClass:"fonticon-user-ok",toolTip:a.ASSIGN_TO_SELF},{id:"removeSelfassign",iconClass:"fonticon-user-delete",toolTip:a.REMOVE_ASSIGN_TO_SELF}],l}),define("DS/ENOProjectMgmtCommonComponents/config/ClassificationConfig",["DS/ENOProjectMgmtModels/Collections/SearchObjects","DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n){"use strict";let o=t.extend({_uwaClassName:"ClassificationConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"classification",values:[{readWrite:"true",name:"classificationPaths",attributeToDisplay:"name",imageAttribute:"image",singleObjectOnly:!1,label:n.CLASSIFICATION_PATHS,type:"object",toggleAttributes:!0,typeAheadCallback:e.typeAheadCallback,linkCallback:i.launchProperties,placeHolder:n.SEARCH_PLACEHOLDER_TEXT,searchSource:["3dspace"],validateSameTenant:!0,searchSourceTypes:{"3dspace":["General Class","Document Family","Export Control Class","IP Control Class","Part Family","Security Control Class"]}}]});return o._instance=o._instance||new o,o._instance}),define("DS/ENOProjectMgmtCommonComponents/config/CustomAttributesConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase"],function(e){"use strict";return e.extend({_uwaClassName:"CustomAttributesConfig",columnInfo:{},type:"basic",values:[],setup:function(e){let t=UWA.clone(e||{},!1);this.options=t,this.options.initializeCustomAttributes=!0,this.options.displayMessageWhenNoAttributeExists=!0,this.setColumnInfo()}})}),define("DS/ENOProjectMgmtCommonComponents/config/CommonTabConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t){"use strict";return e.extend({_uwaClassName:"CommonTabConfig",columnInfo:{},type:"tab",hide:!0,setup:function(){this.setColumnInfo()},values:[{name:t.PROPERTIES,key:"properties",selected:!0,checkFlag:!0}]})}),define("DS/ENOProjectMgmtCommonComponents/config/ClassificationConfigForCreate",["DS/ENOProjectMgmtModels/Collections/SearchObjects","DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n){"use strict";let o=t.extend({_uwaClassName:"ClassificationConfigForCreate",columnInfo:{},setup:function(){this.setColumnInfo()},type:"classification",values:[{readWrite:"true",name:"classificationPaths",attributeToDisplay:"name",imageAttribute:"image",singleObjectOnly:!1,label:n.CLASSIFICATION_PATHS,type:"object",toggleAttributes:!0,typeAheadCallback:e.typeAheadCallback,linkCallback:i.launchProperties,placeHolder:n.SEARCH_PLACEHOLDER_TEXT,searchSource:["3dspace"],validateSameTenant:!0,searchSourceTypes:{"3dspace":["General Class","Document Family","Export Control Class","IP Control Class","Part Family","Security Control Class"]}}]});return o._instance=o._instance||new o,o._instance}),define("DS/ENOProjectMgmtCommonComponents/components/ProgressSpinner",["UWA/Core","DS/Controls/Loader","DS/Controls/ModalContainer","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils"],function(e,t,i,n,o){"use strict";let s={_isSpinnerVisible:!1,initializeProgressSpinner:function(e){this._rootContainer=e},showProgressSpinner:function(e,o){n.get("useExternalNotification")?s.showLoadingMessage(e,o):(e=e||this._rootContainer)._isSpinnerVisible||(e._isSpinnerVisible=!0,this._progressSpinner=new t({text:o}),this._progressSpinner.on(),i.createModal(e,this._progressSpinner.elements.container))},hideProgressSpinner:function(e){n.get("useExternalNotification")?s.hideLoadingMessage(e):(e=e||this._rootContainer)&&e._isSpinnerVisible&&(i.removeModal(e),delete e._isSpinnerVisible)},showLoadingMessage:function(e,t){this.setSpinnerView(e),o.showLoadingMessage(e,t)},hideLoadingMessage:function(e){(e=e||s.getSpinnerView())&&o.hideLoadingMessage(e),this.setSpinnerView()},showRowLoadingMessage:function(e,t){this.setRoWSpinnerView(e),o.showLoadingMessage(e,t)},hideRowLoadingMessage:function(e){(e=e||s.getRowSpinnerView())&&o.hideLoadingMessage(e),this.setRoWSpinnerView()},setSpinnerView:function(e){this._spinnerView=e},getSpinnerView:function(){return this._spinnerView},setRoWSpinnerView:function(e){this._roWSpinnerView=e},getRowSpinnerView:function(){return this._roWSpinnerView}};return s}),define("DS/ENOProjectMgmtCommonComponents/components/CustomAlert",["UWA/Core","UWA/Class/Listener","DS/Windows/Dialog","DS/Controls/Button","DS/Windows/ImmersiveFrame","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/ProgressSpinner","DS/ENOProjectMgmtModels/Utils/DataUtils","DS/ENOProjectMgmtModels/Models/AppSettings"],function(e,t,i,n,o,s,a,l,r,c,d){"use strict";let h=0,u={init:function(){return this.adjustAlertMessagePosition(),a.setNotificationManager(s),this.listener=new t,this.listener.listenTo(widget,"onResize",this.adjustAlertMessagePosition.bind(this)),this.listener.listenTo(c,{showConfirmDialog:u.confirmDialog,showNotification:u.buildNotification}),s},getNotificationsManagerViewOnScreen:function(){return a},adjustAlertMessagePosition:function(){a.slide({top:0,right:widget.body.offsetWidth/2-120});let e=this.getDialogView();e&&e.setAbsolutePosition({y:1})},buildNotification:function(e,t){let i=d.get("useExternalNotification"),n=l.getAlertManager(),o=u.getLastNotificationData(e);if(!o||!i&&o._data.message!==e.message){let o={sticky:!1,title:e.title,subtitle:e.subtitle,message:e.message,level:t||"success"};n&&n.addNotif(o),!i&&u.disposeNotification(e.hideDelay)}},disposeNotification:function(e){let t=u.getLastNotificationData();t&&!t._fadingTimeout&&setTimeout(function(){let i=t.getDiv(),n=setInterval(function(){i.style.opacity||(i.style.opacity=1),i.style.opacity>0?i.style.opacity-=.1:(clearInterval(n),u.clearNotificationMessages())},e&&e/10||100)},e||3e3)},getLastNotificationData:function(e){if(d.get("useExternalNotification")){let t=widget.alerter&&widget.alerter.getMessages();return l.findObject(t,"textContent",e.message)}let t=u.getNotificationsManagerViewOnScreen();return t._notifications.find(e=>e._data===t._lastNotificationDisplayed)},clearNotificationMessages:function(){let e=u.getNotificationsManagerViewOnScreen();e&&e.removeNotifications("","")},confirmDialog:function(t,n){u.immersiveFrame&&u.close();let s=t.noLabel,a=t.yesLabel,l=t.isReload,r=Array.prototype.slice.call(arguments,1),c=t.yesEventFunc&&t.yesEventFunc.bind(void 0,...r),d=t.noEventFunc&&t.noEventFunc.bind(void 0,n);u.immersiveFrame=new o({}),u.dontResetModel=t.dontResetModel,u.setParentView(t.parentView);let m=u.getDialogView();if(!m||!m.isReload){if(!m){m=new i({immersiveFrame:u.immersiveFrame,identifier:"customAlert_"+h++,title:t.title,content:e.createElement("p",{html:t.message}),minHeight:150,minWidth:500,width:500,modalFlag:!0});let n=u.getParentView();u.immersiveFrame.inject(n&&n.container||widget.body),m.setAbsolutePosition({y:1}),u.setDialogView(m),u._registerEvents()}m.buttons=u.getFooterButtons({noLabel:s,yesLabel:a,noEventFunc:d,yesEventFunc:c}),m.buttons.Apply.getContent().addClassName("wux-ui-state-primary"),m.isReload=l}},_registerEvents:function(){let e=this.getDialogView();e.realClosefunc=e.close,e.close=this.close.bind(this)},getFooterButtons:function(e){return{Discard:new n({domId:"noBtn",label:e.noLabel,onClick:this.handleFooterButtonEvents.bind(this,e.noEventFunc)}),Apply:new n({domId:"yesBtn",label:e.yesLabel,onClick:this.handleFooterButtonEvents.bind(this,e.yesEventFunc)})}},handleFooterButtonEvents:function(e,t){let i=t.dsModel.value;this.dontResetModel||"Apply"!==i||this.getParentView().dispatchEvent("resetModel"),e&&e(),this.close()},close:function(){let e=this.getDialogView();e&&e.realClosefunc(),this.setDialogView(),this.setParentView(),this.immersiveFrame.destroy(),delete this.immersiveFrame,r.hideRowLoadingMessage()},setDialogView:function(e){this._dialogView=e},getDialogView:function(){return this._dialogView},setParentView:function(e){this.parentView=e},getParentView:function(){return this.parentView},showSingleErrorMessageForDataObjects:function(e,t,i){if(t){let n=l.getSpecialCharSepartedStringFromObjects(e)+t+(i?' "'+i+'"':"");u.buildNotification({message:n},"error")}let n=r.getRowSpinnerView();n&&r.hideRowLoadingMessage(n)},displayMessage:function(e){let t={message:e.msg,hideDelay:e.hideDelay};u.buildNotification(t,e.msgType);let i=r.getRowSpinnerView();i&&r.hideRowLoadingMessage(i)}};return u}),define("DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel",["UWA/Core","DS/E6WCommonUI/Models/CloneModel","DS/DocumentManagement/DocumentManagement","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Models/CSRFDataModel","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r){"use strict";let c=/(^|\s)((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)/gi,d=t.extend({_uwaClassName:"ProjectMgmtCloneModel",init:function(t,i){this.saving=!1,this.localRelatedItems={},this._parent.apply(this,arguments);let n=e.clone(i||{},!1).config;if(n){let e=n.hasOwnProperty("context");t.isNew()&&!e&&n.values&&n.values.every(e=>{if(e.isContextField)return this.CONTEXT_ATTR=e.name,!1})}},add:function(t,i,o){let s=i,a=e.clone(o||{},!1),l=a.config,r=l&&l.preValidate,c=this.CONTEXT_ATTR||n.CONTEXT_ATTR;if(!r||this.preProcessValidation.apply(this,arguments)){if(i&&(e.is(i,"array")||i instanceof FileList))s=this._addFile(i,a);else if(!e.is(i,"object")){if(t===c||l.setOnSync){a.refresh=!0,a.rmcType=a.model&&a.model.get("type"),s=this._addModel(t,i,a);let e=this[l.handleOnSyncFunc]||this.handleContextOnSync;return void s.addEventOnce("onSync",e.bind(this,{fieldName:t,contextOptions:a}))}s=this._addModel(t,i,a)}let n=s&&s.length||s instanceof e.Class.Model;a.changed=n,n&&this.setRelatedItemData(t,s,a)}return s},setRelatedItemData:function(e,t,i){let n=this.modificationsPending,o=i.config,s=o.validate,a=!1,l=this.get(e);l||(a=!0,l=this.model.createRelatedDataItems([],{config:o})),o.singleObjectOnly&&l.length&&(l.reset(),l.resetOperationFlags()),l.add(t),a?this.set(e,l,{validate:s,config:o}):(this.validationError=s&&this.validate(this.toJSON(),i),this.validationError&&this.dispatchEvent("onValidationFailure"),this.dispatchEvent("onChange:"+e,[this,t,i])),this.localRelatedItems[e]=l,this.modificationsPending=Boolean(i&&i.changed||n),this.dispatchEvent("onChange:modificationsPending",[this]),this.dispatchEvent("onChange",[this,i])},remove:function(t,i,n){let o=e.clone(n||{},!1),s=o.config,a=this.get(t);if(a&&a.length){let e=a.at(i)||a.get(i);s&&s.singleObjectOnly&&(a.reset(),a.resetOperationFlags()),a.remove(e),this.localRelatedItems[t]=a,this.modificationsPending=!0,this.dispatchEvent("onChange:"+t),this.dispatchEvent("onChange",[this,o]),this.dispatchEvent("onChange:modificationsPending",[this]),this.validationError=s&&s.validate&&this.validate(this.toJSON(),s),this.validationError&&this.dispatchEvent("onValidationFailure")}},set:function(t,i,n){if(i&&i.hasOwnProperty("actualValue"))arguments[1]=i.actualValue,n&&delete n.whisper;else if(e.is(t,"object")){let e=t,i=Object.keys(t);return void(i.length&&i.forEach(t=>{this.set(t,e[t])}))}return this._parent.apply(this,arguments)},_attributesGet:function(e,t){return e?e[t]:this.get(t)},_addFile:function(e,t){let i=[],n=t.config,s=e.length;for(let t=0;t<s;t++){let n=e[t],s={title:n.name,type:n.type,lastModified:n.lastModified,lastModifiedDate:n.lastModifiedDate,image:window.URL.createObjectURL(n),file:n};i.push(o.getObjectForAdding(s.id,{attrs:s,modelConstructor:this.model.getModelConstructorBasedOnType(s.type)}))}return n&&n.singleObjectOnly&&i.length?i[0]:i},_addModel:function(e,t,i){if(!this.validateSelfObject.apply(this,arguments))return;let a=this,l=[],c=i.config,d=i.errObjs||{},h=t.split(","),u=h.length,m=this.get(e);for(let s=0;s<u;s++){let r,u=h[s],g=o.alreadyHasObjectInRelatedData(m,u);if(g){let e=g.displayType||g.objectType;d[e]||(d[e]=[]),d[e].push(g.displayName);continue}i.detailedObject=o.getDetailedObject(u,i.detailedObjects);let p=o.getObjectDataFromDropSearchOrTypeAhead(i),C=p.id,f=p.serviceId;if(f!==n.DRIVE_SOURCE){let o=i.refresh,s=i.doNotCache,l=c.fetchSource;l||f!==n.XPLAN_SOURCE||(l="RiskContextInfo");let d=l&&(c.sourceType||i.sourceType)+"CreateAccess";c.fields&&(d+=","+c.fields),r={refresh:o,doNotCache:s,rmcType:i.rmcType,fields:l&&d,include:c.include,fetchSource:l||"ObjectInfo",onComplete:c.customButtons&&function(){a.dispatchEvent("onChange",[a,i])},onFailure:function(){a.rollbackChanges(e,t,i)}}}let D=o.getObjectForAdding(C,{attrs:p,fetchOptions:r,modelConstructor:this.model.getModelConstructorBasedOnType(p.type)});l.push(D)}i.errObjs?i.errObjs=d:Object.keys(d).length&&s.showSingleErrorMessageForDataObjects(d,r.OBJECT_ALREADY_ASSOCIATED,this.get("title")||r.NEW_OBJECT);let g=l.length;return g?c&&c.singleObjectOnly&&g?l[0]:l:void 0},uploadFiles:function(e,t){for(let i=e.length-1;i>=0;i--){e[i].get("file")&&this.uploadFile(e[i],t)}},uploadFile:function(t,n){let o=this,s=e.clone(n||{},!1),c=t.get("title"),d=t.get("file"),h=s.callback,u=s.onFailure,m=c.lastIndexOf(".");if(-1!==m){let e=c.substring(m).toLowerCase();s.isImage=-1!==this.imageExtensions.indexOf(e)}if(!this.id&&!this.isNew)throw new Error(r.INVALID_OBJECT_CANNOT_UPLOAD_FILE);this._fileUploadCount=this._fileUploadCount?this._fileUploadCount+1:1,s.onComplete=function(e){o._fileUploadCount--;let i={},a=e;if(e&&e.data&&(a=e.data[0],i.id=a.id,i.hasfiles="TRUE",i.type=a.type,i.physicalId=a.id),s.isImage&&!t.FileName)i.image=window.URL.createObjectURL(d);else{let e=a.dataelements;e&&(i.image=e.image||e.typeicon)}t.set(i),h&&h(o,n)},s.onFailure=function(e,i){o._fileUploadCount--,o.remove(s.fieldName,t.id,n),u&&u(e,i,n)};let g={fileInfo:{file:d}},p={csrf:l.prototype.getCSRF(),securityContext:a.get("collabspace"),tenant:a.get("tenant"),tenantUrl:a.get("3DSpace")};if(this.isNew){let e=this.model.getCollabSpace();e&&(g.collabspace=e)}else p.deriveCollabspace=!0,g.relInfo={parentDirection:"From",parentId:this.id,parentRelName:s.parentRelName};e.merge(s,p),i.createDocument(g,s)},isUploadingFiles:function(){return Boolean(this._fileUploadCount)},imageExtensions:[".gif",".jpg",".png",".gif",".jpeg",".3dxml",".cgr",".pdf",".bpm",".psd",".ai"],dataForRendering:function(){let e=this._parent.apply(this,arguments),t=this.get("modified"),i=this.get("originated");return t&&(e.modified=o.getIntlDateFormat(t)),i&&(e.originated=o.getIntlDateFormat(i)),e},cancel:function(){if(this.saving=!1,this.localAttributes={},this.localRelatedItems={},this.modificationsPending){this.modificationsPending=!1,this.dispatchEvent("onChange:modificationsPending",[this]),this.dispatchEvent("onChange",[this]);let i=Object.keys(this.model._attributes);var t=i.length;for(let n=0;n<t;n++){let t=i[n],o=this.model.get(t);o instanceof e.Class.Collection&&this.resetRelatedObjectCollection(o),this.dispatchEvent("onChange:"+t)}}this.localAttributes={},this.localRelatedItems={}},resetRelatedObjectCollection:function(e){let t=e.relatedDataToAdd,i=e.relatedDataToDelete,n=t.length;for(let i=0;i<n;i++)e.remove(t[i],{silent:!0});let o=i.length;for(let t=0;t<o;t++)e.add(i[t],{silent:!0});e.resetOperationFlags()},clearLocalAttributes:function(t){t&&!e.is(t,"array")&&(t=[t]),t&&t.length&&t.forEach(e=>{delete this.localAttributes[e]})},validate:function(e,t){var i=!0,n={fields:[],messages:{}};let o=this._options.config&&this._options.config.columnInfo;for(let s in o){let a=o[s];if(a&&(a.validate||a.required)){let o=a.name,s=this._attributesGet(e,o),l=a.customValidate?"customValidate":a.type,r=!1;switch(l){case"customValidate":r=this[a.customValidate](e,n,a);break;case"text":case"textarea":r=this.isValidString(s);break;case"startStop":let i=t.name===a.startDateAttribute||t.name===a.endDateAttribute?t:a;r=this.validateStartEndDates(e,n,i);break;case"number":r=this.isvalidNumber(s);break;case"date":r=this.isValidDate(e,n,o);break;case"object":r=this.validateObjectField(e,n,a);break;default:r=!1}r||"text"!==l&&"textarea"!==l&&"number"!==l||n.fields.push(o),i=i&&r}}return this.dispatchEvent("disableSaveButton",!i),i?this.dispatchEvent("onValidationSuccess")&&void 0:n},validateObjectField:function(e,t,i){let n,o=!0,s=i.name,a=i.required,l=i.singleObjectOnly;if(e.hasOwnProperty(s)){let i=this._attributesGet(e,s);i&&(n=l?1===i.length:i.length),a&&!n&&(o=!1,t.fields.push(s))}return o},isValidString:function(t){return Boolean(e.is(t,"string")&&t&&t.trim().length)},isValidDate:function(e,t,i){let n=!0;return this.getDateFieldValue(i,e)||(n=!1,t.fields.push(i)),n},isvalidNumber:function(e){let t=!0;return e&&isNaN(e)&&(t=!1),t},isvalidURL:function(e,t,i){let n=i.name,o=this._attributesGet(e,n),s=this.isValidString(o)&&!o.contains(" ")&&o.match(c);return!s&&t.fields.push(n),s},handleAttrsUpdateForActions:function(t,i,o){switch(e.extend(o||{},{invokeSaveEvent:!0}),t){case n.STATE_ATTR:this.set(t,i),this.dispatchEvent("submitSave",[o]);break;case n.ASSIGNEE_ATTR:this.handleAssigneesUpdateOnDrop(t,i,o);break;case n.ASSIGN_TO_SELF:case n.REMOVE_ASSIGN_TO_SELF:this.handleAssigneeUpdate(n.ASSIGN_TO_SELF===t?"add":"remove",i,o);break;case n.REMOVE_ASSIGNEE:this.handleRemoveAssignees(i,o)}},updateDetailsDisplay:function(e){e&&(this.validationError=this.validate(this.toJSON())),this.dispatchEvent("resetDetailsDisplay")},validateStartEndDates:function(t,i,n){let o=!0,s=e.clone(n||{},!1),a=s.startDateAttribute,l=s.endDateAttribute,r=this._attributesGet(t,a),c=this._attributesGet(t,l);return r=r&&new Date(r.getTime&&r.getTime()||r).setHours(0,0,0,0),c=c&&new Date(c.getTime&&c.getTime()||c).setHours(0,0,0,0),r&&c&&r>c&&(o=!1,i.fields.push(s.name)),o},getDateFieldValue:function(t,i){let n=this._attributesGet(i,t);return n&&e.is(n.actualValue,"string")&&(n=n.actualValue),n},getContextModel:function(){let e=this.get(n.CONTEXT_ATTR);return e&&e.length&&e.at(0)},validateSelfObject:function(){let e=!0,t=o.removeBracketLongURI(arguments[1]);return this.id===t&&(s.buildNotification({message:r.replace(r.SAME_OBJECT_ERROR,{title:this.get("title")})},"error"),e=!1),e},preProcessValidation:function(t,i,n){let a,l,c=this,d=!0,h=e.clone(n||{},!1).config,u=h&&h.preValidate;return u&&u.length&&u.forEach(e=>{d&&(a=e.nlsMsg,(l=c.get(e.name))&&l.length&&l._alreadyHasObjectInRelatedData(o.removeBracketLongURI(i))&&(a&&s.buildNotification({message:r.replace(a,{fieldLabel:e.label})},"error"),d=!1))}),d},dispatchEventForAssignees:function(e){let t=e&&e.invokeSaveEvent,i=this.hasEvent("submitSave");t&&i&&this.dispatchEvent("submitSave",[e])},handleAssigneeUpdate:function(t,i,s){let l=this.MembersConfig.columnInfo.assignees;if(!l)return;let r=a.get("user");if("add"===t){let t=this,a=function(e){t.add(n.ASSIGNEE_ATTR,e,{config:l}),t.dispatchEventForAssignees(s)};!i||i instanceof e.Class.Model||(i="");let c=i||o.getPersonObjectInfo(r);c.getCESStamp()?a(c):c.addEventOnce("onSync",a.bind(this,c))}else if("remove"===t){let e=this.get("assignees")._alreadyHasObjectInRelatedData(r);this.remove(n.ASSIGNEE_ATTR,e,{config:l}),this.dispatchEventForAssignees(s)}},handleAssigneesUpdateOnDrop:function(e,t,i){this.setRelatedItemData(e,t,{config:this.MembersConfig.columnInfo.assignees}),this.hasEvent("submitSave")&&this.dispatchEvent("submitSave",[i])},handleRemoveAssignees:function(e,t){if(e)this.remove(n.ASSIGNEE_ATTR,e,{config:this.MembersConfig.columnInfo.assignees});else{this.get(n.ASSIGNEE_ATTR).removeAll()}this.hasEvent("submitSave")&&this.dispatchEvent("submitSave",[t])},handleContextOnSync:Function.prototype});return Object.defineProperty(d.prototype,"title",{get:function(){return this.get("title")||this.get("name")}}),Object.defineProperty(d.prototype,"isNew",{get:function(){return this.model.isNew()}}),d}),define("DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtBaseCloneModel",["DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel","DS/ENOProjectMgmtCommonComponents/utils/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n){"use strict";return t.extend({_uwaClassName:"ProjectMgmtBaseCloneModel",validate:function(e){this.dispatchEvent("disableSaveButton",!1)},handleContextOnSync:function(t,i){let o=t.fieldName,s=t.contextOptions,a=this.getNLSMessageForCreateError(i);a?e.buildNotification({title:this.isNew?n.CANNOT_CREATE:n.CHANGE_CONTEXT,message:a,hideDelay:3500},"error"):(s.changed=Boolean(!a),this.setRelatedItemData(o,i,s))},getNLSMessageForCreateError:function(e){let t,o=this.isNew,s=e.get("project");if(e.isXPlanObject()&&!s)t=n.COLLAB_SPACE_SELECT_ERROR;else if(!e.canCreate()){switch(e.type){case i.PROJECT:t=o?n.NO_DPMPROJECT_CREATE_ACCESS:n.NO_DPMPROJECT_CHANGE_CONTEXT_ACCESS;break;case i.XPROJECT:t=o?n.NO_XPROJECT_CREATE_ACCESS:n.NO_XPROJECT_CONTEXT_CHANGE_ACCESS;break;default:t=o?n.NO_CREATE_ACCESS_TT_MSG:n.NO_CHANGE_CONTEXT_ACCESS_TT_MSG}}return t}})}),define("DS/ENOProjectMgmtCommonComponents/components/PopupCommon",["UWA/Core","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/Utilities/Dom","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a){"use strict";let l=e.Class.View.extend({_uwaClassName:"PopupCommon",init:function(t){let i=e.clone(t||{},!1),n=this._getDefaultAttributes();e.extend(n,i),this.options=n,this.customHeight=i.height,this._parent.apply(this,arguments)},_getDefaultAttributes:function(){return this.immersiveFrame=new t({}),{immersiveFrame:this.immersiveFrame,minHeight:200,minWidth:500,modalFlag:!0,resizableFlag:!0,container:widget.body,height:widget.body.clientHeight,title:a.CREATE,checkboxInfos:{label:a.REPEAT,checkFlag:!1}}},handleFooterButtonEvents:function(e){let t=e.dsModel.value,i=this.getContentView();"Save"===t?(this.isSaveInvoked=!0,i&&i.save()):this.close()},close:function(t){let i=e.clone(t||{},!1),n=this.getContentView();if(this.isSaveInvoked&&this.getRepeatCheckboxValue())n&&n.render(n.options);else{n&&(n.destroy(),n.stopListening(),delete this._dialogView.contentView);let e=this.getDialogView();this.beforeCloseCallBack&&this.beforeCloseCallBack(),e.realClosefunc(),this.destroy()}delete this.isSaveInvoked,!i.dontClearAlertMessages&&s.clearNotificationMessages()},getRepeatCheckboxValue:function(){let e=this.options.checkboxInfos;return Boolean(e&&e.checkFlag)},getContentView:function(){return this.getDialogView().contentView},_getDefaultFooterButtons:function(t){if(t&&t.doNotshowFooterButtons)return;let i={Save:new n({domId:"saveBtn",label:t&&t.saveButtonLabel||a.CREATE,emphasize:"primary",onClick:this.handleFooterButtonEvents.bind(this),disabled:!0}),Cancel:new n({domId:"cancelBtn",label:a.CANCEL,emphasize:"secondary",onClick:this.handleFooterButtonEvents.bind(this)})},o=this.options.contentView;return t.additionalFooterButtons&&t.additionalFooterButtons.forEach(t=>{let s=t.type,a=t.label,l=t.onClick,r=t.disabled;e.is(l,"string")&&(l=o[l]);let c=new n({domId:s.toLowerCase()+"Btn",label:a,emphasize:"info",disabled:r,onClick:l.bind(o)}),d={};d[s]=c,e.extend(i,d)}),i},createDialog:function(){let e=this.options,t=e.contentView;this.immersiveFrame=e.immersiveFrame;let n=new i({title:e.title,height:e.height,immersiveFrame:this.immersiveFrame,width:e.minWidth,minWidth:e.minWidth,minHeight:e.minHeight,modalFlag:e.modalFlag,onContextualEvent:Function.prototype,activateButtonsIfActionPerformed:!1,resizableFlag:e.resizableFlag,content:e.content||t.render(e),buttons:e.buttons||this._getDefaultFooterButtons(e),checkboxInfos:!e.doNotRepeat&&e.checkboxInfos});return this.immersiveFrame.inject(e.container),n.contentView=t,this.setDialogView(n),this._registerEvents(),this.beforeCloseCallBack=e.beforeCloseCallBack,this},_adjustHeight:function(e){e.height=this.customHeight||widget.body.clientHeight},_registerEvents:function(){let e=this,t=this.getDialogView();t.realClosefunc=t.close,t.close=this.close.bind(this);let i=this.getContentView();i&&i.listenTo(widget,"onResize",function(){let i=t.getAbsolutePosition();t.setAbsolutePosition({x:i.x,y:this.customHeight?i.y:1}),e._adjustHeight(t)})},setParentView:function(e){this.parentView=e},getParentView:function(){return this.parentView},setDialogView:function(e){this._dialogView=e},getDialogView:function(){return this._dialogView},destroy:function(){this.parentView&&(this.parentView.destroy(),delete this.parentView),this._dialogView&&(this._dialogView.destroy(),delete this._dialogView),this.immersiveFrame&&(this.immersiveFrame.destroy(),delete this.immersiveFrame),this._parent()}}),r=i.prototype.handleEvents;return i.prototype.handleEvents=function(){o.addEventOnElement(this,this.elements.container,"keyup",function(e){13===e.keyCode&&(e.actionPerformed=!0)}),r.apply(this,arguments)},l}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtObjectCardView",["UWA/Core","DS/E6WCommonUI/Views/ObjectCardView","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s){"use strict";return t.extend({setup:function(){let t=this._config;if(t.addLinks){let i=t.customButtons||[];i.push({id:"links",iconClass:"fonticon-link-add",toolTip:s.ADD_LINK,callback:this.handleLinksView}),e.extend(t,{ignoreOpenWith:!0,customButtons:i})}"person"===t.type&&e.extend(t,{ignoreOpenWith:!0}),this._parent.apply(this,arguments)},render:function(){let e=this._parent.apply(this,arguments);if(this._config.addLinks){let e=this.getElement("#links");e&&e.toggleClassName("hidden",!this.model.isNew&&!this.model.model.canModify())}return e},handleLinksView:function(e){let t=this._config,i=t.name,o=this.model,s=e&&e.model;s&&s.set({modifyAccess:"TRUE"},{parse:!0}),n.loadLinksView({model:s,collection:o.get(i),callback:function(e){o.add(i,e,{config:t})}})},setDropdownMenu:function(e){e&&(e.dropdown=this.dropdownMenu)},getDropDownMenuItems:function(t,o){let s=e.clone(o||{},!1),a=s.model,l=a&&a.type,r=i.BOOKMARK_URL===l;if(!this._config.ignoreOpenWith&&!r){let e=this.options.homeView,t=e&&e._viewConfig;this.setDropdownMenu(e),n.addOpenMenuItem(this.dropdownMenu,a,t)}let c=this._parent(t,s);if(c&&c.length)if(r){if(this.model.model&&this.model.model.canModify()){let t=e.clone(o||{},!1);e.extend(t,{handler:this.handleLinksView.bind(this,t)}),c.splice(0,0,n.getLinkEditButton(t))}let t=a.get("linkURL");t&&(t.toLowerCase().startsWith("http://")||t.toLowerCase().startsWith("https://")||(t="http://"+t),c.splice(0,0,n.getWebAppGoToLinkMenuItem(t)))}else{let e=n.getRelationsButton(o);e&&c.push(e)}return this.addHiddenClassNamesToMenuItems(c,o),c},addHiddenClassNamesToMenuItems:function(t,i){let n=this,o=e.clone(i||{},!1),s=o.model,a=o.options&&o.options.config;t.forEach(function(e){e.className=s||(n.model.isNew||n.model.modificationsPending)&&"propertiesButton"!==e.name?e.className||"":"disabled",e.className+=e.className&&e.className.contains("disabled")&&"propertiesButton"!==e.name||"remove-button"===e.name&&!a.showRemoveMenuItem&&a.singleObjectOnly?" hidden":""})},processDropData:function(){this._options.errObjs={},this._parent.apply(this,arguments);let e=this._options.errObjs;Object.keys(e).length&&o.showSingleErrorMessageForDataObjects(e,s.OBJECT_ALREADY_ASSOCIATED,this.model.get("title")||s.NEW_OBJECT),delete this._options.errObjs}})}),define("DS/ENOProjectMgmtCommonComponents/config/CreateFromProfileConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtModels/Collections/SearchObjects","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtObjectCardView","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o){"use strict";let s=e.extend({_uwaClassName:"CreateFromProfileConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"basic",values:[{name:"profile",readWrite:"true",attributeToDisplay:"title",imageAttribute:"image",singleObjectOnly:!0,label:o.PROFILE,type:"object",required:!0,setOnSync:!0,handleOnSyncFunc:"handleOnProfileSync",sourceType:"profile",fetchSource:"riskprofiles",fields:"hasActiveTemplate",typeAheadCallback:i.typeAheadCallback,customView:n,excludeSearchTypes:{"3dspace":["Person","Security Context","Business Role"],swym:["pno:Person"]},linkCallback:t.launchProperties,placeHolder:o.SEARCH_PLACEHOLDER_TEXT,validate:!0,validateSameTenant:!0},{name:"context",readWrite:"true",attributeToDisplay:"title",imageAttribute:"image",singleObjectOnly:!0,label:o.CONTEXT,type:"object",required:!0,typeAheadCallback:i.typeAheadCallback,customView:n,linkCallback:t.launchProperties,placeHolder:o.CONTEXT_SEARCH_TEXT,validate:!0,fields:"readAccess",include:"configuration",validateSameTenant:!0,fetchSource:"RiskContextInfo",sourceType:"risk",excludeSearchTypes:{"3dspace":["Experiment","Project Baseline"],"3dplan":["dsplan:ProjectPlanningTemplate"]},additionalQuery:{"3dspace":' AND NOT [ds6w:status]:"Project Space Hold Cancel.Hold" AND NOT [ds6w:status]:"Project Space Hold Cancel.Cancel"'}}]});return s._instance=s._instance||new s,s._instance}),define("DS/ENOProjectMgmtCommonComponents/config/MembersConfig",["DS/ENOProjectMgmtModels/Collections/Persons","DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtObjectCardView","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o){"use strict";return t.extend({_uwaClassName:"MembersConfig",columnInfo:{},type:"members",setup:function(){this.setValues(),this.addAdditionalValues(),this.setColumnInfo()},setValues:function(){this.values=[{readWrite:"true",name:"assignees",label:o.ASSIGNEES,attributeToDisplay:"fullName",imageAttribute:"image",type:"person",singleObjectOnly:!1,typeAheadCallback:e.typeAheadCallback,customView:i,linkCallback:n.launchProperties,placeHolder:o.SEARCH_PLACEHOLDER_TEXT,excludePendingUser:!0,validateSameTenant:!0,addMembers:!0},{readWrite:"true",name:"ownerInfo",label:o.OWNER,attributeToDisplay:"fullName",imageAttribute:"image",type:"person",singleObjectOnly:!0,typeAheadCallback:e.typeAheadCallback,customView:i,linkCallback:n.launchProperties,placeHolder:o.SEARCH_PLACEHOLDER_TEXT,excludePendingUser:!0,validateSameTenant:!0}]},getAssigneesCustomButtons:function(){return t.assigneesCustomButtons}})}),define("DS/ENOProjectMgmtCommonComponents/config/AppConfig",["UWA/Core","UWA/Class","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/utils/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s){"use strict";return t.extend({_uwaClassName:"AppConfig",Highcharts:void 0,completedPreference:{values:[{label:s.NONE,value:"none",isDefault:!0},{label:s.LAST_TEN_DAYS,value:"10"},{label:s.LAST_THIRTY_DAYS,value:"30"},{label:s.LAST_SIXTY_DAYS,value:"60"},{label:s.ALL,value:"all"}],getDefault:function(){for(let e in this.values)if(this.values[e].isDefault)return this.values[e].value}},gridDropDownItems:{items:[{type:"PushItem",title:s.EDIT,icon:"pencil",name:"edit"},{type:"PushItem",title:s.DUPLICATE,icon:"duplicate",name:"duplicate"},{type:"PushItem",title:s.ASSIGN_TO_SELF,icon:"user-ok",name:"assignToSelf"},{type:"PushItem",title:s.REMOVE_ASSIGN_TO_SELF,icon:"user-delete",name:"removeSelfassign"},{type:"SeparatorItem"},{type:"PushItem",title:s.RELATIONS_LABEL,icon:"object-related",name:"relations"},{type:"SeparatorItem"},{type:"PushItem",title:s.DELETE,icon:"trash",name:"delete"},{type:"PushItem",title:s.REMOVE,icon:"user-delete",name:"removeAssignee"}],dividerItem:{type:"SeparatorItem"},maturityStateMap:{Create:s.SAVE_AS_DRAFT,Assign:s.START,Active:s.BEGIN_WORK,Review:s.APPROVE,Complete:s.MARK_AS_COMPLETED,HelpInfo:{"Profile Risk":{Active:s.ACTIVE,Inactive:s.INACTIVE}}},getMaturityStateConfig:function(e,t){let i=e.value,n=i.toLowerCase()+" "+(t?"promote":"demote");return{type:"PushItem",title:e.helpinfo&&this.maturityStateMap.HelpInfo[e.helpinfo]?this.maturityStateMap.HelpInfo[e.helpinfo][i]:this.maturityStateMap[i],icon:"status-change object-maturity "+n,name:i,groupName:o.STATE_ATTR}},getMenuItemsConfigForModel:function(t,i,o){let s=e.clone(this.items,!1);i&&(s=s.filter(e=>i.find(t=>t===e.name)));let a,l=[];if(o&&o.length){let e=t.state,i=n.findIndex(o,"value",e);o.forEach((e,t)=>{i!==t-1&&i!==t+1||(a=this.getMaturityStateConfig(e,t>i))&&l.push(a)})}return l.length&&s.splice(3,0,...l),s},getItems:function(t,i){let a=[],l=e.clone(i||{},!1),r=l.callback,c=l.assignModel,d=l.isSelectedNode,h=l.isAssignColumn,u=t.model,m=u.getActionsAttrsAccessMap(),g=m.canModify,p=m.canDelete,C=m.canToConnect,f=m.isComplete,D=n.isSelfAssigned(u),w=l.dropDownItemList,E=l.maturityStates,M=n.isLoggedInUserSelected(c);return this.getMenuItemsConfigForModel(u,w,E).forEach(t=>{let i,n;switch(delete t.className,t.name){case o.EDIT:i=!(n=g&&!d&&!f);break;case o.ASSIGN_TO_SELF:n=g&&C&&!D;break;case o.REMOVE_ASSIGN_TO_SELF:n=g&&(h?D&&M:D);break;case o.DELETE:i=!(n=p);break;case o.REMOVE_ASSIGNEE:(n=h&&g&&!M)&&(t.title=c?s.REMOVE+' "'+c.getFullName()+'"':s.REMOVE_ALL);break;default:n=!0,i=!1}if(n||i){t.state=i?"disabled":"";let n=e.clone(t,!1);n.action={callback:r,context:t},a.push(n)}}),a}},defaultSkeletonOptions:{rightContainerContent:void 0,centerContainerContent:void 0,leftContainerCollapsedFlag:!0,rightContainerCollapsedFlag:!0,leftContainerWidth:0,leftContainerMinWidth:0,leftContainerMaxWidth:0,rightContainerWidth:400,rightContainerMinWidth:200,rightContainerMaxWidth:500,navigationContainerVisibleFlag:!1,idCardContainerVisibleFlag:!1,statusContainerVisibleFlag:!1,identifier:"SkeletonLayout_projectMgmentHomeView"},ChartsColor:{WHITE_COLOR:"#FFFFFF",BLUE4_COLOR:"#005686",BLACK_COLOR:"#000000",GREY0_COLOR:"#F1F1F1",GREEN0_COLOR:"#6FBC4B",YELLOW0_COLOR:"#FEE000",RED1_COLOR:"#CC092F",BLUE2_COLOR:"#002596",BLUE3_COLOR:"#4EA8B7",ORANGE0_COLOR:"#FF8A2E"},ColorPalette:[{color:"#E2D5CC",UsedFlag:!1},{color:"#45299E",UsedFlag:!1},{color:"#0067D7",UsedFlag:!1},{color:"#D71F66",UsedFlag:!1},{color:"#C25400",UsedFlag:!1},{color:"#7F7F7F",UsedFlag:!1},{color:"#8DDEE4",UsedFlag:!1},{color:"#4EA8B7",UsedFlag:!1},{color:"#127277",UsedFlag:!1},{color:"#009DDB",UsedFlag:!1},{color:"#ADADAD",UsedFlag:!1},{color:"#9B2C98",UsedFlag:!1},{color:"#00AA86",UsedFlag:!1},{color:"#6D2815",UsedFlag:!1},{color:"#F564A3",UsedFlag:!1},{color:"#000000",UsedFlag:!1},{color:"#4D62BA",UsedFlag:!1},{color:"#007A4C",UsedFlag:!1},{color:"#70036b",UsedFlag:!1},{color:"#C6C68B",UsedFlag:!1},{color:"#6FBC4B",UsedFlag:!1},{color:"#FEE000",UsedFlag:!1},{color:"#CC092F",UsedFlag:!1},{color:"#002596",UsedFlag:!1},{color:"#FF8A2E",UsedFlag:!1}]})}),define("DS/ENOProjectMgmtCommonComponents/components/CustomDataGridView",["UWA/Core","UWA/Class","UWA/Drivers/Alone","DS/Utilities/Dom","DS/Windows/ImmersiveFrame","DS/DataGridView/DataGridView","DS/DataGridView/RowModelClientSide","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/config/CustomGridDefaultConfig","DS/ENOProjectMgmtCommonComponents/config/DefaultGridConfig"],function(e,t,i,n,o,s,a,l,r,c){"use strict";return s.extend({_uwaClassName:"CustomDataGridView",options:{},init:function(t){let i=e.clone(t||{},!1);this.config=i.config,this.options=i.gridOptions,this.container=i.container,this.gridConfig=this.config.gridConfig||c,this._parent({treeDocument:i.treeDocument,columns:this.config.values,defaultColumnDef:this.gridConfig.defaultColumnDef,showRowIndexFlag:this.gridConfig.showRowIndexFlag,showAlternateBackgroundFlag:this.gridConfig.showAlternateBackgroundFlag,showSelectionCheckBoxesFlag:this.gridConfig.showSelectionCheckBoxesFlag,rowSelection:this.gridConfig.rowSelection,cellPreselectionFeedback:this.gridConfig.cellPreselectionFeedback,cellSelection:this.gridConfig.cellSelection,selectionStyle:this.gridConfig.selectionStyle,cellActivationFeedback:this.gridConfig.cellActivationFeedback,showModelChangesFlag:this.gridConfig.showModelChangesFlag,showOutlineFlag:this.gridConfig.showOutlineFlag,identifier:this.gridConfig.identifier||"ENOProjectMgmtCustomDataGridId",cellDragEnabledFlag:this.gridConfig.cellDragEnabledFlag,focusNextEditableCellOnTabFlag:this.gridConfig.focusNextEditableCellOnTabFlag,layoutOptions:this.gridConfig.layoutOptions,selectionBehavior:this.gridConfig.selectionBehavior,showBackgroundFlag:this.gridConfig.showBackgroundFlag,columnDragEnabledFlag:this.gridConfig.columnDragEnabledFlag,showRowHeaderBackgroundFlag:this.gridConfig.showRowHeaderBackgroundFlag,virtuallyLoadAllModelItems:this.gridConfig.virtuallyLoadAllModelItems,showContextualMenuColumnFlag:this.gridConfig.showContextualMenuColumnFlag}),this.handleCustomDataGridViewContent(),this.immersiveFrame=new o,this.immersiveFrame.setContentInBackgroundLayer(this.getContent()),this.immersiveFrame.reactToPointerEventsFlag=!1,this.immersiveFrame.inject(this.container)},handleCustomDataGridViewContent:function(){let t=this;if(this.config){if(this.config.getCellTooltip&&(this.getCellTooltip=this.config.getCellTooltip),this.config.registerReusableCellContent){let i=this.config.registerReusableCellContent;e.is(i,"array")||(i=[i]),i.forEach(function(e){t.registerReusableCellContent(e)})}if(this.config.toolbarConfig){this.toolbar=i.createElement("div"),this.container.appendChild(this.toolbar),this.toolbar.className="divToolbar";let e=this.setToolbar(JSON.stringify(this.config.toolbarConfig));e.options=this.options,this.toolbar.appendChild(e.getContent())}}this.handleGridViewOptions(),this.initializeLazyLoadingEvents(),this.initializeDragAndDropEvents(),this.registerCustomViews(this.gridConfig.customViews?this.gridConfig:r)},initializeDragAndDropEvents:function(){this.onDropCell=this.handleCellDrop.bind(this),this.onDragStartCell=this.handleCellDrag.bind(this)},handleGridViewOptions:function(){let t=e.clone(this.options||{},!1);t.top&&(this.getContent().style.top=t.top),t.placeholder&&(this.placeholder=t.placeholder),t.onSortChange&&(this.onSortChange=t.onSortChange),t.lazyLoadingCallBack&&(this.lazyLoadingCallBack=t.lazyLoadingCallBack),t.onContextualEvent&&(this.onContextualEvent=t.onContextualEvent),this.gridConfig.sortModel&&(this.sortModel=this.gridConfig.sortModel),this.gridConfig.statusBarOptions&&this.buildStatusBar(this.gridConfig.statusBarOptions),t.edit&&(this.getContent().style.top="40px")},initializeLazyLoadingEvents:function(){let e=this,t=this.lazyLoadingCallBack;if(t){let i=this._getScroller(),o=function(){t(e.getLastRenderedNodeModels())};this.initializeEvents(o),n.onNodeRendered(i.getContent(),o)}},initializeEvents:function(e){let t=this,i=this._getScroller(),n=function(){t.clearDropdown(),e&&e.apply(t,arguments)};i.onScrollEnd(function(){this.getPosition().y>-1&&n.apply(this,arguments)}),this.getTreeDocument().getModelEvents().subscribe({event:"PRE_EXPAND_DONE"},n),this.addEventListener("sortModelChange",n),this._onEndResize(e),widget.addEvent("onResize",this.clearDropdown)},getLastRenderedNodeModels:function(e){let t,i=[],n=this.getRowModel();if(n){let o=this.layout.getMinMaxVisibleRowIDs();for(let s=o.minRowID;s<=o.maxRowID;s++){let o=(t=n.getVisibleNodeModel(s))&&t.model;(e||o&&!o.cached)&&(t.model.cached=!0,i.push(t.model))}}return i},getViewByRowID:function(e){let t=this.layout.getDisplayedColumnsIndexes(),i=this.layout.getCellIDFromCoordinates({rowID:e,columnID:t.length&&t[0]||0}),n=this._getViewAt(i);return n&&n.elements.container.parentElement},getGridStatusBar:function(){return this.elements.statusBar},getGridStatusBarContainer:function(){let e=this.getGridStatusBar();return e&&e.elements.container},registerCustomViews:function(e){let t=this,i=e.customViews,n=widget.getValue(this.identifier)||this.getGridDefaultViews(i);this.subscribeOnceToAllCellsRendered(function(){let e=l.findObject(n,"isDefault",!0),i=t.getCustomViewsManager();i.collectionView.rowGroupingEnabledFlag=!1,i.onCustomViewsSave=t.handleCustomViewSave.bind(t),e&&i.setCustomViews(n,e.identifier,!0),widget.setValue(t.identifier,n),t._visibleColumnsNames=t.getVisibleOrderedColumnsDataIndexes()})},getGridDefaultViews:function(t){let i={identifier:"Default View"};return t&&[i].concat(t)||[e.extend(i,{isDefault:!0})]},handleCustomViewSave:function(t,i){t.find(t=>{t.identifier===i?e.extend(t,{isDefault:!0,layoutDensity:t.layoutDensity||"comfortable"}):delete t.isDefault}),widget.setValue(this.identifier,t);let n=this,o=this.getVisibleOrderedColumnsDataIndexes(),s=o.filter(function(e){return-1===n._visibleColumnsNames.indexOf(e)});this._visibleColumnsNames=o;let a=s.length;a&&this.lazyLoadingCallBack&&this.lazyLoadingCallBack&&this.lazyLoadingCallBack(n.getLastRenderedNodeModels(a),s)},handleCellDrag:function(t,i){let n,o,s=i.nodeModel.options.data,a=s&&s.model;if(!a)return;let r=this.getColumnDataIndex(i);if("tree"===r)o=this.getSelectedNodesTransferObjects()||a.getTransferObject();else{let i=this.getDataIdFromEvent(t),n=a.get(r);if(n&&n instanceof e.Class.Collection){let e=i&&n.get(i);if(e){let i=this.getTarget(t),n=i.getBoundingClientRect(),s=t.clientX-n.left,a=t.clientY-n.top;t.dataTransfer.setDragImage(i,s,a),o=e.getTransferObject()}else o=a.getTransferObjectsForRelatedData(r)}}(n=o&&JSON.stringify(o))&&(t.dataTransfer.effectAllowed="copy",t.dataTransfer.setData(l.getDragDataKey(),n),t.dataTransfer.setData("text",n))},handleCellDrop:function(e,t){let i=t.nodeModel.options.data;if(!(i&&i.model))return;let n=t.nodeModel,o=this.getColumnDataIndex(t),s=this.getViewByRowID(t.rowID),a=l.getDataTransferJSON(e.dataTransfer);a&&this.dispatchEvent("onDrop:"+o,[a,o,n,s])},getSelectedNodesTransferObjects:function(){let e,t=this.getTreeDocument().getSelectedNodes();return t&&t.length&&t.forEach(t=>{e=t.options.data.model.getTransferObject(e)}),e},getColumnInfo:function(e){let t;switch(typeof e){case"string":case"number":t=this._getXSOElementFromCellID(e);break;case"object":t=(e.cellView&&e.cellView.collectionView||this).columns[e.columnID]}return t},getColumnDataIndex:function(e){let t=this.getColumnInfo(e);return t&&(t.dataIndex||t.columnDataIndex)},getSelectedColumnInfo:function(){return this._preselectedCellStableID},getTarget:function(e){return e&&e.target},getDataIdFromEvent:function(e){let t=this.getTarget(e);return t&&t.getAttribute&&t.getAttribute("data-id")},removeSelection:function(e){e&&e.isSelected()&&(this.getTreeDocument().getXSO().remove(e),e._isSelected=!1)},setPreselectedCell:function(e){return this._preselectedCellStableID=this._getXSOElementFromCellID(e),this._parent.apply(this,arguments)},cellShouldBeSelected:function(e){let t=event.target,i=this.getColumnInfo(e),n=i.columnDataIndex,o=i.nodeModel;switch(this.removeSelection(o),n){case"ContextualMenuColumn":return!1;case"state":if(-1!==i.rowID&&t&&!t.hasAttribute("disabled")&&t.getAttribute("has-badge"))return this.dispatchEvent("invokeMaturityUpdate",o),!1}return this._parent.apply(this,arguments)},getRowModel:function(){return this._rowModel},_applySortModel:function(){let e=this._parent,t=!1;if(this.onSortChange){let i=this.getSelectedColumnInfo(),n=i&&i.columnDataIndex;if(n&&"rowHeader"!==n){let i=this.treeDocument.getNonCachedModels(n);(t=i.length)&&this.onSortChange(i,n,e.bind(this,arguments))}}!t&&e.apply(this,arguments)},getVisibleOrderedColumnsDataIndexes:function(){let e=this.layout.getVisibleOrderedLeafColumns();return e&&l.getAttributeValues(e,"dataIndex")},clearDropdown:function(){let t=e.extendElement(window.document).getElement(".wux-menu");t&&t.destroy()},destroy:function(){this.clearDropdown(),this.toolbar&&(this.toolbar.destroy(),delete this.toolbar),this.immersiveFrame&&(this.immersiveFrame.destroy(),delete this.immersiveFrame)}})}),define("DS/ENOProjectMgmtCommonComponents/views/DateCustomView",["UWA/Core","DS/Controls/DatePicker","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils"],function(e,t,i,n){"use strict";return i.extend({setup:function(e){this.options=e,this.model=e&&e.model,this._parent.apply(this,arguments)},render:function(){let i=this;this.container.empty(!0),this.dateFieldContainer=e.createElement("div",{class:(this.model.model.canModify()&&this.options.config.readWrite||this.model.model.isNew(),"editable")}),this.dateFieldContainer.inject(this.container),this.attributeLabel=new e.Element("label",{text:this.options.config.label}),this.options.config.required&&(this.requiredLabel=new e.Element("span",{text:"*",class:"required-field-indicator"}),this.requiredLabel.inject(this.attributeLabel)),this.attributeLabel.inject(this.dateFieldContainer),this.groupStackedFields=e.createElement("div",{class:"field-group stacked-fields"}),this.groupStackedFields.inject(this.dateFieldContainer),this.groupWrapper=e.createElement("div",{class:"input-group-wrapper"}),this.groupWrapper.inject(this.groupStackedFields),this.datePickrSpanContainer=e.createElement("div",{class:"input-group"}),this.datePickrSpanContainer.inject(this.groupWrapper),this.datePickerContainer=e.createElement("span",{class:"input-element"}),this.datePickerContainer.inject(this.datePickrSpanContainer);let o=this.options.config.name;if(this.model.model.has(o)||this.model.model.isNew()){let s=this.model.get(o),a=s&&n.getIntlDateFormat(s);this.model.model.isNew()||this.options.config.readWrite?(this.datePicker=new t({value:a&&a.actualValue||void 0,allowUndefinedFlag:!a||!a.actualValue,timePickerFlag:!1}).inject(this.datePickerContainer),this.datePicker.fired=!1,this.datePicker.addEventListener("change",function(e){i.model.set(o,e.dsModel.value)})):(this.attributeValueLabel=new e.Element("span",{class:"read-only",text:a.displayValue||s}),this.attributeValueLabel.inject(this.datePickerContainer))}return this},destroy:function(){this.attributeLabel.destroy(),this.datePicker&&this.datePicker.destroy(),this.datePickrSpanContainer&&this.datePickrSpanContainer.destroy(),this.datePickerContainer&&this.datePickerContainer.destroy(),this.groupWrapper.destroy(),this.groupStackedFields.destroy(),this.dateFieldContainer.destroy(),this._parent.apply(this,arguments)}})}),define("DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtHeatMapChartUtil",["UWA/Core","UWA/Class","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils"],function(e,t,i){"use strict";return t.extend({_uwaClassName:"ProjectMgmtHeatMapChartUtil",emptyHeatMapInfo:void 0,heatMapChartArray:void 0,resetChartData:function(){this.heatMapChartArray=e.clone(this.heatMapChartArray||{}),this.severity=e.clone(this.severity||{})},init:function(e){this.options=e||{},this.chartConfig=this.options.chartConfig||{},this.matrixConfig=this.options.matrixConfiguration,this.isMatrixSettingVeiw=this.options.matrixSettingVeiw,this.heatMapChartArray=this.getHeatmapInfo(this.matrixConfig),this.heatMapChartArray&&this.resetChartData(),this.heatMapChartArray&&this.processHeatmapChart()},getHeatmapInfo:function(t){let n=this,o=t instanceof e.Class.Model?t.get("matrix"):t.matrix||t,s=this.parseMatrixData(o);this.severity=s.severity;let a=s.cells,l=this.getHeatMapAxisValues(s.Xaxis),r=this.getHeatMapAxisValues(s.Yaxis);l=[""].concat(l),r=r.concat(""),this.chartConfig.xAxis.title.text=s.Xaxis.displayValue,this.chartConfig.xAxis.categories=l,this.chartConfig.yAxis.title.text=s.Yaxis.displayValue,this.chartConfig.yAxis.categories=r;let c=[];a&&a.forEach(function(e){let t=e.cellId||"",o=e.Xvalue,s=e.Yvalue,a=e.riskLevel,l=e.rpn,r=o+s,d=n.isMatrixSettingVeiw?l:" ",h=i.findObject(n.severity,"actualValue",a),u=h&&h.actualValue,m=h&&h.backgroundColor,g=h&&h.textColor;c.push({cellId:t,riskLevel:u,Xvalue:o,Yvalue:s,y:1,x:Number(o),color:m,cellCount:0,matrixXY:r,dataLabels:{color:g,format:d,useHTML:!1}})}),c.sort(function(e,t){return e.matrixXY-t.matrixXY});let d=[];return d.push({data:c}),d},getHeatMapAxisValues:function(e){let t=[],i=e.nodes;return i&&i.forEach(function(e){t.push(e.displayValue)}),t},processHeatmapChart:function(){this.chartConfig.series=this.heatMapChartArray},parseMatrixData:function(e){if(e&&!e.parsed){let t=e.Xaxis,i=e.Yaxis,n=e.severity,o=e.cells,s=this.getMatrixSeverityValues(n);return{cells:o,Xaxis:this.getMatrixAxisValues(t),Yaxis:this.getMatrixAxisValues(i),severity:s,parsed:!0}}return e},getMatrixSeverityValues:function(e){let t=[];return e&&e.length&&e.forEach((e,n)=>{e.severityIndex=n;let o=i.getSeverityItem(e);t.push(o)}),t},getMatrixAxisValues:function(e){return{actualValue:e.name,displayValue:e.nls[widget.lang]||e.name,nodes:i.formatRangeValuesForSelectView(e.nodes,"value",i.getconcatenatedActualDisplayValue)}}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtGridView",["UWA/Core","UWA/Class/View","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/components/ProgressSpinner","DS/ENOProjectMgmtCommonComponents/components/CustomDataGridView","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtModels/Models/AppSettings","text!DS/ENOProjectMgmtCommonComponents/assets/templates/GridViewTemplate.html.handlebars","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a,l,r,c){"use strict";let d=[s.EDIT,s.DUPLICATE,s.RELATIONS];return t.extend({_uwaClassName:"ProjectMgmtGridView",init:function(t){let i=e.clone(t||{},!1);this._options=i,this._appConfig=i.appConfig,this.parentView=i.parentView,this._viewConfig=i.viewConfig,this._viewCollection=i.viewCollection,this._listConfig=i.listConfig,this._tabConfig=i.tabConfig,this._tabConfigForCreate=i.tabConfigForCreate,this._leftPanelOnly=i.leftPanelOnly,this._membersConfig=i.membersConfig,this._doNotApplyLazyLoading=i.doNotApplyLazyLoading,this._doNotShowContextualMenu=i.doNotShowContextualMenu,this._doNotApplyPropertyPanelInstance=i.doNotApplyPropertyPanelInstance,this._matrixConfigCollection=i.matrixConfigCollection},reset:function(){this.dataGrid&&(this.dataGrid.destroy(),delete this.dataGrid)},render:function(){if(this.reset(),this._appContainer=e.createElement("div"),this._appContainer.setHTML(r),this._appContainer=this._appContainer.getElement(".grid-view"),this.gridViewContent=this._appContainer.getElement("#gridViewContent"),!this._doNotApplyPropertyPanelInstance){let t=e.clone(this._options||{},!1);e.extend(t,{isCreate:!1,parentView:this}),this.detailsAndRelationships=this.parentView.getRightPanelContainer()&&this.parentView.getPropertyPanelInstance(this.parentView.getRightPanelContainer(),t)}return this._appContainer},loadData:function(t){let i=e.clone(t||{},!1);this.reset(),this.treeDocument&&this.treeDocument.resetTreeDocumentEvents(),this.treeDocument=this._viewCollection.getDocument(),this.treeDocument&&(i.notRisk||this.updateImpactProbabiltyConfig(i),this._ignoreCheckBoxSelection=this._listConfig.ignoreCheckBoxSelection,this.dataGrid=new o({container:this.gridViewContent,treeDocument:this.treeDocument,config:this._listConfig,gridOptions:{viewConfig:this._viewConfig,placeholder:c.NO_OBJECT_FOUND,matrixConfigCollection:this._matrixConfigCollection,onSortChange:this.fetchDataModelsForSorting.bind(this),lazyLoadingCallBack:!this._doNotApplyLazyLoading&&this.fetchLazyLoadingDataModels.bind(this),onContextualEvent:!this._doNotShowContextualMenu&&this.getGridContextualMenu.bind(this)}}),this.initializeEvents(),this.detailsAndRelationships&&this.handlePropertyPanelSelection(),this.disableMassUpdateButton())},handlePropertyPanelSelection:function(){if(this.detailsAndRelationships&&this.detailsAndRelationships.isPropertyPanelOpen()&&this._viewCollection.getDataModelsCount()){let e=this.treeDocument.getPreviousSelectedNodeModel();this.treeDocument.clearPreviousSelectedNodeInfo(),e?(this.dataGrid.removeSelection(e),e.select()):this._viewCollection.selectDataModel(0)}else this.showHideRightPanel(!1)},fetchLazyLoadingDataModels:function(e,t){this.fetchDataModels(e,{fetchColumnNames:t,callback:this.onCompleteLazyLoadingDataModels.bind(this)})},fetchDataModelsForSorting:function(e,t,i){this.fetchDataModels(t,{callback:i,fetchColumnNames:[e]})},getExcludeParams:function(){let e=this.dataGrid.layout._getColumnsVisibleFlagInPreferences();return e&&Object.keys(e)},fetchDataModels:function(t,i){if(t.length){let n=this.dataGrid.getGridStatusBarContainer(),o=this._viewCollection.collection.clone(),s=e.clone(i||{},!1);e.extend(s,{collection:o,paramData:t,excludeParams:this.getExcludeParams(),onComplete:function(){s.callback&&(s.fetchColumnName?s.callback():s.callback.apply(this,arguments)),this.hideSpinnerView(n)}.bind(this),onFailure:this.hideSpinnerView.bind(this,n)}),o&&o.length&&(this.showSpinnerView(n,c.LOADING),this._viewCollection.fetchAdditionalDataForModels(s))}},onCompleteLazyLoadingDataModels:function(e){e&&e.length&&e.forEach(e=>e.fetched=!0)},initializeEvents:function(){let e=this;this.treeDocument.getModelEvents().subscribe({event:"select"},function(t){e.disableMassUpdateButton(),e.rowShouldBeSelected(t.data.virtualRowID)?a.validateModificationsPending({parentView:e.parentView,yesEventFunc:e.selectItem.bind(e),noEventFunc:e.handleRollbackSelection.bind(e)},t):e.setTaggerProxy()}),this.treeDocument.getModelEvents().subscribe({event:"unselect"},a.validateModificationsPending.bind(void 0,{parentView:this.parentView,yesEventFunc:this.unselectItem.bind(this),noEventFunc:this.handleRollbackSelection.bind(this)})),this.dataGrid.addEvent("onDrop:assignees",a.validateModificationsPending.bind(void 0,{parentView:this.parentView,yesEventFunc:this.handleDropOnColumn.bind(this)})),this.dataGrid.addEvent("invokeMaturityUpdate",a.validateModificationsPending.bind(void 0,{parentView:this.parentView,yesEventFunc:function(){e.parentView.dispatchEvent("invokeMaturityUpdate",arguments)}}))},rowShouldBeSelected:function(t){if(!e.is(t,"number")||t<0)return!1;let i=this.dataGrid.getSelectedColumnInfo();if(i&&!isNaN(i.rowID)&&this._ignoreCheckBoxSelection&&"rowHeader"===i.columnDataIndex)return void(this.getSelectedRowsLength()>1&&this.showHideRightPanel(!1));let n=this.treeDocument.getPreviousSelectedNodeRowId(),o=this.detailsAndRelationships&&this.detailsAndRelationships._isPropertyPanelOpen;return n!==t||!o},updateImpactProbabiltyConfig:function(t){let i,n=e.clone(t||{},!1);if(n.context){let e=n.context.get("configuration");if(e&&1===e.length){let t=this._matrixConfigCollection.getMatrixConfigDefinition(e[0]);i=t&&t.get("matrix")}}this._listConfig.updateImpactProbabiltyConfig(i)},showHideRightPanel:function(e){this.detailsAndRelationships&&(this.detailsAndRelationships.reset(),this.detailsAndRelationships._isPropertyPanelOpen=e,this.parentView.showHideRightPanel(e)),this.setTaggerProxy()},setTaggerProxy:function(){let e=this.parentView.getTaggerProxy();e&&this.treeDocument&&e.handleUserTags(this.treeDocument.getSelectedNodes())},loadMassUpdate:function(){this.dataGrid.showModelMassUpdateDialog()},selectItem:function(e){if("select"===e.event){let t=e.data,i=t&&t.nodeModel;i&&(this._leftPanelOnly?this._hideLeftPanel():this.handleRowSelection(i))}},_hideLeftPanel:function(){this.parentView.showHideLeftPanel(!1)},handleRowSelection:function(e){let t=this.treeDocument.getSelectedNodes().length>1;t||(l.get("isComponent")&&this.parentView.dispatchEvent("xppClosePropertyPanel"),this.detailsAndRelationships&&this.detailsAndRelationships.render(),this.treeDocument.previousSelectedNodeInfo=e),this.showHideRightPanel(!t)},unselectItem:function(){this.dataGrid.setActiveCell(-1),this.showHideRightPanel(!1),this.disableMassUpdateButton()},disableMassUpdateButton:function(){let e=this.treeDocument.getSelectedNodes().length;this.parentView.disableMassUpdateButton(!e)},handleRollbackSelection:function(){let e=this.treeDocument.getPreviousSelectedNodeModel();e&&(this._viewCollection.unselect(),e.select())},destroy:function(){this.reset(),this._viewCollection.destroy(),this._appContainer&&this._appContainer.destroy()},getHeight:function(){return this.height=this.height||this.parentView.getHeight(),this.height},setHeight:function(e){this.height=e,this._appContainer&&(this.gridViewContent&&this.gridViewContent.setStyle("height",this.height+"px"),this.detailsAndRelationships&&this.detailsAndRelationships.setHeight(this.parentView.height))},isHidden:function(){return this._appContainer&&this._appContainer.isHidden()},show:function(){this._appContainer&&this._appContainer.show()},hide:function(){this._appContainer&&this._appContainer.hide()},handleGridViewActions:function(t,i,n){let o=e.clone(n||{},!1),a=o.rowView,l=o.treeNodeModel,r=o.isSelectedNode,c=o.cloneModelToSave;if(i===s.DELETE)this.detailsAndRelationships&&this.detailsAndRelationships.handleDeleteAction({isSelect:Boolean(r),treeNodeModel:l,callback:this.hideSpinnerView.bind(this,a)});else{let n={onComplete:this.hideSpinnerView.bind(this,a),onFailure:this.hideSpinnerView.bind(this,a)};c.handleAttrsUpdateForActions(i,t,n),r||c.hasEvent("submitSave")||(e.extend(n,{isSelect:Boolean(r),treeNodeModel:l}),this._viewCollection.saveDataModel(c,n))}},getPersonObjectName:function(e){let t=e.objectId;return-1===t.indexOf("iam:")?e.displayName:t.substr(t.indexOf(":")+1)},processDropData:function(t,n,o){let s,l,r=this,d=e.clone(o||{},!1),h=t.data.items,u=h.length;if(u){let e=this.hideSpinnerView.bind(this,d.rowView);if(a.validateDroppedObjects(h,this._membersConfig.columnInfo.assignees,e))return}let m={},g=[],p=[],C=d.treeNodeModel.options.data.model,f=C.get(n);for(s=0;s<u;s++){let e=(l=h[s]).objectId,t=a.alreadyHasObjectInRelatedData(f,e);if(t){let e=t.displayType||t.objectType;m[e]||(m[e]=[]),m[e].push(t.displayName);continue}let i=this.getPersonObjectName(l),n=a.getPersonObjectInfo(i);n.getCESStamp()?g.push(n):p.push(n)}let D=g.length,w=p.length;if(w){p[w-1].addEventOnce("onSync",function(){r.handleGridViewActions(g.concat(p),n,d)})}else D&&this.handleGridViewActions(g,n,d);Object.keys(m).length&&(i.showSingleErrorMessageForDataObjects(m,c.OBJECT_ALREADY_ASSOCIATED,C.get("title")),this.hideSpinnerView(d.rowView))},handleDropOnColumn:function(e,t,n,o){let s=n.options.data;if(!s.model.canModify())return void i.buildNotification({message:c.NO_MODIFY_ACCESS},"error");this.showSpinnerView(o);let a=this.detailsAndRelationships&&this.detailsAndRelationships.currentModel,l=a&&a.id===s.id?a:s;e&&this.processDropData(e,t,{rowView:o,treeNodeModel:n,cloneModelToSave:l})},getGridContextualMenu:function(e){this.treeDocument.getSelectedNodes().length>1&&this.dataGrid.unselectAll();let t=[],i=this;e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e));let n=e.cellInfos;if(n&&n.rowID>-1){let e,o,l,r=n.nodeModel,c=r.options.data,h=this.detailsAndRelationships&&this.detailsAndRelationships.currentModel,u=h&&h.id===c.id,m=u?h:c;if(!c.model.fetched)return t;let g=this.dataGrid.getViewByRowID(n.rowID),p=this.dataGrid.getColumnDataIndex(n);if(p===s.ASSIGNEE_ATTR){let t=this.dataGrid.getDataIdFromEvent(event);(l=c.get(p))&&(e=l.length,o=t&&l.get(t))}let C=a.validateModificationsPending.bind(void 0,{parentView:this.parentView,yesEventFunc:function(e){m&&m.cancel();let t=e.context;!d.includes(t.name)&&i.showSpinnerView(g),i._handleGridContextMenuActions(t,{rowView:g,personModel:o,treeNodeModel:r,isSelectedNode:u,cloneModelToSave:m})}});t=this._appConfig.gridDropDownItems.getItems(m,{callback:C,assignModel:o,isSelectedNode:u,isAssignColumn:e,dropDownItemList:this._listConfig.dropDownItemList,maturityStates:this._listConfig.columnInfo.state&&this._viewConfig.getFieldDefinitionRangeData(m.model,"state",this._listConfig.columnInfo.state.helpInfoFilter)})}return t},_handleGridContextMenuActions:function(t,i){let n=this,o=e.clone(i||{},!1),r=o.personModel,c=o.treeNodeModel,d=t.groupName||t.name;switch(d){case s.EDIT:this.dataGrid.unselectAll(),c.select();break;case s.DUPLICATE:e.extend(o,{operation:d,isSelect:Boolean(o.isSelectedNode)}),this._viewCollection.duplicateDataModels(o);break;case s.STATE_ATTR:this.handleGridViewActions(t.name,d,o);break;case s.ASSIGN_TO_SELF:this.handleAssignToSelfAction(function(e){n.handleGridViewActions(e,d,o)});break;case s.REMOVE_ASSIGN_TO_SELF:this.handleGridViewActions(l.get("user"),d,o);break;case s.RELATIONS:a.launchApp(s.RELATIONS_WIDGET_APP_ID,c.model);break;case s.DELETE:this.handleGridViewActions("",d,o);break;case s.REMOVE_ASSIGNEE:r?this.handleGridViewActions(r,d,o):this.handleRemoveAllAssigneesAction({title:c.options.data.title,callback:this.handleGridViewActions.bind(this,"",d,o)})}},handleRemoveAllAssigneesAction:function(t){let n=e.clone(t||{},!1),o=n.title,s=n.callback,a={dontResetModel:!0,parentView:this.parentView,title:c.REMOVE_ALL,message:c.replace(c.DELETE_ASSIGNEE_CONFIRM_MSG,{title:o}),yesEventFunc:s,noEventFunc:this.hideSpinnerView,yesLabel:c.YES,noLabel:c.NO};i.confirmDialog(a)},handleAssignToSelfAction:function(e){let t=a.getPersonObjectInfo(l.get("user"));t.getCESStamp()?e(t):t.addEventOnce("onSync",e.bind(this,t))},showSpinnerView:function(e,t){e&&n.showRowLoadingMessage(e,t||" ")},hideSpinnerView:function(e){n.hideRowLoadingMessage(e)},getSelectedRows:function(){return this.treeDocument.getSelectedNodes()},getSelectedRowsLength:function(){return this.getSelectedRows().length}})}),define("DS/ENOProjectMgmtCommonComponents/views/TemplatesView",["UWA/Core","DS/ENOProjectMgmtModels/Models/BaseContext","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtGridView","DS/ENOProjectMgmtCommonComponents/components/CustomAlert"],function(e,t,i,n){"use strict";return i.extend({_uwaClassName:"TemplatesView",init:function(t){let i=e.clone(t||{},!1);e.extend(i,{context:i.parentView._currentModel}),this.listenTo(this,"onPostContextModify",this.handleContextChangeForView),this._parent(i),this._viewCollection.matrixConfigCollection=this._matrixConfigCollection},loadDataModels:function(i){this.baseContext&&(this.baseContext.destroy(),delete this.baseContext);let n=e.clone(i||{},!1);this.actualModel=this.parentView._currentModel.model,this.baseContext=new t(this.actualModel.getAttributes(),{fetchSource:n.fetchSource,sourceType:n.fieldDefinitionSource,fieldDefinitionSource:n.fieldDefinitionSource});let o=this.baseContext.get(n.templateAttribute);o&&o.length>0?this._onCompleteDataModels(n):(n.onComplete=this._onCompleteDataModels.bind(this,i),n.onFailure=this._onFailureDataModels.bind(this,i),n.initialCall=!0,this._viewCollection.getContextInfo(this.baseContext,n).then(n.onComplete,n.onFailure))},createNew:function(e){return e.context=this.baseContext,this.parentView.createNew(e)},_onCompleteDataModels:function(e){e.context=this.baseContext,this.actualModel.set(this.baseContext.getAttributes(),{parse:!0}),e.onComplete()},_onFailureDataModels:function(e,t){n.buildNotification({message:"Error Occured",title:t},"error"),e.onFailure()},setContextTitle:function(e,t){e&&e.set({title:t},{parse:!0})},handleContextChangeForView:function(){let e=this.actualModel.title,t=this._viewCollection.getDocument();if(e&&t){let i=this._viewCollection.storageDataUtil;this.setContextTitle(this.baseContext,e);let n=this.actualModel.get(this._options.templateAttribute);n&&n.length&&n.forEach(n=>{let o=n.id,s=n.get("context");this.setContextTitle(s.first(),e),this._viewCollection.updateTreeNodeModel(n,{treeNodeModel:t.getTreeNodeModelById(o)}),i.get(o)&&i.set(o,n)})}}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProfilesView",["DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtGridView"],function(e){"use strict";return e.extend({_uwaClassName:"ProfilesView",loadDataModels:function(e){this._viewCollection.getDataModels(e)},loadData:function(e){e.notRisk=!0,this.showHideRightPanel(!1),this._parent(e)},_hideLeftPanel:function(){let e={requiresReload:!0,nlsTrend:this._nlsTrend,appConfig:this._appConfig,tabConfig:this._tabConfig,viewCollection:this._viewCollection,matrixConfigCollection:this._matrixConfigCollection,detailsAndRelationships:this._detailsAndRelationships};this.parentView.showHideLeftPanel(!1,e)}})}),define("DS/ENOProjectMgmtCommonComponents/views/MultiValueCustomView",["UWA/Core","DS/Controls/ComboBox","DS/Controls/DatePicker","DS/Controls/LineEditor","DS/Controls/SelectionChips","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l){"use strict";return s.extend({_uwaClassName:"MultiValueCustomView",setup:function(e){this.options=e,this.model=e&&e.model,this._parent.apply(this,arguments)},render:function(){let s=this;this.container.empty(!0);let r=this.model.model.isNew()||this.model.model.canModify()&&this.options.config.readWrite;if(this.multiValueContainer=e.createElement("div",{class:"editable"}),this.multiValueContainer.inject(this.container),this.attributeLabel=new e.Element("label",{text:this.options.config.label}),this.options.config.required&&(this.requiredLabel=new e.Element("span",{text:"*",class:"required-field-indicator"}),this.requiredLabel.inject(this.attributeLabel)),this.attributeLabel.inject(this.multiValueContainer),this.groupStackedFields=e.createElement("div",{class:"field-group stacked-fields"}),this.groupStackedFields.inject(this.multiValueContainer),this.groupWrapper=e.createElement("div",{class:"input-group-wrapper"}),this.groupWrapper.inject(this.groupStackedFields),this.editorContainer=e.createElement("div",{class:"input-group"}),this.editorContainer.inject(this.groupWrapper),this.editorSpan=e.createElement("span",{class:"input-element"}),this.editorSpan.inject(this.editorContainer),r){if(this.selectionChipsContainer=e.createElement("div",{class:"input-group"}),this.selectionChipsContainer.inject(this.groupWrapper),this.selectionChipsSpan=e.createElement("span",{class:"input-element"}),this.selectionChipsSpan.inject(this.selectionChipsContainer),this.options.config.values||"checkbox"===this.options.config.type){let e=[];"checkbox"===this.options.config.type?e=[{label:l.TRUE_VALUE,value:!0},{label:l.FALSE_VALUE,value:!1}]:this.options.config.values.forEach(t=>{e.push(t.displayValue)}),this.comboBox=new t({placeholder:l.SELECT_AN_OPTION,enableSearchFlag:!1,reachablePlaceholderFlag:!0,elementsList:e}),this.comboBox.addEventListener("change",function(e){s._addChip(e.dsModel.value,e.dsModel.label)}),this.comboBox.inject(this.editorSpan)}else"date"===this.options.config.type?(this.datePicker=new i({timePickerFlag:!1}).inject(this.editorSpan),this.datePicker.addEventListener("change",function(e){let t=e.dsModel.value;s._addChip(t.toString())})):("number"===this.options.config.type?this.lineEditor=new n({placeholder:l.ENTER_A_VALUE,maxLength:this.options.config.maxLength,pattern:"float"!==this.options.config.typeRepresentation?"^-?[0-9]{1,10}$":"^(?=.*\\d)[+]?\\d{1,10}(\\.\\d+)?$"}):this.lineEditor=new n({placeholder:l.ENTER_A_VALUE,maxLength:this.options.config.maxLength}),this.lineEditor.inject(this.editorSpan),this.lineEditor.addEventListener("uncommittedChange",function(e){if(e.options.uncommittedValue&&""!==e.options.uncommittedValue){let t="number"===s.options.config.type&&"float"!=s.options.config.typeRepresentation&&(e.options.uncommittedValue>2147483647||e.options.uncommittedValue<-2147483648);s.editorSpan.toggleClassName("has-error",t)}}),this.lineEditor.addEventListener("change",function(e){"number"===s.options.config.type&&"float"!=s.options.config.typeRepresentation&&(s.lineEditor.value>2147483647||s.lineEditor.value<-2147483648)||(s._addChip(s.lineEditor.value),s.lineEditor._giveFocus())}));this.selectionChips=new o,this.selectionChips.inject(this.selectionChipsSpan);let r=this.model.get(this.options.config.name);if(r&&r.length>0){let e=0;r.forEach(t=>{let i,n;if("date"===this.options.config.type){let e=a.getIntlDateFormat(t);i=e.displayValue,n=e.actualValue}else"checkbox"===this.options.config.type?(i=t?l.TRUE_VALUE:l.FALSE_VALUE,n=t):(i=t.toString(),n=t);s.selectionChips.addChip({label:i,index:e,value:n}),e++})}this.selectionChips.addEventListener("change",function(){s._setChipValuesToModel()})}else{let t=this.model.get(this.options.config.name);if(t&&t.length>0){let i=[],n=new e.Element("ul");n.inject(this.editorSpan),t.forEach(t=>{let o;o="date"===s.options.config.type?a.getIntlDateFormat(t).displayValue:"checkbox"===this.options.config.type?t&&l.TRUE_VALUE||l.FALSE_VALUE:t,i.push({label:o});let r=new e.Element("li");r.inject(n),new e.Element("span",{class:"read-only",text:o}).inject(r)})}}return this},_addChip:function(e,t){this.selectionChips.addChip({label:t||e,value:e}),this._setChipValuesToModel()},_setChipValuesToModel:function(){let e=this.selectionChips.getAllChipsOptions(),t=[];e.forEach(e=>{t.push(e.value)}),this.model.set(this.options.config.name,t)},destroy:function(){this.attributeLabel.destroy(),this.lineEditor&&this.lineEditor.destroy(),this.datePicker&&this.datePicker.destroy(),this.editorContainer.destroy(),this.selectionChipsSpan&&this.selectionChipsSpan.destroy(),this.selectionChips&&this.selectionChips.destroy(),this.selectionChipsContainer&&this.selectionChipsContainer.destroy(),this.groupWrapper.destroy(),this.groupStackedFields.destroy(),this.multiValueContainer.destroy(),this._parent.apply(this,arguments)}})}),define("DS/ENOProjectMgmtCommonComponents/views/ToggleView",["UWA/Core","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","text!DS/ENOProjectMgmtCommonComponents/assets/templates/InputGroupDivTemplate.html.handlebars"],function(e,t,i,n,o,s,a){"use strict";let l=n.compile(a);return o.extend({_uwaClassName:"ToggleView",render:function(t){this.container.empty(!0);let n=this._getData(),o=this._config,s=o.buttonType||"checkbox";this.isRadioButtonType="radio"===s,this.container.toggleClassName("editable",Boolean(o.readWrite&&n.canEdit));let a=e.clone(t||{},!1);if(this.inputGroupDiv=a.container,!this.inputGroupDiv){e.extend(o,{isToggleView:Boolean(s)});let t=l(o);this.container.setHTML(t),this.inputGroupDiv=this.container.getElement(".input-element")}return this.toggleButtonGroup=new i({type:s}),this.toggleButtonGroup.inject(this.inputGroupDiv),this._createToggleBoxView(),this.toggleButtonGroup.addEventListener("change",this._toggleDataEntry.bind(this)),this},_toggleDataEntry:function(e){let t=[];(e.value||e.dsModel.value).forEach(e=>{e=this._config.values[e],this.isRadioButtonType?t=e:t.push(e)}),this.normalizedSet(this.model,this._config,t)},getCheckedValue:function(e){return(!this.isRadioButtonType||!this.toggleButtonGroup.value.length)&&e.checked},getValue:function(){let e=this.model.get(this._config.name);if(this.isRadioButtonType)return e&&e.hasOwnProperty("actualValue")?e.actualValue:e;return e&&e.some(e=>e.hasOwnProperty("actualValue"))?s.getAttributeValues(e,"actualValue"):e},_createToggleBoxView:function(){let e,i=[],n=this._config.values,o=this.getValue();n&&n.length&&n.forEach((n,s)=>{if(o){let t=n.actualValue;e=this.isRadioButtonType?t===o:o.includes(t)}else(e=this.getCheckedValue(n))&&i.push(s);let a=new t({type:this.toggleButtonGroup.type,label:n.displayValue,value:s,checkFlag:Boolean(e)});this.toggleButtonGroup.addChild(a)}),i.length&&this._toggleDataEntry({value:i})},destroy:function(){this.toggleButtonGroup&&(this.toggleButtonGroup.destroy(),delete this.toggleButtonGroup,delete this.isRadioButtonType)}})}),define("DS/ENOProjectMgmtCommonComponents/views/QuestionComponent",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/ENOProjectMgmtCommonComponents/views/ToggleView","text!DS/ENOProjectMgmtCommonComponents/assets/templates/QuestionComponentTemplate.html.handlebars","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s){"use strict";let a=t.compile(o);return i.extend({_uwaClassName:"QuestionComponent",tagName:"div",className:"form-group editable layout-vertical",render:function(){this.container.empty(!0),this.destroy({destroyChildrenViews:!0});let e=this._config,t=this._getData(),i=Boolean(e.readWrite&&t.canEdit);this.container.toggleClassName("editable",i);let n=this._config.dependsOn&&this.model.get(this._config.dependsOn),o=n&&n.first()&&n.first().get(this._config.name);return this._getLabel(s.TEMPLATE_QUESTIONS).inject(this.container),o&&o.length?o.forEach(e=>this._appendQuestionInView({question:e})):this._addNoQuestionsDisplay(),this.initializeEvents(),this},initializeEvents:function(){this.listenTo(this.model,"onChange:"+this._config.dependsOn,this.render)},getToggleView:function(e){return new n(e)},_getLabel:function(t){return e.createElement("label",{text:t})},_addNoQuestionsDisplay:function(){e.createElement("span",{text:"--"}).inject(this.container)},getQuestionId:function(e){return"id_"+e.id},getQuestionCommentId:function(e){return this.getQuestionId(e)+"_comments"},getQuestionContent:function(t){let i=e.clone(t||{},!1).question,n=i.get("description");return a({questionLabel:n,commentsNLS:s.COMMENT,questionId:this.getQuestionId(i),commentId:this.getQuestionCommentId(i)})},getQuestionView:function(t,i){let n=new e.Class.View;return n.name=t,n.setContainer({tag:"div",class:"field-group",html:i}),n},getToggleViewForQuestionValues:function(t,i){let n=e.clone(i||{},!1).question,o=n.get("questions"),s=this._getToggleViewDefaultConfig();e.extend(s,{id:n.id,title:n.title,name:"questionResponse",subQuestions:o,text:n.get("description")});let a=this.getToggleView({config:s,model:n});return a.render({container:t}),a},_appendQuestionInView:function(t){let i=e.clone(t||{},!1),n=i.question,o=i.parentQuestionName,s=this.getQuestionContent(t),a=this.getQuestionView(n.title,s),l=a.getElement("#"+this.getQuestionId(n));a.valuesBtnGrp=this.getToggleViewForQuestionValues(l,t).toggleButtonGroup;let r=this.container,c="bottom";o&&(r=this.getFieldViewByName(o).getContent(),c="after"),a.render().inject(r,c),this.addChildView(a),this.listenTo(n,"onChange",this._handleQuestionResponse);let d=this;a.getElement("#"+this.getQuestionCommentId(n)).addEventListener("change",function(e){d.normalizedSet(n,{name:"comment"},e.target.value)})},_getDefaultValue:function(){return{displayValue:s.NO_ANSWER,actualValue:"",checked:!0}},_getToggleViewDefaultConfig:function(){return{type:"checkboxList",buttonType:"radio",values:[{displayValue:s.YES,actualValue:"TRUE"},{displayValue:s.NO,actualValue:"FALSE"},this._getDefaultValue()],toggleButtonsInGridDisplay:!0}},_handleQuestionResponse:function(e,t,i){let n=e.get("questionResponse"),o=t&&t.subQuestions,s=t&&t.title;o&&o.forEach(e=>{this._handleSubQuestionDisplay({subQuestion:e,selectedResponse:n,parentQuestionName:s})})},_handleSubQuestionDisplay:function(t){let i=e.clone(t||{},!1),n=i.subQuestion,o=i.selectedResponse,s=i.parentQuestionName,a=n.title,l=this.getFieldViewByName(a),r=l&&l.getContent(),c=n.get("expectedResponse")===o.actualValue;if(r&&r.toggleClassName("hide",!c),c)l||this._appendQuestionInView({question:n,parentQuestionName:s});else if(n.set("comment",""),l){l.valuesBtnGrp.getButton(2).fire("click"),l.getElement("textarea").value=""}},getFieldViewByName:function(e){let t;return this._childrenViews&&this._childrenViews.length&&this._childrenViews.some(i=>i.name===e&&(t=i,!0)),t},destroy:function(t){e.clone(t||{},!1).destroyChildrenViews&&this._childrenViews&&(this._childrenViews.forEach(e=>{e.destroy()}),delete this._childrenViews),this.questionComponentDiv&&(this.questionComponentDiv.destroy(),delete this.questionComponentDiv,delete this.isRadioButtonType)}})}),define("DS/ENOProjectMgmtCommonComponents/config/ProfilesPropertiesConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t){"use strict";let i=e.extend({_uwaClassName:"ProfilesPropertiesConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"basic",values:[{label:t.TITLE,name:"title",type:"text",readWrite:"true",required:!0,fields:"title,name,description,image,typeicon,modifyAccess,deleteAccess",numberOfDisplayLines:1,numberOfEditableLines:1,removeCarriageReturns:!0,maxLength:128,validate:!0},{label:t.DESCRIPTION,name:"description",type:"text",readWrite:"true",numberOfDisplayLines:1,numberOfEditableLines:1,removeCarriageReturns:!0,maxLength:128}]});return i._instance=i._instance||new i,i._instance}),define("DS/ENOProjectMgmtCommonComponents/config/ViewConfigBase",["UWA/Core","UWA/Class/View","DS/VENHighChart/UIHighCharts","DS/i3DXCompassPlatformServices/OpenWith","DS/ENORIPE_Relations/RelationsTabSettings","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Models/FieldsDefinition","DS/ENOProjectMgmtModels/Constants/Constants","DS/ENOProjectMgmtModels/Utils/FederatedSearch","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d){"use strict";let h,u,m=["typesForSearch"];return t.extend({_uwaClassName:"ViewConfig",_fieldDefinitionSource:void 0,_additionalFieldDefinitionSources:void 0,setup:function(e,t){let i=this;this._initializeHighcharts(),this._fieldDefinitionSource=e,this._additionalFieldDefinitionSources=t||[],l.get(e)||l.set(e,{}),this.listenTo(l,"onChange:"+e,this._updateConfigDataFromFieldDefinition.bind(this,e)),this._additionalFieldDefinitionSources.forEach(e=>{this.listenTo(l,"onChange:"+e,this._initializeRangeValues.bind(this,e))}),this.listenTo(a,"onChange:tenant",function(){i._initializeOpenWith(),i._initializeRelationsTabSettings()})},_initializeHighcharts:function(){i.setOptions({lang:{weekdays:d.WEEKDAYS,shortMonths:d.SHORTMONTHS,months:d.MONTHS}}),a.set("highcharts",i)},_initializeOpenWith:function(){let e=this,t=new n;t._fetchCompatibleApps(function(i){t._appsList=i,e.setOpenWithInfo(t)})},setOpenWithInfo:function(e){h=e},getOpenWithInfo:function(){return h},_initializeRelationsTabSettings:function(){let t=this,i={isDraggable:!1,isProfilesVisible:!1,appID:a.get("appId"),isExternal:!0},n={getPlatformID:function(){return a.get("tenant")},getServiceID:function(){return r.SPACE_SOURCE}};o.isAvailable(n,i).then(function(i){e.is(i,"object")&&i.isAvailable&&i.facetInfo&&t.setRelationsFacetInfo(i.facetInfo)})},setRelationsFacetInfo:function(e){u=e},getRelationsFacetInfo:function(){return u},getFieldDefinitionRangeData:function(e,t,i,n){let o,a,r,c=[];n&&(o=e.get(t));let d=l.getFieldRangeItems(e.getFieldDefinitionSource(),t);return i?(d.forEach(e=>{a=e.helpInfos&&e.helpInfos.hasOwnProperty(i),!(r=a&&e.helpInfos[i])||n&&o!==r.value||c.push(r)}),n&&1===c.length?c[0]:c):n?s.findObject(d,"value",o):d},setFieldDefinitionData:function(e,t){let i={fieldServiceColumns:{},fieldCompositionServiceColumns:{},fieldDefinitionColumns:t};l.setFieldsDefinition(e,i)},isLibraryInstalled:function(){let e=this._fieldDefinitionSource&&l.getFieldDefinitionColumn(this._fieldDefinitionSource,"isLibraryInstalled");return Boolean(e&&"TRUE"===e.label)},profileCreateAccess:function(e){return"TRUE"===l.getFieldRangeItemActualValue(e,"profileCreateAccess",0)},matrixConfigCreateAccess:function(){let e=this._fieldDefinitionSource&&l.getFieldDefinitionColumn(r.APPLICATIONS.MATRIX_CONFIGURATION,"matrixConfigCreateAccess");return Boolean(e&&e.fieldDefinitionRangeItem&&e.fieldDefinitionRangeItem.TRUE)},_updateConfigDataFromFieldDefinition:function(e,t){this._initializeRangeValues(e,t),this._initializeCustomAttributesForList(e)},_initializeCustomAttributesForList:function(e){let t=this.getConfigListToUpdateListConfig(e);t&&t.length&&t.forEach(t=>{this.initializeCustomAttributes(e,void 0,t,void 0,!0)})},initializeCustomAttributes:function(e,t,i,n,o){let s,a;o?s=i.values.length:(s=0,i.values=[]);let r=i.typesForCustomAttributes&&i.typesForCustomAttributes.length;a=l.getFieldCustomColumns(e,r?i.typesForCustomAttributes:t,i.options&&i.options.excludeAutoDeploy);for(let t in a){if(!a.hasOwnProperty(t))continue;let l=a[t];if(l.custom){let t={};if(i.values.push(t),t.isCustom=!0,t.visibleFlag=!o,t.required=Boolean(l.mandatory),t[o?"text":"label"]=l.label,t[o?"dataIndex":"name"]=l.name,l.viewConfig){let e=JSON.parse(l.viewConfig),i=e.multiline,s=e.multivalue,a=e.attributeType;if(o)"string"===a&&i?t.typeRepresentation="multilineString":s?t.typeRepresentation="array<"+a+">":"date"===a?(t.typeRepresentation="datetime",s&&(t.getCellSemantics=function(e){if(e&&-1!==e.rowID&&e.nodeModel)return{allowMultipleValuesFlag:!0}})):t.typeRepresentation=a;else{let o=e.type;t.type=o,t.readWrite=Boolean(e.readWrite||l.editable),s&&n?t.customView=n.MultiValueCustomView:"date"===a&&n?t.customView=n.DateCustomView:"string"===a&&(t.removeCarriageReturns=!i&&"text"===o),t.validate=e.required,"number"===o&&(t.allowEmpty=!0),e.maxlength>0&&(t.maxLength=e.maxlength)}"real"===a&&(t.typeRepresentation="float"),t.defaultValue=e.defaultValue}else t.readWrite=Boolean(l.editable);i._setColumnInfoForField(t,s),l.range&&this._addRangeValuesToConfigs(e,l,void 0,i)}s++}},_initializeRangeValues:function(e,t){let i,n,o=t.getFieldsDefinition(e);for(let t in o)if("field"===(n=o[t]).itemType&&n.range)this._addRangeValuesToConfigs(e,n);else if("service"===n.itemType)for(let t in n.items)"field"!==(i=n.items[t]).itemType||!i.range&&"firstname"!==i.name||this._addRangeValuesToConfigs(e,i,n.name)},_addUOMValuesToConfig:function(e,t,i,n){n.columnInfo[e].uomValues=s.getAttributeValues(t,"displayValue"),n.columnInfo[e].defaultValues=t},_addRangeValuesToConfigs:function(t,i,n,o){let s,a=this,l=[],r=i.range&&i.range.item;if(r)for(let t in r)if(r.hasOwnProperty(t)){let i={};i.displayValue=r[t].display,i.actualValue=r[t].value,i.helpInfo=r[t].helpinfo,i.helpInfos=r[t].helpInfos,(r[t].default||1===r.length)&&(s?(e.is(s,"array")||(s=[s]),s.push(r[t].value)):s=r[t].value),l.push(i)}if(o)a._processConfigValues(t,i,l,s,n,o);else{let e=this.getConfigListToUpdate(t);e&&e.length&&e.forEach(e=>{a._processConfigValues(t,i,l,s,n,e)})}},_processConfigValues:function(e,t,i,n,o,s){let a,l,c=t.name,d="firstname"===c,h=this.getTypesForSearchFields().includes(c);if(c=(l=s.uomMappedkeyValues&&s.uomMappedkeyValues[t.name])||t.name,a=s.columnInfo[c])if(l)this._addUOMValuesToConfig(c,i,n,s),t.format="uom";else{if(a.serviceName!==o)return;t.name!==r.IMPACT_ATTR&&t.name!==r.PROBABILITY_ATTR||(i=[],n=""),a.showIcon&&this.handleIconForRangeValues(i),this._setConfigValues(a,i,n),this._setConfigValues(s.values[a.valueIndex],i,n)}else(h||d)&&(a=s.columnInfo[o])&&this.setSearchSourceForServiceObjects(e,s,a,d)},handleIconForRangeValues:function(e){e&&e.length&&e.forEach(e=>{e.fontIcon=e.actualValue})},setConfigValuesForSingleConfig:function(e,t,i){this._setConfigValues(e,t,i)},_setConfigValues:function(e,t,i){let n=this._getFilteredValues(e,t);e.values=n,e.defaultValue=i,e.defaultValues=n},_getFilteredValues:function(e,t){if(e.helpInfoFilter){let i=[];return t.forEach(t=>{if(t.helpInfos&&t.helpInfos[e.helpInfoFilter]){let n=t.helpInfos[e.helpInfoFilter],o={};o.displayValue=n.display,o.actualValue=n.value,o.helpInfo=n.helpinfo,(n.default||1===n.length)&&(o.defaultValue=n.value),i.push(o)}}),i}return t},handleSearchSourceTypesFor3dplan:function(e,t){if(!e.searchSourceTypes||!e.searchSourceTypes[t]){let i=l.getFieldsDefinition(t),n=s.findObject(i,"name",e.name),o=n&&n.typesForSearch;if(o)!e.searchSourceTypes&&(e.searchSourceTypes={}),e.searchSourceTypes[t]=o.split(",");else{let i=e.searchSource.findIndex(e=>e===t);-1!==i&&e.searchSource.splice(i,1)}}},handleSearchSourceTypesFor3dspace:function(e,t,i){if(!t.searchSourceTypes||!t.searchSourceTypes[i]){let n;if(t.typesForSearchFieldName)n=l.getFieldDefinitionColumn(e,t.typesForSearchFieldName);else{let i=l.getFieldDefinitionColumn(e,t.fieldDefinitionName||t.name);n=i&&s.findObject(i.items,"name",this.getTypesForSearchFields())}if(!n)return;if(!t.searchSourceTypes&&(t.searchSourceTypes={}),t.searchSourceTypes[i]=[],t.typesForSearchFieldName)n.fieldDefinitionRangeItem.hasOwnProperty(t.name)&&this._getTypeSearchFieldValueFromRange(n,i,t,t.name);else for(let e in n.fieldDefinitionRangeItem)n.fieldDefinitionRangeItem.hasOwnProperty(e)&&this._getTypeSearchFieldValueFromRange(n,i,t,e)}},_getTypeSearchFieldValueFromRange:function(e,t,i,n){let o=e.fieldDefinitionRangeItem[n].display.split(",");i.searchSourceTypes[t].length?i.searchSourceTypes[t].concat(o):i.searchSourceTypes[t]=o},setSearchSourceForServiceObjects:function(e,t,i,n){if(n){let e=t.getPersonSearchSource();i.searchSource=c.filterSearchSources(e),i.searchSourceTypes=t.getPersonSearchSourceTypes(e)}else{let n=t.getObjectSearchSource(i.allowFileManagement);n&&n.length&&(i.searchSource=[...n],n.forEach(t=>{switch(t){case r.XPLAN_SOURCE:this.handleSearchSourceTypesFor3dplan(i,t);break;case r.DRIVE_SOURCE:i.searchSourceTypes||(i.searchSourceTypes={}),i.searchSourceTypes[t]=["DriveFile"];break;default:this.handleSearchSourceTypesFor3dspace(e,i,t)}}))}},getTypesForSearchFields:function(){return m},getConfigListToUpdate:Function.prototype,getConfigListToUpdateListConfig:Function.prototype})}),define("DS/ENOProjectMgmtCommonComponents/utils/ClassificationCloneModel",["UWA/Core","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel"],function(e,t){"use strict";return t.extend({_uwaClassName:"ClassificationCloneModel",set:function(){let t=arguments[1];t&&e.is(t,"object")&&(t=t.actualValue,arguments[1]=t),this._parent.apply(this,arguments),this.dispatchEvent("onChangeAttributeValue",arguments)}})}),define("DS/ENOProjectMgmtCommonComponents/config/ChatViewConfig",["UWA/Core","DS/ENOProjectMgmtCommonComponents/config/ConfigBase","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i){"use strict";let n=t.extend({_uwaClassName:"ChatViewConfig",columnInfo:{},hide:!0,setup:function(){this.setColumnInfo()},type:"basic",values:[{label:"Note",name:"note",type:"text",readWrite:!1,defaultValue:"Please provide project details below. This info will be used to generate a multi-level project plan with appropriate milestones."},{label:"Project Details",name:"title",relatedFieldsToSave:["model","temperature","max_tokens","frequency_penalty","presence_penalty","messages"],type:"text",readWrite:!0,validate:!0},{label:"Start Date",name:"startDate",type:"date",readWrite:!0,validate:!0},{label:"Duration",name:"duration",type:"number",readWrite:!0,validate:!0,defaultValue:1},{label:"Duration Period",name:"durationPeriod",type:"select",readWrite:!0,values:[{actualValue:"Days",displayValue:"Days"},{actualValue:"Weeks",displayValue:"Weeks"},{actualValue:"Months",displayValue:"Months"}],defaultValue:"Months"}]});return n._instance=n._instance||new n,n._instance}),define("DS/ENOProjectMgmtCommonComponents/config/CalendarDisplayListConfig",["UWA/Core","DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/config/DefaultGridConfig","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n){"use strict";let o=t.extend({_uwaClassName:"CalendarDisplayListConfig",columnInfo:{},ignoreCheckBoxSelection:!0,customContentColumnInfo:{},setup:function(){this.setColumnInfo()},type:"list",gridConfig:function(){let t=e.clone(i);return t.identifier="CalendarListGridView",t.columnsHeader=!0,t.showContextualMenuColumnFlag=!1,t.layoutOptions.rowsHeader=!1,t.layoutOptions.columnsHeader=!0,t}(),values:[{text:n.EXCEPTION_NAME,key:"title",dataIndex:"tree",minWidth:"150",icon:""},{text:n.EXCEPTION_TYPE,minWidth:"120",dataIndex:"exceptionType"},{text:n.NEXT_INSTANCE,minWidth:"120",dataIndex:"nextOccurrence",typeRepresentation:"date"},{text:n.FREQUENCY,minWidth:"120",dataIndex:"frequency"},{text:n.PATTERN,minWidth:"220",dataIndex:"pattern"},{text:n.EFFECTIVE_FROM,minWidth:"120",dataIndex:"startDate",alignmentValue:"center",typeRepresentation:"date"},{text:n.EFFECTIVE_TO,minWidth:"120",dataIndex:"endDate",alignmentValue:"center",typeRepresentation:"date"}]});return o._instance=o._instance||new o,o._instance}),define("DS/ENOProjectMgmtCommonComponents/config/MatrixConfigListConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t){"use strict";let i=e.extend({_uwaClassName:"MatrixConfigListConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"basic",values:[{text:t.TITLE,key:"title",dataIndex:"tree",fields:"title,name,rmcType",include:"matrix",icon:""}]});return i._instance=i._instance||new i,i._instance}),define("DS/ENOProjectMgmtCommonComponents/views/DetailsDisplay",["UWA/Core","UWA/Promise","DS/DocumentManagement/DocumentManagement","DS/E6WCommonUI/Views/DetailsDisplayView","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a){"use strict";return e.Class.View.extend({_uwaClassName:"DetailsDisplay",container:void 0,detailsDisplayView:void 0,parentView:void 0,model:void 0,customViewInitialized:!1,height:void 0,setup:function(e,t){this.container=e,this.parentView=t,this.height=t.getHeight(),this.model=t.currentModel,this.detailsDisplayView=new n({DocumentManagement:i,homeView:this.parentView,model:t.currentModel,displayMessage:s.displayMessage}),this.listenTo(this.model,"onValidationSuccess",this.clearValidationErrors)},setConfig:function(e){this._config=e},render:function(){if(!this._config)return;this.container.empty(),this.detailsDisplayView.setConfig(this._config.values),this.detailsDisplayView.render().inject(this.container);let e=Object.keys(this.model.localAttributes),t=Object.keys(this.model.localRelatedItems);e.length||t.length||(delete this.model.modificationsPending,this.parentView.showSaveCancelFooter(!1)),this.handleEvents()},handleEvents:function(){this.model.removeEvent("resetDetailsDisplay"),this.listenTo(this.model,{resetDetailsDisplay:this.resetConfigAndRender})},resetModel:function(e){this.detailsDisplayView.resetModel(e)},reRender:function(){this.detailsDisplayView&&this.detailsDisplayView.render()},acceptChanges:function(){this.resetConfigAndRender()},resetConfigAndRender:function(e){this.setConfig(e||this._config),this.render(),this.parentView.updateScrollPosition()},getFieldViewByName:function(){return this.detailsDisplayView&&this.detailsDisplayView.getFieldViewByName.apply(this.detailsDisplayView,arguments)},clearValidationErrors:function(){for(var e=this.container.getElements(".has-error"),t=0;t<e.length;t++)e[t].toggleClassName("has-error",!1)},destroy:function(){this.stopListening(),this.detailsDisplayView&&(this.detailsDisplayView.destroy(),delete this.detailsDisplayView)}})}),define("DS/ENOProjectMgmtCommonComponents/config/ProfileActionButtonConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/utils/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i){"use strict";let n=e.extend({_uwaClassName:"ProfileActionButtonConfig",type:"actionButtons",columnInfo:{},setup:function(){this.setColumnInfo()},values:[{name:"delete",value:"delete",text:i.DELETE,label:i.DELETE,fonticon:"trash"}],getItems:function(e){if(!e)return;let i,n,o=[],s=e.getActionsAttrsAccessMap().canDelete;return this.values.forEach(function(e){switch(e.name){case t.DELETE:i=Boolean(!s)}(n=UWA.clone(e||{},!1)).className=i?"disabled":"",o.push(n)}),o}});return n._instance=n._instance||new n,n._instance}),define("DS/ENOProjectMgmtCommonComponents/config/TabProfileConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/config/ProfilesPropertiesConfig","DS/ENOProjectMgmtCommonComponents/config/ProfileActionButtonConfig","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n){"use strict";let o=e.extend({_uwaClassName:"TabProfileConfig",columnInfo:{},type:"tab",hide:!0,setup:function(){this.setColumnInfo()},actionButtonConfig:function(e){return!(e&&e.isCreate)&&i},values:[{name:n.PROPERTIES,key:"properties",selected:!0,fields:"title,name,description,typeicon,image,modifyAccess,deleteAccess",config:t,checkFlag:!0}]});return o._instance=o._instance||new o,o._instance}),define("DS/ENOProjectMgmtCommonComponents/config/ProjectImportViewConfig",["UWA/Core","DS/ENOProjectMgmtCommonComponents/config/ConfigBase","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i){"use strict";let n=t.extend({_uwaClassName:"ProjectImportViewConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"basic",values:[{label:"Project Data",name:"title",relatedFieldsToSave:["chunks","identifier","projectUpdate"],type:"textarea",readWrite:!0,numberOfDisplayLines:1e3,numberOfEditableLines:1e3,maxLength:1e4,validate:!0}]});return n._instance=n._instance||new n,n._instance}),define("DS/ENOProjectMgmtCommonComponents/config/ChatCreateConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/config/ChatViewConfig"],function(e,t){"use strict";let i=e.extend({_uwaClassName:"ChatCreateConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"tab",hide:!0,values:[{name:"",key:"chatPrompt",selected:!0,config:t,checkFlag:!0}]});return i._instance=i._instance||new i,i._instance}),define("DS/ENOProjectMgmtCommonComponents/components/CommonTreeDocument",["UWA/Core","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils"],function(e,t,i,n,o){"use strict";let s,a=["select","unselect","modelUpdate"],l=["/WEBAPP/undefinedPOST_ADD/","/WEBAPP/undefinedPOST_REMOVE/"],r=t.extend({_uwaClassName:"CommonTreeDocument",init:function(t){let i=e.clone(t||{},!1);this.config=i.config,this.viewCollection=i.viewCollection,this.doNotApplyNodeExpand=i.doNotApplyNodeExpand,this._parent.apply(this,arguments),i.prepareUpdate&&this.prepareUpdate(),!this.doNotApplyNodeExpand&&this.initializeEvents()},handleContextExpansionCache:function(e,t){this.viewCollection.handleContextExpansionCache(e,t)},handleExpandNodeModel:function(e){let t=this,i=e.data.nodeModel,n=i.model;if(this.prepareUpdate(),i.hasChildren())e.target.preExpandDone(),t.handleContextExpansionCache(n.id,!0);else{let i=this.viewCollection.collection.get(n.id)?this.viewCollection.collection.clone():new this.viewCollection.DataModels(n);n&&this.viewCollection.getDataModels({model:n,expandCall:!0,paramData:[n],collection:i,onComplete:function(){e.target.preExpandDone(),t.viewCollection.updateCacheAndTaggerData(n,{childrenTaggerUpdate:!0}),t.handleContextExpansionCache(n.id,!0)}})}t.pushUpdate()},handleCollapseNodeModel:function(e){let t=e.data.nodeModel.model;this.handleContextExpansionCache(t.id,!1)},initializeEvents:function(){this.onPreExpand(this.handleExpandNodeModel.bind(this)),this.onPreCollapse(this.handleCollapseNodeModel.bind(this))},getNodeModelsLength:function(){let e=this.getAllDescendants();return e&&e.length||0},getNodeModels:function(){return this.getNodeModelsLength()&&o.getAttributeValues(this.getAllDescendants(),"model")||[]},getNonCachedNodeModels:function(){return this.getNodeModelsLength()&&o.filterObjects(this.getAllDescendants(),"cached","model")||[]},getNonCachedModels:function(e){let t=this.getNonCachedNodeModels().map(e=>e.model);return t.length&&o.filterObjects(t,e,["",void 0,null])||[]},getSelectedNodeModels:function(){return this.getNodeModelsLength()&&o.getAttributeValues(this.getSelectedNodes(),"model")||[]},getNodeModelLabel:function(e,t){let i=(t=t||this.config).columnInfo;return i.tree&&e.get(i.tree.key)||e.get("name")},createTreeNodeModel:function(t,o){let s,a=e.clone(o||{},!1),l=a.expandNode||t.model.expandNode,r=a.parentNode||this;try{let o=a.isNew,c=this.viewCollection.addAsLastChild,d=a.config,h=t.get("image"),u=a.isSelect,m=a.attributes,g=t.model.hasChildren(),p=e.is(r.isExpanded,"function"),C=!(this.doNotApplyNodeExpand||!p)&&r.isExpanded(),f=o&&!C&&p;if(f&&Boolean(r.getChildren())&&!r.hasChildren())return void r.expand();(s=new i({data:t,id:t.id,icons:[h],grid:m,label:this.getNodeModelLabel(t,d),children:g?[]:void 0})).model.cached||(s.model.cached=Boolean(o)),s.model.fetched||(s.model.fetched=Boolean(o)),c?r.addChild(s):r.addChild(s,0),u&&s.select(),!l&&(l=n.checkNodeForExpansion(t.id)),l&&s.expand(),f&&r.expand()}catch(t){e.log(t)}return s},copyChildNodes:function(e,t){let i,n,o=e.getChildren();o&&o.forEach(e=>{i=e.options,n=this.createTreeNodeModel(i.data,{isSelect:!1,config:this.config,parentNode:t,attributes:i.grid}),this.copyChildNodes(e,n)})},sort:function(){this._getRealTrueRoot().sortChildren(),this.getRoots().forEach(e=>{e.sortChildren()})},updateSortAndExpandAll:function(){this.pushUpdate(),this.sort(),this.expandAll()},getSelectedNode:function(e){let t=this.getSelectedNodes(),i=t.length;if(i)return t[e||i-1]},selectNodeByRowId:function(t){let i;if(e.is(t,"number")&&t>-1){let e=this.getAllDescendants();i=e&&e[t]}else i=this.getSelectedNode(t);i&&(i.isSelected()&&i.unselect(),i.select())},selectNodeById:function(e){let t=this.getTreeNodeModelById(e);t&&t.select()},getTreeNodeModelById:function(e){let t=this.getAllDescendants();return e&&t&&t.find(function(t){return t.id===e})},getPreviousSelectedNodeInfo:function(){return this.previousSelectedNodeInfo},getPreviousSelectedNodeId:function(){let e=this.getPreviousSelectedNodeInfo();return e&&e.id},getPreviousSelectedNodeRowId:function(){let e=this.getPreviousSelectedNodeInfo();return e&&e.rowID},getPreviousSelectedNodeModel:function(){let e=this.getPreviousSelectedNodeId();return e&&this.getTreeNodeModelById(e)},clearPreviousSelectedNodeInfo:function(){this.previousSelectedNodeInfo=!1},resetPreviousSelectionNodeModel:function(){let e=this.getTreeNodeModelById(this.getPreviousSelectedNodeId());e&&e._options.data.cancel()},resetTreeDocumentEvents:function(){let e=this.getModelEvents();e&&a.forEach(t=>{e.unsubscribeAll({event:t})});let t=this.getXSO(),i=t&&t._modelEvents;i&&l.forEach(e=>{let t=i._pubsub.topics[e],n=t.length;i._pubsub.topics[e]=t.slice(0,n-1)})}});return Object.defineProperty(i.prototype,"id",{get:function(){return this._options.id}}),Object.defineProperty(i.prototype,"cloneModel",{get:function(){return this._options.data}}),Object.defineProperty(i.prototype,"model",{get:function(){return this._options.data&&this._options.data.model}}),Object.defineProperty(i.prototype,"config",{get:function(){return this.getTreeDocument().config}}),Object.defineProperty(r.prototype,"previousSelectedNodeInfo",{get:function(){return s},set:function(e){s=e&&{id:e.options.id,rowID:e._rowID}}}),i.prototype.getNodeModelLabel=r.prototype.getNodeModelLabel,r}),define("DS/ENOProjectMgmtCommonComponents/config/ProjectImportConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/config/ProjectImportViewConfig"],function(e,t){"use strict";let i=e.extend({_uwaClassName:"ProjectImportConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"tab",hide:!0,values:[{name:"",key:"title",selected:!0,config:t,checkFlag:!0}]});return i._instance=i._instance||new i,i._instance}),define("DS/ENOProjectMgmtCommonComponents/config/CommonListConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t){"use strict";let i=e.extend({_uwaClassName:"CommonListConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"basic",values:[{text:t.TITLE,key:"title",dataIndex:"tree",fields:"title,name",icon:""}],doNotApplyNodeExpand:!0});return i._instance=i._instance||new i,i._instance}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtTrendView",["UWA/Core","UWA/Class/View","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomDataGridView","DS/ENOProjectMgmtModels/Models/AppSettings","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s){"use strict";return t.extend({_uwaClassName:"ProjectMgmtTrendView",_appContainer:void 0,_viewCollection:void 0,_matrixConfigCollection:void 0,_trendConfig:void 0,_trendChartConfig:void 0,_nlsTrend:void 0,init:function(t,i){let n=this,o=e.clone(i||{},!1);this._appContainer=t,this._viewCollection=o.viewCollection,this._matrixConfigCollection=o.MatrixConfigCollection,this._trendConfig=o.trendConfig,this._nlsTrend=o.nlsTrend,this._appContainer.setHTML(o.trendTemplate),this._chartConfig=e.clone(o.trendChartConfig||{}),this.Highcharts=s.get("highcharts"),this.trendChartDiv=this._appContainer.getElement(".trend-chart"),this._riskTrendGridView=this._appContainer.getElement(".risk-trend-grid"),this.trendChartDiv.addEvent("resize",function(){n.trendChart&&n.trendChart.reflow()}),this._chartConfig.chart.renderTo=this.trendChartDiv},render:function(){let e=this,t=this._viewCollection.getCurrentDataModel(),i=t&&t.model._sourceType;return this._viewCollection.getDataModelTrend(i).then(function(i){if(e.Highcharts){e._appContainer.getElement("#chartLabel").setHTML(e._nlsTrend);let n=e.getRiskTrendData(i);if(e._chartConfig.series[0].data=n,t.isRiskTypeObject){let i=e._chartConfig.goalLineDashStyle,n=e._chartConfig.goalLineDashColor,o=e._chartConfig.goalLineDashWidth,s=e._chartConfig.goalLineLabel,a=Number(t.get("rpnValueGoal"));a&&(e._chartConfig.yAxis.plotLines=[{value:a,color:n,width:o,dashStyle:i,label:{useHTML:!0,formatter:function(){return"<span>"+s+" : "+a+"</span>"}}}])}e.trendChart=new e.Highcharts.Chart(e._chartConfig),e.trendChart.redraw()}let n=e._viewCollection.getCurrentDataModel();e._trendConfig.setModel(n.model),e.treeDocument=e._viewCollection.createTreeDocumentForCollection(i,{config:e._trendConfig}),e.riskTrendDataGrid=new o({container:e._riskTrendGridView,treeDocument:e.treeDocument,config:e._trendConfig})}),this._appContainer},reload:function(){this.trendChart&&this.riskTrendDataGrid&&(this.trendChart.destroy(),this.trendChart=void 0,this.riskTrendDataGrid.destroy(),this.render())},setYAxisMax:function(e){e>this._chartConfig.yAxis.max&&(this._chartConfig.yAxis.max=e)},getRiskTrendData:function(e){let t=this,i=[],o="",s=this._viewCollection.getCurrentDataModel(),a=s.model.get("state");if("Complete"===a){let e=n.getFormattedDate(s.model.get("actualFinishDate"));o=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())}else{let e=new Date;o=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())}let l="Complete"===a?"fonticon-status-ok ":"fonticon-expand-right ",r=n.getFontIconElement(l,{additionalClass:"object-maturity "+a.toLowerCase()});r=r&&r.getHTML()||"";let c=Number(s.model.get("rpnValue"));this.setYAxisMax(c),i.push({x:o,y:c,marker:{symbol:"url()"},fontIcon:r});let d=s&&s.model.getRMCActualId(),h=d&&this._matrixConfigCollection.getMatrixConfigById(d),u=h&&h.get("matrix").severity;return e.forEach(function(e){let a=n.getFormattedDate(e.get("modified"));o=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate());let l=h&&s.model.getMatrixCellInfo(h,e.get("rpnImpact"),e.get("rpnProbability")),r=n.findObject(u,"riskLevel",l&&l.riskLevel),c=Number(e.get("rpnValue"));t.setYAxisMax(c),i.push({x:o,y:c,marker:{fillColor:r&&r.backgroundColor||"#77797C",states:{hover:{fillColor:r&&r.backgroundColor||"#77797C"}}}})}),i},destroy:function(){this._riskTrendGridView.destroy(),this.trendChart&&this.trendChart.destroy(),this.riskTrendDataGrid&&this.riskTrendDataGrid.destroy(),this._appContainer&&this._appContainer.destroy()}})}),define("DS/ENOProjectMgmtCommonComponents/utils/MatrixConfigCloneModel",["UWA/Core","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel","DS/ENOProjectMgmtCommonComponents/constants/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s){"use strict";let a,l;return n.extend({_uwaClassName:"MatrixConfigCloneModel",add:function(t,i,n){let o=e.clone(n||{},!1);if("configuredItems"===t)return o.sourceType="matrixConfiguration",o.refresh=!0,o.rmcType=o.model.get("rmcType"),void((i=this._addModel(t,i,o))&&i.length&&i.forEach(e=>{e.addEventOnce("onSync",this.handleWhereUsedOnSync.bind(this,{fieldName:t,whereUsedOptions:o}))}));this._parent(t,i,o)},validateMatirx:function(t){let i=!0,n=!0,o={fields:[],messages:{}},a=t.title;if(a){this._isString(a)&&a.trim().length||(i=!1,o.fields.push(s.INCORRECT_TITLE))}else i=!1,o.fields.push(s.CREATE_BLANK_TITLE_ALERT);let l=t.matrix;if(l&&e.is(l,"object")&&l)if(l.Xaxis&&l.Yaxis&&l.cells&&l.severity){let e=l.severity;(e&&this._isArray(e)&&e.length)>25?(i=!1,o.fields.push(s.ERROR_RISK_LEVEL_LIMIT)):i=this._validateRiskLevelsInfo(e,o,i);let t=l.Xaxis,a=t&&t.name;a&&this._isString(a)&&a.trim().length||(i=!1,o.fields.push(s.INCORRECT_AXIS_NAME));let r=t&&t.nodes,c=r&&this._isArray(r)&&r.length;(c<3||c>5)&&(i=!1,n=!1,o.fields.push(s.ERROR_NODES_LIMIT)),n&&(i=this._validateNodeInfo(r,o,i));let d=l.Yaxis,h=d&&d.name;h&&this._isString(h)&&h.trim().length||(i=!1,o.fields.push(s.INCORRECT_AXIS_NAME));let u=d&&d.nodes,m=u&&this._isArray(u)&&u.length;n&&(m<3||m>5)&&(i=!1,n=!1,o.fields.push(s.ERROR_NODES_LIMIT)),n&&(i=this._validateNodeInfo(u,o,i));let g=l.cells,p=g&&g.length,C=c*m;i&&p>25&&p!==C?(i=!1,o.fields.push(s.INVALID_TOTAL_CELLS)):i=this._validateCellsInfo(g,o,i,c,m,e)}else i=!1,o.fields.push(s.INVALID_CONFIGURATION_FORMAT);else i=!1,o.fields.push(s.NO_CONFIGURATION);return this.dispatchEvent("disableSaveButton",!i),this.dispatchEvent("onChangeImportFile",{isValid:i,errorMessage:o.fields}),i},compareCell:function(e,t){if(e.cells.length!==t.cells.length)return!1;for(let i=0;i<e.cells.length;i++){let n=e.cells[i],o=t.cells[i];if(n.Xvalue!==o.Xvalue||n.Yvalue!==o.Yvalue)return!1}return!0},_validateRiskLevelsInfo:function(e,t,i){let n=this;return a={},e&&e.forEach(function(e,o){if(!i)return;let l=e.riskLevel;if(a[l])i=!1,t.fields.push(s.DUPLICATE_RISK_LEVEL);else{a[l]=l;let o=l&&n._isString(l)&&l.trim().length,r=e.name,c=e.backgroundColor,d=e.textColor,h=r&&n._isString(r)&&r.trim().length,u=c&&n._isValidColor(c),m=d&&n._isValidColor(d);(!i||o)&&h&&u&&m||(i=!1,t.fields.push(s.INCORRECT_RISK_LEVEL_VALUE))}}),i},_validateNodeInfo:function(e,t,i){let n=this;return e&&e.forEach(function(e,o){if(!i)return;let a=e.label,l=a&&n._isString(a)&&a.trim().length,r=e.value&&Number(e.value);(i&&!l||r!==o+1)&&(i=!1,t.fields.push(s.INCORRECT_NODES_VALUE))}),i},_validateCellsInfo:function(e,i,n,o,a,r){let c=this;return l={},e&&e.forEach(function(e){if(!n)return;let d=e.Xvalue,h=e.Yvalue,u=d+h;if(l[u])n=!1,i.fields.push(s.DUPLICATE_CELL_XY_VALUE);else{l[u]=u;let m=e.defaultCellId,g=void 0===m;m&&(g=m&&c._isNormalInteger(m)&&m>0&&m<=25);let p=e.riskLevel,C=p&&c._isString(p)&&p.trim().length&&Boolean(t.findObject(r,"riskLevel",p)),f=d&&c._isNormalInteger(d)&&d<=o,D=h&&c._isNormalInteger(h)&&h<=a,w=e.rpn,E=w&&Number(w)&&w>0;(!n||g)&&f&&D&&C&&E||(n=!1,i.fields.push(s.INCORRECT_CELLS_VALUE))}}),n},handleWhereUsedOnSync:function(e,t){let n,o=e.fieldName,a=e.whereUsedOptions,l=t.get("configuration"),r=l&&l.length&&l[0];if(r&&"TRUE"!==r.resolved){n='"'+(t.get("title")||t.get("name"))+'" '+s.OBJECT_ALREADY_ASSOCIATED+' "'+(r.title||r.name)+'"'}else t.isXPlanObject()&&!t.canCreate()&&(n=s.NO_RMC_ACCESS);if(n)return i.buildNotification({message:n},"error"),void(!this.model.isNew()&&!Object.keys(this.localAttributes).length&&this.dispatchEvent("disableSaveButton",!0));a.changed=Boolean(!n),this.setRelatedItemData(o,t,a)},isDefault:function(){let e=this.get("name");return e===o.DEFAULT||e===o.DEFAULT_OPPORTUNITY},_isValidColor:function(e){e=e.toLowerCase();let t=(new Option).style;t.color=e;let i=t.color===e,n=/^#[0-9A-F]{6}$/i.test(e);return Boolean(i||n)},_isNumber:function(t){return e.is(Number(t),"number")},_isString:function(t){return e.is(t,"string")},_isArray:function(t){return e.is(t,"array")},_isNormalInteger:function(e){return/^(0|[1-9]\d*)$/.test(e)}})}),define("DS/ENOProjectMgmtCommonComponents/views/MassUpdateView",["UWA/Core","UWA/Class/View","DS/PlatformAPI/PlatformAPI","DS/LifecycleCmd/MaturityCmd","DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_TransferOwnershipCmd","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/config/MassUpdateToolbarConfig"],function(e,t,i,n,o,s,a,l){"use strict";return t.extend({_uwaClassName:"MassUpdateView",init:function(e){this.parentView=e,this.massUpdateToolbarConfig=l,function(){let e=this,t=n.prototype.executeCmd;n.prototype.executeCmd=function(i){let n=i&&i.controller;e.listenTo(n,"onStateChanged",e.updateTreeDocument.bind(e)),e.listenTo(n,"onError",function(t){e.isOnErrorEventInvoked=t.dontshowsuccess}),t.apply(this,arguments),delete e.maturityPopupInvoked}}.apply(this,arguments),this.subscribeToPlatformEvents()},handleMassUpdateButtonEvents:function(e){let t=this.parentView.getViewCollection();switch(e){case s.DUPLICATE:t.duplicateDataModels({operation:e,isSelect:this.parentView._detailsAndRelationships.prototype._isPropertyPanelOpen});break;case s.MATURITY:this.handleChangeMaturity();break;case s.CHANGE_OWNER:this.handleChangeOwner();break;case s.RELATIONS:this.handleRelations();break;case s.EXPORT:t.export()}},handleChangeMaturity:function(e){if(delete this.isOnErrorEventInvoked,!this.maturityPopupInvoked){this.maturityPopupInvoked=!0;let t=this.getSelectedNodes(e);if(t.length){(new n).execute(t)}}},handleChangeOwner:function(){let e=this.getSelectedNodes();if(e.length){new o({context:{getSelectedNodes:()=>e},ID:"ActionBar_ChangeOwner"}).execute()}},handleRelations:function(){a.launchApp(s.RELATIONS_WIDGET_APP_ID,this.parentView.getViewCollection().treeDocument.getSelectedNodeModels())},subscribeToPlatformEvents:function(){let e=this;i.unsubscribe("ENOLC_MOVE_CMD_UPDATE"),i.subscribe("ENOLC_MOVE_CMD_UPDATE",function(t){let i=t&&t.data,n=i&&i.paths;e.massUpdateForResultData(n)}),this.listenTo(this.parentView,"invokeMaturityUpdate",this.handleChangeMaturity)},updateTreeDocument:function(e){let t=e&&!this.isOnErrorEventInvoked&&e.data;this.massUpdateForResultData(t)},massUpdateForResultData:function(e){if(e){let t=[];if(e&&e.length&&e.forEach(function(e){let i=e.physicalid||e;t.push({objectId:i})}),t&&t.length){let e=this.parentView.getViewCollection(),i={collection:e.collection.clone(),paramData:t,onComplete:this.onCompleteMassUpdate.bind(this),isMassUpdate:!0,fields:this.massUpdateToolbarConfig.fetchOptions.fields,includeFields:this.massUpdateToolbarConfig.fetchOptions.includeFields};e.fetchAdditionalDataForModels(i)}}},onCompleteMassUpdate:function(){let e=this.parentView.getCurrentView();if(e){let t=e.detailsAndRelationships;t&&t.currentModel&&t.postCreateProcess()}},getSelectedNodes:function(t){t&&!e.is(t,"array")&&(t=[t]);let i=[],n=this.parentView.getViewCollection();return(t=t||n.treeDocument.getSelectedNodes())&&t.length&&t.forEach(e=>{let t=e.options.data,n=t.title,o=function(){return n};i.push({displayName:n,getLabel:o,getDisplayName:o,physicalid:t.id,getID:function(){return t.id},getType:function(){return t.get("type")},getOwner:function(){return t.get("owner")}})}),i}})}),define("DS/ENOProjectMgmtCommonComponents/views/DetailsDisplayFooter",["UWA/Class","DS/Controls/Button","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n){"use strict";return e.extend({_uwaClassName:"DetailsDisplayFooter",parentView:void 0,closeButton:void 0,saveButton:void 0,cancelButton:void 0,init:function(e,i){this.container=e,this.parentView=i,this.saveButton=new t({domId:"saveButton",label:n.SAVE,visibleFlag:!1,emphasize:"primary"}).inject(this.container),this.cancelButton=new t({domId:"cancelButton",label:n.CANCEL,visibleFlag:!1,emphasize:"secondary"}).inject(this.container),this.closeButton=new t({domId:"closeButton",label:n.CLOSE,visibleFlag:!0,emphasize:"secondary"}).inject(this.container),this.initialiseSaveEventChangeListener(),this.initialiseCancelEventChangeListener(),this.initialiseCloseEventChangeListener()},initialiseSaveEventChangeListener:function(){let e=this;e.saveButton.removeEventListener("buttonclick"),e.saveButton.label=n.SAVE,e.saveButton.getContent().addEventListener("buttonclick",function(){e.parentView.save()})},initialiseCancelEventChangeListener:function(){this.cancelButton.removeEventListener("buttonclick"),this.cancelButton.label=n.CANCEL,this.cancelButton.getContent().addEventListener("buttonclick",i.validateModificationsPending.bind(void 0,{dontResetModel:!0,parentView:this.parentView.parentView.parentView,yesEventFunc:this.parentView.cancelCreateOrEdit.bind(this.parentView)}))},initialiseCloseEventChangeListener:function(){let e=this;e.closeButton.removeEventListener("buttonclick"),e.closeButton.label=n.CLOSE,e.closeButton.getContent().addEventListener("buttonclick",function(){e.parentView.hideRightPanel()})},showSaveCancelFooter:function(e){e?(this.closeButton.visibleFlag=!1,this.saveButton.visibleFlag=!0,this.cancelButton.visibleFlag=!0):(this.closeButton.visibleFlag=!0,this.saveButton.visibleFlag=!1,this.saveButton.disabled=!1,this.cancelButton.visibleFlag=!1)},destroy:function(){this.container.classList.add("footerContainer"),this.saveButton.destroy(),this.cancelButton.destroy(),this.closeButton.destroy()}})}),define("DS/ENOProjectMgmtCommonComponents/config/HeatMapChartConfig",["DS/ENOProjectMgmtCommonComponents/config/AppConfig","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i){"use strict";let n=new e;return{_uwaClassName:"HeatMapChartConfig",goalPatternPath:"M 0 0 L 10 10 M 9 -1 L 11 1 M -1 9 L 1 11",goalPatternStrokeWidth:"4",goalXAxisField:"impactGoal",goalYAxisField:"probabilityGoal",xAxisField:"impact",yAxisField:"probability",rpnIcon:"fonticon-check",goalIcon:"fonticon-status-empty",overlappingIcon:"fonticon-status-ok",goalPatternOpacityValue:"0.80",chart:{type:"column",spacingBottom:0,spacingTop:-15,spacingLeft:0,spacingRight:0,plotBackgroundColor:null,animation:{easing:t.easeInOutSineProjectMgmt}},exporting:!1,credits:!1,title:!1,xAxis:{lineWidth:0,tickLength:0,categories:void 0,title:{text:i.IMPACT,style:{fontWeight:"bold",color:n.ChartsColor.BLUE4_COLOR}},labels:{y:0},tickMarkPlacement:"off"},yAxis:{gridLineColor:"#fff",categories:void 0,width:"50px",title:{text:i.PROBABILITY,style:{fontWeight:"bold",color:n.ChartsColor.BLUE4_COLOR}},labels:{y:-13,style:{width:"110px",overflow:"hidden",textOverflow:"ellipsis"}}},tooltip:{enabled:!1},plotOptions:{series:{animation:!1,showInLegend:!1,pointPadding:0,groupPadding:0},column:{stacking:"normal",cursor:"pointer",dataLabels:{enabled:!0,style:{fontFamily:"Arial",fontSize:"15px",textOutline:"none"}}}},series:void 0}}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtFileChooserCustomView",["UWA/Core","DS/Tweakers/TweakerBlob","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o){"use strict";return i.extend({supportedFormats:["json"],buttonGroup:void 0,toggle:void 0,setup:function(e){this.options=e,this.homeView=e&&e.homeView.parentView,this._parent(e)},render:function(){return this.container.empty(!0),this.fileUploader=new t({placeholder:o.SELECT_FILE}).inject(this.container),this.fileUploader.addEventListener("change",this._fileFieldChange.bind(this)),this},_fileFieldChange:function(e){var t=this;delete t.files;var i=e.dsModel.blob;if(i)if(t.files=e.dsModel,t.fileName=t.files._blobName,t._isValidFormat(e.dsModel._blobName)){let e,s=new FileReader;s.addEventListener("load",function(){try{let i=JSON.parse(s.result);if(t.model.model.isNew()||t.model.compareCell(t.model.get("matrix"),i.matrix)){t.model.validateMatirx(i)?t.model.set({title:i.title,matrix:i.matrix,rmcType:t.homeView._rmcType}):e=!0}else n.buildNotification({message:o.MATRIX_CONFIGURATION_FIELD_CHANGE_ERROR},"error"),e=!0}catch(i){t.jsonError(i),e=!0}e&&(t.model.cancel(),t.model.dispatchEvent("disableSaveButton",Boolean(e)),t.clearFileUploaderText())}),s.readAsText(i)}else n.buildNotification({message:o.INVALID_FILE_FORMAT},"error")},clearFileUploaderText:function(){let e=this.fileUploader.getContent(),t=e&&e.getElement(".wux-tweakers-blob-span-text");t&&t.setContent()},_isValidFormat:function(e){var t=e.lastIndexOf("."),i=(t<1?"":e.substr(t+1)).toLowerCase();return this.supportedFormats&&-1!==this.supportedFormats.indexOf(i)},jsonError:function(e){e=e.name+" : "+e.message,n.buildNotification({title:o.MATRIX_CONFIGURATION_ERROR,message:e,hideDelay:5e3},"error")}})}),define("DS/ENOProjectMgmtCommonComponents/utils/MassUpdateCloneModel",["UWA/Core","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel"],function(e,t,i){"use strict";return i.extend({_uwaClassName:"MassUpdateCloneModel",isMassUpdate:!0,validate:function(e,t){let i=!0,n={fields:[],messages:{}};return this.getDateFieldValue("effectiveDate",e)||(i=!1,n.fields.push("effectiveDate")),i=i&&this.validateStartEndDates(e,n,t),this.dispatchEvent("disableSaveButton",!i),i?this.dispatchEvent("onValidationSuccess")&&void 0:n},set:function(t,i,n){return"select"===e.clone(n||{},!1).type&&(i&&e.is(i,"object")&&(i=i.actualValue),arguments[1]=i),this._parent.apply(this,arguments)},get:function(e){let i=this._parent.apply(this,arguments);if(i)switch(e){case"effectiveDate":case"actualStartDate":case"actualFinishDate":case"estimatedStartDate":case"estimatedFinishDate":i=i&&t.getIntlDateFormat(i.actualValue||i)}return i}})}),define("DS/ENOProjectMgmtCommonComponents/components/TaggerProxy",["UWA/Core","UWA/Promise","UWA/Class/Events","UWA/Class/Listener","UWA/Class/Collection","DS/TagNavigatorProxy/TagNavigatorProxy","DS/ENOProjectMgmtModels/Collections/Tags","DS/ENOProjectMgmtModels/Models/Tag","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils"],function(e,t,i,n,o,s,a,l,r,c){"use strict";return i.extend(n,{_uwaClassName:"TaggerProxy",collection:void 0,_matrixConfigCollection:void 0,tnProxy:void 0,tags:void 0,taggerData:void 0,init:function(t,i){let n=e.clone(i||{},!1);this.tnProxy=n.tnProxy,this.collection=t,this._matrixConfigCollection=i.matrixConfigCollection},getTagPostData:function(){let e,t=this.collection;return t&&t.length&&t.forEach(function(t){e?e+=","+t.get("id"):e=t.get("id")}),e},loadTagData:function(i){let n=this,o=e.clone(i||{},!1);return new t(function(e,t){n.tags=new a;let i=n.getTagPostData();if(!i||""===i)return n.setTNProxy(),e();n.tags.fetch({idList:i,onComplete:function(t){if(o.isSeverityExistsInTagger){let e=r.get("context");t&&t.forEach(function(t){let i=n.collection.get(t.id);i&&t.updateSeverityTag(i,e,n._matrixConfigCollection)})}n.setTNProxy(t),e()},onFailure:function(e,i){t(i)}})})},setTNProxy:function(e){this.register(),e&&e.length?this.drawTags(e):this.drawTags([])},drawTags:function(e){let t=this.buildTagObjectData(e);this.setTaggerData(t)},setTaggerData:function(e){this.tnProxy&&e&&(this.tnProxy.setSubjectsTags(e,"prjMgmtTagSubjects"),this.taggerData=e)},getItemId:function(e){return"pid://"+e.id},buildTagObjectData:function(e){let t={},i=this;return e.forEach(function(e){let n=i.buildItemData(e),o=i.getItemId(e);t[o]=n}),t},buildItemData:function(e){let t="_tag_implicit_".length,i="_tag__".length,n=[];try{e.keys().forEach(function(o){if("id"===o)return;let s,a="";-1===o.indexOf("_tag_implicit_")?s=i:(a="implicit",s=t);let l=e.get(o),r=o.substr(s),c=l.length;for(let e=0;e<c;e++){let t={object:l[e],dispValue:l[e],sixw:r,field:a};n.push(t)}})}catch(e){console.error("loadTagDataDone"+e)}return n},updateTagObject:function(e,i,n){let o=this,s=r.get("context");return new t(function(t,a){let r=o.tags.get(e.get("id"));if(i){if(r){o.tags.remove(r);let e=o.getItemId(r);delete o.taggerData[e],o.setTaggerData(o.taggerData)}t()}else r||((r=new l(r)).set("id",e.get("id")),o.tags.add(r)),r&&(r.updateTagger(o._matrixConfigCollection,e,n,s)&&o.updateTagData(r),o.updateTagData(r)),t()})},updateMappedTagObjects:function(e){let t=this,i={"_tag_implicit_ds6w:what/ds6w:heatMap":"mappedMatrixXY","_tag_implicit_ds6w:why/ds6w:fulfills/ds6w:severity":"mappedSeverity"};e&&e.length&&e.forEach(function(e){let n=e.options.data.model,o=t.tags.get(n.get("id"));o&&o.updateMatrixTag(n,i,t._matrixConfigCollection)}),this.drawTags(this.tags)},updateTagData:function(e){let t=this.buildItemData(e),i=this.getItemId(e);this.taggerData[i]=t,this.subjectChangedRequired=!1,this.setTaggerData(this.taggerData)},handleFocusOnSubjects:function(e){if(this.tnProxy)if(e&&e.length){let t=[],i={};e.forEach(e=>{t.push("pid://"+e),i[e]="3DSpace"}),this.focusOnSubjects(t,!0,i)}else this.unfocus()},focusOnSubjects:function(){this.tnProxy.focusOnSubjects.apply(this.tnProxy,arguments)},unfocus:function(){this.tnProxy.unfocus.apply(this.tnProxy,arguments)},set6WFilterOptions:function(e,t){if(this.tnProxy){let i={};i[e]=[{disptext:t,object:t,type:"string",field:["implicit"]}],this.setLocalFilter(i,!0)}},setLocalFilter:function(t,i){e.is(t,"object")&&this.tnProxy&&(this.subjectChangedRequired=!0,this.tnProxy.setLocalFilter(t,i))},subjectChanged:function(e){this.collection&&!e.dontCacheFilters&&this.dispatchEvent("onSubjectChanged",[e])},register:function(){let e=this;if(this.tnProxy)this.collection&&(this.tnProxy.removeEvent("onFilterSubjectsChange"),this.tnProxy.addEvent("onFilterSubjectsChange",this.subjectChanged.bind(this)));else if(!r.get("doNotInitializeTaggerProxy")){let t=r.get("widgetId"),i=r.get("tenant"),n={widgetId:t,contextId:t?void 0:"context1",tenant:"onpremise"===i?void 0:i,filteringMode:"WithFilteringServices",colorize:!0};this.tnProxy=s.createProxy(n),this.tnProxy.addEvent("onFilterSubjectsChange",this.subjectChanged.bind(this),this.collection),window.onunload=function(){e.tnProxy&&e.tnProxy.die()}}},handleUserTags:function(t){let i;t&&(i=e.is(t,"array")?t.length&&c.getAttributeValues(t,"id"):[t]),this.handleFocusOnSubjects(i)},destroy:function(){this.tnProxy&&(this.tnProxy.die(),this.tnProxy=null)}})}),define("DS/ENOProjectMgmtCommonComponents/collection/ProjectMgmtViewCollection",["UWA/Core","UWA/Class/Model","UWA/Promise","DS/ENOProjectMgmtModels/Models/SaveModels","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Models/RelatedDataItem","DS/ENOProjectMgmtModels/Models/FieldsDefinition","DS/ENOProjectMgmtModels/Utils/StorageDataUtil","DS/ENOProjectMgmtModels/Collections/RelatedDataItems","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/utils/MassUpdateCloneModel","DS/ENOProjectMgmtCommonComponents/components/TaggerProxy","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/components/CommonTreeDocument","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g,p){"use strict";return t.extend({_uwaClassName:"ProjectMgmtViewCollection",treeDocuments:{},storageDataUtil:l,setup:function(e){e&&(this.DataModels=e.DataModels,this.DataModel=e.DataModel,this.AppConfig=e.AppConfig,this.PropertiesConfig=e.PropertiesConfig,this.TabConfig=e.TabConfig,this.TabConfigForCreate=e.TabConfigForCreate,this.ListConfig=e.ListConfig,this.CloneModel=e.CloneModel,this.governingType=e.governingType,this.governingTypeNLS=e.governingTypeNLS,this.NLS=e.NLS,this.defaultDataModelAttrs=e.defaultDataModelAttrs,this.tabConfigForMassUpdate=e.tabConfigForMassUpdate,this.massUpdateCloneModel=e.massUpdateCloneModel||h,this.fieldDefinitionSource=e.fieldDefinitionSource,this.addAsLastChild=e.addAsLastChild)},getDocument:function(e,t){return e?(this.treeDocuments[e]&&!t||(this.treeDocuments[e]=new g({prepareUpdate:!0,viewCollection:this,config:this.ListConfig,doNotApplyNodeExpand:this.treeDocument.doNotApplyNodeExpand}),this.treeDocuments[e].copyChildNodes(this.treeDocument),this.treeDocuments[e].updateSortAndExpandAll()),this.treeDocuments[e]):this.treeDocument},resetCollection:function(e){this.treeDocument&&this.treeDocument.destroy(),this.collection&&this.collection.reset(),this.collection=e||new this.DataModels,this.treeDocument=this.createTreeDocumentForCollection(e)},resetTreeDocument:function(t){let i=this,n=e.clone(t||{},!1),o=n.view&&this.treeDocuments[n.view]||this.treeDocument;o&&o.prepareUpdate()&&o.empty(),n.collection&&(this.collection=n.collection),o=this.createTreeDocumentForCollection(this.collection,t),t&&t.addChild?(n.onComplete=function(e){t&&t.view?(i.treeDocuments[t.view]=e,t.onComplete(i.treeDocuments[t.view])):(i.treeDocument=e,t.onComplete(i.treeDocument))},this._fetchChildDetails(o,n)):n.view?i.treeDocuments[n.view]=o:i.treeDocument=o},getCurrentNode:function(e,t){let i,n=this.getDocument(t);return n&&!(i=n.getSelectedNode())&&(i=n.getAllDescendants()[e]),i},getCurrentDataModel:function(e,t){let i=this.getCurrentNode(e,t);return i&&i.options.data},getDataModelsCount:function(e){let t=this.getDocument(e);return t?t.getNodeModelsLength():this.collection?this.collection.length:0},getCollection:function(){return this.collection},getModelsCountWithInvalidConfig:function(){let e=this.treeDocument.getChildren(),t=e&&e.length&&e.filter(function(e){let t=e.options.data.model;return"FALSE"===(t.validConfiguration||t.get("validConfiguration"))});return t&&t.length},getModelsCountWithInvalidConfigForContext:function(){let e=this.treeDocument.getChildren(),t=e&&e.length&&e.filter(function(e){let t=e.options.data.model,i=t.contextValidConfiguration||t.get("contextValidConfiguration"),n=t.validConfiguration||t.get("validConfiguration");return"FALSE"===i&&"TRUE"===n});return t&&t.length},reselectCurrentDataModel:function(){if(!this.treeDocument)return;this.treeDocument.resetPreviousSelectionNodeModel();let e=this.getCurrentNode();e&&this.selectDataModel(void 0,e)},selectDataModel:function(e,t){t?(this.unselect(),t.select()):this.treeDocument.selectNodeByRowId(e)},getNewDataModel:function(t,i){let n=e.clone(i||{},!1),o=n.attributes||this.defaultDataModelAttrs,s=n.DataModel?new n.DataModel(o):new this.DataModel(o);if(n.private)for(let e in n.private)n.private.hasOwnProperty(e)&&(s[e]=n.private[e]);s.setTempId();let a={config:t,model:s,CloneModel:n.CloneModel,isMassUpdate:n.isMassUpdate};return this.createClonedModel(a)},setFieldsFromConfig:function(e,t,i,n,o){let s=t.dataIndex&&"tree"===t.dataIndex?t.key:t.dataIndex||t.name;if(e.isNew()||(void 0===e.get(s)||null===e.get(s))&&!t.isCustom){if(t.defaultValue)i?i[s]=t.defaultValue:e.set(s,t.defaultValue);else if(i&&t.readWrite)i[s]="";else if(e.has(s)){!e.get(s)&&e.set(s,"")}}else if(n){let i=e.get(s),l=t.typeRepresentation;if(l&&(n[s]=this.getTypeRepresentationValue(l,i)),void 0===n[s])if(t.mapFromRangeValue){let e;if(e=o?a.getFieldServiceColumn(this.fieldDefinitionSource,o,s):a.getFieldDefinitionColumn(this.fieldDefinitionSource,s)){let t=e.fieldDefinitionRangeItem[i].display;n[s]=t}else n[s]=i}else n[s]=i}},getTypeRepresentationValue:function(t,i){let n=i;switch(t){case"string":n=i instanceof e.Class.Collection?d.getAttributeValues(i,"title")||"":i;break;case"detailedInfo":i.length&&(e.is(i,"string")||(n=[],i.forEach(e=>{n.push({label:e.title,icon:e.get("image")})})));break;case"number":n=Number(i);break;case"progress":n=parseInt(i);break;case"array<integer>":n=i&&i.map(Number);break;case"array<boolean>":n=i&&i.map(Boolean)}return n},createModelFields:function(e,t,i,n,o){let s=t.columnInfo;for(let t in s)e.isNew()?this.setFieldsFromConfig(e,s[t]):this.setFieldsFromConfig(e,s[t],i,n,o)},getRecursiveDataModels:function(e,t,i){let n=[],o=this.collection;return o&&o.length&&o.forEach(o=>{let s=o,a=!1;i.forEach(i=>{let n=s.get(i);if(n&&n.length){d.filterObjects(n,e,t).length&&(a=!0)}}),a&&(s.expandNode=!0,n.push(s))}),n},filterDataModels:function(t,i,n){let o,s=e.clone(n||{},!1).filterFromTreeDocument,a=this.collection;if(this.searchValue=t,s){let e=this.treeDocument.getNodeModels();e.length&&(a=e)}return o=this.performFilter(a,t,i,n),this.treeDocument=this.createTreeDocumentForCollection(o||this.collection),this.treeDocument},createClonedModel:function(t){let i,n,o={},s={},a=e.clone(t||{},!1),l=a.isNew,r=a.model,c=a.service,d=a.isSelect,h=a.isMassUpdate,u=a.treeDocument,m=a.treeNodeModel;if(r){let e=a.config||u&&u.config;e&&this.createModelFields(r,e,o,s,c);let t=h?this.massUpdateCloneModel:this.CloneModel;if(i=a.CloneModel?new a.CloneModel(r,a):new t(r,a),!r.isNew())for(let e in o)o.hasOwnProperty(e)&&i.set(e,o[e])}if(m)try{m.updateOptions({label:m.getNodeModelLabel(i),data:i,grid:s})}catch(t){e.log(t)}else!u||u instanceof g||(u=(n=u).getTreeDocument()),u&&!u.getTreeNodeModelById(i.id)&&u&&u.createTreeNodeModel(i,{isNew:l,isSelect:d,attributes:s,parentNode:n});return i},getSpecificTabConfig:function(e,t){let i,n=t||{};return i=e.isMassUpdate?n.tabConfigForMassUpdate||this.tabConfigForMassUpdate:e.model.isNew()?n.tabConfigForCreate||this.TabConfigForCreate:n.tabConfig||this.TabConfig},resetDataModelFromClone:function(e,t){let i=this;if(e){let n={};this.getSpecificTabConfig(e,t).values.forEach(function(t){t.config&&t.config.values.forEach(function(t){i.prepareLocalAttributesToModelAttributes(n,e,t)})}),e.model.set(n)}},setStartStopAttrInfo:function(t,i,n){let o=this;if(e.is(i,"array")){let e=[];i.forEach(t=>{e.push(o.convertDate(t.actualValue||t))}),n[t]=e}else i&&(n[t]=this.convertDate(i.actualValue||i))},setUOMAttrInfo:function(t,i,n){e.is(i,"number")?n[t]=a.getFieldRangeItemActualValue(this.fieldDefinitionSource,t,i):n[t]=i},prepareLocalAttributesToModelAttributes:function(t,i,n){let o,s=n.key,a=n.name,l=n.type,r=i.localAttributes,c=r.hasOwnProperty(a),d=r[a];if(c&&!d&&(d=n.hasOwnProperty("defaultValue")&&n.defaultValue||""),!d&&"startStop"===l){let e=n.endDateAttribute,i=r[e];null!=i&&(this.setStartStopAttrInfo(e,i,t),o=!0)}if(null!=d&&!o){if("date"===l||"startStop"===l){this.setStartStopAttrInfo(a,d,t);let e=n.endDateAttribute;e&&(d=r[e],this.setStartStopAttrInfo(e,d,t))}else if("uom"===l){this.setUOMAttrInfo(a,d,t);let e=n.unitAttribute;e&&(d=r[e])&&this.setUOMAttrInfo(e,d,t,i)}else if("object"!==l&&"person"!==l||i.model.get(a)){let i=d;e.is(d.actualValue,"string")&&(i=d.actualValue),s?(t[s]=i,t[a]=void 0):t[a]=i}else s&&d.length?t[s]=d.at(0).get("id"):t[a]=d;n.relatedFieldsToSave&&n.relatedFieldsToSave.forEach(e=>{t[e]=i.get(e)})}},convertDate:function(e){return e?new Date(e):e},createTreeDocumentForCollection:function(t,i){let n=this,o=e.clone(i||{},!1),s=t,a=o.config||this.ListConfig,l=o.doNotApplyNodeExpand||this.ListConfig.doNotApplyNodeExpand,r=new g({config:a,viewCollection:n,doNotApplyNodeExpand:l});return t&&o.performFilterOnTreeDocument&&(s=this.performFilter(t,o.iSearchValue,o.column,o)),s&&s.length&&s.forEach(function(e){let t={model:e,service:o.service,treeDocument:r};n.createClonedModel(t)}),r},performFilter:function(t,i,n,o){let s=e.clone(o||{},!1),a=void 0;if(i)if("id"===n){if(a=d.filterObjects(t,n,i),s.iterateRecursiveKeys&&s.iterateRecursiveKeys.length){let e=this.getRecursiveDataModels(n,i,s.iterateRecursiveKeys);a=a.concat(e),a=[...new Set(a)]}}else a=t.filter(function(e){if(e.get(n)&&e.get(n).contains(i))return e});return a},updateChildrenForNodeModel:function(t){let i=e.clone(t||{},!1),n=i.model,o=i.collection,s=i.childRelationsNames||n&&n.getChildRelationsNames();if(o&&(n=o.get(n.id)),s&&s.length){i.childMemberNames=s;let e=this.treeDocument.getTreeNodeModelById(n.id);e&&this._addChildNode(n,e,i),i.isExpandNode&&e.expand()}},updateTreeDocumentForCollection:function(t,i){let n,o,s=this,a=this.treeDocument,l=e.clone(i||{},!1);t&&t.length&&t.forEach(function(e){if(n=e.id||e.physicalid,o=a.getTreeNodeModelById(n)){let t={model:e,config:l.config,treeDocument:a,treeNodeModel:o};s.createClonedModel(t)}l.isMassUpdate&&s.updateCacheAndTaggerData(e,{forceUpdate:!0})})},getFieldsAndIncludeParamsForDataModelDetails:function(e){let t,i=e&&e.tabConfig||this.TabConfig,n="none";return i&&i.values.forEach(function(i){!e.include&&i.include&&(t?t+=","+i.include:t=i.include),i.fields&&(n+=","+i.fields)}),{fields:n,include:t}},getDataModelDetails:function(t){let n=this,s=e.clone(t||{},!1),a=Boolean(s.initialCall),l=!s.model&&(s.treeNodeModel||this.getCurrentNode(0)),r=s.model||l.options.data.model,c=[],h=Boolean(s.expandCall);return s.attributesToBeRetained&&s.attributesToBeRetained.forEach(t=>{let i=r.get(t);i&&(c[t]=i.clone?i.clone():e.clone(i||{},!1))}),new i(function(e,t){let i=a?s.initialFields:s.fields,u=a?s.initialInclude:s.include;if(!i&&!u){let e=n.getFieldsAndIncludeParamsForDataModelDetails(s);i=e.fields,u=e.include}r.fetch({debug:!1,method:"GET",filter:o.getSelectedFilterOption(),subFilter:o.getSelectedSubFilterOption(),owned:!s.owned||s.owned,fields:i,include:u,mask:s.mask,refresh:s.refresh,storageKey:s.storageKey,fetchSource:s.fetchSource,subType:s.subType,customParams:s.customParams,ignoreFieldDefinition:s.ignoreFieldDefinition,onComplete:function(t){if(n.handleDoNotCacheAttributes(r,s),s.attributesToBeRetained&&s.attributesToBeRetained.forEach(e=>{let t=c[e];t&&r.set(e,t)}),l){let e={model:r,config:n.getPropertiesConfig(r),treeNodeModel:l};t=n.createClonedModel(e)}else if(h){let e=new n.DataModels(t);n.treeDocument&&n.treeDocument.getNodeModels().length?n.updateTreeDocumentForCollection(e,s):(n.treeDocument=n.createTreeDocumentForCollection(e,{doNotApplyNodeExpand:s.doNotApplyNodeExpand}),s.collection=e),n.updateChildrenForNodeModel(s),s.expandAll&&n.treeDocument.expandAll(),s.onComplete&&s.onComplete.apply(this,arguments)}e(t)},onFailure:function(e,i){m.buildNotification({title:p.FETCH_FAILURE,message:d.getErrorMessage(e,i)},"error"),t()}})})},getPropertiesConfig:function(){return this.PropertiesConfig},getDataModels:function(t){let i,n=this,s=e.clone(t||{},!1),a=s.collection||new this.DataModels,l="none",r="none",h=s.excludeParams,u=Boolean(s.expandCall),g=Boolean(s.initialCall),C=s.fetchColumnNames,f=this.ListConfig&&this.ListConfig.values,D=s.customParams;if(s.fieldDefinitionOnly)D={fieldDefinition:"nodata"};else if(s.paramData&&s.paramData.forEach(function(e){i?i+=","+(e.objectId||e.get("id")):i=e.objectId||e.get("id")}),s.fields||s.includeFields)l+=","+s.fields,r+=","+s.includeFields;else if(C){let e=d.filterObjects(f,"dataIndex",C);e&&e.forEach(t=>{1===e.length&&t.initialFields?s.onComplete&&s.onComplete(n.treeDocument):(t.fields&&(l+=","+t.fields),t.include&&(r+=","+t.include))})}else f&&f.length&&f.forEach(function(e){if(!h||-1===h.indexOf(e.dataIndex))if(u){let t=e.expandFields,i=e.expandInclude;t&&(l+=","+t),i&&(r+=","+i)}else{let t=g?e.initialFields:e.fields,i=g?e.initialInclude:e.include;t&&(l+=","+t),i&&(r+=","+i)}});a.fetch({debug:!1,filter:i?void 0:o.getSelectedFilterOption(),contextId:i?void 0:s.contextId,idList:i,completed:i?void 0:o.get(c.COMPLETED_PREFERENCE),fields:l,include:r,top:s.top,rmcType:s.rmcType,sourceType:s.sourceType,customParams:D,onComplete:function(e){if(n.fieldDefinitionSource=a.getFieldDefinitionSource(),s.paramData&&s.paramData.length>0&&e.length<s.paramData.length){let t;s.paramData.forEach(i=>{e.get(i.objectId||i.get("id"))||(t=t?t+","+(i.displayName||i.get("title")):i.displayName||i.get("title"))}),t&&m.buildNotification({message:p.FAILED_TO_RETRIEVE_OR_ACCESS+" : "+t},"error")}s.updateCurrentTreeDocument?(n.updateTreeDocumentForCollection(e,s),s.onComplete&&s.onComplete.apply(this,arguments)):u?(s.collection=a,n.treeDocument?n.updateTreeDocumentForCollection(e,s):(n.collection=a,n.treeDocument=n.createTreeDocumentForCollection(e,{expandAll:s.expandAll,doNotApplyNodeExpand:s.doNotApplyNodeExpand})),n.updateChildrenForNodeModel(s),s.expandAll&&n.treeDocument.expandAll(),s.onComplete&&s.onComplete.apply(this,arguments)):s.fieldDefinitionOnly||(n.collection=a,n.treeDocument=n.createTreeDocumentForCollection(e,{doNotApplyNodeExpand:s.doNotApplyNodeExpand,performFilterOnTreeDocument:s.performFilterOnTreeDocument}),s.fetchChildDetails||s.addChild?n._fetchChildDetails(n.treeDocument,s):s.onComplete&&s.onComplete(n.treeDocument))},onFailure:function(e,t){m.buildNotification({title:p.FETCH_FAILURE,message:d.getErrorMessage(e,t)},"error"),s.onFailure&&s.onFailure(t)}})},_fetchChildDetails:function(e,t){let n=this;e.prepareUpdate();let o=e.getChildren();if(o&&o.length>0){let s=[];o.forEach(function(i){s.push(n._fetchModelDetails(i,e,t))}),s.length?i.all(s).then(()=>{e.updateSortAndExpandAll(),t.onComplete&&t.onComplete(e)}):t.onFailure()}else t.onComplete&&t.onComplete(e)},_fetchModelDetails:function(e,t,n){let o=this;return new i(function(t,i){n.fetchChildDetails?e.options.data.model.fetch({mask:n.mask,depth:n.depth,onComplete:function(i){o._addChildNode(i,e,n),t()},onFailure:function(e,t){m.buildNotification({title:p.FETCH_FAILURE,message:d.getErrorMessage(e,t)},"error"),i(e,t)}}):n.addChild&&(o._addChildNode(e.options.data.model,e,n),t())})},_addChildNode:function(t,i,n){let o=this,s=e.clone(n||{},!1),a=widget.getValue("isTaggersSelected"),l=d.getAttributeValues(i.getAllDescendants(),"id");s.childMemberNames&&n.childMemberNames.forEach(function(e){let n=t.get(e);n&&(s.performFilterOnTreeDocument&&(n=o.performFilter(n,s.iSearchValue,s.column,s)),n.forEach(function(e){if(!a||!o.searchValue||-1!==o.searchValue.indexOf(e.id)&&-1===l.indexOf(e.id)){let t={model:e,config:o.ListConfig,treeDocument:i};o.createClonedModel(t)}}))});let r=i.getChildren();r&&r.length&&r.forEach(function(e){let t=e.options.data;t?o._addChildNode(t.model,e,s):e.remove()})},hasPropertyInTaggerMap:function(e){return this.fieldDefinitionSource&&Boolean(Object.keys(a.getFieldTaggerMap(this.fieldDefinitionSource)).filter(t=>new RegExp(e).test(t)).length)},processTagger:function(t){let n=this,o=e.clone(t||{},!1);return o.isSeverityExistsInTagger=this.hasPropertyInTaggerMap("severity"),new i(function(e,t){n.taggerProxy=new u(n.collection,o),n.taggerProxy.loadTagData(o).then(function(){e(n.taggerProxy)},function(e,i){m.buildNotification({title:p.TAGGER_ERROR,message:d.getErrorMessage(e,i)},"error"),t(e,i)})})},_clearCachedData:function(){this.collection&&this.collection.forEach(e=>{this.storageDataUtil.remove(e.get("id"))})},getContextInfo:function(t,n){let s=this,l=e.clone(n||{},!1),r=t._sourceType,d=t._fetchSource||l.defaultSource,h=l.initialCall||!1,u=this.ListConfig&&this.ListConfig.values,g=l.showCompletedRisks||o.get(c.COMPLETED_PREFERENCE);return new i(function(e,i){let n=s.ListConfig.getContextFields?s.ListConfig.getContextFields():"none",l=s.ListConfig.getContextIncludeFields?s.ListConfig.getContextIncludeFields():"none";l+=r?","+r:"",u&&u.length&&u.forEach(function(e){let t=h?e.initialFields:e.fields,i=h?e.initialInclude:e.include;if(t){t.split(",").forEach(function(e){e.includes(".")?n+=","+e:n+=","+(r?r+".":"")+e})}i&&(l+=","+i)});let c=a.getFieldsDefinition(t.getFieldDefinitionSource());t.fetch({fetchSource:d,filter:o.getSelectedFilterOption(),subFilter:o.getSelectedSubFilterOption(),completed:g,fields:n,include:l,definition:!c||!c.fieldDefinitionColumns||void 0,fieldDefinitionSource:t.getFieldDefinitionSource(),refresh:!0,onComplete:function(){s.fieldDefinitionSource=t.getFieldDefinitionSource(),s.resetCollection(t.get(r)),e(t)},onFailure:function(e,t){return m.buildNotification({title:p.CONTEXT_SELECTION_FAILURE,message:p.FAILED_TO_RETRIEVE_OR_ACCESS},"warning"),i(e,t)}})})},getHistory:function(){return this.getRelatedResource("history")},getDataModelTrend:function(e){return this.getRelatedResource("rpn",e)},getRelatedResource:function(e,t){let n=this;return new i(function(i,o){let s=n.getCurrentDataModel(),a=new r;a.fetch({id:s.get("id"),refresh:!0,relatedSource:e,sourceType:t,onComplete:function(){i(a)},onFailure:function(e,t){return m.buildNotification({title:p.FETCH_FAILURE,message:d.getErrorMessage(e,t)},"error"),o(e,t)}})})},saveDataModel:function(t,i){this.resetDataModelFromClone(t,i),this.preProcessFileManagement(t,i);let n=t.model.changedAttributes();Object.keys(n).length&&(this.changedSaveAttrsSinceLastChange=e.clone(n,!1)),this.saveIfNotWaitingForAsync(t,i)},deleteDataModel:function(t,n){let o=this,s=e.clone(n||{},!1),a=this.getCurrentNode(),l=a&&t&&a.model.id===t.id,r=l?a:t;return s.isSelect=Boolean(l),r&&new i(function(e,t){s.onComplete=function(t){o.handleDeleteDataModelOnComplete(t,r,s,e)},s.onFailure=function(e,i){m.buildNotification({title:p.DELETE_FAILURE,message:d.getErrorMessage(e,i)},"error"),t()},r.model.destroy(s)})},handleDeleteDataModelOnComplete:function(t,i,n,o){let s,a=n.isSelect;a=!e.is(a,"boolean")||a;let l=i.model;if(e.is(i.getNextNode,"function")&&(s=i.getNextNode(),i.remove()),a&&(s?s.select():this.treeDocument.getNodeModelsLength()&&this.selectDataModel(0)),this._updateTaggerData(l,!0),!n.doNotShowDeleteMessage){let e=d.getNLS(this.NLS,l.get("type"),"Type");e=e||this.governingTypeNLS,m.buildNotification({message:e+' "'+l.title+'" '+p.DELETED,title:""},"success")}o&&o(n)},preProcessFileManagement:function(t,i){let n=this,o=t.get("references"),s=t.get("deliverables"),a=o&&o.relatedDataToAdd,l=s&&s.relatedDataToAdd,r=a&&a.length,c=l&&l.length;if(r||c){let o=e.clone(i||{},!1);o.callback=this.saveIfNotWaitingForAsync.bind(this),o.onFailure=function(e,t){n.handleSaveFailure(e,t,i)},r&&(e.extend(o,{fieldName:"references",parentRelName:"Reference Document"}),t.uploadFiles(a,o)),c&&(e.extend(o,{fieldName:"deliverables",parentRelName:"Task Deliverable"}),t.uploadFiles(l,o))}},unselect:function(t){if(e.is(t,"number")&&t>-1){let e=this.getCurrentNode(t);e&&e.unselect()}else this.treeDocument&&this.treeDocument.unselectAll()},handleProcessSaveDataModelOnComplete:function(t,i){let n=e.clone(i||{},!1),o=t.get("duplicatedModels");if(o){let i=this;e.extend(n,{isDuplicate:!0,donotShowMessage:!0,doNotCache:!0});let s=o.length;o.forEach((e,t)=>{n.isSelect=t===s-1,i.performPostSave(e,n)}),n.donotShowMessage=!0,this._showMessageForGoverningType(t,n),n.onComplete&&n.onComplete.apply(i,arguments)}else this.saveClassification(t,n)},processSaveDataModel:function(t,i){let o=this,s=e.clone(i||{},!1),a=s.isNew,l=s.isDisconnectModel,r=s.collection||this.collection,c=function(e,i,n){n.parseError?(this.handleSaveFailure(i,n.parseError,s),r.dispatchEvent("onError",[i,n])):o.handleProcessSaveDataModelOnComplete(t,s)},d=function(e,t,i){o.handleSaveFailure(e,t,s),r.dispatchEvent("onError",[e,i])},h="none",u="none";a?(o.TabConfig&&o.TabConfig.values.forEach(function(e){e.fields&&(u+=","+e.fields)}),o.TabConfigForCreate&&o.TabConfigForCreate.values.forEach(function(e){e.include&&(h+=","+e.include)}),t.model instanceof n||s.callSaveDataModel?t.model.save(null,{isNew:a,fields:s.fields?i.fields:u,include:s.include?i.include:h,customParams:s.customParams,onComplete:c,onFailure:d,ignoreFieldDefinitions:s.ignoreFieldDefinitions}):r.create(t.model,{isNew:a,fields:u,include:h,customParams:s.customParams,ignoreFieldDefinitions:s.ignoreFieldDefinitions,externalService:s.externalService,no3DSpace:s.no3DSpace,ignoreFields:s.ignoreFields,onComplete:c,onFailure:d})):(u="modifyAccess,deleteAccess,canModify,CanDelete,RMCConnectAccess,changeOwnerAccess,modified",(s.inValidRMC||s.isContextModified)&&(u+=",rmcActual.title,rmcGoverning.title,validConfiguration",h="rmcActual,rmcGoverning"),t.model.save(null,{isDeleteOrRemove:l,fields:s.fields?i.fields:u,include:s.include?i.include:h,customParams:s.customParams,onComplete:c,onFailure:d,ignoreFieldDefinitions:s.ignoreFieldDefinitions}))},saveClassification:function(e,t){let i=this,n=function(){t.ignorePostSave||(e.cancel(),i.performPostSave(e,t),t.onComplete&&t.onComplete.apply(this,arguments))};e.get("ClassificationAttributes")?this.handleClassifications(e,t).then(n,function(n){t.ignorePostSave||i.performPostSave(e,t),i.handleSaveFailure(n,n,t)}):n.apply(this,arguments)},handleClassifications:function(e,t){let n=this;return new i(function(i){let o=e.get("ClassificationAttributes"),s={onComplete:function(s){o?(o.relatedDataToAdd=[],o.relatedDataToDelete=[],s&&m.buildNotification({title:p.CLASSIFICATION_FAILURE,message:s},"error"),t={mask:"dslib:ClassifiedItemBaseMask",refresh:!0,model:e.model},n.getDataModelDetails(t).then(function(){n._saveClassAttributes(e,t).then(function(e){if(s){let t={};t.data=e,t.err={message:s},i(t)}else i(e)},function(t){m.buildNotification({title:p.CLASSIFICATION_FAILURE,message:d.getErrorMessage(t)},"error"),t&&(t.data=e),i(t)})},function(e,t){i(e,t)})):i(e)}};n._addRemoveClasses(e,o,0,0,void 0,s)})},_addRemoveClasses:function(e,t,i,n,o,s){let a,l,r,c=this;if(t&&i<t.relatedDataToAdd.length?(a=t.relatedDataToAdd[i],l="add"):t&&n<t.relatedDataToDelete.length&&(a=t.relatedDataToDelete[n],l="remove"),!a)return s.onComplete();a.save(null,{classifiedItemId:e.get("id"),operation:l,relativePath:e.get("relativePath"),source:e.get("source"),type:e.get("type"),onComplete:function(d){if(e.model.set("modified",new Date),d.get("ObjectsNotClassified")>0||d.get("ObjectsNotDeclassified")>0){let e=d.get("StatusOfObjects"),t=Object.keys(e),i=e[t[0]].Reason+"; status: "+e[t[0]].status;o?o+=", "+t[0]+": "+i:o=d.get("id")+": "+i,r=d.get("ObjectsNotClassified")>0?1:2}c.processAfterClassficationAddRemove(e,t,i,n,o,a,r,l,s)},onFailure:function(h,u){r="add"===l?1:2;let g=a.title+": "+d.getErrorMessage(h,u);o=o?o+", "+g:g,m.buildNotification({title:p.CLASSIFICATION_FAILURE,message:o},"error"),c.processAfterClassficationAddRemove(e,t,i,n,o,a,r,l,s)}})},processAfterClassficationAddRemove:function(e,t,i,n,o,a,l,c,d){if(1===l){let e=t.get(a.get("id"));t.remove(e,{ignoreAddref:!0})}else if(2===l)t.add(a,{ignoreAddref:!0});else if("add"===c){i++;let t=e.get("classes");t||(t=new r,e.model.set("classes",t));let n=new s({id:a.get("id"),name:a.get("name"),title:a.get("title")});t.add(n,{ignoreAddref:!0})}else{n++;let t=e.get("classes");t&&t.remove(a.get("id"),{ignoreAddref:!0})}if(!(i<t.relatedDataToAdd.length||n<t.relatedDataToDelete.length))return d.onComplete(o);this._addRemoveClasses(e,t,i,n,o,d)},_saveClassAttributes:function(e){return new i(function(t,i){let n,o,s=e.get("ClassificationAttributes");if(!s.isEmpty()&&(o=s.find(function(e){return n=e.get("Attributes"),Boolean((e.isAttributesNew||e.hasChanged())&&n&&n.length)}))){let n={classifiedItemId:!0,operation:"modify",mask:"dslib:ClassificationAttributesMask",onComplete:function(i){e.model.set("modified",new Date),t(i)},onFailure:function(e,t){if(t&&t.message&&t.message.length&&t.message.length>0){let e=t.message.indexOf(":");e>0&&(t.message=t.message.substring(e+1))}i({data:e,err:t})}};e.model.save(null,n)}!o&&t(e.model)})},getAdditionalDataModels:function(e,t){let i=o.get("context"),n=t.selectedObjectIds,s=t.isDisconnectModel,a=[...i&&i.additionalDataModels||[]];if(e){!d.findObject(a,"id",e.id)&&!s&&a.push(e)}if(n){let i=e.get(t.attrName),o=d.filterObjects(i,"id",n);o&&o.length&&(a=a.concat(o||[]))}return a},performPostSave:function(t,i){let n=e.clone(i||{},!1),o=n.isNew,s=t.model||t,a=n.invokeSaveEvent,l=n.isDisconnectModel,r=n.selectedObjectIds,c=this.getDocument()||n.treeDocument;if(n.parentTask){let e=(s=n.parentTask).get("tasks");s=e&&e.at(e.length-1)}if(this.handleDoNotCacheAttributes(s,i),o?(n.isDuplicate&&this.collection.add(t),!n.treeDocument&&this.unselect()):(s.dispatchEvent("onSaveModelComplete",[s,this.changedSaveAttrsSinceLastChange]),delete this.changedSaveAttrsSinceLastChange),c&&!n.isReload&&!n.doNotUpdateTreeNodeModel){let i;this.getAdditionalDataModels(s,n).forEach(o=>{let d;(!(i=r?-1!==r.indexOf(o.id):s.id===o.id)||l||a)&&(d=c.getTreeNodeModelById(o.id)),(i||d)&&(e.extend(n,{treeNodeModel:d}),t=this.updateTreeNodeModel(o,n))})}n.doNotUpdateTaggerData||this._updateTaggerData(t,!1),this._showMessageForGoverningType(s,n)},_showMessageForGoverningType:function(e,t){let i=e.get("type"),n=t.isNew?p.CREATED:p.UPDATED,o=d.getNLS(this.NLS,i,"Type");o=o||this.governingTypeNLS||i,!t.donotShowMessage&&m.buildNotification({message:o+' "'+e.title+'" '+n},"success")},updateTreeNodeModel:function(t,i){let n=e.clone(i||{},!1),o=n.isNew||n.isAddExisting,s={isNew:o,model:t,isSelect:n.isSelect,isExpand:n.isExpand,treeDocument:n.treeDocument||this.treeDocument,treeNodeModel:n.treeNodeModel||!o&&this.getCurrentNode()};return this.createClonedModel(s)},handleSaveFailure:function(e,t,i){return!i.donotShowMessage&&m.buildNotification({title:p.SAVE_FAILURE,message:d.getErrorMessage(e,t)},"error"),i.onFailure&&i.onFailure(e,t)},saveIfNotWaitingForAsync:function(e,t){this.shouldWaitForSave(e)||this.processSaveDataModel(e,t)},shouldWaitForSave:function(e){return e.isUploadingFiles()},fetchAdditionalDataForModels:function(t){let i=e.clone(t||{},!1),n={updateCurrentTreeDocument:!0,paramData:i.paramData||this.collection,collection:i.collection||this.collection};if(e.extend(i,n),this.collection&&this.collection.length>0)return this.getDataModels(i);i.onComplete&&t.onComplete.apply(this,arguments)},saveDataModels:function(t,i){let o=this,s=e.clone(i||{},!1),a=s.operation,l=s.donotShowMessage;t&&this.resetDataModelFromClone(t,i);let r=this.treeDocument.getSelectedNodes(),h=a===c.DUPLICATE;if(!r.length&&h&&(r=[t]),r.length){let i,a,c=new n({isDuplicate:h,selectedNodes:r,modelInstance:this.DataModel,fieldDefinitionSource:this.fieldDefinitionSource,massUpdateModel:t&&t.model});if(h){let e=this.getFieldsAndIncludeParamsForDataModelDetails(s);a=e.fields,i=e.include}else i="",a="modifyAccess,deleteAccess,promoteAccess,demoteAccess,fromConnectAccess,toConnectAccess,modified";c.save(null,{fields:a,include:i,onComplete:function(i){if(t&&t.cancel(),e.extend(s,{donotShowMessage:!0}),h){e.extend(s,{isNew:!0,treeNodeModel:void 0,isDuplicate:!0,doNotCache:!0}),i.get("duplicatedModels").forEach(e=>o.performPostSave(e,s))}else r.forEach(t=>{e.extend(s,{treeNodeModel:t}),o.performPostSave(t.options.data,s)});!l&&m.buildNotification({message:p.MASS_UPDATE_SUCCESS},"success"),s.onComplete&&s.onComplete.apply(this,arguments)},onFailure:function(e,t){!l&&m.buildNotification({title:p.MASS_UPDATE_FAILURE,message:d.getErrorMessage(e,t)},"error"),s.onFailure&&s.onFailure.apply(this,arguments)}})}},_updateTaggerData:function(e,t){this.taggerProxy&&this.taggerProxy.updateTagObject(e.model||e,t,this.fieldDefinitionSource).then(function(){},function(e){m.buildNotification({title:p.TAGGER_ERROR,message:e},"error")})},updateCacheAndTaggerData:function(t,i){if(t){let n=e.clone(i||{},!1),o=n.forceUpdate,s=n.childrenTaggerUpdate;if(this.storageDataUtil.get(t.id)&&this.storageDataUtil.set(t.id,t),(o||this.taggerProxy&&!this.taggerProxy.taggerData.hasOwnProperty("pid://"+t.id))&&this._updateTaggerData(t,!1),s){let e=t.getChildRelationsNames();e&&e.length&&e.forEach(e=>{let i=t.get(e);i&&i.length&&i.forEach(e=>{(o||this.taggerProxy&&!this.taggerProxy.taggerData.hasOwnProperty("pid://"+e.id))&&this._updateTaggerData(e,!1)})})}}},handleContextExpansionCache:function(t,i){let n=o.getContextInfo();if(n&&n.id!==t){let s=n.expansions||[],a=s.includes(t);i?!a&&s.push(t):a&&s.splice(s.indexOf(t),1),e.extend(n,{expansions:s}),o.setContextInfo(n)}},duplicateDataModels:function(t){if(!this.validateDuplicateDataModels(t))return;let i=e.clone(t||{},!1),n=i.onComplete,o=i.onFailure;e.extend(i,{donotShowMessage:!0,onComplete:function(){m.buildNotification({message:p.DUPLICATE_SUCCESS},"success"),n&&n.apply(this,arguments)},onFailure:function(e,t){m.buildNotification({title:p.DUPLICATE_FAILURE,message:d.getErrorMessage(e,t)},"error"),o&&o.apply(this,arguments)}}),this.saveDataModels(i.cloneModelToSave,i)},validateDuplicateDataModels:function(){return!0},destroy:function(){this.collection&&delete this.collection,this.treeDocument&&(this.treeDocument.destroy(),delete this.treeDocument)},removeDataModel:function(t,n){let s=this,a=e.clone(n||{},!1),l=a.parentId,r=l&&this.getDocument().getTreeNodeModelById(l);if(!(r=r&&r.cloneModel)){let e=o.get("context").getAllTasks().get(l);e&&(r=new this.CloneModel(e))}return r.remove(a.attrName,t),new i(function(t,i){e.extend(a,{doNotCache:!0,doNotReload:!0,donotShowMessage:!0,isDisconnectModel:!0,onComplete:function(e,i){s.handleRemoveDataModelOnComplete(e,i),t(i)},onFailure:function(e,t){m.buildNotification({title:p.REMOVE_FAILURE,message:d.getErrorMessage(e,t)},"error"),i(t)}}),s.processSaveDataModel(r,a)})},handleRemoveDataModelOnComplete:function(e,t){if(!t.doNotShowRemoveMessage){let t=d.getNLS(this.NLS,e.get("type"),"Type");t=t||this.governingTypeNLS,m.buildNotification({message:t+' "'+e.title+'" '+p.REMOVED,title:""},"success")}},handleDoNotCacheAttributes:function(t,i){let n=e.clone(i||{},!1);if(!n.doNotCache){let e=n.doNotCacheAttributes?n.doNotCacheAttributes:this.TabConfig&&this.TabConfig.doNotCacheAttributes,i={};e?(e.forEach(e=>{i[e]=t.get(e),t.unset(e,{silent:!0})}),this.storageDataUtil.set(n.storageKey||t.id,t),t.set(i,{silent:!0}),t.resetChangedAttrs()):this.storageDataUtil.set(n.storageKey||t.id,t)}},processAddExisting:function(t,i){let n=e.clone(t||{},!1),o=this.getCurrentDataModel(),s=d.getAttributeValues(i,"id");if(!o.add(n.attrName,s.toString(),{config:{validate:!0},doNotCache:!0,detailedObjects:i}))return;o.model.has(n.attrName)||o.model.set(n.attrName,o.get(n.attrName));let a=this,l=this.getDocument().getTreeNodeModelById(o.id);this.processSaveDataModel(o,{isAddExisting:!0,donotShowMessage:!0,attrName:n.attrName,treeDocument:l,selectedObjectIds:s,include:n.include,fields:n.fields,onComplete:this.handleAddExistingOnComplete.bind(this,n),onFailure:function(e,t){a.handleAddExistingOnFailure(e,t,n)}})},handleAddExistingOnComplete:function(e){m.buildNotification({message:p.ADD_EXISTING_SUCCESS},"success"),e.onComplete&&e.onComplete.apply(this,arguments)},handleAddExistingOnFailure:function(e,t,i){if(m.buildNotification({title:p.ADD_EXISTING_FAILURE,message:d.getErrorMessage(e,t)},"error"),i.attrName){let e=this.currentModel.get(i.attrName);e&&e.resetOperationFlags()}i.onFailure&&i.onFailure.apply(this,arguments)}})}),define("DS/ENOProjectMgmtCommonComponents/collection/ClassificationCollection",["UWA/Core","DS/ENOProjectMgmtCommonComponents/config/CommonListConfig","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel","DS/ENOProjectMgmtCommonComponents/collection/ProjectMgmtViewCollection","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtModels/Models/Library","DS/ENOProjectMgmtModels/Collections/Libraries","DS/ENOProjectMgmtModels/Models/RelatedDataItem","DS/ENOProjectMgmtModels/Constants/Constants"],function(e,t,i,n,o,s,a,l,r){"use strict";let c=n.singleton({_uwaClassName:"ClassificationCollection",classes:{},classPaths:{},classNames:{},setup:function(){let e={};e.DataModels=a,e.DataModel=s,e.PropertiesConfig=t,e.ListConfig=t,e.CloneModel=i,e.governingType=r.TYPENAMES.LIBRARIES,e.governingTypeNLS="Libraries",this._parent(e)},getClassPath:function(e){return this.classPaths[e]},getClassName:function(e){return this.classNames[e]},reloadClassifications:function(e){this.resetClassFlags(),this.loadClassifications(e),c.resetCollection()},loadClassifications:function(t){let i=this,n=e.clone(t||{},!1),o=n.onComplete;n.fetchChildDetails=!0,n.mask="dslib:ExpandClassesDetailsMask",n.depth=20,n.top=999,n.childMemberNames=["ChildClasses"],n.onComplete=function(){i._loadClassPaths(),o&&o()},c.getDataModels(n)},GetLibrary:function(e){if(this.collection)return this.collection.get(e)},isDefinitionLibrary:function(e){let t=this.GetLibrary(e);return!!t&&t.get("libraryUsage")===o.DEFINITION},isClassRootIsDefinitionLibrary:function(e){let t=this.classes[e],i=t&&t.get("libraryId");return!!i&&this.isDefinitionLibrary(i)},getClassDefinition:function(e){let t=void 0;e.model?t=e.model:(t=new l).set("id",e.id||c.getCurrentDataModel().get("id"));let i={storageKey:t.id+"ClassAttributesMask",mask:"dslib:ClassAttributesMask",model:t,fetchSource:r.APPLICATIONS.LIBRARIES,subType:r.APPLICATIONS.CLASS};return c.getDataModelDetails(i)},getClassifiedItemAttributes:function(e){let t={mask:"dslib:ClassificationAttributesMask",refresh:!0,model:e};return c.getDataModelDetails(t)},_loadClassPaths:function(){Object.keys(this.classPaths).length||(this.classes={},this.classPaths={},this.classNames={},this._initializeClassPaths(this.collection,void 0))},_initializeClassPaths:function(e,t){let i=this;e&&e.forEach(function(e){let n=e.get("id"),o=e.get("title");if(i.classNames[n]=e.get("name"),i.classes[n]||(i.classes[n]=e),!i.classPaths[n]){let s=t?t+" > "+o:o;i.classPaths[n]=s;let a=e.get("ChildClasses");a&&i._initializeClassPaths(a,s)}})},resetClassFlags:function(){this.classes={},this.classPaths={},this.classNames={}},performFilter:function(e){return e.filter(function(e){if(e.get("libraryUsage")){if(e.get("libraryUsage")===o.DEFINITION&&"Active"===e.get("state"))return e}else if("Active"===e.get("state"))return e})},destroy:function(){this._parent()}});return c}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtHeatMapCustomView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/config/HeatMapChartConfig","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtHeatMapChartUtil","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l){"use strict";return t.extend({_uwaClassName:"ProjectMgmtHeatMapCustomView",options:{},riskHeatMapDiv:void 0,chartConfig:void 0,Highcharts:void 0,seriesArray:void 0,setup:function(t){let n=e.clone(t||{},!1);this.options=n,this.model=n.model,this.homeView=n.homeView,this.fieldConfig=n.config,this.chartConfig=e.clone(s||{}),this.seriesArray=this.chartConfig.series,this.Highcharts=i.get("highcharts"),this._parent.apply(this,arguments)},render:function(){let t=this;this.container.empty(!0);let i=this.fieldConfig.isMatrixSettingView;if(this.heatmapLabel=new e.createElement("label",{text:this.fieldConfig.label}).inject(this.container),this.riskHeatMapDiv=e.createElement("div",{class:"heatmap-details-panel"}).inject(this.container),this.riskHeatMapDiv.addEvent("resize",function(){t.heatMapChart&&t.heatMapChart.reflow()}),this.chartConfig.chart.renderTo=this.riskHeatMapDiv,i){this.listenTo(this.model,"onChangeImportFile",this.handleMatrixImportFile);let e=this.chartConfig.plotOptions.series.point;e&&(e.events.click=void 0),this.chartConfig.plotOptions.column.cursor=void 0,this.chartConfig.plotOptions.column.dataLabels.style.fontSize="10px",this.renderMatrixHeatMapPreview(i)}else this.listenTo(this.model,"onChange:rpnValue",this.handleRPNHeatMap),this.listenTo(this.model,"onChange:rpnValueGoal",this.handleRPNHeatMap),this.chartConfig.xAxis.labels.enabled=!1,this.chartConfig.xAxis.title.enabled=!1,this.chartConfig.yAxis.labels.enabled=!1,this.chartConfig.yAxis.title.enabled=!1,this.initializeClickEvent(),this.renderMatrixHeatMapPreview(),this.handleRPNHeatMap();return this},renderMatrixHeatMapPreview:function(t){let i=this.model.get("rmcId"),n=i&&this.homeView._matrixConfigCollection.getMatrixConfigDefinition(i)||this.model.get("matrix");if(e.is(n,"object")){let e={chartConfig:this.chartConfig,matrixConfiguration:n,matrixSettingVeiw:t};this.heatMapChartUtil=new a(e),this.renderHeatMapChart()}else this.container.empty(!0)},initializeClickEvent:function(){let e=this;this.chartConfig.plotOptions.series.point={events:{click:function(){e.model.model.isComplete()||(e.updateFieldViewByName("impact",this.Xvalue,!0),e.updateFieldViewByName("probability",this.Yvalue))}}}},updateFieldViewByName:function(e,t,i){let o=this._parentView.getFieldViewByName(e);if(o)if(o._config.doNotResetRelatedAttrs=i,widget.useUIKitSelect){let e=o._select.elementsList,i=n.findIndex(e,"valueItem",t.toString()),s=o._select.selectedIndex!==i;o._select.selectedIndex=i,s||o._selectDataEntry()}else{let e=o.getElement("select");e.value=t,o._selectDataEntry({target:e})}},handleRPNHeatMap:function(){let e=this.chartConfig.series?this.chartConfig.series[0].data:[],t=this.chartConfig,i=t.goalPatternPath,o=t.goalPatternStrokeWidth,s=t.goalXAxisField,a=t.goalYAxisField,l=t.xAxisField,r=t.yAxisField,c=t.rpnIcon,d=t.goalIcon,h=t.overlappingIcon,u=t.goalPatternOpacityValue,m=this.model.get(l),g=this.model.get(r),p=this.model.get(s),C=this.model.get(a);m&&g&&e.forEach(function(e){let t=e.color.pattern&&e.color.pattern.color||e.color;e.Xvalue<=p&&e.Yvalue<=C?e.color={pattern:{backgroundColor:t,path:{d:i,strokeWidth:o,stroke:t},width:10,height:10,opacity:u,color:t}}:e.color=t;let s,a="";e.Xvalue===m&&e.Xvalue===p&&e.Yvalue===g&&e.Yvalue===C?s=h:e.Xvalue===m&&e.Yvalue===g?s=c:e.Xvalue===p&&e.Yvalue===C&&(s=d),s&&(e.dataLabels.useHTML=!0,a=(a=n.getFontIconElement(s))&&a.getHTML()||""),e.dataLabels.format=a}),this.renderHeatMapChart()},renderHeatMapChart:function(){let e=this;this.Highcharts&&setTimeout(function(){e.heatMapChart=new e.Highcharts.Chart(e.chartConfig)},150)},handleMatrixImportFile:function(e){let t=e.isValid,i=e.errorMessage;t?this.render():(this.container.empty(!0),o.buildNotification({title:l.MATRIX_CONFIGURATION_ERROR,message:i,hideDelay:1e4},"warning"))}})}),define("DS/ENOProjectMgmtCommonComponents/config/MatrixSettingsViewConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/views/ToggleView","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtObjectCardView","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtHeatMapCustomView","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtFileChooserCustomView","DS/ENOProjectMgmtModels/Collections/SearchObjects","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l){"use strict";let r=e.extend({_uwaClassName:"MatrixSettingsViewConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"basic",values:[{label:l.IMPORT,name:"import",readWrite:"true",buttonType:"radio",toggleConfiguration:{toggleCols:2,toggleRows:1,toggleFlow:"row"},values:[{displayValue:l.CREATE_NEW_LABEL,actualValue:"new"},{displayValue:l.REPLACE_EXISTING,actualValue:"replace",checked:!0}],customView:i},{name:"importFile",customView:s},{label:l.TITLE,name:"title",type:"text",fields:"title,name,owner",include:"matrix,configuredItems",numberOfDisplayLines:1,numberOfEditableLines:1,removeCarriageReturns:!0,maxLength:128,validate:!0},{label:l.HEAT_MAP,name:"matrix",customView:o,isMatrixSettingView:!0},{readWrite:"true",label:l.WHERE_USED,name:"configuredItems",attributeToDisplay:"title",imageAttribute:"image",singleObjectOnly:!1,type:"object",validate:!0,fetchSource:"RiskContextInfo",typeAheadCallback:a.typeAheadCallback,customView:n,excludeSearchTypes:{"3dspace":["Task","Task Management"]},linkCallback:t.launchProperties,placeHolder:l.OBJECT_PLACEHOLDER,validateSameTenant:!0,fields:"riskCreateAccess",include:"configuration"},{label:l.COLLABORATIVE_SPACE,name:"projectTitle",type:"text",group:l.MORE},{label:l.OWNER,name:"ownerInfo",type:"person",imageAttribute:"image",attributeToDisplay:"fullName",customView:n,singleObjectOnly:!0,linkCallback:t.launchProperties,validateSameTenant:!0,group:l.MORE},{name:"rmcType"}]});return r._instance=r._instance||new r,r._instance}),define("DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtSummaryChartsUtil",["UWA/Class","DS/ENOProjectMgmtCommonComponents/config/AppConfig","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/constants/Constants","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtHeatMapChartUtil","DS/ENOProjectMgmtCommonComponents/collection/ClassificationCollection","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Models/FieldsDefinition","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r){"use strict";let c,d,h,u,m=new t,g={},p={},C={},f={};return e.extend({_uwaClassName:"ProjectMgmtSummaryChartsUtil",_breakdownChartConfig:void 0,_heatMapChartConfig:void 0,_classificationChartConfig:void 0,_actionPlanChartConfig:void 0,_matrixConfigCollection:void 0,_viewCollection:void 0,_createConfig:void 0,_planConfig:void 0,parentView:void 0,_matrixDataCount:void 0,_rmcObject:void 0,_isDefaultRMC:void 0,init:function(e){this._breakdownChartConfig=e.breakdownChartConfig,this._heatMapChartConfig=e.heatMapChartConfig,this._classificationChartConfig=e.classificationChartConfig,this._actionPlanChartConfig=e.actionPlanChartConfig,this._matrixConfigCollection=e.matrixConfigCollection,this._viewCollection=e.viewCollection,this._createConfig=e.createConfig,this._planConfig=e.planConfig,this.parentView=e.parentView,c=this.getMitigationTypes(),this.resetChartData()},resetChartData:function(){this.resetRangeData(h,g),this.resetRangeData(u,p),this.resetRangeData(d,C),this.resetRangeData(c,f)},resetRangeData:function(e,t){e&&e.forEach(function(e){t[e.actualValue||e.matrixXY||e]=0})},calculateDataBasedOnKey:function(e,t){e[t]||(e[t]=0),e[t]++},getTreeDocumentCollection:function(){let e=this._viewCollection&&this._viewCollection.getDocument();return e&&e.getChildren()},getMitigationTypes:function(){if(c=this._planConfig.columnInfo.mitigationType.values)return c.forEach(function(e,t){e.rangeColor=m.ColorPalette[t].color}),c},reloadClassification:function(){let e=this;d&&this.resetRangeData(d,C);let t=this.getTreeDocumentCollection(),i=t&&t.length,n=[];i&&t.forEach(function(t){let i=t.options.data;e.getClassificationData(i,n)}),this.processClassificationChart(n,i),this.Highcharts&&(this.classificationChart=new this.Highcharts.Chart(this._classificationChartConfig))},getClassificationData:function(e,t){let i=this,n=e.get("classType"),o=l.getFieldRangeItemObject(this._viewCollection.fieldDefinitionSource,"classType",n);o&&t.push({actualValue:n,displayValue:o.display,classType:"Risk"}),this.calculateDataBasedOnKey(C,n);let a=e.get("classes");a&&a.length&&a.forEach(function(e){let n=e.get("id"),o=s.getClassName(n),a=e.get("title");t.push({actualValue:a,className:o,classType:"Classification"}),i.calculateDataBasedOnKey(C,a)})},getRMCDetails:function(e){let t;if(e){let i=e.get("configuration");t=i&&i.length&&1===i.length?i[0]||i.at(0):this._matrixConfigCollection._defaultConfiguration}else t=this._matrixConfigCollection._defaultConfiguration;return t},reloadMatrixConfiguration:function(){this._isDefaultRMC=!1;let e=a.get("context"),t=this.getRMCDetails(e);if(t=t&&this._matrixConfigCollection.getMatrixConfigDefinition(t.id||t)){this._rmcObject=t;let i={chartConfig:this._heatMapChartConfig,matrixConfiguration:t},s=new o(i);h=s&&s.heatMapChartArray[0].data;let a=this._rmcObject?this._rmcObject.get("name"):"";this._isDefaultRMC=!e&&(a===n.DEFAULT||a===n.DEFAULT_OPPORTUNITY)}},getMatrixData:function(e,t,n){let o=e.get("validConfiguration"),s=e.get("contextValidConfiguration");if("FALSE"===o||"FALSE"===s)return;this._matrixDataCount++;let a,l=e.get("impact")+e.get("probability");if(this._isDefaultRMC){let t=e.getMappedValue(this._matrixConfigCollection._defaultConfiguration);t&&(this.calculateDataBasedOnKey(g,t.matrixXY),a=t.severityItem)}else if(this.calculateDataBasedOnKey(g,l),!n){let t=this._matrixConfigCollection.getMatrixConfigDefinition(e.getRMCActualId()),n=e.getRiskSeverityInfo&&e.getRiskSeverityInfo(t);a=n&&i.getSeverityItem(n)}n||(a&&t.push(a),a&&this.calculateDataBasedOnKey(p,a.actualValue))},processChartsData:function(){let e=this,t=a.get("isComponent"),i=this.getTreeDocumentCollection(),n=i&&i.length;this.reloadMatrixConfiguration();let o=[],s=[];this._matrixDataCount=0,n&&i.forEach(function(i){let n=i.options.data.model;if(n&&(e.getMatrixData(n,s,t),!t)){e.getClassificationData(n,o);let t=n.get("mitigationType");f[t]++}}),this.processCharts(o,s,n,t)},processCharts:function(e,t,i,n){this.processHeatmapChart(n),n||(this.processBreakdownChart(t,i),this.processClassificationChart(e,i),this.processActionPlanChart(i))},processHeatmapChart:function(e){let t=0===this._matrixDataCount;h&&(h.forEach(function(e){let i=e.matrixXY,n=g[i];n?(e.cellCount=n,e.dataLabels.format=n+" "):(e.cellCount=0,t&&(e.opacity=.5),e.dataLabels.format=" ")}),e||(this._heatMapChartConfig.plotOptions.series.point={events:{click:function(){if(0===this.cellCount)return;let e=this.Xvalue+" * "+this.Yvalue;this.series.chart.options.onClickCallBack("ds6w:what/ds6w:heatMap",e)}}},this._heatMapChartConfig.onClickCallBack=this._chartClickCallbackFunction.bind(this)))},preProcessBreakdownChart:function(e){return u=[...new Map(e.map(e=>[e.actualValue,e])).values()]},processBreakdownChart:function(e){u=e&&this.preProcessBreakdownChart(e);let t=[],i=0===this._matrixDataCount;i?t.push({y:1,name:r.NO_DATA,isEmpty:!0,color:m.ChartsColor.GREY0_COLOR}):u&&u.forEach(function(e){let i=e.actualValue,n=p[i]||0;t.push({name:e.displayValue,y:n,severityIndex:e.severityIndex,color:e.backgroundColor,severityLevel:i})}),t.sort(function(e,t){return e.severityIndex-t.severityIndex}),this._breakdownChartConfig.tooltip.enabled=!i,this._breakdownChartConfig.series.isEmpty=i,this._breakdownChartConfig.title.text=this._matrixDataCount.toString(),this._breakdownChartConfig.onClickCallBack=this._chartClickCallbackFunction.bind(this),this._breakdownChartConfig.series[0].data=t},preProcessClassificationChart:function(e){let t=[];(d=[...new Map(e.map(e=>[e.actualValue,e])).values()]).forEach(e=>{t.push(e.displayValue||e.actualValue)}),this.parentView.addChartScroller(t.length)},processClassificationChart:function(e,t){let i=0===t;this.preProcessClassificationChart(e);let n=[];i?n.push({y:0,isEmpty:!0,name:r.NO_DATA}):d.forEach(function(e){let t=C[e.actualValue];t?n.push({name:e.displayValue||e.actualValue,y:t,classType:e.classType,className:e.className,actualValue:e.actualValue}):n.push(null)}),this._classificationChartConfig.tooltip.enabled=!i,this._classificationChartConfig.onClickCallBack=this._chartClickCallbackFunction.bind(this),this._classificationChartConfig.series[0].data=n},processActionPlanChart:function(e){let t=[],i=0===e;i?t.push({y:1,name:r.NO_DATA,isEmpty:!0,color:m.ChartsColor.GREY0_COLOR}):c&&c.forEach(function(e){f[e.actualValue]>0&&t.push({name:e.displayValue,actualValue:e.actualValue,y:f[e.actualValue],color:e.rangeColor})}),this._actionPlanChartConfig.tooltip.enabled=!i,this._actionPlanChartConfig.series.isEmpty=i,this._actionPlanChartConfig.title.text=e.toString(),this._actionPlanChartConfig.onClickCallBack=this._chartClickCallbackFunction.bind(this),this._actionPlanChartConfig.series[0].data=t},renderCharts:function(e,t){this.parentView=t,this.Highcharts=e;let i=a.get("isComponent");this.Highcharts&&(this.heatMapChart=new e.Chart(this._heatMapChartConfig),i||(this.breakdownChart=new e.Chart(this._breakdownChartConfig),this.classificationChart=new e.Chart(this._classificationChartConfig),this.actionPlanChart=new e.Chart(this._actionPlanChartConfig)),this.reflowCharts())},reflowCharts:function(){this.heatMapChart&&this.heatMapChart.reflow(),this.breakdownChart&&this.breakdownChart.reflow(),this.classificationChart&&this.classificationChart.reflow(),this.actionPlanChart&&this.actionPlanChart.reflow()},_chartClickCallbackFunction:function(e,t){if(this.parentView){let i=this.parentView.parentView.getTaggerProxy();i&&i.set6WFilterOptions(e,t)}},destroyCharts:function(){this.heatMapChart&&(this.heatMapChart.destroy(),delete this.heatMapChart),this.breakdownChart&&(this.breakdownChart.destroy(),delete this.breakdownChart),this.classificationChart&&(this.classificationChart.destroy(),delete this.classificationChart),this.actionPlanChart&&(this.actionPlanChart.destroy(),delete this.actionPlanChart),this.resetChartData()},enableAnimation:function(e){this._breakdownChartConfig.plotOptions.pie.animation=e,this._actionPlanChartConfig.plotOptions.pie.animation=e,this._classificationChartConfig.plotOptions.bar.animation=e}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtSummaryView",["UWA/Class/View","UWA/Core","UWA/Element","DS/Controls/TooltipModel","DS/ENOProjectMgmtCommonComponents/config/AppConfig","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtSummaryChartsUtil","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtModels/Models/AppSettings","DS/Controls/Button","DS/UIKIT/Scroller","text!DS/ENOProjectMgmtCommonComponents/assets/templates/summaryView.html.handlebars","text!DS/ENOProjectMgmtCommonComponents/assets/templates/summaryHeatmap.html.handlebars","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m){"use strict";return e.extend({_uwaClassName:"ProjectMgmtSummaryView",_appContainer:void 0,parentView:void 0,chartOptions:void 0,height:void 0,Highcharts:void 0,summaryChartsUtil:void 0,_breakdownChartConfig:void 0,_heatMapChartConfig:void 0,_classificationChartConfig:void 0,_actionPlanBreakdownChartConfig:void 0,_viewCollection:void 0,_createConfig:void 0,_planConfig:void 0,_governingTypeNLS:void 0,_taggerUpdated:void 0,init:function(e){this.parentView=e.parentView,this._breakdownChartConfig=e.breakdownChartConfig,this._heatMapChartConfig=e.heatMapChartConfig,this._classificationChartConfig=e.classificationChartConfig,this._actionPlanBreakdownChartConfig=e.actionPlanBreakdownChartConfig,this._matrixConfigCollection=e.matrixConfigCollection,this._viewCollection=e.viewCollection,this._createConfig=e.createConfig,this._planConfig=e.planConfig,this._governingTypeNLS=e.governingTypeNLS,this._appContainer=t.createElement("div")},render:function(e){let i=t.clone(e||{},!1),n=r.get("isComponent");return this.initContainerResizeEvent(n),n?(this._appContainer.setHTML(u),this._appContainer.getElement("#heatmapLabel").setHTML(this._governingTypeNLS+" "+m.HEAT_MAP),this._heatMapChartConfig.chart.renderTo=this._appContainer.getElement("#heatmapChart")):(this._appContainer.setHTML(h),this.summaryChart=this._appContainer.getElement(".summary-chart"),this._appContainer.getElement("#heatmapLabel").setHTML(m.HEAT_MAP),this._heatMapChartConfig.chart.renderTo=this._appContainer.getElement("#heatmapChart"),this._appContainer.getElement("#breakdownLabel").setHTML(m.BREAKDOWN),this._breakdownChartConfig.chart.renderTo=this._appContainer.getElement("#breakdownChart"),this._appContainer.getElement("#classificationLabel").setHTML(m.CLASSIFICATION),this.classificationChart=this._appContainer.getElement("#classificationChart"),this._classificationChartConfig.chart.renderTo=this.classificationChart,this._appContainer.getElement("#actionPlanBreakdownLabel").setHTML(m.ACTION_PLAN),this._actionPlanBreakdownChartConfig.chart.renderTo=this._appContainer.getElement("#actionPlanBreakdownChart")),t.extend(i,{parentView:this,breakdownChartConfig:this._breakdownChartConfig,heatMapChartConfig:this._heatMapChartConfig,classificationChartConfig:this._classificationChartConfig,actionPlanChartConfig:this._actionPlanBreakdownChartConfig,matrixConfigCollection:this._matrixConfigCollection,viewCollection:this._viewCollection,createConfig:this._createConfig,planConfig:this._planConfig}),this.summaryChartsUtil=new s(i),!n&&this.addScroller(),this._appContainer},initContainerResizeEvent:function(e){let t=this;this._appContainer.removeEvent("resize"),this._appContainer.addEvent("resize",function(){t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){t._shouldWeReloadOnResize()&&(t.summaryChartsUtil&&t.summaryChartsUtil.reflowCharts(),e||t.chartScrollElement&&t.chartScrollElement.setStyle("height",t.summaryChart.getSize().height+"px")),delete t.timer},100)})},addScroller:function(){let e=this._appContainer.getElement("#summaryViewContent");e.setStyle("height",this.getHeight()+"px"),new d({element:e}).inject(this._appContainer.getElement("#summaryViewContainer"))},addChartScroller:function(e){let i=this._appContainer.getElement("#classificationChartContainer"),n=this.summaryChart.getSize().height||i.getSize().height;if(i&&i.empty(),this.chartScrollElement&&this.chartScrollElement.destroy(),e&&e>10){this.chartScrollElement=new t.createElement("div",{id:"chartScrollerElement"}),this.chartScrollElement.setStyle("height",n+"px"),this.classificationChart.inject(this.chartScrollElement),new d({element:this.chartScrollElement}).inject(i)}else this.classificationChart.inject(i)},reset:function(){this.parentView.showHideRightPanel(!1),this.parentView.showMassUpdateToolbarButton(!1),this.summaryChartsUtil.destroyCharts()},loadData:function(e){this.reset(),this._containerHeight=this._appContainer.getBoundingClientRect().height,this._containerWidth=this._appContainer.getBoundingClientRect().width,this.Highcharts?this.summaryChartsUtil.enableAnimation(!1):this.Highcharts=r.get("highcharts");let i=t.clone(e||{},!1);i.parentView=this,this.summaryChartsUtil.processChartsData(i),this.summaryChartsUtil.renderCharts(this.Highcharts,this,i),this.handleInvalidCount()},reloadCharts:function(){!r.get("isComponent")&&this.summaryChartsUtil.reloadClassification()},handleInvalidCount:function(){let e=r.get("context"),t=r.get("isComponent"),i=this._viewCollection.getModelsCountWithInvalidConfig(),n=e&&this._viewCollection.getModelsCountWithInvalidConfigForContext();this._setInvalidCounts(i,n,"#fixInvalidRisksForHeatmap","#configurationMismatchForHeatmap","#heatmapBadge"),t||this._setInvalidCounts(i,n,"#fixInvalidRisksForBreakdown","#configurationMismatchForBreakdown","#breakdownBadge")},_setInvalidCounts:function(e,t,n,o,s){let a=this,l=i.extend(this._appContainer.getElement(s)),d=i.extend(this._appContainer.getElement(n)),h=i.extend(this._appContainer.getElement(o));if(l&&l.show(),d&&d.empty(),h&&h.empty(),e){let t=new c({label:m.FIX+" "+e+" "+m.INVALID+" "+this._governingTypeNLS,emphasize:"medium-attention"});t.inject(d),t.getContent().addEventListener("buttonclick",function(){r.set("invalidRiskFilterisOn","set"),a.parentView.switchTab(1)})}t?(h.set({text:t+" "+m.INVALID_CONFIGURATION+" "+this._governingTypeNLS,title:this._governingTypeNLS+" "+m.INVALID_CONFIGURATION_TOOLTIP}),l&&l.show()):l&&l.hide()},_shouldWeReloadOnResize:function(){var e=this._appContainer.getBoundingClientRect(),t=e.height>0&&e.width>0&&(this._containerHeight!==e.height||this._containerWidth!==e.width);return t&&(this._containerHeight=e.height,this._containerWidth=e.width),t},destroy:function(){this._appContainer&&this._appContainer.destroy()},getHeight:function(){return this.height=this.height?this.height:this.parentView.getHeight()-5},setHeight:function(e){if(this.height=e,this._appContainer){let e=this._appContainer.getElement("#summaryViewContent");e&&e.setStyle("height",this.height+"px")}},isHidden:function(){return this._appContainer.isHidden()},show:function(){this._appContainer&&this._appContainer.show()},hide:function(){this._appContainer&&this._appContainer.hide()}})}),define("DS/ENOProjectMgmtCommonComponents/collection/LinkViewCollection",["UWA/Core","DS/ENOProjectMgmtCommonComponents/collection/ProjectMgmtViewCollection"],function(e,t){"use strict";return t.extend({_uwaClassName:"LinkViewCollection",saveDataModel:function(e,t){if(e.isNew&&e.set("description"," "),this.doNotSave){this.resetDataModelFromClone(e,t);let i=t&&t.onComplete;i&&i.apply(this,arguments)}else this._parent.apply(this,arguments)},getIncludeAndFieldsForSave:function(){return{include:"none,"+this.fieldName,fields:"none,"+this.fieldName+".title,"+this.fieldName+".linkURL,"+this.fieldName+".description,"+this.fieldName+".image"}},processSaveDataModel:function(t,i){if(this.sourceModel){this.currentModel=t,t=this.sourceModel;let n=new this.DataModels;n.add(this.currentModel.model),t.model.set(this.fieldName,n),t.model.performCreateAndConnect=!0;let o=this.getIncludeAndFieldsForSave();i&&e.extend(i,{isNew:!1,ignoreFieldDefinitions:!0,fields:o.fields,include:o.include})}else this.doNotSave||(t.model.performCreateOrEdit=!0,i&&e.extend(i,{ignoreFieldDefinitions:!0}));this._parent(t,i)},handleProcessSaveDataModelOnComplete:function(e){if(this.currentModel){let t=e.get(this.fieldName);t&&t.length&&(t=t[0],this.currentModel.model.set(t),this.currentModel.model.unset("tempId"),this.currentModel.model.resetChangedAttrs()),arguments[0]=this.currentModel,delete this.currentModel}this._parent.apply(this,arguments)}})}),define("DS/ENOProjectMgmtCommonComponents/config/ProfilesListConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/config/DefaultGridConfig","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i){"use strict";let n=e.extend({_uwaClassName:"ProfilesListConfig",columnInfo:{},ignoreCheckBoxSelection:!0,setup:function(){this.setColumnInfo(),this.gridConfig=UWA.clone(t),this.gridConfig.showContextualMenuColumnFlag=!1},type:"basic",values:[{text:i.TITLE,key:"title",dataIndex:"tree",fields:"title,name,description,image,typeicon,modifyAccess,deleteAccess",icon:""},{text:i.NAME,dataIndex:"name"},{text:i.DESCRIPTION,dataIndex:"description"}]});return n._instance=n._instance||new n,n._instance}),define("DS/ENOProjectMgmtCommonComponents/collection/ProfilesCollection",["UWA/Core","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/constants/Constants","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel","DS/ENOProjectMgmtCommonComponents/config/ProfilesPropertiesConfig","DS/ENOProjectMgmtCommonComponents/config/ProfilesListConfig","DS/ENOProjectMgmtCommonComponents/collection/ProjectMgmtViewCollection","DS/ENOProjectMgmtModels/Constants/Constants","DS/ENOProjectMgmtModels/Models/Profile","DS/ENOProjectMgmtModels/Collections/Profiles","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d){"use strict";return a.extend({_uwaClassName:"ProfilesCollection",setup:function(){let e={};e.DataModels=c,e.DataModel=r,e.PropertiesConfig=o,e.TabConfig=o,e.TabConfigForCreate=o,e.ListConfig=s,e.CloneModel=n,e.governingType=l.TYPENAMES.PROFILES,e.governingTypeNLS=d.PROFILES,this._parent(e)}})}),define("DS/ENOProjectMgmtCommonComponents/components/CommonCalendar",["UWA/Core","DS/Controls/Tab","DS/ENOProjectMgmtModels/Models/Calendar","DS/ENOProjectMgmtCommonComponents/views/CalendarsView","DS/ENOProjectMgmtCommonComponents/components/CustomDataGridView","DS/ENOProjectMgmtCommonComponents/collection/ProjectMgmtViewCollection","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/config/CalendarDisplayListConfig","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","UWA/Class/Collection","UWA/Class/Model","text!DS/ENOProjectMgmtCommonComponents/assets/templates/calendar-view-template.html.handlebars","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g){"use strict";return e.Class.View.extend({_uwaClassName:"CalendarsView",_appConfig:void 0,_container:void 0,_viewCollection:void 0,_calendar:void 0,_calendarData:void 0,_currentModel:void 0,_workingExceptions:[],_nonWorkingExceptions:[],_weekendDays:[],_eventContainer:void 0,_days:{Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},_monthslist:{January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11},_days_small:{Sun:0,Mon:1,Tue:2,Wed:3,Thu:4,Fri:5,Sat:6},init:function(t,n){let o=n||{};if(this._container=t,this._calendarContainer=new e.createElement("div"),this._appConfig=o.appConfig,o.calendarId)this._currentModel=new i,this._currentModel.set("id",o.calendarId);else if(o.model)if(o.model.get("exceptions")&&o.model.get("workweek"))this._currentModel=o.model;else{this._currentModel=new i,this._currentModel.id=o.model.get("id")||o.model.get("calendarId"),this._currentModel.url=o.model.url;let e={};e.id=this._currentModel.id,e.title=o.model.get("title"),e.relativePath=o.model.get("relativePath"),this._currentModel.set(e)}o&&o.viewCollection?this._viewCollection=n.viewCollection:this._viewCollection=new s({})},render:function(){let i=this;if(this._container.empty&&this._container.empty(!0),this._calendarContainer=this._calendarContainer.setHTML(m),this._calendarContainer=this._calendarContainer.getElement(".ds-app-dialog-container"),this._exceptionTabContainer=this._calendarContainer.getElement(".ds-app-calendar-gridview-container"),this._exceptionContainer=new e.createElement("div"),this._exceptionContainer.inject(this._exceptionTabContainer),this._calendarTabContainer=this._calendarContainer.getElement(".ds-app-calendar-preview-container"),this._calendarControlContainer=this._calendarTabContainer.getElement(".ds-app-calendar-preview"),this._eventListContainer=this._calendarTabContainer.getElement(".ds-app-calendar-event-list"),this._eventContainer=this._eventListContainer.getElement(".ds-app-calendar-events"),this._toolbarContainer=this._calendarContainer.getElement(".ds-app-dialog-toolbar"),!this._currentModel)return;let n={ignoreFieldDefinition:!0,model:this._currentModel,fields:"all,exceptions.nextOccurrence"};this._ddTabBar=new t({id:"commonCalendarDialogTab",displayStyle:"strip",showComboBoxFlag:!1}),this._ddTabBar.inject(this._toolbarContainer),this._createTabs();let o=this._handleTabClickEvents.bind(this);return this._ddTabBar.addEventListener("tabButtonClick",o),this._ddTabBar.fire("tabButtonClick"),this._createCalendar(),i._calendar.addEventListener("change",function(){i._calendar.allowUndefinedFlag=!0}),i._calendar.elements.monthsCombo.addEventListener("change",function(){i._calendar.value=void 0}),i._calendar.elements.yearsCombo.addEventListener("change",function(){i._calendar.value=void 0}),i._calendar.elements.todayButton.addEventListener("buttonclick",function(){i._calendar.value=[new Date]}),this._currentModel.get("exceptions")&&this._currentModel.get("workweek")?i._onPostCalendarDetailsFetch():this._viewCollection.getDataModelDetails(n).then(function(){i._onPostCalendarDetailsFetch()},function(){}),this._calendarContainer},_onPostCalendarDetailsFetch:function(){this._workingExceptions=[],this._nonWorkingExceptions=[],this._generatePatternForExceptions(),this.repaintCalendarDates()},_createExeptionsDefinition:function(){this._exceptionDefinitionDataGrid=new o({container:this._exceptionContainer,treeDocument:this._treeDocument,config:l})},_createCalendar:function(){this._calendar=new n(this,{value:void 0,allowMultipleValuesFlag:!0,minValue:new Date(1900,1,1),maxValue:new Date(2122,1,1)}),this._calendar.inject(this._calendarControlContainer)},_createTabs:function(){let e=this,t=[{name:g.CALENDAR,selected:!0,font:"calendar",checkFlag:!0},{name:g.EXCEPTION_DEFINITION,font:"view-list",checkFlag:!0}];t.forEach(i=>{e._ddTabBar.add({label:i.name,isSelected:i.selected,icon:{iconName:i.font,fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"2x"},checkFlag:t.checkFlag}).button})},_handleTabClickEvents:function(e){let t=e.dsModel,i=t.value;t.buttonGroup&&(t.buttonGroup.previouslySelectedIndex=i[0]),0===i[0]?(this._calendarTabContainer.show(),this._exceptionTabContainer.hide()):(this._calendarTabContainer.hide(),this._exceptionTabContainer.show())},_createDisplayElements:function(t,i,n){return new e.createElement(t,{class:i,text:n})},_retrieveWorkHours:function(e,t){return t.get("workweek")[e].workingHours.split(/[-,]+/)},_displayExceptionList:function(t,i,n,o){let s=this._getFirstDateInDisplayPanel(),l=this._getLastDateInDisplayPanel(),r=new e.createElement("div",{class:"ds-app-calendar-event"});if(r.inject(this._eventContainer),!o||n){if(i>=s&&i<=l){let e=a.getIntlDateFormat(i);if(this._createDisplayElements("div","ds-app-calendar-date",e.displayValue).inject(r),!n){this._createDisplayElements("div","ds-app-exception-name",t.title).inject(r)}let o=n?this._retrieveWorkHours(i.getDay(),t):t.workingHours.split(/[-,]+/),s=this._getWorkingHoursFormat(o[0].slice(0,2),o[0].slice(2,4)),l=this._getWorkingHoursFormat(o[o.length-1].slice(0,2),o[o.length-1].slice(2,4)),c=!1;if(n?"Working"===t.get("workweek")[i.getDay()].workdayType&&(c=!0):"Working"===t.exceptionType&&(c=!0),c){this._createDisplayElements("div","ds-app-exception-hours",g.WORKING_HOURS+": "+s+"-"+l).inject(r)}if(!n){this._getWeekendDays();let e="Non Working"===t.exceptionType?"non-working":"working",n=this._weekendDays[i.getDay()]?"weekend":"weekday",o="Working"===t.exceptionType?g.WORKING:g.NON_WORKING,s=this._createDisplayElements("div","ds-app-exception-type",o);s.setAttributes({"data-exception-type":e,"data-day-type":n}),s.inject(r)}}}else{this._createDisplayElements("span","empty-view-title",g.NO_CALENDAR_EXCEPTIONS_FOUND).inject(r)}},_addClassToElement:function(e,t,i,n){e.hasClassName(t)&&(n&&e.removeClassName(t),e.addClassName(i))},repaintCalendarDates:function(){if(!this._calendar)return;this._getExceptionList();let t=this._calendar.getContent().getElements(".other-date"),i=this._calendar.getContent().getElements(".days");null!==this._calendar.getContent().getElement(".today")&&i.push(this._calendar.getContent().getElement(".today")),i.push(...t);let n=e.clone(this._weekendDays),o=e.clone(this._nonWorkingExceptions),s=e.clone(this._workingExceptions),a=[],l=[];a=this._getDatesInElementValueFormat(o),l=this._getDatesInElementValueFormat(s);for(let e=0;e<i.length;e+=1){a.includes(i[e].dataset.value)&&(this._addClassToElement(i[e],"other-date","ds-app-non-working")||this._addClassToElement(i[e],"days","ds-app-non-working")||this._addClassToElement(i[e],"today","ds-app-non-working")),l.includes(i[e].dataset.value)&&a.includes(i[e].dataset.value)?this._addClassToElement(i[e],"ds-app-non-working","ds-app-working",!0):l.includes(i[e].dataset.value)&&(this._addClassToElement(i[e],"other-date","ds-app-working")||this._addClassToElement(i[e],"days","ds-app-working")||this._addClassToElement(i[e],"today","ds-app-working"));let t=i[e].dataset.value.split("/"),o=t[1]+"/"+t[0]+"/"+t[2];n[new Date(o).getDay()]&&(a.includes(i[e].dataset.value)?this._addClassToElement(i[e],"ds-app-non-working","ds-app-weekend")||this._addClassToElement(i[e],"other-date","ds-app-weekend non-working"):l.includes(i[e].dataset.value)?this._addClassToElement(i[e],"ds-app-working","ds-app-weekend")||this._addClassToElement(i[e],"other-date","ds-app-weekend working"):this._addClassToElement(i[e],"days","ds-app-weekend"))}this._workingExceptions=[],this._nonWorkingExceptions=[]},_getDailyExceptionDates:function(e,t){let i=this._getFirstDateInDisplayPanel(),n=this._getLastDateInDisplayPanel(),o=this._getDateBasedOnMMDDYYYY(new Date(Math.max(e,i))),s=this._getDateBasedOnMMDDYYYY(new Date(Math.min(t,n))),a=this._getDateBasedOnMMDDYYYY(new Date(e.getTime())),l=[];for(;a<=s;){if(o<=a&&a<=s&&a>=i&&a<=n){let e=this._getDateBasedOnMMDDYYYY(new Date(a));l.push(e)}a.setDate(a.getDate()+1)}return l},_getWeeklyExceptionDates:function(e,t,i){let n=e.split(","),o=[];return n.forEach(e=>{if(""!==e){let n=this._days_small[e],s=this._getFirstDateInDisplayPanel(),a=this._getLastDateInDisplayPanel();for(;s.getDay()!==n;)s.setDate(s.getDate()+1);for(;s<=a;)t<=s&&s<=i&&(o.push(new Date(s.getTime())),this._getDateBasedOnMMDDYYYY(new Date(s))),s.setDate(s.getDate()+7)}}),o},_getMonthlyException_TypeWeekly_Helper:function(e,t,i,n,o,s,a,l){let r=this._getFirstInstanceOfSelectedWeekDay(e,t),c=this._weekdaysProcessing(n,r,i),d=this._getSelectedDayOfWeekForMonthly(c,o),h=void 0;return"CURRENTMONTH"===l&&s<=d&&d<=a&&(h=this._getDateBasedOnMMDDYYYY(new Date(d))),"PREVIOUSMONTH"===l&&this._getFirstDateInDisplayPanel()<=d&&d<=i&&s<=d&&d<=a&&(h=this._getDateBasedOnMMDDYYYY(new Date(d))),"NEXTMONTH"===l&&this._getFirstDateInDisplayPanel()<=d&&d<=this._getLastDateInDisplayPanel()&&s<=d&&d<=a&&(h=this._getDateBasedOnMMDDYYYY(new Date(d))),h},_getMonthlyExceptionDates_DayOfWeekOfMonthType:function(e,t,i,n){let o=[],s=this._days[e],a=this._getDateBasedOnMMDDYYYY(new Date(i)),l=this._getDateBasedOnMMDDYYYY(new Date(n)),r=this._getMonthAndDateSwappedForFirstElement(".days"),c=new Date(r),d=this._getDateBasedOnMMDDYYYY(new Date(c.getFullYear(),c.getMonth(),1)),h=new Date(c.getFullYear(),c.getMonth()+1,0),u=this._getMonthlyException_TypeWeekly_Helper(s,c,h,[],t,a,l,"CURRENTMONTH");void 0!==u&&o.push(u);let m=[],g=this._getFirstDateInDisplayPanel();if(g<new Date(d)){let e=this._getDateBasedOnMMDDYYYY(this._getFirstDateOfSelectedMonth(g)),i=this._getDateBasedOnMMDDYYYY(this._getLastDateOfSelectedMonth(g)),n=this._getMonthlyException_TypeWeekly_Helper(s,e,i,m,t,a,l,"PREVIOUSMONTH");void 0!==n&&o.push(n)}let p=[],C=this._getLastDateInDisplayPanel(),f=this._getFirstDateOfSelectedMonth(C),D=this._getLastDateOfSelectedMonth(C);if(C>h){let e=this._getMonthlyException_TypeWeekly_Helper(s,f,D,p,t,a,l,"NEXTMONTH");void 0!==e&&o.push(e)}return o},_getYearlyExceptionsDates_DayOfMonthTypeHelper:function(e,t,i,n,o,s,a){let l=[];if(i.getMonth()===this._monthslist[t]&&e>=i.getDate()&&e<=n){let t=new Date(i.getMonth()+1+"/"+e+"/"+i.getFullYear()),r=this._getDateBasedOnMMDDYYYY(new Date(t));"CURRENTMONTH"===a&&o<=r&&r<=s&&l.push(new Date(t)),"PREVIOUSMONTH"===a&&o<=r&&r<=s&&r>=i&&l.push(new Date(t)),"NEXTMONTH"===a&&o<=r&&r<=s&&r<=n&&l.push(new Date(t))}return l},_getYearlyExceptionsDates_DayOfMonthType:function(e,t,i,n){let o=this._getFirstDateOfSelectedMonth(this._calendar.referenceDate),s=this._getLastDateOfSelectedMonth(o).getDate(),a=this._getYearlyExceptionsDates_DayOfMonthTypeHelper(e,t,o,s,i,n,"CURRENTMONTH"),l=this._getFirstDateInDisplayPanel(),r=new Date(l.getFullYear(),l.getMonth()+1,0).getDate();if(l<o){let o=this._getYearlyExceptionsDates_DayOfMonthTypeHelper(e,t,l,r,i,n,"PREVIOUSMONTH");a.push(...o)}let c=this._getLastDateInDisplayPanel();if(c.getMonth()!==o.getMonth()){let s=new Date(c.getFullYear(),c.getMonth(),1);if(c>o){let o=this._getYearlyExceptionsDates_DayOfMonthTypeHelper(e,t,s,c,i,n,"NEXTMONTH");a.push(...o)}}return a},_getMonthlyException_TypeDayOfMonth_Helper:function(e,t,i,n,o,s,a){let l=[];if(s.getDate()<=e&&e<=a.getDate()){s.setDate(e);let a=new Date(s);a>=n&&a<=o&&a>=t&&a<=i&&l.push(this._getDateBasedOnMMDDYYYY(new Date(a)))}return l},_getMonthlyException_TypeDayOfMonth:function(e,t,i,n,o){let s=this._getFirstDateOfSelectedMonth(this._calendar.referenceDate),a=this._getLastDateOfSelectedMonth(this._calendar.referenceDate),l=this._getMonthlyException_TypeDayOfMonth_Helper(e,t,i,n,o,s,a),r=this._getFirstDateInDisplayPanel(),c=this._getLastDateOfSelectedMonth(r);if(r.getMonth()!==s.getMonth()){let s=this._getMonthlyException_TypeDayOfMonth_Helper(e,t,i,n,o,r,c);l.push(...s)}let d=this._getLastDateInDisplayPanel(),h=this._getFirstDateOfSelectedMonth(d),u=this._getLastDateOfSelectedMonth(d);if(d.getMonth()!==s.getMonth()){let s=this._getMonthlyException_TypeDayOfMonth_Helper(e,t,i,n,o,h,u);l.push(...s)}return l},_getYearlyExceptionsDates_WeekOfMonthTypeHelper(e,t,i,n,o,s,a,l,r){let c=[],d=this._getFirstInstanceOfSelectedWeekDay(e,n),h=this._weekdaysProcessing([],d,o),u=this._getSelectedDayOfWeekForMonthly(h,t);return s<=u&&u<=a&&u>=l&&u<=r&&o.getMonth()===this._monthslist[i]&&c.push(this._getDateBasedOnMMDDYYYY(new Date(u))),c},_getYearlyExceptionsDates_WeekOfMonthType:function(e,t,i,n,o){let s=this._getFirstDateOfSelectedMonth(this._calendar.referenceDate),a=this._getFirstDateInDisplayPanel(),l=this._getLastDateInDisplayPanel(),r=this._getLastDateOfSelectedMonth(s),c=this._getYearlyExceptionsDates_WeekOfMonthTypeHelper(e,t,i,s,r,n,o,a,l);if(a<s){let s=this._getFirstDateOfSelectedMonth(a),r=this._getLastDateOfSelectedMonth(a),d=this._getYearlyExceptionsDates_WeekOfMonthTypeHelper(e,t,i,s,r,n,o,a,l);c.push(...d)}if(l>r){let s=this._getFirstDateOfSelectedMonth(l),r=this._getLastDateOfSelectedMonth(l),d=this._getYearlyExceptionsDates_WeekOfMonthTypeHelper(e,t,i,s,r,n,o,a,l);c.push(...d)}return c},_callToDisplayFilteredExceptionList:function(e,t){if(0===e.size){let e=!0;this._displayExceptionList(this._currentModel,this._getDateBasedOnMMDDYYYY(new Date),!1,e)}if(t.length>0){let i=!1;for(let n=0;n<t.length;n++)e.has(t[n])?this._displayExceptionList(e.get(t[n]),this._getDateBasedOnMMDDYYYY(new Date(t[n])),!1,i):this._displayExceptionList(this._currentModel,this._getDateBasedOnMMDDYYYY(new Date(t[n])),!0,i)}else{let t=!1;e.forEach((e,i)=>{this._displayExceptionList(e,this._getDateBasedOnMMDDYYYY(new Date(i)),!1,t)})}},_setSortedDatesInSelectedDatesMap:function(e,t,i){for(let e=0;e<i.length;e++){let n=this._getDateBasedOnMMDDYYYY(i._models[e].get("date")).toDateString(),o=i._models[e].get("label");t.has(n)?"Working"===o.exceptionType&&t.set(n,o):t.set(n,o)}return t},_getDatesInElementValueFormat:function(e){let t=[];for(let i=0;i<e.length;i+=1)t[i]='"'+e[i].getDate()+"/"+(e[i].getMonth()+1)+"/"+e[i].getFullYear()+'"';return t},_generatePatternForExceptions:function(){let e=new d;this._eventContainer.empty(),this._treeDocument=new r({dataModelSet:e}),this._currentModel.get("exceptions").forEach(t=>{let i=this._getPatternOfException(t);t.pattern=i;let n="Working"===t.exceptionType?g.WORKING:g.NON_WORKING,o="Daily"===t.frequency?g.DAILY:"Monthly"===t.frequency?g.MONTHLY:"Weekly"===t.frequency?g.WEEKLY:g.YEARLY,s=JSON.parse(JSON.stringify(t));s.exceptionType=n,s.frequency=o;let a=c.createTreeNodeDataModel(e,{label:s.title,grid:s});this._treeDocument.addChild(a),this._exceptionDefinitionDataGrid||this._createExeptionsDefinition()})},_createUWAModelForExceptions:function(e,t){let i=new u;return i.set("label",e),i.set("date",t),i},_getExceptionList:function(){this._eventContainer.empty();let e=new h([],{comparator:"date"});0===this._currentModel.get("exceptions").length&&(this._exceptionDefinitionDataGrid||this._createExeptionsDefinition()),this._currentModel.get("exceptions").forEach(t=>{let i="Working"===t.exceptionType?this._workingExceptions:this._nonWorkingExceptions,n=this._getDateBasedOnMMDDYYYY(new Date(t.startDate)),o=this._getDateBasedOnMMDDYYYY(new Date(t.endDate)),s=this._getFirstDateInDisplayPanel(),a=this._getLastDateInDisplayPanel();if("Daily"===t.frequency){this._getDailyExceptionDates(n,o).forEach(n=>{i.push(n),e.push(this._createUWAModelForExceptions(t,n))})}else if("Weekly"===t.frequency){this._getWeeklyExceptionDates(t.daysOfWeek,n,o).forEach(n=>{i.push(n),e.push(this._createUWAModelForExceptions(t,n))})}else if("Monthly"===t.frequency)if(""!==t.weekOfMonth){this._getMonthlyExceptionDates_DayOfWeekOfMonthType(t.dayOfWeek,t.weekOfMonth,t.startDate,t.endDate).forEach(n=>{i.push(n),e.push(this._createUWAModelForExceptions(t,n))})}else{let l=parseInt(t.dayOfMonth);this._getMonthlyException_TypeDayOfMonth(l,s,a,n,o).forEach(n=>{i.push(n),e.push(this._createUWAModelForExceptions(t,n))})}else if("Yearly"===t.frequency)if(""===t.weekOfMonth){t.dayOfMonth,t.monthOfYear;this._getYearlyExceptionsDates_DayOfMonthType(t.dayOfMonth,t.monthOfYear,n,o).forEach(n=>{i.push(n),e.push(this._createUWAModelForExceptions(t,n))})}else{let s=this._days[t.dayOfWeek],a=t.monthOfYear,l=t.weekOfMonth;this._getYearlyExceptionsDates_WeekOfMonthType(s,l,a,n,o).forEach(n=>{i.push(n),e.push(this._createUWAModelForExceptions(t,n))})}});let t=e.sort(function(e,t){return Number(e[1].date)-Number(t[1].date)}),i=this._getMonthAndDateSwappedForElements(".selected"),n=new Map;n=this._setSortedDatesInSelectedDatesMap(i,n,t),this._callToDisplayFilteredExceptionList(n,i),n.clear(),this._getWeekendDays()},_getDateBasedOnMMDDYYYY:function(e){return new Date(e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear())},_getMonthAndDateSwappedForElements:function(e){let t=this._calendar.getContent().getElements(e),i=[];for(let e=0;e<t.length;e++){let n=t[e].dataset.value.split("/"),o=n[1].replace(/\\|"/g,"")+"/"+n[0].replace(/\\|"/g,"")+"/"+n[2].replace(/\\|"/g,"");i.push(this._getDateBasedOnMMDDYYYY(new Date(o)).toDateString())}return i},_getMonthAndDateSwappedForFirstElement:function(e){let t=this._calendar.getContent().getElement(e).dataset.value.split("/");return t[1].replace(/\\|"/g,"")+"/"+t[0].replace(/\\|"/g,"")+"/"+t[2].replace(/\\|"/g,"")},_getFirstDateOfSelectedMonth:function(e){let t=this._getDateBasedOnMMDDYYYY(e),i=new Date(t.getFullYear(),t.getMonth(),1);return this._getDateBasedOnMMDDYYYY(i)},_getLastDateOfSelectedMonth:function(e){let t=this._getDateBasedOnMMDDYYYY(e),i=new Date(t.getFullYear(),t.getMonth()+1,0);return this._getDateBasedOnMMDDYYYY(i)},_weekdaysProcessing:function(e,t,i){for(;t<=i;)e.push(new Date(t.getTime())),t.setDate(t.getDate()+7);return e},_getSelectedDayOfWeekForMonthly:function(e,t){let i={first:0,second:1,third:2,fourth:3,last:e.length-1}[t.toLowerCase()];return this._getDateBasedOnMMDDYYYY(new Date(e[i]))},_getFirstInstanceOfSelectedWeekDay:function(e,t){for(;t.getDay()!==e;)t.setDate(t.getDate()+1);return t},_getPatternOfException:function(e){let t="",i={First:0,Second:1,Third:2,Fourth:3,Last:4};if("Daily"===e.frequency)t="";else if("Weekly"===e.frequency){let i="";e.daysOfWeek.split(",").forEach(e=>{if(""!==e){let t=this._days_small[e];i+=g.SHORTWEEKDAYS[t]+","}}),t=i.slice(0,i.length-1)}else"Monthly"===e.frequency?t=""!==e.weekOfMonth?g.replace(g.WEEKOFMONTH_DAYOFWEEK_OF_EVERY_MONTH,{WeekOfMonth:g.WEEKOFMONTHLIST[i[e.weekOfMonth]],DayOfWeek:g.WEEKDAYS[this._days[e.dayOfWeek]]}):g.replace(g.DAY_DAYOFMONTH_OF_EVERY_MONTH,{dayOfMonth:e.dayOfMonth}):"Yearly"===e.frequency&&(t=""===e.weekOfMonth?g.replace(g.DAY_DAYOFMONTH_MONTHOFYEAR,{DayOfWeek:e.dayOfMonth,MonthOfYear:g.MONTHS[this._monthslist[e.monthOfYear]]}):g.replace(g.WEEKOFMONTH_DAYOFWEEK_OF_MONTHOFYEAR,{WeekOfMonth:g.WEEKOFMONTHLIST[i[e.weekOfMonth]],DayOfWeek:g.WEEKDAYS[this._days[e.dayOfWeek]],MonthOfYear:g.MONTHS[this._monthslist[e.monthOfYear]]}));return t},_getLastDateInDisplayPanel:function(){let e=this._getMonthAndDateSwappedForElements(".days"),t=e[e.length-1];if(null===this._calendar.getContent().getElement(".other-date"))return this._getDateBasedOnMMDDYYYY(new Date(t));let i=this._getMonthAndDateSwappedForElements(".other-date"),n=new Date(i[i.length-1]),o=new Date(t);return this._getDateBasedOnMMDDYYYY(new Date(Math.max(n,o)))},_getFirstDateInDisplayPanel:function(){if(null===this._calendar.getContent().getElement(".other-date"))return this._getDateBasedOnMMDDYYYY(new Date(this._getMonthAndDateSwappedForFirstElement(".days")));let e=this._getDateBasedOnMMDDYYYY(new Date(this._getMonthAndDateSwappedForFirstElement(".other-date"))),t=this._getDateBasedOnMMDDYYYY(new Date(this._getMonthAndDateSwappedForFirstElement(".days")));return this._getDateBasedOnMMDDYYYY(new Date(Math.min(e,t)))},_getWorkingHoursFormat:function(e,t){let i=e,n=i>=12?"PM":"AM";return(i=i%12||12)+":"+t+" "+n},_getWeekendDays:function(){this._currentModel.get("workweek").forEach(e=>{if("Non Working"===e.workdayType){let t=this._days[e.dayOfWeek];this._weekendDays[t]=!0}})},destroy:function(){this._calendar&&this._calendar.destroy(),this._container.empty&&this._container.empty(),this._exceptionDefinitionDataGrid&&(this._exceptionDefinitionDataGrid.destroy(),delete this._exceptionDefinitionDataGrid)}})}),define("DS/ENOProjectMgmtCommonComponents/views/ClassificationView",["UWA/Core","UWA/Promise","DS/Controls/Button","DS/Controls/ComboBox","DS/Controls/Accordeon","DS/Controls/TooltipModel","DS/UIKIT/DropdownMenu","DS/DocumentManagement/DocumentManagement","DS/E6WCommonUI/Views/DetailsDisplayView","DS/ENOProjectMgmtCommonComponents/views/DateCustomView","DS/ENOProjectMgmtCommonComponents/views/MultiValueCustomView","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel","DS/ENOProjectMgmtCommonComponents/utils/ClassificationCloneModel","DS/ENOProjectMgmtCommonComponents/collection/ClassificationCollection","DS/ENOProjectMgmtModels/Models/Task","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Models/RelatedDataItem","DS/ENOProjectMgmtModels/Collections/RelatedDataItems","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g,p,C,f,D,w,E,M){"use strict";return e.Class.View.extend({_uwaClassName:"ClassificationView",propertiesList:void 0,labelContainer:void 0,comboBoxContainer:void 0,comboBox:void 0,container:void 0,currentModel:void 0,sourceModel:void 0,detailsDisplayViews:void 0,filledSeperateAccordeon:void 0,parentView:void 0,init:function(t,i){let n=e.clone(i||{},!1);if(this.container=t,this.isComponent=n.isComponent,this.parentView=n.parentView||n.homeView,this.isComponent){this.sourceModel=n.currentModel;let e=new f({id:this.sourceModel.get("id"),type:this.sourceModel.get("type"),modifyAccess:this.sourceModel.get("modifyAccess"),state:this.sourceModel.get("state")}),t=new g(e);this.currentModel=t}else this.currentModel=n.currentModel},reset:function(){this.comboBoxContainer&&this.comboBoxContainer.destroy();for(let e in this.detailsDisplayViews)this.detailsDisplayViews.hasOwnProperty(e)&&this.detailsDisplayViews[e].destroy();this.filledSeperateAccordeon&&(this.filledSeperateAccordeon.destroy(),delete this.filledSeperateAccordeon)},render:function(){let t=this;if(this.container.empty(!0),this.reset(),this.detailsDisplayViews={},this._addLabelContainer(),this.comboBoxContainer=e.createElement("div"),this.comboBoxContainer.inject(this.parent),this.detailsContainer=e.createElement("div"),this.detailsContainer.inject(this.parent),this.isComponent){if(!D.isValidCollabspace())return this.selectLabel.setContent(M.UNSUPPORTED_CREDENTIAL),this;let e={model:this.currentModel.model,fields:"none,classes.title",include:"none,classes",refresh:!0};C.getDataModelDetails(e).then(function(){t._loadClassifictions()},function(e){h.buildNotification({title:M.CLASSIFICATION_FAILURE,message:m.getErrorMessage(e)},"error")})}else this._loadClassifictions();return this},_addLabelContainer:function(){this.container.addClassName("object-properties"),this.parent=e.createElement("div",{class:"object-properties-list"}),this.container.appendChild(this.parent),this.labelContainer=e.createElement("div"),this.labelContainer.inject(this.parent),this.selectLabel=e.createElement("label",{id:"selectLabel",text:M.SELECT_CLASSIFICATION_TO_ADD}),this.selectLabel.inject(this.labelContainer)},acceptChanges:function(e){e&&(this.currentModel=e),this.render()},_loadClassifictions:function(){let e=this;try{let t={addChild:!0,childMemberNames:["ChildClasses"],doNotApplyNodeExpand:!0,performFilterOnTreeDocument:!0,onComplete:function(){e._createClassificationList(),e._checkClassificationAttributesAndAddView()}};C.resetTreeDocument(t)}catch(e){h.buildNotification({title:M.CLASSIFICATION_FAILURE,message:m.getErrorMessage(e)},"error")}},addClassification:function(e){let t=this,i=C.getCurrentDataModel(void 0,e);"General Library"!==i.get("type")&&C.getClassDefinition({id:i.id}).then(function(e){let i=e.get("ClassAttributes");if(i){let n=new w({id:e.id,type:"General Class",name:e.get("name"),title:e.title,Attributes:i,serviceId:u.DEFAULT_SOURCE,modifyAccess:t.currentModel.isNew?"TRUE":t.currentModel.model.get("modifyAccess")}),o=t.currentModel.get("ClassificationAttributes");if(o||(o=new E,t.currentModel.model.set("ClassificationAttributes",o)),!t.currentModel.get("classes")){let e=new E;t.currentModel.model.set("classes",e)}n.isAttributesNew=!0,o.add(n),t.addViewForClassesForCurrentModel().then(t.validateLocalAttrs.bind(t))}},function(e,t){h.buildNotification({title:M.CLASSIFICATION_FAILURE,message:m.getErrorMessage(e,t)},"error")})},_checkClassificationAttributesAndAddView:function(){let e=this;this.currentModel.model.isNew()||e.currentModel.get("ClassificationAttributes")?e.addViewForClassesForCurrentModel():C.getClassifiedItemAttributes(e.currentModel.model).then(function(){e.addViewForClassesForCurrentModel()},function(e,t){h.buildNotification({title:M.CLASSIFICATION_FAILURE,message:m.getErrorMessage(e,t)},"error")})},addViewForClassesForCurrentModel:function(){let e=this;return new t(function(t,i){let n=e.currentModel.get("ClassificationAttributes");n&&n.length?e.prepareClassificationAttributes(n).then(function(i){if(e.filledSeperateAccordeon)i.forEach(t=>{e.filledSeperateAccordeon.addItem(t);let i=e.filledSeperateAccordeon.items.length-1;e._addChevronForExpander(n,t,i)});else{e.filledSeperateAccordeon=new o({items:i,style:"filled-separate",exclusive:!1}).inject(e.detailsContainer);for(let t=0;t<i.length;t++)e._addChevronForExpander(n,i[t],t)}t(i)},function(e,t){h.buildNotification({title:M.CLASSIFICATION_FAILURE,message:m.getErrorMessage(e,t)},"error"),i()}):t()})},createAndShowContextMenu:function(e){this.createMenu(e),m.showAndUpdateContextualDropdownMenuPosition(this.dropdownMenu,e)},createMenu:function(t,i){t.stopPropagation(),t.preventDefault();let n=e.Event.getElement(t),o=n.getClosest(".wux-controls-expander-header").getAttribute("data-id"),s=e.clone(i||{},!1),a=this.currentModel.get("ClassificationAttributes"),l={event:t,key:o,target:s.target||n,model:a&&a.get(o)};this.dropdownMenu&&this.dropdownMenu.destroy(),this.createClassificationsMenu(l)},createClassificationsMenu:function(t){let i=this,n=e.clone(t||{},!1);this.dropdownMenu=new a({target:n.target,key:n.key,items:this.getClassificationsDropDownMenuItems(n),events:{onClickOutside:function(){this.menus&&this.destroy(),delete i.dropdownMenu},onHide:function(){this.menus&&this.destroy(),delete i.dropdownMenu}}}),this.setDropdownMenu();let o=this.parentView._viewConfig;return m.addOpenMenuItem(this.dropdownMenu,n.model,o),this.dropdownMenu},getClassificationsDropDownMenuItems:function(e){return[this.getPropertiesButton(e),this.getRemoveButton(e),this.getRelationsButton(e)]},getPropertiesButton:function(t){let i=e.clone(t||{},!1).model;return{name:"properties",text:M.PROPERTIES,fonticon:"attributes",handler:function(){m.launchProperties(i.id,t)}}},getRemoveButton:function(t){let i=this,n=e.clone(t||{},!1);return{name:"remove",text:M.REMOVE,fonticon:"cancel",className:this.currentModel.model.canEdit()?"":"hidden",handler:function(){i._removeClassification(n.key)}}},getRelationsButton:function(e){return m.getRelationsButton(e)},_addChevronForExpander:function(e,t,n){let o=this.filledSeperateAccordeon.getExpanderFromIndex(n),a=o.getContent().getElement(".wux-controls-expander-header");a.setAttribute("data-id",t.key),a.tooltipInfos=new s({shortHelp:t.header});let l=new i({domId:"clasificatonAttributeOptionsButton",emphasize:"secondary",icon:{iconName:"chevron-down",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},tooltipInfos:new s({shortHelp:M.MORE_ACTIONS})}).inject(a);this._handleEvents(o,l,a)},_handleEvents:function(e,t,i){let n=this;e.elements.bodyContainer.addEventListener("keyup",function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1}),t.getContent().addEventListener("buttonclick",function(){e.expandedFlag=Boolean(!e.expandedFlag),n.createMenu(event,{target:this}),setTimeout(function(){n.dropdownMenu.show()},1)}),i.addEventListener("contextmenu",function(e){n.createAndShowContextMenu(e)},!1)},removeClassificationSectionView:function(e){let t=m.findIndex(this.filledSeperateAccordeon.items,"key",e),i=this.filledSeperateAccordeon.items[t];i.content&&i.content.destroy(),delete this.detailsDisplayViews[i.key],this.filledSeperateAccordeon.deleteItem(t)},_removeClassification:function(e){this.removeClassificationSectionView(e);let t=this.currentModel.get("ClassificationAttributes");if(t){let i=t.get(e);t.remove(i),this.validateLocalAttrs()}},prepareClassificationAttributes:function(e){let i=this,n=[],o={};return i.filledSeperateAccordeon&&i.filledSeperateAccordeon.items&&i.filledSeperateAccordeon.items.forEach(e=>{o[e.key]=!0}),new t(function(t,s){if(e.length){let a=[];e.forEach(function(e){a.push(i._getClassDefinitionAttribute(o,n,e))}),a.length?Promise.all(a).then(()=>{m.sort(n,"header"),t(n)}):s()}else t(n)})},_getClassDefinitionAttribute:function(i,n,o){let s=this;return new t(function(t,a){if(i[o.get("id")])return t();let l=new e.Element("div"),r={key:o.id,expandedFlag:!0,content:l};n.push(r),s.addClassificationAttribute(o.id,s.currentModel,l).then(function(){if(r.header=s._getClassPath(o),n.length){Object.keys(s.currentModel.localAttributes).length||s.currentModel.model.isNew()||delete s.currentModel.modificationsPending}t()},function(e,t){h.buildNotification({title:M.CLASSIFICATION_FAILURE,message:m.getErrorMessage(e,t)},"error"),a()})})},_getClassPath:function(e){return C.getClassPath(e.id)||e.title},addClassificationAttribute:function(e,i,n){let o=this;return new t(function(t,s){let a=i.get("ClassificationAttributes"),l=a&&a.get(e);C.getClassDefinition({id:l.get("id")}).then(function(e){let i=l.get("name")||e.get("name"),s=l.get("title")||e.get("title");l.set({name:i,title:s,type:"General Class",serviceId:u.DEFAULT_SOURCE,modifyAccess:o.currentModel.isNew?"TRUE":o.currentModel.model.get("modifyAccess")}),l.resetChangedAttrs(),e.get("ClassAttributes")&&(o.addModelClassAttribute(l,e,n),t())},function(e,t){h.buildNotification({title:M.CLASSIFICATION_FAILURE,message:m.getErrorMessage(e,t)},"error"),s(t)})})},_addParameterToArgument(e,t){e[2]=t},addModelClassAttribute:function(e,t,i){let n=this,o=t.get("ClassAttributes");if(e){let s=[],a=e.get("Attributes");if(a&&(m.sort(a,"name"),a.forEach(function(i){let a=i.name,l=a.split(" ").join(""),r={label:a,name:l,readWrite:t.get("classUsage")===u.DEFINITION},c=m.findObject(o,"name",a);e.set(l,n._getDetailsDisplayType(i,c,r)),s.push(r)})),s.length){let t=new p(e);this.listenTo(t,{"onChange:modificationsPending":this.validateLocalAttrs.bind(this),onChangeAttributeValue:n._updateAttributeOnOtherClasses.bind(this)});let o=new r({DocumentManagement:l,homeView:this,model:t});o.setConfig(s),o.render().inject(i),this.detailsDisplayViews[e.id]=o}}return i},validateLocalAttrs:function(){this.setModificationPending(),this.currentModel.validationError=this.currentModel.validate(this.currentModel.toJSON()),this.validationError?this.dispatchEvent("onValidationFailure"):this.dispatchEvent("onValidationSuccess")},_updateAttributeOnOtherClasses:function(e,t){for(let i in this.detailsDisplayViews)if(this.detailsDisplayViews.hasOwnProperty(i)){this.detailsDisplayViews[i].model.localAttributes[e]!==t&&this.detailsDisplayViews[i].model.set(e,t)}},setModificationPending:function(){this.currentModel.modificationsPending=!0,this.currentModel.dispatchEvent("onChange:modificationsPending",[this.currentModel]),this.isComponent&&(this.sourceModel.modificationsPending=!0,this.sourceModel.dispatchEvent("onChange:modificationsPending",[this.sourceModel]))},prepareSave:function(){let t=this;for(let i in this.detailsDisplayViews)if(this.detailsDisplayViews.hasOwnProperty(i)){let n={};this.detailsDisplayViews[i]._config.forEach(o=>{let s=t.detailsDisplayViews[i].model,a=s.get(o.name);"checkbox"===o.type&&e.is(a,"array")?n[o.name]=a:C.prepareLocalAttributesToModelAttributes(n,s,o)}),this.detailsDisplayViews[i].model.model.set(n)}},save:function(t){let i=this,n=e.clone(t||{},!1);this.prepareSave();let o={ignorePostSave:!1,isReload:!0,doNotUpdateTaggerData:!0,donotShowMessage:!0,onComplete:function(){i.acceptChanges(),n.onComplete&&n.onComplete.apply(this,arguments)},onFailure:n.onFailure};C.saveClassification(this.currentModel,o)},_getDetailsDisplayType:function(t,i,n){let o=i.type;if(!o)return n.type="text",n.type;let s,a=t.value;if(i.multivalued)n.customView=d;else if(i.multilined)n.removeCarriageReturns=!1;else{"timestamp"===i.type&&(n.customView=c);let t=i.hasOwnProperty("default")&&i.default;switch(o){case"real":case"integer":s=!0,a=Number(a>0?a:t||0);break;case"boolean":a=Boolean(e.is(a,"boolean")?a:JSON.parse(t)).toString().toUpperCase();break;case"string":a=a||t||"";break;case"timestamp":a=a||(t||"")}}if(i.authorizedValues&&(this._addAuthorizedValues(i,n),n.type="select"),!i.authorizedValues||i.multivalued)switch(o){case"string":n.type="text",n.numberOfDisplayLines=1,n.numberOfEditableLines=1,n.removeCarriageReturns=!0;break;case"boolean":n.type="checkbox";break;case"timestamp":n.type="date";break;case"real":n.type="number",n.typeRepresentation="float";break;case"integer":n.type="number";break;case"range":n.type="range";break;default:n.type="text"}return s?(n.allowEmpty=!0,a):a||""},_addAuthorizedValues:function(e,t){let i=[],n="real"===e.type;e.authorizedValues.forEach(e=>{let t={displayValue:e,actualValue:n?Number(e):e};i.push(t)}),t.values=i},_createClassificationList:function(){let e=this.currentModel.model.isNew()?"CreateNewView":void 0,t=C.getDocument(e,!!e||void 0),i=t.getChildren().length;this.currentModel.model.canEdit()||this.currentModel.model.isNew()?(this.selectLabel.setContent(M.SELECT_CLASSIFICATION_TO_ADD),this.comboBox&&(this.comboBox.destroy(),delete this.comboBox),i&&(this.comboBox=new n({elementsTree:t}),this.comboBox.selectedIndex=0,this.comboBox.inject(this.comboBoxContainer),this.comboBox.addEventListener("change",this.addClassification.bind(this,e)))):this.selectLabel.setContent(M.CLASSIFICATION_PATHS),!i&&this.selectLabel.setContent(M.CLASSIFICATION_LIBRARY_NOT_FOUND)},setDropdownMenu:function(){let e=this.parentView;e&&(e.dropdown=this.dropdownMenu)},destroy:function(){this.selectLabel.destroy(),this.labelContainer.destroy(),C.resetTreeDocument({view:this.currentModel.model.isNew()?"CreateNewView":void 0}),this.comboBox&&this.comboBox.removeEventListener("change"),this.comboBox&&this.comboBox.destroy(),this.reset(),this.parent.destroy()}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtDetailsAndRelationships",["UWA/Core","UWA/Class/View","DS/Controls/Tab","DS/Controls/Button","DS/Controls/TooltipModel","DS/UIKIT/Scroller","DS/UIKIT/DropdownMenu","DS/SocialToolbar/SocialToolbar","DS/ENOProjectMgmtCommonComponents/views/DetailsDisplay","DS/ENOProjectMgmtCommonComponents/views/ClassificationView","DS/ENOProjectMgmtCommonComponents/views/DetailsDisplayFooter","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtTrendView","DS/ENOProjectMgmtCommonComponents/views/DateCustomView","DS/ENOProjectMgmtCommonComponents/views/MultiValueCustomView","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/components/ProgressSpinner","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtModels/Models/AppSettings","text!DS/ENOProjectMgmtCommonComponents/assets/templates/template_RightPanel.html.handlebars","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g,p,C,f,D,w,E){"use strict";let M,_=0,S=1,b=2,y=3,P=t.extend({_uwaClassName:"ProjectMgmtDetailsAndRelationships",init:function(t,i){let n=e.clone(i||{},!1);if(this.options=n,this.parentContainer=t,this.isCreate=n.isCreate,this.parentView=n.parentView,this._appConfig=n.appConfig,this._tabConfig=this._getTabConfig(n),this._viewCollection=n.viewCollection,this._viewConfig=n.viewConfig,this._createConfig=n.createConfig,this._matrixConfigCollection=i.matrixConfigCollection,this.context=n.context,this.editModel=n.editModel,this.relatedView={},this.scrollElements={},this.detailsDisplayBodyContainers={},this.detailsContainer=e.createElement("div",{id:"objectInfoContainer"}),this.detailsContainer.setHTML(w),this.propertiesContainer=this.detailsContainer.getElement(".object-properties"),this.propertiesBodyContainer=this.detailsContainer.getElement(".object-properties-body"),!this.isRMCContext){let e=this.detailsContainer.getElement(".object-properties-list");e&&e.remove()}this.buildTabBarContainer(n),this.addActionButtonAndOperations(),this.isCreate||(this.isRMCContext||(this.clearRightPanelContent(this.parentContainer),this.detailsDisplayFooterContainer=this.detailsContainer.getElement(".object-properties-footer"),this.detailsDisplayFooter=new d(this.detailsDisplayFooterContainer,this)),this.detailsContainer.inject(this.parentContainer))},clearRightPanelContent:function(e){if(e){e.getElements("#objectInfoContainer").forEach(e=>e.remove())}},reset:function(){this.destroyDetailsDisplayTabContent();for(let e in this.scrollElements)this.scrollElements.hasOwnProperty(e)&&this.scrollElements[e].destroy();this.scrollElements={},this._isPropertyPanelOpen=!1,this.currentModel&&this.currentModelEvents&&this.currentModel.removeEvents(this.currentModelEvents),delete this.currentTab,delete this.currentModel,delete this.currentModelEvents,delete this._isPropertyPanelOpen},render:function(t){let i=this;this._initialLoad=!0;let n=e.clone(t||{},!1);if(this.showSpinnerView(this.propertiesContainer,E.FETCHING),this.isCreate||this.isRMCContext||(this.clearRightPanelContent(this.parentContainer),this.detailsContainer.inject(this.parentContainer)),this.reset(),this.isCreate)this.createData(this._tabConfig.values[0].config,n);else if(this.editModel)this.currentModel=new this._viewCollection.CloneModel(this.editModel),this.handleGetDataResponse();else{this._viewCollection.getDataModelDetails(n).then(e=>i.handleGetDataResponse(e))}return this.detailsContainer},handleDetailsDisplay:function(e){this.showDetailsDisplay(e),this._initialLoad&&this.handleInitialOpenPropertyPanel(),this.updateScrollPosition(),delete this._initialLoad},handleInitialOpenPropertyPanel:function(){delete this.currentModel.modificationsPending,this.currentModel.dispatchEvent("onChange:modificationsPending"),this.isNew&&this.currentModel.dispatchEvent("onValidationSuccess")},getSelectedTabKey:function(){let e=this.ddTabBar&&this.ddTabBar.tabBar,t=e&&e.getButtonFromValue(this.ddTabBar.value);return t&&t[0].domId},processTabContentRenderView:function(){this.ddTabBar.fire("tabButtonClick")},handleGetDataResponse:function(){this.ddTabBar?this.processTabContentRenderView():this.handleDetailsDisplay(),this.hideSpinnerView(this.propertiesContainer)},getDetailsDisplayDivContent:function(t){return e.createElement("div",{id:t+"Container",class:"details-display-container"})},addScroller:function(t,i){if(this.propertiesBodyContainer){this.scrollElements[t]=new e.createElement("div",{id:"scrollerElement"}),this.scrollElements[t].setStyle("height",this.getHeight()+"px"),i.inject(this.scrollElements[t]);let n=new s({element:this.scrollElements[t]});n.elements.content.addEventListener("scroll",()=>this.dropdown&&this.dropdown.destroy()),n.inject(this.propertiesBodyContainer),this.relatedView[t].scroller=n}},getScroller:function(e){let t=e;return this.relatedView&&this.currentTab&&(t=this.relatedView[this.currentTab.key]),t&&t.scroller},updateScrollPosition:function(){let e=this.getScroller();if(e){let t=e._previousInfos;t&&e.scrollTo(t.x.scrollPosition,t.y.scrollPosition)}},buildTabBarContainer:function(t){let n=e.clone(t||{},!1);if(this._tabConfig||(this._tabConfig=this._getTabConfig(n)),this._tabConfig.hide)return;let s=this.detailsContainer.getElement(".object-properties-tabs");this.ddTabBar=new i({id:"detailsPanelTab",displayStyle:"strip",showComboBoxFlag:!1}),this.ddTabBar.inject(s);let a=this._tabConfig.values,l=a.length;for(let e=0;e<l;e++){let t=a[e];if("classification"!==t.key||t.doNotShowTab||(t.doNotShowTab=!this._viewConfig.isLibraryInstalled()),!t.doNotShowTab){this.ddTabBar.add({isSelected:t.selected,icon:{iconName:t.font,fontIconFamily:WUXManagedFontIcons.Font3DS},tooltipInfos:new o({shortHelp:t.name}),type:"radio",checkFlag:t.checkFlag}).button.domId=t.key}}this.initializeTabEvents()},initializeTabEvents:function(){let t=this.ddTabBar.tabBar,i=t.buttonGroup,n=t.showNextButton,o=t.showPreviousButton;this.ddTabBar.addEventListener("dragenter",function(t){let n=t.target.dsModel,o=n&&n.value;if(e.is(o,"number")&&o>=0){let e=i.getButton(o);e.clickMode=0,e.fire("click")}}),n&&n.addEventListener("dragenter",function(){!n.disabled&&n.fire("click")}),o&&o.addEventListener("dragenter",function(){!o.disabled&&o.fire("click")}),this.ddTabBar.addEventListener("tabButtonClick",this.handleTabBarActionEvents.bind(this))},handleTabBarActionEvents:function(e){let t=e.target.dsModel.value;if(t){let e=this.ddTabBar.tabBar.getButtonFromValue(t)[0].domId,i=this._tabConfig.columnInfo[e];this.currentTab=i,this.currentTabView=this.relatedView[e],"history"!==e&&"riskTrend"!==e||this.relatedView[e]&&this.relatedView[e].reload();for(let t in this.relatedView)e!==t?this.scrollElements[t].hide():this.scrollElements[t].show();let n=this.relatedView[e];n?n.resetConfigAndRender&&n.resetConfigAndRender():this.handleDetailsDisplay(i)}},_setFieldReadWrite:function(t,i){let n=this.currentTab.config.columnInfo[t];if(n){let t=this.currentModel.model[i];i=e.is(t,"function")?t.apply(this.currentModel.model):i,n.readWrite=Boolean(i)}},cancelCreateOrEdit:function(){this.currentModel=this.currentModel||this._viewCollection.getCurrentDataModel(void 0),this.currentModel?(this.currentModel.cancel(),delete this.currentModel,this.resetDetailsAndRealtionshipsView()):(this.destroyDetailsDisplayTabContent(),this.showSaveCancelFooter(!1))},resetDetailsAndRealtionshipsView:function(){this._viewCollection.reselectCurrentDataModel()},getActionButtonConfig:function(){let t=this._tabConfig.actionButtonConfig;return e.is(t,"function")?t.apply(this,[{isCreate:this.isCreate}]):t},addActionButtonAndOperations:function(){if(this._actionButtonConfig=this.getActionButtonConfig(),!this._actionButtonConfig)return;let e=this.detailsContainer.getElement(".object-properties-actions");this.actionsButton=new n({displayStyle:"lite",domId:"actionsButton",emphasize:"secondary",icon:{iconName:"fonticon fonticon-chevron-down site-icon",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},tooltipInfos:new o({shortHelp:E.ACTIONS}),checkFlag:!1}).inject(e),this.actionsButton.getContent().addEventListener("buttonclick",f.validateModificationsPending.bind(void 0,{dontResetModel:!0,parentView:this.parentView.parentApp,yesEventFunc:this.createActionsDropdownMenu.bind(this)}))},createActionsDropdownMenu:function(e){let t=this._actionButtonConfig.getItems(this.currentModel.model,e);this.dropdownMenu&&this.dropdownMenu.destroy(),this.dropdownMenu=new a({target:this.actionsButton.getContent(),items:t,events:{onClick:this.handleActionButtonEvents.bind(this)}}),this.dropdownMenu.show()},handleActionButtonEvents:function(e,t){let i=t.name;switch(i){case C.DELETE:case C.REMOVE:this.handleDeleteAction({operation:i});break;case C.DUPLICATE:this._viewCollection.duplicateDataModels({operation:i,isSelect:this.isPropertyPanelOpen()});break;case C.LINK:f.getCopyLinkURL(this.currentModel),g.buildNotification({message:E.LINK_COPY_TO_CLIPBOARD},"success");break;case C.COMPLETE:case C.RE_OPEN:{this.currentModel.cancel();let e=i===C.COMPLETE?C.COMPLETE_STATE:C.IN_WORK_STATE;this.currentModel.handleAttrsUpdateForActions(C.STATE_ATTR,e);break}}},createData:function(t,i){let n=e.clone(i||{},!1);if(n.model)this.currentModel=n.model;else{let i=n.modelIntializationOption?e.clone(n.modelIntializationOption,!1):n;if(this.context){let t=e.clone(i.attributes||{},!1);i.attributes=t,i.attributes.context=this.context}this.currentModel=this._viewCollection.getNewDataModel(t,i)}this.CreateOrEdit(),this.updateStateOfFooterButtons(!0),this.hideSpinnerView()},CreateOrEdit:function(){this.handleDetailsDisplay(),this.showSaveCancelFooter(!0)},modelChanged:function(e){this.showSaveCancelFooter(e)},initializeEvents:function(t){let i=e.clone(t||{},!1);this.currentModelEvents={submitSave:this.save,"onChange:modificationsPending":this._notifyChanges,disableSaveButton:this.updateStateOfFooterButtons,onChange:function(e,t){let i=t&&t.config||t;i&&this.handleTabCustomRender(i.name,e)}},Object.keys(i).length&&e.extend(this.currentModelEvents,i),this.listenTo(this.currentModel,this.currentModelEvents),this.listenTo(this.currentModel.model,"onChange:"+C.ASSIGNEE_ATTR,this.handleTabCustomRender.bind(this,C.ASSIGNEE_ATTR))},isMembersTab:function(){return Boolean("members"===this.currentTab.key&&this.currentTabView&&this.currentModel)},handleTabCustomRender:function(e){switch(e){case"members":this.isMembersTab()&&(this._membersTab=this.currentTabView),this.handleAssigneesFieldCustomBtns();break;case C.ASSIGNEE_ATTR:this.handleAssigneesFieldCustomBtns()}},handleAssigneesFieldCustomBtns:function(){if(this._membersTab){let e,t,i=[],n=f.isSelfAssigned(this.currentModel),o=this.currentModel.model.canModify()||this.isCreate,s=this.currentModel.model.canToConnect()||this.isCreate;this._membersTab._config.getAssigneesCustomButtons().forEach(a=>{switch(a.id){case C.ASSIGN_TO_SELF:t="add",e=o&&s&&!n;break;case C.REMOVE_ASSIGN_TO_SELF:t="remove",e=o&&n}e&&(a.callback=this.currentModel.handleAssigneeUpdate.bind(this.currentModel,t),i.push(a))}),this._membersTab._config.columnInfo.assignees.customButtons=i,this.currentModel.updateDetailsDisplay()}},displayTabBarAndActionButtons:function(){let e=this.detailsContainer.getElement(".object-properties-tabs");this.detailsContainer.getElement(".object-properties-actions").toggleClassName("hide",!this._actionButtonConfig),!this._actionButtonConfig&&e.toggleClassName("hide",Boolean(this._tabConfig.hide||1===this._tabConfig.values.length))},updateContextFieldReadWrite:function(t){let i,n=(t=t||this.currentTab.config)&&t.columnInfo.context;if(n&&(i=n.readWrite,i=e.is(i,"string")?Boolean(i):i),this.currentTab.checkFlag&&n&&e.is(i,"boolean")){let e=!1;if(this.isNew)e=!this.context;else{let t=this.currentModel.getContextModel();e=Boolean(!t||t.canReadAccess())}n.readWrite=e}},showDetailsDisplay:function(e,t){if(e||(e=this._tabConfig.getDefaultTab(t)),this.currentTab=e||this.currentTab,this.currentModel||(this.currentModel=this._viewCollection.getCurrentDataModel(void 0)),!this.currentModel)return;this.isNew=this.currentModel.isNew,this.isNew||(this._checkAccess(),this._isPropertyPanelOpen=!0),this.updateContextFieldReadWrite(),this.initializeEvents();let i=this.currentTab.key;switch(i){case"comments":this._addComments();break;case"relations":this._addRelation();break;case"classification":this._addClassification();break;default:this.currentTab.isCustom?this._addCustomTabContent():this._addDetailsTabContent()}this.currentTabView=this.relatedView[i],this.displayTabBarAndActionButtons(),this.handleTabCustomRender(this.currentTab.key)},isPropertiesTab:function(){return Boolean("properties"===this.currentTab.key&&this.currentTabView&&this.currentModel)},isClassificationTab:function(){return Boolean("classification"===this.currentTab.key&&this.currentTabView&&this.currentModel)},_addDetailsTabContent:function(t){let i,n=!0,o=this.currentTab.key,s=this.currentTab.config,a=t||s;if(this.relatedView[o]||(i=this.getDetailsDisplayDivContent(o),this._addRelatedView(o,i,a),this.addScroller(o,i),this.detailsDisplayBodyContainers[o]=i),a){let t=a.handleCustomFieldConfigs(this.isNew,this.currentModel,this._viewConfig,{DateCustomView:u,MultiValueCustomView:m}),s=e.clone(t.options||{},!1);s.initializeCustomAttributes&&(this.currentTab.config=t),!t.values.length&&s.displayMessageWhenNoAttributeExists?(e.createElement("label",{class:"object-properties-list",html:E.NO_ATTRIBUTE_TO_DISPLAY}).inject(i),n=!1):(this.relatedView[o].setConfig(t),this.relatedView[o].resetModel(this.currentModel))}n&&this.relatedView[o].render()},_addRelatedView:function(e,t,i){this.relatedView[e]=new r(t,this)},_addTrend:function(e,t){this.relatedView[e]=new h(t,{nlsTrend:this._nlsTrend,viewCollection:this._viewCollection,trendConfig:this._trendConfig,trendTemplate:this._trendTemplate,trendChartConfig:this._trendChartConfig,MatrixConfigCollection:this._matrixConfigCollection})},_addRelation:function(){let e=this,t=this.currentTab.key;if(!this.relatedView[t]){let i=this.getDetailsDisplayDivContent(t),n=this._viewConfig.getRelationsFacetInfo();n&&require([n.require],function(n){e.relatedView[t]=new n,e.relatedView[t].updateFacetExternal(e.currentModel.model.getModelForRelations()),e.relatedView[t].elements.container.inject(i),e.addScroller(t,i)}),this.detailsDisplayBodyContainers[t]=i}},_addComments:function(){let e=this.currentTab.key;if(!this.relatedView[e]){let t=this.getDetailsDisplayDivContent(e),i=this.currentModel.get("id"),n=D.get("appId"),o=D.get("tenant"),s=D.get("3DSwym"),a="pid:"+i,r=D.get("3DSpace")+"/resources/",c=["/#app:",n,"/content:id=",i,"&propertyPanelTab=commentsTab&x3dPlatformId=",o].join("");this.relatedView[e]=new l({subjectURI:a,subjectUri:a,tenantId:o,serviceURL:r,serviceUrl:r,enableShare:!1,"3DSwymUrl":s,appForcedLinkUri:c,commentsNumberAtInit:8,commentProxyToken:{header:"X-DS-CSRFTOKEN"}}),this.relatedView[e].inject(t),this.addScroller(e,t),this.detailsDisplayBodyContainers[e]=t}},_addClassification:function(){let e=this,t=this.currentTab.key;if(!this.relatedView[t]){let i=this.getDetailsDisplayDivContent(t);e.relatedView[t]=new c(i,{parentView:this,currentModel:this.currentModel}),this.relatedView[t].render(),this.addScroller(t,i),this.detailsDisplayBodyContainers[t]=i}},_addCustomTabContent:function(){let e=this,t=this.currentTab.key;if(!this.relatedView[t]){let i=this.getDetailsDisplayDivContent(t);e.relatedView[t]=this.getCustomView(i,t),this.relatedView&&this.relatedView[t].render(),this.addScroller(t,i),this.detailsDisplayBodyContainers[t]=i}},getCustomView:Function.prototype,_notifyChanges:function(e){this.modelChanged(e&&e.modificationsPending)},updateStateOfFooterButtons:function(e){let t=this.parentView.dialog&&this.parentView.dialog.getDialogView();t?this.saveButton=t.buttons.Save:this.detailsDisplayFooter&&(this.saveButton=this.detailsDisplayFooter.saveButton),this.saveButton&&(this.saveButton.disabled=e)},destroyDetailsDisplayTabContent:function(){if(this.detailsDisplayBodyContainers)for(let e in this.detailsDisplayBodyContainers)this.relatedView[e]&&(this.relatedView[e].destroy(),delete this.relatedView[e]);this.relatedView={}},isPropertyPanelOpen:function(){return this._isPropertyPanelOpen||this.isCreate&&!this.isRMCContext},save:function(t){let i=this,n=e.clone(t||this.options||{},!1);this.currentModel.saving=!0,this.currentModel.dispatchEvent("disableSaveButton",!0),this.showSpinnerView(this.propertiesContainer,n.progressMessage||E.SAVING);let o=n.isSelect,s=n.onFailure,a=n.onComplete,l=n.resetWidgetData,r=this.getParentView();o=e.is(o,"boolean")?o:this.isPropertyPanelOpen();for(let e in this.relatedView)this.relatedView.hasOwnProperty(e)&&this.relatedView[e].prepareSave&&this.relatedView[e].prepareSave();this._viewCollection.saveDataModel(this.currentModel,{isNew:this.isNew,isSelect:o,inValidRMC:this.inValidRMC,doNotCache:n.doNotCache,ignoreFieldDefinitions:this.ignoreFieldDefinitions,externalService:n.externalService,no3DSpace:n.no3DSpace,ignoreFields:n.ignoreFields,isContextModified:this.isContextModified,donotShowMessage:n.donotShowMessage,tabConfig:this._tabConfig,tabConfigForCreate:this._tabConfigForCreate||this._tabConfig,onComplete:function(){i.currentModel.saving=!1,i.postCreateProcess(this.isNew?S:b,r,{isSelect:o,resetWidgetData:Boolean(l)}),a&&a.apply(this,arguments)}.bind(this),onFailure:function(){i.currentModel.saving=!1,i.currentModel.dispatchEvent("disableSaveButton",!0),i.hideSpinnerView(),!this.isNew&&!this.editModel&&i.handlePostSaveFailure(i.currentModel.model),s&&s.apply(this,arguments)}.bind(this),fields:n.fields,customParams:n.customParams,parentModel:n.parentModel})},handlePostSaveFailure:function(){this.isNew||(this.currentModel.cancel(),this.currentModel.model.set(this.currentModel.model.previousAttributes()),this.currentModel.model.resetChangedAttrs(),this.updateCurrentTabPostSave())},postCreateProcess:function(t,i,n){let o=e.clone(n||{},!1);if(y===t||_===t)i.postCreateProcess&&i.postCreateProcess();else if(S===t&&!o.donotCloseDialog||this.editModel){i.postCreateProcess();let e=i.getDialog();e&&e.close({dontClearAlertMessages:!0})}else this.currentTab&&this.updateCurrentTabPostSave();this.hideSpinnerView(),this._isPropertyPanelOpen=o.isSelect,i.dispatchEvent("updateCommonFacet",o),o.resetWidgetData&&this.reloadWidgetData(i,o)},reloadWidgetData:function(t,i){let n=e.clone(i||{},!1);this.currentModel.cancel(),D.setFilterSearchString(""),t.reload({refresh:!0,showLoadSpinner:!0,valiateInvalidRisksContext:!0,loadingMessage:n.loadMsg||""})},updateCurrentTabPostSave:function(t){e.clone(t||{},!1).doNotUpdateCurrentTab||(this.currentModel.cancel(),this._checkAccess(),this.currentTabView&&this.currentTabView.acceptChanges&&this.currentTabView.acceptChanges(this.currentModel)),this.handleInitialOpenPropertyPanel()},handleDeleteAction:function(t){let i=e.clone(t||{},!1),n=i.treeNodeModel||this.currentModel,o=(n&&n.model).title,s=i.operation===C.DELETE,a=s?E.DELETING:E.REMOVING,l=s?E.DELETE_CONFIRM_MSG:E.REMOVE_CONFIRM_MSG;e.extend(i,{spinnerMsg:a});let r={dontResetModel:!0,title:E.DELETE+' "'+o+'"',message:E.replace(l,{title:o}),yesEventFunc:this.deleteDataObjectModel.bind(this,n,i),noEventFunc:function(){this.hideSpinnerView(),i.callback&&i.callback.apply(this,arguments)}.bind(this),yesLabel:E.YES,noLabel:E.NO};g.confirmDialog(r)},deleteDataObjectModel:function(t,i){let n=e.clone(i||{},!1);p.showProgressSpinner(this.propertiesContainer,n.spinnerMsg||E.DELETING),this._viewCollection.deleteDataModel(t,n).then(this.handleDeleteOnComplete.bind(this),this.hideSpinnerView.bind(this))},handleDeleteOnComplete:function(t){let i=e.clone(t||{},!1),n=i.callback,o=this._viewCollection.getDocument(),s=this.getParentView();o&&o.getSelectedNodes().length&&i.isSelect||this.hideRightPanel(),this.postCreateProcess(y,s),n&&n.apply(this,arguments)},showSpinnerView:function(e,t){p.showProgressSpinner(e||this.propertiesContainer,t)},hideSpinnerView:function(e){p.hideProgressSpinner(e||this.propertiesContainer)},showSaveCancelFooter:function(e){this.detailsDisplayFooter&&this.detailsDisplayFooter.showSaveCancelFooter(e)},destroy:function(){this.destroyDetailsDisplayTabContent&&this.destroyDetailsDisplayTabContent();for(let e in this.detailsDisplayBodyContainers)this.detailsDisplayBodyContainers[e]&&(this.detailsDisplayBodyContainers[e].destroy(),delete this.detailsDisplayBodyContainers[e]);this.actionButton&&this.actionButton.destroy(),this.detailsDisplayFooter&&this.detailsDisplayFooter.destroy(),this.detailsDisplayFooterContainer&&this.detailsDisplayFooterContainer.destroy(),this.detailsContainer&&this.detailsContainer.destroy()},_getTabConfig:function(e){return e.tabConfig&&e.tabConfig.cloneConfig&&e.tabConfig.cloneConfig(!0)||e.tabConfig},getHeight:function(){return this.isNew?(this.height=this.height?this.height:this.parentView.getHeight(),this._calculateHeight()-70):(this.height=this.height?this.height:this.parentView.parentView?this.parentView.parentView.height:this.parentView.height,this._calculateHeight()+10)},_calculateHeight:function(){if(this.detailsDisplayFooterContainer){let e=this.detailsDisplayFooterContainer.clientHeight,t=this.detailsContainer.getElement(".object-properties-toolbar"),i=t&&t.clientHeight||0;return this.height-(i+e)}return this.height},setHeight:function(e){this.height=e;for(let e in this.scrollElements)this.scrollElements.hasOwnProperty(e)&&this.scrollElements[e].setStyle("height",this.getHeight()+"px")},hideRightPanel:function(){this.getParentView().showHideRightPanel(!1),this.reset()},getParentView:function(){let e=this.parentView.getCurrentView?this.parentView:this.parentView.parentView,t=e&&e.getCurrentView?e.getCurrentView():this;return t&&t.parentView},_checkAccess:Function.prototype});return Object.defineProperty(P.prototype,"_isPropertyPanelOpen",{get:function(){return M},set:function(e){M=e}}),P}),define("DS/ENOProjectMgmtCommonComponents/views/CalendarPopup",["UWA/Core","DS/ENOProjectMgmtCommonComponents/components/CommonCalendar","DS/ENOProjectMgmtCommonComponents/components/PopupCommon","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n){"use strict";return e.Class.View.extend({_uwaClassName:"CalendarPopup",init:function(e,t){this.parentView=e,this._options=t,this.model=t&&t.model,this._parent(t)},render:function(){let e=new t(this,this._options);this.dialog=new i({minWidth:600,contentView:e,doNotshowFooterButtons:!0,title:n.PREVIEW+" - "+(this.model?this.model.get("title"):""),height:520}),this.dialog.createDialog();let o=this.dialog.getDialogView().getContent().getElement(".wux-windows-window-maincontent.wux-element-contentbox");o&&o.addClassName("ds-app-calendar-preview-dialog")},getHeight:function(){return this.parentView.getHeight()},destroy:function(){this.dialog&&this.dialog.destroy()}})}),define("DS/ENOProjectMgmtCommonComponents/views/CalendarPopupSharedView",["UWA/Core","DS/Controls/Button","DS/ENOProjectMgmtCommonComponents/views/CalendarPopup","DS/E6WCommonUI/Views/DetailsDisplaySharedView"],function(e,t,i,n){"use strict";return n.extend({_sourceModel:void 0,_calendarModel:void 0,_calendarId:void 0,setup:function(e){this.options=e||{},this._sourceModel=e.model,this.calendarId=e.calendarId,this._parent.apply(this,arguments)},render:function(){let e=this;this.container.empty(!0);let n=this._sourceModel.get("calendar");if(n&&(this._calendarModel=n.at(0)),this._calendarModel){this._calendarId=this._calendarModel.get("id"),this.calendarButton=new t({displayStyle:"icon",icon:"calendar",label:this._calendarModel.get("title")}).inject(this.container);let n={model:this._calendarModel};this.calendarButton.addEventListener("click",function(){this._calendarPopup=new i(e,n),this._calendarPopup.render()})}return this},getHeight:function(){this.options.homeView.getHeight()},destroy:function(){this.calendarButton&&this.calendarButton.destroy(),this._calendarPopup&&this._calendarPopup.destroy(),this._parent.apply(this,arguments)}})}),define("DS/ENOProjectMgmtCommonComponents/components/ChatPromptView",["UWA/Core","UWA/Utils","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtDetailsAndRelationships","DS/ENOProjectMgmtCommonComponents/config/ChatCreateConfig","DS/ENOProjectMgmtCommonComponents/config/ProjectImportConfig","DS/ENOProjectMgmtCommonComponents/collection/ProjectMgmtViewCollection","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtModels/Collections/ENOProjectMgmtBaseCollection","DS/ENOProjectMgmtModels/Models/ChatPromptParser","DS/ENOProjectMgmtModels/Models/Importer","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel","DS/ENOProjectMgmtCommonComponents/config/ViewConfigBase","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Constants/Constants","DS/ENOProjectMgmtModels/Collections/Projects","DS/ENOProjectMgmtModels/Models/Project","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g,p,C){"use strict";let f=d.extend({_uwaClassName:"ChatPromptCloneModel",dataForRendering:function(){let e=this._parent.apply(this,arguments),t=this.get("startDate");return t&&(e.startDate=a.getIntlDateFormat(t)),e},get:function(e){let t=this._parent.apply(this,arguments);if(t)switch(e){case"startDate":t=t&&a.getIntlDateFormat(t.actualValue||t)}return t},validate:function(e){var t=!0,i={fields:[],messages:{}};let n=this._attributesGet(e,"title"),o=this.getDateFieldValue("startDate",e),s=this._attributesGet(e,"duration"),a=this.isValidString(n);return t&&!a&&(t=!1,i.fields.push("title")),t&&!o&&(t=!1,i.fields.push("startDate")),t&&!s&&(t=!1,i.fields.push("startDate")),this.dispatchEvent("disableSaveButton",!t),t?this.dispatchEvent("onValidationSuccess")&&void 0:i}});return i.extend({_uwaClassName:"ChatPromptView",_isPrompt:!0,_parentView:void 0,dataForImport:"",messages:[{role:"assistant",content:"You are a Project Manager with certifications in Project Management Professional(PMP), PMI Risk Management Professional(PMI-RMP),PMBOK and MIL Standards 498. Your task is to build a very industry-specific multi-level project plan using fine-tuned industry-specific data and knowledge. You must return only RFC 8259 Compliant JSON ouput without any additional text."},{role:"user",content:'Create a multi level comprehensive project plan to develope <title> for a duration of <duration> <durationPeriod> with start date as <startDate>. Generate a complete work breakdown structure, a minimum 5 tasks and a minimum 10 sub tasks and in JSON format only.Do not include any explanations, only provide a  RFC 8259 Compliant JSON RESPONSE following this format without deviation. {"name": "Project name","description":"project description", "startdate":"start date", "enddate":"end date","tasks": ["name":"number and task" with start and end dates], "subtasks": ["name":"number and subtask" with start and end date under each task],"Milestones":[ "name" separately with start dates]}. Include as many tokens as possible to define all tasks and subtasks.'},{role:"user",content:'return response in JSON only!!!.check for errors! Response should start with "name" only.'}],objectivesFormat:"Get objectives in an JSON Array format.",fields:{level:"",name:"",type:"",subtype:"",dependencies:"",state:"","%":"",duration:"1D","duration offset":"","fixed start":"","actual start date":"","estimated start date":"","fixed end":"","actual end date":"","estimated end date":"",owner:"",assignees:"",description:"",priority:"",strategy:"","external id":"","external system":""},init:function(t,i){var n=e.clone(i||{},!1);this._parentView=i.parentView,this._subscribeActivity=n.subscribeActivity,n=this.resetInitializationData(n),e.extend(n,{viewCollection:this._viewCollection,parentView:this._parentView,isCreate:!0}),this._parent(t,n)},resetInitializationData:function(t){var i=e.clone(t||{},!1);return this._isPrompt=i.isPrompt,i.DataModels=l,i.DataModel=r,i.DataModel=this._isPrompt?r:c,this._isPrompt?i.CloneModel=f:i.CloneModel=d,i.isComponent&&u.set("isComponent",i.isComponent),this.viewConfig||(this.viewConfig=new h(m.APPLICATIONS.CHAT_PROMPT)),this._setFieldDefinitions(),this._viewCollection=new s(i),this._isPrompt?(i.tabConfig=n,this._viewCollection.fieldDefinitionSource=m.APPLICATIONS.CHAT_PROMPT):(i.tabConfig=o,this._viewCollection.fieldDefinitionSource=m.APPLICATIONS.IMPORTER),this._tabConfig=i.tabConfig,this._viewCollection.ListConfig=i.tabConfig,this._viewCollection.TabConfig=i.tabConfig,this._viewCollection.TabConfigForCreate=i.tabConfig,this._viewCollection.resetCollection(),this.currentModel=this._viewCollection.getNewDataModel(this._tabConfig),this.isNew=this.currentModel.isNew,this._isPrompt?this.currentModel.set("messages",this.messages):this.currentModel.set("title",this.dataForImport),i},render:function(){let e=this._parent({refresh:!0,model:this.currentModel}),t=this.detailsContainer.getElement(".object-properties-list");return t&&t.remove(),e},save:function(i){let n=this;this.isError=!1;let o=e.clone(i||{},!1);if(o.onComplete=function(){let e={};n.isError||!this._isPrompt?this._parentView.postCreateProcess():(e._isPrompt=!1,n.resetInitializationData(e),n.save(e))},o.onFailure=function(e,t){let i={},o=this._isPrompt?"Error from AI Service : ":"Error when importing data to Project Plan";this.displayError(o,t),i.isPrompt=!0,n.resetInitializationData(i),n._resetCurrentModelData(),this.updateStateOfFooterButtons(!1)},o.ignoreFields=["serviceId","tempId"],o.donotShowMessage=!0,this._isPrompt){this._backupCurrentModel=e.clone(this.currentModel,!1),o.externalService=!0,o.no3DSpace=!0,this.currentModel.set("model","meta-llama/Llama-2-13b-chat-hf"),this.currentModel.set("temperature",.5),this.currentModel.set("max_tokens",3600);let t=this.isObjectiveQueried?this.currentModel.get("objectivesFormat"):this.currentModel.get("messages"),i=t[1].content;i=i.replace("<title>",this.currentModel.get("title"));let n=this._viewCollection.convertDate(this.currentModel.get("startDate").actualValue);i=(i=(i=i.replace("<startDate>",n.toLocaleDateString())).replace("<duration>",this.currentModel.get("duration"))).replace("<durationPeriod>",this.currentModel.get("durationPeriod").actualValue||this.currentModel.get("durationPeriod")),t[1].content=i,this.currentModel.set("messages",t),o.progressMessage="Generating detailed Project Plan"}else{let e=t.getUUID(),i={uuid:e,start:!0};this._subscribeActivity("Create Project",i);let n=[];o.no3DSpace=!0,n.push(this.currentModel.get("title")),this.currentModel.set("chunks",n),this.currentModel.set("identifier",e),this.currentModel.set("projectUpdate",!1)}this._parent(o)},_resetCurrentModelData:function(e){this._backupCurrentModel&&this.currentModel.set(this._backupCurrentModel.localAttributes),e||this.render()},postCreateProcess:function(t,i,n){let o=e.clone(n||{},!1);try{if(this._isPrompt){let e=this.currentModel.get("responseInfo");this.dataForImport=this._prepareImportData(e,0,"xProject")}}catch(e){this.displayError("Error when preparing import data from AI",e),this.isError=!0}o.donotCloseDialog=!0,this._parent(t,i,o)},displayError:function(e,t){let i=a.getErrorMessage(void 0,t);i=e+(i.message||i),this._parentView.displayError(a.getErrorMessage(void 0,i))},_prepareImportData:function(e,t,i){let n="",o=new p;if(o.set(this.fields),o.set("level",t),o.set("name",'"'+e.name+'"'),e.description){let t,i=this.currentModel.get("objectives");i&&i.length>0?(t='"<p>'+e.description+"</p>",t+="\n",i.forEach(e=>{t+="<p>"+e.objective+"</p>",t+="\n"}),t+='"'):t='"'+e.description+'"',o.set("description",t)}o.set("type",i);let s=a.getIntlDateFormat(e.startdate),l=this._convertOutputDate(s.actualValue);if(""===l)throw new Error("Mandatory data is missing : Estimated Start Date");if(o.set("estimated start date",l),e.enddate){let t=a.getIntlDateFormat(e.enddate),i=this._convertOutputDate(t.actualValue);if(""===i)throw new Error("Mandatory data is missing : Estimated End Date");o.set("estimated end date",i)}0===t&&(n+=o.keys().toString(),n+="\r"),e.dependencies&&o.set("dependencies",e.dependencies),n+=o.values().toString(),n+="\r";let r=void 0;if(e.tasks||e.Tasks){r=e.tasks||e.Tasks;for(let e=0;e<r.length;e++){let i=0===t?e+1:parseFloat(t.toString()+"."+(e+1).toString());n+=this._prepareImportData(r[e],i,"Task")}}if(e.subtasks||e.subTasks){let i=e.subtasks||e.subTasks;for(let e=0;e<i.length;e++)n+=this._prepareImportData(i[e],parseFloat(t.toString()+"."+(e+1).toString()),"Task")}if(e.milestones||e.Milestones){let t=e.milestones||e.Milestones,i=r?r.length+1:1;for(let e=0;e<t.length;e++)n+=this._prepareImportData(t[e],i+e,"Gate")}return n},_convertOutputDate:function(t){return t&&"Invalid Date"!==t.toString()&&e.Date.strftime(t,"%Y-%m-%dT%T."+t.getMilliseconds())||""},_setFieldDefinitions:function(){if(this._isPrompt){let e={model:{itemType:"field",name:"field"},temperature:{itemType:"field",name:"field"},max_tokens:{itemType:"field",name:"field"},frequency_penalty:{itemType:"field",name:"field"},presence_penalty:{itemType:"field",name:"field"},messages:{itemType:"field",name:"field"},n:{itemType:"field",name:"field"}};this.viewConfig.setFieldDefinitionData(m.APPLICATIONS.CHAT_PROMPT,e)}else{let e={chunks:{itemType:"field",name:"field"},identifier:{itemType:"field",name:"field"},projectUpdate:{itemType:"field",name:"field"}};this.viewConfig.setFieldDefinitionData(m.APPLICATIONS.IMPORTER,e)}},destroy:function(){this._viewCollection&&this._viewCollection.destroy(),this._parent.apply(this,arguments)}})}),define("DS/ENOProjectMgmtCommonComponents/views/ChatPromptPopup",["UWA/Core","DS/ENOProjectMgmtCommonComponents/components/ChatPromptView","DS/ENOProjectMgmtCommonComponents/components/PopupCommon","DS/ENOProjectMgmtCommonComponents/components/CustomAlert"],function(e,t,i,n){"use strict";return e.Class.View.extend({_uwaClassName:"ChatPromptPopup",contentView:void 0,init:function(t,i){let n=e.clone(i||{},!1);this._parentView=t,this._options=n,this._options.parentView=this,this._options.subscribeActivity=this._parentView.subscribeActivity,this._options.isPrompt=!0,this._parent(i)},render:function(){let e=this;this.contentView=new t(this,this._options),this.dialog=new i({minWidth:600,height:500,minHeight:300,saveButtonLabel:"Generate",contentView:this.contentView,title:"Create Project using AI"}),this.dialog.createDialog();let n=this.dialog.getDialogView(),o=this.dialog.getContentView();o&&(o.stopListening(widget,"onResize"),o.listenTo(widget,"onResize",function(){n.setAbsolutePosition({x:n.getAbsolutePosition().x,y:1}),e._adjustHeight(n)}))},_adjustHeight:function(e){widget.body.clientHeight<=500&&(e.height=widget.body.clientHeight)},displayError:function(e){this._parentView.displayError?this._parentView.displayError(e):n.buildNotification({title:"Error",message:e},"error")},displayInfo:function(e){this._parentView.displayInfo(e)},postCreateProcess:function(){this.dialog&&this.dialog.close()},getHeight:function(){return this._parentView.getHeight?this._parentView.getHeight():500},destroy:function(){this.dialog&&this.dialog.close(),this._parent.apply(this,arguments)}})}),define("DS/ENOProjectMgmtCommonComponents/utils/PlatformManager",["UWA/Class/Events","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Utils/DataUtils","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/constants/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l){"use strict";return e.singleton({_serviceData:[],_options:void 0,initializeServiceData:function(){let e=this;return new Promise(function(t,n){e._serviceData.length?t():i.getPlatformServices({onComplete:function(i){e.storePlatformServiceData(i),t()},onFailure:function(e){n(e)}})})},configure:function(e){let i=this;return this._options=e,new Promise(function(e,o){i.initializeServiceData().then(function(){let o,s,a,l,r,c;window.widget?(o=window.widget.getUrl(),s=window.widget.getUrl().match(/[?&]runYourApp=([^&]*)?/),a=t.getApplicationConfiguration("app.urls.myapps"),o=o.substring(0,o.indexOf("/webapps")),l=window.widget.lang,r=widget.id,c=widget.data.appId):(o=window.enoviaServer.storageUrl,r=window.enoviaServer.widgetId,c=window.enoviaServer.viewId),a&&!s||(a=o);let d,h,u=(new Date).getTimezoneOffset(),m=t.getUser();m&&m.login&&(d=m.firstName,h=m.lastName,m=m.login);let g={url:o,language:l,timezone:u,myAppsUrl:a,user:m,firstName:d,lastName:h,isStandaloneWidget:i.isStandaloneWidget(),widgetId:r,appId:c};n.set(g),i.processStorages(i._serviceData),e()},function(e){o(e)})})},processStorages:function(){let e,t=[];if(s.sort(this._serviceData,"displayName"),this._serviceData.forEach(function(i){i[a.SPACE_SOURCE]&&(e||(e=i),t.push({label:i.displayName||i.platformId,value:i.platformId}))}),!this._options.doNotInitializePreference&&window.widget){let e=void 0,i=widget.getValue(a.COLLABSTORAGE);if(i)for(let t of this._serviceData)if(t.platformId===i||t[a.SPACE_SOURCE]===i){e=t.platformId;break}e||(e=widget.data.x3dPlatformId||t[0].value),widget.addPreference({name:a.COLLABSTORAGE,type:"list",disabled:!(t.length>1),defaultValue:e,options:t,label:l["3DEXPERIENCE_PLATFORM"]}),i!==e&&widget.setValue(a.COLLABSTORAGE,e)}this.processStorage(),n.get("3DSpace")||this.processStorageForUndefinedPlatform()},processStorageForUndefinedPlatform:function(){for(let e of this._serviceData)if(e["3DSpace"]){let t=e;n.set(a.TENANT,t.platformId),n.set(t),!this._options.doNotInitializeCollabStorage&&window.widget&&(widget.setValue(a.TENANT,t.platformId),widget.setValue(a.X3D_PLATFORMID,t.platformId));break}},processStorage:function(){let e,t=void 0;t=window.widget?this._options.doNotInitializeCollabStorage?widget.getValue("x3dPlatformId"):widget.getValue(a.COLLABSTORAGE)||widget.getValue(a.TENANT):location.href?o.getURLParameter(location.href,"tenant"):"OnPremise";for(let i of this._serviceData)if(i.platformId===t||i[a.SPACE_SOURCE]===t){e=i;break}if(!e&&!widget.getValue(a.COLLABSTORAGE)&&this._serviceData.length>0&&(e=this._serviceData[0]),!e)return this._options.doNotInitializeCollabStorage||widget.deleteValue(a.TENANT),n.unset(a.TENANT),void n.unset("platformId");!this._options.doNotInitializeCollabStorage&&window.widget&&(widget.setValue(a.TENANT,e.platformId),widget.setValue(a.X3D_PLATFORMID,e.platformId)),n.set(a.TENANT,e.platformId),n.set(e)},isStandaloneWidget:function(){return void 0!==window.widget},storePlatformServiceData:function(e){this._serviceData=e},getTenant:function(){if(this.isStandaloneWidget()){return widget.getValue(a.TENANT)}},isOnPremise:function(){return"OnPremise"===this.getTenant()}})}),define("DS/ENOProjectMgmtCommonComponents/config/MatrixConfigActionButtonConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t){"use strict";let i=e.extend({_uwaClassName:"MatrixConfigActionButtonConfig",type:"actionButtons",columnInfo:{},setup:function(){this.setColumnInfo()},values:[{name:"export",value:"export",text:t.EXPORT,title:t.EXPORT,fonticon:"export"},{name:"delete",value:"delete",text:t.DELETE,title:t.DELETE,fonticon:"trash"}],getItems:function(e,t){if(!e)return;let i,n,o=[],s=UWA.clone(t||{},!1),a=s.isDefault,l=s.isCreateNewSelected;return this.values.forEach(function(t){switch(t.name){case"export":i=l;break;case"delete":i=a||!e.canDelete()}(n=UWA.clone(t||{},!1)).className=i?"disabled":"",o.push(n)}),o}});return i._instance=i._instance||new i,i._instance}),define("DS/ENOProjectMgmtCommonComponents/config/TabMatrixConfigCreate",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/config/MatrixSettingsViewConfig","DS/ENOProjectMgmtCommonComponents/config/MatrixConfigActionButtonConfig"],function(e,t,i){"use strict";let n=e.extend({_uwaClassName:"TabMatrixConfigCreate",columnInfo:{},setup:function(){this.setColumnInfo()},type:"tab",actionButtonConfig:i,hide:!0,values:[{name:"",key:"matrixCreate",selected:!0,fields:"title,name,owner,modifyAccess,deleteAccess,project,projectTitle,configuredItems.title,configuredItems.name,configuredItems.image,configuredItems.typeicon,configuredItems.thumbnail,ownerInfo.title,ownerInfo.name,ownerInfo.image,ownerInfo.firstname,ownerInfo.lastname,ownerInfo.company,rmcType",include:"matrix,configuredItems,ownerInfo",config:t,checkFlag:!0}]});return n._instance=n._instance||new n,n._instance}),define("DS/ENOProjectMgmtCommonComponents/utils/PreferenceManager",["UWA/Core","UWA/Class/Events","DS/ENOProjectMgmtModels/Utils/DataUtils","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Collections/SecurityContexts","DS/ENOProjectMgmtModels/Models/ENOProjectMgmtBaseModel","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/utils/PlatformManager","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/constants/Constants","DS/ENOProjectMgmtModels/Constants/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d,h){"use strict";window.dataVersion=.3;let u={name:c.COLLABSPACE,type:"list",defaultValue:"",options:[{label:"None",value:"None"}],label:h.CREDENTIALS};return t.extend({defaultWindowedHeight:505,homeModule:void 0,homeView:void 0,parentContainer:void 0,init:function(t,i){let n=this,o=e.clone(t||{},!1);if(this.homeModule=i,this.initUtils(),!o.doNotInitializePreference&&window.widget){widget.useUIKitSelect=!0,widget.addEvents({onEdit:this.onPreferencesOpened.bind(this),endEdit:this.onPreferencesClosed.bind(this,o),onViewChange:function(){n.onViewChange()},onRefresh:this.refreshWidget.bind(this,o)});let e=top.document.getElementsByName("viewport");e&&e.length&&e[0].setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"),n._initializePreference(o)}l.configure(o).then(function(){n.homeModule&&n._initializeHomeView(o);const e=[];e.push(n.getConfigurationCenterSettings(o)),e.push(n.setSpace(o)),Promise.all(e).then(function(){o.onComplete&&o.onComplete()},function(){r.buildNotification({message:h["3DEXPERIENCE_PLATFORM_CONFIGURATION_FAILURE"],title:h.ERROR},"error"),o.onFailure&&o.onFailure()})},function(){r.buildNotification({message:h["3DEXPERIENCE_PLATFORM_CONFIGURATION_FAILURE"],title:h.ERROR},"error"),o.onFailure&&o.onFailure()})},initUtils:function(){i.properties.forEach(e=>!a[e]&&(a[e]=i[e]))},refreshWidget:function(){var e=window.parent.document.getElementById("frame-"+widget.id);e&&(e.src=e.src)},_initializeHomeView:function(t){let i=this,n=e.clone(t||{},!1);if(widget.data.X3DContentId){let e=JSON.parse(widget.data.X3DContentId);n.paramData=e.data.items}else widget.data.ids&&(n.paramData=[{objectId:widget.data.ids,serviceId:"3DSpace"}]);this.homeView=new i.homeModule(n),this.homeView.listenTo(widget,"onResize",function(){i.setDimensions()}),i._initPreferencesWithConstants()},getHomeView:function(){return this.homeView},_initializePreference:function(e){e.doNotInitializePreference||(widget.addPreference({name:c.COLLABSTORAGE,type:"list",disabled:!0,options:[{label:"None",value:"None"}],label:h["3DEXPERIENCE_PLATFORM"]}),widget.addPreference(u))},_initPreferencesWithConstants:function(){this.REFRESHTIMEOUT=1e3*parseInt("REFRESH_TIMEOUT",10),widget.dispatchEvent("onResize")},onPreferencesOpened:function(){this._prefsWhenOpened=widget.getPreferences().reduce(function(e,t){return e[t.name]=t.value,e},{})},onPreferencesClosed:function(e,t){t&&t.submitted&&(this.handleModicationPending(e),this._prefOpenedAndClosed=!0)},onViewChange:function(){let e=widget.getView();e.previous&&e.previous.type!==e.type&&this.setDimensions()},setDimensions:function(){let e=widget.getViewportDimensions();n.set(e),n.dispatchEvent("onChange:dimensions")},setSpace:function(t){let i=this,o=e.clone(t||{},!1);return new Promise(function(e){if(o.callback=i.setSpace.bind(i,o),!i.homeView||i.homeView.handleUnsaveForSearchAndPreferences(o))return e();{let t=!1,s=!1;if(i._prefsWhenOpened||o.refresh){for(let e in i._prefsWhenOpened)i._prefsWhenOpened[e]!==widget.getValue(e)&&(e===c.COLLABSTORAGE?(l.processStorage(),t=!0,o.doNotInitializeCollabStorage||(widget.addPreference(u),widget.setValue(c.COLLABSPACE,""),widget.setValue(c.X_PREF_CREDENTIAL,"")),n.unset(c.COLLABSPACE)):(e===c.COLLABSPACE&!o.doNotInitializeCollabStorage&&widget.setValue(c.X_PREF_CREDENTIAL,widget.getValue(e).replace(c.CTX_PREFIX,"")),n.set(e,widget.getValue(e)),s=!0),i.homeView.clearParamData());if(o.refresh&&!s)return o.showRefreshMessage=!0,i.homeView.reload(o),e()}else l.processStorage(),t=!0;if(t)i.getSecurityContexts(o).then(function(t){o.securityContextList=t;let n=i._getDefaultSecurityContext(o);return o.doNotInitializeCollabStorage||(widget.setValue(c.COLLABSPACE,n),widget.setValue(c.X_PREF_CREDENTIAL,n.replace(c.CTX_PREFIX,""))),i.setSecurityContext(n),e()});else if(s)return i.homeView.reload(o),e()}})},setSecurityContext:function(e,t){t&&l.processStorage(),n.set(c.COLLABSPACE,e)},_getDefaultSecurityContext:function(t){let i,o,s=e.clone(t||{},!1),l=s.securityContextList,r=!1;return s.doNotInitializeCollabStorage?n.get(c.COLLABSPACE):(i=(o=widget.getPreference(c.COLLABSPACE)).value,l=l&&l.list,i&&l&&(r=a.findObject(l,"value",i))?i:o.defaultValue)},getSecurityContexts:function(t){let i=this,s=e.clone(t||{},!1),a=new o;return new Promise(function(e,t){a.fetch({onComplete:function(t){let o=t.getSortedPreferences();if(o&&o.list.length){let e=o.defaultValue,t=e.replace(c.CTX_PREFIX,"");s.doNotInitializeCollabStorage?(n.set(c.X_PREF_CREDENTIAL,t),i.setSecurityContext(e)):(widget.setValue(c.X_PREF_CREDENTIAL,t),widget.addPreference({name:c.COLLABSPACE,type:"list",disabled:!1,defaultValue:e,options:o.list,label:h.CREDENTIALS}))}e(o)},onFailure:function(e,i){t(i)}})})},getConfigurationCenterSettings:function(e){let t=this;return new Promise(function(e,i){if(!t.homeView)return e();let o=t.homeView._appConfig&&t.homeView._appConfig.expresssionsSearch;if(!o)return e();{let t=o.join(","),a=new s;a.convertToRequestData=function(e,t,i){return"$ids="+i.idList},a.url=d.getExpresssionSearchUrl(),a.fetch({idList:t,headers:{"Content-Type":d.COMTENT_TYPE_FORM_URL_ENCODED},onComplete:function(t){return o.forEach(e=>{n.set(e,t.get(e))}),e()},onFailure:function(e,t){i(t)}})}})},handleModicationPending:function(t){r.clearNotificationMessages();let i=e.clone(t||{},!1);e.extend(i,{refresh:!0,valiateInvalidRisksContext:!0}),a.validateModificationsPending({parentView:this.homeView,isReload:!0,dontResetModel:!0,yesEventFunc:this.setSpace.bind(this,e.extend({yesEvent:!0},i)),noEventFunc:this.setSpace.bind(this,i)})},destroy:function(){n.clear(),this.homeView&&this.homeView.destroy(),this._parent()}})}),define("DS/ENOProjectMgmtCommonComponents/components/CommonInitializer",["UWA/Core","UWA/Class/Events","UWA/Class/Listener","DS/WidgetLink/WidgetLink","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/Utilities/TouchUtils","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Constants/Constants","DS/ENOProjectMgmtCommonComponents/constants/Constants","DS/ENOProjectMgmtCommonComponents/config/ViewConfigBase","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/utils/PreferenceManager","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/collection/ClassificationCollection","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m){"use strict";let g={summary:"summaryView",risk:"gridView"};return t.extend({_preferenceManager:void 0,_homeView:void 0,_widgetLink:void 0,init:function(t){let i=e.clone(t||{},!1),n=i.isComponent;i.container||(i.container=document.querySelector("#container")),this._homeView=i.homeView,a.set("isComponent",n),a.set("useExternalNotification",i.useExternalNotification||n),a.set("doNotInitializeTaggerProxy",i.doNotInitializeTaggerProxy||n),i.doNotInitializeCollabStorage=i.doNotInitializeCollabStorage||n,i.doNotInitializePreference=i.doNotInitializePreference||n,this._initializePlatformServices(i)},_initializePlatformServices:function(t){let i=this,n=e.clone(t||{},!1);if(n.onComplete||(n.onComplete=function(){let e=i.getHomeView();e&&(e.render(n),i.initializeEvents(n))}),n.onFailure||(n.onFailure=Function.prototype),window.widget)if(n.isComponent)if(n.loadLinks)this.initializeComponent(n),d.loadLinksView(n);else{this.viewConfig=new c(l.APPLICATIONS.TASK);let e={classes:{isFieldGroup:!1,itemType:"service",items:[],name:"classes"},isLibraryInstalled:{label:n.isLibraryInstalled?"TRUE":"FALSE"}};this.viewConfig.setFieldDefinitionData(l.APPLICATIONS.TASK,e),this.initializeComponent(n),this.initializeEvents(n)}else{let e={onLoad:function(){i._preferenceManager=new h(n,i._homeView)}};widget.addEvent("onLoad",e.onLoad),o.getPlatformServices({onComplete:function(e){var t=e[0];widget.setIcon(t["3DSpace"]+"/widget/images/MyApps/iconENOVIA.png")}}),window.addEventListener("dragover",function(e){(e=e||event).preventDefault()},!1),window.addEventListener("drop",function(e){(e=e||event).preventDefault()},!1),s.setTouchMode(!0)}else this.initializeComponent(n),this.initializeEvents(n)},initializeComponent:function(e){this._options={};let t=this.viewConfig&&this.viewConfig.isLibraryInstalled()&&e.loadClassification;if(this._preferenceManager)e.securityContext&&(this._preferenceManager.setSecurityContext(e.securityContext,!0),t&&m.reloadClassifications(e));else{if(t){let t=e.onComplete,i=e.onFailure;e.onComplete=function(){e.securityContext&&e.loadClassification&&(e.onComplete=t,e.onFailure=i,m.loadClassifications(e))},e.onFailure=function(){i()}}this._preferenceManager=new h(e,this._homeView),e.securityContext&&this._preferenceManager.setSecurityContext(e.securityContext)}},handleWidgetLinkEvents:function(e){this._widgetLink=n.get(widget);let t=e.getAppConfig().widgetLinkOptions,i=e.getAppConfig().subscribeToContextChange;t&&this._widgetLink&&this._widgetLink.setLinkability(t),i&&e&&(this._widgetLink.subscribe(r.CONTEXT_CHANGE,t=>{if(t.success){let i=t.dropData.data.items[0];e._handleAddContexScope(t.dropData.id,{dropObj:i,parentView:e,config:e.contextView&&e.contextView._config&&e.contextView._config.at(0)})}else u.buildNotification({message:t.message,hideDelay:3500},"error")}),this._widgetLink.subscribe(r.CONTEXT_REMOVE,t=>{if(t.success){e.contextScope.handleRemoveContext("context",{homeView:e,config:e.contextView._config})}}))},initializeEvents:function(t){let n=this,o={},s=this.getHomeView();this.listener=new i;let a=e.clone(t||{},!1);s?(this.handleWidgetLinkEvents(s),a.isComponent?e.extend(o,{switchToRisksTab:function(){n.dispatchEvent("switchToRisksTab")},xppClosePropertyPanel:function(){n.dispatchEvent("xppClosePropertyPanel")}}):e.extend(o,{openProjectEvent:function(e){n._widgetLink&&n._widgetLink.publish(r.CONTEXT_CHANGE,e)},deleteProjectAndRemoveContextEvent:function(e){n._widgetLink&&n._widgetLink.publish(r.CONTEXT_REMOVE,e)}})):(s=this,e.extend(o,{onWidgetRefresh:function(){n._options.resetWidgetData=!0,n.getHomeView().container.click()},onResize:function(){let e=n.getHomeView(),t=n.getGridView(),i=t&&t.gridViewContent;e&&i&&i.setStyle("height",e.getHeight()+"px")},rskClosePropertyPanel:function(){let e=n.getGridView();e&&e.detailsAndRelationships&&e.detailsAndRelationships.hideRightPanel()}})),this.listener.listenTo(s,o)},renderView:function(t){let i=this.getHomeView();if(!i)return;let n=e.clone(t||{},!1);e.extend(n,this._options),i.isCurrentContext(n.context)?(i.setOptions(n),i._processTabContentRenderView(n)):i.render(n),this._options&&delete this._options.resetWidgetData},getHomeView:function(){return this._preferenceManager&&this._preferenceManager.getHomeView()},getHomeBodyView:function(){let e=this.getHomeView();return e&&e.homeBodyView},getSelectedFacetViewName:function(){let e=widget.getValue("selectedProgramAndFilter"),t=e&&e.substr(1,e.length-2).split("/")[2];return g[t]},getGridView:function(){let e=this.getHomeView();return e&&e.getView("gridView")},getSummaryView:function(){let e=this.getHomeView();return e&&e.getView("summaryView")},isRiskGridViewLoaded:function(){return Boolean(this.getGridView())},isRiskHeatMapViewLoaded:function(){return Boolean(this.getSummaryView())}})}),define("DS/ENOProjectMgmtCommonComponents/views/MatrixConfigDetailsAndRelationships",["UWA/Core","DS/Controls/ComboBox","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/config/TabMatrixConfigCreate","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtDetailsAndRelationships","DS/ENOProjectMgmtModels/Models/AppSettings","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l){"use strict";return s.extend({_uwaClassName:"MatrixConfigDetailsAndRelationships",init:function(t,i){var n=e.clone(i||{},!1);this.isRMCContext=i&&i.isRMCContext,this.contextMatrixConfiguration=n.contextMatrixConfiguration,this._matrixConfigurationCollection=n.matrixConfigCollection,e.extend(n,{hideTab:!0,tabConfig:o,viewCollection:this._matrixConfigurationCollection}),this._parent(t,n)},clearRightPanelContent:function(){!this.isRMCContext&&this._parent.apply(this,arguments)},render:function(){if(this.treeDocument=this._matrixConfigurationCollection.getDocument(),this.propertiesList=this.detailsContainer.getElement(".object-properties-list"),this.labelContainer=e.createElement("div"),this.labelContainer.inject(this.propertiesList),this.selectLabel=e.createElement("label",{id:"selectLabel",text:l.SELECT_EXISTING_CONFIGURATION}),this.selectLabel.inject(this.labelContainer),this.comboBoxContainer=e.createElement("div"),this.comboBoxContainer.inject(this.propertiesList),this.comboBox=new t({elementsTree:this.treeDocument}),this.comboBox.selectedIndex=0,this.comboBox.inject(this.comboBoxContainer),this.comboBox.addEventListener("change",this.handleChangeMatrixConfigurations.bind(this)),this._matrixConfigurationCollection.getDataModelsCount()<=0)this.isCreate=!0;else{this.contextMatrixConfiguration&&this.treeDocument.selectNodeById(this.contextMatrixConfiguration),this._matrixConfigurationCollection.getCurrentDataModel().model.unset("configuredItems")}return this._parent({refresh:!0})},_enableDisableButtons:function(e){let t=this.relatedView[this.currentTab.key].getFieldViewByName("importFile"),i=t&&t.fileUploader;i&&(i.disabled=e)},beforeClose:function(){this.resetWidgetData&&this.reloadWidgetData(this.parentView,{loadMsg:l.MATRIX_CONFIG_LOADING})},_addDetailsTabContent:function(e){let t=this._canCreate(),n=this.currentModel.model.isNew(),o=this.currentModel.model.canModify(),s=a.get("isComponent");if(!t&&!n&&!o||s){(e=this.currentTab.config.cloneConfig(!0)).values.splice(0,1),delete e.columnInfo.import;let t=i.findIndex(e.values,"name","configuredItems");t>=0&&(e.values[t].readWrite=o)}this._parent(e,!0),this.isCreate?(this.comboBox.selectedIndex=-1,this._enableDisableButtons(!1)):this._enableDisableButtons(!o)},postCreateProcess:function(e,t,i){this.isCreate&&(this.isCreate=!1,this.comboBox.selectedIndex=0),this.resetWidgetData=!0,3===e&&(this.comboBox.selectedIndex=-1,this.comboBox.selectedIndex=0),this._parent(0,this.parentView,i)},handlePostSaveFailure:function(){let e=this;this.currentModel.model.unset("configuredItems"),this._matrixConfigurationCollection.getDataModelDetails({refresh:!0}).then(function(t){e.currentModel=t})},_canCreate:function(){return Boolean(this.parentView._viewConfig.matrixConfigCreateAccess())},handleActionButtonEvents:function(e,t){if(this._parent.apply(this,arguments),"export"===t.name){this.currentModel.cancel();let e=JSON.stringify({title:this.currentModel.title,name:this.currentModel.get("name"),matrix:this.currentModel.get("matrix")});i.downloadFile(e,e.title+".json")}},handleChangeMatrixConfigurations:function(){let e=this;if(this.comboBox.selectedIndex>=0){this.showSpinnerView(this.propertiesContainer,l.FETCHING),this.isCreate=!1,this.currentModel&&this.currentModel.cancel(),this._matrixConfigurationCollection.getDataModelDetails({refresh:!0}).then(function(t){e.currentModel=t,e.showDetailsDisplay(),e.currentModel.dispatchEvent("disableSaveButton",!0),e.hideSpinnerView()})}},createActionsDropdownMenu:function(t){let i=e.clone(t||{},!1);e.extend(i,{isDefault:this.currentModel.isDefault(),isCreateNewSelected:-1===this.comboBox.selectedIndex}),this._parent(i)},updateStateOfFooterButtons:function(){this._parent.apply(this,arguments),this.saveButton&&(this.saveButton.label=this.isNew&&!this.isMassUpdate?l.CREATE_BUTTON_LABEL:l.SAVE)},handleTabCustomRender:function(e){if("import"===e){let t=this.currentModel.get(e);if(this.isCreate="new"===t,this.propertiesList.toggleClassName("hide",this.isCreate),this.isCreate)this.comboBox.selectedIndex=-1,this.createData(this._tabConfig.values[0].config,{attributes:this.currentModel.localAttributes});else{let e=this._matrixConfigurationCollection.validateAndGetFirstSelectionNodeModel();e&&(e=e.options.data,this.relatedView[this.currentTab.key].resetModel(e),this.currentModel.dispatchEvent("disableSaveButton",!0))}}},destroy:function(){delete this.saveButton,this.selectLabel.destroy(),this.labelContainer.destroy(),this._viewCollection.resetTreeDocument(),this.comboBox.removeEventListener("change"),this.comboBox.destroy(),this.comboBoxContainer.destroy(),this.propertiesList.destroy(),this._parent()}})}),define("DS/ENOProjectMgmtCommonComponents/config/LinkViewConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t){"use strict";let i=e.extend({_uwaClassName:"LinkViewConfig",columnInfo:{},hide:!0,setup:function(){this.setColumnInfo()},type:"basic",values:[{label:t.TITLE,name:"title",type:"text",readWrite:!0,required:!0,removeCarriageReturns:!0,maxLength:128,validate:!0},{label:"URL",name:"linkURL",type:"textarea",readWrite:!0,required:!0,numberOfDisplayLines:2,numberOfEditableLines:2,maxLength:2048,validate:!0,removeCarriageReturns:!0,customValidate:"isvalidURL"},{name:"description"}]});return i._instance=i._instance||new i,i._instance}),define("DS/ENOProjectMgmtCommonComponents/collection/MatrixConfigCollection",["UWA/Core","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/constants/Constants","DS/ENOProjectMgmtCommonComponents/utils/MatrixConfigCloneModel","DS/ENOProjectMgmtCommonComponents/config/TabMatrixConfigCreate","DS/ENOProjectMgmtCommonComponents/config/MatrixConfigListConfig","DS/ENOProjectMgmtCommonComponents/config/MatrixSettingsViewConfig","DS/ENOProjectMgmtCommonComponents/collection/ProjectMgmtViewCollection","DS/ENOProjectMgmtModels/Constants/Constants","DS/ENOProjectMgmtModels/Models/MatrixConfiguration","DS/ENOProjectMgmtModels/Collections/MatrixConfigurations","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d,h){"use strict";return l.extend({_uwaClassName:"MatrixConfigCollection",_defaultConfiguration:void 0,setup:function(){let e={};e.DataModels=d,e.DataModel=c,e.PropertiesConfig=a,e.TabConfig=o,e.TabConfigForCreate=o,e.ListConfig=s,e.CloneModel=n,e.governingType=r.TYPENAMES.MATRIX_CONFIGURATION,e.governingTypeNLS=h.MATRIX_CONFIGURATION,this._parent(e)},getMatrixConfigDefinition:function(t){if(this.collection)return t instanceof e.Class.Model?t=t._attributes:e.is(t,"string")&&(t={id:t}),this.collection.get(t.id)},getMatrixConfigById:function(e){return e&&this.getMatrixConfigDefinition(e)},getDefaultConfiguration:function(){return!this._defaultConfiguration&&this.collection&&(this._defaultConfiguration=t.findObject(this.collection,"name",i.DEFAULT),this._defaultConfiguration||(this._defaultConfiguration=t.findObject(this.collection,"name",i.DEFAULT_OPPORTUNITY))),this._defaultConfiguration},validateAndGetFirstSelectionNodeModel:function(){let e=this.treeDocument.getSelectedNode();if(e||(this.selectDataModel(0),e=this.treeDocument.getSelectedNode()),e&&0===e._getRowID())return e}})}),define("DS/ENOProjectMgmtCommonComponents/config/LinkTabConfig",["DS/ENOProjectMgmtCommonComponents/config/ConfigBase","DS/ENOProjectMgmtCommonComponents/config/LinkViewConfig","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i){"use strict";let n=e.extend({_uwaClassName:"LinkTabConfig",columnInfo:{},setup:function(){this.setColumnInfo()},type:"tab",hide:!0,values:[{name:i.PROPERTIES,key:"properties",selected:!0,config:t,checkFlag:!0}]});return n._instance=n._instance||new n,n._instance}),define("DS/ENOProjectMgmtCommonComponents/views/HomeViewBase",["UWA/Core","UWA/Class/View","DS/ENOProjectMgmtCommonComponents/views/MassUpdateView","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/collection/MatrixConfigCollection","DS/ENOProjectMgmtCommonComponents/collection/ClassificationCollection","DS/ENOProjectMgmtModels/Models/BaseContext","DS/ENOProjectMgmtModels/Models/AppSettings","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a,l,r){"use strict";return t.extend({_uwaClassName:"HomeViewBase",init:function(t){let r=e.clone(t||{},!1);this._nls=r.nls,this.appName=r.appName,this._rmcType=r.rmcType,this.container=r.container,this._appConfig=r.appConfig,this._paramData=r.paramData,this._viewCollection=r.viewCollection,this._viewConfig=r.viewConfig,this._initialCall=r.initialCall,this._trendConfig=r.trendConfig,this._homeTabConfig=r.homeTabConfig,this._trendTemplate=r.trendTemplate,this.baseContextModel=r.baseContextModel||a,this._trendChartConfig=r.trendChartConfig,this._contextSourceInfo=r.contextSourceInfo,this._tabConfigForCreate=r.tabConfigForCreate,this._tabConfigForMassUpdate=r.tabConfigForMassUpdate,this._contextSelectionConfig=r.contextSelectionConfig,this._detailsAndRelationships=r.detailsAndRelationships,this._leftPanelContent=r.leftPanelContent,this._rightPanelContent=r.rightPanelContent,this.dpmToolbar=r.dpmToolbar,this.homeBodyView={},this.isComponent=l.get("isComponent"),this._matrixConfigCollection=r.matrixConfigCollection||new o,this._classificationCollection=s,this._homeTabConfig&&this._homeTabConfig.getObjectSearchSource(),window.widget&&(widget.projectMgmtAlertManager=n.init()),this._setExteranlDetailsPanelContainer(r),r.doNotLoadMassUpdateView||this.massUpdateView||(this.massUpdateView=new i(this))},_setExteranlDetailsPanelContainer:function(e){e.detailsPanelContainer&&(this._externalRightPanelOptions={detailsPanelContainer:e.detailsPanelContainer,openDetailsPanel:e.openDetailsPanel,closeDetailsPanel:e.closeDetailsPanel})},render:function(){if(this.isComponent&&!l.isValidCollabspace())return this.selectLabel.setContent(r.UNSUPPORTED_CREDENTIAL),!1;this.loadData()},getView:function(e){return this.homeBodyView[e]},reload:function(e){this.render(e)},loadData:Function.prototype,getHeight:Function.prototype,clearParamData:Function.prototype,handleUnsaveForSearchAndPreferences:Function.prototype})}),define("DS/ENOProjectMgmtCommonComponents/views/HomeViewTabBase",["UWA/Core","DS/Controls/Tab","DS/Controls/Button","DS/Controls/TooltipModel","DS/UIKIT/DropdownMenu","DS/E6WCommonUI/Views/DetailsDisplayView","DS/DocumentManagement/DocumentManagement","DS/ENOProjectMgmtModels/Models/FieldsDefinition","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/views/HomeViewBase","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","text!DS/ENOProjectMgmtCommonComponents/assets/templates/app-skeleton-template.html.handlebars","text!DS/ENOProjectMgmtCommonComponents/assets/templates/tmpl-risk-toolbar.html.handlebars","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Constants/Constants","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g,p){"use strict";let C={group1:".ds-app-toolbar-group.ds-navigation",group2:".ds-app-toolbar-group.ds-contextual-actions",group3:".ds-app-toolbar-group.ds-filtering",group4:".ds-app-toolbar-group.ds-panel-actions"};return c.extend({_uwaClassName:"HomeViewTabBase",_toolbarButtons:{},_customObjects:{},reset:function(){this.ddTabBar&&(this.ddTabBar.getContent().empty(),this.ddTabBar.destroy(),delete this.ddTabBar)},initializeContainers:function(t){let i=e.clone(t||{},!1);if(i.actionToolbarContainer)this.actionToolbarContainer=i.actionToolbarContainer,this.actionToolbarContainer.empty(),this.homeToolbarContent=this.actionToolbarContainer;else if(!this.isComponent){if(this._leftPanelContent)this._myPanelMainContent=i.container;else{this.container=this.container.setHTML(h);let e=this.container.getElement(".ds-app-skeleton-navigationbar");e.hide();let t=this.container.getElement(".ds-app-skeleton-statusbar");e.hide(),t.hide(),this._myPanelMainContent=this.container.getElement(".ds-app-skeleton-main-content"),this._leftPanelContent=this.container.getElement(".ds-app-skeleton-panel.ds-app-panel-left"),this._rightPanelContent=this.container.getElement(".ds-app-skeleton-panel.ds-app-panel-right");let n=this._getPanelWidth(!1),o="400px";this._createStyleElement(n,o,i)}"right"!=i.panel&&this._homeTabConfig&&this._homeTabConfig.leftPanel?(this._leftPanelContent.addClassName("ds-app-panel-open"),this.homeToolbarContent=this.container.getElement(".ds-app-panel-head")):this.homeToolbarContent=this._myPanelMainContent.getElement(".ds-app-facet-toolbar")}!this.dpmToolbar&&this.homeToolbarContent&&(this.dpmToolbar=this.homeToolbarContent.getElement(".ds-app-toolbar-container"),this.dpmToolbar||(this.homeToolbarContent.setHTML(u),this.dpmToolbar=this.homeToolbarContent.getElement(".ds-app-toolbar-container"))),this.dpmToolbar&&this._addTabBar(i)},getRightPanelContainer:function(){return this._externalRightPanelOptions&&this._externalRightPanelOptions.detailsPanelContainer||this._rightPanelContent},_getPanelWidth:function(e){let t=m.get("width");return e?t-400:t},_getRightPanelWidth:function(e){return m.get("width")-e},_getContainerStyleHtml:function(e,t,i){let n=e+"px";return".ds-app-layouts-skeleton { --enoAppLeftPaneWidth: "+n+";--enoAppLeftPanePosition: "+(i?0:n)+";--enoAppContentPaneWidth: "+n+";--enoAppContentPanePosition: "+(i?n:0)+";--enoAppRightPaneWidth: 400px;--enoAppRightPanePosition: -"+(t+"px")+";}"},_createStyleElement:function(t,i,n){(n.styleElement||e.createElement("style",{id:"commonStyleDimensionsContainer",html:this._getContainerStyleHtml(t,i,!n||!n.isContentPanel)})).inject(this.container||n.container)},_setWidthPropertiesForContainerStyle:function(e,t){let i=this.container.getElement("#commonStyleDimensionsContainer");if(i){let n=this._getPanelWidth(t);i.setHTML(this._getContainerStyleHtml(n,this._getRightPanelWidth(n),e))}this.setHeight()},checkCreateAccess:function(e){return Boolean(e&&(e.isProgramContext()||!e.canCreate()))},showHideRightPanel:function(e,t){this._externalRightPanelOptions?e?this._externalRightPanelOptions.openDetailsPanel():this._externalRightPanelOptions.closeDetailsPanel():this._rightPanelContent&&this._rightPanelContent.toggleClassName("ds-app-panel-open",e),this._setWidthPropertiesForContainerStyle(!t,e)},showHideLeftPanel:function(e,t){if(this._leftPanelContent.toggleClassName("ds-app-panel-open",e),e){if(this.showHideRightPanel(!1),this._homeTabConfig.leftPanel.navigatoFacetOnSelection){this.contextScope.removeContext({config:this._contextSelectionConfig.columnInfo.context});let e=this._homeTabConfig.leftPanel.defaultTab;this.homeBodyView[e]?m.setSelectedViewName(e):this._loadDataModels()}}else t&&t.doNotReload||this.handleCenterPanelView(t);this._setWidthPropertiesForContainerStyle(e,!1)},setDimensions:function(){if(this._rightPanelContent){let e=this._leftPanelContent.hasClassName("ds-app-panel-open"),t=this._rightPanelContent.hasClassName("ds-app-panel-open");this._setWidthPropertiesForContainerStyle(e,t)}else this.setHeight()},getHeight:function(){this.homeToolbarContainer=this.container.getElement(".ds-app-toolbar-container");let e=this.homeToolbarContainer&&this.homeToolbarContainer.clientHeight;if(this.isComponent){return this.container.offsetHeight-e}return e?this.height-e:this.height},setHeight:function(e,t){let i=this;this.height=e||m.get("height"),(t=t||this._homeTabConfig.leftPanel||this._homeTabConfig.mainPanel).toolbarConfig.group1.forEach(function(e){i.homeBodyView[e.name]&&i.homeBodyView[e.name].setHeight&&i.homeBodyView[e.name].setHeight(i.getHeight())});let n=i.commonFacetView&&i.commonFacetView.homeBodyView;if(n){let e=Object.keys(n);e.length&&e.forEach(e=>{n[e].setHeight(i.getHeight())})}},setWidgetOptions:function(e){let t=e.defaultTab,i=e.defaultTabFilter,n=e.defaultTabSubFilter;if(m.getSelectedViewName()){if(i){!m.getSelectedFilterOption()&&m.setSelectedFilterOption(i)}if(n){!m.getSelectedSubFilterOption()&&m.setSelectedSubFilterOption(n)}}else m.setSelectedViewName(t),i&&m.setSelectedFilterOption(i),n&&m.setSelectedSubFilterOption(n)},hasParamDataExists:function(){return this._paramData&&this._paramData.length},_addTabBar:function(i){let n=e.clone(i||{},!1),o=n.facetConfig||this._homeTabConfig.getPanelViewConfig();this.hasParamDataExists()?m.setSelectedViewName(o.defaultParamDataTab):o.alwaysLoadDefault&&(m.setAlwaysLoadDefault(!0),m.setSelectedViewName(o.defaultTab)),this.setWidgetOptions(o);let s=o.toolbarConfig.group1;this.dpmToolbar||(this.dpmToolbar=this.homeToolbarContent.getElement(".ds-app-toolbar-container"));let a=this.dpmToolbar.getElement(C.group1);n.doNotRenderTabs||a&&a.empty();for(let e=0;e<s.length;e++){let i=s[e],o=this.getToolbarDivContent(i),l=i.doNotCreate;if(i.doNotCreateCheck&&(l=this[i.doNotCreateCheck]()),("tab"===i.type||"facet"===i.type)&&!l&&!1!==i.visible){if(this.ddTabBar)this.createTab(this.ddTabBar,i);else{this.ddTabBar=new t({id:"prjmgmtCommonToolbarTab",displayStyle:"strip",showComboBoxFlag:!1}),n.doNotRenderTabs||(this.ddTabBar.inject(o),o.inject(a)),this.createTab(this.ddTabBar,i);let e=this.handleTabClickEvents.bind(this,{parentView:this,_config:s});i.validateModificationsPending?this.ddTabBar.addEventListener("tabButtonClick",r.validateModificationsPending.bind(this,{parentView:this,yesEventFunc:e,noEventFunc:function(e){let t=e.dsModel.buttonGroup;t&&t.selectIndex(t.previouslySelectedIndex)}})):this.ddTabBar.addEventListener("tabButtonClick",e)}a.toggleClassName("hide",1===this.ddTabBar.tabBar.getTabCount())}}},_addToolbarContentForTab:function(t){if(!this.homeToolbarContent)return;let i=e.clone(t||{},!1),n=void 0,o=i.config.toolbarConfig;this.dpmToolbar||(this.dpmToolbar=this.homeToolbarContent.getElement(".ds-app-toolbar-container")),this._resetToolbar();for(let e in o){if(!o.hasOwnProperty(e))continue;let t=o[e],s=this.dpmToolbar.getElement(C[e]),a=void 0;if("group3"===e){r.findObject(t,"type","cardView")&&!this.isComponent&&this.dpmToolbar.addClassName("include-filtering-input"),r.findObject(t,"domId","filterNewButton")&&this.dpmToolbar.addClassName("include-filtering")}for(let e=0;e<t.length;e++){let o=t[e];o.groupInContextActionToolbar?(n||(n=this.getToolbarDivContent(o,"contextualActionsContainer",!0)),a=n):a=this.getToolbarDivContent(o),"cardView"!==o.type||this.isComponent||!1===o.visible?"button"===o.type&&!1!==o.visible&&a&&(this.addButton(a,o,i.contentInstance),a.inject(s)):a&&!i.doNotRenderTabs&&(a.addClassName("ds-input-element"),this.addContextSelection(a),a.inject(s))}}},getContext:function(){return m.get("context")},handleTabClickEvents:function(t,i){let n,o=e.clone(t||{},!1),s=i.options,a=i.dsModel,l=a.value;a.buttonGroup&&(a.buttonGroup.previouslySelectedIndex=l[0]);let r=o._config.length?o._config.length>1?o._config[l]:o._config[0]:o._config;if(r.referenceConfig){let t=r.referenceConfig;e.merge(r,t)}s&&s.facetConfig&&(r.type=s.facetConfig.type,r.bodyContainer=s.facetConfig.bodyContainer),o.context=this.getContext(r);let c=r.name;if(m.setSelectedViewName(c),this.currentViewName=c,this.setWidgetOptions(r),n=this.homeBodyView[c],this.isComponent){if(this.homeBodyContent=o.container||o.parentView&&o.parentView.container,!this.homeBodyContent)return}else this._homeTabConfig&&this._homeTabConfig.leftPanel?this.homeBodyContent=this.container.getElement(".ds-app-panel-body"):this.homeBodyContent=this._myPanelMainContent.getElement(".ds-app-content.ds-app-facet");n?n&&r.options&&(e.merge(o,r.options),"all"===o.loadOption?(o.onComplete=this._postContentInit.bind(this,this.homeBodyView[c],r,c,!0,o),o.onFailure=this._onContentInitFailure.bind(this,o),this.homeBodyView[c].loadDataModels(o)):this._postContentInit(n,r,c,r.alwaysRender,o)):(r.options&&(r.options.viewConfig=this._viewConfig,("CommonFacetView"!==this._uwaClassName||r.options.useMatrixCollection)&&(r.options.matrixConfigCollection=this._matrixConfigCollection)),e.merge(o,r.options),o.container=this.container,o.leftPanelContent=this._leftPanelContent,o.rightPanelContent=this._rightPanelContent,o.detailsPanelContainer&&!this._externalRightPanelOptions&&this._setExteranlDetailsPanelContainer(o),this.homeBodyView[c]=new r.content(o),o.loadOption?(o.onComplete=this._postContentInit.bind(this,this.homeBodyView[c],r,c,!0,o),o.onFailure=this._onContentInitFailure.bind(this,o),this.homeBodyView[c].loadDataModels(o)):this._postContentInit(this.homeBodyView[c],r,c,!0,o)),this.homeBodyView[c]&&(this.homeBodyView[c].tabBarConfig=r)},_postContentInit:function(e,t,i,n,o){if(n){t.alwaysRender&&this.homeBodyContent.empty();let e=this.homeBodyView[i].render(o);"tab"===t.type&&o.doNotRenderTabs?e&&e.inject(this._appContainer):e&&e.inject(this.homeBodyContent)}this.dpmToolbar&&t.className?(this.lastAddedClassName&&this.dpmToolbar.removeClassName(this.lastAddedClassName),this.dpmToolbar.addClassName(t.className),this.lastAddedClassName=t.className):o.actionToolbarContainer&&(this.actionToolbarContainer=o.actionToolbarContainer,this.actionToolbarContainer.empty(),this.homeToolbarContent=this.actionToolbarContainer,this.dpmToolbar=this.homeToolbarContent.getElement(".ds-app-toolbar-container"),this.dpmToolbar||(this.homeToolbarContent.setHTML(u),this.dpmToolbar=this.homeToolbarContent.getElement(".ds-app-toolbar-container"))),"tab"===t.type?this._addToolbarContentForTab({doNotRenderTabs:o.doNotRenderTabs,config:t,contentInstance:this.homeBodyView&&this.homeBodyView[i]}):this.homeBodyView[i]._addToolbarContentForTab?this.homeBodyView[i]._addToolbarContentForTab({doNotRenderTabs:!0,config:t}):this._addToolbarContentForTab({config:t,contentInstance:this.homeBodyView&&this.homeBodyView[i]}),this.updateStateOfActionsButtons(o.context||e.baseContext,t),this._showHideTabContent(e,i,o);let s=Boolean(e.detailsAndRelationships&&e.detailsAndRelationships.isPropertyPanelOpen());this.showHideRightPanel(s),this.setTitle(o)},_onContentInitFailure:function(e){d.buildNotification({message:"Error Occured",title:e},"error")},_showHideTabContent:function(e,t,i){let n,o=m.get("invalidRiskFilterisOn");for(let s in this.homeBodyView)if(this.homeBodyView.hasOwnProperty(s)){if(e=this.homeBodyView[s],t===s&&(n=this.homeBodyView[s],!o))continue;if(e)if(t!==s)!this.isComponent&&e.hide(i.viewName);else if(o)switch(o){case"set":m.set("invalidRiskFilterisOn","beforeFilter"),this.filterRisksBasedOnSearch("FALSE","validConfiguration",!0);break;case"beforeFilter":m.set("invalidRiskFilterisOn","fired"),e.show(i.viewName),e.loadData(i);break;case"fired":m.unset("invalidRiskFilterisOn"),this.filterRisksBasedOnSearch()}}n&&(n.show(i.viewName),n.loadData(i))},onCreateDropdownMenuSelection:function(e,t){if(t.config){let e=this._tabConfigForCreate.columnInfo[t.name];e&&(e.config=t.config,this._tabConfigForCreate.values=[e])}else t.customView&&this._createCustomView(this,t.customViewKey,t,!0)},addViewByFilter:function(e,t,i){this.clearParamData(),-1!==t.className.indexOf("view-by-menu")&&m.setSelectedFilterOption(t.name),-1!==t.className.indexOf("filter-menu")&&m.setSelectedSubFilterOption(t.name);let n=this.getViewCollection();n&&n.resetCollection(),this.reload({showLoadSpinner:!0,ignoreFetchDataForView:!0})},clearParamData:function(){delete this._paramData},setSelectView:function(e){let t=m.getSelectedFilterOption(),i=m.getSelectedSubFilterOption();if(e.forEach(function(e){let n="fonticon";t!==e.value&&i!==e.value||(n+=" fonticon-check"),e.fonticon=n}),!t){r.findObject(e,"name",g.ALL_ITEMS).fonticon+=" fonticon-check"}return e},getToolbarDivContent:function(t,i,n){let o="ds-app-toolbar";return new e.createElement("div",{id:i||("tab"===t.type?"projectMgmtTabbarContainer":t.name),class:n||t.separator?o+=" include-separator":o})},_resetToolbar:function(){let e=this.dpmToolbar.getElement(C.group2);e&&e.empty();let t=this.dpmToolbar.getElement(C.group3);t&&t.empty();let i=this.dpmToolbar.getElement(C.group4);i&&i.empty()},createTab:function(e,t){let i=e.add({label:t.label,isSelected:t.selected,icon:{iconName:t.font,fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"2x"},checkFlag:t.checkFlag}).button;return i.domId=t.name,i},initializeDropdownEvents:function(e){let t=this;return e.onClick.validateModificationsPending?r.validateModificationsPending.bind(this,{parentView:this,yesEventFunc:function(i,n){t[e.onClick.functionName](i,n,e)}}):t[e.onClick.functionName]},_createCustomView:function(e,t,i,n){return!this._customObjects[t]&&i.customView&&(this._customObjects[t]=new i.customView(this)),e=this._customObjects[t]||this[t],n&&e.render(),e},initializeButtonEvents:function(e,t,i){let n=this,o=e.buttonClick;if(o){let s=e.customViewKey,a=function(){let a=n;s&&(a=n._createCustomView(a,s,e)),"contentInstance"===o.invokeObject?i[o.functionName](o.params):e.dropdown?a[o.functionName](e,t,n._toolbarButtons[t].getContent(),!0):a[o.functionName](o.params)};o.validateModificationsPending?this._toolbarButtons[e.name].getContent().addEventListener("buttonclick",r.validateModificationsPending.bind(void 0,{parentView:n,yesEventFunc:a})):n._toolbarButtons[e.name].getContent().addEventListener("buttonclick",a)}},addButton:function(e,t,o){let s=t.name;this._toolbarButtons[s]&&this._toolbarButtons[s].destroy(),this._toolbarButtons[s]=new i({domId:t.domId,recId:t.customViewKey,emphasize:t.emphasize,displayStyle:t.displayStyle,icon:{iconName:t.iconName,fontIconSize:t.fontIconSize,fontIconFamily:WUXManagedFontIcons.Font3DS},tooltipInfos:new n({shortHelp:t.shortHelp})}).inject(e),t.buttonClick?this.initializeButtonEvents(t,s,o):this.addDropDownItem(t,s,this._toolbarButtons[s].getContent())},addDropDownItem:function(e,t,i,n){let s=e.dropdown;if(s){let e=s.getItems("context"===s.useModel?this.getContext():"currentModel"===s.useModel?this._viewCollection&&this._viewCollection.getCurrentDataModel():s.useModel&&this[s.useModel]());1===e.length?s.onClick.validateModificationsPending?r.validateModificationsPending({parentView:this,yesEventFunc:this[s.items[0].value].bind(this)}):this[s.items[0].value]():(s.onInitialize&&this[s.onInitialize.functionName](e),this.dropdownCollection?this.dropdownCollection[t]&&this.dropdownCollection[t].destroy():this.dropdownCollection={},s.onClick?this.dropdownCollection[t]=new o({target:this._toolbarButtons[t].getContent(),items:e,events:{onClick:this.initializeDropdownEvents(s)}}):this.dropdownCollection[t]=new o({target:i,items:e}),n&&this.dropdownCollection[t].show())}},addContextSelection:function(e){let t=this._contextSourceInfo.fieldDefinitionSource,i=t&&l.get(t);if(i&&i.length)return this.contextView&&this.contextView.destroy(),this.contextView=new s({DocumentManagement:a,model:this.contextScope,homeView:this,displayMessage:d.displayMessage}),this.contextView.resetModel(this.contextScope),this._viewCollection.fieldDefinitionSource=t,this.contextView.setConfig(this._contextSelectionConfig.values),void this.contextView.render().inject(e);t&&this.listenTo(l,"onChange:"+t,this.addContextSelection.bind(this,e))},getToolbarButton:function(e){return this._toolbarButtons[e]},showMassUpdateToolbarButton:function(e){let t=this.massUpdateView&&this.massUpdateView.massUpdateButtons,i=t&&Object.keys(t).length;for(let i in t)t.hasOwnProperty(i)&&(t[i].visibleFlag=e);let n=this.dpmToolbar&&this.dpmToolbar.getElement("#toolbarMultiObjectActions");n&&n.toggleClassName("include-separator",Boolean(i&&e))},getCurrentViewFilterValues:function(){let t,i=this._homeTabConfig.getSpecificViewConfig(m.getSelectedViewName()),n=i&&this.getToolbarButtonConfig(i.toolbarConfig,"filterNewButton");if(n){let i=n.dropdown;t=e.is(i.getFilterItems,"function")?i.getFilterItems():[...n.dropdown.items]}return t},getToolbarButtonConfig:function(e,t){let i=e&&Object.keys(e);if(i&&i.length){let i=Object.values(e).flat();return r.findObject(i,"domId",t)}},getToolbarButtonName:function(e,t){let i=this.getToolbarButtonConfig(e,t);return i&&i.name},updateStateOfActionsButtons:function(e,t){let i=t&&t.toolbarConfig;if(i){let n=this.checkCreateAccess(e,t),o=this.getToolbarButton(this.getToolbarButtonName(i,"createNewButton")),s=this.getToolbarButton(this.getToolbarButtonName(i,"settingsButton"));o&&(o.disabled=n,o.tooltipInfos.shortHelp=this.getNLSMessageForCreateBtn(e,n,t)),this.isComponent&&s&&(s.disabled=n,s.tooltipInfos.shortHelp=this.getNLSMessageForSettingsBtn(e,n,t)),r.isGridViewSelected()&&this.disableMassUpdateButton(!0)}},getNLSMessageForCreateBtn:function(e,t){let i=p.replace(p.CREATE,{appName:this.appName||""});if(t){if(e.get("project"))if(this.isComponent)i=p.NO_XPROJECT_CREATE_ACCESS_XPP;else{switch(i=p.NO_CREATE_ACCESS_TT_MSG,e.type){case g.TYPENAMES.PROJECT:i+=p.NO_DPMPROJECT_CREATE_ACCESS_TT_MSG;break;case g.TYPENAMES.XPROJECT:i+=p.NO_XPROJECT_CREATE_ACCESS_TT_MSG}}else i=p.COLLAB_SPACE_SELECT_ERROR}return i},getNLSMessageForSettingsBtn:function(e,t){let i=p.MATRIX_CONFIGURATION;if(t){i=e.get("project")?p.NO_RMC_ACCESS:p.COLLAB_SPACE_SELECT_ERROR}return i},disableMassUpdateButton:function(e){let t=this.massUpdateView&&r.filterObjects(Object.values(this._toolbarButtons),"recId","massUpdateView");for(let i in t)t.hasOwnProperty(i)&&(t[i].disabled=e)},loadData:function(t){let i=e.clone(t||{},!1);this.requiresReload?(delete this.requiresReload,this.reload(i)):i.doNotRenderTabs||this.switchTab(0,i)},handleComponentTabContentRenderView:function(t,i){let n={},o=i.facetConfig||this._homeTabConfig.getPanelViewConfig().toolbarConfig.group1;e.extend(i,{parentView:this.parentView||i.parentView||this,_config:o}),o&&o.length&&t&&(n.value=r.findIndex(o,"name",t)),-1===n.value&&(n.value=0),this.handleTabClickEvents(i,{dsModel:n})},_processTabContentRenderView:function(t){let i=e.clone(t||{},!1),n=i.viewName||m.getSelectedViewName();if(i.isComponent)this.handleComponentTabContentRenderView(n,i);else{let e,t=this.ddTabBar.tabBar._getVisibleTabButtons();n&&(e=r.findObject(t,"domId",n)),(e=e||t[0]).clickMode=0,e.fire("click")}},switchTab:function(t,i){if(this.isComponent)this.dispatchEvent("switchToRisksTab");else if(this.ddTabBar){let n=e.clone(i||{},!1),o=this.ddTabBar.tabBar.getButtonFromValue(t);o&&e.extend(n,{viewName:o.domId}),this._processTabContentRenderView(n)}},show:function(e){this._appContainer&&this._appContainer.show(),this.homeBodyView&&this.homeBodyView[e]&&this.homeBodyView[e].show()},hide:function(){if(this._appContainer&&this._appContainer.hide(),this.homeBodyView)for(let e in this.homeBodyView)if(this.homeBodyView.hasOwnProperty(e)){this.homeBodyView[e]&&this.homeBodyView[e].hide()}},getCurrentView:function(){let e=m.getSelectedViewName();return this.homeBodyView[e]||this.commonFacetView&&this.commonFacetView.homeBodyView[e]},getViewCollection:function(){let e=this.getCurrentView();return e&&(e._viewCollection?e._viewCollection:e.parentView._viewCollection)||this._viewCollection},getViewFilterButtonLabel:function(e){if(!e)return;let t=this.getCurrentViewFilterValues(),i=t&&r.findObject(t,"name",e);return i&&i.text},destroy:function(){if(this.ddTabBar&&this.ddTabBar.destroy(),this.settingsButton&&this.settingsButton.destroy(),this.massUpdateButton&&this.massUpdateButton.destroy(),this.massUpdateView&&this.massUpdateView.destroy(),this._customObjects)for(let e in this._customObjects)this._customObjects.hasOwnProperty(e)&&(this._customObjects[e].destroy(),delete this._customObjects[e])}})}),define("DS/ENOProjectMgmtCommonComponents/config/LinkHomeTabConfig",["DS/ENOProjectMgmtCommonComponents/config/LinkTabConfig","DS/ENOProjectMgmtCommonComponents/utils/ProjectMgmtCloneModel","DS/ENOProjectMgmtCommonComponents/collection/LinkViewCollection","DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtDetailsAndRelationships","DS/ENOProjectMgmtModels/Constants/Constants","DS/ENOProjectMgmtModels/Models/RelatedDataItem","DS/ENOProjectMgmtModels/Collections/RelatedDataItems"],function(e,t,i,n,o,s,a){"use strict";return{constants:o,tabConfig:e,viewCollection:new i({DataModel:s,DataModels:a,CloneModel:t,defaultDataModelAttrs:{type:o.TYPENAMES.URL,policy:o.TYPENAMES.URL,serviceId:"3DSpace"}}),detailsAndRelationships:n}}),define("DS/ENOProjectMgmtCommonComponents/views/LinkViewPopup",["UWA/Core","DS/ENOProjectMgmtModels/Models/CSRFDataModel","DS/ENOProjectMgmtCommonComponents/components/PopupCommon","DS/ENOProjectMgmtCommonComponents/config/LinkHomeTabConfig","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o){"use strict";return e.Class.View.extend({_uwaClassName:"LinkViewPopup",init:function(i){let o=e.clone(i||{},!1);this.model=o.model,this.callback=o.callback,this.onFailure=o.onFailure,this.collection=o.collection,this.fieldName=o.fieldName,this.closureFunc=o.closureFunc,this.isComponent=o.isComponent,this.sourceModel=o.currentModel,this.viewCollection=n.viewCollection,t.prototype.csrfValue||this.viewCollection.getDataModels({fieldDefinitionOnly:!0,sourceType:n.constants.APPLICATIONS.LINKS}),this.isComponentditModel=this.isComponent&&this.model,this._parent(i)},render:function(){let t,s=this.model,a=!this.isComponent,l=n.viewCollection;if(this.isComponentditModel)s=new l.DataModel({id:this.model.get("id")||this.model.getIdForFederatedSearch(),title:this.model.get("title"),linkURL:this.model.get("linkURL"),description:this.model.get("description"),modifyAccess:this.model.get("canEdit").toString().toUpperCase()});else if(this.sourceModel){let e=new l.DataModel({id:this.sourceModel.get("id"),type:this.sourceModel.get("type"),modifyAccess:this.sourceModel.get("modifyAccess"),state:this.sourceModel.get("state")});e.resourceURL=this.sourceModel.model.url(),t=new l.CloneModel(e)}e.extend(l,{doNotSave:a,fieldName:this.fieldName,sourceModel:t,collection:this.collection||new l.DataModels}),this.contentView=new n.detailsAndRelationships(this.container,{parentView:this,editModel:s,onFailure:this.onFailure,tabConfig:n.tabConfig,isCreate:!s||s.isNew(),viewCollection:n.viewCollection}),this.dialog=new i({height:320,doNotRepeat:s,contentView:this.contentView,beforeCloseCallBack:this.beforeCloseCallBack.bind(this),title:s?o.EDIT_LINK:a?o.ADD_LINK:o.CREATE_NEW_LINK,saveButtonLabel:this.model?o.SAVE:a?o.ADD:o.CREATE_BUTTON_LABEL}),this.dialog.createDialog()},beforeCloseCallBack:function(){this.destroy(),this.closureFunc()},postCreateProcess:function(){let e=this.contentView.currentModel.model;this.isComponentditModel&&(this.model.set(e.getAttributes()),e=this.model),this.callback&&this.callback(e)},getDialog:function(){return this.dialog},destroy:function(){this.dialog&&(this.dialog.destroy(),delete this.dialog),this.contentView&&(this.contentView.destroy(),delete this.contentView),this._parent.apply(this,arguments)},getHeight:Function.prototype})}),define("DS/ENOProjectMgmtCommonComponents/views/CommonFacetView",["UWA/Core","DS/Controls/Button","DS/ControlsEx/IDCard","DS/Controls/TooltipModel","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtCommonComponents/views/HomeViewTabBase","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents"],function(e,t,i,n,o,s,a){"use strict";return s.extend({_uwaClassName:"CommonFacetView",_options:void 0,init:function(t){this._options=e.clone(t||{},!1),this.container=this._options.container,this.parentView=this._options.parentView,this._leftPanelContent=this._options.leftPanelContent,this._rightPanelContent=this._options.rightPanelContent,this._parent.apply(this,arguments),this._appConfig=this._options.appConfig,this._tabConfig=this._options.tabConfig,this._viewConfig=this._options.viewConfig,this.facetConfig=this._options.facetConfig,this._viewCollection=this._options.viewCollection,this.headerContainer=this.container.getElement(".ds-app-facet-toolbar"),this.homeBodyContent=this.container.getElement(this.facetConfig.bodyContainer)},reset:function(){this.idCard&&this.idCard.destroy(),this.detailsAndRelationships&&this.detailsAndRelationships.destroy(),this.parentView.getRightPanelContainer().empty(),this._parent.apply(this,arguments)},render:function(){let t=e.clone(this._options||{},!1),i=o.getSelectedViewName();if(!this.homeBodyView[i]||t.requiresReload){let i=e.clone(t.facetConfig||{},!1);this.reset(),t.isContentPanel=!0,this.initializeContainers(t),this._currentModel=this._viewCollection.getCurrentDataModel(),this.detailsAndRelationships=this.parentView.getPropertyPanelInstance(this.parentView.getRightPanelContainer(),{isCreate:!1,parentView:this,viewCollection:this._viewCollection,appConfig:this._appConfig,tabConfig:this._tabConfig,viewConfig:this._viewConfig,detailsAndRelationships:i.detailsAndRelationships}),this.addIdCard()}return e.extend(t,{viewName:i}),this._processTabContentRenderView(t),this.currentView=this.homeBodyView[o.getSelectedViewName()],this},getToolbarSplitter:function(){return new e.createElement("div",{class:"wux-controls-toolbar-category-separator"})},addHomeButton:function(e){delete this.homeButton,this.homeButton=new t({domId:"facetHomeButton",displayStyle:"smartIcon",icon:{iconName:"home",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},tooltipInfos:new n({shortHelp:a.HOME})}).inject(e)},addIdCardContent:function(){let t=this.idCard.getContent().getElement(".wux-controls-toolbar-containers.wux-controls-toolbar-farContainer");this.getToolbarSplitter().inject(t);let i=new e.createElement("div",{class:"wux-generated-toolbar-items wux-toolbar-items wux-toolbar-items-far"}),n=new e.createElement("div",{class:"wux-tweakers"}),o=new e.createElement("div",{class:"wux-generated-toolbar-items-tweaker"});o.inject(i),n.inject(o),this.addHomeButton(n),i.inject(t)},openPropertyPanel:function(e){this.detailsAndRelationships.render({model:e,config:this._viewCollection.getPropertiesConfig(e)}),this.showHideRightPanel(!0)},handleInfoButtonAction:function(){this.dispatchEvent("closeCreationPanel"),this.dispatchEvent("closeConfigurationPanel");let t=this.homeBodyView[o.getSelectedViewName()];if(t&&e.is(t.validateInfoActionButton,"function")&&!t.validateInfoActionButton())return void this.dispatchEvent("closePropertyPanel");let i,n=!0,s=t&&t.getSelectedRowsLength&&t.getSelectedRows().at(0),a=o.getSelectedViewName();s&&(a&&"ganttView"===a?i=this._currentModel.model.getRelatedModelById(s.id):(n=!1,t.handleRowSelection(s))),n&&this.openPropertyPanel(i)},setTitle:function(t){let i=e.clone(t||{},!1);e.extend(i,{doNotSetCount:!0}),this.parentView.setTitle(i)},resetContextFlag:function(){let e=o.get("context");e&&delete e.dataFetched},initializeIdCardEvents:function(){let e=this;this.idCard&&this.idCard.addEventListener("infoClicked",this.handleInfoButtonAction.bind(this)),this.homeButton&&this.homeButton.getContent().addEventListener("buttonclick",function(){let t=e.getTabBarConfig();e.dispatchEvent("closeCreationPanel"),e.detailsAndRelationships&&(e.detailsAndRelationships._isPropertyPanelOpen=!1),e.resetContextFlag(),o.setLastSelectedContextCache(),e.showHideLeftPanel(!0),e.setTitle(t)}),this.removeEvent("updateCommonFacet"),this.removeEvent("onSelectionChange"),this.removeEvent("closePropertyPanel"),this.listenTo(this,{updateCommonFacet:this.fetchAndUpdateIDCard.bind(this),onSelectionChange:function(){this.detailsAndRelationships.isPropertyPanelOpen()&&e.handleInfoButtonAction()},closePropertyPanel:function(){this.detailsAndRelationships&&(this.detailsAndRelationships._isPropertyPanelOpen=!1),this.showHideRightPanel(!1)}}),this.detailsAndRelationships&&this.detailsAndRelationships._isPropertyPanelOpen&&this.detailsAndRelationships.render()},addIdCard:function(){delete this.homeButton,this.idCard=new i({isFoldedFlag:!0,infoVisibleFlag:!0,identifier:"ProjectMgmtCommonFacetIdCard"}),this.addIdCardContent(),this.initializeIdCardEvents(),this.idCard.inject(this._getIdCardContainer()),this.fetchAndUpdateIDCard()},updateIdCard:function(){this.idCard&&(e.extend(this.idCard,{titleText:this._currentModel.title,titleIcon:this._currentModel.get("typeicon"),pictureSrc:this._currentModel.get("image"),subTitle:this._currentModel.get("description")||""}),this.setTitle())},fetchAndUpdateIDCard:function(e){this._currentModel.get("image")?this.updateIdCard():this._viewCollection.getDataModelDetails({refresh:!0,model:this._currentModel.model}).then(this.updateIdCard.bind(this)),e&&this.currentView&&this.currentView.dispatchEvent("onPostContextModify")},getRightPanelContainer:function(){return this.parentView.getRightPanelContainer()},showHideRightPanel:function(e){return this.parentView.showHideRightPanel(e,!0)},showHideLeftPanel:function(e,t){return this.parentView.showHideLeftPanel(e,t)},getTaggerProxy:function(){return this.parentView.getTaggerProxy()},createNew:function(e){return this.parentView.createNew(e)},getPropertyPanelInstance:function(e,t){return this.parentView.getPropertyPanelInstance(e,t)},_getIdCardContainer:function(){return this.container.getElement(".ds-app-skeleton-idcard")},oncreateNewDropdownSelection:function(e,t,i){return this.parentView.onCreateDropdownMenuSelection(e,t,i)},getValidSelectionModel:function(){return this.getCurrentView().getValidSelectionModel()},getTabBarConfig:function(){return this.currentView&&this.currentView.tabBarConfig},postCreateProcess:function(){this.setTitle()},getDialog:function(){return this.parentView.getDialog()},destroy:function(){this.homeButton&&(this.homeButton.destroy(),delete this.homeButton),this.idCard&&(this.idCard.destroy(),delete this.idCard),this.detailsAndRelationships&&(this.detailsAndRelationships.destroy(),delete this.detailsAndRelationships),this.bodyContent&&(this.homeButton.destroy(),delete this.bodyContent)}})}),define("DS/ENOProjectMgmtCommonComponents/views/ProjectMgmtHomeView",["UWA/Core","DS/ENOProjectMgmtCommonComponents/utils/Constants","DS/ENOProjectMgmtCommonComponents/utils/CommonUtils","DS/ENOProjectMgmtCommonComponents/components/CustomAlert","DS/ENOProjectMgmtCommonComponents/components/PopupCommon","DS/ENOProjectMgmtCommonComponents/components/ProgressSpinner","DS/ENOProjectMgmtCommonComponents/views/CommonFacetView","DS/ENOProjectMgmtCommonComponents/views/HomeViewTabBase","DS/ENOProjectMgmtCommonComponents/views/MatrixConfigDetailsAndRelationships","DS/ENOProjectMgmtModels/Models/AppSettings","DS/ENOProjectMgmtModels/Models/BaseContextScope","DS/ENOProjectMgmtModels/Constants/Constants","DS/ENOProjectMgmtModels/Utils/StorageDataUtil","DS/ENOProjectMgmtModels/Utils/DataUtils","i18n!DS/ENOProjectMgmtCommonComponents/assets/nls/ENOProjectMgmtCommonComponents","css!DS/ENOProjectMgmtCommonComponents/ENOProjectMgmtCommonComponents.css"],function(e,t,i,n,o,s,a,l,r,c,d,h,u,m,g){"use strict";return l.extend({_uwaClassName:"ProjectMgmtHomeView",init:function(e){this._parent(e),this.contextScope=new d,widget.projectMgmtAlertManager=n.init(),this._initAppPreference(),this.initializeEvents(),s.initializeProgressSpinner(this._getPositionContainer(this,e))},reset:function(){this.container&&this.container.click(),delete this._options,this.dpmToolbar&&(this.dpmToolbar.empty(),this.dpmToolbar=void 0),this.homeToolbarContent&&(this.homeToolbarContent.empty(),this.homeToolbarContent=void 0);for(let e in this.homeBodyView)if(this.homeBodyView.hasOwnProperty(e)){this.homeBodyView[e].destroy(),delete this.homeBodyView[e]}this._viewCollection.resetCollection()},reload:function(t){let i=e.clone(t||{},!1);i.viewName||(i.viewName=this.currentViewName);let n=c.get("invalidRiskFilterisOn");i.valiateInvalidRisksContext&&n&&"fired"===n&&c.set("invalidRiskFilterisOn","set"),i.donotInitializeContainers=!0,this._options&&(i.container=this._options.container,i.isComponent=this._options.isComponent),this._parent(i)},render:function(t){let i=e.clone(t||{},!1);return i.doNotRenderTabs||i.donotInitializeContainers||this.reset(i),this._options=i,i.donotInitializeContainers?delete t.donotInitializeContainers:this.initializeContainers(t),i.refresh&&this.clearContentForRefresh(),this._loadDataModels(i),this.container},setOptions:function(e){this._options=e},_getPositionContainer:function(t,i){let n=e.clone(i||{},!1);if(!t)return;let o=t.container.classList;return o.contains("ds-app-container")||o.contains("risk-view")||o.contains("summary-card")?t.container:this._getPositionContainer(n.parentView||t.parentView)},_loadDataModels:function(t){let i=e.clone(t||{},!1);i.showLoadSpinner&&s.showProgressSpinner(this._getPositionContainer(this,i),this._nls.LOADING),this.handleParamDataObjectsInApp();let n,o=this.getContextInfo(),a=o&&o.id||c.getContextId();i.context?(n=i.context,n=this.handleContextForModel(i.context),this.initializeEventsForComponentContext(i.context,i),this.context=n,this.contextScope.set("context",this.context,e.extend(i,{parentView:this,config:this._contextSelectionConfig.values[0]}))):(e.extend(i,{parentView:this,detailedObjects:[o],config:this._contextSelectionConfig.values[0]}),o?n=c.get("context"):(n=this.contextScope.get("context"))&&(n.length&&this.contextScope.remove("context",void 0,i),n=void 0));let l=this.onCompleteDataModels.bind(this,i),r=this.onFailureDataModels.bind(this,i);i.onComplete=l,i.onFailure=r,!this.hasParamDataExists()&&n||a?a?this._handleAddContexScope(a,i):(e.extend(i,{initialCall:this._initialCall}),this._viewCollection.getContextInfo(n,i).then(i.onComplete,i.onFailure)):(i.paramData=this._paramData,i.initialCall=this._initialCall,this._viewCollection.getDataModels(i))},_handleAddContexScope:function(i,n){let o=e.clone(n||{},!1);o.onComplete||(o.onComplete=this.onCompleteDataModels.bind(this,o)),o.onFailure||(o.onFailure=this.onFailureDataModels.bind(this,o)),o.detailedObject=m.getDetailedObject(i,o.detailedObjects),o.initialCall=this._initialCall;let s=m.getObjectDataFromDropSearchOrTypeAhead(o),a=s.id,l=m.getObjectForAdding(a,{attrs:s,modelConstructor:this.baseContextModel,sourceInfo:o.parentView&&o.parentView._contextSourceInfo||o.homeView._contextSourceInfo});this.contextScope.set(t.CONTEXT_ATTR,l,o),this._viewCollection.getContextInfo(l,o).then(o.onComplete,o.onFailure)},_loadMatrixConfigurations:function(e){let t=this,i={rmcType:t._rmcType,onComplete:function(){t._matrixConfigCollection.getDefaultConfiguration(),t._processPostCompleteDataModels(e)},onFailure:function(){}};this._matrixConfigCollection.getDataModels(i)},_processPostCompleteDataModels:function(t){let i=e.clone(t||{},!1);i.matrixConfigCollection=this._matrixConfigCollection;let o=c.getContextInfo(),s=this._homeTabConfig&&(o&&this._homeTabConfig.leftPanel&&this._homeTabConfig.leftPanel.navigatoFacetOnSelection?this._homeTabConfig.mainPanel:this._homeTabConfig.leftPanel);(s=s||i._config)&&"facet"===s.type||this._processTabContentRenderView(i),this.handleGetRisksResponse(i),i.showRefreshMessage&&n.buildNotification({message:g.REFRESH_SUCCESSFUL},"success"),o&&this._homeTabConfig.leftPanel&&"right"!==i.panel&&this.showHideLeftPanel(!this._homeTabConfig.leftPanel.navigatoFacetOnSelection)},_loadMatrixConfigurationDetails:function(){let e=this.contextScope.getConnectedRMC(),t={parentView:this,isRMCContext:!0,matrixConfigCollection:this._matrixConfigCollection,modelConstructor:r,contextMatrixConfiguration:e&&e.id},i=this.getPropertyPanelInstance(this.container,t);this.dialog=new o({title:g.MATRIX_CONFIGURATION,saveButtonLabel:g.SAVE,contentView:i,doNotRepeat:!0,beforeCloseCallBack:i.beforeClose.bind(i)}),this.dialog.createDialog()},_initAppPreference:function(){if(!this.isComponent){let e=widget.getValue("completedRisks");e?widget.deleteValue("completedRisks"):e=widget.getValue(t.COMPLETED_PREFERENCE);let i=this._appConfig.completedPreference&&this._appConfig.completedPreference.getDefault();c.set(t.COMPLETED_PREFERENCE,e||i);let n={name:t.COMPLETED_PREFERENCE,type:"list",defaultValue:i,options:this._appConfig.completedPreference&&this._appConfig.completedPreference.values,label:this._nls.SHOW_COMPLETED};widget.addPreference(n)}},initializeEvents:function(){let e=this;this.listenTo(this,"resetModel",this.resetCurrentModel),this.listenTo(c,"onChange:dimensions",this.setDimensions),this.listenTo(widget,{onSearch:function(t){e.filterRisksBasedOnSearch(t,"title",!0)},onResetSearch:this.filterRisksBasedOnSearch})},filterRisksBasedOnSearch:function(e,t,n){c.setFilterSearchString(e||""),i.validateModificationsPending({parentView:this,isReload:!0,dontResetModel:!0,yesEventFunc:this.processFilterRisks.bind(this,{yesEvent:!0,searchColAttr:t||"title",searchFilter:e,filterFromTreeDocument:n}),noEventFunc:this.processFilterRisks.bind(this,{searchColAttr:t||"title",searchFilter:e,filterFromTreeDocument:n})})},processFilterRisks:function(t){let i=e.clone(t||{},!1);if(i.callback=this.processFilterRisks.bind(this,t),!this.handleUnsaveForSearchAndPreferences(i)){let e=i.searchFilter,n=i.searchColAttr,o=i.filterFromTreeDocument;e||o||!this.taggerRiskIds||(e=this.taggerRiskIds,n="id"),this._viewCollection.filterDataModels(e,n,{filterFromTreeDocument:o}),this._processTabContentRenderView(),this.setTitle(t)}},handleContextForModel:function(e){let t=e.getTransferObject(),n=i.getObjectDataFromDropData(t.data.items[0]);return i.getObjectForAdding(n.id,{modelConstructor:this.baseContextModel,attrs:n,sourceInfo:this._contextSourceInfo})},initializeEventsForComponentContext:function(e){this.listenTo(e,"onChange:"+h.XPROJECT_COLLAB_SPACE,function(e,t){let i=c.get("context"),n=i.get("project"),o=t&&t.id;if(this._options&&n!==o){delete this._options.doNotFetchDataForView,this._options.ignoreFetchDataForView=!0,i.set("project",o);for(let e in this.homeBodyView)if(this.homeBodyView.hasOwnProperty(e)){this.homeBodyView[e].destroy(),delete this.homeBodyView[e]}this._options.viewName=this.currentViewName,this.render(this._options)}})},getContextInfo:function(){let e=c.getContextInfo();if(this.isParamSupportedTypeForContext()){let t=this._paramData[0];e={id:t.objectId,type:t.objectType,name:t.displayName,serviceId:t.serviceId},this.clearParamData()}return e},getAppConfig:function(){return this._appConfig||{}},clearContentForRefresh:function(){this.homeBodyView={},u.clear(),this.homeBodyContent&&this.homeBodyContent.empty()},isParamObjectsSupportedInApp:function(){let e,t,i=this.hasParamDataExists(),o=this._appConfig.supportedTypesAsParamsInAppListing;if(!i||!o)return!1;let s=[],a={};return this._paramData.forEach(i=>{e=i.objectType,o.includes(e)?s.push(i):(t=i.displayType||e,a[t]||(a[t]=[]),a[t].push(i.displayName))}),Object.keys(a).length&&n.showSingleErrorMessageForDataObjects(a,g.PARAM_DATA_NOT_SUPPORTED),this._paramData=s,Boolean(s.length)},handleGetRisksResponse:function(e){this.setTitle(e),s.hideProgressSpinner(this._getPositionContainer(this,e)),this.load6WTagger(e)},load6WTagger:function(t){let i=this,o=e.clone(t||{},!1);if(this._options.hide6WTagger)return;let s=this.taggerProxy&&this.taggerProxy.tnProxy;s&&(o.tnProxy=s),!s&&(s=o.tnProxy),!s&&this.isComponent||this._viewCollection.processTagger(o).then(function(e){i.taggerProxy=e,i.updateTaggerData(),i.listenTo(i.taggerProxy,"onSubjectChanged",function(e){let t=Boolean(e&&(Object.keys(e.allfilters).length||Object.keys(e.localfilters).length));widget.setValue("isTaggersSelected",t),i.taggerRiskIds=[],e&&e.filteredSubjectList&&e.filteredSubjectList.length&&e.filteredSubjectList.forEach(function(e){i.taggerRiskIds.push(e.split("pid://")[1])}),i.filterRisksBasedOnTags(i.taggerRiskIds)})},function(e){n.buildNotification({message:g.TAGGER_ERROR,title:e},"error")})},filterRisksBasedOnTags:function(e,t){this._viewCollection.filterDataModels(e,"id",t),this._processTabContentRenderView(),this.setTitle(t)},getTaggerProxy:function(){return this.taggerProxy},updateTaggerData:function(){let e=this.taggerProxy;if(!c.get("context")&&e){let t=this._viewCollection&&this._viewCollection.getDocument(),i=t&&t.getChildren();e.updateMappedTagObjects(i)}},handleParamDataObjectsInApp:function(){let e,t,i=this._appConfig.supportedTypesAsParamsInAppListing;if(!this.hasParamDataExists()||!i)return!1;let o={},s=[],a=[],l=[],r=this._appConfig.supportedTypesAsParamsForContext,c=this._paramData.length;this._paramData.forEach(n=>{e=n.objectType,i.includes(e)?s.push(n):r.includes(e)?l.push(n):(t=n.displayType||e,o[t]||(o[t]=[]),o[t].push(n.displayName),a.push(n))});let d=!0,h=l.length;s.length?this._paramData=s:1===h&&(this._paramData=l,d=!1),d&&h&&l.forEach(e=>{t=e.displayType||e.objectType,o[t]||(o[t]=[]),o[t].push(e.displayName)}),a.length===c&&this.clearParamData(),Object.keys(a).length&&n.showSingleErrorMessageForDataObjects(o,g.PARAM_DATA_NOT_SUPPORTED)},isParamSupportedTypeForContext:function(){return this.hasParamDataExists()&&1===this._paramData.length&&this._appConfig.supportedTypesAsParamsForContext&&this._appConfig.supportedTypesAsParamsForContext.includes(this._paramData[0].objectType)},handleCenterPanelView:function(i){if(this._homeTabConfig.leftPanel){if(!i){let e=this._viewCollection.getCurrentDataModel();if(e){if(this.contextScope.set(t.CONTEXT_ATTR,e.model),this.commonFacetView)for(let e in this.commonFacetView.homeBodyView)if(this.commonFacetView.homeBodyView.hasOwnProperty(e)){this.commonFacetView.homeBodyView[e]&&(this.commonFacetView.homeBodyView[e].requiresReload=!0)}}else e=c.get("context"),this._viewCollection.resetCollection(),this._viewCollection.getCollection().push(e),this._viewCollection.resetTreeDocument(),this._viewCollection.getDocument().selectNodeByRowId(0),this.contextScope.setContextCache(e)}if(!this.commonFacetView&&this._homeTabConfig.mainPanel){let t=e.clone(i||this._homeTabConfig.mainPanel.options||{},!1);e.extend(t,{parentView:this,viewConfig:this._viewConfig,container:this._myPanelMainContent,leftPanelContent:this._leftPanelContent,rightPanelContent:this._rightPanelContent,facetConfig:this._homeTabConfig.mainPanel}),this.commonFacetView=new a(t)}this.setContextInitialLoad(),this.commonFacetView&&this.commonFacetView.render()}},setContextInitialLoad:function(){let t=c.get("context");t&&e.extend(t,{initialLoad:!0})},onCompleteDataModels:function(t,i){let n=e.clone(t||{},!1),o=n.ignoreFetchDataForView||this._options.ignoreFetchDataForView;i&&i instanceof e.Class.Model&&(this.clearParamData(),this.dropdownCollection&&this.dropdownCollection.viewFilterbuttonContainer&&this.dropdownCollection.viewFilterbuttonContainer.updateItem({id:h.ALL_ITEMS,text:this._nls.ALL_CONTEXT_RISKS,label:this._nls.ALL_CONTEXT_RISKS}));let s=c.getFilterSearchString();s&&this._viewCollection.filterDataModels(s,"title"),o?this._processPostCompleteDataModels(n):(this._options.ignoreMatrixConfiguration||this._loadMatrixConfigurations(n),this._viewConfig.isLibraryInstalled()?(this._classificationCollection.loadClassifications(),this.fetchAdditionalDataForModels(this._options)):this._processPostCompleteDataModels(n))},fetchAdditionalDataForModels:function(t){let i=e.clone(t||{},!1),n={fields:"classes.title",includeFields:"classes",paramData:i.paramData,onComplete:this.onCompleteAdditionalDataModels.bind(this,i),onFailure:this.onFailureAdditionalDataModels.bind(this)};this._viewCollection.fetchAdditionalDataForModels(n)},onCompleteAdditionalDataModels:function(e){c.getSelectedViewName()&&c.getSelectedViewName()===this.SUMMARY_VIEW&&this.homeBodyView.summaryView&&this.homeBodyView.summaryView.reloadCharts(),e&&e.processPostCompleteDataModels&&this._processPostCompleteDataModels(e)},onFailureAdditionalDataModels:Function.prototype,onFailureDataModels:function(e,t){if(!this.isComponent){this.contextScope.get("context")&&this.contextScope.remove("context",void 0,e)}this.handleGetRisksResponse(),t&&!t.success&&400===t.statusCode&&this.container.empty&&this.container.empty()},handleRemoveContext:function(t){let i=e.clone(t||{},!1);i.showLoadSpinner=!0,this.reload(i)},getSelectedFilterLabelsForWidgetTitle:function(){let e=this.getViewFilterButtonLabel(c.getSelectedFilterOption()),t=this.getViewFilterButtonLabel(c.getSelectedSubFilterOption());return t&&(e=e?e+" - "+t:t),e},setTitle:function(t){let i=e.clone(t||{},!1);if(i.doNotSetTitle)widget.setTitle("");else if(!this.isComponent){let e="",t=c.get("context")||i.context,n=this.hasParamDataExists()&&g.SEARCHED_LIST||"";if(!n)if(i.title)n=i.title;else{let e=t&&t.get("title")||"",i=this.getSelectedFilterLabelsForWidgetTitle();e&&(n=e),i&&(n+=(n?" - ":"")+i),c.get("invalidRiskFilterisOn")&&(n+=(n?" - ":"")+g.INVALID+" "+g.LIST)}!i.doNotSetCount&&n&&(e=" ("+this.getViewCollection().getDataModelsCount()+")"),widget.setTitle(n+e)}},createNewBasedOnSelection:function(e,t){this.createNew(t.params)},createNew:function(t){let i=e.clone(t||{},!1),n=e.extend({parentView:this,context:c.get("context"),viewCollection:i.viewCollection||this._viewCollection,matrixConfigCollection:this._matrixConfigCollection,trendConfig:this._trendConfig,trendChartConfig:this._trendChartConfig,trendTemplate:this._trendTemplate,viewConfig:this._viewConfig,nlsTrend:this._nls.RISK_TREND,appConfig:this._appConfig,tabConfig:this._tabConfigForCreate,isCreate:!0,modelConstructor:i.detailsAndRelationships,additionalFooterButtons:i.additionalFooterButtons});e.extend(n,i);let s=this.getPropertyPanelInstance(this.container,n);i.contentView=s,i.saveButtonLabel=i.isMassUpdate?g.SAVE:g.CREATE_BUTTON_LABEL,i.title=i.title||g.replace(g.CREATE,{appName:this.appName}),this.dialog=new o(i),this.dialog.createDialog()},getPropertyPanelInstance:function(e,t){return new(t&&t.modelConstructor||this._detailsAndRelationships)(e,t)},handleUnsaveForSearchAndPreferences:function(e){let t=!1,i=this.getSelectedCurrentModel();return e.yesEvent&&i&&i.modificationsPending?(this._viewCollection.saveDataModel(i,{isReload:!0,onComplete:e&&e.callback}),t=!0):i&&i.cancel(),t},destroy:function(){if(this.dropdownCollection){for(let e in this.dropdownCollection)this.dropdownCollection.hasOwnProperty(e)&&this.dropdownCollection[e].destroy();delete this.dropdownCollection}for(let e in this.homeBodyView)this.homeBodyView.hasOwnProperty(e)&&this.homeBodyView[e].destroy();this.taggerProxy&&this.taggerProxy.destroy(),this.container&&this.container.destroy(),this._leftPanelContent&&this._leftPanelContent.destroy(),this.commonFacetView&&this.commonFacetView.destroy(),this._myPanelMainContent&&this._myPanelMainContent.destroy(),this._rightPanelContent&&this._rightPanelContent.destroy()},addExisting:function(e){i.addExistingSearch(e)},postCreateProcess:function(){this.setTitle();let e=c.getSelectedViewName();"summaryView"===e&&this.homeBodyView[e].loadData()},getGridView:function(){return i.isGridViewSelected()&&this.homeBodyView[c.getSelectedViewName()]},getSelectedCurrentModel:function(){let e=this.getGridView();return e&&e.detailsAndRelationships&&e.detailsAndRelationships.currentModel},resetCurrentModel:function(){let e=this.getGridView();e&&e.detailsAndRelationships&&e.detailsAndRelationships.cancelCreateOrEdit()},isCurrentContext:function(e){let t=c.getContextInfo(),i=e&&m.removeBracketLongURI(e.id);return!(!i||!t||(t.id||t.get("id"))!==i)},getDialog:function(){return this.dialog},SUMMARY_VIEW:"summaryView"})});