define("DS/IPClassifyUX/events/IPClassifyEvents",["UWA/Class","DS/CoreEvents/ModelEvents"],function(e,t){return e.singleton({EVT_CURRENT_LIBRARY_CHANGE:"/LIBRARY_EDITOR/CURRENTLIBRARY_CHANGE",EVT_NODEMODEL_MODIFY:"/LIBRARY_EDITOR/NODEMODEL_MODIFY",EVT_LIBRARY_LOADINGSTART:"/LIBRARY_EDITOR/LIBRARY_LOADINGSTART",EVT_LIBRARY_LOADINGEND:"/LIBRARY_EDITOR/LIBRARY_LOADINGEND",EVT_CURRENT_LIBRARY_FILTER_CHANGE:"/LIBRARY_EDITOR/CURRENTLIBRARY_FILTER_CHANGE",EVT_CURRENT_LIBRARY_COLUMN_CHANGE:"/LIBRARY_EDITOR/CURRENT_LIBRARY_COLUMN_CHANGE",EVT_LIBRARY_TREELISTVIEW_SCROLL_END:"/LIBRARY_EDITOR/LIBRARY_TREELISTVIEW_SCROLL_END",EVT_LIBRARY_TAGGER_OPEN:"/LIBRARY_EDITOR/LIBRARY_TAGGER_OPEN",EVT_LIBRARY_TAGGER_CLOSE:"/LIBRARY_EDITOR/LIBRARY_TAGGER_CLOSE",EVT_LIBRARY_PAGETOOLBAR_EXPAND:"welcome-panel-expand",EVT_LIBRARY_PAGETOOLBAR_EXPANDED:"welcome-panel-expanded",EVT_LIBRARY_PAGETOOLBAR_COLLAPSE:"welcome-panel-collapse",EVT_LIBRARY_PAGETOOLBAR_COLLAPSED:"welcome-panel-collapsed",EVT_LIBRARY_PAGEINFO_EXPAND:"information-panel-open",EVT_LIBRARY_PAGEINFO_EXPANDED:"information-panel-visible",EVT_LIBRARY_PAGEINFO_COLLAPSE:"information-panel-close",EVT_LIBRARY_PAGEINFO_COLLAPSED:"information-panel-hidden",EVT_COLUMN_SORT_CHANGE:"/LIBRARY_EDITOR/COLUMN_SORT_CHANGE",EVT_REMOVENODE_CONTENT:"/LIBRARY_EDITOR/REMOVENODE_CONTENT",EVT_UPDATE_SEARCH_VISIBILITY:"/LIBRARY_EDITOR/UPDATE_SEARCH_VISIBILITY",EVT_EXPANDTREE_AND_SELECT:"/LIBRARY_EDITOR/EXPANDTREE_AND_SELECT",EVT_LIBRARYSELECT:"/LIBRARY_EDITOR/SELECT",EVT_ACTIVATE_TREE_ITEM:"/LIBRARY_EDITOR/ACTIVATE_TREE_ITEM",EVT_TREE_SORT_CHANGE:"/LIBRARY_EDITOR/TREE_SORT_CHANGE",EVT_CONTENT_SEARCH_RESULT:"/LIBRARY_EDITOR/CONTENT_SEARCH_RESULT",EVT_CONTENT_SEARCH_CHANGE:"/LIBRARY_EDITOR/CONTENT_SEARCH_CHANGE",EVT_CONTENT_TAB_CHANGE:"/LIBRARY_EDITOR/CONTENT_TAB_CHANGE",EVT_FAVORITE_SECTION_EMPTY:"/LIBRARY_EDITOR/EVT_FAVORITE_SECTION_EMPTY",EVT_CONTENT_READY:"/LIBRARY_EDITOR/EVT_CONTENT_READY",EVT_SWITCH_MODE:"/LIBRARY_EDITOR/INDEX_DB_MODE_CHANGE",EVT_TAB_CHANGE:"/LIBRARY_EDITOR/TAB_CHANGE",_modelEvents:null,init:function(e){this._parent(e),this._modelEvents=new t},getModelEvents:function(){return this._modelEvents},notifyupdateRefreshTime:function(e){if(!UWA.is(e,"object"))throw new Error("input parameter should be object");this._modelEvents.publish({event:"REFRESH_TIME_UPDATED",data:e})},onUpdateRefreshTime:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:"REFRESH_TIME_UPDATED"},e)},notifyLibraryLoadingStart:function(e){if(!UWA.is(e))throw new Error("input parameter should be a TreeNodeModel");this._modelEvents.publish({event:this.EVT_LIBRARY_LOADINGSTART,context:e,data:e})},onLibraryLoadingStart:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_LOADINGSTART},e)},notifyLibraryLoadingEnd:function(e){if(!UWA.is(e))throw new Error("input parameter should be a TreeNodeModel");this._modelEvents.publish({event:this.EVT_LIBRARY_LOADINGEND,context:e,data:e})},onLibraryLoadingEnd:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_LOADINGEND},e)},notifyLibraryRename:function(e){if(!UWA.is(e,"object"))throw new Error("input parameter should be object");this._modelEvents.publish({event:this.EVT_NODEMODEL_MODIFY,context:e.oldNode,data:e})},onLibraryRename:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_NODEMODEL_MODIFY},e)},notifyRemoveNodeInContent:function(e){this._modelEvents.publish({event:this.EVT_REMOVENODE_CONTENT,data:e})},onRemoveNodeInContent:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_REMOVENODE_CONTENT},e)},notifyUpdateSearchVisibility:function(e){this._modelEvents.publish({event:this.EVT_UPDATE_SEARCH_VISIBILITY,data:e})},onUpdateSearchVisibility:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_UPDATE_SEARCH_VISIBILITY},e)},notifyExpandTreeAndSelect:function(e){this._modelEvents.publish({event:this.EVT_EXPANDTREE_AND_SELECT,data:e})},onExpandTreeAndSelect:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_EXPANDTREE_AND_SELECT},e)},notifyLibrarySelected:function(e){this._modelEvents.publish({event:this.EVT_LIBRARYSELECT,data:e})},onLibrarySelected:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARYSELECT},e)},notifyActivateTreeItem:function(e){this._modelEvents.publish({event:this.EVT_ACTIVATE_TREE_ITEM,data:e})},onActivateTreeItem:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_ACTIVATE_TREE_ITEM},e)},notifyTreeSortChange:function(e){this._modelEvents.publish({event:this.EVT_TREE_SORT_CHANGE,data:e})},onTreeSortChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_TREE_SORT_CHANGE},e)},notifyContentSearchResult:function(e){this._modelEvents.publish({event:this.EVT_CONTENT_SEARCH_RESULT,data:e})},onContentSearchResult:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CONTENT_SEARCH_RESULT},e)},notifyContentSearchChange:function(){this._modelEvents.publish({event:this.EVT_CONTENT_SEARCH_CHANGE})},onContentSearchChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CONTENT_SEARCH_CHANGE},e)},onEmptySearchQuery:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:"EmptySearchQuery"},e)},notifyOnEmptySearchQuery:function(){this._modelEvents.publish({event:"EmptySearchQuery"})},notifyContentTabChange:function(){this._modelEvents.publish({event:this.EVT_CONTENT_TAB_CHANGE})},onContentTabChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CONTENT_TAB_CHANGE},e)},notifyCurrentLibraryChange:function(e){if(!UWA.is(e,"object"))throw new Error("input parameter should be object");if(!e.currentNode)throw new Error("input object should have currentNode");this._modelEvents.publish({event:this.EVT_CURRENT_LIBRARY_CHANGE,context:e.currentNode,data:e})},onCurrentLibraryChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CURRENT_LIBRARY_CHANGE},e)},notifyCurrentLibraryFilterChange:function(){this._modelEvents.publish({event:this.EVT_CURRENT_LIBRARY_FILTER_CHANGE})},onCurrentLibraryFilterChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CURRENT_LIBRARY_FILTER_CHANGE},e)},notifyCurrentLibraryColumnChange:function(){this._modelEvents.publish({event:this.EVT_CURRENT_LIBRARY_COLUMN_CHANGE})},onCurrentLibraryColumnChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CURRENT_LIBRARY_COLUMN_CHANGE},e)},notifyColumnSortChange:function(){this._modelEvents.publish({event:this.EVT_COLUMN_SORT_CHANGE})},onColumnSortChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_COLUMN_SORT_CHANGE},e)},notifyScrollEnd:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_TREELISTVIEW_SCROLL_END})},onScrollEnd:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_TREELISTVIEW_SCROLL_END},e)},notifyTaggerOpen:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_TAGGER_OPEN})},onTaggerOpen:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_TAGGER_OPEN},e)},notifyTaggerClose:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_TAGGER_CLOSE})},onTaggerClose:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_TAGGER_CLOSE},e)},notifyPageToolBarExpand:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGETOOLBAR_EXPAND})},onPageToolBarExpand:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_PAGETOOLBAR_EXPAND},e)},notifyPageToolBarExpanded:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGETOOLBAR_EXPANDED})},onPageToolBarCollapse:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_PAGETOOLBAR_COLLAPSE},e)},notifyPageToolBarCollapse:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGETOOLBAR_COLLAPSED})},notifyInfoExpand:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGEINFO_EXPAND})},onInfoExpand:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_PAGEINFO_EXPAND},e)},notifyInfoExpanded:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGEINFO_EXPANDED})},notifyInfoCollapse:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGEINFO_COLLAPSE})},onInfoCollapse:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_LIBRARY_PAGEINFO_COLLAPSE},e)},notifyInfoCollapsed:function(){this._modelEvents.publish({event:this.EVT_LIBRARY_PAGEINFO_COLLAPSED})},notifyContentReady:function(){this._modelEvents.publish({event:this.EVT_CONTENT_READY})},onContentReady:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_CONTENT_READY},e)},notifyFavoriteSectionEmpty:function(){this._modelEvents.publish({event:this.EVT_FAVORITE_SECTION_EMPTY})},onFavoriteSectionEmpty:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_FAVORITE_SECTION_EMPTY},e)},notifyModeChange:function(e){if(!UWA.is(e,"object"))throw new Error("input parameter should be object");this._modelEvents.publish({event:this.EVT_SWITCH_MODE,data:e})},onModeChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_SWITCH_MODE},e)},notifyTabChange:function(e){this._modelEvents.publish({event:this.EVT_TAB_CHANGE})},onTabChange:function(e){if(!UWA.is(e,"function"))throw new Error("input parameter should be function");this._modelEvents.subscribe({event:this.EVT_TAB_CHANGE},e)},unsubscribeAll:function(){this._modelEvents.unsubscribeAll()}})}),define("DS/IPClassifyUX/views/additionalData/ThumbnailAttribute",["UWA/Class","DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyUtility"],function(e,t,i){"use strict";var n=function(){return"thumbnail"};return e.singleton({init:function(e){this.alwaysUpdate=!0,this._parent(e)},setCheckToShowThumbnail:function(e){this._toShowThumbnailCheck=e},getName:n,getManagedColumnNames:()=>["thumbnail","isThumbnailSet"],toBeUpdated:function(e,t){if(i.isIndexedMode())return!1;if(this._toShowThumbnailCheck){if(!this._toShowThumbnailCheck(this.getName()))return!1}return!e.isThumbnailSet},updateAttributes:function(e,i){t.loadThumbnails({ids:e.pids,onComplete:e=>{if(e){var t=e.results,n={};t&&(t.forEach(function(e){var t=e.attributes,i=null,r=null;t.every(function(e){if("preview_url"===e.name){if(r=(r=e.value).indexOf("snresources")<0?r:null,i||!r)return!1}else if("resourceid"===e.name&&(i=e.value,r))return!1;return!0}),n[i]={isThumbnailSet:!0},i&&r&&(n[i]={thumbnail:"url("+r+")",isThumbnailSet:!0,_root:{thumbnail:r}})}),i({pids:n}))}},onFailure:function(){i({}),console.log("Failure during thumbnail retrieval")}})}})}),define("DS/IPClassifyUX/facets/AttachmentsFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/IPClassifyUtil/IPClassifyAlert","DS/EditPropWidget/facets/Common/FacetsBase","DS/ENOXAttachmentsUX/AttachmentsPane","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],function(e,t,i,n,r,a,o){return t.extend(i,r,{init:function(e){this._parent(e),this.componentRefresh=!1,this.buildView(e)},buildView:function(t){this.elements.container=e.createElement("div",{class:"attachments"}),this.multiselDisplay=e.createElement("div",{class:"notSupported"}).inject(this.elements.container),this.iconHolder=e.createElement("span",{class:"blockIcon"}).inject(this.multiselDisplay),this.infoMsgH2Tag=e.createElement("h2",{class:"information_msg"}).inject(this.multiselDisplay),this.multiselDisplay.hide();var i={parentObject:{parentId:t.appContext.getDocumentId()},connectorOptions:{fetchSecurityContext:function(){return t.appContext.options.securityContext},platformUrls:t.appContext.options.platformUrls},readonly:t.appContext.readonly};this.attachmentsPane=new a(i),this.attachmentsPane.inject(this.elements.container),this.attachmentsPane.modelEvents.subscribe({event:"context-menu-requested"},function(e){var t;if(e.contextMenu.items.forEach(function(e){e.name&&e.name.startsWith("open-with")&&(t=e)}),t){var i=[];e.contextMenu.items.forEach(function(e){e.parentItemId&&e.parentItemId==t.id&&i.push(e)}),i.length>0&&1==i.length&&"ENXWDOC_AP"==i[0].name&&e.contextMenu.removeItem([t.id,i[0].name])}}),this.attachmentsPane.modelEvents.subscribe({event:"user-selects-files-for-upload"},function(e){t.appContext.isOwnerRole&&(e.cancelled=!0,n.displayNotification({message:o.UploadNewAttachmentActionFail,className:"error"}))}),this.multiselDisplay.isHidden()||this.attachmentsPane.hide()},updateFacet:function(){this.selectionModified(this.options.appContext.getDocumentId())},notApplicable:function(){this.infoMsgH2Tag.setText(this.options.appContext.i18nManager.get("notSupportedSelection")),this.iconHolder.addClassName("wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"),this.multiselDisplay.show(),this.attachmentsPane&&this.attachmentsPane.hide()},selectionModified:function(e){if(e){this.multiselDisplay.hide();var t={parentId:e};this.attachmentsPane&&this.attachmentsPane.getParentObject().parentId!==e&&(this.attachmentsPane.show(),this.attachmentsPane.setParentObject(t)),this.componentRefresh=!0}else this.notApplicable()},onResize:function(){},onRefresh:function(){}})}),define("DS/IPClassifyUX/views/IPClassifyWebInWinTaggerProxy",["DS/SNResultUX/webinwin/WebInWinTaggerProxy","UWA/Core","DS/CoreEvents/ModelEvents"],function(e,t,i){"use strict";return e.extend(i,{init:function(e){e.proxyId=e.widgetId+"LibraryEditor_WebInWin",this._parent.call(this,e)},_dispatchEvent:function(e){if(!t.is(e,"object")||!t.is(e.notif_name)||void 0===e.notif_parameters)throw console.log("E_INVALIDARG, expect to have parameters.notif_name arg & parameters.notif_parameters in _dispathTowin !!!"),"No parameters.notif_name arg & parameters.notif_parameters given to _dispathTowin method !";console.log("ResultWebInWin._dispathTowin for "+e.notif_name);var i=t.is(e.notif_parameters,"string")?e.notif_parameters:JSON.stringify(e.notif_parameters);"undefined"!=typeof dscef&&dscef.sendString(e.notif_name+"="+i)}})}),define("DS/IPClassifyUX/service/LibraryDnDService",["UWA/Class","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PADUtils/PADUtilsServices","DS/WidgetServices/WidgetServices","DS/IPClassifyUtil/IPClassifyCommunication"],function(e,t,i,n,r,a){return e.singleton({setDragData:function(e,t,i,n){if(r.isNatifEnvironnement()&&!r.isWebInWinEnvironment()){var o=i.getSelectedNodesID();a.publish("setDragData",{ids:o})}else{var s=i.getSelectedNodes(),l=i.getCurrentObject(),d="";l&&!l.isRoot()&&n.isValidType(l.plmType)&&(d=l.getID());var c={protocol:"3DXContent",version:"1.1",source:"LibraryEditor",widgetId:widget.id,data:{items:[]}},u=widget.getValue("x3dPlatformId");u||(u="OnPremise");var h=widget.getPreference("pad_security_ctx");h&&h.value&&(h=h.value.split("::")[1]);var f=[];s.forEach(function(e){var t={envId:u,serviceId:"3DSpace",contextId:h,objectId:e._options.physicalid,objectType:e._options.type,displayName:e._options.label,displayType:e._options.type,libraryId:d};f.push(t)}),c.data.items=f,e.dataTransfer&&e.dataTransfer.setData&&e.dataTransfer.setData("text/plain",JSON.stringify(c))}},cleanDragData:function(){r.isNatifEnvironnement()&&!r.isWebInWinEnvironment()&&a.publish("cleanDragData")},shouldAcceptDrop:function(){return!1},performDropOnLibraryEditorNode:function(e,n,r){var a=null;try{a=this.retrieveDroppedDataFromDropEvent(n)}catch(e){a=null,t.displayNotification({message:i.msg_warning_dndnotsupported,className:"warning"})}a&&e&&this.processDroppedDataOnLibraryEditorNode(e,a,r)},retrieveDroppedDataFromDropEvent:function(e){for(var t,i=UWA.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",n="",r=["text/searchitems","text/plain","Text"],a=0;a<r.length&&""===n;a++){var o=e.dataTransfer.types[i](r[a]);(UWA.is(o,"number")&&o>=0||UWA.is(o,"boolean")&&!0===o)&&(n=r[a])}if(""===n)throw new Error("Unknown type in DnD");return t=e.dataTransfer.getData(n),JSON.parse(t)},processDroppedDataOnLibraryEditorNode:function(e,r,a){function o(e){if(Array.isArray(e)&&e.length>0)for(var t=n.getPlatformId(),i=e.length-1;i>=0;i--){var r=e[i];if(r&&r.droppedItem_tenantId!==t)return!1}return!0}if(r&&e){var s=this.isExternalDroppedDataOnLibraryEditor(r),l=a.getDroppedData(r),d=l.RootLibrary_itemList,c=l.Library_itemList,u=l.Content_itemList;if(!o(d)||!o(c)||!o(u))return void t.displayNotification({message:i.msg_warning_dndnotsupported_from_different_tenant,className:"warning"});if(a.inFamilyLibrary(e.plmType)){if(Array.isArray(c)&&c.length>0)for(;c.length>0&&c[0];){for(var h=c[0].droppedSourceLibrary_id,f=[],g=c.length-1;g>=0;g--){(p=c[g])?p.droppedSourceLibrary_id===h&&(f.push(p.droppedItem_id),c.splice(g,1)):c.splice(g,1)}a.addClassesInLibrary(e,h,f,s,!1)}if(Array.isArray(u)&&u.length>0)for(;u.length>0&&u[0];){for(h=u[0].droppedSourceLibrary_id,f=[],g=u.length-1;g>=0;g--){var p;(p=u[g])?p.droppedSourceLibrary_id===h&&(f.push(p.droppedItem_id),u.splice(g,1)):u.splice(g,1)}a.addContentInObject(e,h,f,s)}}}else console.warn("  LibraryDnDService processDroppedDataOnLibraryEditorNode invalid argument(s)")},isExternalDroppedDataOnLibraryEditor:function(e){var t=!0;return e&&e.widgetId&&e.widgetId==this.getWidgetId()&&(t=!1),t},getWidgetId:function(){return self.widget.id}})}),define("DS/IPClassifyUX/models/LibraryInfo",["UWA/Controls/Abstract","UWA/Class/Options"],function(e,t){"use strict";var i=e.extend(t,{_id:null,_type:null,_label:null,init:function(e){this._parent(e),this._id=e.id,this._type=e.type,this._label=e.label,this._getChildrenInfos=e.getChildrenInfos},getID:function(){return this._id},getType:function(){return this._type},getLabel:function(){return this._label},getChildrenInfos:function(e){this._getChildrenInfos(this._id).then(function(t){var n=[];t.forEach(function(e){n.push(new i({id:e.getID(),type:e.plmType,label:e.getLabel()}))}),e.onComplete(n)})}});return i}),define("DS/IPClassifyUX/utils/IPClassifyWidgetData",["UWA/Class"],function(e){"use strict";return e.singleton({init:function(e){this._widgetData={currentTab:0,showTreeView:!0,currentWidgetTab:0,isEditMode:!1,isReadOnly:!1}},getWidgetData:function(){return this._widgetData},setCurrentTab:function(e){this._widgetData.currentTab=e||0},setReadOnly:function(e){this._widgetData.isReadOnly=e},getCurrentWidgetTab:function(){return this._widgetData.currentWidgetTab},setCurrentWidgetTab:function(e,t){e?(this._widgetData.currentWidgetTab=e,this._widgetData.showTreeView=t):(this._widgetData.currentWidgetTab=0,this._widgetData.showTreeView=t)},getIsEditModeEnabled:function(){return this._widgetData.isEditMode},setIsEditModeEnabled:function(e){this._widgetData.isEditMode=e}})}),define("DS/IPClassifyUX/utils/LoadCssUtil",["UWA/Class"],function(e){"use strict";return e.singleton({init:function(e){},_loadCSS:function(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.head.appendChild(t)}})}),define("DS/IPClassifyUX/service/SettingsManagement",["UWA/Class"],function(e){"use strict";return e.singleton({init:function(){this.isPlatformInitialized=!0},addSetting:function(e,t){if(!this.isPlatformInitialized)throw new Error("Platformservices not initialized");widget[e]&&console.log("Setting is already in use"),widget[e]=t},getSetting:function(e){return widget[e]||""},getPlatformURLs:function(){return this.getSetting("platformServices")}})}),define("DS/IPClassifyUX/views/LibraryThumbnailGridView",["DS/IPClassifyNav/views/xNavResponsiveThumbnailsView","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],function(e,t,i){"use strict";return e.extend({init:function(e){this._parent(e),this.options.grid.infiniteScrolling=!0;var i=this;UWA.is(this.options.grid.onCellDoubleClick,"function")&&this.options.grid.onCellDoubleClick(function(e){var i=e.nodeModel;t.notifyActivateTreeItem({resourceid:i.options.resourceid,mxid:i.options.mxid,type:i.options.type,label:i.options.label})}),this.options.grid.onInfiniteScroll(function(e){e.reachBottom?t.notifyScrollEnd():e.reachRight&&i.options.grid.infiniteScrollProcessDone()}),this.options.grid.getCustomTooltip=(e=>{let t=["ds6w:label","ds6wg:revision","ds6w:type","ds6w:status","ds6w:description","ds6w:responsible","ds6w:modified","ds6w:created","ds6w:identifier"],i=this.options.dataprovider.getAdditionalTooltipAttribute?this.options.dataprovider.getAdditionalTooltipAttribute():null,n="";if(i)for(let e of i)t.splice(e.order-1,0,e.label);for(let i of t)n+=this.showTooltip(i,e);return n})},showTooltip:(e,t)=>t.options.grid[e]?i.ViewTooltip[e]+":"+t.options.grid[e]+"\n":"",showTooltipDate:(e,t)=>{if(t.options.grid[e]){let r=new Date(Date.parse(t.options.grid[e])),a=r.toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/,"$1$3");var n=r.toLocaleString("default",{month:"short"})+" "+r.getUTCDate()+","+r.getUTCFullYear()+", "+a;return i.ViewTooltip[e]+":"+n+"\n"}return""}})}),define("DS/IPClassifyUX/views/LibraryDataGridView",["DS/IPClassifyNav/views/xNavDataGridView","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/Configuration","DS/PADServices/utils/GlobalUtils","DS/PADUtils/PADCommandProxy","DS/PADServices/utils/AttributesMgtV2","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUtil/IPClassifyPreference","UWA/Controls/Abstract","DS/Core/PointerEvents","DS/ApplicationFrame/CommandsManager"],function(e,t,i,n,r,a,o,s,l,d,c,u,h,f){"use strict";var g={GRIDVIEWID:"ipcGridViewID_v1"},p=u.extend({name:"LibraryDataGridView",init:function(e){this._parent(e),this.onContextualMenuReady=e.context.onContextualMenuReady,this.gridPlaceHolder=e.context.getPlaceHolder(),this.dataProvider=e.context.dataProvider},initialize:function(){var e=this;return new Promise(function(r){var o=UWA.clone(a.getConfig("dgvOptions"));e.options.viewMode=o.viewMode,e.options.clickEvent=null;var l=e.fetchGridViewID(),c=[e.buildDGVOpts(),l];Promise.all(c).then(function(a){var l=a[0],c=a[1],u=UWA.extend({identifier:"DataGridView-"+e.name+"-"+c},l);if("undefined"!==o.dgvLayout){var g=UWA.clone(o.dgvLayout);void 0!==l.defaultCellHeight&&(g.cellHeight=l.defaultCellHeight,delete l.defaultCellHeight),void 0!==l.rowsHeader&&(g.rowsHeader=l.rowsHeader,delete l.rowsHeader),u.layout=e.options.dgvLayout=new i(g),u.layout.useLastColumnWidthAutoFlag=!0}u.onContextualEvent=e.onContextualMenuReady,u.getCellTooltip=e._provideDisplayTooltip.bind(e),u.columnDragEnabledFlag=!1,u.placeholder=e.gridPlaceHolder,u.defaultColumnDef.allowUnsafeHTMLContent=!1,e.options.dataGridPlaceHolder=u.placeholder,e.options.viewMode=l.viewMode?l.viewMode:"comfortable",u.showModelChangesFlag=!(!o.dgv||!o.dgv.showModelChangesFlag)&&o.dgv.showModelChangesFlag;var p=e.options.dgv=new t(u);if(e.options.additionalColumnsModules)for(var _=0;_<e.options.additionalColumnsModules.length;_++)if(e.options.additionalColumnsModules[_].getTypeRepresentations){var b=e.options.additionalColumnsModules[_].getTypeRepresentations();p.getTypeRepresentationFactory().registerTypeRepresentations(JSON.stringify(b))}if(["ctrl+a","alt+return","ctrl+f","f2"].forEach(function(e){p._keymapManager.registerKeymap(e,void 0)}),p.addEventListener(h.POINTERHIT,function(t,i){if(1===t.multipleHitCount){var r,a=e.getManager();if(a&&a._preselectedCellStableID&&a._preselectedCellStableID.columnDataIndex){switch(a._preselectedCellStableID.columnDataIndex){case"ds6w:status":r=f.getCommand("MaturityState")||f.getCommand("MaturityHdr")}r&&r.isEnabled()&&r.begin()}}if(2===t.multipleHitCount){var o=p.layout.getColumnIndex("tree");if(i&&i.columnID==o&&i.nodeModel&&i.nodeModel.isFavorite){var s=p.layout.getCellsFromNodeModel(i.nodeModel)[o],l=p.getEditionManager(s);l.onEscape&&l.onEscape(s)}if(i&&i.nodeModel){var d=i.nodeModel;n.notifyActivateTreeItem({resourceid:d.options.physicalid,mxid:d.options.mxid,type:d.plmType,label:d.options.label})}}}),p._modelEvents.subscribe({event:"READY"},function(){n.notifyContentReady(),e.setSortingForComputedAttrs()}),p.addEventListener("sortModelChange",function(){n.notifyColumnSortChange()}),p.onDelayedModelDataRequest){var m=p.onDelayedModelDataRequest;p.onDelayedModelDataRequest=function(t){e.dataProvider.updateAttributesDelayedForUnits&&e.dataProvider.updateAttributesDelayedForUnits(t,e.getManager()),m(t)}}p.onInfiniteScroll(function(e){e.reachBottom?n.notifyScrollEnd():e.reachRight&&p.infiniteScrollProcessDone()}),e._commandProxy=s.create(),p.getContent().addClassName(e.name),e.options.renderTo&&!0===e.options.isActiveView&&p.inject(e.options.renderTo),d.getModelEvents().subscribe({event:"IPClassifyColumnCusto/AttributesCustomization/columnModification"},function(t){switch(t.what){case"addRemoveColumns":t.removedColumns&&e.removeColumn(t.removedColumns),t.addedColumns&&e.addColumn(UWA.clone(t.addedColumns));break;case"reset":e.resetColumn()}}),r()})})},fetchGridViewID:function(){return new Promise(function(e){widget&&widget.id?e(widget.id):c.get(g.GRIDVIEWID,function(t){if(t&&t.GridViewID)e(t.GridViewID);else{var i=o.uid();c.set(g.GRIDVIEWID,{GridViewID:i},!1),e(i)}},!1)})},_provideDisplayTooltip:function(e){if(e&&e.rowID<0&&this.dataProvider.getTooltipIfDynamicColumn){var t=this.options.dgv.getColumnOrGroup(e.columnID),i=this.dataProvider.getTooltipIfDynamicColumn(e,t);if(i)return{longHelp:i}}return this.options.dgv.getCellDefaultTooltip(e)},getManager:function(){return this.options.dgv},addColumn:function(e){this.dataProvider.onAddColumn&&this.dataProvider.onAddColumn(e),n.notifyCurrentLibraryColumnChange()},removeColumn:function(e){this.dataProvider.onRemoveColumn&&this.dataProvider.onRemoveColumn(e)},resetColumn:function(e){this.dataProvider.onResetColumn&&this.dataProvider.onResetColumn(l.getAvailableColumnsOpts(),l.getTreeColumn()),n.notifyCurrentLibraryColumnChange()},getDefaultSortModel:function(){var e=this.getManager(),t=[];if(e)for(var i=e.layout.getLeafColumns(),n=0;n<i.length;++n){var r=i[n];r.defaultSortOrder&&(t=[{dataIndex:r.dataIndex,sort:r.defaultSortOrder}])}return t},getSortingOrder:function(e){var t={},i=this.getManager(),n=this.getDefaultSortModel(),r=null,a=null;if(n.length>0&&(r=n[0].dataIndex,a=n[0].sort),i){var o=i.sortModel,s=r,l=a;o&&o.length>0&&null!=o[0].dataIndex&&null!=o[0].dataIndex?(s=o[0].dataIndex,l=o[0].sort):this._setColumnOrderState(s,l),t.order_by=l;var d=i.layout.getLeafColumns()[i.layout.getColumnIndex(s)];d?d.isHidden?this._setColumnOrderState(r,a):(d.dataIndex&&(t.order_field=d.dataIndex,"tree"===d.dataIndex&&(t.order_field=d.ds6w)),e&&d.dbAttribute&&(t.order_field=d.dbAttribute)):r&&(this._setColumnOrderState(r,a),t.order_by=a,t.order_field=r)}return t},setSortingForComputedAttrs:function(){for(var e=r.isIndexedMode(),t=["tree","ds6w:description"],i=!!e,n=0;n<t.length;++n)this._setColumnSortable(t[n],i);var a,o=[];if(this.dataProvider.getAuthModeNoSortColumns&&(o=this.dataProvider.getAuthModeNoSortColumns(this.getManager().layout.getLeafColumns())),!1===e){var s=this.getSortingOrder(!0).order_field;if("ds6w:label"===(a=s)||"tree"===a||"ds6w:description"===a||-1!==o.indexOf(s)){var l=this.getDefaultSortModel();l.length>0&&this._setColumnOrderState(l[0].dataIndex,l[0].sort)}}var d=this,c=["thumbnail"];o.forEach(function(e){c&&-1!==c.indexOf(e)||d._setColumnSortable(e,i)})},_setColumnSortable:function(e,t){var i=this.getManager(),n=i.layout.getColumnIndex(e);if(!(n<0||null==n)){var r=i.layout.getLeafColumns();r[n].sortableFlag!==t&&(r[n].sortableFlag=t)}},setTreeColumnEditable:function(e){var t=this.getManager(),i=t.layout.getColumnIndex("tree");if(!(i<0)){var n=t.layout.getLeafColumns();n[i].editableFlag!==e&&(n[i].editableFlag=e)}},_setColumnOrderState:function(e,t){var i=this.getManager();i.sortModel=[{dataIndex:e,sort:t}],i.layout._saveColumnSortModelInPreferences()},setColumnOrderState:function(e){var t=this.getManager();t.sortModel=e,t.layout._saveColumnSortModelInPreferences()},getDatagridPlaceHolder:function(){return this.options.dataGridPlaceHolder},removeColumnPreferences:function(e){if(e&&0!==e.length){var t=this.getManager(),i=t.layout._getUnpinnedColumnsOrderInPreferences();if(i){for(var n=0;n<e.length;++n)delete i[e[n]];t.layout._saveDataInPreferences("unpinnedColumnsOrder",i)}}},isColumnAvailable:function(e){return this.getManager().layout.getColumnVisibleState(e)}}),_=p.prototype.initialize;return p.prototype=Object.assign(p.prototype,e.prototype),p.prototype.initialize=_,p}),define("DS/IPClassifyUX/views/LibraryTileGridView",["DS/IPClassifyNav/views/xNavResponsiveTilesView","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],function(e,t,i){"use strict";return e.extend({init:function(e){this._parent(e),this.options.grid.infiniteScrolling=!0;var i=this;UWA.is(this.options.grid.onCellDoubleClick,"function")&&this.options.grid.onCellDoubleClick(function(e){var i=e.nodeModel;t.notifyActivateTreeItem({resourceid:i.options.resourceid,mxid:i.options.mxid,type:i.options.type,label:i.options.label})}),this.options.grid.onInfiniteScroll(function(e){e.reachBottom?t.notifyScrollEnd():e.reachRight&&i.options.grid.infiniteScrollProcessDone()}),this.options.grid.getCustomTooltip=(e=>{let t=["ds6w:label","ds6wg:revision","ds6w:type","ds6w:status","ds6w:description","ds6w:responsible","ds6w:modified","ds6w:created","ds6w:identifier"],i=this.options.dataprovider.getAdditionalTooltipAttribute?this.options.dataprovider.getAdditionalTooltipAttribute():null,n="";if(i)for(let e of i)t.splice(e.order-1,0,e.label);for(let i of t)n+=this.showTooltip(i,e);return n})},showTooltip:(e,t)=>t.options.grid[e]?i.ViewTooltip[e]+":"+t.options.grid[e]+"\n":"",showTooltipDate:(e,t)=>{if(t.options.grid[e]){let r=new Date(Date.parse(t.options.grid[e])),a=r.toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/,"$1$3");var n=r.toLocaleString("default",{month:"short"})+" "+r.getUTCDate()+","+r.getUTCFullYear()+", "+a;return i.ViewTooltip[e]+":"+n+"\n"}return""}})}),define("DS/IPClassifyUX/models/LibrarySearchModel",["UWA/Class","DS/IPClassifyUX/events/IPClassifyEvents"],function(e,t){"use strict";return e.singleton({init:function(){this._currentSearch=null,this._indexInfo=null,this._lListener=[]},onSearchChange:function(e){"function"==typeof e&&this._lListener.push(e)},onClearListener:function(){this._lListener=[]},_notifyChange:function(e){if(this.isSearchActive()||e){var i=this;e||(e=i._currentSearch),this._lListener.forEach(function(e){e.call(null,i._currentSearch)}),t.notifyContentSearchChange()}},changeSearch:function(e,t){if(""===e&&(e=null),this._currentSearch!==e||!e){this.setInfoIndex(null,!e);var i=this._currentSearch;this._currentSearch=e,this._notifyChange(i)}},clearSearch:function(){this.changeSearch("",!0)},setInfoIndex:function(e,i){if(this._indexInfo=e,!1!==i){var n=null;e&&((n={}).numberHits=this.getNumberHits(),n.dateIndex=this.getDateLastIndexation()),t.notifyContentSearchResult(n)}},getInfoIndex:function(){return this._indexInfo},getNumberLastResult:function(){return this._indexInfo?this._indexInfo.nresults:0},getNumberHits:function(){return this._indexInfo?this._indexInfo.nhits:0},getDateLastIndexation:function(){var e=null,t=this.getInfoIndex();if(t&&t.sources){var i=null;t.sources.forEach(function(e){if(e.indexingDate)var t=e.indexingDate;for(var n in t)t[n]&&-1!==t[n]&&(i?t[n]<i&&(i=t[n]):i=t[n])}),i&&(e=new Date(1e3*i))}return e},isSearchActive:function(){return!!this.getSearchValue()},isSearchInProgress:function(){return this._indexInfo&&this._currentSearch},getSearchValue:function(){return this._currentSearch}})}),define("DS/IPClassifyUX/utils/IPClassifyModeManager",["UWA/Utils","UWA/Core","UWA/Class","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/PADSession","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],function(e,t,i,n,r,a,o,s){"use strict";var l=null,d=i.singleton({init:function(e){this._parent(e),this.modeInformation={last_refreshed:(new Date).getTime()}},isModeSwitcherEnabled:function(){return this.modeSwitcherEnabled},determineAuthoringMode:function(){return a.determineAuthoringMode()},_isUsingIndex:function(){return"index"===this.determineAuthoringMode()},_getWaitingTimeBeforeSwitchToIndexMode:function(){return parseInt(widget.getValue("intervalToSwitchMode"))},determineCurrentModeState:function(){var e=this.determineAuthoringMode();const t=this._getWaitingTimeBeforeSwitchToIndexMode();return"authoring"!==e||widget.getValue("useIndexAccleration")?"authoring"!==e||t||(e="neverIndexMode"):e="useOnlyAuthoring",e},getFullViewLoadInfo:function(){return this.modeInformation},setAuthoringMode:function(e,t,i,a){var c=this,u=this._getWaitingTimeBeforeSwitchToIndexMode(),h=u||.02;if(i){const e=widget.getValue("IPClassify_ModeInfo")||{};if(e&&UWA.is(e.last_editing,"number")){const t=(new Date).getTime();var f=(e.last_editing+1e3*u-t)/1e3;f>0&&(h=f)}}else{if(t)if(this._isUsingIndex()&&"authoring"===e&&(u||0===u))if("none"===t)n.displayNotification({title:s.get("msg_database_mode_activated"),subtitle:s.get("msg_database_mode_activated_details")+" "+s.get("msg_tagger_not_available"),className:"info"});else{var g=s.get("msg_database_mode_activated")+"<br>"+s.get("msg_database_mode_activated_details")+" "+s.get("msg_tagger_not_available");n.displayNotification({title:t,subtitle:g,className:"success"})}else"none"!==t&&n.displayNotification({message:t,className:"success"});var p={state:e,last_editing:(new Date).getTime()};widget.setValue("IPClassify_ModeInfo",p),r.notifyModeChange({switchMode:e}),a||("authoring"===e?(c.updateTaggerAndComputeColumns(!1),o.setAuthoringState(!0)):(c.updateTaggerAndComputeColumns(!0),o.setAuthoringState(!1)))}l&&(clearTimeout(l),l=null);var _=c.determineCurrentModeState();"authoring"===e&&u&&"useOnlyAuthoring"!==_&&(l=setTimeout(function(){n.displayNotification({title:s.get("msg_index_mode_activated"),subtitle:s.get("msg_index_mode_activated_details"),className:"info"}),r.notifyModeChange({switchMode:"index"}),c.updateTaggerAndComputeColumns(!0),o.setAuthoringState(!1),c.updateRefreshTime(),d.refreshViewOfWidget(),l=null},1e3*h))},updateRefreshTime:function(){var e={modeInformation:{last_refreshed:(new Date).getTime()}};r.notifyupdateRefreshTime(e)},updateLastIndexTime:function(e){e&&e.sources&&(this._lastIndexedData=e)},getLastIndexedTime:function(){if(this._lastIndexedData){var e=this.extractLastIndexation(this._lastIndexedData);if(e&&null!=e)return this._previousIndexTime=e,e}return this._previousIndexTime||s.text_not_available},extractLastIndexation:function(e){var t=null;if(e&&e.sources){var i=null;if(e.sources.forEach(function(e){if(e.indexingDate)var t=e.indexingDate;for(var n in t)t[n]&&-1!==t[n]&&(i?t[n]<i&&(i=t[n]):i=t[n])}),i){var n=new Date(1e3*i),r="";if(n){var a=new Date;r=(a-n)/1e3/3600>24||n.getDay()!=a.getDay()?n.toLocaleString():n.toLocaleTimeString()}t=r}}return t},addModeIntervalPreferences:function(e){var t=this;t.modeSwitcherEnabled=!0,t.refreshViewOfWidget=e.refreshView,t.updateTaggerAndComputeColumns=e.updateTaggerAndComputeColumns,widget.addPreference({name:"useIndexAccleration",defaultValue:!0,type:"boolean",label:"useIndexAccleration_label",onchange:"onUseOnlyDBChange"}),widget.addEvent("onUseOnlyDBChange",t.onUseOnlyDBChange.bind(t)),t.setIntervalSwitch(),widget.addEvent("endEdit",function(e){if(!(!e||!e.submitted&&!e.needRefresh)){var i=widget.getValue("useIndexAccleration")?"index":"authoring";t.setAuthoringMode(i,!1,!1,!0)}t.setIntervalSwitch()})},setIntervalSwitch:function(e){var t={name:"intervalToSwitchMode",defaultValue:"180",type:"list",label:"label_interval_to_switch_mode",options:[{label:"label_back2index_time_never",value:"0"},{label:"label_back2index_time_one_min",value:"60"},{label:"label_back2index_time_three_mins",value:"180"},{label:"label_back2index_time_five_mins",value:"300"},{label:"label_back2index_time_ten_min",value:"600"}]};e||widget.getValue("useIndexAccleration")||(t.disabled="true"),widget.addPreference(t)},onUseOnlyDBChange:function(e,t){this.setIntervalSwitch(t),widget.dispatchEvent("onEdit")}});return d}),define("DS/IPClassifyUX/views/LibraryTreeDocumentView",["DS/Logger/Logger","DS/IPClassifyNav/models/xNavDocument","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/PADUtils/PADProbes","DS/PADUtils/PADUtilsServices","DS/WebappsUtils/WebappsUtils","DS/WidgetServices/WidgetServices","DS/PADUtils/PADContext","DS/PADUtils/PADPredicatesNls"],function(e,t,i,n,r,a,o,s,l,d){"use strict";var c=t.extend({name:"LibraryTreeDocumentView",_doNotAddLibrary:!1,init:function(t){t.authorize_setStructure=!0,this._parent(t),this.onNodeModelUpdate(widget.TreeDocumentDataProvider.onContentUpdate),this._logger=e.getLogger(c),this._logger.log("init");var i=this;this.selection_broadcast_fn=function(){if(!i._doNotAddLibrary){var e=i.getXSO().get();if(e&&e.length>0){var t=e[0];t.getID||(t.getID=function(){return this.id}),t.getType||(t.getType=function(){return this.plmType})}widget.TreeDocumentCSOProvider&&widget.TreeDocumentCSOProvider.addInCSO(e,"CONTENT")}},this.getXSO().onChange(i.selection_broadcast_fn),this.getXSO().onEmpty(function(){i._doNotAddLibrary=!1,i.selection_broadcast_fn()}),this.getXSO().onPreEmpty(function(){i._doNotAddLibrary=!0})},_buildSelectData:function(){var e=this._parent();if(e){var t=widget.TreeDocumentCSOProvider.getCurrentObject();if(Array.isArray(e.paths)&&e.paths.length>=1){if(t&&widget.TreeDocumentDataProvider.isValidType(t.plmType)){for(var i=widget.TreeDocumentCSOProvider.getCurrentObjectPath(),n=[],r=Array.isArray(i)?i.length:0,a=0;a<r;a++)n.push({resourceid:i[a].id,type:i[a].type});e.libraryPath=n}}else if(t&&widget.TreeDocumentDataProvider.isValidType(t.plmType)){i=widget.TreeDocumentCSOProvider.getCurrentObjectPath();var o=[];for(r=Array.isArray(i)?i.length:0,a=0;a<r-1;a++)o.push({resourceid:i[a].id,type:i[a].type});var s={};if(r>=1){var l=r-1;i[l].id&&(s[i[l].id]={type:i[l].type,label:i[l].label})}e.paths=[[t.id]],e.attributes=s,e.libraryPath=o}}return e},withBroadcastSelect:function(e){this.prepareBroadcastSelect(),e(),this.pushBroadcastSelect()},prepareBroadcastSelect:function(){this._doNotAddLibrary=!0,this._parent()},pushBroadcastSelect:function(){this._doNotAddLibrary=!1,this.selection_broadcast_fn(),this._parent()},keepExpandedState:function(){for(var e=this.getRoots(),t=0;t<e.length;t++)if(e[t].isExpanded()){libraryContent._refreshProductStructure=!0;break}},refreshNodeById:function(e){var t=this,r=n.isModeSwitcherEnabled();if((!r||widget.id!==e.widgetId)&&i.isIndexedMode())return;var a=e.modified;e.modified=[];var o=e.fromRenameOp;if(a.length>0){var s=l.get(),c=s.options.views?s.options.views.datagridview:null,u=c?c.options.dgvLayout.getLeafColumns():null;widget.TreeDocumentDataProvider&&widget.TreeDocumentDataProvider.getObjectsForRefresh&&u&&widget.TreeDocumentDataProvider.getObjectsForRefresh(a,u).then(function(a){a&&a.length>0&&(r&&!o&&widget.id===e.widgetId&&i.isIndexedMode()&&(widget.TreeDocumentDataProvider.canSwitchToAuthoringOnEdit?widget.TreeDocumentDataProvider.canSwitchToAuthoringOnEdit()&&(n.setAuthoringMode("authoring","none"),n.updateRefreshTime()):(n.setAuthoringMode("authoring","none"),n.updateRefreshTime())),a.forEach(function(e){var i=t.searchRootById(e.physicalid);i&&(t.wrapInTransaction(function(){i.updateOptions(e)}),!0===i.options._manageNLS&&d.updateNLS(i))}))})}this._parent(e)}});return c}),define("DS/IPClassifyUX/models/LibraryBreadcrumbModel",["UWA/Class","DS/IPClassifyUX/models/LibraryInfo"],function(e,t){"use strict";var i=e.singleton({_currentPathNodes:null,getNewPathNodes:function(e){this._currentPathNodes=[];var i=e.CSOProvider.getCurrentObjectPath();if(i&&i.length>0)for(var n=i.length-1;n>=0;--n){var r=i[n];this._currentPathNodes.push(new t({id:r.id,mxid:r.mxid,type:r.type,label:r.label,getChildrenInfos:e.getChildrenInfos}))}return this._currentPathNodes},getPathNodes:function(){return this._currentPathNodes}});return{getNewPathNodes:i.getNewPathNodes.bind(i),getPathNodes:i.getPathNodes.bind(i)}}),define("DS/IPClassifyUX/views/LibrarySearchInContext",["UWA/Core","UWA/Controls/Abstract","DS/UIKIT/Autocomplete","DS/IPClassifyUX/models/LibrarySearchModel","DS/UIKIT/Tooltip","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/SNResultUX/assets/nls/SNResultUX","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],function(e,t,i,n,r,a,o,s,l){"use strict";var d=13,c=38,u=40,h=function(){if(!e.is(localStorage.LibSearchBoxStore)){localStorage.LibSearchBoxStore=JSON.stringify([])}return{insertSuggestion:function(t){if(null!=t&&null!=t&&""!=t&&e.is(localStorage.LibSearchBoxStore)){var i=JSON.parse(localStorage.LibSearchBoxStore);if(-1===i.indexOf(t))i.length>=100&&i.shift(),i.push(t),localStorage.LibSearchBoxStore=JSON.stringify(i);else if(i.indexOf(t)>-1){var n=i.indexOf(t),r=i[n];i.splice(n,1),i.push(r),localStorage.LibSearchBoxStore=JSON.stringify(i)}}},getSuggestions:function(t,i){var n=[];if(e.is(localStorage.LibSearchBoxStore))for(var r=JSON.parse(localStorage.LibSearchBoxStore),o=r.length-1;o>=0&&n.length!=i;--o){var s=r[o];if(null!=s&&null!=s&&""!=s&&s.toLowerCase().startsWith(t.toLowerCase())){var l={};l.label=s,l.value=s,l.id=a.stringEncode(s),n.push(l)}}return n}}}();return t.extend({switchSearch:function(e){e?this._showSearchInput():this._hideSearchInput(!0)},_hideSearchInput:function(e){e&&this.getValue()&&this.clearValue(),this.getValue()||(this.elements.inputHolder.show(),this.elements.input.hide(),this.dispatchEvent("onSearchSwitch",!1))},_showSearchInput:function(){this.elements.input.show(),this.elements.inputHolder.hide(),this.dispatchEvent("onSearchSwitch",!0)},init:function(e){var t=this;this._parent(e),this._placeholder=null;var a=document.querySelectorAll(".searchInContext_container");if(a&&a.length>0){var f=Array.prototype.slice.call(a);f&&f.forEach(function(e){e.remove()})}this.elements.container=UWA.createElement("div",{class:"searchInContext_container"}),this.elements.inputHolder=new UWA.createElement("div",{class:"searchInContext_holder fonticon-2x fonticon fonticon-search",attributes:{title:l.get("searchInLibrary_search")},events:{click:function(){t._showSearchInput()}}}).inject(this.elements.container),new r({position:"left",target:this.elements.inputHolder}),this.elements.input=new i({multiSelect:!1,className:"ipc-searchwithin",showSuggestsOnFocus:!1,placeholder:"Search In Context",disabled:!1,allowFreeInput:!0,minLengthBeforeSearch:3,maxSuggestsToDisplay:4,noResultsMessage:null,events:{onSelect:function(e,i){this.resetCache(),h.insertSuggestion(e.value),t._launchSearch(e.value)},onKeyDown:function(e){this.resetCache();var i=e.which;e.ODTENVKeyName&&(i=e.ODTENVKeyName),i===d?(this._updateKeyboardIndex("reset"),this.dispatchEvent("onHideSuggests"),this.elements.input.value&&1==this.elements.input.value.trim().length?o.displayNotification({message:s.warning_twochars,className:"error"}):(h.insertSuggestion(this.elements.input.value),t._launchSearch(this.elements.input.value))):i===c?(this._updateKeyboardIndex("up"),this.elements.input.value=this._getActiveItem().value,this._updateKeyboardIndex("down")):i===u&&(this._updateKeyboardIndex("down"),this.elements.input.value=this._getActiveItem().value,this._updateKeyboardIndex("up"))},onClickOutside:function(e){null!=this.elements.input.value&&null!=this.elements.input.value&&""!==this.elements.input.value||(t._changePlaceholder(t._placeholder),t._launchSearch("")),this.resetCache(),t._hideSearchInput()}},datasets:{configuration:{searchEngine:function(e,i){return i?h.getSuggestions(i,this.options.maxSuggestsToDisplay):(t._launchSearch(""),[])}}}}).inject(this.elements.container),n.onSearchChange(function(e){t.elements.input.elements.input.value=e,h.insertSuggestion(e),t._showSearchInput()}),widget&&(widget.addEvent("onSearch",function(e){n.changeSearch(e,!0)}),widget.addEvent("onResetSearch",function(){n.clearSearch(),t._hideSearchInput()}))},changeLibraryPlaceholder:function(e){var t=l.replace(l.SearchInLibrary,{libraryName:e});this._changePlaceholder(t),this._placeholder=t},_changePlaceholder:function(e){this.elements.input.elements.input&&(this.elements.input.elements.input.setAttribute("placeholder",e),this.elements.input.elements.input.setAttribute("title",e))},_launchSearch:function(e){e=e.trim(),n.changeSearch(e,!0)},getValue:function(){return this.elements.input.elements.input.value},clearValue:function(){n.clearSearch()}})}),define("DS/IPClassifyUX/models/LibraryTreeModel",["UWA/Class","DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/IPClassifyUtil/IPClassifyUtility","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUtil/IPClassifyAlert"],function(e,t,i,n,r,a){"use strict";var o,s,l,d,c,u,h=(o={},{toFetchDataFromCache:function(e){var t=o[e];return null!=t},clean:function(){o={}},children:function(e){var t=o[e];if(t){var i=[];for(var n in t)t.hasOwnProperty(n)&&i.push(t[n]);t=i}return o[e]=null,t},updateCache:function(e,t,i){if(e&&t&&!(e.length<=0)){for(var n=[],r=0;r<e.length;++r)for(var a=e[r],s=1;s<a.length;++s){var l=a[s-1],d=t[a[s]],c=a[s];o[l]?o[l][c]=d:(o[l]={},o[l][c]=d),s===a.length-1&&-1===i&&n.push(a[s])}-1===i&&(i=n);for(var u=0;u<i.length;++u){var h=i[u];o[h]||(o[h]={})}}}}),f={TREE_SELECTED_NODE:"ipcTreeSelectedNode_v1",TREE_STRUCTURE:"ipcTreeStrucure_v1",getTreeSelectedNode:function(){return n.getTenantAwarePreferenceName(this.TREE_SELECTED_NODE)},getTreeStructure:function(){return n.getTenantAwarePreferenceName(this.TREE_STRUCTURE)}},g=(s=function(){return{e:!0,c:{}}},l=function(e){return e||(e={root:s()}),e},d={_items:[],_isProcessing:!1,OPERATIONS:{ADD:"add",REMOVE:"remove"},_process:function(){var e=this;if(0!=this._items.length){var t=this._items[0];this._items.shift(),t.operation==e.OPERATIONS.ADD?c(t.pathId,t.childIds,function(){e._process()}):t.operation==e.OPERATIONS.REMOVE&&u(t.pathId,function(){e._process()})}else this._isProcessing=!1},add:function(e){this._items.push(e),0==this._isProcessing&&(this._isProcessing=!0,this._process())}},c=function(e,i,n){t.get(f.getTreeStructure(),function(r){var a=r=l(r),o=e.split(","),d=o.splice(o.length-1)[0];if(o.forEach(function(e){a[e]||(a[e]=s()),a=a[e].c}),a[d]||(a[d]=s()),a[d].e=!0,UWA.is(i,"array")){var c=a[d].c,u={};i.forEach(function(e){c[e]&&(u[e]=c[e])}),a[d].c=u}t.set(f.getTreeStructure(),r),n()})},u=function(e,i){t.get(f.getTreeStructure(),function(n){var r=n=l(n),a=e.split(","),o=a.splice(a.length-1)[0];a.forEach(function(e){r[e]||(r[e]=s()),r=r[e].c}),r[o]||(r[o]=s()),r[o].e=!1,0===r[o].c.length&&delete r[o],t.set(f.getTreeStructure(),n),i()})},{add:function(e,t){d.add({pathId:e,childIds:t,operation:d.OPERATIONS.ADD})},remove:function(e){d.add({pathId:e,operation:d.OPERATIONS.REMOVE})},addExpandAllPaths:function(e,i){i.length<=0||t.get(f.getTreeStructure(),function(n){var r=n=l(n),a=e.split(","),o=a.splice(a.length-1)[0];a.forEach(function(e){r[e]||(r[e]=s()),r=r[e].c}),r[o]=s();for(var d=0;d<i.length;++d)for(var c=r,u=i[d],h=1;h<u.length;++h){var g=u[h],p=u[h-1];c[p].c[g]||(c[p].c[g]=s()),c=c[p].c}t.set(f.getTreeStructure(),n)})},isExpanded:function(e,i){t.get(f.getTreeStructure(),function(t){var n=t=l(t),r=e.split(","),a=r.splice(r.length-1)[0];r.forEach(function(e){n[e]||(n[e]=s()),n=n[e].c});var o=!1;n[a]&&void 0!==n[a].e&&(o=n[a].e),i.call(window,o)})},select:function(e){var i={path:e};t.set(f.getTreeSelectedNode(),i)},isSelected:function(e,i,n){t.get(f.getTreeSelectedNode(),function(t){var r=!0;t&&(t=t.path),t||e!=="root,"+i?t!=e&&(r=!1):r=!0,n.call(window,r)})},getExpandedChildren:function(e,i){t.get(f.getTreeStructure(),function(t){var n=[],r=t=l(t),a=e.split(","),o=a.splice(a.length-1)[0];a.forEach(function(e){r[e]||(r[e]=s()),r=r[e].c});var d=[];d.push(r[o]);for(var c=0;c<d.length;++c){var u=d[c];if(u)for(var h in u.c)u.c.hasOwnProperty(h)&&!0===u.c[h].e&&(n.push(h),0!=Object.keys(u.c[h].c).length&&d.push(u.c[h]))}i.call(window,n)})},scrollAfterSelect:function(e){widget.setValue("scrollToNode",e)},doScrollAfterSelect:function(e){return widget.getValue("scrollToNode")===e}}),p=e.singleton({setExpandAllOperation:function(e){this._expandAllOp=!1,e&&!0===e&&(this._expandAllOp=!0)},_isOperationExpandAll:function(){return this._expandAllOp},fetchLibraryContents:function(e,t){var i=this;return new Promise(function(n,r){if(h.toFetchDataFromCache(e.parentNodeID)){var a=h.children(e.parentNodeID);n(a)}else h.clean(),i._isOperationExpandAll()?i._expand(e,null,t).then(function(e){n(e)},function(e){r(e)}):g.getExpandedChildren(e.parentPath,function(a){i._expand(e,a,t).then(function(e){n(e)},function(e){r(e)})})})},_expand:function(e,t,i){var n=this;return new Promise(function(r,a){i({pid:e.parentNodeID,mxid:e.parentNodeMXID,children:t,isExpandAll:n._isOperationExpandAll()}).then(function(i){i.paths&&i.paths.length<=0&&i.objects&&i.objects.length<=0?r([]):(n._isOperationExpandAll()&&(t=-1,g.addExpandAllPaths(e.parentPath,i.paths)),h.updateCache(i.paths,i.objects,t),i.childIds?(g.add(e.parentPath,i.childIds),r(i.objects)):r(h.children(e.parentNodeID)))},function(e){a(e)})})},fetchAllLibraries:function(e,t){var n=this;return new Promise(function(o,s){t().then(function(t){if(t&&t.infos&&(i.updateLastIndexTime(t.infos),t.infos.sources&&t.infos.sources.length>0&&t.infos.sources[0].error)){var s=t.infos.sources[0],l=s.error.errorMessage;console.error("Error with federated search: ["+s.error.errorCode+"] "+l),a.displayNotification({title:r.msg_error_with_federated_search_title,message:r.msg_error_with_federated_search_message,className:"error"})}n._isOperationExpandAll()&&g.add(e,t.ids),o(t.objects)},function(e){s(e)})})},getFavorites:function(e,i){function n(e){return e.id}t.get(e.getPreferenceSectionName(),function(r){r&&r.length>0?e.getPreferenceSectionContents({ids:r.map(n)}).then(function(n){var a=[],o=!1;n.length!==r.length&&(o=!0);for(var s=0;s<n.length;++s){for(var l=0;l<r.length;++l)r[l].id===n[s].physicalid&&(n[s].label=r[l].name);o&&a.push({id:n[s].physicalid,name:n[s].label})}if(o&&t.set(e.getPreferenceSectionName(),a,!1,!1),i.onComplete){var d=n,c=r.slice(),u=[];function h(e){for(var t=0;t<d.length;t++)d[t].physicalid===e&&d.splice(t,1)}for(var f=0;f<c.length;f++)n.forEach(function(e,t){e.physicalid===c[f].id&&(u.push(e),h(e.physicalid))});d.length>0&&d.forEach((e,t)=>{u.concat(e)}),i.onComplete(u)}},function(e){i.onFailure&&i.onFailure(e)}):i.onComplete&&i.onComplete([])},!1,!1)},setFavorites:function(e,i){function n(e){for(var t=0;t<this.length;++t)if(this[t].id==e.id)return!1;return!0}function r(e){return e.id}var a=Array.isArray(i.favoriteLibraries)?i.favoriteLibraries:[i.favoriteLibraries];t.get(e.getPreferenceSectionName(),function(o){if((o=Array.isArray(o)?o:[]).length>0){if(!0===i.renamed)for(var s=0;s<o.length;++s)for(var l=0;l<a.length;++l){o[s].id===a[l].id&&(o[s].name=a[l].name);break}a=a.filter(n,o)}o=o.concat(a),t.set(e.getPreferenceSectionName(),o,!1,!1),a.length>0?e.getPreferenceSectionContents({ids:a.map(r)}).then(function(e){i.onComplete&&i.onComplete(e)},function(e){i.onFailure&&i.onFailure(e)}):i.onComplete&&i.onComplete([])},!1,!1)},reorderFavoritePreference:function(e,i){var n=Array.isArray(i.favoriteLibraries)?i.favoriteLibraries:[i.favoriteLibraries];t.set(e.getPreferenceSectionName(),n,!1,!1),n.length>0?e.getPreferenceSectionContents({ids:n.map(function(e){return e.id})}).then(function(e){i.onComplete&&i.onComplete(e)},function(e){i.onFailure&&i.onFailure(e)}):i.onComplete&&i.onComplete([])},removeFromFavorites:function(e,i){function n(e){for(var t=0;t<this.length;++t)if(this[t]==e.id)return!1;return!0}var r,a=Array.isArray(i.favoritesToRemove)?i.favoritesToRemove:[i.favoritesToRemove];t.get(e.getPreferenceSectionName(),function(o){o.length>0&&(r=1!==o.length,o=o.filter(n,a)),t.set(e.getPreferenceSectionName(),o,!1,!1),i.onComplete&&i.onComplete(r)},!1,!1)},getLibraryPathLength:function(e,t){e({ids:[t.pid]}).then(function(e){t.onComplete&&t.onComplete(e)},function(e){t.onFailure&&t.onFailure(e)})},getLibraryPath:function(e,t){e({depth:t.depth,pid:t.pid}).then(function(e){t.onComplete&&t.onComplete(e)},function(e){t.onFailure&&t.onFailure(e)})},libraryStructurePreference:g});return{setExpandAllOperation:p.setExpandAllOperation.bind(p),fetchLibraryContents:p.fetchLibraryContents.bind(p),fetchAllLibraries:p.fetchAllLibraries.bind(p),getFavorites:p.getFavorites.bind(p),setFavorites:p.setFavorites.bind(p),removeFromFavorites:p.removeFromFavorites.bind(p),libraryStructurePreference:p.libraryStructurePreference,getLibraryPathLength:p.getLibraryPathLength.bind(p),getLibraryPath:p.getLibraryPath.bind(p),reorderFavoritePreference:p.reorderFavoritePreference.bind(p)}}),define("DS/IPClassifyUX/views/LibraryPathSeparator",["UWA/Controls/Abstract","UWA/Class/Options","DS/IPClassifyUX/events/IPClassifyEvents","DS/UIKIT/DropdownMenu","DS/IPClassifyUtil/IPClassifyAlert"],function(e,t,i,n,r){"use strict";return e.extend(t,{_dropDownCreated:!1,_dropdownElmt:null,_separator:null,_libraryInfo:null,_subLibraries:null,_activeIconFont:"",_unactiveIconFont:"",init:function(e){this._parent(e),this._libraryInfo=e.libraryInfo||null,this._activeIconFont=e.activeIconFont||"fonticon-down-dir",this._unactiveIconFont=e.unactiveIconFont||"fonticon-right-dir"},getSubLibrary:function(e){return null===this._subLibraries||e>=this._subLibraries.length?null:this._subLibraries[e]},addSubLibrary:function(e,t){null===this._subLibraries&&(this._subLibraries=[]),t?this._subLibraries.splice(0,0,e):this._subLibraries.push(e),this._dropDownCreated=!1},removeSubLibrary:function(e){if(null===this._subLibraries||e>=this._subLibraries.length)return!1;this._subLibraries.splice(e,1);return this._dropDownCreated=!1,this._dropdownElmt&&this._dropdownElmt.isVisible&&this._dropdownElmt.hide(),!0},hide:function(){this._dropdownElmt&&this._dropdownElmt.isVisible&&(this._dropdownElmt.hide(),this._dropDownCreated=!1),this._separator&&this._separator.hide()},show:function(){this._separator&&this._separator.show()},isVisible:function(){return"none"!==this._separator.getStyle("display")},buildPathSeparatorElement:function(){var e=this;return this._separator=UWA.createElement("div",{class:"separatorIdCard fonticon "+this._unactiveIconFont,styles:{cursor:"pointer"},events:{click:function(t){e._dropDownCreated||e._buildDropDownPath()}}}),this._separator},flush:function(){this._clearDropDown,this._dropDownCreated=!1,this._subLibraries=null},_clearDropDown:function(){this._dropdownElmt&&(this._dropdownElmt.destroy(),this._dropdownElmt=null)},_buildDropDownPath:function(){var e=this;if(null===this._subLibraries&&null===this._libraryInfo)return null;this._clearDropDown(),this._subLibraries?(e._dropDownCreated=!0,this._buildDomDropdownElmt(this._subLibraries)):this._libraryInfo.getChildrenInfos({onComplete:function(t){e._dropDownCreated=!0,e._buildDomDropdownElmt(t)},onFailure:function(t){e._dropDownCreated=!1,r.displayNotification({message:Nls.replace(Nls.get("msg_error_LibraryActivate"),{name1:name}),className:"error"})}})},_buildDomDropdownElmt:function(e){var t=this,r=[];e.length>0&&(e.forEach(function(e){r.push({text:e.getLabel(),title:e.getLabel(),handler:function(){i.notifyExpandTreeAndSelect({libraryToFindAndSelect:{id:e.getID(),type:e.getType(),name:e.getLabel()}})}})}),this._dropdownElmt=new n({target:this._separator,className:"library_ctx_menu",items:r,position:"bottom left",events:{onShow:function(){t._separator.removeClassName(t._unactiveIconFont),t._separator.addClassName(t._activeIconFont)},onHide:function(){t._separator.removeClassName(t._activeIconFont),t._separator.addClassName(t._unactiveIconFont)}}}),this._checkSizeOverflowDropdownMenu(),this._dropdownElmt.show())},resizeWidgetCallback:function(){this._dropdownElmt&&this._dropDownCreated&&(this._dropDownCreated=!1,this.isVisible()&&this._dropdownElmt.hide())},_checkSizeOverflowDropdownMenu:function(){var e,t,i,n,r,a,o,s,l,d,c;if(!this._dropdownElmt)return!1;a=this._dropdownElmt.elements.container,e=(o=this._dropdownElmt.options).target,i=document.documentElement.clientHeight||window.innerHeight,r=document.documentElement.clientWidth||window.innerWidth,a.isInjected()||(this._dropdownElmt.inject(o.renderTo?o.renderTo:document.body),a.setStyle("display","")),t=a.offsetHeight,n=a.offsetWidth,t>(s=i-(d=e.getOffsets().y+e.offsetHeight)-20>0?i-d-20:i-d)&&(a.setStyle("height",s),a.setStyle("overflow-y","auto"),n+=20,a.setStyle("width",n)),n>(l=r-(c=e.getOffsets().x+e.offsetWidth)-20>0?r-c-20:r-c)&&a.setStyle("width",l)}})}),define("DS/IPClassifyUX/views/LibraryPathNavigator",["UWA/Controls/Abstract","UWA/Class/Options","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/views/LibraryPathSeparator"],function(e,t,i,n){"use strict";return e.extend(t,{_ctxMenu:null,_ctxMenuWidth:4,_breadcrumb:null,_pathCont:null,init:function(e){this._parent(e),this._pathCont=e.pathCont,this.CSOProvider=e.CSOProvider,this._buildCtxMenu(),this._breadcrumb=UWA.createElement("div",{class:"containerPathIdCard"}).inject(this._pathCont),e.pathNodes&&e.pathNodes.length>0&&this._buildPathNavigator(e.pathNodes)},flush:function(){for(this._ctxMenu.hide();this._breadcrumb.firstChild;)this._breadcrumb.removeChild(this._breadcrumb.firstChild);this._ctxMenu.flush()},_buildPathNavigator:function(e){if(UWA.is(e))for(var t=this._pathCont.offsetWidth,i=!1,r=0;r<e.length;r++){var a,o=null,s=null,l=0,d=this._createLibraryInfoPathElement(e[r]);if(a=d.getDimensions().outerWidth,r<e.length-1&&((o=(s=new n({libraryInfo:e[r+1]})).buildPathSeparatorElement()).LibrarySeparator=s,o.inject(this._breadcrumb,"top"),l=o.getDimensions().outerWidth),a+l<t&&!i)t=t-a-l;else{i=!0,this._ctxMenu.isVisible()||this._ctxMenu.show(),o&&o.destroy();var c=d.nextSibling;c&&c.hasClassName("separatorIdCard")&&c.destroy(),d.remove(),this._ctxMenu.addSubLibrary(e[r])}}},_buildCtxMenu:function(){this._ctxMenu=new n({libraryInfo:null,activeIconFont:"fonticon-menu",unactiveIconFont:"fonticon-menu"});var e=this._ctxMenu.buildPathSeparatorElement();e.inject(this._pathCont,"top"),this._ctxMenuWidth=e.getDimensions().outerWidth,this._ctxMenu.hide()},_resize:function(){var e,t=null;if(this._isOverflowed(this._pathCont))for(this._ctxMenu.isVisible()||this._ctxMenu.show();this._isOverflowed(this._pathCont)&&this._breadcrumb.hasChildNodes()&&(t=this._breadcrumb.firstChild);)t.LibraryInfo&&(this._ctxMenu.addSubLibrary(t.LibraryInfo,!0),(e=t.nextSibling)&&e.hasClassName("separatorIdCard")&&e.destroy(),t.remove());else for(var i=!0,r=this._breadcrumb.getElementsByClassName("subLabelTextIdCard").length>0;i;)if(this._ctxMenu.isVisible()||(i=!1),t=this._ctxMenu.getSubLibrary(0)){if(r){var a=new n({libraryInfo:t});(e=a.buildPathSeparatorElement()).LibrarySeparator=a,e.inject(this._breadcrumb,"top");e.getDimensions().outerWidth}var o=this._createLibraryInfoPathElement(t);o.getDimensions().outerWidth;r=!0,this._isOverflowed(this._pathCont)?(e&&e.destroy(),o.remove(),i=!1):this._ctxMenu.removeSubLibrary(0)}else this._ctxMenu.hide(),i=!1;this._ctxMenu.isVisible()&&this._ctxMenu.resizeWidgetCallback();var s,l,d,c=this._breadcrumb.getElementsByClassName("separatorIdCard");for(d=c.length,s=0;s<d;++s)(l=c[s].LibrarySeparator)&&l.resizeWidgetCallback();return!0},_isOverflowed:function(e){return e.scrollHeight-1>e.clientHeight||e.scrollWidth>e.clientWidth},_createLibraryInfoPathElement:function(e){var t=e.getID()===this.CSOProvider.getCurrentObject().getID(),n=UWA.createElement("div",{class:"subLabelTextIdCard",styles:{cursor:"pointer"},events:{click:function(e){i.notifyExpandTreeAndSelect({libraryToFindAndSelect:{id:this.LibraryInfo.getID(),type:this.LibraryInfo.getType(),name:this.LibraryInfo.getLabel()}})}}}).inject(this._breadcrumb,"top");return n.LibraryInfo=e,n.setAttribute("current",t),n.setText(e.getLabel()),n}})}),define("DS/IPClassifyUX/views/LibraryBreadcrumbView",["UWA/Class","DS/IPClassifyUX/views/LibraryPathNavigator","DS/PADUtils/PADProbes","DS/IPClassifyUX/models/LibraryBreadcrumbModel","DS/IPClassifyUX/events/IPClassifyEvents","DS/ENOXPageToolBar/js/PageToolBar"],function(e,t,i,n,r,a){"use strict";return e.extend({init:function(e){this.dataProvider=e.dataProvider,this.CSOProvider=e.CSOProvider,this._elements=null},showBreadCrumb:function(e){this._elements=e;var t=this._elements.container.querySelector(".xnav_viewmain");t.querySelector(".LibraryDataGridView").style.top="38px",this._elements.breadCrumb_container=UWA.createElement("div",{class:"LibraryEditor_breadCrumb"}).inject(t);var i={withInformationButton:!1,withWelcomePanelButton:!0,parentContainer:this._elements.breadCrumb_container,modelEvents:r.getModelEvents()};this._pageToolBar=new a(i),this._pageToolBar.render().inject(this._elements.breadCrumb_container),this._elements.breadCrumb_container_content=UWA.createElement("div",{class:"LibraryEditor_title_IdCard"});var n=this._pageToolBar.getBodyContent();this._elements.breadCrumb_container_content.inject(n)},_buildLibraryPath:function(e){this._LibraryPathNavigator?(this._LibraryPathNavigator.flush(),this._LibraryPathNavigator._buildPathNavigator(e)):this._LibraryPathNavigator=new t({pathCont:this._elements.breadCrumb_container_content,pathNodes:e,CSOProvider:this.CSOProvider}),e.length>0&&this._elements.searchInContext&&this._elements.searchInContext.changeLibraryPlaceholder(e[0].getLabel())},setCurrentLocation:function(e){var t=i.createProbe("content_updateUI");this._elements=e;var r=n.getNewPathNodes({getChildrenInfos:this.dataProvider.getChildrenInfos,CSOProvider:this.CSOProvider}),a=r[0],o=this.CSOProvider.getCurrentObject();o&&null!=o&&o.getID()===a.getID()&&!o.options.mxid&&(o.options.mxid=a.options.mxid),this._buildLibraryPath(r),t.end()},_isSearchAvailable:function(e){return e||(e=this.CSOProvider.getCurrentObject()),!!e&&(!this.dataProvider.isSection(e.getType())&&e.options.mxid&&!1!==e.options.contentAvailable)}})}),define("DS/IPClassifyUX/views/LibraryPlaceHolder",["DS/ApplicationFrame/CommandsManager","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/models/LibrarySearchModel","UWA/Controls/Abstract","DS/Controls/Button","DS/IPClassifyUX/utils/IPClassifyWidgetData"],function(e,t,i,n,r,a,o){"use strict";return r.extend({init:function(e){this._parent(e),this._buttonComponents=null,this.text={},this.dataProvider=e.commandContext.dataProvider,this.CSOProvider=e.commandContext.CSOProvider,this.isMultiplePlaceholders=e.commandContext.placeholderData.multiplePlaceholders,this.buildSkeleton()},buildSkeleton:function(){var e=this,t=null,r="LibrarySection_AllLibraries";e.CSOProvider.getCurrentObject()&&(r=e.CSOProvider.getCurrentObject().noTree?"noTree":e.CSOProvider.getCurrentObject().plmType),i.onCurrentLibraryChange(function(i){var n=o.getWidgetData().currentTab;e._removeButtonComponent(),(t=e._getComponentToReplace(i.currentNode.plmType,n))&&t.inject(e.elements.container)}),n.onSearchChange(function(i,n){if(e.dataProvider.showSearchPlaceHolder&&e.dataProvider.showSearchPlaceHolder()){var r=e.CSOProvider.getCurrentObject()?e.CSOProvider.getCurrentObject().noTree?"noTree":e.CSOProvider.getCurrentObject().plmType:"LibrarySection_AllLibraries";e._removeButtonComponent(),(t=e._getComponentToReplace(r))&&t.inject(e.elements.container)}}),i.onContentTabChange(function(i){var n=o.getWidgetData().currentTab;e._removeButtonComponent(),(t=e._getComponentToReplace(i,n))&&t.inject(e.elements.container)}),this.elements.container=UWA.createElement("div",{class:"content-placeholder",html:{tag:"div",text:"",class:"content-placeholder-description"}});var a=o.getWidgetData().currentTab;(t=e._getComponentToReplace(r,a))&&t.inject(e.elements.container)},_removeButtonComponent:function(){this.getContent().getElementsByClassName("content-placeholder-common-command")[0]&&this.getContent().getElementsByClassName("content-placeholder-common-command")[0].remove()},_getComponentToReplace:function(e,t){var i=this._getButtonComponents();if(null===i){var r=this._getOptions();i=this._buttonComponents=this._buildButtonComponents(r)}return n.isSearchActive()?(this._getText(this.text.blankSection),i.blankSection):this.isMultiplePlaceholders?1===o.getWidgetData().currentWidgetTab?(this._getText(this.text.newClassAttributesSection),i.newClassAttributesSection):"LibrarySection_favorite"===e?(this._getText(this.text.favoriteSection),i.favoriteSection):"LibrarySection_AllLibraries"===e?(this._getText(this.text.librariesSection),i.librariesSection):"RootLibrary"===e?(this._getText(this.text.librarySection),i.librarySection):"Library"!==e&&e?void 0:1===t?(this._getText(this.text.classAttributesSection),i.classAttributesSection):(this._getText(this.text.classSection),i.classSection):"noTree"===e?(this._getText(this.text.blankSection),i.blankSection):(this._getText(this.text.commonSection),i.commonSection)},_getButtonComponents:function(){return this._buttonComponents},_getText:function(e){null==e&&(e=""),this.getContent().getElementsByClassName("content-placeholder-description")[0].innerText=e},_getOptions:function(){var t=this;if(this.isMultiplePlaceholders)return{favoriteSection:{text:t.options.commandContext.placeholderData.placeholders.favoriteSection.labelNLS,commands:[]},librariesSection:{text:t.options.commandContext.placeholderData.placeholders.createNewDefinitionLibrary.labelNLS,commands:[{name:t.options.commandContext.placeholderData.placeholders.createNewDefinitionLibrary.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.createNewDefinitionLibrary.command,t.options.commandContext);i&&i.begin()}},{name:t.options.commandContext.placeholderData.placeholders.createNewStandardLibrary.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.createNewStandardLibrary.command,t.options.commandContext);i&&i.begin()}}]},librarySection:{text:t.options.commandContext.placeholderData.placeholders.createNewClass.labelNLS,commands:[{name:t.options.commandContext.placeholderData.placeholders.createNewClass.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.createNewClass.command,t.options.commandContext);i&&i.begin()}}]},classSection:{text:t.options.commandContext.placeholderData.placeholders.createNewClass.labelNLS_Cls,commands:[{name:t.options.commandContext.placeholderData.placeholders.createNewClass.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.createNewClass.command,t.options.commandContext);i&&i.begin()}}]},classAttributesSection:{text:t.options.commandContext.placeholderData.placeholders.addClassAttributes.labelNLS,commands:[{name:t.options.commandContext.placeholderData.placeholders.addClassAttributes.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.addClassAttributes.command,t.options.commandContext);i&&i.begin()}}]},newClassAttributesSection:{text:t.options.commandContext.placeholderData.placeholders.newClassAttributes.labelNLS,commands:[]}};{let i={commonSection:{text:t.options.commandContext.placeholderData.placeholders.addExistingCI.labelNLS,commands:[{name:t.options.commandContext.placeholderData.placeholders.addExistingCI.commandNLS,emphasize:"primary",callback:function(){var i=e.getCommand(t.options.commandContext.placeholderData.placeholders.addExistingCI.command,t.options.commandContext);i&&i.begin()}}]}};return t.options.commandContext.placeholderData.placeholders.NoObjectsFound&&(i.blankSection={text:t.options.commandContext.placeholderData.placeholders.NoObjectsFound.labelNLS,commands:[]}),i}},_buildButtonComponents:function(e){var t=[];function i(e,t){var i=e.commands[t].callback,n={label:e.commands[t].name,emphasize:e.commands[t].emphasize},r=new a(n);return r.getContent().addEventListener("buttonclick",function(){i()}),r}function n(e,t){if(e.commands)for(var n=0;n<e.commands.length;n++){i(e,n).inject(t)}}for(var r in e){var o=UWA.createElement("div",{class:"content-placeholder-common-command"});n(e[r],o),t[r]=o,this.text[r]=e[r].text}return t}})}),define("DS/IPClassifyUX/views/LibraryMode",["UWA/Controls/Abstract","DS/Controls/TooltipModel","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUX/models/LibrarySearchModel","DS/IPClassifyUtil/IPClassifyAlert","DS/PADUtils/PADSession","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/utils/IPClassifyModeManager"],function(e,t,i,n,r,a,o,s,l,d){"use strict";var c=null,u=null,h=null;function f(){return{icon:{iconName:widget.getValue("useIndexAccleration")?0==widget.getValue("intervalToSwitchMode")?"database hoverGlass":"database-hourglass":"database hoverGlass",fontIconFamily:1,className:"check-active"},disabled:!widget.getValue("useIndexAccleration")}}var g=e.singleton({_currentModeType:"index",_instantTime:null,_lastRefreshMode:null,_lastIndexInfo:i.text_not_available,_modeInformation:{},init:function(e){this._parent(e),this._tooltip=new t,this._modeInformation={last_refreshed:(new Date).getTime()},this.subscribeToEvents()},subscribeToEvents:function(){var e=this;o.getModelEvents().subscribe({event:"switch_to_author"},this.switchtoAuthoringMode.bind(this)),setInterval(()=>{this.updateToolTip()},1e4),l.onUpdateRefreshTime(function(t){e._modeInformation=t.modeInformation,e.updateToolTip()}),l.onModeChange(function(t){e.setCurrentMode(t.switchMode),g.updateIconAndSettings()})},setLibraryControl:function(e){h=e},getToolbarEntry:function(){this._tooltip.title=i.get("tooltip_title_indexMode"),this._tooltip.shortHelp=i.get("msg_index_mode_activated");var e="index"==g.determineCurrentModeState()?{icon:{iconName:"database-refresh",fontIconFamily:1,className:""},disabled:!1}:f(),t={id:"indexMode",dataElements:{typeRepresentation:"functionIcon",tooltip:this._tooltip,label:i.indexMode.Label,action:{module:"DS/IPClassifyUX/views/LibraryMode",func:"switchModeButtonUI"},visibleFlag:!0}};for(var n in e)t[n]=e[n];return t},switchModeButtonUI:function(){s.sendTrackerPageEvent("LibraryWidget_iconBar","Active Mode");var e;e=300,clearTimeout(u),u=setTimeout(function(){n.isSearchActive()&&(n.clearSearch(),h.getIdCardCont().switchSearch(!1));try{"index"==g.getCurrentModeType()?d.setAuthoringMode("authoring"):d.setAuthoringMode("index"),g.updateIconAndSettings(),d.refreshViewOfWidget(),g.setLastIndexTime(d.getLastIndexedTime())}catch(e){console.error(e)}},e)},updateIconAndSettings:function(e){if((e||!0)&&this._registerTimeandModeOfRefresh(this.getCurrentModeType()),"index"==this.getCurrentModeType()&&this._enableIndexModeSwitch(),"authoring"==this.getCurrentModeType())if(widget.getValue("useIndexAccleration")){var t=widget.getValue(widget.getValue("intervalToSwitchMode"));this._enableAuthoringMode(),g.setIndexModeAfterTimeInterval(t)}else this._enableAuthoringMode();this.updateToolTip()},_enableAuthoringMode:function(){if(h.getIdCardCont()){var e=f();h.getIdCardCont().updateCommand("indexMode",e)}},_enableIndexModeSwitch:function(){if(h.getIdCardCont()){var e={icon:{iconName:"database-refresh",fontIconFamily:1,className:""},disabled:!1};h.getIdCardCont().updateCommand("indexMode",e)}},getCurrentModeType:function(){return s.determineAuthoringMode()},setCurrentModeType:function(e){this._currentModeType==e&&"authoring"!=this._currentModeType||("index"==e?this._enableIndexModeSwitch():this._enableAuthoringMode()),this._currentModeType=e,"index"==e?(a.setAuthoringState(!1),a.setUseIndexPreference(!0)):(a.setAuthoringState(!0),a.setUseIndexPreference(!1))},_getWaitingTimeBeforeSwitchToIndexMode:function(){return parseInt(widget.getValue("intervalToSwitchMode"))},determineCurrentModeState:function(){var e=this.getCurrentModeType();const t=this._getWaitingTimeBeforeSwitchToIndexMode();return"authoring"!==e||widget.getValue("useIndexAccleration")?"authoring"!==e||t||(e="neverIndexMode"):e="useOnlyAuthoring",e},getFullViewLoadInfo:function(){return this._modeInformation},setLastIndexTime:function(e){this._lastIndexInfo=e},getLastIndexedTime:function(){return this._lastIndexInfo?this._lastIndexInfo:d.getLastIndexedTime()},_registerTimeandModeOfRefresh:function(e){this._instantTime=(new Date).getTime(),this._lastRefreshMode=e},updateToolTip:function(){const e=this.determineCurrentModeState(),t=this.getCurrentModeType();let n,r=(new Date).getTime()-this.getFullViewLoadInfo().last_refreshed;if(r>=6e4)var a=Math.abs(Math.round(r/6e4));else var o=Math.abs(Math.round(r/1e3));r=void 0!==a?a:o;let s=this.getLastIndexedTime();if("index"===e&&"authoring"!==t){n=void 0!==a?i.get("tooltip_index_mode_last_update_minute"):i.get("tooltip_index_mode_last_update_seconds"),a&&a>1&&(n=i.get("tooltip_index_mode_last_update_minutes"));var l=i.replace(n,{time:r,lastIndexed:s});this._tooltip.setProperties({shortHelp:l})}else"authoring"===t&&"neverIndexMode"===e?(n=void 0!==a?i.get("tooltip_never_use_index_minute"):i.get("tooltip_never_use_index_seconds"),a&&a>1&&(n=i.get("tooltip_never_use_index_minutes")),this._tooltip.shortHelp=i.replace(n,{time:r,lastIndexed:s})):"authoring"===t&&"useOnlyAuthoring"===e?(n=void 0!==a?i.get("tooltip_never_use_index_minute"):i.get("tooltip_never_use_index_seconds"),a&&a>1&&(n=i.get("tooltip_never_use_index_minutes")),this._tooltip.shortHelp=i.replace(n,{time:r,lastIndexed:s})):"authoring"===t&&(n=void 0!==a?i.get("tooltip_authoring_mode_back2index_minute"):i.get("tooltip_authoring_mode_back2index_seconds"),a&&a>1&&(n=i.get("tooltip_authoring_mode_back2index_minutes")),this._tooltip.shortHelp=i.replace(n,{time:r,indexTime:widget.getValue("intervalToSwitchMode")/60,lastIndexed:s}))},setIndexModeAfterTimeInterval:function(e){var t=this;if(this.stopRefresh(),!isNaN(e)){var n=parseInt(e);c=setTimeout(function(){t.setCurrentMode("index"),t.updateIconAndSettings(),r.displayNotification({message:i.indexMode.info_msg_DataNotUptoDate,className:"info"})},60*n*1e3)}},stopRefresh:function(){c&&clearTimeout(c)},setCurrentMode:function(e){"authoring"==e&&(n.isSearchActive()&&(n.clearSearch(),h.getIdCardCont().switchSearch(!1)),r.displayNotification({message:i.indexMode.msg_Authoring,className:"info"})),this.setCurrentModeType(e)},switchtoAuthoringMode:function(){"index"==g.getCurrentModeType()&&(n.isSearchActive()&&(n.clearSearch(),h.getIdCardCont().switchSearch(!1)),g.setCurrentMode("authoring"),r.displayNotification({message:i.indexMode.msg_Authoring,className:"info"}),g.updateIconAndSettings())}});return g}),define("DS/IPClassifyUX/views/InformationsPanelView",["UWA/Controls/Abstract","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PADUtils/PADContext","DS/WidgetServices/commandProxy/CommandProxy","DS/PADServices/utils/GlobalModelEvents"],function(e,t,i,n,r,a){"use strict";return e.extend({_context:null,_propertiesWdg:null,_callbackAdd:!1,_modelEv:null,_libraryEditorUtil:null,_libraryControl:null,init:function(e){this._parent(e,{}),this._context=n.get();var r=this;this._propertiesWdg=null,this._callbackAdd=!1,this._modelEv=a.getModelEvents(),e.dataProvider&&(this._libraryEditorUtil=e.dataProvider.getLibraryEditorUtil&&e.dataProvider.getLibraryEditorUtil(),this._libraryControl=e.dataProvider.getLibraryControl&&e.dataProvider.getLibraryControl()),r.CSOProvider=e.CSOProvider,e.padshell&&(null==r._propertiesWdg&&require(["DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants"],function(n,a){if(null==r._propertiesWdg){r._propertiesWdg=new n({className:"enxpropertiestab",setEditButton:!0,readOnly:!1,typeOfDisplay:a.ALL,selectionType:a.RESTRICTED_SELECTION,multiselection:!1,collapseTabs:!1});let l=[{require:"DS/EditPropWidget/facets/GeneralHistory/History",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"history",icon:"clock",text:i.get("history_tab")},options:{appContext:{options:e,getDocumentId:function(){return e.CSOProvider.getSelectedNodesID()[0]}}}},{position:1,require:"DS/ENORIPE_Relations/views/RelationsTab",facet:{name:"relations",text:i.get("relations_tab"),icon:"object-related"}},{position:2,require:"DS/IPClassifyUX/facets/AttachmentsFacet",alwaysVisible:!1,supportMerge:!1,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"attachments",text:i.get("attachments"),icon:"attach"},options:{appContext:{options:e,getDocumentId:function(){return e.CSOProvider.getSelectedNodesID()[0]},readonly:e.readOnly}}},{position:3,require:"DS/ClassificationsFacet/ClassificationFacet",alwaysVisible:!1,facet:{name:"Classification",text:i.get("Classification"),icon:"classification-book"},options:e}];r.options.dataProvider.getAdditionalFacets&&l.push(...r.options.dataProvider.getAdditionalFacets(r.options)),r._propertiesWdg.addFacets(l),r._propertiesWdg.removeFacets([a.FACET_VIEWS]);var o=e.padshell.getRightPanelContent();r._propertiesWdg.inject(o),r._propertiesWdg.stopSelection(!0);var s=null;r._libraryEditorUtil.getRightPanelStatus().then(function(i){s=i,1!==r._libraryEditorUtil.CURRENT_TAB_VALUE&&s&&s.rightPanelState&&(r._context.togglePanel("right"),r._selectionChange(),r.show(e.padshell),t.notifyInfoExpanded(),r.setPreferences(),r._modelEv.publish({event:"information-panel-visible"}))}),r._propertiesWdg.elements.container.getContent().addEvent("resize",function(){r.size=e.padshell._currentRight;var t={rightPanelState:e.padshell.getRightOpen(),size:r.size};r._libraryEditorUtil&&r._libraryEditorUtil.setRightPanelStatus(t)})}r.addCallback(e)}),t.onInfoExpand(function(){r.show(e.padshell),t.notifyInfoExpanded()}),t.onInfoCollapse(function(){e.padshell._modelEvents.publish({event:"triptych-hide-panel",data:"right"}),t.notifyInfoCollapsed()}),t.onLibrarySelected(function(){e.padshell.getRightOpen()&&(r.show(e.padshell),t.notifyInfoExpanded())}))},updatePanelVisibility:function(e,t){"right"===t&&this._libraryControl&&this._libraryControl.getIdCardCont()&&this._libraryControl.getIdCardCont().updateRightPanelIcon(e)},show:function(e){var t=this;require(["DS/EditPropWidget/utils/EditPropUtils"],function(i){t._selectionChange(i,e)})},addCallback:function(e){var i=this;!1===i._callbackAdd&&i._context.elements.padshell&&i._context.elements.padshell._modelEvents&&(i._context.elements.padshell._modelEvents.subscribe({event:"triptych-panel-hidden"},i.updatePanelVisibility.bind(this,!1)),i._context.elements.padshell._modelEvents.subscribe({event:"triptych-panel-visible"},i.updatePanelVisibility.bind(this,!0)),this._modelEv.subscribe({event:"information-panel-open"},function(){i.show(e.padshell),t.notifyInfoExpanded(),i.setPreferences()}),this._modelEv.subscribe({event:"information-panel-close"},function(){i._context.elements.padshell.getRightOpen()&&(i._context.togglePanel("right"),t.notifyInfoCollapsed(),i._selectionChange(),i.setPreferences())}),i._callbackAdd=!0)},_selectionChange:function(e,t){if(e){var i=this.CSOProvider.getSelectedNodes();if(this._propertiesWdg.elements.UI._lFacets.forEach(function(e){"history"===e.facet.name&&i.length>1?e.alwaysVisible=!1:"history"===e.facet.name&&1===i.length&&(e.alwaysVisible=!0)}),this.CSOProvider.enableEditProperty){let e=this.CSOProvider.enableEditProperty(i);this._propertiesWdg.controller.skeleton._sharedOptions.readOnly=!e}var n=[];i.length&&i.forEach(function(t){if(e.getModelFromSelectedNode){var i=e.getModelFromSelectedNode(t);i&&n.push(i)}}),this._propertiesWdg.initDatas(n),this._context.elements.padshell._modelEvents.publish({event:"triptych-show-panel",data:"right"})}},setPreferences:function(){var e=this._context.elements.padshell.getRightOpen(),t={rightPanelState:e,size:this.size};this._libraryEditorUtil.setRightPanelStatus(t),e?this._modelEv.publish({event:"information-panel-visible"}):this._modelEv.publish({event:"information-panel-hidden"})}})}),define("DS/IPClassifyUX/models/LibraryContentModel",["UWA/Class","UWA/Class/Promise","DS/PADUtils/PADProbes","DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUX/utils/IPClassifyWidgetData"],function(e,t,i,n,r){"use strict";var a,o,s,l,d=(a=void 0,o=0,s=!1,l=!1,{reset:function(){a=void 0,o=0},updateStartIndexAfterFetch:function(e){if(s=!1,e.infos&&e.infos.next_start){a=e.infos.next_start;var t=parseInt(a.slice(0,a.indexOf(" ")));(o+=e.infos.nresults)<e.infos.nhits&&t<e.infos.nhits&&(s=!0)}},isMoreDataToFetch:function(){return s},isFetchInProgress:function(){return l},setFetchInProgress:function(e){l=e},getNextStart:function(){return a}}),c=void 0,u=e.singleton({fetchLibraryContents:function(e,n){var a=i.createProbe("probeFetchLibraryContents");var o,s;return e.isStartFromBeg&&(d.reset(),c=e.dynamicattributes.filter(function(e,t,i){return i.indexOf(e)===t})),e.sortOrder&&(o=e.sortOrder.order_field,s=e.sortOrder.order_by),new t(function(t,i){n({pid:e.containerId,mxid:e.containerMXID,searchQuery:e.searchQuery,isExactSearch:e.isExactSearch,selectedType:e.selectedType,dynamicattributes:c,attributesDimMap:e.attributesDimMap,filters:e.filters,start:e.isStartFromBeg?0:void 0,next_start:d.getNextStart(),order_field:o,order_by:s,physicalId:e.physicalId,isAuthoringMode:e.isAuthoringMode,grid:e.grid,widgetData:r.getWidgetData()}).then(function(e){d.setFetchInProgress(!1),d.updateStartIndexAfterFetch(e),t(e),a.end()},function(e){i(e),a.end()})})},fetchAllLibraries:function(e,n){var a,o,s=i.createProbe("probeFetchAllLibraries");return e.isStartFromBeg&&d.reset(),e.sortOrder&&(a=e.sortOrder.order_field,o=e.sortOrder.order_by),new t(function(t,i){n({filters:e.filters,start:e.isStartFromBeg?0:void 0,next_start:d.getNextStart(),order_field:a,order_by:o,searchQuery:e.searchQuery,widgetData:r.getWidgetData()}).then(function(e){d.setFetchInProgress(!1),d.updateStartIndexAfterFetch(e),t(e),s.end()},function(){i(),s.end()})})},fetchAllFavorites:function(e){var a=i.createProbe("probFetchAllFavorites");return new t(function(t,i){function o(e){return e.id}n.get(e.getPreferenceSectionName(),function(s){s.length>0?e.getPreferenceSectionContents({ids:s.map(o),widgetData:r.getWidgetData()}).then(function(i){var r=[],o=!1;i.length!==s.length&&(o=!0);for(var l=0;l<i.length;++l){for(var d=0;d<s.length;++d)s[d].id===i[l].physicalid&&(i[l].label=s[d].name);o&&r.push({id:i[l].physicalid,name:i[l].label})}o&&n.set(e.getPreferenceSectionName(),r,!1,!1),t(i),a.end()},function(){i(),a.end()}):t([])},!1,!1)})}});return{fetchLibraryContents:u.fetchLibraryContents.bind(u),fetchAllLibraries:u.fetchAllLibraries.bind(u),fetchAllFavorites:u.fetchAllFavorites.bind(u),isMoreDataToFetch:d.isMoreDataToFetch,isFetchInProgress:d.isFetchInProgress,setFetchInProgress:d.setFetchInProgress}}),define("DS/IPClassifyUX/views/LibraryContentView",["UWA/Core","DS/WebappsUtils/WebappsUtils","DS/ENOIPClassify/IPClassifyComponent","DS/IPClassifyNav/models/xNavNodeModel","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/models/LibrarySearchModel","DS/UIKIT/Mask","DS/PADUtils/PADProbes","DS/UIKIT/Native/Dropdown","DS/WidgetServices/WidgetServices","DS/IPClassifyUtil/IPClassifyCommunication","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/views/LibraryPlaceHolder","DS/IPClassifyUX/service/LibraryDnDService","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/Controls/TabBar","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUtil/IPClassifyPreference","DS/Menu/ContextualMenu"],function(e,t,i,n,r,a,o,s,l,d,c,u,h,f,g,p,_,b,m){"use strict";var v=null,C=null;let y=!1,S=null;var P="ipcColumnSort_v1";return i.extend({name:"LibraryContentView",defaultOptions:{x3dAppId:"LibraryEditor",amd_custo:{TreeDocument:"DS/IPClassifyUX/views/LibraryTreeDocumentView",DataGridView:"DS/IPClassifyUX/views/LibraryDataGridView",TileGridView:"DS/IPClassifyUX/views/LibraryTileGridView",ThumbnailGridView:"DS/IPClassifyUX/views/LibraryThumbnailGridView"},active_view:"datagridview",layout:{keyboard_inputs:!1,root_panel:!1,action_bar:!1,statusInfo:!1,slidder:!1,title_update:!1,drop_invite:"none",triptychOpts:{borderLeft:!0,left:{withClose:!1,originalState:"close"},right:{withClose:!1}},amdTreeView:"datagridview"}},_contentDiv:null,_isEditable:null,init:function(e){var t=this;if(this._contentDiv=e.renderTo,this.leftTriptychElem=e.leftTriptychElem,widget.TreeDocumentCSOProvider=this.CSOProvider=e.CSOProvider,widget.TreeDocumentDataProvider=this.dataProvider=e.dataProvider,this.showBreadcrumb=e.showBreadcrumb,this.DnDProvider=e.DnDProvider,this.placeholderData=e.placeholderData,t._columnsCache={},e._libraryBreadcrumbView&&(this._libraryBreadcrumbView=e._libraryBreadcrumbView),this._isEditable=e.dataProvider.checkEditable?e.dataProvider.checkEditable:null,v=e.dataProvider.getContextualMenu,e.DisabledDropInvit=!0,e.layout&&e.layout.view_customization&&e.layout.view_customization.columnsOptimized){var i=t.removeClassAttrsFromColumnCusto(e.layout.view_customization.columnsOptimized);e.layout.view_customization.columnsOptimized=i}d.isNatifEnvironnement()||this.dataProvider.showContentPlaceholder&&this.dataProvider.showContentPlaceholder(this.leftTriptychElem)&&(t._placeHolder=new h({commandContext:this}),t._gridPlaceHolder=new h({commandContext:this})),this.setOptions(e),this._parent(this.options),require(["DS/PADUtils/views/PADStatusInfos"],function(e){t.elements.padstatus=new e({renderTo:t._contentDiv,events:{onShow:function(){t.elements.padstatus.setStatus(e.buildStatus({tree_content:{nbObjectsInTree:t.options.model.getAllDescendants().length,nbObjectsSelected:t.options.model.getSelectedNodes().length}}))}}})})},createRootListSlidder2:function(){return this.leftTriptychElem},showBreadCrumb:function(){this._libraryBreadcrumbView.showBreadCrumb(this.elements)},addTabPages:function(){var e=this;if(this.dataProvider.getPageTabs){var t=this.elements.container.querySelector(".xnav_viewmain");this.elements.pageTab_container=UWA.createElement("div",{class:"LibraryEditor_pageTab"}).inject(t);var i=new p({displayStyle:"strip"});i.inject(this.elements.pageTab_container);var n=this.dataProvider.getPageTabs();for(var a in n)i.add(n[a]);i.addEventListener("tabButtonClick",function(t){t&&t.options&&(_.setCurrentTab(t.options.value),e._lastTabID=t.options.value,r.notifyContentTabChange())}),this.elements.pageTab_container.hide()}},setFilterModel:function(e){e&&this.getPADTreeDocument().setFilterModel(e)},setTabsVis:function(e){if(this.dataProvider.getPageTabs&&this.elements.pageTab_container){if(!this.elements.pageTab_container.isHidden()===e)return;var t=_.getWidgetData().currentTab;e?(this.elements.pageTab_container.show(),_.setCurrentTab(this._lastTabID)):(this.elements.pageTab_container.hide(),_.setCurrentTab()),this.setTabStyleOnView(),t!==_.getWidgetData().currentTab&&this.loadNewColumns()}},setTabStyleOnView:function(){if(this.dataProvider.getPageTabs){var e=null;(e="datagridview"===this.getActiveView()?this.elements.container.querySelector(".LibraryDataGridView"):this.elements.container.querySelector(".wux-layouts-responsivecollectionview"))&&e.setStyle("top",this.elements.pageTab_container.clientHeight)}},_addStyleOnTreeCont:function(e){var t=this.elements.padshell._getLeftWidth();t=e&&e>t?e:t,d.addNewStyles("treeContResize",{".LibraryTreeView-root_container":{overflow:"hidden"},".LibraryTreeView-root_treeview_container":{width:t+"px !important"}},!0)},removeClassAttrsFromColumnCusto:function(e){for(var t=[],i=0;i<e.length;++i)-1==e[i].dataIndex.indexOf("attribute[")&&t.push(e[i]);return t},saveSortModelInCache:function(){if(this.dataProvider.getPageTabs){this._currentSortModel||(this._currentSortModel={});var e=this.getPADTreeListView().getManager(),t=e.sortModel;if(t&&t.length>0&&null!=t[0].dataIndex&&null!=t[0].dataIndex){var i=_.getWidgetData();if(e.layout.getLeafColumns()[e.layout.getColumnIndex(t[0].dataIndex)]){this._currentSortModel[i.currentTab]=e.sortModel;var n=P+(0==i.currentWidgetTab?i.currentTab:"exceptions_tab");b.set(n,e.sortModel,!0)}}}},setSortOnColumn:function(){var e=this;return new Promise(function(t,i){if(e.dataProvider.getPageTabs){e._loadedColTabs||(e._loadedColTabs={});var n=_.getWidgetData();if(e._loadedColTabs[n.currentTab])e.getPADTreeListView().setColumnOrderState(e._currentSortModel[n.currentTab]),t();else{e._loadedColTabs[n.currentTab]=!0;var r=P+(0==n.currentWidgetTab?n.currentTab:"exceptions_tab");b.get(r,function(i){var n=e.getPADTreeListView().getDefaultSortModel();Object.keys(i).length&&(n=i),e.getPADTreeListView().setColumnOrderState(n);var r=e.getPADTreeListView().getManager().sortModel;n.dataIndex==r.dataIndex&&n.sort==r.sort&&e.saveSortModelInCache(),t()},!0)}}else t()})},loadNewColumns:function(){if("datagridview"===this.getActiveView()){var e=this.getPADTreeListView().getManager(),t=_.getWidgetData();this._currentSortModel||(this._currentSortModel={}),this.removeAllColumns();for(var i=this.dataProvider.getColumnConfig(t),n=0;n<i.length;++n)this._columnsCache[i[n].dataIndex]?e.addColumnOrGroup(this._columnsCache[i[n].dataIndex]):e.addColumnOrGroup(i[n]);this.setSortOnColumn()}},removeAllColumns:function(){for(var e=this.getPADTreeListView().getManager(),t=e.layout.getLeafColumns(),i=0;i<t.length;++i)"tree"!==t[i].dataIndex&&(this._columnsCache[t[i].dataIndex]=t[i],e.removeColumnOrGroup(t[i].dataIndex))},cleanColumns:function(){for(var e=this.getPADTreeListView().getManager().layout.getLeafColumns(),t=[],i=[],n=0;n<e.length;++n)e[n].isDynamic&&(t.push(e[n].dataIndex),i.push(e[n]));this.getPADTreeListView().removeColumnCB(i),this.getPADTreeListView().removeColumnPreferences(t)},toShowThumbnail:function(e){return!this._isTreeViewType()||this.getPADTreeListView().isColumnAvailable(e)},_addCtxItem:function(e,t,i){var n=this;if("DS/ResultWebInWin/ResultWebInWinAction"==t.sourcejs){let r=t.image,a=i&&i[r]?i[r]:"",o={type:"PushItem",title:t.title,icon:a,action:{callback:()=>{n.CSOProvider.getSelectedNodes();var e=n.CSOProvider.getSelectedNodesID();c.publish("onActionContextualMenu",{header:t.id,ids:e,repeatMode:n.dataProvider.getRepeatMode?n.dataProvider.getRepeatMode():null})}}},s=[];t.items&&(t.items.forEach(e=>{this._addCtxItem(s,e)}),o.submenu=s),e.push(o)}},showWebInWinCtxMenu:function(e,t){var i=t;if(i&&i.actions){var n=[];i.actions.forEach(e=>{e.actions&&e.actions.forEach(e=>{this._addCtxItem(n,e,t.images)})}),this._initDropDown(n)}},_initDropDown:function(e){if(!C)return;y=!0;let t=m.addEventListener(C,{callback:function(){return e}});m.buildAndDisplayContextualMenu(C,{clientX:S.x,clientY:S.y}),m.removeEventListener(C,t),y=!1},setLibraryCommunicationChannel:function(){},getOnContextualEvent:function(){return{this:this,callback:function(e){var t=this;return new Promise(function(i){t.onContextualMenuReady(e).then(function(e){i(e)})})}}},onContextualMenuReady:function(e){var t=e.cellInfos;e.data&&(C=e.data.target),null==t&&(t={}),e.data&&e.data.event&&(S={x:e.data.event.pageX,y:e.data.event.pageY});var i={};t.cellView?t.rowID?i.virtualRowID=t.rowID:i.virtualRowID=1:t.white_Click=!0;var n=t.nodeModel,r=!0;return-1===i.virtualRowID&&(r=!1),y?Promise.resolve([]):new Promise(function(a,o){if(r&&d.isNatifEnvironnement()&&!d.isWebInWinEnvironment())c.publish("Create_ContextMenu",{ids:n?[n.id]:[]}),n&&!1===n.isSelected()&&n.select(!0),a(void 0);else{if(v||a(void 0),t.white_Click&&e&&e.treeview){var s=e.treeview?e.treeview.manager.getScroller():null;if(s&&e.data.target!=s.getContent())return}n&&"Busy"===n.plmType&&a(void 0);var l=_.getWidgetData(),u=!1;t.white_Click||-1===i.virtualRowID?u=!0:n&&(!1===n.isSelected()&&n.select(!0),!0===n.isSelected()&&(u=!0)),u&&v(t,"CONTENT",l,e).then(function(e){e.forEach(function(e){"separator"===e.type||"SeparatorItem"===e.type?e.type="SeparatorItem":e.label&&(e.title=e.label,e.action={callback:e.callback},e.type="PushItem")}),a(e)})}})},getActiveView:function(){return this._parent()},getPADTreeListView:function(){return this.options.views.datagridview},getPlaceHolder:function(){return this._gridPlaceHolder},enableTreeColumnEdit:function(e){return this.options.views.datagridview.setTreeColumnEditable(e)},removeNodesInContent:function(){var e=this.getPADTreeDocument();if(e){var t=e.getRoots(!0).slice(0);e.wrapInTransaction(function(){e.withTransactionUpdate(function(){var i,n=t.length;for(e.unselectAll(),i=0;i<n;++i)e.removeRoot(t[i],!0,!1)})})}},getSortingOrder:function(e){return this.getPADTreeListView().getSortingOrder(e)},setSortingForComputedAttrs:function(){this.getPADTreeListView().setSortingForComputedAttrs()},displayDynamicAttributes:function(e,t){var i=this;i.cleanColumns();var n=e.dynamicattributesName,r=e.dynamicattributesForUIView,a=e.dynamicattributes,o=e.dynamicattributesType;let s=e.dynamicattributesIndex;var l=e.dynamicattributesValueType,d=e.dynamicattributesUnit,c=e.dynamicattributesRange?e.dynamicattributesRange:null,u=e.convUnitInfos,h=[];if(u&&(h=u.attrsToConvert),!i._isTreeViewType()||!n||n.length<1||!r||r.length<1)return new Promise(function(e){e()});var f=i.getPADTreeListView(),g={};let p=[];for(var _=0;_<n.length;++_)if(null!=n[_]&&null!=n[_]){if(!t){if(g[a[_]])continue;g[a[_]]=a[_]}var b={dataIndex:a[_],text:r[_],width:"auto",minWidth:30,isVisible:!0,isDynamic:!0,editableFlag:!0,dbAttribute:n[_],customisation:{layout:{removable:!1,removableFromView:!1,pinEditable:!1,movable:!1},exportable:{lock:!0,value:!1}},dynamicattributesIndex:s?s[_]:s,getCellEditableState:function(e){var t=!!e.nodeModel&&e.nodeModel.plmType,n=!1;if(t&&e.nodeModel.options){var r=e.nodeModel.options;n=r.grid["ds6w:reserved"]?r.grid["ds6w:reserved"]:!(!r.padgrid||!r.padgrid["ds6w:reserved"])&&r.padgrid["ds6w:reserved"]}return!!i._isEditable&&i._isEditable(t,n)}};"multiline"==o[_]?(b.typeRepresentation="editor",b.editionPolicy="EditionOnOver"):b.typeRepresentation=o[_],c&&i._isEditable&&c[_].length>0&&(b.editionPolicy="EditionOnClick",b.semantics={possibleValues:c[_]},b.typeRepresentation="string"),l&&"multival"==l[_]&&(void 0!==d[_]?b.getCellEditableState=function(e){return!1}:c&&i._isEditable&&c[_].length>0?(b.semantics={possibleValues:c[_],allowMultipleValuesFlag:!0},b.typeRepresentation="string"):i._isEditable&&(b.getCellSemantics=function(e){return{allowMultipleValuesFlag:!0}}));var m={};if(h.indexOf(n[_])>-1){m.dimension=u[n[_]+".dimension"];var v=u[n[_]+".manipulationUnit"];v&&v.length>0&&(m.manipulationUnit=v),b.convertInfos=m}p.push(b)}return new Promise(function(e){f.addColumnCB(p).then(function(){e()})})},_getColumnOptions:function(e){var t,i=this.getPADTreeListView().getManager()?this.getPADTreeListView().getManager().layout:null;if(i){var n=i.getColumnIndex(e);if(n>-1)t=i.getLeafColumns()[n]}return t},displayContentNodes:function(e,i,r,a,o){var s=this;a&&s.removeNodesInContent();var l=[],d=[];e.forEach(function(e){var a=null;if(i&&i.forEach(function(t){(t.id||t.getID())===e.id&&(a=t)}),null==a){var o=e,c=new n(o);if(s._isEditable&&s.dataProvider.getAttributesInfo){var u=s.dataProvider.getAttributesInfo().rangeAttributes,h={},f=s.dataProvider.getAttributesInfo().predicates,g=Object.keys(f);if(u&&u.isNLSavailable)for(const e in u){var p=Object.keys(f).find(t=>f[t]===e),_=c.options.grid[p];if(Array.isArray(_))for(var b=0;b<_.length;b++)c.options.grid[p][b]=u[e][_[b]];else c.options.grid[p]=u[e][_]}if(g.length>0)for(b=0;b<g.length;b++)h[g[b]]=e.grid[g[b]];c.attributeValue=h}if(c.options.grid.thumbnail="url("+o.thumbnail+")",c.plmType=o.plmType,c.id=o.physicalid,c.mxid=o.mxid,o.usage&&(c.options.usage=o.usage),c._ischeckout=e.Documentlocked,"TRUE"===c._ischeckout){var m=t.getWebappsAssetUrl("LibraryEditor","icons/32/I_CheckOutDocument.png");c.updateOptions({badges:{bottomRight:m}})}if("TRUE"===e.publishOnConnect){var v=t.getWebappsAssetUrl("LibraryEditor","icons/libraryPublishBadge.png");c.setBadges({bottomRight:v})}s.dataProvider.setIconsForLibraries&&s.dataProvider.setIconsForLibraries(c,s.getActiveView()),c.options.oldLabel=o.label,c._manageNLS=c.options._manageNLS=!0,l.push(c),"Attribute"!=c.plmType&&(UWA.is(r,"array")?r.indexOf(c.id)>=0:c.id===r)&&d.push(c)}else{l.push(a),roots_PS_toRefresh.push(a);var C=a.id||a.getID();(UWA.is(r,"array")?r.indexOf(C)>=0:C===r)&&d.push(a)}}),s._endRefreshAndAddNodes(d,l);var c=null;return d.length>0&&(c=d[d.length-1],o&&s.dataProvider.getTreeCellEditionValue&&1==s.dataProvider.getTreeCellEditionValue(d)&&s._defaultEnableNameEdit(d[d.length-1])),s._sortContent(),c},_defaultEnableNameEdit:function(e){setTimeout(function(){this._switchNameToEdit(e)}.bind(this),1e3)},_switchNameToEdit:function(e){try{var t=this.getPADTreeListView().getManager(),i=t.layout.getColumnIndex("tree"),n=t.layout.getCellsFromNodeModel(e)[i],r=s.createProbe("scrollTo_LibraryOrClass");t.scrollToCellAt({cellID:n}),r.end();t.getCellInfosAt(n);t.setCellInEdition(n)}catch(e){}},_sortContent:function(){this._isTreeViewType()&&this.getPADTreeDocument()._getTrueRoot().sortChildren({isRecursive:!0,sortFunction:this.dataProvider.comparator})},displayFavouriteNodes:function(e,t){var i=s.createProbe("probeDisplayFavouriteContent"),r=this;r.removeNodesInContent();var a=[],o=[];e.forEach(function(e){var i=new n(e);i.plmType=e.plmType?e.plmType:"Library",i.id=e.physicalid,i.isFavorite=!0,i.options.oldLabel=e.label,r.dataProvider.setIconsForLibraries&&r.dataProvider.setIconsForLibraries(i,r.getActiveView()),i.options.physicalid=e.physicalid,i.options.mxid=e.mxid,i.options.type=e.type,i._manageNLS=!0,(UWA.is(t,"array")?t.indexOf(e.physicalid)>=0:e.physicalid===t)&&o.push(i),a.push(i)}),r._endRefreshAndAddNodes(o,a),i.end()},_endRefreshAndAddNodes:function(e,t){this._isTreeViewType()&&this._listenEndUIRefreshEvent(),this.addRootNodes(t),this._endRefreshView(),e.length>0&&e.forEach(function(e){e.select()})},_isTreeViewType:function(){return"datagridview"===this.getActiveView()&&null!==this.getPADTreeListView()},_endLoadAndSelect:function(){var e=this.CSOProvider.getCurrentObject();null==e||e.noTree||r.notifyUpdateSearchVisibility(e)},_endContentSelect:function(){this.contentHandleRequest=null,this.infiniteScrollDone()},infiniteScrollDone:function(){var e=this.getActiveView();if("datagridview"===e){var t=this.getPADTreeListView(),i=t?t.getManager():null;i&&i.infiniteScrollProcessDone()}else{var n=null;"tileview"===e?n=this.getPADTileGridView().options.grid:"thumbnailview"===e&&(n=this.getPADThumbnailGridView().options.grid),n&&n.infiniteScrollProcessDone()}},_listenEndUIRefreshEvent:function(){var e=this.getPADTreeListView();e&&e.getManager().onPostUpdateViewOnce(function(){this.elements.columnsHeaderContainer&&this.elements.columnsHeaderContainer.setStyle("left",0)})},maskContentDiv:function(e){var t=this._contentDiv,i=t;t&&(i=t.getElement(".xnav_viewmain")),e?o.mask(i):o.isMasked(i)&&o.unmask(i)},_endRefreshView:function(){this.maskContentDiv(!1),null==this.CSOProvider.getCurrentObject()||this.CSOProvider.getCurrentObject().noTree||this.dispatchEvent("onCompleteRefreshNodes",this.CSOProvider.getCurrentObject().getID()),this.CSOProvider.getCurrentObject().noTree&&this.dispatchEvent("onCompleteRefreshNodes",null),d.isWebInWinEnvironment()&&c.publish("onLibraryEditorUIReady","")},removeNodeInContent:function(e){var t=this.getPADTreeDocument();t.getRoots().forEach(function(i){(i.id||i.getID()||"Attribute"===i.plmType&&i.getLabel())===e&&t.removeRoot(i)})},onDragStartCell:function(t,i){if(!this.DnDProvider.shouldAcceptDrag()||!e.is(i)||!0===i.isHeader)return t.preventDefault(),void t.stopPropagation();f.setDragData(t,i,this.CSOProvider,this.dataProvider)},onDragOverBlank:function(e){this._onDragOver(e)},onDragOverCell:function(e){this._onDragOver(e)},onDragOverColumnHeader:function(e){this._onDragOver(e)},_onDragOver:function(e){return e.preventDefault(),!0},onDropCell:function(e,t){if(this.dataProvider.isDNDSupported()){var i=t.nodeModel;this.DnDProvider.shouldAcceptDrop(i)?(f.performDropOnLibraryEditorNode(i,e,this.DnDProvider),e.preventDefault(),f.cleanDragData()):this.onDropBlank(e,t)}else u.displayNotification({message:g.msg_warning_dndnotsupported,className:"warning"})},onDropBlank:function(e,t){if(this.dataProvider.isDNDSupported()){var i=this.CSOProvider.getCurrentObject();if(i&&this.DnDProvider.shouldAcceptDrop()){try{f.performDropOnLibraryEditorNode(i,e,this.DnDProvider)}catch(e){u.displayNotification({message:g.msg_warning_dndnotsupported,className:"warning"})}e.preventDefault(),f.cleanDragData()}else u.displayNotification({message:g.msg_warning_dndnotsupported,className:"warning"}),e.preventDefault()}else u.displayNotification({message:g.msg_warning_dndnotsupported,className:"warning"})},onDropColumnHeader:function(e,t){return f.cleanDragData(),!0},_addPlaceHolder:function(){if(!d.isNatifEnvironnement()&&this.dataProvider.showContentPlaceholder&&this.dataProvider.showContentPlaceholder(this.leftTriptychElem)){var e=this.getActiveView(),t=a.isSearchActive(),i=this.CSOProvider.getCurrentObject().noTree?this.CSOProvider.getCurrentObject():this.CSOProvider.getCurrentObject().getType();if("datagridview"!==e){if((!t||t&&this.dataProvider.showSearchPlaceHolder&&this.dataProvider.showSearchPlaceHolder())&&("Library"===i||i.noTree)){var n;"tileview"===e?n=this.getPADTileGridView().options.grid.elements.scroller:"thumbnailview"===e&&(n=this.getPADThumbnailGridView().options.grid.elements.scroller);var r=n?n.getContent():null;r&&this._placeHolder&&this._placeHolder.elements.container.inject(r)}}else{var o=this.getPADTreeListView().getDatagridPlaceHolder()?this.getPADTreeListView().getDatagridPlaceHolder().getContent():null;o&&(t?t&&this.dataProvider.showSearchPlaceHolder&&this.dataProvider.showSearchPlaceHolder()&&o.isHidden()&&o.show():o.isHidden()&&o.show())}}},removePlaceHolder:function(){if(!d.isNatifEnvironnement()&&(this.dataProvider.showContentPlaceholder&&this.dataProvider.showContentPlaceholder(this.leftTriptychElem)))if("datagridview"!==this.getActiveView()){var e=document.querySelectorAll(".content-placeholder");if(e&&e.length>0){var t=Array.prototype.slice.call(e);t&&t.forEach(function(e){e.remove()})}}else{var i=this.getPADTreeListView().getDatagridPlaceHolder()?this.getPADTreeListView().getDatagridPlaceHolder().getContent():null;i&&(i.isHidden()||i.hide())}}})}),define("DS/IPClassifyUX/views/IPClassifyTagger",["UWA/Class","DS/IPClassifyUX/events/IPClassifyEvents","DS/TagNavigatorProxy/TagNavigatorProxy","DS/IPClassifyUX/views/IPClassifyWebInWinTaggerProxy","DS/WidgetServices/WidgetServices","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUtil/IPClassifyUtility","DS/FedDictionaryAccess/FedDictionaryAccessAPI"],function(e,t,i,n,r,a,o,s,l){"use strict";var d={},c={},u={};return e.extend({CONTENT_TYPES:{EMPTY:"empty"},_initTaggerProxy:function(){var e=this;if(r.isNatifEnvironnement()){window.widgetId||(window.widgetId="LibraryEditor"+Math.random().toString(36).substr(2,9)),(a=o(window.widgetId)).events.addFilterChangeListener=e.onFilterChange.bind(e),a.events.addCriteriaChangeListener=e.onFilterChange.bind(e),e.taggerProxy=new n(a)}else{var a=o(widget.id);(e.taggerProxy=i.createProxy(a)).addEvent("onFilterChange",e.onFilterChange.bind(e)),t.onTabChange(function(){e.taggerProxy.clearLocalFilter(),e.unsetTags(),e.deactivateTaggerProxy()})}function o(t){return{widgetId:t,filteringMode:"FilteringOnServer",colorize:!1,events:{addOpenTaggerListener:e.onOpenTagger.bind(e),addCloseTaggerListener:e.onCloseTagger.bind(e)}}}},_setSubjectTags:function(e,t,i){switch(this.containerType=t,t){case this.CONTENT_TYPES.EMPTY:this._setTagsForFavourites(e);break;default:this._setTagsForLibraries(e,i)}},getTranslationOfObject:function(e,t){let i=t[e];return i||e},applyTranslation:function(e,t){e.forEach(e=>{if(e.nlsKey){let i=t[e.nlsKey];if(i){let t=[];Array.isArray(e.object)?e.object.forEach(e=>{t.push(this.getTranslationOfObject(e,i))}):t=this.getTranslationOfObject(e.object,i),e.dispValue=t}}})},prepareForTranslation:function(e){var t={};return e&&e.forEach(e=>{if(e.sixw&&"date"!==e.type){let i=e.sixw.lastIndexOf("/"),n=i>0?e.sixw.substring(i+1):e.sixw;e.nlsKey=n;let r=t[n];r||(r=t[n]=[]),Array.isArray(e.object)?e.object.forEach(e=>r.push(e)):r.push(e.object)}}),t},translatePredicates:function(e){if(0===Object.keys(e).length)return;let t=this.prepareForTranslation(e);var i=this;return new Promise(n=>{l.getNlsOfPropertiesValues(JSON.stringify(t),{tenantId:r.getTenantID(),lang:r.getLanguage(),apiVersion:"R2019x",onComplete:function(t){i.applyTranslation(e,t),n()},onFailure:function(e){console.warn("IP Cannot retrieve NLS"),n()}})})},_setTagsForLibraries:async function(e,t){if(this.taggerProxy)if(e){var i={};for(var n in e){var r=e[n];if(i[r.sixw])i[r.sixw][r.object]=r;else{var l={};l[r.object]=r,i[r.sixw]=l}}var u=[];for(var h in i)for(var f in d[h]||(c[h]=i[h]),c[h])u.push(c[h][f]);t?(await this.translatePredicates(e),this.taggerProxy.setTags(null,e)):(await this.translatePredicates(u),this.taggerProxy.setTags(null,u))}else{this.taggerProxy.setTags({});let e=this.taggerProxy.getCurrentFilter();!(!e||!e.allfilters||0===Object.keys(e.allfilters).length)&&s.isIndexedMode()&&a.displayNotification({message:o.msg_warning_emptyResult_with_selected_tags,className:"warning"})}},_setTagsForFavourites:function(e){if(this.taggerProxy){this.taggerProxy.setTags({})}},activateTaggerProxy:function(){var e=this.taggerProxy;e&&e.activate()},deactivateTaggerProxy:function(){var e=this.taggerProxy;e&&e.deactivate()},unsetTags:function(){var e=this.taggerProxy;e&&e.unsetTags()},onFilterChange:function(e){if(e){for(var i in d={},e.allfilters)d[i]=[];return u=e.allfilters,t.notifyCurrentLibraryFilterChange(),!0}},onOpenTagger:function(){t.notifyTaggerOpen()},onCloseTagger:function(){t.notifyTaggerClose()},_getCurrentFilter:function(){return u}})}),define("DS/IPClassifyUX/service/PlatformServices",["UWA/Core","UWA/Promise","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/IPClassifyUX/service/SettingsManagement"],function(e,t,i,n){"use strict";var r=function(){};return r.prototype.initializePlatform=function(e){var t=this;i.getPlatformServices({onComplete:function(i){if(null===i){i.options=e;var r=e.onFailure;r&&r("cannot retrieve platform data")}else{for(var a={},o=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",s=0;s<i.length;s++)i[s].platformId===o&&(t.platformurls=a.platformurls=i[s]);n.addSetting("platformServices",t),a.options,(0,e.onComplete)(a)}},onFailure:function(t){var i=e.onFailure;i&&i(t)}})},r}),define("DS/IPClassifyUX/IPClassifyUXEvents",["UWA/Class","DS/IPClassifyUX/events/IPClassifyEvents"],function(e,t){return e.singleton({notifyLibrarySelected:function(e){t.notifyLibrarySelected(e)},onLibrarySelected:function(e){t.onLibrarySelected(e)},onContentSearchChange:function(e){t.onContentSearchChange(e)},notifyCurrentLibraryChange:function(e){t.notifyCurrentLibraryChange(e)}})}),define("DS/IPClassifyUX/LibraryIdCardCont",["DS/IPClassifyUXUtil/ActionBar/IPToolbar","UWA/Class/Options","DS/IPClassifyUX/views/LibraryMode","DS/IPClassifyUX/models/LibraryInfo","DS/PADUtils/PADProbes","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUX/models/LibrarySearchModel","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUtil/OpenWithMenuBuilder","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUXUtil/ActionBar/IPClassifyTabBar","DS/IPClassifyUX/IPClassifyUXEvents"],function(e,t,i,n,r,a,o,s,l,d,c,u,h){"use strict";var f=null,g=void 0;return e.extend(t,{name:"LibraryIdCardController",_probeLoadElmt:null,_commandManager:null,_libraryControl:null,_libraryCSO:null,_libraryTypeService:null,getCommandManager:function(){return this._commandManager},needSep:function(){return!f.needSep||f.needSep()},getInfoVisibility:function(){return!f.showInformationCommand||f.showInformationCommand()},getStableAreaWidth:function(){var e=this._libraryCSO.getCurrentObject();return f.getStableAreaWidth?f.getStableAreaWidth(this.isSearchAvailable(),e):void 0},shouldMove:function(){return g},isTreeViewVisible:function(){var e=c.getWidgetData();return e&&e.showTreeView},getSearchWithinController:function(){return f.getSearchWithinController?f.getSearchWithinController():null},handleChange:function(){return f.getClassAttributeSearch?f.getClassAttributeSearch.bind(f):o.changeSearch.bind(o)},createPathInfo:e=>new n({id:e.id,mxid:e.mxid,type:e.type,label:e.label,getChildrenInfos:f.getChildrenInfos}),getEntryForCommand:e=>{var t=null,n=c.getWidgetData().currentWidgetTab;return"IndexMode"===e&&(0==n||f.isIndexModeVisible&&f.isIndexModeVisible(n))&&(t=i.getToolbarEntry()),"openWith"===e&&(t={id:"openWith",plmType:"",dataElements:{typeRepresentation:"functionMenuIconCount",tooltip:l.OpenWith,label:l.OpenWith,icon:{iconName:"open-menu-dot",fontIconFamily:1},value:{menu:[]},position:"far"}}),t},buildOpenWithMenuItems:function(e,t){if(Array.isArray(t)&&0!=t.length&&null!=t[0]&&null!=t[0]&&1!=t[0].noTree&&"Attribute"!=t[0].plmType&&t[0].getLabel()){var i=this;t||(t=this._libraryCSO.getSelectedNodes());var n="";try{t[0].options&&(n=t[0].options.type),n&&!["General Library","Part Library","RootLibrary","General Class","Library"].includes(n)||(n="CLASSIFICATION_NODE")}catch(e){console.log(e),n="CLASSIFICATION_NODE"}if(i.toolbars.unstable){var r={data:{menu:[]}};if(!e||t.length>1||!t[0].options||!t[0].options.mxid)i.toolbars.unstable.updateNodeModel("openWith",{grid:r,visibleFlag:!1,menuSave:r.data.menu,visitedType:n});else{var a=i.toolbars.unstable.getNodeModelByID("openWith"),o=a.options.visitedType;if(n!=o||0==a.options.grid.data.menu.length)d.openWithApps(t,{iconOpenWith:{iconName:"open-menu-dot",fontIconFamily:1},nlsOpenWith:l.OpenWith},"ClassificationEditorWidget_openwith").then(function(e){e[0]&&e[0].submenu&&e[0].submenu.forEach(function(e){r.data.menu.push(e)}),i.toolbars.unstable.updateNodeModel("openWith",{grid:r,menuSave:r.data.menu,visibleFlag:r.data.menu.length>0,visitedType:n})})}}}},getSizes:function(){var e=[];return e=widget.getValue("x3dSharedId").startsWith("ClassificationEditor")?["102px","102px"]:this.isSearchAvailable()?["176px","175px"]:["147px","147px"],this._parent(e)},buildTabBar(e){this.tabProvider&&(this.IPClassifyTabBar=new u({tabIdCard_container:this.defaultTabIdCardCont?this.defaultTabIdCardCont:e,dataProvider:f,tabBarProvider:this.tabProvider,unsubscribeAll:s.unsubscribeAll.bind(s),notifyTabChange:s.notifyTabChange.bind(s),getCurrentWidgetTab:c.getCurrentWidgetTab.bind(c),setCurrentWidgetTab:c.setCurrentWidgetTab.bind(c)}),g||(this.IPClassifyTabBar.tabBar.elements.container.style.height="0px"))},init:function(e){this._probeLoadElmt=r.createProbe("loadIdCard"),this._libraryCSO=e.libraryCSODataProvider,f=e.libraryDataProvider,g=e.canMoveBreadCrumb,this._commandManager=f.getCommandManager&&f.getCommandManager(),this._libraryControl=f.getLibraryControl&&f.getLibraryControl(),this._libraryTypeService=f.getLibraryTypeService&&f.getLibraryTypeService(),this._libraryControl.setIdCardCont(this),this.tabProvider=e.TabBarProvider,this.defaultTabIdCardCont=e.TabCont,i.setLibraryControl(this._libraryControl),widget.addEvent("ontoolbarReady",()=>{this._libraryIdCardView=this._libraryControl.getContent().getView();var t=this._libraryIdCardView.getActiveView(),i=this._commandManager.getCommand(t);i&&i.options.icon&&e.modelEvents.publish({event:"toolbar_update_command",data:{commandID:"display",data:{icon:{iconName:i.options.icon,fontIconFamily:1}}}})});var t=this,n=e.leftState,o=e.rightState;if(e.leftOpened=n&&n.leftPanelState,e.rightOpened=o&&o.rightPanelState,e.modelEvents=a.getModelEvents(),e.searchInCurrentTab=!0,this._parent(e),e.modelEvents.subscribe({event:"searchValueSet"},t.handleChange()),h.onLibrarySelected(()=>{t.getCommandManager().updateCommands()}),s.onEmptySearchQuery(function(){e.modelEvents.publish({event:"searchUpdated",data:null}),e.modelEvents.publish({event:"searchValueSet",data:null})}),s.onContentTabChange(function(){t.getCommandManager().updateCommands()}),s.onCurrentLibraryChange(function(e){var i=r.createProbe("idcard_updateUI");t.setCurrentLocation(),i.end()}),e.modelEvents.subscribe({event:"build_openwith"},e=>{t.toolbars.unstable&&t.toolbars.unstable.getNodeModelByID("openWith")&&t.buildOpenWithMenuItems(e.visible,e.nodes)}),t.dispatchEvent.call(this,"onReady"),1==g)this.elements.elementStableCommands.setStyles({"flex-basis":"auto"}),this.elements.flexToolbar.getChildren()[0].getChildren()[0].setStyles({width:"70%"});else if(this.tabProvider){this.elements.container.getParent().style.height="60px";var l=document.querySelector(".wux-controls-buttongroup.wux-controls-abstract");if(l){var d=l.getChildren();for(let e=0;d&&e<d.length>0;e++)d[e].setStyles({"font-size":"14px",color:"#878787","font-family":"Arial,sans-serif"})}}f.isSearchBoxAvailable&&0==f.isSearchBoxAvailable()&&document.querySelector(".searchFlex.centerMe").setStyles({display:"none"});t._probeLoadElmt.end()},inject:function(){this._parent.apply(this,arguments),this.setCurrentLocation()},setCurrentLocation:function(){var e=this._libraryCSO.getCurrentObjectPath();this._parent({objectPath:e})},isSearchAvailable:function(e){return f.showSeachCommand?f.showSeachCommand():(e||(e=this._libraryCSO.getCurrentObject()),!(!e||1==e.noTree)&&(!this._libraryTypeService.isSection(e.getType())&&e.options.mxid))},render:function(){return this}})}),define("DS/IPClassifyUX/views/IPClassifyModeSwitch",["UWA/Core","UWA/Controls/Abstract","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX"],function(e,t,i,n,r){"use strict";return t.extend({init:function(e){var t=this;this._parent(e);var a=document.querySelectorAll(".switchMode_container");if(a&&a.length>0){var o=Array.prototype.slice.call(a);o&&o.forEach(function(e){e.remove()})}this.switchModeContainer=UWA.createElement("div",{class:"switchMode_container"}).inject(e.idCardContainer),this.elements.modeSwitchHolder=new UWA.createElement("div",{class:"generic-icon",attributes:{title:r.command_Index_Auth_mode_switch},events:{click:function(){const e=t.switchModeContainer.querySelector(".generic-icon");e&&!e.hasClassName("disable")&&(e.hasClassName("fonticon-database-refresh")?(i.setAuthoringMode("authoring"),i.refreshViewOfWidget()):(e.hasClassName("fonticon-database-hourglass")||e.hasClassName("fonticon-database"))&&(i.setAuthoringMode("index"),i.refreshViewOfWidget()))}}}).inject(t.switchModeContainer);var s=this.switchModeContainer.getElement(".generic-icon");if(s){var l=i.determineCurrentModeState();"index"===l?s.addClassName("fonticon fonticon-database-refresh"):"authoring"===l?(s.addClassName("fonticon fonticon-database-hourglass"),s.addClassName("hoverGlass"),i.setAuthoringMode("authoring",!1,!0)):"neverIndexMode"===l?(s.addClassName("fonticon fonticon-database"),s.addClassName("hoverGlass")):"useOnlyAuthoring"===l&&(s.addClassName("fonticon fonticon-database"),s.addClassName("hoverGlass"),s.addClassName("disable")),t.setIndexDbIconTooltip(s)}n.onModeChange(function(e){var n=e.switchMode;const r=i.determineCurrentModeState();n&&("authoring"===n&&"neverIndexMode"===r?t.setNeverIndexModeIcon():"useOnlyAuthoring"===r?t.setOnlyAuthoringModeIcon():"authoring"===n?t.setAuthoringModeIcon():t.setIndexModeIcon())})},setIndexDbIconTooltip(e){e.onmouseover=function(t){const n=i.determineCurrentModeState(),a=i.determineAuthoringMode();let o,s=(new Date).getTime()-i.getFullViewLoadInfo().last_refreshed;if(s>=6e4)var l=Math.abs(Math.round(s/6e4));else var d=Math.abs(Math.round(s/1e3));s=void 0!==l?l:d;let c=i.getLastIndexedTime();"index"===n&&"authoring"!==a?(o=void 0!==l?r.get("tooltip_index_mode_last_update_minute"):r.get("tooltip_index_mode_last_update_seconds"),l&&l>1&&(o=r.get("tooltip_index_mode_last_update_minutes")),e.title=r.replace(o,{time:s,lastIndexed:c})):"authoring"===a&&"neverIndexMode"===n?(o=void 0!==l?r.get("tooltip_never_use_index_minute"):r.get("tooltip_never_use_index_seconds"),l&&l>1&&(o=r.get("tooltip_never_use_index_minutes")),e.title=r.replace(o,{time:s,lastIndexed:c})):"authoring"===a&&"useOnlyAuthoring"===n?(o=void 0!==l?r.get("tooltip_never_use_index_minute"):r.get("tooltip_never_use_index_seconds"),l&&l>1&&(o=r.get("tooltip_never_use_index_minutes")),e.title=r.replace(o,{time:s,lastIndexed:c})):"authoring"===a&&(o=void 0!==l?r.get("tooltip_authoring_mode_back2index_minute"):r.get("tooltip_authoring_mode_back2index_seconds"),l&&l>1&&(o=r.get("tooltip_authoring_mode_back2index_minutes")),e.title=r.replace(o,{time:s,indexTime:widget.getValue("intervalToSwitchMode")/60,lastIndexed:c}))}},setAuthoringModeIcon(){let e=this.switchModeContainer.querySelector(".generic-icon");null!==e&&(e.classList.remove("fonticon-database-refresh"),e.classList.remove("fonticon-database"),e.classList.remove("disable"),e.classList.add("fonticon-database-hourglass"),e.classList.add("hoverGlass"))},setIndexModeIcon(){let e=this.switchModeContainer.querySelector(".generic-icon");null!==e&&(e.classList.remove("fonticon-database-hourglass"),e.classList.remove("hoverGlass"),e.classList.remove("fonticon-database"),e.classList.remove("disable"),e.classList.add("fonticon-database-refresh"))},setNeverIndexModeIcon(){let e=this.switchModeContainer.querySelector(".generic-icon");null!==e&&(e.classList.remove("fonticon-database-hourglass"),e.classList.remove("fonticon-database-refresh"),e.classList.remove("disable"),e.classList.add("fonticon-database"),e.classList.add("hoverGlass"))},setOnlyAuthoringModeIcon(){let e=this.switchModeContainer.querySelector(".generic-icon");null!==e&&(e.classList.remove("fonticon-database-hourglass"),e.classList.remove("fonticon-database-refresh"),e.classList.add("fonticon-database"),e.classList.add("hoverGlass"),e.classList.add("disable"))}})}),define("DS/IPClassifyUX/views/LibraryOrderCmdView",["UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/IPClassifyUX/events/IPClassifyEvents"],function(e,t,i,n,r){"use strict";return e.extend(t,i,{_name:"library_orderTools",_defaultOptions:{sortMode:"alpha",sortOrder:"asc"},init:function(e){this._parent(e),this.sortMode=widget.getValue("sortMode")||this._defaultOptions.sortMode,this.sortOrder=widget.getValue("order")||this._defaultOptions.sortOrder,this._buildSkeleton()},getSortModel:function(e){let t=this;var i=this._getalphaIcon(),r=this._getdateSortingIcon();return{id:"alphaSortingContainer",dataElements:{label:n.fonticon_sort,typeRepresentation:"functionMenuIcon",value:{menu:[{id:"alphaSort",type:"PushItem",title:n.alpha_sorting,icon:i,action:{callback:function(){t.changeAlphaIcon(e,i)}}},{id:"dateSort",type:"PushItem",title:n.date_sorting,icon:r,tooltip:"Creation Date",action:{callback:function(){t.changeDateIcon(e)}}}]},icon:i,position:"far",category:"1"}}},_buildSkeleton:function(){this.elements.container=UWA.createElement("div",{id:"library_orderTools"})},changeDateIcon:function(e){var t=this._getdateSortingIcon();e.leftToolbar.updateNodeModel("dateSort",{icon:t}),this.toggleButtonDate(),t=this._getdateSortingIcon(),e.leftToolbar.updateNodeModel("alphaSortingContainer",{icon:t})},changeAlphaIcon:function(e){var t=this._getalphaIcon();e.leftToolbar.updateNodeModel("alphaSort",{icon:t}),this.toggleButton(),t=this._getalphaIcon(),e.leftToolbar.updateNodeModel("alphaSortingContainer",{icon:t})},toggleButton:function(){this.sortMode="alpha",this.sortOrder&&("asc"===this.sortOrder?this.sortOrder="desc":this.sortOrder="asc"),widget.setValue("sortMode",this.sortMode),widget.setValue("order",this.sortOrder),this.sortingNodesUnsensitiveCase()},toggleButtonDate:function(){this.sortMode="date",this.sortOrder&&("asc"===this.sortOrder?this.sortOrder="desc":this.sortOrder="asc"),widget.setValue("sortMode",this.sortMode),widget.setValue("order",this.sortOrder),this.sortingNodesUnsensitiveCase()},getSortMode:function(){return this.sortMode},_getalphaIcon:function(){return{iconName:"desc"==this.sortOrder?"alpha-sorting-z-a":"alpha-sorting-a-z",fontIconFamily:1}},_getdateSortingIcon:function(){return{iconName:"desc"==this.sortOrder?"num-sorting-2-1":"num-sorting-1-2",fontIconFamily:1}},sortingNodesUnsensitiveCase:function(){r.notifyTreeSortChange({sortOrder:this.sortOrder,sortMode:this.sortMode})}})}),define("DS/IPClassifyUX/views/LibraryIdCardView",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","DS/IPClassifyUX/models/LibraryBreadcrumbModel","DS/IPClassifyUX/views/LibrarySearchInContext","DS/IPClassifyUX/views/IPClassifyModeSwitch","DS/ENOXPageToolBar/js/PageToolBar","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/IPClassifyUXUtil/ActionBar/IPClassifyTabBar","DS/IPClassifyUX/views/LibraryBreadcrumbView","DS/IPClassifyUX/utils/IPClassifyWidgetData"],function(e,t,i,n,r,a,o,s,l,d,c,u){"use strict";return t.extend(i,{name:"LibraryIdCardView",_currentPathNodes:null,_pageToolBar:null,_parentDiv:null,init:function(e){this._parent(e),this._parentDiv=e.parentDiv,this.CSOProvider=e.CSOProvider,this.dataProvider=e.dataProvider,this.IconBarProvider=e.IconBarProvider,this.tabBarProvider=e.TabBarProvider,this.tabBarProvider&&this.tabBarProvider.getTabBars||(this._libraryBreadcrumbView=new c(e)),this._buildSkeleton()},_buildSkeleton:function(){if(this.topRightSideDiv=this._parentDiv,!e.is(this.elements.container)){this.elements.container=UWA.createElement("div",{class:this.getClassNames()}),this.getOption("css_view_class")&&this.elements.container.addClassName(this.getOption("css_view_class")),this.tabBarProvider&&this.tabBarProvider.getTabBars?(this.elements.TabIdCard_container=UWA.createElement("div",{class:"LibraryEditor_tab_IdCard"}).inject(this.elements.container),this.ipClassifyTabBar=new d({tabIdCard_container:this.elements.TabIdCard_container,dataProvider:this.dataProvider,tabBarProvider:this.tabBarProvider,unsubscribeAll:s.unsubscribeAll.bind(s),notifyTabChange:s.notifyTabChange.bind(s),getCurrentWidgetTab:u.getCurrentWidgetTab.bind(u),setCurrentWidgetTab:u.setCurrentWidgetTab.bind(u)})):this.elements.titleIdCard_container=UWA.createElement("div",{class:"LibraryEditor_title_IdCard"}).inject(this.elements.container);var t={withInformationButton:!0,withWelcomePanelButton:!this.tabBarProvider||!this.tabBarProvider.getTabBars,parentContainer:this._parentDiv,modelEvents:s.getModelEvents()};this._pageToolBar=new o(t),this._pageToolBar.render().inject(this._parentDiv);var i=this._pageToolBar.getBodyContent();this.elements.container.inject(i),this.topRightSideDiv.addEventListener("contextmenu",this._rightClick)}},buildSearch:function(){var e=this;this.dataProvider.isSearchInContextAvailable&&!this.dataProvider.isSearchInContextAvailable()||(this.elements.searchInContext=new r({events:{onSearchSwitch:function(t){var i=!1;(document.body.hasClassName("LibraryEditor_SearchActive")&&!t||!document.body.hasClassName("LibraryEditor_SearchActive")&&t)&&(i=!0),t?UWA.extendElement(document.body).addClassName("LibraryEditor_SearchActive"):UWA.extendElement(document.body).removeClassName("LibraryEditor_SearchActive"),i&&setTimeout(function(){e.actionBar._iconBar.show(),e.updateDisplayPath()},100)}}}).hide(),this.elements.searchInContext.inject(this.elements.container))},buildModeSwitcher:function(){l.isModeSwitcherEnabled()&&(this.elements.modeSwitcher=new a({idCardContainer:this.elements.container}))},buildIconBar:function(e,t,i,n,r,a){var o=document.querySelectorAll(".LibraryEditor_IdCard_IconBar");if(o&&o.length>0){var s=Array.prototype.slice.call(o);s&&s.forEach(function(e){e.remove()})}this.elements.toolbar=UWA.createElement("div",{class:"LibraryEditor_IdCard_IconBar"}).inject(this.elements.container),this.IconBarProvider.getCommandsIconBar()&&(this.actionBar=this.IconBarProvider.getCommandsIconBar().render(e,t,i,n,r,a),this.actionBar.inject(this.elements.toolbar),this.buildSearch(),this.buildModeSwitcher())},updateCommandVisibilityInIconBar:function(e,t,i,n,r){this.actionBar.updateCommandVisibilityInIconBar(e,t,i,n,r)},updateDisplayPath:function(){this.tabBarProvider&&this.tabBarProvider.getTabBars||this._LibraryPathNavigator&&this._LibraryPathNavigator._resize(n.getPathNodes())},render:function(){return this},_rightClick:function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1},getActionBar:function(){return this.actionBar},switchSearch:function(e){this.elements.searchInContext&&this.elements.searchInContext.switchSearch(e)},setCurrentLocation:function(){this._libraryBreadcrumbView.setCurrentLocation(this.elements)},manageSearchVisibility:function(){this._libraryBreadcrumbView.manageSearchVisibility()},_isSearchAvailable:function(){this._libraryBreadcrumbView._isSearchAvailable()}})}),define("DS/IPClassifyUX/LibraryIdCard",["UWA/Core","UWA/Class","DS/IPClassifyUX/views/LibraryIdCardView","DS/IPClassifyUX/models/LibraryBreadcrumbModel","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUX/views/LibraryPathNavigator","DS/IPClassifyUX/views/LibrarySearchInContext","DS/PADUtils/PADProbes","DS/IPClassifyUX/utils/IPClassifyWidgetData","css!DS/IPClassifyUX/IPClassifyUX"],function(e,t,i,n,r,a,o,s,l,d){"use strict";return t.extend({name:"LibraryIdCardController",_probeLoadElmt:null,_libraryIdCardView:null,init:function(e){this._probeLoadElmt=s.createProbe("loadIdCard"),this._libraryIdCardView=new i(e),this._OnIdCardComponentReady(),this.dataProvider=e.dataProvider,this.CSOProvider=e.CSOProvider,this.tabProvider=e.TabBarProvider,this._libraryIdCardView.dispatchEvent.call(this._libraryIdCardView,"onReady")},_OnIdCardComponentReady:function(){var e=this,t=null;e._attributesTabSelected=!1,r.onCurrentLibraryChange(function(i){t=i,e._libraryIdCardView.getActionBar()?e._libraryIdCardView.updateCommandVisibilityInIconBar(i.currentNode,"TREE",i.currentNode):e._libraryIdCardView.buildIconBar(i.currentNode,"TREE",i.currentNode),e.switchSearch(!1),e.setCurrentLocation()}),r.onLibrarySelected(function(i){t=i;var n=e.CSOProvider.getCurrentObject(),r=e.CSOProvider.getSelectedNodes().length;e._libraryIdCardView.getActionBar()?e._attributesTabSelected?1===l.getWidgetData().currentTab?e._libraryIdCardView.buildIconBar(i.selectedNode,i.context,n,l.getWidgetData().currentTab,i.allSelectNodes,r):e._libraryIdCardView.buildIconBar(i.selectedNode,i.context,n,null,i.allSelectNodes,r):e._libraryIdCardView.updateCommandVisibilityInIconBar(i.selectedNode,i.context,n,i.allSelectNodes,r):e._libraryIdCardView.buildIconBar(i.selectedNode,i.context,n,null,null,null)}),r.onContentTabChange(function(){var i=l.getWidgetData();1===i.currentTab?e._attributesTabSelected=!0:e._attributesTabSelected=!1,e._libraryIdCardView.buildIconBar(t.currentNode,"TREE",t.currentNode,i.currentTab)}),r.onUpdateSearchVisibility(function(t){e.manageSearchVisibility(t)}),e._probeLoadElmt.end()},setCurrentLocation:function(){this.tabProvider&&this.tabProvider.getTabBars||this._libraryIdCardView.setCurrentLocation()},switchSearch:function(e){this._libraryIdCardView.switchSearch(e)},manageSearchVisibility:function(e){this.tabProvider&&this.tabProvider.getTabBars||this._libraryIdCardView.manageSearchVisibility(e)},updateDisplayPath:function(){this._libraryIdCardView.updateDisplayPath(n.getPathNodes())},getView:function(){return this._libraryIdCardView}})}),define("DS/IPClassifyUX/views/LibraryLeftSidePanelView",["UWA/Core","UWA/Controls/Abstract","DS/PADUtils/PADContext","DS/IPClassifyUX/events/IPClassifyEvents","DS/PADServices/utils/GlobalModelEvents"],function(e,t,i,n,r){"use strict";return t.extend({_callbackAdd:!1,_context:null,_padshell:null,_modelEvent:null,_libraryEditorUtil:null,_libraryControl:null,_dataProvider:null,init:function(e){this._parent(e,{}),this._context=i.get(),this._padshell=e.padshell,this._modelEvent=r.getModelEvents(),this._libraryEditorUtil=e.dataProvider.getLibraryEditorUtil&&e.dataProvider.getLibraryEditorUtil(),this._libraryControl=e.dataProvider.getLibraryControl&&e.dataProvider.getLibraryControl(),this._dataProvider=e.dataProvider,this.addCallback(e)},updatePanelVisibility:function(e,t){"left"===t&&(this.setPreferences(),this._libraryControl&&this._libraryControl.getIdCardCont()&&this._libraryControl.getIdCardCont().updateLeftPanelIcon(e))},addCallback:function(){var e=this;!1===e._callbackAdd&&this._padshell&&this._padshell._modelEvents&&(this._padshell._modelEvents.subscribe({event:"triptych-panel-hidden"},e.updatePanelVisibility.bind(this,!1)),this._padshell._modelEvents.subscribe({event:"triptych-panel-visible"},e.updatePanelVisibility.bind(this,!0)),this._modelEvent.subscribe({event:"welcome-panel-collapse"},function(){e._mode="close",e._padshell.togglePanel("left"),e._modelEvent.publish({event:"welcome-panel-collapsed"}),e.setPreferences()}),this._modelEvent.subscribe({event:"welcome-panel-expand"},function(){e._mode="open",e._padshell.togglePanel("left"),e._modelEvent.publish({event:"welcome-panel-expanded"}),e.setPreferences()}),n.onTaggerOpen(function(){e._padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),e._modelEvent.publish({event:"welcome-panel-collapsed"})}),n.onTaggerClose(function(){e._mode&&"open"!==e._mode||!e._dataProvider.hasWelcomePanel||!e._dataProvider.hasWelcomePanel()?(e._padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),e._modelEvent.publish({event:"welcome-panel-collapsed"})):(e._padshell._modelEvents.publish({event:"triptych-show-panel",data:"left"}),e._modelEvent.publish({event:"welcome-panel-expanded"}))}),this._callbackAdd=!0)},setPreferences:function(){var e=this._context.elements.padshell.getLeftOpen(),t={leftPanelState:e,isWelcomePanelCollapsed:!e};this._libraryEditorUtil&&this._libraryEditorUtil.setLeftPanelStatus&&this._libraryEditorUtil.setLeftPanelStatus(t),e?this._modelEvent.publish({event:"welcome-panel-expanded"}):this._modelEvent.publish({event:"welcome-panel-collapsed"})}})}),define("DS/IPClassifyUX/LibraryContent",["UWA/Class","DS/Logger/Logger","DS/IPClassifyUX/views/LibraryContentView","DS/IPClassifyUX/models/LibraryContentModel","DS/IPClassifyUX/views/IPClassifyTagger","DS/IPClassifyUX/events/IPClassifyEvents","DS/PADUtils/PADProbes","DS/WidgetServices/WidgetServices","DS/PADServices/utils/AttributesMgtV2","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/PADSession","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUX/views/InformationsPanelView","DS/IPClassifyUX/service/PlatformServices","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","i18n!DS/SNResultUX/assets/nls/SNResultUX","DS/IPClassifyUX/models/LibrarySearchModel","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUX/utils/IPClassifyModeManager","css!DS/IPClassifyUX/IPClassifyUX","DS/IPClassifyUX/views/additionalData/ThumbnailAttribute","DS/IPClassifyUX/views/LibraryLeftSidePanelView","DS/IPClassifyUX/views/LibraryBreadcrumbView"],function(e,t,i,n,r,a,o,s,l,d,c,u,h,f,g,p,_,b,m,v,C,y,S,P){"use strict";var I=e.extend({name:"LibraryContentController",_tagNavigator:null,_libraryContentView:null,_infoPanelView:null,_refreshProductStructure:!1,_LibraryLeftPanel:null,init:function(e){this._probeLoadElmt=o.createProbe("loadComponent"),this.leftTriptychElem=e.leftTriptychElem;var n=this;e.additionalColumnsModules||(e.additionalColumnsModules=[]),e.thumbnailAttributeDelayed&&e.additionalColumnsModules.push(y),this.dataProvider=e.dataProvider,this.leftState=e.leftState,this.rightState=e.rightState,this.showBreadcrumb=e.showBreadcrumb,this.CSOProvider=e.CSOProvider,a.onContentReady(function(){n._OnPADComponentReady()}),this.showBreadcrumb&&(e._libraryBreadcrumbView=this._libraryBreadcrumbView=new P(e)),this._libraryContentView=new i(e),this._logger=t.getLogger(I)},_OnPADComponentReady:function(){var e=this;e._LibraryLeftPanel=new S({padshell:e._libraryContentView.elements.padshell,dataProvider:e.dataProvider}),!e.leftState||e.leftState.isWelcomePanelCollapsed||e.showBreadcrumb?(e.getView().elements.padshell.togglePanel("left"),e._mode="load",a.onPageToolBarExpand(function(){"load"!=e._mode&&(e._mode="open",e.getView().elements.padshell.togglePanel("left"),a.notifyPageToolBarExpanded())}),a.onPageToolBarCollapse(function(){e._mode="close",e.getView().elements.padshell.togglePanel("left"),a.notifyPageToolBarCollapse()}),a.onTaggerOpen(function(){e.getView().elements.padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),a.notifyPageToolBarCollapse()}),a.onTaggerClose(function(){"open"===e._mode?(e.getView().elements.padshell._modelEvents.publish({event:"triptych-show-panel",data:"left"}),a.notifyPageToolBarExpanded()):(e.getView().elements.padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),a.notifyPageToolBarCollapse())})):e.getView().elements.padshell.togglePanel("left"),e._tagNavigator=new r,e._tagNavigator._initTaggerProxy(),this.dataProvider.showClassTabs&&this.dataProvider.showClassTabs()&&e._libraryContentView.addTabPages(),e.showBreadcrumb&&e._libraryContentView.showBreadCrumb(),e._libraryContentView.cleanColumns(),y.setCheckToShowThumbnail(e._libraryContentView.toShowThumbnail.bind(e._libraryContentView)),e._libraryContentView.addEvent("onToggleView",function(){e._libraryContentView.setTabStyleOnView(),e.loadContentAndSelect()}),l.getAvailableColumnsOpts()&&e.dataProvider.setColumnNames&&e.dataProvider.setColumnNames(l.getAvailableColumnsOpts(),l.getTreeColumn()),b.onSearchChange(function(t,i){e.loadContentAndSelect()}),a.onCurrentLibraryChange(function(t){e._libraryContentView.options.model.getModelEvents().publish({event:"titleRecalc",data:t.currentNode.getLabel()}),b.getSearchValue()&&a.notifyOnEmptySearchQuery(),e._isColumnUnderProcessing=!0,e.dataProvider.getTabsVisOnSelectionChange&&e._libraryContentView.setTabsVis(e.dataProvider.getTabsVisOnSelectionChange()),e._isColumnUnderProcessing=!1,e.loadContentAndSelect(this),e.showBreadcrumb&&e._libraryBreadcrumbView.setCurrentLocation(e._libraryContentView.elements)}),a.onLibraryRename(function(t){var i=t.oldNode.getLabel();null!=e.CSOProvider.getCurrentObject()&&t.oldNode.id===e.CSOProvider.getCurrentObject().getID()&&UWA.is(widget)&&e._libraryContentView.options.model.getModelEvents().publish({event:"titleRecalc",data:i})}),a.onCurrentLibraryFilterChange(function(){e.loadContentAndSelect(null,null,!1,!0)}),a.onCurrentLibraryColumnChange(function(){e.loadContentAndSelect(null,null)}),a.onRemoveNodeInContent(function(t){e.getView().removeNodeInContent(t)}),a.onScrollEnd(function(){n.isMoreDataToFetch()?n.isFetchInProgress()||(n.setFetchInProgress(!0),e.loadContentAndSelect(null,null,!0)):e._libraryContentView.infiniteScrollDone()}),a.onContentTabChange(function(){e._isColumnUnderProcessing=!0,e._libraryContentView.removeNodesInContent(),e._libraryContentView.toggleView("treeview"),e._libraryContentView.loadNewColumns(),e._isColumnUnderProcessing=!1,e.loadContentAndSelect(null,null)}),a.onColumnSortChange(function(){e._libraryContentView.saveSortModelInCache(),e.dataProvider.reloadAfterSort&&0==e.dataProvider.reloadAfterSort()||e.loadContentAndSelect(null,null)}),a.onFavoriteSectionEmpty(function(){e.managePlaceholderDisplay(0)&&e.getView()._addPlaceHolder()}),e._libraryContentView.setSortOnColumn().then(function(){var t=e.CSOProvider.getCurrentObject();null!=t&&(t.noTree?e.loadContentAndSelect(t):(e.dataProvider.getTabsVisOnSelectionChange&&e._libraryContentView.setTabsVis(e.dataProvider.getTabsVisOnSelectionChange()),e._libraryContentView.options.model.getModelEvents().publish({event:"titleRecalc",data:e.CSOProvider.getCurrentObject().getLabel()}),e.loadContentAndSelect(t)))});var t=c.isIndexedMode();u.setAuthoringState(!t),e.dataProvider.hasLibrarianRole().then(function(t){(new g).initializePlatform({onComplete:function(i){e._infoPanelView=new f({padshell:e._libraryContentView.elements.padshell,CSOProvider:e.CSOProvider,securityContext:h.getSetting("pad_security_ctx"),platformUrls:i.platformurls,readOnly:t.readOnly,dataProvider:e.dataProvider})}})}).catch(function(e){console.log(e)});var i=widget.getValue("customLeftWidth");e._libraryContentView._addStyleOnTreeCont(i),null!=i&&e._libraryContentView.elements.padshell._modelEvents.publish({event:"triptych-set-size",data:{side:"left",size:i}}),e._libraryContentView.elements.padshell._modelEvents.subscribe({event:"triptych-panel-show-started"},function(t){"left"===t&&e._libraryContentView._addStyleOnTreeCont()}),e._libraryContentView.elements.padshell._modelEvents.subscribe({event:"triptych-panel-visible"},function(e){"left"===e&&s.clearJSStylesheet("treeContResize")}),e._libraryContentView.elements.padshell._modelEvents.subscribe({event:"triptych-resized"},function(e){"left"===e.side&&widget.setValue("customLeftWidth",e.width)}),a.notifyPageToolBarExpand(),null!=this.leftTriptychElem?this.getView().elements.padshell._modelEvents.publish({event:"triptych-show-panel",data:"left"}):this.getView().elements.padshell._modelEvents.publish({event:"triptych-hide-panel",data:"left"}),this.dataProvider.getFilterOptions&&this._libraryContentView.setFilterModel(this.dataProvider.getFilterOptions()),this._probeLoadElmt.end()},webInWinCtxMenu:function(e,t){this._libraryContentView.showWebInWinCtxMenu(e,t)},onWebInWinFilterChange:function(e){this._tagNavigator.onFilterChange(e.data)},updateFilterBI:function(e){e?this._tagNavigator||(this._tagNavigator=new r,this._tagNavigator._initTaggerProxy()):this._tagNavigator&&this._tagNavigator.unsetTags(),u.setAuthoringState(!e);var t=this._libraryContentView.getPADTreeDocument();null!==t&&(t.options.filterBIComponentProxy=this._tagNavigator)},updateComputedColumns:function(){this._libraryContentView.setSortingForComputedAttrs()},loadContentAndSelect:function(e,t,i,n,r){var a,s,l,d=this;if(!d._isColumnUnderProcessing)return!0!==i&&(i=!1),!0!==n&&(n=!1),!0!==r&&(r=!1),d._libraryContentView.enableTreeColumnEdit(!1),d.dataProvider.initColumns&&d.dataProvider.initColumns(d._libraryContentView.getPADTreeListView().getManager().layout.getLeafColumns()),e||(e=d.CSOProvider.getCurrentObject()),e&&!e.noTree&&(e.getType&&(a=e.getType()),e.getID&&(s=e.getID()),l=e.options.mxid?e.options.mxid:""),new Promise(function(h,f){var g=null,p=m.getWidgetData();if(d.dataProvider.toEnableTreeColumnEdit&&d.dataProvider.toEnableTreeColumnEdit(a,p)&&d._libraryContentView.enableTreeColumnEdit(!0),u.setAuthoringState(!c.isIndexedMode()),null==d.leftTriptychElem)d.displayAllContents({idsToSelect:t,isPaginationOperation:i,isFilterOperation:n,isNewInsertMode:r}).then(function(e){v.updateRefreshTime(),h(e)});else if(d.dataProvider.isValidType(a)&&s)g=d.displayLibraryContents({containerType:a,containerId:s,containerMXID:l,idsToSelect:t,newCurrentContainer:e,isPaginationOperation:i,isFilterOperation:n,isNewInsertMode:r}),v.updateRefreshTime(),h(g);else if(d.dataProvider.isPaginatedSection(a))d.managePlaceholderDisplay()||d.getView().removePlaceHolder(),d._libraryContentView.cleanColumns(),d.displayAllLibraries({idsToSelect:t,isPaginationOperation:i,isFilterOperation:n,isNewInsertMode:r},a).then(function(e){v.updateRefreshTime(),h(e)});else if(d.dataProvider.isPreferenceSection(a))d.managePlaceholderDisplay()||d.getView().removePlaceHolder(),d._libraryContentView.cleanColumns(),d.displayFavouriteLibraries(t,a),v.updateRefreshTime(),h(g);else{var _=o.createProbe("unknown_container_clean");d._libraryContentView.cleanColumns(),b.isSearchActive()&&b.clearSearch(),d._libraryContentView.removeNodesInContent(),d._libraryContentView.maskContentDiv(!1),d._libraryContentView._endLoadAndSelect(),_.end(),v.updateRefreshTime(),h(g)}})},displayLibraryContents:function(e){var t=o.createProbe("probeDisplayLibraryContents"),i=this;i._libraryContentView.maskContentDiv(!0);var n=e.containerType,r=b.getSearchValue(),a=r?e.newCurrentContainer.options.mxid:e.containerId,s=!1;function l(){var e=!1;return i.dataProvider.isAuthoring&&i.dataProvider.isAuthoring(n)?e=!0:"Library"===n&&!1===c.isIndexedMode()&&(e=!0),e}!r||-1==r.indexOf(":")&&-1==r.indexOf("=")&&-1==r.indexOf(">")&&-1==r.indexOf("<")||(s=!0);var d=l()&&(null==r||""===r);function u(t){var o=[],c=[];t&&(d?t.dynamicattributesName&&(c=t.dynamicattributesName):t.dynamicattributes&&(c=t.dynamicattributes),o.push(new Promise(function(e){i._libraryContentView.displayDynamicAttributes(t,d).then(function(t){e()})})),t.unitPredicates&&(c=c.concat(t.unitPredicates)));var u={};i._libraryContentView.getPADTreeListView().getManager().layout.getLeafColumns().forEach(function(e){if(e.convertInfos){var t=e.convertInfos,i=e.dataIndex;u[i]=t.dimension}}),Promise.all(o).then(function(){i.getContentOfLibraryOrClass({containerId:a,containerMXID:e.containerMXID,searchQuery:r,isExactSearch:s,selectedType:n,isStartFromBeg:!e.isPaginationOperation,dynamicattributes:c,libraryData:e,isAuthMode:d,isNewInsertMode:e.isNewInsertMode,attributesDimMap:u},l())})}e.isPaginationOperation||!this.dataProvider.getObjectDynamicAttributes?u():this.dataProvider.getObjectDynamicAttributes({id:a,type:n},d).then(function(e){e||i._libraryContentView.cleanColumns(),u(e)},function(){u(),t.end()})},getContentOfLibraryOrClass:function(e,t){var i=o.createProbe("probeDisplayLibraryContents"),r=this,a=!1===t&&r._tagNavigator?r._tagNavigator._getCurrentFilter():null,s=r._libraryContentView.getSortingOrder(e.isAuthMode);n.fetchLibraryContents({containerId:e.containerId,containerMXID:e.containerMXID,searchQuery:e.searchQuery,isExactSearch:e.isExactSearch,selectedType:e.selectedType,filters:a,isStartFromBeg:e.isStartFromBeg,dynamicattributes:e.dynamicattributes,sortOrder:s,physicalId:e.libraryData.containerId,attributesDimMap:e.attributesDimMap,isAuthoringMode:e.isAuthMode,grid:e.libraryData.newCurrentContainer._options.grid},r.dataProvider.getObjectContents).then(function(n){var a=n.contents,o=n.infos,s=n.facets;if(o&&v.updateLastIndexTime(o),r.managePlaceholderDisplay(n.contents.length)?r.getView()._addPlaceHolder():r.getView().removePlaceHolder(),r._tagNavigator)if(t)r._tagNavigator.unsetTags();else if(!e.libraryData.isPaginationOperation){var l=!e.libraryData.isFilterOperation;r._tagNavigator._setSubjectTags(s,e.libraryData.containerType,l),r._tagNavigator.activateTaggerProxy()}var d=b.isSearchInProgress();e.searchQuery&&o&&(b.setInfoIndex(o),e.libraryData.newCurrentContainer.options.contentAvailable=!0),r._libraryContentView._endContentSelect();var c=null;if(r.CSOProvider.getCurrentObject()&&(c=r.CSOProvider.getCurrentObject().getID(),e.searchQuery&&(c=r.CSOProvider.getCurrentObject().options.mxid)),c!==e.containerId)return r._libraryContentView._endRefreshView(),void r._libraryContentView._endLoadAndSelect();var u=null;if(null==a)d||r._libraryContentView.removeNodesInContent(),r._libraryContentView.maskContentDiv(!1);else{var h=[];if(r._refreshProductStructure){var f=r._libraryContentView.getPADTreeDocument().getRoots(),g=0,p=f.length;for(g=0;g<p;g++){var _=f[g];_.options.type;f[g].isExpanded()&&h.push(_)}}var m=!e.libraryData.isPaginationOperation;if(u=r._libraryContentView.displayContentNodes(a,h,e.libraryData.idsToSelect,m,e.isNewInsertMode),r._refreshProductStructure&&h.length>0){r._refreshProductStructure=!1;var C=r._libraryContentView.getPADTreeListView();r._libraryContentView.getPADTreeDocument().refresh({treelist:C,roots:[],cb:function(e){r._logger.log("Refresh PS : "+e.msg)}})}}return r._libraryContentView._endLoadAndSelect(),i.end(),u},function(e){var n,a=e.err,o=e.serverErr;r._logger.log("WebService content, Err : "+a),r._libraryContentView.removeNodesInContent(),r._tagNavigator&&t&&r._tagNavigator.unsetTags(),n=a&&"timeout"===a.type?p.msg_error_timeout:b.isSearchActive()&&o&&"object"==typeof o&&o.error&&o.error.errorCode?_.get(o.error.errorCode):e.msg,d.displayNotification({message:n,className:"error"}),r._libraryContentView.maskContentDiv(!1),r._libraryContentView._endLoadAndSelect(),i.end()})},displayFavouriteLibraries:function(e,t){var i=o.createProbe("probeDisplayFavLibraries"),r=this;r._libraryContentView.maskContentDiv(!0),n.fetchAllFavorites(this.dataProvider).then(function(n){r.managePlaceholderDisplay(n.length)?r.getView()._addPlaceHolder():r.getView().removePlaceHolder();var a="";r.CSOProvider.getCurrentObject()&&(a=r.CSOProvider.getCurrentObject().getType()),a==t?(r._libraryContentView.displayFavouriteNodes(n,e),r._tagNavigator&&(r._tagNavigator._setSubjectTags({},r._tagNavigator.CONTENT_TYPES.EMPTY,!0),r._tagNavigator.activateTaggerProxy())):r._libraryContentView._endRefreshView(),r._libraryContentView.maskContentDiv(!1),r._libraryContentView._endLoadAndSelect(),i.end()},function(e){r._logger.log("getFavorites, Err : "+e),r._libraryContentView.maskContentDiv(!1),r._libraryContentView._endLoadAndSelect(),i.end()})},displayAllLibraries:function(e,t){var i=o.createProbe("probeDisplayAllLibraries"),r=this,a=e.idsToSelect,s=e.isPaginationOperation,l=e.isNewInsertMode,c=b.getSearchValue();r._libraryContentView.maskContentDiv(!0);var u=r._libraryContentView.getSortingOrder();return new Promise(function(o){n.fetchAllLibraries({filters:r._tagNavigator?r._tagNavigator._getCurrentFilter():null,isStartFromBeg:!s,searchQuery:c,sortOrder:u},r.dataProvider.getPaginatedSectionContents).then(function(n){if(n&&n.infos&&(v.updateLastIndexTime(n.infos),n.infos.sources&&n.infos.sources.length>0&&n.infos.sources[0].error)){var c=n.infos.sources[0],u=c.error.errorMessage;console.error("Error with federated search: ["+c.error.errorCode+"] "+u),d.displayNotification({title:p.msg_error_with_federated_search_title,message:p.msg_error_with_federated_search_message,className:"error"})}r.managePlaceholderDisplay(n.results.length)?r.getView()._addPlaceHolder():r.getView().removePlaceHolder();var h="";if(r.CSOProvider.getCurrentObject()&&(h=r.CSOProvider.getCurrentObject().getType()),h==t){var f=(n="string"==typeof n?JSON.parse(n):n).results?n.results:[];if(r._tagNavigator&&!s){var g=!e.isFilterOperation;r._tagNavigator._setSubjectTags(n.facets,t,g),r._tagNavigator.activateTaggerProxy()}r._libraryContentView._endContentSelect();var _=!e.isPaginationOperation,b=r._libraryContentView.displayContentNodes(f,null,a,_,l)}else r._libraryContentView._endRefreshView();r._libraryContentView._endLoadAndSelect(),i.end(),o(b)},function(e){r._logger.log("WebService roots, Err : "+e),r._libraryContentView._endLoadAndSelect(),i.end(),o(null)})})},displayAllContents:function(e,t){var i=o.createProbe("probedisplayAllContents"),r=this,a=e.idsToSelect,s=e.isPaginationOperation,l=e.isNewInsertMode,c=b.getSearchValue();r._libraryContentView.maskContentDiv(!0);var u=r._libraryContentView.getSortingOrder();return new Promise(function(o){n.fetchAllLibraries({filters:r._tagNavigator?r._tagNavigator._getCurrentFilter():null,isStartFromBeg:!s,searchQuery:c,sortOrder:u},r.dataProvider.getExceptionTabContents).then(function(n){if(n&&n.infos&&(v.updateLastIndexTime(n.infos),n.infos.sources&&n.infos.sources.length>0&&n.infos.sources[0].error)){var c=n.infos.sources[0],u=c.error.errorMessage;console.error("Error with federated search: ["+c.error.errorCode+"] "+u),d.displayNotification({title:p.msg_error_with_federated_search_title,message:p.msg_error_with_federated_search_message,className:"error"})}var h=(n="string"==typeof n?JSON.parse(n):n).results?n.results:[];if(r.managePlaceholderDisplay(n.results.length)?r.getView()._addPlaceHolder():r.getView().removePlaceHolder(),r._tagNavigator&&!s){var f=e.isFilterOperation;r._tagNavigator._setSubjectTags(n.facets,t,f),r._tagNavigator.activateTaggerProxy()}r._libraryContentView._endContentSelect();var g=!e.isPaginationOperation,_=r._libraryContentView.displayContentNodes(h,null,a,g,l);r._libraryContentView._endLoadAndSelect(),i.end(),o(_)},function(e){r._logger.log("WebService roots, Err : "+e),r._libraryContentView.maskContentDiv(!1),r._libraryContentView._endLoadAndSelect(),i.end(),o(null)})})},refreshLibraryContent:function(){var e=this.getView().getPADTreeDocument();e&&e.keepExpandedState();var t=this.CSOProvider.getCurrentObject();if(null!=t)if(1==t.noTree)this.loadContentAndSelect();else{var i=t.getType();(!t.isVisible()&&!t.isFavorite||this.dataProvider.isSection(i))&&this.loadContentAndSelect(t)}},switchLibraryTreeNodeLabelToWriteView:function(e){var t=!1;if(this._libraryContentView.getPADTreeDocument()&&e.getTreeDocument()===this._libraryContentView.getPADTreeDocument()){var i;"datagridview"===this._libraryContentView.getActiveView()&&(i=this._libraryContentView.getPADTreeListView());var n=i?i.getManager():void 0;if(n){var r=n.layout.getColumnIndex("tree"),a=n.layout.getCellsFromNodeModel(e)[r],o=n.getEditionManager(a);o.onF2&&(n.setActiveCell(a),o.onF2(a),t=!0)}}return t},getView:function(){return this._libraryContentView},managePlaceholderDisplay:function(e){if(s.isNatifEnvironnement())return!1;if(null!=this.CSOProvider.getCurrentObject()){var t=this.CSOProvider.getCurrentObject().getType(),i=m.getWidgetData();return!!this.dataProvider.isValidTypeForPlaceholder(t,i)&&(b.isSearchActive()?!(!this.dataProvider.showSearchPlaceHolder||!this.dataProvider.showSearchPlaceHolder()):0===e)}},displayDynamicAttributes:function(e,t){this._libraryContentView.displayDynamicAttributes(e,t)}});return I}),define("DS/IPClassifyUX/views/LibrarySearchWithinView",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","DS/IPClassifyUX/utils/LoadCssUtil","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WebappsUtils/WebappsUtils","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ComboBox","DS/Controls/Popup","DS/Controls/LineEditor","UWA/Date","DS/Controls/DatePicker","DS/IPClassifyUX/models/LibrarySearchModel","DS/IPClassifyUtil/IPClassifyAlert"],function(e,t,i,n,r,a,o,s,l,d,c,u,h,f,g,p,_,b,m){"use strict";return t.extend(i,n,{name:"LibrarySearchWithinView",_searchInNode:null,_librarySearchWithinDialog:null,_title:l.advance_search_within_title+" ",_output:{},_outputArr:[],_conditionNode:function(e,t){this.value=e,this.id=t},_id:0,_singleConditionId:null,_logicalOperator:"AND",_eachGroupLogicalOperator:{},_setVisible:!1,_titleContainer:null,_bodyContainer:null,_queryBuilderContainer:null,_restrictQueryContainer:null,_blockButtonContainer:null,_andOrBlockContainer:null,_selectAllorany:null,_currentDateTime:null,_attributesInfo:null,_classificationAttributePredicates:{},_nlsUnitData:null,init:function(e){this._parent(e),this.CSOProvider=e.CSOProvider,this.dataProvider=e.dataProvider,this._classificationAttributePredicates=e._classificationAttributePredicates,this._attributesInfo=e._attributesInfo,this._nlsUnitData=e._nlsUnitData;var t=s.getWebappsAssetUrl("IPClassifyUX","css/LibrarySearchWithin.css");r._loadCSS(t),this._singleConditionId=new Set,this._singleConditionId.add(this._id),this._conditionNode.prototype.updateValue=function(e,t){this.value=e,this.id=t},this._conditionNode.prototype.getValue=function(){return this.value},this._buildUI()},_buildUI:function(){var t=this;let i=t.CSOProvider.getCurrentObject().getLabel();var n=document.querySelectorAll(".LibrarySearchWithinView");if(n&&n.length>0){var r=Array.prototype.slice.call(n);r&&r.forEach(function(e){e.remove()})}t._titleContainer&&t._bodyContainer&&t._restrictQueryContainer&&t._blockButtonContainer&&t._andOrBlockContainer&&t._queryBuilderContainer||(t._bodyContainer=new UWA.createElement("div",{class:"searchWithinBody"}),t._titleContainer=new UWA.createElement("div",{class:"searchWithinTitle",text:t._updateSearchInNode(i)}),t._restrictQueryContainer=new UWA.createElement("div",{class:"restrictQueryContainer"}),t._blockButtonContainer=new UWA.createElement("div",{class:"blockButtonContainer"}),t._queryBuilderContainer=new UWA.createElement("div",{class:"queryBuilderContainer",id:"queryBuilderContainer"})),e.is(this.elements.container)||(this.elements.container=UWA.createElement("div",{class:this.getClassNames()}),t._librarySearchWithinDialog=new c({activeFlag:!1,resizableFlag:!0,domId:"librarySearchWithinDialog",modalFlag:!0,position:{my:"center",at:"center"},height:400,width:800,buttons:{Cancel:new u({onClick:function(e){const i=t._output;for(var n=Object.getOwnPropertyNames(t._output),r=0;r<n.length;r++)delete i[n[r]];t._librarySearchWithinDialog.close()}}),Yes:new u({label:l.get("advance_search_within_text_search"),onClick:function(e){let i=Object.keys(t._output);const n=t._output;let r=" ";var a=0;for(let e of i)if(++a,n[e]instanceof t._conditionNode&&!e.includes("group_"))""!==n[e].getValue().trim()&&(r=r+"("+n[e].getValue().trim()+") "+(a!==i.length?t._logicalOperator+" ":""));else{let s=t._eachGroupLogicalOperator[e],l=Object.keys(n[e]).length;r=r+"( "+o(n[e],"",t._eachGroupLogicalOperator[e],s,l)+"  "+(a!==i.length?t._logicalOperator+" ":"")}function o(e,i,n,r,a){let s=0,l=Object.keys(e);for(let d in e)++s,e.hasOwnProperty(d)&&(e[d]instanceof Array&&0!==e[d].length&&(l.splice(0,1),i+="(",i=o(e[d],i,t._eachGroupLogicalOperator[d],r,a)),e[d]instanceof t._conditionNode&&""!==e[d].getValue().trim()&&(l.splice(0,1),i=i+e[d].getValue().trim()+" "+(l.length>0?n+" ":"")));return i=i+") "+(s!==a?r:" ")+" "}let s=function(e){for(var t=/and/gi,i=[];n=t.exec(e);)i.push(n.index);for(let t of i)")"===e[t+4]&&(console.log(!0),e=e.substr(0,t)+e.substr(t+3,e.length));var n;for(t=/or/gi,i=[];n=t.exec(e);)i.push(n.index);for(let t of i)")"===e[t+4]&&(console.log(!0),e=e.substr(0,t)+e.substr(t+3,e.length));let r="";e=e.split("").reverse().join("");for(let t=0;t<e.length;t++)if(r+=e[t],")"===e[t]){let i=e.substring(t+2,t+5),n=e.substring(t+2,t+4);"AND"===i.split("").reverse().join("")&&(t+=5),"OR"===n.split("").reverse().join("")&&(t+=4)}return r=r.split("").reverse().join("")}(r.trim());var d=Object.getOwnPropertyNames(t._output);for(a=0;a<d.length;a++)delete n[d[a]];t._isCriteriaValueNull(s)?m.displayNotification({message:l.msg_no_criteria,className:"warning"}):(console.log(s),b.changeSearch(s,!0)),t._librarySearchWithinDialog.close()}})}}),t._titleContainer.inject(t._librarySearchWithinDialog.elements._titleP),t._bodyContainer.inject(t._librarySearchWithinDialog.elements._contentDiv),t._restrictQueryContainer.inject(t._bodyContainer),t._queryBuilderContainer.inject(t._bodyContainer),t._singleConditionUIblock(t._queryBuilderContainer,t._id),t._blockButtonContainer.inject(t._bodyContainer),t._restrictQueryOnObject(),t._blockButtonContainerUI(),t._customizeStyle(),this.elements.container.inject(widget.body))},_isCriteriaValueNull:function(e){if(!e)return!0;let t=e,i=t.split("").reduce((e,t,i)=>("="===t&&e.push(i),e),[]);for(let e of i)if(")"===t[e+1])return console.log("No value"),!0;let n=t.split(" "),r=n.reduce((e,t,i)=>("("===t&&e.push(i),e),[]);for(let e of r)if(")"===n[e+1])return console.log("No value"),!0;return!1},_customizeStyle:function(){this._librarySearchWithinDialog.elements._titleBarDiv.setStyles({padding:"4px 0 4px 0"}),this._librarySearchWithinDialog.elements._titlebarButtonsDiv.addClassName("headerCloseButton"),this._librarySearchWithinDialog.elements._titlebarButtonsDiv.firstElementChild.setStyles({"font-size":"12px",color:"#77797c"})},_updateSearchInNode:function(e){return this._searchInNode=e?this._title+e:this._title+"Context",this._librarySearchWithinDialog&&(this._titleContainer.textContent=this._searchInNode),this._searchInNode},_restrictQueryOnObject:function(){var e=this;const t=new UWA.createElement("span",{class:"labelSearchWithin",text:l.get("advance_search_within_text_search")});let i=new UWA.createElement("span",{class:"selectObjectType",text:l.get("advance_search_within_text_All_objects")});i.addEvents({click:e._chooseObjectType});const n=new UWA.createElement("span",{class:"labelSearchWithin",text:l.get("advance_search_within_text_with")});e._andOrBlockContainer=new UWA.createElement("div",{class:"andOrBlockContainer"}),e._selectAllorany=new UWA.createElement("a",{class:"selectConditionType",text:l.get("advance_search_within_text_all"),title:l.get("msg_all_any")}),e._selectAllorany.addEventListener("click",function(){e._switchLogicalOperator()}),e._selectAllorany.inject(e._andOrBlockContainer),new UWA.createElement("span",{class:"labelSearchWithin",text:l.get("advance_search_within_text_ofthefollowing")+" :"}).inject(e._andOrBlockContainer),new Promise((i,n)=>{t.inject(e._restrictQueryContainer),i([])}).then(()=>{i.inject(e._restrictQueryContainer)}).then(()=>{n.inject(e._restrictQueryContainer)}).then(()=>{e._andOrBlockContainer.inject(e._restrictQueryContainer)}).then(()=>{e._setVisible||(e._andOrBlockContainer.style.visibility="hidden")})},_singleConditionUIblock:async function(e,t,i){var n=this,r=new n._conditionNode("",t);const s=n._addGroupToObject.bind(n);if(i)s(n._output,i," ",r);else{const e="single_"+t;n._output[e]=r}console.log(e);var d=new UWA.createElement("div",{class:"singleConditionBlockContainer",id:"singleConditionBlockContainer_"+t});d.inject(e);var c=null,p="=",b="",m=n._getOperatorString.bind(n),v=(n._hideAndAnySpan.bind(n),n._fliterSingleIdList.bind(n)),C=(n._buildDateSection.bind(n),n._resetTimeOfDate.bind(n)),y=new a,S=new a,P=null;for(let e in n._classificationAttributePredicates){var I=!1;n._classificationAttributePredicates[e].authRange&&(I=!0);var w=new o({isRangeAttr:I,name:n._classificationAttributePredicates[e].name,label:e,type:"timestamp"===n._classificationAttributePredicates[e].type?"date":n._classificationAttributePredicates[e].type});y.addRoot(w)}y.expandAll();var T=new UWA.createElement("div",{class:"attributeComboContainer",id:"attributeComboContainer_"+t}),E=new h({enableSearchFlag:!0,domId:"attributeCombo_"+t,placeholder:l.get("msg_select_attribute"),popupSizeAdjustPolicy:f.SizeAdjustPolicyEnum.AdjustToVisibleContents,elementsTree:y,reachablePlaceholderFlag:!0});E.inject(T),T.inject(d);var D=new UWA.createElement("div",{class:"operatorComboContainer",id:"operatorComboContainer_"+t});const A=l.searchWithinOperator,L=Object.keys(A).map(e=>[A[e]]),x=[].concat(...L);var N=new h({domId:"operatorCombo_"+t,enableSearchFlag:!1,elementsList:x,displayStyle:"normal",popupSizeAdjustPolicy:f.SizeAdjustPolicyEnum.AdjustToVisibleContents,value:"equals to"});N.inject(D),D.inject(d),D.style.visibility="hidden";var O=function(){if(E.value){if(c=E.value,c="["+n._classificationAttributePredicates[E.value].predicate+"]",P=n._classificationAttributePredicates[E.value].predicate,r.updateValue(c.toString()+p+b,t),!i){const e="single_"+t;n._output[e]=r}console.group("Output Object"),console.table(n._output),console.groupEnd();let w="attribute["+n._classificationAttributePredicates[E.value].name+"]";if(n._nlsUnitData[w]){R.style.display="inline",S.removeRoots();for(let t in n._nlsUnitData[w].nlsToUnits){var e=new o({label:t});S.addRoot(e)}W.getContent().addEventListener("change",function(e){let i=e.dsModel.value.trim();""!==b||b||(b=0);let a=Number(b)*n._nlsUnitData[w].nlsToUnits[i].factor+Number(n._nlsUnitData[w].nlsToUnits[i].offset);console.log(i),r.updateValue(c.toString()+p+a,t)})}else R.style.display="none";let T=E.elementsTree.getSelectedNodes();if(T&&"string"===T[0]._options.type||"boolean"===T[0]._options.type){let e=[].concat(...L);N.elementsList=[].concat(e[0])}else N.elementsList=x;if(M){M.remove(),b="";var s=n._attributesInfo.rangeAttributes;if(T&&"date"===T[0]._options.type){var d=C(new Date(Date.now()));(M=new _({domId:"singleattrValue_"+t,timePickerFlag:!0,timePickerPrecision:"sec",value:d})).inject(U);let e=d.toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/,"$1$3");var u=d.getMonth()+1,m=d.getUTCDate()+1,v=d.getUTCFullYear();b=`"${b=v+"/"+u+"/"+m+" "+e}"`,r.updateValue(c.toString()+p+b,t),M.getContent().addEventListener("change",function(e){var i;let n=(i=e.dsModel.value).toLocaleTimeString().replace(/([\d]+:[\d]{2})(:[\d]{2})(.*)/,"$1$3");var a=i.getMonth()+1,o=i.getUTCDate()+1,s=i.getUTCFullYear();b=`"${b=s+"/"+a+"/"+o+" "+n}"`,r.updateValue(c.toString()+p+b.toString(),t),console.log(b)})}else if(T&&T[0]._options.isRangeAttr){var y=n._classificationAttributePredicates[T[0]._options.label].authRange,I=new a;M.remove();for(let t in y){e=new o({label:y[t],type:"string"});I.addRoot(e)}I.expandAll(),(M=new h({enableSearchFlag:!0,domId:"attributeCombo_"+t,placeholder:"select value",popupSizeAdjustPolicy:f.SizeAdjustPolicyEnum.AdjustToVisibleContents,elementsTree:I,reachablePlaceholderFlag:!0})).inject(U),M.getContent().addEventListener("change",function(e){b=e.dsModel.value;var i=E.value,a=n._classificationAttributePredicates[i].name;if(s[a]&&s.isNLSavailable)if(Array.isArray(b)){for(var o=0;o<b.length;o++)if(!s[a][b[o]]){var l=Object.keys(s[a]).find(e=>s[a][e]===b[o]);b[o]=l}}else s[a][b]||(b=Object.keys(s[a]).find(e=>s[a][e]==b));r.updateValue(c.toString()+p+b,t)})}else{(M=new g({placeholder:l.get("enter_attribute_value"),domId:"singleattrValue_"+t,displayClearFieldButtonFlag:!0})).inject(U);let e="real"===T[0]._options.type;M.pattern=e?"^(([-+]?[0-9]+.[0-9]+)|([0-9]+))$":"",M.getContent().addEventListener("change",function(i){let a=(b=i.dsModel.value.trim()).split(" ");a.length>1&&!e?(M.pattern="",b=`"${b}"`):e&&n._nlsUnitData[P]?b=a[0]:Number.isNaN(b)?(M.pattern="",b=Number(b)):(M.pattern="",b=`"${b}"`),r.updateValue(c.toString()+p+b,t),console.log(b)}),r.updateValue(c.toString()+p+b,t)}}D.style.visibility="visible",B.style.visibility="visible",U.style.visibility="visible"}else console.log("Please Choose an attribute"),c=null,D.style.visibility="hidden",B.style.visibility="hidden",U.style.visibility="hidden"},V=function(){if(N.value&&(p=m(N.value,x),r.updateValue(c.toString()+p+b,t),!i)){const e="single_"+t;n._output[e]=r}};E.addEventListener("change",O),E.addEventListener("preselectionChange",O),N.addEventListener("change",V),N.addEventListener("preselectionChange",V);var U=new UWA.createElement("div",{class:"operatorCombo_",id:"attributeValueHolderContainer_"+t}),M=new g({placeholder:l.get("enter_attribute_value"),domId:"singleattrValue_"+t,displayClearFieldButtonFlag:!0});M.inject(U),U.inject(d),U.style.visibility="hidden",M.getContent().addEventListener("change",function(e){console.log(e.dsModel.value)});var R=new UWA.createElement("div",{class:"operatorComboContainer",id:"unitComboHolderContainer_"+t}),W=new h({enableSearchFlag:!0,domId:"unitCombo_"+t,placeholder:l.get("msg_select_unit"),popupSizeAdjustPolicy:f.SizeAdjustPolicyEnum.AdjustToVisibleContents,elementsTree:S,reachablePlaceholderFlag:!0});W.inject(R),R.inject(d),R.style.display="none";var B=new UWA.createElement("div",{class:"deleteButtonHolder",title:l.get("msg_delete_block")}),F=new u(n._getBlockButtonStyle("trash wux-ui-3ds"));F.inject(B),B.inject(R,"after"),B.style.visibility="hidden",F.getContent().addEventListener("buttonclick",function(){if(c=null,p="=",b="",r.updateValue("",t),B.style.visibility="hidden",U.style.visibility="hidden",R.style.display="none",!i){const e="single_"+t;n._output[e]=r}0===t?(E.selectedIndex=-1,v(t)):(E.selectedIndex=-1,d.remove(),v(t))})},_groupConditionUIblock:async function(e,t,i){var n=this,r="AND";let a="group_"+t;n._eachGroupLogicalOperator[a]=r;const o=n._addGroupToObject.bind(n);i?o(n._output,i,a):n._output[a]=[];var s=n._fliterSingleIdList.bind(n),d=new UWA.createElement("div",{class:"groupHolder",id:"groupHolder_"+t}),c=new UWA.createElement("div",{class:"groupConditionBlockContainer",id:"groupConditionBlockContainer_"+t}),h=new UWA.createElement("div",{class:"blockButtonContainer"});d.inject(e),c.inject(d);var f=new UWA.createElement("div",{class:"deleteButtonHolder",title:l.get("msg_delete_block")});f.inject(d);var g=new u(n._getBlockButtonStyle("trash wux-ui-3ds"));g.inject(f);const p=new UWA.createElement("div",{class:"grouprestrictQueryContainer",title:l.get("msg_all_any")});p.inject(c);const _=new UWA.createElement("span",{class:"labelSearchWithin",text:l.get("advance_search_within_text_with")}),b=new UWA.createElement("a",{class:"selectConditionType",text:l.get("advance_search_within_text_all")});b.addEventListener("click",function(){r="AND"===r?"OR":"AND",b.text="AND"===r?l.get("advance_search_within_text_all"):l.get("advance_search_within_text_any"),n._eachGroupLogicalOperator[a]=r});const m=new UWA.createElement("span",{class:"labelSearchWithin",text:l.get("advance_search_within_text_ofthefollowing")+" :"}),v=n._blockButtonContainerUI.bind(n);new Promise((e,t)=>{_.inject(p),e([""])}).then(()=>{b.inject(p)}).then(()=>{m.inject(p)});var C=new UWA.createElement("div",{class:"inlineConditionContainer",id:"inlineConditionContainer_"+t});C.inject(c),n._singleConditionUIblock(C,0,a),g.getContent().addEventListener("buttonclick",function(){d.remove(),s(t),i?o(n._output,i,a):delete n._output[a]}),h.inject(c),v(h,C,a)},_blockButtonContainerUI:function(e,t,i){var n=this;const r=new u(n._getBlockButtonStyle("plus wux-ui-3ds"));r.elements.container.title=l.get("msg_add_single_condition");const a=new u(n._getBlockButtonStyle("group-add wux-ui-3ds"));a.elements.container.title=l.get("msg_add_group_condition"),new Promise((t,i)=>{r.inject(e||n._blockButtonContainer),t([""])}).then(()=>{a.inject(e||n._blockButtonContainer)}),r.getContent().addEventListener("buttonclick",function(){n._blockButtonOnClick("single",t||"",i)}),a.getContent().addEventListener("buttonclick",function(){n._blockButtonOnClick("group",t||"",i)})},_chooseObjectType:function(e){e.preventDefault(),console.log("Need to render the combobox here...")},_switchLogicalOperator:function(){var e="AND"===this._logicalOperator?"OR":"AND";this._logicalOperator=e,this._selectAllorany.text="AND"===this._logicalOperator?l.get("advance_search_within_text_all"):l.get("advance_search_within_text_any")},_getBlockButtonStyle:function(e){return{displayStyle:"icon",showLabelFlag:!1,icon:this._getIconByName(e)}},_getIconByName:function(e){return{iconName:e,fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"}},_blockButtonOnClick:function(e,t,i){switch(e){case"single":this._setVisible||(this._setVisible=!0,this._andOrBlockContainer.style.visibility="visible"),this._updateSingleId(),this._singleConditionUIblock(""===t?this._queryBuilderContainer:t,this._id,i);break;case"group":console.log("add group condition to ",t),this._setVisible||(this._setVisible=!0,this._andOrBlockContainer.style.visibility="visible"),this._updateSingleId(),this._groupConditionUIblock(""===t?this._queryBuilderContainer:t,this._id,i);break;default:console.log(e)}},_hideAndAnySpan:function(){this._setVisible=!1,this._andOrBlockContainer.style.visibility="hidden"},_updateSingleId:function(){var e=[];for(let t=0;t<this._singleConditionId.size;t++)e[t]=!1;for(const t of this._singleConditionId)e[t]=!0;var t=0,i=!1;for(let n=0;n<e.length;n++)if(!1===e[n]){i=!0,t=n;break}console.log(e),i?(this._id=t,this._singleConditionId.add(this._id)):(this._id=this._singleConditionId.size,this._singleConditionId.add(this._id)),console.log(this._singleConditionId)},_fliterSingleIdList:function(e){this._singleConditionId.has(e)&&0!==e&&this._singleConditionId.delete(e),this._id=e,console.log("filtered Set : ",this._singleConditionId),1===this._singleConditionId.size&&this._hideAndAnySpan()},_buildDateSection:function(e,t,i){var n,r=this;n=t?new p(p.parse(t)):this._resetTimeOfDate(new Date(Date.now()));var a=new _({domId:e,timePickerFlag:!0,timePickerPrecision:"sec",value:n});function o(t){var i;r._currentDateTime=t,i=(i=r._currentDateTime.toISOString()).substring(0,i.lastIndexOf("."))+"Z",r.model.set(e,i)}return a.inject(i),o("on",a.value),a.getContent().addEventListener("change",function(e){o("on",e.dsModel.value)}),a},_resetTimeOfDate:function(e){var t=new Date(e);return t.setHours(0,0,0,0),t},_getOperatorString:function(e,t){var i={};console.log("before string check",l.searchWithinOperator.equals_to);for(let e=0;e<t.length;e++)switch(t[e]){case l.searchWithinOperator.equals_to:i[t[e]]="=";break;case l.searchWithinOperator.is_greater_than:i[t[e]]=">";break;case l.searchWithinOperator.is_greater_or_equal_to:i[t[e]]=">=";break;case l.searchWithinOperator.is_lower_than:i[t[e]]="<";break;case l.searchWithinOperator.is_lower_than_or_equal_to:i[t[e]]="<=";break;default:console.log("Type not supported!")}return console.log(i),i[e]},_saveUItoState:async function(e){let t=(new XMLSerializer).serializeToString(e);localStorage.setItem("librarysearchquery",t)},_addGroupToObject:function(e,t,i,n){!function e(r){for(let a in r)if(r.hasOwnProperty(a)){if(console.log(a+": "+r[a]),a===t){if(console.log("--found id")," "!==i){r[a][i]=[];break}r[a].push(n),r[a]===i&&console.log("----found porop",a,", ",r[a])}r[a]instanceof Array&&e(r[a])}}(e)}})}),define("DS/IPClassifyUX/LibrarySearchWithinController",["UWA/Class","DS/Logger/Logger","DS/IPClassifyUX/views/LibrarySearchWithinView","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PADUtils/PADProbes","DS/IPClassifyUXUtil/IPClassifyConfirmation"],function(e,t,i,n,r,a){"use strict";var o=e.singleton({name:"LibrarySearchWithinController",_LibrarySearchWithinView:null,_probeLoadElmt:null,_logger:null,_libraryContentView:null,_classificationAttributePredicates:{},_attributesInfo:null,_nlsUnitData:null,init:function(e){this._probeLoadElmt=r.createProbe("loadAdvanceSearchWithin"),e&&(this.dataProvider=e.dataProvider,this.CSOProvider=e.CSOProvider),this._logger=t.getLogger(o)},loadUI:function(e){if(0!==Object.keys(this._classificationAttributePredicates).length)e._classificationAttributePredicates=this._classificationAttributePredicates,e._nlsUnitData=this._nlsUnitData,e._attributesInfo=this._attributesInfo,this._LibrarySearchWithinView=new i(e,this);else{console.log("No classification attribute on class");var t=this;a.launch({title:n.advance_search_within_title,content:n.msg_no_ca+".<br><br>"+n.msg_proceed,confirmLabel:n.msg_confirm},function(){e._classificationAttributePredicates=t._classificationAttributePredicates,e._nlsUnitData=t._nlsUnitData,e._attributesInfo=t._attributesInfo,t._LibrarySearchWithinView=new i(e,t)})}},feedClassificationAttributes:function(e){let t={};for(let i of e)t[i.nls_label]={predicate:i.predicate,type:i.type,name:i.name,authRange:i.authRange};e._attributesInfo&&(this._attributesInfo=e._attributesInfo),this._classificationAttributePredicates=t},feedUnitManipulationDatas:function(e){this._nlsUnitData=e}});return o}),define("DS/IPClassifyUX/views/LibraryTreeView",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Options","UWA/Class/Events","DS/Tree/Tree","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Tree/TreeNodeView","DS/WebappsUtils/WebappsUtils","DS/IPClassifyUX/models/LibraryTreeModel","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADUtilsServices","DS/IPClassifyUX/views/LibraryOrderCmdView","DS/IPClassifyUX/service/LibraryDnDService","DS/IPClassifyUtil/IPClassifyAlert","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/PADUtils/Configuration","DS/WidgetServices/WidgetServices","DS/Tweakers/GeneratedToolbar"],function(e,t,i,n,r,a,o,s,l,d,c,u,h,f,g,p,_,b,m,v,C){"use strict";function y(e){return e._modelEvents}return t.extend(i,n,{name:"LibraryTreeView",_libraries_TreeDocument:null,_libraries_TreeView:null,_libraries_SortElmt:null,_rootNodeFavorite:null,_rootNodeLibraries:null,_commandProxy:null,_libraries_dgvTreeDocument:null,_timerDragEnter:null,_dndDropPosition:null,_currentDragEnterLibrary:null,_typeService:null,init:function(e,t){var i=this;i._parent(e),this.CSOProvider=e.CSOProvider,this.DnDProvider=e.DnDProvider,this.dataProvider=e.dataProvider,i._commandProxy=u.create(),i._buildSkeleton(),i._libraries_SortElmt=new f;let n=i._libraries_SortElmt.getSortModel(i);i.model={entries:[]},this.dataProvider.getStatesFilterModel&&i.model.entries.push(this.dataProvider.getStatesFilterModel()),i.model.entries.push(n);var r=C.prototype.createTreeDocument(i.model);i.leftToolbar=new C({overflowManagement:"dropdown",direction:"horizontal",items:r}).inject(i._libraries_SortElmt.elements.container);this._libraries_dgvTreeDocument;var a=this._libraries_TreeView?this._libraries_TreeView.getTreeDocument():void 0;this._libraries_TreeDocument=a,a&&(a.options.shouldBeEditable=this.dataProvider.shouldBeEditable,a.onNodeModelUpdate(this.dataProvider.onContentUpdate),a.options.shouldAcceptDrag=this._shouldAcceptDrag.bind(this),a.options.shouldAcceptDrop=this._shouldAcceptDrop.bind(this),i._libraries_TreeDocument.onPreExpand(t._onPreExpandTreeNode.bind(t)),i._libraries_TreeDocument.getXSO().onChange(function(e){var t=i._libraries_TreeDocument.getXSO().get();if(t&&t.length>0){var n=t[t.length-1];n.getID||(n.getID=function(){return this.id}),n.getType||(n.getType=function(){return this.plmType}),i.CSOProvider.getCurrentObject()!==n&&i.CSOProvider.addInCSO(n,"TREE")}}))},createLibrarySections:function(e){var t=this;e.forEach(function(e){var i={useAsyncPreExpand:!0};i.label=e.label,i.icons=[e.icon],i.children=[],i.id="",i.plmType=e.plmType,t.dataProvider.isPreferenceSection(e.plmType)?t._rootNodeFavorite=t._createTreeNodeModel(i,t._libraries_TreeDocument):(t.defaultSelectedSection=e.plmType,t._rootNodeLibraries=t._createTreeNodeModel(i,t._libraries_TreeDocument))})},_buildSkeleton:function(){var t=this;if(!e.is(this.elements.container)){this.elements.container=UWA.createElement("div",{class:this.getClassNames()+"_container"}),this.getOption("css_view_class")&&this.elements.container.addClassName(this.getOption("css_view_class")),this.elements.libraryTreeView_container=UWA.createElement("div",{class:this.getClassNames()+"_treeview_container"}).inject(this.elements.container);var i=UWA.clone(m.getConfig("dgvOptions")),n=i&&i.dgv?i.dgv:{};n.selectionBehavior.toggle=v.isTouchDevice(),n.selectionBehavior.unselectAllOnEmptyArea=!1,n.infiniteScrolling=!0,n.onContextualEvent=t._onContextualEvent.bind(t),n.rowSelection="single",n.showRowBorderFlag=!1,n.columns=[{dataIndex:"tree",sortableFlag:!1,typeRepresentation:"string",getCellEditableState:function(e){return!!(e&&e.nodeModel&&t.dataProvider.isTreeNodeEditable)&&t.dataProvider.isTreeNodeEditable(e)},editionPolicy:"DelayedEditionOnClick",setCellValue:function(e,t){if(e.nodeModel){var i=e.nodeModel;i.getTreeDocument().withTransactionUpdate(function(){var e={};e.label=t,e.display=t,e.oldLabel=i.options.label,i.updateOptions(e)})}},compareFunction:function(e,i,n,r,a){return t.dataProvider.comparator(n,r)},onCellRequest:function(e){e.isHeader||(e.nodeModel&&e.nodeModel.options.isBeingCut?e.cellView.getContent().addClassName("library-state-is-being-cut"):e.cellView.getContent().removeClassName("library-state-is-being-cut")),this.defaultOnCellRequest(e)}}];var r=UWA.extend({identifier:"DataGridView-"+t.name+"-"+widget.id},n);i.dgvLayout.rowsHeader=!1;var o=UWA.clone(i.dgvLayout);r.layout=new b(o),r.layout.useLastColumnWidthAutoFlag=!0,r.layout.columnsHeader=!1;var s=new a;r.treeDocument=s,r.rowDragEnabledFlag=!0,r.useAsyncPreExpand=!0;var l=new _(r).inject(this.elements.libraryTreeView_container);this._libraries_TreeView=l,l.showAlternateBackgroundFlag=!1,l.treeNodeCellOptions.depthIncrement=14,l.treeNodeCellOptions.buildLinks=!0,l.treeNodeCellOptions.expanderStyle="triangle",l.onDragEndCell=this._onDragEndCell.bind(this),l.onDragOverCell=this._onDragOverCell.bind(this),l.onDragLeaveCell=this._onDragLeaveCell.bind(this),l.onDropCell=this._onDropCell.bind(this),l.onDragEnterBlank=this._onDragEnterBlank.bind(this),l.onDragOverBlank=this._onDragOverBlank.bind(this),l.onDropBlank=this._onDropBlank.bind(this),l.addEventListener("dblclick",function(e,i){e&&i&&-1!==i.rowID&&t._switchExpandStatus(i)})}},_switchExpandStatus:function(e){!0===e.nodeModel._isExpanded?e.nodeModel.collapse():e.nodeModel.expand()},_onContextualEvent:function(e){var t=this;return e&&e.cellInfos&&e.cellInfos.nodeModel.select(),new Promise(function(i){t.onContextualMenuReady(e).then(function(e){i(e)})})},_onDragOver:function(e){},_onDragOverCell:function(e,t){e.preventDefault();t.nodeModel;return t&&!t.nodeModel.isFavorite&&(t.dropPosition="middle"),this._dndDropPosition=t.dropPosition,this._currentDragEnterLibrary&&this._timerDragEnter&&this._currentDragEnterLibrary!==t.nodeModel.getID()&&(clearTimeout(this._timerDragEnter),this._timerDragEnter=null),this._currentDragEnterLibrary===t.nodeModel.getID()||t.nodeModel.isExpanded()||"expanding"===t.nodeModel.getState()||(this._timerDragEnter=setTimeout(function(){t.nodeModel.expand()},this.time_to_expand_node)),this._currentDragEnterLibrary=t.nodeModel.getID(),!0},_onDropCell:function(e,t){if(e.preventDefault(),"middle"!==t.dropPosition)return!0;if(this.dataProvider.isDNDSupported()){var i=t.nodeModel;if(i&&this.DnDProvider.shouldAcceptDrop(i)){this._timerDragEnter&&(clearTimeout(this._timerDragEnter),this._timerDragEnter=null),this._currentDragEnterLibrary=null;try{g.performDropOnLibraryEditorNode(i,e,this.DnDProvider)}catch(e){p.displayNotification({message:c.msg_warning_dndnotsupported,className:"warning"})}}else p.displayNotification({message:c.msg_warning_dndnotsupported,className:"warning"})}else p.displayNotification({message:c.msg_warning_dndnotsupported,className:"warning"})},_onDropBlank:function(e,t){this.dataProvider.isDNDSupported()||p.displayNotification({message:c.msg_warning_dndnotsupported,className:"warning"})},_onDragEndCell:function(e,t){e.preventDefault();var i=this;if("middle"!==this._dndDropPosition&&t&&t.nodeModel.isFavorite){var n=[];this._libraries_TreeDocument.getRoots()[0].getAllDescendants().forEach(function(e){n.push(e.id)}),d.getFavorites(i.dataProvider,{onComplete:function(e){var t=e,r=[];function a(e){for(var i=0;i<t.length;i++)t[i].physicalid===e&&t.splice(i,1)}for(var o=0;o<n.length;o++)e.forEach(function(e,t){e.physicalid===n[o]&&(r.push({id:e.physicalid,name:e.label}),a(e.physicalid))});t.length>0&&t.forEach((e,t)=>{r.concat({id:e.physicalid,name:e.label})}),d.reorderFavoritePreference(i.dataProvider,{favoriteLibraries:r,onComplete:function(e){console.log("Re-arrange of favorite node is successful"),p.displayNotification({message:c.get("msg_success_favoriteReordered"),className:"success"})},onFailure:function(e){console.log("WebService setFavorites Err : "+e),p.displayNotification({title:c.msg_error_favoriteReordered.title,subtitle:c.msg_error_favoriteReordered.subtitle,className:"error"})}})},onFailure:function(e){console.log(e)}})}return!1},_onDragLeaveCell:function(e,t){return this._timerDragEnter&&(clearTimeout(this._timerDragEnter),this._timerDragEnter=null),this._currentDragEnterLibrary=null,!0},_onDragEnterBlank:function(e,t){e&&e.dataTransfer&&(e.dataTransfer.dropEffect="none"),t.dropPosition="middle";return this._dndDropPosition=t.dropPosition,!0},_onDragOverBlank:function(e,t){},_populateContentSection:function(e,t){var i=this;e.forEach(function(e){var n={useAsyncPreExpand:!0};n.label=e.label,n.icons=e.icons,n.children=[],n.id=e.physicalid,n.mxid=e.mxid,n.plmType=e.plmType,n.created=e.created,n.type=e.type,n.grid=e.grid,UWA.is(e.publishOnConnect)&&(n.publishOnConnect=e.publishOnConnect);i._createTreeNodeModel(n,t)}),i._libraries_SortElmt.sortingNodesUnsensitiveCase()},_populateAllLibrariesSection:function(e,t){var i=this;e.forEach(function(e){var n={useAsyncPreExpand:!0};n.label=e.label,n.icons=e.icons,n.children=[],n.id=e.physicalid,n.mxid=e.mxid,n.plmType=e.plmType,n.created=e.created,n.type=e.type,n.grid=e.grid,UWA.is(e.publishOnConnect)&&(n.publishOnConnect=e.publishOnConnect);i._createTreeNodeModel(n,t)}),i._libraries_SortElmt.sortingNodesUnsensitiveCase()},_populateFavoriteSection:function(e){var t=this,i={useAsyncPreExpand:!1};e.forEach(function(e){i.label=e.label,i.icons=e.icons,i.children=null,i.id=e.physicalid,i.mxid=e.mxid,i.plmType=e.plmType,i.isFavorite=!0,i.type=e.type,i.grid=e.grid,t._createTreeNodeModel(i,t._rootNodeFavorite).setState({state:"noChildren"})})},_addFavouriteNode:function(e){var t={useAsyncPreExpand:!1};t.label=e.label,t.icons=e.icons,t.mxid=e.mxid,t.children=null,t.id=e.physicalid,t.plmType=e.plmType,t.type=e.type,t.isFavorite=!0,this._createTreeNodeModel(t,this._rootNodeFavorite).setState({state:"noChildren"})},addNewNode:function(e,t){var i={useAsyncPreExpand:!1};i.label=e.label,i.icons=e.icons,e.usage&&(i.usage=e.usage),i.mxid=e.mxid,i.children=[],i.id=e.physicalid,i.plmType=e.plmType,i.type=e.type,t?this._createTreeNodeModel(i,t):this._createTreeNodeModel(i,this._rootNodeLibraries)},_createTreeNodeModel:function(e,t,i){var n=this,r=t instanceof a,s=e.publishOnConnect;delete e.publishOnConnect;var c=new o(e);if(c.id=e.id,c.mxid=e.mxid,c.plmType=e.plmType,e.usage?c.options.usage=e.usage:e.grid&&(c.options.usage=e.grid["ds6w:classificationUsage"]),e.isFavorite&&(c.isFavorite=!0),e.created&&(c.created=e.created),c._instanceType="LibraryEditor/TreeNodeModel",c._loadingcounter=0,c.getID=function(){var e=this.id;return e&&""!==e||(e=this.plmType),e},c.getMXID=function(){var e=this.mxid;return e&&""!==e||(e=this.plmType),e},c.options.oldLabel=e.label,c.pathId=(r?"root":t.pathId)+","+c.getID(),"TRUE"===s){var u=l.getWebappsAssetUrl("LibraryEditor","icons/libraryPublishBadge.png");c.setBadges({bottomRight:u})}c.onPostExpand(function(e){if(!e.data||!e.data.expandAll){var t=[];if(this&&this.getChildren){var i=this.getChildren();UWA.is(i,"array")&&i.forEach(function(e){t.push(e.getID())})}d.libraryStructurePreference.add(this.pathId,t)}}),c.onPostCollapse(function(e){d.libraryStructurePreference.remove(this.pathId)}),y(c).subscribe({event:"removeChild"},function(e){if(c.isExpanded()&&c.isVisible()){var t=e.nodeModel;!t&&e.data&&(t=e.data.nodeModel),t&&d.libraryStructurePreference.remove(t.pathId)}}),y(c).subscribe({event:"addChild"},function(e){if(c.isExpanded()&&c.isVisible()){var t=e.nodeModel;!t&&e.data&&(t=e.data.nodeModel),t&&t._isExpanded&&d.libraryStructurePreference.add(t.pathId)}}),r?t.addRoot(c):t.addChild(c,i);var h=function(e){r?c[e]():t.isExpanded()?(c.isVisible()&&"select"===e&&n._libraries_TreeDocument.getXSO().empty(),("expand"!==e||!c.isExpanded()&&"expanding"!==c.getState())&&c[e]()):y(t).subscribeOnce({event:"postExpand"},function(t){"expanding"!==c.getState()&&("select"===e&&n._libraries_TreeDocument.getXSO().empty(),c[e]())})},f=widget?widget.defaultSelectionPathFromWin:null;return d.libraryStructurePreference.isExpanded(c.pathId,function(e){(e||f&&-1!=f.indexOf(c.pathId))&&(n.dataProvider.isPreferenceSection(c.plmType)&&!n._rootNodeFavorite&&(n._rootNodeFavorite=c),h("expand"))}),f?f==c.pathId&&h("select"):d.libraryStructurePreference.isSelected(c.pathId,n.defaultSelectedSection,function(e){e?h("select"):c.pathId===n._TreeNodeToBeAddedtoLibraryCSOWithoutSelection_pathId&&(n.CSOProvider.addInCSO(c,"TREE"),n._TreeNodeToBeAddedtoLibraryCSOWithoutSelection_pathId=void 0)}),c},_scrollToVisibleNode:function(e){var t=this._libraries_TreeView,i=t.layout.getColumnIndex("tree"),n=t.layout.getCellsFromNodeModel(e)[i];t.scrollToCellAt({cellID:n})},_scrollOnPostUpdateView:function(e){var t=this,i=this._libraries_TreeView?this._libraries_TreeView:null,n=d.libraryStructurePreference.doScrollAfterSelect(e.getID());i&&n&&i.onPostUpdateViewOnce(function(){d.libraryStructurePreference.doScrollAfterSelect(e.getID())&&(t._scrollToVisibleNode(e),d.libraryStructurePreference.scrollAfterSelect(""))})},onContextualMenuReady:function(e){var t=this;return new Promise(function(i){var n=e.cellInfos,r=void 0;try{r=n.nodeModel?n.nodeModel:n.cellModel}catch(e){}if(r)if(r&&t.dataProvider.getContextualMenu){var a=t.CSOProvider.getSelectedNodes(),o=[];a.length&&a.forEach(function(e){o.push(e)}),o.length&&o.forEach(function(e){e.unselect()});var s=!1;if(n.nodeModel)if(!1===n.nodeModel._isSelected&&(n.nodeModel._isSelected=!0,n.nodeModel.select(!0)),!0===n.nodeModel._isSelected)(n.nodeModel?n.nodeModel:n.cellModel)&&(s=!0);s?t.dataProvider.getContextualMenu(n).then(function(e){e&&e.forEach(function(e){"separator"===e.type||"SeparatorItem"===e.type?e.type="SeparatorItem":e.label&&(e.title=e.label,e.action={callback:e.callback},e.type="PushItem")}),i(e)}):i([])}else i([]);else i([])})},onViewChange:function(e){this.elements.container.removeClassName(e.previous.type),this.elements.container.addClassName(e.type)},getSortingContainer:function(){return this._libraries_SortElmt.elements.container},setObjectOnCompass:function(e){h.setObject_on_compass({nodes_2_open:e})},render:function(){return this},isTreeNodeModelInstance:function(e){return e instanceof o},_shouldAcceptDrag:function(e){var t=this.CSOProvider.getCurrentObject();return!(!t||!t.isFavorite)},_shouldAcceptDrop:function(e){return!e||"middle"!==e.dropPosition||"Library"!==e.draggedNodes[0].plmType||!e.draggedNodes[0].isFavorite}})}),define("DS/IPClassifyUX/LibraryTree",["UWA/Class","DS/Logger/Logger","DS/IPClassifyUX/views/LibraryTreeView","DS/IPClassifyUX/models/LibraryTreeModel","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/IPClassifyUX/assets/nls/IPClassifyUX","DS/PADUtils/PADProbes","DS/PlatformAPI/PlatformAPI","css!DS/IPClassifyUX/IPClassifyUX","DS/WidgetServices/WidgetServices","DS/IPClassifyUX/models/LibrarySearchModel","UWA/Controls/Abstract","DS/PADServices/utils/GlobalModelEvents"],function(e,t,i,n,r,a,o,s,l,d,c,u,h,f){"use strict";var g=h.extend({name:"LibraryTreeController",_libraryTreeView:null,_probeLoadElmt:null,_logger:null,_libraryContentView:null,init:function(e){this._parent(e),this._probeLoadElmt=s.createProbe("loadTreeCont"),this.dataProvider=e.dataProvider,this.CSOProvider=e.CSOProvider,this._libraryTreeView=new i(e,this),this._libraryTreeView.createLibrarySections(this.dataProvider.getSectionsData()),this._libraryTreeView.getSortingContainer().inject(this._libraryTreeView.elements.container),this._OnTreeComponentReady(),this.dispatchEvent.call(this,"onReady"),this._logger=t.getLogger(g)},_OnTreeComponentReady:function(){var e=this;a.onCurrentLibraryChange(function(t){if(n.libraryStructurePreference.select(this.pathId),this.id&&""!==this.id&&e.dataProvider.isValidType(this.plmType)){for(var i=e.CSOProvider.getCurrentObjectPath(),r=[],a=Array.isArray(i)?i.length:0,o=0;o<a-1;o++)r.push({resourceid:i[o].id,type:i[o].type});var s={};if(a>=1){var d=a-1;i[d].id&&(s[i[d].id]={type:i[d].type,label:i[d].label})}var u=[];t.currentNode&&!e.dataProvider.isSection(t.currentNode.getType())&&(t.currentNode.systemType=i[a-1].type,u=[t.currentNode]),e._libraryTreeView.setObjectOnCompass(u),c.isNatifEnvironnement()||e._libraryTreeView._commandProxy.select({paths:[[this.id]],attributes:s,libraryPath:r,doNotSetOnCompass:!0})}else e.dataProvider.isSection(this.plmType)&&e._libraryTreeView._commandProxy.select({paths:[],attributes:{},libraryPath:[],doNotSetOnCompass:!0});e._libraryTreeView._scrollOnPostUpdateView(t.currentNode);var h=JSON.stringify(e.dataProvider.getSecurityContextAndData());l.publish("LibraryEditor.CurrentLibrary",h)}),a.onExpandTreeAndSelect(function(t){e.expandTreeAndSelectLibrary(t)}),f.getModelEvents().subscribe({event:"select_breadcrumb_object"},function(t){e.expandTreeAndSelectLibrary({libraryToFindAndSelect:t,onComplete:function(e){console.log(" expandTreeAndSelectLibrary:onComplete")},onGiveUp:function(e){console.log(" expandTreeAndSelectLibrary:onGiveUp")},onFailure:function(e){r.displayNotification({message:e instanceof Error?e.message:e,className:"error"})}})}),a.onTreeSortChange(function(t){if(e.getView()._libraries_TreeView){var i=e.getView()._libraries_TreeView;i.sortModel=[{dataIndex:"tree",sort:"asc"===t.sortOrder?"asc":"desc",sortFunction:e.dataProvider.comparator}],i.reapplySortModel()}}),a.onActivateTreeItem(function(t){var i=t.resourceid,n=t.mxid,a=t.type,s=t.label;i&&e.dataProvider.isValidType(a)?e.expandTreeAndSelectLibrary({libraryToFindAndSelect:{id:i,mxid:n,type:a,name:s},onComplete:function(e){console.log(" expandTreeAndSelectLibrary:onComplete")},onGiveUp:function(e){console.log(" expandTreeAndSelectLibrary:onGiveUp")},onFailure:function(e){r.displayNotification({message:o.replace(o.get("msg_error_LibraryActivate"),{name1:s}),className:"error"})}}):console.log("Selected (Double Clicked) object is not library")}),a.onLibraryRename(function(t){var i=JSON.stringify(t,(()=>{const e=new WeakSet;return(t,i)=>{if("object"==typeof i&&null!==i){if(e.has(i))return;e.add(i)}return i}})()),n=JSON.parse(i).oldNode.id,r=JSON.parse(i).newLabel;e.updateNodeLabel(n,r)}),this._probeLoadElmt.end()},updateNodeLabel:function(e,t){var i,n=[],r=UWA.is(e,"string")?e:e.physicalid?e.physicalid:null;(n=r?this._getNodesById(r):[e]).length>0&&t&&(i=t,n.forEach(function(e){if(e.getLabel()!==i){e._lastUpdateTime=Date.now();var t=UWA.extend(e.options,{label:i,oldLabel:i},!0);e.withTransactionUpdate(function(){e.updateOptions(t)})}}))},_getNodesById:function(e,t){var i=[],n=[],r=this;t?i=[t]:r.getView()._libraries_TreeDocument.getRoots().forEach(function(e){e&&"LibrarySection_favorite"!=e.plmType&&i.push(e)});return i.forEach(function(t){t.getID()==e&&n.push(t);var i=t.getChildren();UWA.is(i,"array")&&i.forEach(function(t){r._getNodesById(e,t).forEach(function(e){n.push(e)})})}),n},destroy:function(){this._logger.log("destroy"),this._parent()},_onPreExpandTreeNode:function(e){var t=e.data.nodeModel;if(!t.preExpandInProgress){t.preExpandInProgress=!0;var i=this,r=t.options.id,a=t.options.id;n.setExpandAllOperation(e.data.expandAll),i.dataProvider.isValidType(t.plmType)&&!t.isFavorite?(t.removeChildren(),n.fetchLibraryContents({parentNodeID:r,parentNodeMXID:a,parentPath:t.pathId},i.dataProvider.expandObject).then(function(e){e&&e.length>0&&i._libraryTreeView._populateContentSection(e,t),null===t.options.children&&(t.options.children=[]),o()},function(e){o(),i._logger.log("WebService libraries Err : "+e)})):i.dataProvider.isPreferenceSection(t.plmType)?(t.removeChildren(),i._refreshFavoriteSection({onComplete:function(){o()}})):i.dataProvider.isSection(t.plmType)?(t.removeChildren(),n.fetchAllLibraries(t.pathId,i.dataProvider.getRootSectionContents).then(function(e){i._libraryTreeView._populateAllLibrariesSection(e,t),o()},function(e){o(),i._logger.log("WebService roots Err : "+e)})):o()}function o(){t.preExpandInProgress=!1,t.preExpandDone(),"expanded"===t.getState()&&t.setState({state:"expanded"})}},_refreshFavoriteSection:function(e){var t=this;t._libraryTreeView._rootNodeFavorite?n.getFavorites(t.dataProvider,{onComplete:function(i){t._libraryTreeView._populateFavoriteSection(i),e&&e.onComplete&&e.onComplete()},onFailure:function(i){t._logger.warn("LibraryTreeCont : unable to initialize list of Favorite Libraries",i),r.displayNotification({message:o.msg_error_nopreferences,className:"error"}),e&&e.onFailure&&e.onFailure(i)}}):(t._logger.log("LibraryTreeCont : LibrarySection_favorite node does not yet exist"),e&&e.onFailure&&e.onFailure(new Error("LibrarySection_favorite node does not yet exist")))},isLibraryAmongFavoriteLibraries:function(e){var t=!1;if(e){var i=this._libraryTreeView._rootNodeFavorite.getChildren();if(i)for(var n=0;n<i.length;++n){if(e==i[n].id){t=!0;break}}}return t},addFavorite:function(e){if(e){var t=this,i=Array.isArray(e)?e:[e];n.setFavorites(t.dataProvider,{favoriteLibraries:i,onComplete:function(e){for(var i=0;i<e.length;++i){var n=e[i];t._libraryTreeView._addFavouriteNode(n);var a=n.label?n.label:"";r.displayNotification({message:o.replace(o.get("msg_info_favoriteadded"),{name1:a}),className:"primary"})}},onFailure:function(e){t._logger.warn("WebService setFavorites Err : "+e)}})}else t._logger.log("LibraryTreeCont unable to addFavorite, newFavoriteLibrary(s) is not define")},addNewNode:function(e){var t=null;e.parentid&&(t=this._getNodesById(e.parentid)[0]);this._libraryTreeView.addNewNode(e,t)},removeFavorite:function(e){for(var t,i=this,s=!1,l=i._libraryTreeView._rootNodeFavorite.getChildren(),d=Array.isArray(l)?l.length:0,c=0;c<d;++c){var u=l[c];if(e.id==u.id){s=u.isSelected(),t=e.name?e.name:"",i._libraryTreeView._rootNodeFavorite.removeChild(u),!1===i._libraryTreeView._rootNodeFavorite.hasChildren()&&i._libraryTreeView._rootNodeFavorite.withTransactionUpdate(function(){i._libraryTreeView._rootNodeFavorite.removeChildren(),i._libraryTreeView._rootNodeFavorite.setState({state:"collapsed"})});break}}var h="";i.CSOProvider.getCurrentObject()&&(h=i.CSOProvider.getCurrentObject().getType()),i.dataProvider.isPreferenceSection(h)&&a.notifyRemoveNodeInContent(e.id),n.removeFromFavorites(i.dataProvider,{favoritesToRemove:e.id,onComplete:function(e){e||a.notifyFavoriteSectionEmpty(),r.displayNotification({message:o.replace(o.get("msg_info_favoriteremoved"),{name1:t}),className:"primary"}),s&&i._libraryTreeView._rootNodeFavorite.select()},onFailure:function(e){i._logger.warn("WebService getFavorites Err : "+e),r.displayNotification({message:o.msg_error_nopreferences,className:"error"})}})},renameFavorite:function(e,t,i){var s=this;function l(e,t){e.prepareUpdate(),e.setLabel(t),e.pushUpdate()}function d(){i&&l(i,e.name),r.displayNotification({title:o.replace(o.get("msg_error_rename").title,{name1:e.name}),subtitle:o.msg_error_rename.subtitle,className:"error"})}n.getFavorites(s.dataProvider,{onComplete:function(c){for(var u,h=c,f=0,g=0;g<h.length;++g)if(u=h[g],e.id==u.physicalid){u.label=t,f=1;break}f?n.setFavorites(s.dataProvider,{favoriteLibraries:[{id:u.physicalid,name:u.label}],renamed:!0,onComplete:function(n){i&&i._instanceType&&"LibraryEditor/TreeNodeModel"==i._instanceType||s._libraryTreeView._rootNodeFavorite.getChildren().forEach(function(i){i&&e.id==i.id&&l(i,t)});r.displayNotification({message:o.replace(o.get("msg_info_favoriterenamed"),{name1:e.name,name2:t}),className:"primary"}),a.notifyLibraryRename({oldNode:e,newLabel:t})},onFailure:function(e){s._logger.warn("WebService setFavorites Err : "+e),d()}}):(s._logger.warn("LibraryTreeCont favorite library to rename, not found in list"),d())},onFailure:function(e){s._logger.warn("WebService getFavorites Err : "+e),r.displayNotification({message:o.msg_error_nopreferences,className:"error"}),d()}})},expandTreeAndSelectLibrary:function(e){var t=e&&e.libraryToFindAndSelect?e.libraryToFindAndSelect.id:void 0,i=this;if(t){var r=i._getVisibleNodeById(t,null);if(r){i.CSOProvider.getCurrentObject();if(e.doNotSelectInTree?i.CSOProvider.addInCSO(r,"TREE"):(i._libraryTreeView._scrollToVisibleNode(r),r.select(!0)),e.onComplete){var a={libraryToFindAndSelect:e.libraryToFindAndSelect,correspondingTreeNodeModel:r};e.onComplete(a)}}else{var s=i.CSOProvider.getCurrentObject(),l=i.CSOProvider.getCurrentObjectPath(),d=l.length;if(1===d&&i.dataProvider.isPreferenceSection(l[0].type)||e.isInvisible||u.isSearchActive())n.getLibraryPathLength(i.dataProvider.getObjectPathLength,{pid:t,onComplete:function(e){d=e,g()},onFailure:function(e){}});else if(1===d&&i.dataProvider.isSection(l[0].type)){var c="root,"+l[0].type,h=c+","+t;n.libraryStructurePreference.add(c),n.libraryStructurePreference.select(h),n.libraryStructurePreference.scrollAfterSelect(t),n.libraryStructurePreference.remove(h);var f=i._libraryTreeView._rootNodeLibraries;"expanding"!==f.getState()&&f.expand()}else g()}}else i._logger.log("expandTreeAndSelectLibrary error : libraryToFindAndSelect is undefined"),e.onFailure&&e.onFailure(new Error("Tree exploration stopped, libraryToFindAndSelect is undefined"));function g(){n.getLibraryPath(i.dataProvider.getObjectPath,{depth:d,pid:t,onComplete:function(r){if(!function(e){var t=!1;if(i.CSOProvider.getCurrentObject()!==s&&(t=!0,e.onGiveUp)){var n={libraryToFindAndSelect:e.libraryToFindAndSelect};e.onGiveUp(n)}return t}(e))if(i._libraryTreeView._rootNodeLibraries){var a=null,l=null,d=i._libraryTreeView._rootNodeLibraries,c=d.pathId;i.dataProvider.resetFilterIfNodeIsNotCompliant&&i.dataProvider.resetFilterIfNodeIsNotCompliant(r);for(var u=0;u<r.length;++u){var h=r[u],f=h.physicalid;if(i.dataProvider.isRoot(h)&&(l=f),f){if(!a){var g=i._getVisibleNodeById(f,d);g&&g.isVisible()?(d=g,c=g.pathId):a=d}if(a){var p=c;n.libraryStructurePreference.add(p),d=null,c=c+","+f}}else i._logger.log("unexpected undefined parentObjectId")}if(l)if(a){var _=p+","+t;if(e.doNotSelectInTree?(n.libraryStructurePreference.select(""),n.libraryStructurePreference.scrollAfterSelect(""),i._TreeNodeToBeAddedtoLibraryCSOWithoutSelection_pathId=_):(n.libraryStructurePreference.select(_),n.libraryStructurePreference.scrollAfterSelect(t)),n.libraryStructurePreference.remove(_),"expanding"!==a.getState()&&a.expand(),e.onComplete){var b={libraryToFindAndSelect:e.libraryToFindAndSelect};e.onComplete(b)}}else console.log("   Damnation, no firstUnexpandedTreeNodeModelParentFound"),e.onFailure&&e.onFailure(new Error(o.msg_error_TreeExpandCancelledInternalError));else e.onFailure&&e.onFailure(new Error(i.dataProvider.getObjectNotVisiblemessage()))}else i._logger.log("  No LibrarySection_AllLibraries to start expandTreeAndSelectLibrary"),e.onFailure&&e.onFailure(new Error(o.msg_error_TreeExpandCancelledNotReady))},onFailure:function(t){i._logger.log("WebService getLibraryPath Err : "+t),e.onFailure&&e.onFailure(t)}})}},_getVisibleNodeById:function(e,t){var i=t||this._libraryTreeView._rootNodeLibraries,n=null;if(i&&i.isVisible())if(i.getID()===e)n=i;else if(i.isExpanded()){var r=i.getChildren();if(Array.isArray(r)&&r.length>=1)for(var a=0;a<r.length;a++){var o=r[a];if(o){if(o.id==e){n=o;break}var s=this._getVisibleNodeById(e,o);if(s&&s.isVisible()){n=s;break}}}}return n},refreshLibraryTree:function(){this._libraryTreeView._rootNodeFavorite.isExpanded()&&(this._libraryTreeView._rootNodeFavorite.collapse(),this._libraryTreeView._rootNodeFavorite.expand()),this._libraryTreeView._rootNodeLibraries.isExpanded()&&(this._libraryTreeView._rootNodeLibraries.collapse(),this._libraryTreeView._rootNodeLibraries.expand())},switchLibraryTreeNodeLabelToWriteView:function(e){var t=!1;if(e.getTreeDocument()===this._libraryTreeView._libraries_TreeDocument&&this._libraryTreeView._libraries_TreeView){var i=this._libraryTreeView._libraries_TreeView;if(i){var n=i.getCell(e._getRowID(),"tree"),r=n?n.getView():void 0;r&&(r.switchToWriteView(),t=!0)}}return t},getView:function(){return this._libraryTreeView},performOperationOnNode:function(e,t){e[t]()}});return g});