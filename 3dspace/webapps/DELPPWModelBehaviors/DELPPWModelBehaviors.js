define("DS/DELPPWModelBehaviors/InterWidgetComBehavior",["UWA/Core"],function(e){"use strict";return{plugins:["InterWidgetComPlugin"],creator:function(e,t,n){e.getLogger();return{listenTo:function(){return{}},onStart:function(){},onStop:function(){},addEventListener:function(e,t){n.addEventListener(e,t)},subscribeEvent:function(e,t){n.subscribeEvent(e,t)},publishEvent:function(e,t){n.publishEvent(e,t)},isWidgetLinked:function(e){return n.isWidgetLinked(e)},isOpsViewerWidgetLinked:function(){return n.isOpsViewerWidgetLinked()},isCloud:function(){return n.isCloud()}}}}}),define("DS/DELPPWModelBehaviors/OperationTimeBehavior",["UWA/Core"],function(e){"use strict";return{plugins:["TreeViewPlugin","DicoPlugin","DatabasePlugin","ResourcePlugin","AttributePlugin","WebServicePlugin"],creator:function(t,n,i,o,r,a,s,c){var l,u,f,d,g,m,p,P,L,I,S,h,C,y,D,R,v,A,V=null,E="DELLmiOperationReference.V_TimeMode",N=["DELLmiHeaderOperationReference.V_UseGanttTimeSolver","DELLmiGeneralOperationReference.V_UseGanttTimeSolver"],b={};return l=function(){var e,t={},n={},i="DELLmiOperationReference.V_OperationTime";e={Name:"V_OperationTime",NLS:a.getNLSValue("Attribute."+i),Type:"Double",Protection:3,MultiValuated:"No",HasRangeDefined:"No",DefaultValue:"",MaxLength:256,Magnitude:"TIME",ManipulationUnit:"",MultiLine:"No",UIAccess:"",HasDefault:"No"},n[i]=e.NLS,t[i]=e,a.addNlsJSON(n),s.addAttributeInfo(t)},f=function(t){var n=null,i=r.getReference(t);if(e.is(i)){let e=i.get(E);if(null!==e){let t=o.getAttributeInfo(E);n=s.getAuthorizedValue(t,null,e)}}return n},u=function(){var t,o;return e.is(V)||(t=i.getViewColumnPreferences(n.getId()),o=e.is(t)?t.Columns.Column:[],V=o.some(function(e){return"V_OperationTime"===e.dataIndex&&!e.isHidden})),V},d=function(t,n,i){return c.webServiceRequest({url:"dsmfg/private/V0/invoke/MfgProcess/fetchOperationTime",method:"POST",headers:c.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),data:e.Json.encode({rirPaths:t}),context:this,onFailure:i,onTimeout:i,onCancel:i,onComplete:function(t){var i,o={};if(e.is(t))for(i in t)Object.hasOwnProperty.call(t,i)&&(b[i]=t[i],o[i]={},o[i].V_OperationTime=b[i]);n(o)}})},g=function(e){var t=n.getBehavior("WUXNodeModelBehavior"),i=[],o={};u()&&(e instanceof Set&&(e=Array.from(e)),(e=Array.isArray(e)?e:[e]).length>0&&(e.forEach(function(e){var n=t.getNodeModel(e);null!==n&&n.forEach(function(e){var t=e.getRIRpath().toString();i.push(t),o[t]={},o[t].V_OperationTime="FetchInProgress"})}),n.notify("updateNodes",o),d(i,function(e){n.notify("updateNodes",e)},function(){n.notify("unsetNodeAttr",[i,"V_OperationTime"])})))},m=function(t){var i=[],o={};return u()&&Array.isArray(t)&&(t.forEach(function(t){var n=r.getReference(t[t.length-1]);r.isOperation(n)&&(t=t.toString(),o[t]={},e.is(b[t])?o[t].V_OperationTime=b[t]:(i.push(t),o[t].V_OperationTime="FetchInProgress"))}),i.length>0&&d(i,function(e){n.notify("updateNodes",e)},function(){n.notify("unsetNodeAttr",[i,"V_OperationTime"])})),o},p=function t(n,i,o){var a=[];(e.is(i)?[i]:r.getParentInstancesFromCollection(n)).forEach(function(n){var i=r.getAggregatingReferenceModelFromInstance(n),s=i.get("PID");if(-1===a.indexOf(s)){if(r.isOperation(i)){let n=D(i.keys());e.is(n)&&"TRUE"===i.get(n)&&(t(s,null,o),o.add(s))}a.push(s)}})},P=function t(n,i){var o=r.getReference(n),a=D(o.keys());e.is(a)&&"TRUE"===o.get(a)&&r.getInstancesFromCollection(n).forEach(function(e){let n=e.get("isInstanceOf");"3"===f(n)&&i.add(n),t(n,i)})},L=function(t){var n=new Set;u()&&((t=e.is(t,"array")?t:[t]).forEach(function(e){var t,i=e.get("PID");r.isOperation(e)&&(t=e.changedAttributes(),(Object.hasOwnProperty.call(t,E)||Object.hasOwnProperty.call(t,"DELLmiOperationReference.V_EstimatedTime")||Object.hasOwnProperty.call(t,"DELLmiOperationReference.V_MeasuredTime")||R(Object.keys(t)))&&(p(i,null,n),n.add(i)))}),g(n))},I=function(t){var n=new Set;u()&&((t=e.is(t,"array")?t:[t]).forEach(function(e){var t=e.changedAttributes(),i=e.get("type");if("DELAsmProcessCanUseCnx"===i){let i=e.get("from");Object.hasOwnProperty.call(t,"DELLmiEstimatedTime.V_EstimatedTime")?"3"===f(i)&&(p(i,null,n),n.add(i)):Object.hasOwnProperty.call(t,"DELAsmProcessCanUseCnx.V_IsPreferred")&&"TRUE"===t["DELAsmProcessCanUseCnx.V_IsPreferred"]&&(n.add(i),P(i,n))}if("PrimaryResourceLinkDetail"===i){let i=e.get("from"),o=Array.isArray(i)?i[i.length-1]:i;Object.hasOwnProperty.call(t,"DELLmiEstimatedTime.V_EstimatedTime")&&"3"===f(o)&&(p(o,null,n),n.add(o))}}),g(n))},h=function(t){var n=new Set;u()&&((t=e.is(t,"array")?t:[t]).forEach(function(e){if("DELAsmProcessCanUseCnx"===e.get("type")){let t=e.get("from");0===r.getImpacted(t,!0,{relationTypes:["DELAsmProcessCanUseCnx"]}).length&&(n.add(t),P(t,n))}}),g(n))},S=function(t){var n=new Set;u()&&((t=e.is(t,"array")?t:[t]).forEach(function(e){p(null,e,n)}),g(n))},C=function(t){var n,i;if(u()&&e.is(t)&&(n=t.newParentPID,i=r.getReference(n),r.isOperation(i))){let t=D(i.keys());e.is(t)&&"TRUE"===i.get(t)&&g(n)}},y=function(){var t,i,o,a=n.getBehavior("WUXNodeModelBehavior"),s=e.is(V)?V:null;V=null,s!==(t=u())&&(t?e.is(a)&&(i=(i=a.getVisibleNodesInViewport().map(e=>e.getReferencePID())).filter(e=>r.isOperation(e)),g(i)):(o=[],r.getAllReferences().forEach(function(e){if(r.isOperation(e)){let t=a.getNodeModel(e.get("PID"));null!==t&&t.forEach(function(e){var t=e.getRIRpath().toString();b.hasOwnProperty(t)&&o.push(t)})}}),o.length>0&&n.notify("unsetNodeAttr",[o,"V_OperationTime"]),v()))},D=function(e){var t;if(Array.isArray(e)&&Array.isArray(N))for(let n=0;n<N.length;n++)if(-1!==e.indexOf(N[n])){t=N[n];break}return t},R=function(t){var n=!1,i=D(t);return e.is(i)&&(n=!0),n},v=function(){u()&&(b={})},A=function(){var e=n.getBehavior("WUXNodeModelBehavior").getSelectedNodes();u()&&e.forEach(function(e){let t=e.getRIRpath().toString();b.hasOwnProperty(t)&&(delete b[t],Object.keys(b).forEach(function(e){e.startsWith(t)&&delete b[e]}))})},{listenTo:function(){return{referenceChanged:L,connectionChanged:I,instanceAdded:S,instanceRemoved:S,connectionRemoved:h,reparentInstances:C,TreeViewPrefModified:y,refreshOperationTime:g,refreshAll:v,RefreshCmd:A}},onStart:function(){var e;e={boAttrName:[E,"DELLmiOperationReference.V_EstimatedTime","DELLmiOperationReference.V_MeasuredTime"],roAttrName:[],otherAttrName:[]},N.forEach(function(t){e.boAttrName.push(t)}),V=u(),l(),r.setSelectPredicate(n.getId(),e)},onStop:function(){},isColumnVisible:function(){return u()},getUpdateOptionsForVisibleNodes:function(e){return m(e)}}}}}),define("DS/DELPPWModelBehaviors/MfgProcessBehavior",["UWA/Core"],function(e){"use strict";return{plugins:["MfgProcessPlugin","ResourcePlugin","BIPlugin","DatabasePlugin","ProcessImplementPlugin","DicoPlugin"],creator:function(t,n,i,o,r,a,s,c){var l,u;t.getLogger();return l=function(t){var n,i,o,r=[];return Array.isArray(t)?(n=t[t.length-1],i=a.getReferenceModel(n),0===(r=s.getScopeLinks(i.get("PID"))).length&&(o=s.findInstanceWhoseParentIsScoped(t),e.is(o,"object")&&(r=o.scopeLinks))):r=s.getScopeLinks(t),r},u=function(e){var t=[];return e.forEach(function(e){var n=e.get("to");t.push(n)}),t},{webservice:function(t,s,c,l){var u,f,d,g,m={noTimeout:!0},p=!1,P={silentMode:!0,updateItem:!0};n.notify("startProgress",m),e.is(c)&&e.is(c.logMessage)&&(f=n.log(c.logMessage)),(s=s||{}).product&&(s.product.referencePID,s.product.OccPath),s.mfgItem&&(s.mfgItem.referencePID,s.mfgItem.instancePID),g=function(t){var i,o,r=[];t.instancesAndReferences.forEach(function(t){i=t.attributesValue,e.is(i.isInstanceOf)&&(o=a.getInstance(i.PID),n.notify("instanceAdded",[o,P]))}),t.connections.forEach(function(e){r.push(a.getConnection(e.PID))}),r.length>0&&n.notify("connectionAdded",[r])},"rerouteLink"===t&&(u="POST",d=e.Json.encode(c),(c=e.merge(c,{appenedURL:"ExecuteSuggestedActions"})).onComplete=function(t,i,o){g(o),e.is(l)&&l(o),p&&n.notify("toggleCmdCheckHeaderState",{cmdName:"BIEssentialsCmd",cmdState:!0}),n.notify("stopProgress",m)}),c.onFailure=function(t){var i=c.logMessage+" "+o.getNLSValue("failed");e.is(t)&&(i=i+". "+t.message),n.warn(i,f),n.notify("stopProgress",m),e.is(l)&&l(),p&&n.notify("toggleCmdCheckHeaderState",{cmdName:"BIEssentialsCmd",cmdState:!0})},(p=r.getBICmdState())&&n.notify("toggleCmdCheckHeaderState",{cmdName:"BIEssentialsCmd",cmdState:!1}),i.webserviceAndProcessing(u,d,c)},isInstPossible:function(t){var n,i,o,r,a,f,d=t.parent,g=t.child,m=e.is(t.targetAbsPath)?t.targetAbsPath:null,p=!0;return e.is(m)&&c.isAKindOf(g,"DELLmiHeaderOperationReference")&&(n=Array.isArray(m)&&m.length>0?m:d.get("PID"),i=g.get("PID"),r=s.getPartialScopeLinks(i),Array.isArray(r)&&r.length>0&&(p=!1,o=l(n),r.length===o.length&&(a=u(o),f=u(r),p=a.every(function(e){return f.indexOf(e)>=0})))),p},getBrokenMfgProcessStatus:function(e,t){r.getBrokenMfgProcessStatus(e,t)}}}}}),define("DS/DELPPWModelBehaviors/ResourceBehavior",[],function(){"use strict";return{plugins:["ResourcePlugin"],creator:function(e,t,n){return{onStart:function(){},onStop:function(){},getNLSValue:function(e,t,i,o){return n.getNLSValue(e,t,i,o)},getNLSForUnit:function(e,t){return n.getNLSForUnit(e,t)},getIconURLFromKey:function(e,t,i){return n.getIconURLFromKey(e,t,i)},getIconElem:function(e,t){return n.getIconElem(e,t)}}}}}),define("DS/DELPPWModelBehaviors/SpecifyScopeIntentDialog",["UWA/Core"],function(e){"use strict";return function(t,n){const i=function(i,o,r){const a=[n.getNLSValue("ImplementBehavior.SpecifyScopeIntent.message.line1"),n.getNLSValue("ImplementBehavior.SpecifyScopeIntent.message.line2")].map(e=>`<p>${e}</p>`).join("");let s=e.createElement("div",{class:"specifyScopeIntent-container",html:a}),c=e.createElement("div",{class:"specifyScopeIntent-content-container"});s.inject(c),"function"!=typeof o?function(i,o,r){let a=t.create("Dialog",{title:n.getNLSValue("ImplementBehavior.SpecifyScopeIntent.Title"),domId:"specifyScopeIntentDialog",identifier:"specifyScopeIntentDialog",content:i,minHeight:150,minWidth:400,modalFlag:!0,resizableFlag:!0,customButtonsDefinition:[{label:n.getNLSValue("ImplementBehavior.SpecifyScopeIntent.Button.Cancel"),emphasize:"primary",onClick:function(){e.is(o,"function")&&o(),a.close()}},{label:n.getNLSValue("ImplementBehavior.SpecifyScopeIntent.Button.Fabrication"),emphasize:"secondary",onClick:function(){e.is(r,"function")&&r(),a.close()}}]});a.close=function(){this.destroy()}}(c,i,r):"function"!=typeof r?function(i,o,r){let a=t.create("Dialog",{title:n.getNLSValue("ImplementBehavior.SpecifyScopeIntent.Title"),domId:"specifyScopeIntentDialog",identifier:"specifyScopeIntentDialog",content:i,minHeight:150,minWidth:400,modalFlag:!0,resizableFlag:!0,customButtonsDefinition:[{label:n.getNLSValue("ImplementBehavior.SpecifyScopeIntent.Button.Cancel"),emphasize:"primary",onClick:function(){e.is(o,"function")&&o(),a.close()}},{label:n.getNLSValue("ImplementBehavior.SpecifyScopeIntent.Button.Assembly"),emphasize:"secondary",onClick:function(){e.is(r,"function")&&r(),a.close()}}]});a.close=function(){this.destroy()}}(c,i,o):function(i,o,r,a){let s=t.create("Dialog",{title:n.getNLSValue("ImplementBehavior.SpecifyScopeIntent.Title"),domId:"specifyScopeIntentDialog",identifier:"specifyScopeIntentDialog",content:i,minHeight:150,minWidth:400,modalFlag:!0,resizableFlag:!0,customButtonsDefinition:[{label:n.getNLSValue("ImplementBehavior.SpecifyScopeIntent.Button.Cancel"),emphasize:"primary",onClick:function(){e.is(o,"function")&&o(),s.close()}},{label:n.getNLSValue("ImplementBehavior.SpecifyScopeIntent.Button.Assembly"),emphasize:"secondary",onClick:function(){e.is(r,"function")&&r(),s.close()}},{label:n.getNLSValue("ImplementBehavior.SpecifyScopeIntent.Button.Fabrication"),emphasize:"secondary",onClick:function(){e.is(a,"function")&&a(),s.close()}}]});s.close=function(){this.destroy()}}(c,i,o,r)};return{show:function(e,t,n){i(e,t,n)}}}}),define("DS/DELPPWModelBehaviors/UserDefProceduresBehaviour",["UWA/Core"],function(e){"use strict";const t="workplan",n="process",i="resource",o="product";return{plugins:["WebServicePlugin","DatabasePlugin","RootsPlugin","PlatformPlugin","ResourcePlugin"],creator:function(r,a,s,c,l,u,f){var d,g={ProcDisplayName:f.getNLSValue("UserDefExploreBehavior.DefaultBehavior.ProcDisplayName"),ProcID:"default",ProcShortDescription:f.getNLSValue("UserDefExploreBehavior.DefaultBehavior.ProcShortDescription")},m=!!e.is(u.isLoadOOTBProcedures())&&u.isLoadOOTBProcedures(),p=[],P=new Set,L=null;return{isLoadOOTBProcedures:function(){return u.isLoadOOTBProcedures()},getAllProcedures:function(t){var n=function(e){var t,n;return d=[],P.clear(),e.forEach(function(e){e.forEach(function(e){t=c.getPPRType(e.id),n=c.transformToRIROccurrencePath(e.path).length>0?c.transformToRIROccurrencePath(e.path):[e.id],p.push(e.id),d.push({type:t,path:n}),t="OPERATION"===t?"SYSTEM":t,P.add(t)})}),P}(t);return new e.Promise(function(t){var i,o;e.is(L)?t({procs:L,selectedPPRTypes:n}):(i={url:"delmcb/api/UDOWebServices/GetProcedureList",method:"GET",onFailure:function(e){a.debug("GetProcedureList Failed "+e),t({procs:[],selectedPPRTypes:n})},onComplete:function(i){o=e.is(i)&&e.is(i.Scenarios)?i.Scenarios:[],L=m?o:o.filter(function(e){return"Custo"===e.ProcCategory}),a.debug("GetProcedureList succeeded"),t({procs:L,selectedPPRTypes:n})}},s.webServiceRequest(i))})},filterApplicableProcedures:function(t,n){var i,o=t.procs,r=t.selectedPPRTypes,c=[];e.is(o)&&o.length>0&&!e.is(o[0].supportedPPRTypes)&&(c=o.map(function(t){return new e.Promise(function(e,n){var i;i={url:"delmcb/api/UDOWebServices/GetProcedureDetails",method:"POST",data:JSON.stringify({ProcID:t.ProcID}),onFailure:function(e){a.debug(e),n(e)},onComplete:function(n){switch(n.ProcNodeType){case"EBOM":t.supportedPPRTypes=["PRODUCT"];break;case"MBOM":t.supportedPPRTypes=["PROCESS","SERVICE"];break;case"Workplan":case"System":t.supportedPPRTypes=["SYSTEM"];break;case"Resource":t.supportedPPRTypes=["RESOURCE"];break;case"Any":t.supportedPPRTypes=["ALL"];break;default:a.debug("Unsupported procedure in MGA")}e()}},s.webServiceRequest(i)})})),e.Promise.allSettled(c).then(function(e){var t=0;e.forEach(function(e){"rejected"===e.state&&t++}),0===t?(i=function(e){var t=[];return 1===e.size&&null!==L?t=L.filter(function(t){var n=!1;return Array.isArray(t.supportedPPRTypes)&&(n=t.supportedPPRTypes.indexOf(Array.from(e)[0])>-1||t.supportedPPRTypes.indexOf("ALL")>-1),n}):console.error("Objects of different PPR types are selected or Procedures are not available."),t.unshift(g),t}(r),n(i)):t===e.length?(a.debug("GetProcedureDetails failed"),n([g])):(a.debug("GetProcedureDetails partially failed"),n([g]))})},executeProcedure:function(r,u,g){var m,P,L,I,S={},h=g||{},C=function(r,s){var u,f,g,m={workplan:[],process:[],resource:[],product:[]};return f={workplan:{path:[],rootPID:"",configId:""},process:{path:[],rootPID:"",configId:""},product:{path:[],rootPID:"",configId:""},resource:{path:[],rootPID:"",configId:""}},u=function(e,t){f[e].path.push({pids:t}),f[e].rootPID=t[0],f[e].configId=l.getCompatibleConfigurationFilters([t[0]])[t[0]]},g=function(r){var a="";switch(c.getPPRType(r)){case"PROCESS":case"SERVICE":a=n;break;case"PRODUCT":a=o;break;case"RESOURCE":a=i;break;case"SYSTEM":case"OPERATION":a=t}e.is(m[a])&&m[a].push({compiledForm:"",configuration:f[a].configId,rootId:r,volume:""})},d.forEach(function(e){switch(e.type){case"PROCESS":case"SERVICE":u(n,e.path);break;case"PRODUCT":u(o,e.path);break;case"RESOURCE":u(i,e.path);break;case"SYSTEM":case"OPERATION":u(t,e.path);break;default:a.debug("Invalid Type")}}),l.getRoots(a.getId()).forEach(function(e){Array.isArray(e)&&e.forEach(function(e){g(e)})}),'<execute xmlns="http://www.3ds.com/xmql/query"><function>'+r+"</function><version>"+s+'</version><params><param name="SEL_WK_PL">{"modelerName":"workplan","occurrences":'+JSON.stringify(f.workplan.path)+'}</param><param name="SEL_PRCS">{"modelerName":"process","occurrences":'+JSON.stringify(f.process.path)+'}</param><param name="SEL_PRD">{"modelerName":"product","occurrences":'+JSON.stringify(f.product.path)+'}</param><param name="SEL_RSC">{"modelerName":"resource","occurrences":'+JSON.stringify(f.resource.path)+'}</param><param name="SEL_PROD_SYS">{"modelerName":"productionSystem","occurrences":'+JSON.stringify(f.workplan.path)+'}</param><param name="SEL_CPBL_RSC">{"modelerName":"resource","occurrences":'+JSON.stringify(f.resource.path)+'}</param><param name="PRD">{"modelerName":"product","occurrences":'+JSON.stringify(f.product.path)+'}</param><param name="PROD_SYS">{"modelerName":"productionSystem","occurrences":'+JSON.stringify(f.workplan.path)+'}</param><param name="WK_PL">{"modelerName":"workplan","occurrences":'+JSON.stringify(f.workplan.path)+'}</param><param name="RSC">{"modelerName":"resource","occurrences":'+JSON.stringify(f.resource.path)+'}</param><param name="PRCS">{"modelerName":"process","occurrences":'+JSON.stringify(f.process.path)+'}</param><param name="CPBL_RSC">{"modelerName":"capableResource","occurrences":'+JSON.stringify(f.resource.path)+'}</param><param name="ConfigurationsVal">[{"filters":'+JSON.stringify(m.product)+',"modelerName":"product"},{"filters":'+JSON.stringify(m.process)+',"modelerName":"process"},{"filters":'+JSON.stringify(m.workplan)+',"modelerName":"workplan"},{"filters":[{"compiledForm":"","configuration":'+JSON.stringify(f.workplan.configId)+',"rootId":'+JSON.stringify(f.workplan.rootPID)+',"volume":""}],"modelerName":"productionSystem"},{"filters":'+JSON.stringify(m.resource)+',"modelerName":"resource"},{"filters":[{"compiledForm":"","configuration":'+JSON.stringify(f.resource.configId)+',"rootId":'+JSON.stringify(f.resource.rootPID)+',"volume":""}],"modelerName":"capableResource"}]</param></params></execute>'}(r,u);a.notify("startProgress",S),L=function(t){var n=[],i=[],o=e.is(t.xmql_response.footer["global error"])?t.xmql_response.footer["global error"]:null,r=t.xmql_response.body.result;e.is(r)&&null===o?(r.forEach(function(e){Object.keys(e).length>0&&e.output.occurrences.forEach(function(e){i.push(e.pids),e.pids.forEach(function(e){-1===n.indexOf(e)&&n.push(e)})})}),m=function(e){var t,o,r,s,l=[],u=[],f=[],d=[];s=function(){a.notify("addOccurrece",[i]),r.length>0&&a.notify("selectNodes",[r])},p.forEach(e=>{t=c.getPPRType(e),-1===u.indexOf(t)&&u.push(t),c.getImpacted(e,!0,{excludeRelationTypes:["LinearProductFlowCnx"]}).forEach(function(e){e=Array.isArray(e)?e:[e],-1!==n.indexOf(e[e.length-1])&&l.push(e[e.length-1])})}),p=[],h.selectConnectedObjects&&(r=[],l.forEach(e=>{u.includes(c.getPPRType(e))||r.push(e)})),e.instancesAndReferences.forEach(e=>{f.push(e.id)}),(o=n.filter(e=>!f.includes(e))).length>0?(o.forEach(e=>{c.isInstance(e)||d.push(e)}),d.length>0?c.fetchInstancesAndTheirReferences(d,{onComplete:function(e){s()},silentMode:"true"}):s()):s(),a.notify("stopProgress",S)},P=function(){a.debug("Fetching getDescendantsFromServer for user defined procedure failed.")},c.getDescendantsFromServer(n,m,{onFailure:P,silentMode:!0,expandLevel:0,forceDBMode:!0})):(a.notify("stopProgress",S),o=(o=JSON.parse(o).MESSAGE).substr(o.lastIndexOf(":")+1),a.warn(o))},I=function(){a.notify("stopProgress",S),a.warn(f.getNLSValue("UserDefExploreBehavior.ExecuteProc.Failure"))},s.webServiceRequest({url:s.get3DSpaceUrl()+"i3dx/services/xmql",method:"POST",data:C,headers:{Accept:"application/json","Content-Type":"application/xml"},onComplete:L,onFailure:I,onTimeout:I,onCancel:I})}}}}}),define("DS/DELPPWModelBehaviors/LinkBehavior",["UWA/Core","UWA/Promise"],function(e,t){"use strict";return{plugins:["DatabasePlugin","DicoPlugin","WebServicePlugin","AttributePlugin","ResourcePlugin","ProductImplementPlugin","ProcessImplementPlugin","SelectionPlugin","PlatformPlugin"],creator:function(n,i,o,r,a,s,c,l,u,f,d){const g=l.getPartialScopeLinkType(),m="DELLmiProductionSystemOutputCnxToMBOM",p="MfgProcessAlternate",P="HistorizationLinkRefRef";var L,I,S,h,C,y,D,R,v,A,V,E,N,b,k,O;return S=function(t,n,o,r){o=o||{},e.is(n,"string")&&i.info(n,r),i.notify("stopProgress",t),e.is(o.onComplete,"function")&&o.onComplete.call(null,n)},h=function(t,n,o,r,a){r=r||{},e.is(o,"string")&&(n+="\n"+o),e.is(n,"string")&&(i.warn(n,a),i.debug(n)),i.notify("stopProgress",t),e.is(r.onFailure,"function")&&r.onFailure.call(null,n)},C=function(t){return new e.Promise(function(n){var r=[],a=function(t){var n,i;-1===r.indexOf(t)&&(n=o.getInstance(t),i=t,e.is(n)&&(i=n.get("isInstanceOf"),o.needToQueryForConnections(t)&&r.push(t)),-1===r.indexOf(i)&&o.needToQueryForConnections(i)&&r.push(i))};o.isNavigateOnDemand()||n({impactedList:[],relationsLoaded:!0}),(e.is(t)?t:f.getModuleSelections(i.getId())).forEach(function(e){a(e.id),Array.isArray(e.path)&&e.path.forEach(function(e){a(e)})}),r.length>0?o.getConnectionsFromServer(r,function(t){e.is(t)&&Array.isArray(t.connections)&&t.connections.length>0&&i.notify("connectionAdded",[t.connections]),n({impactedList:r,result:t,relationsLoaded:!0})}):n({impactedList:r,relationsLoaded:!0})})},y=function(e){return C(e).then(function(e){var t=e.impactedList;t.length>0&&(i.notify("refreshImpacted",{impactedChildren:[],impactedObjects:t}),i.getBehavior("RefreshBehavior").onRefreshSelected({impactedChildren:[],impactedObjects:t}))})},D=function(){return e.is(L)||(L=i.getBehavior("ProductImplementBehavior")),L},R=function(){return e.is(I)||(I=i.getBehavior("ProcessImplementBehavior")),I},v=function(t){var n,i,a,s,l,u=!0,f={};return e.is(t.fromSideRefPID)&&e.is(t.toSideRefPID)?(n=t.fromSideRefPID,i=t.toSideRefPID,a=o.getReference(n),s=o.getReference(i)):(u=!1,l=c.getNLSValue("LinkBehavior.canCreateOutputLinkError.InsufficentInfo")),u&&(r.isAKindOf(s,"Provide")||r.isAKindOf(a,"DELLmiHeaderWorkPlanReference")||r.isAKindOf(a,"DELLmiQtyControlProcessReference")||r.isAKindOf(a,"DELLmiServiceHeaderWorkPlanReference")?(u=!1,l=c.getNLSValue("LinkBehavior.canCreateOutputLinkError.ObjectTypeDoesntSupport")):o.hasConnection({from:n,to:i,type:m})&&(u=!1,l=c.getNLSValue("LinkBehavior.canCreateOutputLinkError.LinkAlreadyExists"))),f={canCreateLink:u},u?f.data=e.merge({type:m,IDFrom:t.fromSideRefPID,IDTo:t.toSideRefPID,displayText:c.getNLSValue(m,null,"CreateLink"),buttonIdentifier:c.getNLSValue(m,null,"CreateLink")},e.clone(t)):f.errorMessage=l,f},A=function(t){var n,i,a,s,l,u=!0,f={};return e.is(t.fromSideRefPID)&&e.is(t.toSideRefPID)?(i=t.fromSideRefPID,a=t.toSideRefPID,s=o.getReference(i),l=o.getReference(a)):(u=!1,n=c.getNLSValue("LinkBehavior.canCreateOriginateLinkError.InsufficentInfo")),u&&(o.hasConnection({from:i,to:a,type:P})||o.hasConnection({from:a,to:i,type:P})?(u=!1,n=c.getNLSValue("LinkBehavior.canCreateOriginateLinkError.LinkAlreadyExists")):(r.isAKindOf(s,"DELLmiHeaderWorkPlanReference")||r.isAKindOf(l,"DELLmiHeaderWorkPlanReference")||r.isAKindOf(s,"DELLmiServiceHeaderWorkPlanReference")||r.isAKindOf(l,"DELLmiServiceHeaderWorkPlanReference"))&&(u=!1,n=c.getNLSValue("LinkBehavior.canCreateOriginateLinkError.ObjectTypeDoesntSupport"))),f={canCreateLink:u},u?f.data=e.merge({type:P,IDFrom:i,IDTo:a,displayText:c.getNLSValue(P,null,"CreateLink"),buttonIdentifier:c.getNLSValue(P,null,"CreateLink")},e.clone(t)):f.errorMessage=n,f},V=function(t){let n,i,o="PLMReqSpecifyHowToCnx",r=!0,a="",s={};return e.is(t.fromSideRefPID)&&e.is(t.toSideRefPID)?(n=t.fromSideRefPID,i=t.toSideRefPID):(r=!1,a=c.getNLSValue("LinkBehavior.canCreateRequirementLinkError.InsufficentInfo")),r||(s.errorMessage=a),(s={canCreateLink:r}).data=e.merge({type:o,IDFrom:n,IDTo:i,displayText:c.getNLSValue(o,null,"CreateLink"),buttonIdentifier:c.getNLSValue(o,null,"CreateLink")},e.clone(t)),s},E=function(t){var n,i,r,a=!0,s={};return e.is(t.fromSideRefPID)&&e.is(t.toSideRefPID)?(n=t.fromSideRefPID,i=t.toSideRefPID,(o.hasConnection({from:n,to:i,type:p})||o.hasConnection({from:i,to:n,type:p}))&&(a=!1,r=c.getNLSValue("LinkBehavior.canCreateAlternateLinkError.LinkAlreadyExists"))):(a=!1,r=c.getNLSValue("LinkBehavior.canCreateAlternateLinkError.InsufficentInfo")),s={canCreateLink:a},a?s.data=e.merge({type:p,IDFrom:n,IDTo:i,displayText:c.getNLSValue(p,null,"CreateLink"),buttonIdentifier:c.getNLSValue(p,null,"CreateLink")},e.clone(t)):s.errorMessage=r,s},N=function(t){var n,i,a,s,l=!0,u={};return e.is(t.fromSideRefPID)&&e.is(t.toSideRefPID)?(n=t.fromSideRefPID,i=t.toSideRefPID,a=o.getReference(n),r.isAKindOf(a,"DELLmiHeaderWorkPlanReference")||r.isAKindOf(a,"DELLmiServiceHeaderWorkPlanReference")?(l=!1,s=c.getNLSValue("LinkBehavior.canCreateMfgResponsibilityLinkError.SourceTypeNotAllowed")):o.hasConnection({from:n,to:i,type:"DELMfgResponsibilityCnx"})&&(l=!1,s=c.getNLSValue("LinkBehavior.canCreateMfgResponsibilityLinkError.LinkAlreadyExists"))):(l=!1,s=c.getNLSValue("LinkBehavior.canCreateMfgResponsibilityLinkError.InsufficentInfo")),u={canCreateLink:l},l?u.data=e.merge({type:"DELMfgResponsibilityCnx",IDFrom:n,IDTo:i,displayText:c.getNLSValue("DELMfgResponsibilityCnx",null,"CreateLink"),buttonIdentifier:c.getNLSValue("DELMfgResponsibilityCnx",null,"CreateLink")},e.clone(t)):u.errorMessage=s,u},b=function(t){var n,i,r,a=!0,s={};return e.is(t.fromSideAbsPath)&&e.is(t.toSideRefPID)?(n=t.toSideRefPID,e.is(t.fromSideAbsPath,"array")&&t.fromSideAbsPath.length>0?(i=t.fromSideAbsPath[t.fromSideAbsPath.length-1],o.hasConnection({from:i,to:n,type:"DELFmiMfgSubstituteCnx"})&&(a=!1),r=o.getInstance(i),o.getReferenceModelFromInstance(r).get("PID")===n&&(a=!1)):a=!1):a=!1,s={canCreateLink:a},a&&(s.data=e.merge({type:"DELFmiMfgSubstituteCnx",IDFrom:i,IDTo:n,displayText:c.getNLSValue("DELFmiMfgSubstituteCnx",null,"CreateLink"),buttonIdentifier:c.getNLSValue("DELFmiMfgSubstituteCnx",null,"CreateLink")},e.clone(t))),s},k=function(t,n){var o,r=i.getBehavior("ProductFlowLinkBehavior"),a=i.getBehavior("CapableResourceLinkBehaviour");switch(e.is(t.type)?t.type:n){case"ProductImplementLink":o=l.canCreateScopeLink(t);break;case"ProductImplementLinkOcc":o=l.canCreateImplementLink(t);break;case g:o=l.canCreatePartialScopeLink(t);break;case"ProcessImplementLink":o=u.canCreateScopeLink(t);break;case"ProcessImplementLinkOcc":o=u.canCreateImplementLink(t);break;case"ResultingProductLink":o=l.canCreateResultingProductLink(t);break;case m:o=v(t);break;case p:o=E(t);break;case P:o=A(t);break;case"DELAsmProcessCanUseCnx":o=a.canCreatePrimaryCapableRscLink(t);break;case"SecondaryCandidateResourceLink":o=a.canCreateSecondaryCapableRscLink(t);break;case"DELAssetsStructureLink":o=a.canCreateAssetsStructureLink(t);break;case"DELLmiTimeConstraintCnx":case"DELLmiMaterialPathCnxCust":o=r.canCreateProductFlowLink(t,n);break;case"DELMfgResponsibilityCnx":o=N(t);break;case"DELFmiMfgSubstituteCnx":o=b(t);break;case"PLMReqSpecifyHowToCnx":o=V(t);break;default:o={canCreateLink:!1}}return o},O=function(n,r){var a,s,c,l,u=D(),f=R(),d=i.getBehavior("ProductFlowLinkBehavior"),g=i.getBehavior("CapableResourceLinkBehaviour");return new t(function(t,i){var L=function(e){t(e)},I=function(e){i(e)};switch(n.type){case"ProductImplementLinkOcc":u.createImplementLink(n,r,L,I);break;case"ProcessImplementLinkOcc":f.createImplementLink(n,r,L,I);break;case"DELAsmProcessCanUseCnx":case"SecondaryCandidateResourceLink":case"DELAssetsStructureLink":g.createConnection(n,r,L,I);break;case"DELLmiTimeConstraintCnx":case"DELLmiMaterialPathCnxCust":d.createProductFlowLink(n,r,L,I);break;case P:case p:case"ResultingProductLink":case m:default:s={linkType:n.type,target:n.IDFrom,source:n.IDTo},c=function(){e.is(L,"function")&&L(s)},l=function(){e.is(I,"function")&&I(s)},(a=k(n)).canCreateLink?(r=r||{},o.createConnection({IDFrom:n.IDFrom,IDTo:n.IDTo,type:n.type},e.merge({onFailure:l,onTimeout:l,onCancel:l,onComplete:c},r))):(s.errorMessage=a.errorMessage,l())}})},{listenTo:function(){return{LoadRelations:function(e){var t;return Array.isArray(e)&&(t=e),y(t)}}},onStart:function(){},onStop:function(){},getPossibleRelationTypes:function(t){var n=e.is(t.fromSideRefPID)?o.getReference(t.fromSideRefPID):null,a=e.is(t.toSideRefPID)?o.getReference(t.toSideRefPID):null,s=e.is(n)?n.get("type"):null,c=e.is(a)?a.get("type"):null,l={};return e.is(s)&&e.is(c)?(r.getPossibleRelations(s,c,"write").forEach(function(n){var i={};(i=k(t,n)).canCreateLink&&(delete i.canCreateLink,i.data=e.is(i.data,"array")?i.data:[i.data],l[n]=i)}),l):(i.debug("No Types on models"),[])},canCreatePartialScopeLink:function(e){return u.canCreatePartialScopeLink(e)},isUsagePointManagementEnabled:function(){return o.isUsagePointManagementEnabled()},isLinkPossible:function(e,t,n,i){return r.isLinkPossible(e,t,n,i)},isRelationTypeConfiguredForPPRTypes:function(e,t,n,i){const o=r.getConfiguredRelations(t,n,i);return Array.isArray(o)&&o.indexOf(e)>-1},webServiceRequest:function(e){a.webServiceRequest(e)},getConnection:function(e){return o.getConnection(e)},isExploreWebAppEnabled:function(){return d.isCloud()?!d.isCloud():"true"===localStorage.getItem("isExploreWebAppEnabled")},createConnectionsByType:function(e,t){var n,i=D(),o=R(),r=e.linkType,a=e.linksData;switch(r){case"ProductImplementLink":i.createScopeLink(a,t);break;case g:(n=a[0]).cmdAction=i.PartialScopeAction.CREATE_PARTIALSCOPE,i.managePartialScopeLink(n,t);break;case"ProcessImplementLink":o.createScopeLink(a,t);break;default:this.createConnection(a,t)}},createConnection:function(n,r){var a,s={},l=[];e.is(n)&&e.is(n,"array")&&(i.notify("startProgress",s),a=i.log(c.getNLSValue("CreateLink.LogMessage")),l=n.map(function(e){return O(e,r)}),t.allSettled(l).then(function(t){var n=0,l={},u={},f={success:l,failed:u};t.forEach(function(t){var o,r;"rejected"===t.state?(n++,r=u,o=t.reason,e.is(o.errorMessage,"string")&&i.debug(o.linkType+" creation failed :  "+o.errorMessage)):(r=l,o=t.value),e.is(r[o.linkType])||(r[o.linkType]={}),e.is(r[o.linkType][o.target])||(r[o.linkType][o.target]=[]),r[o.linkType][o.target].push({errorMessage:o.errorMessage,source:o.source})}),Object.keys(f).forEach(function(e){var t="success"===e,n=t?"CreateLink.Success":"CreateLink.Failure",r=f[e];Object.keys(r).forEach(function(e){var s=r[e];Object.keys(s).forEach(function(r){var l,u=s[r],f=[],d=o.getReferenceModel(r).get("PLMEntity.V_Name");u.forEach(function(e){var t=e.source,n=o.getReferenceModel(t);e.errorMessage&&(l=e.errorMessage),f.push(n.get("PLMEntity.V_Name"))}),l||(l=c.getNLSValue(n,{linkType:c.getNLSValue(e),target:d,source:f.join(", ")})),t?i.info(l,a):(i.warn(l,a),i.debug(l))})})}),0===n?S(s,null,r,a):h(s,null,null,r,a)}))},createHOPMfgItemPartialScopeLink:function(e){var t,n={},o=c.getNLSValue("ImplementBehavior.CreateMGAPartialScopeLink.LogMessage");i.notify("startProgress",n),t=i.log(o),u.createHOPMfgItemPartialScopeLink(e,{onSuccess:function(e){S(n,e,null,t)},onFailure:function(e){h(n,e,null,null,t)}})},setUsagePoints:function(t,n,o){var r,a=i.log(c.getNLSValue("LinkBehavior.SetUsagePoints.LogMessage")),s={},l=this.getConnection(t),f=e.is(o)?o.get("type"):l.get("type"),d={IDFrom:l.get("from"),IDTo:l.get("to")};i.notify("startProgress",s),r={connPID:t,connectionParams:d,pathOfInstanceIds:n,implementLinkId:e.is(o)?o.get("PID"):null},e.is(r)&&e.is(f)&&u.setUsagePoints(r,f,{onSuccess:function(){"ProcessImplementLink"===f?S(s,c.getNLSValue("LinkBehavior.SetUsagePoints.CreateUsagePoints.SaveSucceeded"),null,a):"ProcessImplementLinkOcc"===f&&S(s,c.getNLSValue("LinkBehavior.SetUsagePoints.AssignImplementLink.SaveSucceeded"),null,a)},onFailure:function(e){"ProcessImplementLink"===f?h(s,c.getNLSValue("LinkBehavior.SetUsagePoints.CreateUsagePoints.SaveFailed"),e,null,a):"ProcessImplementLinkOcc"===f&&h(s,c.getNLSValue("LinkBehavior.SetUsagePoints.AssignImplementLink.SaveFailed"),e,null,a)}})},deleteUsagePoint:function(t,n){var o,r=i.log(c.getNLSValue("LinkBehavior.DeleteUsagePoint.LogMessage",{pathInstIds:n})),a={};i.notify("startProgress",a),o={pid:t,pathOfInstanceIds:n},e.is(o)&&u.deleteUsagePoint(o,{onSuccess:function(){S(a,c.getNLSValue("LinkBehavior.DeleteUsagePoint.SaveSucceeded"),null,r),i.notify("refreshImpacted"),i.notify("updateCrossHighlight")},onFailure:function(e){h(a,c.getNLSValue("LinkBehavior.DeleteUsagePoint.SaveFailed"),e,null,r)}})},unassignImplementLinkFromUsagePoints:function(t,n){var o,r=i.log(c.getNLSValue("LinkBehavior.UnassignImplementLinkFromUsagePoints.LogMessage")),a={};i.notify("startProgress",a),o={pid:t,implementLinkId:n},e.is(o)&&u.unassignImplementLinkFromUsagePoints(o,{onSuccess:function(){S(a,c.getNLSValue("LinkBehavior.UnassignImplementLinkFromUsagePoints.SaveSucceeded"),null,r),i.notify("refreshImpacted"),i.notify("updateCrossHighlight")},onFailure:function(e){h(a,c.getNLSValue("LinkBehavior.UnassignImplementLinkFromUsagePoints.SaveFailed"),e,null,r)}})},setImplementLinkToUsagePoints:function(t,n){var i,o,r=this.getConnection(t);e.is(r)&&(1===(i=u.findInstanceWhoseParentIsScoped(r.get("from")).scopeLinks).length?o=i[0]:i.length>1&&i.forEach(function(t){"ProcessImplementLink"===t.get("type")&&e.is(t.get("usagePoint"))&&t.get("usagePoint").includes(n[0])&&(o=t)}),e.is(o)&&(n.length>0?this.setUsagePoints(o.get("PID"),n,r):this.unassignImplementLinkFromUsagePoints(o.get("PID"),t)))},canDeleteRelation:function(t){var n,i,a,s,c,l,u=!1;return n=this.getConnection(t),e.is(n)&&("CapableResourcesStructureLink"===(i=n.getAttribute("type"))?u=!1:"SecondaryCandidateResourceLink"===i?u=!0:"DELLmiMaterialPathCnxCust"===i?u=!0:(a=n.getAttribute("from"),s=o.getReferenceModel(a).get("type"),c=n.getAttribute("to"),l=o.getReferenceModel(c).get("type"),u=r.isRelationTypeConfigured(i,s,l,"write"))),u},switchScope:function(t,n,o,r,a,s){var l,f,d={};f=i.log(c.getNLSValue("LinkBehavior.SwitchScope.LogMessage")),i.notify("startProgress",d),l={fromID:t,mbomRefID:n,mbomInstID:o,connectionType:r,isRefInstRefScope:a},e.is(s)&&l&&u.switchScope(l,s,{onSuccess:function(){S(d,c.getNLSValue("LinkBehavior.SwitchScope.SaveSucceeded"),null,f)},onFailure:function(e){h(d,c.getNLSValue("LinkBehavior.SwitchScope.SaveFailed"),e,null,f)}})},deleteConnection:function(t,n){var r,a,s,f,d,m={},p=o.getConnection(t),P=p.getAttribute("type"),L=c.getNLSValue(P),I=D();switch(n=n||{},i.notify("startProgress",m),s=i.log(c.getNLSValue("DeleteLink.LogMessage",{linkType:L})),r={onComplete:function(t,o){var r={};S(m,c.getNLSValue("DeleteLink.Success",{linkType:L}),n,s),e.is(t)&&e.is(t.preferred)&&(r.linkPID=t.preferred,r.state=!0,i.notify("updatePreferredLink",r)),e.is(o)?i.notify("deleteLink",[o.deletedConnections]):i.notify("deleteLink",p.toJSON())},onFailure:f=function(e,t){h(m,c.getNLSValue("DeleteLink.Failure",{linkType:L}),t,n,s)},onTimeout:f,onCancel:f},a=e.extend({},n),r=e.extend(a,r),P){case"ProductImplementLink":l.deleteScopeLink(t,r);break;case"ProcessImplementLink":u.deleteScopeLink(t,r);break;case"ProductImplementLinkOcc":l.isDeleteOfProductImplementLinkAllowed()?l.deleteImplementLink(t,r):h(m,c.getNLSValue("DeleteLink.ProductImplementLinkDeleteNotAllowed"),null,n,s);break;case"ProcessImplementLinkOcc":u.deleteImplementLink(t,r);break;case g:if(3===(d=t.split("|")).length){r.cmdAction=I.PartialScopeAction.DELETE_PARTIALSCOPE;const[,e,t]=d;l.manageScopeAndImplementLink(e,null,t,null,r)}break;default:o.deleteConnection(t,r)}},addConnection:function(e,t){return o.addConnection(e,t)},updateLinkAttributes:function(e,t,n){var r,a,l,f,d,g=[],m={},p={},P={};for(t=t||{},n=n||{},r=0;r<t.length;r++)d=s.hasRangeDefined(t[r].attributeInfo,t[r].attributeDef)&&s.isInteger(t[r].attributeInfo),f=t[r].objectToBeModified.get(t[r].dataIndex),l=t[r].newValue,d&&(f=s.getAuthorizedValueIndex(t[r].attributeInfo,t[r].attributeDef,f)),s.isDate(t[r].attributeInfo)&&(f=new Date(f).getTime()/1e3),f!==l&&(t[r].previousValue=f,g.push(t[r]));if(0!==g.length){for(r=0;r<g.length;r++)m[g[r].attributeName]=g[r].newValue;m=u.addCustoRoleToLinkData(m),a={data:m=u.validateQuantityToEdit(e,m),onFailure:function(e){for(r=0;r<g.length;r++)e.set(g[r].dataIndex,g[r].previousValue);h(P,c.getNLSValue("AttributeUtil.SaveFailed"),e,n)},onComplete:function(){S(P,c.getNLSValue("AttributeUtil.SaveSucceeded"),n),i.notify("editLinkAttributes",p),i.notify("refreshImpacted")},logMessage:c.getNLSValue("AttributeUtil.EditAttributesLogMessage")},i.notify("startProgress",P),o.updateConnection(e,a)}},getConnectionsByModel:function(e,t,n){o.getConnectionsByModel(e,t,n)},getImpactedConnections:function(e,t,n){return o.getImpacted(e,t,n)},getConnectedObjects:function(t,n,r){var a,s,c,l,u=R(),f=i.getBehavior("CapableResourceLinkBehaviour"),d=[];return a=o.getInstance(t),e.is(a)?(s=t,c=o.getReferenceModelFromInstance(a),l=c.get("PID")):(c=o.getReference(t),l=t),o.getImpacted(t,!1,r).forEach(function(e){var t,i=e.get("type"),o=e.get("from"),r=e.get("to");switch(i){case"ProcessImplementLink":case"PartialProcessImplementLink":case"ProcessImplementLinkOcc":d=d.concat(u.getConnectedObjects(l,s,n,e));break;case"CapableResourcesStructureLink":case"DELAsmProcessCanUseCnx":case"SecondaryCandidateResourceLink":case"DELAssetsStructureLink":d=d.concat(f.getConnectedObjects(l,s,n,e));break;case m:case p:case P:t=o===l?r:o,d.push(t);break;case"ProductImplementLink":case"ProductImplementLinkOcc":case"ResultingProductLink":case"DELLmiTimeConstraintCnx":case"DELLmiMaterialPathCnxCust":break;default:console.log("Invalid Type")}}),d},getConnectedUsagePoints:function(t,n){var i,a,s=[];return i=o.getInstance(t),a=e.is(i)?o.getReferenceModelFromInstance(i):o.getReference(t),e.is(a)&&(r.isAKindOf(a.get("type"),"DELLmiServiceWorkPlanSystemReference")||r.isAKindOf(a.get("type"),"DELServicePartReference")||r.isAKindOf(a.get("type"),"DELServiceAssemblyReference")||r.isAKindOf(a.get("type"),"DELServiceKitReference"))&&o.getImpacted(t,!1,n).forEach(function(t){var n=t.get("usagePoint");e.is(n)&&n.length>0&&s.push(...n.map(e=>e[e.length-1]))}),s},getXMLValues:function(e,t,n){return a.getXMLValues(e,t,n)},getRelations:function(t){return C(t).then(function(t){var n=t.result;return{isRelationsLoaded:t.relationsLoaded,connections:e.is(n)?n.connections:[]}})},areRelationsLoaded:function(t){var n=!0;return t=Array.isArray(t)?t:[t],o.isNavigateOnDemand()&&(n=t.some(function(t){var n,i,r,a=o.getReferenceModel(t),s=a.get("PID")===t;return e.is(a)&&(s||(r=t),i=o.getInstance(r),n=e.is(i)?a.getAdditionalInfo("queriedForConnections")&&i.getAdditionalInfo("queriedForConnections"):a.getAdditionalInfo("queriedForConnections")),n})),n},hasConnection:function(e){return o.hasConnection(e)},getLinkInfo:function(t){var n,o=i.getBehavior("ProductFlowLinkBehavior"),r={NLS:null,type:null,subType:null,iconName:null,interface:null};return e.is(t)&&("DELLmiTimeConstraintCnx"===(n=t.get("type"))&&e.is(o)?r=o.getLinkInfo(t):(r.NLS=c.getNLSValue(n),r.type=n,r.iconName=n)),r},getSecondaryRscLinksFromPrimaryLink:function(e){var t;return t=e.get("PID"),o.getImpacted(t,!1,{relationTypes:["SecondaryCandidateResourceLink"]})},cloneSecondaryCapableRscLinkWithFromAttr:function(t){var n=this.getConnection(t.get("from"));return e.is(n)&&(t=t.clone()).set("from",n.get("from")),t},getSecondaryResourceLinksInfo:function(t){var n,i=this,r=[],a=o.getConnection(t),s=this.getSecondaryRscLinksFromPrimaryLink(a);return n=function(t){var n=t.get("PID"),i=t.get("type"),r=t.get("DELAsmProcessCanUseCnx.V_IsPreferred"),a=t.get("from"),s=t.get("to"),c=o.getReference(a),l=o.getReference(s),u=e.is(c)?c.get("type"):null,f=e.is(l)?l.get("type"):null,d=e.is(c)?c.get("PLMEntity.V_Name"):null,g=e.is(l)?l.get("PLMEntity.V_Name"):null,m=e.is(t.get("ResourceUsage"))?t.get("ResourceUsage"):null,p=e.is(m)?o.getInstance(m):null;return{connPID:n,isPreferred:"DELAsmProcessCanUseCnx"===i?r:"",fromPID:a,toPID:s,fromType:u,toType:f,fromName:d,toName:g,resourceUsage:e.is(p)?p.get("PLMInstance.PLM_ExternalID"):"",resourceUsagePID:m}},s.forEach(function(e){var t=i.cloneSecondaryCapableRscLinkWithFromAttr(e);r.push(n(t))}),r},isAuthoringMode:function(){return o.isAuthoringMode()},getAttributeNLSForUnit:function(e){var t=r.getAttributeInfo(e);return s.getNLSForUnit(t)}}}}}),define("DS/DELPPWModelBehaviors/BuildUpBehavior",["UWA/Core"],function(e){"use strict";return{plugins:["DicoPlugin","UXComponentsPlugin","DatabasePlugin","ResourcePlugin","DELPXPSessionPlugin","ModelObserverPlugin"],creator:function(t,n,i,o,r,a,s,c){const l=["DELLmiGeneralOperationReference","DELLmiHeaderOperationReference","DELLmiLoadingOperationReference","DELLmiUnloadingOperationReference","DELLmiWorkPlanSystemReference"],u=["DELLmiGeneralOperationInstance","DELLmiHeaderOperationInstance","DELLmiLoadingOperationInstance","DELLmiUnloadingOperationInstance"],f="type",d="PLMEntity.V_Name",g="isAggregatedBy",m="isInstanceOf",p="PLMInstance.PLM_ExternalID",P="from",L="to",I="PLMEntity.V_usage",S="flowType",h="DELLmiTimeConstraintCnx.V_MaterialNeed",C="V_TreeOrder",y=["1.0","0.0","0.0","0.0","1.0","0.0","0.0","0.0","1.0","0.0","0.0","0.0"],D="type",R="pid",v="name",A="isinstanceof",V="duration",E="isaggregatingby",N="from",b="to",k="transformationmatrix",O="materialneed",T="productFlowType",M="role",F="treeorder",w="isOwnedBy",x="transformationMatrix",B="materialNeed",U="treeOrder",_="isInstanceOf",W="DELLmiTimeConstraintCnx",j="LinearProductFlowCnx",H="ProcessImplementLink",J="ProcessImplementLinkOcc",K="TimeConstraint",q="Scope",Y="ImplementLink",z="MfgProductionPlanning",X={SCRAPPED:"Scrapped",FAILED:"Failed",GOOD:"Good",QUANTITYDISTRIBUTION:"Good"},G={"Start to Start":"TCDependencyType_StartToStart","Start to Finish":"TCDependencyType_StartToFinish","Finish to Start":"TCDependencyType_FinishToStart","Finish to Finish":"TCDependencyType_FinishToFinish","Previous Cycle":"TCDependencyType_PreviousCycle"},Q={MaxDelay:"DelayMode_maxDelay",MinDelay:"DelayMode_minDelay",Synchro:"DelayMode_synchro"};var Z,$,ee,te,ne,ie,oe,re,ae,se,ce,le,ue,fe,de,ge,me,pe,Pe={},Le=(t.getLogger(),n.getAppContext()),Ie=o.getComponent("WUXCommandsManager"),Se=[],he=[],Ce=[];let ye,De,Re,ve,Ae,Ve,Ee,Ne={SYSTEM:{},OPERATION:{DELLmiHeaderOperationReference:"Op_HeaderOperation",DELLmiGeneralOperationReference:"Op_GeneralOperation",DELLmiInterruptOperationReference:"Op_InterruptOperation",DELLmiPunctualOperationReference:"Op_PunctualOperation",DELLmiSinkOperationReference:"Op_SinkOperation",DELLmiCurveOperationReference:"Op_CurveOperation",DELLmiLoadingOperationReference:"Op_LoadingOperation",DELLmiUnloadingOperationReference:"Op_UnloadingOperation",DELLmiRemoveMaterialOperationReference:"Op_RemoveMaterialOperation",DELLmiTransferOperationReference:"Op_TransferOperation",DELLmiPickingOperationReference:"Op_PickingOperation"},PROCESS:{Provide:"Item_Provide",ProcessContinuousProvide:"Item_ProcessContinuousProvide",Transform:"Item_Transform",Drill:"Item_Drill",PreDrill:"Item_PreDrill",NoDrill:"Item_NoDrill",Cutting:"Item_Cutting",Grinding:"Item_Grinding",Beveling:"Item_Beveling",CreateAssembly:"Item_CreateAssembly",Fasten:"Item_Fasten",ElementaryEndItem:"Item_ElementaryEndItem",Machine:"Item_Machine",SplitProcess:"Item_SplitProcess",CreateMaterial:"Item_CreateMaterial",ProcessContinuousCreateMaterial:"Item_CreateContinuousMaterial",CreateKit:"Item_CreateKit",Disassemble:"Item_Disassemble",Installation:"Item_Installation"}},be=[],ke=0,Oe=null;Ee=function(e){ye={SYSTEM:{add:e.createProcessReference,update:e.updateProcessReference,remove:e.deleteProcessReference},OPERATION:{add:e.createOperationReference,update:e.updateOperationReference,remove:e.deleteOperationReference},PROCESS:{add:e.createMfgItemReference,update:e.updateMfgItemReference,remove:e.deleteMfgItemReference},RESOURCE:{add:null,update:null,remove:null},SystemInstance:{add:null,update:null,remove:null},OperationInstance:{add:e.createOperationInstance,update:e.updateOperationInstance,remove:e.deleteOperationInstance},DELFmiFunctionIdentifiedInstance:{add:e.createMfgItemInstance,update:e.updateMfgItemInstance,remove:e.deleteMfgItemInstance},VPMInstance:{add:null,update:null,remove:null},ProductImplementLink:{add:null,update:null,remove:null},ProductImplementLinkOcc:{add:null,update:null,remove:null},ProcessImplementLink:{add:null,update:null,remove:null},ProcessImplementLinkOcc:{add:e.createImplementLink,update:e.updateImplementLink,remove:e.deleteImplementLink},PartialProcessImplementLink:{add:null,update:null,remove:null},CapableResourcesStructureLink:{add:null,update:null,remove:null},DELAsmProcessCanUseCnx:{add:null,update:null,remove:null},SecondaryCandidateResourceLink:{add:null,update:null,remove:null},PrimaryResourceLinkDetail:{add:null,update:null,remove:null},SecondaryResourceLinkDetail:{add:null,update:null,remove:null},DELLmiTimeConstraintCnx:{add:e.createTimeConstraint,update:e.updateTimeConstraint,remove:e.deleteTimeConstraint},LinearProductFlowCnx:{add:null,update:null,remove:null},HistorizationLinkRefRef:{add:null,update:null,remove:null},MfgProcessAlternate:{add:null,update:null,remove:null}}};let Te={references:{add:Re=function(t,n){var o;if(o={apiToCall:e.is(t.PPRTYPE)&&e.is(ye[t.PPRTYPE])?ye[t.PPRTYPE][n]:null,info:{pid:t.PID,type:t.type}},"SYSTEM"!==t.PPRTYPE&&"OPERATION"!==t.PPRTYPE||(o.info.duration=600),e.is(Pe.newBuildUpAPI)&&Pe.newBuildUpAPI)o.info.type=t.type;else{if("OPERATION"===t.PPRTYPE){let e=Object.keys(Ne.OPERATION);for(let n=0;n<e.length;n++)if(i.isAKindOf(t.type,e[n])){o.info.type=Ne.OPERATION[e[n]];break}}if("PROCESS"===t.PPRTYPE){let e=Object.keys(Ne.PROCESS);for(let n=0;n<e.length;n++)if(i.isAKindOf(t.type,e[n])){o.info.type=Ne.PROCESS[e[n]];break}}}return o},update:Re,remove:Ve=function(e,t){var n,i;return n={apiToCall:null,info:e.PID},e.type.contains("OperationInstance")?i="OperationInstance":e.type.contains("SystemInstance")?i="SystemInstance":"SYSTEM"===e.PPRTYPE||"OPERATION"===e.PPRTYPE||"PROCESS"===e.PPRTYPE||"RESOURCE"===e.PPRTYPE?i=e.PPRTYPE:"ProcessImplementLinkOcc"===e.type?(de(e.to,t),i=e.type):i=e.type,n.apiToCall=ye[i][t],n}},instances:{add:ve=function(t,n){var i,o;return i={apiToCall:null,info:{pid:t.PID}},e.is(Pe.newBuildUpAPI)&&Pe.newBuildUpAPI?(i.info.isOwnedBy=t.isAggregatedBy,i.info.isInstanceOf=t.isInstanceOf,i.info.type=t.type,"DELFmiFunctionIdentifiedInstance"!==t.type&&"VPMInstance"!==t.type||(i.info.transformationMatrix=y)):(i.info.isaggregatingby=t.isAggregatedBy,i.info.isinstanceof=t.isInstanceOf,"DELFmiFunctionIdentifiedInstance"!==t.type&&"VPMInstance"!==t.type||(i.info.transformationmatrix=y)),o=t.type.contains("OperationInstance")?"OperationInstance":t.type.contains("SystemInstance")?"SystemInstance":t.type,i.apiToCall=e.is(ye[o])?ye[o][n]:null,i},update:ve,remove:Ve},connections:{add:Ae=function(t,n){var i,o={apiToCall:e.is(ye[t.type])?ye[t.type][n]:null,info:{pid:t.PID}};switch(e.is(t.from)&&(o.info=e.extend(o.info,{from:Array.isArray(t.from)?t.from:[t.from]})),e.is(t.to)&&(o.info=e.extend(o.info,{to:Array.isArray(t.to)?t.to:[t.to]})),t.type){case"ProcessImplementLinkOcc":o.info=e.extend(o.info,{role:"NULL"===t["PLMEntity.V_usage"]?"Add":t["PLMEntity.V_usage"],type:"MfgProductionPlanning"}),i=r.getConnection(t.PID),e.is(Pe.newBuildUpAPI)&&Pe.newBuildUpAPI&&(e.is(i)?(o.info.isOwnedBy=pe(i.get("from")[0]),de(i.get("to"),n)):(o.info.isOwnedBy=pe(o.info.from[0]),de(o.info.to,n)));break;case"DELLmiTimeConstraintCnx":e.is(Pe.newBuildUpAPI)&&Pe.newBuildUpAPI?o.info=e.extend(o.info,{materialNeed:t["DELLmiTimeConstraintCnx.V_MaterialNeed"],type:t.type,isOwnedBy:me(t.from,t.to)}):o.info=e.extend(o.info,{delay:Number(t["DELLmiTimeConstraintCnx.V_Delay"]),materialneed:"TRUE"===t["DELLmiTimeConstraintCnx.V_MaterialNeed"],productFlowType:-1===Object.values(X).indexOf(t["DELLmiTimeConstraintCategoryAbstractCusto.flowType"])?X.GOOD:t["DELLmiTimeConstraintCategoryAbstractCusto.flowType"],timeConstraintsDependencyType:G[t["DELLmiTimeConstraintCnx.V_DependencyType"]],delayMode:Q[t["DELLmiTimeConstraintCnx.V_DelayMode"]],type:"TimeConstraint"})}return o},update:Ae,remove:Ve}};return De=function(t){var n=t||{};Object.keys(n).forEach(function(t){Object.keys(n[t]).forEach(function(i){n[t][i]=Array.isArray(n[t][i])?n[t][i]:[n[t][i]],n[t][i].forEach(function(n){if(e.is(Te[t][i])){let o=Te[t][i](n,i);e.is(o.apiToCall)&&e.is(o.info)&&o.apiToCall.call($,o.info)}})})})},ge=function(e,t){var n,i;return[n,i]=e.length>t.length?[e,t]:[t,e],i.every(e=>n.includes(e))},de=function(n,i){var o,a,s,c,l,u=!1,f=!1,d=[];if(l=e.is(Pe.newBuildUpAPI)&&Pe.newBuildUpAPI?t.getBehavior("SBOM","WUXNodeModelBehavior"):t.getBehavior("MANUFACTURING","WUXNodeModelBehavior"),e.is(n))if(o=r.transformToRIROccurrencePath(n),d=l.getChildren(o[o.length-1]),"add"===i)if(he.length>0)if(Ce.push(o),0===d.length){for(a=0;a<he.length;a++)if(e.equals(he[a],o)){he.splice(a,1);break}}else d.length>0&&d.forEach(function(t){for(f=!1,a=0;a<Ce.length;a++)if(ge(Ce[a],[t])){f=!0;break}f||(s=r.getReferenceIdFromInstance(t),l.getNodeModel(s).forEach(function(n){if(-1!==(c=r.transformToRIROccurrencePath(n.getAbsolutePath())).indexOf(t))for(a=0;a<he.length;a++)if(e.equals(he[a],c)){he.splice(a,1);break}}))});else Ce.push(o);else if("remove"===i)if(Ce.length>0){for(a=0;a<Ce.length;a++)if(e.equals(Ce[a],o)){Ce.splice(a,1);break}if(0===d.length){for(a=0;a<Ce.length;a++)if(ge(Ce[a],o)){u=!0;break}u?he.splice(a,1):he.push(o)}else d.length>0&&d.forEach(function(e){for(f=!1,a=0;a<Ce.length;a++)if(ge(Ce[a],[e])){f=!0;break}f||(s=r.getReferenceIdFromInstance(e),l.getNodeModel(s).forEach(function(t){-1!==(c=r.transformToRIROccurrencePath(t.getAbsolutePath())).indexOf(e)&&he.push(c)}))})}else he.push(o)},me=function(t,n){var i,o,a,s,c,l,u,f={},d=!1;if(e.is(t,"array")&&e.is(n,"array"))for(o=t.length-1;o>=0;o--){for(s=t[o],a=r.getInstance(s).get("isAggregatedBy"),c=n.length-1;c>=0;c--)if(l=n[c],e.is(f[l])?u=f[l]:(u=r.getInstance(l).get("isAggregatedBy"),f[l]=u),a===u&&s!==l){d=!0,i=a;break}if(d)break}return i},pe=function(e){var t;return t=r.getInstance(e),r.getAggregatingReferenceModelFromInstance(t).get("PID")},ee=function n(i,o,a,s,c){var l,u=t.getBehavior("MANUFACTURING","WUXNodeModelBehavior"),P={};-1===s.indexOf(i.id)&&(P[R]=i.id,P[D]="Item_"+i.get(f),P[v]=i.get(d),o.push(P),s.push(i.id)),r.findInstances({isInstanceOf:i.id}).forEach(function(e){var t={};-1===c.indexOf(e.id)&&(t[R]=e.id,t[E]=e.get(g),t[A]=e.get(m),t[v]=e.get(p),t[k]=y,a.push(t),c.push(e.id))}),(l=r.findInstances({isAggregatedBy:i.id})).length>0?l.forEach(function(e){r.findReferences({PID:e.get(m)}).forEach(function(e){n(e,o,a,s,c)})}):u.getNodeModel(i.id).forEach(function(t){let n,i=!1,o=r.transformToRIROccurrencePath(t.getAbsolutePath());for(n=0;n<Se.length;n++)if(e.equals(Se[n],o)){i=!0;break}i||Se.push(o)})},ne=function e(t,n,i,o,a){r.findInstances({isAggregatedBy:t.id}).forEach(function(t){r.findReferences({PID:t.get(m)}).forEach(function(t){var s,c={};(r.isOperation(t.id)||r.isSystem(t.id))&&(-1===o.indexOf(t.id)&&(o.push(t.id),s=t.get(f),s=l.indexOf(s)>=0?"UnloadingOperation"===(s=s.replace("DELLmi","").replace("Reference",""))?"UnloadOperation":s:"AssembleOperation",c[R]=t.id,c[D]=s,c[v]=t.get(d),c[V]=parseFloat(t.get("DELLmiOperationReference.V_EstimatedTime")),n.push(c)),r.findInstances({isInstanceOf:t.id}).forEach(function(e){var t={};-1===a.indexOf(e.id)&&(a.push(e.id),t[R]=e.id,t[E]=e.get(g),t[A]=e.get(m),t[v]=e.get(p),t[F]=Number(e.get(C)),i.push(t))}),e(t,n,i,o,a))})})},oe=function(n,i,o,a,s,c,l,d,m){var p=t.getBehavior("MANUFACTURING","WUXNodeModelBehavior"),C=[],y=[];return(y=(y=r.findConnections({type:W})).concat(r.findConnections({type:j}))).forEach(function(t){var o,s,c,l,d,m={},p=!1;if(-1===n.indexOf(t.id)&&((a.indexOf(t.getAttribute("to"))>-1||a.indexOf(t.getAttribute("from"))>-1)&&(p=!0),!0===p&&(1===(s=r.findInstances({PID:t.getAttribute(P)})).length&&((s=s[0]).get(g)!==i?1===r.findInstances({isInstanceOf:s.get(g)}).length&&(l=[r.findInstances({isInstanceOf:s.get(g)},1)[0].id,s.id]):l=[s.id]),1===(o=r.findInstances({PID:t.getAttribute(L)})).length&&((o=o[0]).get(g)!==i?null!==(d=r.findInstances({isInstanceOf:o.get(g)},1))&&(c=[d[0].id,o.id]):c=[o.id]),u.indexOf(o.get(f))>=0&&u.indexOf(s.get(f))>=0&&a.indexOf(l[l.length-1])>-1&&a.indexOf(c[c.length-1])>-1))){if(m[R]=t.id,m[D]=K,m[N]=l,m[b]=c,m[O]=!e.is(t.get(h))||"TRUE"===t.get(h),e.is(t.get(S)))switch(t.get(S)){case X.SCRAPPED:m[T]=X.SCRAPPED;break;case X.FAILED:m[T]=X.FAILED;break;default:m[T]=X.GOOD}C.push(m),n.push(t.id)}}),(y=r.findConnections({type:H})).forEach(function(t){var o={};i===t.get(P)&&s===t.get(L)&&-1===n.indexOf(t.id)&&(o[R]=t.id,o[D]=q,o[N]=e.is(t.get(P),"array")?t.get(P):[t.get(P)],o[b]=e.is(t.get(L),"array")?t.get(L):[t.get(L)],C.push(o),n.push(t.id))}),y=r.findConnections({type:J}),he=[...Se],y.forEach(function(t){var i,o,s,c={};-1===n.indexOf(t.id)&&(i=t.get(P)[t.get(P).length-1],a.indexOf(i)>-1&&(o=t.get(L)[t.get(L).length-1],l.indexOf(o)>-1&&(c[R]=t.id,c[D]=Y,c[N]=e.is(t.get(P),"array")?t.get(P):[t.get(P)],c[b]=e.is(t.get(L),"array")?t.get(L):[t.get(L)],e.is(t.get(I))&&"NULL"!==t.get(I)&&(c[M]=t.get(I)),C.push(c),n.push(t.id),s=r.getReferenceIdFromInstance(o),p.getNodeModel(s).forEach(function(t){let n,i=!1,a=!1,s=r.transformToRIROccurrencePath(t.getAbsolutePath());if(-1!==s.indexOf(o)){for(Ce.push(s),n=0;n<Se.length;n++){if(e.equals(Se[n],s)){i=!0;break}if(ge(Se[n],s)){a=!0;break}}if(i){for(n=0;n<he.length;n++)if(e.equals(he[n],s)){he.splice(n,1);break}}else if(a)for(n=0;n<he.length;n++)ge(he[n],s)&&(he.splice(n,1),n--)}}))))}),C},ae=function(e){var t,n,i=[],o=[],s=[],c=[],l=[],u=[],f=[],g=[],m=[];try{return t=r.getReference(e.sysPID),n=r.getReference(e.scopedMfgItemPID),ee(n,s,c,i,o),s.length<=1&&a.getNLSValue("BuildUp.Error.NoMBOM"),c.length<=1&&a.getNLSValue("BuildUp.Error.NoMBOM"),ne(t,f,g,l,u),f.length<=1&&a.getNLSValue("BuildUp.Error.NoOperations"),g.length<=1&&a.getNLSValue("BuildUp.Error.NoOperations"),m=oe([],t.id,0,u,n.id,0,o),{version:"1.0",workplan:{pid:t.id,name:t.get(d),scopedItem:n.id,manufactureditems:{references:s,instances:c},resources:{references:[],instances:[]},operations:{references:f,instances:g},links:m}}}catch(e){console.error(e.stack),console.error(e.message)}},te=function n(i,o,a,s,c){var l,u=t.getBehavior("SBOM","WUXNodeModelBehavior"),P={};-1===s.indexOf(i.id)&&(P[R]=i.id,P[D]=i.get(f),P[v]=i.get(d),o.push(P),s.push(i.id)),r.findInstances({isInstanceOf:i.id}).forEach(function(e){var t={};-1===c.indexOf(e.id)&&(t[R]=e.id,t[w]=e.get(g),t[_]=e.get(m),t[D]=e.get(f),t[v]=e.get(p),t[x]=y,a.push(t),c.push(e.id))}),(l=r.findInstances({isAggregatedBy:i.id})).length>0?l.forEach(function(e){r.findReferences({PID:e.get(m)}).forEach(function(e){n(e,o,a,s,c)})}):u.getNodeModel(i.id).forEach(function(t){let n,i=!1,o=r.transformToRIROccurrencePath(t.getAbsolutePath());for(n=0;n<Se.length;n++)if(e.equals(Se[n],o)){i=!0;break}i||Se.push(o)})},ie=function(t,n,i,o,a){var s,c={};s=function t(n,i,o,a,s){r.findInstances({isAggregatedBy:n.id}).forEach(function(n){r.findReferences({PID:n.get(m)}).forEach(function(n){var c={};(r.isOperation(n.id)||r.isSystem(n.id))&&(-1===a.indexOf(n.id)&&(a.push(n.id),c[R]=n.id,c[D]=n.get(f),c[v]=n.get(d),e.is(n.get("DELLmiOperationReference.V_EstimatedTime"))&&(c[V]=parseFloat(n.get("DELLmiOperationReference.V_EstimatedTime"))),i.push(c)),r.findInstances({isInstanceOf:n.id}).forEach(function(e){var t={};-1===s.indexOf(e.id)&&(s.push(e.id),t[R]=e.id,t[D]=e.get(f),t[w]=e.get(g),t[_]=e.get(m),t[v]=e.get(p),t[U]=Number(e.get(C)),o.push(t))}),t(n,i,o,a,s))})})},(r.isOperation(t.id)||r.isSystem(t.id))&&-1===o.indexOf(t.id)&&(o.push(t.id),c[R]=t.id,c[D]=t.get(f),c[v]=t.get(d),e.is(t.get("DELLmiOperationReference.V_EstimatedTime"))&&(c[V]=parseFloat(t.get("DELLmiOperationReference.V_EstimatedTime"))),n.push(c)),s(t,n,i,o,a)},re=function(n,i,o,a,s,c,l,d,m){var p=t.getBehavior("SBOM","WUXNodeModelBehavior"),S=[],C=[];return(C=r.findConnections({type:W})).forEach(function(t){var o,s,c,l,d,m={},p=!1;-1===n.indexOf(t.id)&&((a.indexOf(t.getAttribute("to"))>-1||a.indexOf(t.getAttribute("from"))>-1)&&(p=!0),!0===p&&(1===(s=r.findInstances({PID:t.getAttribute(P)})).length&&((s=s[0]).get(g)!==i?1===r.findInstances({isInstanceOf:s.get(g)}).length&&(l=[r.findInstances({isInstanceOf:s.get(g)},1)[0].id,s.id]):l=[s.id]),1===(o=r.findInstances({PID:t.getAttribute(L)})).length&&((o=o[0]).get(g)!==i?null!==(d=r.findInstances({isInstanceOf:o.get(g)},1))&&(c=[d[0].id,o.id]):c=[o.id]),u.indexOf(o.get(f))>=0&&u.indexOf(s.get(f))>=0&&a.indexOf(l[l.length-1])>-1&&a.indexOf(c[c.length-1])>-1&&(m[R]=t.id,m[D]=W,m[N]=l,m[b]=c,m[B]=e.is(t.get(h))?t.get(h):"FALSE",m[w]=me(l,c),S.push(m),n.push(t.id))))}),(C=r.findConnections({type:H})).forEach(function(t){var o={};i===t.get(P)&&s===t.get(L)&&-1===n.indexOf(t.id)&&(o[R]=t.id,o[D]=z,o[N]=e.is(t.get(P),"array")?t.get(P):[t.get(P)],o[b]=e.is(t.get(L),"array")?t.get(L):[t.get(L)],o[w]="",S.push(o),n.push(t.id))}),C=r.findConnections({type:J}),he=[...Se],C.forEach(function(t){var i,o,s,c={};-1===n.indexOf(t.id)&&(i=t.get(P)[t.get(P).length-1],a.indexOf(i)>-1&&(o=t.get(L)[t.get(L).length-1],l.indexOf(o)>-1&&(c[R]=t.id,c[D]=z,c[N]=e.is(t.get(P),"array")?t.get(P):[t.get(P)],c[b]=e.is(t.get(L),"array")?t.get(L):[t.get(L)],c[w]=pe(t.get(P)[0]),e.is(t.get(I))&&"NULL"!==t.get(I)&&(c[M]=t.get(I)),S.push(c),n.push(t.id),s=r.getReferenceIdFromInstance(o),p.getNodeModel(s).forEach(function(t){let n,i=!1,a=!1,s=r.transformToRIROccurrencePath(t.getAbsolutePath());if(-1!==s.indexOf(o)){for(Ce.push(s),n=0;n<Se.length;n++){if(e.equals(Se[n],s)){i=!0;break}if(ge(Se[n],s)){a=!0;break}}if(i){for(n=0;n<he.length;n++)if(e.equals(he[n],s)){he.splice(n,1);break}}else if(a)for(n=0;n<he.length;n++)ge(he[n],s)&&(he.splice(n,1),n--)}}))))}),S},se=function(e){var t,n,i=[],o=[],s=[],c=[],l=[],u=[],f=[],d=[],g=[];try{return t=r.getReference(e.sysPID),n=r.getReference(e.scopedMfgItemPID),te(n,s,c,i,o),s.length<=1&&a.getNLSValue("BuildUp.Error.NoMBOM"),c.length<=1&&a.getNLSValue("BuildUp.Error.NoMBOM"),ie(t,f,d,l,u),f.length<=1&&a.getNLSValue("BuildUp.Error.NoOperations"),d.length<=1&&a.getNLSValue("BuildUp.Error.NoOperations"),g=re([],t.id,0,u,n.id,0,o),{version:"2.0",mfgItemReferences:s,mfgItemInstances:c,mfgOperationReferences:f,mfgOperationInstances:d,mfgResourceReferences:[],mfgResourceInstances:[],connections:g}}catch(e){console.error(e.stack),console.error(e.message)}},ce=function(t,i,o){var r=this;return new Promise(function(a,c){var l,u={},f=null;n.notify("startProgress",u),i.sysPID===t&&s.connectBuildUpSession(t,i.scopedMfgItemPID).then(function(d){he=[],Se=[],Ce=[],ue=d.initBuildupModelers,fe=d.processBuildUpAPI,l=e.is(Pe.newBuildUpAPI)&&Pe.newBuildUpAPI?se(i):ae(i),ue.load(JSON.stringify(l)).then(function(){f=s.retriveSessionIdForSelected(t,i.scopedMfgItemPID),n.notify("stopProgress",u),r.startEventListener(),fe.subscribeToBuildUpResultChange(function(e){console.log(e),o()}),a(f)},function(){n.notify("stopProgress",u),le.call(r),c(f)})},function(){n.notify("stopProgress",u),le.call(r),c(f)})})},le=function(){ue=fe=$=void 0,he=[],Se=[],Ce=[],ke=0,e.is(this)&&this.stopEventListener()},{onStart:function(t){Pe=e.extend(t,Pe),Z=Ie.getCommandCheckHeader("BuildUpReviewModeCmd",Le)},onStop:function(){s.resetAllSessions()},getBuildUpCmd:function(){return Z},initBuildUpSession:function(e,t,n){return ce.call(this,e,t,n)},retriveActiveSession:function(){return{session:s.retriveActiveSession()}},retriveActiveSessionId:function(){return s.retriveActiveSessionId()},resetActiveSession:function(){e.is(this)?le.call(this):le()},resetAllSessions:function(){e.is(this)?le.call(this):le(),s.resetAllSessions()},getContextItemRIRPaths:function(){return he},databasePlugin:r,delPXPSessionPlugin:s,startEventListener:function(){var n=s.retriveActiveSession();e.is(n)&&null!==n&&(be.push(t.addExternalListener("startProgress",this.onStartProgress)),be.push(t.addExternalListener("stopProgress",this.onStopProgress)))},stopEventListener:function(){for(let e=0;e<be.length;e++)t.removeExternalListener(be[e])},onStartProgress:function(){1==++ke&&(Oe=c.subscribeToModelChanges(De),$=ue.createPXPTransaction(),Ee($))},onStopProgress:function(){0==--ke&&(c.unSubscribeToModelChanges(Oe),ue.commitTransaction($).then(e=>{console.log(e)}).catch(e=>{console.log(e)}))}}}}}),define("DS/DELPPWModelBehaviors/DuplicateAdvBehavior/DuplicateAdvUI",["UWA/Core"],function(e){"use strict";return function(t,n,i){var o,r,a,s,c,l,u,f=n.getComponent("Element"),d=n.getComponent("Dialog"),g=n.getComponent("Button"),m=n.getComponent("LineEditor"),p=n.getComponent("Toggle");return c=function(n){(o=new d({domId:"DuplicateAdvCmd-Dialog",identifier:"DuplicateAdvCmd-Dialog",immersiveFrame:t.getImmersiveFrame(),modalFlag:!0,visibleFlag:!1,minWidth:"500",minHeight:"500",resizableFlag:!0,snappableFlag:!1,title:i.getNLSValue("DuplicateAdvCmd.Header"),content:s,buttons:{Ok:new g({className:"ok primary",label:i.getNLSValue("DuplicateAdvCmd.OK"),emphasize:"primary",onClick:function(){var t=u();o.close(),e.is(n,"function")&&n(t)}}),Cancel:new g({className:"cancel",label:i.getNLSValue("DuplicateAdvCmd.CANCEL"),onClick:function(){o.close()}})}})).close=function(){this.destroy(),s=null,r=null,a=null},o.show()},l=function(e,t){var n,o,c,l,u;for(n in s=new f("div",{class:"DuplicateAdvCmd-Content"}),o=new f("div",{class:"DuplicateAdvCmd-prefixOptionContainer"}),c=new f("div",{class:"DuplicateAdvCmd-linkOptionsContainer"}),e.isDisplayed&&(new f("div",{class:"DuplicateAdvCmd-prefixLabelContainer",text:i.getNLSValue("DuplicateAdvCmd.Prefix")}).inject(o),(r=new m({placeholder:i.getNLSValue("DuplicateAdvCmd.Prefix"),value:e.defaultValue})).inject(o)),a={},t)Object.prototype.hasOwnProperty.call(t,n)&&(l=t[n]).isDisplayed&&((u=new p({label:i.getNLSValue("DuplicateAdvCmd."+n),checkFlag:l.defaultValue})).inject(c),a[n]=u);o.inject(s),c.inject(s)},u=function(){var t,n={};if(e.is(r)&&(n.Prefix=r.value),e.is(a))for(t in a)Object.prototype.hasOwnProperty.call(a,t)&&(n[t]=a[t].checkFlag);return n},{name:"DuplicateAdvUI",showUI:function(t,n){return e.is(o)&&o.close(),l(t.prefixOption,t.linkOptions),c(n),o}}}}),define("DS/DELPPWModelBehaviors/ResourceParameterPlanBehavior",["UWA/Core"],function(e){"use strict";return{plugins:["DicoPlugin","DatabasePlugin","WebServicePlugin","AttributePlugin","ResourcePlugin"],creator:function(t,n,i,o,r,a,s){var c,l,u=!1,f="PLMSpecifyHowToResourcePlanCnx_Custo";return c={attributesToFetch:[{type:"PLMEntity",attributes:["PLM_ExternalID","V_description"]},{type:"BusinessType",attributes:["organization","project","reservedby","originated","modified"]},{type:"DELExtTargetValuesInteger",attributes:["V_RPPMaxValue","V_RPPMinValue","V_PossibleValues","V_RPPRscMinValue","V_RPPRscMaxValue"]},{type:"DELExtControlLimitsInteger",attributes:["V_RPPMaxControlValue","V_RPPMinControlValue"]},{type:"DELExtTargetValuesText",attributes:["V_PossibleValues"]}],customRPPAttributes:["V_RPPMode","V_RPPMagnitude","V_RPPValue","V_RPPMinValue","V_RPPMaxValue","V_RPPRscMinValue","V_RPPRscMaxValue","V_RPPRichText","V_RPPTitle","V_RPPMaxValue_Inclusive","V_RPPMinValue_Inclusive","V_RPPMinControlValue","V_RPPMinControlValue_Inclusive","V_RPPMaxControlValue","V_RPPMaxControlValue_Inclusive","V_PossibleValues"]},l=function(e){var t=f+"."+e;return{Name:e,NLS:s.getNLSValue(t),Type:"String",Protection:2,MultiValuated:"No",HasRangeDefined:"No",DefaultValue:"",MaxLength:256,Magnitude:"",ManipulationUnit:"",MultiLine:"No",UIAccess:"",HasDefault:"Yes"}},{listenTo:function(){return{moveResourceParameterRow:this.moveResourceParameterRow}},onStart:function(){u=!1},onStop:function(){u=!1},deleteResourceParameterRows:function(t,i,a){var s,c,l={};n.notify("startProgress",l),s={resourceParameterPlanPID:t,resourceParameterPlanRowPID:i},c={url:"dsmfg/private/V0/invoke/MfgProcess/WKI/ResourceParameterPlanRow",method:"DELETE",context:this,data:e.Json.encode(s),applyWidgetPreferenceUnit:!1,onComplete:function(t){e.is(t)&&e.is(t.deletedObjects)&&(o.removeReference(t.deletedObjects[0]),e.is(a)&&e.is(a.onComplete)&&a.onComplete(t.deletedObjects[0])),n.notify("stopProgress",l)},onFailure:function(){e.is(a)&&e.is(a.onFailure)&&a.onFailure(),n.notify("stopProgress",l)}},r.webServiceRequest(c)},fetchRPPAttrInfos:function(t){var i,o,d;d=function(){u=!0,e.is(t,"function")&&t()},u?d():(o=function(e){var t={},n={};c.customRPPAttributes.forEach(function(e){var i=f+"."+e,o=l(e);n[i]=o.NLS,t[i]=o}),s.addNlsJSON(n),a.addAttributeInfo(t),e()},i=[new Promise(function(t,i){var o={},l=e.clone(c.attributesToFetch);n.notify("startProgress",o),r.webServiceRequest({url:"dictionary/properties",method:"POST",applyWidgetPreferenceUnit:!1,onComplete:function(e){var i={},r={};e.forEach(function(e){e.info.forEach(function(t){var n=e.type+"."+t.Name;r[n]=t.NLS,i[n]=t})}),s.addNlsJSON(r),a.addAttributeInfo(i),n.notify("stopProgress",o),t()},onFailure:function(){n.notify("stopProgress",o),i()},onTimeout:function(){n.notify("stopProgress",o),i()},data:e.Json.encode(l)})}),new Promise(o)],Promise.all(i).then(d,d))},getObjectAndAttributeInfos:function(e){return a.getObjectAndAttributeInfos(e)},getResourceParameterRows:function(t,i,a){var s,c,l={};n.notify("startProgress",l),c={resourceParameterPlanPID:t,resourceParameterPlanRIRPath:o.transformToRIROccurrencePath(i.rppPath),resourceParameterLists:e.is(i.resourceParameterListIds)?i.resourceParameterListIds:"",resourceParameterObj:e.is(i.resourceParameterListObj)?i.resourceParameterListObj:"",resourcePID:e.is(i.resourceRefs)?i.resourceRefs:""},s={data:e.Json.encode([c]),url:"dsmfg/private/V0/invoke/MfgProcess/WKI/GetResourceParameterPlanRows",method:"POST",context:this,applyWidgetPreferenceUnit:!1,onComplete:function(t){e.is(t)&&e.is(t.rows)&&t.rows.length>0&&(t.rows.forEach(e=>{"NotSet"===e.V_RPPMinControlValue_Inclusive&&(e.V_RPPMinControlValue=""),"NotSet"===e.V_RPPMaxControlValue_Inclusive&&(e.V_RPPMaxControlValue="")}),o.addToCollections({stackedReferences:t.rows,onComplete:function(t){e.is(a)&&e.is(a.onComplete)&&a.onComplete(t.instancesAndReferences)}})),n.notify("stopProgress",l)},onFailure:function(){e.is(a)&&e.is(a.onFailure)&&a.onFailure(),n.notify("stopProgress",l)}},r.webServiceRequest(s)},isResourceParameterRow:function(e){var t=e.get("type");return["DELResourcePrmPlanSET","DELResourcePrmPlanGET"].includes(t)},isResourceParameterPlan:function(e){return i.isAKindOf(e,"DELResourceParameterPlanReference")},getAuthorizedValueIndex:function(e,t,n){return a.getAuthorizedValueIndex(e,t,n)},getAuthorizedValueDB:function(e,t){return a.getAuthorizedValueDB(e,t)},moveResourceParameterRow:function(t,i,a,c){var l,u,f={};e.is(t)&&e.is(i)&&e.is(a)&&(l={resourceParameterPlanPID:String(t),resourceParameterPlanRowPID:String(i),newIndex:a},n.notify("startProgress",f),u={url:"dsmfg/private/V0/invoke/MfgProcess/WKI/ResourceParameterPlanRow/Move",method:"POST",context:this,data:e.Json.encode(l),applyWidgetPreferenceUnit:!1,onComplete:function(t){e.is(t)&&Array.isArray(t.rows)&&o.addToCollections({stackedReferences:t.rows,silentMode:!1,onComplete:function(){n.notify("stopProgress",f),e.is(c)&&e.is(c.onComplete)&&c.onComplete()}})},onFailure:function(){n.notify("stopProgress",f),n.warn(s.getNLSValue("WUXResourceParameterRowDragDrop.ReorderFailure")),e.is(c)&&e.is(c.onFailure)&&c.onFailure()}},r.webServiceRequest(u))},updateResourceParameterRow:function(t,i){var a,c,l,u={},f=!0;e.is(t)&&e.is(i)&&(e.is(i.V_RPPValue)?Array.isArray(i.V_RPPValue)?i.V_RPPValue=i.V_RPPValue[0]:""===i.V_RPPValue&&(i.V_RPPValue=null,f=!1):(i.V_RPPValue=null,f=!1),a=e.is(t.rppPath)?o.transformToRIROccurrencePath(t.rppPath):"",c={resourceParameterPlanPID:e.is(t.resourceParameterPlanPID)?t.resourceParameterPlanPID:"",resourceParameterPlanRowPID:e.is(t.resourceParameterRowPID)?t.resourceParameterRowPID:"",resourcePID:e.is(t.resourcePID)?t.resourcePID:"",resourceParameterListPID:e.is(t.resourceParameterListPID)?t.resourceParameterListPID:"",resourceParameterPID:e.is(t.resourceParameterPID)?t.resourceParameterPID:"",resourceParameterPlanRowAttrs:e.is(i)?i:"",resourceParameterPlanRIRPath:a},n.notify("startProgress",u),l={data:e.Json.encode(c),url:"dsmfg/private/V0/invoke/MfgProcess/WKI/ResourceParameterPlanRow",method:"PUT",applyWidgetPreferenceUnit:!1,onComplete:function(t){e.is(t)&&(!1===f&&(t.V_RPPValue=null),"NotSet"===t.V_RPPMaxControlValue_Inclusive&&(t.V_RPPMaxControlValue=null),"NotSet"===t.V_RPPMinControlValue_Inclusive&&(t.V_RPPMinControlValue=null),o.addToCollections({stackedReferences:[t],silentMode:!1,onComplete:function(){n.notify("stopProgress",u)}}))},onFailure:function(){n.notify("stopProgress",u),n.warn(s.getNLSValue("ResourceParametersMgmtDialog.UpdateFailure"))}},r.webServiceRequest(l))},createResourceParameterRow:function(t,i,a){var c,l,u,f={};u=o.transformToRIROccurrencePath(a.rppPath),e.is(t)&&e.is(i)&&(c={resourceParameterPlanPID:t,resourceParameterPlanRIRPath:u,resourceParameterPlanParameters:i},n.notify("startProgress",f),l={data:e.Json.encode([c]),url:"dsmfg/private/V0/invoke/MfgProcess/WKI/ResourceParameterPlanRow",method:"POST",applyWidgetPreferenceUnit:!1,onComplete:function(t){e.is(t)&&e.is(t.rows)&&t.rows.length>0&&(t.rows.forEach(e=>{"NotSet"===e.V_RPPMinControlValue_Inclusive&&"NotSet"===e.V_RPPMaxControlValue_Inclusive&&(e.V_RPPMinControlValue="",e.V_RPPMaxControlValue="",e.V_RPPValue=null),"NotSet"===e.V_RPPMinValue_Inclusive&&"NotSet"===e.V_RPPMaxValue_Inclusive&&(e.V_RPPMinValue="",e.V_RPPMaxValue="",e.V_RPPValue=null)}),o.addToCollections({stackedReferences:t.rows,silentMode:!1,onComplete:function(e){n.info(s.getNLSValue("ResourceParametersMgmtDialog.CreateSuccess")),n.notify("addResourceParamRef",[e.instancesAndReferences])}})),n.notify("stopProgress",f)},onFailure:function(){n.notify("stopProgress",f),n.warn(s.getNLSValue("ResourceParametersMgmtDialog.CreateFailure")),e.is(a)&&e.is(a.onFailure)&&a.onFailure()}},r.webServiceRequest(l))},getNLSForUnit:function(e,t){return s.getNLSForUnit(e,t)},getNodeOptions:function(t){var i,o,r,a,l={},u=c.customRPPAttributes||[],f=t.V_RPPMagnitude,d=n.getPreferenceValue("separator"),g=t,m=["V_RPPMode","V_RPPRichText","V_RPPUnit","V_RPPMagnitude","V_TreeOrder","V_MinControlValue_Inclusive","V_MaxControlValue","V_MaxControlValue_Inclusive","V_MinControlValue"],p=["V_RPPMinValue_Inclusive","V_RPPMaxValue_Inclusive"],P={referencePID:t.PID,grid:l};for(o in g)Object.prototype.hasOwnProperty.call(g,o)&&(i=o.contains(".")?o.split(".")[1]:o,r=u.indexOf(i)>-1?"PLMSpecifyHowToResourcePlanCnx_Custo."+i:o,m.includes(i)?l[r]="NULL"!==g[o]?g[o]:"":"V_RPPMinValue"===i||"V_RPPMaxValue"===i||"V_RPPMinControlValue"===i||"V_RPPMaxControlValue"===i||"V_RPPValue"===i||"V_RPPRscMinValue"===i||"V_RPPRscMaxValue"===i?l["PLMSpecifyHowToResourcePlanCnx_Custo."+i]=g[o]:"V_RPPMinControlValue_Inclusive"===i||"V_RPPMaxControlValue_Inclusive"===i?"Excluded"===g[o]?l["PLMSpecifyHowToResourcePlanCnx_Custo."+i]=!1:"Included"===g[o]?l["PLMSpecifyHowToResourcePlanCnx_Custo."+i]=!0:l["PLMSpecifyHowToResourcePlanCnx_Custo."+i]=!1:"V_RPPTitle"===i?t.validResourceLinkExists?l["PLMSpecifyHowToResourcePlanCnx_Custo.V_RPPTitle"]={iconPath:"",label:"NULL"!==g[o]?g[o]:""}:l["PLMSpecifyHowToResourcePlanCnx_Custo.V_RPPTitle"]={iconPath:s.getIconURLFromKey("MarkUp"),label:""}:"V_PossibleValues"===i&&e.is(g[o],"array")?l["PLMSpecifyHowToResourcePlanCnx_Custo.V_PossibleValues"]=g[o].join(d):p.includes(i)&&("Excluded"===g[o]?l[r]=!1:"Included"===g[o]?l[r]=!0:l[r]="NotSet"));return e.is(f)&&Object.prototype.hasOwnProperty.call(l,"V_RPPUnit")&&(l.V_RPPUnit=this.getNLSForUnit(f,l.V_RPPUnit)),["PLMSpecifyHowToResourcePlanCnx_Custo.V_RPPMinValue_Inclusive","PLMSpecifyHowToResourcePlanCnx_Custo.V_RPPMaxValue_Inclusive"].forEach(function(e){Object.prototype.hasOwnProperty.call(l,e)||(a=e.replace("_Inclusive",""),delete l[a])}),P}}}}}),define("DS/DELPPWModelBehaviors/CapableResourceLinkBehaviour",["UWA/Core"],function(e){"use strict";return{plugins:["DatabasePlugin","DicoPlugin","ResourcePlugin"],creator:function(t,n,i,o,r){var a,s,c,l,u;return l=function(t,i,o,r){o=o||{},n.info(i,r),n.notify("stopProgress",t),e.is(o.onComplete,"function")&&o.onComplete.call(null,i)},u=function(t,i,o,r,a){r=r||{},e.is(o,"string")&&(i+="\n"+o),n.warn(i,a),n.debug(i),n.notify("stopProgress",t),e.is(r.onFailure,"function")&&r.onFailure.call(null,i)},a=function(t){var n=t.get("PID"),o=t.get("type"),r=t.get("DELAsmProcessCanUseCnx.V_IsPreferred"),a=t.get("from"),s=t.get("to"),c=t.get("DELLmiEstimatedTime.V_EstimatedTime"),l=i.getReference(a),u=i.getReference(s),f=e.is(l)?l.get("type"):null,d=e.is(u)?u.get("type"):null,g=e.is(l)?l.get("PLMEntity.V_Name"):null,m=e.is(u)?u.get("PLMEntity.V_Name"):null,p=e.is(t.get("ResourceUsage"))?t.get("ResourceUsage"):null,P=e.is(p)?i.getInstance(p):null;return{connPID:n,isPreferred:"DELAsmProcessCanUseCnx"===o?r:"",fromPID:a,toPID:s,estimatedTime:c,fromType:f,toType:d,fromName:g,toName:m,resourceUsage:e.is(P)?P.get("PLMInstance.PLM_ExternalID"):"",resourceUsagePID:p}},s=function(e){var t=[];return i.getImpacted(e,!1,{relationTypes:["DELAsmProcessCanUseCnx"]}).forEach(function(e){t.push(a(e))}),t},c=function(t,n,o){var r,a,s,c,l,u,f,d,g=!1;return r=e.is(o)?i.getInstance(o):null,a=e.is(r)?r.get("isAggregatedBy"):null,s=i.getReference(t),c=e.is(a)?i.getReference(a):null,l=i.getReference(n),u=s.get("PPRTYPE"),f=e.is(c)?c.get("PPRTYPE"):null,d=l.get("PPRTYPE"),"OPERATION"===u&&"SYSTEM"===f&&"RESOURCE"===d&&(g=!0),g},{listenTo:function(){},onStart:function(){},onStop:function(){},checkType:function(e,t){return i.getReference(e).get("PPRTYPE")===t},checkParentType:function(e,t){var n=i.getInstance(e).get("isAggregatedBy");return i.getReference(n).get("PPRTYPE")===t},getCapableRscStructureLinkOfAncestor:function(e){var t,n,o=[],r={relationTypes:["CapableResourcesStructureLink"]};for(t=e.length-2;t>=0&&1!==(o=i.getImpacted(e[t],!1,r)).length;t--);return e.length>0&&1!==o.length&&(n=i.getInstance(e[0]).get("isAggregatedBy"),o=i.getImpacted(n,!1,r)),1===o.length?o[0]:null},canCreatePrimaryCapableRscLink:function(t){var n,a,s,l,u,f,d,g,m,p,P="DELAsmProcessCanUseCnx",L=!0,I={};return n=t.fromSideRefPID,a=t.toSideRefPID,s=t.fromSideInstPID,l=t.toSideInstPID,u=t.fromSideAbsPath,f=t.toSideRootRefPID,m=i.getReferenceModel(n),o.isAKindOf(m,"DELLmiHeaderWorkPlanReference")||o.isAKindOf(m,"DELLmiServiceHeaderWorkPlanReference")?(L=!1,p=r.getNLSValue("CapableResourceLinkBehaviour.canCreatePrimaryCapableRscLinkError.ProcessIsHeaderWP")):i.hasConnection({from:n,to:a,type:"DELAsmProcessCanUseCnx"})&&(L=!1,p=r.getNLSValue("CapableResourceLinkBehaviour.canCreatePrimaryCapableRscLinkError.LinkAlreadyExists")),I={canCreateLink:L},L?(I.data=e.merge({type:P,displayText:r.getNLSValue(P,null,"CreateLink"),buttonIdentifier:r.getNLSValue(P,null,"CreateLink")},e.clone(t)),c(n,a,s)&&(d=this.getCapableRscStructureLinkOfAncestor(u),g=e.is(d)?d.get("to"):null,I.data.connectionParams={resourceAreaID:g,rscInstPID:e.is(g)&&g===f?l:null,operationRIRPath:e.is(g)?i.transformToRIROccurrencePath(u).toString():null})):I.errorMessage=p,I},canCreateSecondaryCapableRscLink:function(t){var n,o,l,u,f,d,g,m,p="SecondaryCandidateResourceLink",P=[],L={};return L={canCreateLink:!1,data:[]},n=t.fromSideRefPID,o=t.toSideRefPID,l=t.fromSideInstPID,u=t.fromSideAbsPath,g=c(n,o,l),f=this.getCapableRscStructureLinkOfAncestor(u),d=e.is(f)?f.get("to"):null,e.is(t.connectionParams)&&e.is(t.connectionParams.primaryResourceLinkPID)?(m=i.getConnection(t.connectionParams.primaryResourceLinkPID),P.push(a(m))):P=s(n),P.forEach(function(n){var a,s;o!==n.toPID&&(s={primaryResourceLinkPID:n.connPID},g&&(s=e.merge(s,{resourceAreaID:d,operationRIRPath:e.is(d)?i.transformToRIROccurrencePath(u).toString():null})),a=e.merge({type:p,displayText:r.getNLSValue(p,{primaryResource:n.toName},"CreateLink"),connectionParams:s,buttonIdentifier:n.connPID},e.clone(t)),L.data.push(a),L.canCreateLink||(L.canCreateLink=!0))}),L},canCreateCapableResourcesStructureLink:function(e){var t,n=!0;return t=i.getReferenceModel(e),(o.isAKindOf(t,"DELLmiWorkPlanSystemReference")||o.isAKindOf(t,"DELLmiQtyControlProcessReference ")||o.isAKindOf(t,"DELLmiServiceWorkPlanSystemReference"))&&i.getImpacted(e,!0,{relationTypes:["CapableResourcesStructureLink"]}).length>0&&(n=!1),n},canCreateAssetsStructureLink:function(t){var n,a,s,c,l,u,f="DELAssetsStructureLink",d=!0,g={};return n=t.fromSideRefPID,a=t.toSideRefPID,s=i.getReferenceModel(n),c=i.getReferenceModel(a),(o.isAKindOf(s,"DELLmiHeaderWorkPlanReference")||o.isAKindOf(s,"DELLmiServiceHeaderWorkPlanReference")||o.isAKindOf(s,"DELLmiWorkPlanSystemReference")||o.isAKindOf(s,"DELLmiServiceWorkPlanSystemReference"))&&o.isAKindOf(c,"Organizational")?i.hasConnection({from:n,to:a,type:"DELAssetsStructureLink"})?(d=!1,l=r.getNLSValue("CapableResourceLinkBehaviour.canCreateAssetsStructureLink.LinkAlreadyExists")):i.hasConnection({from:n,type:"DELAssetsStructureLink"})?(d=!0,u=r.getNLSValue(f,null,"CreateLink")+" "+r.getNLSValue("AuthorLinks.LinkExistsReplace")):d=!0:d=!1,g={canCreateLink:d},d?g.data=e.merge({type:f,displayText:r.getNLSValue(f,null,"CreateLink"),buttonIdentifier:r.getNLSValue(f,null,"CreateLink"),linkExistsInfoMessage:u},e.clone(t)):g.errorMessage=l,g},createConnection:function(t,o,a,s){var c,l,u,f,d,g,m,p;switch(o=o||{},u=(t=t||{}).fromSideRefPID,f=t.toSideRefPID,d=t.type,g={linkType:d,target:u,source:f},m=function(t,o){var r;e.is(o.instancesAndReferences,"array")&&o.instancesAndReferences.length>0&&i.addInstance(o.instancesAndReferences[0]),"DELAsmProcessCanUseCnx"!==t.get("type")&&"SecondaryCandidateResourceLink"!==t.get("type")||(r={linkPID:t.get("PID")},n.notify("updateResourceUsage",r)),e.is(o.deletedConnections,"array")&&o.deletedConnections.length>0&&o.deletedConnections.forEach(function(e){i.removeConnection(e)}),e.is(a,"function")&&a(g)},p=function(){e.is(s,"function")&&s(g)},t.type){case"DELAsmProcessCanUseCnx":l=this.canCreatePrimaryCapableRscLink(t);break;case"SecondaryCandidateResourceLink":l=this.canCreateSecondaryCapableRscLink(t),Array.isArray(l.data)&&l.data.length>=1&&(l.data=l.data[0]);break;case"DELAssetsStructureLink":l=this.canCreateAssetsStructureLink(t);break;default:l={canCreateLink:!1,errorMessage:r.getNLSValue("CapableResourceLinkBehaviour.createConnectionError.InvalidInputs")}}l.canCreateLink?(o=o||{},c={onFailure:p,onTimeout:p,onCancel:p,onComplete:m},i.createConnection({IDFrom:u,IDTo:f,type:d,connectionParams:l.data.connectionParams},e.merge(c,o))):(g.errorMessage=l.errorMessage,p())},createCapableResourceStructureLink:function(t,o){var a,s,c,f={},d="CapableResourcesStructureLink",g=function(e,t,n){return r.getNLSValue(e,{linkType:d,target:t,source:n})};return o=o||{},s={onFailure:function(){var e=i.getReferenceModel(t).get("PLMEntity.V_Name");u(f,g("CreateLink.CapableResourcesStructureLink.Failure",e,null),null,o,c)},onComplete:function(e){var t=i.getReferenceModel(e.get("from")),n=i.getReferenceModel(e.get("to")),r=t.get("PLMEntity.V_Name"),a=n.get("PLMEntity.V_Name");l(f,g("CreateLink.Success",r,a),o,c)}},a={type:d,IDFrom:t},n.notify("startProgress",f),c=n.log(r.getNLSValue("CreateLink.LogMessage")),i.createConnection(a,e.merge(s,o))},packConnInfo:function(e){return a(e)},getPrimaryResourceLinksInfo:function(e){return s(e)},getConnectedObjects:function(t,o,r,a){var s=[];return e.is(a)&&(a=Array.isArray(a)?a:[a]).forEach(function(o){var r,a,c,l,u,f=o.get("type"),d=o.get("PID"),g=o.get("from"),m=o.get("to");switch(f){case"CapableResourcesStructureLink":u=g===t?m:g,s.push(u);break;case"DELAsmProcessCanUseCnx":r=g,a=m,c=o.get("ResourceUsage"),u=r===t?e.is(c)?c:a:r,s.push(u),i.getImpacted(d,!1,{relationTypes:["SecondaryCandidateResourceLink"]}).forEach(function(t){var n=t.get("to"),i=t.get("ResourceUsage");s.push(e.is(i)?i:n)});break;case"SecondaryCandidateResourceLink":l=i.getConnection(g),e.is(l)&&(r=l.get("from"),s.push(r),a=l.get("to"),c=l.get("ResourceUsage"),s.push(e.is(c)?c:a));break;case"DELAssetsStructureLink":u=g===t?m:g,s.push(u);break;default:n.debug("Invalid Type")}}),s},getIsPreferred:function(e){return e.get("DELAsmProcessCanUseCnx.V_IsPreferred")}}}}}),define("DS/DELPPWModelBehaviors/DocumentBehavior",[],function(){"use strict";return{plugins:["DocumentPlugin","ResourcePlugin","DicoPlugin","PlatformPlugin"],creator:function(e,t,n,i,o,r){var a,s;return a=function(e,n,i){i=i||{},t.info(n),t.notify("stopProgress",e),UWA.is(i.onComplete,"function")&&i.onComplete.call(null,n)},s=function(e,n,i,o){o=o||{},UWA.is(i)&&UWA.is(i.message,"string")&&(n+="\n"+i.message),t.warn(n),t.notify("stopProgress",e),UWA.is(o.onFailure,"function")&&o.onFailure.call(null,n)},{listenTo:function(){return{}},onStart:function(){},onStop:function(){},getDocumentTypes:function(){return n.getDocumentTypes()},getDocumentsPolicies:function(e){n.getDocumentsPolicies({onComplete:function(t){e(t)},onFailure:function(){t.warn(i.getNLSValue("Document.FetchDocPolicyFailed"))}})},getDocument:function(e){return n.getDocument(e)},isDocConnection:function(e){return n.isDocConnection(e)},addDocumentConnection:function(e,t,i,o){return n.addDocumentConnection(e,t,i,o)},addDocument:function(e,t){return n.addDocument(e,t)},uploadDocument:function(e,o,r,c){var l,u=this,f=r.shift(),d={},g={};t.notify("startProgress",d),l=function(l){var f=l[0],m={id:f};n.linkWithDocumentID(e,f,{onComplete:function(){n.addDocumentConnection(e,f),u.attachFile(m,r,{silent:!0,onComplete:function(){a(d,i.getNLSValue("Document.UploadDocSucceeded",{document:o.title})),UWA.is(c)&&c()},onFailure:function(){s(d,i.getNLSValue("Document.UploadDocPartialSuccess",{document:o.title}))}}),t.notify("attachDocument",g)},onFailure:function(e){n.deleteDocument(f),s(d,i.getNLSValue("Document.UploadDocFailed",{message:UWA.Json.encode(UWA.result(e,"message"))}))}})},u.attachFile(o,f,{silent:!0,onComplete:l,onFailure:function(e){s(d,i.getNLSValue("Document.UploadDocFailed",{message:UWA.Json.encode(UWA.result(e,"message"))}))}})},attachDocuments:function(e,r){var c={},l={};t.notify("startProgress",c),n.getDocumentInfo(r,{onComplete:function(r){var u,f,d;for(u=0;u<r.data.length;u++)f=r.data[u],d={onComplete:function(){n.addDocument(this),n.addDocumentConnection(e,this.id),a(c,i.getNLSValue("Document.UploadDocSucceeded",{document:this.dataelements.title})),t.notify("attachDocument",l)}.bind(f),onFailure:function(e){s(c,i.getNLSValue("Document.UploadDocFailed",{message:UWA.Json.encode(UWA.result(e,"message"))}))}},"DOCUMENT"!==o.getPPRType(f.type)?t.warn(i.getNLSValue("Document.SelectionNotSupported",{type:f.type})):n.linkWithDocumentID(e,f.id,d)},onFailure:function(e){s(c,i.getNLSValue("Document.UploadDocFailed",{message:UWA.Json.encode(UWA.result(e,"message"))}))}})},fetchDocuments:function(e,i){n.getDocumentID(e,{onComplete:function(o){if(Array.isArray(o)&&o.length>0){const r=new Set;o.forEach(e=>{r.add(e.PID)}),n.getDocumentInfo([...r],{onComplete:function(r){var a,s=[];for(n.getConnectedDocumentPIDs(e).forEach(function(t){const[i,,o]=t.split("|");n.removeDocumentConnection(e,o,i,{silent:!0})}),a=0;a<r.data.length;a++){const e=r.data[a];s.push(n.addDocument(e))}o.forEach(t=>{n.addDocumentConnection(e,t.PID,t.type,{silent:!0})}),t.notify("documentAdded",[[e]]),i(s)},onFailure:function(){i()}})}else 0===o.length&&i(o)},onFailure:function(){i()}})},downloadDocument:function(e){var o=n.getDocument(e),r={};t.notify("startProgress",r),n.downloadDocuments(e,{onComplete:function(){a(r,i.getNLSValue("Document.DownloadDocSucceeded",{document:o.get("dataelements").title}))},onFailure:function(e){s(r,i.getNLSValue("Document.DownloadDocFailed",{document:o.get("dataelements").title,message:UWA.Json.encode(UWA.result(e,"message"))}))}})},deleteDocument:function(e,o){var r=n.getDocument(o),c={};t.notify("startProgress",c),n.deleteLink(e,o,{onComplete:function(){n.removeDocumentConnection(e,o),0===n.getDocumentConnectionsByDocID(o).length&&n.removeDocument(o),a(c,i.getNLSValue("Document.DeleteDocLinkSucceeded",{document:r.get("dataelements").title}))},onFailure:function(e){s(c,i.getNLSValue("Document.DeleteDocLinkFailed",{document:r.get("dataelements").title,message:UWA.Json.encode(UWA.result(e,"message"))}))}})},attachFile:function(o,r,c){var l,u,f,d=[],g={};if(c=c||{},r=UWA.is(r,"array")?r:[r],UWA.is(c.silent,"boolean")&&c.silent||t.notify("startProgress",g),!UWA.is(o.id)&&r.length>1)return e.getLogger().debug("if documentID is not provided only one file can be added"),void(UWA.is(c.onFailure)&&c.onFailure());for(l=0;l<r.length;l++)f=r[l],u=new Promise(function(e,t){n.attachFile(this.docInfo,this.fileInfo,{onComplete:function(t){var i;UWA.is(o.id)?(i=n.getDocument(o.id)).addFile(t.data[0].relateddata.files[0]):i=n.addDocument(t.data[0]),e(i.id)},onFailure:function(e){t(e)}})}.bind({docInfo:o,fileInfo:f})),d.push(u);Promise.all(d).then(function(e){UWA.is(c.silent,"boolean")&&c.silent?UWA.is(c.onComplete)&&c.onComplete(e):a(g,i.getNLSValue("Document.AttachFileSuccess"))},function(e){UWA.is(c.silent,"boolean")&&c.silent?UWA.is(c.onFailure)&&c.onFailure(e):s(g,i.getNLSValue("Document.AttachFileFailed")+UWA.Json.encode(UWA.result(e,"error")))})},downloadFile:function(e,o,r){var c={};t.notify("startProgress",c),n.downloadFile(e,o,{onComplete:function(){a(c,i.getNLSValue("Document.DownloadFileSucceeded",{file:r}))},onFailure:function(e){s(c,i.getNLSValue("Document.DownloadFileFailed",{file:r,message:UWA.Json.encode(e)}))}})},modifyFile:function(e,o,r){var c={};t.notify("startProgress",c),n.modifyFile(e,o,{onComplete:function(o){n.getDocument(e.id).modifyFile(o.data[0].relateddata.files[0]),a(c,i.getNLSValue("Document.ModifyFileSucceeded",{file:r})),t.notify("editDocument",{})},onFailure:function(e){s(c,i.getNLSValue("Document.ModifyFileFailed",{file:r,message:UWA.Json.encode(e)}))}})},removeFile:function(e,o){var r={};t.notify("startProgress",r),n.removeFile(e,o,{onComplete:function(){n.getDocument(e).removeFile(o),a(r,i.getNLSValue("Document.RemoveFileSuccess"))},onFailure:function(e){s(r,i.getNLSValue("Document.RemoveFileFailure")+UWA.Json.encode(e))}})},viewFile:function(e,t,o){n.fetchFileURL(e,t,{onComplete:function(e){window.open(e,i.getNLSValue("Document.ViewFile",{title:o}),"fullscreen=no")}})},getFileCommands:function(){return r.isCloud()?{document:{authoring:["Download","Update","Delete"],nonAuthoring:["Download"]},file:{authoring:["DownloadFile","ModifyFile","RemoveFile","ViewFile"],nonAuthoring:["DownloadFile","ViewFile"]}}:{document:{authoring:["Download","Update","Delete","Explore"],nonAuthoring:["Download","Explore"]},file:{authoring:["DownloadFile","ModifyFile","RemoveFile","ViewFile"],nonAuthoring:["DownloadFile","ViewFile"]}}},removeDocumentConnection:function(e,t,i,o){return n.removeDocumentConnection(e,t,i,o)},getConnectedDocumentPIDs:function(e){return n.getConnectedDocumentPIDs(e)}}}}}),define("DS/DELPPWModelBehaviors/ProductFlowLinkBehavior",["UWA/Core"],function(e){"use strict";return{plugins:["DatabasePlugin","DicoPlugin","WebServicePlugin","ResourcePlugin","AttributePlugin","UXComponentsPlugin"],creator:function(t,n,i,o,r,a,s,c){const l=Object.freeze({GOOD:"",QUANTITYDISTRIBUTION:"DELLmiTimeConstraintQuantityDistribution",ALTERNATIVE:"DELLmiTimeConstraintAlternative",FAILED:"DELLmiTimeConstraintFailed",SCRAPPED:"DELLmiTimeConstraintScrapped"});var u,f,d,g,m,p,P,L,I,S,h,C,y,D,R,v,A="DELLmiTimeConstraintCategoryAbstractCusto.flowType",V=["DELLmiTimeConstraintCnx","DELLmiMaterialPathCnxCust","LinearProductFlowCnx"],E={DELLmiTimeConstraintQuantityDistribution:"QuantityDistribution",DELLmiTimeConstraintAlternative:"Alternative",DELLmiTimeConstraintFailed:"Failed",DELLmiTimeConstraintScrapped:"Scrapped"},N=!1,b=[A,"DELLmiTimeConstraintAlternative.V_ExecutionReturnCode","DELLmiTimeConstraintFailed.V_ExecutionReturnCode","DELLmiTimeConstraintScrapped.V_ExecutionReturnCode","DELLmiTimeConstraintCategoryAbstract.V_ExecutionReturnCode","DELLmiTCOverlapQtyCusto.isOverlapExist","DELLmiTCOverlapQtyCusto.overlapMagnitude"],k=c.getComponent("Button"),O=null;return h=function(e){var t,n,i=e.get(A);return"NULL"!==i&&(t=o.getAttributeInfo(A),(n=s.getAuthorizedValueIndex(t,null,i))&&(i=s.getAuthorizedValueDB(t,n))),i},p=function(t,n){var o,r,a;return a=t[t.length-1],!(!i.getImpacted(a,!1,{relationTypes:V}).some(function(i){return e.equals(i.get("from"),t)&&e.equals(i.get("to"),n)})&&(o=!1,(r=function(n){var a,s,c,l,u=n[n.length-1],f=i.getImpacted(u,!1,{relationTypes:V});for(c=0;c<f.length&&(a=f[c],l=h(a),!0!==o);c++){if("DELLmiTimeConstraintFailed"===l){o=!1;break}if(e.equals(a.get("from"),n)){if(e.equals(a.get("to"),t)){o=!0;break}s=a.get("to"),r(s)}}})(n),!o))},m=function(t,n){var o,r,a,s,c,l,u={},f={},d=!1;if(e.is(t,"array")&&e.is(n,"array")){for(o=t.length-1;o>=0;o--){for(a=t[o],r=i.getInstance(a).get("isAggregatedBy"),s=n.length-1;s>=0;s--)if(c=n[s],e.is(f[c])?l=f[c]:(l=i.getInstance(c).get("isAggregatedBy"),f[c]=l),r===l&&a!==c){d=!0;break}if(d)break}u.fromPath=t.slice(o),u.toPath=n.slice(s)}return u},P=function(t,n){var i,r={Name:n,Type:"String",Protection:2,MultiValuated:"No",HasRangeDefined:"No",DefaultValue:"",MaxLength:256,Magnitude:"",ManipulationUnit:"",MultiLine:"No",UIAccess:"",HasDefault:"Yes"};switch(n){case"flowType":(i=e.clone(r)).NLS=a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory"),i.AuthorizedValues=[{Name:"",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Good")},{Name:"DELLmiTimeConstraintQuantityDistribution",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.QuantityDistribution")},{Name:"DELLmiTimeConstraintFailed",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Failed")},{Name:"DELLmiTimeConstraintAlternative",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Alternative")},{Name:"DELLmiTimeConstraintScrapped",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Scrapped")}],i.HasRangeDefined="Yes",i.DefaultValue=a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Good");break;case"V_ExecutionReturnCode":switch(i=o.getAttributeInfo(n),(i=e.is(i)?e.clone(i):e.clone(r)).FullName=t+"."+n,i.HasRangeDefined="Yes",i.AuthorizedValues=[],t){case"DELLmiTimeConstraintFailed":i.AuthorizedValues=[{Name:"RCFail203",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.203")},{Name:"RCFail204",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.204")}],i.DefaultValue=a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.203");break;case"DELLmiTimeConstraintAlternative":i.AuthorizedValues=[{Name:"RCAlter201",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.201")},{Name:"RCAlter202",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.202")}],i.DefaultValue=a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.201");break;case"DELLmiTimeConstraintScrapped":i.AuthorizedValues=[{Name:"RCScrap205",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.205")},{Name:"RCScrap206",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.206")}],i.DefaultValue=a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.205");break;case"DELLmiTimeConstraintCategoryAbstract":i.AuthorizedValues=[{Name:"RCAlter201",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.201")},{Name:"RCAlter202",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.202")},{Name:"RCFail203",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.203")},{Name:"RCFail204",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.204")},{Name:"RCScrap205",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.205")},{Name:"RCScrap206",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.206")}],i.DefaultValue=a.getNLSValue("DELLmiTimeConstraintCnx.ReturnCode.205")}break;case"isOverlapExist":(i=e.clone(r)).DefaultValue="false",i.Type="Boolean",i.NLS=a.getNLSValue("DELLmiTimeConstraintCnx.Overlap");break;case"overlapMagnitude":(i=e.clone(r)).NLS=a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude"),i.AuthorizedValues=[{Name:"DELLmiTCOverlapQty_Weight",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude.Weight")},{Name:"DELLmiTCOverlapQty_Volume",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude.Volume")},{Name:"DELLmiTCOverlapQty_Length",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude.Length")},{Name:"DELLmiTCOverlapQty_Area",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude.Area")},{Name:"DELLmiTCOverlapQty_Each",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude.Each")}],i.HasRangeDefined="Yes",i.DefaultValue=a.getNLSValue("DELLmiTimeConstraintCnx.Overlap.Magnitude.Each")}return i},I=function(e){var t=e.get("from"),n=t[t.length-1],r=i.getInstance(n),c=r.get("type"),u=!1,f=!1,d=[{Name:"DELLmiTimeConstraintFailed",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Failed")},{Name:"DELLmiTimeConstraintAlternative",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Alternative")},{Name:"DELLmiTimeConstraintScrapped",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Scrapped")}];if(o.isAKindOf(c,"DELLmiHeaderOperationInstance")){let t=r.get("DELLmiHeaderOperationInstance.V_DistributionRule"),n=o.getAttributeInfo("DELLmiHeaderOperationInstance.V_DistributionRule"),i=s.getAuthorizedValue(n,null,t),a=e.get(A),c=e.get("DELLmiTimeConstraintCnx.V_MaterialNeed"),d=o.getAttributeInfo(A),g=s.getAuthorizedValue(d,null,a);if("NotDefined"===i)switch(g){case l.GOOD:case l.FAILED:case l.ALTERNATIVE:case l.SCRAPPED:u=!0;break;case l.QUANTITYDISTRIBUTION:u=!0,f=!0}else switch(g){case l.GOOD:"TRUE"===c&&(u=!0),f=!0;break;case l.FAILED:case l.ALTERNATIVE:case l.SCRAPPED:case l.QUANTITYDISTRIBUTION:f=!0}}else u=!0;return u&&d.unshift({Name:"",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.Good")}),f&&d.unshift({Name:"DELLmiTimeConstraintQuantityDistribution",NLS:a.getNLSValue("DELLmiTimeConstraintCnx.FlowCategory.QuantityDistribution")}),d},L=function(){var e={},t={};b.forEach(function(n){var i,o;i=n.split("."),o=P(i[0],i[1]),t[n]=o.NLS,e[n]=o}),a.addNlsJSON(t),s.addAttributeInfo(e),N=!0},S=function(t){var n,i,r,a=t.get(A);return e.is(a)&&""!==a&&(E[a]?n=a:(i=o.getAttributeInfo(b[0]),r=s.getAuthorizedValueIndex(i,null,a),e.is(r)&&(n=s.getAuthorizedValueDB(i,r)))),n},C=function(t){var o,r,s=new Map,c={};t.forEach(function(t){var n,o,a,c=t.x,l=t.y;n=i.getInstance(t.instancePID),o=i.getReferenceModelFromInstance(n).get("PPRTYPE"),r=[(a="OPERATION"===o?"DELLmiOperationInstance.":"SYSTEM"===o?"DELLmiProductionSystemInstance.":"")+"V_X2DPos",a+"V_Y2DPos"],e.is(n)&&(c===Number(n.get(a+"V_X2DPos"))&&l===Number(n.get(a+"V_Y2DPos"))||s.set(t.instancePID,{[a+"V_X2DPos"]:c,[a+"V_Y2DPos"]:l}))}),s.size>0&&(o={data:Object.fromEntries(s),onFailure:function(){n.notify("stopProgress",c),n.warn(a.getNLSValue("ProductFlowLinkBehavior.TilePosition.SaveFailed"))},onComplete:function(){n.notify("stopProgress",c),n.info(a.getNLSValue("ProductFlowLinkBehavior.TilePosition.SaveSuccess"))}},n.notify("startProgress",c),i.updateInstances(r,o))},y=function(t,o,r){var s,c={};e.is(o,"object")&&(s={data:o,onFailure:function(t){var i=a.getNLSValue("EditAnchorPositionsUI.UpdateFailure");e.is(t)&&e.is(t.message,"string")&&(i+="\n"+t.message),n.warn(i),n.notify("stopProgress",c)},onComplete:function(){var e={linkPID:t,iAnchorPositionsToSet:o};r&&n.notify("refreshNodeLinks",e),n.info(a.getNLSValue("EditAnchorPositionsUI.UpdateSuccess")),n.notify("stopProgress",c)}},n.notify("startProgress",c),i.updateConnection(t,s))},D=function(t){return new Promise(function(o,r){var s={},c=function(){n.notify("stopProgress",s),n.warn(a.getNLSValue("EditAttributeUI.retrieveDataFailure")),r()};if(!e.is(t))return n.debug("object is not available."),void r();n.notify("startProgress",s),i.fetchAttributes(t,{onComplete:function(){n.notify("stopProgress",s),o()},onFailure:c,onTimeout:c})})},v=function(t){var n,i=null,o=null,r=u.getComponent("ComboBox"),s=["North","South","East","West"],c=[],l=[],f=u.createElement("div",{class:"section-container"}),m=u.createElement("div",{class:"start-position-content",styles:{display:"flex","align-items":"center",margin:"20px"}}),p=u.createElement("div",{class:"end-position-content",styles:{display:"flex","align-items":"center",margin:"20px"}});for(new e.Element("span",{text:a.getNLSValue("ProductFlowLinkBehavior.editAnchorPositionsDialog.StartPosition.Title"),styles:{width:"45%"}}).inject(m),new e.Element("span",{text:a.getNLSValue("ProductFlowLinkBehavior.editAnchorPositionsDialog.EndPosition.Title"),styles:{width:"45%"}}).inject(p),n=0;n<s.length;n++)c.push({label:a.getNLSValue("ProductFlowLinkBehavior.editAnchorPositionsDialog."+s[n]),value:s[n]}),l.push({label:a.getNLSValue("ProductFlowLinkBehavior.editAnchorPositionsDialog."+s[n]),value:s[n]});return t.get("DELArrowDisplayExt.V_ArrowStartPosition")&&t.get("DELArrowDisplayExt.V_ArrowEndPosition")&&(i=s.findIndex(function(e){return"Default"===t.get("DELArrowDisplayExt.V_ArrowStartPosition")?"East"===e:e===t.get("DELArrowDisplayExt.V_ArrowStartPosition")}),o=s.findIndex(function(e){return"Default"===t.get("DELArrowDisplayExt.V_ArrowEndPosition")?"West"===e:e===t.get("DELArrowDisplayExt.V_ArrowEndPosition")})),d=new r({elementsList:c,enableSearchFlag:!1,actionOnClickFlag:!1,selectedIndex:null!==i?i:2}).inject(m),g=new r({elementsList:l,enableSearchFlag:!1,actionOnClickFlag:!1,selectedIndex:null!==o?o:3}).inject(p),m.inject(f),p.inject(f),f},R=function(t){var n={},i=a.getNLSValue("LinksUI.EditAnchorPositions");e.is(u)&&(f=u.createElement("div",{class:"EditAnchorPositions-Dialog"}),(O=u.create("Dialog",{domId:"EditAnchorPositionsUI-Dialog",title:i,content:f,resizableFlag:!0,modalFlag:!0,width:280,minWidth:260,height:190,minHeight:180,buttons:{Cancel:new k({onClick:function(){O.close()}}),Ok:new k({disabled:!1,emphasize:"primary",onClick:function(){n={"DELArrowDisplayExt.V_ArrowStartPosition":d.value,"DELArrowDisplayExt.V_ArrowEndPosition":g.value},e.is(t,"function")&&t(n)}})}})).close=function(){this.destroy(),e.is(f)&&f.destroy(),O=null})},{listenTo:function(){},onStart:function(){u=n.getBehavior("UXFactoryBehavior"),N||L()},onStop:function(){},canCreateProductFlowLink:function(t,n){var o,r,s,c,l,u,f,d=!0,g={};return u=function(){var t=!1,n=c.toString(),i=l.toString();return c.length>0&&l.length>0&&0!==n.indexOf(i)&&0!==i.indexOf(n)&&(o=m(c,l),t=e.is(o)&&Array.isArray(o.fromPath)&&o.fromPath.length>0&&Array.isArray(o.toPath)&&o.toPath.length>0),t},f=function(){var e,t,n;return e=i.getInstance(c[c.length-1]),t=i.getReference(e.get("isAggregatedBy")),n=i.getSequencingModeAttrName(t),"Linear"===t.get(n)},t=t||{},e.is(t.fromSideAbsPath)&&e.is(t.toSideAbsPath)?(c=t.fromSideAbsPath,l=t.toSideAbsPath,r=a.getNLSValue(n),u()?f()?(d=!1,s=a.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.ParentisInLinearSeqMode",{linkType:r})):p(o.fromPath,o.toPath)&&(d=!1,s=a.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.ExistOrLoop",{linkType:r})):(d=!1,s=a.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.NoCommonParent",{linkType:r}))):(d=!1,s=a.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.InsufficentInfo")),g={canCreateLink:d},d?g.data=e.merge({type:n,fromSideOccPath:e.is(o,"object")?o.fromPath:null,toSideOccPath:e.is(o,"object")?o.toPath:null,displayText:e.is(r)?r:null,buttonIdentifier:e.is(r)?r:null},e.clone(t)):g.errorMessage=s,g},createProductFlowLink:function(t,n,o,r){var a,s,c,l,u=function(){e.is(r,"function")&&r(l)};n=n||{},s=(t=t||{}).fromSideOccPath[t.fromSideOccPath.length-1],c=t.toSideOccPath[t.toSideOccPath.length-1],l={linkType:t.type,target:s,source:c},a=this.canCreateProductFlowLink(t,t.type),e.is(t.startAnchorId)&&e.is(t.endAnchorId)&&(n.startAnchorId=t.startAnchorId,n.endAnchorId=t.endAnchorId),a.canCreateLink?i.createConnection({IDFrom:t.fromSideOccPath.toString(),IDTo:t.toSideOccPath.toString(),type:t.type},e.merge({onFailure:u,onTimeout:u,onCancel:u,onComplete:function(){e.is(o,"function")&&o(l)}},n)):(l.errorMessage=a.errorMessage,u())},getProductFlowRelationTypes:function(){return V},getProductFlowRelationTypeByTypes:function(e,t){var n,i=o.getPossibleRelations(e,t,"write");return(n=i.indexOf(V[0]))>-1?i[n]:void 0},getDynamicAuthorizedListFlowType:function(e){return I(e)},getLinkInfo:function(t){var n,i,r,c,l,u,f,d,g,m={NLS:null,type:null,subType:null,iconName:null,flowType:null,reasonCode:null,description:null,isProductFlow:!1};return n=t.get("type"),i=t.get("PLMEntity.V_description"),c=o.getAttributeInfo("DELLmiTimeConstraintCnx.V_DependencyType"),"TRUE"===t.get("DELLmiTimeConstraintCnx.V_MaterialNeed")?(m.isProductFlow=!0,r=n+"_ProductFlow",f=S(t),"Good"!==(d=e.is(f)?E[f]:"Good")&&(g=t.get("DELLmiTimeConstraintCategoryAbstract.V_ExecutionReturnCode"))):(l=t.get("DELLmiTimeConstraintCnx.V_DependencyType"),u=s.getAuthorizedValueIndex(c,null,l),r=n+"_"+s.getAuthorizedValueDB(c,u)),m.NLS=a.getNLSValue(r),m.type=n,m.description=i,m.subType=r,m.iconName=r,m.flowType=d,m.reasonCode=g,m},saveTilePositions:function(e){C(e)},saveAnchorPositions:function(e,t,n){y(e,t,n)},editAnchorPositions:function(t){var o,r=i.getConnection(t),s=e.is(r)?r.get("type"):null;e.is(r)&&"DELLmiTimeConstraintCnx"===s?D(r).then(function(){o=v(r),R(function(e){null!==e?y(t,e,!0):n.warn(a.getNLSValue("EditAnchorPositionsUI.ConfigAttrNotAvilaibleOnObject")),O.close()}),o.inject(f)}):n.warn(a.getNLSValue("EditAnchorPositionsUI.LinkNotAvailable"))}}}}}),define("DS/DELPPWModelBehaviors/DataCollectWKIBehavior",["UWA/Core"],function(e){"use strict";return{plugins:["DicoPlugin","DatabasePlugin","WebServicePlugin","AttributePlugin","ResourcePlugin"],creator:function(t,n,i,o,r,a,s){var c,l,u=!1,f="PLMSpecifyHowToCollectDataCnx_Custo";return c={attributesToFetch:[{type:"PLMEntity",attributes:["PLM_ExternalID","V_description"]},{type:"BusinessType",attributes:["organization","project","reservedby","originated","modified"]},{type:"PLMSpecifyHowToCollectDataCnx",attributes:["V_DCLabel","V_DCMode","V_DCNbSameMeasurement"]},{type:"DELExtTargetValuesInteger",attributes:["V_MaxValue","V_MinValue","V_PossibleValues"]},{type:"DELExtControlLimitsInteger",attributes:["V_MaxControlValue","V_MinControlValue"]},{type:"DELExtTargetValuesText",attributes:["V_PossibleValues"]}],customDCAttributes:["V_DCRichText","V_DCType","V_DCMagnitude","V_DCUnit","V_MinValue","V_MinValue_Inclusive","V_MinControlValue","V_MinControlValue_Inclusive","V_MaxValue","V_MaxValue_Inclusive","V_MaxControlValue","V_MaxControlValue_Inclusive","V_Value","V_DCTimeStampFormat","V_DCRequirementLink","V_DCFormula","V_DCResourceLink","V_PossibleValues"]},l=function(e){var t,n=f+"."+e;switch(t={Name:e,NLS:s.getNLSValue(n),Type:"String",Protection:2,MultiValuated:"No",HasRangeDefined:"No",DefaultValue:"",MaxLength:256,Magnitude:"",ManipulationUnit:"",MultiLine:"No",UIAccess:"",HasDefault:"Yes"},e){case"V_DCType":t.AuthorizedValues=[{Name:"Real",NLS:s.getNLSValue("DCType.Real")},{Name:"Integer",NLS:s.getNLSValue("DCType.Integer")},{Name:"Text",NLS:s.getNLSValue("DCType.Text")},{Name:"Boolean",NLS:s.getNLSValue("DCType.Boolean")},{Name:"TimeStamp",NLS:s.getNLSValue("DCType.TimeStamp")}],t.HasRangeDefined="Yes",t.DefaultValue="Real";break;case"V_DCUnit":t.HasRangeDefined="Yes",t.AuthorizedValues=[];break;case"V_DCTimeStampFormat":t.AuthorizedValues=[{Name:"hh:mm:ss",NLS:s.getNLSValue("DCRow.TimeStamp.Format.HHMMSS")},{Name:"hh:mm",NLS:s.getNLSValue("DCRow.TimeStamp.Format.HHMM")},{Name:"YYYY:MM:DD",NLS:s.getNLSValue("DCRow.TimeStamp.Format.YYYYMMDD")}],t.HasRangeDefined="Yes",t.DefaultValue="hh:mm:ss";break;case"V_PossibleValues":t.AuthorizedValues=[{Name:"TRUE,FALSE",NLS:s.getNLSValue("DCRow.Boolean.PossibleValues.TrueFalse")},{Name:"YES,NO",NLS:s.getNLSValue("DCRow.Boolean.PossibleValues.YesNo")},{Name:"1,0",NLS:s.getNLSValue("DCRow.Boolean.PossibleValues.OneZero")}],t.DefaultValue="TRUE,FALSE";break;case"V_DCFormula":t.MultiLine="Yes"}return t},{listenTo:function(){return{moveDataCollectRow:this.moveDataCollectRow}},onStart:function(){u=!1},onStop:function(){u=!1},fetchDataCollectAttrInfos:function(t){var i,o,d;d=function(){u=!0,e.is(t,"function")&&t()},u?d():(o=function(e){var t={},n={};c.customDCAttributes.forEach(function(e){var i=f+"."+e,o=l(e);n[i]=o.NLS,t[i]=o}),s.addNlsJSON(n),a.addAttributeInfo(t),e()},i=[new Promise(function(t,i){var o={},l=e.clone(c.attributesToFetch);n.notify("startProgress",o),r.webServiceRequest({url:"dictionary/properties",method:"POST",applyWidgetPreferenceUnit:!1,onComplete:function(e){var i={},r={};e.forEach(function(e){e.info.forEach(function(t){var n=e.type+"."+t.Name;r[n]=t.NLS,i[n]=t})}),s.addNlsJSON(r),a.addAttributeInfo(i),n.notify("stopProgress",o),t()},onFailure:function(){n.notify("stopProgress",o),i()},onTimeout:function(){n.notify("stopProgress",o),i()},data:e.Json.encode(l)})}),new Promise(o)],Promise.all(i).then(d,d))},isDataCollectPlan:function(e){return i.isAKindOf(e,"DELWkiDataCollectPlanReference")},isDataCollectCheckList:function(e){return i.isAKindOf(e,"DELWkiDataCollectChecklistReference")},isDataCollectRow:function(e){return i.isAKindOf(e,"PLMSpecifyHowToCollectDataCnx")},getDataCollectRows:function(t,i){var a,s={};n.notify("startProgress",s),a={url:"dsmfg/private/V0/invoke/MfgProcess/WKI/DataCollectRows?dataCollectPID="+t,method:"GET",context:this,applyWidgetPreferenceUnit:!1,onComplete:function(t){e.is(t)&&e.is(t.rows)&&o.addToCollections({stackedReferences:t.rows,onComplete:function(t){e.is(i)&&e.is(i.onComplete)&&i.onComplete(t.instancesAndReferences),n.notify("stopProgress",s)}})},onFailure:function(){e.is(i)&&e.is(i.onFailure)&&i.onFailure(),n.notify("stopProgress",s)}},r.webServiceRequest(a)},getNodeOptions:function(t){var i,o,r,a,l,u,f,d,g,m={},p=c.customDCAttributes||[],P=n.getPreferenceValue("separator"),L=t.toJSON(),I=["V_DCMode","V_DCRichText","V_DCLabel","V_DCNbSameMeasurement","V_DCUnit","V_MinValue","V_MinControlValue","V_MaxValue","V_MaxControlValue","V_DCTimeStampFormat","PLM_ExternalID","V_description","organization","project","reservedby","originated","modified","V_TreeOrder"],S=["V_MinValue_Inclusive","V_MinControlValue_Inclusive","V_MaxValue_Inclusive","V_MaxControlValue_Inclusive"],h={referencePID:t.get("PID"),grid:m};for(o in L)Object.prototype.hasOwnProperty.call(L,o)&&(i=o.contains(".")?o.split(".")[1]:o,g=p.indexOf(i)>-1?"PLMSpecifyHowToCollectDataCnx_Custo."+i:o,I.includes(i)?m[g]="NULL"!==L[o]?L[o]:"":"V_Value"===i?m[g]=L[o]:"V_PossibleValues"===i&&e.is(L[o],"array")?m["PLMSpecifyHowToCollectDataCnx_Custo.V_Value"]=L[o].join(P):"V_DCFormula"===i?(r=L[o],e.is(r)&&(a=r.match("(?<=<FormulaAsDisplayed>)(.*)(?=</FormulaAsDisplayed>)"),Array.isArray(a)&&(m[g]=a[0]))):S.includes(i)?"Excluded"===L[o]?m[g]=!1:"Included"===L[o]?m[g]=!0:m[g]="NotSet":"V_DCType"===i?(f="DCType."+L[o],m[g]={iconPath:s.getIconURLFromKey(f),label:s.getNLSValue(f)}):"V_DCMagnitude"===i?(u=L[o],m[g]={iconPath:s.getIconURLFromKey("DCMagnitude."+u),label:s.getNLSValue(u)}):"V_DCRequirementLink"===i?(l=L[o],m[g]={iconPath:s.getIconURLFromKey("DCLink.Rquirement"),label:l.ReqName+" "+l.ReqRevision}):"V_DCResourceLink"===i&&(m[g]={iconPath:s.getIconURLFromKey(i),label:m[i]}));return e.is(u)&&Object.prototype.hasOwnProperty.call(m,"PLMSpecifyHowToCollectDataCnx_Custo.V_DCUnit")&&(m["PLMSpecifyHowToCollectDataCnx_Custo.V_DCUnit"]=s.getNLSForUnit(u,m["PLMSpecifyHowToCollectDataCnx_Custo.V_DCUnit"])),S.forEach(function(e){var t=p.indexOf(e)>-1?"PLMSpecifyHowToCollectDataCnx_Custo."+e:e;Object.prototype.hasOwnProperty.call(m,t)||(d=t.replace("_Inclusive",""),delete m[d])}),h},deleteDataCollectRow:function(t,i,a){var s,c,l={};n.notify("startProgress",l),s={dataCollectPID:t,dataCollectRowPID:i},c={url:"dsmfg/private/V0/invoke/MfgProcess/WKI/DataCollectRow",method:"DELETE",context:this,data:e.Json.encode(s),applyWidgetPreferenceUnit:!1,onComplete:function(t){e.is(t)&&e.is(t.deletedObjects)&&(o.removeReference(t.deletedObjects[0]),e.is(a)&&e.is(a.onComplete)&&a.onComplete(t.deletedObjects[0])),n.notify("stopProgress",l)},onFailure:function(){e.is(a)&&e.is(a.onFailure)&&a.onFailure(),n.notify("stopProgress",l)}},r.webServiceRequest(c)},fetchDataCollectRow:function(t,i,a){var c,l={};e.is(t)&&e.is(i)&&(n.notify("startProgress",l),c={url:"dsmfg/private/V0/invoke/MfgProcess/WKI/DataCollectRow?dataCollectPID="+t+"&dataCollectRowPID="+i,method:"GET",applyWidgetPreferenceUnit:!1,onComplete:function(t){e.is(t)&&o.addToCollections({stackedReferences:[t],silentMode:!1,onComplete:function(){n.notify("stopProgress",l),e.is(a)&&e.is(a.onComplete)&&a.onComplete()}})},onFailure:function(){n.notify("stopProgress",l),n.warn(s.getNLSValue("DataCollectMgmtDialog.RetrieveDataFailure")),e.is(a)&&e.is(a.onFailure)&&a.onFailure()}},r.webServiceRequest(c))},getObjectAndAttributeInfos:function(e){return a.getObjectAndAttributeInfos(e)},getDimensions:function(){return a.getDimensions()},getAuthorizedValueIndex:function(e,t,n){return a.getAuthorizedValueIndex(e,t,n)},getAuthorizedValueDB:function(e,t){return a.getAuthorizedValueDB(e,t)},convertValuesBetweenUnits:function(t){var i={};return n.notify("startProgress",i),new Promise(function(o,a){var c={Dimension:t.dimension,UnitFrom:t.fromUnit,UnitTo:t.toUnit,Value:t.valuesToConvert.join(";")},l=function(){n.notify("stopProgress",i),n.warn(s.getNLSValue("DataCollectMgmtDialog.ConvertUnitFailure")),a()};r.webServiceRequest({url:"dictionary/dimensions/convertValue",method:"POST",applyWidgetPreferenceUnit:!1,onComplete:function(e){n.notify("stopProgress",i),o(e)},onFailure:l,onTimeout:l,data:e.Json.encode(c)})})},updateDataCollectRow:function(t,i,a,c){var l,u,f={};e.is(t)&&e.is(i)&&e.is(a)&&(l={dataCollectPID:t,dataCollectRowPID:i,dataCollectRowAttrs:a},n.notify("startProgress",f),u={data:e.Json.encode(l),url:"dsmfg/private/V0/invoke/MfgProcess/WKI/DataCollectRow",method:"PUT",applyWidgetPreferenceUnit:!1,onComplete:function(t){e.is(t)&&o.addToCollections({stackedReferences:[t],silentMode:!1,onComplete:function(){n.notify("stopProgress",f),n.info(s.getNLSValue("DataCollectMgmtDialog.UpdateSuccess")),e.is(c)&&e.is(c.onComplete)&&c.onComplete()}})},onFailure:function(){n.notify("stopProgress",f),n.warn(s.getNLSValue("DataCollectMgmtDialog.UpdateFailure")),e.is(c)&&e.is(c.onFailure)&&c.onFailure()}},r.webServiceRequest(u))},moveDataCollectRow:function(t,i,a,c){var l,u,f={};e.is(t)&&e.is(i)&&e.is(a)&&(l={dataCollectPID:t,dataCollectRowPID:i,newIndex:a},n.notify("startProgress",f),u={url:"dsmfg/private/V0/invoke/MfgProcess/WKI/DataCollectRow/Move",method:"POST",context:this,data:e.Json.encode(l),applyWidgetPreferenceUnit:!1,onComplete:function(t){e.is(t)&&Array.isArray(t.rows)&&o.addToCollections({stackedReferences:t.rows,silentMode:!1,onComplete:function(){n.notify("stopProgress",f),e.is(c)&&e.is(c.onComplete)&&c.onComplete()}})},onFailure:function(){n.notify("stopProgress",f),n.warn(s.getNLSValue("WUXDataCollectRowDragDrop.ReorderFailure")),e.is(c)&&e.is(c.onFailure)&&c.onFailure()}},r.webServiceRequest(u))},createDataCollectRow:function(t,i,a){var c,l,u={};e.is(t)&&e.is(i)&&(c={dataCollectPID:t,dataCollectRowAttrs:i},n.notify("startProgress",u),l={data:e.Json.encode(c),url:"dsmfg/private/V0/invoke/MfgProcess/WKI/DataCollectRow",method:"POST",applyWidgetPreferenceUnit:!1,onComplete:function(t){e.is(t)&&o.addToCollections({stackedReferences:[t],silentMode:!1,onComplete:function(){n.notify("stopProgress",u),n.info(s.getNLSValue("DataCollectMgmtDialog.CreateSuccess")),e.is(a)&&e.is(a.onComplete)&&a.onComplete()}})},onFailure:function(){n.notify("stopProgress",u),n.warn(s.getNLSValue("DataCollectMgmtDialog.CreateFailure")),e.is(a)&&e.is(a.onFailure)&&a.onFailure()}},r.webServiceRequest(l))}}}}}),define("DS/DELPPWModelBehaviors/ImplementBehaviorBase",["UWA/Core","UWA/Class/Promise"],function(e,t){"use strict";return function(n,i,o,r,a,s,c,l,u){var f,d,g,m,p,P=function(t,n,o,r){var s=e.is(t)?a.getNLSValue(t):n;i.info(s,o),r&&r(s)},L=function(t,n,o,r,s){var c=e.is(t)?a.getNLSValue(t):o;e.is(n,"string")&&n.length>0&&(c=n),i.warn(c,r),s&&s(c)};return f=function(e,t,n,o,r,c){var l,u,f={},d=a.getNLSValue("ImplementBehavior.CreateScope.LogMessage"),g=a.getNLSValue("ImplementBehavior.CreateScope.Success"),p=a.getNLSValue("ImplementBehavior.CreateScope.Failed"),I=i.log(d),S=function(e){P(e,g,I,r),i.notify("createLink",f)},h=function(e,t){L(e,t,p,I,c)};(l=s.canCreateScopeLink({fromSideRefPID:e,toSideRefPID:t,fromSideAbsPath:n,toSideAbsPath:o})).canCreateLink?"ProcessImplementLink"===s.getScopeLinkType()?s.createScopeLink(e,t,{onComplete:S,onFailure:h}):(u=m(n)).hasImplementLink?h(null,a.getNLSValue("ImplementBehavior.Validation.ImplLinkExists",{obj1:u.implementingName,obj2:u.implementedName})):s.createScopeLink(e,t,{onComplete:S,onFailure:h}):h(null,l.errorMessage)},d=function(t,n,r,c){var u,f,d,g,I,S,h,C=[],y=a.getNLSValue("ImplementBehavior.CreateScope.LogMessage"),D=a.getNLSValue("ImplementBehavior.CreateScope.Success"),R=a.getNLSValue("ImplementBehavior.CreateScope.Failed"),v=i.log(y),A=function(t,n){P(t,D,v,r),e.is(n)&&(n.connections.forEach(function(e){C.push(e.toJSON())}),i.notify("createImplementLink",C))},V=function(e,t){L(e,t,R,v,c)};if(e.is(t,"array")&&t.length>0&&e.is(n,"array")&&n.length>0)if(f=t[t.length-1],u=o.getReferenceIdFromInstance(f),g=n[n.length-1],d=o.getReferenceIdFromInstance(g),(h=s.canCreateScopeLink({fromSideRefPID:u,toSideRefPID:d,fromSideInstPID:f,toSideInstPID:g,fromSideAbsPath:t,toSideAbsPath:n})).canCreateLink)if("ProcessImplementLink"===s.getScopeLinkType())s.createScopeLink(u,d,{onComplete:A,onFailure:V});else if(s.validateIfScoped(t,n))(S=m(t,n)).hasImplementLink?S.withSameProduct?s.createScopeLink(u,d,{onComplete:A,onFailure:V}):V(null,a.getNLSValue("ImplementBehavior.Validation.ImplLinkExists",{obj1:S.implementingName,obj2:S.implementedName})):(I=p(t,n),s.createScopeAndImplementLink(u,f,d,I,{onComplete:A,onFailure:V}));else{if(i.getPreferenceValue("skipVaidationIfScopedCheck")&&l.isAKindOf(void 0,"Provide"))return void s.createScopeLink(u,d,{onComplete:A,onFailure:V});V(null,a.getNLSValue("ImplementBehavior.Validation.ScopeNotValid"))}else V(null,h.errorMessage);else i.debug("Input parameters are invalid."),V()},m=function(t,n){var i,r,a,c,l,u,f=!1,d=!1,g=null,m=null;return i=e.is(t,"array")&&t.length>0?s.getImplLinksOfImplementing(t):null,e.is(i,"array")&&i.length>0&&(f=!0,e.is(n)&&(d=i.some(function(t){const i=e.is(n,"array")&&n.length>0?n[n.length-1]:n;return e.equals(t.get("to"),[i])})),c=(u=i[0]).getAttribute("from"),l=o.getReferenceModel(c),e.is(l)&&(m=l.get("PLMEntity.V_Name")),r=u.getAttribute("to"),a=o.getReferenceModel(r),e.is(a)&&(g=a.get("PLMEntity.V_Name"))),{hasImplementLink:f,withSameProduct:d,implementingName:m,implementedName:g}},g=function(n,i,r,a){var c,l,u;return e.is(n,"array")&&n.length>0&&s.isUnderScope(n)&&e.is(r,"array")&&r.length>0?(l=n,u=r,c=new t(function(e,t){d(l,u,e,t)})):c=function(e,n,i,r){return new t(function(t,a){var s=o.isReference(e)?e:o.getReferenceIdFromInstance(e),c=o.isReference(n)?n:o.getReferenceIdFromInstance(n);f(s,c,i,r,t,a)})}(i,a,n,r),c},p=function(t,n){const i=s.getPathToScope(n),o=((t,n)=>{let i=null;const o=s.isUnderPartialScope(t);return e.is(o)&&o&&(i=s.getPathToPartialScope(n)),i})(t,n);let r=i;return Array.isArray(o)&&Array.isArray(i)?r=((...e)=>{let t=e[0];const n=e.length;for(let i=1;i<n;i++)e[i].length<t.length&&(t=e[i]);return t})(o,i):Array.isArray(o)&&(r=o),r},{onStart:function(){},isScoped:function(e){return s.isScoped(e)},isPartialScoped:function(e){return s.isPartialScoped(e)},getPartialScopeLinkType:function(){return s.getPartialScopeLinkType()},getScopeLinkType:function(){return s.getScopeLinkType()},getImplementLinkType:function(){return s.getImplementLinkType()},getScopeLinksOfImplemented:function(e){return s.getScopeLinksOfImplemented(e)},getPartialScopeLinks:function(e){return s.getPartialScopeLinks(e)},getPathToScope:function(e){return s.getPathToScope(e)},findInstanceWhoseParentIsScoped:function(e){return s.findInstanceWhoseParentIsScoped(e)},createScopeLink:function(n){var r,a={},s=[];return e.is(n,"array")&&n.length>0?(i.notify("startProgress",a),s=n.map(function(e){return g(e.implementingAbsPath,e.implementingPID,e.implementedAbsPath,e.implementedPID,e.isPartialScope)}),r=t.allSettled(s).then(function(){var r,s=u.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),c=[],f=o.isReference(n[0].implementingPID)?n[0].implementingPID:o.getReferenceIdFromInstance(n[0].implementingPID),d=o.isReference(n[0].implementedPID)?n[0].implementedPID:o.getReferenceIdFromInstance(n[0].implementedPID);r=o.getReferenceModel(f),l.isAKindOf(r.get("type"),"Provide")||l.isAKindOf(r.get("type"),"DELServicePartReference")?o.getCurrentStates([d],s,function(n){e.is(n)&&"RELEASED"===n.get(d)?((widget.getValue("isReleaseMaturitySynced")||i.getPreferenceValue("isReleaseSyncXENEnabled")&&widget.getValue("fromXen"))&&c.push(new t(function(e,t){o.syncMaturity([r],s,widget.getValue("isChangeRequiredSynced")||i.getPreferenceValue("isReleaseSyncXENEnabled")&&widget.getValue("fromXen"),e,t)})),t.all(c).then(function(){var e=[];e.onComplete=function(){i.notify("referenceChanged",r),i.notify("stopProgress",a)},e.onFailure=function(){i.notify("referenceChanged",r),i.notify("stopProgress",a)},e.forceDBMode=!0,o.fetchRoot(r.get("PID"),e)})):i.notify("stopProgress",a)}):(i.notify("referenceChanged",r),i.notify("stopProgress",a))})):(i.debug("Input parameters are invalid."),r=t.reject("ImplementBehavior.Validation.InvalidInput")),r},createImplementLink:function(t,n,r,c){var l,u,f,d,g=a.getNLSValue("ImplementBehavior.Validation.ScopeNotValid"),m=function(t,n){var i=e.is(t)?a.getNLSValue(t):null;e.is(n)&&(i=n),u.errorMessage=i,c(u)};if(u={linkType:t.type,target:o.getReferenceModel(t.implementingAbsPath[t.implementingAbsPath.length-1]).get("PID"),source:o.getReferenceModel(t.implementedAbsPath[t.implementedAbsPath.length-1]).get("PID")},e.is(t.fromSideAbsPath)&&e.is(t.fromSideAbsPath)||(t.fromSideAbsPath=t.implementingAbsPath,t.toSideAbsPath=t.implementedAbsPath),e.is(t.fromSideRefPID)||(t.fromSideRefPID=t.implementingPID),s.canCreateImplementLink(t).canCreateLink){let n=s.isPartialScoped(t.fromSideRefPID)?[t.fromSideRefPID]:t.implementingAbsPath,o=t.implementedAbsPath;f=(l=s.getPathsToScope(n,o)).implementingPathToScope,d=l.implementedPathToScope,e.is(f)&&e.is(d)?s.createImplementLink(f,d,{connectionParams:t.connectionParams,onComplete:function(e,t){i.notify("createImplementLink",t.toJSON()),r(u)},onFailure:m}):m(null,g)}else m(null,g)},deleteScopeLink:function(n){var o,r,c={},l=[],u=e.is(n,"array")?n:[n],f=a.getNLSValue(this.getScopeLinkType()),d=a.getNLSValue("DeleteLink.LogMessage",{linkType:f}),g=a.getNLSValue("DeleteLink.Success",{linkType:f}),m=a.getNLSValue("DeleteLink.Failure",{linkType:f});return u.length>0?(i.notify("startProgress",c),u.forEach(function(n){r=s.getScopeLinksOfImplementing(n),e.is(r)&&r.length>0&&(l=r.map(function(e){return new t(function(t,n){!function(e,t,n){var o=i.log(d);s.deleteScopeLink(e,{onComplete:function(e,n){P(e,g,o,t),i.notify("deleteLink",[n.deletedConnections])},onFailure:function(e,t){L(e,t,m,o,n)}})}(e.get("PID"),t,n)})}))}),o=t.allSettled(l).then(function(){i.notify("stopProgress",c)})):(i.debug("Unable to delete scope links as input parameters are invalid."),o=t.reject("ImplementBehavior.Validation.InvalidInput")),o}}}}),define("DS/DELPPWModelBehaviors/MfgItemBehavior",["UWA/Core"],function(e){"use strict";return{plugins:["MfgItemPlugin","ResourcePlugin","BIPlugin","DatabasePlugin","PlatformPlugin"],creator:function(t,n,i,o,r,a,s){return{webservice:function(t,c,l,u){var f,d,g,m,p,P,L,I,S,h,C,y,D,R={noTimeout:!0},v={},A={silentMode:!0,updateItem:!0},V="";if(n.notify("startProgress",R),e.is(l)&&e.is(l.logMessage)&&(d=n.log(l.logMessage)),(c=c||{}).product&&(m=c.product.referencePID,L=c.product.OccPath,V=e.is(c.product.productConfigFilter)?c.product.productConfigFilter:""),c.mfgItem&&(p=c.mfgItem.referencePID,I=c.mfgItem.instancePID,D=c.mfgItem.topRootMfgItemPID),h=function(t){e.is(P)&&n.notify(P,v),e.is(t)?e.is(t.succeeded)&&Object.keys(t.succeeded).length>0&&r.getBICmdState()&&r.computeBI():(n.info(l.logMessage+" "+o.getNLSValue("completed"),d),r.getBICmdState()&&r.computeBI()),n.notify("stopProgress",R)},S=function(t){var i,o,r=[];t.instancesAndReferences.forEach(function(t){i=t.attributesValue,e.is(i.isInstanceOf)&&(o=a.getInstance(i.PID),e.is(o)&&n.notify("instanceAdded",[o,A]))}),t.connections.forEach(function(e){r.push(a.getConnection(e.PID))}),r.length>0&&n.notify("connectionAdded",[r])},"Create"===t){if(s.isCreateMBOMv2())return g={rootProductID:m,productOccPath:Array.isArray(L)?L.join(","):"",rootMfgItemID:p,engConfigFilter:V,mfgInstanceID:e.is(I)?I:"",scopeCreation:l.scopeCreation,prefix:l.prefix,computeResultReport:!!e.is(l.computeResultReport)&&l.computeResultReport,topRootMfgItemPID:D},void i.callScalCreateMBOM(g).then(e=>{n.info(o.getNLSValue("CreateMfgItemStructure.jobSubmit.Success")),n.notify("stopProgress",R)}).catch(e=>{n.warn(o.getNLSValue("CreateMfgItemStructure.jobSubmit.Fail")),n.notify("stopProgress",R)});f="POST",P="createMfgItemStructure",g=e.Json.encode({rootProductID:m,productOccPath:Array.isArray(L)?L.join(","):"",rootMfgItemID:p,engConfigFilter:V,mfgInstanceID:e.is(I)?I:"",scopeCreation:l.scopeCreation,prefix:l.prefix,computeResultReport:!!e.is(l.computeResultReport)&&l.computeResultReport,topRootMfgItemPID:D}),l.onComplete=function(t,i,o){C=a.getReference(t),n.notify("referenceAdded",[C,"",A]),e.is(u)&&u(o),h()}}else if("Update"===t){P="updateMfgItemStructure ",f="PUT";const t=e.is(c.mfgItem.processConfigFilter)?c.mfgItem.processConfigFilter:"";g=e.Json.encode({mbomUpdateMode:"mbomPull",rootProductID:m,rootMfgItemID:p,backgroundJobflag:l.backgroundJobFlag,scopeCreation:l.scopeCreation,prefix:l.prefix,engConfigFilter:V,mfgConfigFilter:t,updateIntermediateScopedAssemblies:l.updateIntermediateScopedAssemblies,computeResultReport:!0,topRootMfgItemPID:D}),l.onComplete=function(t,i,r,s){if(!e.is(t)){const e=r.resultReport,t=Object.values(e);let i=[];for(let e=0;e<t.length;e++)for(let n=0;n<t[e].length;n++)"Failed"===t[e][n].Status&&i.push(t[e][n].ErrorMessage);return i.length>0?(n.warn(o.getNLSValue("Info.PartialUpdate.Title"),d),i.forEach(function(e){n.log(e,d)})):n.info(o.getNLSValue("Info.NoUpdate.Title"),d),void n.notify("stopProgress",R)}e.is(i)?(C=a.getReference(i),n.notify("referenceAdded",[C,"",A])):e.is(s)&&s?(y=a.getReference(m),n.notify("referenceAdded",[y,"",A]),S(r)):S(r),h()}}else"rerouteScopeLink"!==t&&"rerouteLink"!==t||(f="POST",g=e.Json.encode(l),l=e.merge(l,{appenedURL:"RerouteMfgItem"}),(l=e.merge(l,{logMessage:o.getNLSValue("MIL.LogMessage")})).onComplete=function(t,n,i){var o,r;o=i.succeeded,(r=Object.keys(o)).length>0&&(P="RerouteMfgItem",r.forEach(function(e){var t=o[e];Object.keys(t).forEach(function(e){S(t[e])})})),e.is(u)&&u(i),h(i)});l.onFailure=function(t){if(e.is(l.logMessage)){let i=l.logMessage+" "+o.getNLSValue("failed");e.is(t)&&(i=i+". "+t.message),n.warn(i,d)}n.notify("stopProgress",R),e.is(u)&&u()},i.webserviceAndProcessing(f,g,l)},getBrokenMfgItemStatus:function(e,t){r.getBrokenMfgItemStatus(e,t)},getPhantomNodeItems:function(){return r.getPhantomNodeItems()},getBIModel:function(e){return r.getBIModel(e)},getCreateMfgItemStatus:function(){return i.getCreateMfgItemStatus()},isCreateMBOMv2:function(){return s.isCreateMBOMv2()}}}}}),define("DS/DELPPWModelBehaviors/ModelBehavior",["UWA/Core"],function(e){"use strict";return{plugins:["DatabasePlugin","ResourcePlugin","AttributePlugin","WebServicePlugin","DicoPlugin","BIPlugin"],creator:function(t,n,i,o,r,a,s,c){var l,u,f,d,g,m,p,P,L,I,S,h;return d=function(t,i,o,r,a){var s=o||{};!0===(!e.is(s.popupMessage)||s.popupMessage)?n.info(i,r):n.log(i,r),e.is(t)&&n.notify("stopProgress",t),e.is(s.onComplete,"function")&&s.onComplete.call(null,i,o,a)},g=function(t,i,o,r,a,s){var c=r||{},l=!e.is(c.popupMessage)||c.popupMessage;e.is(o)&&e.is(o.message,"string")&&(i+="\n"+o.message),!0===l?n.warn(i,a):n.log(i,a),n.notify("stopProgress",t),e.is(c.onFailure,"function")&&c.onFailure.call(null,i,s)},l=function(t,r,a,s,c,l){var u,f,m,P,L,I,S=o.getNLSValue("DeleteObject.Success"),h=o.getNLSValue("DeleteObject.Failure"),C=o.getNLSValue("DeleteObject.PatialFailure"),y=[],D=t?"Instance":"Reference",R={};if(a&&!0===a.isDetachInstance)p(t,r,a,s,c,l);else if(l=!!e.is(l)&&l,u=function(e,t){L=o.getNLSValue(D,{objectLabel:e.get(s)},"Delete","Success"),n.log(L,P),e.isInstance()&&(m=i.getReferenceModelFromInstance(e)),t(m)},f=function(t,i,r){L=o.getNLSValue(D,{objectLabel:t.get(s)},"Delete","Failure"),e.is(r)&&e.is(r.message,"string")&&(L+="\n"+r.message),n.log(L,P),i()},e.is(r,"array")&&r.length>0){if(n.notify("startProgress",R),P=n.log(o.getNLSValue("DeleteObject.LogMessage")),I=i[t?"deleteInstance":"deleteReference"],!e.is(I,"function"))return void n.debug("delete function not found on database plugin.");r.forEach(function(i){y.push(new Promise(function(o,r){I(i.id,{deep:!!e.is(c)&&c,onComplete:function(){u(i,o),t&&n.notify("instanceDeleted",i.toJSON())},onFailure:function(e,t){f(i,r,t)}})}))}),Promise.allSettled(y).then(function(i){var o=!1,r=0,s=0,c=[];for(r=0;r<i.length;r++)"rejected"!==i[r].state?e.is(i[r].value)&&c.push(i[r].value):s++;0===s?(d(R,S,a,P),o=!0):s===i.length?g(R,h,null,a,P):(g(R,C,null,a,P),o=!0),o&&t&&l&&n.notify("addToAuxiliaryView",[c,{askAddToAuxConfirmation:!l}])})}},P=function(e,t){let n,i,o=Math.ceil(e.length/t),r=[];for(i=0,n=0;i<o;i++,n+=t)r[i]=e.slice(n,n+t);return r},L=function(o,r,a){let s,c;c=function(n){return new e.Promise(function(e){t.getMediator().notify("instanceRemoved",[n]),e()})},(s=function(t){let o={};return o.deletedObjects=t.deleted,new e.Promise(function(t,r){o.onComplete=function(){e.is(a)&&n.notify("stopProgress",a),t()},o.onFailure=function(){e.is(a)&&n.notify("stopProgress",a),r()},i.addToCollections(o)})})(r).then(function(){o.length>0&&c(o)})},I=function(e,t){let n=new Map;n.set(!0,[]),n.set(!1,[]);for(let i=0;i<e.length;i++){const o=t(e[i]),r=e[i];n.set(o,n.get(o).concat(r))}return n},S=function(e){let t=new Set;for(let n=0;n<e.length;n++)if("fullfilled"===e[n].state){let i=e[n].value.deleted;for(let e=0;e<i.length;e++)t.add(i[e])}return t},p=function(t,r,s,c,l,u){var f,m,p,h,C,y=o.getNLSValue("DeleteObject.Success"),D=o.getNLSValue("DeleteObject.Failure"),R=o.getNLSValue("DeleteObject.PatialFailure"),v=t?"Instance":"Reference",A={},V=new Set;u=!!e.is(u)&&u,h=function(t){return new e.Promise(function(n,i){let o={url:"dsmfg/private/V0/MfgElement/instance/deleteMultipleInstances",method:"POST",headers:a.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),data:e.Json.encode(t),onComplete:function(e){n(e)},onFailure:function(){i()}};a.webServiceRequest(o)})},C=function(e,t){let n="";return n=e.length===t.length?"Success":0===e.length?"Failure":"Partial Success"},r.length>0&&(n.notify("startProgress",A),m=n.log(o.getNLSValue("DeleteObject.LogMessage"))),r.forEach(function(e){V.add(e.id)});const E=P(Array.from(V),500).map(e=>h(e));e.Promise.allSettled(E).then(function(e){let a=new Set,l=[],P=!1,h=new Map;a=S(e);const V=(h=I(r,function(e){return a.has(e.id)})).get(!0),E=h.get(!1);L(V,{deleted:Array.from(a)},A);let N=[];for(let e=0;e<V.length;e++)p=o.getNLSValue(v,{objectLabel:V[e].get(c)},"Delete","Success"),n.log(p,m),V[e].isInstance()&&(f=i.getReferenceModelFromInstance(V[e]),l.push(f)),N.push(V[e].toJSON());n.notify("instanceDeleted",N);for(let e=0;e<E.length;e++)p=o.getNLSValue(v,{objectLabel:E[e].get(c)},"Delete","Failure"),n.log(p,m);switch(C(V,r)){case"Success":d(null,y,s,m),P=!0;break;case"Failure":g(A,D,null,s,m);break;case"Partial Success":g(null,R,null,s,m),P=!0;break;default:g(A,D,null,s,m)}P&&t&&u&&n.notify("addToAuxiliaryView",[l,{askAddToAuxConfirmation:!u}])}).catch(function(e){n.log(e),g(A,D,null,s,m)})},m=function(t){var o=t.parent,r=t.child,a=n.getBehavior("MfgProcessBehavior");let{isInstancePossible:c,errorMessage:l}=i.computeIsInstancePossible(o,r);return c&&s.isAKindOf(r,"DELLmiHeaderOperationReference")&&e.is(a)&&(c=a.isInstPossible(t)),{isInstancePossible:c,errorMessage:l}},u=function(t,r){var a,s,c,l={},u={},f=!1,m=!1;return r=r||{},e.is(r.securityContextOverride,"string")&&(c=r.securityContextOverride,delete r.securityContextOverride),e.is(r.silent,"boolean")&&(f=r.silent,delete r.silent),e.is(r.isBLToBecalled,"boolean")&&(m=r.isBLToBecalled),e.is(t)?e.is(t.V_Type)&&e.is(t.type)?(a=n.log(o.getNLSValue("ModelBehavior.CreateReference.LogMessage",{title:t["PLMEntity.V_Name"],type:t.type})),n.notify("startProgress",l),s=i.createReference(t,{onComplete:function(t){var i,s,c,f={transactionUUID:e.is(r.transactionUUID,"string")&&r.transactionUUID.length>0?r.transactionUUID:null,referenceAttrs:t.toJSON(),instanceAttrs:null};r.newRef=t,d(l,o.getNLSValue("ModelBehavior.CreateReference.Success",{name:(i=t,s=o.getNLSValue("AbstractDragAndDropManager.RootNotInIndexUnknownName"),c=null,e.is(i)&&(c=i.get("PLMEntity.V_Name"),e.is(c,"string")&&c.length>0?s=c:(c=i.get("PLMEntity.PLM_ExternalID"),e.is(c,"string")&&c.length>0&&(s=c))),s)}),r,a,f),n.notify("referenceCreated",u)},onFailure:function(t,n){var i={transactionUUID:e.is(r.transactionUUID,"string")&&r.transactionUUID.length>0?r.transactionUUID:null,referenceAttrs:null,instanceAttrs:null};g(l,o.getNLSValue("ModelBehavior.CreateReference.Failure"),n,r,a,i)},securityContextOverride:c,silent:f,isBLToBecalled:m})):n.debug("Type is required to create reference",s):n.debug("data is empty to addReference"),s},f=function(t,r){var a,s,c={},l={},u=!0;if(r=r||{},e.is(r.securityContextOverride,"string")&&(s=r.securityContextOverride,delete r.securityContextOverride),e.is(t))if(e.is(t.isAggregatedBy)){let f=null;e.is(t.isInstanceOf)&&(l={parent:i.getReference(t.isAggregatedBy),child:i.getReference(t.isInstanceOf)},({isInstancePossible:u,errorMessage:f}=m(l))),u?(n.notify("startProgress",c),a=n.log(o.getNLSValue("ModelBehavior.CreateInstance.LogMessage")),i.createInstance(t,{onComplete:function(t){var s=i.getReferenceModelFromInstance(t),l={transactionUUID:e.is(r.transactionUUID,"string")&&r.transactionUUID.length>0?r.transactionUUID:null,referenceAttrs:e.is(s)?s.toJSON():null,instanceAttrs:e.is(t)?t.toJSON():null};r.newInst=t,d(c,o.getNLSValue("ModelBehavior.CreateInstance.Success",{name:t.get("PLMInstance.PLM_ExternalID")}),r,a,l),n.notify("instanceCreated",t.toJSON())},onFailure:function(t,n){var i={transactionUUID:e.is(r.transactionUUID,"string")&&r.transactionUUID.length>0?r.transactionUUID:null,referenceAttrs:null,instanceAttrs:null};g(c,o.getNLSValue("ModelBehavior.CreateInstance.Failure"),n,r,a,i)},securityContextOverride:s})):(n.debug("Instance object cannot be created between two selected Types"),n.warn(f))}else n.debug("isAggregatedBy required to create instance");else n.debug("data is empty to createInstance")},h=function(e,t,n){a.webServiceRequest({url:"dsmfg/private/V0/MfgElement/reference/type",method:"POST",data:JSON.stringify(e),onFailure:n,onTimeout:n,onCancel:n,onComplete:e=>{t(e)}})},{onStart:function(){},onStop:function(){},moveInstance:function(t){var r,s,l,u=t||{},f=null,m=null,p={},P=widget.getBool("oneDelmiaAggregationMode"),L=o.getNLSValue("ModelBehavior.ReparentInstances"),I=o.getNLSValue("ModelBehavior.ReparentInstances.Success"),S=o.getNLSValue("ModelBehavior.ReparentInstances.Failure"),h=a.getServerConfigurationRawXML("DELWebMfgAssetsLinkAuthoring.xml");r=function(t){var o,r={formerParentsPIDArray:f.formerInstancesParentPIDs,movedInstPIDArray:f.instancesPIDsToReparent,newParentPID:f.newParentPID,newInstPIDArray:[]},a=[],s={stackedObjects:{stackedReferences:[],stackedInstances:[],stackedConnections:[],deletedObjects:[]},silentOpt:!0,onComplete:function(t){var o,s=n.getPreferenceValue("refreshBIOnAuthoring");for(o of(s=!!e.is(s,"boolean")&&s,r.newInstPIDArray=t.instancePIDs.slice(),r.newInstPIDArray))i.manageLinearProductFlowsOnCreateInstancePID(o);n.notify("reparentInstances",r),a.length>0&&n.notify("instanceRemoved",[a]),s&&c.getBICmdState()&&c.computeBI(),d(p,I,u,m),n.notify("reparentEnd",f.newParentPID)}};for(o of f.instancesPIDsToReparent)i.manageLinearProductFlowsOnDeleteInstancePID(o);e.is(t.deletedObjects)&&t.deletedObjects.forEach(function(t){var n=i.getInstance(t);e.is(n)&&a.push(n)}),i.parseServerObjects(t,s)},s=function(e,t){u.popupMessage=!0,n.notify("reparentEnd",f.newParentPID),g(p,S,t,u,m)},m=n.log(L),n.notify("startProgress",p),f={oneDelmiaAggregationMode:P,instancesPIDsToReparent:e.is(u.instancesPIDsToReparent)?u.instancesPIDsToReparent:[],formerInstancesParentPIDs:e.is(u.formerInstancesParentPIDs)?u.formerInstancesParentPIDs:[],newParentPID:e.is(u.newParentPID)?u.newParentPID:"",newParentInstancesOrder:e.is(u.newParentInstancesOrder)?u.newParentInstancesOrder:[]},e.is(h,"string")&&(f.xmlLinkAuthoringConfig=h),l={url:"dsmfg/private/V0/invoke/reparent",method:"POST",headers:a.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),onComplete:r,onFailure:s,data:e.Json.encode(f)},n.notify("reparentBegin",f.newParentPID),n.debug("Reparent instance ("+f.instancesPIDsToReparent.reduce(function(e,t,n){return e+(0===n?"":", ")+t+"#"+i.getInstance(t).get("PLMInstance.PLM_ExternalID")},"")+"), formerly under reference ("+f.formerInstancesParentPIDs.reduce(function(e,t,n){return e+(0===n?"":", ")+t+"#"+i.getReference(t).get("PLMEntity.V_Name")},"")+"), under new reference ("+f.newParentPID+"#"+i.getReference(f.newParentPID).get("PLMEntity.V_Name")+")"),a.webServiceRequest(l)},moveMultipleInstances:function(t,i,r){var a=this;return new Promise(function(n,i){var o=e.merge({onComplete:n,onFailure:i,popupMessage:!1},t);a.moveInstance(o)}).then(function(){var e=o.getNLSValue("ModelBehavior.MoveInstances.Success",{instanceLabel:r,newParentLabel:i});return n.info(e),Promise.resolve(e)})},createRefOrInst:function(t,i,o){var r,a={};if(o=o||{},e.is(t)){for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(a[r]=t[r]);s.isAKindOf(a.type,"MBOMContinuousPhaseReference")&&delete a["DELFmiMagnitudeExt.V_DimensionType"],e.is(i,"string")?(a.isAggregatedBy=i,s.isAKindOf(a.type,"DELLmiHeaderOperationReference")&&(a.isAutoCreateScopeOnHOP=s.isAutoCreateScopeOnHOP()),f(a,o)):u(a,o)}else n.debug("createRefOrInst: No data to insert")},createMultipleInstances:function(e,t,r){var a;return a=e.map(function(e){return function(e){return new Promise(function(t,o){i.getReference(e.referencePID),f({isAggregatedBy:e.targetReferencePID,isInstanceOf:e.referencePID,skipScopeCheck:n.getPreferenceValue("skipVaidationIfScopedCheck")},{onComplete:t,onFailure:o,popupMessage:!1})})}(e)}),Promise.all(a).then(function(){var e=o.getNLSValue("ModelBehavior.CreateInstances.Success",{instanciatedReference:r,referenceName:t});return n.info(e),Promise.resolve(e)}).catch(function(e){return n.warn(e),Promise.reject(e)})},insertInstance:function(t,r){var a,c,l=n.getBehavior("MfgProcessBehavior"),u={onComplete:function(){var e=t.isAggregatedBy,a={parent:i.getReference(e),child:c,targetAbsPath:r};l.isInstPossible(a)?f(t):n.warn(o.getNLSValue("ModelBehavior.InsertInstance.HOP.Error",{refName:t["PLMEntity.V_Name"]}))}};if(s.isAKindOf(t.type,"DELLmiHeaderOperationReference")){let o=n.getBehavior("ProcessImplementBehavior").getPartialScopeLinkType();a=t.isInstanceOf,c=i.getReference(a),i.getConnectionsByModel(c,null,e.merge(u,{relationTypes:[o]}))}else f(t)},deleteReference:function(t,r){var a,s,c,u="PLMEntity.V_Name",f=n.getBehavior("UXFactoryBehavior"),d=o.getNLSValue("Delete.Confirmation.Title");if(e.is(f)){if(r=r||{},e.is(t,"array")&&t.length>0){for(s=o.getNLSValue("DeleteReference.Confirmation.Message"),a=0;a<t.length;a++)if(i.getInstancesFromCollection(t[a].id).length>0){c=o.getNLSValue("Confirmation.DeleteWholeStructure");break}e.is(c)?f.showConfirmation(d,s,{attributes:[u],models:t},function(n,i,o){e.is(n)&&n&&l(!1,t,r,u,o)},{check:c}):f.showConfirmation(d,s,{attributes:[u],models:t},function(n){e.is(n)&&n&&l(!1,t,r,u,!1)})}}else n.debug("uxFactoryBehavior is not available.")},deleteInstance:function(t,i){var r,a,s,c="PLMInstance.PLM_ExternalID",u=n.getBehavior("UXFactoryBehavior"),f=o.getNLSValue("Confirmation.addRefToAuxViewPostDelete");e.is(u)?(i=i||{},r=!e.is(i.askDeleteConfirmation)||i.askDeleteConfirmation,e.is(t,"array")&&t.length>0&&(r?(e.is(i.isDetachInstance)&&i.isDetachInstance?(s=o.getNLSValue("Detach.Confirmation.Title"),a=o.getNLSValue("DetachInstance.Confirmation.Message")):(s=o.getNLSValue("Delete.Confirmation.Title"),a=o.getNLSValue("DeleteInstance.Confirmation.Message")),u.showConfirmation(s,a,{attributes:[c],models:t},function(n,o,r){e.is(n)&&n&&l(!0,t,i,c,!1,r)},{check:f})):l(!0,t,i,c))):n.debug("uxFactoryBehavior is not available.")},fetchRoot:function(e,t){return i.fetchRoot(e,t)},fetchInstancesAndTheirReferences:function(e,t){return i.fetchInstancesAndTheirReferences(e,t)},isNavigateOnDemand:function(){return i.isNavigateOnDemand()},fetchInstance:function(e,t){return i.fetchInstance(e,t)},getReference:function(e){return i.getReference(e)},getReferencesFromArray:function(e){return i.getReferencesFromArray(e)},removeReference:function(e,t){i.removeReference(e,t)},getInstance:function(e){return i.getInstance(e)},getReferenceModelFromInstance:function(e){return i.getReferenceModelFromInstance(e)},getAggregatingReferenceModelFromInstance:function(e){return i.getAggregatingReferenceModelFromInstance(e)},getReferenceIdFromInstance:function(e){return i.getReferenceIdFromInstance(e)},getReferenceId:function(e){var t=e;return this.isInstance(e)&&(t=i.getReferenceIdFromInstance(e)),t},getInstancesFromCollection:function(e,t){return i.getInstancesFromCollection(e,t)},getParentInstancesFromCollection:function(e){return i.getParentInstancesFromCollection(e)},needToQueryForConnections:function(e){return i.needToQueryForConnections(e)},needToQueryForChildren:function(e){return i.needToQueryForChildren(e)},getDescendantsFromServer:function(e,t,n){i.getDescendantsFromServer(e,t,n)},getConnectionsFromServer:function(e,t,n){i.getConnectionsFromServer(e,t,n)},getAllChildrenFromCollection:function(e){return i.getAllChildrenFromCollection(e)},getImpactedConnections:function(t,n,o){var r,a=[];return e.is(t,"array")&&t.forEach(function(t){r=i.getImpacted(t,n,o),e.is(r)&&e.is(r,"array")&&r.length>0&&(a=a.concat(r))}),a},getReferenceModel:function(e){return i.getReferenceModel(e)},isReference:function(t){return e.is(this.getReference(t))},isInstance:function(t){return e.is(this.getInstance(t))},updateModelAttribute:function(t,a,s,c){var l,u,f,m,p,P,L,I,S,h,C,y,D,R,v,A,V,E,N,b,k,O,T=this,M=[],F=function(t){var n=t,i=function(t){return e.is(t,"string")?r.getFormattedDate(t):r.getFormattedDate(1e3*t)};return r.isDate(y)?n=Array.isArray(t)?t.map(function(e){return i(e)}):i(t):h&&!L&&(n=r.getValueAsString(t,r.getType(y))),n};e.is(a,"array")&&(a=a[0]),a=a||{},c=c||{},e.is(a.instOrRef)&&e.is(a.dataIndex)&&e.is(a.attributeInfo)&&e.is(a.objectToBeModified)&&e.is(a.attributeName)?(R=a.attributeName,y=a.attributeInfo,D=e.is(a.attributeDef)?a.attributeDef:{},p=r.getNLS(y),v=a.objectToBeModified,a.dataIndex,P="instance"===a.instOrRef,L=r.hasRangeDefined(y,D),I=r.isString(y),S=r.isInteger(y),h=r.isDouble(y),C=r.isMultiValuated(y),m=v.get(R),e.is(m)&&"NULL"!==m||(m=""),L&&!C&&(I||S||h)&&(m=r.getAuthorizedValue(y,D,m)),V=function(e,t,i,r){var a,s=F(i),c=F(t),l=n.getBehavior("UXFactoryBehavior"),u=l.getComponent("Button"),f=l.createElement("div",{class:"confirmation-dialog-content-container"}),d=l.createElement("div",{text:o.getNLSValue("UpdateAttributeUI.NotUptoDate")}),g=l.createElement("div"),m=l.createElement("div",{text:o.getNLSValue("UpdateAttributeUI.NewValue")}),P=l.createElement("div"),L=l.createElement("div",{text:o.getNLSValue("UpdateAttributeUI.DoYouWantToUpdate")});d.inject(f),g.textContent=s,g.inject(f),m.inject(f),P.textContent=c,P.inject(f),L.inject(f),(a=l.create("Dialog",{title:o.getNLSValue("UpdateAttributeUI.Header",{attributeName:p}),domId:"EditAttributeUI-Dialog",content:f,resizableFlag:!0,modalFlag:!0,buttons:{No:new u({onClick:function(){i===t&&A(e,r,i),a.close()}}),Yes:new u({disabled:!1,onClick:function(){A(e,t,i),a.close()}})}})).close=function(){this.destroy(),a=null}},E=function(t){var i=!1,l=s;return e.is(t)&&(f=t.get(R),L&&!C&&(I||S)&&(f=r.getAuthorizedValue(y,D,f)),r.isDate(y)&&!r.isMultiValuated(y)?(f=(f=new Date(f).getTime()/1e3).toString(),l=s=l.toString()):h&&r.hasMagnitude(y)&&!C&&(f=parseFloat(f),"AsRequired"===l?s=l:(l=parseFloat(l),s=l.toString())),(f=isNaN(f)&&"AsRequired"===l?l:f)!==l?r.doesAttributeExist(t,R)||r.isAttrApplicableForType(t,R)||r.isAttributeInProtectedList(R)?i=!0:n.warn(o.getNLSValue("TableView.AvailabilityFailure",{key:p})):c.noChange.call(null,a)),i},e.is(t,"array")?t.forEach(function(e){l=P?T.getInstance(e):T.getReference(e),E(l)&&M.push(l.get("PID"))}):E(v)&&M.push(v.id),0!==M.length&&(1===M.length?(A=function(t,a,s){var l,f={previous:{}},m={},L={};f[R]=a,l=P?T.getInstance(t):T.getReference(t),r.doesAttributeExist(l,R)&&(f.previous[R]=s),u={data:f,onFailure:function(e,t){g(L,o.getNLSValue("TableView.SingleUpdateFailure",{key:p,value:F(a)}),t,c)},onComplete:function(i,r){var l;l="AsRequired"===a?a:i.get(R),e.is(r)&&e.is(r.isInSync)&&!r.isInSync?(g(L,o.getNLSValue("TableView.UpdateWarning",{key:p})),V(t,a,l,s)):e.is(i._changed.modified)?(l="AsRequired"===l?l:F(l),"Rich Text"===p?c.onUpdateSuccess.call(null,L,i,r):d(L,o.getNLSValue("TableView.SingleUpdateSuccess",{key:p,value:l}),c),e.is(c.onSuccess)&&c.onSuccess(),n.notify("editAttribute",m)):(a="AsRequired"===a?a:F(a),"Rich Text"===p?c.onUpdateFailure.call(null,L,i,r):g(L,o.getNLSValue("TableView.SingleUpdateFailure",{key:p,value:a}),r,c))},logMessage:o.getNLSValue("TableView.SingleUpdateLogMessage")},n.notify("startProgress",L),!0===P?i.updateInstance(t,u):i.updateReference(t,u)})(M[0],s,m):M.length>1&&(b=s,k={},O={},(N=M).forEach(function(e){k[e]={[R]:b}}),u={data:k,onFailure:function(e){g(O,o.getNLSValue("TableView.MassUpdateFailure",{key:p,value:F(b)}),e,c)},onComplete:function(e){e.length!==N.length?g(O,o.getNLSValue("TableView.UpdateWarning",{key:p})):(d(O,o.getNLSValue("TableView.MassUpdateSuccess",{key:p,value:F(b)}),c),n.notify("editAttribute",{}))},logMessage:o.getNLSValue("TableView.MassUpdateLogMessage")},n.notify("startProgress",O),!0===P?i.updateInstances(R,u):i.updateReferences(R,u)))):n.debug("Required attribute information is missing to update the model attribute")},getValidChildTypes:function(e){return i.getValidChildTypes(e)},computeIsInstancePossible:function(e){return m(e)},isMovePossible:function(t,n){var o,r=!1;return i.isWorkInstruction(n)?r=!1:n&&n.get("isAggregatedBy")!==t.id&&(o=this.getReferenceModelFromInstance(n).get("PPRTYPE"),e.is(o)&&(r=s.isReparentPossible(o))),r},isAKindOf:function(e,t){return s.isAKindOf(e,t)},getTypeHierarchy:function(e){return s.getTypeHierarchy(e)},getAttributeInfo:function(e){return s.getAttributeInfo(e)},fetchDicoAttributeInfo:function(e,t,n){s.fetchDicoAttributeInfo(e,t,n)},getPPRType:function(e){return i.getPPRType(e)},getPPRTypeFromType:function(e){return s.getPPRType(e)},getParentTypes:function(e){return s.getParentTypes(e)},getReadOnlyTypes:function(){return s.getReadOnlyTypes()},isReferencesHasReadOnlyType:function(e){return s.isReferencesHasReadOnlyType(e)},getMajorRevisions:function(t,r,s){var c,l,u,f=i.getReferenceModel(t).get("PLMEntity.V_Name");l=function(e,t,i){n.debug("jsonData: "+e+" error:"+t+" options: "+i),c=o.getNLSValue("Error.GetMajorRevisionFailure.Title",{objectName:f}),s(c)},u=function(e){r(e)},a.webServiceRequest({url:"dsmfg/private/V0/invoke/getMajorRevisions",method:"POST",data:e.Json.encode({pid:t}),onFailure:l,onTimeout:l,onCancel:l,onComplete:u})},isReadOnly:function(t,i,r,s){var c,l,u;l=function(e,t,i){n.debug("jsonData: "+e+" error:"+t+" options: "+i),s()},u=function(t){e.is(t.isReadOnly)&&t.isReadOnly&&(c=o.getNLSValue("Error.ObjNotInReadWrite.Title",{objectName:i})),r(c)},a.webServiceRequest({url:"dsmfg/private/V0/invoke/isReadOnly",method:"GET",data:{pid:t},onFailure:l,onTimeout:l,onCancel:l,onComplete:u})},isLatestRevision:function(t,i,r,s){var c,l,u;l=function(e,t,i){n.debug("jsonData: "+e+" error:"+t+" options: "+i),s()},u=function(t){e.is(t.isLatestRevision)&&!t.isLatestRevision&&(c=o.getNLSValue("Error.ObjNotLatestRevision.Title",{objectName:i})),r(c)},a.webServiceRequest({url:"dsmfg/private/V0/invoke/isLatestRevision",method:"GET",data:{pid:t},onFailure:l,onTimeout:l,onCancel:l,onComplete:u})},getWhereUsedReferences:function(e,t){i.getWhereUsedReferences(e,t)},getTenant:function(){return a.getTenant()},getSecurityContext:function(){return a.getSecurityContext()},getTypeProxy:function(e,t,n){return h(e,t,n)},get3DSpaceUrl:function(){return a.get3DSpaceUrl()},isEntityInstance:function(e){return s.isEntityInstance(e)},getAcceptedBaseTypesForCreation:function(){var t=[],n=s.getAcceptedBaseTypesForActions();return e.is(n)&&e.is(n.CREATION,"array")&&(t=n.CREATION),t},getFilteredInstancesFromCollection:function(e,t){return i.getFilteredInstancesFromCollection(e,t)},transformToRIROccurrencePath:function(e){return i.transformToRIROccurrencePath(e)},transformRIRToAbsolutePath:function(e){return i.transformRIRToAbsolutePath(e)},isOperation:function(e){return i.isOperation(e)},isSystem:function(e){return i.isSystem(e)},webServiceGETRequest:function(e,t,n,i){a.webServiceRequest({url:this.get3DSpaceUrl()+e,method:t,onFailure:i,onTimeout:i,onCancel:i,onComplete:n})}}}}}),define("DS/DELPPWModelBehaviors/ProcessImplementBehavior",["UWA/Core","UWA/Class/Promise","DS/DELPPWModelBehaviors/ImplementBehaviorBase","DS/DELPPWModelBehaviors/SpecifyScopeIntentDialog","text!DS/DELPPWModelBehaviors/assets/json/NonModelAttributeInfo.json"],function(e,t,n,i,o){"use strict";return{plugins:["DatabasePlugin","AttributePlugin","ResourcePlugin","ProcessImplementPlugin","MfgItemPlugin","DicoPlugin","WebServicePlugin"],creator:function(t,i,r,a,s,c,l,u,f){let d=new n(t,i,r,a,s,c,l,u,f);return e.extend(d,{onStart:function(){var t=e.Json.decode(o);for(let e in t)"MfgProductionPlanning.V_usage"===e?t[e].NLS=s.getNLSValue("ImplementBehavior.ImplementLink.Role"):"MfgProductionPlanning.V_DimensionType"===e&&(t[e].NLS=s.getNLSValue("ImplementBehavior.ImplementLink.DimensionType"));a.addAttributeInfo(t),u.addTypeExtnCustomInterface("ProcessImplementLinkOcc","MfgProductionPlanning")},isImplementLinkValidForOccPath:function(e,t,n){return c.isImplementLinkValidForOccPath(e,t,n)},getRoleFromModelOrComputed:function(e){return c.getRoleFromModelOrComputed(e)},getOotbRoleFromCustoRole:function(e){return c.getOotbRoleFromCustoRole(e)},getCustoRoleFromNLS:function(e){return c.getCustoRoleFromNLS(e)},getQuantityFromModel:function(e){return c.getQuantityFromModel(e)},getConnectedObjects:function(t,n,i,o){var r=[];return e.is(c.getConnectedObjects)&&(r=c.getConnectedObjects(t,n,i,o)),r}})}}}),define("DS/DELPPWModelBehaviors/AssignProductBehavior",["UWA/Core","DS/DELPPWModelBehaviors/SpecifyScopeIntentDialog"],function(e,t){"use strict";return{plugins:["DatabasePlugin","ResourcePlugin","WebServicePlugin","ProductImplementPlugin","AttributePlugin","DicoPlugin"],creator:function(n,i,o,r,a,s,c,l){var u,f,d,g,m,p;return u=function(t,n,r,s,c){var l,u,f,d,g=0,m=0,p={instancesAndReferences:[],connections:[]},P=a.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),L=a.getServerConfigurationRawXML("DELWebMfgAssetsLinkAuthoring.xml");c=c||{},e.is(c.securityContextOverride,"string")&&(P.SecurityContext=c.securityContextOverride),f=function(t,n){e.is(c.onFailure,"function")&&c.onFailure(n)},u=function(t){var r=o.getConnectionParser(),a={stackedReferences:[],stackedInstances:[],stackedConnections:[]},s={queriedForConnections:!0},l={queriedForChildren:!0,queriedForConnections:!0,queriedForDocuments:!1};e.is(t)&&(e.is(t.instancesAndReferences)&&t.instancesAndReferences.forEach(function(t){var n,i,o=t.attributesValue;Object.prototype.hasOwnProperty.call(o,"isInstanceOf")?(n=e.merge(o,s),a.stackedInstances.push(n),e.is(t["to.attributesValue"])&&(i=e.merge(t["to.attributesValue"],l),a.stackedReferences.push(i))):(i=e.merge(o,l),a.stackedReferences.push(i))}),e.is(t.connections)&&t.connections.forEach(function(e){r.parse(e,a)}),a.onComplete=function(o){var r=[];(!e.is(o.instancesAndReferences)||o.connections.length<2/*!UWA.is(scopeConnModel) || !UWA.is(implConnModel)*/)&&i.debug("Instance or scope or implement model is empty for instance PID:"+t.instancesAndReferences[0].attributesValue.PID),o.instancesAndReferences.forEach(function(e){e.isInstance()&&r.push(e)}),i.notify("instanceAdded",r),o.instancesAndReferences.forEach(function(e){"PROCESS"===e.toJSON().PPRTYPE&&p.instancesAndReferences.push(e.toJSON())}),o.connections.forEach(function(e){p.connections.push(e.toJSON())}),i.notify("connectionAdded",[o.connections]),m++,n.length===m&&(e.is(c.onComplete,"function")&&c.onComplete(o),i.notify("assignProduct",p))},o.addToCollections(a))},d={processID:t},e.is(L,"string")&&(d.xmlLinkAuthoringConfig=L),n.forEach(function(t){var n=e.clone(d),i=e.clone(s[g]);l=o.getReferenceModel(t),n.productPath=e.Json.encode(r[g]),n.productRefPID=l.get("PID"),n.type=i.V_Type,n.attributes=i,Object.prototype.hasOwnProperty.call(i,"PLMEntity.V_Name")||(i["PLMEntity.V_Name"]=l.get("PLMEntity.V_Name")),a.webServiceRequest({url:"dsmfg/private/V0/invoke/assignproduct",method:"POST",headers:P,context:this,data:e.Json.encode(n),onComplete:u,onFailure:f,onTimeout:f,onCancel:f}),g++},this)},f=function(t,n,i,o){return new Promise(function(r,s){var c,l=a.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),u=o||{},f=a.getServerConfigurationRawXML("DELWebMfgAssetsLinkAuthoring.xml");e.is(u.securityContextOverride,"string")&&(l.SecurityContext=u.securityContextOverride),c={productID:n,processType:i.V_Type,processData:i},e.is(f,"string")&&(c.xmlLinkAuthoringConfig=f),a.webServiceRequest({url:t,method:"POST",headers:l,data:e.Json.encode(c),onFailure:function(e,t){s(t)},onTimeout:s,onComplete:r})})},d=function(t,n,r,a,s,c){var l=function(t){return new Promise(function(n,i){var r=o.getConnectionParser(),a={silentMode:!0,stackedReferences:[],stackedInstances:[],stackedConnections:[],onComplete:function(e){n(e)}};e.is(t)&&e.is(t.instancesAndReferences)&&e.is(t.connections)?(a.stackedReferences=t.instancesAndReferences.map(function(t){return e.merge(t,{queriedForChildren:!0,queriedForConnections:!0,queriedForDocuments:!0})}),t.connections.forEach(function(e){r.parse(e,a)}),o.addToCollections(a)):i()})};return new Promise(function(u,d){var g=[],m={};Array.isArray(t)&&Array.isArray(n)&&(i.notify("startProgress",m),g=t.map(function(t,i){return new Promise(function(u,d){var g=e.clone(n[i]),m=o.getReferenceModel(t),p=m.get("PLMEntity.V_Name"),P=m.get("PID");e.is(g["PLMEntity.V_Name"])||(g["PLMEntity.V_Name"]=p),f(r,P,g,c).then(l).then(function(e){a(e,g,p),u(e)}).catch(function(e){s(p,e),d()})})}),Promise.allSettled(g).then(function(e){var t,n=function(e){return e.value};t=e.some(function(e){return"rejected"===e.state})?e.filter(function(e){return"fulfilled"===e.state}).map(n):e.map(n),i.notify("stopProgress",m),t.length>0?u(t):d()}).catch(function(){i.notify("stopProgress",m),d()}))})},g=function(t,n,o,a){var s;a=a||{},i.notify("stopProgress",n),s=r.getNLSValue("AssignProdBehavior.ErrorLinkCreation.Title"),i.warn(s,t),i.debug("AssignProdBehavior.ErrorLinkCreation.Title. ERROR during product assign: "+o),e.is(a.onFailure,"function")&&a.onFailure(s,o)},m=function(e,t,n,o,a,s){i.info(r.getNLSValue(n,{processName:o["PLMEntity.V_Name"],productName:a}),s),i.notify(e,t)},p=function(t,n,s,c,u,f,d){var g=t.instancesAndReferences[2],p=t.instancesAndReferences[0].get("PID"),P=a.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0});e.is(f.securityContextOverride,"string")&&(P.SecurityContext=f.securityContextOverride),o.getCurrentStates([p],P,function(t){var a=[],f=widget.getValue("fromXen"),L="createMfgItemAndResultingProduct"===u?"createMfgItemAndResultingProductLink.Success":"createMfgItemAndScope"===u?"CreateMfgItemAndScope.Success":"";e.is(t)&&"RELEASED"===t.get(p)&&(l.isAKindOf(g.get("type"),"Provide")||l.isAKindOf(g.get("type"),"DELServicePartReference"))?((widget.getValue("isReleaseMaturitySynced")||!0===f&&i.getPreferenceValue("isReleaseSyncXENEnabled"))&&a.push(new Promise(function(e,t){o.syncMaturity([g],P,widget.getValue("isChangeRequiredSynced")||f&&i.getPreferenceValue("isReleaseSyncXENEnabled"),e,t)})),Promise.all(a).then(function(t){var a=[];a.onComplete=function(t){e.is(t,"array")&&(t=t[0]),g.set("current",t.get("current")),i.notify("referenceAdded",g),m(u,c,L,n,s,d)},a.onFailure=function(){g.set("current",t.results[0].maturityState),i.notify("referenceAdded",g),i.warn(r.getNLSValue("MaturitySync.UIChangeFailed")),i.notify(u,c)},a.forceDBMode=!0,o.fetchRoot(g.get("PID"),a)}).catch(function(){i.warn(r.getNLSValue("MaturitySync.changeStateFailed")),i.notify("referenceAdded",g),m(u,c,L,n,s,d)})):(null===t&&i.warn(r.getNLSValue("MaturitySync.retrieveCurrentStateFailed")),i.notify("referenceAdded",g),m(u,c,L,n,s,d))})},{unassignProduct:function(t,n){var o,a,c,l=[],u=[],f=[],d={};o={onComplete:function(){i.notify("stopProgress",d),e.is(n)&&e.is(n.onComplete)?n.onComplete():i.info(r.getNLSValue("UnassignProduct.DeleteSuccess"))},onFailure:function(t){i.notify("stopProgress",d),e.is(n)&&e.is(n.onFailure)?n.onFailure():i.warn(t)}},e.is(n)&&(o=e.merge(o,n)),e.is(t,"array")&&0!==t.length&&(i.notify("startProgress",d),t.forEach(function(t){l.push(new Promise(function(n,i){a=s.getImplLinksOfImplementing(t),e.is(a)&&a.length>0&&(a.forEach(function(e){var t=e.get("PID");f.push(new Promise(function(e,n){s.deleteImplementLink(t,{onComplete:e,onFailure:n})}))}),Promise.allSettled(f).then(function(){c=s.getScopeLinksOfImplementing(t),e.is(c)&&c.length>0&&c.forEach(function(e){var t=e.get("PID");u.push(new Promise(function(e,n){s.deleteScopeLink(t,{onComplete:e,onFailure:n})}))}),Promise.allSettled(u).then(function(){n()},function(){i()})},function(){i()}))}))}),Promise.allSettled(l).then(function(){o.onComplete()},function(e){var t=0,n=0;for(t=0;t<e.length;t++)"rejected"===e[t].state&&n++;n===e.length?o.onFailure(r.getNLSValue("UnassignProduct.DeleteFailure")):o.onFailure(r.getNLSValue("UnassignProduct.PatialFailure"))}))},assignProduct:function(n){var a,c,f,d,m,p,P,L,I,S,h,C,y,D,R,v,A,V,E=[],N=[],b=[],k=[],O=[],T=[],M=[],F={},w={},x=new t(i.getBehavior("UXFactoryBehavior"),r);let B;if(C=function(t,n,o,a){const c=r.getNLSValue("ImplementBehavior.Consumption.LogMessage"),l=r.getNLSValue("ImplementBehavior.Consumption.Success"),u=r.getNLSValue("ImplementBehavior.Consumption.Failed"),f=i.log(c);s.consumeReferenceWithScopeLink(t,n.prodPID,n.mfgPID,n.mfgInstPID,{}).then(t=>{if(e.is(t)){if(e.is(t.instancesAndReferences,"array")){const e=[];t.instancesAndReferences.forEach(t=>{t.isInstance()&&e.push(t)}),i.notify("instanceAdded",e)}e.is(t.connections,"array")&&i.notify("connectionAdded",[t.connections]),i.info(l,f)}o()}).catch(()=>{i.warn(u,f),a()})},y=function(){i.info(r.getNLSValue("Success.ProductAssigned.Title",{mfgItem:h}),I),i.notify("stopProgress",F),e.is(n.onComplete,"function")&&n.onComplete()},D=function(e,t){g(I,F,t,n)},e.is(n)&&(R=n.securityContextOverride,f=n.mbomReferenceId,a=n.mbomInstanceId,c=n.bodyInstanceIds,P=n.bodyAbsolutePaths,m=n.mbomAbsolutePaths[0],L=n.isInstancePossible,d=e.is(n.newMfgAttributes)?n.newMfgAttributes:{V_Type:"DELAsmAssemblyModelDisciplines/Provide"}),e.is(m,"array")&&m.length>0)B=s.isUnderScope(m);else{const t=s.getScopeLinks(f);B=e.is(t,"array")&&t.length>0,m=f}for(p=0;p<P.length;p++)if(s.validateIfScoped(m,P[p]))N.push(P[p]),b.push(c[p]),k.push(d[p]);else{if(!i.getPreferenceValue("skipVaidationIfScopedCheck")||!B)return void i.warn(r.getNLSValue("AssignProdBehavior.NotScoped.Title"));O.push(P[p]),T.push(c[p]),M.push(d[p])}e.is(f,"array")&&f.length>0&&(f=f[0]),i.notify("startProgress",F),S=o.getReferenceModel(f),h=e.is(S)?S.get("PLMEntity.V_Name"):"";const U=[];if(O.length>0)for(p=0;p<O.length;p++){const e={prodPID:o.getReferenceModel(T[p]).get("PID"),mfgPID:f,mfgInstPID:a},t=function(){Promise.resolve()},n=function(){C("ManufacturingAssembly",e,Promise.resolve,Promise.reject)},s=function(){C("ManufacturingMadeFrom",e,Promise.resolve,Promise.reject)};if(l.isAKindOf(S.get("type"),"CreateAssembly")||l.isAKindOf(S.get("type"),"CreateKit"))x.show(t,n,"");else{if(!(l.isAKindOf(S.get("type"),"CreateMaterial")||l.isAKindOf(S.get("type"),"ElementaryEndItem")||l.isAKindOf(S.get("type"),"Provide")))return i.warn(r.getNLSValue("AssignProdBehavior.DiffEBOM.NotSupportedType")),void i.notify("stopProgress",F);x.show(t,n,s)}}if(0===N.length)return void Promise.all(U).then(y).catch(D);for(p=0;p<N.length;p++)E.push(s.getPathToScope(N[p]));I=i.log(r.getNLSValue("ProductAssign.LogMessage",{mfgItem:h})),w.securityContextOverride=R,w.onComplete=(()=>{U.length>0?Promise.all(U).then(y).catch(D):y()}),w.onFailure=((e,t)=>{U.length>0?Promise.all(U).then(()=>D(0,t)).catch(()=>D(0,t)):D(0,t)});let _=!1;if(e.is(n.newMfgAttributes)&&e.is(n.newMfgAttributes[0])&&e.is(n.newMfgAttributes[0].type)&&(_=n.newMfgAttributes[0].type.contains("DELServiceSpareItemReference")),i.getPreferenceValue("insertSpareItemOnAssign")&&_){const t=o.getInstance(P[0][0]).get("isAggregatedBy");let n;n=e.is(m,"array")?o.getInstance(m[0]).get("isAggregatedBy"):m,A=e.is(a)?o.getReferenceIdFromInstance(a):n,w.computeResultReport=!0,w.insertSpareItemOnAssign=!0,s.consumeImplementedItems(t,E,n,A,w)}else!0===L?u(f,b,E,k,w):(A=o.getReferenceIdFromInstance(a),v=E[0],V=o.getReferenceIdFromInstance(v[v.length-1]),s.createScopeAndImplementLink(A,a,V,v,w))},createMfgItemAndScopeLink:function(t,n,o,s){var c,l=s||{},u=e.is(l.onComplete,"function")?l.onComplete:null,f=e.is(l.onFailure,"function")?l.onFailure:null;c=i.log(o),d(t,n,"dsmfg/private/V0/invoke/createMfgItemAndScope",function(t,n,o){var r={},s=t.instancesAndReferences[2],u=a.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0});e.is(l.securityContextOverride,"string")&&(u.SecurityContext=l.securityContextOverride),e.is(t)&&Array.isArray(t.instancesAndReferences)?p(t,n,o,r,"createMfgItemAndResultingProduct",l,c):(i.notify("referenceAdded",s),m("createMfgItemAndScope",r,"CreateMfgItemAndScope.Success",n,o,c))},function(t,n){e.is(n)&&e.is(n.message,"string")&&n.message.length>0?i.warn(r.getNLSValue("CreateMfgItemAndScope.FailureWithMessage",{productName:t,message:n.message}),c):i.warn(r.getNLSValue("CreateMfgItemAndScope.Failure",{productName:t}),c)},l).then(function(t){var n=t.map(function(e){return{toObject:e.instancesAndReferences[0],fromObject:e.instancesAndReferences[1],createdObject:e.instancesAndReferences[2]}});e.is(u,"function")&&u(n)}).catch(function(){e.is(f,"function")&&f()})},createMfgItemAndResultingProductLink:function(t,n,o,a){var s,c=a||{},l=e.is(c.onComplete,"function")?c.onComplete:null,u=e.is(c.onFailure,"function")?c.onFailure:null;s=i.log(o),d(t,n,"dsmfg/private/V0/invoke/createMfgItemAndResultingProduct",function(t,n,i){var o={};e.is(t)&&Array.isArray(t.instancesAndReferences)?p(t,n,i,o,"createMfgItemAndResultingProduct","ResultingProduct",c):m("createMfgItemAndResultingProduct",o,"createMfgItemAndResultingProductLink.Success",n,i,s)},function(t,n){e.is(n)&&e.is(n.message,"string")&&n.message.length>0?i.warn(r.getNLSValue("createMfgItemAndResultingProductLink.FailureWithMessage",{productName:t,message:n.message}),s):i.warn(r.getNLSValue("createMfgItemAndResultingProductLink.Failure",{productName:t}),s)},c).then(function(t){var n=t.map(function(e){return{toObject:e.instancesAndReferences[0],fromObject:e.instancesAndReferences[1],createdObject:e.instancesAndReferences[2]}});e.is(l,"function")&&l(n)}).catch(function(){e.is(u,"function")&&u()})}}}}}),define("DS/DELPPWModelBehaviors/ProductImplementBehavior",["UWA/Core","UWA/Class/Promise","DS/DELPPWModelBehaviors/ImplementBehaviorBase","DS/DELPPWModelBehaviors/SpecifyScopeIntentDialog"],function(e,t,n,i){"use strict";return{plugins:["DatabasePlugin","AttributePlugin","ResourcePlugin","ProductImplementPlugin","MfgItemPlugin","DicoPlugin","WebServicePlugin"],creator:function(o,r,a,s,c,l,u,f,d){var g,m,p,P,L,I,S,h,C,y,D,R,v,A=function(t,n,i,o){var a=e.is(t)?c.getNLSValue(t):n;r.info(a,i),o&&o(a)},V=function(t,n,i,o,a){var s=e.is(t)?c.getNLSValue(t):i;e.is(n,"string")&&n.length>0&&(s=n),r.warn(s,o),a&&a(s)};g=function(t,n,i,s,l){var f,d,g={},m={};f=e.Json.encode({selectedHigherProductID:t,selectedMfgItemID:n,rootMfgItemID:n,reviseMfgItem:i}),(s=e.merge(s,{appenedURL:"ReconnectScopeLink"})).onComplete=function(e,t,n){var i,u;n.connections.length>0&&(i=a.getConnection(n.connections[0].PID),o.getMediator().notify("connectionAdded",[i])),n.instancesAndReferences.length>0&&(u=n.instancesAndReferences.filter(e=>"PRODUCT"===e.attributesValue.PPRTYPE)[0].attributesValue.PID,r.notify("addProductOrPart",{pid:u})),r.info(s.logMessage+" "+c.getNLSValue("completed"),d),r.notify("stopProgress",g),r.notify("reconnectScope",m),l(e,t)},s.onFailure=function(e,t){r.warn(s.logMessage+" "+c.getNLSValue("failed"),d),r.notify("stopProgress",g),l(e,t)},s.onTimeout=function(e,t){r.warn(s.logMessage+" "+c.getNLSValue("timeout"),d),r.notify("stopProgress",g),l(e,t)},r.notify("startProgress",g),e.is(s)&&e.is(s.logMessage)&&(d=r.log(s.logMessage)),u.webserviceAndProcessing("POST",f,s)},m=function(e,t,n,i,o,a){var s,u,f={},d=c.getNLSValue("ImplementBehavior.CreateScope.LogMessage"),g=c.getNLSValue("ImplementBehavior.CreateScope.Success"),m=c.getNLSValue("ImplementBehavior.CreateScope.Failed"),p=r.log(d),P=function(e){A(e,g,p,o),r.notify("createLink",f)},L=function(e,t){V(e,t,m,p,a)};(s=l.canCreateScopeLink({fromSideRefPID:e,toSideRefPID:t,fromSideAbsPath:n,toSideAbsPath:i})).canCreateLink?"ProcessImplementLink"===l.getScopeLinkType()?l.createScopeLink(e,t,{onComplete:P,onFailure:L}):(u=S(n)).hasImplementLink?L(null,c.getNLSValue("ImplementBehavior.Validation.ImplLinkExists",{obj1:u.implementingName,obj2:u.implementedName})):l.createScopeLink(e,t,{onComplete:P,onFailure:L}):L(null,s.errorMessage)},L=function(t,n,i,o){var s,u,d,g,m,p,P,L=[],I=c.getNLSValue("ImplementBehavior.CreateScope.LogMessage"),h=c.getNLSValue("ImplementBehavior.CreateScope.Success"),C=c.getNLSValue("ImplementBehavior.CreateScope.Failed"),y=r.log(I),D=function(t,n){A(t,h,y,i),e.is(n)&&(n.connections.forEach(function(e){L.push(e.toJSON())}),r.notify("createImplementLink",L))},v=function(e,t){V(e,t,C,y,o)};if(e.is(t,"array")&&t.length>0&&e.is(n,"array")&&n.length>0)if(u=t[t.length-1],s=a.getReferenceIdFromInstance(u),g=n[n.length-1],d=a.getReferenceIdFromInstance(g),(P=l.canCreateScopeLink({fromSideRefPID:s,toSideRefPID:d,fromSideInstPID:u,toSideInstPID:g,fromSideAbsPath:t,toSideAbsPath:n})).canCreateLink)if("ProcessImplementLink"===l.getScopeLinkType())l.createScopeLink(s,d,{onComplete:D,onFailure:v});else if(l.validateIfScoped(t,n))(p=S(t,n)).hasImplementLink?p.withSameProduct?l.createScopeLink(s,d,{onComplete:D,onFailure:v}):v(null,c.getNLSValue("ImplementBehavior.Validation.ImplLinkExists",{obj1:p.implementingName,obj2:p.implementedName})):(m=R(t,n),l.createScopeAndImplementLink(s,u,d,m,{onComplete:D,onFailure:v}));else{if(r.getPreferenceValue("skipVaidationIfScopedCheck")&&f.isAKindOf(void 0,"Provide"))return void l.createScopeLink(s,d,{onComplete:D,onFailure:v});v(null,c.getNLSValue("ImplementBehavior.Validation.ScopeNotValid"))}else v(null,P.errorMessage);else r.debug("Input parameters are invalid."),v()},S=function(t,n){var i,o,r,s,c,u,f=!1,d=!1,g=null,m=null;return i=e.is(t,"array")&&t.length>0?l.getImplLinksOfImplementing(t):null,e.is(i,"array")&&i.length>0&&(f=!0,e.is(n)&&(d=i.some(function(t){return e.equals(t.get("to"),n)})),s=(u=i[0]).getAttribute("from"),c=a.getReferenceModel(s),e.is(c)&&(m=c.get("V_Name")),o=u.getAttribute("to"),r=a.getReferenceModel(o),e.is(r)&&(g=r.get("V_Name"))),{hasImplementLink:f,withSameProduct:d,implementingName:m,implementedName:g}},P=function(e,t,n,i,o,a){var s=c.getNLSValue("ImplementBehavior.Consumption.LogMessage"),u=c.getNLSValue("ImplementBehavior.Consumption.Success"),f=c.getNLSValue("ImplementBehavior.Consumption.Failed"),d=r.log(s);l.createScopeAndImplementLink(e,t,n,i,{onComplete:function(){A(null,u,d,o)},onFailure:function(e,t){V(null,t,f,d,a)}})},p=function(t,n,i,o,a,s,u){var f=c.getNLSValue("ImplementBehavior.Consumption.LogMessage"),d=c.getNLSValue("ImplementBehavior.Consumption.Success"),g=c.getNLSValue("ImplementBehavior.Consumption.Failed"),m=r.log(f),p={instancesAndReferences:[],connections:[]},P={};P={computeResultReport:!0,onComplete:function(t,n,i){var o;e.is(n)?(A(t,d,m,a),n.connections.forEach(function(e){p.connections.push(e.toJSON())}),n.instancesAndReferences.forEach(function(e){p.instancesAndReferences.push(e.toJSON())}),r.notify("createStructure",p)):V(t,null,g,m,s),e.is(i)&&e.is(i.resultReport)?(o=r.getBehavior("UXFactoryBehavior"),e.is(o)?o.create("MfgItemCreateReportUI",{title:c.getNLSValue("MfgItemConsumeReportUI.Dialog.Title"),report:i.resultReport,mode:"erroronly_report"}):r.debug("Result report is avialable in response, but uxFactoryBehavior is not avialable")):r.debug("Result report is not avialable in response")},onFailure:function(e,t){V(e,t,g,m,s)}},e.is(u)&&(P.insertSpareItemOnAssign=u),l.consumeImplementedItems(t,n,i,o,P)},I=function(n,i,o,r){var s,c,u;return e.is(n,"array")&&n.length>0&&l.isUnderScope(n)&&e.is(o,"array")&&o.length>0?(c=n,u=o,s=new t(function(e,t){L(c,u,e,t)})):s=function(e,n,i,o){return new t(function(t,r){var s=a.isReference(e)?e:a.getReferenceIdFromInstance(e),c=a.isReference(n)?n:a.getReferenceIdFromInstance(n);m(s,c,i,o,t,r)})}(i,r,n,o),s},y=function(e,n,i,o,r){var a,s,c,l,u;return a=e,s=n,c=i,l=o,u=r,new t(function(e,t){D(a,s,c,l,u,e,t)})},D=function(t,n,i,o,s,u,f){var d,g,m,p,P,L,I,S=[],C=[],y=c.getNLSValue("ImplementBehavior.CreateScope.LogMessage"),D=c.getNLSValue("ImplementBehavior.CreateScope.Success"),v=c.getNLSValue("ImplementBehavior.CreateScope.Failed"),E=r.log(y),N=function(e,t){V(e,t,v,E,f)},b=r.getBehavior("UXFactoryBehavior");const k="CREATE_PARTIALSCOPE"===s,O="STRETCH_PARTIALSCOPE"===s,T="DELETE_PARTIALSCOPE"===s,M="SWITCH_TO_FULLSCOPE"===s;P={onComplete:function(e,t){A(e,D,E,u),t.connections.forEach(function(e){C.push(e.toJSON())}),r.notify("createImplementLink",C)},onFailure:N,cmdAction:s};const F=function(){if(M)P.isSwitchToPartialScopeLink=M;else if(O){P.isStretchPartialScopeLink=O;const t=n[n.length-1];if(Array.isArray(I)){let n=I.indexOf(t);for(n+=1;n<I.length;n++)L=e.is(L)?L+","+I[n]:I[n]}P.targetPrdOccPath=L,P.targetProductID=p,p=l.getPartialScopeLinks(d)[0].get("to")}else if(T){if(P.isDeletePartialScopeLink=T,Array.isArray(I))for(let t=0;t<I.length;t++)L=e.is(L)?L+","+I[t]:I[t];P.targetPrdOccPath=L}k&&(P.isCreatePartialScopeLink=k,S=R(t,n)),l.manageScopeAndImplementLink(d,g,p,S,P)};if(e.is(t,"array")&&t.length>0){if(g=t[t.length-1],d=a.getReferenceIdFromInstance(g),m=a.getReferenceModel(d),!0===l.isScoped(d))return void N(null,c.getNLSValue("ImplementBehavior.Validation.ScopeLinkExists",{objectName:m.get("V_Name")}));if(k&&!0===l.isPartialScoped(d))return void N(null,c.getNLSValue("ImplementBehavior.Validation.PartialScopeLinkExists",{objectName:m.get("V_Name")}));if(O&&!1===l.isPartialScoped(d))return void N(null,c.getNLSValue("ImplementBehavior.Validation.NoPartialScopeLinkExists",{objectName:m.get("V_Name")}));if(e.is(n)&&e.is(n,"array")&&n.length>0){if(p=a.getReferenceIdFromInstance(n[n.length-1]),O){const e=l.getPartialScopeLinks(d)[0].get("to");if(p===e)return void N(null,c.getNLSValue("ImplementBehavior.Validation.StretchPartialScopeToSamePrd"))}}else{p=e.is(i)?i:l.getPartialScopeLinks(d)[0].get("to");const o=h(t);n=o}if(I=h(t),k)F();else if(null===I){if(!T)return void N(null,O?c.getNLSValue("ImplementBehavior.Validation.StretchPartialScopeImplBroken"):c.getNLSValue("ImplementBehavior.Validation.SwtichPartialScopeImplBroken"));b.showConfirmation(c.getNLSValue("Confirmation.AreYouSure"),c.getNLSValue("Confirmation.DeletePartialScopeImplBroken"),null,function(t){e.is(t,"boolean")&&t?F():f()})}else F()}else e.is(i)&&e.is(o)?(d=o,p=e.is(n)&&e.is(n,"array")&&n.length>0?a.getReferenceIdFromInstance(n[n.length-1]):i,g=null,F()):(r.debug("Input parameters are invalid."),N())},R=function(t,n){let i=[];if(!e.is(n))return i;const o=l.getPathToScope(n),r=((t,n)=>{let i=null;const o=l.isUnderPartialScope(t);return e.is(o)&&o&&(i=l.getPathToPartialScope(n)),i})(t,n);return i=o,Array.isArray(r)&&Array.isArray(o)?i=((...e)=>{let t=e[0];const n=e.length;for(let i=1;i<n;i++)e[i].length<t.length&&(t=e[i]);return t})(r,o):Array.isArray(r)&&(i=r),i},h=function(t){var n,i,o,r,s,c=function(t){var n,i=!1;return n=a.getReferenceModel(t),e.is(n)&&"PROCESS"===n.get("PPRTYPE")&&(i=!0),i};if(Array.isArray(t)){if(0===(n=t).length)return null;if(!c(n[n.length-1]))return null;if(!l.isPartialScoped(n))return null;if(l.isUnderPartialScope(n)){s=[],o=n.slice(0);do{if(!l.isPartialScoped(o))break;if(r=l.getImplLinksOfImplementing(o),!e.is(r)||r.length>1||0===r.length){s=null;break}s=r[0].get("to").concat(s),o=C(o)}while(Array.isArray(o))}else if(r=l.getImplLinksOfImplementing(n),e.is(r)){if(1!==r.length)return null;s=r[0].get("to")}else s=[]}else s=c(i=t)&&l.isScoped(i)?[]:null;return s},C=function(t){var n,i,o,r=null;return Array.isArray(t)&&t.length>0&&(o=l.findInstanceWhoseParentIsPartialScoped(t),e.is(o)&&(0===o.absPathIndex?i=o.instanceModel.get("isAggregatedBy"):n=t.slice(0,o.absPathIndex))),e.is(n)?r=n:e.is(i)&&(r=i),r},v=function(n,i){const o=a.isReference(n)?n:a.getReferenceIdFromInstance(n),s=a.isReference(i)?i:a.getReferenceIdFromInstance(i);return u={IDFrom:o,IDTo:s,type:l.getScopeLinkType()},new t(function(t,n){const i={url:"dsmfg/private/V0/MfgElement/connection/validateBrokenScope",method:"POST",headers:d.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),data:e.Json.encode(u),onComplete:function(i){const a=!!e.is(i.isScopeLinkBroken,"boolean")&&i.isScopeLinkBroken;if(a){const e=r.getBehavior("UXFactoryBehavior"),i=c.getNLSValue("BrokenScope.Confirmation.Title"),l=c.getNLSValue("BrokenScope.Reason.Text"),u=function(e){e?t({isScopeLinkBroken:a,implementedRefId:s,implementingRefId:o}):n()};e.showConfirmation(i,l,null,u)}else t({isScopeLinkBroken:a,implementedRefId:s,implementingRefId:o})},onFailure:function(){n()}};d.webServiceRequest(i)});var u};let E=new n(o,r,a,s,c,l,u,f,d);return e.extend(E,{onStart:function(){},PartialScopeAction:{CREATE_PARTIALSCOPE:"CREATE_PARTIALSCOPE",STRETCH_PARTIALSCOPE:"STRETCH_PARTIALSCOPE",SWITCH_TO_FULLSCOPE:"SWITCH_TO_FULLSCOPE",DELETE_PARTIALSCOPE:"DELETE_PARTIALSCOPE"},isImplementLinkPossible:function(e,t){return l.isImplementLinkPossible(e,t)},getScopeLinksOfImplementing:function(e){return l.getScopeLinksOfImplementing(e)},getPartialScopeLinksOfImplementing:function(e){return l.getPartialScopeLinksOfImplementing(e)},createEngMadeFromItem:function(t,n){var i=n.get("PID");const o=c.getNLSValue("ImplementBehavior.createEngMadeFromItem.LogMessage"),a=c.getNLSValue("ImplementBehavior.createEngMadeFromItem.Success"),s=c.getNLSValue("ImplementBehavior.createEngMadeFromItem.Failed"),u=c.getNLSValue("ImplementBehavior.createEngMadeFromItem.NotSupportedType.Failed"),d=r.log(o);f.isAKindOf(n.get("type"),"CreateMaterial")||f.isAKindOf(n.get("type"),"ElementaryEndItem")?l.createEngMadeFromItem(t,i).then(t=>{if(e.is(t)){if(e.is(t.instancesAndReferences,"array")){const e=[];t.instancesAndReferences.forEach(t=>{t.isInstance()&&e.push(t)}),r.notify("instanceAdded",e)}e.is(t.connections,"array")&&r.notify("connectionAdded",[t.connections]),r.info(a,d)}}).catch(()=>{r.warn(s,d)}):r.warn(u,d)},consumeImplementedItems:function(n){var o,s,u,d,g={},m=new i(r.getBehavior("UXFactoryBehavior"),c);return e.is(n,"array")&&n.length>0?(r.notify("startProgress",g),o=t.allSettled((s=[],u=[],d=function(t,n,i,o){const s=c.getNLSValue("ImplementBehavior.Consumption.LogMessage"),u=c.getNLSValue("ImplementBehavior.Consumption.Success"),f=c.getNLSValue("ImplementBehavior.Consumption.Failed"),d=r.log(s),g=a.getReferenceModel(n.referencePID);l.consumeReferenceWithScopeLink(t,n.referencePID,n.targetReferencePID,"",{"PLMEntity.V_Name":g.get("V_Name"),"PLMEntity.V_description":"",V_Type:"DELAsmAssemblyModelDisciplines/Provide",type:"Provide"}).then(t=>{if(e.is(t)){if(e.is(t.instancesAndReferences,"array")){const e=[];t.instancesAndReferences.forEach(t=>{t.isInstance()&&e.push(t)}),e.length>0&&r.notify("instanceAdded",e)}e.is(t.connections,"array")&&r.notify("connectionAdded",[t.connections]),r.info(u,d)}i()}).catch(()=>{r.warn(f,d),o()})},n.forEach(function(i,o){var g=new t(function(t,s){var g=null,L=null,S=e.is(i.targetInstancePIDsArray)&&i.targetInstancePIDsArray.length>0?i.targetInstancePIDsArray:i.targetReferencePID;if(l.validateIfScoped(S,i.instancePIDsArray)){const d=a.getParentReferenceIdFromInstance(i.instancePID);if(e.is(d)&&l.isPartialScoped(d)){const t=l.getPartialScopeLinks(d);if(e.is(t)&&e.is(t[0])){const n=t[0].get("from");if(e.is(i.targetInstancePIDsArray)){let e=!1;for(const t of i.targetInstancePIDsArray)if(a.getReferenceIdFromInstance(t)===n){e=!0;break}e||(g=i.instancePIDsArray)}}}if(null===g&&(g=R(i.instancePIDsArray,i.instancePIDsArray)),L=a.getReference(i.targetReferencePID),f.isAKindOf(L,"DELConstructionStructure")){const e=c.getNLSValue("ImplementBehavior.ConstructionStructureConsumption.Failed");return r.warn(e),void s(e)}const m=r.getPreferenceValue("insertSpareItemOnAssign");m&&(f.isAKindOf(L,"DELServiceAssemblyReference")||f.isAKindOf(L,"DELServiceKitReference")||f.isAKindOf(L,"DELServicePartReference")||f.isAKindOf(L,"DELServiceAttachingItemReference"))?(u.push(g),o===n.length-1?p(i.rootReferencePID,u,i.targetRootReferencePID,i.targetReferencePID,t,s,m):t()):f.isAKindOf(L,"Provide")||f.isAKindOf(L,"ProcessContinuousProvide")||f.isAKindOf(L,"ContinuousByProduct")||f.isAKindOf(L,"MBOMContinuousPhaseReference")||f.isAKindOf(L,"DELConstructionWorkElementEach")||f.isAKindOf(L,"DELConstructionWorkElementArea")||f.isAKindOf(L,"DELConstructionWorkElementLength")||f.isAKindOf(L,"DELServicePartReference")||f.isAKindOf(L,"DELServiceAttachingItemReference")||f.isAKindOf(L,"DELServiceSpareItemReference")||f.isAKindOf(L,"DELContinuousServicePartReference")?P(i.targetReferencePID,i.targetInstancePID,i.referencePID,g,t,s):(u.push(g),o===n.length-1?p(i.rootReferencePID,u,i.targetRootReferencePID,i.targetReferencePID,t,s):t())}else{const n=()=>I(i.targetInstancePIDsArray,i.targetReferencePID,i.instancePIDsArray,i.referencePID);if(r.getPreferenceValue("skipVaidationIfScopedCheck")){let o=!1;if(e.is(i.targetInstancePIDsArray,"array")&&i.targetInstancePIDsArray.length>0)o=l.isUnderScope(i.targetInstancePIDsArray);else{const t=l.getScopeLinks(i.targetRootReferencePID);o=e.is(t,"array")&&t.length>0}o?m.show(function(){t()},function(){d("ManufacturingAssembly",i,t,s)},function(){d("ManufacturingMadeFrom",i,t,s)}):n().then(t,s)}else n().then(t,s)}});s.push(g)}),s)).then(function(){r.notify("stopProgress",g)})):(r.debug("Input parameters are invalid."),o=t.reject("ImplementBehavior.Validation.InvalidInput")),o},reconnectScope:function(e,t,n,i){g(e,t,!1,n,i)},reviseAndReconnectScope:function(e,t,n,i){g(e,t,!0,n,i)},prereqChecksForReconnectScope:function(e,t,n,i,o){var a=r.getBehavior("ModelBehavior");"ReconnectScope"===e?a.isReadOnly(t,n,i,o):"ReviseAndReconnectScope"===e&&a.isLatestRevision(t,n,i,o)},managePartialScopeLink:function(n){let i,o={};return e.is(n,"object")?(r.notify("startProgress",o),i=y(n.implementingAbsPath,n.implementedAbsPath,n.implementedPID,n.implementingPID,n.cmdAction).then(()=>{r.notify("stopProgress",o)}).catch(e=>{r.notify("stopProgress",o)})):(r.debug("Input parameters are invalid."),i=t.reject("ImplementBehavior.Validation.InvalidInput")),i},updateDataMaterializationLinkUsage:function(n,i,o){return new t(function(t,r){var a={rpConnectionPID:n,newValue:i},s={url:"dsmfg/private/V0/invoke/updateDataMaterializationLinkUsage",method:"POST",data:e.Json.encode(a),context:self,onComplete:function(e){t(e)},onFailure:function(t){e.is(o.onFailure,"function")&&o.onFailure(t),r()}};d.webServiceRequest(s)})},validateBrokenScopeLinkPromise:function(e,t){return v(e,t)}})}}}),define("DS/DELPPWModelBehaviors/DuplicateAdvBehavior/DuplicateAdvBehavior",["UWA/Core","DS/DELPPWModelBehaviors/DuplicateAdvBehavior/DuplicateAdvUI"],function(e,t){"use strict";return{plugins:["WebServicePlugin","UXComponentsPlugin","ResourcePlugin","DatabasePlugin"],creator:function(n,i,o,r,a,s){var c,l;return l=function(t,n){var r,c,l,u={},f={};i.notify("startProgress",u),r=i.log(a.getNLSValue("DuplicateAdvCmd.LogMessage")),t.instAndRefIDs=[],n.forEach(function(e){var n,i;n=s.getReferenceModel(e.id),i=s.getAllChildrenFromCollection(n.get("PID")),t.instAndRefIDs=t.instAndRefIDs.concat(i.referencesPID),t.instAndRefIDs=t.instAndRefIDs.concat(i.instancesPID)}),c=function(t){var n=[],o=[],c=s.getConnectionParser(),d={silentMode:!0,stackedReferences:[],stackedInstances:[],stackedConnections:[],onComplete:function(){var t=i.getBehavior("WUXNodeModelBehavior");e.is(t)&&(d.stackedInstances.forEach(function(e){s.manageLinearProductFlowsOnCreateInstance(s.getInstance(e.attributesValue.PID))}),n.forEach(function(e){-1===o.indexOf(e)&&t.addNode(s.getReferenceModel(e),{withLinksResolved:!1})})),i.notify("stopProgress",u),i.info(a.getNLSValue("DuplicateAdvCmd.Success"),r),i.notify("DuplicateAdv",f)}};e.is(t)&&e.is(t.instancesAndReferences)&&e.is(t.connections)?(t.instancesAndReferences.forEach(function(e){var t=e.attributesValue;Object.prototype.hasOwnProperty.call(t,"isInstanceOf")?(e.queriedForConnections=!0,d.stackedInstances.push(e),o.push(t.isInstanceOf)):(e.queriedForChildren=!0,e.queriedForConnections=!0,d.stackedReferences.push(e),n.push(t.PID))}),t.connections.forEach(function(e){c.parse(e,d)}),s.addToCollections(d)):l()},l=function(){i.notify("stopProgress",u),i.warn(a.getNLSValue("DuplicateAdvCmd.Failure"),r)},o.webServiceRequest({url:"dsmfg/private/V0/invoke/advancedClone",method:"POST",data:e.Json.encode(t),onComplete:c,onFailure:l,onTimeout:l,onCancel:l})},{listenTo:function(){return{DuplicateAdvCmd:this.executeDuplicateAdvCmd}},onStart:function(){var t=n.getConfig();if(!(e.is(t)&&e.is(t.resource)&&e.is(t.resource.duplicateAdvancedPreferencesXML)))throw new Error(i.getId()+": DuplicateAdvBehavior initialization failed");c=t.resource.duplicateAdvancedPreferencesXML},onStop:function(){},executeDuplicateAdvCmd:function(){var s,u,f,d,g,m,p,P,L=a.getNLSValue(i.getId()),I=i.getBehavior("WUXNodeModelBehavior");if(e.is(I))if((P=I.getSelectedNodesInfo()).length>0)if(f=o.getXMLValues(c),e.is(f)&&e.is(f.Config)){for(u in m=f.convert("Config.Preferences.DuplicateAdvanced.LinkOption","name"),g=f.Config.Preferences.DuplicateAdvanced.PrefixOption,d=f.Config.Preferences.DuplicateAdvanced.showOptionPanel,(s={}).Prefix=g.defaultValue,m)Object.prototype.hasOwnProperty.call(m,u)&&(s[u]=m[u].defaultValue);d?(p=r.getComponent("WUXFrameWindowsManager").getFrameWindow(n.getConfig().appContext),new t(p,r,a).showUI({prefixOption:g,linkOptions:m},function(t){l(e.merge(t,s),P)})):l(s,P)}else i.warn(a.getNLSValue("DuplicateAdvCmd.PreferencesXMLNotConfigured"));else console.log(a.getNLSValue("DuplicateAdvCmd.NoSelection",{view:L}));else i.debug("WUXNodeModelBehavior is not available so cannot execute DuplicateAdvCmd")}}}}});