function ClassificationEditor(e){"use strict";var t={leftPanelState:!0,isWelcomePanelCollapsed:!1},i={rightPanelState:!1,size:300},a={widget:null,filterFromWin:null,libraryContent_Cont:null,libraryContentController:null,libraryTree_div:null,libraryTreeDoc_div:null,libraryTree_Cont:null,libraryIdCard_div:null,libraryIdCard_Cont:null,core:null,widthToHideLeftPanel:300,_actionbar:null,libraryTree_W_NotLinked:!1,css_view_class:"windowed",_mouseEventsManager:{unlockMouseMove:!1,draggingXSlider:null,mouseStartXSlider:null,initialMouseStartXSlider:null,dragginDirection:null,cancelDragging:!1,spanPosition:null,widthLeftDiv:null,widthRightDiv:null,widthLeftDivSave:null,widthRightDivSave:null,widthGlobalDiv:null,newWidthGlobalDiv:null},init:function(e){var a=this;require(["DS/ClassificationEditor/dataProvider/LibraryContentDataProvider","DS/IPClassifyUX/utils/IPClassifyWidgetData"],function(e,t){t.setIsEditModeEnabled(!1),e.hasLibrarianRole().then(function(e){e="string"==typeof e?JSON.parse(e):e,t.setReadOnly(e.readOnly)}).catch(e=>console.log(e.message))}),require(["DS/ClassificationEditor/utils/ClassificationEditorUtil"],function(e){var a=e.getLeftPanelStatus(),r=e.getRightPanelStatus();Promise.all([a,r]).then(function(e){t=e[0],i=e[1]})}),require(["DS/PADUtils/PADSettingsMgt"],function(e){e.setSetting("columnParametrization",!0),e.setSetting("activateTXO",!0)}),require(["DS/IPClassifyUtil/IPClassifyUtility"],function(e){e.isCustomizedEnv(),e.initURLSAsync().then(function(){a.migratePreferences()})}),this.widget=e.widget,this.dataForActiveClassODT=e.dataForActiveClassODT,e.defaultSelectionPath&&(this.widget.defaultSelectionPathFromWin="root,LibrarySection_AllLibraries,"+e.defaultSelectionPath),require(["DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e){e.setWidgetRefresh(a.onRefresh.bind(a))}),require(["DS/ClassificationEditor/utils/Library_CSO"],function(t){e.reInitialize&&(t._currentLibrary={noTree:!0,getType:function(){return"Exception"}},t._currentLibraryPath=null)}),this.widget.removeEvent("onLoad"),this.widget.removeEvent("onRefresh"),this.widget.removeEvent("onDestroy"),this.widget.removeEvent("onResize"),this.widget.removeEvent("onEdit"),this.widget.removeEvent("endEdit"),this.widget.addEvent("onLoad",this.onLoad.bind(this)),this.widget.addEvent("onRefresh",this.onRefresh.bind(this)),this.widget.addEvent("onDestroy",this.onDestroy.bind(this)),this.widget.addEvent("onResize",this.onResize.bind(this)),this.widget.changeInPreference={};var r={},n={};this.widget.addEvent("onEdit",function(){a.widget.preferences.forEach(function(e){"hidden"!==e.type&&(r[e.name]=a.widget.getValue(e.name))})}),this.widget.addEvent("endEdit",function(e){!(!e||!e.submitted&&!e.needRefresh)&&(a.widget.changeInPreference={},Object.keys(r).forEach(function(e){n[e]=a.widget.getValue(e),r[e]!==n[e]&&(a.widget.changeInPreference[e]=n[e])}))})},doRefresh:function(e,t,i,a,r,n){var o=this,s=[];s.push(r.initURLSAsync()),o.widget.changeInPreference.x3dPlatformId&&(o.widget.changeInPreference={}),Promise.all(s).then(function(){var s=r.isIndexedMode();if(a.getContent().updateFilterBI(s),a.getContent().updateComputedColumns(),o.libraryContent_Cont.addEvent("onCompleteRefreshNodes",function(e){this.removeEvent("onCompleteRefreshNodes"),t.displayNotification({message:i.msg_info_refresh,className:"primary"})}),n&&UWA.is(n.authored.deleted,"array")){var l=e.getCurrentLibrary();null!=l&&l.getID()===n.authored.deleted[0]&&l.getParent().select(!0)}a.getTreeCont().refreshLibraryTree(),a.getContent().refreshLibraryContent()})},onRefresh:function(e){var t=this;e&&e.reInitialize?t._onReInit():require(["DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADContext","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUtil/IPClassifyUtility","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUXUtil/IPClassifyConfirmation"],function(i,a,r,n,o,s,l,c,d,u){d.getIsEditModeEnabled()?null==document.querySelector(".right-actions.fonticon.fonticon-cancel")&&u.launch({title:r.command_CancelUpdates,content:r.confirmation_cancel_attributesSure,confirmLabel:r.confirmation_ok},function(){var u=n.get(),f=u.options.views?u.options.views.datagridview:void 0;if(f){f.options.dgv.prepareUpdateView();var m=f.options.dgvLayout.getLeafColumns();m&&Array.isArray(m)&&m.forEach(function(e){e.toggleToEdit&&!0===e.toggleToEdit&&(e.getCellEditableState=function(e){return!1},e.getCellTypeRepresentation=function(e){return"string"}),"AuthorizedValues"===e.dataIndex&&(e.getCellValue=function(e){if(e.nodeModel){let t=e.nodeModel.getAttributeValue("AuthorizedValues"),i=c.getOldNodeValues()[e.nodeModel.options.grid.Name];return i&&(t=i),{label:t,func:"",module:""}}})}),f.options.dgv.treeDocument.cancelChanges(),f.options.dgv.treeDocument.setUseChangeTransactionMode(!1),f.options.dgv.pushUpdateView({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0},!0),d.setIsEditModeEnabled(!1),c.emptyOldNodeValues(),c.emptyUpdatedNodes(),l.updateCommands()}t.doRefresh(i,a,r,o,s,e)}):t.doRefresh(i,a,r,o,s,e)})},onDestroy:function(){},onResize:function(){var e=this;setTimeout(function(){e.libraryGlobal_div&&e.libraryIdCard_Cont&&0!==e.libraryGlobal_div.clientWidth&&e.libraryIdCard_Cont.updateDisplayPath()},500)},migratePreferences:function(){return new Promise(function(e){require(["text!DS/ClassificationEditor/assets/classificationVersion.json","DS/ClassificationEditor/utils/ClassificationMigration","DS/IPClassifyUtil/IPClassifyPreference"],function(t,i,a){let r=JSON.parse(t);var n=[];let o=new Promise(function(e){a.get("LibraryFavPrefVersion",function(t){!t||!t.version||t.version<r.LibraryFavPrefVersion?i.migrateFavPreferences(null,r.LibraryFavPrefVersion).then(function(){e()}):e()},!1)});n.push(o);let s=new Promise(function(e){a.get("LibraryTreeStrcutPrefVersion",function(t){!t||!t.version||t.version<r.LibraryTreeStrcuturePrefVersion?i.migrateTreeStructurePreferences(null,r.LibraryTreeStrcuturePrefVersion).then(function(){e()}):e()})});n.push(s),Promise.all(n).then(function(){e()})})})},_onReInit:function(){delete a.libraryTree_Cont,a.libraryTree_Cont=null,delete a.libraryContent_Cont,a.libraryContent_Cont=null,delete a.libraryIdCard_Cont,a.libraryIdCard_Cont=null,a.widget.body.container=null,a.libraryTree_W_NotLinked=!1,a.init({widget:this.widget,reInitialize:!0})},onLoad:function(){this.probeHeader=this.widget.id+"_"+this.widget.getTitle()+"_",window.top.performance.mark("onLoad_begin"),window.top.performance.measure(this.probeHeader+"createToOnLoad","createWidget_begin","onLoad_begin");var e=this;require(["DS/PADUtils/Configuration","DS/IPClassifyUX/utils/IPClassifyWidgetData","text!DS/ClassificationEditor/assets/ClassificationEditorConf.json","DS/PADServices/utils/AttributesMgt","DS/ClassificationEditor/utils/ClassificationEditorUtil","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(t,i,a,r,n,o){var s=JSON.parse(a),l=i.getWidgetData(),c="";l&&l.currentWidgetTab&&l.currentWidgetTab!==n.CONTENT_TABS.LIBRARIES?(s.settings.dgvOptions.value.dgv.showModelChangesFlag=!0,s.settings.dgvOptions.value.dgv.rowsHeader=!0,s.settings.dgvOptions.value.dgv.showColumnBorderFlag=!0,c=s.columnsCusto.ATTRIBUTES,Array.isArray(c.attributes)&&c.attributes.forEach(function(e){let t=o[e.nls_key]?o[e.nls_key]:e.dataIndex;e.text=t;let i=e.children;i&&i.forEach(function(e){e.text=o[e.nls_key]?o[e.nls_key]:e.dataIndex})})):(s.settings.dgvOptions.value.dgv.defaultColumnDef.typeRepresentation="string",s.settings.dgvOptions.value.dgv.showModelChangesFlag=!1,s.settings.dgvOptions.value.dgv.showColumnBorderFlag=!1,s.settings.dgvOptions.value.dgv.rowsHeader=!1,c=s.columnsCusto.LIBRARIES),t.mergeConfig(s),r.updateAttributesList(c),require(["UWA/Core","DS/PADUtils/PADContext","DS/PADUtils/PADCommandProxy","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADSharedSettings","DS/PADUtils/PADUtilsServices","DS/IPClassifyUX/LibraryContent","DS/ClassificationEditor/dataProvider/LibraryContentDataProvider","DS/IPClassifyUX/LibraryIdCardCont","DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider","DS/IPClassifyUX/LibraryTree","DS/ClassificationEditor/dataProvider/LibraryTreeDataProvider","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/dataProvider/LibraryCSODataProvider","DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider","DS/ClassificationEditor/dataProvider/ClassificationCommandsIconBarProvider","DS/ClassificationEditor/ActionBar/LibraryActionBar","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/service/LibraryServices","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/UIKIT/Mask","DS/ClassificationEditor/utils/ClassificationEditorKeyboardListener","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassifyUtil/IPClassifyUtility","DS/PADUtils/PADProbes","DS/ClassificationEditor/utils/FilterUtils","DS/IPClassifyUX/IPClassifyUXEvents","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/WidgetServices/WidgetServices","DS/IPClassifyUXUtil/CredentialsView","text!DS/ClassificationEditor/assets/library_settings.json","DS/MessageBus/MessageBus","DS/ClassificationEditor/dataProvider/ClassificationTabBarProvider"],function(t,i,a,r,n,o,s,l,c,d,u,f,m,p,g,C,b,y,h,v,_,S,A,E,D,w,L,x,T,I,P,N,U,M){try{x.init()}catch(e){}var O=e;O.options={},O.addEvent=(()=>{}),O.checkOnCommand=!1,i.set(O),window.top.performance.mark("loadRequire_end"),window.top.performance.measure(e.probeHeader+"loadRequire","createWidget_begin","loadRequire_end"),widget.setValue("tenantAware",!0),r.addEventOnce("onNoSecurityContext",function(e){if(!0!==e){S._isSecurityCTXInitialized=!1,widget.setBody(" ");var t=UWA.createElement("div",{text:y.get("authentication_error")});t.set("styles",{position:"absolute",top:"40%",bottom:"30%",left:"30%",right:"30%"}),t.inject(widget.body)}}),r.addEvent("onPad_security_ctx",function(e){S.getContent()&&S.getContent().getView()&&S.getContent().getView().options&&S.getContent().getView().options.model&&S.getContent().getView().options.model.getModelEvents()&&S.getContent().getView().options.model.getModelEvents().publish({event:"titleRecalc",data:m.getCurrentLibrary()._options.label})}),widget.addPreference({name:"pad_security_ctx",type:"hidden"});var F=JSON.parse(U);if(r.setApp(F.padsettings,"enopad",!0),r.setSetting("activate_padprobes",!0),r.setSetting("add_objects_when_select",!1),L.initialize({padid:widget.id,padtitle:widget.getTitle()}),n.addSharedSettings(widget,["x3dPlatformId"]),widget.setValue("editProperties_readOnly",!1),widget&&widget.lang&&r.setSetting("lang",widget.lang),e.widget.addEvent("endEdit",r.updateWidgetPreferences.bind(r)),r.updateWidgetPreferences(),e.updateSecurityPreference(),I.addModeIntervalPreferences({refreshView:function(){require(["DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e){e.getTreeCont().refreshLibraryTree(),e.getContent().refreshLibraryContent()})},updateTaggerAndComputeColumns:function(e){require(["DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(t){t.getContent().updateFilterBI(e),t.getContent().updateComputedColumns()})}}),e.widget.getValue("x3dSharedId")||e.widget.getValue("x3dAppId")||e.widget.addPreference({name:"x3dAppId",type:"hidden",defaultValue:"ENOFOL3_AP"}),e.widget.getValue("x3dSharedId")||e.widget.addPreference({name:"x3dSharedId",type:"hidden",defaultValue:"ClassificationEditor_"+o.getWidgetId()}),N.render(),null===e.libraryTree_Cont||void 0===e.libraryTree_Cont){e.core=t,e.widget.body.empty(),e._buildSkeleton();e.widget.addEvent("endEdit",function(){e.widget.getPreferences().forEach(function(t){var i="boolean"===t.type&&UWA.is(t.value,"string")?e.convertToBool(t.value):t.value;e.widget.setValue(t.name,i)})}),e.libraryGlobal_div=e.widget.body.container,e.libraryTreeDoc_div=e.widget.body.right_side_div,e.libraryIdCard_div=e.widget.body.top_right_side_div,e.libraryContent_div=e.widget.body.bottom_right_side_div;var R=e._initializeClassificationEditorComponent.bind(e);if(null===e.libraryContent_Cont){var W={x3dAppId:e.widget.getValue("x3dAppId"),lang:e.widget.lang?e.widget.lang:e.widget.getValue("lang"),layout:{view_customization:null,css_view_class:e.css_view_class,store_roots_in_pref:!0,padshell:!0},authorize_setStructure:!0,settings:F};e.widget.getValue("LibraryCusto_treelistview_v1")?(W.layout.view_customization=JSON.parse(w.jsonUnzip(e.widget.getValue("LibraryCusto_treelistview_v1"))),R(W)):o.app_initialization(function(){require(["DS/IPClassifyUtil/service/IPClassifyUtilWebService"],function(t){t.getUserPreferences({name:e.widget.getValue("x3dAppId")+"_Classification_v1",onComplete:function(e){var t=null;e&&e.length>0&&(t=JSON.parse(w.jsonUnzip(e))),W.layout.view_customization=t,R(W)},onFailure:function(e){R(W)}})})}),e.getSelectedNodes=function(){return m.getSelectedNodes()},e.getCurrentLibrary=function(){var e=D.getCurrentSecurityContextAndLibraryData(!0);return JSON.stringify(e)},e.getSecurityContext=function(){return{SecurityContext:r.getSetting("pad_security_ctx"),tenant:widget.getValue("pad_tenant")}},e.beginBlockingTransaction=function(t){A.mask(e.libraryContent_div,t)},e.endBlockingTransaction=function(){A.unmask(e.libraryContent_div)},e.author=function(e){},e.displayNotification=function(e){_.displayNotification({message:e.msg,className:e.eventID})},e.getPADTreeDocument=function(){return S.getContent().getView()?S.getContent().getView().getPADTreeDocument():null},e.toggleView=function(e){UWA.is(S.getContent().getView().toggleView(e))&&S.getContent().getView().toggleView(e)},e.getPADTreeListView=function(){return S.getContent().getView().getPADTreeListView()},e.getContent=function(){return S.getContent()}}}})})},_slidderMoveEndCallback:function(){this.libraryIdCard_Cont&&this.libraryIdCard_Cont.updateDisplayPath()},_buildSkeleton:function(){if(!this.core.is(this.widget.body.container)){this.widget.body.container=UWA.createElement("div",{class:"LibraryEditor_global_container"}).inject(this.widget.body,"top"),this.widget.body.right_side_div=UWA.createElement("div",{class:"LibraryEditor_right_side_div"}).inject(this.widget.body.container),this.widget.body.top_right_side_div=UWA.createElement("div",{class:"LibraryEditor_top_right_side_div"}).inject(this.widget.body.right_side_div),this.widget.body.bottom_right_side_div=UWA.createElement("div",{class:"LibraryEditor_bottom_right_side_div"}).inject(this.widget.body.right_side_div);var e=UWA.createElement("div",{class:"LibraryEditor_containerTools"}),t=this;require(["DS/PADServices/utils/GlobalModelEvents"],function(i){i.getModelEvents().subscribe({event:"AddExistingAttributesCmd/Views/showInWidgetBody"},function(i){i.html?(e.empty(),i.html.inject(e),e.inject(widget.body),i.keepOpacity||t.widget.body.right_side_div.setStyle("opacity",.5)):!0===i.restore&&(e.remove(),t.widget.body.right_side_div.setStyle("opacity",1))})})}},convertToBool:function(e){return"true"===e.toLowerCase()},_initializeClassificationEditorComponent:function(e){var a=this,r=require("DS/IPClassifyUX/LibraryTree"),n=require("DS/ClassificationEditor/dataProvider/LibraryTreeDataProvider"),o=require("DS/ClassificationEditor/utils/ClassificationEditorcontrol"),s=require("DS/IPClassifyUX/LibraryIdCardCont"),l=require("DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider"),c=require("DS/IPClassifyUX/LibraryContent"),d=require("DS/ClassificationEditor/dataProvider/LibraryContentDataProvider"),u=require("DS/ClassificationEditor/utils/ClassificationEditorKeyboardListener"),f=require("DS/PADUtils/PADUtilsServices"),m=require("DS/ClassificationEditor/dataProvider/LibraryCSODataProvider"),p=require("DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider"),g=(require("DS/ClassificationEditor/dataProvider/ClassificationCommandsIconBarProvider"),require("i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor")),C=require("DS/ClassificationEditor/service/LibraryTypeService"),b=require("DS/ClassificationEditor/utils/ClassificationEditorUtil"),y=require("DS/PADServices/utils/GlobalModelEvents"),h=require("DS/ClassificationEditor/dataProvider/ClassificationTabBarProvider");f.app_initialization(function(){f.getSecurityContext(function(v){if(v&&""!==v.securityContext&&v.securityContextList.length>0){if(0==b.CURRENT_TAB_VALUE)null===a.libraryTree_Cont&&f.app_initialization(function(){var s=new r({lang:a.widget.lang?a.widget.lang:a.widget.getValue("lang"),css_view_class:a.css_view_class,dataProvider:n,CSOProvider:m,DnDProvider:p,LibraryTypeService:C,events:{onReady:function(){if(o.setTreeCont(this),a.libraryTree_Cont=this._libraryTreeView,null!==a.libraryTree_Cont)a.libraryTree_Cont.setOption("_libraryContentView",this._libraryTreeView);else{if(!0===a.libraryTree_W_NotLinked)throw"LibraryTree are not linked !!!";a.libraryTree_W_NotLinked=!0}var r=a._retrieveinitializationOpts(),n=UWA.extend(e,r);n.placeholderData={},n.placeholderData.multiplePlaceholders=!0,n.placeholderData.placeholders={},n.placeholderData.placeholders.favoriteSection={},n.placeholderData.placeholders.favoriteSection.labelNLS=g.placeholder_Msg_FavoriteSection,n.placeholderData.placeholders.createNewDefinitionLibrary={},n.placeholderData.placeholders.createNewDefinitionLibrary.labelNLS=g.placeholder_Msg_CreateStandardOrDefinitonLib,n.placeholderData.placeholders.createNewDefinitionLibrary.commandNLS=g.placeholder_CMD1_CrteLib,n.placeholderData.placeholders.createNewDefinitionLibrary.command="CreateNewDefinitionLibrary",n.placeholderData.placeholders.createNewStandardLibrary={},n.placeholderData.placeholders.createNewStandardLibrary.labelNLS=g.placeholder_Msg_CreateStandardOrDefinitonLib,n.placeholderData.placeholders.createNewStandardLibrary.commandNLS=g.placeholder_CMD2_CrteLib,n.placeholderData.placeholders.createNewStandardLibrary.command="CreateNewStandardLibrary",n.placeholderData.placeholders.addClassAttributes={},n.placeholderData.placeholders.addClassAttributes.labelNLS=g.placeholder_Msg_classAttributes,n.placeholderData.placeholders.addClassAttributes.commandNLS=g.command_addExistingAttribute,n.placeholderData.placeholders.addClassAttributes.command="AddExistingAttributes",n.placeholderData.placeholders.createNewClass={},n.placeholderData.placeholders.createNewClass.labelNLS=g.placeholder_Msg,n.placeholderData.placeholders.createNewClass.labelNLS_Cls=g.placeholder_Msg_Cls,n.placeholderData.placeholders.createNewClass.commandNLS=g.placeholder_CMD1,n.placeholderData.placeholders.createNewClass.command="CreateNewClass",n.placeholderData.placeholders.newClassAttributes={},n.placeholderData.placeholders.newClassAttributes.labelNLS=g.placeholder_Msg_newClassAttributes,n.placeholderData.placeholders.newClassAttributes.commandNLS=g.placeholder_CMD2,n.placeholderData.placeholders.newClassAttributes.command="CreateClassAttributes",n.leftTriptychElem=a.libraryTree_Cont.elements.container,n.dataProvider=d,n.CSOProvider=m,n.DnDProvider=p,n.libraryEditorUtil=b,n.libraryControl=o,n.leftState=t,n.rightState=i,n.libraryContent_div=a.libraryContent_div,n.tabBarProvider=h,n.css_view_class=a.css_view_class,a.libraryContentController=new c(n),o.setContent(a.libraryContentController),a.widget.dispatchEvent("onClassificationEditorReady")}}});o.setTreeCont(s)});else{var _=a._retrieveinitializationOpts(),S=UWA.extend(e,_);S.placeholderData={},S.placeholderData.multiplePlaceholders=!0,S.placeholderData.placeholders={},S.placeholderData.placeholders.favoriteSection={},S.placeholderData.placeholders.favoriteSection.labelNLS=g.placeholder_Msg_FavoriteSection,S.placeholderData.placeholders.createNewDefinitionLibrary={},S.placeholderData.placeholders.createNewDefinitionLibrary.labelNLS=g.placeholder_Msg_CreateStandardOrDefinitonLib,S.placeholderData.placeholders.createNewDefinitionLibrary.commandNLS=g.placeholder_CMD1_CrteLib,S.placeholderData.placeholders.createNewDefinitionLibrary.command="CreateNewDefinitionLibrary",S.placeholderData.placeholders.createNewStandardLibrary={},S.placeholderData.placeholders.createNewStandardLibrary.labelNLS=g.placeholder_Msg_CreateStandardOrDefinitonLib,S.placeholderData.placeholders.createNewStandardLibrary.commandNLS=g.placeholder_CMD2_CrteLib,S.placeholderData.placeholders.createNewStandardLibrary.command="CreateNewStandardLibrary",S.placeholderData.placeholders.addClassAttributes={},S.placeholderData.placeholders.addClassAttributes.labelNLS=g.placeholder_Msg_classAttributes,S.placeholderData.placeholders.addClassAttributes.commandNLS=g.command_addExistingAttribute,S.placeholderData.placeholders.addClassAttributes.command="AddExistingAttributes",S.placeholderData.placeholders.createNewClass={},S.placeholderData.placeholders.createNewClass.labelNLS=g.placeholder_Msg,S.placeholderData.placeholders.createNewClass.labelNLS_Cls=g.placeholder_Msg_Cls,S.placeholderData.placeholders.createNewClass.commandNLS=g.placeholder_CMD1,S.placeholderData.placeholders.createNewClass.command="CreateNewClass",S.placeholderData.placeholders.newClassAttributes={},S.placeholderData.placeholders.newClassAttributes.labelNLS=g.placeholder_Msg_newClassAttributes,S.dataProvider=d,S.CSOProvider=m,S.DnDProvider=p,S.tabBarProvider=h,S.libraryContent_div=a.libraryContent_div,S.thumbnailAttributeDelayed=!0,a.libraryContentController=new c(S),o.setContent(a.libraryContentController),a.widget.dispatchEvent("onClassificationEditorReady"),y.subscribe({event:"/NLSRange/updated"},function(e){b.uppendChangestoList(e)})}null===a.libraryIdCard_Cont&&(a.libraryIdCard_Cont=new s({lang:a.widget.lang?a.widget.lang:a.widget.getValue("lang"),css_view_class:a.css_view_class,parentDiv:a.libraryIdCard_div,leftState:t,rightState:i,modelEvents:y.getModelEvents(),libraryCSODataProvider:m,libraryDataProvider:l,TabBarProvider:h,TabCont:a.widget.body.top_right_side_div,events:{onReady:function(){a.libraryIdCard_Cont=this,a.libraryIdCard_Cont.render().inject(a.libraryIdCard_div)}}})),a._keyboardListener||(a._keyboardListener=new u,a._keyboardListener.startObservingKeyboard())}})})},updateSecurityPreference:function(){window.library&&require(["DS/PADUtils/PADSettingsMgt"],function(e){var t="ctx::"+window.library.params.securityContext;e.setSetting("pad_security_ctx",t)})},_retrieveinitializationOpts:function(){var e=this;return{renderTo:e.libraryContent_div,events:{onActionBarReadyToBuild:function(){var a=require("DS/IPClassifyUX/LibraryIdCardCont"),r=require("DS/PADServices/utils/GlobalModelEvents"),n=require("DS/ClassificationEditor/dataProvider/LibraryCSODataProvider"),o=require("DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider"),s=require("DS/ClassificationEditor/dataProvider/ClassificationTabBarProvider");window.DEBUG_ActionBar_Require=!0,window.DEBUG_ActionBar_CmdInstantiation=!0,window.DEBUG_ActionBar_Xml=!0,window.DEBUG_ActionBar_ProcessCommandHeader=!0,window.DEBUG_ActionBar_Init=!0,e.elements=this.elements,e.options=this.options,e.togglePanel=this.togglePanel,null===e.libraryIdCard_Cont&&(e.libraryIdCard_Cont=new a({lang:e.widget.lang?e.widget.lang:e.widget.getValue("lang"),css_view_class:e.css_view_class,parentDiv:e.libraryIdCard_div,leftState:t,rightState:i,modelEvents:r.getModelEvents(),libraryCSODataProvider:n,libraryDataProvider:o,TabBarProvider:s,TabCont:e.widget.body.top_right_side_div,events:{onReady:function(){e.libraryIdCard_Cont=this,e.libraryIdCard_Cont.render().inject(e.libraryIdCard_div)}}}))},onReady:function(){e.libraryContent_Cont=this,e.addEvent=e.libraryContent_Cont.addEvent.bind(e.libraryContent_Cont),e.libraryContent_Cont.dropInvitContainer&&(e.libraryContent_Cont._dropInvitContainer=e.libraryContent_Cont.dropInvitContainer),e.libraryContent_Cont.options.renderTo&&(e.libraryContent_Cont._dropInvitContainer.hide(),e.libraryContent_Cont.render().inject(e.libraryContent_Cont.options.renderTo));require("DS/PADUtils/PADSettingsMgt");e.updateSecurityPreference()},onCustoViewChange:function(t){require(["DS/IPClassifyUtil/IPClassifyUtility"],function(i){e.widget.setValue("LibraryCusto_treelistview_v1",i.jsonZip(JSON.stringify(t)))})},onSaveAsTemplate:function(t){require(["DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyUtility"],function(i,a){e.widget.setValue("LibraryCusto_treelistview_v1",a.jsonZip(JSON.stringify(t))),i.saveUserPreferences({name:e.widget.getValue("x3dAppId")+"_Classification_v1",value:a.jsonZip(JSON.stringify(t)),onComplete:function(e){console.log("Saved as template")},onFailure:function(e){console.warn("Cannot save customization template")}})})},onSwitchView:function(){require("DS/ClassificationEditor/ActionBar/ClassificationCommandManager").updateCommands()},onToggleView:function(){require("DS/ClassificationEditor/ActionBar/ClassificationCommandManager").updateCommands()}}}}};return a.init(e),a}define("DS/ClassificationEditor/service/LibraryServices",["DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r){"use strict";return{CreateNewLibrary:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");t.createNewLibrary({onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var a=i.error;console.log("AddContent WebService Err : "+a),a.length>200&&(a=null),e.callbacks.onFailure(a)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure})},DeleteLibrary:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");e.IDs.length>0?t.deleteLibrary({IDs:e.IDs,onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var a=i.error;console.log("Delete Library WebService Err : "+a),a.length>200&&(a=null),e.callbacks.onFailure(a)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure}):e.callbacks.onFailure(e)},DeleteClass:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");e.IDs.length>0?t.deleteClass({IDs:e.IDs,onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var a=i.error;console.log("Delete Class WebService Err : "+a),a.length>200&&(a=null),e.callbacks.onFailure(a)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure}):e.callbacks.onFailure(e)},CreateNewClass:function(i){if(!UWA.is(i.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(i.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(i.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");var a=e.getCurrentLibrary().getID();t.createNewClass({libpid:a,onComplete:function(e){var t=e?JSON.parse(e):void 0;if(t&&t.error){var a=t.error;console.log("createNewClass WebService Err : "+a),a.length>200&&(a=null),i.callbacks.onFailure(a)}else i.callbacks.onComplete(e)},onFailure:i.callbacks.onFailure})},CreateNewAttribute:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");t.CreateNewAttribute({onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var a=i.error;console.log("createNewClass WebService Err : "+a),a.length>200&&(a=null),e.callbacks.onFailure(a)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure})},MoveClass:function(e){if(!UWA.is(e.callbacks,"object"))throw new Error("No callbacks function defined");if(!UWA.is(e.callbacks.onComplete,"function"))throw new Error("No onComplete callback function defined");if(!UWA.is(e.callbacks.onFailure,"function"))throw new Error("No onFailure callback function defined");var i=e.targetLibrary,a=i?i.id:"";a.length&&e.IDs.length?t.moveClass({classPhysicalIds:e.IDs,targetLibraryPhysicalId:a,carryOverAttributeGroups:e.carryOverAttributeGroups,onComplete:function(t){var i=t?JSON.parse(t):void 0;if(i&&i.error){var a=i.error;console.log("MoveClass WebService Err : "+a),a.length>200&&(a=null),e.callbacks.onFailure(a)}else e.callbacks.onComplete(t)},onFailure:e.callbacks.onFailure}):e.callbacks.onFailure(e)}}}),define("DS/ClassificationEditor/utils/ClassificationEditorcontrol",["UWA/Controls/Abstract"],function(e){return e.singleton({_Content:null,_TreeCont:null,_IdCardCont:null,_onWidgetRefresh:null,getContent:function(){return this._Content},setContent:function(e){this._Content=e},getTreeCont:function(){return this._TreeCont},setTreeCont:function(e){this._TreeCont=e},getIdCardCont:function(){return this._IdCardCont},setIdCardCont:function(e){this._IdCardCont=e},setWidgetRefresh:function(e){this._onWidgetRefresh=e},getWidgetRefresh:function(){return this._onWidgetRefresh}})}),define("DS/ClassificationEditor/utils/ClassificationMigration",["DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUtil/IPClassifyUtility"],function(e,t){return{migrateFavPreferences:function(i,a){return new Promise(function(i){1==a?e.get("ipcFavoriteList_v1",function(r){e.set(t.getTenantAwarePreferenceName("ipcFavoriteList_v1"),r,!1,!1),e.set("LibraryFavPrefVersion",{version:a},!1),i()},!1):i()})},migrateTreeStructurePreferences:function(i,a){return new Promise(function(i){1==a?e.get("ipcTreeStrucure_v1",function(r){e.set(t.getTenantAwarePreferenceName("ipcTreeStrucure_v1"),r),e.get("ipcTreeSelectedNode_v1",function(r){e.set(t.getTenantAwarePreferenceName("ipcTreeSelectedNode_v1"),r),e.set("LibraryTreeStrcutPrefVersion",{version:a}),i()})}):i()})}}}),define("DS/ClassificationEditor/utils/LibrarySearch",["UWA/Class","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","text!DS/ClassificationEditor/assets/library_exclude_columns.json"],function(e,t,i){"use strict";return e.singleton({init:function(e){this._parent(e),this._predicateToHeaderMap=null,this._dynamicHeaderMap=[],this._dynamicMapSorted=!1,this._searchInfo=null,this._defaultPredicates=["ds6w:label","physicalid","mxid","ds6w:type","owner","ds6w:classificationUsage"],this._authModePredicates=["ds6w:label","physicalid","mxid","ds6w:description","ds6w:modified","ds6w:created","ds6w:responsible","ds6w:type","ds6w:identifier","ds6w:status","ds6w:reservedBy","owner","policy","ds6w:classificationUsage"],this._authPersonAttributes=["ds6w:reservedby","ds6w:responsible"];this._searchInfo={with_indexing_date:!0,select_predicate:this._defaultPredicates.slice(0),select_file:["icon","thumbnail_2d"],order_field:"ds6w:modified",order_by:"desc",nresults:25}},getSearchInfo:function(e){var t=Object.assign({},this._searchInfo);return!0===e&&(t.select_predicate=this._authModePredicates),t},filterExcludeListColumns:function(e){var t=[],a=JSON.parse(i);if(a){a=a.columnToExclude;for(var r=0;r<e.length;++r)-1==a.indexOf(e[r].dataIndex)&&t.push(e[r])}return t},setPredicates:function(e,t){var a=this,r=JSON.parse(i),n=[];r&&(n=r.predicateToExclude,r=r.columnToExclude),Array.isArray(e)&&e.forEach(function(e){var t=e.ds6w;t||(t=e.dataIndex),"tree"===t||-1===a._searchInfo.select_predicate.indexOf(t)&&-1===r.indexOf(t)&&-1===n.indexOf(t)&&a._searchInfo.select_predicate.push(t)})},removeAllPredicates:function(){this._searchInfo.select_predicate=[],this._searchInfo.select_predicate=this._searchInfo.select_predicate.concat(this._defaultPredicates)},removePredicates:function(e){for(var t=[],i=[],a=0;a<e.length;++a)i.push(e[a].dataIndex);this._searchInfo.select_predicate.forEach(function(e){-1===i.indexOf(e)&&t.push(e)}),this._searchInfo.select_predicate=t},getPersonPredicatesForAuth:function(){return this._authPersonAttributes},setAttrNameToPredMapping:function(e){this._attrNameToPredMapping||(this._attrNameToPredMapping={}),this._attrNameToPredMapping&&e&&(this._attrNameToPredMapping[e.key]=e.value)},getAttrNameToPredMapping:function(){return this._attrNameToPredMapping||(this._attrNameToPredMapping={}),this._attrNameToPredMapping},resetAttrNameToPredMapping:function(){this._attrNameToPredMapping=null},initPredicateToHeaderMap:function(e){if(!this._predicateToHeaderMap){this._predicateToHeaderMap=[];for(var t=0;t<e.length;t++){var i=e[t],a=i.text?i.text.toLowerCase():null;if(a&&i.ds6w){var r={header:a,predicate:i.ds6w};this._predicateToHeaderMap.push(r)}}}},addToPredicateHeaderMap:function(e){for(var t=0;t<e.length;++t){var i=e[t],a=i.text?i.text.toLowerCase():null;if(a&&i.ds6w){var r={header:a,predicate:i.ds6w};this._predicateToHeaderMap.push(r)}}},removeFromPredicateHeaderMap:function(e){this._predicateToHeaderMap=this._predicateToHeaderMap.filter(function(e){for(var t=0;t<this.length;++t)if(this[t].ds6w==e.predicate)return!1;return!0},e)}})}),define("DS/ClassificationEditor/service/LibraryTypeService",["UWA/Controls/Abstract","text!DS/PADUtils/assets/PADOpenCommandsSettings.json"],function(e,t){return e.singleton({TYPE_ROOT_LIBRARY_1:"General Library",TYPE_ROOT_LIBRARY_2:"Part Library",TYPE_ROOT_LIBRARY_3:"RootLibrary",TYPE_LIBRARY_1:"General Class",TYPE_LIBRARY_2:"Library",TYPE_LIBRARIES_SECTION:"LibrarySection_AllLibraries",TYPE_FAVORITES_SECTION:"LibrarySection_favorite",RELATIONSHIP_SUBCLASS:"Subclass",STANDARD_USAGE:"STANDARD",openTypes:[],getOpenAvailableForTypes:function(e){if(0==this.openTypes.length&&e){var i=JSON.parse(t);i["openInCAD_"+e+"_supported_types"]&&(this.openTypes=i["openInCAD_"+e+"_supported_types"])}return this.openTypes},init:function(){},isRootLibrary:function(e){return e===this.TYPE_ROOT_LIBRARY_1||e===this.TYPE_ROOT_LIBRARY_2||e===this.TYPE_ROOT_LIBRARY_3},isLibrary:function(e){return e===this.TYPE_LIBRARY_1||e===this.TYPE_LIBRARY_2},inFamilyLibrary:function(e){return this.isRootLibrary(e)||this.isLibrary(e)},isSection:function(e){return e===this.TYPE_LIBRARIES_SECTION||e===this.TYPE_FAVORITES_SECTION},getPlmTypeFromContentDetails:function(e){if(e&&!(e.length<1)){for(var t,i,a,r,n="Content",o=0,s=e.length;o<s;++o)if("flattenedtaxonomies"===e[o].name){if("types/Classification"===e[o].value?t=!0:"types/General Class"===e[o].value?i=!0:"types/Libraries"===e[o].value?a=!0:"types/General Library"===e[o].value&&(r=!0),"types/Classification"===e[o].value[0]&&"types/General Class"===e[o].value[1]){n="Library";break}if("types/Libraries"===e[o].value[0]&&"types/General Library"===e[o].value[1]){n="RootLibrary";break}}return t&&i&&(n="Library"),a&&r&&(n="RootLibrary"),n}},getPLMTypeOfLibraryTreeNode:function(e){var t="";if(e){var i=e.plmType;t="Library"==i?"General Class":"RootLibrary"==i?"General Library":i}return t}})}),define("DS/ClassificationEditor/commands/ActionBar_ExpandNCmd",["UWA/Core","DS/ApplicationFrame/Command"],function(e,t){"use strict";return t.extend({labelTopBar:e.i18n("Expand N levels"),isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),require(["DS/IPClassifyUtil/IPClassifyAlert","DS/PADUtils/views/PADLevelSel","DS/ClassificationEditor/utils/Library_CSO","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a){})},beginExecute:function(){},execute:function(){var e=require("DS/IPClassifyUtil/IPClassifyAlert"),t=require("DS/PADUtils/views/PADLevelSel"),i=require("DS/ClassificationEditor/utils/Library_CSO"),a=require("i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"),r=null;null===(r=i.getCurrentLibrary())?e.displayNotification({message:a.msg_warning_noselection,className:"warning"}):new t({css_style:"",events:{onApply:function(e){r.expandNLevels({numberOfLevelsToExpand:parseInt(e),initialLevel:r.getNodeDepth()})}}})},endExecute:function(){}})}),define("DS/ClassificationEditor/utils/FilterUtils",["UWA/Class"],function(e){"use strict";return e.singleton({init:function(e){this.libraryFilter='flattenedtaxonomies:"types/General Library"',this.classFilter=["General Class"],this.classTreeFilter='flattenedtaxonomies:"types/General Class"',this.classTreeFilterAuth="General Class",this.endItemFilter=null,this.excludeBOTypesFromContentView=["Document Family","Part Family"]}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewRealAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("New Real Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new r).loadAttrCreatePanel({attrType:"Double",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewBooleanAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("New Boolean Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new r).loadAttrCreatePanel({attrType:"Boolean",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_DeleteLibrary",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUXUtil/IPClassifyConfirmation","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Delete Library"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=require("DS/ClassificationEditor/utils/Library_CSO"),t=require("DS/IPClassifyUtil/IPClassifyAlert"),i=require("DS/ApplicationFrame/CommandsManager"),s=require("DS/ClassificationEditor/service/LibraryServices"),l=require("DS/ClassificationEditor/commands/LibraryCommands"),c=require("DS/IPClassifyUX/events/IPClassifyEvents");n.launch({title:o.confirmation_deleteLibrary_title,content:o.confirmation_deleteLibrary_message},function(){var n=e.getSelectedNodes(),d=n.length;if(d>0){l._startProgressBar(o.deleteLibrary_loading);var u=i.getCommand("DeleteLibrary",r.getContent());u.disable();var f=[],m=null;n.forEach(function(e){null===m&&"noExpandState"!==e._expandState&&!0===widget.getBool("filtered-content")&&(m=!0),f.push(UWA.is(e.id)?e.id:e.options.resourceid)}),s.DeleteLibrary({IDs:f,callbacks:{onComplete:function(e){var t=o.msg_info_librariesDeleted;1===d&&(t=o.replace(o.msg_info_libraryDeleted,{libraryname:n[0]._options.label})),a.setAuthoringMode("authoring",t),a.updateRefreshTime();for(var i=0;i<f.length;i++){var s=f[i],u=r.getTreeCont().getView()._rootNodeLibraries;u.select(),r.getTreeCont().performOperationOnNode(u,"collapse"),r.getTreeCont().performOperationOnNode(u,"expand"),c.notifyRemoveNodeInContent(s)}0===r.getContent()._libraryContentView.options.model.getAllDescendants().length&&r.getContent().getView()._addPlaceHolder(),l._offProgressBar()},onFailure:function(e,i,a){l._offProgressBar(),u.enable();var r=l.extractMyErrorMessage(e,i,a);t.displayNotification({message:r?o.msg_error_deletelibrary+"<br>"+r:o.msg_error_deletelibrary,className:"error"})}}})}})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewStringAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s){"use strict";return t.extend({labelTopBar:e.i18n("New String Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new o).loadAttrCreatePanel({attrType:"String",container:r.getContent().getView().elements.container,grid:r.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_ClassAttributesToolsCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("New Boolean Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new r).buildToolsMenu({container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewDimentionalAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("New Attribute With Dimention"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new r).loadAttrCreatePanel({attrType:"DoubleWithDim",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewDateAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("New Date Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new r).loadAttrCreatePanel({attrType:"Date",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_CreateClass",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Create New Class"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=require("DS/ClassificationEditor/service/LibraryServices"),t=require("DS/ClassificationEditor/commands/LibraryCommands"),i=require("DS/ClassificationEditor/utils/Library_CSO"),n=require("DS/IPClassifyUtil/IPClassifyAlert"),s=i.getCurrentLibrary();t._startProgressBar(o.CreateNewClass_loading),e.CreateNewClass({callbacks:{onComplete:function(e){t._offProgressBar(),e="string"==typeof e?JSON.parse(e):e,a.setAuthoringMode("authoring",o.replace(o.msg_info_classCreationSucess,{})),e.createdClassObj&&(r.getTreeCont().addNewNode({physicalid:e.createdClassObj.classPhysicalId,label:e.createdClassObj.className,plmType:"Library",type:e.createdClassObj.classType,mxid:e.createdClassObj.classObjId,parentid:e.createdClassObj.classParentId,icons:[{iconName:"library-class"}]}),setTimeout(function(){r.getContent().loadContentAndSelect(s,e.createdClassObj.classPhysicalId,!1,!1,!0).then(function(e){})},100))},onFailure:function(e,i,a){t._offProgressBar();var r=t.extractMyErrorMessage(e,i,a);n.displayNotification({message:r?o.msg_error_createClass+"<br>"+r:o.msg_error_createClass,className:"error"})}}})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_DeleteClass",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUXUtil/IPClassifyConfirmation","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Delete Class"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=require("DS/ClassificationEditor/utils/Library_CSO"),t=require("DS/IPClassifyUtil/IPClassifyAlert"),i=require("DS/ApplicationFrame/CommandsManager"),s=require("DS/ClassificationEditor/service/LibraryServices"),l=require("DS/ClassificationEditor/commands/LibraryCommands"),c=require("DS/IPClassifyUX/events/IPClassifyEvents");n.launch({title:o.confirmation_deleteClass_title,content:o.confirmation_deleteClass_message},function(){var n=e.getSelectedNodes(),d=!1;d=!!n[0].pathId;var u=n.length;if(u>0){l._startProgressBar(o.deleteClass_loading);var f=i.getCommand("DeleteClass",r.getContent());f.disable();var m=[],p=null;n.forEach(function(e){null===p&&"noExpandState"!==e._expandState&&!0===widget.getBool("filtered-content")&&(p=!0),m.push(UWA.is(e.id)?e.id:e.options.resourceid)}),s.DeleteClass({IDs:m,callbacks:{onComplete:function(t){var i=o.msg_info_classesDeleted;1===u&&(i=o.replace(o.msg_info_classDeleted,{classname:n[0]._options.label})),a.setAuthoringMode("authoring",i),a.updateRefreshTime();for(var s=0;s<m.length;s++){var f=m[s],p=e._currentLibrary;d&&"RootLibrary"!=p.plmType&&(p=p._parentNode),p.select(),r.getTreeCont().performOperationOnNode(p,"collapse"),r.getTreeCont().performOperationOnNode(p,"expand"),c.notifyRemoveNodeInContent(f)}0===r.getContent()._libraryContentView.options.model.getAllDescendants().length&&r.getContent().getView()._addPlaceHolder(),l._offProgressBar()},onFailure:function(e,i,a){l._offProgressBar(),f.enable();var r=l.extractMyErrorMessage(e,i,a);t.displayNotification({message:r?o.msg_error_deleteClass+"<br>"+r:o.msg_error_deleteClass,className:"error"})}}})}})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_NewIntegerAttribute",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/PADUtils/PADProbes","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("New Integer Attribute"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){(new r).loadAttrCreatePanel({attrType:"Integer",container:i.getContent().getView().elements.container,grid:i.getContent().getView().getPADTreeListView().getManager()})},endExecute:function(){}})}),define("DS/ClassificationEditor/service/ClassificationEditorWebService",["UWA/Core","DS/WAFData/WAFData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADSettingsMgt","DS/PADUtils/PADUtilsServices","DS/ClassificationEditor/utils/LibrarySearch","DS/ClassificationEditor/utils/FilterUtils","DS/IPClassifyUtil/IPClassifyUtility","text!DS/ClassificationEditor/assets/ClassificationEditorProps.json","DS/ClassificationEditor/service/LibraryTypeService"],function(e,t,i,a,r,n,o,s,l,c){"use strict";return{_pageCount:50,content:function(e){var t={};UWA.extend(t,e);var i="";t.searchQuery?i="*"+e.searchQuery+'* (flattenedtaxonomies:"types/General Class" AND classification: '+e.mxid+")":(i='flattenedtaxonomies:"types/General Class"',!0===e.isAuthoringMode&&(i='type == "General Class"'),t.isExpand=!0),t.searchPageCount=this._pageCount,this._performSearchQuery(t,i,"content")},roots:function(e){var t='flattenedtaxonomies:"types/Libraries"',i=o.libraryFilter;i&&null!=i&&(t=i),!0===e.isAuthoringMode&&(t='type == "General Library"'),!0!==e.fetchAll&&(e.searchPageCount=this._pageCount),this._performSearchQuery(e,t,"roots")},favourites:function(e){this._performFetchQuery(e,"favourites")},libraries:function(e){var t={};UWA.extend(t,e),t.expand_iter="1",e.isExpandAll&&(t.expand_iter="-1");var i=o.classTreeFilter;e.isAuthoringMode&&(i=o.classTreeFilterAuth),t.filter=i,this._performExpandQuery(t,"libraries")},createNewLibrary:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.createNewLibrary");var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/create";t.headers={"content-type":"application/json"},t.data={type:"General Library",name:" "},t.data=UWA.Json.encode(t.data),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"createNewLibrary")},deleteLibrary:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.deleteLibrary");var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.IDs[0]+"/delete";t.headers={"content-type":"application/json"},t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"deleteLibrary")},createNewClass:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.createNewClass");if(!UWA.is(t.libpid,"string"))throw new Error("Invalid inputs for ClassificationEditorWebService.createNewClass");var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.libpid+"/createClass";t.headers={"content-type":"application/json"},t.data={type:"General Class"},t.data=UWA.Json.encode(t.data),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"createNewClass")},CreateNewAttribute:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.createNewClass");if(!UWA.is(t.libpid,"string"))throw new Error("Invalid inputs for ClassificationEditorWebService.createNewClass");var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.libpid+"/createClass";t.headers={"content-type":"application/json"},t.data={type:"General Class"},t.data=UWA.Json.encode(t.data),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"createNewClass")},deleteClass:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.deleteClass");var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/class/"+t.IDs[0]+"/delete";t.headers={"content-type":"application/json"},t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"deleteClass")},moveClass:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.moveClass");var i=s.get3DSpaceUrl()+"/resources/IPClassificationReuse/class/"+t.classPhysicalIds[0]+"/moveClassification?carryOver="+t.carryOverAttributeGroups;t.headers={"content-type":"application/json"},t.data={id:t.targetLibraryPhysicalId},t.data=UWA.Json.encode(t.data),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"moveClass")},setProperties:function(e){var t={};if(UWA.extend(t,e),!UWA.is(t,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.setProperties");if(!UWA.is(t.pid,"string"))throw new Error("Invalid inputs for ClassificationEditorWebService.setProperties");var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.pid+"/updateClassificationProps",a=n.getSearchInfo(e.isAuthoringMode).select_predicate;a=a.concat(["flattenedtaxonomies"]),t.payload={};var o=["svg","bi_color"],l=a.filter(function(e){return o.indexOf(e)<0});t.payload.physicalid=t.pid,t.payload.select_predicate=l,t.payload.properties=t.properties,s.isIndexedMode()?(t.payload.person_predicate=[],t.payload.compute_select_bo=["icon","thumbnail_2d"]):(t.payload.person_predicate=n.getPersonPredicatesForAuth(),t.payload.compute_select_bo=["icon","thumbnail_2d"]),t.method="POST",t.headers={"content-type":"application/json",Accept:"application/json"},t.type="json",t.data={properties:t.properties,fetchPayload:t.payload},t.data=UWA.Json.encode(t.data),this._executeRequest(i,t,"setProperties")},getLibraryPathLength:function(e){e.fetchClassification=!0,this._performFetchQuery(e,"getLibraryPathLength")},getLibraryPath:function(e){var t={};UWA.extend(t,e);for(var i={},a=t.depth,r=1;r<=a;r++)i["GET_PARENT_"+r+"_LIBRARY"]=[{id:2,iter:r}];t.patterns=i,this._performNavigateQuery(t,"getLibraryPath")},_performNavigateQuery:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var t={};UWA.extend(t,e);var i=a.getSetting("pad_security_ctx"),s=r.get3DSpaceUrl()+"/cvservlet/navigate";!0===e.isAuthoringMode&&(s=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/Navigate/navigate"),s+="?SecurityContext="+i;var l=widget.lang?widget.lang:widget.getValue("lang"),c=[];c.push(e.pid),t.payload={},t.payload.input_physical_ids=c;var d=o.classFilter;d&&null!=d&&"RootLibrary"==e.selectedType?t.payload.primitives=[{navigate_to_rel:{id:1,filter:{bo_type:d}},navigate_from_rel:{id:2}}]:t.payload.primitives=[{navigate_to_rel:{id:1},navigate_from_rel:{id:2}}],t.payload.patterns=t.patterns;var u=n.getSearchInfo(!0).select_predicate;if(u=u.concat(["flattenedtaxonomies"]),e.dynamicattrs&&e.dynamicattrs.length>0){var f=u.concat(e.dynamicattrs);t.payload.attributes=f}else t.payload.attributes=u;t.payload.version=3;var m=new Date;return t.payload.label=("LibraryWidgetNavigate_"+m.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),t.method="POST",t.headers={Accept:"application/json","content-type":"application/json","Accept-Language":l},t.type="json",t.data=UWA.Json.encode(t.payload),this._executeRequest(s,t,"searchInLibrary")},_performExpandQueryIndex:function(e,t,i){var n={};UWA.extend(n,e);let o=r.get3DSpaceUrl()+"/cvservlet/progressiveexpand/v2?output_format=cvjson",s=[];return n.pid&&(n.children||(n.children=[]),n.children.push(n.pid)),n.children.forEach((e,i)=>{let a={label:t+"_"+i,root:{physical_id:e},parameters:{graph_advise:1,limit_max_path:1e4},graph:{descending_condition_object:{uql:'(flattenedtaxonomies:"types/General Class") OR (flattenedtaxonomies:"types/General Library") '}},filter:{all:1}};n.expand_iter>=0&&(a.aggregation_processors=[{truncate:{max_distance_from_prefix:n.expand_iter,prefix_filter:{prefix_path:[{physical_id_path:[e]}]}}}]),s.push(a)}),n.payload={batch:{expands:s},outputs:{select_object:i,format:"entity_relation_occurrence",hits:{predefined_computation:["mythumbnail2d","icons"]}}},n.headers={SecurityContext:a.getSetting("pad_security_ctx"),"content-type":"application/json"},n.type="json",n.data=UWA.Json.encode(n.payload),n.method="POST",this._executeRequest(o,n,"expandFolder")},_performExpandQuery:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var t=n.getSearchInfo(!0).select_predicate;t=t.concat(["flattenedtaxonomies"]);var i=["svg","bi_color"],a=t.filter(function(e){return i.indexOf(e)<0});let o=("LibraryWidgetExpand_"+(m=new Date).getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-");if(!0!==e.isAuthoringMode)return e.dynamicattrs&&e.dynamicattrs.length>0&&(a=a.concat(e.dynamicattrs)),this._performExpandQueryIndex(e,o,a);var s={};UWA.extend(s,e);var l=null;!0===e.isAuthoringMode&&(l=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/Expand/expand");var c=widget.lang?widget.lang:widget.getValue("lang");if(s.payload={},s.payload.expand_iter=e.expand_iter,s.children&&s.children.length>0){var d=[];d.push(e.pid);for(var u=0;u<s.children.length;++u)d.push(s.children[u]);s.payload.multi_root_physicalid=d}else s.payload.root_physicalid=e.pid;if(s.filter&&!1===e.isAuthoringMode&&(s.payload["q.iterative_filter_query_bo"]=e.filter),s.filter&&!0===e.isAuthoringMode&&(s.payload.iterative_filter_query_bo=e.filter,s.payload.person_predicate=n.getPersonPredicatesForAuth()),e.dynamicattrs&&e.dynamicattrs.length>0){var f=a.concat(e.dynamicattrs);s.payload.select_bo=f}else s.payload.select_bo=a;s.payload.compute_select_bo=["icon","thumbnail_2d"];var m=new Date;return s.payload.label=("LibraryWidgetExpand_"+m.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),s.payload.max_count_path="10000",s.method="POST",s.headers={Accept:"application/json","content-type":"application/json","Accept-Language":c},s.type="json",s.data=UWA.Json.encode(s.payload),this._executeRequest(l,s,"Expand")},_performFetchQuery:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var t={};UWA.extend(t,e);var i=a.getSetting("pad_security_ctx"),o=r.get3DSpaceUrl()+"/cvservlet/fetch/v2";o+="?SecurityContext="+i;var s=widget.lang?widget.lang:widget.getValue("lang"),l=n.getSearchInfo(e.isAuthoringMode).select_predicate;l=l.concat(["flattenedtaxonomies"]),t.payload={},e.dynamicAttrs&&e.dynamicAttrs.length>0&&(t.payload.classification_attribute=e.dynamicAttrs,l=l.concat(e.dynamicAttrs));var c=["svg","bi_color"],d=l.filter(function(e){return c.indexOf(e)<0});!0===e.fetchClassification&&d.push("classification"),t.payload.physicalid=t.ids,t.payload.select_predicate=d,!0===e.isAuthoringMode&&(o=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/classifiedItem/getContentDetails",t.payload.person_predicate=n.getPersonPredicatesForAuth(),t.payload.compute_select_bo=["icon","thumbnail_2d"]);var u=new Date;return t.payload.label=("LibraryWidgetFetch_"+u.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),t.method="POST",t.headers={Accept:"application/json","content-type":"application/json","Accept-Language":s},t.type="json",t.data=UWA.Json.encode(t.payload),this._executeRequest(o,t,"Fetch")},_performSearchQuery:function(e,t){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.content");var i={};UWA.extend(i,e);var o=r.get3DSearchUrl()+"/search",s=widget.lang?widget.lang:widget.getValue("lang");i.payload=Object.assign({},n.getSearchInfo(e.isAuthoringMode));var l=i.payload.select_predicate;i.securityContextRequired=!1,!0===e.isAuthoringMode?(i.securityContextRequired=!0,o=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/Search/search",i.payload.person_predicate=n.getPersonPredicatesForAuth(),i.payload.root_physicalid=e.pid):i.payload.login={"3dspace":{SecurityContext:a.getSetting("pad_security_ctx")}},l=l.concat(["flattenedtaxonomies"]),e.dynamicattributes&&e.dynamicattributes.length>0&&(l=l.concat(e.dynamicattributes)),i.payload.select_predicate=l;var d=new Date,u=Math.random();u.toString(36);var f=u.toString(36).substr(2,9);return i.payload.label=("LibraryWidgetSearch_"+f+"_"+d.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-"),i.payload.locale=s,i.payload.query=t,i.payload.tenant=r.getPlatformId(),i.payload.next_start=e.next_start,i.payload.start=e.start,i.method="POST",i.headers={Accept:"application/json","content-type":"application/json","Accept-Language":s},i.type="json",e.order_field&&(i.payload.order_field=e.order_field,i.payload.order_by=e.order_by),e.searchPageCount&&(i.payload.nresults=e.searchPageCount),!0===e.fetchAll&&(i.payload.nresults=1e3),e.isExpand&&!1===e.isAuthoringMode&&(i.payload.source=["3dspace"],i.payload.specific_source_parameter={"3dspace":{search_in_context:{expand:{root_physicalid:e.pid,expand_iter:"1",type_filter_rel:[c.RELATIONSHIP_SUBCLASS]}},option:{with_Idx_Search:!0}}}),e.filters&&!1===e.isAuthoringMode&&(i.payload.refine=e.filters),i.data=UWA.Json.encode(i.payload),this._executeRequest(o,i,"searchInLibrary")},_executeRequest:function(e,r,n){var o=Math.round(1e3*Math.random()).toString(),s=widget.id+"_"+widget.getTitle()+"_";window.top.performance.mark("libraryRequest_begin"+o);var l={};if(UWA.extend(l,r),!l.payload&&e.indexOf("cvservlet")>-1){l.payload={};var c=new Date;l.payload.label=("LibraryWidgetExecute_"+c.getTime()).replace(new RegExp(" ","g"),"_").replace(new RegExp(",","g"),"").replace(new RegExp("/","g"),"-")}UWA.is(l.onTimeout,"function")||(l.onTimeout=function(){var e={type:"timeout",toString:function(){return i.msg_InfoAction_Timeout}};l.onFailure(e)},l.onComplete=function(e){window.top.performance.mark("libraryRequest_end"+o);var t=window.top.performance.getEntriesByName("libraryRequest_begin"+o);t&&1===t.length&&(window.top.performance.measure(s+"_Request"+n,"libraryRequest_begin"+o,"libraryRequest_end"+o),window.top.performance.clearMarks("libraryRequest_end"+o),window.top.performance.clearMarks("libraryRequest_begin"+o)),r.onComplete(e)});var d={Accept:"application/json","Accept-Language":widget.lang?widget.lang:widget.getValue("lang")};return!1!==l.securityContextRequired&&(d.SecurityContext=a.getSetting("pad_security_ctx")),r.headers?l.headers=UWA.extend(d,r.headers):l.headers=d,t.authenticatedRequest(e,l)},getClassificationAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.getClassificationAttributes");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/"+t.classid+"/getClassAttributes?timezoneOffset="+(new Date).getTimezoneOffset()/60;return t.method="GET",t.timeout=12e4,this._executeRequest(i,t,"getClassificationAttributes")},getInterfaceForAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.getClassificationAttributes");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/getInterfaceForAttribute";if(t.headers={"content-type":"application/json"},t.attributes){var a=t.attributes,n=[];a.forEach(function(e){n.push(e.name)})}return t.data={attributes:e.attributes},t.data=UWA.Json.encode(t.data),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"getInterfaceForAttribute")},fetchDataForClassAttributesTab:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.fetchAllTheClassificationAttributes");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/getDataForClassAttributesTab?timezoneOffset="+(new Date).getTimezoneOffset()/60;return t.method="GET",t.timeout=12e4,t.securityContextRequired=!0,this._executeRequest(i,t,"fetchDataForClassAttributesTab")},fetchAllTheClassificationAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.fetchAllTheClassificationAttributes");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/fetchAttributes?timezoneOffset="+(new Date).getTimezoneOffset()/60;return t.method="GET",t.timeout=12e4,this._executeRequest(i,t,"fetchAllTheClassificationAttributes")},addClassAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.addClassAttributes");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/"+t.pid+"/addAttributes";if(t.headers={"content-type":"application/json"},t.attributes){var a=t.attributes,n=[];a.forEach(function(e){n.push(e.name)}),t.data={attributes:n},t.data=UWA.Json.encode(t.data)}t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"addClassAttributes")},removeClassAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.removeClassAttributes");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/ClassAttribute/"+t.pid+"/removeAttributes";t.headers={"content-type":"application/json"},t.attributes&&(t.data={attributes:t.attributes},t.data=UWA.Json.encode(t.data)),t.method="POST",t.timeout=12e4,this._executeRequest(i,t,"removeClassAttributes")},exportClassificationAttributes:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.exportClassificationAttributes");var t={};UWA.extend(t,e);var i=JSON.parse(l);t.headers={Accept:"application/zip","Content-Type":"application/zip","Accept-Language":widget.lang},t.package=i.package_name,t.tenant=r.getPlatformId(),t.type="blob",t.method="GET",t.timeout=18e5;var a=r.get3DSpaceUrl()+"/resources/dictionary/ExportData?tenant="+t.tenant+"&package="+t.package;this._executeRequest(a,t,"exportClassificationAttributes")},exportLibraryStructure:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.exportLibraryStructure");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/"+t.pid+"/exportStructure";t.headers={"content-type":"application/json",Accept:"application/json"},t.method="GET",t.timeout=6e5,this._executeRequest(i,t,"exportLibraryStructure")},importLibraryStructure:function(e){if(!UWA.is(e,"object"))throw new Error("Invalid inputs for ClassificationEditorWebService.importLibraryStructure");var t={};UWA.extend(t,e);var i=r.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/importStructure";t.headers={"content-type":"application/json",Accept:"application/json"},t.fileContent&&(t.data={isValidate:t.isValidate,fileContent:t.fileContent},t.data=UWA.Json.encode(t.data)),t.method="POST",t.timeout=6e5,this._executeRequest(i,t,"importLibraryStructure")},hasLibrarianRole:function(e){var t=e;if(!UWA.is(t,"object"))throw new Error("Invalid inputs for LibraryEditorWebService.hasLibrarianRole");var i=s.get3DSpaceUrl()+"/resources/IPClassificationReuse/library/canManageClassificationAttributes";return t.method="GET",this._executeRequest(i,t,"hasLibrarianRole")}}}),define("DS/ClassificationEditor/utils/ClassificationEditorDataConversion",["DS/WebappsUtils/WebappsUtils","DS/ClassificationEditor/service/LibraryTypeService","DS/PADServices/utils/AttributesMgt","DS/ClassificationEditor/utils/LibrarySearch","DS/IPClassifyUtil/IPClassifyUtility","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n){var o=function(e){var t=e.toLowerCase(),a=null;i.getAvailableColumns()&&(a=i.getAvailableColumns());var r=i.getTreeColumn(),n=null;return Array.isArray(a)&&a.every(function(e){return"tree"===e&&(e=r),t==e.toLowerCase()&&(n=e),null===n}),n=n||e},s={convertToExaleadDataFormatFederated:function(e){var t={children:null},i=e.attributes,r=a.getAttrNameToPredMapping(),n={"ds6w:type":"type","ds6w:label":"label","ds6w:classificationUsage":"usage"},s={};return i.forEach(function(e){if("resourceid"==e.name||"physicalid"==e.name)t.physicalid=e.value,t.resourceid=e.value;else if("mxid"==e.name)t.mxid=e.value;else if("type_icon_url"===e.name)t.icons=[e.value];else if("preview_url"===e.name)t.thumbnail=e.value;else if(e.name.startsWith("ds6w")){var i=e.name.split("/");"ds6w:type"===(d=i[i.length-1])&&(m=e.value,["CATIA Embedded Component","CATPart","CATProduct","CATProcess","CATDrawing","CATAnalysis","CATShape"].indexOf(m)>=0)?t.children=[]:"ds6w:created"===d&&(t.created=e.value);var a=e.object?e.object:e.value;if(a=a||e.dispValue,r[d]){if(s[d]){a=[a];var l=s[d];Array.isArray(l)||(l=[l]),a=a.concat(l)}d=r[d]}s[d]=a,s[e.name]=a;var c=n[d];c&&(t[c]=a)}else{var d=e.name;r[d]&&(d=r[d]);var u=s[o(e.name)];if(u)if(Array.isArray(u))u.push(e.value);else{var f=[u,e.value];s[o(e.name)]=f,s[d]=f}else s[o(e.name)]=e.value,s[d]=e.value}var m}),e.id||(e.id=t.resourceid),t.grid=s,t.padgrid={"ds6w:leaf":"False","ds6w:root":"True"},t},convertAttributeFromDicoToExaleadDataFormat:function(t){var i={children:null},a={};for(var r in t)if(t.hasOwnProperty(r)){if("nls_hasDefault"===r)a.hasDefault=t[r];else if("name"===r)a["ds6w:label"]=t[r],i.label=t[r],a.Name=t[r],i.Name=t[r];else if("isInDico"===r)a.isInDico=t[r];else if("nls_predicate"===r)a.Predicates=t[r];else if("default"===r)a.DefaultValue=t[r];else if("description"===r)a.Description=t[r];else if("nls_type"===r)a.Type=t[r],i.type=t[r];else if("nls_dimension"===r)a.Dimension=t[r];else if("manipulationUnit"===r)a.prefUnit=t[r];else if("origin"===r)a.origin=t[r],i.origin=t[r];else if("range"===r){var n=t[r];(n="string"==typeof n?JSON.parse(n):n).forEach(function(e){if("between"==e.operator){var t=e.value.split(" ");a.Minimum=t[0],a.Maximum=t[2]}else a.AuthorizedValues?a.AuthorizedValues+=","+e.value:a.AuthorizedValues=e.value})}else"nls_valuetype"===r?a.IsMultivalue=t[r]:"nls_multiline"===r?a.IsMultiline=t[r]:"attr_nls_en"===r?a.nls_EN=t[r]:"attr_nls_fr"===r?a.nls_FR=t[r]:"attr_nls_de"===r?a.nls_DE=t[r]:"attr_nls_ja"===r?a.nls_JA=t[r]:"attr_nls_ko"===r?a.nls_KO=t[r]:"attr_nls_ru"===r?a.nls_RU=t[r]:"attr_nls_zh"===r?a.nls_ZH=t[r]:"nls_isParametric"===r&&(a.attrIsParametric=t[r]);a.values={isInDico:t.actual_is_InDico?t.actual_is_InDico.toString():"false",hasDefault:t.hasDefault,type:t.type}}return i.icons=[e.getWebappsAssetUrl("ClassificationEditor","icons/attributes.png")],i.grid=a,i.padgrid={"ds6w:leaf":"False","ds6w:root":"True"},i},convertAttributeToExaleadDataFormat:function(t){var i={children:null},a={};for(var r in t)if(t.hasOwnProperty(r))if("nls_label"===r)a["ds6w:label"]=t[r],i.label=t[r];else if("nls_hasDefault"===r)a.hasDefault=t[r];else if("isInDico"===r)a.isInDico=t[r];else if("name"===r)a.Name=t[r];else if("nls_predicate"===r)a.Predicates=t[r];else if("default"===r)a.DefaultValue=t[r];else if("description"===r)a.Description=t[r];else if("nls_type"===r)a.Type=t[r],i.type=t[r];else if("nls_dimension"===r)a.Dimensions=t[r],t.manipulationUnit&&t.manipulationUnit.length>0&&(a.Dimensions+="("+t.manipulationUnit+")");else if("origin"===r)a.origin=t[r],i.origin=t[r];else if("range"===r){var o=t[r];(o="string"==typeof o?JSON.parse(o):o).forEach(function(e){if("between"==e.operator){var t=e.value.split(" ");a.Minimum=t[0],a.Maximum=t[2]}else a.AuthorizedValues?a.AuthorizedValues+=","+e.value:a.AuthorizedValues=e.value})}else"valuetype"===r?a.IsMultivalue=t[r]&&"multival"==t[r]?n.VALUE_TYPE_TRUE:n.VALUE_TYPE_FALSE:"nls_isParametric"===r&&(a.attrIsParametric=t[r]);return i.icons=[e.getWebappsAssetUrl("ClassificationEditor","icons/attributes.png")],i.grid=a,i.padgrid={"ds6w:leaf":"False","ds6w:root":"True"},i},convertExpandToSearchFormat:function(e,t){var i=[];return t.forEach(function(t){var a=!1;t.attributes&&t.attributes.forEach(function(t){"physicalid"===t.name&&t.value!=e&&(a=!0)}),a&&i.push(t)}),i},convertNavigateToSearchFormat:function(e){var t=[],i=e[0].outputs.GET_CONTENT;return i&&i.forEach(function(e){var i=[];for(var a in e)i.push({name:a,value:e[a]});t.push({attributes:i})}),t},convertNavigateToFlatFormat:function(e,t){var i=[];if(t.length<=0)return i;for(var a=t[0],r=a.input_object,n=a.outputs,o=e,s=0;o>0;o--){var l=n["GET_PARENT_"+o+"_LIBRARY"];l&&((l=l[0]).level=s++,i.push(l))}return i.push(r),i},getLibraryDepth:function(e){var t=e.results[0].attributes,i=[];return t.forEach(function(e){"classification"===e.name&&i.push(e.value)}),i.length+1},getPathsAndObjectsFromExpand:function(e){if(e&&!(e.length<=0)){for(var t=[],i={},a={},n={},o=0,l=e.length;o<l;++o){var c=e[o];if(c.attributes){for(var d,u,f=!0,m=0,p=c.attributes.length;m<p;++m)"physicalid"===c.attributes[m].name?(f=!1,u=c.attributes[m].value):"did"===c.attributes[m].name&&(d=c.attributes[m].value);f||(i[u]=c,a[d]=u)}else if(c.path)t.push(c.path);else if(c.Path)t.push(c.Path);else if(c.icon__default_thumbnail_2d)for(var g=0;g<c.icon__default_thumbnail_2d.length;g++)for(var C=c.icon__default_thumbnail_2d[g].did,b=0;b<C.length;b++){var y=[];y.push(c.icon__default_thumbnail_2d[g].icon),y.push(c.icon__default_thumbnail_2d[g].thumbnail_2d),n[C[b]]=y}}for(var h in i)for(var v,_=i[h],S=0;S<_.attributes.length;S++)if("did"===_.attributes[S].name){v=_.attributes[S].value,_.attributes.push({name:"icons",value:n[v]});break}for(var A in i){var E=i[A],D=s.convertToExaleadDataFormatFederated(E);i[A]=D}var w=1;r.isIndexedMode()&&(w=2);var L=[];for(o=0;o<t.length;++o){var x=t[o],T=[];for(m=0;m<x.length;m+=w)T.push(a[x[m]]);L.push(T)}return{paths:L,objects:i}}}};return s}),define("DS/ClassificationEditor/utils/Library_CSO",["DS/Selection/XSO","DS/Logger/Logger","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUX/IPClassifyUXEvents","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/PADUtils/PADProbes","DS/IPClassifyUtil/IPClassifyUtility"],function(e,t,i,a,r,n,o,s){"use strict";var l=e.singleton({name:"library_cso",_logger:null,_currentLibrary:null,init:function(e){var i={areEquals:function(e,t){return e===t}};UWA.extend(i,e),this._parent(i),this._logger=t.getLogger(l);var a=this;this.onPostAdd(function(e){var t="CONTENT",i=e;UWA.is(e,"array")&&(e=e[0]),e&&UWA.is(e.getID,"function")&&e.getID()==a.getCurrentLibraryID()&&(t="TREE"),UWA.is(e)&&r.notifyLibrarySelected({context:t,selectedNode:e,allSelectNodes:i})})},addInLibraryCSO:function(e,t){if(!UWA.is(e))throw new Error("No libraryNode specified");if(!UWA.is(t))throw new Error("No context specified");var l=o.createProbe("library_addInLibraryCSO");if("TREE"==(t=t.toUpperCase())){var c=this;this.empty(!1);var d=this._currentLibrary;this._currentLibrary=e;var u=function(e,t){r.notifyCurrentLibraryChange({previousNode:e,currentNode:t}),c.add(t),l.end()};this._currentLibraryPath=[{id:e.id,type:i.getPLMTypeOfLibraryTreeNode(e),label:e.getLabel(),mxid:e.options.mxid}];var f=!1;if(i.inFamilyLibrary(e.plmType)){if(e.isVisible&&e.isVisible()&&e.getPath){var m=e.getPath();if(Array.isArray(m)&&m.length>=2&&m[0]&&"LibrarySection_AllLibraries"===m[0].plmType){this._currentLibraryPath=[];for(var p=1;p<m.length;p++){var g=m[p];this._currentLibraryPath.push({id:g.id,type:i.getPLMTypeOfLibraryTreeNode(g),label:g.getLabel()})}f=!0}}}else f=!0;f?u(d,e):a.getLibraryPathLength({ids:[e.id],onComplete:function(t){!t.results&&t.error&&(c._logger.warn("Unable to retrieve LibraryPath using Index/Search"),u(d,c._currentLibrary));var i=n.getLibraryDepth(t);if(1===i){var r={};r.id=e.id,r.type=e.plmType,r.label=e.options.label,c._currentLibrary&&r.id==c._currentLibrary.id?(c._currentLibraryPath=[],c._currentLibraryPath.push({id:r.id,type:r.type,label:r.label}),u(d,c._currentLibrary)):c._logger.log("LibraryPath returned by Index do not corresponds to the current Library")}else if(i>1){var o=i-1;a.getLibraryPath({depth:o,pid:e.id,isAuthoringMode:!s.isIndexedMode(),onComplete:function(e){var t=n.convertNavigateToFlatFormat(o,e.result);c._currentLibrary&&t[i-1].physicalid==c._currentLibrary.id&&(c._currentLibraryPath=[],t.forEach(function(e){c._currentLibraryPath.push({id:e.physicalid,type:e["ds6w:type"],label:e["ds6w:label"]})}),u(d,c._currentLibrary))},onFailure:function(e){c._logger.warn("Unable to retrieve LibraryPath using Index/Navigate"),u(d,c._currentLibrary)}})}},onFailure:function(e){c._logger.warn("Unable to retrieve LibraryPathLength using Index/Search"),u(d,c._currentLibrary)}})}else{this.empty(!1);var C=null;0===(C="array"==UWA.typeOf(e)?e:[e]).length?(null==this._currentLibrary&&(this._currentLibrary={noTree:!0,getType:function(){return"Exception"}}),this.add(this._currentLibrary),l.end()):(this.add(C),l.end())}},removeFromLibraryCSO:function(e){if(!UWA.is(e))throw new Error("No libraryNode specified");this.remove(e),0===this.getSelectedNodes().length&&e!=this._currentLibrary&&this.add(this._currentLibrary)},removeAllFromLibraryCSO:function(){this.empty(!0)},getCurrentLibrary:function(){return this._currentLibrary},getCurrentLibraryID:function(){var e=null;return this._currentLibrary&&this._currentLibrary.getID&&(e=this._currentLibrary.getID()),e},getCurrentLibraryPath:function(){var e=[];return this._currentLibraryPath&&this._currentLibraryPath.forEach(function(t){e.push({id:t.id,type:t.type,label:t.label})}),e},getSelectedNodes:function(){var e=[];return this.get()&&this.get().forEach(function(t){t.getIconUrl=function(){return""},e.push(t)}),e},getSelectedNodesID:function(){var e=[];return this.get()&&this.get().forEach(function(t){e.push(t.getID())}),e},getCAChangeAccessOnClass:function(e){return!!this.CAChangeAccess&&this.CAChangeAccess[e]},setCAChangeAccessOnClass:function(e,t){this.CAChangeAccess={},this.CAChangeAccess[e]=t}});return l}),define("DS/ClassificationEditor/dataProvider/LibraryCSODataProvider",["UWA/Class","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUX/utils/IPClassifyWidgetData"],function(e,t,i){"use strict";return e.singleton({getCurrentObject:function(){return t.getCurrentLibrary()},getCurrentObjectPath:function(){return t.getCurrentLibraryPath()},addInCSO:function(e,i){t.addInLibraryCSO(e,i)},getSelectedNodes:function(){return t.getSelectedNodes()},getSelectedNodesID:function(){return t.getSelectedNodesID()},removeBroadcast:function(){if(1==i.getWidgetData().currentWidgetTab)return!1}})}),define("DS/ClassificationEditor/commands/ActionBar_AddToFavoritesCmd",["UWA/Core","DS/ApplicationFrame/CommandCheckHeader","DS/ClassificationEditor/utils/Library_CSO","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/LibraryTypeService"],function(e,t,i,a,r,n){"use strict";return t.extend({labelTopBar:a.label_ActionBar_AddToFavorites,isInsert:!0,datas:{},init:function(t){this._parent(t,{});var o=this;i.onChange(function(){o._adaptStateToCurrentLibrary()}),this.onStateChange(function(){if(o.getState()){if(t=i.getCurrentLibrary()){s=t.getID(),l=t.getType(),c=t.options.label;if(s&&n.inFamilyLibrary(l))if(e.is(r.getTreeCont()))0==r.getTreeCont().isLibraryAmongFavoriteLibraries(s)&&r.getTreeCont().addFavorite({id:s,name:c})}o.labelTopBar=a.label_ActionBar_RemoveFromFavorites}else{var t;if(t=i.getCurrentLibrary()){var s=t.getID(),l=t.getType(),c=t.options.label;if(s&&n.inFamilyLibrary(l))if(e.is(r.getTreeCont()))if(1==r.getTreeCont().isLibraryAmongFavoriteLibraries(s))!1===r.getTreeCont().removeFavorite({id:s,name:c})&&o.setState(!0,!1)}o.labelTopBar=a.label_ActionBar_AddToFavorites}})},_adaptStateToCurrentLibrary:function(){var t=i.getCurrentLibrary();if(t&&t.getID){var a=t.getID();if(e.is(r.getTreeCont())){var n=!1;r.getTreeCont().isLibraryAmongFavoriteLibraries(a)&&(n=!0),this.setState(n,!1)}}}})}),define("DS/ClassificationEditor/utils/ClassificationEditorUtil",["UWA/Utils","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/events/IPClassifyEvents","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/PADUtils/PADSettingsMgt","DS/IPClassifyUtil/IPClassifyPreference","DS/IPClassifyUX/utils/IPClassifyWidgetData"],function(e,t,i,a,r,n,o,s,l,c,d,u,f){var m={nameRules:{maxLength:127},shouldBeEditable:function(e){return!1},prohibitedOperations:{},updatedNodes:{},oldNodeValues:{},getProhibitedOperations:function(){return this.prohibitedOperations},getOldNodeValues:function(){return this.oldNodeValues},getUpdatedNodes:function(){return this.updatedNodes},emptyProhibitedOperations:function(){this.prohibitedOperations={}},emptyOldNodeValues:function(){this.oldNodeValues={}},emptyUpdatedNodes:function(){this.updatedNodes={}},storeOldNodeValues:function(e,t){this.oldNodeValues[e]=t},cleanValues:function(e){var t={};for(let i in e){let a=e[i],r={};for(let e in a)"value"!=e&&(r[e]=null!=a[e]?a[e]:"");Object.keys(r).length>0&&(t[i]=r)}return t},uppendChangestoList:function(e){if(e&&e.Name){let i=this.updatedNodes[e.Name];if(!i){var t=e.attrType.charAt(0).toUpperCase()+e.attrType.slice(1);i={Name:e.Name,Owner:"ClassificationAttributes",Nature:"Attribute",Type:"Real"==t?"Double":t},"String"==t&&(i.MaxLength="0")}e.nameNLS&&!i.NameNLS&&(i.NameNLS=e.nameNLS),Object.keys(e.nlsRanges).length>0&&(i.AuthorizedValuesNLS=e.nlsRanges);let a=e.authorizedValues?e.authorizedValues.split(";"):[],r=e.originalRange?e.originalRange:[];a.length>0&&(i.AuthorizedValues||(i.AuthorizedValues=[],i.HasRangeDefined="Yes"),a.forEach(function(e){var a="";if("Real"==t||"real"==t||"Double"==t||"double"==t){for(var n in r)if(Number(r[n])==Number(e)){a=r[n];break}0==a.length&&(a="add:"+e)}else a=r.includes(e)?"":"add:"+e;0==a.trim().length||i.AuthorizedValues.includes(a.trim())||i.AuthorizedValues.push(a.trim())})),this.updatedNodes[e.Name]=i}},onNodeModelUpdate:function(e){var s=e.data.nodeModel;if(1==f.getWidgetData().currentWidgetTab){if(s){var l=this.updatedNodes[s.options.grid.Name];if(l||(l={Name:s.options.grid.Name,Nature:"Attribute"}),e.data.attributes)for(let t in e.data.attributes)if("DefaultValue"==t){var d=e.data.attributes[t];try{if("date/time"==e.data.nodeModel.options.grid.values.type||"timestamp"==e.data.nodeModel.options.grid.values.type){let e=new Date(d.toDateString()+" 10:00:00 GMT");d=Math.floor(e.getTime()/1e3).toString()}l.Default=d,l.HasDefault="Yes"}catch(e){console.log("date format error :"+l.Default)}}else if("AuthorizedValues"==t){let i=e.data.attributes[t]?e.data.attributes[t].split(","):[];if(i.length>0){l.AuthorizedValues=[];var u=this.oldNodeValues[s.options.grid.Name];if(u){var p=u.split(","),g=this.prohibitedOperations.removeRangeNotAllowed;if(g||(g=this.prohibitedOperations.removeRangeNotAllowed=[]),p.some(function(e){return!i.includes(e)}))g.includes(s.options.grid.Name)||g.push(s.options.grid.Name);else{var C=g.indexOf(s.options.grid.Name);g.splice(C,1),0==g.length&&(this.prohibitedOperations={},i.forEach(function(e){l.AuthorizedValues.push("add:"+e)}),l.AuthorizedValues.length>0&&(l.HasRangeDefined="Yes"))}}}}else if(t.startsWith("nls_")){l.NameNLS||(l.NameNLS={en:s.options.grid.nls_EN,fr:s.options.grid.nls_FR,de:s.options.grid.nls_DE,ja:s.options.grid.nls_JA,ko:s.options.grid.nls_KO,ru:s.options.grid.nls_RU,zh:s.options.grid.nls_ZH});let i=t.split("_")[1].toLowerCase();l.NameNLS[i]=e.data.attributes[t]}}(l.NameNLS&&Object.keys(l.NameNLS).length>0||"Yes"==l.HasRangeDefined||"Yes"==l.HasDefault)&&(this.updatedNodes[s.options.grid.Name]=l)}else{if(!i.inFamilyLibrary(s.plmType))return;var b=s._lastUpdateTime?s._lastUpdateTime:0,y=Date.now()-b;if(s._lastUpdateTime=Date.now(),console.log("lastUpdateTime : "+b+", elapsedTime : "+y),0!==b&&y<300)return;if(s._resetting)return void(s._resetting=!1);var h=s.getID(),v=s.options.label,_=s.options.oldLabel;if(void 0===_&&(_=""),v===_)return;v&&v.trim&&(v=v.trim());var S=!0;if(v.length>m.nameRules.maxLength&&(a.displayNotification({message:n.replace(n.get("msg_error_name_maxlength"),{name:v,maxLength:m.nameRules.maxLength}),className:"error"}),S=!1),0==v.trim().length&&(a.displayNotification({message:n.get("msg_error_name_empty"),className:"error"}),S=!1),S)if(s.isFavorite){if(UWA.is(o.getTreeCont())){var A={id:h,name:_};o.getTreeCont().renameFavorite(A,v,s)}}else t.setProperties({pid:h,plmType:s.plmType,properties:{title:v},onComplete:function(e){var t;"RootLibrary"===s.plmType?t=n.replace(n.get("msg_info_renameLibrary"),{name1:_,name2:v}):"Library"===s.plmType&&(t=n.replace(n.get("msg_info_renameClass"),{name1:_,name2:v})),c.setAuthoringMode("authoring",t),c.updateRefreshTime(),s.options.oldLabel=v,r.notifyLibraryRename({oldNode:s,newLabel:v});var i={},a=[];a.push(h),i.modified=a,i.fromRenameOp=!0,o.getContent()._libraryContentView.getPADTreeDocument().refreshNodeById(i)},onFailure:function(e){a.displayNotification({message:n.replace(n.get("msg_error_rename"),{name1:_}),className:"error"}),s._resetting=!0,setTimeout(function(){s.withTransactionUpdate(function(){this.setLabel(_)}),s._resetting=!1})}});else s.withTransactionUpdate(function(){this.setLabel(_)})}},getCurrentSecurityContextAndLibraryData:function(e){var t=s.getCurrentLibrary(),a=d.getSetting("pad_security_ctx"),r=widget.getValue("pad_tenant"),n={From:"ClassificationEditor",LibraryID:null,LibraryType:null,IsInDeletedItems:!1,Timestamp:Date.now(),Tenant:r,SecurityContext:a};return t&&(i.inFamilyLibrary(t.plmType)||e)&&(n.LibraryID=t.getID(),n.LibraryType=t.getType()),n},sortColumn:function(e,t){var a=i.inFamilyLibrary(e.plmType),r=i.inFamilyLibrary(t.plmType);return a&&!r?-1:!a&&r?1:0},setLeftPanelStatus:function(e){u.set("classEditor_view_status",{leftPanelState:e},!0,!1)},setRightPanelStatus:function(e){u.set("classEditor_view_status",{rightPanelState:e},!0,!1)},getLeftPanelStatus:function(){return new Promise(function(e){u.get("classEditor_view_status",function(t){t&&t.hasOwnProperty("leftPanelState")?e(t.leftPanelState):e({leftPanelState:!0,isWelcomePanelCollapsed:!1})},!0)})},getRightPanelStatus:function(){return new Promise(function(e){u.get("classEditor_view_status",function(t){t&&t.hasOwnProperty("rightPanelState")?e(t.rightPanelState):e({rightPanelState:!1,size:250})},!0)})},sortAttributeColumn:function(e,t,i){var a=e.options.grid[i.order_field]?e.options.grid[i.order_field]:"",r=t.options.grid[i.order_field]?t.options.grid[i.order_field]:"",n=a.localeCompare(r);return"asc"===i.order_by?n:-n},CONTENT_TABS:{CLASSES:0,CLASSIFICATION_ATTRIBUTES:1,LIBRARIES:0,EXCEPTIONS:1},CURRENT_TAB_VALUE:0};return m}),define("DS/ClassificationEditor/dataProvider/ClassificationTabBarProvider",["UWA/Class","DS/ClassificationEditor/utils/ClassificationEditorUtil","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e,t,i,a){"use strict";return e.singleton({getTabBars:function(){var e=[],a={};a.tabOptions={label:i.library_tab,value:t.CONTENT_TABS.LIBRARIES,icon:{iconName:"library",fontIconFamily:WUXManagedFontIcons.Font3DS}},a.showTreeView=!0,a.plmType="LibrarySection_AllLibraries",e.push(a);var r={};return r.tabOptions={label:i.exception_tab,value:t.CONTENT_TABS.EXCEPTIONS,icon:{iconName:"attributes-cog",fontIconFamily:WUXManagedFontIcons.Font3DS}},r.showTreeView=!1,r.plmType="LibrarySection_AllExceptions",e.push(r),e},updateLayoutOnTabChange:function(e){t.CURRENT_TAB_VALUE=e,a.getWidgetRefresh()({reInitialize:!0})}})}),define("DS/ClassificationEditor/ActionBar/ClassificationCommandManager",["UWA/Class","DS/ApplicationFrame/CommandsManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUX/IPClassifyUXEvents","DS/IPClassifyUXUtil/ActionBar/IPCommandManager","DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/IPClassifyUX/events/IPClassifyEvents","DS/IPClassifyUtil/IPClassifyUtility","text!DS/ClassificationEditor/assets/ClassificationProbesCommandMapping.json"],function(e,t,i,a,r,n,o,s,l,c,d,u){"use strict";var f={},m=JSON.parse(u);return e.singleton(o,{noSizeToFit:["classificationLocation"],initialize:function(){var e=this;this.enableAllCommands(!1),r.onEmpty(()=>{e.enableAllCommands(!1)});var t=new Promise(e=>{require(["text!DS/ClassificationEditor/assets/afr/ClassificationEditor.json"],e)});return new Promise(e=>{t.then(t=>{var i={};if(t)for(var a in(i=JSON.parse(t)).headers){i.headers[a].ID=a}f=i.Rules,e(i)})})},revaluateContentValue:function(e,t){if(!0===e.CONTENT)return!0;if(!t.checkWhiteClick&&!t.isFavoriteNode&&t.isCtxMenu&&!1===e.CONTENT.ctxMenu)return!1;var i=!0;if(!1!==i&&e.CONTENT.filter){var a=e.CONTENT.filter;t.isCtxMenu&&a.ctxMenuRestictTo&&Array.isArray(a.ctxMenuRestictTo)&&(i=a.ctxMenuRestictTo.includes(t.plmType)),!1!==i&&a.ctxMenuOnly&&Array.isArray(a.ctxMenuOnly)&&(i=!a.ctxMenuOnly.includes(t.tab)||1==t.isCtxMenu)}return!1!==i&&1==e.CONTENT.favCtxMenuOnly&&(i=t.isCtxMenu&&!t.isMultiSelect&&t.isFavoriteNode),!1!==i&&(!0===e.CONTENT.FavContent?i=t.isFavSection:!1===e.CONTENT.FavContent&&(i=!t.isFavSection)),!1!==i&&(!0===e.CONTENT.RootLibraries?i=t.isRoot:!1===e.CONTENT.RootLibraries&&(i=!t.isRoot||1==t.isCtxMenu&&1==t.isFavoriteNode)),!1!==i&&(!0===e.CONTENT.Libraries?i=t.isLibrary:!1===e.CONTENT.Libraries&&(i=!t.isLibrary)),!1!==i&&(!0===e.CONTENT.FavNode?i=t.isFavoriteNode:!1===e.CONTENT.FavNode&&(i=!t.isFavoriteNode)),!1!==i&&1==t.isCtxMenu&&t.isFavoriteNode&&e.CONTENT&&!0===e.CONTENT.ctxFavOnMultiSel&&(i=!0),i},revaluateTreeValue:function(e,t){if(!0===e.TREE)return!0;if(!t.checkWhiteClick&&!t.isFavoriteNode&&t.isCtxMenu&&!1===e.TREE.ctxMenu)return!1;var i=!0;if(e.TREE.filter){var a=e.TREE.filter;t.isCtxMenu&&a.ctxMenuRestictTo&&Array.isArray(a.ctxMenuRestictTo)&&(i=a.ctxMenuRestictTo.includes(t.plmType)),!1!==i&&a.ctxMenuOnly&&Array.isArray(a.ctxMenuOnly)&&(i=!a.ctxMenuOnly.includes(t.tab)||1==t.isCtxMenu)}return!1!==i&&(!0===e.TREE.Sections?i=t.isSection:!1===e.TREE.Sections&&(i=!t.isSection)),!1!==i&&(!0===e.TREE.RootLibraries?i=t.isRoot:!1===e.TREE.RootLibraries&&(i=!t.isRoot)),!1!==i&&(!0===e.TREE.Libraries?i=t.isLibrary:!1===e.TREE.Libraries&&(i=!t.isLibrary)),!1!==i&&(!0===e.TREE.FavSection?i=t.isFavSection:!1===e.TREE.FavSection&&(i=!t.isFavSection)),!1!==i&&(!0===e.TREE.FavNode?i=t.isFavoriteNode:!1===e.TREE.FavNode&&(i=!t.isFavoriteNode)),i},_manageSwitchOfCommands:function(e,t,i,r){var n=!1,o=i&&!!t&&0===t.length;!e||t&&0!=t.length||o?t&&t.length>0&&(n=t[0].isFavorite):n=e.isFavorite;var s=l.getWidgetData().currentTab,c=l.getWidgetData().currentWidgetTab,d=l.getWidgetData().isEditMode,u=l.getWidgetData().isReadOnly,m=!1,p=!1,g=!1,C=!1,b=!1,y=!1;e&&(b="LibrarySection_favorite"==e.plmType,y="LibrarySection_AllLibraries"==e.plmType,g=a.isRootLibrary(e.plmType),C=a.isLibrary(e.plmType));var h=b||y,v=!1;t&&t.every(function(e){return m=m||a.isRootLibrary(e.plmType),p=p||a.isLibrary(e.plmType),v=v||"Busy"===e.plmType,!m||!p||!v});var _=!0;if((b||v||(y||!e)&&t&&0===t.length)&&(_=!1),i||this.enableAllCommands(_),!v){var S={},A=Object.keys(f);r&&(A=r);var E={};return E.isSection=h,E.isFavSection=b,E.isCtxMenu=i,E.isFavoriteNode=n,E.checkWhiteClick=o,E.tab=s,A.forEach(a=>{var r=f[a];if(r){var l=t&&t.length>0||1==c,b=e&&1!=e.noTree&&(!l||void 0===r.CONTENT),y=!0;"object"==typeof r&&(y&&"edit"==r.WIDGET_MODE&&(y=d),!y||r.WIDGET_MODE&&"view"!=r.WIDGET_MODE||(y=!d||0==c),y&&null!=r.WIDGET_TAB&&(y=r.WIDGET_TAB==c),y&&r.TABS&&Array.isArray(r.TABS)&&(y=r.TABS.includes(s)),(y&&!1===r.TREE&&b||!1===r.CONTENT&&l)&&(y=!1),y&&o&&(y=1==r.white_click||r.white_click==e.plmType||r.white_click===s),y&&void 0!==r.multisel&&(y=!t||t.length<=1),y&&!1===r.NoSelection&&(y=t&&t.length>0),y&&i&&n&&!0!==r.ctxFavorite&&(y=t&&t.length>1&&1==r.CONTENT.ctxFavOnMultiSel),y&&!1===r.CATIAV6&&(y=!0!==widget.getValue("noCompass")),y&&!0===r.roleCheck&&(y=!u),y&&r.TREE&&b&&(E.plmType=e.plmType,E.isRoot=g,E.isLibrary=C,b=this.revaluateTreeValue(r,E)),y&&r.CONTENT&&l&&(E.plmType=t[0]?t[0].plmType:"Attribute",E.isRoot=m,E.isLibrary=p,E.isFavoriteNode=n,E.isCtxMenu=i,E.isMultiSelect=t&&t.length>1,l=this.revaluateContentValue(r,E)),y=y&&(!0===l||!0===b||null===l&&null===b||!1===l&&!1===b&&1==r.noSelection)),S[a]=y,(!i||r.TREE.filter&&r.TREE.filter.ctxMenuOnly||r.CONTENT.filter&&r.CONTENT.filter.ctxMenuOnly||o)&&this._switchCommand(a,y,r.type),i||"openWith"!==a||this.getModelEvents().publish({event:"build_openwith",data:{visible:y,nodes:l?t:[e]}})}}),S}},enableAllCommands:function(e){var i=t.getCommands();for(var a in i){var r=t.getCommand(a);UWA.is(r)&&r.enable&&(e?this._switchCommand(a,!0):this._switchCommand(a,!1))}},getModelEvents:function(){return s.getModelEvents()},updateCommands:function(e,t){if(t||(t=r.getCurrentLibrary()),i.getContent()&&i.getContent().getView().getPADTreeDocument()){a=(a=i.getContent().getView().getPADTreeDocument().getSelectedNodes())||(e?[e]:[]),this._parent(t,a)}else{var a=[];try{a=(a=i.getContent().getView().getPADTreeDocument().getSelectedNodes())||(e?[e]:[])}catch(e){}this._parent(t,a)}},launchCommand:function(e,t,i,a){let r=e;m&&m[e]&&(r=m[e]),"ContextualMenu"===a?d.sendTrackerPageEvent("ClassificationWidget_contextual",r):d.sendTrackerPageEvent("ClassificationWidget_iconBar",r),this._parent.apply(this,arguments)}})}),define("DS/ClassificationEditor/dataProvider/LibraryIdCardDataProvider",["UWA/Class","UWA/Class/Promise","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUX/utils/IPClassifyWidgetData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s,l){"use strict";return e.singleton({getChildrenInfos:function(e){return new t(function(t){var n=i.getTreeCont()._getVisibleNodeById(e);if(n){var o=n.getChildren();t(o)}else a.libraries({pid:e,onComplete:function(i){var a=[];i.results?a=r.convertExpandToSearchFormat(e,i.results):i.result&&(a=r.convertNavigateToSearchFormat(i.result)),a.forEach(function(e){e.plmType=e.plmType||"Library"}),t(a)},onFailure:function(e){console.warn("WebService libraries Err : "+e),t([])}})})},isSection:function(e){return"LibrarySection_favorite"==e||"LibrarySection_AllLibraries"==e},needSep:function(){if(this.showSeachCommand())return!1},showSeachCommand:function(){var e=s.getWidgetData().currentWidgetTab;let t=s.getIsEditModeEnabled();return 1===e&&!t},showInformationCommand:function(){return 0===s.getWidgetData().currentWidgetTab},getStableAreaWidth:function(){var e=s.getWidgetData();if(0!==e.currentWidgetTab){let t=e.isLeader,i=e.isReadOny;return!t||i?77:s.getIsEditModeEnabled()?49:130}return 0===e.currentTab?143:1===e.currentTab?105:void 0},searchMatchCriteria:function(e,t){var i=!1,a=new RegExp(e,"i");return(a.test(t.nodeModel.options.grid.Name)||a.test(t.nodeModel.options.grid.nls_DE)||a.test(t.nodeModel.options.grid.nls_EN)||a.test(t.nodeModel.options.grid.nls_FR)||a.test(t.nodeModel.options.grid.nls_JA)||a.test(t.nodeModel.options.grid.nls_KO)||a.test(t.nodeModel.options.grid.nls_RU)||a.test(t.nodeModel.options.grid.nls_ZH))&&(i=!0),i},getClassAttributeSearch:function(e){var t=this;e=e||"";var a=i.getContent().getView().getPADTreeDocument();a.withTransactionUpdate(function(){var i=!0;a.search({match:function(a){t.searchMatchCriteria(e,a)?(a.nodeModel.show(),e.length>0&&i?(a.nodeModel.matchSearch(),i=!1):(a.nodeModel.unmatchSearch(),a.nodeModel.unselect())):(a.nodeModel.unmatchSearch(),a.nodeModel.unselect(),a.nodeModel.hide())}})})},isSearchInContextAvailable:function(){return!1},getLibraryControl:function(){return i},getCommandManager:function(){return n},getLibraryTypeService:function(){return o}})}),define("DS/ClassificationEditor/commands/ActionBar_EditAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/PADUtils/PADContext","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassificationAttributes/utils/EventHandler"],function(e,t,i,a,r,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Edite Class Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){n.emptyUpdatedNodes();var e=a.get(),t=e.options.views?e.options.views.datagridview:void 0;if(t){try{var o=t.options.dgv.layout.getColumnIndex("AuthorizedValues"),s=t.options.dgv.getRowModelLength();if(s)for(var l=0;l<s;l++){var c=t.options.dgv.layout.getCellIDFromCoordinates({rowID:l,columnID:o}),d=t.options.dgv.getCellInfosAt(c);d&&n.storeOldNodeValues(d.nodeModel.options.grid.Name,d.nodeModel.getAttributeValue("AuthorizedValues"))}}catch(e){}var u=t.options.dgvLayout.getLeafColumns();u&&Array.isArray(u)&&u.forEach(function(e){e.getCellEditableState=function(t){try{if("false"==t.nodeModel.options.grid.values.isInDico)return!1;if("DefaultValue"===e.dataIndex)return"TRUE"==t.nodeModel.options.grid.values.hasDefault}catch(e){console.log(e)}return!0===e.toggleToEdit},"AuthorizedValues"===e.dataIndex&&(e.getCellTypeRepresentation=function(e){return"url"},e.getCellValue=function(e){if(e.nodeModel)return e.nodeModel.options.grid.AuthorizedValues&&e.nodeModel.options.grid.AuthorizedValues.length>0&&"true"==e.nodeModel.options.grid.values.isInDico?{label:e.nodeModel.getAttributeValue("AuthorizedValues"),func:"valuesClickAction",module:"DS/IPClassificationAttributes/utils/EventHandler"}:{label:e.nodeModel.getAttributeValue("AuthorizedValues"),func:"",module:""}},e.setCellValue=function(e,t){if(e.nodeModel){var i={grid:{}};t.hasOwnProperty("label")&&(i.grid.AuthorizedValues=t.label),e.nodeModel.updateOptions(i)}}),"DefaultValue"===e.dataIndex&&(e.getCellTypeRepresentation=function(e){if(e.nodeModel&&e.nodeModel.options.grid.values.type){var t=e.nodeModel.options.grid.values.type;return"boolean"==t.toLowerCase()||e.nodeModel.options.grid.AuthorizedValues?"string":"date/time"==t.toLowerCase()||"timestamp"==t.toLowerCase()?"date":"real"==t.toLowerCase()?"double":e.nodeModel.options.grid.values.type.toLowerCase()}return"string"},e.getCellSemantics=function(e){if(e.nodeModel&&e.nodeModel.options.grid.values.type){if("boolean"===e.nodeModel.options.grid.values.type.toLowerCase())return{possibleValues:["false","true"]};var t=e.nodeModel.options.grid.AuthorizedValues;if(t)return{possibleValues:t.split(",")}}return{}})}),t.options.dgv.treeDocument.setUseChangeTransactionMode(!0),t.options.dgv.getModel().updateRenderedColumn("AuthorizedValues",{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1},!0),i.setIsEditModeEnabled(!0),r.updateCommands()}},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_CancelUpdatesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUX/utils/IPClassifyWidgetData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/PADUtils/PADContext","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassificationAttributes/dataprovider/DataProvider"],function(e,t,i,a,r,n,o,s,l){"use strict";return t.extend({labelTopBar:e.i18n("Undo Edit"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){i.launch({title:r.command_CancelUpdates,content:r.confirmation_cancel_attributesSure,confirmLabel:r.confirmation_ok},function(){var e=o.get(),t=e.options.views?e.options.views.datagridview:void 0;if(t){var i=t.options.dgvLayout.getLeafColumns();i&&Array.isArray(i)&&i.forEach(function(e){e.getCellEditableState=function(e){return!1},e.toggleToEdit&&!0===e.toggleToEdit&&(e.getCellTypeRepresentation=function(e){return"string"}),"AuthorizedValues"===e.dataIndex&&(e.getCellValue=function(e){if(e.nodeModel){let t=e.nodeModel.getAttributeValue("AuthorizedValues"),i=s.getOldNodeValues()[e.nodeModel.options.grid.Name];return i&&(t=i,e.nodeModel.options.grid.AuthorizedValues=t),{label:t,func:"",module:""}}})}),t.options.dgv.treeDocument.cancelChanges(),t.options.dgv.treeDocument.setUseChangeTransactionMode(!1),t.options.dgv.getModel().updateRenderedColumn("AuthorizedValues",{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1},!0),a.setIsEditModeEnabled(!1),s.emptyOldNodeValues(),s.emptyUpdatedNodes(),n.updateCommands(),s.emptyProhibitedOperations(),l.setSavedNlsRanges(void 0,{})}})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/LibraryCommands",["DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/Library_CSO","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ApplicationFrame/CommandsManager","DS/PADUtils/views/PADProgressBar","DS/WidgetServices/WidgetServices","text!DS/ClassificationEditor/assets/ClassificationProbesCommandMapping.json","DS/ClassificationEditor/ActionBar/ClassificationCommandManager"],function(e,t,i,a,r,n,o,s,l){"use strict";JSON.parse(s);return{_endProgressBarListener:function(){var e=this;a.getContent().getView().addEvent("onCompleteRefreshNodes",function(t){this.removeEvent("onCompleteRefreshNodes"),e._offProgressBar()})},_offProgressBar:function(){if(0===n._counter)return null;n.off()},_commonError:function(t,i,a){console.error(t,a);var r=i;!UWA.is(a)||a instanceof Error||(r+="<br>"+a),e.displayNotification({message:r,className:"error"})},_startProgressBar:function(e){1===n._counter&&n.off(),n.on(e)},_nbItemsNotNull:function(e){var t,i=e.length,a=0;for(t=0;t<i;++t)e&&a++;return a},convertSystemError:function(e){return-1!=e.indexOf("No fromconnect access to business object")?i.error_no_fromconnect_onParent:(console.error("Unexpected Error:: "+e),i.error_unexpected)},extractMyErrorMessage:function(e,t,a){var r=e;return e&&"timeout"===e.type?r=i.msg_InfoAction_Timeout:t&&(a&&"application/json"===a["content-type"]?(t="string"==typeof t?JSON.parse(t):t).error&&t.error.message&&(r=t.error.message):r="User doesnt have Librarian Role"===t?i.error_no_LibrarianRole:"string"==typeof t&&0===t.indexOf("System Error:")?this.convertSystemError(t):t),r},RenameCmd:function(e,t){if("CONTENT"==t){var i=e.manager.layout.getColumnIndex("tree"),a=e.manager.layout.getCellsFromNodeModel(e.nodeModel)[i],r=e.manager.getEditionManager(a);r.onF2&&(e.manager.setActiveCell(a),r.onF2(a))}else{var n=e.manager.layout.getColumnIndex("tree");a=e.manager.layout.getCellIDFromCoordinates({rowID:e.rowID,columnID:n});e.manager.setCellInEdition(a)}},CreateLibraryCmd:function(e,t){var i=r.getCommand("CreateNewLibrary",a.getContent());i&&i.begin()},ImportLibraryCmd:function(e,t){var i=r.getCommand("ImportLibrary",a.getContent());i&&i.begin()},ExportLibraryCmd:function(e,t){var i=r.getCommand("ExportLibrary",a.getContent());i&&i.begin()},DeleteLibraryCmd:function(e,t){var i=r.getCommand("DeleteLibrary",a.getContent());i&&i.begin()},CreateClassCmd:function(e,t){var i=r.getCommand("CreateNewClass",a.getContent());i&&i.begin()},DeleteClassCmd:function(e,t){var i=r.getCommand("DeleteClass",a.getContent());i&&i.begin()},MoveClassCmd:function(e,t){var i=r.getCommand("MoveClass",a.getContent());i&&i.begin()},ExpandAllCmd:function(a,r){a.plmType;var n=[];"TREE"===r&&a?n.push(a):n=t.getSelectedNodes();var o=null;o=t.getCurrentLibrary(),n.length?n.forEach(function(e){null===e.options.children||e.expandAll()}):null===o?e.displayNotification({message:i.msg_warning_nocurrentlibrary,className:"warning"}):o.expandAll()},CollapseAllCmd:function(a,r){a.plmType;var n=[],o=t.getCurrentLibrary();"TREE"===r&&a?n.push(a):n=t.getSelectedNodes(),n.length?n.forEach(function(e){e.collapseAll()}):null===o?e.displayNotification({message:i.msg_warning_noselection,className:"warning"}):o.collapseAll()},ChangeMaturityCmd:function(e,t){var i=r.getCommand("MaturityHdr",a.getContent());i&&i.begin()},AccessRightCmd:function(e,t){var i=r.getCommand("ActionBar_AccessRightCmd",a.getContent());i&&i.begin()},Information:function(){var e=a.getContent()._infoPanelView;e._context.elements.padshell._isRightOpen||e._modelEv.publish({event:"information-panel-open"})},RemoveFavoriteCmd:function(e,t){var i=e;if(console.log("  RemoveFavoriteCmd currentFavoriteTreeNode : ",i),i&&i.isFavorite){var r=i.getID(),n=i.options.label;console.log("  currentLibrary Id : ",r),r&&UWA.is(a.getTreeCont())&&a.getTreeCont().removeFavorite({id:r,name:n})}},AddExistingAttributesCmd:function(e,t){var i=r.getCommand("AddExistingAttributes",a.getContent());i&&i.begin()},RemoveAttributesCmd:function(e,t){var i=r.getCommand("RemoveAttributes",a.getContent());i&&i.begin()},GetContextualMenuForAttributes:function(e,i,a){var r=!0===(!!e.white_Click&&e.white_Click)?r=t.getCurrentLibrary():e.nodeModel;return void 0===r&&(r=e),Array.isArray(r)||(r=[r]),"CONTENT"===i?(a||(a={cellInfos:e,data:{event:{pageX:0,pageY:0}}}),Promise.resolve(l.getContextualMenu(r,!1,a))):Promise.resolve([])},GetContextualMenu:function(e,i,r){var n,o=!!e.white_Click&&e.white_Click,s=r?a.getContent().getView().getPADTreeDocument().getSelectedNodes():[];try{n=!0===o?n=t.getCurrentLibrary():s&&s.length>0?s:e.nodeModel}catch(e){n=void 0}return void 0===n&&(n=e),Array.isArray(n)||(n=[n]),r||(r={cellInfos:e,data:{event:{pageX:0,pageY:0}}}),l.getContextualMenu(n,"TREE"===i,r)},_checkTypeAvailability:function(e,i){if(i){var a=i.managedTypes;if(a){var r=null;if(r="TREE"===e?(r=t.getCurrentLibrary())?[r]:[]:t.getSelectedNodes())for(var n=!0,o=0;o<r.length;++o){var s=r[o];if(!(n=!(!s.options||!s.options.type)&&a.indexOf(s.options.type)>-1))return n}}}return!0},_addCtxCmd:function(e,t,i){var a=!0;o.isNatifEnvironnement()?0==i.nativeAvailability?a=!1:o.isWebInWinEnvironment()||0==i.v6Availability&&(a=!1):0==i.dashboardAvailability&&(a=!1),a&&(a=this._checkTypeAvailability(e,i)),a&&t.push(i)},_addCtxCmdAsync:function(e,t,i){var a=this._checkTypeAvailability(e,i);return new Promise(function(e){a?i.addMenus(t).then(function(t){e(t)}):e(t)})},_addHiddenInput:function(e){var t=a.getContent().getView();UWA.createElement("a",{href:e,styles:{display:"hidden"}}).inject(t.elements.container).click()}}}),define("DS/ClassificationEditor/commands/ActionBar_ExportClassificationAttributes",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n){"use strict";return t.extend({labelTopBar:e.i18n("Export Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},execute:function(){var e=this;r._startProgressBar(n.msg_exportAttributes_loading),e.disable(),i.exportClassificationAttributes({onComplete:function(t){var i=document.createElement("a");i.href=window.URL.createObjectURL(t),i.download="ClassificationAttributesExport.zip",i.dispatchEvent(new MouseEvent("click")),r._offProgressBar(),e.enable()},onFailure:function(t,i,o){var s=n.exportFail;null!=t&&0!==t.length&&(s+=": "+t),a.displayNotification({message:s,className:"error"}),r._offProgressBar(),e.enable()}})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_CollapseAllCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/Library_CSO"],function(e,t,i,a){"use strict";return t.extend({labelTopBar:e.i18n("Collase All"),isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=a.getSelectedNodes();if(e.length){var t=e[0];i.CollapseAllCmd(t,"CONTENT")}else{var r=a.getCurrentLibrary();i.CollapseAllCmd(r,"TREE")}},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_ImportLibraryStructureCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADUtilsServices"],function(e,t,i,a,r,n,o,s,l,c){"use strict";return t.extend({labelTopBar:e.i18n("Add Existing Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),this.importPanel=null},beginExecute:function(){},execute:function(){var e=this;require(["DS/PADServices/utils/GlobalModelEvents","DS/IPClassifyUXUtil/FileImportPanel","DS/ClassificationEditor/utils/Library_CSO"],function(t,n,c){var d=c.getCurrentLibrary(),u=t.getModelEvents();e.importPanel=new n({panelHeaderName:l.importLibraryPanelHeader,panelHeaderIcon:{iconName:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-import",fontIconFamily:WUXManagedFontIcons.Font3DS},modelEvents:u,validateFile:e.validateFile,downloadErrorReport:e.downloadErrorReport,closePanelEvent:"AddExistingAttributesCmd/Views/showInWidgetBody",importFileEvent:"ImportLibraryStructureXML/SelectedFileContent",validationInProgressMsg:l.validateLibrary_loading});var f=[];f.push(u.subscribe({event:"ImportLibraryStructureXML/SelectedFileContent"},function(t){t.isValidate||r._startProgressBar(l.importLibrary_loading),e.disable(),i.importLibraryStructure({fileContent:t.selectedFileContent,isValidate:!1,onComplete:function(i){var n=i?JSON.parse(i):void 0;if(n&&n.ErrorDescription){var c=n.ErrorDescription;n.MissingAttributes&&(e.downloadErrorReport(c,t.fileName,n.MissingAttributes),c=l.msg_importLibrary_failedSeeReport+" ImportLibrary_ErrorReport.txt"),a.displayNotification({title:l.get("msg_importLibrary_failed"),message:c,className:"error"})}else{o.setAuthoringMode("authoring",l.msg_importLibrary_success);var u=s.getTreeCont().getView()._rootNodeLibraries;u.isExpanded()&&(s.getTreeCont().performOperationOnNode(u,"collapse"),s.getTreeCont().performOperationOnNode(u,"expand")),n&&n.LibraryMxID&&u.isSelected()&&s.getContent().loadContentAndSelect(d)}r._offProgressBar(),e.enable()},onFailure:function(t,i,n){var o=r.extractMyErrorMessage(t,i,n);a.displayNotification({message:l.msg_importLibrary_failed+o,className:"error"}),r._offProgressBar(),e.enable()},onTimeout:function(t,i){a.displayNotification({message:l.command_importLibrary+": "+l.msg_InfoAction_Timeout,className:"warning"}),r._offProgressBar(),e.enable()}})})),f.push(u.subscribe({event:"AddExistingAttributesCmd/Views/showInWidgetBody"},function(e){!0===e.restore&&f.forEach(function(e){u.unsubscribe(e)})}))})},validateFile:function(e){var t=this;return new Promise(function(a){var n={};i.importLibraryStructure({fileContent:e.selectedFileContent,isValidate:!0,onComplete:function(i){var r=i?JSON.parse(i):void 0;if(r&&r.ErrorDescription){var o=r.ErrorDescription;r.MissingAttributes&&(t.downloadErrorReport(o,e.fileName,r.MissingAttributes),o=l.msg_importLibrary_failedSeeReport+" ImportLibrary_ErrorReport.txt"),n.success=!1,n.message=l.msg_importLibrary_validationFailed+o}else n.success=!0,n.message=l.msg_importLibrary_validationSucess;a(n)},onFailure:function(e,t,i){var o=r.extractMyErrorMessage(e,t,i);n.success=!1,n.message=l.msg_importLibrary_validationFailed+o,a(n)}})})},downloadErrorReport:function(e,t,i){var a="#############################################\n\t".concat(l.msg_importLibrary_errorReportHeader).concat("\n#############################################\n-----------------------------------------------\n").concat(l.msg_importLibrary_errorReportFile).concat(t).concat("\n-----------------------------------------------\n").concat(l.msg_importLibrary_errorReportMsg).concat(e).concat(": \n");i.forEach(function(e){a=a.concat(e).concat("\n")}),c.downloadfile(a,"ImportLibrary_ErrorReport.txt","text/plain")},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_RemoveAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/service/ClassificationEditorWebService"],function(e,t,i,a){"use strict";return t.extend({labelTopBar:e.i18n("Remove Class Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),require(["DS/ClassificationEditor/commands/LibraryCommands"],function(e){})},beginExecute:function(){},execute:function(){var t=this;require(["DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(r,n,o,s,l){var c=r.getCurrentLibrary();if(c){var d=c.getID(),u=r.getCAChangeAccessOnClass(d);if(!u||"true,true"!==u&&"false,true"!==u)i._commonError("RemoveAttributes",l.command_removeAttribute+": ",l.error_noChangeAccessOnCA);else{var f=r.getSelectedNodes();if(f.length>0){var m=[],p=[];if(f.forEach(function(t){"Attribute"===t.plmType&&("Inherited"===t.options.origin||"UserAG"===t.options.origin?p.push(e.is(t.getLabel())?t.getLabel():t.id):(t.getLabel=(()=>t.options.grid.Name),m.push(e.is(t.options.grid.Name)?t.options.grid.Name:t.id)))}),m.length>0){var g=l.confirmation_remove_attributesSure;p.length>0&&(g=p.length<6?l.confirmation_remove_attributesPrefix+"<br>"+p+".<br><br>"+l.confirmation_remove_attributesSuffix:l.replace(l.confirmation_remove_attributesNumber,{number:p.length})),n.launch({title:l.command_removeAttribute,content:g,confirmLabel:l.CMDRemove},function(){i._startProgressBar(l.remove_attributes_loading),t.disable(),a.removeClassAttributes({pid:d,attributes:m,onComplete:function(e){var t={},a=JSON.parse(e),r=a?a.attributes:[];if(r&&r.length>0)for(var n=0;n<r.length;n++)t[r[n]]=!0;if(m.length>5)s.getContent().RefreshProductStructure=!0,s.getContent().loadContentAndSelect(c);else for(var d=0;d<m.length;d++){var u=m[d];t[u]||s.getContent()._libraryContentView.removeNodeInContent(u)}0===s.getContent()._libraryContentView.options.model.getAllDescendants().length&&s.getContent().getView()._addPlaceHolder(),i._offProgressBar(),r&&r.length>0?o.displayNotification({message:l.confirmation_remove_attributesPrefix+"<br>"+r,className:"error"}):o.displayNotification({message:l.replace(l.msg_info_attributeremoved,{number:m.length,libraryname:c.options.label}),className:"success"})},onFailure:function(e,a,r){var n=i.extractMyErrorMessage(e,a,r);i._offProgressBar(),t.enable(),i._commonError("RemoveAttributes",l.msg_error_removeClassAttributes,n)}})})}else{var C=l.msg_warning_noAttributeSelected;p.length>0&&(C=l.msg_remove_attributesNotPossibleHere+"\n"+l.msg_remove_attributesNotPossibleSuffix),o.displayNotification({message:C,className:"warning"})}}else o.displayNotification({message:l.msg_warning_noAttributeSelected,className:"warning"})}}else o.displayNotification({message:l.msg_warning_nocurrentlibrary,className:"warning"})})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/CtxCommands",["DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/PADUtils/PADContext"],function(e,t,i){"use strict";return e.extend({execute:function(){i.get().ctxInfo;switch(this.options.ID){case"Information":t.Information()}}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_RenameCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e,t,i,a,r){"use strict";return t.extend({labelTopBar:e.i18n("Rename"),datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=a.getSelectedNodes(),t="",n={},o="";if(e[0].pathId){t="TREE";var s=(n=r.getTreeCont().getView()._libraries_TreeView).layout.getColumnIndex("tree");o=n.layout.getCellIDFromCoordinates({rowID:e[0]._rowID,columnID:s})}else{t="CONTENT";s=(n=r.getContent().getView().getPADTreeListView().getManager()).layout.getColumnIndex("tree");o=n.layout.getCellsFromNodeModel(e[0])[s]}var l=n.getCellInfosAt(o);l.manager||(l.manager=n),i.RenameCmd(l,t)},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_SaveUpdatesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUX/utils/IPClassifyWidgetData","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/ActionBar/ClassificationCommandManager","DS/PADUtils/PADContext","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/IPClassificationAttributes/dataprovider/DataProvider","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassificationAttributes/utils/AttributesUtil","text!DS/IPClassificationAttributes/assets/IPClassificationAttributesProps.json","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e,t,i,a,r,n,o,s,l,c,d,u,f){"use strict";return t.extend({labelTopBar:e.i18n("Save Changes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=o.getProhibitedOperations();if(Object.keys(e).length>0){var t="";return Object.keys(e).forEach(function(i){t=a[i]+"<br>"+e[i].join("<br>")}),void u.displayNotification({message:t,className:"error"})}var m=o.getUpdatedNodes();if(0!=Object.keys(m).length){var p=JSON.parse(d);s.updateClassAttributes(c.formatObjectToSend(m)).then(function(e){var t=(e="string"==typeof e?JSON.parse(e):e).Dictionary.Interfaces[p.interface_name].Attributes,l=[];if(Object.keys(m).forEach(function(e){var i=m[e],a=t[e],r=t[e].Type;Object.keys(i).forEach(function(t){let n=i[t],o=a[t];if("boolean"===(r=r.toLowerCase())&&"Default"==t&&("Yes"!=o&&"No"!=o||(o="Yes"==o)),"NameNLS"==t&&o)Object.keys(n).forEach(function(t){n[t]==o[t]||l.includes(e)||l.push(e)});else if("AuthorizedValues"==t&&o){"double"==r&&(o=o.map(e=>Number(e).toString())),n.every(function(e){var t=e;return e.indexOf(":")>-1&&(t=e.split(":")[1]),"double"==r&&(t=Number(t).toString()),o.includes(t)})||l.includes(e)||l.push(e)}else"AuthorizedValuesNLS"==t&&o?Object.keys(n).forEach(function(t){let i=n[t];Object.keys(i).forEach(function(a){"value"==a||i[a]==o[t][a]||l.includes(e)||l.push(e)})}):"Default"!=t||n==o||l.includes(e)||l.push(e)})}),l&&l.length>0)u.displayNotification({message:a.confirmation_update_attributesPrefix+"<br>"+l,className:"error"});else{u.displayNotification({message:a.replace(a.msg_info_attributeUpdated,{number:Object.keys(m).length}),className:"success"});var c=n.get(),d=c.options.views?c.options.views.datagridview:void 0;if(d){var g=d.options.dgvLayout.getLeafColumns();g&&Array.isArray(g)&&g.forEach(function(e){e.toggleToEdit&&!0===e.toggleToEdit&&(e.getCellEditableState=function(e){return!1},e.getCellTypeRepresentation=function(e){return"string"}),"AuthorizedValues"===e.dataIndex&&(e.getCellValue=function(e){if(e.nodeModel)return{label:e.nodeModel.getAttributeValue("AuthorizedValues"),url:""}})}),d.options.dgv.treeDocument.acceptChanges(),d.options.dgv.treeDocument.setUseChangeTransactionMode(!1),d.options.dgv.getModel().updateRenderedColumn("AuthorizedValues",{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1},!0),f.getContent().RefreshProductStructure=!0,s.reloadCache().then(function(){f.getContent().loadContentAndSelect()},function(e){f.getContent().loadContentAndSelect()}),o.emptyOldNodeValues(),o.emptyUpdatedNodes(),o.emptyProhibitedOperations(),i.setIsEditModeEnabled(!1),r.updateCommands()}}},function(e){l._commonError("SaveUpdatesCmd",a.msg_error_updateClassAttributes,e)})}else u.displayNotification({message:a.noAttributetoUpdate,className:"warning"})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_DeleteAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassificationAttributes/utils/AttributesUtil","DS/IPClassificationAttributes/dataprovider/DataProvider","DS/IPClassifyUtil/IPClassifyUtility","UWA/Promise","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s,l,c,d,u){"use strict";return t.extend({labelTopBar:e.i18n("Delete Class Attribute"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var t=this,n=d.getContent().getView().getPADTreeDocument().getSelectedNodes();if(n.length>0){var o=[],s=[];if(n.forEach(function(t){"Attribute"===t.plmType&&("false"==t.options.grid.values.isInDico?s.push(e.is(t.options.label)?t.options.label:t.options.grid.Name):(t.getLabel=(()=>t.options.grid.Name),o.push(e.is(t.options.grid.Name)?t.options.grid.Name:t.id)))}),0==o.length&&s.length>0)return void c.displayNotification({message:u.msg_delete_attributesNotPossibleHere+"\n"+u.msg_delete_attributesNotPossibleSuffix,className:"warning"});r.attributeDeleteCheck(Object.assign({},o)).then(function(e){var n="string"==typeof e?JSON.parse(e):e,f=[];if(n.REFERENCED_ATTRIBUTES&&(n.REFERENCED_ATTRIBUTES.forEach(function(e){f.push(e.Name);var t=o.indexOf(e.Name);o.splice(t,1)}),0==o.length))c.displayNotification({message:u.replace(u.attribute_delete_forbidden,{list:"<br>"+f.join("<br>")}),className:"warning"});else{var m=u.confirmation_delete_attributesSure;(s.length>0||f.length>0)&&(m=s.length+f.length<6?u.confirmation_delete_attributesPrefix+(s.length>0?"<br>":"")+s+(f.length>0?"<br>":"")+f+".<br><br>"+u.confirmation_delete_attributesSuffix:u.replace(u.confirmation_delete_attributesNumber,{number:s.length+f.length})),l.launch({title:u.command_deleteAttribute,content:m,confirmLabel:u.CMDDelete},function(){i._startProgressBar(u.delete_attributes_loading);var e=a.buildObjectToDelete(o);r.deleteClassAttributes(e).then(function(e){e="string"==typeof e?JSON.parse(e):e;var t=Object.keys(a.extractArributesNode(e)),s=o.filter(function(e){return t.includes(e)});if(r.reloadCache(),o.length>5)d.getContent().RefreshProductStructure=!0,d.getContent().loadContentAndSelect();else for(var l=0;l<o.length;l++)s.includes(o[l])||d.getContent()._libraryContentView.removeNodeInContent(o[l]);0===d.getContent()._libraryContentView.options.model.getAllDescendants().length&&d.getContent().getView()._addPlaceHolder(),s&&s.length>0?c.displayNotification({message:u.confirmation_delete_attributesPrefix+"<br>"+s,className:"error"}):c.displayNotification({message:u.replace(u.msg_info_attributeDeleted,{number:o.length}),className:"success"}),n.CONFLICTED_WITH&&n.CONFLICTED_WITH.length>0&&r.restoreSybolicNames(n.CONFLICTED_WITH).then(function(e){c.displayNotification({message:u.replace(u.msg_info_attributeSymbUpdated,{number:n.CONFLICTED_WITH.length}),className:"infos"})},function(e){i._commonError("DeleteAttributes",u.msg_error_creatingClassAttrSymb,e)}),i._offProgressBar()},function(e){i._offProgressBar(),t.enable(),i._commonError("DeleteAttributes",u.msg_error_deleteClassAttributes,e)})})}},function(e){i._offProgressBar(),t.enable(),i._commonError("DeleteAttributes",u.msg_error_deleteClassAttributes,e)})}else c.displayNotification({message:u.msg_warning_noAttributeSelected,className:"warning"})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_ExpandAllCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/Library_CSO"],function(e,t,i,a){"use strict";return t.extend({labelTopBar:e.i18n("Expand All"),isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=a.getSelectedNodes();if(e.length){var t=e[0];i.ExpandAllCmd(t,"CONTENT")}else{var r=a.getCurrentLibrary();i.ExpandAllCmd(r,"TREE")}},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_DownloadCATNlsCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/service/IPClassifyUtilWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","DS/WidgetServices/WidgetServices","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/JSZipTools/JSZip"],function(e,t,i,a,r,n,o,s,l){"use strict";return t.extend({labelTopBar:e.i18n("Export Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},execute:function(){var e=this;n._startProgressBar(s.get("msg_info_downloadProgress")),e.disable();var t=["en","de","fr","ja","ko","ru","zh"],c='<meta charset="UTF-8"/>\nClassification="Classification";\n',d={},u={};t.forEach(e=>{d[e]="",u[e]={}}),a.getDictionaryCusto1({tenant:o.getTenantID(),package:"ClassificationDefaultPack",lang:"en;de;fr;ja;ko;ru;zh",onComplete:function(a){(a="string"==typeof a?JSON.parse(a):a).Response&&a.Response;var o=a.Dictionary.Interfaces.ClassificationAttributes.Attributes;for(const e in o){var f=o[e],m=f.Name;if("Yes"===f.HasRangeDefined){var p=f.AuthorizedValues;t.forEach(e=>{u[e][m]={fromWebapp:!1,interfaceId:""}});for(const e in p){var g=p[e];let i="Range."+f.Name+"."+g;t.forEach(e=>{let t="DictionaryNLS_"+e;u[e][m][g]=a[t][i]})}}}i.fetchDataForClassAttributesTab({onComplete:function(a){var o=JSON.parse(a),f=o.attribute;f||(f=o.Attribute),f.forEach(function(e){e.range.length>0&&t.forEach(t=>{var i=e.Name;u[t][i]={fromWebapp:!0,interfaceId:""}})}),i.getInterfaceForAttributes({attributes:Object.keys(u.en),onComplete:function(i){console.log(" ski82 debug hre");var a=JSON.parse(i);console.log("These are json received"),f.forEach(function(e){t.forEach(t=>{d[t]=d[t]+"Classification.Classification_Taxonomies."+e.name+'="'+e["attr_nls_"+t]+'";\n'}),u.en[e.name]&&a[e.name]&&a[e.name].forEach(i=>{if(i){var a="Classification."+i;e.range.forEach(i=>{t.forEach(t=>{let r=u[t][e.name][i.value]?u[t][e.name][i.value]:"";var n=parseFloat(i.value);""!=r||isNaN(n)||(r=u[t][e.name][n]?u[t][e.name][n]:""),d[t]=d[t]+a+"."+e.name+".Range.Equal."+i.value+'="'+r+'";\n'})})}})});var o=new l;Object.keys(d).forEach(e=>{var t;t=c+d[e],o.folder(e).file("Classification.CATNls",t)}),o.generateAsync({type:"blob"}).then(function(t){var i=document.createElement("a");i.href=window.URL.createObjectURL(t),i.download="CATNls.zip",i.dispatchEvent(new MouseEvent("click")),n._offProgressBar(),e.enable(),r.displayNotification({message:s.get("msg_info_downloadComplete"),className:"success"}),console.log("CatNLS download complete")})},onFailure:function(t,i,a){var o=s.get("msg_classificationattributes_webservicefailed")+": "+n.extractMyErrorMessage(t,i,a);r.displayNotification({message:o,className:"error"}),n._offProgressBar(),e.enable()}})},onFailure:function(t,i,a){var o=s.get("msg_classificationattributes_webservicefailed")+": "+n.extractMyErrorMessage(t,i,a);r.displayNotification({message:o,className:"error"}),n._offProgressBar(),e.enable()}})},onFailure:function(t,i,a){var o=s.get("msg_classificationattributes_webservicefailed")+": "+n.extractMyErrorMessage(t,i,a);r.displayNotification({message:o,className:"error"}),n._offProgressBar(),e.enable()}})},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ActionBar_ExportLibraryStructureCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADUtilsServices"],function(e,t,i,a,r,n,o){"use strict";return t.extend({labelTopBar:e.i18n("Add Existing Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},execute:function(){var e=this;require(["DS/ClassificationEditor/utils/Library_CSO"],function(t){var s,l,c,d="No Library Selected",u=!1;if(t.getCurrentLibrary()&&(s=(l=t.getCurrentLibrary()).getID(),d=l.getLabel(),c=l.plmType||l.getType()),"RootLibrary"===c)u=!0;else if("LibrarySection_AllLibraries"==c||"LibrarySection_favorite"==c){var f=t.getSelectedNodes(),m=f.length;if(1===m&&"RootLibrary"===f[0].plmType)u=!0,s=f[0].id,d=f[0].getLabel();else{var p=n.msg_exportLibrary_selectLib;m>1&&(p=n.msg_exportLibrary_selectOneLib),a.displayNotification({message:p,className:"warning"})}}else a.displayNotification({message:n.msg_exportLibrary_selectLib,className:"warning"});u&&(r._startProgressBar(n.msg_exportLibrary_loading+d),e.disable(),i.exportLibraryStructure({pid:s,onComplete:function(t,i,s,l){var c=t?JSON.parse(t):void 0;c&&c.fileContent?o.downloadfile(c.fileContent,c.fileName,"text/xml"):a.displayNotification({message:n.replace(n.msg_exportLibrary_failed,{libraryname:d}),className:"error"}),r._offProgressBar(),e.enable()},onFailure:function(t,i,o){var s=n.replace(n.msg_exportLibrary_failed,{libraryname:d});i&&"User doesnt have Librarian Role"===i&&(s=n.replace(n.error_exportLibrary,{libraryname:d})+"<br>"+n.error_no_LibrarianRole),a.displayNotification({message:s,className:"error"}),r._offProgressBar(),e.enable()}}))})},endExecute:function(){}})}),define("DS/ClassificationEditor/dataProvider/LibraryContentDataProvider",["UWA/Class","UWA/Class/Promise","DS/PADUtils/PADProbes","DS/WebappsUtils/WebappsUtils","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyPreference","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/ClassificationEditor/utils/LibrarySearch","DS/ClassificationEditor/commands/LibraryCommands","DS/IPClassifyUtil/IPClassifyAlert","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyUtility","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/IPClassifyUX/utils/IPClassifyWidgetData","DS/ClassificationEditor/ActionBar/ClassificationCommandManager"],function(e,t,i,a,r,n,o,s,l,c,d,u,f,m,p,g,C,b){"use strict";var y={FAVORITES:"ipcFavoriteList_v1",getFavorites:function(){return p.getTenantAwarePreferenceName(this.FAVORITES)}},h=null,v={order_field:"Name",order_by:"asc"},_=e.singleton({getObjectsForRefresh:function(e,i){return new t(function(t){var a=[];i.forEach(function(e){e.isDynamic&&-1===a.indexOf(e.dataIndex)&&a.push(e.dataIndex)}),n._performFetchQuery({ids:e,dynamicAttrs:a,isAuthoringMode:!0,onComplete:function(e){var i=[];e.results&&e.results.length>0&&e.results.forEach(function(e){i.push(r.convertToExaleadDataFormatFederated(e))}),t(i)},onFailure:function(){console.error("Unable to update Content root node, Error in getting content Properties"),t(null)}})})},setIconsForLibraries:function(e,t){var i,r=e.options.thumbnail;"General Class"==e.options.type&&"Definition"==e.options.grid["ds6w:classificationUsage"]&&((i=[]).push(a.getWebappsAssetUrl("LibraryEditor","icons/categorizationIcons/GeneralClass_small.png")),r.includes("I_GeneralClass")&&(e.options.thumbnail=a.getWebappsAssetUrl("LibraryEditor","icons/categorizationIcons/GeneralClass_Tile.png")),e.options.icons=i);"General Library"==e.options.type&&"Standard"==e.options.grid["ds6w:classificationUsage"]&&((i=[]).push(a.getWebappsAssetUrl("LibraryEditor","icons/categorizationIcons/GeneralLibrary_small.png")),r.includes("I_GeneralLibrary")&&(e.options.thumbnail=a.getWebappsAssetUrl("LibraryEditor","icons/categorizationIcons/GeneralLibrary_Tile.png")),e.options.icons=i)},getExceptionTabContents:function(e){return v.order_field=e.order_field,v.order_by=e.order_by,new t(function(e,t){var a=i.createProbe("probeFindClassificationAttrs");n.fetchDataForClassAttributesTab({onComplete:function(t){var i=JSON.parse(t),n=i.attribute;n||(n=i.Attribute);var o=function(e){var t={},i=[];e.forEach(function(e){var t=r.convertAttributeFromDicoToExaleadDataFormat(e);t.plmType="Attribute",i.push(t)}),t.results=i;var a={};return a.nhits=i.length,a.nresults=i.length,a.next_start="0 0",t.infos=a,t}(n);e({results:o.results,infos:o.infos,facets:{}}),a.end()},onFailure:function(e,i,r){t({results:[],facets:{}}),u.displayNotification({message:f.get("msg_classificationattributes_webservicefailed")+": "+i,className:"error"}),a.end()}})})},_getAttributesTabContents:function(e){return v.order_field=e.order_field,v.order_by=e.order_by,new t(function(t,a){var o=i.createProbe("probeFetchClassificationAttrs");n.getClassificationAttributes({classid:e.pid,onComplete:function(i){var a=JSON.parse(i),n=a.attribute;n||(n=a.Attribute),m.setCAChangeAccessOnClass(e.pid,a.changeaccess);var s=function(e){var t={},i=[];e.forEach(function(e){var t=r.convertAttributeToExaleadDataFormat(e);t.plmType="Attribute",i.push(t)}),t.contents=i;var a={};return a.nhits=i.length,a.nresults=i.length,a.next_start="0 0",t.infos=a,t}(n);t({contents:s.contents,infos:s.infos,facets:{}}),o.end()},onFailure:function(e,t,i){var r=f.get("msg_classificationattributes_webservicefailed")+": "+d.extractMyErrorMessage(e,t,i);a({msg:r}),o.end()}})})},_getDefaultTabContents:function(e){return new t(function(t,i){n.content({pid:e.pid,mxid:e.mxid,searchQuery:e.searchQuery,isExactSearch:e.isExactSearch,selectedType:e.selectedType,dynamicattributes:e.dynamicattributes,filters:e.filters,start:e.start,next_start:e.next_start,order_field:e.order_field,order_by:e.order_by,grid:e.grid,isAuthoringMode:!p.isIndexedMode(),onComplete:function(i){if((i="string"==typeof i?JSON.parse(i):i).result)return a=r.convertNavigateToSearchFormat(i.result),void t({contents:n(a),infos:i.infos,facets:i.facets});var a=function(e,t){var i=[];null!=e&&e.forEach(function(e){var a=!1;e.attributes&&e.attributes.forEach(function(e){"physicalid"===e.name&&e.value!=t&&(a=!0)}),a&&i.push(e)});return i}(i.results,e.pid);function n(e){var t=[];return e.forEach(function(e){var i=r.convertToExaleadDataFormatFederated(e),a=e.attributes;i.plmType=o.getPlmTypeFromContentDetails(a),i.Documentlocked=e.Documentlocked,i.publishOnConnect=e.publishOnConnect,t.push(i)}),t}t({contents:n(a),infos:i.infos,facets:i.facets})},onFailure:function(e,t){i({err:e,serverErr:t,msg:f.msg_error_contentnotavailable})}})})},getObjectContents:function(e){return h=e.widgetData,new t(function(t,i){var a=e.widgetData;!a||!a.currentTab&&!a.currentWidgetTab||a.currentTab===l.CONTENT_TABS.CLASSES&&a.currentWidgetTab===l.CONTENT_TABS.LIBRARIES?_._getDefaultTabContents(e).then(function(e){t(e)},function(e){i(e)}):1===a.currentTab&&0===a.currentWidgetTab?_._getAttributesTabContents(e).then(function(e){t(e)},function(e){i(e)}):1===a.currentWidgetTab&&_.getExceptionTabContents(e).then(function(e){t(e)},function(e){i(e)})})},getPaginatedSectionContents:function(e){return h=e.widgetData,new t(function(t,i){n.roots({filters:e.filters,start:e.start,next_start:e.next_start,order_field:e.order_field,order_by:e.order_by,isAuthoringMode:!p.isIndexedMode(),onComplete:function(e){var i=[];e.results&&e.results.forEach(function(e){var t=r.convertToExaleadDataFormatFederated(e),a=e.attributes;t.plmType=o.getPlmTypeFromContentDetails(a),t.Documentlocked=e.Documentlocked,t.publishOnConnect=e.publishOnConnect,i.push(t)}),t({results:i,infos:e.infos,facets:e.facets})},onFailure:function(){i()}})})},getPreferenceSectionContents:function(e){return h=e.widgetData,new t(function(t,i){n.favourites({ids:e.ids,onComplete:function(e){for(var i=(e="string"==typeof e?JSON.parse(e):e).results?e.results:[],a=[],n=0;n<i.length;++n){var s=o.getPlmTypeFromContentDetails(i[n].attributes),l=r.convertToExaleadDataFormatFederated(i[n]);l.plmType=s,a.push(l)}t(a)},onFailure:function(e){i(e)}})})},getContextualMenu:function(e,t,i,a){return i&&i.currentTab&&i.currentTab!==l.CONTENT_TABS.CLASSES?i.currentTab===l.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES?d.GetContextualMenuForAttributes(e,t,a):[]:d.GetContextualMenu(e,t,a)},comparator:function(e,t){return 1==C.getWidgetData().currentWidgetTab?l.sortAttributeColumn(e,t,v):h&&h.currentTab&&h.currentTab!==l.CONTENT_TABS.CLASSES?h.currentTab===l.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES?l.sortAttributeColumn(e,t,v):void 0:l.sortColumn(e,t)},getPreferenceSectionName:function(){return y.getFavorites()},isValidType:function(e){return o.inFamilyLibrary(e)},isValidTypeForPlaceholder:function(e,t){return!0},showClassTabs:function(){return 0===C.getWidgetData().currentWidgetTab},getFilterOptions:function(){return 1===C.getWidgetData().currentWidgetTab?{Type:{filterId:"string",filterModel:{condition1:{type:"contains",filter:""}}}}:void 0},toEnableTreeColumnEdit:function(e,t){return 1!==t.currentWidgetTab&&(!t||!t.currentTab||t.currentTab===l.CONTENT_TABS.CLASSES)},isSection:function(e){return"LibrarySection_favorite"==e||"LibrarySection_AllLibraries"==e},isPreferenceSection:function(e){return"LibrarySection_favorite"==e},isPaginatedSection:function(e){return"LibrarySection_AllLibraries"==e},shouldBeEditable:function(e){return l.shouldBeEditable(e)},onContentUpdate:function(e){return l.onNodeModelUpdate(e)},onAddColumn:function(e){c.filterExcludeListColumns(e).length>0&&(c.setPredicates(e),c.addToPredicateHeaderMap(e))},onRemoveColumn:function(e){c.removePredicates(e),c.removeFromPredicateHeaderMap(e)},onResetColumn:function(e,t){c.removeAllPredicates(),c.setPredicates(e,t)},setColumnNames:function(e,t){c.setPredicates(e,t)},initColumns:function(e){c.initPredicateToHeaderMap(e)},getPageTabs:function(){var e=[];return e.push({label:f.classes_tab,isSelected:!0,value:l.CONTENT_TABS.CLASSES,icon:{iconName:"library-class",fontIconFamily:WUXManagedFontIcons.Font3DS}}),e.push({label:f.classification_attributes_tab,value:l.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES,icon:{iconName:"attributes",fontIconFamily:WUXManagedFontIcons.Font3DS}}),e},getTabsVisOnSelectionChange:function(){if(!m.getCurrentLibrary())return!1;var e=m.getCurrentLibrary().getType();return!this.isSection(e)&&"RootLibrary"!==e},reloadAfterSort:function(){return 1!=C.getWidgetData().currentWidgetTab},getColumnConfig:function(e){return!e||!e.currentTab&&!e.currentWidgetTab||e.currentTab===l.CONTENT_TABS.CLASSES&&e.currentWidgetTab===l.CONTENT_TABS.LIBRARIES?[{dataIndex:"ds6w:classificationUsage"},{dataIndex:"ds6w:type"},{dataIndex:"ds6w:status"},{dataIndex:"ds6w:description"},{dataIndex:"ds6w:responsible"},{dataIndex:"ds6w:modified"},{dataIndex:"ds6w:created"},{dataIndex:"ds6w:identifier"},{dataIndex:"ds6w:reservedBy"}]:[{dataIndex:"Name",text:f.column_Name,defaultSortOrder:"asc"},{dataIndex:"Type",text:f.column_Type},{dataIndex:"Description",text:f.column_Description},{dataIndex:"DefaultValue",text:f.column_DefaultValue},{dataIndex:"hasDefault",text:f.hasDefault},{dataIndex:"Dimensions",text:f.column_Dimensions},{dataIndex:"Predicates",text:f.column_Predicates},{dataIndex:"AuthorizedValues",text:f.column_Authorized_Values},{dataIndex:"attrIsParametric",text:f.column_Is_Parametric},{dataIndex:"IsMultivalue",text:f.column_Is_Multivalue},{dataIndex:"Minimum",text:f.column_Minimum},{dataIndex:"Maximum",text:f.column_Maximum},{dataIndex:"isInDico",text:f.existInDictionary}]},isDNDSupported:function(){return!0},showContentPlaceholder:function(){return!0},doSelect:function(){return 1!=C.getWidgetData().currentWidgetTab},hasWelcomePanel:function(){return 1!=C.getWidgetData().currentWidgetTab},hasLibrarianRole:function(){return new t(function(e,t){n.hasLibrarianRole({onComplete:function(t){e({readOnly:JSON.parse(t).isAuthorized.readOnly})},onFailure:function(){t({readOnly:!1})}})})},getLibraryControl:function(){return g},getLibraryEditorUtil:function(){return l},getLibraryTypeService:function(){return o},getStatus:function(e,t){return!1===e.contains(".")&&(e=t&&t.contains(" ")?t+"."+e.toUpperCase():t&&t.contains("_")?t+"."+(e=e.replace(" ","_")).toUpperCase():t&&e.contains(" ")?t+"."+(e=e.replace(" ","")):t+"."+e),e}});return _}),define("DS/ClassificationEditor/dataProvider/LibraryTreeDataProvider",["UWA/Class","UWA/Class/Promise","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","DS/ClassificationEditor/commands/LibraryCommands","DS/WebappsUtils/WebappsUtils","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUtil/IPClassifyAlert"],function(e,t,i,a,r,n,o,s,l,c,d){"use strict";var u={FAVORITES:"ipcFavoriteList_v1",getFavorites:function(){return c.getTenantAwarePreferenceName(this.FAVORITES)}};return e.singleton({expandObject:function(e){return new t(function(t,i){r.libraries({pid:e.pid,mxid:e.mxid,children:e.children,isExpandAll:e.isExpandAll,isAuthoringMode:!c.isIndexedMode(),onComplete:function(i){i="string"==typeof i?JSON.parse(i):i,c.isIndexedMode()&&(i.results=c.convertExpandV2toV1(i.results));var a=n.getPathsAndObjectsFromExpand(i.results);if(null==a)t({paths:[],objects:[]});else if(a.paths&&a.paths.length<=0){var r=[];i.results&&(r=n.convertExpandToSearchFormat(e.pid,i.results));var o=[];for(var s in a.objects)a.objects.hasOwnProperty(s)&&s!==e.pid&&o.push(s);t({objects:function(e){var t=[];e&&e.length>0&&e.forEach(function(e){var i=n.convertToExaleadDataFormatFederated(e);"Standard"==i.grid["ds6w:classificationUsage"]?i.icons=[{iconName:"library-class"}]:i.icons=[{iconName:"library-class-filled"}],i.plmType="Library",t.push(i)});return t}(r),childIds:o,paths:a.paths})}else{for(var s in a.objects)a.objects.hasOwnProperty(s)&&("Standard"==a.objects[s].grid["ds6w:classificationUsage"]?a.objects[s].icons=[{iconName:"library-class"}]:a.objects[s].icons=[{iconName:"library-class-filled"}],a.objects[s].plmType="Library");t({paths:a.paths,objects:a.objects})}},onFailure:function(e){i(e)}})})},getRootSectionContents:function(e){return new t(function(e,t){r.roots({fetchAll:!0,isAuthoringMode:!c.isIndexedMode(),onComplete:function(t){var i=(t="string"==typeof t?JSON.parse(t):t).results?t.results:[],a=[],r=[];i.forEach(function(e){var t=n.convertToExaleadDataFormatFederated(e);"Standard"==t.grid["ds6w:classificationUsage"]?t.icons=[{iconName:"library-lined"}]:t.icons=[{iconName:"library"}],t.plmType="RootLibrary",r.push(t),a.push(t.physicalid)}),e({objects:r,ids:a,infos:t.infos})},onFailure:function(e){t(e)}})})},getObjectPathLength:function(e){return new t(function(t,i){r.getLibraryPathLength({ids:e.ids,onComplete:function(e){if(e.results){var a=n.getLibraryDepth(e);t(a)}else d.displayNotification({message:l.msg_error_BOdeleted,className:"error"}),i()},onFailure:function(e){that._logger.log("WebService getObjectPathLength Err : "+e),i(e)}})})},getObjectPath:function(e){return new t(function(t,i){r.getLibraryPath({depth:e.depth,pid:e.pid,isAuthoringMode:!c.isIndexedMode(),onComplete:function(i){var a=n.convertNavigateToFlatFormat(e.depth,i.result);t(a)},onFailure:function(e){that._logger.log("WebService getObjectPath Err : "+e),i(e)}})})},getPreferenceSectionContents:function(e){return new t(function(t,a){r.favourites({ids:e.ids,onComplete:function(e){for(var a=(e="string"==typeof e?JSON.parse(e):e).results?e.results:[],r=[],o=0;o<a.length;++o){var s=i.getPlmTypeFromContentDetails(a[o].attributes),l=n.convertToExaleadDataFormatFederated(a[o]);l.plmType=s,"RootLibrary"===l.plmType?"Standard"==l.grid["ds6w:classificationUsage"]?l.icons=[{iconName:"library-lined"}]:l.icons=[{iconName:"library"}]:"Standard"==l.grid["ds6w:classificationUsage"]?l.icons=[{iconName:"library-class"}]:l.icons=[{iconName:"library-class-filled"}],r.push(l)}t(r)},onFailure:function(e){a(e)}})})},comparator:function(e,t){var i,a="LibrarySection_favorite"===e.getParent().plmType;if(a)return null;if(e.isRoot()&&t.isRoot()||a)return null;if("date"!==widget.getValue("sortMode"))return e.options.label.localeCompare(t.options.label);try{i=new Date(e.options.created)>new Date(t.options.created)?1:new Date(e.options.created)<new Date(t.options.created)?-1:0}catch(a){i=e.options.created<t.options.created?-1:1}finally{return i}},shouldBeEditable:function(e){return a.shouldBeEditable(e)},getContextualMenu:function(e){return o.GetContextualMenu(e,"TREE")},onContentUpdate:function(e){return a.onNodeModelUpdate(e)},isValidType:function(e){return i.inFamilyLibrary(e)},isSection:function(e){return"LibrarySection_favorite"==e||"LibrarySection_AllLibraries"==e},isTreeNodeEditable:function(e){if(e&&e.nodeModel){var t=e.nodeModel.plmType;return!("LibrarySection_favorite"==t||"LibrarySection_AllLibraries"==t)}return!1},isPreferenceSection:function(e){return"LibrarySection_favorite"==e},getSectionsData:function(){var e=[],t={};t.label=l.name_Section_FavoriteLibraries,t.icon=s.getWebappsAssetUrl("ClassificationEditor","icons/libraryfavorites.png"),t.plmType="LibrarySection_favorite",e.push(t);var i={};return i.label=l.name_Section_AllLibraries,i.icon=s.getWebappsAssetUrl("ClassificationEditor","icons/librarysectionall.png"),i.plmType="LibrarySection_AllLibraries",i.defaultSelectedSection=!0,e.push(i),e},getPreferenceSectionName:function(){return u.getFavorites()},getSecurityContextAndData:function(){return a.getCurrentSecurityContextAndLibraryData()},getObjectNotVisiblemessage:function(){return l.msg_error_NoVisibleRootLibrary},isDNDSupported:function(){return!0},isRoot:function(e){return!(!e||!e.flattenedtaxonomies||"types/Libraries"!==e.flattenedtaxonomies[0]||"types/General Library"!==e.flattenedtaxonomies[1])}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_CreateLibrary",["UWA/Core","DS/ApplicationFrame/Command","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/commands/LibraryCommands","DS/ApplicationFrame/CommandsManager","DS/PADUtils/PADProbes","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s,l){"use strict";return t.extend({labelTopBar:e.i18n("Create New Library"),isInsert:!0,data:{},_modalChooser:null,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=require("DS/ClassificationEditor/service/LibraryServices"),t=require("DS/ClassificationEditor/utils/Library_CSO"),i=require("DS/IPClassifyUtil/IPClassifyAlert"),o=t.getCurrentLibrary();n._startProgressBar(l.CreateNewLibrary_loading),e.CreateNewLibrary({callbacks:{onComplete:function(e){n._offProgressBar(),e="string"==typeof e?JSON.parse(e):e,a.setAuthoringMode("authoring",l.replace(l.msg_info_libraryCreationSucess,{})),e.createdLibraryObj&&(r.getTreeCont().addNewNode({physicalid:e.createdLibraryObj.libraryPhysicalId,label:e.createdLibraryObj.libraryName,plmType:"RootLibrary",type:e.createdLibraryObj.libraryType,mxid:e.createdLibraryObj.libraryObjId,icons:[{iconName:"library"}]}),setTimeout(function(){r.getContent().loadContentAndSelect(o,e.createdLibraryObj.libraryPhysicalId,!1,!1,!0).then(function(e){})},100))},onFailure:function(e,t,a){n._offProgressBar();var r=n.extractMyErrorMessage(e,t,a);i.displayNotification({message:r?l.msg_error_createlibrary+"<br>"+r:l.msg_error_createlibrary,className:"error"})}}})},endExecute:function(){}})}),define("DS/ClassificationEditor/utils/LibraryCommandManager",["DS/ApplicationFrame/CommandsManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/service/LibraryTypeService","DS/WidgetServices/WidgetServices"],function(e,t,i,a){"use strict";var r=["CreateSnapshotHdr"],n={ColumnVisibility:{enable:{view:"datagridview"}}},o={enableAllCommands:function(i){var a,n=e.getCommands();for(a in n)if(this.checkCommandCond(a,i)){var o=e.getCommand(a,t.getContent().getView());UWA.is(o)&&r.indexOf(a)<0&&(i?o.enable():"ListSnapshotsHdr"!==a&&o.disable())}},enableFavoriteCommands:function(t){var i=e.getCommandCheckHeader("AddToFavorites");i&&t?i.enable():i&&i.disable()},ItemSelected:function(e,a,r){var n=[],s=[];if("TREE"===a)i.inFamilyLibrary(e.plmType)?(o.enableAllCommands(!0),o.enableFavoriteCommands(!0),s.push("SelectSiblings")):"LibrarySection_favorite"==e.plmType?(o.enableAllCommands(!1),o.enableFavoriteCommands(!1),n.push("treeview","tileview","thumbnailview","ExpandAll","ExpandN","CollapseAll","SelectAll","SelectInversion")):"LibrarySection_AllLibraries"==e.plmType?(o.enableAllCommands(!1),o.enableFavoriteCommands(!1),n.push("treeview","tileview","thumbnailview","ExpandAll","ExpandN","CollapseAll","SelectAll","SelectInversion")):(o.enableAllCommands(!1),o.enableFavoriteCommands(!1));else if("CONTENT"===a){var l=r.plmType,c=t.getContent().getView().getSelectedNodes();if(o.enableFavoriteCommands(!0),i.inFamilyLibrary(l)&&"Busy"===e.plmType)o.enableAllCommands(!1);else if(i.inFamilyLibrary(l))o.enableAllCommands(!0),s.push("ExpandAll","ExpandN","CollapseAll");else if("LibrarySection_AllLibraries"==l){if(o.enableAllCommands(!0),1===c.length)c[0].plmType||c[0].getType();s.push("ExpandAll","ExpandN","CollapseAll")}else"LibrarySection_favorite"==l?(o.enableAllCommands(!1),n.push("treeview","tileview","thumbnailview","ExpandAll","ExpandN","CollapseAll","SelectAll","SelectInversion","SelectSiblings")):o.enableAllCommands(!1)}this._switchCommands(n,!0),this._switchCommands(s,!1)},getCommand:function(i){return e.getCommand(i,t.getContent().getView())},checkCommandCond:function(e,i){var a=!0;if(n[e]){var r=n[e];i&&r.enable&&r.enable.view&&r.enable.view!=t.getContent().getView().getActiveView()&&(a=!1)}return a},_switchCommands:function(e,t){for(var i=0;i<e.length;++i)if(this.checkCommandCond(e[i],t)){var a=this.getCommand(e[i]);try{t?a.enable():a.disable()}catch(a){console.error("Error "+(t?"enabling":"disabling"),e[i],a)}}}};return o}),define("DS/ClassificationEditor/ActionBar/LibraryActionBar",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Events","UWA/Class/Options","DS/Logger/Logger","DS/ClassificationEditor/utils/LibraryCommandManager","DS/ApplicationFrame/CommandsManager","DS/ApplicationFrame/ActionBar","DS/CoreEvents/ModelEvents","DS/ClassificationEditor/utils/Library_CSO","DS/RuntimeView/NLSManager","DS/PADUtils/PADContext","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/PADUtils/PADProbes","DS/WidgetServices/WidgetServices","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/IPClassifyUXEvents"],function(e,t,i,a,r,n,o,s,l,c,d,u,f,m,p,g,C){"use strict";var b=t.extend(a,i,{name:"library_actionbar",_logger:null,_actionBar:null,_language:"en",_context:null,_isReady:!1,_modelEvents:null,init:function(e){this._probeLoadElmt=m.createProbe("loadActionBar");var t=this;e.language&&(this._language=widget.lang?widget.lang:widget.getValue("lang")),e.context?this._context=e.context:this._context=this,this._modelEvents=new l,this._parent(e),this._logger=r.getLogger(b),this.onLoad(e),this.getOption("renderTo")&&this.render().inject(this.getOption("renderTo")),this.onReady(function(){t.syncState(),C.onLibrarySelected(function(e){var t=c.getCurrentLibrary();n.ItemSelected(e.selectedNode,e.context,t)}),C.onContentSearchChange(function(){var e=c.getCurrentLibrary();e&&n.ItemSelected(e,"TREE",e)}),c.onEmpty(function(){n.enableAllCommands(!1)}),UWA.is(e.events)&&UWA.is(e.events.onActionBarReady,"function")&&e.events.onActionBarReady(),t._probeLoadElmt.end()})},render:function(){return this},loadActionBar:function(e){this._actionBar.loadModel(e)},destroy:function(){this._logger.log("destroy"),this._actionBar&&(delete this._actionBar,this._actionBar=null),this._parent()},onLoad:function(t){var i=this;i._context.options=i._context.options||{},UWA.extend(i._context.options,{custo_view_title:f.name_Widget_Title}),i._context.getFolderXSO=function(){return c},u.set(i._context);if(!e.is(this.elements.container)){d.DEFAULT_LANGUAGE=widget.lang?widget.lang:widget.getValue("lang"),this.elements.container=UWA.createElement("div",{class:this.getClassNames()});var a=g.isCustomizedEnv()?"ENOLibraryCusto.xml":"ENOLibrary.xml",r="ClassificationEditor";t.dataForActiveClassODT&&t.dataForActiveClassODT.ActionBarCommandsXML&&t.dataForActiveClassODT.ModuleForCommandsXML&&(a=t.dataForActiveClassODT.ActionBarCommandsXML,r=t.dataForActiveClassODT.ModuleForCommandsXML),this._actionBar=new s({context:null,file:a,module:r,language:widget.lang?widget.lang:widget.getValue("lang")});var n=this._actionBar.onActionBarReady(function(){i._actionBar._modelEvents.unsubscribe(n),i._isReady=!0,i._modelEvents.publish({event:"READY",context:i})})}},onReady:function(e){return this._modelEvents.subscribe({event:"READY"},e)},syncState:function(){var e=c.getCurrentLibrary(),t=c.get();if(e&&t&&t.length>0){var i="CONTENT";e.getID()==t[0].getID()&&(i="TREE"),n.ItemSelected(t[0],i,e)}else n.enableAllCommands(!1)}});return b}),define("DS/ClassificationEditor/utils/ClassificationEditorKeyboardListener",["UWA/Core","UWA/Class","UWA/Event","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/utils/LibraryCommandManager","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUX/events/IPClassifyEvents","DS/Logger/Logger"],function(e,t,i,a,r,n,o,s,l,c){var d=t.extend({name:"ClassificationEditorKeyboardListener",init:function(e){this._parent(e),this._logger=c.getLogger(d),this._onKeyDown_binded=this._onKeyDown.bind(this)},startObservingKeyboard:function(){e.Element.addEvent.call(document,"keydown",this._onKeyDown_binded)},_onKeyDown:function(e){var t=this,r=i.whichKey(e);e.ODTENVKeyName&&(r=e.ODTENVKeyName);var c,d,u,f=function(){var e=document.activeElement;return!(!e||"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName)};switch(r){case"ctrl+a":c=r,d="SelectAll",(u=n.getCommand(d))&&u.isEnabled()?f()?t._logger.log("Info : '"+c+"' key pressed in INPUT field, no command launched"):(u.begin(),i.stop(e)):t._logger.log("Info : '"+c+"' key pressed, but command '"+d+"' is disabled");break;case"alt+return":l.notifyInfoExpand();break;case"ctrl+f":var m=a.getIdCardCont();m._isSearchAvailable()&&(m.switchSearch(!0),i.stop(e));break;case"f2":if(f())t._logger.log("Info : '"+r+"' key pressed in INPUT field, no command launched");else{var p=o.getSelectedNodes(),g=o.getCurrentLibrary();if(1!=(Array.isArray(p)?p.length:0))break;var C=p[0];if(C&&s.inFamilyLibrary(C.plmType)&&a.getTreeCont().getView().isTreeNodeModelInstance(C))if(g.getID()==C.getID()){var b=a.getTreeCont();b&&b.switchLibraryTreeNodeLabelToWriteView&&b.switchLibraryTreeNodeLabelToWriteView(g)}else{var y=a.getContent();y&&y.switchLibraryTreeNodeLabelToWriteView&&y.switchLibraryTreeNodeLabelToWriteView(C)}else t._logger.log("Info : '"+r+"' key pressed but selected element is not a Library, no command launched")}}}});return d}),define("DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider",["UWA/Class","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/commands/LibraryCommands","DS/ClassificationEditor/service/LibraryServices","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/service/LibraryTypeService","DS/IPClassifyUtil/IPClassifyUtility","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/IPClassifyUXUtil/IPClassifyConfirmation","DS/IPClassifyUXUtil/IPClassifyConfirmationWthCheckBx","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s,l,c,d,u){"use strict";return e.singleton({shouldAcceptDrag:function(){var e=!0,t=n.getSelectedNodes();if(1==t.length){for(var i=0;i<t.length;++i)if("Library"!==t[i].plmType){e=!1;break}}else e=!1;return e},shouldAcceptDrop:function(e){var t=!1;return e||(e=n.getCurrentLibrary()),"LibrarySection_AllLibraries"===e.plmType&&"LibrarySection_Favorites"===e.plmType||!o.inFamilyLibrary(e.plmType)||(t=!0),t},addContentInObject:function(e,i,a,r){t.displayNotification({message:u.msg_warning_dndnotsupported,className:"warning"})},addClassesInLibrary:function(e,s,f,m,p){if(e&&e.plmType&&o.inFamilyLibrary(e.plmType)&&f){var g=f;if(g.length<1)return void console.warn("  Error in LibraryDnDServiceProvider.addClassesInLibrary, lContentId list is empty");if(e.id===s)return i._offProgressBar(),void t.displayNotification({message:u.msg_error_MoveInSamelibrary,className:"error"});for(var C=0;C<g.length;C++){var b=g[C];if(e.id===b)return i._offProgressBar(),void t.displayNotification({message:u.msg_error_MoveInSamelibrary,className:"error"})}var y=p,h=n.getCurrentLibrary();if("LibrarySection_favorite"===h.getType())return i._offProgressBar(),void t.displayNotification({message:u.msg_warning_dndnotsupported,className:"warning"});h.getID()===f[0]&&(h=h.getParent());var v=n.getSelectedNodes(),_=e&&o.inFamilyLibrary(e.plmType)?e:null;function S(e,r,n){a.MoveClass({IDs:e,targetLibrary:r,carryOverAttributeGroups:n,callbacks:{onComplete:function(e){A(e)},onFailure:function(e,a,r){i._offProgressBar();var n=i.extractMyErrorMessage(e,a,r);t.displayNotification({message:n?u.msg_error_moveClass+"<br>"+n:u.msg_error_moveClass,className:"error"})}}})}function A(e){i._offProgressBar();var t=u.replace(u.msg_info_classesmoved,{number:T,libraryname:_._options.label});1===x&&(t=u.replace(u.msg_info_classmoved,{classmovedname:v[0]._options.label,libraryname:_._options.label})),l.setAuthoringMode("authoring",t),r.getContent().loadContentAndSelect(h),h.isExpanded()&&(r.getTreeCont().performOperationOnNode(h,"collapse"),r.getTreeCont().performOperationOnNode(h,"expand")),y?(_=r.getTreeCont()._getNodesById(_.id)[0]).isExpanded()&&(r.getTreeCont().performOperationOnNode(_,"collapse"),r.getTreeCont().performOperationOnNode(_,"expand")):_.isExpanded()&&(r.getTreeCont().performOperationOnNode(_,"collapse"),r.getTreeCont().performOperationOnNode(_,"expand"))}if(_||(_=n.getCurrentLibrary()),!v)return;var E=[],D=[],w=[],L=[],x=v.length;x>0?v.forEach(function(e){E.push(UWA.is(e.id)?e.id:e.options.resourceid),o.isLibrary(e.plmType)?(D.push(UWA.is(e.id)?e.id:e.options.resourceid),w.push(e)):o.isRootLibrary(e.plmType)?"RootLibrary"===e.plmType&&D.push(UWA.is(e.id)?e.id:e.options.resourceid):L.push(UWA.is(e.id)?e.id:e.options.resourceid)}):(E.push(v),"Library"==node.plmType?(D.push(v.id),w.push(v)):o.isRootLibrary(node.plmType)||L.push(v.id));var T=D.length;_?D.length>0&&(void 0!==_._options.usage&&h._options.usage!==(_._options.usage?_._options.usage:_._options.classUsage)?(i._offProgressBar(),t.displayNotification({title:u.msg_error_MoveInLibraryErrorTitle,subtitle:u.msg_error_MoveInLibraryErrorSubTitle,message:u.msg_error_MoveInLibraryErrorMessage,className:"error"})):!function(e,t,i,a){if(i.id!=t.id){if("MOVE_CLASS"===e&&!o.isRootLibrary(t.plmType)&&UWA.is(a,"array")&&1===a.length&&a[0]===t){var r=t.getParent();if(r&&r.id===i.id)return!1}return!0}}("MOVE_CLASS",h,_,v)?(i._offProgressBar(),t.displayNotification({message:u.msg_error_MoveInSamelibrary,className:"error"})):"RootLibrary"===h.plmType?c.launch({title:u.confirmation_move_title+" - "+v[0].getLabel(),content:u.replace(u.confirmation_move_message,{parentlibrary:_.getLabel()}),confirmLabel:u.confirmMoveYes,cancelLabel:u.confirmMoveNo},function(){i._startProgressBar(u.Move_Class_loading),S(D,_,!1)},null,function(){i._offProgressBar()}):"Library"===h.plmType&&a.MoveClass({IDs:D,targetLibrary:_,carryOverAttributeGroups:"",callbacks:{onComplete:function(e){JSON.parse(e).hasInheritedAttributes?d.launch({title:u.confirmation_move_title+" "+v[0].getLabel(),confirmLabel:u.confirmMoveYes,cancelLabel:u.confirmMoveNo,mainDivContent:{divHeaderShow:u._class+v[0].getLabel()+u.moveClassAttributesLostMsg_Part1+h.getLabel(),divFooterHide:u.moveClassAttributesLostMsg_Part2+JSON.parse(e).noOfClassifiedItemsAffected+u.moveClassAttributesLostMsg_Part3,checkBoxParams:{label:u.includeInheritedAttributes}}},function(){i._startProgressBar(u.Move_Class_loading),d.getChkBoxCheckedFlag()?S(D,_,!0):S(D,_,!1)},null,function(){i._offProgressBar()}):c.launch({title:u.confirmation_move_title+" "+v[0].getLabel(),content:u.replace(u.confirmation_move_message,{parentlibrary:_.getLabel()}),confirmLabel:u.confirmMoveYes,cancelLabel:u.confirmMoveNo},function(){i._startProgressBar(u.Move_Class_loading),S(D,_,!1)},null,function(){i._offProgressBar()})},onFailure:function(e,a,r){i._offProgressBar();var n=i.extractMyErrorMessage(e,a,r);t.displayNotification({message:n?u.msg_error_moveClass+"<br>"+n:u.msg_error_moveClass,className:"error"})}}})):(i._offProgressBar(),t.displayNotification({message:u.msg_warning_nocurrentlibrary,className:"warning"}))}},getDroppedData:function(e){var t=[],i=[],a=[];if(e&&e.data&&e.data.items&&Array.isArray(e.data.items)){for(var r=0;r<e.data.items.length;r++){var n=e.data.items[r],s=n.objectId,l=n.objectType_Internal;if(l||(l=n.objectType),Array.isArray(l)){for(var c=l.length,d=c>0?l[c-1]:void 0,u=0;u<c;++u)if(o.inFamilyLibrary(l[u])){d=l[u];break}l=d}var f=n.displayName;f||(f=l),f||(f=s);var m={droppedItem_id:s,droppedItem_type:l,droppedItem_name:f,droppedSourceLibrary_id:n.libraryId,droppedItem_tenantId:n.envId};o.isRootLibrary(l)?t.push(m):o.isLibrary(l)?i.push(m):a.push(m)}var p={};return p.RootLibrary_itemList=t,p.Library_itemList=i,p.Content_itemList=a,p}},inFamilyLibrary:function(e){return o.inFamilyLibrary(e)}})}),define("DS/ClassificationEditor/commands/ClassificationIconBar_MoveClass",["UWA/Core","DS/ApplicationFrame/Command","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/LibraryActive/LibraryActive","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/dataProvider/LibraryDnDServiceProvider"],function(e,t,i,a,r,n){"use strict";return t.extend({labelTopBar:i.moveClass_ActiveClassify_LabelTopbar,isInsert:!0,datas:{},init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){this.popover?(this.popover.nestedMenuInContext.popover.title=i.confirmation_move_title+" - "+r.getSelectedNodes()[0].getLabel(),this.popover.showPopover()):(this.popover=new a({container:document.body.querySelector('[data-command="ActionBar_ActiveClassificationCmd"]'),topBarLabel:i.confirmation_move_title+" - "+r.getSelectedNodes()[0].getLabel(),selectBtnLabel:i.confirmMoveYes,isChooserPanel:!0,panelIcon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-move-to",couldBeValid:function(e){e&&e.getID&&e.getID();if(e&&e.getType){if(e.getType())return"General Class"===e.getType()||"General Library"===e.getType();if("General Class"===e.plmType||"General Library"===e.plmType)return!0}return!1},isMaturityFilterDisabled:!0}),this.popover.addEvent("onSetActive",function(e){var t=e,i=r.getCurrentLibrary().getID(),a=[r.getSelectedNodes()[0].getID()];n.addClassesInLibrary(t,i,a,!1,!0),require("DS/ClassificationEditor/commands/LibraryCommands")._offProgressBar()}))},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/ClassificationCommandsIconBar",["UWA/Core","UWA/Class/View","DS/UIKIT/Iconbar","DS/ApplicationFrame/CommandsManager","DS/ClassificationEditor/service/LibraryTypeService","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/ClassificationEditorUtil","DS/ClassificationEditor/utils/Library_CSO","DS/WidgetServices/WidgetServices","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s,l,c){"use strict";var d="fonticon fonticon-wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-down",u="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-down",f="fonticon fonticon-wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-down-cog",m="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-down-cog",p="fonticon fonticon-wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-up",g="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-tree-expand-up",C="fonticon fonticon-wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-cascade",b="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-cascade",y="fonticon fonticon-wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-cascade-wrong-2",h="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-cascade-wrong-2",v="fonticon fonticon-wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-cascade-wrong-1",_="wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-flow-cascade-wrong-1";return t.extend({name:"DS/ClassificationEditor/commands/ClassiificationCommandsIconBar",_iconBar:null,disabledCommands:[],selectedTab:null,commandsList_inGeneral:{createNewLibrary:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-library-add",text:c.command_createNewDefinitionLibrary,name:"createNewLibrary",handler:function(e,t){var i=a.getCommand("CreateNewLibrary",n.getContent());i&&i.begin()}},exportAttributes:{fonticon:"export-multiple",text:c.command_exportAttributes,name:"exportAttributes",handler:function(e,t){var i=a.getCommand("ExportAttributes",n.getContent());i&&i.begin()}},exportLibrary:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-export",text:c.command_exportLibrary,name:"exportLibrary",handler:function(e,t){var i=a.getCommand("ExportLibrary",n.getContent());i&&i.begin()}},importLibrary:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-import",text:c.command_importLibrary,name:"importLibrary",handler:function(e,t){var i=a.getCommand("ImportLibrary",n.getContent());i&&i.begin()}},createNewClass:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-library-class-add",text:c.command_createNewClass,name:"createNewClass",handler:function(e,t){var i=a.getCommand("CreateNewClass",n.getContent());i&&i.begin()}},deleteGeneric:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-trash",text:c.command_deleteGeneric,name:"deleteGeneric",handler:function(e,t){var i=s.getSelectedNodes()[0].getType(),r=null;"RootLibrary"===i?r=a.getCommand("DeleteLibrary",n.getContent()):"Library"===i&&(r=a.getCommand("DeleteClass",n.getContent())),r&&r.begin()}},addRemoveFavs:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-favorite-on",text:c.command_addRemoveFavs,name:"addRemoveFavorites",handler:function(t,i){var a=s.getCurrentLibrary(),o=a.getID(),l=a.getType(),c=a.options.label;0==n.getTreeCont().isLibraryAmongFavoriteLibraries(o)?a&&o&&r.inFamilyLibrary(l)&&e.is(n.getTreeCont())&&n.getTreeCont().addFavorite({id:o,name:c}):a&&o&&r.inFamilyLibrary(l)&&e.is(n.getTreeCont())&&n.getTreeCont().removeFavorite({id:o,name:c})}},properties:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attributes",text:c.command_properties,name:"properties",handler:function(e,t){var i=a.getCommand("ActionBar_Attributes",n.getContent());i&&i.begin()}},changeMaturity:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-collaborative-lifecycle-management",text:c.command_changeMaturity,name:"changeMaturity",handler:function(e,t){var i=a.getCommand("MaturityHdr",n.getContent());i&&i.begin()}},shareMOA:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-topbar-share",text:c.command_shareMOA,name:"shareMOA",handler:function(e,t){var i=a.getCommand("ActionBar_AccessRightCmd",n.getContent());i&&i.begin()}},moveClass:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-move-to",text:c.command_moveClass,name:"moveClass",handler:function(e,t){var i=a.getCommand("MoveClass",n.getContent());i&&i.begin()}}},commandsList_AttributesTab:{addExistingAttribute:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-attributes-add",text:c.command_addExistingAttribute,name:"addExistingAttribute",handler:function(e,t){var i=a.getCommand("AddExistingAttributes",n.getContent());i&&i.begin()}},removeAttribute:{fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-remove",text:c.command_removeAttribute,name:"removeAttribute",handler:function(e,t){var i=a.getCommand("RemoveAttributes",n.getContent());i&&i.begin()}}},setup:function(e){this._parent(e),this._iconBar=null},render:function(e,t,a,r,n,s){return this.selectedTab=r,this._iconBar=new i({renderTo:this.container,items:[]}),this._iconBar.addItem({className:"divider"}),r?r===o.CONTENT_TABS.CLASSES?(this._iconBar.addItem(this.commandsList_inGeneral.createNewLibrary),this._iconBar.addItem(this.commandsList_inGeneral.createNewClass),this._iconBar.addItem(this.commandsList_inGeneral.deleteGeneric),this._iconBar.addItem(this.commandsList_inGeneral.addRemoveFavs),this._iconBar.addItem(this.commandsList_inGeneral.properties),this._iconBar.addItem(this.commandsList_inGeneral.changeMaturity),this._iconBar.addItem(this.commandsList_inGeneral.shareMOA),this.addCommandsToList()):r===o.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES&&(this._iconBar.addItem(this.commandsList_AttributesTab.addExistingAttribute),this._iconBar.addItem(this.commandsList_AttributesTab.removeAttribute)):(this._iconBar.addItem(this.commandsList_inGeneral.createNewLibrary),this._iconBar.addItem(this.commandsList_inGeneral.createNewClass),this._iconBar.addItem(this.commandsList_inGeneral.deleteGeneric),this._iconBar.addItem(this.commandsList_inGeneral.addRemoveFavs),this._iconBar.addItem(this.commandsList_inGeneral.properties),this._iconBar.addItem(this.commandsList_inGeneral.changeMaturity),this._iconBar.addItem(this.commandsList_inGeneral.shareMOA),this.addCommandsToList()),this._iconBar.addItem({className:"divider"}),r&&r===o.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES||this.addMoreActionsCommandsList(),this.updateCommandVisibilityInIconBar(e,t,a,n,s),this},addMoreActionsCommandsList:function(){this.commandsList_inGeneral.moreActionsMenu={fonticon:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-menu-dot",text:c.menu_moreActions,name:"moreActions",content:{type:"dropdownmenu",options:{multiSelect:!1,items:[this.commandsList_inGeneral.exportLibrary,this.commandsList_inGeneral.importLibrary,this.commandsList_inGeneral.moveClass]}}},this._iconBar.addItem(this.commandsList_inGeneral.moreActionsMenu)},addCommandsToList:function(){var e=this;e.commandsList_inGeneral.expandAndClps={fonticon:u,text:c.command_expandAll,name:"expandAndCollapse",content:{type:"dropdownmenu",options:{multiSelect:!1,items:[{fonticon:u,text:c.command_expandAll,name:"expandAll",selectable:!0,selected:!0,handler:function(){var t=e._iconBar.getItem("expandAndCollapse");e.setExpandClpsCmdsIcon(t,"expandAll");var i=a.getCommand("ExpandAll",n.getContent());i&&i.begin()}},{fonticon:m,text:c.command_expandNLevels,name:"expandNLevels",selectable:!0,selected:!1,handler:function(){var t=e._iconBar.getItem("expandAndCollapse");e.setExpandClpsCmdsIcon(t,"expandNLevels");var i=a.getCommand("ExpandN",n.getContent());i&&i.begin()}},{fonticon:g,text:c.command_collapseAll,name:"collapseAll",selectable:!0,selected:!1,handler:function(){var t=e._iconBar.getItem("expandAndCollapse");e.setExpandClpsCmdsIcon(t,"collapseAll");var i=a.getCommand("CollapseAll",n.getContent());i&&i.begin()}}]}}},e.commandsList_inGeneral.selectionCmd={fonticon:b,text:c.command_selectAllVisible,name:"selections",content:{type:"dropdownmenu",options:{multiSelect:!1,items:[{fonticon:b,text:c.command_selectAllVisible,name:"selectAllVisible",selectable:!0,selected:!0,handler:function(){var t=e._iconBar.getItem("selections");e.setSelectionCmdsIcon(t,"selectAllVisible");var i=a.getCommand("SelectAll",n.getContent());i&&i.begin()}},{fonticon:h,text:c.command_selectInversion,name:"selectInversion",selectable:!0,selected:!1,handler:function(){var t=e._iconBar.getItem("selections");e.setSelectionCmdsIcon(t,"selectInversion");var i=a.getCommand("SelectInversion",n.getContent());i&&i.begin()}},{fonticon:_,text:c.command_selectSiblings,name:"selectSiblings",selectable:!0,selected:!1,handler:function(){var t=e._iconBar.getItem("selections");e.setSelectionCmdsIcon(t,"selectSiblings");var i=a.getCommand("SelectSiblings",n.getContent());i&&i.begin()}}]}}},e._iconBar.addItem(e.commandsList_inGeneral.expandAndClps),e._iconBar.addItem(e.commandsList_inGeneral.selectionCmd),e._iconBar.addItem(e.commandsList_inGeneral.exportAttributes)},updateCommandVisibilityInIconBar:function(e,t,i,a,n){var l,c=this;function d(e){c._iconBar.disableItem(e),c.disabledCommands.push(e)}function u(e){try{c._iconBar.overflowMenu&&c._iconBar.overflowMenu.disableItem(e);var t=c._iconBar.menu.getItem("moreActions");if(t.content)if(t.content.component)t.content.component.menus[0].updateItem({id:e,disabled:!0});else for(var i=t.content.options.items,a=0;a<i.length;a++)if(i[a].name===e){i[a].disabled=!0;break}}catch(e){console.log(e)}}if(c.enableCommands(),void 0===e&&(e=s.getCurrentLibrary()),void 0===t&&(t="TREE"),void 0===i&&(i=s.getCurrentLibrary()),"TREE"===t)r.inFamilyLibrary(e.plmType)?"RootLibrary"===e.plmType?(d("createNewLibrary"),u("moveClass")):"Library"===e.plmType&&(c.selectedTab?c.selectedTab===o.CONTENT_TABS.CLASSES?(d("createNewLibrary"),u("exportLibrary")):c.selectedTab===o.CONTENT_TABS.CLASSIFICATION_ATTRIBUTES&&d("removeAttribute"):(d("createNewLibrary"),u("exportLibrary"))):"LibrarySection_favorite"==e.plmType?(d("createNewLibrary"),u("exportLibrary"),u("moveClass"),d("createNewClass"),d("deleteGeneric"),d("addRemoveFavorites"),d("properties"),d("changeMaturity"),d("shareMOA")):"LibrarySection_AllLibraries"==e.plmType&&(d("createNewClass"),u("exportLibrary"),u("moveClass"),d("deleteGeneric"),d("addRemoveFavorites"),d("properties"),d("changeMaturity"),d("shareMOA"));else if("CONTENT"===t){var f=i.plmType;if(r.inFamilyLibrary(f)){if("RootLibrary"===e.plmType)n>1&&(d("changeMaturity"),d("shareMOA")),d("createNewLibrary"),d("createNewClass");else if("Library"===e.plmType)n>1&&(d("deleteGeneric"),d("changeMaturity"),d("shareMOA"),u("moveClass")),d("createNewLibrary"),u("exportLibrary"),d("createNewClass");else if("Attribute"===e.plmType){var m;d("addExistingAttribute"),a.forEach(function(e){"ClassOwned"===e.options.origin&&(m=!0)}),m?(l="removeAttribute",c._iconBar.enableItem(l)):d("removeAttribute")}d("expandAndCollapse")}else"LibrarySection_AllLibraries"==f?(d("createNewLibrary"),n>1&&(d("deleteGeneric"),d("changeMaturity"),d("shareMOA"),u("exportLibrary")),u("moveClass"),d("createNewClass"),d("addRemoveFavorites"),d("expandAndCollapse")):"LibrarySection_favorite"==f&&((n>1||!a||!a[0]||"RootLibrary"!==a[0].plmType)&&u("exportLibrary"),d("createNewLibrary"),d("createNewClass"),d("deleteGeneric"),u("moveClass"),d("addRemoveFavorites"),d("shareMOA"))}c._iconBar.show()},setExpandClpsCmdsIcon:function(e,t){var i=e.elements.icon,a=e.tooltip;"expandAll"===t?(i.hasClassName(f)?i.removeClassName(f).addClassName(d):i.hasClassName(p)&&i.removeClassName(p).addClassName(d),e.fonticon=u,e.text=c.command_expandAll,a.setBody(c.command_expandAll)):"expandNLevels"===t?(i.hasClassName(d)?i.removeClassName(d).addClassName(f):i.hasClassName(p)&&i.removeClassName(p).addClassName(f),e.fonticon=m,e.text=c.command_expandNLevels,a.setBody(c.command_expandNLevels)):"collapseAll"===t&&(i.hasClassName(d)?i.removeClassName(d).addClassName(p):i.hasClassName(f)&&i.removeClassName(f).addClassName(p),e.fonticon=g,e.text=c.command_collapseAll,a.setBody(c.command_collapseAll))},setSelectionCmdsIcon:function(e,t){var i=e.elements.icon,a=e.tooltip;"selectAllVisible"===t?(i.hasClassName(y)?i.removeClassName(y).addClassName(C):i.hasClassName(v)&&i.removeClassName(v).addClassName(C),e.fonticon=b,e.text=c.command_selectAllVisible,a.setBody(c.command_selectAllVisible)):"selectInversion"===t?(i.hasClassName(C)?i.removeClassName(C).addClassName(y):i.hasClassName(v)&&i.removeClassName(v).addClassName(y),e.fonticon=h,e.text=c.command_selectInversion,a.setBody(c.command_selectInversion)):"selectSiblings"===t&&(i.hasClassName(C)?i.removeClassName(C).addClassName(v):i.hasClassName(y)&&i.removeClassName(y).addClassName(v),e.fonticon=_,e.text=c.command_selectSiblings,a.setBody(c.command_selectSiblings))},enableCommands:function(){for(var e=this,t=0;t<e.disabledCommands.length;t++)e._iconBar.enableItem(e.disabledCommands[t]);try{var i=e._iconBar.menu.getItem("moreActions");if(i.content)if(i.content.component)["exportLibrary"].forEach(function(e){i.content.component.menus[0].updateItem({id:e,disabled:!1})}),["moveClass"].forEach(function(e){i.content.component.menus[0].updateItem({id:e,disabled:!1})});else for(var a=i.content.options.items,r=0;r<a.length;r++)a[r].disabled=!1;["exportLibrary"].forEach(function(t){e._iconBar.overflowMenu&&e._iconBar.overflowMenu.enableItem(t)}),["moveClass"].forEach(function(t){e._iconBar.overflowMenu&&e._iconBar.overflowMenu.enableItem(t)})}catch(e){console.log(e)}}})}),define("DS/ClassificationEditor/dataProvider/ClassificationCommandsIconBarProvider",["UWA/Class","DS/ClassificationEditor/commands/ClassificationCommandsIconBar"],function(e,t){"use strict";return e.singleton({getCommandsIconBar:function(){return new(require("DS/ClassificationEditor/commands/ClassificationCommandsIconBar"))}})}),define("DS/ClassificationEditor/commands/PLMNewClassCmd",["DS/UIKIT/Mask","DS/ENONewWidget/ENONew/Events","DS/ENONewWidget/command/NewContentCommandBase","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e,t,i,a,r,n){"use strict";var o,s;return i.extend({defaults:{type:o},init:function(i,a){s="new_class",o="General Class",this.defaults.type=o,t.addEvent("onCreationDialogAction",function(t){if(t&&"ready"===t.action){var i=n.getContent().getView().getContent().getChildren()[1].getChildren()[0];e.unmask(i)}}),this._parent(i)},getType(){return this.defaults.type},execute:function(){var t=n.getContent().getView().getContent().getChildren()[1].getChildren()[0];e.mask(t),this.launchCreationDialog()},launchCreationDialog:function(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getOptions:function(){var e,t=r.getCurrentLibrary()._options.usage;return e=r.getCurrentLibrary().getID(),{options:{typeName:o,parentPIDs:[e],attributes:{"Class Usage":t}},context:{serviceBaseUrl:this.options.serviceBaseUrl,tenant:this.options.tenant,header:{SecurityContext:this.options.securityContext},getENONewContext:function(){return{}}},events:this.options.callbacks,viewType:"listView",labelTopBar:a.get(s),activeTopBar:!0,silentMode:!1,type:o}}})}),define("DS/ClassificationEditor/commands/ActionBar_ClassCreationCmd",["DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/PLMNewClassCmd","DS/IPClassifyUX/service/SettingsManagement","DS/PADUtils/PADSettingsMgt","DS/ApplicationFrame/CommandsManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyAlert","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s,l,c,d,u){"use strict";return e.extend({isInsert:!0,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=r.getCurrentCmdId(),f={fetchSecurityContext:function(){return a.getSetting("pad_security_ctx")},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return n.getContent().getView().getPADTreeDocument().getSelectedNodes()},getDocumentFromNodeModel:function(e){return e.options.data},getOrigin:function(){return{source:UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"toolbar"}},platformUrls:i.getPlatformURLs().platformurls},m={onSuccess:function(e){var t=[o.getCurrentLibrary()];c._performFetchQuery({ids:[e.result[0].identifier],dynamicAttrs:[],isAuthoringMode:!0,onComplete:function(i){var a=[],r="library-class";i.results&&i.results.length>0&&(i.results.forEach(function(e){a.push(d.convertToExaleadDataFormatFederated(e))}),a[0].usage&&"Definition"==a[0].usage&&(r="library-class-filled")),n.getTreeCont().addNewNode({physicalid:a[0].physicalid,label:a[0].label,plmType:"Library",type:a[0].type,mxid:a[0].mxid,parentid:o.getSelectedNodes()[0].getID(),icons:[{iconName:r}]}),l.setAuthoringMode("authoring","none"),UWA.is(n.getContent())&&n.getContent().loadContentAndSelect(t[0],e.result[0].identifier),s.displayNotification({message:u.replace(u.msg_info_classcreated,{classname:a[0].label}),className:"success"})},onFailure:function(){}})},onFailure:function(e){console.log("object creation failure")},onCancel:function(e){localStorage.setItem("PLMNewClassCmd"+(UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId),e.preferedType),console.log("object creation cancellled")}};new t({preferedType:localStorage.getItem("PLMNewClassCmd"+(UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId)),serviceBaseUrl:f.platformUrls["3DSpace"],tenant:f.platformUrls.platformId,securityContext:f.fetchSecurityContext(),callbacks:m},e).execute()},endExecute:function(){}})}),define("DS/ClassificationEditor/commands/PLMNewLibraryCmd",["DS/UIKIT/Mask","DS/ENONewWidget/ENONew/Events","DS/ENONewWidget/command/NewContentCommandBase","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(e,t,i,a,r){"use strict";var n,o,s;return i.extend({defaults:{type:n},init:function(i,a){n="General Library","CreateNewDefinitionLibrary"===a?(o="new_definition_library",s="Definition"):(o="new_standard_library",s="Standard"),this.defaults.type=n,t.addEvent("onCreationDialogAction",function(t){if(t&&"ready"===t.action){var i=r.getContent().getView().getContent().getChildren()[1].getChildren()[0];e.unmask(i)}}),this._parent(i)},getType(){return this.defaults.type},execute:function(){var t=r.getContent().getView().getContent().getChildren()[1].getChildren()[0];e.mask(t),this.launchCreationDialog()},launchCreationDialog:function(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getOptions:function(){return{options:{typeName:n,attributes:{"Library Usage":s}},context:{serviceBaseUrl:this.options.serviceBaseUrl,tenant:this.options.tenant,header:{SecurityContext:this.options.securityContext},getENONewContext:function(){return{}}},events:this.options.callbacks,viewType:"listView",labelTopBar:a.get(o),activeTopBar:!0,silentMode:!1,type:n}}})}),define("DS/ClassificationEditor/commands/ActionBar_LibraryCreationCmd",["DS/ApplicationFrame/Command","DS/ClassificationEditor/commands/PLMNewLibraryCmd","DS/IPClassifyUX/service/SettingsManagement","DS/PADUtils/PADSettingsMgt","DS/ApplicationFrame/CommandsManager","DS/IPClassifyUX/utils/IPClassifyModeManager","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/utils/Library_CSO","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/ClassificationEditor/utils/ClassificationEditorDataConversion","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor"],function(e,t,i,a,r,n,o,s,l,c,d,u){"use strict";return e.extend({isInsert:!0,init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1})},beginExecute:function(){},execute:function(){var e=r.getCurrentCmdId(),f={fetchSecurityContext:function(){return a.getSetting("pad_security_ctx")},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return o.getContent().getView().getPADTreeDocument().getSelectedNodes()},getDocumentFromNodeModel:function(e){return e.options.data},getOrigin:function(){return{source:UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"toolbar"}},platformUrls:i.getPlatformURLs().platformurls},m={onSuccess:function(e){var t=[s.getCurrentLibrary()];c._performFetchQuery({ids:[e.result[0].identifier],dynamicAttrs:[],isAuthoringMode:!0,onComplete:function(i){var a=[];i.results&&i.results.length>0&&i.results.forEach(function(e){a.push(d.convertToExaleadDataFormatFederated(e))}),o.getTreeCont().addNewNode({physicalid:a[0].physicalid,label:a[0].label,usage:a[0].usage,plmType:"RootLibrary",type:a[0].type,mxid:a[0].mxid,icons:[{iconName:"library"}]}),n.setAuthoringMode("authoring","none"),UWA.is(o.getContent())&&o.getContent().loadContentAndSelect(t[0],e.result[0].identifier,!1,!1,!0),l.displayNotification({message:u.replace(u.msg_info_librarycreated,{libraryname:a[0].label}),className:"success"})},onFailure:function(){}})},onFailure:function(e){console.log("object creation failure")},onCancel:function(e){localStorage.setItem("PLMNewLibraryCmd"+(UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId),e.preferedType),console.log("object creation cancellled")}};new t({preferedType:localStorage.getItem("PLMNewLibraryCmd"+(UWA.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId)),serviceBaseUrl:f.platformUrls["3DSpace"],tenant:f.platformUrls.platformId,securityContext:f.fetchSecurityContext(),callbacks:m},e).execute()},endExecute:function(){}})}),define("DS/ClassificationEditor/dataProvider/ClassAttributesDataProvider",["UWA/Class","UWA/Class/Promise","DS/ClassificationEditor/service/ClassificationEditorWebService","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassifyUtil/IPClassifyAlert","DS/WebappsUtils/WebappsUtils"],function(e,t,i,a,r,n){"use strict";return e.singleton({hasLibrarianRole:function(){return new t(function(e,t){i.hasLibrarianRole({onComplete:function(t){e({readOnly:JSON.parse(t).isAuthorized.readOnly})},onFailure:function(){t({readOnly:!0})}})})},fetchTheObjects:function(){return new t(function(e){i.fetchAllTheClassificationAttributes({onComplete:function(t){var i=JSON.parse(t).attribute||[],r=n.getWebappsAssetUrl("ClassificationEditor","icons/attributes.png"),o=[];i.forEach(function(e){var t="",i="",n="",s="string"==typeof s?JSON.parse(e.range):e.range;s&&s.length>0&&(s.forEach(function(e){if("between"==e.operator){var a=e.value.split(" ");t=a[0],i=a[2]}else n+=","+e.value}),n.length>0&&(n=n.substring(n.indexOf(",")+1))),o.push({label:e.name,icons:[r],grid:{attrName:e.name,attrTitle:e.nls_label,attrDesc:e.description,attrKind:e.nls_type,attrDefault:e.default,attrHasDefault:e.nls_hasDefault,attrDim:e.manipulationUnit&&e.manipulationUnit.length>0?e.nls_dimension+"("+e.manipulationUnit+")":e.nls_dimension,attrPredi:e.nls_predicate,attrAuthorizedValues:n,attrMinimum:t,attrMaximum:i,attrIsMultivalue:e.valuetype&&"multival"==e.valuetype?a.VALUE_TYPE_TRUE:a.VALUE_TYPE_FALSE,attrIsParametric:e.nls_isParametric,attrIsInDico:e.isInDico,attrSel:!1}})}),e({objectsList:o})},onFailure:function(t,i,n){var o=a.get("msg_classificationattributes_webservicefailed");i&&"User doesnt have Librarian Role"===i&&(o=o+": <br>"+a.error_no_LibrarianRole),r.displayNotification({message:o,className:"error"}),e({})}})})},fetchPlaceHolder:function(){return a.classAttributesPanel_Placeholder},initialSortModel:function(){return[{dataIndex:"attrTitle",sort:"asc"}]},searchMatchCriteria:function(e,t){var i=!1,a=new RegExp(e,"i");return(a.test(t.nodeModel.options.grid.attrTitle)||a.test(t.nodeModel.getLabel())||a.test(t.nodeModel.options.grid.attrKind)||a.test(t.nodeModel.options.grid.attrDim))&&(i=!0),i},fetchColumns:function(){return{checkBoxColumn:"attrSel",objectIdentifier:"attrName",columns:[{icon:{iconName:"check",fontIconFamily:1},dataIndex:"attrSel",pinned:"left",typeRepresentation:"boolean",alwaysVisibleFlag:!0,width:40,resizableFlag:!1,editableFlag:!0,editionPolicy:"EditionInPlace",getCellEditableState:function(e){return e.nodeModel,!0}},{dataIndex:"tree",text:a.column_ActualName||"Name",tooltip:a.column_ActualName||"Actual Name"},{dataIndex:"attrTitle",text:a.column_DisplayName||"Display Name",tooltip:a.column_DisplayName||"Display Name",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrKind",text:a.column_Type||"Type",tooltip:a.column_Type||"Type",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrDesc",text:a.column_Description||"Description",tooltip:a.column_Description||"Description",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrDefault",text:a.column_DefaultValue||"Default Value",tooltip:a.column_DefaultValue||"Default Value",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrHasDefault",text:a.hasDefault||"Has Default",tooltip:a.hasDefault||"Has Default",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrDim",text:a.column_Dimensions||"Dimension",tooltip:a.column_Dimensions||"Dimension",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrPredi",text:a.column_Predicates||"Predicate",tooltip:a.column_Predicates||"Predicate",editableFlag:!1,sortableFlag:!0,resizableFlag:!1},{dataIndex:"attrAuthorizedValues",text:a.column_Authorized_Values||"Authorized Values",tooltip:a.column_Authorized_Values||"Authorized Values",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrIsParametric",text:a.column_Is_Parametric||"Is Parametric",tooltip:a.column_Is_Parametric||"Is Parametric",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrIsMultivalue",text:a.column_Is_Multivalue||"Is Multivalue",tooltip:a.column_Is_Multivalue||"Is Multivalue",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrMinimum",text:a.column_Minimum||"Minimum",tooltip:a.column_Minimum||"Minimum",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrMaximum",text:a.column_Maximum||"Maximum",tooltip:a.column_Maximum||"Maximum",editableFlag:!1,sortableFlag:!0,resizableFlag:!0},{dataIndex:"attrIsInDico",text:a.existInDictionary,tooltip:a.existInDictionary,editableFlag:!1,sortableFlag:!1,resizableFlag:!0}]}}})}),define("DS/ClassificationEditor/commands/ActionBar_AddExistingAttributesCmd",["UWA/Core","DS/ApplicationFrame/Command","DS/ClassificationEditor/service/ClassificationEditorWebService","DS/IPClassifyUtil/IPClassifyAlert","DS/ClassificationEditor/utils/ClassificationEditorcontrol","DS/ClassificationEditor/dataProvider/ClassAttributesDataProvider","DS/ClassificationEditor/commands/LibraryCommands","i18n!DS/ClassificationEditor/assets/nls/ClassificationEditor","DS/IPClassificationAttributes/CreateNewAttributes"],function(e,t,i,a,r,n,o,s,l){"use strict";var c=!1;return t.extend({labelTopBar:e.i18n("Add Existing Classification Attributes"),init:function(e){this._parent(e,{mode:"exclusive",isAsynchronous:!1}),this.attributesPanel=null,n.hasLibrarianRole().then(function(e){e="string"==typeof e?JSON.parse(e):e,c=e.readOnly}).catch(e=>console.log(e.message))},beginExecute:function(){},execute:function(){var e=this;require(["DS/PADServices/utils/GlobalModelEvents","DS/PADUtils/PADContext","DS/IPClassifyUXUtil/ObjectsSelectionPanel","DS/ClassificationEditor/utils/Library_CSO","DS/ClassificationEditor/utils/ClassificationEditorcontrol"],function(t,d,u,f,m){var p=f.getCAChangeAccessOnClass(f.getCurrentLibraryID());if(!p||"true,true"!==p&&"true,false"!==p)o._commonError("AddExistingAttributes",s.command_addExistingAttribute+": ",s.error_noChangeAccessOnCA);else{var g,C,b=d.get(),y="No Class Selected";f.getCurrentLibrary()&&(C=f.getCurrentLibrary(),g=C.getID(),y=C.getLabel());var h=[];try{h=m.getContent()._libraryContentView.getPADTreeDocument().getRoots()}catch(e){}var v={};if(h.forEach(function(e){v[e.options.grid.Name]=!0}),b.options.views?b.options.views.datagridview:void 0){var _=t.getModelEvents();e.attributesPanel=new u({panelHeader:s.command_addExistingAttribute+" - "+y,okButtonLabel:s.classAttributesPanel_okButtonLabel,cancelButtonLabel:s.classAttributesPanel_cancelButtonLabel,okEventName:"AddExistingClassificationAttributes/selectedAttributes",cancelOrCloseEventName:"AddExistingAttributesCmd/Views/showInWidgetBody",modelEvents:_,objectsToSkip:v,dataProvider:n,newAttributeUI:l,isReadOnly:c});var S=[];S.push(_.subscribe({event:"AddExistingClassificationAttributes/selectedAttributes"},function(t){o._startProgressBar(s.command_addExistingAttribute),e.disable(),i.addClassAttributes({pid:g,attributes:t.selectedObjects,onComplete:function(i){var n=i?JSON.parse(i):void 0;if(n&&n.error){var l=n.error;a.displayNotification({message:s.msg_addclassificationattributes_failed+l,className:"error"})}else a.displayNotification({message:s.replace(s.msg_addclassificationattributes_success,{number:t.selectedObjects.length,libraryname:y}),className:"success"}),r.getContent().loadContentAndSelect(C);o._offProgressBar(),e.enable()},onFailure:function(t,i,a){var r=o.extractMyErrorMessage(t,i,a);o._offProgressBar(),e.enable(),o._commonError("AddExistingAttributes",s.msg_addclassificationattributes_failed,r)}}),S.forEach(function(e){_.unsubscribe(e)})})),S.push(_.subscribe({event:"AddExistingAttributesCmd/Views/showInWidgetBody"},function(e){!0===e.restore&&S.forEach(function(e){_.unsubscribe(e)})}))}}})},endExecute:function(){}})});