define("DS/CompareCommon/Cycle",[],function(){"function"!=typeof JSON.decycle&&(JSON.decycle=function(e,t,i){"use strict";var n=new WeakMap;return i=(i=i||[])instanceof String?[i]:i,function e(o,r){var a,s;return null!=t&&(o=t(o)),"object"!=typeof o||null===o||o instanceof Boolean||o instanceof Date||o instanceof Number||o instanceof RegExp||o instanceof String?o:void 0!==(a=n.get(o))?{$ref:a}:(n.set(o,r),Array.isArray(o)?(s=[],o.forEach(function(t,i){s[i]=e(t,r+"["+i+"]")})):(s={},Object.keys(o).forEach(function(t){isNaN(+t)?-1===i.indexOf(t)&&(s[t]=e(o[t],r+"["+JSON.stringify(t)+"]")):console.log("Compare decycle, ignoring key name that seems to be a number: ",t)})),s)}(e,"$")}),"function"!=typeof JSON.retrocycle&&(JSON.retrocycle=function retrocycle($){"use strict";var px=/^\$(?:\[(?:\d+|"(?:[^\\"\u0000-\u001f]|\\(?:[\\"\/bfnrt]|u[0-9a-zA-Z]{4}))*")\])*$/;return function rez(value){value&&"object"==typeof value&&(Array.isArray(value)?value.forEach(function(element,i){if("object"==typeof element&&null!==element){var path=element.$ref;"string"==typeof path&&px.test(path)?value[i]=eval(path):rez(element)}}):Object.keys(value).forEach(function(name){var item=value[name];if("object"==typeof item&&null!==item){var path=item.$ref;"string"==typeof path&&px.test(path)?value[name]=eval(path):rez(item)}}))}($),$})}),define("DS/CompareCommon/DBG_Stopwatch_impl",["UWA/Core"],function(e){var t=-1,i={};"undefined"!=typeof widget&&null==widget._timingEventList&&(widget._timingEventList=[]);var n=function(){};function o(){return(new Date).getTime()}function r(e,t,i){var n=[""," ","  ","   ","    ","     ","      ","       "],o=e-i.toString().length;return o>7&&(o=7),ret="l"==t?n[o]+i:i+n[o],ret}function a(){var e="";if(-1==t)e+="\n>CW>TM>    << no stats to report  >>>";else{var n=function(){var e;e="\n>CW>TM>******************************************************",e+="\n>CW>TM>*            T I M I N G   E V E N T S               *",e+="\n>CW>TM>vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv",i={};for(var n=0;n<=t;n++){var o=widget._timingEventList[n].msStart,a=widget._timingEventList[n].markList.length;if(0!=a){var s=widget._timingEventList[n].markList[a-1].msTime-o;e+="\n>CW>TM> <<<<<<<<<------------------------------------------------\x3e>>>>>>>>\n",e+=">CW>TM> <<<<<<<< --------- Iteration #"+n+", total: "+s+" ms -------- >>>>>>>>\n",e+=">CW>TM> <<<<<<<<<------------------------------------------------\x3e>>>>>>>>\n",widget._timingEventList[n].msElapsed=s;for(var l=0;l<a;l++){var u=widget._timingEventList[n].markList[l],c=u.msTime-o,p="\n>CW>TM> ("+u.msTime+" ms) @ "+r(6,"l",c)+" ms /"+r(4,"l",Math.round(c/s*100))+"% into iter ",d=null;if(null!=u.id)for(var f=0;f<l;f++){var h=widget._timingEventList[n].markList[f];if(h.id==u.id){var m=u.msTime-h.msTime,v=Math.round(m/s*100);null==i[u.str+"    "+u.comment]?i[u.str+"    "+u.comment]=v:i[u.str+"    "+u.comment]+=v,d=" :: from '"+h.str+"'\n                                                                   ----\x3e"+r(6,"l",m)+"ms elapsed, "+r(3,"l",v)+"% of entire op          "+u.comment;break}}var g=null!=d?d:u.comment;e+=p+":: "+u.str+g}}else e+="\n>CW>TM> <<<<<<<<<------------------------------------------------\x3e>>>>>>>>>",e+="\nCW>TM>  <<<<<<<<<----Iteration # "+n+" has no entries... skipping-----\x3e>>>>>>>>",e+="\n>CW>TM> <<<<<<<<<------------------------------------------------\x3e>>>>>>>>>\n"}return e+="\n"}(),o=function(){var e="\n>CW>TM>******************************************************";e+="\n>CW>TM>*    C O M P R E H E N S I V E   D A T A             *",e+="\n>CW>TM>vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv";for(var n=0,o=0;o<widget._timingEventList.length;o++)n+=widget._timingEventList[o].msElapsed;var a=t+1;return e+=">\n>CW>TM>    ITER COUNT: "+a,e+="\n>CW>TM> AVG ITER TIME: "+n/a+" ms",jQuery.each(i,function(t,i){e+="\n>CW>TM>"+r(4,"l",Math.round(i/a*100/100))+"% - "+t.replace("[END]","")}),e}();e+=o+n}return e+=function(){var e="\n>CW>TM>******************************************************";return e+="\n>CW>TM>*              T I M E S T A M P S                   *",e+="\n>CW>TM>vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv\n",null!=widget&&null!=widget.cw_debugtxt?e+=widget.cw_debugtxt:e+=" << No Timestamps >>",e}()}return{iterStart:function(e){t++;var i=new n;i.msStart=o(),i.comment="Start Iteration #"+t+(e?" / "+e:""),i.markList=[],widget._timingEventList.push(i)},mark:function(e){var i=null,n=null,r="";"string"==typeof e?i=e:(i=e.str,n=e.id,r=null!=e.comment?e.comment:""),-1==t?this.dbglog("CANNOT log message, because iteration has not started:"+i):widget._timingEventList[t].markList.push({msTime:o(),id:n,str:i,comment:r})},dump:function(){var e=a();console.log(e)},getTimingOutput:a,dbglog:function(e){null==widget.cw_debugtxt&&(widget.cw_debugtxt="");var t=o();return widget.cw_debugtxt+=">CW>TM> DBGLOG (@"+t+" ms ),'"+e+"'\n",t},reset:function(){t=-1,i={},widget._timingEventList=[]}}}),define("DS/CompareCommon/Input/CompareInputFilterCmd",["DS/ENONextGenFilterCmd/commands/ENONextGenFilterCmd"],function(e){"use strict";return e.extend({init:function(e){this._parent(e),this.root=e.root,this.NGFUXId=e.NGFUXId},setRoot:function(e){this.root=e},_getRootId:function(){return this.root.objId},_getRootLabel:function(){return this.root.displayName},_getNGFUXId:function(){return this.NGFUXId},getAppParams:function(){return{widgetId:widget.id,appId:widget.getValue("appId"),NGFUXId:this.NGFUXId,tenantId:this.root.tenant,securityContext:this.root.securityContext}},getSelectorManager:function(){return null},getRoots:function(){return[{id:this._getRootId(),label:this._getRootLabel(),filtered:0}]},getSelection:function(){return{path:[[this._getRootId()]],label:[[this._getRootLabel()]],directSelection:!0}}})}),define("DS/CompareCommon/CompareIdData",["UWA/Core"],function(e){"use strict";return function(e,t,i){var n=this;function o(e,t){for(var i of e)if(null!=i&&void 0!==i.objectServices&&null!==i.objectServices&&void 0!==i.objectServices.displayName&&null!==i.objectServices.displayName)for(var n of t)if(i.objectServices.displayName.includes(n.toReplace)){let e=new RegExp(n.toReplace,"g"),t=i.objectServices.displayName.replace(e,n.replaceWith);i.objectServices.displayName=t}}this.listType=e||"modelIDList",this.items=t||[],null!=t&&t.length>=2&&null==i?this.areCompared=!0:this.areCompared=i||!1,n.getLeftID=function(){var e=n.items[0];return null!=e?e.objectId:null},n.getRightID=function(){var e=n.items[1];return null!=e?e.objectId:null},n.get_nonNullCount=function(){var e=0;return n.items.forEach(function(t){null!=t&&e++}),e},n.get_objIDList=function(){for(var e=[],t=0,i=0;i<n.items.length;i++){var o=n.items[i];null!=o&&(e[t]=o.objectId,t++)}return e},n.get_objServices=function(e){var t=[];if("left"===e||"right"===e){t[0]=null;let i=n.items["left"===e?0:1];null!=i&&null!=i&&(t[0]=i.objectServices)}else for(var i=0,o=0;o<n.items.length;o++){let e=n.items[o];null!=e&&void 0!==e.objectServices&&null!==e.objectServices&&(t[i]=e.objectServices,i++)}return t},n.get_objFilterData=function(){for(var e=[],t=0;t<n.items.length;++t){e[t]=null;var i=n.items[t];null!=i&&void 0!==i.filterData&&null!==i.filterData&&(e[t]=i.filterData)}return e},n.get_allIDList=function(){for(var e=[],t=[],i=0;i<n.items.length;i++){var o=n.items[i];if(null!=o){e.push(o.objectId);var r=o.commands;if(null!=r)for(var a=r.length,s=0;s<a;s++){var l=r[s].inNode;null!=l&&t.push(l)}}}return t.forEach(function(t){e.push(t)}),e},n.areItemsIdentical=function(e,t){var i=!1,o="number"==typeof e?n.items[e]:e,r="number"==typeof t?n.items[t]:t;return null!=o&&null!=r&&o.objectId===r.objectId&&(void 0!==o.filterData&&null!==o.filterData||void 0!==r.filterData&&null!==r.filterData?void 0!==o.filterData&&null!==o.filterData&&void 0!==r.filterData&&null!==r.filterData&&(void 0!==o.filterData.filterTitle&&null!==o.filterData.filterTitle&&""!==o.filterData.filterTitle&&void 0!==r.filterData.filterTitle&&null!==r.filterData.filterTitle&&""!==r.filterData.filterTitle&&o.filterData.filterTitle===r.filterData.filterTitle?i=!0:void 0!==o.filterData.CVQuery&&null!==o.filterData.CVQuery&&void 0!==r.filterData.CVQuery&&null!==r.filterData.CVQuery?JSON.stringify(o.filterData.CVQuery)===JSON.stringify(r.filterData.CVQuery)&&(i=!0):void 0!==o.filterData.CVQuery3D&&null!==o.filterData.CVQuery3D&&void 0!==r.filterData.CVQuery3D&&null!==r.filterData.CVQuery3D&&JSON.stringify(o.filterData.CVQuery3D)===JSON.stringify(r.filterData.CVQuery3D)&&(i=!0)):i=!0),i},n.safeHtmlDisplayName=function(){o(n.items,[{toReplace:"<",replaceWith:"#LT#"},{toReplace:">",replaceWith:"#GT#"}])},n.restoreDisplayName=function(){o(n.items,[{toReplace:"#LT#",replaceWith:"<"},{toReplace:"#GT#",replaceWith:">"}])}}}),define("DS/CompareCommon/DragAndDrop",["DS/ENO6WPlugins/jQuery","DS/DataDragAndDrop/DataDragAndDrop"],function(e,t){this._processingCB=null,this._processingCBThis=null;var i=function(e,i,n,o,r,a){var s=this;s._target=e,s._dragInVizCB=n,s._dragOutVizCB=o,s._dragOverVizCB=a,s._dragDropCB=r,s._dragCBThis=i,s._dragInCount=0,s.getDropSide=function(e){var t=e.currentTarget.id,i=null;return"drop-target-right"===t||"drop-target-right-iconlabel"===t||"drop-target-right-icon"===t||"compare-tree-to-1"===t||"compare-tree-right"===t||"compare-list-right"===t?i="drop-right":"drop-target-left"===t||"drop-target-left-iconlabel"===t||"drop-target-left-icon"===t||"compare-tree-base"===t||"compare-tree-left"===t||"compare-list-left"===t?i="drop-left":t.startsWith("compare-input-")?t.endsWith("-left")?i="drop-left":t.endsWith("-right")?i="drop-right":console.log("DnD.getDropSide undefined"):console.log("DnD.getDropSide undefined"),i},s.getObjs=function(e){var t=e.originalEvent&&e.originalEvent.dataTransfer||e.dataTransfer,i={objArray:[]},n=null;if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){n=("function"==typeof t.types.indexOf?t.types.indexOf("text/searchitems")>=0:t.types.contains("text/searchitems"))?t.getData("text/searchitems"):t.getData("text/plain")}else{for(var o=UWA.is(t.types.indexOf,"function")?"indexOf":"contains",r="",a=["text/searchitems","text/plain","Text"],s=0;s<a.length&&""===r;s++){var l=t.types[o](a[s]);(UWA.is(l,"number")&&l>=0||UWA.is(l,"boolean")&&!0===l)&&(r=a[s])}""!=r&&(n=t.getData(r))}if(n&&""!=n){for(var u=JSON.parse(n),c=u.data,p=0;p<c.items.length;p++){var d=c.items[p];d.objectType&&"3DShape"===d.objectType&&null!=u.biProxyCtx||i.objArray.push(d)}i.filterProxy=u.biProxyCtx}return i},s.handleDragEnter=function(e){if(e.preventDefault(),s._dragInCount++,1==s._dragInCount){var t=s.getObjs(e);s._dragInVizCB.call(s._dragCBThis,e,t.objArray.length)}return!0},s.handleDragOver=function(e){e.preventDefault(),null!=s._dragOverVizCB&&s._dragOverVizCB(e)},s.handleDragLeave=function(e){return e.preventDefault(),s._dragInCount--,0==s._dragInCount&&s._dragOutVizCB.call(s._dragCBThis,e),!0},s.handleDragDropped=function(e){s._dragInCount=0,e.preventDefault(),s._dragOutVizCB.call(s._dragCBThis,e);var t=s.getObjs(e);if(t.objArray.length>0){var i=s.getDropSide(e);null!=s._dragDropCB?s._dragDropCB.call(s._dragCBThis,e,t,i):null!=_processingCB&&_processingCB.call(_processingCBThis,t.objArray,i,e)}return!0},s.reset=function(){s._dragInCount=0},s.off=function(e){var i=jQuery("#"+e);t.off([],i)};var l=jQuery("#"+e);t.on([],l,{enter:(e,t)=>s.handleDragEnter(t),over:(e,t)=>s.handleDragOver(t),leave:(e,t)=>s.handleDragLeave(t),drop:(e,t,i)=>s.handleDragDropped(i)})};return{_attachedObjects:[],setProcessingCB:function(e,t){_processingCBThis=e,_processingCB=t},attachObject:function(e,t,n,o,r,a){var s=new i(e,t,n,o,r,a),l=this._attachedObjects.findIndex(t=>t._target===e);-1===l?this._attachedObjects.push(s):this._attachedObjects[l]=s},detachObject:function(e){var t=this._attachedObjects.findIndex(t=>t._target===e);-1!==t&&this._attachedObjects[t].off(e)},reset:function(){for(const e of this._attachedObjects)e.reset()}}}),define("DS/CompareCommon/Input/SearchManager",["UWA/Core","UWA/Utils/InterCom","text!DS/CompareCommon/assets/search_config/search_config.json"],function(e,t,i){"use strict";return{initialize:function(){this.socketName="search_socket_"+(new Date).getTime(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var e=this.options();return this.socket.dispatchEvent("RegisterContext",e),this},options:function(e,t,i,n,o,r,a,s){var l={};return l.title=e,l.mode="furtive",l.app_socket_id=this.socketName,null!==widget&&void 0!==widget?l.widget_id=widget.id:l.widget_id="",l.default_with_precond=!0,l.show_precond=!1,l.idcard_activated=!1,l.multiSel=o,l.role=i,t&&(l.precond="flattenedtaxonomies:(",t.forEach(function(e,t){0!==t&&(l.precond+=" OR "),l.precond+='"types/'+e+'"'}),l.precond+=")",l.precond+=' OR [dsxpfl:flattenedTypesIndex]:("dsxpfl:PortfolioVersion" OR "dscpfl:SellableItem")'),r&&(l.precond?l.precond="( "+l.precond+") AND "+r:l.precond=r),a&&a.length>0&&(l.columns=a),l.tenant=s,l},destroy:function(){var e={};e.widget_id=widget.id,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect(),delete this.socket},activate:function(e,t,i,n,o,r,a,s,l){var u=this.options(e,t,i,n,o,a,s,l);this.callback=r,this.socket.dispatchEvent("InContextSearch",u)},isAvailable:function(){return e.is(this.socket)},configureSearch:function(e){this.isAvailable()||this.initialize(e)},displaySearchPanel:function(e,t,n){var o=JSON.parse(i),r=[];for(var a in o)o.hasOwnProperty(a)&&"type_"===a.substring(0,5)&&r.push(o[a]);this.launchSearch({tenant:e,allowedTypes:r,role:"",criteria:i.type_act_physical,additionalQuery:"",bMultiSel:t,in_apps_callback:n})},launchSearch:function(e){var t=this;this._searchInProgress=!0,t.initialize(),t.activate("Compare Search",e.allowedTypes,e.role||"",e.criteria,e.bMultiSel,function(i){t._searchInProgress&&(t._searchInProgress=!1,e.in_apps_callback(i))},e.additionalQuery,e.selectable,e.tenant)},destroySearch:function(){this._searchInProgress&&(this._searchInProgress=!1,this.destroy())},objectsSelected:function(e){var t,i,n=[];if(this.callback){for(t=0,i=e.length;t<i;t++)n.push(e[t]);this.callback(n)}}}}),define("DS/CompareCommon/CompareStructOpenWith",["DS/i3DXCompassPlatformServices/OpenWith"],function(e){"use strict";return e.extend({_buildItems:function(){var e=this,t=[],i=this._getCompatibleApps();return i.length>0&&i.forEach(function(i){t.push({name:i.get("id"),text:i.get("title"),fonticon:"play",handler:function(){e._launchApp(i)}})}),t}})}),define("DS/CompareCommon/launchTree",[],function(){var e=1e3,t=function(e,t,i){var n={id:e,phid:t};return i&&(n.CADOrigin=i),n},i=function(n,o,r){var a=e++;this.id=a.toString(),this.physID=n,this.show=!0,this.isObj=r,o&&(this.select=!0),this.children=[];var s=this;s.addChild=function(e,t,n){var o=new i(e,t,n);return s.children.push(o),o},s.getChild=function(e){var t=null;return e<s.children.length&&(t=s.children(e)),t},s.cleanse=function(){delete this.physID,delete this.isObj;for(var e=0;e<this.children.length;e++)this.children[e].cleanse()},s.makeResult=function(e){var i=s.isObj?"CATIAV5":null;e.push(new t(s.id,s.physID,i));s.children;for(var n=0;n<s.children.length;n++)s.children[n].makeResult(e)},s.findChild=function(e){for(var t=null,i=0;i<s.children.length;i++){var n=s.children[i];if(e==n.physID){t=n;break}}return t}},n=function(){var e=this;e.insert=function(t,n){if(null==e.root){var o=!1;0==t.length&&(o=!0),e.root=new i(t[0],o,!0)}for(var r=e.root,a=1;a<t.length;a++){var s=t[a],l=r.findChild(s);if(null==l){var u=a==t.length-1,c=a%2==0;r=r.addChild(s,u&&n,c)}else r=l}},e.cleanse=function(){e.root.cleanse()}};function o(e,t,i){for(var o=new n,r=function(e,t){var i=e.length,n=t.length,o=new Array(i);for(o.fill(0),j=0;j<i;j++)for(var r=e[j],a=0;a<n;a++){var s=t[a];if(s.contains("_LEFT")&&(s=s.replace(/_LEFT/g,"")),s.contains("_RIGHT")&&(s=s.replace(/_RIGHT/g,"")),r==s){o[j]=2;break}if(r.startsWith(s)){o[j]=1;break}}return o}(t,i),a=r.length,s=0;s<a;s++)if(r[s]>0){var l=2==r[s];o.insert(e[s],l)}return o}var r=function(e){this._pathWithArray=function(e){for(var t=[],i=e.length,n=0;n<i;n++){var o=e[n].pathWith;t.push(o)}return t}(e),this._pathWithStrArray=[];for(var t=0;t<this._pathWithArray.length;t++)this._pathWithStrArray.push(this._pathWithArray[t].join())};return r.prototype.buildLaunchJSON=function(e){for(var t=null,i=[],n=0;n<e.length;n++){for(var r=[],a=e[n],s=0;s<a.length;s++)r.push(a[s].resourceid);i[n]=r.join()}var l=function(e,t,i){var n=null,r=o(e,t,i);return null!=r.root&&((n={version:"2.1",viewpoint:[],workUnder:{version:"1.0",AuthoringContextHeader:null,change:{id:"",name:"",context:[],title:"",description:"",severity:""},evolution:{id:"",displayExpression:"",expression:""}}}).results=function(e){var t=[];return e.root.makeResult(t),t}(r),n.structures=[function(e){return e.cleanse(),{structure:[e.root]}}(r)]),n}(this._pathWithArray,this._pathWithStrArray,i);return null!=l&&(t=JSON.stringify(l)),t},r}),define("DS/CompareCommon/CompareImgSrc",[],function(){var e={VPMReference:"I_VPMNavProduct.png","3DShape":"I_Part.png",CATPart:"I_DECPrtCV5.png",CATProduct:"I_DECAsmCV5.png","CATIA Embedded Component":"I_DECAsmCV5.png",Drawing:"I_VPMNavDrawing.png",ENOStrRefinementSpecification:"I_AdvancedFilter32.png",Workspace:"I_TeamWorkspace.png"},t={ENOStrRefinementSpecification:"I_AdvancedFilter144.png",Workspace:"I_TeamWorkspace108x144.png"},i={Default:"iconSmallDefault.gif",CATShape:"iconSmallCATShape.gif","CATIA CGR":"iconSmallCATIACGR.gif",CATProcess:"iconSmallCATProcess.gif",CATDrawing:"iconSmallCATDrawing.gif","CATIA Design Table":"iconSmallCATIADesignTable.gif","CATIA V4 Model":"iconSmallCATIAV4Model.gif",CATAnalysis:"iconSmallCATAnalysis.gif",CATAnalysisResults:"iconSmallCATAnalysisResults.gif",CATAnalysisComputations:"iconSmallCATAnalysisComputations.gif",Missing:"utilUploadStop.gif"};return{getObjTypeIconPath:function(t){return void 0!==e[t]?"snresources/images/icons/small/"+e[t]:void 0!==i[t]?"common/images/"+i[t]:"common/images/"+i.Default},getObjTypeLargeIconPath:function(e){var i=null;return null!=t[e]&&(i="snresources/images/icons/large/"+t[e]),i},defaultThumbnailPath:"/webapps/W3DSpace/assets/img/big/I_DefaultThumbnail.png",thumbnailUrlPath:"/resources/compare/thumbnailUrl/",iconUrlPath:"/resources/compare/icon/"}}),define("DS/CompareCommon/CompareMetaData",["UWA/Class"],function(e){return e.singleton({typeInfo:{}})}),define("DS/CompareCommon/DBG_Stopwatch",["UWA/Core"],function(e){return{iterStart:function(){},mark:function(){},dump:function(){},getTimingOutput:function(){},dbglog:function(){},reset:function(){},enable:function(){var e=this;require(["DS/CompareCommon/DBG_Stopwatch_impl"],function(t){e.iterStart=t.iterStart,e.mark=t.mark,e.getTimingOutput=t.getTimingOutput,e.dump=t.dump,e.dbglog=t.dbglog,e.reset=t.reset})}}}),define("DS/CompareCommon/CompareAlert",["DS/MessageBus/MessageBus","DS/PADUtils/views/PADAlert","css!DS/CompareCommon/CompareAlert.css"],function(e,t){"use strict";return{doAlert:function(e){if(null!=e&&e.clearExistingFirst){var i=jQuery(".wux-notification-close"),n=document.createEvent("Event");n.initEvent("DSpointerup",!0,!0);for(var o=0;o<i.length;++o)i[o].dispatchEvent(n)}var r="(empty)",a="warning";try{r=e?e.msg:null;e.alertStyle&&(a="compare-alert-error"==e.alertStyle?"error":"compare-alert-success"==e.alertStyle?"success":"compare-alert-info"==e.alertStyle?"info":"warning"),null==r?console.log("%%%% CompareWidget: Blank alert "+a+" sent %%%%"):("error"==a&&console.error("%%%% CompareWidget "+a+": "+r),t.displayNotification({msg:e.msg,eventID:a}))}catch(e){console.log("%%%% CompareWidget: Failed to display alert "+a+" '"+r+"' %%%%")}}}}),define("DS/CompareCommon/CompareIdDataListItem",["UWA/Core"],function(e){"use strict";return function(e,t){this.objectId=e,this.idType=t&&t.idType?t.idType:"modelID",this.commands=t&&t.commands?t.commands:[],this.objectServices=t||null,this.filterData=null}}),define("DS/CompareCommon/Utils",["UWA/Core","UWA/Class","DS/WAFData/WAFData","UWA/Promise","DS/Utilities/Dom","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/WidgetServices/WidgetServices","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings","DS/CompareCommon/CompareMetaData","DS/CompareCommon/CompareIdData","DS/Controls/TooltipModel","DS/ENO6WPlugins/jQuery","UWA/Json","i18n!DS/CompareCommon/assets/nls/CompareCommon"],function(e,t,i,n,o,r,a,s,l,u,c,p,d,f,h,m){"use strict";function v(e,t,n,o,r,s,l){var u=-1!=e.indexOf("?")?"&":"?",c=o.tenant?o.tenant:"OnPremise",p=o.url3DSpace+e+u+"tenant="+c,d={headers:{Accept:"application/json","Accept-Language":a.getLanguage(),"Content-Type":"application/json",SecurityContext:encodeURIComponent(o.securityContext)},method:1==t?"POST":"GET",type:"json",timeout:r,proxy:"passport",onComplete:s,onFailure:l};t&&(d.data=n),i.authenticatedRequest(p,d)}function g(e,t,i,n,o,r){var a=-1!=e.indexOf("?")?"&":"?",s=e;for(var l in t)s+=a+l+"="+t[l],a="&";v(s,!1,null,i,n,o,r)}function y(t,i,n,o,r,a){v(t,!0,e.Json.encode(i),n,o,r,a)}function C(e,t,i,n){g("/resources/compare/revisions2",{objectId:e},t,12e4,function(t){for(var o=null,r=t.results,a=0;a<r.length;a++){var s=r[a];if(s.physicalid==e){o=s;break}}null==o&&null!=n&&n(),i(o)},n)}function b(e,t,i,n){C(e.physicalid,t,function(o){for(var r in o)e[r]=o[r];!function(e,t,i,n,o){y("/resources/FilterBIAPI/Filter/retrieveFilters",Array.isArray(e)?filtername:[e],i,12e4,function(e){var i=null;if(null!=e.success)for(var r=0;r<e.success.length;r++){var a=e.success[r];if(t==a.filterPhysicalid){i=a;break}}null==i&&null!=o&&o(),n(i)},o)}(e.name,e.physicalid,t,function(o){e.filter=o,C(o.rootPhysicalId,t,function(t){o.rootObj=t,e.revision=t.name+" "+t.revision,i()},n)},n)},n)}var I=t.singleton({init:function(){this._parent({})},jQueryTriggerAsync:function(e,t,i){setTimeout(function(){f(e).trigger(t,i)},0)},augDroppedObject:function(e,t,i,n){e.isFilter?function(e,t,i,n){var o=e.filter;null==o?b(e,t,i,n):null==o.rootObj?C(o.rootPhysicalId,t,function(e){o.rootObj=e,filterObj.revision=e.name+" "+e.revision,i()},n):i()}(e,t,function(){i(e.filter.rootObj)},n):this._augNonFilterAsNeeded(e,t,function(){i(e)},n)},_augNonFilterAsNeeded:function(e,t,i,n){var o=this;null==e.type?"3dportfolio"===e.serviceId?(t.tenant=widget.getValue("x3dPlatformId"),t.url3DSpace=e.attributesUrl.url,g("/"+e.attributesUrl.attributes.url,{objectIds:e.physicalid},t,12e4,function(n){var r=[];if(void 0!==n.results&&null!==n.results){if(1==(r=n.results).length)for(var a=0;a<r[0].data.length;++a)"Title"==r[0].data[a].displayName&&(e.Title=r[0].data[a].value),"Version"==r[0].data[a].displayName&&(e.revision=r[0].data[a].value),"dskern:nlsLabel"===r[0].data[a].name&&(e.Title=r[0].data[a].value),"dsxpfl:typeNLSPath"===r[0].data[a].name&&(e.displayType=r[0].data[a].value),"dslc:isVersionNumber"===r[0].data[a].name&&(e.revision=r[0].data[a].value),"preview_url"===r[0].data[a].name&&(e.preview_url=r[0].data[a].value);o.getFederatedAttributesPromise({objectIds:[e.physicalid],serviceIds:[e.serviceId],tenant:t.tenant,securityContext:t.securityContext}).then(function(t){if(void 0!==t.results&&null!==t.results&&t.results.length>0)e.preview_url=t.results[0].preview_url,e.type_icon_url=t.results[0].type_icon_url,e.type=t.results[0].data.find(function(e){return-1!==e.name.search(/ds6w:type$/)}).value;else{let t=m.federated_attributes_failed;void 0!==e.displayName&&null!==e.displayName&&""!==e.displayName&&(t=t+": "+e.displayName),o.showAlertBox(t,null,"warning")}i()},function(){let t=m.federated_attributes_failed;void 0!==e.displayName&&null!==e.displayName&&""!==e.displayName&&(t=t+": "+e.displayName),o.showAlertBox(t,null,"warning")})}},function(e){console.log("COMPARE: failed getting object info")})):C(e.physicalid,t,function(t){for(var n in t)e[n]=t[n];i()},n):i()},loadFilter:function(e,t,i,n){b(e,t,i,n)},getFederatedAttributesPromise:function(t){var o=u.getPlatformWSUrl("3DSearch",t.tenant,"/search");return new n(function(n,s){for(var l={with_indexing_date:!0,with_synthesis:!0,with_nls:!0,label:"ENOCompare-"+("compareWidgetOdtId"!==widget.id?Date.now().toString():"ODTFakeSearch"),select_predicate:[],with_synthesis_hierarchical:!0,select_file:["icon","thumbnail_2d"],query:"",nresults:40,start:"0",tenant:t.tenant},u=0;u<t.objectIds.length;u++)l.query+=(0===u?"":" OR ")+'[ds6w:resourceUid]:"'+t.objectIds[u]+'"';i.authenticatedRequest(o,{method:"POST",type:"json",proxy:"passport",timeout:3e4,data:e.Json.encode(l),headers:{Accept:"application/json",SecurityContext:encodeURIComponent(t.securityContext),"content-type":"application/json","Accept-Language":widget.lang},onComplete:function(e){var t=[],i={results:[]};if(void 0!==e.results)for(var o=0;o<e.results.length;o++){for(var s=e.results[o].attributes,u={data:[]},c=0;c<s.length;c++)if("type_icon_url"===s[c].name)u.type_icon_url=s[c].value;else if("preview_url"===s[c].name)u.preview_url=s[c].value;else if("resourceid"===s[c].name)u.physicalID=s[c].value;else if("sourceid"===s[c].name)u.sourceID=s[c].value;else{var p=s[c].name.split("/"),d=p[p.length-1];u.data.push({nls:d,value:s[c].value,name:s[c].name});for(var f=!1,h=0;!f&&h<t.length;++h)d===t[h]&&(f=!0);f||t.push(d)}i.results.push(u)}if(t.length>0){var m=t.join(",");r.getResourcesInfo(m,{tenantId:l.tenant,lang:a.getLanguage(),apiVersion:"R2018x",onComplete:function(e){for(var t=0;t<i.results.length;++t)for(var o=0;o<i.results[t].data.length;++o)for(var r=i.results[t].data[o],a=0;a<e.vocabularyElementNLSInfo.length;++a){var s=e.vocabularyElementNLSInfo[a].uri,l=e.vocabularyElementNLSInfo[a].nlsName;r.nls===s&&(r.nls=l)}n(i)},onFailure:function(e){console.log("COMPARE: Can't get ElementsNls "+e),n(i)}})}else n(i)},onFailure:function(e){s(t)}})})},getPropertiesPromise:function(e,t,i,o){return new n(function(n,r){("GET"==o?g:y)(e,i,t,864e5,n,r)})},getPropertiesTabsToDisplayPromise:function(e,t){var i=[],n=[0];function o(e,t){return e.length&&e.every(function(e){return"rejected"!==e.status&&e.value.facets[t]&&!0===e.value.facets[t].available})}return Array.isArray(e)&&e.length?(e.forEach(function(e){if(e){var n=[{name:"properties"},{name:"instance"}];widget.propertiesCompareDisplayEffectivity&&(n=n.concat({name:"Effectivity"})),i.push(new Promise(function(i,o){y("/resources/v1/collabServices/attributes/op/facets/available",{id:e,facets:n},t,12e4,i,o)}))}}),i.length?Promise.allSettled(i).then(function(e){return n=[],o(e,"properties")&&n.push(0),o(e,"instance")&&n.push(1),widget.propertiesCompareDisplayEffectivity&&o(e,"Effectivity")&&n.push(2),Promise.resolve(n)},function(){return Promise.resolve(n)}):Promise.resolve(n)):Promise.resolve(n)},getEffectivityPromise:function(e){return new n(t=>{this.loadEffectivities({objectIds:e},e=>{var i=this.formatEffectivities(e);t(i)})})},getEffectivityPromise2:function(e){return new n(t=>{this.loadEffectivities(e,e=>{var i=this.formatEffectivities(e);t(i)})})},formatEffectivities:function(e){var t=[];if(null==e)return console.log("unexpected effectivity"),t;var i=e.expressions;if(null==i)return console.log("unexpected effectivity"),t;for(var n=Object.keys(i),o=n.length,r=0;r<o;r++){var a=n[r],s=i[a],l=s.hasEffectivity;if("ERROR"!=l)if("ERROR"!=s.status){var u=[],c={metatype:"effectivity",physicalID:a,data:u};t.push(c);var p="YES"==l?m.Yes:m.No;if(u.push({name:"Effectivity",nls:m.Effectivity,type:"string",value:[p]}),"NO"!=l){var d=s.content;if(null!=d){var f=d.Variant;null!=f&&u.push({name:"VariantOption",nls:m.VariantOption,type:"string",value:f});var h="",v="",g=d.Evolution;null!=g&&(h=null==g.Current?"":g.Current,v=null==g.Projected?"":g.Projected,u.push({name:"CurrentEvolution",nls:m.CurrentEvolution,type:"string",value:[h]}),u.push({name:"ProjectedEvolution",nls:m.ProjectedEvolution,type:"string",value:[v]}))}else console.log("unexpected effectivity")}}}return{results:t}},loadEffectivities:function(e,t){var i="/resources/modeler/configuration/navigationServices/getMultipleFilterableObjectInfo?timestamp="+(new Date).getTime().toString(),n=e.securityContext;null!=n&&""!==n||(n=widget.securityContext);var o={version:"1.3",output:{targetFormat:"TXT",withDescription:"YES",view:"ALL",domains:"ALL"},pidList:e.objectIds};I.doPost(i,o,widget.getValue("x3dPlatformId"),n,function(e){t(e)}.bind(this),function(e){t({expressions:{}})}.bind(this))},loadAttrs2:function(e,t,i,n,o){var r=widget.getValue("x3dPlatformId");l.loadAttrs(e,t,i,n,r,o,this.getFederatedAttributesPromise,c,void 0)},loadAttrs:function(e,t,i,n,o){for(var r=widget.getValue("x3dPlatformId"),a=null,s=[],l=[],p=[],d=[],f=[],h=[],m=[],v={objectIds:[],serviceIds:[],tenant:widget.getValue("x3dPlatformId"),securityContext:widget.securityContext},g=0;g<e.length;g++)"3DSpace"===t[g]?f.push(e[g]):"3dportfolio"===t[g]?d.push(e[g]):(v.objectIds.push(e[g]),v.serviceIds.push(t[g]));if(n.indexOf(1)>=0)for(g=0;g<i.length;g++)h.push(i[g]);if(n.indexOf(2)>=0)for(g=0;g<i.length;g++)m.push(i[g]);d.length?s.push(this.getPropertiesPromise("/"+c.typeInfo["3dportfolio"].attributes.url,{securityContext:widget.securityContext,tenant:r,url3DSpace:c.typeInfo["3dportfolio"].url},{objectIds:d.join(",")},"GET")):f.length?(a={debug_properties:"",readonly:"false",navigateToMain:"true",attributes:"true",plmparameters:"true",busIDs:f,relIDs:[],lIds:[]},s.push(this.getPropertiesPromise("/resources/v1/collabServices/attributes/op/read",{tenant:r,securityContext:widget.securityContext,url3DSpace:u.get3DSpaceBaseUrl(r)},a,"POST"))):v.objectIds.length&&s.push(this.getFederatedAttributesPromise(v)),h.length&&(a={debug_properties:"",readonly:"false",navigateToMain:"false",attributes:"true",plmparameters:"true",busIDs:[],relIDs:h,lIds:[]},l.push(this.getPropertiesPromise("/resources/v1/collabServices/attributes/op/read",{tenant:r,securityContext:widget.securityContext,url3DSpace:u.get3DSpaceBaseUrl(r)},a,"POST"))),m.length&&p.push(this.getEffectivityPromise(m));var y=s.concat(l).concat(p);Promise.allSettled(y).then(function(e){for(var t=[],i=0;i<e.length;i++)if("rejected"!==e[i].status){var n=e[i].value;void 0!==n.results&&null!==n.results&&(t=t.concat(n.results))}o(t)})},isTitleAttr:function(e,t){var i=e.name,n=e.value,o=this.getTitleAttrNames();return(!1!==t||"PLM_ExternalID"!==i&&"PLM_ExternalID"!==n)&&(-1!=o.indexOf(i)||-1!=o.indexOf(n))},generateTooltip:function(e,t){if(t.includes(".")){var i=t.split(".");t=i[i.length-1]}var n=new d({});return n.loadFromHelpRscFile(e,t),n},getTitleAttrNames:function(){return["attribute[PLMEntity.V_Name]","V_Name","PLM_ExternalID","attribute[PLMInstance.PLM_ExternalID]","attribute[Title]","Title","dskern:nlsLabel","Synopsis"]},accessRightsPromise:function(e,t,o,r){for(var a="",s=0;s<e.length;++s){var l=e[s];0==l.isSupportedType&&(""!==a&&(a+=","),a+='{"objectID":"'+l.physID+'","accessRight":[{"access":{"physical":"read"}}]}')}if(""!==a){var c=u.get3DSpaceWSUrl(t,"/resources/pno/ownership/checkaccess"),p='{"boAccessRights":['+a+"]}";return new n(function(e,t){i.authenticatedRequest(c,{method:"POST",type:"json",proxy:"passport",timeout:5e3,data:p,headers:{Accept:"application/json",SecurityContext:encodeURIComponent(o),"content-type":"application/json","Accept-Language":widget.lang},onComplete:function(e){r(e.success)},onFailure:function(e){r(e.success)}})})}r(!0)},_PROP_COMP_FACETS:["","_INST","_EFF"],compPropFacetsReduceFn:e=>I._PROP_COMP_FACETS.reduce((t,i)=>(t[i]=e(i),t),{}),getPrefFromSession:function(e){return h.decode(sessionStorage.getItem(e))},savePrefToSession:function(e,t){sessionStorage.setItem(e,h.encode(t))},getPrefTimestampFromSession:function(e){return Number(this.getPrefFromSession(`${e}[__CS_TS__]`))},savePrefTimestampToSession:function(e,t){this.savePrefToSession(`${e}[__CS_TS__]`,t.toString())},getPrefLastSavedTimestampFromDashboardPromise:function(e){return this.getUserPreferencesPromise(`${e}[__CS_TS__]`).then(e=>Promise.resolve(Number(e)))},savePrefTimestampToDashboardPromise:function(e,t){return this.saveUserPreferencesPromise(`${e}[__CS_TS__]`,t.toString())},getPrefFromSessionPromise:function(e){return Promise.resolve(this.getPrefFromSession(e))},loadPref:function(e,t,n){a.getCompassUrlAsync({onComplete:function(o){var r=o+"/resources/AppsMngt/user/getPreferences?name="+encodeURI(e);i.authenticatedRequest(r,{method:"GET",timeout:5e3,headers:{Accept:"application/json",SecurityContext:void 0},onComplete:function(e){t(e)},onFailure:function(e){"function"==typeof n?n(e):t("")},cache:!1})}})},savePref:function(e,t,n,o){a.getCompassUrlAsync({onComplete:function(r){var a=r+"/resources/AppsMngt/user/setPreferences?name="+encodeURI(e)+"&value="+encodeURI(t);i.authenticatedRequest(a,{method:"GET",timeout:5e3,headers:{Accept:"application/json",SecurityContext:void 0},cache:!1,onComplete:function(e){"function"==typeof n&&n(e)},onFailure:function(e){"function"==typeof o?o(e):onLoad("error")}})}})},saveUserPreferencesPromise:function(e,t){return new Promise(function(i,n){I.savePref(e,encodeURIComponent(h.encode(t)),i,n)})},getUserPreferencesPromise:function(e){return new Promise(function(t,i){I.loadPref(e,e=>{let i="";try{i=h.decode(decodeURIComponent(e))}catch{i=decodeURIComponent(e)}t(i)},i)})},setPreferencesToWidget:function(e,t,i){let n,o,r=[];"string"==typeof e?(n=[e],o=[t]):Array.isArray(e)&&Array.isArray(t)&&(n=e,o=t),Promise.allSettled(n.map(e=>I.getUserPreferencesPromise(e))).then(e=>{e.forEach((e,t)=>{"rejected"!==e.status&&e.value?"string"==typeof o[t]&&o[t].length&&null!=e.value&&""!=e.value&&(widget.setValue(o[t],e.value),r.push({[n[t]]:e.value})):console.info(" Compare Utils.setPreferencesToWidget: Failed to get preference and save to widget "+n[t])}),"function"==typeof i&&i(1===r.length?Object.values(r)[0]:r)})},doPost:function(e,t,i,n,o,r){y(e,t,{url3DSpace:u.get3DSpaceBaseUrl(i),tenant:i,securityContext:n},864e5,o,r)},getExpressionPromise:function(e,t){return new n(function(i,n){g("/resources/compare/getExpressionValue",{expressionName:e},t,864e5,i,n)})},mergeArrays:function(e){for(var t={},i=0;i<e.length;i++)for(var n=e[i],o=0;o<n.length;o++)t[n[o]]=!0;return Object.keys(t)},determineListType:function(e){for(var t="unknown",i=!1,n=!1,o=!1,r=e.items,a=0;a<r.length;a++){var s=r[a];"snapshotID"==s.idType?o=!0:"modelID"==s.idType?i=!0:"IDPlusCommands"==s.idType?n=!0:null==s.idType?i=!0:console.error("COMPARE>> Unknown idtype in input")}return o?t="snapshotIDList":n?t="IDPlusCommandsList":i?t="modelIDList":console.error("COMPARE>> Unknown idType in input"),t},persistIDs:function(e){e.safeHtmlDisplayName(),widget.setValue("persistedIDs",JSON.stringify(e))},fetchPersistedIDs:function(){var e=null,t=widget.getValue("persistedIDs");if(t){var i=JSON.parse(t);(e=new p(i.listType,i.items,i.areCompared)).restoreDisplayName()}return e},clear_persistedIDs:function(){widget.setValue("persistedIDs",null)},getX3DContent:function(){return widget.getValue("X3DContentId")},fetchContentFromCompass:function(){var e=this.getX3DContent();return null!=e&&e.constructor==String&&(e=JSON.parse(e)),e},setCredentialsToWidget:function(e){var t=e.replace("ctx::","");widget.setValue("xPref_CREDENTIAL",t)},isRevBranchRevPattern:function(e,t){var i=!1,n="",o=e.match(/_/g);if(null!=o&&o.length>0?n="_":null!=(o=e.match(/\x2e/g))&&o.length>0&&(n="."),""!==n){t.separator=n,t.branches=[];var r=e.split(n);if(r.length>2){i=!0;for(var a=r.length-1;a>=0;a-=2)0===a?t.branches.push({branchId:"",revisionId:r[a]}):1===a?t.branches.push({branchId:"",revisionId:r[a-1]+n+r[a]}):t.branches.push({branchId:r[a-1],revisionId:r[a]})}}return i},compareRevBranchRev:function(e,t){var i="revision";if(void 0===e.branches||void 0===t.branches||e.branches.length!==t.branches.length)i="branch";else for(var n=0;n<e.branches.length&&"revision"===i;++n)n<e.branches.length-1?e.branches[n].branchId===t.branches[n].branchId&&e.branches[n].revisionId===t.branches[n].revisionId||(i="branch"):e.branches[n].branchId!==t.branches[n].branchId&&(i="branch");return i},getAttrValueFromAttrData:function(e){var t="";if(null!=e&&void 0!==e.value&&null!==e.value){var i="timestamp"===e.type||"modified"===e.name||"originated"===e.name;if(e.value.constructor==Array)if(!0===e.multivalue)for(var n=0;n<e.value.length;++n){var o;if(i){var r=new Date(e.value[n]);o=a.formatDate(r,!0)}else o=e.value[n];t+=o,n!==e.value.length-1&&(t+=", ")}else if(i){r=new Date(e.value[0]);t=a.formatDate(r,!0)}else t=e.value[0];else if(i){r=new Date(e.value);t=a.formatDate(r,!0)}else t=e.value}return t},__setUMPrefs:function(e,t){require(["DS/CompareWidget2/userSettings/UserSettingsManager"],i=>{setTimeout(()=>{let n=!1;for(const[t,o]of Object.entries(e))i.hasPref(t)&&i.get(t)!==o&&(i.set(t,o),n=!0);t(n)},0)})},forceRequireIndex:function(e,t,i){!0===widget.compareV1?widget.getBool("useIndex")||(e||this.showAlertBox("INDEX_REQ_ENABLING",m,"warning"),widget.setValue("useIndex",!0)):(widget.setValue("compareSettings.dataSource.useIndex",!0),this.__setUMPrefs({"compareSettings.dataSource.useIndex":!0},n=>{!e&&n&&this.showAlertBox(t?"INDEX_REQ_ENABLING_FOR_CUSTOM_PROFILE":"INDEX_REQ_ENABLING",m,"warning"),"function"==typeof i&&i(n)}))},disableExternalRelationsComputation:function(e){this.__setUMPrefs({"compareSettings.includeFacets.externalRelations.showDocs":!1,"compareSettings.includeFacets.externalRelations.showOtherRels":!1},t=>{t&&this.showAlertBox("DISABLE_EXTERNAL_RELATIONS",m,"warning"),"function"==typeof e&&e(t)})},forceIndex_DisableOtherRelations_ForCustomProfilePromiseArray(){return[new Promise((e,t)=>this.forceRequireIndex(!1,!0,e)),new Promise((e,t)=>this.disableExternalRelationsComputation(e))]},intersectionDifference:function(e,t,i,n){if(null==e&&(e=[]),null==t&&(t=[]),!Array.isArray(e)&&!Array.isArray(t))throw Error("ArrayUtils.setDifference: both inputs should be an array");for(var o=e.slice(),r=t.slice(),a={intersection:[],difference:void 0},s={intersection:[],difference:void 0},l=!0===n?o.length-1:0;!0===n?l>=0:l<o.length;l=!0===n?l-1:l+1)for(var u=!0===n?r.length-1:0;!0===n?u>=0:u<r.length;u=!0===n?u-1:u+1)if(i(o[l],r[u])){a.intersection.unshift(o.splice(l,1)[0]),s.intersection.unshift(r.splice(u,1)[0]),!n&&(l-=1);break}return a.difference=o,s.difference=r,[a,s]},checkIsAdminUserPromise:function(){return new Promise(e=>{s.getUser({onComplete:function(t){var i=!1,n=t.platforms;n&&n.length>0&&n.forEach(function(e){e.id===widget.getValue("x3dPlatformId")&&"admin"===e.role&&(i=!0)}),e({isAdminUser:i,id:t.id})},onFailure:function(e){console.error("FAILED TO GET compass services: "+e)}})})},getWidgetCredentialsCompanyId:function(){return this.getWidgetCredentialsSecurityContext().split(".")[1]},getWidgetCredentialsSecurityContext:function(){return widget.getValue("xPref_CREDENTIAL")},showAlertBox:function(e,t,i,n,o){var r="compare-alert-warning";switch(i){case"warning":r="compare-alert-warning";break;case"error":r="compare-alert-error";break;case"success":r="compare-alert-success";break;case"info":r="compare-alert-info";break;default:r="compare-alert-warning"}require(["DS/CompareCommon/CompareAlert"],function(i){null==t?i.doAlert({msg:e,alertStyle:r,clearExistingFirst:n}):require([t],function(){var a=t[e];null==a?a=e+" (NLS message is missing)":""==a?a=e+"(NLS message is blank)":null!=o&&(a=t.replace(a,o)),i.doAlert({msg:a,alertStyle:r,clearExistingFirst:n})},function(){i.doAlert({msg:e+" (NLS file '"+t+"' cannot be found)",alertStyle:r})})},function(t){e="%%%% CompareWidget:: Failed to show "+i+": '"+e+"', error:"+t,"error"==i?this.errout(e):this.warnout(e)})},confirmDialog:function(e,t,i,n,o){this.confirmDialog2({message:e,fonticon:t,okButton:i,koButton:n,title:o})},confirmDialog2:function(t){require(["DS/UIKIT/SuperModal"],function(i){var n="",o=new i({events:{onHide:function(){""===n&&void 0!==t.closeX&&null!==t.closeX&&null!==t.closeX.callback&&void 0!==t.closeX.callback&&"function"==typeof t.closeX.callback&&t.closeX.callback(),n=""}},renderTo:document.body}),r=document.createElement("div");r.innerHTML=t.message;var a=document.createElement("div");if(a.className="compare_popup_warning",null!=t.fonticon){let i=e.createElement("span",{class:"compare_warning_icon fonticon "+t.fonticon+" fonticon-2x"});a.appendChild(i)}else if(null!=t.iconpath&&t.iconpath.length>0){let i=e.createElement("div",{style:"height: 100%"}),n=e.createElement("img",{src:t.iconpath});i.appendChild(n),a.appendChild(i)}var s=document.createElement("div");s.appendChild(a),s.appendChild(r);var l=[];l.push({className:"primary compare-input-Ok",value:void 0!==t.okButton.label&&null!==t.okButton.label&&""!==t.okButton.label?t.okButton.label:null,action:function(e){n="ok",e.hide(),null!==t.okButton.callback&&void 0!==t.okButton.callback&&"function"==typeof t.okButton.callback&&t.okButton.callback()}}),null!==t.koButton&&l.push({className:"default compare-input-Cancel",value:void 0!==t.koButton.label&&null!==t.koButton.label&&""!==t.koButton.label?t.koButton.label:null,action:function(e){n="cancel",e.hide(),null!==t.koButton.callback&&void 0!==t.koButton.callback&&"function"==typeof t.koButton.callback&&t.koButton.callback()}}),o.dialog({title:null!=t.title?t.title:m.get("CompareDialogHeader"),body:s,buttons:l})})}});return I}),define("DS/CompareCommon/WidgetPreferences",["UWA/Core","UWA/Class","DS/Controls/Toggle","DS/Controls/ComboBox","UWA/Json","DS/CompareCommon/Utils","i18n!DS/CompareWidget/assets/nls/CompareWidget"],function(e,t,i,n,o,r,a,s){"use strict";return t.singleton({init:function(){this._parent({}),this.PREF_NAME="compare_widget_pref_webinwin",this.defaults={vizOverview:!0,vizLegend:!0,openness_revisions:!1,openness_duplicates:!1,useIndex:!0,viewer_display_mode:"select"}},loadDefaults:function(e,t){r.loadPref(e,function(e){if(""!=e)try{for(var i=o.decode(e),n=0;n<widget.preferences.length;n++){var r=widget.preferences[n].name,a=i[r];null!=a&&widget.setValue(r,a)}}catch(e){console.log(e)}t()})},saveAsDefaults:function(e,t){for(var i={},n=0;n<widget.preferences.length;n++){var a=widget.preferences[n].name,s=widget.getValue(a);null!=s&&(i[a]=s)}r.savePref(e,o.encode(i),function(){t()})},setDefaults:function(e){for(var t in e)this.defaults[t]=e[t]},load:function(e){var t=this.defaults,i={};r.loadPref(this.PREF_NAME,function(n){if(""!=n)try{i=o.decode(n)}catch(e){console.log(e)}for(var r=Object.keys(t),a=0;a<r.length;a++){var s=r[a],l=i[s];null==l&&(l=t[s]),widget.setValue(s,l)}e()})},edit:function(t){var s=e.createElement("div",{styles:{position:"absolute",overflow:"auto",width:"100%",height:"100%",left:"0px",top:"0px","z-index":4e4,"background-color":"white"}});s.inject(document.body);var l=e.createElement("div",{styles:{position:"relative",width:"70%",margin:"auto"}});l.inject(s),new e.Element("h4",{text:a.editPref}).inject(l);for(var u=[],c=[],p=0;p<widget.preferences.length;p++){var d=widget.preferences[p],f=d.type;if("boolean"==f){var h=new i({label:d.label,value:d.name,visibleFlag:!0,checkFlag:widget.getBool(d.name)});h.pref=d,h.inject(l),u.push(h)}else if("list"==f){new e.Element("h5",{text:d.label}).inject(l);for(var m=[],v=[],g=d.options,y=0;y<g.length;y++){var C=g[y];m.push(C.label),v.push(C.value)}var b=new n({enableSearchFlag:!1,elementsList:m,selectedIndex:v.indexOf(widget.getValue(d.name))});b.pref=d,b.getContent().setStyles({width:"100%",height:"30px"}),b.inject(l),c.push(b)}}var I=e.createElement("div",{styles:{"margin-top":"20px"}}).inject(l),D={"margin-left":"10px",float:"right"},O=e.createElement("button",{type:"button",class:"btn-default btn btn-root",styles:D,html:a.cancel}).inject(I),S=e.createElement("button",{type:"button",class:"btn-primary btn btn-root",styles:D,html:a.save}).inject(I);O.addEventListener("click",function(){s.destroy()});var _=this;S.addEventListener("click",function(){for(var e={},i=0;i<u.length;i++){var n=u[i],a=n.pref.name,l=n.checkFlag;e[a]=l,widget.setValue(a,l)}for(i=0;i<c.length;i++){var p=c[i];a=p.pref.name,l=p.pref.options[p.selectedIndex].value;e[a]=l,widget.setValue(a,l)}r.savePref(_.PREF_NAME,o.encode(e),function(){s.destroy(),t()})})},addWidgetPrefs:function(e){var t=[{name:"credentialPrefName",type:"hidden",V1:!0,V2:!0},{name:"serverTimingVerbose",type:"hidden",defaultValue:"_serverTimingVerbose",V1:!0,V2:!0},{name:"vizStructPanel",type:"hidden",defaultValue:!0,V1:!0},{name:"vizAttrTable",type:"hidden",defaultValue:!1,V1:!0},{name:"vizViewerPanel",type:"hidden",defaultValue:!0,V1:!0},{name:"ratioStructPanel",type:"hidden",defaultValue:-1,V1:!0},{name:"ratioAttrTable",type:"hidden",defaultValue:-1,V1:!0},{name:"ratioViewerPanel",type:"hidden",defaultValue:-1,V1:!0},{name:"vizOverview",type:"boolean",label:a.showOverviewBar,defaultValue:!0,V1:!0},{name:"vizLegend",type:"boolean",label:a.showCompareStatusLegend,defaultValue:!0,V1:!0},{name:"openness_revisions",type:"boolean",label:a.opennessRevision,defaultValue:!1,V1:!0,V2Migrate:!0},{name:"openness_duplicates",type:"boolean",label:a.opennessDuplicates,defaultValue:!1,V1:!0,V2Migrate:!0},{name:"useIndex",type:"boolean",label:a.useIndex,defaultValue:!0,V1:!0,V2Migrate:!0},{name:"showDocs",type:"boolean",label:a.showDocs,defaultValue:!1,V1:!0,V2Migrate:!0},{name:"showOtherRels",type:"boolean",label:a.showOtherRels,defaultValue:!1,V1:!0,V2Migrate:!0},{name:"viewer_display_mode",type:"list",label:a.viewerDisplayMode,defaultValue:"V1"===e?"isolate":"select",options:[{label:a.selectInTreeIsolateInViewer,value:"isolate"},{label:a.selectInTreeSelectInViewer,value:"select"}],V1:!0,V2Migrate:!0},{name:"attributes_not_shown",type:"hidden",defaultValue:"",V1:!0,V2Migrate:!0},{name:"attributes_not_shown_INST",type:"hidden",defaultValue:"",V1:!0,V2Migrate:!0},{name:"attributes_not_shown_EFF",type:"hidden",defaultValue:"",V1:!0,V2Migrate:!0}];if(!e)throw Error("WidgetPreferences.addWidgetPreferences: need param name to set widget preferences");t.filter(t=>!0===t[e]).forEach(t=>{"V2Migrate"===e&&(t.type="hidden"),widget.addPreference(t)})},addWidgetPreference:function(t,i,n){widget.addPreference(e.extend(i,{name:t})),null!=n&&widget.setValue(t,n)},isV1ToV2PrefMigrationComplete:function(e,t,i){r.getUserPreferencesPromise(e+"[migratedToV2]").then(function(e){"true"===e||!0===e?t():i()},i)},setV1ToV2PrefMigrationCompletedFlag:function(e,t){return r.saveUserPreferencesPromise(e+"[migratedToV2]","boolean"!=typeof t||t)}})}),define("DS/CompareCommon/Input/FilterManager",["UWA/Core","DS/CompareCommon/Input/CompareInputFilterCmd","DS/ENOFilterBIUX/FilterBIComponentProxy"],function(e,t,i){"use strict";return{initialize:function(e,t,n,o){if(null!=t&&""!==t){if(void 0===this._filterProxy||null===this._filterProxy){function r(e,t,i){let n=new i({appId:widget.getValue("appId"),widgetId:widget.id,NGFUXId:e,tenant:widget.getValue("x3dPlatformId"),securityContext:t,ExpandSynthesisON:!0,selectionFilterAvailable:!1,volumeFilterAvailable:!1,shareFilterSpec:!0});return null!==n&&n.setNGFilterOptions({appID:widget.getValue("appId")}),n}for(var a of(this._filterCmd=null,this._filterProxy=[],void 0!==this._ctxt&&null!==this._ctxt||(this._ctxt=e),n))void 0!==this._filterProxy[a.whichOne]&&null!==this._filterProxy[a.whichOne]||(this._filterProxy[a.whichOne]=r("CompareWidget_"+a.whichOne,t,i))}this.setApplyCallback(e,n,o)}},setApplyCallback:function(e,t,i){for(var n of t)void 0!==this._filterProxy[n.whichOne]&&null!==this._filterProxy[n.whichOne]&&(this._filterProxy[n.whichOne].removeEvent("ApplyNGFilter"),this._filterProxy[n.whichOne].addEvent("ApplyNGFilter",i,e))},isCtxt:function(e){return this._ctxt===e},activateProxy:function(e){void 0!==this._filterProxy[e]&&null!==this._filterProxy[e]?this._filterProxy[e].activate():console.log("Compare FilterManager: activateProxy() failed")},getFilterProxy:function(e){var t=null;return void 0!==this._filterProxy[e]&&null!==this._filterProxy[e]?t=this._filterProxy[e]:console.log("Compare FilterManager: getFilterProxy() failed"),t},executeFilterCmd:function(e,i){var n="CompareWidget_"+e;void 0!==this._filterCmd&&null!==this._filterCmd&&this._filterCmd.NGFUXId===n?this._filterCmd.setRoot(i):this._filterCmd=new t({ID:"DefineFilter",root:i,NGFUXId:n}),this._filterCmd.execute()},hasFilter:function(e,t){return!0===this._filterProxy[e].hasFilter(t).hasFilter},getFilterSpecificationPromise:function(e,t){var i=this;return new Promise(function(n,o){if("left"===e||"right"===e)if(void 0!==i._filterProxy[e]&&null!==i._filterProxy[e]){let o={rootId:t,NGFUXId:"CompareWidget_"+e,widgetId:widget.id,eventName:"getFilterSpec-Compare-"+e};i._filterProxy[e].removeEvent(o.eventName),i._filterProxy[e].addEvent(o.eventName,function(e){n(e)}),i._filterProxy[e].getPublicFilterSpecification(o)}else o();else o()})},setFilterSpecificationPromise:function(e,t,i){var n=this;return new Promise(function(o,r){if("left"===e||"right"===e)if(void 0!==n._filterProxy[e]&&null!==n._filterProxy[e]){let r={rootId:t,specification:i,applyFilter:1,eventName:"setFilterSpec-Compare-"+e};n._filterProxy[e].removeEvent(r.eventName),n._filterProxy[e].addEvent(r.eventName,function(e){o(e)}),n._filterProxy[e].setPublicFilterSpecification(r)}else r();else r()})},clearFiltering:function(e,t){"left"!==e&&""!==e||void 0===this._filterProxy.left||null===this._filterProxy.left||this._filterProxy.left.removeRoot(t.left),"right"!==e&&""!==e||void 0===this._filterProxy.right||null===this._filterProxy.right||this._filterProxy.right.removeRoot(t.right)}}}),define("DS/CompareCommon/Input/RevisionsManager",["UWA/Core","DS/CompareCommon/Utils","i18n!DS/CompareCommon/assets/nls/CompareInput"],function(e,t,i){"use strict";return{displayHistoryGraph:function(e,n,o,r){var a=this;require(["DS/ENOXVersionExplorerController/VersionExplorerController","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/ENOXVersionExplorerUtils/VersionExplorerSettings","DS/LifecycleServices/LifecycleServices","DS/Utilities/TouchUtils","css!DS/CompareCommon/Input/CompareInputRevisionsModal.css"],function(s,l,u,c,p){a.revisionsExplorer=new s({versionGraphContainer:null,widget:widget,autoUpdate:!1,useGlobalStorage:!0,globalStorageName:"historyUserSettings"}),a.revisionsExplorer.setSingleSelectionMode(),a.revisionsExplorer.disableCommands();var d=null,f=p.getTouchMode(),h={className:"CompareInputRevisionsModal"+(f?"_Touch":""),maximizable:!0,showMaximized:f,dlgTitle:o.dlgTitle,okButtonLabel:o.OKButtonLabel};a.revisionsExplorer.showDialog(h,void 0,!0);var m={displayLegend:!1};c.getHistoryConfigPromise().then(function(e){u.historyConfig=e,u.historyConfig&&u.historyConfig.settings&&(u.historyConfig.settings.defaultView&&(m.displayMode=l.DISPLAY_MODES[u.historyConfig.settings.defaultView]),u.historyConfig.settings.thumbnailGraph&&(u.historyConfig.settings.thumbnailGraph.thumbnailGraphLayout&&(m.thumbnailGraphLayout=u.historyConfig.settings.thumbnailGraph.thumbnailGraphLayout),u.historyConfig.settings.thumbnailGraph.displayThumbnailOverview&&(m.displayThumbnailOverview="true"===u.historyConfig.settings.thumbnailGraph.displayThumbnailOverview)),u.historyConfig.settings.subwayGraph&&(u.historyConfig.settings.subwayGraph.subwaySort&&(m.subwaySortAscending="asc"===u.historyConfig.settings.subwayGraph.subwaySort),"SUBWAY_COMPACT_VIEW"!==u.historyConfig.settings.subwayGraph.viewMode&&"SUBWAY_COMFORTABLE_VIEW"!==u.historyConfig.settings.subwayGraph.viewMode||(m.subwayViewMode=u.historyConfig.settings.subwayGraph.viewMode)))},function(){}).finally(function(){u.loadUserSettingsPromise(m,!1,!0,"historyUserSettings").then(function(){let t=l.DATA_MODEL_TYPES.MODEL_HISTORY;null!=o&&!1===o.allowDuplicates&&(t=l.DATA_MODEL_TYPES.MODEL_REVISION),a.revisionsExplorer.publishEvent("ENOXVersionExplorerLoadVersionModel",{id:e.objId,type:e.objType,tenantId:e.tenant,securityContext:e.securityContext,dataModelType:t,onComplete:function(){if(o&&o.disableRoot)a.revisionsExplorer.applyFilter(function(e){var t=!0;if(null!=n)if(Array.isArray(n))for(var i=0;i<n.length;++i)n[i]===e._options.id&&(t=!1);else n===e._options.id&&(t=!1);return t});o&&o.disableRoot||(a.revisionsExplorer.publishEvent("ENOXVersionExplorerSetActiveVersion",{id:e.objId}),a.revisionsExplorer.select(e.objId))}})})}),a.revisionsExplorer.subscribeEvent("ENOXVersionExplorerLoadCompleted",function(e){if(widget&&widget.body&&o&&o.controlOKButton){var t=widget.body.querySelector(".CompareInputRevisionsModal");t&&(d=t.querySelector("._BTN_OK"))&&(d.disabled=!0)}},!1),a.revisionsExplorer.subscribeEvent("select",function(e){o&&o.controlOKButton&&d&&(d.disabled=!1)},!1),a.revisionsExplorer.subscribeEvent("unselect",function(e){o&&o.controlOKButton&&d&&(d.disabled=!0)},!1),a.revisionsExplorer.subscribeEvent("ENOXVersionExplorerModalOK",function(e){var n=a.revisionsExplorer.getSelectedNodes(),o=n.length;if(o>0){for(var s,l=0;l<o;++l)void 0===s&&(s=n[l].options.data);void 0!==s?r(s):t.showAlertBox("rootRevisionGraphSel",i,"warning")}else t.showAlertBox("noRevisionGraphSel",i,"warning");a.revisionsExplorer.cleanup(),a.revisionsExplorer=null},!1),a.revisionsExplorer.subscribeEvent("ENOXVersionExplorerModalCancel",function(e){t.showAlertBox("noRevisionGraphSel",i,"warning"),a.revisionsExplorer.cleanup(),a.revisionsExplorer=null},!1)})},closeHistoryGraphDialog:function(){null!==this.revisionsExplorer&&this.revisionsExplorer.hideDialog(),this.revisionsExplorer=null}}}),define("DS/CompareCommon/Input/CompareInput",["UWA/Core","DS/WAFData/WAFData","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","DS/UIKIT/Mask","DS/UIKIT/Iconbar","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/Controls/ResponsiveTileView","DS/Tweakers/GeneratedToolbar","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOXEmptyContent/js/ENOXEmptyContent","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleServices/LifecycleServices","DS/CompareCommon/CompareImgSrc","DS/CompareCommon/CompareMetaData","DS/CompareCommon/DBG_Stopwatch","DS/CompareCommon/DragAndDrop","DS/CompareCommon/Utils","DS/CompareCommon/CompareIdData","DS/CompareCommon/CompareIdDataListItem","DS/CompareCommon/Input/SearchManager","DS/CompareCommon/Input/RevisionsManager","DS/CompareCommon/Input/FilterManager","DS/ENOCollabToolsUI/tracker/ENOCollabTracker","i18n!DS/UIKIT/assets/nls/UIKIT","i18n!DS/CompareCommon/assets/nls/CompareInput","i18n!DS/CompareCommon/assets/nls/CompareCustomization","css!DS/PADServices/PADServices.css","css!DS/CompareCommon/Input/CompareInput.css"],function(e,t,i,n,o,r,a,s,l,u,c,p,d,f,h,m,v,g,y,C,b,I,D,O,S,_,w,j){"use strict";var x=h.defaultThumbnailPath,T=h.getObjTypeIconPath("Default"),L=h.thumbnailUrlPath,E=h.iconUrlPath,P="",A=[];A.left="",A.right="";const F="compare-input-empty",R=F+"-left",N=F+"-right",B="compare-input-dropzone",V="compare-input-drop-label",k=V+"-left",M=V+"-right",W="compare-input-panel",U=W+"-root",G=W+"-dropArea",Q="addObjects",z="addObjRev",X="addObjFilter",H=W+"-"+Q,q=H+"-left",J=H+"-right",K=W+"-"+z,Z=K+"-left",$=K+"-right",Y=W+"-"+X,ee=Y+"-left",te=Y+"-right",ie="compare-input-tile",ne=ie+"-left",oe=ie+"-right",re="compare-input-tile-container",ae="compare-input-search",se=ae+"-left",le=ae+"-right",ue="compare-input-filterOf",ce=ue+"-left",pe=ue+"-right",de="compare-input-revsOf",fe=de+"-left",he=de+"-right";var me=function(e){};function ve(e,t){null!==e&&(jQuery("#"+F+"-"+t).addClass("compare-input-while-dragging"),jQuery("#"+B+"-"+t).show(),jQuery("#"+ie+"-"+t).addClass("compare-input-while-dragging"))}function ge(e,t,i){var n=t+"-"+i;P=n,jQuery("#"+n).children().addClass("zoneHighlighted")}function ye(e,t,i){var n=t+"-"+i;jQuery("#"+n).children().removeClass("zoneHighlighted"),n===P&&(jQuery("#"+F+"-"+i).removeClass("compare-input-while-dragging"),jQuery("#"+B+"-"+i).hide(),jQuery("#"+ie+"-"+i).removeClass("compare-input-while-dragging"),P="")}function Ce(e,t){var i=e["PLMEntity.V_Name"];return null!=i&&""!==i||(i=e.Title),null!=i&&""!==i||(i=e.displayName),null!=i&&""!==i||(i=e.name),1==t&&(i+=" "+e.revision),i}var be=function(e,t){this.proxyType=e.proxyType||"passport",this.rootServiceURL=e.rootServiceURL||"",this.tenant="undefined"!=typeof widget&&widget?widget.getValue("x3dPlatformId"):null,null!=this.tenant&&""!=this.tenant||(this.tenant="OnPremise"),this.securityContext="uninitialized",this.runOptions={},this.loadFromCompassOK=!0,this._CCM=t,this.init(e)};function Ie(t,i,n,o){return e.createElement("div",{id:W+"-"+t+"-"+o,class:"enx-welcome-panel-dropZoneGlobal "+t,html:[{tag:"div",class:"enx-welcome-panel-dropZone "+t,html:[{tag:"div",class:"enx-welcome-panel-dropIconAndText "+t,html:[{tag:"i",styles:{"margin-left":"inherit"},class:"enx-welcome-panel_img wux-ui-3ds wux-ui-3ds-4x wux-ui-3ds-"+i,html:[]},{tag:"h5",class:"enx-welcome-panel_txt "+t,html:n}]}]}]})}function De(e,t){var i=!0;return null!=e&&void 0!==e.serviceId&&null!==e.serviceId&&""!==e.serviceId&&"3dspace"!==e.serviceId.toLowerCase()&&(i=!1),!0===t&&(i=!1),i}function Oe(e,t){var i=document.createElement("div");i.title=w.get("FilterBadgeTip"),"filter"===t.type&&void 0!==t.title&&null!==t.title&&""!==t.title&&(i.title=w.get("FilterBadgeTip")+" ("+t.title+")"),i.className="wux-button-icon-fi wux-ui-genereatedicon-fi wux-ui-genereatedicon-badge-bottom-right wux-ui-3ds","filter"===t.type&&(i.className+=" wux-ui-3ds-filter"),i.style="font-size: 2em; color: #aaa",e.elements.picture.appendChild(i)}function Se(e,t){var i=null;return null!=t&&void 0!==t.input&&null!==t.input&&t.input.length>0&&("left"===e?t.input.length>0&&void 0!==t.input[0].RevisionsDialogTitle&&null!==t.input[0].RevisionsDialogTitle&&""!==t.input[0].RevisionsDialogTitle&&(i=t.input[0].RevisionsDialogTitle):t.input.length>1&&void 0!==t.input[1].RevisionsDialogTitle&&null!==t.input[1].RevisionsDialogTitle&&""!==t.input[1].RevisionsDialogTitle&&(i=t.input[1].RevisionsDialogTitle)),i}return be.prototype.init=function(){P="",this.idDataList=null,this.validateObj_stateData={},this.tile=[],this.tile.left=null,this.tile.right=null},be.prototype.doInput=function(e,t,i,n){this.launchCompareCustomizationCB=n,this.doCompareCB=i,this.init(),this.buildSkeleton(e),this.setupDragAndDropHandling(),this.initializeData(t)},be.prototype.buildSkeleton=function(t){this.displayOrientation=this.computeOrientation(t);var i="side-by-side"===this.displayOrientation?"row":"column",n=y.fetchContentFromCompass();null!=n&&void 0!==n.runOptions&&null!==n.runOptions&&void 0!==n.runOptions.cmdOptions&&null!==n.runOptions.cmdOptions&&(this.runOptions=n.runOptions.cmdOptions),this.inputRoot=e.createElement("div",{id:"compare-input-root",html:[]}),this.inputRoot.inject(t),this.inputRoot.hide(),this.buildSkeleton_Header(this.inputRoot),this.buildSkeleton_Body(this.inputRoot,i),this.buildSkeleton_Footer(this.inputRoot),window.addEventListener("resize",this.updateDisplayOrientation.bind(this))},be.prototype.buildSkeleton_Header=function(t){var i=this,n=e.createElement("div",{id:"compare-input-header",html:[]}).inject(t),o=[];if(!0===widget.CV2EnableCustomProfile&&this.launchCompareCustomizationCB instanceof Function&&!1!==this.runOptions.SupportsCompareCustomization&&(o.push({id:"compareInputCustomizationProfile",dataElements:{domId:"compare-input-customization-profile",typeRepresentation:"customEnumMember",label:j.get("ComparisonProfileLabel"),displayLabel:"true",value:"",possibleValues:[""],position:"far",category:"1",visibleFlag:!1},onNodeUpdate:function(e){e.getAttributeValue("data")},hasTooltip:!0,tooltipInfos:y.generateTooltip("CompareWidget2/Tooltips","mainToolbarCustomizationProfile")}),o.push({id:"compareInputEditCustomization",dataElements:{domId:"compare-input-settings",typeRepresentation:"functionIcon",value:function(){i.launchCompareCustomizationCB(i.tenant,i.securityContext)},position:"far",icon:{iconName:"cog",fontIconFamily:1},category:1},hasTooltip:!0,tooltipInfos:y.generateTooltip("CompareWidget2/Tooltips","mainToolbarEditCustomization")})),o.length>0){let e=u.prototype.createTreeDocument({entries:o});this.mainToolbar=new u({items:e}).inject(n)}},be.prototype.buildSkeleton_Body=function(t,i){var n=this,o=e.createElement("div",{id:"compare-input-body"}).inject(t),r=e.createElement("div",{id:"compare-input-drop"}).inject(o),a=e.createElement("div",{id:"compare-input-drop-targets",styles:{height:"100%","flex-direction":i}}).inject(r);this.buildSkeleton_Body_Input("left",a),this.buildSkeleton_MidCmds(a),this.buildSkeleton_Body_Input("right",a);jQuery("#"+se).click(function(){n.searchButtonPressed("left")}),jQuery("#"+fe).click(function(){n.revisionsOfButtonPressed("left")}),jQuery("#"+ce).click(function(){n.filtersOfButtonPressed("left")}),jQuery("#"+le).click(function(){n.searchButtonPressed("right")}),jQuery("#"+he).click(function(){n.revisionsOfButtonPressed("right")}),jQuery("#"+pe).click(function(){n.filtersOfButtonPressed("right")}),jQuery("#compare-input-swap-button").click(function(){n.swapColumns()})},be.prototype._objSupportsRevisions=function(e){var t=!0;if(null!==e){var i=this.validateObj_stateData[e];null==i||De(i)||(t=!1)}return t},be.prototype._supportsRevisions=function(e,t){var i=this._objSupportsRevisions(e),n=!0;return void 0!==this.runOptions.input&&null!==this.runOptions.input&&this.runOptions.input.length>0&&("left"===t||0===t?this.runOptions.input.length>0&&!0===this.runOptions.input[0].NoRevisionOf&&(n=!1):this.runOptions.input.length>1&&!0===this.runOptions.input[1].NoRevisionOf&&(n=!1)),i&&n},be.prototype._objSupportsFilters=function(e,t){var i=!0;if(null!==e){var n=this.validateObj_stateData[e];null!=n&&(i=!!n.isFilterSupported)}return i},be.prototype._supportsFilters=function(e,t){var i=this._objSupportsFilters(e),n=!0;return void 0!==this.runOptions.input&&null!==this.runOptions.input&&this.runOptions.input.length>0&&("left"===t||0===t?this.runOptions.input.length>0&&!0===this.runOptions.input[0].NoFilterOf&&(n=!1):this.runOptions.input.length>1&&!0===this.runOptions.input[1].NoFilterOf&&(n=!1)),i&&n},be.prototype._supportsOpenContent=function(e){var t=!0;return void 0!==this.runOptions.input&&null!==this.runOptions.input&&this.runOptions.input.length>0&&("left"===e||0===e?this.runOptions.input.length>0&&!0===this.runOptions.input[0].NoOpenContent&&(t=!1):this.runOptions.input.length>1&&!0===this.runOptions.input[1].NoOpenContent&&(t=!1)),t},be.prototype._supportsRemoveItem=function(e){var t=!0;return void 0!==this.runOptions.input&&null!==this.runOptions.input&&this.runOptions.input.length>0&&("left"===e||0===e?this.runOptions.input.length>0&&!0===this.runOptions.input[0].NoRemove&&(t=!1):this.runOptions.input.length>1&&!0===this.runOptions.input[1].NoRemove&&(t=!1)),t},be.prototype._supportsDropZones=function(e){var t=!0;return void 0!==this.runOptions.input&&null!==this.runOptions.input&&this.runOptions.input.length>0&&("left"===e||0===e?this.runOptions.input.length>0&&!0===this.runOptions.input[0].NoDropZones&&(t=!1):this.runOptions.input.length>1&&!0===this.runOptions.input[1].NoDropZones&&(t=!1)),t},be.prototype._setSupportsDropZones=function(e,t){void 0!==this.runOptions.input&&null!==this.runOptions.input&&this.runOptions.input.length>0&&("left"===e||0===e?this.runOptions.input.length>0&&(this.runOptions.input[0].NoDropZones=!t):this.runOptions.input.length>1&&(this.runOptions.input[1].NoDropZones=!t))},be.prototype.buildSkeleton_Body_Input=function(t,n){var o=e.createElement("div",{id:"compare-input-container-"+t,styles:"left"!==t?{display:"none"}:{}}).inject(n),r=e.createElement("div",{id:"compare-input-drop-target-"+t,class:"compare-input-drop-target",styles:"left"===t?{"min-width":"100px","overflow-x":"overlay",border:"none"}:{"overflow-y":"overlay","overflow-x":"overlay"}}).inject(o);(function(t,i,n){var o=null;if(null!=n&&(o=e.createElement("div").inject(i),void 0!==n.input&&null!==n.input&&n.input.length>0)){var r="";"left"===t?n.input.length>0&&void 0!==n.input[0].Label&&null!==n.input[0].Label&&""!==n.input[0].Label&&(r=n.input[0].Label):n.input.length>1&&void 0!==n.input[1].Label&&null!==n.input[1].Label&&""!==n.input[1].Label&&(r=n.input[1].Label),""!==r&&e.createElement("div",{class:V,id:"left"===t?k:M,html:r}).inject(o)}})(t,r,this.runOptions),function(t,n,o){var r=new i({id:ae+"-"+t,icon:"open",value:w.get("left"===t?"addObjectsDZ":"searchButtonLabel"),className:"primary"});r.getContent().title=w.get("searchButtonTip"),null!=o&&!0===o.noOpenContent&&(r.getContent().style.display="none");var a=new i({id:de+"-"+t,icon:"flow-branch-list",value:w.get("revisionOfButtonLabel")});a.getContent().title=w.get("revisionOfButtonTip"),null!=o&&!0===o.noRevisionOf&&(a.getContent().style.display="none");var s=new i({id:ue+"-"+t,icon:"filter-open",value:w.get("filterOfButtonLabel")});s.getContent().title=w.get("filterOfButtonTip"),null!=o&&!0===o.noFilterOf&&(s.getContent().style.display="none");var l=e.createElement("div",{id:"drop-target-iconlabel-"+t,class:"compare-input-drop-icon-label"}),u=[];u.push({type:"drop",text:w.get("dropHere"),DOMelement:l}),u.push({type:"dom",DOMelement:a.getContent()}),u.push({type:"dom",DOMelement:s.getContent()}),u.push({type:"dom",DOMelement:r.getContent()});var c=new p({sentences:u}),d=e.createElement("div",{id:F+"-"+t,class:F,html:c._containerEmptyContent.outerHTML}).inject(n);d.childNodes[0].childNodes[0].style.width="100%";var f=d.childNodes[0].childNodes[0].childNodes[0].childNodes;let h=null==o||!0!==o.noDropZones;f[0].style.display=h?"":"none";for(var m=1;m<f.length-1;++m)f[m].childNodes[0].childNodes[1].style.display="none"}(t,r,{noDropZones:!this._supportsDropZones(t),noFilterOf:"left"===t||!this._supportsFilters(null,t),noRevisionOf:"left"===t||!this._supportsRevisions(null,t),noOpenContent:!this._supportsOpenContent(t)}),function(t,i,n){var o=Ie(Q,"drag-drop",w.get("addObjectsDZ"),t),r=Ie(z,"flow-branch-list",w.get("revisionOfObjectDZ"),t),a=Ie(X,"filter",w.get("filterOfObjectDZ"),t),s=[];null!=n&&!0===n.noRevisionOf||s.push(r),s.push(o),null!=n&&!0===n.noFilterOf||s.push(a),e.createElement("div",{id:B+"-"+t,class:"compare-input-dropzone",styles:{display:"none"},html:[{tag:"div",id:U+"-"+t,class:"enx-welcome-panel enx-welcome-panel-root",html:[{tag:"div",id:G+"-"+t,class:"enx-welcome-panel-dropArea",html:s}]}]}).inject(i)}(t,r,{noDropZones:!this._supportsDropZones(t),noFilterOf:!this._supportsFilters(null,t),noRevisionOf:!this._supportsRevisions(null,t),noOpenContent:!this._supportsOpenContent(t)}),function(t,i,n){e.createElement("div",{id:ie+"-"+t,class:re,styles:{display:"none"},html:[]}).inject(i)}(t,r,this.runOptions);return o},be.prototype.buildSkeleton_MidCmds=function(t){var n=e.createElement("div",{id:"compare-input-middle-cmds",styles:{display:"none"}}).inject(t),o=e.createElement("div",{class:"compare-input-swap-vertcenter"}).inject(n);return this.swapButton=new i({id:"compare-input-swap-button",icon:"exchange"}).inject(o),this.swapButton.getContent().title=w.get("swapColumnsTip"),this.swapButton.getContent().children[0].setStyle("margin","-4px 0px 0px 5px"),n},be.prototype.buildSkeleton_Footer=function(t){var o=this;if(this.inputFooter=e.createElement("div",{id:"compare-input-footer",html:[]}).inject(t),void 0!==this.runOptions.settings&&null!==this.runOptions.settings&&this.runOptions.settings.length>0){let t=e.createElement("div",{class:"compare-input-drop-settings"}).inject(this.inputFooter);var r=null,l=0;for(var u of this.runOptions.settings)if(void 0!==u.Label&&null!==u.Label&&""!==u.Label){u.Id="compare-setting-"+l,++l;var c=new a({type:"checkbox",id:u.Id,label:u.Label,checkFlag:!0===u.Value});if(void 0!==u.Value&&null!==u.Value&&!1!==u.Value&&!0!==u.Value&&""!==u.Value){var p=u.Value;u.Id;require(["DS/CompareWidget2/userSettings/UserSettingsManager"],e=>{var t=0;let i=setInterval(()=>{++t,e.hasPref(p)&&(clearInterval(i),u.Value=e.get(p),!0!==u.Value&&!1!==u.Value||(c.checkFlag=u.Value,c.addEventListener("change",function(t){var i=t.dsModel;e.set(p,i.checkFlag)}))),t>20&&clearInterval(i)},500)})}null===r&&(r=new s({type:"checkbox"})),r.addChild(c)}null!==r&&r.inject(t)}var d=w.get("CompareStructures");void 0!==this.runOptions.CompareCmdLabel&&null!==this.runOptions.CompareCmdLabel&&""!==this.runOptions.CompareCmdLabel&&(d=this.runOptions.CompareCmdLabel);let f=[];this.compareBtn=new i({value:d,className:"primary",id:"compare-input-button-compare",events:{onClick:function(e,t){console.log("CompareInput Compare button was clicked"),o.doCompare()}}}),f.push(this.compareBtn),this.removeAllBtn=new i({value:w.get("RemoveAll"),id:"compare-input-button-cancel",events:{onClick:function(e,t){console.log("CompareInput Remove All button was clicked"),o.clearItem("all")}}}),f.push(this.removeAllBtn);var h=new n({buttons:f}).inject(this.inputFooter);this.compareBtn.getContent().title=w.get("CompareButtonTip"),this.removeAllBtn.getContent().title=w.get("CancelButtonTip"),this.inputFooter.hide(),h.elements.container.addClassName("compare-input-buttongroup"),this.compareBtn.elements.container.setStyles({"margin-right":"10px","border-radius":"4px"}),this.removeAllBtn.elements.container.setStyles({"border-radius":"4px"})},be.prototype.setupDragAndDropHandling=function(){this._supportsDropZones("left")&&(g.attachObject("compare-input-drop-target-left",this,this.dragEnterPanelLeft,this.dragLeavePanelLeft,this.dropHandler),g.attachObject(q,this,this.dragEnterAddObjectsLeft,this.dragLeaveAddObjectsLeft,this.dropHandler),g.attachObject(Z,this,this.dragEnterAddObjRevLeft,this.dragLeaveAddObjRevLeft,this.dropHandler),g.attachObject(ee,this,this.dragEnterAddObjFilterLeft,this.dragLeaveAddObjFilterLeft,this.dropHandler)),this._supportsDropZones("right")&&(g.attachObject("compare-input-drop-target-right",this,this.dragEnterPanelRight,this.dragLeavePanelRight,this.dropHandler),g.attachObject(J,this,this.dragEnterAddObjectsRight,this.dragLeaveAddObjectsRight,this.dropHandler),g.attachObject($,this,this.dragEnterAddObjRevRight,this.dragLeaveAddObjRevRight,this.dropHandler),g.attachObject(te,this,this.dragEnterAddObjFilterRight,this.dragLeaveAddObjFilterRight,this.dropHandler))},be.prototype.shutdownDragAndDropHandling=function(){g.detachObject("compare-input-drop-target-left"),g.detachObject("compare-input-drop-target-right"),g.detachObject(q),g.detachObject(Z),g.detachObject(ee),g.detachObject(J),g.detachObject($),g.detachObject(te)},be.prototype.dropHandler=function(e,t,i){g.reset();var n=e.currentTarget.id,o="drop-left"===i?"left":"right";O.clearFiltering(o,A),n.startsWith("compare-input-panel-addObjects-")?(console.log("CompareInput handle dropped object "+o),this.validateAndProcessObjDrop(t,o)):n.startsWith("compare-input-panel-addObjRev-")?(console.log("CompareInput handle Revisions of dropped object "+o),this.validateAndProcessRevisionOfDrop(t,o)):n.startsWith("compare-input-panel-addObjFilter-")&&(console.log("CompareInput handle Filters of dropped object "+o),this.validateAndProcessFilterOfDrop(t,o))},be.prototype.dragEnterPanelLeft=function(e){ve(e,"left")},be.prototype.dragEnterPanelRight=function(e){ve(e,"right")},be.prototype.dragEnterAddObjectsLeft=function(e){ge(0,H,"left")},be.prototype.dragEnterAddObjRevLeft=function(e){ge(0,K,"left")},be.prototype.dragEnterAddObjFilterLeft=function(e){ge(0,Y,"left")},be.prototype.dragEnterAddObjectsRight=function(e){ge(0,H,"right")},be.prototype.dragEnterAddObjRevRight=function(e){ge(0,K,"right")},be.prototype.dragEnterAddObjFilterRight=function(e){ge(0,Y,"right")},be.prototype.dragLeavePanelLeft=function(e){},be.prototype.dragLeavePanelRight=function(e){},be.prototype.dragLeaveAddObjectsLeft=function(e){ye(0,H,"left")},be.prototype.dragLeaveAddObjRevLeft=function(e){ye(0,K,"left")},be.prototype.dragLeaveAddObjFilterLeft=function(e){ye(0,Y,"left")},be.prototype.dragLeaveAddObjectsRight=function(e){ye(0,H,"right")},be.prototype.dragLeaveAddObjRevRight=function(e){ye(0,K,"right")},be.prototype.dragLeaveAddObjFilterRight=function(e){ye(0,Y,"right")},be.prototype.initializeData=function(e){var t=this;this.tenant=widget.getValue("x3dPlatformId");var i=null==this.tenant?null:this.tenant,n=null==this.securityContext?null:this.securityContext;d.app_initialization(function(){f.getSecurityContextPromise(i,n).then(function(i){t.securityContext=i,t.initData(e)})})},be.prototype.initData=function(e){var t=this;O.initialize(this,this.securityContext,[{whichOne:"left"},{whichOne:"right"}],this.onApplyNGFilter);var i=null!=e?e.idDataList:null;if(null==i&&null!=(i=y.fetchPersistedIDs())){var n=i.get_nonNullCount();if(n>0){console.log("CompareInput: initializing with "+n+" persisted ids");for(var r=0;r<i.items.length;++r)void 0!==i.items[r]&&null!==i.items[r]&&void 0!==i.items[r].filterSpec&&null!==i.items[r].filterSpec&&O.setFilterSpecificationPromise(0===r?"left":"right",i.items[r].objectId,i.items[r].filterSpec);y.fetchPersistedIDs()}}if(null!=i)if("modelIDList"===i.listType||"IDPlusCommandsList"===i.listType){let e="IDPlusCommandsList"===i.listType?i.get_allIDList():i.get_objIDList(),n=i.get_objServices();t.validateIdsPromise(e,n).then(function(){if(Array.isArray(n)&&n.length){for(var o of i.items)null!=o&&(o.objectServices.envId||(o.objectServices.envId=t.tenant),o.objectServices.contextId||(o.objectServices.contextId=t.securityContext));t.idDataList=i}else{t.idDataList=new C(i.listType);for(let i=0,n=e.length;i<n;i++){let n=e[i],o={serviceId:t.validateObj_stateData[n].serviceId,envId:t.tenant,objectId:n,objectType:t.validateObj_stateData[n].objectType,contextId:t.securityContext};t.idDataList.items.push(new b(n,o))}}t.processValidatedIDs()},function(e){"OBJ_INACCESSIBLE"===e?y.showAlertBox("STORED_OBJ_INACCESSIBLE",w,"error"):y.showAlertBox(e,w,"error"),o.unmask(t.inputRoot.parentElement),t.inputRoot.show()})}else console.log("CompareInput: failure initializing with an unknown type of id list"),this.inputRoot.show();else if(!this.loadFromCompassOK||null!=e&&void 0!==e.noCompassContent&&null!==e.noCompassContent&&!0===e.noCompassContent)t.inputRoot.show();else{var a=y.fetchContentFromCompass();if(null!=a){null!=a.useIndex&&widget.setValue("useIndex",a.useIndex);var s=a.envId;if(null==s&&null!=a.data&&null!=a.data.items&&a.data.items.length>0&&(s=a.data.items[0].envId),null!=s&&0!=s.length&&(t.tenant=s,widget.setValue("x3dPlatformId",t.tenant),me("CompareInput: compass data indicates tenant is now '"+t.tenant+"'")),void 0!==a.data&&null!==a.data)if(console.log("CompareInput: initializing with "+a.data.items.length+" from compass"),a.data.items.length>5)t.inputRoot.show(),y.showAlertBox("selectFiveOrFewer",w,"error");else{void 0!==t.runOptions.ImmediateCompare&&null!==t.runOptions.ImmediateCompare||(t.runOptions.ImmediateCompare=a.data.immediateCompare);var l=a.listType;if(null==l&&(l=y.determineListType(a.data)),"modelIDList"===l||"IDPlusCommandsList"===l){let e=[],i=[];a.data.items.forEach(function(n){if(null!=n){var o=n.contextId,r=null!=o&&o.constructor===String&&0!==o.length?o:t.securityContext;e.push(n.objectId),i.push({serviceId:n.serviceId,envId:n.envId,objectId:n.objectId,objectType:n.objectType,contextId:r,displayName:n.displayName,displayType:n.displayType,idType:n.idType,commands:n.commands,queryDef:n.filterQuery,filterSpec:n.filterSpec})}}),t.validateIdsThenCall(e,i,function(){null==t.idDataList&&(t.idDataList=new C(l));for(var n=0;n<e.length;++n){null==i[n].objectType&&(i[n].objectType=t.validateObj_stateData[e[n]].objectType);var o=new b(e[n],i[n]);void 0!==i[n].filterSpec&&null!==i[n].filterSpec&&(o.filterSpec=i[n].filterSpec),void 0!==i[n].queryDef&&null!==i[n].queryDef&&(o.queryDef=i[n].queryDef),t.idDataList.items.push(o)}for(n=0;n<t.idDataList.items.length;++n)void 0!==t.idDataList.items[n]&&null!==t.idDataList.items[n]&&void 0!==t.idDataList.items[n].filterSpec&&null!==t.idDataList.items[n].filterSpec&&O.setFilterSpecificationPromise(0===n?"left":"right",t.idDataList.items[n].objectId,t.idDataList.items[n].filterSpec);var r=a.biProxyCtx;if(null!=r){var s=a.data.items.map(function(e){return e.objectId});t.processIdsContainingFilters(s,r,!1,"left")}t.processValidatedIDs()})}}else t.inputRoot.show()}else t.inputRoot.show()}},be.prototype.searchButtonPressed=function(e){console.log("CompareInput: "+e+" Search button press handler");var t=this;I.displaySearchPanel(this.tenant,!0,function(i){t.onSelectedFromSearch(e,i)})},be.prototype.revisionsOfButtonPressed=function(e){console.log("CompareInput: Revisions of  "+e+" button press handler");var t=this;if("left"===e||"right"===e){var i=this.idDataList.get_objServices("left"===e?"right":"left");if(null!=i&&i.length>0){var n=t.validateObj_stateData[i[0].objectId],o={objId:n.isFilter?n.filter.rootObj.physicalid:i[0].objectId,objType:n.isFilter?n.filter.rootObj.internalType:i[0].objectType,tenant:this.tenant,securityContext:this.securityContext},r=null;t.runOptions.DisableRootInRevisionsDialog&&(r=o.objId);var a=Se(e,t.runOptions);D.displayHistoryGraph(o,r,{allowDuplicates:t.runOptions.AllowDuplicatesInRevisionsDialog,disableRoot:t.runOptions.DisableRootInRevisionsDialog,controlOKButton:t.runOptions.ControlOKButtonInRevisionsDialog,OKButtonLabel:t.runOptions.RevisionsDialogOKButtonLabel,dlgTitle:a},function(n){var o=[],r=n.physicalid;o.push(r);var a=[],s=void 0;null!=i&&i.length>0&&void 0!==i[0]&&null!==i[0]&&(s={envId:i[0].envId,objectId:r,objectType:n.type,serviceId:i[0].serviceId,contextId:i[0].contextId,displayName:n.displayName}),a.push(s),t.validateIdsThenCall(o,a,function(){var i=new b(o[0],a[0]);"left"===e?t.idDataList.items[0]=i:t.idDataList.items.length>1?t.idDataList.items[1]=i:t.idDataList.items.push(i),"left"!==e&&"right"!==e||O.clearFiltering(e,A),t.processValidatedIDs()})})}else console.log("CompareInput: revisionsOfButtonPressed failure")}else console.log("CompareInput: revisionsOfButtonPressed failure")},be.prototype.filtersOfButtonPressed=function(e){console.log("CompareInput: Filters of  "+e+" button press handler");if("left"===e||"right"===e){var t=this.idDataList.get_objServices("left"===e?"right":"left");if(null!=t&&t.length>0){var i=this.validateObj_stateData[t[0].objectId],n={objId:i.isFilter?i.filter.rootObj.physicalid:t[0].objectId,objType:i.isFilter?i.filter.rootObj.internalType:t[0].objectType,tenant:this.tenant,securityContext:this.securityContext,displayName:Ce(i.isFilter?i.filter.rootObj:i,!0)};this.displayFilterPanel(e,n)}else console.log("CompareInput: filtersOfButtonPressed failure")}else console.log("CompareInput: filtersOfButtonPressed failure")},be.prototype.replaceWithRevisionOf=function(e){console.log("CompareInput Revision context menu handler reached");var t=this;if("left"===e||"right"===e){var i=this.idDataList.get_objServices(e);if(null!=i&&i.length>0){var n=t.validateObj_stateData[i[0].objectId],o={objId:n.isFilter?n.filter.rootObj.physicalid:i[0].objectId,objType:n.isFilter?n.filter.rootObj.internalType:i[0].objectType,tenant:this.tenant,securityContext:this.securityContext},r=null;t.runOptions.DisableRootInRevisionsDialog&&(r=o.objId);var a=Se(e,t.runOptions);D.displayHistoryGraph(o,r,{allowDuplicates:t.runOptions.AllowDuplicatesInRevisionsDialog,disableRoot:t.runOptions.DisableRootInRevisionsDialog,controlOKButton:t.runOptions.ControlOKButtonInRevisionsDialog,OKButtonLabel:t.runOptions.RevisionsDialogOKButtonLabel,dlgTitle:a},function(n){var o=[],r=n.physicalid;o.push(r);var a=[],s={envId:i[0].envId,objectId:r,objectType:i[0].objectType,serviceId:i[0].serviceId,contextId:i[0].contextId,displayName:n.displayName};a.push(s),t.validateIdsThenCall(o,a,function(){var i=new b(o[0],a[0]);t.idDataList.items["left"===e?0:1]=i,"left"!==e&&"right"!==e||O.clearFiltering(e,A),t.processValidatedIDs()})})}else console.log("CompareInput: replaceWithRevisionOf failure")}else console.log("CompareInput: replaceWithRevisionOf failure")},be.prototype.replaceWithFilterOf=function(e){console.log("CompareInput Filter context menu handler reached");if("left"===e||"right"===e){var t=this.idDataList.get_objServices(e);if(null!=t&&t.length>0){var i=this.validateObj_stateData[t[0].objectId],n={objId:i.isFilter?i.filter.rootObj.physicalid:t[0].objectId,objType:i.isFilter?i.filter.rootObj.internalType:t[0].objectType,tenant:this.tenant,securityContext:this.securityContext,displayName:Ce(i.isFilter?i.filter.rootObj:i,!0)};this.displayFilterPanel(e,n)}else console.log("CompareInput: replaceWithFilterOf failure")}else console.log("CompareInput: replaceWithFilterOf failure")},be.prototype.replaceWithSearch=function(e){console.log("CompareInput: "+e+" Open context menu handler reached");var t=this;I.displaySearchPanel(this.tenant,!0,function(i){t.onSelectedFromSearch(e,i)})},be.prototype.swapColumns=function(){if(console.log("CompareInput Swap Columns context menu handler reached"),A.left=null,A.right=null,void 0!==this.idDataList&&null!==this.idDataList){var e=this.idDataList.items[0];this.idDataList.items[0]=this.idDataList.items.length>1?this.idDataList.items[1]:null,this.idDataList.items[1]=e;var t={idDataList:this.idDataList};this.initData(t)}},be.prototype.validateAndProcessObjDrop=function(e,t){this.validateAndProcessDrop(e,t)},be.prototype.validateAndProcessDrop=function(e,t,i){var n=this,o=e.objArray;v.reset(),widget.addEventOnce("ENOLCM/CompareWidget/entireCompareDone",function(){v.dump()});var r=o.map(function(e){return e.objectId}),a=r.length,s=null!=i&&i.forRevisionOf,l=null!=i&&i.forFilterOf;if(s){if(1!==a)return void y.showAlertBox("onlyOneObjForRevOf",w,"warning")}else if(l){if(1!==a)return void y.showAlertBox("onlyOneObjForFilterOf",w,"warning")}else{if(a>5)return y.showAlertBox("selectFiveOrFewer",w,"error"),void widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_immediateDone","CompareInput immediate state ready");if(a<1)return void console.warn("WARNING: unexpected drop count... no processing to be done")}var u=o[0].envId;null!=u&&0!=u.length||(u=null);var c=widget.getValue("x3dPlatformId");if(null!=u){if(!this.checkAdjustTenant(a,t,c,u))return}else me("Dropped ID has no tenant info / value not changed, value remains "+c);var p=o.map(function(e){var t={};for(var i in e)t[i]=e[i];return t});this.validateIdsThenCall(r,p,function(){s?n.processValidatedId_RevisionOf(r,p,t):n.processValidatedIds_Drop(r,p,t,e.filterProxy,i,function(e){l&&-1!==t.indexOf(e)&&(n._supportsFilters(r[0],e)?n.processValidatedId_FilterOf(r,p,e):y.showAlertBox("filtersNotSupported",w,"warning"))})});var d={UXName:"Compare",models:p};this.trackerEvent=S.createInitActionEvent(d,this.trackerEvent),S.checkAndTrackPageEvent(this.trackerEvent)},be.prototype.processValidatedIds_Drop=function(e,t,i,n,o,r){if(null==this.idDataList&&(this.idDataList=new C("modelIDList")),e.length>1&&2===this.idDataList.items.length&&null===this.idDataList.items[0]&&null!==this.idDataList.items[1])console.log("CompareInput: Only 1 dropped object expected on left when right object is already specified.");else{for(var a=0;a<e.length;++a){var s=new b(e[a],t[a]);if(1===e.length)"left"===i?this.idDataList.items[0]=s:"right"===i&&(this.idDataList.items[1]=s);else{if(2===this.idDataList.items.length&&null!==this.idDataList.items[0]&&null===this.idDataList.items[1]){this.idDataList.items.pop()}this.idDataList.items.push(s)}}if(null!=n){var l=null!=o&&o.forFilterOf;this.processIdsContainingFilters(e,n,l,i)}}this.processValidatedIDs(r)},be.prototype.processIdsContainingFilters=function(e,t,i,n){var o=this;let r=e.length;1===r?o.processIdContainingFilters(e[0],O.getFilterProxy(n),t,i,n):2===r&&"left"===n&&o.processIdContainingFilters(e[0],O.getFilterProxy("left"),t,i,"left").then(()=>{o.processIdContainingFilters(e[1],O.getFilterProxy("right"),t,i,"right")}).catch(e=>{console.log("CompareInput processIdContainingFilters failure")})},be.prototype.processIdContainingFilters=function(e,t,i,n,o){var r=this;return new Promise(function(a,s){if(null==t)console.log("CompareInput processIdContainingFilters: filter proxy not initialized"),s();else{t.activate();var l=[e];console.log("CompareInput processIdContainingFilters: "+o+": before areRootsSharable()?"),t.areRootsSharable(l,i).then(function(e){console.log("CompareInput processIdContainingFilters: "+o+": after areRootsSharable()?"),null!=e?(console.log("CompareInput processIdContainingFilters: "+o+": "+e.length+" rootsSharable"),e.forEach(function(e){!0===e.hasFilter?(console.log("CompareInput processIdContainingFilters: "+o+": rootsSharable and hasFilter, calling shareFilterSpec: "+e.rootId),t.shareFilterSpec({fromRootId:e.rootId,fromSourceCtx:i,fromDropOnFilter:n,callback:function(e){console.log("CompareInput processIdContainingFilters: "+o+": reached shareFilterSpec callback"),r.shareFilterSpecCB(e,o),a()}})):a()})):a()})}})},be.prototype.shareFilterSpecCB=function(e,t){var i=e.success;if(null!=i&&i.length>0)if(void 0!==i[0].filter&&null!==i[0].filter){console.log("CompareInput processIdContainingFilters: "+t+": shareFilter success, applied filter definition retrieved OK");var n=this.tile[t];let e="left"===t?0:1;i[0].rootId===this.idDataList.items[e].objectId&&null==this.idDataList.items[e].filterData?(this.idDataList.items[e].filterData=i[0].filter,console.log("CompareInput processIdContainingFilters: "+t+": SUCCESS applying applied filter")):console.log("CompareInput processIdContainingFilters: "+t+": error applying applied filter"),y.persistIDs(this.idDataList),null!=n&&Oe(n,{type:"filter",title:i[0].filter.filterTitle})}else void 0!==i[0].filterId&&null!==i[0].filterId&&i[0].filterId.length>0&&void 0!==i[0].filterId[0]&&null!==i[0].filterId[0]&&""!==i[0].filterId[0]?(console.log("CompareInput processIdContainingFilters: "+t+": filter definition FAIL, using filterId to retrieve definition instead"),("left"===t&&i[0].rootId===this.idDataList.items[0].objectId||"right"===t&&i[0].rootId===this.idDataList.items[1].objectId)&&(this.replaceIdWithFilterId(t,i[0].filterId[0]),console.log("CompareInput processIdContainingFilters: "+t+": shareFilter success, filter definition FAIL, filterId SUCCESS"))):console.log("CompareInput processIdContainingFilters: "+t+": shareFilter success, filter definition FAIL, filterId FAIL");else console.log("CompareInput processIdContainingFilters: "+t+": shareFilter NO success")},be.prototype.replaceIdWithFilterId=function(e,t){var i=this,n=[t],o=[{envId:null,objectId:t,objectType:"ENOStrRefinementSpecification",serviceId:null}];i.validateIdsThenCall(n,o,function(){var t=new b(n[0],o[0]);"left"===e?i.idDataList.items[0]=t:i.idDataList.items.length>1?i.idDataList.items[1]=t:i.idDataList.items.push(t),"left"!==e&&"right"!==e||O.clearFiltering(e,A),i.processValidatedIDs()})},be.prototype.validateIdsThenCall=function(e,t,i){this.validateIdsPromise(e,t).then(function(){i()},function(e){i()})},be.prototype.validateIdsPromise=function(e,i){var n=this;return new Promise(function(r,a){if(e.length>0)if(null!=i&&i.length>0&&void 0!==i[0]&&null!==i[0]&&!De(i[0])){void 0===m.typeInfo||null===m.typeInfo||void 0===m.typeInfo[i[0].objectType]||null===m.typeInfo[i[0].objectType]?(o.mask(n.inputRoot.parentElement),c.getPlatformServices({onComplete:function(e){for(var o=-1,a=0;a<e.length&&-1===o;++a)e[a].platformId===i[0].envId&&(o=a);if(o>-1){var s=e[o][i[0].serviceId]+"/"+i[0].serviceId,l=s+"/compareMetaData/"+i[0].objectType;m.typeInfo[i[0].objectType]={serviceId:i[0].serviceId,url:s,b3DViewerSupported:!1};try{t.authenticatedRequest(l,{proxy:n.proxyType,method:"GET",onComplete:function(e){try{var t=JSON.parse(e);m.typeInfo[i[0].objectType].structure=t.structure,m.typeInfo[i[0].objectType].attributes=t.attributes,void 0!==m.typeInfo[i[0].serviceId]&&null!==m.typeInfo[i[0].serviceId]||(m.typeInfo[i[0].serviceId]={serviceId:i[0].serviceId,url:s,b3DViewerSupported:!1},m.typeInfo[i[0].serviceId].structure=t.structure,m.typeInfo[i[0].serviceId].attributes=t.attributes),i.forEach(function(e){let t={physicalid:e.objectId,objectId:e.objectId,objectType:e.objectType,serviceId:e.serviceId,attributesUrl:{url:m.typeInfo[e.objectType].url,attributes:m.typeInfo[e.objectType].attributes}};n.updateValidatedObj_StateData(t)}),r()}catch(e){console.log("COMPARE compareMetaData invalid syntax"),r()}},onFailure:function(e){console.log("COMPARE CONTENT: failed getting compare metadata")}})}catch(e){console.log("COMPARE failure calling compareMetaData service '"+l+"'")}}else console.log("COMPARE failure identifying compareMetaData service URL for "+i[0].envId+" "+i[0].serviceId)},onFailure:function(){console.log("COMPARE failure retrieving compareMetaData service URL for "+i[0].envId+" "+i[0].serviceId)}})):(i.forEach(function(e){let t={physicalid:e.objectId,objectId:e.objectId,objectType:e.objectType,serviceId:e.serviceId,attributesUrl:{url:m.typeInfo[e.objectType].url,attributes:m.typeInfo[e.objectType].attributes}};n.updateValidatedObj_StateData(t)}),r())}else{var s=e.join(",");if(s.includes("cid:"))for(var l of i){let e=w.get("OBJ_TYPE_UNSUPPORTED").replace("{msgData}",l.displayName);y.showAlertBox(e,null,"warning")}else{o.mask(n.inputRoot.parentElement);var u=d.get3DSpaceWSUrl(n.tenant,"/resources/compare/getObjState","objectIds="+s);let e={};i[0].contextId&&(e.securityContext=i[0].contextId);try{t.authenticatedRequest(u,{proxy:n.proxyType,method:"GET",headers:e,onComplete:function(e){var t=JSON.parse(e).results;null==t||"number"!=typeof t.length?y.showAlertBox("BAD_OBJDATA",w,"error"):y.accessRightsPromise(t,n.tenant,n.securityContext,function(e){var i=!1;for(var o of t)!1===o.exists&&(i=!0),e||(o.notAccessible=!0,i=!0);if(!i)for(o of t)o.requiresIndex&&y.forceRequireIndex(!1),o.serviceId="3DSpace",n.updateValidatedObj_StateData(o);for(o of t){if(!1===o.exists){y.showAlertBox("OBJ_NOT_FOUND",w,"error"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_leftSideDone","CompareInput left side done"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_rightSideDone","CompareInput right side done");break}if(!0===o.notAccessible){y.showAlertBox("OBJ_INACCESSIBLE",w,"error"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_leftSideDone","CompareInput left side done"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_rightSideDone","CompareInput right side done");break}}i||r()})},onFailure:function(e){console.log("CompareInput getObjState failed"),a("OBJ_INACCESSIBLE")}})}catch(e){console.log("Exception on '"+u+"'")}}}})},be.prototype.checkAdjustTenant=function(e,t,i,n){var o=!0;return i===n?me("Tenant info for dropped ID same as current tenant / no change ("+i+", "+n+")"):1===e&&(null!=this.idDataList&&null!=this.idDataList.getLeftID()&&"right"===t||null!=this.idDataList&&null!=this.idDataList.getRightID()&&"left"===t)?(y.showAlertBox("tenantMismatch",w,"error"),me("Both objects' tenants must match // "+i+" != "+n+"... rejecting dropped object"),o=!1):(y.showAlertBox("tenantChanged",w,"success"),me("Changing tenant, based upon dropped ID, from '"+i+"' to '"+n+"'"),widget.setValue("x3dPlatformId",n),this.tenant=n),o},be.prototype.updateValidatedObj_StateData=function(e){var t=e.physID||e.physicalid;if(e.physicalid=t,null==this.validateObj_stateData[t])this.validateObj_stateData[t]=e;else for(var i in e)this.validateObj_stateData[t][i]=e[i]},be.prototype.processValidatedIDs=function(e){var t=this,i=0;if(null!=t.idDataList&&(i=t.idDataList.get_nonNullCount()),0!==i)if(y.persistIDs(this.idDataList),this.loadFromCompassOK=!1,o.unmask(this.inputRoot.parentElement),this.idDataList.areCompared||i>2||2===i&&this.runOptions.ImmediateCompare||"IDPlusCommandsList"===this.idDataList.listType)console.log("CompareInput Starting an immediate comparison"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_immediateDone","CompareInput immediate state ready"),this.doCompare();else{var n=d.get3DSpaceBaseUrl(this.tenant),r=null==this.tenant?null:this.tenant,a=null==this.securityContext?null:this.securityContext;d.app_initialization(function(){f.getSecurityContextPromise(r,a).then(function(i){t.inputRoot.show();var a=t.inputRoot.getElement("#"+ne),s=t.inputRoot.getElement("#"+R),l=t.idDataList.getLeftID();if(null!=l){var u=t.validateObj_stateData[l];let c=t.idDataList.get_objServices("left");null!=c&&c.length>0&&void 0!==c[0]&&null!==c[0]&&(void 0!==c[0].preview_url&&null!==c[0].preview_url&&""!==c[0].preview_url&&(u.preview_url=c[0].preview_url),void 0!==c[0].type_icon_url&&null!==c[0].type_icon_url&&""!==c[0].type_icon_url&&(u.type_icon_url=c[0].type_icon_url),void 0!==c[0].displayName&&null!==c[0].displayName&&""!==c[0].displayName&&(u.displayName=c[0].displayName),void 0!==c[0].displayType&&null!==c[0].displayType&&""!==c[0].displayType&&(u.displayType=c[0].displayType)),s.hide(),a.show();let p=t.inputRoot.getElement("div#"+a.parentElement.id);o.mask(p),y.augDroppedObject(u,{tenant:r,securityContext:i,url3DSpace:n},function(i){let r="",s=void 0!==t.idDataList.items[0].filterData&&null!==t.idDataList.items[0].filterData;s&&(r=t.idDataList.items[0].filterData.filterTitle);let l=void 0!==u.filter&&null!==u.filter,c=null;l&&(c=u.filter.rootObj,r=u.filter.filterTitle);let d=void 0!==t.idDataList.items[0].filterSpec&&null!==t.idDataList.items[0].filterSpec,f=void 0!==t.idDataList.items[0].queryDef&&null!==t.idDataList.items[0].queryDef;t.createOrigTile(a,l&&null!==c?c:u,n,"passport",{applyBadgeToImage:s||l||d||f?{type:"filter",title:r}:null}),t.updateUIforIdList(!0),o.unmask(p),null!=e&&"function"==typeof e&&e("left"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_leftSideDone","CompareInput left side done")},function(e){console.log("augDroppedObject error: "+e)})}else s.show(),a.hide();var c=t.inputRoot.getElement("#"+oe),p=t.inputRoot.getElement("#"+N),d=l;if(null!=(l=t.idDataList.getRightID())){var f=t.validateObj_stateData[l];let a=t.idDataList.get_objServices("right");null!=a&&a.length>0&&void 0!==a[0]&&null!==a[0]&&(void 0!==a[0].preview_url&&null!==a[0].preview_url&&""!==a[0].preview_url&&(f.preview_url=a[0].preview_url),void 0!==a[0].type_icon_url&&null!==a[0].type_icon_url&&""!==a[0].type_icon_url&&(f.type_icon_url=a[0].type_icon_url),void 0!==a[0].displayName&&null!==a[0].displayName&&""!==a[0].displayName&&(f.displayName=a[0].displayName),void 0!==a[0].displayType&&null!==a[0].displayType&&""!==a[0].displayType&&(f.displayType=a[0].displayType)),p.hide(),c.show();let s=t.inputRoot.getElement("#"+c.parentElement.id);o.mask(s),y.augDroppedObject(f,{tenant:r,securityContext:i,url3DSpace:n},function(i){let r="",a=void 0!==t.idDataList.items[1].filterData&&null!==t.idDataList.items[1].filterData;a&&(r=t.idDataList.items[1].filterData.filterTitle);let l=void 0!==f.filter&&null!==f.filter,u=null;l&&(u=f.filter.rootObj,r=f.filter.filterTitle);let p=void 0!==t.idDataList.items[1].filterSpec&&null!==t.idDataList.items[1].filterSpec,d=void 0!==t.idDataList.items[1].queryDef&&null!==t.idDataList.items[1].queryDef;t.createOrigTile(c,l&&null!==u?u:f,n,"passport",{applyBadgeToImage:a||l||p||d?{type:"filter",title:r}:null}),t.updateUIforIdList(!0),o.unmask(s),null!=e&&"function"==typeof e&&e("right"),widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_rightSideDone","CompareInput right side done")},function(e){console.log("augDroppedObject error: "+e)})}else p.show(),c.hide(),""!==d&&!0===t.runOptions.ImmediateRevisionOf&&t.revisionsOfButtonPressed("right")})})}else console.error("CompareInput failed sanity check in processValidatedIDs")},be.prototype.validateAndProcessRevisionOfDrop=function(e,t){var i=this;!function(e,t){var i=!1;return void 0!==e.filterProxy&&null!==e.filterProxy?i=!0:null!=e&&void 0!==e.objArray&&null!==e.objArray&&e.objArray.length>0&&"ENOStrRefinementSpecification"===e.objArray[0].objectType&&(i=!0),i}(e)?!function(e,t){var i=!0;return null!=e&&void 0!==e.objArray&&null!==e.objArray&&e.objArray.length>0&&!De(e.objArray[0])&&(i=!1,e.objArray[0].serviceId),i}(e)?y.confirmDialog(w.get("RevisionsNotSupported"),"fonticon-attention",{label:_.ok,callback:function(){i.validateAndProcessDrop(e,t)}},{label:_.ko,callback:function(){}}):this.validateAndProcessDrop(e,t,{forRevisionOf:!0}):y.confirmDialog(w.get("CantDropFilterOnRevisions"),"fonticon-attention",{label:_.ok,callback:function(){i.validateAndProcessDrop(e,t)}},{label:_.ko,callback:function(){}})},be.prototype.processValidatedId_RevisionOf=function(e,t,i){console.log("CompareInput: Revisions of "+i+" dropped item handler");var n=this;if("left"===i||"right"===i){var r={objId:t[0].objectId,objType:t[0].objectType,tenant:this.tenant,securityContext:this.securityContext},a=null;n.runOptions.DisableRootInRevisionsDialog&&(a=r.objId);var s=Se(i,n.runOptions);o.unmask(this.inputRoot.parentElement),D.displayHistoryGraph(r,a,{allowDuplicates:n.runOptions.AllowDuplicatesInRevisionsDialog,disableRoot:n.runOptions.DisableRootInRevisionsDialog,controlOKButton:n.runOptions.ControlOKButtonInRevisionsDialog,OKButtonLabel:n.runOptions.RevisionsDialogOKButtonLabel,dlgTitle:s},function(e){var o=[],r=e.physicalid;o.push(r);var a=[],s={envId:t[0].envId,objectId:r,objectType:t[0].objectType,serviceId:t[0].serviceId,contextId:t[0].contextId,displayName:e.displayName};a.push(s),n.validateIdsThenCall(o,a,function(){null==n.idDataList&&(n.idDataList=new C("modelIDList"));var e=new b(o[0],a[0]);"left"===i?n.idDataList.items[0]=e:n.idDataList.items.length>1?n.idDataList.items[1]=e:n.idDataList.items.push(e),O.clearFiltering(i,A),n.processValidatedIDs()})})}else console.log("CompareInput: RevisionsOf Dropped Item failure")},be.prototype.validateAndProcessFilterOfDrop=function(e,t){this.validateAndProcessDrop(e,t,{forFilterOf:!0})},be.prototype.processValidatedId_FilterOf=function(e,t,i){console.log("CompareInput: Filters of "+i+" item handler");if("left"===i||"right"===i){var n=this.validateObj_stateData[t[0].objectId],o={objId:n.isFilter?n.filter.rootObj.physicalid:t[0].objectId,objType:n.isFilter?n.filter.rootObj.internalType:t[0].objectType,tenant:this.tenant,securityContext:this.securityContext,displayName:Ce(n.isFilter?n.filter.rootObj:n,!0)};this.displayFilterPanel(i,o)}else console.log("CompareInput:FilterOf Dropped Item failure");widget.dispatchEvent("ENOLCM/CompareCommon/CompareInput_FilterDisplayDone","CompareInput filter display done")},be.prototype.onSelectedFromSearch=function(e,t){var i=this;if(null!=t){if("left"===e&&t.length>5||"right"===e&&t.length>4)return void y.showAlertBox("selectFiveOrFewer",w,"error");var n=[],o=[];for(const e of t)if(null!=e){var r=e.id;n.push(r);var a=e.sourceid_value.split(":"),s={contextId:i.securityContext,displayName:e["ds6w:label_value"],displayType:e["ds6w:type"],envId:a.length>1?a[1]:i.tenant,objectId:e.id,objectType:e["ds6w:type_value"],serviceId:a[0],preview_url:e.preview_url_value,type_icon_url:e.type_icon_url_value};o.push(s)}i.validateIdsThenCall(n,o,function(){null==i.idDataList&&(i.idDataList=new C("modelIDList"));let t="left"===e?0:1;for(var r=0;r<n.length;++r,++t)i.idDataList.items[t]=new b(n[r],o[r]);"left"!==e&&"right"!==e||O.clearFiltering(e,A),i.processValidatedIDs()})}},be.prototype.displayFilterPanel=function(e,t){O.setApplyCallback(this,[{whichOne:"left"},{whichOne:"right"}],this.onApplyNGFilter),O.activateProxy(e),O.executeFilterCmd(e,t)},be.prototype.onFetchFilterBIFilteringEvent=function(e){},be.prototype.onApplyNGFilter=function(t){var i=this,n=t||null,o="CompareWidget_right"===(n=e.is(n,"string")?JSON.parse(n):n).appId?"right":"left",r=this.tile[o],a=n.filterRootIds[0],s=this.validateObj_stateData[a],l=this.inputRoot.getElement("#"+ie+"-"+o);if(this.inputRoot.getElement("#"+F+"-"+o).hide(),l.show(),null==r){var u=d.get3DSpaceBaseUrl(this.tenant);this.createOrigTile(l,s,u,"passport",{applyBadgeToImage:{type:"filter",title:n.filterTitle},highlight:!0})}else n.empty?function(e){var t=e.elements.picture.getElementsByClassName("wux-button-icon-fi wux-ui-genereatedicon-fi wux-ui-genereatedicon-badge-bottom-right wux-ui-3ds");for(let i of t)e.elements.picture.removeChild(i)}(r):Oe(r,{type:"filter",title:n.filterTitle}),A[o]=s.physicalid;const c="left"===o?this.idDataList.getLeftID():this.idDataList.getRightID(),p="left"===o?0:1,f="left"===o?1:0;if(a!==c)for(var h in void 0!==this.idDataList.items[p]&&null!==this.idDataList.items[p]||(this.idDataList.items[p]={}),this.idDataList.items[f])this.idDataList.items[p][h]=this.idDataList.items[f][h];this.idDataList.items[p].filterData=n.empty?null:n,this.idDataList.items[p].requiresIndex=!n.empty,y.forceRequireIndex(!1),n.empty?(i.idDataList.items[p].filterSpec=null,y.persistIDs(i.idDataList)):O.getFilterSpecificationPromise(o,c).then(function(e){1===e.status&&(i.idDataList.items[p].filterSpec=e.publicSpec),y.persistIDs(i.idDataList)},function(){y.persistIDs(i.idDataList)}),this.updateUIforIdList(!1)},be.prototype.createOrigTile=function(i,n,o,r,a){var s=this,u="";if(i.id.endsWith("-left")?u="left":i.id.endsWith("-right")?u="right":console.log("CompareInput createOrigTile failure"),void 0!==i.children&&null!==i.children&&i.children.length>0)for(;i.children.length>0;){var c=i.children[i.children.length-1];i.removeChild(c)}var p=o+x,d=o+T,f=(i.id,Ce(n,!1)),m=function(e){var t=e.displayType;return null!=t&&""!==t||(t=e.type),t}(n),v=n.revision;null!=a&&(void 0!==a.customTitle&&null!==a.customTitle&&""!==a.customTitle&&(f=a.customTitle),void 0!==a.customSubtitle&&null!==a.customSubtitle&&""!==a.customSubtitle&&(m=a.customSubtitle),void 0!==a.prependToSubtitle&&null!==a.prependToSubtitle&&""!==a.prependToSubtitle&&(m=a.prependToSubtitle+m),void 0!==a.customDescription&&null!==a.customDescription&&""!==a.customDescription&&(v=a.customDescription));var g=[],y=[],C=[];this._supportsRevisions(n.physicalid,u)&&(g.push(w.get("revisionCM")),y.push("revision"),C.push("flow-branch-list")),this._supportsFilters(n.physicalid,u)&&(g.push(w.get("filterCM")),y.push("filter"),C.push("filter")),this._supportsOpenContent(u)&&(g.push(w.get("openCM")),y.push("open"),C.push("open")),g.push(w.get("swapColumnsCM")),y.push("swap"),C.push("exchange"),this._supportsRemoveItem(u)&&(g.push(w.get("removeCM")),y.push("remove"),C.push("remove"));let b=e.String.escapeHTML(f);var I=new l({picture:p,icon:d,title:b,multipleTitleLineNumber:!1,subtitle:m,description:v,statusbarIcons:[],contextualMenu:g,onContextMenuBuildCallback:function(e){var t=[];if(null!=e)for(var i=0;i<e.length;i++)t.push({type:"PushItem",title:e[i],icon:C[i],action:{context:y[i]+"-"+u,callback:function(e){var t=e.context.indexOf("-"),i=e.context.substring(t+1);""!==i?e.context.startsWith("revision-")?s.replaceWithRevisionOf(i):e.context.startsWith("filter-")?s.replaceWithFilterOf(i):e.context.startsWith("open-")?s.replaceWithSearch(i):e.context.startsWith("swap-")?s.swapColumns():e.context.startsWith("remove-")?s.clearItem(i):console.log("CompareInput context menu callback UNKNOWN reached"):console.log("CompareInput context menu callback id failure")}}});return t}}).inject(i);I.getContent().setStyle("width","100%"),null!=a&&(!0===a.highlight&&I.highlight(),void 0!==a.applyBadgeToImage&&null!==a.applyBadgeToImage&&Oe(I,a.applyBadgeToImage)),function(e,i,n,o,r,a){if(void 0===n.serviceId||null===n.serviceId||""===n.serviceId||"3dspace"===n.serviceId.toLowerCase())if(void 0!==n.preview_url&&null!==n.preview_url&&""!==n.preview_url)o.picture=n.preview_url;else{var s=n.physicalid,l="undefined"!=typeof widget&&widget?widget.getValue("x3dPlatformId"):null;null!=l&&""!=l||(l="OnPremise");var u=e+L+s+"/?tenant="+l+"&root3DSpaceUrl="+e;if("Workspace"==a){var c=h.getObjTypeLargeIconPath(a);null!=c&&(o.picture=e+"/"+c)}else t.authenticatedRequest(u,{ndx:0,proxy:i,onComplete:function(t){if(console.log("CompareInput getImage success"),t.endsWith("iconLargeDefault.png")){var i=h.getObjTypeLargeIconPath(a);null!=i&&(t=e+"/"+i)}o.picture=t},onFailure:function(){console.log("CompareInput getImage failed")}})}else o.picture=n.preview_url}(o,r,n,I,0,n.internalType),function(e,i,n,o,r,a){if(void 0===n.serviceId||null===n.serviceId||""===n.serviceId||"3dspace"===n.serviceId.toLowerCase())if(void 0!==n.type_icon_url&&null!==n.type_icon_url&&""!==n.type_icon_url)o.icon=n.type_icon_url;else{var s=n.physicalid,l="undefined"!=typeof widget&&widget?widget.getValue("x3dPlatformId"):null;null!=l&&""!=l||(l="OnPremise");var u=e+E+s+"/?tenant="+l+"&root3DSpaceUrl="+e;if("Workspace"==a){var c=h.getObjTypeIconPath(a);null!=c&&(o.icon=e+"/"+c)}else t.authenticatedRequest(u,{ndx:0,proxy:i,onComplete:function(t){if(console.log("CompareInput getIcon success"),t.endsWith("iconLargeDefault.png")){var i=h.getObjTypeIconPath(a);null!=i&&(t=e+"/"+i)}o.icon=t},onFailure:function(){console.log("CompareInput getIcon failed")}})}else o.icon=n.type_icon_url}(o,r,n,I,0,n.internalType);var D=null,O=null;if("left"===u?(D=jQuery("#"+he),O=jQuery("#"+pe)):"right"===u&&(D=jQuery("#"+fe),O=jQuery("#"+ce)),null!==D&&D.length>0){D[0].children[0].nextSibling.nodeValue=w.get("revisionOfButtonLabel").replace("{objname}",f)}if(null!==O&&O.length>0){O[0].children[0].nextSibling.nodeValue=w.get("filterOfButtonLabel").replace("{objname}",f)}A[u]=n.physicalid,this.tile[u]=I},be.prototype.updateUIforIdList=function(e){var t=null!=this.idDataList?this.idDataList.get_nonNullCount():0;t<2?this.compareBtn.disable():(this.compareBtn.enable(),this.compareBtn.focus()),this.inputFooter[0===t?"hide":"show"](),t>0?(jQuery("#compare-input-container-right").show(),"side-by-side"===this.displayOrientation?jQuery("#compare-input-middle-cmds").show():jQuery("#compare-input-middle-cmds").hide()):(jQuery("#compare-input-container-right").hide(),jQuery("#compare-input-middle-cmds").hide());let i=jQuery("."+V);(i.length>1&&(i[0].style.display=t>0?"":"none"),jQuery("#compare-input-drop-target-left").css("border",t>0?"":"none"),jQuery("#"+se)[0].children[0].nextSibling.nodeValue=w.get(t>0?"searchButtonLabel":"addObjectsDZ"),this._tempBasicDropZone)&&(this._tempBasicDropZone=!1,jQuery("#"+R)[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].style.display="none",this._setSupportsDropZones("left",!1),this.shutdownDragAndDropHandling());if(null===this.idDataList||null===this.idDataList.getLeftID()){let e=t>0&&this._supportsRevisions(this.idDataList.getRightID(),"left"),i=t>0&&this._supportsFilters(this.idDataList.getRightID(),"left"),n=jQuery("#"+fe);if(n[0].style.display=e?"":"none",(n=jQuery("#"+ce))[0].style.display=i?"":"none",(n=jQuery("#"+se))[0].style.display=this._supportsOpenContent("left")?"":"none","none"===n[0].style.display)if(!e&&!i&&!this._supportsDropZones("left"))this._tempBasicDropZone=!0,jQuery("#"+R)[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0].style.display="",n[0].style.display="",this._setSupportsDropZones("left",!0),this.setupDragAndDropHandling()}if(null!==this.idDataList&&null!==this.idDataList.getLeftID()&&null===this.idDataList.getRightID()){let e=this._supportsRevisions(this.idDataList.getLeftID(),"right"),t=this._supportsFilters(this.idDataList.getLeftID(),"right"),i=jQuery("#"+he);i[0].style.display=e?"":"none",(i=jQuery("#"+pe))[0].style.display=t?"":"none",(i=jQuery("#"+le))[0].style.display=this._supportsOpenContent("right")?"":"none"}void 0!==this._CCM&&null!==this._CCM&&(this.launchCompareCustomizationCB,Function)},be.prototype.updateComparisonProfileDropdownUI=function(){require(["DS/CompareWidget2/framework/useCase","DS/CompareWidget2/support/objIDSpec"],(e,t)=>{})},be.prototype.computeOrientation=function(e){var t="";if(null!=e){var i=e.clientWidth,n=e.clientHeight;t=i<480&&n>i?"over-under":"side-by-side"}return t},be.prototype.updateDisplayOrientation=function(){var e=jQuery("#compare-input-root"),t=this.computeOrientation(e[0]);if(t!==this.displayOrientation){this.displayOrientation=t;var i="side-by-side"===this.displayOrientation?"row":"column";jQuery("#compare-input-drop-targets").css("flex-direction",i),"side-by-side"===this.displayOrientation?jQuery("#compare-input-middle-cmds").show():jQuery("#compare-input-middle-cmds").hide()}},be.prototype.updateTenant=function(e,t){var i=this;null!=this.idDataList&&this.idDataList.get_nonNullCount()>0?y.confirmDialog(w.get("PlatformChange"),"fonticon-attention",{label:w.get("ChangeButton"),callback:function(){i.clearItem("all"),i.tenant=e,y.showAlertBox("tenantChanged",w,"success"),t(!0)}},{label:w.get("CancelButton"),callback:function(){t(!1)}}):(this.tenant=e,y.showAlertBox("tenantChanged",w,"success"),t(!0))},be.prototype.clearItem=function(e){"left"==e?(this.idDataList.items.length>0&&(this.idDataList.items[0]=null),this.idDataList.get_nonNullCount()>0?(this.idDataList.areCompared=!1,y.persistIDs(this.idDataList)):(this.idDataList=null,y.clear_persistedIDs()),this.clearTileItem(e),O.clearFiltering(e,A),A[e]=""):"right"==e?(this.idDataList.items.length>1&&(this.idDataList.items[1]=null),this.idDataList.get_nonNullCount()>0?(this.idDataList.areCompared=!1,y.persistIDs(this.idDataList)):(this.idDataList=null,y.clear_persistedIDs()),this.clearTileItem(e),O.clearFiltering(e,A),A[e]=""):(this.idDataList=null,y.clear_persistedIDs(),this.clearTileItem("left"),this.clearTileItem("right"),O.clearFiltering("",A),A.left="",A.right="",this.inputRoot.show()),this.updateUIforIdList(!0)},be.prototype.clearTileItem=function(e){var t=jQuery("#"+ie+"-"+e);for(t.hide();t[0].children.length>0;){var i=t[0].children[t[0].children.length-1];t[0].removeChild(i)}jQuery("#"+F+"-"+e).show(),this.tile[e]=null},be.prototype.doCompare=function(){var e=this;function t(){for(var t of(I.destroySearch(),e.clearTileItem("left"),e.clearTileItem("right"),e.idDataList.areCompared=!0,e.idDataList.items))t.supportsRevisions=e._objSupportsRevisions(t.objectId),t.supportsFilters=e._objSupportsFilters(t.objectId);if(y.persistIDs(e.idDataList),"function"==typeof e.doCompareCB){var i={idDataList:e.idDataList,validateObj_stateData:e.validateObj_stateData};e.doCompareCB(i)}}if(!0===this.idDataList.areCompared||"IDPlusCommandsList"===this.idDataList.listType||!0===this.runOptions.ImmediateCompare&&!1!==this.runOptions.AllowCompareOfIdentical||!this.idDataList.areItemsIdentical(0,1))t();else if(!1!==this.runOptions.AllowCompareOfIdentical){let e=Ce(this.validateObj_stateData[this.idDataList.items[0].objectId]),i=Ce(this.validateObj_stateData[this.idDataList.items[1].objectId]);y.confirmDialog(w.get("CompareWithItself").replace("{objname1}",e).replace("{objname2}",i),null,{label:w.get("CompareStructures"),callback:function(){t()}},{label:w.get("CancelButton"),callback:function(){}})}else y.showAlertBox("CompareWithItselfNotAllowed",w,"error"),this.clearItem("right")},be});