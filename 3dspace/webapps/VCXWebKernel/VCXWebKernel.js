define("DS/VCXWebKernel/VCXNodeHolderActorList",["DS/WebApplicationBase/W3AASGNodeHolder","DS/Visualization/Node3D","Visualization/PathElement"],function(e,t,i){"use strict";return e.extend({init:function(){},buildSGNode:function(){return null},getPathElement:function(){return new i},isSelfManagedPathElement:function(){return!0}})}),define("DS/VCXWebKernel/VCXModelNavigableActorList",["DS/WebApplicationBase/VCXAModelNavigable"],function(e){"use strict";return e.extend({init:function(){},getChildren:function(){for(var e=this.QueryInterface("VCXIModifiable").GetProperty("Actor.ListActors").GetPropertyValue().GetValue(),t=[],i=0;i<e.length;i++){var n=e[i],r=this.GetObject()._experienceBase.ComponentsMap.GetComponentFromLink(n);r&&t.push(r)}return t},isSelfOrganized:function(){return!0}})}),define("DS/VCXWebKernel/VCXCmdChangeMarker",["DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCommand","DS/VCXWebKernelCommands/VCXCmdChangeModifiable","DS/VCXWebKernelCommands/VCXCmdChangeComponent"],function(e,t,i,n){"use strict";return t.extend({init:function(e,t,i){this._parent(),this._scenarioManager=e,this._commandManager=t,this._ComponentsMap=i,this._markersToAdd={},this._markerToRemove={},this._scenario=null,this._bLockEvents=!1,this._type="VCXCmdChangeMarker"},GetType:function(){return this._type},GetTitle:function(){return"Change markers"},AddMarkerToScenario:function(e,t,i){e&&"undefined"!==i&&(this._markersToAdd[i]=e),this._scenario=t},RemoveMarkerFromScenario:function(e,t){if(e){var i=e.QueryInterface("VCXIModifiable").GetProperty("Actor.TimePos").GetPropertyValue().GetValue();this._markerToRemove[i]=e}this._scenario=t},Do:function(){if(this._scenario){var t=new i(this._scenarioManager),r=new n(this._commandManager,this._ComponentsMap);for(var a in this._markersToAdd)if(this._markersToAdd.hasOwnProperty(a)){var o=this._markersToAdd[a];r.AddComponents(o),t.AddModifiables(o.QueryInterface("VCXIModifiable"))}for(var a in this._markerToRemove)if(this._markerToRemove.hasOwnProperty(a)){o=this._markerToRemove[a];r.RemoveComponents(o),t.RemoveModifiables(o.QueryInterface("VCXIModifiable"))}for(var a in this._commandManager.Push(r),this._commandManager.Push(t),this._markersToAdd)if(this._markersToAdd.hasOwnProperty(a)){o=this._markersToAdd[a];this._scenario.AddMarker(a,o),o.SetParentScenario(this._scenario.GetID())}for(var a in this._markerToRemove)this._markerToRemove.hasOwnProperty(a)&&this._scenario.RemoveMarker(a);if(this._bLockEvents);else{var s={arrayToAdd:this._markersToAdd,arrayToRemove:this._markerToRemove};e.publish({event:"VCX_MARKERS_CHANGED",data:s})}}else console.log("VCXCmdChangeMarker: scenario not found")},Invert:function(){var e=this._markersToAdd;this._markersToAdd=this._markerToRemove,this._markerToRemove=e},SetLockEvents:function(e){this._bLockEvents=e}})}),define("DS/VCXWebKernel/VCXModifiableDRMManager",["UWA/Core","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueBoolean","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,i,n,r,a,o){"use strict";return t.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,i){if(i||(i={}),i.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if("Display.Tree"===e){var n=t.GetValue();this.GetObject().GetDisplayTree()!==n&&this.GetObject().SetDisplayTree(n)}else if("Display.Timeline"===e){var r=t.GetValue();this.GetObject().GetDisplayTimeline()!==r&&this.GetObject().SetDisplayTimeline(r)}else if("Display.PropertiesPanel"===e){var a=t.GetValue();this.GetObject().GetDisplayPropertiesPanel()!==a&&this.GetObject().SetDisplayPropertiesPanel(a)}else{if("Display.ScenariosPanel"!==e){i.fromChildClass=!0;var o=this._parent(e,t,i);return o||console.log("property not found : '"+e+"'"),o}var s=t.GetValue();this.GetObject().GetDisplayScenariosPanel()!==s&&this.GetObject().SetDisplayScenariosPanel(s)}return!0},GetProperty:function(e){var t=null;if("Display.Tree"===e){var i=this.GetObject().GetDisplayTree();(c=new a).SetValue(i),t=new n(new r(e,2,!0,o),c)}else if("Display.Timeline"===e){var s=this.GetObject().GetDisplayTimeline();(c=new a).SetValue(s),t=new n(new r(e,2,!0,o),c)}else if("Display.PropertiesPanel"===e){var l=this.GetObject().GetDisplayPropertiesPanel();(c=new a).SetValue(l),t=new n(new r(e,2,!0,o),c)}else if("Display.ScenariosPanel"===e){var c,p=this.GetObject().GetDisplayScenariosPanel();(c=new a).SetValue(p),t=new n(new r(e,2,!0,o),c)}return t},GetProperties:function(){var e=new i;return e.AddOrModifyProperty(this.GetProperty("Display.Tree")),e.AddOrModifyProperty(this.GetProperty("Display.Timeline")),e.AddOrModifyProperty(this.GetProperty("Display.PropertiesPanel")),e.AddOrModifyProperty(this.GetProperty("Display.ScenariosPanel")),e}})}),define("DS/VCXWebKernel/VCXModifiableMarker",["DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueBoolean","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,i,n,r,a,o,s){"use strict";return e.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,i){if(i||(i={}),i.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if("Actor.Name"===e){var n=t.GetValue();this.GetObject().name!==n&&(this.GetObject().name=n)}else if("Actor.TimePos"===e){var r=t.GetValue();this.GetObject().timePos!==r&&(this.GetObject().timePos=r)}else{if("Actor.IsMilestone"!==e){i.fromChildClass=!0;var a=this._parent(e,t,i);return a||console.log("property not found : '"+e+"'"),a}var o=t.GetValue();this.GetObject().isMileStone!==o&&(this.GetObject().isMileStone=o)}return!0},GetProperty:function(e){var t=null;if("Actor.Name"===e){var l=this.GetObject().name;if(l){var c=new a;c.SetValue(l),t=new i(new n(e,2,!0,s),c)}}else if("Actor.TimePos"===e){var p=this.GetObject().timePos;if(null!==p){var h=new r;h.SetValue(p),t=new i(new n(e,0,!0,s),h)}}else if("Actor.IsMilestone"===e){var u=this.GetObject().isMileStone;if(null!==u){var d=new o;d.SetValue(u),t=new i(new n(e,0,!0,s),d)}}return t},GetProperties:function(){var e=new t;return e.AddOrModifyProperty(this.GetProperty("Actor.TimePos")),e.AddOrModifyProperty(this.GetProperty("Actor.Name")),e.AddOrModifyProperty(this.GetProperty("Actor.IsMilestone")),e}})}),define("DS/VCXWebKernel/VCXInternalMaterial_Spec",["require","exports"],function(e,t){"use strict";class i{constructor(){}GetID(){return"VCXInternalMaterial_Spec_"+this.QueryInterface("VCXIMaterialCache").GetPID()}}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXInternalMaterial_Spec"}}),i}),define("DS/VCXWebKernel/VCXCmdChangeSelection",["DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCommand"],function(e,t){"use strict";var i={AddToSelection:3,RemoveFromSelection:3,SetSelection:3,SetModifiablesSelection:3};return t.extend({init:function(e,t){this._DoNotUpdateCSO=!1,t&&(this._DoNotUpdateCSO=!0),this._parent(),this._compToAdd=[],this._compToRemove=[],this._selectionManager=e,this._bLockEvents=!1,this._type="VCXCmdChangeSelection"},_sendWarningIfNecessary:function(e,t){i[t]>0&&(console.warn(e),--i[t])},GetType:function(){return this._type},GetTitle:function(){return"Change selection"},Do:function(){this._selectionManager.addComponentsToSelection(this._compToAdd,this._DoNotUpdateCSO),this._selectionManager.removeComponentsFromSelection(this._compToRemove,this._DoNotUpdateCSO),this._bLockEvents||e.publish({event:"VCX_SELECTION_CHANGED"})},Redo:function(){this._selectionManager.addComponentsToSelection(this._compToAdd,this._DoNotUpdateCSO),this._selectionManager.removeComponentsFromSelection(this._compToRemove,this._DoNotUpdateCSO),this._bLockEvents||e.publish({event:"VCX_SELECTION_CHANGED"})},Invert:function(){var e=this._compToAdd;this._compToAdd=this._compToRemove,this._compToRemove=e},SaveContext:function(){},AddComponentsToSelection:function(e){if(!e)return!1;this._compToAdd=this._compToAdd.concat(e)},AddToSelection:function(e){if(e.QueryInterface("VCXIModifiable")===e){this._sendWarningIfNecessary("The method 'AddToSelection' used with a modifiable as parameter is now deprecated. Please use a component instead of a modifiable.","AddToSelection"),e=e.GetObject()}this._compToAdd.push(e)},RemoveComponentsFromSelection:function(e){if(!e)return!1;this._compToRemove=this._compToRemove.concat(e)},RemoveFromSelection:function(e){if(e.QueryInterface("VCXIModifiable")===e){this._sendWarningIfNecessary("The method 'RemoveFromSelection' used with a modifiable as parameter is now deprecated. Please use a component instead of a modifiable.","RemoveFromSelection"),e=e.GetObject()}this._compToRemove.push(e)},SetSelection:function(e){if(e&&e.QueryInterface("VCXIModifiable")===e){this._sendWarningIfNecessary("The method 'SetSelection' used with a modifiable as parameter is now deprecated. Please use a component instead of a modifiable.","SetSelection"),e=e.GetObject()}var t=this._selectionManager.GetComponentsFromCurrentSelection();if(e){var i,n=!1;(i=e.GetID())||console.log("VCXCmdChangeSelection: id is not defined for this component !");for(var r=0;r<t.length;r++){var a=t[r].GetID();a?a!==i?this.RemoveFromSelection(t[r]):n=!0:console.log("VCXCmdChangeSelection: currentId is empty !")}!n&&i&&this.AddToSelection(e)}else this.RemoveComponentsFromSelection(t)},SetComponentsSelection:function(e){for(var t=this._selectionManager.GetComponentsFromCurrentSelection(),i=0;i<t.length;i++){var n=t[i];if(n){for(var r=!1,a=0;a<e.length;a++){var o=e[a];if(o&&o===n){r=!0;break}}r||this.RemoveFromSelection(n)}}this.AddComponentsToSelection(e)},SetModifiablesSelection:function(e){this._sendWarningIfNecessary("/!\\ The method SetModifiablesSelection(arrModifiables) is DEPRECATED /!\\\nPlease use method cmdChangeSelection.SetComponentsSelection(arrComponents) instead.","SetModifiablesSelection");var t=e.map(function(e){return e.GetObject()});this.SetComponentsSelection(t)},SetLockEvents:function(e){this._bLockEvents=e}})}),define("DS/VCXWebKernel/VCXMarkerManager",["UWA/Class","DS/CoreEvents/Events"],function(e,t){"use strict";var i=e.extend({initialize:function(){this._callback=null;var e=this;this._tokenMarkerSeq=t.subscribe({event:"VCX_UPDATE_MARKER_SEQ"},function(t){e.UpdateMarkerSequence(t)})},unInitialize:function(){this._callback=null,this._tokenMarkerSeq&&(t.unsubscribe(this._tokenMarkerSeq),this._tokenMarkerSeq=null)},UpdateMarkerSequence:function(e){if(this._callback){var t=e.scenarioID,i=this._experienceBase.ComponentsMap.GetComponentFromID(t);if(i){var n=i.GetTrackMarkers();if(n){var r=n.GetPreviousKey(e.time);if(r){var a=r.GetValue();if(i.GetCurrentMarkerSequence()!==a&&(i.SetCurrentMarkerSequence(a),this._callback)){var o=this._experienceBase.ComponentsMap.GetComponentFromID(a);if(o){var s=o.GetTimePos(),l=o.GetName(),c=o.IsMilestone();this._callback(l,s,c,t,a)}}}}}}},RegisterMarkerSequenceCB:function(e){this._callback=e}});return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXMarkerManager"}}),i}),define("DS/VCXWebKernel/VCXAContextualContent",["UWA/Class"],function(e){"use strict";var t=e.extend({appendContent:function(e,t,i){}});return t.content=[],t}),define("DS/VCXWebKernel/VCXMultiUserInputManager",["UWA/Class"],function(e){"use strict";var t=e.extend({postInitialize:function(){this._parent(),this._runningCommand=[]},unInitialize:function(){this._parent()},update:function(e){for(var t=0;t<this._runningCommand.length;t++)this._runningCommand[t].update&&this._runningCommand[t].update(e)},preRender:function(e){for(var t=0;t<this._runningCommand.length;t++)this._runningCommand[t].preRender&&this._runningCommand[t].preRender(e)},postRender:function(e){for(var t=0;t<this._runningCommand.length;t++)this._runningCommand[t].postRender&&this._runningCommand[t].postRender(e)},postUpdate:function(e){for(var t=0;t<this._runningCommand.length;t++)this._runningCommand[t].postUpdate&&this._runningCommand[t].postUpdate(e)},registerCommand:function(e){this._runningCommand.push(e)},unRegisterCommand:function(e){this._runningCommand.pop(e)}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXMultiUserInputManager"}}),t});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXActorList_Spec",["require","exports","DS/VCXWebExperienceBase/VCXComponentOccurrenceExperience"],function(e,t,i){"use strict";i=__importDefault(i);class n extends i.default{constructor(){super(),this._arrayActors=[],this._arrayActors=[],this._bEnable=!0,this._GroupID=null}SetName(e){e&&(this._name=e)}GetName(){return this._name}SetArrayActors(e){if(Array.isArray(e)&&0!==e.length)for(var t=0;t<e.length;t++){var i=e[t];this.AddActor(i)}}GetArrayActors(){return this._arrayActors}AddActor(e){for(var t=!1,i=0;i<this._arrayActors.length;i++){if(this._arrayActors[i]===e){t=!0;break}}if(!t){var n=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(n)this._arrayActors.push(e),this.getManagerName&&this._experienceBase.getManager(this.getManagerName()).addComponentToMapSelectionSet(n,this);else{var r=this._experienceBase.getManager("VCXContextManager");if(r.getOpenSMGXML()){var a=r.getSmgXmlRoot();if(a){var o=a.GetComponentsMap();o.has(e)&&(n=o.get(e))&&this._arrayActors.push(n.GetID())}}}}}RemoveActor(e){for(var t=0;t<this._arrayActors.length;t++){if(this._arrayActors[t]===e){this._arrayActors.splice(t,1);var i=this._experienceBase.ComponentsMap.GetComponentFromID(e);i&&this.getManagerName&&this._experienceBase.getManager(this.getManagerName()).removeComponentFromMapSelectionSet(i,this);break}}}get enable(){return this._bEnable}set enable(e){this._bEnable=e}get GroupID(){return this._GroupID}set GroupID(e){this._GroupID=e}}return Object.defineProperty(n.prototype,"componentType",{enumerable:!0,get:function(){return"VCXActorList_Spec"}}),n}),define("DS/VCXWebKernel/VCXCmdGoToMarker",["DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCommand","DS/VCXWebKernelCommands/VCXCmdChangeTimePos","DS/VCXWebKernelCommands/VCXCmdGoToScenario","DS/WebRBTree/WebRBIterator"],function(e,t,i,n,r){"use strict";return t.extend({init:function(e,t,i){this._parent(),this._scenarioManager=e,this._commandManager=t,this._ComponentsMap=i,this._bLockEvents=!1,this._targetMarker=null,this._frameForDo=null,this._frameForUndo=null,this._type="VCXCmdGoToMarker"},GetType:function(){return this._type},GetTitle:function(){return"Go to markers"},GoToMarker:function(e){this._targetMarker=this._ComponentsMap.GetComponentFromID(e),this._targetMarker&&(this._frameForDo=this._targetMarker.QueryInterface("VCXIModifiable").GetProperty("Actor.TimePos").GetPropertyValue().GetValue())},GoToNextMarker:function(){var e=this._scenarioManager.GetCurrentFrame(),t=this._scenarioManager.GetCurrentScenario(),i=this._ComponentsMap.GetComponentFromID(t),n=i.GetTrackMarkers(),r=!1;if(n){var a=n.GetNextStrictKey(e);if(null!==a){var o=a.GetValue(),s=a.GetFrame();this._targetMarker=this._ComponentsMap.GetComponentFromID(o),this._frameForDo=s,r=!0}}r||(this._frameForDo=i.GetMaxFrame())},GoToPreviousMarker:function(){var e=this._scenarioManager.GetCurrentFrame(),t=this._scenarioManager.GetCurrentScenario(),i=this._ComponentsMap.GetComponentFromID(t).GetTrackMarkers(),n=!1;if(i){var r=i.GetPreviousStrictKey(e);if(null!==r){var a=r.GetValue(),o=r.GetFrame();this._targetMarker=this._ComponentsMap.GetComponentFromID(a),this._frameForDo=o,n=!0}}n||(this._frameForDo=0)},Do:function(){if(this._targetMarker){var t=this._targetMarker.GetParentScenario();if(t!==this._scenarioManager.GetCurrentScenario()){var r=new n(this._scenarioManager,this._commandManager);r.GoToScenario(t),this._commandManager.Push(r)}}var a=new i(this._scenarioManager);a.ChangeTimePos(this._frameForDo),this._commandManager.Push(a);this._bLockEvents||e.publish({event:"VCX_GOTO_MARKER",data:this._frameForDo}),this._callback&&this._callback(this._parameter)},SaveContext:function(){this._frameForUndo=this._scenarioManager.GetCurrentFrame()},Redo:function(){this._bLockEvents||e.publish({event:"VCX_GOTO_MARKER",data:this._frameForDo})},Undo:function(){this._bLockEvents||e.publish({event:"VCX_GOTO_MARKER",data:this._frameForUndo})},Invert:function(){},SetLockEvents:function(e){this._bLockEvents=e}})}),define("DS/VCXWebKernel/VCXNotificationManager",["UWA/Class","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/VCXWebIO/VCXLogServices","DS/UIKIT/Spinner","DS/Controls/ModalContainer","DS/Controls/ProgressBar","DS/ControlsEx/LoadingPanel","UWA/Core","css!DS/VCXWebKernel/VCXWebKernel.css","DS/Controls/Button","DS/VCXWebSystem/VCXTextTools","i18n!DS/VCXWebKernel/assets/nls/VCXWebKernel"],function(e,t,i,n,r,a,o,s,l,c,p,h,u){"use strict";var d=e.extend({_notifCounter:0,_notifStack:{},_parentContainer:null,_curtainView:null,_progressBarView:null,_wuxNotifManager:null,_displayProgressBarInCurtainCounter:0,initialize:function(){i.setNotificationManager(t),i.setStackingPolicy(7),i.setRemoveStackOnFirstTimeoutFlag(!0)},postInitialize:function(){"undefined"!=typeof widget?this._parentContainer=widget.body:this._parentContainer=document.body,this._curtainView=new _,this._curtainView.setNotificationManager(this),this._curtainView.initialize(),this._progressBarView=new C,this._progressBarView.setNotificationManager(this),this._progressBarView.initialize(),this._loadingPanel=new f,this._loadingPanel.setNotificationManager(this),this._loadingPanel.initialize(),this._loadingPanel.loadingPanelODTSupport=!this._experienceBase.getManager("VCXODTManager")||"true"===localStorage.getItem("VCX_Enable_DisplayProgressBar")},unInitialize:function(){this.clearAllProgressNotifications(),this.clearAllNotifications(),this._curtainView&&this._curtainView.dispose(),delete this._curtainView,this._progressBarView&&this._progressBarView.dispose(),delete this._progressBarView,this._loadingPanel&&this._loadingPanel.dispose(),delete this._loadingPanel,this._notifStack={},this._resetNotificationIdGenerator(),this._parentContainer=null},getParentContainer:function(){return this._parentContainer},addNotification:function(e){e.category=e.message,e.idx=t.addNotif(e)},removeNotification:function(e,t){i.removeNotifications(e,t)},clearAllNotifications:function(){i.removeNotifications("",""),i.removeNotifications()},_generateNotificationId:function(){return this._notifCounter++,this._notifCounter},_resetNotificationIdGenerator:function(){this._notifCounter=0},_getNextNotificationWaiting:function(e){var t;for(var i in this._notifStack)if(this._notifStack.hasOwnProperty(i)){if(this._notifStack[i].maskDisplayAdd&this._notifStack[i].maskDisplayAddWaiting&e){t=i;break}if(this._notifStack[i].maskDisplayEnd&this._notifStack[i].maskDisplayEndWaiting&e){t=i;break}if(this._notifStack[i].maskDisplayErr&this._notifStack[i].maskDisplayErrWaiting&e){t=i;break}}return t},_hasNotificationDisplayed:function(e){var t=!1;for(var i in this._notifStack)if(this._notifStack.hasOwnProperty(i)){if(this._notifStack[i].maskDisplayAdd&~this._notifStack[i].maskDisplayAddWaiting&e){t=!0;break}if(this._notifStack[i].maskDisplayEnd&~this._notifStack[i].maskDisplayEndWaiting&e){t=!0;break}if(this._notifStack[i].maskDisplayErr&~this._notifStack[i].maskDisplayErrWaiting&e){t=!0;break}}return t},_getPercentValueToDisplay:function(e,t){var i,n=0;if(this._notifStack[e].displayProgressBarInCurtainFlag===d.FDisplayModeProgressBarInCurtain.CURRENT)this._notifStack[e].percentValue&&this._notifStack[e].maskDisplayAdd&t&&(n=this._notifStack[e].percentValue);else if(this._notifStack[e].displayProgressBarInCurtainFlag===d.FDisplayModeProgressBarInCurtain.SUM)for(i in this._notifStack)this._notifStack.hasOwnProperty(i)&&this._notifStack[i].percentValue&&this._notifStack[i].maskDisplayAdd&t&&(n+=this._notifStack[i].percentValue);else if(this._notifStack[e].displayProgressBarInCurtainFlag===d.FDisplayModeProgressBarInCurtain.MIN)for(i in this._notifStack)this._notifStack.hasOwnProperty(i)&&this._notifStack[i].percentValue&&this._notifStack[i].maskDisplayAdd&t&&(n=Math.min(n,this._notifStack[i].percentValue));else if(this._notifStack[e].displayProgressBarInCurtainFlag===d.FDisplayModeProgressBarInCurtain.MAX)for(i in this._notifStack)this._notifStack.hasOwnProperty(i)&&this._notifStack[i].percentValue&&this._notifStack[i].maskDisplayAdd&t&&(n=Math.max(n,this._notifStack[i].percentValue));return n},_completeVCXInputOptions:function(e){e.strObjectType=e.strObjectType||"",e.strObjectName=e.strObjectName||e.strObjectType,e.strAction=e.strAction||u["ProgressNotification.Loading"],e.iPromise=e.iPromise||void 0,e.totalProgressLevel=e.totalProgressLevel||1,e.currentProgressLevel=e.currentProgressLevel||1,e.percentValue=e.percentValue||0,e.displayProgressBarInCurtainFlag=e.displayProgressBarInCurtainFlag||d.FDisplayModeProgressBarInCurtain.NONE,e.maskDisplayAdd=e.maskDisplayAdd||d.FDisplayMode.CONSOLE|d.FDisplayMode.BUBBLEFLOW,e.maskDisplayEnd=e.maskDisplayEnd||d.FDisplayMode.CONSOLE,e.maskDisplayErr=e.maskDisplayErr||d.FDisplayMode.CONSOLE|d.FDisplayMode.BUBBLEFLOW,e.maskDisplayAddWaiting=0,e.maskDisplayEndWaiting=0,e.maskDisplayErrWaiting=0},_updateVCXOptionsLabels:function(e,t){e.strObjectType=t.strObjectType||e.strObjectType,e.strObjectName=t.strObjectName||e.strObjectType,e.strAction=t.strAction||e.strAction,e.totalProgressLevel=t.totalProgressLevel||e.totalProgressLevel,e.currentProgressLevel=t.currentProgressLevel||e.currentProgressLevel,e.percentValue=t.percentValue||e.percentValue},getMaskFlag:function(e,t){return e&t},setMaskFlag:function(e,t,i){return void 0===i||i?e|=t:e&=~t,e},_completeWuxInfoOptions:function(e,t){t.level="info",t.sticky=!0,t.message=t.message||"",t.title=e.strAction+" "+e.strObjectType,t.subtitle=e.strObjectName},_completeWuxSuccessOptions:function(e,t){t.level="success",t.sticky=!1,t.message="",t.title=e.strAction+" "+e.strObjectType,t.subtitle=e.strObjectName},_completeWuxErrorOptions:function(e,t,i){t.level="error",t.sticky=!0,t.message=i,t.title=e.strAction+" "+e.strObjectType,t.subtitle=e.strObjectName},_completeWuxWarningOptions:function(e,t,i){t.level="warning",t.sticky=!0,t.message=i,t.title=e.strAction+" "+e.strObjectType,t.subtitle=e.strObjectName},addProgressNotification:function(e){this._loadingPanel&&e.maskDisplayAdd&d.FDisplayMode.CURTAIN&&this._loadingPanel.displayPanel(e.notifTitle,e.strAction,e.strObjectName,e.strObjectType);var i=this._generateNotificationId();if(this._completeVCXInputOptions(e),this._notifStack[i]=e,this._notifStack[i].iPromise){var r=e.strAction+" "+e.strObjectType+" "+e.strObjectName;const t=n.generateUUID();n.memoryLog(r,!0,t);var a=this;this._notifStack[i].iPromise.then(function(){a.endProgressNotification(i,e.isLastStep),n.memoryLog(r,!1,t)}).catch(function(e){a.errorProgressNotification(i,e),n.memoryLog(r,!1,t)})}if(this._notifStack[i].cancelButton&&this._curtainView._cancelButton.getContent().show(),this._notifStack[i].maskDisplayAdd&d.FDisplayMode.BUBBLEFLOW||this._notifStack[i].maskDisplayAdd&d.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&!this._hasNotificationDisplayed(d.FDisplayMode.CURTAIN)){var o={};this._completeWuxInfoOptions(this._notifStack[i],o),this._notifStack[i].wuxNotifId=t.addNotif(o)}return this._notifStack[i].maskDisplayAdd&d.FDisplayMode.PROGRESSBAR&&(this._progressBarView.addNotificationElement(i,this._notifStack[i].strAction,this._notifStack[i].strObjectName)||(this._notifStack[i].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[i].maskDisplayAddWaiting,d.FDisplayMode.PROGRESSBAR,!0))),this._notifStack[i].maskDisplayAdd&d.FDisplayMode.CONSOLE&&console.log("addProgressNotification: "+this._notifStack[i].strAction+" : "+this._notifStack[i].strObjectName),i},updateProgressNotification:function(e,i){if(this._notifStack[e]){var n="",r="";if(i?this._updateVCXOptionsLabels(this._notifStack[e],i):(r=": "+(n=this._notifStack[e].currentProgressLevel+"/"+this._notifStack[e].totalProgressLevel),this._notifStack[e].currentProgressLevel=Math.min(this._notifStack[e].currentProgressLevel+1,this._notifStack[e].totalProgressLevel)),(this._notifStack[e].maskDisplayAdd&~this._notifStack[e].maskDisplayAddWaiting&d.FDisplayMode.CURTAIN||this._notifStack[e].maskDisplayAdd&~this._notifStack[e].maskDisplayAddWaiting&d.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&this._hasNotificationDisplayed(d.FDisplayMode.CURTAIN))&&(this._curtainView.updateNotificationElement(e,this._notifStack[e].strAction,this._notifStack[e].strObjectName+r),this._notifStack[e].displayProgressBarInCurtainFlag>0)){var a=this._getPercentValueToDisplay(e,d.FDisplayMode.CURTAIN);this._displayProgressBarInCurtainCounter>0&&a&&(this._curtainView.updateProgressBar(a),this._curtainView._displayProgressBar())}if(this._notifStack[e].maskDisplayAdd&~this._notifStack[e].maskDisplayAddWaiting&d.FDisplayMode.BUBBLEFLOW||this._notifStack[e].maskDisplayAdd&~this._notifStack[e].maskDisplayAddWaiting&d.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&!this._hasNotificationDisplayed(d.FDisplayMode.CURTAIN)){var o={message:n};this._completeWuxInfoOptions(this._notifStack[e],o),this._notifStack[e].wuxNotifId&&t.modifyNotif(this._notifStack[e].wuxNotifId,o)}this._notifStack[e].maskDisplayAdd&~this._notifStack[e].maskDisplayAddWaiting&d.FDisplayMode.PROGRESSBAR&&this._progressBarView.updateNotificationElement(e,this._notifStack[e].strAction,this._notifStack[e].strObjectName+r),this._notifStack[e].maskDisplayAdd&~this._notifStack[e].maskDisplayAddWaiting&d.FDisplayMode.CONSOLE&&console.log("updateProgressNotification: "+this._notifStack[e].strAction+" "+this._notifStack[e].strObjectName+r)}else console.error("unexpected behavior: updateProgressNotification called on a non stacked notification: "+e)},_endDisplayInProgress:function(e){if(this._notifStack[e]){var n,r,a;if(this._notifStack[e].maskDisplayAdd&d.FDisplayMode.CURTAIN||this._notifStack[e].maskDisplayAdd&d.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&this._hasNotificationDisplayed(d.FDisplayMode.CURTAIN))if(~this._notifStack[e].maskDisplayAddWaiting&(d.FDisplayMode.CURTAIN|d.FDisplayMode.BUBBLEFLOWBUTCURTAIN)){if(this._curtainView.removeNotificationElement(e),this._notifStack[e].maskDisplayAdd=this.setMaskFlag(this._notifStack[e].maskDisplayAdd,d.FDisplayMode.CURTAIN,!1),this._notifStack[e].maskDisplayAdd=this.setMaskFlag(this._notifStack[e].maskDisplayAdd,d.FDisplayMode.BUBBLEFLOWBUTCURTAIN,!1),this._notifStack[e].displayProgressBarInCurtainFlag>d.FDisplayModeProgressBarInCurtain.NONE&&this._displayProgressBarInCurtainCounter--,this._displayProgressBarInCurtainCounter<1&&this._curtainView._hideProgressBar(),n=this._getNextNotificationWaiting(d.FDisplayMode.CURTAIN)){if(a=!(r=this._curtainView.addNotificationElement(n,this._notifStack[n].strAction,this._notifStack[n].strObjectName)),this._notifStack[n].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[n].maskDisplayAddWaiting,d.FDisplayMode.CURTAIN,a),this._notifStack[n].displayProgressBarInCurtainFlag>d.FDisplayModeProgressBarInCurtain.NONE){var o=this._getPercentValueToDisplay(n,d.FDisplayMode.CURTAIN);this._displayProgressBarInCurtainCounter>0&&o&&(this._curtainView.updateProgressBar(o),this._curtainView._displayProgressBar())}}else if(this._hasNotificationDisplayed(d.FDisplayMode.CURTAIN))(n=this._getNextNotificationWaiting(d.FDisplayMode.BUBBLEFLOWBUTCURTAIN))&&(a=!(r=this._curtainView.addNotificationElement(n,this._notifStack[n].strAction,this._notifStack[n].strObjectName)),this._notifStack[n].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[n].maskDisplayAddWaiting,d.FDisplayMode.BUBBLEFLOWBUTCURTAIN,a));else for(n in this._notifStack)if(this._notifStack.hasOwnProperty(n)&&(this._notifStack[n].maskDisplayAdd|this._notifStack[n].maskDisplayAddWaiting)&d.FDisplayMode.BUBBLEFLOWBUTCURTAIN){this._curtainView.isNotificationElementDisplayed(n)?this._curtainView.removeNotificationElement(n):this._notifStack[n].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[n].maskDisplayAddWaiting,d.FDisplayMode.BUBBLEFLOWBUTCURTAIN,!1);var s={};this._completeWuxInfoOptions(this._notifStack[n],s),this._notifStack[n].wuxNotifId=t.addNotif(s)}}else this._notifStack[e].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[e].maskDisplayAddWaiting,d.FDisplayMode.CURTAIN,!1),this._notifStack[e].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[e].maskDisplayAddWaiting,d.FDisplayMode.BUBBLEFLOWBUTCURTAIN,!1);this._notifStack[e].cancelButton&&this._curtainView._cancelButton.getContent().hide(),(this._notifStack[e].maskDisplayAdd&d.FDisplayMode.BUBBLEFLOW||this._notifStack[e].maskDisplayAdd&d.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&!this._hasNotificationDisplayed(d.FDisplayMode.CURTAIN))&&(i.removeNotification(this._notifStack[e].wuxNotifId),this._notifStack[e].maskDisplayAdd=this.setMaskFlag(this._notifStack[e].maskDisplayAdd,d.FDisplayMode.BUBBLEFLOW,!1),this._notifStack[e].maskDisplayAdd=this.setMaskFlag(this._notifStack[e].maskDisplayAdd,d.FDisplayMode.BUBBLEFLOWBUTCURTAIN,!1)),this._notifStack[e].maskDisplayAdd&d.FDisplayMode.PROGRESSBAR&&(~this._notifStack[e].maskDisplayAddWaiting&d.FDisplayMode.PROGRESSBAR?(this._progressBarView.removeNotificationElement(e),this._notifStack[e].maskDisplayAdd=this.setMaskFlag(this._notifStack[e].maskDisplayAdd,d.FDisplayMode.PROGRESSBAR,!1),(n=this._getNextNotificationWaiting(d.FDisplayMode.PROGRESSBAR))&&(r=this._progressBarView.addNotificationElement(n,this._notifStack[n].strAction,this._notifStack[n].strObjectName),this._notifStack[n].maskDisplayAddWaiting=r?this.setMaskFlag(this._notifStack[n].maskDisplayAddWaiting,d.FDisplayMode.PROGRESSBAR,!1):this.setMaskFlag(this._notifStack[n].maskDisplayAddWaiting,d.FDisplayMode.PROGRESSBAR,!0))):this._notifStack[e].maskDisplayAddWaiting=this.setMaskFlag(this._notifStack[e].maskDisplayAddWaiting,d.FDisplayMode.PROGRESSBAR,!1))}else console.error("unexpected behavior: _endDisplayInProgress called on a non stacked notification: "+e)},endProgressNotification:function(e,i){if(this._loadingPanel&&this._notifStack[e]&&this._notifStack[e].maskDisplayAdd&d.FDisplayMode.CURTAIN&&this._loadingPanel.hidePanel(i),this._notifStack[e]){if(this._endDisplayInProgress(e),this._notifStack[e].maskDisplayEnd&d.FDisplayMode.BUBBLEFLOW||this._notifStack[e].maskDisplayEnd&d.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&!this._hasNotificationDisplayed(d.FDisplayMode.CURTAIN)){var n={};this._completeWuxSuccessOptions(this._notifStack[e],n),this._notifStack[e].wuxNotifId=t.addNotif(n)}this._notifStack[e].maskDisplayEnd&~this._notifStack[e].maskDisplayEndWaiting&d.FDisplayMode.CONSOLE&&console.log("endProgressNotification: "+this._notifStack[e].strAction+" "+this._notifStack[e].strObjectName),delete this._notifStack[e]}else console.error("unexpected behavior: endProgressNotification called on a non stacked notification: "+e)},errorProgressNotification:function(e,i){this._loadingPanel.hidePanel(!0);var n="object"==typeof i&&i.message?i.message:i;if(this._notifStack[e]){if(this._endDisplayInProgress(e),this._notifStack[e].maskDisplayErr&d.FDisplayMode.BUBBLEFLOW||this._notifStack[e].maskDisplayErr&d.FDisplayMode.BUBBLEFLOWBUTCURTAIN&&!this._hasNotificationDisplayed(d.FDisplayMode.CURTAIN)){var r={};this._completeWuxErrorOptions(this._notifStack[e],r,n),this._notifStack[e].wuxNotifId=t.addNotif(r)}this._notifStack[e].maskDisplayErr&d.FDisplayMode.CONSOLE&&(console.log("errorProgressNotification: "+this._notifStack[e].strAction+" "+this._notifStack[e].strObjectName+" : "+n),console.error(i)),delete this._notifStack[e]}else console.error("unexpected behavior: endProgressNotification called on a non stacked notification: "+e)},stopProgressNotification:function(e){console.log("stopProgressNotification: "+this._notifStack[e].strAction+" "+this._notifStack[e].strObjectName),this._notifStack[e]?(this._endDisplayInProgress(e),delete this._notifStack[e]):console.error("unexpected behavior: stopProgressNotification called on a non stacked notification: "+e)},computeBarValue:function(e,t=100,i=70){let n=i*(t-e)/200;return e+=(t-e)/2-Math.random()*n},clearAllProgressNotifications:function(){for(var e in this._notifStack)this._notifStack.hasOwnProperty(e)&&this.stopProgressNotification(e)}});Object.defineProperty(d.prototype,"componentType",{enumerable:!0,get:function(){return"VCXNotificationManager"}});var f=e.extend({_manager:null,initialize:function(){this.panelView=new s({modalFlag:!0,statusFlag:!1,info:" ",value:0,width:"25%"}).inject(document.body),this.panelView.getContent().addClassName("vcx-Notification-LoadingPanel"),this.panelViewTitle=l.Element("div",{html:"",class:"vcx-loading-panel-title"}),this.panelView.elements._panel.insertBefore(this.panelViewTitle,this.panelView.elements._panel.firstChild),this.panelViewSubtitleContainer=l.Element("div",{html:"",class:"vcx-loading-panel-subtitle-container"}).inject(this.panelView.elements._panel),this.panelViewMainSubtitle=l.Element("div",{html:"",class:"vcx-loading-panel-subtitle vcx-main-subtitle"}).inject(this.panelViewSubtitleContainer),this.panelViewSecondarySubtitle=l.Element("div",{html:"",class:"vcx-loading-panel-subtitle vcx-secondary-subtitle"}).inject(this.panelViewSubtitleContainer)},dispose:function(){this.panelView.destroy()},resetPanelView:function(){this.panelView.value=0,this.panelView.emphasize="info",this.panelViewTitle.innerHTML="",this.panelViewMainSubtitle.innerHTML="",this.panelViewSecondarySubtitle.innerHTML=""},displayPanel:function(e,t,i,n){if("boolean"==typeof this.loadingPanelODTSupport&&!this.loadingPanelODTSupport)return;100===this.panelView.value&&this.resetPanelView(),e&&(this.panelViewTitle.innerHTML=e),t&&(this.panelViewMainSubtitle.innerHTML=t);let r="";i&&(r=i),n&&(r+=" "+n),this.panelViewSecondarySubtitle.innerHTML=r,this.panelView.show(),this.panelView.on(),d._addTempStyle();let a=this.panelView.value;"number"==typeof a&&this._manager&&(this.panelView.value=this._manager.computeBarValue(a))},hidePanel:function(e){("boolean"!=typeof this.loadingPanelODTSupport||this.loadingPanelODTSupport)&&(e?(this.panelView.value=100,this.panelView.emphasize="success",setTimeout(()=>{this.panelView&&this.panelView.elements&&Object.keys(this.panelView.elements).length>0&&(this.panelView.off(),this.panelView.hide()),d._removeTempStyle()},400)):this.panelView.off())},setNotificationManager:function(e){this._manager!==e&&(this._manager=e)}}),_=e.extend({_counter:0,_notificationElements:{},_maxLength:4,_notificationCurtainContainer:null,_notificationCurtainContent:null,_notificationCurtainTileTop:null,_notificationCurtainTileMiddle:null,_notificationCurtainHeader:null,_notificationCurtainTitle:null,_notificationCurtainList:null,_notificationCurtainSpinner:null,_notificationCurtainTileBottom:null,_notificationCurtainProgressBar:null,_manager:null,initialize:function(){this._buildView()},dispose:function(){this._deleteView(),this._manager=null,this._counter=0,this._notificationElements={}},setNotificationManager:function(e){this._manager!==e&&(this._manager=e,this._manager)},addNotificationElement:function(e,t,i){var n=!1;if(this._counter<this._maxLength){var r=l.createElement("p",{text:i});r.setAttribute("title",i),r.inject(this._notificationCurtainList),this._notificationElements[e]=r,this._counter++,1===this._counter&&(this._notificationCurtainTitle.innerHTML=t,this._displayView()),n=!0}else n=!1;return n},isNotificationElementDisplayed:function(e){var t=!1;return this._notificationElements[e]&&(t=!0),t},updateNotificationElement:function(e,t,i){this._notificationElements[e]&&(this._notificationElements[e].innerHTML=i,this._notificationElements[e].setAttribute("title",i),this._notificationCurtainTitle.innerHTML=t,this._displayView())},updateProgressBar:function(e){this._notificationCurtainProgressBar.value=void 0!==e?e:0},removeNotificationElement:function(e){this._notificationElements[e]&&(this._notificationElements[e].remove(),delete this._notificationElements[e],this._counter--,0===this._counter&&this._hideView())},_buildView:function(){},_deleteView:function(){if(this._notificationCurtainTileTop&&(this._notificationCurtainTileTop.remove(),delete this._notificationCurtainTileTop),this._notificationCurtainList&&(this._notificationCurtainList.remove(),delete this._notificationCurtainList),this._notificationCurtainTitle&&(this._notificationCurtainTitle.remove(),delete this._notificationCurtainTitle),this._notificationCurtainSpinner&&(this._notificationCurtainSpinner.remove(),delete this._notificationCurtainSpinner),this._notificationCurtainHeader&&(this._notificationCurtainHeader.remove(),delete this._notificationCurtainHeader),this._notificationCurtainTileMiddle&&(this._notificationCurtainTileMiddle.remove(),delete this._notificationCurtainTileMiddle),this._cancelButton&&(this._cancelButton.remove(),delete this._cancelButton),this._notificationCurtainProgressBar&&(this._notificationCurtainProgressBar.remove(),delete this._notificationCurtainProgressBar),this._notificationCurtainTileBottom&&(this._notificationCurtainTileBottom.remove(),delete this._notificationCurtainTileBottom),this._notificationCurtainContent&&(this._notificationCurtainContent.remove(),delete this._notificationCurtainContent),this._notificationCurtainContainer)try{a.removeModal(this._notificationCurtainContainer)}catch(e){}this._notificationCurtainContainer&&(this._notificationCurtainContainer.remove(),delete this._notificationCurtainContainer)},_displayView:function(){this._notificationCurtainContainer.show(),this._notificationCurtainSpinner.show(),this._manager._displayProgressBarInCurtainCounter>0&&this._displayProgressBar(),this._notificationCurtainContent.setAttribute("isVisible","true"),d._addTempStyle()},_hideView:function(){if(this._notificationCurtainContainer&&this._notificationCurtainContent&&this._notificationCurtainTitle)this._notificationCurtainContent.setAttribute("isVisible","false"),d._removeTempStyle(),this._notificationCurtainTitle.innerHTML="",this._notificationCurtainContainer.hide();else{console.error(new Error("VCXNotificationManagerViewInCurtain._hideView: Unexpected behavior! _notificationCurtainContainer is undefined"))}},_displayProgressBar:function(){this._notificationCurtainProgressBar?this._notificationCurtainProgressBar.show():console.warn("this._notificationCurtainProgressBar is undefined or null")},_hideProgressBar:function(){this._notificationCurtainProgressBar?this._notificationCurtainProgressBar.hide():console.warn("this._notificationCurtainProgressBar is undefined or null")}}),C=e.extend({_counter:0,_notificationElements:{},_maxLength:1,_notificationProgressBarContainer:null,_notificationProgressBarContent:null,_notificationProgressBarTile:null,_progressBar:null,_manager:null,initialize:function(){this._buildView()},dispose:function(){this._deleteView(),this._manager=null,this._counter=0,this._notificationElements={}},setNotificationManager:function(e){this._manager!==e&&(this._manager=e,this._manager)},addNotificationElement:function(e,t,i){var n=!1;if(this._counter<this._maxLength){var r=t+" "+i,a=l.createElement("p",{text:r});a.setAttribute("title",r),a.inject(this._notificationProgressBarTile),this._notificationElements[e]=a,this._counter++,1===this._counter&&this._displayView(),n=!0}else n=!1;return n},updateNotificationElement:function(e,t,i){var n=t+" "+i;this._notificationElements[e]&&(this._notificationElements[e].innerHTML=n,this._notificationElements[e].setAttribute("title",n),this._displayView())},removeNotificationElement:function(e){this._notificationElements[e]&&(this._notificationElements[e].remove(),delete this._notificationElements[e],this._counter--,0===this._counter&&this._hideView())},_buildView:function(){if(!this._notificationProgressBarContainer&&this._manager){var e=this._manager.getParentContainer();if(e){this._notificationProgressBarContainer=l.Element("div",{html:"",class:"vcx-Notification-Progress-Bar-Container"}).inject(e).hide(),this._notificationProgressBarContent=l.Element("div",{html:"",class:"vcx-Notification-Progress-Bar-Content"}),this._notificationProgressBarContent.setAttribute("isVisible","false"),this._notificationProgressBarTile=l.Element("div",{text:"",class:"vcx-Notification-Progress-Bar-Tile"}).inject(this._notificationProgressBarContent),this._progressBar=new o({displayStyle:"lite"}).inject(this._notificationProgressBarTile),this._progressBar.infiniteFlag=!0;try{a.createModal(this._notificationProgressBarContainer,this._notificationProgressBarContent)}catch(e){console.error("WebUX/Controls.mweb/ModalContainer/createModal throws an error : VCXWebKernel.css probably not finished to be loaded"),console.error(e)}}}},_deleteView:function(){this._progressBar&&(this._progressBar.remove(),delete this._progressBar),this._notificationProgressBarContent&&(this._notificationProgressBarContent.remove(),delete this._notificationProgressBarContent);try{a.removeModal(this._notificationProgressBarContainer)}catch(e){}this._notificationProgressBarContainer&&(this._notificationProgressBarContainer.remove(),delete this._notificationProgressBarContainer)},_displayView:function(){this._notificationProgressBarContainer.show(),this._notificationProgressBarContent.show(),this._progressBar.show(),this._notificationProgressBarContent.setAttribute("isVisible","true")},_hideView:function(){if(this._notificationProgressBarContainer)this._notificationProgressBarContent.setAttribute("isVisible","false"),this._notificationProgressBarContainer.hide();else{console.error(new Error("VCXNotificationManagerViewInProgressBar._hideView: Unexpected behavior! _notificationProgressBarContainer is undefined"))}}});return d.FDisplayMode={SILENT:1,CONSOLE:2,BUBBLEFLOW:4,PROGRESSBAR:8,CURTAIN:16,BUBBLEFLOWBUTCURTAIN:32},d._addTempStyle=function(){console.warn("adding temporary style");var e=document.querySelector(".xapp-background-image");console.warn(e),e&&(e.style.webkitFilter="blur(5px)",e.style.filter="blur(5px)");var t=document.querySelector(".xapp-app-container");console.warn(t),t&&(t.style.visibility="hidden");var i=document.querySelector(".vcx-Notification-Curtain-Title");i&&(i.style.fontSize="4rem");let n=document.querySelector(".afr-welcome-screen-container");if(n){let e=n.children;for(let t=0;t<e.length;t++){let i=e[t];"IMG"!==i.nodeName&&(i.style.visibility="hidden")}}let r=document.querySelector(".vcx-Notification-LoadingPanel");r&&(r.firstChild.style.backdropFilter="blur(5px)")},d._removeTempStyle=function(){console.warn("removing temporary style");var e=document.querySelector(".xapp-background-image");e&&(e.style.webkitFilter=null,e.style.filter=null);var t=document.querySelector(".xapp-app-container");t&&(t.style.visibility=null);let i=document.querySelector(".afr-welcome-screen-container");if(i){let e=i.children;for(let t=0;t<e.length;t++){e[t].style.visibility=""}}let n=document.querySelector(".vcx-Notification-LoadingPanel");n&&(n.firstChild.style.backdropFilter="")},d.FDisplayModeProgressBarInCurtain={NONE:0,CURRENT:1,SUM:2,MIN:3,MAX:4},d}),define("DS/VCXWebKernel/VCXDRMManager",["UWA/Class"],function(e){"use strict";var t=e.extend({init:function(){},initialize:function(){this._bDisplayWatermark=!1,this._bDisplaySignature=!1,this._bValidSignature=!0,this._bDisplayTree=!0,this._bValidDate=!0,this._bDisplayTimeline=!0,this._bDisplayPropertiesPanel=!0,this._bDisplayScenariosPanel=!0,this._bDisplayPaper=!1},SetDisplayWatermark:function(e){this._bDisplayWatermark=e},GetDisplayWatermark:function(){return this._bDisplayWatermark},SetDisplaySignature:function(e){this._bDisplaySignature=e},GetDisplaySignature:function(){return this._bDisplaySignature},SetValidSignature:function(e){this._bValidSignature=e},GetValidSignature:function(){return this._bValidSignature},SetDisplayTree:function(e){this._bDisplayTree=e},GetDisplayTree:function(){var e=this._experienceBase.getManager("VCXContextManager").getSimulatePlayMode();return("undefined"==typeof widget||!e)&&this._bDisplayTree},SetValidDate:function(e){this._bValidDate=e},GetValidDate:function(){return this._bValidDate},SetDisplayTimeline:function(e){this._bDisplayTimeline=e},GetDisplayTimeline:function(){return this._bDisplayTimeline},SetDisplayPropertiesPanel:function(e){this._bDisplayPropertiesPanel=e},GetDisplayPropertiesPanel:function(){var e=this._experienceBase.getManager("VCXContextManager").getSimulatePlayMode();return("undefined"==typeof widget||!e)&&this._bDisplayPropertiesPanel},SetDisplayScenariosPanel:function(e){this._bDisplayScenariosPanel=e},GetDisplayScenariosPanel:function(){return this._bDisplayScenariosPanel},SetDisplayPaper:function(e){this._bDisplayPaper=e},GetDisplayPaper:function(){return this._bDisplayPaper},GetType:function(){return"VCXDRMManager"}});return t.LitSignatureMode={LIT_SIGNATURE_DISPLAY_AND_BLOCK:0,LIT_SIGNATURE_DISPLAY_AND_PASS:1,LIT_SIGNATURE_NO_DISPLAY:2},t}),define("DS/VCXWebKernel/VCXWebSelectionManager",["DS/Core/Core","DS/CoreEvents/Events","UWA/Class","DS/VCXWebVisu/VCXModifiablesAccess","DS/VCXWebModifiablesServices/VCXModifiablesServices","DS/VCXWebExperienceBase/VCXSceneGraphOverridesServices","DS/SceneGraphOverrides/SceneGraphOverrideSet"],function(e,t,i,n,r,a,o){"use strict";var s=i.extend({postInitialize:function(){this._setComponents={},this.activatePrepicking(!0),this._defaultHLValue=!0;var e=this._experienceBase.getManager("VCXContextManager").getTrapSelectionRequirements();this.setTrapSelection(e.pick,e.prePick),this._excludeParts=!1,this._excludeDressups=!1,this._keepLinkSelectable=!0,this._keepHotspotsSelectable=!0,this._keepAssemblySelectionModeActive=!1,this.original_HLData=null,this.original_PreHLData=null,this._apiCBAddSel=null,this._apiCBRemoveSel=null,this._volatile_persistent_list={},this._WUXEventTokens={},this._WUXEventTokens.VCX_VOLATILE_PERSISTENT_PRE=t.subscribe({event:"VCX_VOLATILE_PERSISTENT_PRE"},e=>{this.isIn(e.component)&&(this._volatile_persistent_list[e.component.GetID()]=e.component,this.removeComponentsFromSelection([e.component]))}),this._WUXEventTokens.VCX_VOLATILE_PERSISTENT_POST=t.subscribe({event:"VCX_VOLATILE_PERSISTENT_POST"},e=>{this._volatile_persistent_list[e.component.GetID()]&&(this.addComponentsToSelection([e.component]),delete this._volatile_persistent_list[e.component.GetID()])}),this._WUXEventTokens.VCX_SELECTION_COMPONENTSLIST_ADD=t.subscribe({event:"VCX_SELECTION_COMPONENTSLIST_ADD"},e=>{if(this._apiCBAddSel){for(var t=[],i=0;i<e.length;i++){var n=e[i];n&&t.push(n.GetID())}this._apiCBAddSel(t)}}),this._WUXEventTokens.VCX_SELECTION_COMPONENTSLIST_REMOVE=t.subscribe({event:"VCX_SELECTION_COMPONENTSLIST_REMOVE"},e=>{if(this._apiCBRemoveSel){for(var t=[],i=0;i<e.length;i++){var n=e[i];n&&t.push(n.GetID())}this._apiCBRemoveSel(t)}}),this._WUXEventTokens.VCX_TEMPORARILY_HIDE_DECORATION=t.subscribe({event:"VCX_TEMPORARILY_HIDE_DECORATION"},e=>{e&&e.viewer&&this.SetHighlightRenderVisibility(e.viewer,!1)}),this._WUXEventTokens.VCX_RESTORE_TEMPORARILY_HIDDEN_DECORATION=t.subscribe({event:"VCX_RESTORE_TEMPORARILY_HIDDEN_DECORATION"},e=>{e&&e.viewer&&this.SetHighlightRenderVisibility(e.viewer,!0)})},unInitialize:function(){for(var i in this._WUXEventTokens)this._WUXEventTokens.hasOwnProperty(i)&&this._WUXEventTokens[i]&&(t.unsubscribe(this._WUXEventTokens[i]),this._WUXEventTokens[i]=null);e.Selection.CSOManager.empty(!1),e.Selection.HSOManager.empty(!1),e.Selection.PSOManager.empty(!1),this._setComponents={},this.filterXSO(),this._apiCBAddSel=null,this._apiCBRemoveSel=null},_setStyleHighlight:function(e,t){var i=e.getHighlightData();let n=this._getStyleHighlight(e),r={...n,...t};return i.colorEnabled=r.colorEnabled,i.haloEnabled=r.haloEnabled,i.outlineEnabled=r.outlineEnabled,i.priority=r.priority,i.visibleAlpha=r.visibleAlpha,e.setHighlightData(r.polite,i),n},_getStyleHighlight:function(e){var t=e.getHighlightData();return{polite:e.advanced,colorEnabled:t.colorEnabled,haloEnabled:t.haloEnabled,outlineEnabled:t.outlineEnabled,priority:t.priority,visibleAlpha:t.visibleAlpha}},setOverrideStyle:function(e,t,i){let n=t?this.PreHLData:this.HLData,r=e&&e.internalSceneGraph&&e.internalSceneGraph&&(t?e.internalSceneGraph.selectionPreHL:e.internalSceneGraph.selectionHL);if(i.polite=r.advanced,!this.original_PreHLData&&t&&(this.original_PreHLData=this._getStyleHighlight(r)),this.original_HLData||t||(this.original_HLData=this._getStyleHighlight(r)),n){let e={...n};return t?this.PreHLData=i:this.HLData=i,e}return this._setStyleHighlight(r,i)},resetOverrideStyle:function(e,t){return this.original_PreHLData&&t?(this.setOverrideStyle(e,t,this.original_PreHLData),!0):!(!this.original_HLData||t)&&(this.setOverrideStyle(e,t,this.original_HLData),!0)},setPreHighlightVisibility:function(e,t){if(t){(i=e&&e.internalSceneGraph&&e.internalSceneGraph&&e.internalSceneGraph.selectionPreHL)&&this.PreHLData&&this._setStyleHighlight(i,this.PreHLData),this.PreHLData=null}else{var i=e&&e.internalSceneGraph&&e.internalSceneGraph&&e.internalSceneGraph.selectionPreHL;!this.PreHLData&&i&&(this.PreHLData=this._setStyleHighlight(i,{polite:i.advanced,colorEnabled:!1,haloEnabled:!1,outlineEnabled:!1,priority:-100}))}},setSelectionVisibility:function(e,t){if(t){(i=e&&e.internalSceneGraph&&e.internalSceneGraph&&e.internalSceneGraph.selectionHL)&&this.HLData&&this._setStyleHighlight(i,this.HLData),this.HLData=null}else{var i=e&&e.internalSceneGraph&&e.internalSceneGraph&&e.internalSceneGraph.selectionHL;!this.HLData&&i&&(this.HLData=this._setStyleHighlight(i,{polite:i.advanced,colorEnabled:!1,haloEnabled:!1,outlineEnabled:!1,priority:-100}))}},SetHighlightRenderVisibility:function(e,i){if(i){if(!this.LockVCXEvents)return;this.setPreHighlightVisibility(e,i),this.setSelectionVisibility(e,i),this.LockVCXEvents=!1}else{if(this.LockVCXEvents)return;this.LockVCXEvents=!0,this.setPreHighlightVisibility(e,i),this.setSelectionVisibility(e,i)}t.publish({event:"VCX_CHANGE_HIGHLIGHTS_VISIBILITY"})},RegisterAddSelectionCB:function(e){this._apiCBAddSel=e},RegisterRemoveSelectionCB:function(e){this._apiCBRemoveSel=e},_getSubStructNameFromComponent:function(e){var t="others";return e.IsKindOf("VCXScenario")?t="scenarios":e.QueryInterface("W3AISGNodeHolder")&&(t="visu"),this._setComponents[t]||(this._setComponents[t]={}),t},GetSelection:function(t){var i=null;return"CSO"===t?i=e.Selection.CSOManager:"HSO"===t?i=e.Selection.HSOManager:"PSO"===t&&(i=e.Selection.PSOManager),i.get()},ProcessComponentsFromSelection:function(e,t){if(t)for(var i=this.GetComponentsFromSelection(e),n=0;n<i.length;n++)t(i[n])},ChangeSelectionForContextual:function(){this.GetComponentsFromSelection("CSO");var e=this.GetComponentsFromSelection("PSO");if(!(e.length<1)){this.addComponentsToSelection(this.GetComponentsFromSelection("PSO"));this.GetComponentsFromSelection("CSO"),this.GetComponentsFromSelection("PSO")}},GetComponentsFromSelection:function(e){if("CSO"===e)return this.GetComponentsFromCurrentSelection();var t=[],i=this.GetSelection(e);if(void 0===i)return t;for(var r={},a=i.length,o=0;o<a;o++){var s=i[o];if(void 0!==s){var l=this._experienceBase.ComponentsMap.GetComponentFromPathElement(s.pathElement);if(!l){var c=n.BuildCleanedPathElement(s.pathElement);(l=this._experienceBase.ComponentsMap.GetComponentFromPathElement(c))&&l.IsKindOf("VCXDressup_Spec")&&(l=null)}l&&!r[l.GetID()]&&(t.push(l),r[l.GetID()]=l)}}return t},setComponentsAsSelection:function(e,t){if(this._experienceBase.odt){var i=this.GetComponentsFromCurrentSelection();this._logForODTRecord(i,!0)}this._setComponents={},this.addComponentsToSelection(e,!0),t||this.RefreshXSO()},addComponentsToSelection:function(e,i){if(Array.isArray(e)){if(0!==e.length){"boolean"!=typeof i&&(i=!1);var n=[],r=[];if(this._keepAssemblySelectionModeActive){for(var a=0;a<e.length;++a){var o=e[a];if(o&&o.IsKindOf("VCXComponentOccurrenceExt")&&o.IsMesh()){var s,l=o.QueryInterface("VCXIModelNavigable").getParent();l&&(s=l.GetObject())&&(n.push(s),r.push(o))}}n.length<=0&&(n=e),this._addToSelectionCache(n)}else this._addToSelectionCache(e);if(this._componentsJustAdded&&0!==this._componentsJustAdded.length){var c=this._componentsJustAdded.slice(0);this._componentsJustAdded=null,i||this.RefreshXSO(),this.LockVCXEvents||(t.publish({event:"VCX_SELECTION_COMPONENTSLIST_ADD",data:c}),this._keepAssemblySelectionModeActive&&t.publish({event:"VCX_SELECTION_COMPONENTSLIST_REMOVE_FROM_TREE_ASSY_SEL",data:r})),this._experienceBase.odt&&this._logForODTRecord(c,!1)}}}else console.log("[VCXWebSelectionManager] An array is required as first argument of the 'addComponentsToSelection' method.")},removeComponentsFromSelection:function(e,i){if(Array.isArray(e)){if(0!==e.length&&("boolean"!=typeof i&&(i=!1),this._removeFromSelectionCache(e),this._componentsJustRemoved&&0!==this._componentsJustRemoved.length)){var n=this._componentsJustRemoved.slice(0);this._componentsJustRemoved=null,i||this.RefreshXSO(n),this.LockVCXEvents||t.publish({event:"VCX_SELECTION_COMPONENTSLIST_REMOVE",data:n}),this._experienceBase.odt&&this._logForODTRecord(n,!0);var r=this;r.HasActors()||(r.outTimer=window.setTimeout(function(){r.HasActors()||this.LockVCXEvents||t.publish({event:"VCX_SELECTED_ACTORS_EMPTY"})},200))}}else console.log("[VCXWebSelectionManager] An array is required as first argument of the 'removeComponentsFromSelection' method.")},_alterSelectionCache:function(e,t){var i="_removeFromSelectionCache",n="_removeCompChildrenToSelectionCache";t&&(i="_addToSelectionCache",n="_addCompChildrenToSelectionCache");for(var r=0;r<e.length;++r){var a=e[r];if(a){var o=a.QueryInterface("VCXIModifiable"),s=a.QueryInterface("VCXISelectBehavior");if(s){var l=s.GetListForSelection();this[i](l)}else if(o){var c=a.GetID(),p=this._getSubStructNameFromComponent(a);c&&(t&&this._setComponents[p][c]!==a?(this._setComponents[p][c]=a,this._componentsJustAdded||(this._componentsJustAdded=[]),this._componentsJustAdded.push(a)):t||this._setComponents[p][c]!==a||(delete this._setComponents[p][c],this._componentsJustRemoved||(this._componentsJustRemoved=[]),this._componentsJustRemoved.push(a)))}else this[n](a)}}},_addToSelectionCache:function(e){this._alterSelectionCache(e,!0)},_removeFromSelectionCache:function(e){this._alterSelectionCache(e,!1)},_alterSelectionCacheWithCompChildren:function(e,t){for(var i=e.QueryInterface("VCXIModelNavigable"),n=i&&i.getChildren(),r=0;r<n.length;++r){var a=n[r].GetObject(),o=a.GetID();if(o){var s=this._getSubStructNameFromComponent(a);t&&this._setComponents[s][o]!==a?(this._setComponents[s][o]=a,this._componentsJustAdded||(this._componentsJustAdded=[]),this._componentsJustAdded.push(a)):t||this._setComponents[s][o]!==a||(delete this._setComponents[s][o],this._componentsJustRemoved||(this._componentsJustRemoved=[]),this._componentsJustRemoved.push(a))}}},_addCompChildrenToSelectionCache:function(e){this._alterSelectionCacheWithCompChildren(e,!0)},_removeCompChildrenToSelectionCache:function(e){this._alterSelectionCacheWithCompChildren(e,!1)},HasActors:function(){for(var e=this.GetComponentsFromCurrentSelection(),t=0;t<e.length;t++){var i=e[t];if(i.IsDressup||i.IsKindOf("VCXWebComponentOccurrence"))return!0}return!1},HasOccurence:function(){let e=!1;return this.GetComponentsFromCurrentSelection("VCXWebComponentOccurrence",()=>(e=!0,!1)),e},GetComponentsFromCurrentSelection:function(e,t){if("VCXScenario"===e)return this.GetScenariosComponentsFromCurrentSelection();var i=[];for(var n in this._setComponents)if(this._setComponents.hasOwnProperty(n)){var r=this._setComponents[n];for(var a in r)if(r.hasOwnProperty(a)){var o=r[a];if(!o)continue;var s=!0;if(e&&(o.IsKindOf(e)||(s=!1)),s)if(t){if(t(o))return}else i.push(o)}}return i},GetScenariosComponentsFromCurrentSelection:function(){var e=[];if(this._setComponents.scenarios)for(var t in this._setComponents.scenarios)if(this._setComponents.scenarios.hasOwnProperty(t)){var i=this._setComponents.scenarios[t];i&&e.push(i)}return e},GetSGComponentsFromCurrentSelection:function(){var e=[];if(this._setComponents.visu)for(var t in this._setComponents.visu)if(this._setComponents.visu.hasOwnProperty(t)){var i=this._setComponents.visu[t];i&&e.push(i)}return e},isIn:function(e){var t=e,i=(t.QueryInterface("VCXIModifiable"),!1);for(var n in this._setComponents)if(this._setComponents.hasOwnProperty(n)){var r=this._setComponents[n];if(i=i||r.hasOwnProperty(t.GetID()))break}return i},setTrapSelection:function(e,t){"boolean"==typeof e?(this._experienceBase.getManager("VCXContextManager").getMainViewer().setPicking({trapSelection:e,trapPrimitive:!1}),e&&"boolean"==typeof t&&this._experienceBase.getManager("VCXContextManager").getMainViewer().setPrePicking({trapSelection:t,trapPrimitive:!1})):console.warn("[VCXWebSelectionManager] Method setTrapSelection: a boolean is needed as first argument")},activatePrepicking:function(e){this._experienceBase.getManager("VCXContextManager").getMainViewer().setPrePicking({activated:e})},setDefaultHighlightValue:function(e){this._defaultHLValue=e},getDefaultHighlightValue:function(){return this._defaultHLValue},_logForODTRecord:function(e,t){for(var i=[],n=0;n<e.length;++n){var r=e[n];if(!r||"VCXComponentHotspot"!==r.GetType()){var a=r&&r.GetID();a&&i.push(a)}}if("record"===this._experienceBase.odt){var o=this._experienceBase.getManager("VCXODTManager");o._isActivatingSelSetHotspotGr||o.LogAPI(t?"VCXRemoveSelection":"VCXAddSelection",i)}else if("replay"===this._experienceBase.odt)i.length},buildXSOfilter:function(){if(this.excludeDressups||this.excludeParts){var e=[],t=[],i=this._experienceBase.getManager("VCXHotspotManager"),n=this._experienceBase.getManager("VCXContextManager").getRootComponent();if(n){var r=n.QueryInterface("VCXIModelNavigable");r&&r.traverse((n,r,a)=>{var o=!1,s=n.GetObject();!o&&this.keepLinkSelectable&&(o=s.hyperlinkID>=0),!o&&this.keepHotspotsSelectable&&(o=i&&i.GetEnabledHotspotFromComponentID(s.GetID())),s.IsKindOf("VCXComponentOccurrenceExt")?o&&e.push(s):s.IsKindOf("VCXDressup_Spec")&&o&&t.push(s)},null,null)}var a={};this.excludeDressups&&(a.Dressups=t),this.excludeParts&&(a.Parts=e),this.filterXSO(a)}else this.filterXSO()},filterXSO:function(e){var t=e&&e.Dressups;if(!this.dressupsOverrideSet&&t){var i=this._experienceBase.getManager("VCXDressupManager").QueryInterface("W3AISGNodeHolder").giveSGNode(),n=this._experienceBase.getManager("VCXContextManager").getMainViewer().getSceneGraphOverrideSetManager();this.dressupsOverrideSet=new o(i),n.pushSceneGraphOverrideSet(this.dressupsOverrideSet)}if(this.dressupsOverrideSet){if(this.dressupsOverrideSet.deleteOverrides(this.dressupsOverrideSet.getOverrides()),t){var r=[];if(p=this._experienceBase.getManager("VCXContextManager").getRootComponent())(h=p.QueryInterface("VCXIModelNavigable"))&&h.traverse(function(e,i,n){if(e.GetObject().IsKindOf("VCXDressup_Spec")&&t.indexOf(e.GetObject())<0){var a=e.GetObject().QueryInterface("W3AISGNodeHolder");a.getPathElement()&&r.push(a.getPathElement())}},null,null);if(r&&r.length>0)this.dressupsOverrideSet.createOverride({pathes:r,enabled:!0}).setPickability("NOT_PICKABLE")}t||(a.removeSceneGraphOverrideSet(this._experienceBase,this.dressupsOverrideSet,this._experienceBase.getManager("VCXContextManager").getMainViewer()),delete this.dressupsOverrideSet)}var s=e&&e.Parts;if(!this.partsOverrideSet&&s&&(this.partsOverrideSet=a.createAndPushSceneGraphOverrideSet(this._experienceBase,this._experienceBase.getManager("VCXContextManager").getMainViewer())),this.partsOverrideSet){if(this.partsOverrideSet.deleteOverrides(this.partsOverrideSet.getOverrides()),s){for(var l=[],c=0;c<s.length;c++){s[c].QueryInterface("VCXIModelNavigable").traverse(function(e,t,i){e.GetObject().IsKindOf("VCXComponentOccurrenceExt")&&e.GetObject().IsMesh()&&l.indexOf(e.GetObject())<0&&l.push(e.GetObject())},null,null)}var p,h,u=[];if(p=this._experienceBase.getManager("VCXContextManager").getRootComponent())(h=p.QueryInterface("VCXIModelNavigable"))&&h.traverse(function(e,t,i){if(e.GetObject().IsKindOf("VCXComponentOccurrenceExt")&&e.GetObject().IsMesh()&&l.indexOf(e.GetObject())<0){var n=e.GetObject().QueryInterface("W3AISGNodeHolder");n.getPathElement()&&u.push(n.getPathElement())}},null,null);if(u&&u.length>0)this.partsOverrideSet.createOverride({pathes:u,enabled:!0}).setPickability("NOT_PICKABLE")}s||(a.removeSceneGraphOverrideSet(this._experienceBase,this.partsOverrideSet,this._experienceBase.getManager("VCXContextManager").getMainViewer()),delete this.partsOverrideSet)}}});return Object.defineProperty(s.prototype,"componentType",{enumerable:!0,get:function(){return"VCXWebSelectionManager"}}),Object.defineProperty(s.prototype,"excludeDressups",{enumerable:!0,get:function(){return this._excludeDressups},set:function(e){this._excludeDressups=e,this.buildXSOfilter()}}),Object.defineProperty(s.prototype,"excludeParts",{enumerable:!0,get:function(){return this._excludeParts},set:function(e){this._excludeParts=e,this.buildXSOfilter()}}),Object.defineProperty(s.prototype,"keepLinkSelectable",{enumerable:!0,get:function(){return this._keepLinkSelectable},set:function(e){this._keepLinkSelectable=e,this.buildXSOfilter()}}),Object.defineProperty(s.prototype,"keepHotspotsSelectable",{enumerable:!0,get:function(){return this._keepHotspotsSelectable},set:function(e){this._keepHotspotsSelectable=e,this.buildXSOfilter()}}),Object.defineProperty(s.prototype,"keepAssemblySelectionModeActive",{enumerable:!0,get:function(){return this._keepAssemblySelectionModeActive},set:function(e){this._keepAssemblySelectionModeActive=e}}),s}),define("DS/VCXWebKernel/VCXIContextualContent",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/VCXWebKernel/VCXModifiableActorList",["DS/VCXWebExperienceBase/VCXModifiableOccurrenceExperience","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyGroupSet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueLink","DS/VCXWebProperties/VCXPropertyValueMap","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,i,n,r,a,o,s,l){"use strict";return e.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,i){if(i||(i={}),i.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;var n=t.GetValue();if("Actor.Enable"===e)this.GetObject().enable!==n&&(this.GetObject().enable=n);else if("Actor.ListActors"===e){let e=[...this.GetObject().GetArrayActors()];for(var r=t.GetValue(),a=0;a<r.length;a++){for(var o=r[a].GetValue(),s=0;s<e.length;s++){if(e[s]===o){e.splice(s,1);break}}this.GetObject().AddActor(o)}for(a=0;a<e.length;a++)this.GetObject().RemoveActor(e[a])}else{if("Actor.GroupID"!==e){i.fromChildClass=!0;var l=this._parent(e,t,i);return l||console.log("property not found : '"+e+"'"),l}this.GetObject()._groupID=t.GetValue()}return!0},GetProperty:function(e){var t=null;if("Actor.Enable"===e){var i=new a;i.SetValue(this.GetObject().enable),t=new n(new r(e,2,!0,l),i)}else if("Actor.ListActors"===e){var c=new s;let i=this.GetObject().GetArrayActors().map(e=>{let t=new o;return t.SetValue(e),t});c.SetValue(i),(p=new r(e,2,!0,l)).SetVisible(!1),t=new n(p,c)}else if("Actor.GroupID"===e){var p,h=new o,u=this.GetObject()._groupID;u&&h.SetValue(u),(p=new r(e,0,!0,l)).SetVisible(!1),t=new n(p,h)}else t=this._parent(e);return t},GetProperties:function(){var e=new t;return e.AddOrModifyProperty(this.GetProperty("Actor.Name")),e.AddOrModifyProperty(this.GetProperty("Actor.Color")),e.AddOrModifyProperty(this.GetProperty("Actor.Enable")),e.AddOrModifyProperty(this.GetProperty("Actor.ToolTip")),e.AddOrModifyProperty(this.GetProperty("Actor.Hyperlink")),e.AddOrModifyProperty(this.GetProperty("Actor.ListActors")),e}})}),define("DS/VCXWebKernel/VCXComponentMarker",["UWA/Class"],function(e){"use strict";var t=e.extend({init:function(){this._parentScenarioID="",this._timePos=null,this._isMileStone=!1,this._name=null},GetType:function(){return this.componentType},SetName:function(e){this.name!==e&&(this.name=e)},GetName:function(){return this.name},GetTimePos:function(){return this.timePos},IsMilestone:function(){return this.isMileStone},SetParentScenario:function(e){this._parentScenarioID=e},GetParentScenario:function(){return this._parentScenarioID}});return Object.defineProperty(t.prototype,"name",{enumerable:!0,get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e)}}),Object.defineProperty(t.prototype,"timePos",{enumerable:!0,get:function(){return this._timePos},set:function(e){this._timePos=e}}),Object.defineProperty(t.prototype,"isMileStone",{enumerable:!0,get:function(){return this._isMileStone},set:function(e){this._isMileStone=e}}),Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentMarker"}}),t}),define("DS/VCXWebKernel/VCXIMagnetLine",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/VCXWebKernel/VCXModifiableViewActorList",["DS/VCXWebExperienceBase/VCXModifiableViewOccurrenceExperience"],function(e){"use strict";return e.extend({init:function(){this._parent()},getPropertyGroups:function(e){e||(e={}),this._parent(e);this.getGroupPropertiesOrders();return e["Group.Essentials"].removeProperty("Actor.Opacity"),e}})}),define("DS/VCXWebKernel/VCXAMagnetLine",["UWA/Class"],function(e){"use strict";return e.extend({isMagnetizable:function(){return!1}})}),define("DS/VCXWebKernel/VCXEMaterialCache",["require","exports","DS/CAT3DExpMaterialWeb/XCTMaterialHelper"],function(e,t,i){"use strict";return class{constructor(){this._title="",this._pid="",this._image="",this._name="",this._whereApplied=[],this._wasInternal=!1,this._hasDetails=!1,this._isIndexed=!0,this.materialVisu=null}GetType(){return this.componentType}GetIndexingState(){return this._isIndexed}SetIndexingState(e){this._isIndexed=e}populate(e){var t;this._title=e.title,this._name=e.name,this._pid=e.PID,e.whereApplied&&(this._whereApplied=e.whereApplied),this._image=null!==(t=e.image)&&void 0!==t?t:"",this._hasDetails=!0}GetTitle(){return this._title}GetPID(){return this._pid}GetWhereApplied(){return this._whereApplied}GetImage(){return this._image}SetImage(e){this._image=e}GetName(){return this._name}GetID(){return this._object.GetID()}async GetExternalID(){return(await this.GetExternalMaterial()).GetID()}removeComponentFromWhereApplied(e){const t=this._whereApplied.indexOf(e);t>-1&&this._whereApplied.splice(t,1)}addComponentFromWhereApplied(e){-1===this._whereApplied.indexOf(e)&&this._whereApplied.push(e)}GetWhereDefaultApplied(){let e=this.GetInternalMaterial();return e?e.QueryInterface("VCXIMaterialCache").GetWhereDefaultApplied():[]}setFromInternal(){this._wasInternal=!0}getWasFromInternal(){return this._wasInternal}hasDetails(){return this._hasDetails}async getMaterialVisu(){return this.materialVisu?this.materialVisu:this.materialVisuP?this.materialVisuP:(this.materialVisuP=this._getMaterialVisu(),this.materialVisuP)}async _getMaterialVisu(){return this.materialVisu=await this._object.QueryInterface("CATI3DXMaterialAsset").getMaterial(),this.updateMaterialVisu(),this.materialVisu}updateMaterialVisu(){if(!this.materialVisu)return;const e=this._object.QueryInterface("CATI3DExperienceObject").GetValueByName("appearance");let t=[],n=[];if(localStorage.getItem("VCX_TweakingMaterial"))n=e.QueryInterface("CATI3DExpVCXObjectConvertor").getTab();else{const t=e.QueryInterface("CATI3DExperienceObject").ListVariables();let i=["_varName","linktomaterial"];t.forEach(e=>{i.includes(e)||n.push({variableName:e})})}n.forEach(n=>{t.push({name:n.variableName,parameterID:n.variableName,type:i._getMaterialVariableType(n.variableName,e),value:localStorage.getItem("VCX_TweakingMaterial")?this._getMaterialVariableValue(n.propertyName,e):i._getMaterialVariableValue(n.variableName,e)})});let r=this._object.QueryInterface("CATI3DXAssetHolder")._getCache().material_extra_parameters;i.applyJop(this.materialVisu,{material_appearance:{reference_material_parameters:t,applied_material_parameters:[]},version:2},{reference_material_parameters:r,applied_material_parameters:void 0})}_getMaterialVariableValue(e,t){let i=t.QueryInterface("VCXIModifiable").GetProperty(e).GetPropertyValue();switch(i.GetType()){case"VCXPropertyValueFloat":case"VCXPropertyValueString":case"VCXPropertyValueBoolean":return i.GetValue();case"VCXPropertyValueColor":return i.GetValue().GetRGBA();case"VCXPropertyValuePoint":return i.GetValue().toArray()}}}}),define("DS/VCXWebKernel/VCXICuttableObject",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/VCXWebKernel/VCXActorDocManager",["UWA/Class","DS/VCXWebIO/VCXFileServices"],function(e,t){"use strict";var i=e.extend({init:function(){this._mapDataB64=[]},Build:function(){this._experienceBase.getManager("VCXDocManager").actorDocManager=this},GetType:function(){return this.componentType},RemoveDocument:function(e){delete this._mapDataB64[e]},AddDocToBase64Map:function(e,i,n){if(void 0===n){var r=this,a=i.GetValueURL().GetValue(),o=i.GetFileName().GetValue();t.BlobURLToBase64(a,o,function(e,t){e&&(r._mapDataB64[t]=e)},e)}else this._mapDataB64[e]=n}});return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXActorDocManager"}}),i}),define("DS/VCXWebKernel/VCXIMaterialCache",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/VCXWebKernel/ExpTrackManager_Spec",["UWA/Class"],function(e){"use strict";var t=e.extend({init:function(){},GetType:function(){return this.componentType}});return Object.defineProperty(t.prototype,"componentType",{enumerable:!0,get:function(){return"ExpTrackManager_Spec"}}),t}),define("DS/VCXWebKernel/VCXModifiableActorDocManager",["UWA/Core","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebProperties/VCXPropertyValueBin","DS/VCXWebProperties/VCXPropertyValueInt","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValuePath","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueDocId","DS/VCXWebIO/VCXFileServices","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,i,n,r,a,o,s,l,c,p,h,u,d){"use strict";return t.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,i){if(i||(i={}),i.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;switch(e){case"DocManager.defaultIndex":var n=this.GetObject()._experienceBase.getManager("VCXDocManager");console.log("DocManager.defaultIndex = "+t.GetValue()),n.SetDefaultImageIndex(t.GetValue());break;case"DocManager.documents":console.log("Initialization of DocManager from VCXModifiableActorDocManager"),console.log("onchange property with DocManager.documents");n=this.GetObject()._experienceBase.getManager("VCXDocManager");if(t instanceof a)for(var r=0;r<t._value.length;r++){var o=t._value[r];if(o){var s=new c;o.GetValueAtIndex(0)&&s.SetPathType(o.GetValueAtIndex(0)),o.GetValueAtIndex(2)&&s.SetFileName(o.GetValueAtIndex(2)),o.GetValueAtIndex(3)&&s.SetValueLink(o.GetValueAtIndex(3));var h=new p;h.SetValue(!0),s.SetValueBool(h),o.GetValueAtIndex(4)&&s.SetDocIdParent(o.GetValueAtIndex(4));var d=o.GetValueAtIndex(1);s.SetValueURL(d);var f=o.GetValueAtIndex(5);if(f){var _="data:"+d.GetValue()+";base64,"+f.GetValue(),C=u.dataURLToBlob(_),g=window.URL.createObjectURL(C),m=new l;m.SetValue(g),console.log("-------- DOC blobURL ="+g+"\n"),s.SetValueURL(m),!this.GetObject()._experienceBase.getManager("VCXContextManager").IsLocalMode()&&this.GetObject()._experienceBase.getManager("VCXContextManager").getUseResourcesManager()||(n.actorDocManager._mapDataB64[r]=_)}n._map[r]=s}}break;default:return i.fromChildClass=!0,this._parent(e,t,i)}return!0},OnChangePropertiesEnd:function(){},GetProperty:function(e){var t=null;if("DocManager.defaultIndex"===e){var r=new s,c=this.GetObject()._experienceBase.getManager("VCXDocManager");r.SetValue(c.GetDefaultImageIndex()),t=new i(new n(e,n.EBehaviorType.Singleton),r)}else if("DocManager.documents"===e){c=this.GetObject()._experienceBase.getManager("VCXDocManager");for(var p=new a,h=c.NumberOfDoc(),u=0;u<h;u++){var f=c.GetPropPath(u);if(f)if(f.GetValueBool().GetValue()){var _=new a;if(_.SetValueAtIndex(0,f.GetPathType()),_.SetValueAtIndex(2,f.GetFileName()),_.SetValueAtIndex(3,f.GetValueLink()),_.SetValueAtIndex(4,f.GetDocIdParent()),f.GetValueURL().GetValue().indexOf("blob:")>=0){var C=c.actorDocManager._mapDataB64[u];if(C){var g=C.split(";base64,"),m=g[0].split(":")[1],S=new o;S.SetValue(g[1]),_.SetValueAtIndex(5,S);var y=new l;y.SetValue(m),_.SetValueAtIndex(1,y)}else console.log("docmanager : BAD base64 cache !!")}else _.SetValueAtIndex(1,f.GetValueURL());p.SetValueAtIndex(u,_)}}var V=new n(e,n.EBehaviorType.Singleton,!0,d);V.SetVisible(!1),t=new i(V,p)}else t=this._parent(e);return t},GetProperties:function(){var e=this._parent();return!this.GetObject()._experienceBase.getManager("VCXContextManager").IsLocalMode()&&this.GetObject()._experienceBase.getManager("VCXContextManager").getUseResourcesManager()||e.AddOrModifyProperty(this.GetProperty("DocManager.documents")),e.AddOrModifyProperty(this.GetProperty("DocManager.defaultIndex")),e}})}),define("DS/VCXWebKernel/VCXModifiableSelectionManager",["UWA/Core","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebProperties/VCXPropertyValueLink"],function(e,t,i,n,r,a,o){"use strict";return t.extend({init:function(){this._parent()},GetListSelection:function(){return this.GetObject().GetComponentsFromSelection("CSO")},GetProperty:function(e){var t=null;if("SelectionManager.ListCSO"===e){for(var i=this.GetListSelection(),s=[],l=0;l<i.length;l++){var c=i[l].GetID();s.push(c)}var p=new a,h=0;s.sort();for(l=0;l<s.length;l++){c=s[l];var u=new o;u.SetValue(c),p.SetValueAtIndex(h,u),h++}t=new n(new r(e,2),p)}return t},GetProperties:function(){var e=new i;return e.AddOrModifyProperty(this.GetProperty("SelectionManager.ListCSO")),e}})}),define("DS/VCXWebKernel/VCXModifiableHotspot",["DS/VCXWebKernel/VCXModifiableActorList","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueHyperlinkId","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueColor","DS/VCXWebProperties/VCXPropertyValueMap","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,i,n,r,a,o,s,l,c){"use strict";return e.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,i){if(i||(i={}),i.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if("highlight.color"!==e){i.fromChildClass=!0;var n=this._parent(e,t,i);return n||console.log("property not found : '"+e+"'"),n}return this.GetObject().highlight=t.GetValue()[0],!0},OnChangePropertiesEnd:function(){if(this._previousEnableValue!==this.GetProperty("Actor.Enable").GetPropertyValue().Value){this._previousEnableValue=this.GetProperty("Actor.Enable").GetPropertyValue().Value;var e=this.GetObject()._experienceBase.getManager("VCXSelectionManager");e&&e.buildXSOfilter&&e.buildXSOfilter()}this._parent()},GetProperty:function(e){var t=null;if("highlight.color"===e){if(this.GetObject().highlight){var r=new s,a=this.GetObject().highlight.getColorHighlight();a&&r.GetValue().SetThreeColor(a.color);var o=new n(e,2,!0,c);t=new i(o,r)}}else"highlight.color.actors"===e||(t=this._parent(e));return t},GetProperties:function(){var e=this._parent();return this.GetObject()._experienceBase.odt&&(e.AddOrModifyProperty(this.GetProperty("highlight.color")),e.AddOrModifyProperty(this.GetProperty("highlight.color.actors"))),e}})});__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXComponentGroupHotspot",["require","exports","DS/VCXWebKernel/VCXActorList_Spec"],function(e,t,i){"use strict";i=__importDefault(i);class n extends i.default{constructor(){super(),this._bEnable=!1}Build(){var e;return null===(e=this.QueryInterface("VCXISelectBehavior"))||void 0===e||e.SetSelectMode(1),this}}return Object.defineProperty(n.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentGroupHotspot"}}),n}),define("DS/VCXWebKernel/VCXECoveringMaterialCache",["require","exports","DS/VCXWebKernel/VCXEMaterialCache"],function(e,t,i){"use strict";return class extends i{constructor(){super()}async GetExternalMaterial(){return this._object}GetInternalMaterial(){return this._object._experienceBase.ComponentsMap.GetComponentFromID(this._internalMaterial)}setInternalMaterial(e){this._internalMaterial=e}GetWhereApplied(e=!1){let t=super.GetWhereApplied();return!e&&this._internalMaterial?t.concat(this.GetInternalMaterial().QueryInterface("VCXIMaterialCache").GetWhereApplied()):t}}}),define("DS/VCXWebKernel/VCXModifiableSelectionSet",["DS/VCXWebKernel/VCXModifiableActorList","DS/VCXWebProperties/VCXPropertySet"],function(e,t){"use strict";return e.extend({init:function(){this._parent()},GetProperties:function(){var e=new t;return e.AddOrModifyProperty(this.GetProperty("Actor.Name")),e.AddOrModifyProperty(this.GetProperty("Actor.ListActors")),e}})});__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXGroupSelectionSet_Spec",["require","exports","DS/VCXWebKernel/VCXActorList_Spec"],function(e,t,i){"use strict";i=__importDefault(i);class n extends i.default{Build(){var e;return null===(e=this.QueryInterface("VCXISelectBehavior"))||void 0===e||e.SetSelectMode(1),this}AddActor(e){super.AddActor(e);var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);t&&(t.GroupID=this.GetID())}}return Object.defineProperty(n.prototype,"componentType",{enumerable:!0,get:function(){return"VCXGroupSelectionSet_Spec"}}),n});__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXSelectionSet_Spec",["require","exports","DS/VCXWebKernel/VCXActorList_Spec"],function(e,t,i){"use strict";i=__importDefault(i);class n extends i.default{Build(){return this.QueryInterface("VCXISelectBehavior").SetSelectMode(1),this}getManagerName(){return"VCXSelectionSetManager"}}return Object.defineProperty(n.prototype,"componentType",{enumerable:!0,get:function(){return"VCXSelectionSet_Spec"}}),n}),define("DS/VCXWebKernel/VCXModifiableGroupActorList",["DS/VCXWebKernel/VCXModifiableActorList","DS/VCXWebProperties/VCXPropertySet"],function(e,t){"use strict";return e.extend({init:function(){this._parent()},GetProperties:function(){var e=new t;return e.AddOrModifyProperty(this.GetProperty("Actor.ListActors")),e}})}),define("DS/VCXWebKernel/VCXSelectionManager",["DS/Core/Core","DS/VCXWebKernel/VCXWebSelectionManager"],function(e,t){"use strict";var i=t.extend({update:function(e){this._refreshXSORequested&&(this._refreshXSORequested=!1,this._RefreshXSO()),this._parent()},RefreshXSO:function(){this._refreshXSORequested=!0},_RefreshXSO:function(){for(var t=[],i=this.GetSGComponentsFromCurrentSelection(),n=0;n<i.length;++n){var r=i[n].QueryInterface("W3AISGNodeHolder");if(r&&r.getPathElement){var a=r.getPathElement();a&&t.push({pathElement:a})}else console.log("Found a component without sgNode/pathElement in selection from visu.")}var o=this._experienceBase.getManager("VCXSelectManager");o.blockEventCallback("all","SELECTION"),o.blockEventCallback("all","HIGHLIGHT");try{e.Selection.CSOManager.empty(!0),e.Selection.HSOManager.empty(!0),e.Selection.CSOManager.add(t),e.Selection.HSOManager.add(t)}catch(e){console.error(e)}o.unblockEventCallback("all","SELECTION"),o.unblockEventCallback("all","HIGHLIGHT")}});return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXSelectionManager"}}),i}),define("DS/VCXWebKernel/VCXSelectManager",["DS/Core/Core","DS/CoreEvents/Events","DS/VCXWebKernel/VCXCmdChangeSelection","DS/VCXWebVisu/VCXModifiablesAccess","UWA/Class","DS/VCXWebSystem/VCXAdvancedEventService"],function(e,t,i,n,r,a){"use strict";let o=[e.Selection.CSOManager,e.Selection.HSOManager,e.Selection.PSOManager];for(let e of o)e._add=e.add,e.add=function(e){this._add(Array.isArray(e)?e:[e])};var s={add:"onAdd",postAdd:"onPostAdd",preAdd:"onPreAdd",preRemove:"onPreRemove",remove:"onRemove",postRemove:"onPostRemove",preEmpty:"onPreEmpty",empty:"onEmpty"};Object.freeze(s);var l=r.extend({postInitialize:function(){this._subscribeEvents(),this._excludedFromXSOHyperlinksPathes=[],this._componentsToAdd=[],this._componentsToRemove=[],this.blockedCBFlags={SELECTION:1,HIGHLIGHT:2,PREHIGHLIGHT:4},this.blockedCBEvents={add:0,postAdd:0,preAdd:0,preRemove:0,preRemove:0,remove:0,postRemove:0,preEmpty:0,empty:0},this._selectionManager=this._experienceBase.getManager("VCXSelectionManager")},getInitPhase:function(){return 9},unableSelectionInPlayMode:function(){this._experienceBase.getManager("VCXContextManager").getMainViewer().setPicking({activated:!1}),this._experienceBase.getManager("VCXContextManager").getMainViewer().setPrePicking({activated:!1})},blockEventCallback:function(e,t){if("all"===e)for(var i=Object.keys(this.blockedCBEvents),n=0;n<i.length;++n){var r=i[n];this.blockedCBEvents[r]=this.blockedCBEvents[r]|this.blockedCBFlags[t]}else this.blockedCBEvents.hasOwnProperty(e)&&(this.blockedCBEvents[e]=this.blockedCBEvents[e]|this.blockedCBFlags[t])},unblockEventCallback:function(e,t){if("all"===e)for(var i=Object.keys(this.blockedCBEvents),n=0;n<i.length;++n){var r=i[n];this.blockedCBEvents[r]=this.blockedCBEvents[r]&~this.blockedCBFlags[t]}else this.blockedCBEvents.hasOwnProperty(e)&&(this.blockedCBEvents[e]=this.blockedCBEvents[e]&~this.blockedCBFlags[t])},isEventCallbackBlocked:function(e,t){return Boolean(this.blockedCBEvents[e]&this.blockedCBFlags[t])},_subscribeEvents:function(){var t=e.Selection.CSOManager,i=e.Selection.HSOManager,n=e.Selection.PSOManager,r=this,a=function(e,t){var i=s[e];return function(n){r.isEventCallbackBlocked(e,t)||r[i](n,t)}};this._xsoEventSubscrArray={CSO:[],HSO:[],PSO:[]};for(var o=Object.keys(s),l=0;l<o.length;++l){var c=o[l],p=s[c];this._xsoEventSubscrArray.CSO.push(t[p](a(c,"SELECTION"))),this._xsoEventSubscrArray.HSO.push(i[p](a(c,"HIGHLIGHT"))),this._xsoEventSubscrArray.PSO.push(n[p](a(c,"PREHIGHLIGHT")))}},_unsubscribeEvents:function(){var t={CSO:e.Selection.CSOManager,HSO:e.Selection.HSOManager,PSO:e.Selection.PSOManager},i=[];for(this._xsoEventSubscrArray&&(i=Object.keys(this._xsoEventSubscrArray));0!==i.length;){for(var n=0;n<i.length;++n){var r=i[n],a=this._xsoEventSubscrArray[r].pop();t[r].unsubscribe(a),0===this._xsoEventSubscrArray[r].length&&delete this._xsoEventSubscrArray[r]}i=Object.keys(this._xsoEventSubscrArray)}},unInitialize:function(){this._unsubscribeEvents(),this._selectionManager=null},switchSensibilityForPreviewHyperlinks:function(e,t){if(e&&"boolean"==typeof t){var i=n.BuildCleanedPathElement(e);if(i){var r=this._experienceBase.ComponentsMap.GetComponentFromPathElement(i);if(r&&r.QueryInterface){var a=null;if(t)(a=r.QueryInterface("VCXISensible"))&&(a.setSelectable(t),a.setHighlightable(t));else this._experienceBase.getManager("VCXHyperlinkManager").ObjectHasHyperlink(r)&&(a=r.QueryInterface("VCXISensible"))&&(a.setSelectable(t),a.setHighlightable(t))}}}},switchOnSensibilityForAllHyperlinks:function(){for(;0!==this._excludedFromXSOHyperlinksPathes.length;){var e=this._excludedFromXSOHyperlinksPathes.pop();this.switchSensibilityForPreviewHyperlinks(e,!0)}},_storeToAddCompFromPathElement:function(e){var t=n.BuildCleanedPathElement(e),i=this._experienceBase.ComponentsMap.GetComponentFromPathElement(t);if(i&&i.QueryInterface){var r=!1,a=this._experienceBase.getManager("VCXHotspotManager").GetEnabledHotspotFromComponentID(i.GetID(),!0);if(a&&(r=!0,this._experienceBase.getManager("VCXHotspotManager").DeactivateAllHotspots(),this._experienceBase.getManager("VCXHotspotManager").DeactivateAllHotspots(!0),this._experienceBase.getManager("VCXAPIManager").SelectHotspot(a.GetID())),!r){var o=i.QueryInterface("VCXISensible");o&&o.getSelectable()&&(this._selectionManager.isIn(i)||this._componentsToAdd.push(i))}}},_storeToRemoveCompFromPathElement:function(e){var t=n.BuildCleanedPathElement(e),i=this._experienceBase.ComponentsMap.GetComponentFromPathElement(t);i&&this._selectionManager.isIn(i)&&this._componentsToRemove.push(i)},onAdd:function(e,t){var i=null;let n=this._experienceBase.getManager("VCXHyperlinkManager");n&&n.isActive()&&"PREHIGHLIGHT"===t?(i=e).pathElement&&(this.switchSensibilityForPreviewHyperlinks(i.pathElement,!1),this._excludedFromXSOHyperlinksPathes.push(i.pathElement)):"SELECTION"===t&&(i=e).pathElement&&this._storeToAddCompFromPathElement(i.pathElement)},onPostAdd:function(e,n){if("SELECTION"!==n)0!==e.length&&t.publish({event:"VCX_"+n+"_ADD",data:e});else if("SELECTION"===n&&0!==this._componentsToAdd.length){var r=new i(this._selectionManager,!0);r.AddComponentsToSelection(this._componentsToAdd),this._experienceBase.getManager("VCXCommandManager").Do(r),t.publish({event:"VCXActiveCardMATERIAL",data:null})}this._componentsToAdd=[]},onRemove:function(e,t){var i=null;let n=this._experienceBase.getManager("VCXHyperlinkManager");if(n&&n.isActive()&&"PREHIGHLIGHT"===t){var r=null;(i=e).pathElement&&(this.switchSensibilityForPreviewHyperlinks(i.pathElement,!0),r=this._excludedFromXSOHyperlinksPathes.indexOf(i.pathElement),this._excludedFromXSOHyperlinksPathes.splice(r,1))}else"SELECTION"===t&&(i=e).pathElement&&this._storeToRemoveCompFromPathElement(i.pathElement)},onPreAdd:function(e,t){a.publish({event:"VCX_"+t+"_PREADD",data:e})},onPreRemove:function(e,t){a.publish({event:"VCX_"+t+"_PREREMOVE",data:e})},onPostRemove:function(e,n){if("SELECTION"!==n)0!==e.length&&t.publish({event:"VCX_"+n+"_REMOVE",data:e});else if("SELECTION"===n&&this._componentsToRemove&&0!==this._componentsToRemove.length){var r=new i(this._selectionManager,!0);r.RemoveComponentsFromSelection(this._componentsToRemove),this._experienceBase.getManager("VCXCommandManager").Do(r)}this._componentsToRemove=[]},onPreEmpty:function(e,i){this.blockEventCallback("remove",i),t.publish({event:"VCX_"+i+"_PREEMPTY",data:e})},onEmpty:function(e,n){let r=this._experienceBase.getManager("VCXHyperlinkManager");if(r&&r.isActive()&&"PREHIGHLIGHT"===n)this.switchOnSensibilityForAllHyperlinks();else if("SELECTION"===n){var a=this._selectionManager.GetSGComponentsFromCurrentSelection();if(0!==a.length){var o=new i(this._selectionManager,!0);o.RemoveComponentsFromSelection(a),this._experienceBase.getManager("VCXCommandManager").Do(o)}}t.publish({event:"VCX_"+n+"_EMPTY",data:e}),this.unblockEventCallback("remove",n)}});return Object.defineProperty(l.prototype,"componentType",{enumerable:!0,get:function(){return"VCXSelectManager"}}),l}),define("DS/VCXWebKernel/VCXEInternalMaterialCache",["require","exports","DS/VCXWebKernel/VCXEMaterialCache"],function(e,t,i){"use strict";return class extends i{constructor(){super(),this._whereAppliedDefault=[]}async _transformToExternal(){let e=this._object._experienceBase.getManager("VCXCAT3DXModelManager"),t=await e.GetCAT3DXModel().InsertMaterial(this.GetName(),null,this.GetPID());await e.OnEndLoading(!0,{materials:[t,t.QueryInterface("CATI3DExperienceObject").GetValueByName("appearance")]});let i=t.QueryInterface("VCXIMaterialCache");return i.populate({PID:this.GetPID(),whereApplied:[],title:this.GetTitle(),name:this.GetName(),image:this.GetImage()}),this._object._experienceBase.getManager("VCXMaterialManager").addMaterialActorToCache(t),i.setInternalMaterial(this.GetID()),t}async GetExternalMaterial(){let e=this._object._experienceBase.getManager("VCXMaterialManager").getMaterialPLM(this.GetPID());return e&&"CXPCoveringMaterial_Spec"===e.GetType()?e:this._externalP?this._externalP:(this._externalP=this._transformToExternal(),await this._externalP)}populate(e){super.populate(e),this._whereAppliedDefault=[...this.GetWhereApplied()]}GetWhereDefaultApplied(){return this._whereAppliedDefault}GetInternalMaterial(){return this._object}async getMaterialVisu(){return(await this.GetExternalMaterial()).QueryInterface("VCXIMaterialCache").getMaterialVisu()}}});__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWebKernel/VCXComponentHotspot",["require","exports","DS/VCXWebKernel/VCXActorList_Spec"],function(e,t,i){"use strict";i=__importDefault(i);class n extends i.default{constructor(){super(),this._highlight=null,this._alpha=null}AddActor(e){for(var t=!1,i=0;i<this._arrayActors.length;i++){if(this._arrayActors[i]===e){t=!0;break}}if(!t){this._arrayActors.push(e);var n=this._experienceBase.getManager("VCXHotspotManager");n&&n.addComponentToMapPrehighlight(e,this)}}RemoveActor(e){for(var t=0;t<this._arrayActors.length;t++){if(this._arrayActors[t]===e){this._arrayActors.splice(t,1);break}}}get highlight(){return this._highlight}set highlight(e){this._highlight=e}}return Object.defineProperty(n.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentHotspot"}}),n}),define("DS/VCXWebKernel/VCXAPIManager",["DS/CoreEvents/Events","UWA/Class","DS/VCXWebKernel/VCXCmdChangeSelection","DS/VCXWebKernelCommands/VCXCmdChangeTimePos","DS/VCXWebKernel/VCXCmdGoToMarker","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebProperties/VCXPropertyMap","DS/VCXWebExperienceLoader/VCXExperienceSaverBase","DS/VCXWebExperienceLoader/VCXExperienceLoaderBase","DS/VCXWebKernelCommands/VCXCmdChangeVisibility","DS/VCXWebVisibility/VCXIVisibility","DS/Visualization/ThreeJS_DS","DS/Animation/PropertyAnimation"],function(e,t,i,n,r,a,o,s,l,c,p,h,u){"use strict";var d,f=t.extend({initialize:function(){this._experienceSaver=new s,this._experienceLoader=new l,this._experienceLoader.InitLoader(this._experienceBase),this._buildInfo=null,this._mapVerNumbers=new Map,this._mapVerNumbers.set("423","R2021x"),this._mapVerNumbers.set("424","R2022x"),this._mapVerNumbers.set("425","R2023x"),this._mapVerNumbers.set("426","R2024x"),this.frameWindow=this._experienceBase.getManager("VCXContextManager").getFrameWindow(),this.rotationQueue=[],this._isReadyForPlaneRotation=!0,this.ang=0,this.isrotating=!1,this.time=0,this.rotationflag=0,this.pos="",d=this},unInitialize:function(){this._experienceSaver=null,this._experienceLoader=null,this.viewControl=null},GoToScenario:async function(e,t){if(e)return this._experienceBase.getManager("VCXGUIManager").GoToScenarioContext()?new Promise(i=>{this._experienceBase.getManager("VCXExperience").GoToScenarioWithInterpolation(e,()=>{t&&t(),i()})}):void 0},HasAnimation:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(t)return t.HasAnimation();console.log("APIManager:: HasAnimation. Scenario not found.")},AxisRotation:function(e,t,i,n,r){if(d._isReadyForPlaneRotation){return 1==e&&0==d.isrotating?(this.view=this._experienceBase.getManager("VCXContextManager").getMainViewer().currentViewpoint,this.view.rotate=function(e,n,r){if(null!==this.control&&1==r){var a=new function(){var n;n="y"==t||"Y"==t?new h.Vector3(0,1,0):"x"==t||"X"==t?new h.Vector3(0,0,-1.55):"-x"==t||"-X"==t?new h.Vector3(0,0,1.55):"-y"==t||"-Y"==t?new h.Vector3(0,0,3.12):"-z"==t||"-Z"==t?new h.Vector3(-1.6,1,0):new h.Vector3(1.6,2,0),this._orientation=(new h.Quaternion).setFromEuler(n,"XYZ"),this._key1=new h.Quaternion;var r,a,o=0,s=0,l=0;"-x"==t||"-X"==t||"x"==t||"X"==t?o=1*i:"-y"==t||"-Y"==t||"y"==t||"Y"==t?s=1*i:l=1*i,this._key2=(new h.Quaternion).setFromAxisAngle(new h.Vector3(o,s,l),Math.PI/2),this._key3=(new h.Quaternion).setFromAxisAngle(new h.Vector3(o,s,l),Math.PI),this._key4=(new h.Quaternion).setFromAxisAngle(new h.Vector3(o,s,l),3*Math.PI/2),this._duration=e,this.duration=function(){return this._duration},this.valueAt=function(e){r=(new Date).getTime();var t,i,n,o,s=this._duration;let l=e%s/s;return l>=0&&l<.25?(a=(new Date).getTime(),t=this._key1,i=this._key2,o=l/.25):l>=.25&&l<.5?(a=(new Date).getTime(),t=this._key2,i=this._key3,o=(l-.25)/.25):l>=.5&&l<.75?(a=(new Date).getTime(),t=this._key3,i=this._key4,o=(l-.5)/.25):(a=(new Date).getTime(),t=this._key4,i=this._key1,o=(l-.75)/.25),n=new h.Quaternion,h.Quaternion.slerp(t,i,n,o),console.log(a-r),n.multiply(this._orientation)}};d.anim=new u(this.control,"orientation",a),1==n&&d.anim.setLoop(1),0==d.isrotating&&(d.anim.start(),d.isrotating=!0)}},this.view.rotate(1e3*n,r,1),0==r&&(d.isrotating=!1),-1==i&&(d.pos=" Reverse "),d.pos+"Rotation Started along "+t+" axis"):1==e&&1==d.isrotating?"Rotation along an axis already running":0==e&&1==d.isrotating?(d.anim.stop(),d.isrotating=!1,"Rotation along axis Stoped"):"NO Rotations Detected"}return"Rotation along a Plane already running"},start_plane_rotation:function(e,t){e.normalize(),t.normalize(),0==d.time&&(d.time=5.5),d._isReadyForPlaneRotation=!1;var i=Math.acos(t.dot(e))*(180/Math.PI),n=Math.floor(Math.abs(i)),r=i-n,a=0,o=t.cross(e);o.normalize();var s=function(){var e=(new h.Quaternion).setFromAxisAngle(o,-d.time*(Math.PI/180)),t=n-a;if(t>=d.time?e.setFromAxisAngle(o,-d.time*(Math.PI/180)):t<d.time?e.setFromAxisAngle(o,-t*(Math.PI/180)):a>n&&e.setFromAxisAngle(o,-r*(Math.PI/180)),d.viewControl&&d.viewControl.orientation.multiplyQuaternions(e,d.viewControl.orientation.clone()),d.viewControl&&d.viewControl.update(),d.frameWindow.getViewer().render(),0!=d.rotation_flag)return(n=360)-a>=d.time?0!=d.loop_flag?a=d.time:a+=d.time:a=360,a<360?void requestAnimationFrame(s):(d._isReadyForPlaneRotation=!0,"Rotation Ended")};s()},PlaneRotation:function(e,t,i,n,r){if(0==d.isrotating){var a,o={};d.frameWindow=d._experienceBase.getManager("VCXContextManager").getFrameWindow(),d.viewpoint=d._experienceBase.getManager("VCXContextManager").getFrameWindow().getViewpoint(),d.viewControl=d.viewpoint.getControl(),d.loop_flag=r,d.rotation_flag=e,d.ang=360,d._isReadyForPlaneRotation?(n>0&&(d.time=6/n),-1==i?"v"==t||"V"==t?(o={from:d.viewpoint.getSightDirection(),to:d.viewpoint.getUpDirection()},a="Rotation in Vertical(-) Direction Started"):"h"!=t&&"H"!=t||(o={from:d.viewpoint.getSightDirection(),to:d.viewpoint.getSightDirection().clone().cross(d.viewpoint.getUpDirection())},a="Rotation in Horizontal(-) Direction Started"):"v"==t||"V"==t?(o={from:d.viewpoint.getSightDirection(),to:d.viewpoint.getUpDirection().multiplyScalar(-1)},a="Rotation in Vertical Direction Started"):"h"!=t&&"H"!=t||(o={from:d.viewpoint.getSightDirection(),to:d.viewpoint.getUpDirection().cross(d.viewpoint.getSightDirection())},a="Rotation in Horizontal Direction Started"),o.from&&o.to&&d.start_plane_rotation(o.from,o.to)):a="Rotation along a Plane already running "}else a="Rotation along an Axis already Running";return a},StopRotation:function(){return 1==d.rotation_flag?(d.rotation_flag=0,d._isReadyForPlaneRotation=!0,"Rotation along plane Stoped"):this.AxisRotation(0)},PlayAnimation:async function(t){return new Promise(i=>{var n=this,r=this._experienceBase.getManager("VCXScenarioManager"),a=r.GetCurrentScenario();if(t){if(t===a&&this._experienceBase.getManager("VCXScenarioManager").GetIsPlayingCurrentScenario())return}else t=a;var o=this._experienceBase.ComponentsMap.GetComponentFromID(t);o||console.log("VCXAPIManager : NO scenario for PlayAnimation");var s=function(){if(o.HasAnimation()){e.publish({event:"VCX_START_PLAY"});var t=n._experienceBase.getManager("VCXContextManager");t&&("0"==t.getUrlVars().boost||o.BuildAnimatedModifiablesSets(r._keyframer)),r.SetIsPlayingCurrentScenario(!0),i()}},l=function(){r.GetCurrentScenario()!==t?n.GoToScenario(t,s):s()};this._experienceBase.getManager("VVCXPulseManager")&&this._experienceBase.getManager("VCXPulseManager").isActive()?this._experienceBase.getManager("VCXPulseManager").StopPulse(l):l()})},PauseAnimation:function(){var t=this._experienceBase.getManager("VCXScenarioManager");t.GetIsPlayingCurrentScenario()&&(t.SetIsPlayingCurrentScenario(!1),e.publish({event:"VCX_PAUSE_PLAY"}))},StopAnimation:function(){var t=this._experienceBase.getManager("VCXScenarioManager");if(t.GetIsPlayingCurrentScenario()){var i=t.GetCurrentScenario(),r=this._experienceBase.ComponentsMap.GetComponentFromID(i).GetCurrentFrame(),a=new n(this._experienceBase.getManager("VCXScenarioManager"));a.ChangeTimePos(0,r),this._experienceBase.getManager("VCXCommandManager").Push(a),t.SetIsPlayingCurrentScenario(!1),e.publish({event:"VCX_STOP_PLAY"})}},GetAnimationTime:function(){var e=this._experienceBase.getManager("VCXScenarioManager").GetCurrentTime();return console.log("API GetAnimationTime : "+e),e},SetReferenceAxisSystemVisisbility:function(e){var t,i=this._experienceBase.getManager("VCXContextManager"),n=i.getMainViewer().getReferenceAxisSystemNode();return"1"===e?1==n._enabled?t="Reference Axis Compass Already On":(i.getMainViewer().setReferenceAxisSystem(!0),t="Reference Axis Compass On"):"0"===e?0==n._enabled?t="Reference Axis Compass Already Off":(i.getMainViewer().setReferenceAxisSystem(!1),t="Reference Axis Compass Off"):t="Invalid Input",i.renderAll(),t},GetAnimationDuration:function(e){var t=0;if(e){var i=this._experienceBase.getManager("VCXScenarioManager");if(i)t=i.GetMaxFrame(e)/i.GetFPS();console.log("API GetAnimationDuration : "+t)}return t},GoToMarker:function(e,t){if(this._experienceBase.ComponentsMap.GetComponentFromID(e)){var i=new r(this._experienceBase.getManager("VCXScenarioManager"),this._experienceBase.getManager("VCXCommandManager"),this._experienceBase.ComponentsMap);i.GoToMarker(e),i.SetCallback(t),this._experienceBase.getManager("VCXCommandManager").Push(i)}},ActivateSelectionSet:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(t){var n=new i(this._experienceBase.getManager("VCXSelectionManager"));n.AddToSelection(t),this._experienceBase.getManager("VCXCommandManager").Do(n)}else console.log("Component selection set not found.")},DeactivateSelectionSet:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(t){var n=new i(this._experienceBase.getManager("VCXSelectionManager"));n.RemoveFromSelection(t),this._experienceBase.getManager("VCXCommandManager").Do(n)}else console.log("Component selection set not found.")},ActivateHotspotOnClick:function(e){this.ActivateHyperlink(e)},ActivateHyperlink:async function(e,t){return new Promise(i=>{const n=()=>{t&&t(),i()};var r=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(r){var a=r.QueryInterface("VCXIModifiable");this._experienceBase.getManager("VCXHyperlinkManager").OpenHyperlink(a,n)}else console.log("Component not found.")})},SelectHotspot:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);t?(this._experienceBase.getManager("VCXHotspotManager").ActivateHotspotFromTree(t),this._experienceBase.getManager("VCXContextManager").renderAll()):console.log("Component hotspot not found.")},DeselectHotspot:function(e){var t=this._experienceBase.ComponentsMap.GetComponentFromID(e);t?(this._experienceBase.getManager("VCXHotspotManager").DeactivateHotspotFromTree(t),this._experienceBase.getManager("VCXContextManager").renderAll()):console.log("Component hotspot not found.")},RegisterAddSelectionCB:function(e){this._experienceBase.getManager("VCXSelectionManager").RegisterAddSelectionCB(e)},RegisterRemoveSelectionCB:function(e){this._experienceBase.getManager("VCXSelectionManager").RegisterRemoveSelectionCB(e)},RegisterMarkerSequenceCB:function(e){this._experienceBase.getManager("VCXMarkerManager").RegisterMarkerSequenceCB(e)},GetAllHotspots:function(){for(var e={},t=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentHotspot"),i=0;i<t.length;i++){var n=t[i];if(n){var r=n.GetArrayActors();e[n.GetID()]=r}}return e},GetSelectedObjects:function(){for(var e=[],t=this._experienceBase.getManager("VCXSelectionManager").GetComponentsFromCurrentSelection(),i=0;i<t.length;i++){var n=t[i];n&&e.push(n.GetID())}return e},ChangeProperties:function(e){var t=this._experienceLoader.LoadPropMap(e),i=new a(this._experienceBase.getManager("VCXScenarioManager"),this._experienceBase.getManager("VCXCommandManager"));i.ChangePropertiesFromMap(t),this._experienceBase.getManager("VCXCommandManager").Do(i)},GetProperties:function(e,t){var i=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(i){var n=new o,r=i.QueryInterface("VCXIModifiable");if(t){var a=r.GetProperty(t);a&&n.AddOrModifyProperty(r.GetHashing(),a)}else{var s=r.GetProperties();n.AddOrModifyPropertySet(r.GetHashing(),s)}return this._experienceSaver._PropMapToJson(this._experienceBase,n)}console.log("Object not found")},ActivateTooltipDisplayOnPartHover:function(e){if(this._experienceBase){var t=this._experienceBase.getManager("VCXGUIManager");t&&t.setTooltipDisplay(!0)}},DeactivateTooltipDisplayOnPartHover:function(e){if(this._experienceBase){var t=this._experienceBase.getManager("VCXGUIManager");t&&t.setTooltipDisplay(!1)}},SetPreventPartsFromBeingSelectable:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").excludeParts=e)},GetPreventPartsFromBeingSelectable:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").excludeParts},SetPreventCollaborativeActorsFromBeingSelectable:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").excludeDressups=e)},GetPreventCollaborativeActorsFromBeingSelectable:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").excludeDressups},SetKeepLinkSelectable:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable=e)},GetKeepLinkSelectable:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable},SetKeepHotspotsSelectable:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable=e)},GetKeepHotspotsSelectable:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable},SetKeepAssemblySelectionModeActive:function(e){this._experienceBase&&(this._experienceBase.getManager("VCXSelectionManager").keepAssemblySelectionModeActive=e)},GetKeepAssemblySelectionModeActive:function(){return this._experienceBase&&this._experienceBase.getManager("VCXSelectionManager").keepAssemblySelectionModeActive},GetAllActors:function(e){var t,i,n=[],r=!1;""===e&&(r=!0);var a,o=e.toLowerCase();if(r||"mesh"===o)for(var s=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentOccurrenceExt"),l=0;l<s.length;++l){var c=s[l];c&&(c.IsMesh()&&n.push(c.GetID()))}if((r||"collab"===o)&&(i=this._experienceBase.ComponentsMap.GetComponentFromType("VCXDressup_Spec")),(r||"pmi"===o)&&(t=this._experienceBase.ComponentsMap.GetComponentFromType("VCXComponentCompositePmi")),i&&t?a=i.concat(t):i?a=i:t&&(a=t),a)for(l=0;l<a.length;++l){var p=a[l];p&&n.push(p.GetID())}return n},SelectActors:function(e){for(var t=[],n=0;n<e.length;++n){var r=this._experienceBase.ComponentsMap.GetComponentFromID(e[n]);r&&t.push(r)}var a=new i(this._experienceBase.getManager("VCXSelectionManager"));t&&t.length<=0?a.SetSelection(null):a.AddComponentsToSelection(t),this._experienceBase.getManager("VCXCommandManager").Do(a)},ZoomFitAll:function(e){var t=this._experienceBase.getManager("VCXUserInputControllerManager");t&&t.ZoomFitSelection(e)},SetVisibility:function(e,t){for(var i=[],n=0;n<e.length;++n){var r=this._experienceBase.ComponentsMap.GetComponentFromID(e[n]);if(r)r.QueryInterface("VCXIVisibility")&&i.push(r)}if(0!==i.length){var a=new c(this._experienceBase.getManager("VCXScenarioManager"),this._experienceBase.ComponentsMap,this._experienceBase.getManager("VCXCommandManager")),o=p.EVisState.Hidden;t&&(o=p.EVisState.Visible),a.ChangeVisibility(i,o),this._experienceBase.getManager("VCXCommandManager").Push(a)}},GetVisibility:function(e){var t=-1,i=this._experienceBase.ComponentsMap.GetComponentFromID(e);if(!i)return t;var n=i.QueryInterface("VCXIVisibility");if(n){var r=n.GetVisibility();r===p.EVisState.Hidden?t=0:r===p.EVisState.Visible&&(t=1)}return t},GetViewport:function(){var e=this._experienceBase.ComponentsMap.GetComponentFromType("VCXViewport_Spec");if(e&&e.length>0)return e[0].GetID()}});return Object.defineProperty(f.prototype,"componentType",{enumerable:!0,get:function(){return"VCXAPIManager"}}),Object.defineProperty(f.prototype,"preventCollaborativeActorsFromBeingSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").excludeDressups},set:function(e){this._experienceBase.getManager("VCXSelectionManager").excludeDressups=e}}),Object.defineProperty(f.prototype,"preventPartsFromBeingSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").excludeParts},set:function(e){this._experienceBase.getManager("VCXSelectionManager").excludeParts=e}}),Object.defineProperty(f.prototype,"keepLinkSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable=e}}),Object.defineProperty(f.prototype,"keepHotspotSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable=e}}),Object.defineProperty(f.prototype,"keepAssemblySelectionModeActive",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepAssemblySelectionModeActive},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepAssemblySelectionModeActive=e}}),f}),define("DS/VCXWebKernel/VCXComposerAPIManager",["UWA/Core","DS/CoreEvents/Events","DS/VCXWebKernelCommands/VCXCmdChangeTimePos","DS/VCXWebKernel/VCXAPIManager","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebVisu/VCXModifiablesAccess"],function(e,t,i,n,r,a){"use strict";var o=n.extend({initialize:function(){this._parent(),this._APIMngr=this._experienceBase.getManager("VCXAPIManager"),this._versionInfo=null,this._ApiCBEndSce=null,this._WUXEventTokens={};var e=this;this._WUXEventTokens.VCX_END_TRANSITION=t.subscribe({event:"VCX_END_TRANSITION"},function(t){e._ApiCBEndSce&&t._name&&t._ID&&e._ApiCBEndSce(t._name,t._ID)})},unInitialize:function(){this._parent(),this._APIMngr=null,this._ApiCBEndSce=null},GoToScenario:function(e,t){this._APIMngr.GoToScenario(e,t)},PlayAnimation:function(e){if(null==e&&(e="AnimationSmgID",this.GetAnimationTime()>=this.GetAnimationDuration(e))){var t=new i(this._experienceBase.getManager("VCXScenarioManager"));t.ChangeTimePos(0,!1),this._experienceBase.getManager("VCXCommandManager").Push(t)}this._APIMngr.PlayAnimation(e)},HasAnimation:function(e){return null==e&&(e="AnimationSmgID"),this._APIMngr.HasAnimation(e)},PauseAnimation:function(){return this._APIMngr.PauseAnimation()},StopAnimation:function(){return this._APIMngr.StopAnimation()},GetAnimationTime:function(){return this._APIMngr.GetAnimationTime()},GetAnimationDuration:function(e){return null==e&&(e="AnimationSmgID"),this._APIMngr.GetAnimationDuration(e)},GoToView:function(e,t){this._APIMngr.GoToScenario(e,t)},GoToMarker:function(e,t){this._APIMngr.GoToMarker(e,t)},ActivateSelectionSet:function(e){this._APIMngr.ActivateSelectionSet(e)},DeactivateSelectionSet:function(e){this._APIMngr.DeactivateSelectionSet(e)},SelectHotspot:function(e){this._experienceBase.ComponentsMap.GetComponentFromID(e)&&(this._experienceBase.getManager("VCXHotspotManager").DeactivateAllHotspots(),this._experienceBase.getManager("VCXHotspotManager").DeactivateAllHotspots(!0),this._APIMngr.SelectHotspot(e))},DeselectHotspot:function(e){this._APIMngr.DeselectHotspot(e)},RegisterAddSelectionCB:function(e){this._APIMngr.RegisterAddSelectionCB(e)},RegisterRemoveSelectionCB:function(e){this._APIMngr.RegisterRemoveSelectionCB(e)},RegisterMarkerSequenceCB:function(e){this._APIMngr.RegisterMarkerSequenceCB(e)},RegisterEndScenarioCB:function(e){this._ApiCBEndSce=e},RegisterDoubleClickCB:function(e){this._experienceBase.getManager("VCXUserInputControllerManager").RegisterDoubleClickCB(e)},GetAllHotspots:function(){return this._APIMngr.GetAllHotspots()},ChangeAntialiasing:function(e){const t={NoAA:0,SMAA:1,FXAA:3,FSAA:4,SSAA:6,TAA:8};let i=this._experienceBase.getManager("VCXContextManager"),n=this._experienceBase.getManager("VCXContextManager").getActiveViewport();if(n&&i){let a=n.QueryInterface("VCXIModifiable");a&&a.OnChangeProperty("Environment.AA",new r(t[e])),i.applyToViewers(function(t){t.setAntiAliasing(e)}),i.renderAll()}else console.error("Change Antialiasing API Failed")},GetAntialiasingMode:function(){let e=null,t=this._experienceBase.getManager("VCXContextManager");return t?(t.applyToViewers(function(t){e=t.antiAliasing}),e):(console.error("Get Antialiasing API Failed"),"Something went wrong")},GetSelectedObjects:function(){return this._APIMngr.GetSelectedObjects()},ChangeProperties:function(e){this._APIMngr.ChangeProperties(e)},GetProperties:function(e,t){var i=this._APIMngr.GetProperties(e,t),n=i[e];for(var r in n)if(n.hasOwnProperty(r)){var o=n[r]?n[r].name:"",s=n[r]?n[r].value:null;if("Actor.ToolTip"===o||"Collab.Text"===o){var l=a.ValuateLinkedProperties(s,this._experienceBase,e,e,null);i[e][r].value=l}}return i},ActivateTooltipDisplayOnPartHover:function(){this._APIMngr.ActivateTooltipDisplayOnPartHover()},DeactivateTooltipDisplayOnPartHover:function(){this._APIMngr.DeactivateTooltipDisplayOnPartHover()},SetPreventPartsFromBeingSelectable:function(e){this._APIMngr.SetPreventPartsFromBeingSelectable(e)},GetPreventPartsFromBeingSelectable:function(){return this._APIMngr.GetPreventPartsFromBeingSelectable()},SetPreventCollaborativeActorsFromBeingSelectable:function(e){this._APIMngr.SetPreventCollaborativeActorsFromBeingSelectable(e)},GetPreventCollaborativeActorsFromBeingSelectable:function(){return this._APIMngr.GetPreventCollaborativeActorsFromBeingSelectable()},SetKeepLinkSelectable:function(e){this._APIMngr.SetKeepLinkSelectable(e)},GetKeepLinkSelectable:function(){return this._APIMngr.GetKeepLinkSelectable()},SetKeepHotspotsSelectable:function(e){this._APIMngr.SetKeepHotspotsSelectable(e)},GetKeepHotspotsSelectable:function(){return this._APIMngr.GetKeepHotspotsSelectable()},SetKeepAssemblySelectionModeActive:function(e){this._APIMngr.SetKeepAssemblySelectionModeActive(e)},GetKeepAssemblySelectionModeActive:function(){return this._APIMngr.GetKeepAssemblySelectionModeActive()},GetAllActors:function(e){return this._APIMngr.GetAllActors(e)},SelectActors:function(e){return this._APIMngr.SelectActors(e)},ZoomFitAll:function(e){return this._APIMngr.ZoomFitAll(e)},GetViewport:function(){return this._APIMngr.GetViewport()},SetVisibility:function(e,t){return this._APIMngr.SetVisibility(e,t)},GetVisibility:function(e,t){return this._APIMngr.GetVisibility(e)},SetReferenceAxisSystemVisisbility:function(e){return this._APIMngr.SetReferenceAxisSystemVisisbility(e)},StartRotation:function(e){var t,i,n=null,r=null,a=null,o=null;return 1==e.length?(n=e.pop(),"No Error"==(i=this.ErrorCheck(n,r,a,o))?1==this.AxisCheck(n)?t=this._APIMngr.AxisRotation(1,n,1,2,1):2==this.AxisCheck(n)&&(t=this._APIMngr.PlaneRotation(1,n,1,2,1)):t=i):2==e.length?(r=1*e.pop(),n=e.pop(),"No Error"==(i=this.ErrorCheck(n,r,a,o))?1==this.AxisCheck(n)?-1!=r&&1!=r||(t=this._APIMngr.AxisRotation(1,n,r,2,1)):2==this.AxisCheck(n)&&(-1!=r&&1!=r||(t=this._APIMngr.PlaneRotation(1,n,r,2,1))):t=i):3==e.length?(a=1*e.pop(),r=1*e.pop(),n=e.pop(),"No Error"==(i=this.ErrorCheck(n,r,a,o))?1==this.AxisCheck(n)?(-1==r||1==r)&&a>0&&(t=this._APIMngr.AxisRotation(1,n,r,a,1)):2==this.AxisCheck(n)&&(-1==r||1==r)&&a>0&&(t=this._APIMngr.PlaneRotation(1,n,r,a,1)):t=i):4==e.length&&(o=1*e.pop(),a=1*e.pop(),r=1*e.pop(),n=e.pop(),"No Error"==(i=this.ErrorCheck(n,r,a,o))?1==this.AxisCheck(n)?0!=o&&1!=o||!(a>0)||-1!=r&&1!=r||(t=this._APIMngr.AxisRotation(1,n,r,a,o)):2==this.AxisCheck(n)&&(0!=o&&1!=o||!(a>0)||-1!=r&&1!=r||(t=this._APIMngr.PlaneRotation(1,n,r,a,o))):t=i),t},StopRotation:function(){return this._APIMngr.StopRotation()},AxisCheck:function(e){return"x"==e||"-x"==e||"y"==e||"-y"==e||"z"==e||"-z"==e||"X"==e||"-X"==e||"Y"==e||"-Y"==e||"Z"==e||"-Z"==e?1:"h"==e||"H"==e||"V"==e||"v"==e?2:0},ErrorCheck:function(e,t,i,n){return null!=e&&0==this.AxisCheck(e)?"Please Enter Valid Rotation Axis/Plane":null!=t&&-1!=t&&1!=t?"Please Enter Valid Rotation Direction":null!=i&&i<=0?"Please Enter Valid time multiplier":null!=n&&0!=n&&1!=n?"Please Enter Valid Loop Flag":"No Error"},FetchInformation:function(e){if(this._experienceBase.getManager("VCXContextManager").getIfStanAlonePlayerIsInDevMode()){var t=e.lastIndexOf("/"),i=e.slice(0,t);t=i.lastIndexOf("/"),t=(i=i.slice(0,t)).lastIndexOf("/");var n=(i=i.slice(0,t))+"/ComposerWebPlayer/version.json",r=new XMLHttpRequest;r.open("GET",n);var a=this;r.onreadystatechange=function(){if(4===r.readyState&&(200===r.status||0===r.status)){var e=r.responseText,t=/{.*{(.*)}.*{(.*)}.(.*)}/,i=t.exec(e),n=i[1],o=/.*"(.*)",.*"(.*)"/.exec(n),s=i[3],l=(t=/([A-Z]{2}).*"(.*)"/).exec(s);a._versionInfo=o[1]+" "+l[1]+" "+l[2],a._buildInfo=o[2]}},r.send()}},AddInformation:function(e,t){if(this._experienceBase.getManager("VCXContextManager").getIfStanAlonePlayerIsInDevMode()){this.AddFileOpenOptions(e,t);var i=e.getElementById("DivLogo"),n=e.getElementById("buildVersion");if(this._versionInfo&&this._buildInfo&&!n){var r=e.createElement("div");r.id="divBuildVersion";var a=this._versionInfo.slice(this._versionInfo.indexOf(".")+1,this._versionInfo.lastIndexOf(".")),o=this._versionInfo.slice(this._versionInfo.lastIndexOf(".")+1),s=a.slice(0,a.indexOf(".")),l=o.slice(o.lastIndexOf(" ")+1),c=o.slice(0,o.indexOf(" "));this._mapVerNumbers&&this._mapVerNumbers.has(s)&&(s=this._mapVerNumbers.get(s));var p=e.createElement("text");p.id="buildVersion";var h="Version: "+s+" FD"+l+" ("+c+")";p.innerHTML=h,r.appendChild(p);var u=e.createElement("br");r.appendChild(u);var d=this._buildInfo.slice(0,this._buildInfo.indexOf(".")),f=this._buildInfo.slice(this._buildInfo.indexOf(".")+1),_=e.createElement("text");_.id="builddate";var C="  Build: "+d+" ("+f+")";_.innerHTML=C,r.appendChild(_),i?i.insertBefore(r,i.childNodes[0]):window.alert(h+"\n"+C)}}},AddFileOpenOptions:function(e,t){var i=e.getElementById("SelectSMG"),n=e.getElementById("BrowseSMG");if(i&&!n){var r=e.createElement("br");i.appendChild(r);var a=e.createElement("a");a.id="BrowseSMG",a.href="#",a.text="Browse SMG file on disk",i.appendChild(a);var o=this;a.onclick=function(){o.OpenFileBrowser(t)}}},OpenFileBrowser:function(e){var t=document.createElement("input");t.type="file",t.id="fileBrowserId",t.click(),console.log("Load smg file"),t.addEventListener("change",function(t){var i=this.files,n=i.length?i[0]:null;if(n&&n instanceof Blob){n.name;var r=new window.FileReader;r.onloadend=function(){var t=r.result,i=new Blob([t],{type:n.type}),a=window.URL.createObjectURL(i),o={experience:{filename:"DS/VCXWebAuthoringApp/VCXWebPlayerExperience"}};o.asset={filename:a,mimetype:"smg",type:"smg",format:"smg",provider:"FILE"},e.loadAsset(o)},r.readAsArrayBuffer(n)}})}});return Object.defineProperty(o.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComposerAPIManager"}}),Object.defineProperty(o.prototype,"preventCollaborativeActorsFromBeingSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").excludeDressups},set:function(e){this._experienceBase.getManager("VCXSelectionManager").excludeDressups=e}}),Object.defineProperty(o.prototype,"preventPartsFromBeingSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").excludeParts},set:function(e){this._experienceBase.getManager("VCXSelectionManager").excludeParts=e}}),Object.defineProperty(o.prototype,"keepLinkSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepLinkSelectable=e}}),Object.defineProperty(o.prototype,"keepHotspotSelectable",{enumerable:!0,get:function(){return this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable},set:function(e){this._experienceBase.getManager("VCXSelectionManager").keepHotspotsSelectable=e}}),o}),define("DS/VCXWebKernel/VCXContextualContentOccurenceExperience",["DS/VCXWebKernel/VCXAContextualContent"],function(e){"use strict";return e.extend({appendContent:function(e,t,i){this._parent(e,t,i),t&&(e.Visibility={type:"button",name:"Dropdown_hide",cmdId:"VCXHideSelectionCmd",index:20},e.CopyStyle={type:"button",name:"CopyStyle",cmdId:"VCXFormatPainterCmd",index:35},e.TransformHack={type:"button",name:"Transform2",cmdId:"VCXTransformHackCmd",index:40},e.RestorePosition={type:"button",name:"RestorePosition",cmdId:"VCXRestoreNeutralPositionCmd",index:50},1===t.length&&(e.ParentSelector={type:"button",name:"ParentSelector",cmdId:"VCXParentSelectorCmd",index:80}))}})}),define("DS/VCXWebKernel/VCXContextualContentOccurenceExt",["DS/VCXWebKernel/VCXContextualContentOccurenceExperience"],function(e){"use strict";return e.extend({appendContent:function(e,t,i){if(this._parent(e,t,i),t&&1===t.length){var n=0,r=0;t.forEach(function(e){e.IsKindOf("VCXComponentOccurrenceComposer")&&e.IsMesh()?n++:r++}),n&&!r&&(e.ApplyNewMaterialOnSelection={type:"button",name:"ApplyNewMaterialOnSelection",cmdId:"VCXApplyNewMaterialOnSelectionCmd",index:30})}let a=[];a.push({type:"PushItem",title:"Add to Selection Set",state:this.GetObject()._experienceBase.getManager("VCXSelectionSetManager").getSelectionSets().length>0?"enabled":"disabled",action:"VCXAddToSelectionSetCmd",fonticon:{content:"wux-ui-3ds-folder-add wux-ui-3ds"}}),a.push({type:"PushItem",title:"Isolate",state:t.length>0?"enabled":"disabled",action:"VCXIsolateCmd",fonticon:{content:"wux-ui-3ds-eye wux-ui-3ds"}}),a.push({type:"PushItem",title:"Select with similar color",action:"VCXSelectSimilarColor",fonticon:{content:"wux-ui-3ds-pipette wux-ui-3ds"}}),a.push({type:"PushItem",title:"Select with similar instance",action:"VCXSelectSimilarInstance",fonticon:{content:"wux-ui-3ds-object-instance-select wux-ui-3ds"}}),e.Menu={type:"menu",name:"Dropdown_hide",cmdId:"VCXMenuCmd",content:a,index:100}}})});