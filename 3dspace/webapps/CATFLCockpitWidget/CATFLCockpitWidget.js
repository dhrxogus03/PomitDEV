define("DS/CATFLCockpitWidget/utils/group.util",[],function(){"use strict";return{getGroupNodeParent:function(e){let t=this,i=e.getParent();return i.getID?i:t.getGroupNodeParent(i)},removeGroupNodesOnEmpty:function(e){let t=this,i=e.getParent();return e.getChildren()&&0!==e.getChildren().length||e.remove(),i.getID?void 0:t.removeGroupNodesOnEmpty(i)}}}),define("DS/CATFLCockpitWidget/components/CreateLogicalItemModal/SAXPLMNew/PLMNewSAXCmd",["DS/ENONewWidget/command/NewContentCommandBase"],function(e){"use strict";return e.extend({defaults:{type:"RFLVPMLogicalReference"},init:function(e){this._parent(e)},getType(){return this.options.options.typeName},execute:function(){this.launchCreationDialog()},launchCreationDialog:function(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getOptions:function(){return this.options}})}),define("DS/CATFLCockpitWidget/utils/model.events.util",["UWA/Core","DS/CoreEvents/ModelEvents"],function(e,t){"use strict";var i={},n=[];return{createAppEventObject:function(e){return i[e]=new t,i[e]},subscribeEvent:function(){},getFLWebModelEventsObj:function(e){return i[e]},publishEvent:function(e){this.getFLWebModelEventsObj(e.userAction).publish({event:e.eventName,data:e.eventData}),this.cleanSubscriptionAndUserAction(e)},cleanSubscriptionAndUserAction:function(e){this.getFLWebModelEventsObj(e.userAction).unsubscribe({event:e.eventName})},deleteAppEventObject:function(e){delete i[e]},addToSubscriptionList:function(e){n.push(e)},getSubscriptionList:function(){return n},removeFromSubscriptionList:function(e){n=n.filter(function(t){return t!==e})},clearSubscriptionList:function(){n=[]}}}),define("DS/CATFLCockpitWidget/utils/search.util",["UWA/Core","UWA/Utils/InterCom","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i){"use strict";var n={initialize:function(){this.socketName="search_socket_"+(new Date).getTime(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var e=this.options();return this.socket.dispatchEvent("RegisterContext",e),this},options:function(t,i,n,o,r,a,s){var l={};return l.title=t,l.mode="furtive",l.app_socket_id=this.socketName,l.widget_id=widget.id,l.default_with_precond=!0,l.show_precond=!1,l.idcard_activated=!1,l.multiSel=!!e.is(r)&&r,l.role=n,i&&(l.precond="",(i=i.split(",")).forEach(function(e,t){0!==t&&(l.precond+=" OR "),l.precond+='flattenedtaxonomies:"types/'+e+'"'})),l.recent_search={types:i},a&&(l.precond?l.precond="( "+l.precond+") AND "+a:l.precond=a),s&&s.length>0&&(l.columns=s),l},destroy:function(){var e={};e.widget_id=widget.id,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect(),delete this.socket},activate:function(e,t,i,n,o,r,a,s){var l=this.options(e,t,i,n,o,a,s);this.callback=r,this.socket.dispatchEvent("RegisterContext",l),this.socket.dispatchEvent("InContextSearch",l)},isAvailable:function(){return e.is(this.socket)},configureSearch:function(e){this.isAvailable()||this.initialize(e)},launchSearch:function(e){var t=e.searchTitle||i.label_search_title;this.activate(t,e.allowedTypes,e.role||"",e.criteria,e.bMultiSel,function(t){e.in_apps_callback(t)},e.additionalQuery,e.selectable)},objectsSelected:function(e){var t,i,n=[];if(this.callback){for(t=0,i=e.length;t<i;t++)n.push(e[t]);this.callback(n)}}};return n.initialize(),n}),define("DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbar",["DS/Tweakers/GeneratedToolbar","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t){"use strict";var i=function(e,t){this.wrapper=e,this.render(t)};return i.prototype.render=function(t){var i={entries:[]};this._addExpandActionEntry(i),this._addCollapseActionEntry(i),this._addExportActionEntry(i),this._addSwitchMatrixActionEntry(i),this._addFilterActionEntry(i);var n=e.prototype.createTreeDocument(i);this.catflGeneratedToolbar=new e({overflowManagement:"dropdown",direction:"horizontal",items:n}),this.catflGeneratedToolbar.inject(t)},i.prototype._addExpandActionEntry=function(e){var i=this;e.entries.push({id:"expAll_btn",dataElements:{typeRepresentation:"functionMenuIconCount",tooltip:t.action_expand,value:{menu:[{type:"PushItem",title:"0",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(0),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=-1}}},{type:"PushItem",title:"1",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(1),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=1}}},{type:"PushItem",title:"2",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(2),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=2}}},{type:"PushItem",title:"3",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(3),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=3}}},{type:"PushItem",title:"4",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(4),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=4}}},{type:"PushItem",title:"N",action:{callback:function(){i.wrapper.trMatrix.setExpandLevel(-1),i.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=0}}}]},icon:{iconName:"flow-tree-expand-down",fontIconFamily:1},count:-1,position:"far",category:"1"}})},i.prototype._addCollapseActionEntry=function(e){e.entries.push({id:"collapse_btn",dataElements:{typeRepresentation:"functionIcon",action:{module:"DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",func:"executeToolbarCmd",argument:{id:"collapse_btn",toolbarCtx:this}},tooltip:t.action_collapse_all,icon:{iconName:"flow-tree-expand-up",fontIconFamily:1},position:"far",category:"1"}})},i.prototype._addExportActionEntry=function(e){e.entries.push({id:"export_btn",dataElements:{typeRepresentation:"functionIcon",action:{module:"DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",func:"executeToolbarCmd",argument:{id:"export_btn",toolbarCtx:this}},tooltip:t.action_export_2_excel,icon:{iconName:"export",fontIconFamily:1},position:"far",category:"2"}})},i.prototype._addSwitchMatrixActionEntry=function(e){e.entries.push({id:"switchMatrix_btn",dataElements:{typeRepresentation:"functionIcon",action:{module:"DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",func:"executeToolbarCmd",argument:{id:"switchMatrix_btn",toolbarCtx:this}},tooltip:t.action_switch_matrix,icon:{iconName:"table-row-column",fontIconFamily:1},position:"far",category:"2"}})},i.prototype._addFilterActionEntry=function(e){e.entries.push({id:"filter_btn",dataElements:{typeRepresentation:"functionIcon",action:{module:"DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",func:"executeToolbarCmd",argument:{id:"filter_btn",toolbarCtx:this}},tooltip:t.action_Filter,icon:{iconName:"filter",fontIconFamily:1},position:"far",category:"3"}})},i}),define("DS/CATFLCockpitWidget/utils/SAXTracker",["DS/Usage/TrackerAPI"],function(e){"use strict";return class{static trackCommandLaunched(e){e&&this.trackPageEvent({eventCategory:"command",eventAction:e,eventLabel:e})}static trackPageEvent({eventCategory:t,eventAction:i,eventLabel:n,eventValue:o}){let r={eventCategory:t||null,eventAction:i||null,eventLabel:n||null,eventValue:o||null,appID:widget.getValue("appId"),tenant:widget.getValue("x3dPlatformId"),scope:"Dashboard"};e.trackPageEvent(r)}}}),define("DS/CATFLCockpitWidget/utils/modelObj.util",["UWA/Class/Model"],function(e){"use strict";var t=e.extend({setup:function(e){this._parent(e)},getID:function(){return this.get("physicalid")},getLabel:function(){return this.get("label")},getType:function(){return this.get("type")},getDisplayName:function(){return this.get("label")},getParent:function(){return this.get("parent")?new t(this.get("parent")):null},getRelationID:function(){return this.get("relID")}});return t}),define("DS/CATFLCockpitWidget/utils/tooltip.util",["DS/Controls/TooltipModel"],function(e){"use strict";return{loadTooltips:function(t){let i=[];return t.forEach(function(t){i[t]=new e,i[t]._properties.allowUnsafeHTMLLongHelp.value=!0,i[t]._properties.mouseRelativePosition.value=!1,i[t].loadFromHelpRscFile("CATFLCockpitWidget/help",t)}),i},setTooltip:function(e,t){if(t.isEmpty())return setTimeout(this.setTooltip.bind(this,e,t),1e3);e.tooltipInfos=t}}}),define("DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow",["DS/Windows/Dialog","DS/Controls/Button","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i){return{createWindow:function(n,o,r,a,s,l){var c=new e({title:n,content:o,width:500,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new t({label:r||i.label_submit,emphasize:"primary",onClick:function(){a(),c.close()}}),Close:new t({label:i.cancel_button,emphasize:"secondary",onClick:function(){s&&"function"==typeof s&&s(),c.close()}})}});return c.addEventListener("close",function(){c.destroy()}),c}}}),define("DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel",["DS/TreeModel/TreeNodeModel"],function(e){"use strict";var t=["RFLPLMFunctionalConnection","RFLVPMLogicalConnection"],i=["RFLPLMFlowExpositionInstance","RFLVPMSystemTypeExpositionInstance","RFLPLMFunctionalConnector","RFLVPMLogicalPort"];function n(t){this.options={grid:{},color:"rgba(0, 0, 0, 0)",isUIActive:!1,relationid:"",physicalid:"",type:"",basetype:"",relationtype:"",virtual:!1},this.options.grid.active_color="rgba(0, 0, 0, 0)",this.options.grid.bi_color="rgba(0, 0, 0, 0)",this.options=UWA.extend(this.options,t),e.call(this,this.options)}function o(e){e._getFilterInfo||(e._getFilterInfo=n.prototype._getFilterInfo.bind(e),e._getChildrenFilterInfo=n.prototype._getChildrenFilterInfo.bind(e),e._removeChildrenFilterInfo=n.prototype._removeChildrenFilterInfo.bind(e),e.filterInChild=n.prototype.filterInChild.bind(e),e.filterOutChild=n.prototype.filterOutChild.bind(e))}return n.prototype=Object.create(e.prototype),n.prototype.getRealPath=function(){var e=this.getPath();return e.length>0&&e[0].isVirtual()&&e.shift(),e},n.prototype.isVirtual=function(){return this.options.virtual},n.prototype.getAttribute=function(e){return"ds6w:label-Instance"===e&&(e="instanceName"),this.getAttributeValue(e)},n.prototype.isConnection=function(){return t.indexOf(this.getBaseType())>=0},n.prototype.isConnector=function(){return i.indexOf(this.getBaseType())>=0},n.prototype.getType=function(){return this.options.type},n.prototype.getBaseType=function(){return this.options.basetype},n.prototype.getRelationType=function(){return this.options.relationtype},n.prototype.getGroups=function(){let e;return e=this.options.merged?this.options.grp:UWA.Utils.splat(this.options.grp)},n.prototype.setID=function(e){this.options.physicalid=e},n.prototype.getID=function(){return this.options.physicalid},n.prototype.getReferenceID=function(){return this.options.physicalid},n.prototype.getRelationID=function(){return this.options.relationid},n.prototype.setRelationID=function(e,t){this.options.relationid=e,this.options.relationtype=t},n.prototype.addChild=function(e,t){if(!Array.isArray(e)){var i=this.getTreeDocument();if(i&&e.options.physicalid&&e.options.physicalid.length>0){var n=i.getRoots()[0];0==Object.keys(i.mappedNodesToIds).length&&n.options.physicalid.length>0&&(i.mappedNodesToIds[n.options.physicalid]=[n]),i.mappedNodesToIds[e.options.physicalid]||(i.mappedNodesToIds[e.options.physicalid]=[]),i.mappedNodesToIds[e.options.physicalid].push(e)}return this._addChild(e,t)}},n.prototype.removeChild=function(t){if(!Array.isArray(t)){var i=this.getTreeDocument();if(i&&t.options.physicalid&&t.options.physicalid.length>0){var n=i.mappedNodesToIds[t.options.physicalid];if(n){for(var o=n.length-1;o>=0;o--){n[o]._id===t._id&&n.splice(o,1)}n.length<=0&&delete i.mappedNodesToIds[t.options.physicalid]}}return Object.create(e.prototype).removeChild.call(this,t)}},n.prototype.getNodesById=function(e){var t={listOfFoundNodes:[]};return this._groupingOptions?this.getChildrenFromGroupById(e,t):this._getNodesById(e,t),t.listOfFoundNodes},n.prototype.getChildrenFromGroupById=function(e,t){this.getChildren().forEach((i,o)=>{i.getID?i._getNodesById(e,t):n.prototype.getChildrenFromGroupById.call(i,e,t)})},n.prototype._getNodesById=function(e,t){var i=!1;if(this.getID()===e)t.listOfFoundNodes.push(this),i=!0;else{var n=this.getChildren();if(n)for(var o=0;n&&o<n.length;o++)i=n[o]._getNodesById(e,t)||i}return i},n.prototype.getSortableAttributeValue=function(e){switch(e){case"label1":case"label2":return this.options.label;case"maturity":return this.options.maturityState;case"owner":return this.options.owner;case"creationDate":return new Date(this.options.creationDate).getTime();case"modificationDate":return new Date(this.options.modificationDate).getTime()}},n.prototype.getNodesByRelId=function(e){var t={listOfFoundNodes:[],foundId:void 0};return this._groupingOptions?this.getChildrenFromGroupByRelId(e,t):this._getNodesByRelId(e,t),t.listOfFoundNodes},n.prototype.getChildrenFromGroupByRelId=function(e,t){this.getChildren().forEach((i,o)=>{i.getID?i._getNodesByRelId(e,t):n.prototype.getChildrenFromGroupByRelId.call(i,e,t)})},n.prototype._getNodesByRelId=function(e,t){var i=this.options.relationid,n=this.getID();if(i===e)t.listOfFoundNodes.push(this),t.foundId=n;else if(n!==t.foundId){var o=this.getChildren();if(o)for(var r=0;r<o.length;r++)o[r]._getNodesByRelId(e,t)}},n.prototype.getOccurencePath=function(e){UWA.is(e,"function")&&e(this);var t=this.options.actualParent||this.getParent();if(this.isRoot()||this.isVirtual()||!t)return[this.options.physicalid];var i=t.getOccurencePath(e);return i.push(this.options.instance.physicalid),i.push(this.options.physicalid),i},n.prototype.setActive=function(e){this.updateOptions({isUIActive:e})},n.prototype.isActive=function(){return this.options.isUIActive},n.prototype.setColor=function(e){this.updateOptions({color:e,grid:{active_color:e}})},n.prototype._removeFilterInfo=function(){delete this.options._filterInfo},n.prototype._removeChildrenFilterInfo=function(){delete this.options._childrenFilterInfo},n.prototype._getFilterInfo=function(e){return!this.options._filterInfo&&Boolean(e)&&(this.options._filterInfo={}),this.options._filterInfo},n.prototype._getChildrenFilterInfo=function(e){return!this.options._childrenFilterInfo&&Boolean(e)&&(this.options._childrenFilterInfo={}),this.options._childrenFilterInfo},n.prototype.filterOut=function(){var e=this.isRoot()?this.getTreeDocument():this.getParent();null!==e&&(o(e),e.filterOutChild(this))},n.prototype.filterIn=function(e){var t=this._getFilterInfo();if(t&&t.parentBeforeFiltering){var i=t.parentBeforeFiltering;o(i),i.filterInChild(this)}if(Boolean(e)){var n,r=this._getChildrenFilterInfo();(n=r&&r.childrenBeforeFiltering?r.childrenBeforeFiltering:this.getChildren())&&n.forEach(function(t){t.filterIn(e)})}},n.prototype.filterOutChild=function(e){var t=this.getChildren();if(t.indexOf(e)<0)throw"Not a child";var i=this._getChildrenFilterInfo(!0);if(!i.childrenBeforeFiltering){i.childrenBeforeFiltering=t&&t.length>0?t.slice(0):[];UWA.is(this._expandState)&&(i.expandStateBeforeFiltering={noExpandState:"noChildren",expandingState:"expanding",partiallyExpandedState:"partiallyExpanded",collapseState:"expanded",expandState:"collapsed"}[this._expandState])}e._getFilterInfo(!0).parentBeforeFiltering=this,UWA.is(this.removeChild,"function")?this.removeChild(e):this.removeRoot(e,!0,!0),UWA.is(this.setState,"function")&&this.setState({state:i.expandStateBeforeFiltering}),i.filteredOutChildren||(i.filteredOutChildren=[]),i.filteredOutChildren.push(e)},n.prototype.filterInChild=function(e){var t=this._getChildrenFilterInfo();if(t){var i=t.childrenBeforeFiltering;if(i){var n=i.indexOf(e);if(n>=0){var o=e._getFilterInfo();if(o&&o.parentBeforeFiltering===this){var r,a=this.getChildren();if(a)for(var s=0;s<a.length;s++){var l=a[s];if(i.indexOf(l)>n){r=l;break}}delete o.parentBeforeFiltering,void 0!==e.options.isRootAttached?!0===e.options.isRootAttached&&this.insertBefore(e,r):this.insertBefore(e,r),UWA.is(this.setState,"function")&&this.setState({state:t.expandStateBeforeFiltering}),e._removeFilterInfo();var c=t.filteredOutChildren.indexOf(e);t.filteredOutChildren.splice(c,1),0===t.filteredOutChildren.length&&this._removeChildrenFilterInfo()}}}}},n.prototype.isDescendantOf=function(e){var t;if(t=e instanceof n?e.getID():e,this.getID()===t)return!0;if(!this.isRoot()){var i=this.getParent();if(i)return i.isDescendantOf(t)}return!1},n}),define("DS/CATFLCockpitWidget/utils/gridview.dnd.util",[],function(){"use strict";return{makeGridViewDroppable:function(e){var t=widget.body.querySelector(".fl-cockpit-app-container"),i=t.getElement("#drop-insert-instance");i||(i=new UWA.createElement("div",{id:"drop-insert-instance",class:"hidden"}).inject(t)),e.contentView.onDragEnterCell=this._onDragEnterGridView.bind(this,e.acceptDrop,e.getTextInvite),e.contentView.onDragEnterRowHeader=this._onDragEnterGridView.bind(this,e.acceptDrop,e.getTextInvite),e.contentView.onDragLeaveCell=this._onDragLeaveGridView.bind(this),e.contentView.onDragLeaveRowHeader=this._onDragLeaveGridView.bind(this),e.contentView.onDropCell=this._onDropGridView.bind(this,e.onDropCallback),e.contentView.onDropRowHeader=this._onDropGridView.bind(this,e.onDropCallback),e.contentView.onDragOverCell=this._onDragOverGridView.bind(this,e.acceptDrop,e.getTextInvite),e.contentView.onDragOverRowHeader=this._onDragOverGridView.bind(this,e.acceptDrop,e.getTextInvite)},_manageDisplayDropInviteGridView:function(e,t){var i=widget.body.querySelector(".fl-cockpit-app-container").getElement("#drop-insert-instance");i&&(e?(t.icon&&t.text&&(i.innerHTML="<i class='wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-"+t.icon+"'></i><h5 class='font-3dsregular insert'>"+t.text+"</h5>"),i.removeClassName("hidden"),i.addClassName("show")):(i.removeClassName("show"),i.addClassName("hidden")))},_onDragOverGridView:function(e,t,i,n){var o=e(i,n),r=t?t(i,n,o):void 0;return r&&this._manageDisplayDropInviteGridView(!0,r),!!o&&(i.preventDefault(),!0)},_onDragEnterGridView:function(e,t,i,n){var o=e(i,n),r=t?t(i,n,o):void 0;return r&&this._manageDisplayDropInviteGridView(!0,r),!0},_onDragLeaveGridView:function(){return this._manageDisplayDropInviteGridView(),!0},_onDropGridView:function(e,t,i){return this._manageDisplayDropInviteGridView(),e(t,i),!1}}}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByRevisionCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/AuthGenericCommands/AppContext","DS/AuthGenericCommands/commands/AuthGenericCmdRevisionUpdate","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","i18n!DS/AuthGenericCommands/assets/nls/AuthGenericCommandsCatalog.json"],function(e,t,i,n,o,r,a){"use strict";var s={RFLVPMLogicalReference:!0,RFLVPMLogicalInstance:!0};return e.extend(t,n,{init:function(e){let t=this;i.isExternalContext=!0,i._is2DContext=function(){return!0},i.isThereARootSelected=function(){return!1},i.getOrdering=function(){return{}},i.refresh=function(e){e.operations&&e.operations.length>0&&o.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-items-on-replace",data:{replaceDetails:e.operations,selectedNodes:t.selectedNodes}})},i.getParentWithChild=function(e){if(null!=e&&e.length){for(var t=[],i=e.length,n=0;n<i;n++)for(var o=e[n],r=0;r<i;r++)if(n!==r)for(var a=e[r],s=a.getParent();s;)s===o&&t.push({parent:o,child:a}),s=s.getParent();return t}return[]},this._parent(e)},defaultOptions:{modeler:"v1/modeler/dsfl",version:"1.0",bAllOrNothing:!1,availability:"multiSelection",commandName:r.action_replace_other_rev,reportTitle:r.action_replace_other_rev_report,commandMode:"FlatList",options:{webInWin:!1,visibleColumn:{IsModified:!0,Title:!0,Revision:!0,Maturity:!0,Type:!0,Responsible:!0,Candidate:!0,ReplaceAction:!0,ExpectedRevision:!0,ExpectedMaturity:!0},EnableByRevision:!0,EnableBubbleup:!1,EnableCompare:!1},remapErrors:[{modeler:"Input parameters are not valid",user:a.ERR_008},{modeler:"You don't have the required license for this command.",user:a.error_license},{modeler:"Embedded Component not supported",user:r.authoring_failed_EC},{modeler:"ERR_FUN092398",user:r.ERR_FUN092398}],isValidSelection:function(e,t){var n={valid:[],invalid:[],status:!0},o=[],r=[];e.forEach(function(e){if(i.isRoot(e)){var t=i.getName(e);r.push({node:e,why:"ROOT",name:t})}else o.push(e)}),i.getParentWithChild(o).forEach(function(e){var t=e.child,n=o.indexOf(t);if(n>-1){o.splice(n,1);var a=i.getName(t);r.push({node:t,why:"CHILD",name:a,parent:e.parent})}}),o.forEach(function(e){var t=e.getType();if(!0===s[t])n.valid.push(e);else{var o=i.getName(e);r.push({node:e,why:"TYPE",name:o})}}),n.invalid=r,n.status=0===r.length,t(n)}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByLatestRevisionCmd",["UWA/Class","DS/ApplicationFrame/Command","DS/AuthGenericCommands/AppContext","DS/AuthGenericCommands/commands/AuthGenericCmdReplaceByLatestRevision","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","i18n!DS/AuthGenericCommands/assets/nls/AuthGenericCommandsCatalog.json"],function(e,t,i,n,o,r,a){"use strict";var s={RFLVPMLogicalReference:!0,RFLVPMLogicalInstance:!0};return e.extend(t,n,{init:function(e){let t=this;i.isExternalContext=!0,i.isThereARootSelected=function(){return!1},i.getOrdering=function(){return{}},i.getParentWithChild=function(e){if(null!=e&&e.length){for(var t=[],i=e.length,n=0;n<i;n++)for(var o=e[n],r=0;r<i;r++)if(n!==r)for(var a=e[r],s=a.getParent();s;)s===o&&t.push({parent:o,child:a}),s=s.getParent();return t}return[]},i._is2DContext=function(){return!0},i.refresh=function(e){e.operations&&e.operations.length>0&&o.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-items-on-replace",data:{replaceDetails:e.operations,selectedNodes:t.selectedNodes}})},this._parent(e)},defaultOptions:{modeler:"v1/modeler/dsfl",version:"1.0",bAllOrNothing:!1,availability:"multiSelection",commandName:r.action_replace_latest_rev,reportTitle:r.action_replace_latest_rev_report,remapErrors:[{modeler:"Input parameters are not valid",user:a.ERR_008},{modeler:"You don't have the required license for this command.",user:a.error_license},{modeler:"Embedded Component not supported",user:r.authoring_failed_EC},{modeler:"ERR_FUN092398",user:r.ERR_FUN092398}],isValidSelection:function(e,t){var i={valid:[],invalid:[],status:!0};e.forEach(function(e){var t=e.getType();s[t]?i.valid.push(e):(i.invalid.push(e),i.status=!1)}),t(i)}}})}),define("DS/CATFLCockpitWidget/utils/config.util",["UWA/Core","UWA/Class/Promise","UWA/Utils/InterCom","DS/WAFData/WAFData","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CATFLCockpitWidget/utils/model.events.util","text!DS/CATFLCockpitWidget/assets/config/webservices.conf.json","text!DS/CATFLCockpitWidget/assets/config/masks.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],function(e,t,i,n,o,r,a,s,l,c,d,u){"use strict";var p={nlsBasicAttributesBO:{},nlsBasicAttributesRel:{},identifiers:JSON.parse(u),masks:JSON.parse(c),localStorageKeys:JSON.parse(d),webservices:JSON.parse(l),mappingType:{}};return p.mappingType[p.identifiers.type_act_logref]={nlsName:p.identifiers.type_logicalref,icon:"I_VPMNavLogical.png"},p.mappingType[p.identifiers.type_act_loginstance]={nlsName:p.identifiers.rel_logicalInstance},p.mappingType[p.identifiers.type_document]={icon:"I_TextDoc22x22.png"},p.mappingType[p.identifiers.type_usecase]={icon:"iconReqTypeUseCase.png"},p.mappingType[p.identifiers.type_requirement]={icon:"iconReqTypeRequirement.png"},p.mappingType[p.identifiers.type_reqSpec]={icon:"iconReqTypeRequirementSpecification.png"},p.mappingType[p.identifiers.type_reqGroup]={icon:"iconReqTypeSpecificationFolder.png"},p.mappingType[p.identifiers.type_act_functref]={icon:"I_VPMNavFunction.png"},p.mappingType[p.identifiers.type_act_physical]={icon:"I_VPMNavProduct.png"},{cleanRecentlyAuthoredItemsInLocalStorage:function(){var e=1e3*parseInt(widget.getPreference(p.localStorageKeys.timeoutIndex).value,10);let t=this;for(var i=localStorage.length-1;i>=0;i--){var n=localStorage.key(i);-1!==n.indexOf(p.localStorageKeys.recentlyAuthored)&&Date.now()-JSON.parse(t.SAXStorage().getItem(n),10)>e&&localStorage.removeItem(n)}},setAuthIDforWIW:function(e,t){this.AuthIDForWIW={workunder:e,value:t}},getAuthorizedWorkUnder:function(e){var t={},i=a.get();if(e){let e="DS-Configuration-Authoring-Context",i=null;this.AuthIDForWIW&&this.AuthIDForWIW.value&&("evolution"===this.AuthIDForWIW.workunder?i="pid:"+this.AuthIDForWIW.value:(e="DS-Change-Authoring-Context",i=this.AuthIDForWIW.value),t[e]=i)}else if(i&&i&&i.AuthoringContextHeader)for(var n in i.AuthoringContextHeader)t[n]=i.AuthoringContextHeader[n];return t},getEntry:function(e){return p[e]},getFullConfig:function(){return p},getPlatformServices:function(){var i=this;return new t(function(t,n){r.getPlatformServices({onComplete:function(n){var o={};e.is(n,"array")&&n.length>0&&n.forEach(function(e){o[e.platformId]=e}),i._platformServices=o,i.retrieveSecurityContext().then(function(e){t(e)})},onFailure:n})})},retrieveCurrentUser:function(){var e=this;return new t(function(t,i){if(e._user&&e._user.id)return t(e._user);r.getUser({onComplete:function(i){e._user={id:i.id,email:i.email,firstName:i.firstname,lastName:i.lastname},t(e._user)},onFailure:i})})},getSecurityContext:function(){var e=widget.getPreference(p.localStorageKeys.credentials),t=widget.getValue("widgetSecCtxPref");return e&&e.value?this._securityContext=e.value:this._securityContext=t&&null!==t?t:null,this._securityContext},getServiceURL:function(e){var t=this.getTenant();if(this._platformServices)return this._platformServices[t][e]},retrieveSecurityContext:function(){var i=this,o=null;return new t(function(t,r){var a=i.getServiceURL("3DSpace")+p.webservices.pnoCredential+"&tenant="+i.getTenant();n.authenticatedRequest(a,{method:"GET",type:"json",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(n){e.is(n.collabspaces,"array")&&0===n.collabspaces.length&&t(!1),o=i.credentialDataParser(n),t(o)},onFailure:r,onTimeout:r})})},getTenant:function(){return e.is(this._tenant)||(this._tenant=widget.getValue("x3dPlatformId")),this._tenant},switchPlatform:function(e){return!(!e||!e instanceof String)&&(widget.setValue("x3dPlatformId",e),this._tenant=e,!0)},getUser:function(e){var t="";if(this._user)return"isFullName"===e?t=this._user.firstName+" "+this._user.lastName:"isTrigram"===e?t=this._user.id:t},form3DXContent:function(e){return{protocol:"3DXContent",version:"1.1",source:widget.getValue("appId"),widgetId:widget.id,data:{items:this.getItemDetailsToShare(e)}}},getItemDetailsToShare:function(e){var t=this,i=[],n=t.getSecurityContext();let o=widget.getValue("ngFilter");if(o&&(o=JSON.parse(o)),1==e.length&&e[0].isRoot()&&o&&o.filterId){let e={envId:t.getTenant(),serviceId:"3DSpace",contextId:n,objectId:o.filterId,objectType:p.identifiers.type_act_advfilter,displayName:o.filterTitle,displayType:p.identifiers.type_advfilter};i.push(e)}else e.forEach(function(e){i.push({envId:t.getTenant(),serviceId:"3DSpace",contextId:n,objectId:e.getID(),objectType:e.options.grid.actualType||e.options.type,displayName:e.getLabel(),facetName:"realized",path:[{resourceid:e.getID(),type:e.getType()}]})});return i},setObjectOnCompass:function(t){var n=e.is(widget)&&widget.id?"flcockpitcompassSocket_"+widget.id:"flcockpitcompassSocket";this.flcockpitIntercom||(this.flcockpitIntercom=new i.Socket(n),this.flcockpitIntercom.subscribeServer("com.ds.compass",window.parent)),0===t.data.items.length?(this.flcockpitIntercom.dispatchEvent("onResetObject",{}),this.flcockpitIntercom.dispatchEvent("onResetX3DContent",{},n)):(this.flcockpitIntercom.dispatchEvent("onSetObject",t.data.items[0]),this.flcockpitIntercom.dispatchEvent("onSetX3DContent",t,n))},launchCrossAppSelection:function(e){var t={attributes:e.reduce(function(e,t){return e[t.getID()]={type:t.getType(),label:t.getLabel()},e},{}),paths:e.map(function(e){return e.getOccurencePath()}),version:"1.1"},i={metadata:{uid:Math.random(),originUid:Math.random(),timestamp:Date.now(),appid:widget.getValue("appId")+"_"+widget.id,originWidgetId:widget.id},data:t};o.publish("DS/PADUtils/PADCommandProxy/select",i)},getTypeIconUrl:function(e){let t=p.mappingType[e];return{iconPath:this.getServiceURL("3DSpace")+"/snresources/images/icons/small/"+t.icon,iconSize:{width:"16px",height:"16px"}}},credentialDataParser:function(e){var t,i,n;this._theListSC=[],this._theListSC_NLS=[],this.returnList=[],this._SCPreferredDB=null;var o=e.preferredcredentials;if(o.collabspace&&o.role&&o.organization){var r=o.collabspace,a=o.role,s=o.organization;t=r.name,i=a.name,n=s.name,this._SCPreferredDB=i+"."+n+"."+t}var l=e.collabspaces;if(l&&l.length>0){for(var c,d=!1,u=0;u<l.length;u++){for(var p=(f=l[u]).couples||[],g=0;g<p.length;g++){var m=p[g];if(void 0===c&&(c=m.organization.name),c!==m.organization.name){d=!0;break}}if(d)break}for(u=0;u<l.length;u++){var f,h=(f=l[u]).name,v=f.title;for(p=f.couples,g=0;g<p.length;g++){var C=p[g],b=C.organization,y=C.role,_=b.name,w=b.title,D=y.name,S=y.nls,I=D+"."+_+"."+h,A=d?v+" ● "+w+" ● "+S:v+" ● "+S;this._theListSC.push(I),this._theListSC_NLS.push(A),this.returnList.push({label:A,value:I})}}}return{optionList:this.returnList,defaultValue:this._SCPreferredDB}},retrieveCSRFToken:function(){var e=this;return new t(function(t,i){var o=e.getServiceURL("3DSpace")+p.webservices.getCSRFToken+"?tenant="+e.getTenant();n.authenticatedRequest(o,{method:"GET",type:"json",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:function(i){e.csrfToken=i.csrf.value,t()},onFailure:i,onTimeout:i})})},refreshCSRFToken:function(){var e=this;setTimeout(function(){e.retrieveCSRFToken(),e.refreshCSRFToken()},9e5)},getCSRFToken:function(){return this.csrfToken},SAXStorage:function(){return{setItem(e,t){e.contains(p.localStorageKeys.recentlyAuthored)&&s.getFLWebModelEventsObj("flweb-model-events")&&s.getFLWebModelEventsObj("flweb-model-events").publish({event:"item-loaded-from-database",data:{id:e,timestamp:t,authoring:!0}}),localStorage.setItem(e,t),widget.setValue(e,t)},getItem:e=>widget.getValue(e)||localStorage.getItem(e)||null,removeItem(e){localStorage.removeItem(e),widget.deleteValue(e)}}},get3DswymUrl:function(){return this.getServiceURL("3DSwym")},getUserImage:function(e){return this.get3DswymUrl()&&e?this.get3DswymUrl()+"/api/user/getpicture/login/"+e+"/format/normal":null},getNlsBasicAttributesBO:function(e){return p.nlsBasicAttributesBO[e]||e},getNlsBasicAttributesRel:function(e){return p.nlsBasicAttributesRel[e]||e}}}),define("DS/CATFLCockpitWidget/components/PropertiesPanel/facets/RelatedDocumentsFacet",["UWA/Core","UWA/Class","UWA/Controls/Abstract","DS/CATFLCockpitWidget/utils/config.util","DS/EditPropWidget/facets/Common/FacetsBase","DS/ENOXAttachmentsUX/AttachmentsPane","DS/ENOXSpecificationsUX/SpecificationsPane","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l){"use strict";let c=s.getFLWebModelEventsObj("flcockpit-content-list-view");return t.extend(i,o,{init:function(e){this._parent(e),this.buildView(e)},buildView:function(){var t=this;t.elements.container=e.createElement("div",{class:t.options.specificationDocuments?"relatedDocuments_spec":"relatedDocuments"}),t.multiselDisplay=e.createElement("div",{class:"notSupported"}).inject(t.elements.container),t.iconHolder=e.createElement("span",{class:"blockIcon"}).inject(t.multiselDisplay),t.infoMsgH2Tag=e.createElement("h2",{class:"information_msg"}).inject(t.multiselDisplay),t.multiselDisplay.hide();var i={parentObject:{},connectorOptions:{fetchSecurityContext:function(){return n.getSecurityContext()},getWorkUnderHeaders:function(){return n.getAuthorizedWorkUnder()},platformUrls:{"3DSpace":n.getServiceURL("3DSpace"),platformId:n.getTenant()},webinwin:!1}};t.options.specificationDocuments?(t.documentsPane=new a(i),t.documentsPane.modelEvents.subscribe({event:"upload-attachment-complete"},function(){t.refreshNode()}),t.documentsPane.modelEvents.subscribe({event:"attach-attachment-complete"},function(){t.refreshNode()}),t.documentsPane.modelEvents.subscribe({event:"detach-attachment-complete"},function(){t.refreshNode()})):t.documentsPane=new r(i),t.elements.container.appendChild(t.documentsPane.elements.container),t.multiselDisplay.isHidden()||t.documentsPane.hide()},refreshNode:function(){var e=this.getActiveNodeDetails().node;c.publish({event:"refresh-documents-by-id",data:{nodes:[e],docType:"specificationDocumentsCategory"}})},getActiveNodeDetails:function(){var e=null,t=null;if(this.options.getAppContext()){var i=this.options.getAppContext().getTreeDocument().getSelectedNodes();if(0===i.length){var n=this.options.getAppContext().getTreeDocument().getRoots()[0];n&&(e=n.options.physicalid,t=n)}else 1===i.length&&(e=i[0].options.physicalid,t=i[0])}return{nodeID:e,node:t}},updateFacet:function(){var e=this.getActiveNodeDetails().nodeID;!e||"specificationDocumentsCategory"===this.getActiveNodeDetails().node.getParent().options.type&&"SPECIFICATION_DOCUMENT"===this.options.tabId?this.notApplicable():(this.multiselDisplay.hide(),this.documentsPane&&(this.documentsPane.show(),this.documentsPane.options.parentObject.parentId!==e&&this.documentsPane.setParentObject({parentId:e})))},destroyComponent:function(){},notApplicable:function(){this.infoMsgH2Tag.setText(l.msg_not_supported_selection),this.iconHolder.addClassName("wux-ui-3ds wux-ui-3ds-5x wux-ui-3ds-block"),this.multiselDisplay.show(),this.documentsPane&&this.documentsPane.hide()},onResize:function(){},onRefresh:function(){}})}),define("DS/CATFLCockpitWidget/utils/common.util",["UWA/Core","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","UWA/Controls/Drag","DS/Windows/Panel","DS/Controls/Tab","DS/Controls/ComboBox","DS/Utilities/KeyboardUtils","DS/CATFLCockpitWidget/utils/model.events.util","DS/DataDragAndDrop/DataDragAndDrop","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","DS/CATFLCockpitWidget/utils/config.util","DS/i3DXCompassPlatformServices/OpenWith"],function(e,t,i,n,o,r,a,s,l,c,d,u,p){"use strict";let g,m=u.getFullConfig(),f=m.localStorageKeys,h=t;i.setNotificationManager(h),i.setStackingPolicy(17),require(["DS/CATFLCockpitWidget/utils/gridview.util.extended"],function(e){g=e});var v={alertMessage:function(e,t,i,n){i=i?i.replace(/(\r\n|\n|\r)/gm,"<br>"):"",n=n?n.replace(/(\r\n|\n|\r)/gm,"<br>"):"",h.addNotif({level:e,title:t,subtitle:i,message:n,sticky:!1})},displayError:function(t,i,n,o){var r=o;t.errorResp&&t.errorResp.message&&500!==t.errorResp.status?r=t.errorResp.message:e.is(t.error,"string")&&(r=t.error),n=n?n.replace(/(\r\n|\n|\r)/gm,"<br>"):"",r=r?r.replace(/(\r\n|\n|\r)/gm,"<br>"):"",v.alertMessage("error",i,n,r)},create3DXJsonFromDGVSelection:function(e,t){var i,n=[];t=void 0===t||t;let o=widget.getValue("ngFilter");if(o&&(o=JSON.parse(o)),1===e.length&&e[0].isRoot()&&o&&o.filterId)i={contextId:"ctx::"+u.getSecurityContext(),displayName:o.filterTitle,displayType:m.identifiers.type_advfilter,objectId:o.filterId,objectType:m.identifiers.type_act_advfilter,envId:u.getTenant(),serviceId:"3DSpace"},n.push(i);else for(var r=0;r<e.length;r++){if(i={contextId:"ctx::"+u.getSecurityContext(),displayName:e[r].options.label,displayType:e[r].options.grid.actualType||e[r].options.type,objectId:e[r].options.physicalid,objectType:e[r].options.grid.actualType||e[r].options.type,envId:u.getTenant(),serviceId:"3DSpace"},t){var a=e[r].getParent().options.physicalid;void 0!==a&&a.length>0&&(i.path=this._createPathFor3DXContent(e[r]))}n.push(i)}return{protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("appId"),widgetId:widget.id,data:{items:n}}},_createPathFor3DXContent:function(e){for(var t=[],i=e;void 0!==i.options.physicalid;)t.push({resourceid:i.options.physicalid,type:m.identifiers.type_act_logref}),i.options.instance&&i.options.instance.physicalid&&t.push({resourceid:i.options.instance.physicalid,type:m.identifiers.type_act_loginstance}),i=i.getParent();return t.reverse()},debounce:function(e,t,i){var n;return function(){var o=this,r=arguments,a=i&&!n;clearTimeout(n),n=setTimeout(function(){n=null,i||e.apply(o,r)},t),a&&e.apply(o,r)}},getFileInput:function(){var t=new e.createElement("input",{id:"fileExplorer",type:"file",styles:{display:"none"}}).inject(widget.body);return t.removeEvents(),t},makeDroppable:function(t,i,n){var o=t.getElement("#drop-invite");o||(o=new e.createElement("div",{id:"drop-invite",class:"hidden",html:i}).inject(t)),o.callback=n;var r={enter:this._manageDragEvents.bind(this),leave:this._manageDragEvents.bind(this),over:this._manageDragEvents.bind(this),drop:this._manageDropEvent.bind(this)};c.droppable(t,r)},_manageDragEvents:function(e,t){var i,n=(i=e).getElement("#drop-invite");switch(t.type){case"dragenter":i.addClassName("droppable"),n.removeClassName("hidden"),n.addClassName("show");break;case"dragleave":if(t.target!==n)return!1;i.removeClassName("droppable"),n.removeClassName("show"),n.addClassName("hidden");break;case"dragover":i.addClassName("droppable"),n.removeClassName("hidden"),n.addClassName("show")}return!0},_manageDropEvent:function(t,i){var n,o=(n=i).getElement("#drop-invite");if(t.trim().length>0){if(e.is(t,"string"))try{t=JSON.parse(t)}catch(e){t=null}else t=t;var r=t&&t.data&&t.data.items?t.data.items:null;o.callback(r)}n.hasClassName("droppable")&&n.removeClassName("droppable"),o.removeClassName("show"),o.addClassName("hidden")},cleanDragNDrop:function(e,t){c.clean(e,t)},formatDate:function(e){return e instanceof Date?e:(e.indexOf("@")>=0&&(e=e.replace("@"," ")),e.indexOf(":GMT")>=0&&(e=e.replace(":GMT"," GMT")),new Date(e))},displayDate:function(e){return e instanceof Date?e.toLocaleString():new Date(e).toLocaleString()},isDateEqual:function(e,t){if(e===t)return!0;if(e&&t){var i=v.formatDate(e),n=v.formatDate(t);return i.setHours(0,0,0),n.setHours(0,0,0),i.getTime()===n.getTime()}return!1},checkIfRecentlyAuthored:function(e,t){var i,n=parseInt(widget.getPreference(f.timeoutIndex).value,10);i=t?f.recentlyAuthoredStructure:f.recentlyAuthored;var o=u.SAXStorage().getItem(i+e);if(null!==o){if(Date.now()-parseInt(o,10)<1e3*n)return l.getFLWebModelEventsObj("flweb-model-events").publish({event:"item-loaded-from-database",data:{id:e,timestamp:o}}),!0;localStorage.removeItem(i+e)}return!1},checkIfMaturityIsReleasedOrObsolete:function(e){return null!=e&&(-1!==e.indexOf("RELEASED")||-1!==e.indexOf("OBSOLETE"))},getUserWorkUnderPositionPref:function(){try{return widget.getPreference(f.workunderpos).value}catch(e){return null}},setCfgAuthoringContextDragEvent:function(e){e||(e=widget.body.getElement(".fl-cockpit-triptych-main-container")),!this.bubbleDragControl&&e&&(this.bubbleDragControl=new n.Move({container:e,delegate:"#BubbleContainer > *",centerHandles:!0,handles:function(e){return e.target.getClosest("#BubbleContainer")},stop:function(){var t=e.querySelector("#BubbleContainer");if(t){var i=t.style.top,n=t.style.left;widget.setValues({"bubble-top":i,"bubble-left":n})}}}))},unsetCfgAuthoringContextDragEvent:function(){if(this.bubbleDragControl){this.bubbleDragControl&&(this.bubbleDragControl.destroy(),this.bubbleDragControl=null);var e=widget.getElement(".fl-cockpit-triptych-main-container").querySelector("#BubbleContainer");if(e){var t=e.style.top,i=e.style.left;(t||i)&&e.setStyles({top:null,left:null})}widget.setValue("bubble-top",null),widget.setValue("bubble-left",null)}},getOpenWithCompatibleApps:function(t,i){if(t){var n=u.form3DXContent([t]);i&&(n.data.items[0].objectTaxonomies=i,n.data.items[0].objectTaxonomies.push(t.options.grid.actualType||t.options.type));var o=new p;return o.set3DXContent(n,!1),e.is(o.retrieveCompatibleApps,"function")?new Promise(function(t){e.is(o.retrieveCompatibleApps,"function")?o.retrieveCompatibleApps(function(e){t(e)}):t([])}):void 0}},formObjForEditProp:function(e,t){var i=[];if(0===e.length){if(widget.getValue("currentView")&&"LandingPage"!==widget.getValue("currentView")){var n=widget.getValue("currentOpenedItem");i.push({physicalid:n,rootPID:n,metatype:"businessobject"})}}else e.forEach(function(e){e.options.instance&&e.options.instance.physicalid?i.push({physicalid:e.options.instance.physicalid,childPID:e.options.physicalid,rootPID:e.getRoot().options.physicalid,metatype:"relationship"}):e.options.linkInfo&&e.options.linkInfo.objType&&t?i.push({physicalid:e.options.linkInfo.implementId,rootPID:e.getRoot().options.physicalid,metatype:"businessobject"}):e.options.physicalid&&i.push({physicalid:e.options.physicalid,rootPID:e.getRoot().options.physicalid,metatype:"businessobject"})});return i},downloadFile:function(e,t,i){var n="text/plain;charset=utf-8";if(i&&(t="\ufeff"+t),window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(new Blob([t],{type:n}),e);else if(document.queryCommandSupported("SaveAs")){var o=document.createElement("iframe");o.setAttribute("style","display:none;"),document.body.appendChild(o),o.contentWindow.document.open("text/html","replace"),o.contentWindow.document.write(t),o.contentWindow.document.close(),o.contentWindow.focus(),o.contentWindow.document.execCommand("SaveAs",!0,e),document.body.removeChild(o)}else{var r,a=window.document.createElement("a");"download"in a?(r=URL.createObjectURL(new Blob([t],{type:n})),a.setAttribute("download",e)):(r="data:"+n+","+encodeURIComponent(t),a.setAttribute("target","_blank"),a.setAttribute("download",e)),a.href=r,a.setAttribute("style","display:none;"),document.body.appendChild(a),setTimeout(function(){if(a.click)a.click();else if(document.createEvent){var e=document.createEvent("MouseEvents");e.initEvent("click",!0,!0),a.dispatchEvent(e)}document.body.removeChild(a)},0)}},convertToDoubleDigit:function(e){var t=e;return e<10&&(t="0"+e),t},validateTenant:function(e){var t=u.getTenant(),i=e.envId;return u.switchPlatform(i)?(widget.getPreference("xPref_3DEXPERIENCE_PLATFORM")&&widget.setValue("xPref_3DEXPERIENCE_PLATFORM",i),v.alertMessage("info",null,d.info_platform_changed),!0):(v.alertMessage("error",null,d.replace(d.error_incorrect_platform,{displayName:e.displayName,tenant:t})),!1)},getUserCustomAttributes:function(e){return e?m.userAdditionalAttributesForPhysicalProduct:m.userAdditionalAttributes},getUserCustomAttributesCURI:function(){var e={bo:[],rel:[]},t=v.getUserCustomAttributes();return t&&t.forEach(function(t){t.bo&&!e.bo.includes(t.curi)?e.bo.push(t.curi):t.bo||e.rel.includes(t.curi)||e.rel.push(t.curi)}),e},createBatchServiceReqExecution:function(e,t,i,n,o){var r=e.length,a=this;if(0===r)return;n||(a.occNodesToExpand={});let s=widget.getValue(f.componentView);var c=Math.ceil(r/50),d=widget.getValue("currentConfig"),u=null;d&&d.filterCompiledForm&&(u=d.filterCompiledForm);let p=[];var m,h;l.getFLWebModelEventsObj("flcockpit-content-list-view").subscribe({event:"content-list-view-referenceLinks-loaded"},function(n){if(a.occNodesToExpand&&Object.keys(a.occNodesToExpand).length>0){let o=[];if(n.forEach(function(e){a.occNodesToExpand[e]&&(o=o.concat(a.occNodesToExpand[e]),delete a.occNodesToExpand[e])}),o.length>0){let n=a.expandNodesBasedonLevel.bind(a,e,t,i);a.occNodesToExpand&&0!==Object.keys(a.occNodesToExpand).length?g.addOccImplementLinksToNodesInBatch(o,i.collectionView.treeDocument):g.addOccImplementLinksToNodesInBatch(o,i.collectionView.treeDocument,n)}}});for(var v=0;v<c;v++)if(m=50*v,h=e.slice(m,m+50),p.push(g.getExpandServicesForBatchCalls(h,u,n,t,i)),h.forEach(function(e){e.options.noIndexOrDBExpand=!0,e.options.hasBeenExpanded=!0,n||("-1"===t?e.options.dontExpandAllLvl=!0:"2"===t&&(e.options.dontExpandTwoLvl=!0))}),n&&o&&s===f.structuredView){a.occNodesToExpand||(a.occNodesToExpand={});let e=[];h.forEach(function(t){let i=t.options.actualParent;i.options.implementLinks&&e.push(i.options.physicalid);let n=a.occNodesToExpand[i.options.physicalid]||[];n.push(t),a.occNodesToExpand[i.options.physicalid]=n}),a.actionPendingNodes||(a.actionPendingNodes={}),a.actionPendingNodes[o.options.physicalid]||(a.actionPendingNodes[o.options.physicalid]={node:o,level:t}),e.length>0&&l.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-referenceLinks-loaded",data:e})}return Promise.all(p)},expandNodesBasedonLevel:function(){let e=this;for(let t in e.actionPendingNodes){let i=e.actionPendingNodes[t].level,n=e.actionPendingNodes[t].node;"-1"===i?n.expandAll():"2"===i&&n.expandNLevels({numberOfLevelsToExpand:"2"}),delete e.actionPendingNodes[t]}},sortNodesIntoDBandIndex:function(e,t){let i,n={},o=[],r=[];return e&&e.length>0&&e.forEach(function(e){if(t){if(!(i=v.checkIfRecentlyAuthored(e.options.physicalid,!0))){let t=e.getOccurencePath();for(let e=0;e<t.length;e+=2)if(v.checkIfRecentlyAuthored(t[e],!0)){i=!0;break}}}else i=v.checkIfRecentlyAuthored(e.options.physicalid);i?o.push(e):r.push(e)}),n.databaseNodes=o,n.indexNodes=r,n},createReportStatusPanel:function(t,i){var n=new e.Element("div"),a=new r({displayStyle:"strip"});a.reorderFlag=!1,a.pinFlag=!0,a.showComboBoxFlag=!1,a.editableFlag=!1,a.multiSelFlag=!0,a.centeredFlag=!1,a.touchMode=!0;var s=0;function l(t,i,n){n&&n.length>0&&(t.add({label:i+" ("+n.length+")",content:function(t){for(var i=new e.Element("ul"),n=0,o=t.length;n<o;n++){var r=e.Element("div",{styles:{"white-space":"pre-line"}});r.textContent=t[n],i.appendChild(new e.Element("li").appendChild(r))}var a=new e.Element("div",{styles:{padding:"2px","word-wrap":"break-word"}});return a.appendChild(new e.Element("div").appendChild(i)),a}(n),isSelected:0===s,index:s}),s++)}return l(a,d.success_header,i.success),l(a,d.warning_header,i.warning),l(a,d.error_header,i.error),a.inject(n),new o({title:t,content:n,position:{my:"center",at:"center"},width:600,allowedDockAreas:0,immersiveFrame:widget.immersiveFrame,resizableFlag:!0,collapsibleFlag:!1,minWidth:600,minHeight:85})},getUserCustomHeaderView:function(){return m.customHeaderView},createMapSelectableForAdditionalAttr:function(){var e={},t=v.getUserCustomAttributes();return t&&t.forEach(function(t){t.selectable&&t.selectable.length?Array.isArray(t.selectable)?t.selectable.forEach(function(i){e[i.toLowerCase()]=t}):e[t.selectable.toLowerCase()]=t:Object.values(t.selectable).flat().forEach(function(i){e[i.toLowerCase()]=t})}),e},getNLSValueFromRangeValuesAttribute:function(e,t,i,n){if(void 0!==e.rangeValues&&i[t]&&("string"===e.type||"date"===e.type))if(n&&(n[t]=i[t]),e.multiValuated){if(i[t]=Array.isArray(i[t])?i[t]:i[t].split(","),n&&(Array.isArray(i[t])?n[t]=i[t].slice():n[t]=i[t]),"string"===e.type)for(let n=0;n<i[t].length;n++){let o=e.rangeValues.find(function(e){return e.value===i[t][n]});o&&(i[t][n]=o.nlsValue)}else if("date"===e.type)for(let n=0;n<i[t].length;n++){let o=e.rangeValues.find(function(e){return v.isDateEqual(e.value,i[t][n])});o&&(i[t][n]=o.formatDateValue)}}else if("string"===e.type){let n=e.rangeValues.find(function(e){return e.value===i[t]});n&&(i[t]=n.nlsValue)}else if("date"===e.type){let n=e.rangeValues.find(function(e){return v.isDateEqual(e.value,i[t])});n&&(i[t]=n.formatDateValue)}}};return v}),define("DS/CATFLCockpitWidget/utils/xhr.util",["DS/WAFData/WAFData","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){"use strict";var o=t.getFullConfig(),r=o.webservices.getCSRFToken;return{get:function(e,t,i){return this.makeServiceCall(e,"GET",null,null,null,t)},post:function(e,t,i,n){return this.customTimeout=i,this.makeServiceCall(e,"POST",t,null,null,n)},patch:function(e,t){return this.makeServiceCall(e,"PATCH",t)},put:function(e,i,n,o){var r,a;return r=n?{method:"PUT",headers:n,data:i||null}:this.generateFetchOptions("PUT",!0,!0,!0,!1,i),a=o&&o.targetService?o.targetService:"3DSpace",r.targetService=a,e=t.getServiceURL(a)+e,this.buildAjaxCall(e,r,"PUT")},makeServiceCall:function(e,i,n,o,r,a){var s,l,c,d,u;s=!a||"boolean"!=typeof a.accept||a.accept,l=!a||"boolean"!=typeof a.content||a.content,c=!a||"boolean"!=typeof a.secCtx||a.secCtx,d=!a||"boolean"!=typeof a.authoringCtx||a.authoringCtx,a&&"number"==typeof a.timeout&&(this.customTimeout=a.timeout);var p=r?this.generateFetchOptions("POST",!1,!0,!0,!0,n):this.generateFetchOptions(i,s,l,c,d,n),g="",m=!1;return window.location.href.indexOf("createLogicalReferencesFromDiagram.html")>-1||window.location.href.indexOf("setArchitectureNumberOnPSpool.html")>-1?(g=window.location.href.substring(0,window.location.href.indexOf("/webapps")),m=!0):(u=a&&a.targetService?a.targetService:r?"3DSearch":"3DSpace",g=t.getServiceURL(u)),(p=r?this.generateFetchOptions("POST",!1,!0,!0,!0,n):this.generateFetchOptions(i,s,l,c,d,n,m)).targetService=u,a&&a.responseType&&(p.responseType=a.responseType),e=r?t.getServiceURL("3DSearch")+"/search":g+e,m&&a&&a.wiwSecurityContext&&(p.headers.SecurityContext=a.wiwSecurityContext),this.buildAjaxCall(e,p,i,o)},makeMultipleServiceCalls:function(e,t){var i=this;if(t)return UWA.Promise.all(e);var n=e.map(function(e){return i.makeServiceCall(e.url,e.method,e.data,e.noCSRF,e.isIndexCall)});return UWA.Promise.all(n)},generateFetchOptions:function(e,i,n,o,r,a,s){var l={};l["Accept-Language"]=widget.lang,i&&(l.Accept="application/json"),n&&(l["Content-Type"]="application/json"),o&&(l.SecurityContext=t.getSecurityContext());var c=t.getAuthorizedWorkUnder(s);return r&&c&&"GET"!==e&&Object.assign(l,c),{method:e,headers:l,data:a||null}},buildAjaxCall:function(e,i,n,o){var a=this;return o||"POST"!==n&&"PATCH"!==n&&"DELETE"!==n?a.createPromiseFunction(e,i):window.location.href.indexOf("createLogicalReferencesFromDiagram.html")>-1||window.location.href.indexOf("setArchitectureNumberOnPSpool.html")>-1?a.get(r).then(function(t){return i.headers.ENO_CSRF_TOKEN=JSON.parse(t).csrf.value,i.headers.SecurityContext?a.createPromiseFunction(e,i):a.get("/resources/pno/person/getsecuritycontext").then(function(t){return i.headers.SecurityContext=JSON.parse(t).SecurityContext,a.createPromiseFunction(e,i)})}):(i.headers.ENO_CSRF_TOKEN=t.getCSRFToken(),a.createPromiseFunction(e,i))},createPromiseFunction:function(r,a){var s=this;return new Promise(function(l,c){Number.isInteger(s.customTimeout)&&(a.timeout=s.customTimeout),a.onComplete=l,a.onFailure=function(e,t,i){try{t=JSON.parse(t)}catch(e){t={}}c({error:e,errorResp:t})},a.onTimeout=function(e){i.alertMessage("error","",n.error_request_timedOut),c({error:e})},o.identifiers.tenant_based_services.indexOf(a.targetService)>=0&&(r.indexOf("?")>=0?r+="&tenant="+t.getTenant():r+="?tenant="+t.getTenant()),e.authenticatedRequest(r,a)})}}}),define("DS/CATFLCockpitWidget/services/thumbnail.service",["DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/WAFData/WAFData"],function(e,t,i,n){"use strict";var o=i.getFullConfig();i.getFullConfig().webservices.getCSRFToken;return{createFCSTicket:function(){var t=o.webservices.generateFCSTicket;return e.makeServiceCall(t,"PUT")},checkInThumbNail:function(e,t,i){var n=this,o={};o.method=i,o.headers={},t&&(o.data=t);return new Promise(function(t,i){n.createPromiseFunction(e,o,t,i)})},createPromiseFunction:function(e,t,o,r){t.onComplete=o,t.onFailure=r,t.onTimeout=r,e.indexOf("?")>=0?e+="&tenant="+i.getTenant():e+="?tenant="+i.getTenant(),n.authenticatedRequest(e,t)}}}),define("DS/CATFLCockpitWidget/services/common.service",["DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/PlatformAPI/PlatformAPI","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s){"use strict";var l=n.getFullConfig();a=JSON.parse(a);return{getItemInfo:function(e){var t=l.webservices.getItemInfo+l.webservices.getConfigInfoMask;return i.post(t,JSON.stringify(e),0).then(function(e){return JSON.parse(e)})},applyWorkUnderEvolution:function(e,o){var a=e.model,s=e.modelVer;a.physicalid&&s.physicalid||reject(new Error("invalid input"));var c=l.webservices.evolutionExpr.url,d=l.webservices.evolutionExpr.xmlExpr;d=(d=(d=(d=(d=d.replace(new RegExp("{modelName}","g"),a.name)).replace(new RegExp("{productName}","g"),s.backEndName)).replace(new RegExp("{productRevision}","g"),s.revision)).replace(new RegExp("{productTitle}","g"),s.name)).replace(new RegExp("{modelTitle}","g"),a.name);var u={"Dictionary Contexts":a.physicalid,"Evolution Expression":d};if(o){return i.post(c,JSON.stringify(u)).then(function(e){if(null!==(e=JSON.parse(e)).ACId&&""!==e.ACId&&null!==e.XSLTExpr&&""!==e.XSLTExpr)return n.setAuthIDforWIW("evolution",e.ACId),"Success"}).catch(function(e){console.error(e)})}i.post(c,JSON.stringify(u)).then(function(e){if(null!==(e=JSON.parse(e)).ACId&&""!==e.ACId&&null!==e.XSLTExpr&&""!==e.XSLTExpr){var i=r.get();i.evolution.id=e.ACId,i.evolution.displayExpression=e.XSLTExpr,r.setEffectivity(i),t.publish("sessionEff",i),t.publish("toggleActiveSE")}}).catch(function(e){console.error(e)})},getUserPreferences:function(e){var t=l.webservices.getUserPreferences;return t=t+"?name="+e,i.get(t,{secCtx:!1,targetService:"3DCompass"}).then(function(e){var t={};return e&&""!==e&&(t=JSON.parse(e)),t}).catch(function(e){o.displayError(e,null,null,s.error_get_user_pref)})},setUserPreferences:function(e){var t=l.webservices.setUserPreferences,n={};e&&(n=e);return i.put(t,n,{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},{targetService:"3DCompass"}).then(function(e){return JSON.parse(e)}).catch(function(e){o.displayError(e,null,null,s.error_set_user_pref)})},getKindOfRFLP:function(e){var t=l.webservices.getItemInfo+l.webservices.isKindOfFetchField;return i.post(t,JSON.stringify(e)).then(function(e){var t=[];return e&&(e=UWA.is(e,"string")?JSON.parse(e):e).member&&e.member[0]&&e.member[0].kindOfRFLP&&e.member.forEach(function(e){t.push(e.kindOfRFLP)}),t})},getVisualCues:function(){var e=l.webservices.getVisualCues;return i.post(e,JSON.stringify({})).then(function(e){return JSON.parse(e)}).catch(function(){})},exportVisualCues:function(e,t){var n=l.webservices.exportConvergenceCues;return this.getUserPreferences(a.user_pref_cues).then(function(r){var a=r.cues_state,l=r.combined_state;if(a&&Object.keys(a).length>0){var c=Object.values(a),d={};if(l&&l.active){for(var u in l.combinedCues)l.combinedCues.hasOwnProperty(u)&&(l.combinedCues[u]=l.combinedCues[u]);d={isCombinedConvergenceActivated:!0,combinedConvergenceOperator:l.operator,combinedConvergenceDefinition:l.combinedCues}}else d.isCombinedConvergenceActivated=!1;var p={cueInfo:c,instanceIds:e,occurrenceInfo:t,combinedConvergenceInfo:d};return i.post(n,JSON.stringify(p),0,{responseType:"arraybuffer"}).then(function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,"}),i=document.createElement("a");i.href=URL.createObjectURL(t);var n=new Date,r=o.convertToDoubleDigit(n.getMonth()+1),a=o.convertToDoubleDigit(n.getDate()),l=o.convertToDoubleDigit(n.getHours()),c=o.convertToDoubleDigit(n.getMinutes()),d=o.convertToDoubleDigit(n.getSeconds()),u=r+"_"+a+"_"+n.getFullYear()+"_"+l+"_"+c+"_"+d;i.download="ExportConvergenceStates_"+u+".xlsx",i.click(),URL.revokeObjectURL(i.href),i.remove(),o.alertMessage("success",null,s.msg_cue_export_success)}).catch(function(e){return o.displayError(e,null,null,s.error_export_cues_failed),Promise.reject()})}o.alertMessage("error",null,s.msg_userPref_cues)})},validateVisualCues:function(e,t){var n=l.webservices.validateVisualCues;return this.getUserPreferences(a.user_pref_cues).then(function(r){var a=r.cues_state,l=r.combined_state;if(a&&Object.keys(a).length>0){var c=Object.values(a),d={};if(l&&l.active){for(var u in l.combinedCues)l.combinedCues.hasOwnProperty(u)&&(l.combinedCues[u]=l.combinedCues[u]);d={isCombinedConvergenceActivated:!0,combinedConvergenceOperator:l.operator,combinedConvergenceDefinition:l.combinedCues}}else d.isCombinedConvergenceActivated=!1;var p={cueInfo:c,instanceIds:e,occurrenceInfo:t,combinedConvergenceInfo:d};return i.post(n,JSON.stringify(p),0).then(function(e){return JSON.parse(e)})}o.alertMessage("error",null,s.msg_userPref_cues)})},getCuesReportOnInstance:function(e,t,n){var r=l.webservices.cuesReportOnInst,a={cueInfo:e,instanceId:t,occurrenceInfo:n};return i.post(r,JSON.stringify(a),0).then(function(e){return JSON.parse(e)}).catch(function(e){return o.displayError(e,null,null,s.msg_generic_error_get_failed),Promise.reject()})},getParameterizationSetting:function(e){var t=l.webservices.getParameterizationSetting;return i.post(t,JSON.stringify(e)).then(function(e){return JSON.parse(e)}).catch(function(e){return o.displayError(e,null,null,s.msg_generic_error_get_failed),Promise.reject()})},getTypeSchemaDetails:function(e){var t=l.webservices.getTypeSchemaDetails;return i.post(t,JSON.stringify(e)).then(function(e){return JSON.parse(e)}).catch(function(e){return o.displayError(e,null,null,s.msg_generic_error_get_failed),Promise.reject()})},getExtensionsForClass:function(e){return i.post(l.webservices.getExtensionsForClass,JSON.stringify({class:e})).then(function(e){return JSON.parse(e).results}).catch(function(e){return o.displayError(e,null,null,s.error_get_extensions),[]})},getPredicateValues:function(t){return new Promise(function(i){e.getNlsOfPropertiesValues(JSON.stringify(t),{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){i(e)}})})},getTypeHierarchy:function(e){let t;return l._typeHierarchies||(l._typeHierarchies={}),l._typeHierarchies[e]&&(t=l._typeHierarchies[e]),new Promise(function(n){if(t)return void n(t);let o={types:[e]};var r=l.webservices.getTypeHierarchy;return i.post(r,JSON.stringify(o)).then(function(e){e=JSON.parse(e),l._typeHierarchies[e.types_hierarchies[0].type]=e.types_hierarchies[0].hierarchy,n(e.types_hierarchies[0].hierarchy)}).catch(function(){n([])})})}}}),define("DS/CATFLCockpitWidget/utils/contextManager.util",["UWA/Class","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util"],function(e,t,i){"use strict";return e.singleton({_selectedItems:[],getContext:function(e){return this.treeDocument=e,this.elements={container:widget.body},this.displayNotification=function(e){"error"===e.eventID?t.alertMessage("error",null,e.msg||e):"warning"===e.eventID?t.alertMessage("error",null,e.msg||e):t.alertMessage("success",null,e.msg||e)},this},init:function(e){this.options={widget:widget},this._parent(e)},addSelection:function(e){var t=this;UWA.is(e,"array")?e.forEach(function(e){t._selectedItems.push(e)}):(e.object="",this._selectedItems.push(e))},setBIFilter:function(e){this._biFilter=e,this.isIndexMode=function(){return!0}},isRoot:function(e){return e.isRoot()},getRoots:function(){return this.treeDocument.getRoots()},getChildren:function(e){return e.getChildren()||[]},getNodesById:function(e){return this.treeDocument.getNodesById(e)},getParents:function(e){return e.getParents()},getRelationID:function(e){return e.options.instance?e.options.instance.physicalid:null},getReference:function(e){return e.getID()},getParent:function(e){var t=e.getParent();return null!=t&&void 0!==t&&t.isVirtual&&t.isVirtual()&&(t=t.getParent()),t},getType:function(e){return e.getType()},getName:function(e){return e.getLabel()},getSelectedNodes:function(){return this._selectedItems},isDescendantOf:function(e,t){return e.isDescendantOf(t)},author:function(){return!0},resetSelection:function(){this._selectedItems=[],this._biFilter=null,this.isIndexMode=null},getSecurityContext:function(){return{SecurityContext:"ctx::"+i.getSecurityContext()}},getSetting:function(e){var t=null;switch(e){case"tenant":t=i.getTenant();break;case"securityContext":t=i.getSecurityContext()}return t},getLeafNodes:function(e){let t=[],i=e?e.getVisibleChildren():e.getChildren();return i&&Array.isArray(i)&&0!==i.length?i.forEach(e=>{let i=this.getLeafNodes(e);t.push(...i)}):t.push(e),t},getDataForCfgAnalysisCommands:function(e){let t,i={selectedNodes:[]},n=this.getSelectedNodes(),o=n.length,r=n[0]._attributes.treeData,a=r.isRoot();for(t=0;t<o;t++){if(a)var s={rootID:n[t].getID(),rootAlias:n[t].getLabel(),id:n[t].getID(),alias:n[t].getLabel(),isRoot:!0};else s={id:"CfgInstantiatedConfigurationCommands"==e?r.getRelationID():r.getID(),alias:r.getLabel(),parentID:r.getParent().getID(),parentalias:r.getParent().getLabel(),rootID:r.getRoot().getID(),rootAlias:r.getRoot().getLabel(),isRoot:!1};i.selectedNodes.push(s)}return i},getDescendantsDataForCfgAnalysisCommands:function(){var e={descendantNodes:[],occurrences:[]},t=this.getSelectedNodes();if(1==t.length){var i=0;let u=t[0]._attributes.treeData;if(u.isRoot()||u._isExpanded){i=u.getAllDescendants({onlyVisibleNodes:!0});for(var n=0;n<i.length;n++){let t=i[n];if(!t.isGroupingNode&&"Logical Reference"==t.options.grid.type){var o={physicalID:t.getRelationID()};e.descendantNodes.push(o)}}var r=this.getLeafNodes(u);for(n=0;n<r.length;n++){let t=r[n];if(!t.isGroupingNode&&"Logical Reference"==t.options.grid.type){for(var a=t.getOccurencePath(),s=[],l=0;l<a.length;l++){var c={instancePID:a[l]};s.push(c)}var d={path:s};e.occurrences.push(d)}}}}return e}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/EditConfigurationContextCmd",["DS/CfgConfigurationCommands/commands/CfgEditConfigurationContextCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel()})}),{selectedNodes:i}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/CopyEvolutionEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgCopyEvolutionEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()})}),{selectedNodes:i,nodes:e}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/EditVariantEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgVariantEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o){"use strict";return e.extend({init:function(e){var t=e||{};this._parent(t,{mode:"exclusive",isAsynchronous:!0})},getData:function(){var e=t.getSelectedNodes()[0];return e?{selectedNodes:[{id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()}],nodes:e}:{}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/ExtendEvolutionEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgExtendEvolutionEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util"],function(e,t,i,n){"use strict";return e.extend({init:function(e){var t=e||{};this._parent(t,{mode:"exclusive",isAsynchronous:!0})},getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()})}),{selectedNodes:i,nodes:e}}})}),define("DS/CATFLCockpitWidget/commands/CATFLNextGenFilterCmd",["DS/ENONextGenFilterCmd/commands/ENONextGenFilterCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return e.extend({init:function(e){this.name=e.ID,this.viewController=e.viewController,e.context?this.context=t.getContext():this.context=e.context,this._parent(e)},getAppParams:function(){return{widgetId:widget.id,appId:widget.id}},getSelectorManager:function(){return this.viewController.contentView.getTreeDocument().getXSO()||null},getRoots:function(){var e=this.viewController.contentView.getTreeDocument().getRoots()[0];return[{id:e.getID(),filtered:0,Label:e.getLabel()}]},getSelection:function(){var e={path:[],label:[]},t=[],i=this.viewController.contentView.getTreeDocument().getRoots()[0];if(i&&(t=[i]),t.forEach(function(t){e.path.push([t.getID()]),e.label.push([t.getLabel()])}),this.viewController.contentView.getTreeDocument().getSelectedNodes()){var n=this.viewController.contentView.getTreeDocument().getSelectedNodes();n.length>=1&&n[0].getID()!==t[0].getID()&&n.forEach(function(t){e.path.push(t.getOccurencePath()),e.label.push([t.getLabel()])})}return e}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/AddToConfigurationRevisionCmd",["DS/CfgEffectivityCommands/commands/CfgAddToConfigurationRevisionCmd","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o){"use strict";return e.extend({init:function(e){var t=e||{};this._parent(t,{mode:"exclusive",isAsynchronous:!0})},getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()})}),{selectedNodes:i,nodes:e}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/PasteVariantEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgPasteEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[],n=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()}),n.push(e._attributes.nodeModel)}),{selectedNodes:i,nodes:e,padNodes:n}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/SelectByConfigurationCriteriaCmd",["DS/CfgAnalysisCommands/commands/CfgSelectByConfigurationCriteriaCmd","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","DS/CfgBaseUX/scripts/CfgUtility"],function(e,t,i,n,o){"use strict";return e.extend({getData:function(){return this.end(),t.getDataForCfgAnalysisCommands()},getDescendantsData:function(){return t.getDescendantsDataForCfgAnalysisCommands()},selectLeaves:function(e){var i=this;let n=t.getSelectedNodes()[0];if(n._attributes.treeData.unselect(),n._attributes.treeData.unselectAll(),null!=e&&null!=e.occurrences){var r=e.occurrences;let t=0;for(var a=0;a<r.length;a++)"ErrorTooComplexExpression"==r[a].status&&t++;if(t>0){var s={primaryButton:"Yes",secondaryButton:"No",messageToDisplayOnDialog:"Status not computed on "+t+" instances. \n Do you want to highlight them?",dontShowAgain:!1,targetBody:widget.body,primaryCallback:function(){i.highlightLeavesWithStatus(r,"ErrorTooComplexExpression")},secondaryCallback:function(){i.highlightLeavesWithStatus(r,"Valid")}};o.showUserChoiceDialog(s)}else i.highlightLeavesWithStatus(r)}},highlightLeavesWithStatus:function(e){var o=0;let r=t.getSelectedNodes()[0]._attributes.treeData.getAllDescendants();for(var a=0;a<e.length;a++){let t=e[a];if("Valid"==t.status){let e=t.pids.substring(1,t.pids.length-1).split(", ");for(var s=0;a<r.length;s++){let t=r[s];if(t._options.grid.type&&t.getID()==e[e.length-1]){t.select(),o++;break}}}}o>1?i.alertMessage("info",null,o+" "+n.instances_selected):i.alertMessage("info",null,o+" "+n.instance_selected)},selectInstances:function(e){let o=t.getSelectedNodes()[0];o._attributes.treeData.unselect(),o._attributes.treeData.unselectAll();let r=o._attributes.treeData.getAllDescendants();if(null!=e&&null!=e.instances){for(var a=e.instances,s=0,l=0;l<a.length;l++)"used"==a[l].status&&r.forEach(function(t){if(t._options.grid.type){t.getNodesByRelId(e.instances[l].physicalID).forEach(function(e){e.select(),s++})}});s>1?i.alertMessage("info",null,s+" "+n.instances_selected):i.alertMessage("info",null,s+" "+n.instance_selected)}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/CopyVariantEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgCopyEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()})}),{selectedNodes:i,nodes:e}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/EditEvolutionEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgEvolutionCmd","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o){"use strict";return e.extend({init:function(e){var t=e||{};this._parent(t,{mode:"exclusive",isAsynchronous:!0})},getData:function(){var e=t.getSelectedNodes()[0];return{selectedNodes:[{id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()}],nodes:e}}})}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/PasteEvolutionEffectivityCmd",["DS/CfgEffectivityCommands/commands/CfgPasteEvolutionEffectivityCmd","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return e.extend({getData:function(){var e=t.getSelectedNodes(),i=[],n=[];return e.forEach(function(e){i.push({id:e.getID(),alias:e.getLabel(),isRoot:!1,VPMRef:e.getType(),parentID:e.getParent().getID(),parentalias:e.getParent().getLabel()}),n.push(e._attributes.nodeModel)}),{selectedNodes:i,nodes:e,padNodes:n}}})}),define("DS/CATFLCockpitWidget/services/implementlink.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){var o=e.getFullConfig();return{getRefImplementLinks:function(e){var r=o.webservices.createLogItem+e+o.webservices.keyMaskForService+o.masks.logItemImplementLinksMask;return i.get(r).then(function(e){var t=JSON.parse(e).member[0];return{implemented:t["Implemented by"],implementing:t.Implementing}}).catch(function(e){t.displayError(e,null,null,n.msg_generic_error_get_failed)})},getInstanceImplementLinks:function(e,r){var a=this.confAllImplPathsOnNodes(e,r,!0),s=!1;if(a&&a.payload){let e=!1,t=!1;a.payload.isImplementingPath&&a.payload.isImplementingPath.length>0&&(e=!0),a.payload.isImplementedByPath&&a.payload.isImplementedByPath.length>0&&(t=!0),e||t||(s=!0)}else s=!0;if(s)return Promise.resolve();var l=o.webservices.getLogItemOccImplementLink;return i.post(l,JSON.stringify(a.payload),0).then(function(e){var t=JSON.parse(e).member,i=[];return t&&t.forEach(function(e){let t=e.selectedoccpath,n=UWA.is(t,"string")?t:t[t.length-1];a.pathData[n][t.toString()].forEach(function(t){i.push({node:t,implemented:e.isImplementedBy,implementing:e.isImplementing})})}),i}).catch(function(e){t.displayError(e,null,null,n.msg_generic_error_get_failed)})},confAllImplPathsOnNodes:function(e,t,i,n){let o=this,r={},a={},s=!0,l=!0;if(n&&(s=void 0===n.bIsImplementing||n.bIsImplementing,l=void 0===n.bIsImplementedBy||n.bIsImplementedBy),t){let e=widget.getValue("configurable_expand")||{};if(e.isImplementing?a.isImplementingPath=[]:s=!1,e.isImplementedBy?a.isImplementedByPath=[]:l=!1,!s&&!l)return{}}else a.isImplementingPath=[],a.isImplementedByPath=[];if(e&&e.length>0){let t,n;e.forEach(function(e){if(!e.isRoot()){t=e.options.instance.physicalid;let u=[];if(t&&(r[t]||(r[t]={}),s&&(n=o.getAllImplPaths("implementing",e,[],[])).forEach(function(i){u.push(i.join("|")),r[t][i]?r[t][i].push(e):(r[t][i]=[e],a.isImplementingPath.push(i))}),l&&(n=o.getAllImplPaths("implemented",e,[],[])).forEach(function(i){let n=i.join("|");if(u.indexOf(n)<0)u.push(n),r[t][i]?r[t][i].push(e):(r[t][i]=[e],a.isImplementedByPath.push(i));else{a.isImplementedByPath.some(e=>i.every((t,i)=>t===e[i]))||a.isImplementedByPath.push(i)}}),i)){var c=e.getNodesByRelId("implementinginst"+t)[0],d=e.getNodesByRelId("implementedinst"+t)[0];c&&c.remove(),d&&d.remove()}}})}return{pathData:r,payload:a}},formAllImplPathsOnNodes:function(e,t){var i,n=this,o={};let r=!0,a=!0;if(t){let e=widget.getValue("configurable_expand")||{};if(e.isImplementing||(r=!1),e.isImplementedBy||(a=!1),!r&&!a)return o}return e&&e.length>0&&e.forEach(function(e){e.isRoot()||(i=e.options.instance.physicalid)&&(o[i]={},r&&(o[i].implementing=n.getAllImplPaths("implementing",e,[],[])),a&&(o[i].implementedBy=n.getAllImplPaths("implemented",e,[],[])))}),o},getAllImplPaths:function(e,t,i,n){var o=t.options.actualParent||t.getParent();if(o){if(i.push(t.options.instance.physicalid),o.isRoot())return i.reverse(),n.push(i),n;if(o.options.implementLinks&&o.options.implementLinks[e]){var r=i.slice();r.reverse(),n.push(r)}return this.getAllImplPaths(e,o,i,n)}},createScopeLinks:function(e){var t=o.webservices.createScopeLinks;return i.post(t,JSON.stringify(e)).then(function(e){return e})},deleteImplementLinks:function(e){var t=o.webservices.deleteImplementLinks;return i.post(t,JSON.stringify(e)).then(function(e){return e})},createOccurrenceLinks:function(e){var t=o.webservices.createOccurrenceLinks;return i.post(t,JSON.stringify(e)).then(function(e){return e})},deleteOccurrenceLinks:function(e){var t=o.webservices.deleteOccurrenceLinks;return i.post(t,JSON.stringify(e)).then(function(e){return e})}}}),define("DS/CATFLCockpitWidget/services/model.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/WAFData/WAFData","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r){var a=e.getFullConfig();return{getModelPIDFromLogicalReference:function(e){return i.get(a.webservices.dsfl_getLogItem+e+"/model").then(function(e){var t=JSON.parse(e);if(void 0!==t.rootObjects){var i=t.rootObjects[0],n={};return i.attributes.forEach(function(e){void 0!==e.value&&(n[e.name]=e.value)}),i.attributes=n,i}return null}).catch(function(e){var i=e.error.message.slice(e.error.message.indexOf("ResponseCode")),n=r.error_get_model;i&&i.indexOf("404")>=0&&(n=r.error_get_model_media),t.displayError(e,null,null,n)})},getModelVersionFromModelPID:function(t){let i=this,o=t.name,r=t.physicalid?t.physicalid:t.id;window.location.href.indexOf("createLogicalReferencesFromDiagram.html")>-1?(host=window.location.href.substring(0,window.location.href.indexOf("/webapps")),isWIWcall=!0):host=e.getServiceURL("3DSpace");var a=host+"/resources/modeler/browsing/browseservice/pid:"+r+"/configurationdictionary?products=1&attributes=1&tenant="+e.getTenant(),s=new FormData;let l={filterExpression:'<?xml version="1.0" encoding="UTF-8"?><CfgFilterExpression xmlns="urn:com:dassault_systemes:config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:com:dassault_systemes:config CfgFilterExpression.xsd"><FilterSelection SelectionMode="Strict"><Context xmlns="urn:com:dassault_systemes:config" HolderType="Model" HolderName="'+o+'"/></FilterSelection></CfgFilterExpression>'};return s.append("evolutionExpression",JSON.stringify(l)),new Promise(function(t,o){var r={method:"POST",headers:{SecurityContext:e.getSecurityContext()||"","Accept-Language":widget.lang},data:s,onComplete:function(e){var n=JSON.parse(e).products,o=[];Object.keys(n).length>0&&(n.created=new Date(n.originated).getTime(),o.push(n)),i._addNextRevisionAndOrBranchToModelVersionsList(o,n),o=o.sort(function(e,t){return e.created>t.created?1:e.created<t.created?-1:0}),t(o)},onFailure:o,onTimeout:o};n.authenticatedRequest(a,r)})},_addNextRevisionAndOrBranchToModelVersionsList:function(e,t){if(t["Main Derived"]&&void 0!==t["Main Derived"].id&&(t["Main Derived"].created=new Date(t["Main Derived"].originated).getTime(),e.push(t["Main Derived"]),this._addNextRevisionAndOrBranchToModelVersionsList(e,t["Main Derived"])),t.Derived&&t.Derived.length>0)for(var i=0;i<t.Derived.length;i++)t.Derived[i].created=new Date(t.Derived[i].originated).getTime(),e.push(t.Derived[i]),this._addNextRevisionAndOrBranchToModelVersionsList(e,t.Derived[i])},getProductConfigurationsFromModelVersion:function(e,t){var n="/resources/modeler/browsing/model/"+e+'/getproductconfigurations?filteringCriteria={"version": "1.0.0", "input": {"status": "0","basics": "owner,description,current,to[Product Configuration].from.attribute[Marketing Name],to[Product Configuration].from.revision","attributes": "FilterCompiledForm","productPIDs":"'+t+'"}}';return i.get(encodeURI(n)).then(function(e){return JSON.parse(e).productconfigurations})},createVolatileFilter:function(e){var t=a.webservices.getVolatileFilter,n='<CfgFilterExpression xs:schemaLocation = "urn:com:dassault_systemes:config CfgFilterExpression.xsd" xmlns:xs = "http://www.w3.org/2001/XMLSchema-instance" xmlns = "urn:com:dassault_systemes:config"><FilterSelection SelectionMode="150%" SelectionView="'+widget.getValue("evolutionView")+'"><TreeSeries Type = "ProductState" Name = "'+e.modelName+'"><Single Name = "'+e.modelVerName+'" Revision = "'+e.modelVerRev+'"/></TreeSeries></FilterSelection></CfgFilterExpression>';return i.post(t,JSON.stringify({version:"1.2",output:{targetFormat:"TXT"},expression:{version:"0.1",format:"xml",content:n},dictionary:{version:"0.1",id:{pid:e.modelID}}})).then(function(e){return JSON.parse(e)})},getConfigContextInfo:function(e){var n=a.webservices.getConfigContextInfo,o={version:"1.0",modelMask:"Read",enabledCriteria:"NO",cfgCtxt:"YES",pidList:e};return i.post(n,JSON.stringify(o),0).then(function(e){return JSON.parse(e)}).catch(function(e){t.alertMessage("error",null,r.error_get_config_ctx)})},getEffectivityInfo:function(e,t){var n=a.webservices.getEffectivityInfo,r={version:"1.3",output:{targetFormat:t||"TXT",withDescription:"YES",view:"ALL",domains:"ALL"},pidList:e},s=null;return"function"==typeof o.getConfigurationRevisionDetails&&(s=o.getConfigurationRevisionDetails().configurationRevision),s&&s.configRevision&&(r.configurationRev=s.configRevision[0].id),i.post(n,JSON.stringify(r),0).then(function(e){return JSON.parse(e).expressions}).catch(function(e){})},setMultipleFilterableObjectInfo:function(e,n){var o=a.webservices.setMultipleFilterableObjectInfo;let s={version:"1.2",expression:{output:{targetFormat:"TXT",withDescription:"YES",view:"All",domains:"All"},contentFormat:"XML",expressionList:e,dictionary:{version:"0.1",idList:n,format:"xml"}}};return i.post(o,JSON.stringify(s),0).then(function(e){return JSON.parse(e)}).catch(function(e){let i=e.errorResp?e.errorResp.errorMessage:r.error_wiw_copy_eff;t.alertMessage("error",r.error_wiw_title_copy_eff,i)})},filterValidation:function(e,t,n){var o=[];n=n||!1,t.forEach(function(e,t){var i;i=n?[{name:"physicalId ",value:e.physicalId},{name:"V_CompiledExpression",value:e.compiledExpression}]:[{name:"physicalId ",value:e.physicalId}],o.push({path:[{attributes:i}]})});var r=a.webservices.getFilterValidation;return i.post(r,JSON.stringify({version:"1.0",detailedResults:"No",filter:{format:"bin",value:e},occurrences:{ApplyMasterComposition:"no",withBinaries:n?"yes":"no",paths:o}}),0).then(function(e){if(parsedResult=JSON.parse(e),"SUCCEEDED"===parsedResult.occurrences.status){var t=[];return parsedResult.occurrences.paths.forEach(function(e,i){t.push({status:e.status,PIDInstance:e.path[0].pid})}),t}return Promise.reject(new Error("Service_failed"))}).catch(function(e){return Promise.reject(new Error("Service_failed"))})},allFilterValidation:function(e,t,n){var o=this,r=[],a=[];return a=(n=n||!1)?e.map(function(e){return{physicalId:e.options.instance.physicalid,compiledExpression:e.options.instance.effectivitycompiledform}}):e.map(function(e){return{physicalId:e.options.instance.physicalid}}),t.forEach(function(e,t){e.FilterCompiledForm&&r.push(o.filterValidation(e.FilterCompiledForm,a,n))}),i.makeMultipleServiceCalls(r,!0).then(function(i){var n=[];return i.forEach(function(i,o){var r=[];i.forEach(function(t,i){r.push({filterValidationStatus:t.status,nodeInstance:e[i]})}),n.push({modelversion:t[o].mv,productConfiguration:t[o].pc,instances:r})}),n})},getMVandPCinformationFromModel:function(e){var t=this;return t.getModelVersionFromModelPID(e).then(function(n){if(n.length<1)return Promise.reject(new Error("No_ModelVersions"));var o=[],r={model:e,modelversions:[]};return n.forEach(function(i,n){r.modelversions.push({modelversion:i});var a=i.id;a.indexOf("pid")>=0&&(a=a.substring(4)),o.push(t.getProductConfigurationsFromModelVersion(e.physicalid,a))}),i.makeMultipleServiceCalls(o,!0).then(function(e){return e.forEach(function(e,t){r.modelversions[t].productConfigurations=[],e.forEach(function(e,i){r.modelversions[t].productConfigurations.push(e)})}),r})})},getEffConsistencyReportofItemNProduct:function(e){let n=a.webservices.compareEvolutionEffectivityForLAndP;return i.post(n,JSON.stringify(e),0).then(function(e){return JSON.parse(e)}).catch(function(e){t.displayError(e,null,null,null)})},getEffConsistencyReportofItemNDiscipline:function(e){let n=a.webservices.compareEvolutionEffectivityForItemAnd2D;return i.post(n,JSON.stringify(e),0).then(function(e){return JSON.parse(e)}).catch(function(e){t.displayError(e,null,null,null)})},getChangeControl:function(e){let n=a.webservices.getChangeControl;return i.post(n,JSON.stringify(e),0).then(function(e){return JSON.parse(e)}).catch(function(e){t.displayError(e,null,null,null)})}}}),define("DS/CATFLCockpitWidget/components/ModelPCSelector/configurationSelector",["DS/Windows/Dialog","DS/Controls/Button","DS/Handlebars/Handlebars4","DS/WUXAutoComplete/AutoComplete","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","text!DS/CATFLCockpitWidget/components/ModelPCSelector/modelPCSelector.html","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f){var h="MODELVERSION",v="PC",C=JSON.parse(m);return{setActiveModel:function(e){this.configDetails.model=e},setActiveModelVersion:function(e){this.configDetails.modelVersion=e},setActiveProductConfig:function(e){this.configDetails.productConfiguration=e},getActiveModel:function(){return this.configDetails.model},getActiveModelVersion:function(e){return this.configDetails.modelVersion},getActiveProdConfig:function(){return this.configDetails.productConfiguration},init:function(t,i,a,c,d){var u,g=this;g.itemID=i,g.configDetails={model:{},modelVersion:{},productConfiguration:{}},g.configurationType=t,a&&(Array.isArray(a)&&a.length>0?g.allModels=a:g.setActiveModel({physicalid:a.physicalid?a.physicalid:a.id,name:a.name,revision:a.revision,objId:a.id})),c&&g.setActiveModelVersion({physicalid:c.physicalid?c.physicalid:c.id,name:c.name,revision:c.revision,current:c.current,backEndName:c.backEndName}),d&&g.setActiveProductConfig({physicalid:d.physicalid?d.physicalid:d.id,name:d.name,filterCompiledForm:d.filterCompiledForm,objId:d.id}),g.modalWindow&&g.modalWindow.close(),l.configureSearch();var m=g.getModalContent();g.modalWindow=new e({title:m.header,content:m.content,buttons:m.buttons,width:580,height:150,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame});var h=g.modalWindow.getContent().getElement("#modelVersionRow"),C=g.modalWindow.getContent().getElement("#productConfRow"),b=g.getActiveModel(),y=g.getActiveModelVersion(),_=g.getActiveProdConfig();if(h){var w=h.getElement(".autoCompleteContainer"),D=h.getElement(".searchContainer");w&&(u=y.physicalid,g.modVerAutoComplete=new n({allowFreeInputFlag:!1,minLengthBeforeSearch:3,multiSearchMode:!1,placeholder:m.modverPlaceholder}),g.modVerAutoComplete.addEventListener("change",function(e){var t=g.modVerAutoComplete.selectedItems;if(t){var i=(t=t.options).physicalid?t.physicalid:t.modelVersionID;i.indexOf("pid")>=0&&(i=i.substring(4)),g.submitButton.disabled=i===u,t.model&&g.setActiveModel({physicalid:t.model.physicalid?t.model.physicalid:t.model.id,name:t.model.name,objId:t.model.id?t.model.id:t.model.objId}),g.setActiveModelVersion({physicalid:i,name:t.name?t.name:t.modelVersionName,revision:t.revision,backEndName:t.backEndName,current:t.current})}else g.submitButton.disabled=!u,g.setActiveModelVersion({physicalid:null,name:null,revision:null,backEndName:null,current:null})}),g.formAutocomplMVDataset(),g.modVerAutoComplete.inject(w)),D&&(D.onclick=g.searchModVer.bind(g))}if(C){var S=C.getElement(".autoCompleteContainer"),I=C.getElement(".searchContainer");S&&(g.pcAutoComplete=new n({allowFreeInputFlag:!1,minLengthBeforeSearch:3,multiSearchMode:!1,placeholder:f.ph_header_config_pc}),g.pcAutoComplete.addEventListener("change",function(e){var t=g.pcAutoComplete.selectedItems;t?((t=t.options).physicalid.indexOf("pid")>=0&&(t.physicalid=t.physicalid.substring(4)),g.setActiveProductConfig({physicalid:t.physicalid?t.physicalid:t.id,name:t.name,label:t.label,filterCompiledForm:t.attributes.FilterCompiledForm})):g.setActiveProductConfig({physicalid:null,name:null,filterCompiledForm:null})}),g.pcAutoComplete.inject(S),g.configurationType===v&&s.getProductConfigurationsFromModelVersion(b.physicalid,y.physicalid).then(function(e){var t=new o;e.forEach(function(e){e.label=e.marketingName,e.physicalid=e.id,e.value=e.id&&e.id.indexOf("pid")>=0?e.id.substring(4):e.id,e.icon=p.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_FTRProductConfig.png",t.addRoot(new r(e))}),g.pcAutoComplete.elementsTree=t,_.physicalid&&g._retrieveItemInProductConfigurationDataset(_.physicalid)})),I&&(I.onclick=g.searchPC.bind(g))}return g.modalWindow},getModalContent:function(){var e=this,n=e.configurationType,o={header:"",content:"",buttons:{}},r=i.compile(g),a={};return e.submitButton=new t({id:"configurationSubmit",domId:"configurationSubmit",label:f.confirmation_button,onClick:e.onSubmitCallback.bind(e),disabled:!1}),e.cancelButton=new t({id:"configurationCancel",domId:"configurationCancel",label:f.cancel_button,onClick:function(){e.modalWindow.close()}}),o.buttons.Ok=e.submitButton,o.buttons.Cancel=e.cancelButton,n===h?(o.header=f.header_config_modver,o.modverPlaceholder=f.ph_header_config_modver,a.rows=[{rowId:"modelVersionRow"}],a.modal_title="",e.submitButton.disabled=!0,o.buttons.Cancel=e.cancelButton):n===v&&(o.header=f.header_config_pc,a.rows=[{rowId:"productConfRow"}],a.modal_title="",o.buttons.Cancel=e.cancelButton),o.content=r(a),o},onSubmitCallback:function(){var e=this,t=e.configurationType,i=e.getActiveModel(),n=e.getActiveModelVersion(),o=e.getActiveProdConfig(),r=d.getFLWebModelEventsObj("flweb-model-events");n.physicalid?o.physicalid?o.filterCompiledForm?r.publish({event:"mod-PC-selection-successful",data:{itemID:e.itemID,model:i,modelVer:n,pc:o,filterCompiledForm:o.filterCompiledForm}}):s.createVolatileFilter({modelID:i.physicalid,modelName:i.name,modelVerName:n.backEndName,modelVerRev:n.revision}).then(function(t){r.publish({event:"mod-PC-selection-successful",data:{itemID:e.itemID,model:i,modelVer:n,pc:o,filterCompiledForm:t.filterBinaryForExpand}})}):e.publishSelectedModVer():t===h&&(u.alertMessage("success",null,f.attachedConfigurationFilterRemoved),r.publish({event:"allmod-selection-successful",data:{itemID:e.itemID}})),e.modalWindow.close()},searchModVer:function(){var e=this,t=(e.configurationType,{searchTitle:f.label_search_modelVer,allowedTypes:C.type_products,role:"",criteria:"",bMultiSel:!1,in_apps_callback:function(t){e._retrieveItemInModelVersionDataset("pid:"+t[0].id)}});if(e.allModels){var i="";e.allModels.forEach(function(e){var t=e.id;i+='[BASED_ON_MODEL]:"'+t+'" OR '}),t.additionalQuery="("+i.substring(0,i.length-4)+")"}else e.getActiveModel()&&e.getActiveModel().objId&&(t.additionalQuery='[BASED_ON_MODEL]:"'+e.getActiveModel().objId+'"');l.launchSearch(t)},searchPC:function(){var e=this,t=e.getActiveModelVersion().physicalid,i=(e.configurationType,{searchTitle:f.label_search_pc,allowedTypes:C.type_productConfiguration,role:"",criteria:"",bMultiSel:!1,additionalQuery:'[BASED_ON_MODEL_VERSION_PID]:"'+t+'"'});null!==t?(i.in_apps_callback=function(t){e._retrieveItemInProductConfigurationDataset("pid:"+t[0].id)},l.launchSearch(i)):u.alertMessage("error",null,"Please select Model Version","")},_retrieveItemInModelVersionDataset:function(e){e&&e.indexOf("pid")>=0&&(e=e.substring(4)),this.modVerAutoComplete.value=e},_retrieveItemInProductConfigurationDataset:function(e){e&&e.indexOf("pid")>=0&&(e=e.substring(4)),this.pcAutoComplete.value=e},publishSelectedModVer:function(){var e=this,t=e.getActiveModel(),i=e.getActiveModelVersion(),n=(e.getActiveProdConfig(),d.getFLWebModelEventsObj("flweb-model-events"));s.createVolatileFilter({modelID:t.physicalid,modelName:t.name,modelVerName:i.backEndName,modelVerRev:i.revision}).then(function(o){n.publish({event:"mod-PC-selection-successful",data:{itemID:e.itemID,model:t,modelVer:i,pc:null,filterCompiledForm:o.filterBinaryForExpand}})})},formAutocomplMVDataset:function(){var e=this,t=[],i=e.getActiveModel(),n=e.getActiveModelVersion();e.allModels?e.allModels.forEach(function(e){e.physicalid?e.physicalid:e.id,t.push(s.getModelVersionFromModelPID(e))}):i.physicalid&&t.push(s.getModelVersionFromModelPID(i)),c.makeMultipleServiceCalls(t,!0).then(function(t){var a,s=new o;t.forEach(function(t,n){e.allModels?a=e.allModels[n]:i.physicalid&&(a=i),t.forEach(function(e){s.addRoot(new r({modelVersionID:e.id,modelVersionName:e.attributes.MarketingName,revision:e.revision,current:e.current,value:e.id&&e.id.indexOf("pid")>=0?e.id.substring(4):e.id,label:e.attributes.MarketingName+" "+e.revision,backEndName:e.name,model:a,icon:p.getServiceURL("3DSpace")+"/snresources/images/icons/small/iconSmallProduct.png"}))})}),console.log("datasetTreeModel",s.getRoots()),e.modVerAutoComplete.elementsTree=s,n.physicalid&&e._retrieveItemInModelVersionDataset(n.physicalid)})}}}),define("DS/CATFLCockpitWidget/utils/preferences.util",["UWA/Core","DS/ENOXWidgetPreferences/js/ENOXWidgetPreferences","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/services/common.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o){"use strict";var r=i.getFullConfig(),a=r.localStorageKeys,s=r.identifiers;return{buildPreferences:function(){var e=this;return t.addPlatformSelectionPreferenceToWidget({roles:["SAX"]}),widget.addEvent("onIndexOrDatabaseModeChange",this.onIndexOrDatabaseModeChange.bind(this)),t.addCredentialPreferenceToWidget({usePreferredCredentials:!0}).then(function(){widget.addPreference({name:a.showSpecDocs,type:"boolean",label:o.label_show_spec_doc,defaultValue:!1}),widget.addPreference({name:a.indexDatabaseMode,type:"list",label:o.label_index_and_database_mode,defaultValue:a.indexAndDatabaseMode,options:[{label:o.label_always_use_db,value:a.onlyDatabaseMode},{label:o.label_switch_between_index_and_db,value:a.indexAndDatabaseMode}],onchange:"onIndexOrDatabaseModeChange"}),e.addTimeoutIndexPreference(),widget.addPreference({name:a.depthFlattenedView,label:o.label_depth_flat_view,type:"range",defaultValue:"2",step:"1",min:"2",max:"10"}),widget.addPreference({name:a.depthFlattenedViewArchitectureItemOnly,label:o.label_depth_flat_view_arch,type:"range",defaultValue:"4",step:"1",min:"2",max:"10"}),widget.addPreference({name:a.workunderpos,type:"list",label:o.label_work_under_position,defaultValue:"bottom-right",options:[{label:o.label_upper_left,value:"top-left"},{label:o.label_upper_right,value:"top-right"},{label:o.label_lower_left,value:"bottom-left"},{label:o.label_lower_right,value:"bottom-right"},{label:o.label_free_pos,value:s.workUnder_pos_freeValue}]}),r.disableIndexAcceleration="only_db"===widget.getPreference(a.indexDatabaseMode).value,i.cleanRecentlyAuthoredItemsInLocalStorage()})},addTimeoutIndexPreference:function(){var e={name:a.timeoutIndex,type:"list",label:o.label_time_enable_indexing,defaultValue:"180",options:[{label:o.label_one_minute,value:"60"},{label:o.label_three_minute,value:"180"},{label:o.label_five_minute,value:"300"},{label:o.label_ten_minute,value:"600"}]};"only_db"===widget.getPreference(a.indexDatabaseMode).value&&(e.disabled=!0),widget.addPreference(e)},onIndexOrDatabaseModeChange:function(e,t){this.addTimeoutIndexPreference(),r.disableIndexAcceleration="only_db"===t,widget.dispatchEvent("onEdit")},saveUserCustomAttributes:function(e){let t=e.extensions,i=e.userAdditionalAttributes,o=e.isForPhysicalProduct,a=o?r.localStorageKeys.userAdditionalAttributesForPhysicalProduct:r.localStorageKeys.userAdditionalAttributes,s={extensions:t,userAdditionalAttributes:i};o?r.userAdditionalAttributesForPhysicalProduct=i:r.userAdditionalAttributes=i,t||i?(s=JSON.stringify(s),localStorage.setItem(a,s),widget.setValue(a,s)):(localStorage.removeItem(a),widget.setValue(a,null)),n.setUserPreferences({name:a,value:s})},getNSaveUserCustomAttributes:function(e){let t=e?r.localStorageKeys.userAdditionalAttributesForPhysicalProduct:r.localStorageKeys.userAdditionalAttributes,i=widget.getValue(t)||localStorage.getItem(t);if(i){localStorage.setItem(t,i),widget.setValue(t,i);let n=JSON.parse(i);return e?r.userAdditionalAttributesForPhysicalProduct=n.userAdditionalAttributes:r.userAdditionalAttributes=n.userAdditionalAttributes,Promise.resolve(n)}return n.getUserPreferences(t).then(function(i){return i&&0!==Object.keys(i).length&&(localStorage.setItem(t,JSON.stringify(i)),widget.setValue(t,JSON.stringify(i)),e?r.userAdditionalAttributesForPhysicalProduct=i.userAdditionalAttributes:r.userAdditionalAttributes=i.userAdditionalAttributes),i})},saveUserCustomViews:function(e,t){let i=r.localStorageKeys.customViews,o={customViews:e,currentCustomViewIdentifier:t},a=JSON.stringify(o);localStorage.setItem(i,a),widget.setValue(i,a),n.setUserPreferences({name:i,value:a})},getUserCustomViews:function(){let e=r.localStorageKeys.customViews,t=widget.getValue(e)||localStorage.getItem(e);return t?Promise.resolve(JSON.parse(t)):n.getUserPreferences(e).then(function(t){return 0!==Object.keys(t).length&&(localStorage.setItem(e,JSON.stringify(t)),widget.setValue(e,JSON.stringify(t))),t})},saveCustomHeaderView:function(e){var t=r.localStorageKeys.customHeaderView,i=JSON.stringify(e);localStorage.setItem(t,i),widget.setValue(t,i),n.setUserPreferences({name:t,value:i}),r.customHeaderView=e},getCustomHeaderView:function(){var e=r.localStorageKeys.customHeaderView,t=widget.getValue(e)||localStorage.getItem(e);return t?(r.customHeaderView=JSON.parse(t),Promise.resolve(JSON.parse(t))):n.getUserPreferences(e).then(function(t){return 0!==Object.keys(t).length&&(localStorage.setItem(e,JSON.stringify(t)),widget.setValue(e,JSON.stringify(t))),r.customHeaderView=t,t})}}}),define("DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller",["DS/CATFLCockpitWidget/utils/modelObj.util","DS/CATFLCockpitWidget/utils/contextManager.util"],function(e,t){"use strict";return{init:function(e,t){e&&this._generateCommand(e,t)},_generateCommand:function(i,n){var o,r=this;switch(t.resetSelection(),i){case"HistoryCommand":n.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/LifecycleCmd/HistoryCmd","css!DS/egraph/views.css"],function(e){r.historyCmd&&r.historyCmd.historyDlg||(r.historyCmd=new e({context:t.getContext(),ID:"HistoryHdr"}),r._beginCommand(r.historyCmd))});break;case"DuplicateCommand":widget._biFilter&&t.setBIFilter(widget._biFilter),n.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/LifecycleCmd/DuplicateCmd"],function(e){r.duplicateCmd=new e({context:t.getContext(),ID:"DuplicateHdr"}),r._beginCommand(r.duplicateCmd)});break;case"MaturityCommand":n.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/LifecycleCmd/MaturityCmd","css!DS/egraph/views.css"],function(e){r.maturityCmd=new e({context:t.getContext(),ID:"MaturityHdr"}),r._beginCommand(r.maturityCmd)});break;case"EditConfigurationContextCmd":n.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/EditConfigurationContextCmd"],function(e){r.editConfigurationContextCmd=new e,r.editConfigurationContextCmd.execute()});break;case"SelectByConfigurationCriteriaCmd":n.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/SelectByConfigurationCriteriaCmd"],function(e){r.selectByConfigurationCriteriaCmd=new e,r.selectByConfigurationCriteriaCmd.execute()});break;case"CopyVariantEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/CopyVariantEffectivityCmd"],function(e){r.copyVariantEffectivityCmd=new e(n),r.copyVariantEffectivityCmd.execute()});break;case"PasteVariantEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/PasteVariantEffectivityCmd"],function(e){r.pasteVariantEffectivityCmd=new e,r.pasteVariantEffectivityCmd.execute()});break;case"EditVariantEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/EditVariantEffectivityCmd"],function(e){r.editVariantEffectivityCmd=new e(n),r.editVariantEffectivityCmd.execute()});break;case"CopyEvolutionEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/CopyEvolutionEffectivityCmd"],function(e){r.copyEvolutionEffectivityCmd=new e(n),r.copyEvolutionEffectivityCmd.execute()});break;case"PasteEvolutionEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/PasteEvolutionEffectivityCmd"],function(e){r.pasteEvolutionEffectivityCmd=new e,r.pasteEvolutionEffectivityCmd.execute()});break;case"EditEvolutionEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/EditEvolutionEffectivityCmd"],function(e){r.editEvolutionEffectivityCmd=new e(n),r.editEvolutionEffectivityCmd.execute()});break;case"ExtendEvolutionEffectivityCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/ExtendEvolutionEffectivityCmd"],function(e){r.editEvolutionEffectivityCmd=new e,r.editEvolutionEffectivityCmd.execute()});break;case"AddToConfigurationRevisionCmd":n.items.forEach(function(i){o=new e(i),t.addSelection(o)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/AddToConfigurationRevisionCmd"],function(e){r.addToConfigurationRevisionCmd=new e,r.addToConfigurationRevisionCmd.execute()});break;case"ChangeOwnerCommand":n.forEach(function(i){(o=new e(i)).options={grid:{"ds6w:type":i.displayType,"ds6wg:revision":i.revision,"ds6wg:responsible":i.owner},icons:i.icons},t.addSelection(o)}),require(["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd"],function(e){r.changeOwnerCmd=new e({context:t.getContext(),ID:"ActionBar_ChangeOwner"}),r._beginCommand(r.changeOwnerCmd)});break;case"CompareCmd":n.forEach(function(i){t.addSelection(new e(i))}),require(["DS/CompareCmd/CompareCmd"],function(e){r.compareCmd=new e({context:t.getContext(),ID:"CompareHdr"}),r._beginCommand(r.compareCmd)});break;case"ShareCmd":n.forEach(function(i){(o=new e(i)).options={grid:{"ds6w:type":i.displayType,"ds6wg:revision":i.revision,"ds6wg:responsible":i.owner},subLabel:i.owner,icons:i.icons},t.addSelection(o)}),require(["DS/ENOCollabSharingCmds/commands/AccessRightCmd/ActionBar_AccessRightCmd"],function(e){r.shareCmd=new e({context:t.getContext(),ID:"ActionBar_AccessRightCmd"}),r._beginCommand(r.shareCmd)});break;case"ReserveCmd":n.forEach(function(i){new e(i);t.addSelection(new e(i))}),require(["DS/ENOCollabSharingCmds/commands/ReserveCmd/ActionBar_ReserveCmd"],function(e){r.reserveHdr=new e({context:t.getContext(),ID:"ReserveHdr"}),r._beginCommand(r.reserveHdr)});break;case"UnreserveCmd":n.forEach(function(i){t.addSelection(new e(i))}),require(["DS/ENOCollabSharingCmds/commands/UnreserveCmd/ActionBar_UnreserveCmd"],function(e){r.unreserveHdr=new e({context:t.getContext(),ID:"UnreserveHdr"}),r._beginCommand(r.unreserveHdr)});break;case"NGFilterCmd":require(["DS/CATFLCockpitWidget/commands/CATFLNextGenFilterCmd"],function(e){r.nextgenFilterCmd=new e({context:t.getContext(),ID:"CATFLNextGenFilterCmd",viewController:n.viewController}),r._beginCommand(r.nextgenFilterCmd)});break;case"ReplaceByLatestRevCmd":n.forEach(function(e){t.addSelection(e)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByLatestRevisionCmd"],function(e){r.replaceByLatestRevCmd=new e({context:t.getContext(n[0].getTreeDocument()),ID:"ReplaceByLatestRevisionCmd"}),r._beginCommand(r.replaceByLatestRevCmd)});break;case"ReplaceByRevCmd":n.getSelectedNodes().forEach(function(e){e.options.grid["ds6w:responsible"]=e.options.grid.owner,e.options.grid["ds6w:type"]=e.options.grid.type,t.addSelection(e)}),require(["DS/CATFLCockpitWidget/components/CommandsCtrl/ReplaceByRevisionCmd"],function(e){r.replaceByRevisionCmd=new e({context:t.getContext(n),ID:"ReplaceByRevCmd"}),r._beginCommand(r.replaceByRevisionCmd)})}},_beginCommand:function(e){e.begin()}}}),define("DS/CATFLCockpitWidget/services/document.service",["DS/DocumentManagement/DocumentManagement","DS/CATFLCockpitWidget/utils/config.util","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],function(e,t,i){"use strict";var n=JSON.parse(i);return{getDocument:function(i,o){return new Promise(function(r,a){e.getDocumentsFromParent({getVersions:!0,relInfo:{parentDirection:"from",parentId:i,parentRelName:o?n.rel_specification:n.rel_document},securityContext:t.getSecurityContext(),tenant:t.getTenant(),tenantUrl:t.getServiceURL("3DSpace"),onFailure:function(e){a(e)},onComplete:function(e){r(e)}})})},createDocument:function(i,n,o){return new Promise(function(r,a){if(n.length>0){var s=n[0],l={title:s.name.replace(/\.[^/.]+$/,""),fileInfo:{comments:"Test file upload",file:s},relInfo:{parentId:i,parentRelName:o,parentDirection:"from"}},c={tenant:t.getTenant(),securityContext:t.getSecurityContext(),tenantUrl:t.getServiceURL("3DSpace"),onFailure:a,onComplete:r},d=t.getAuthorizedWorkUnder();d&&(c.additionalHeaders=d),e.createDocument(l,c)}else r()})},downloadDocument:function(i){var n=this;return new Promise(function(o,r){var a={tenant:t.getTenant(),securityContext:t.getSecurityContext(),tenantUrl:t.getServiceURL("3DSpace"),onFailure:r,onComplete:function(e){n.launchDownloadfromURLs(e),o()}};e.downloadDocuments(i,a)})},launchDownloadfromURLs:function(e){var t=this;e.reduce(function(e,i){return new Promise(function(n,o){e.then(function(){t._downloadFromFCS(i.downloadUrl),setTimeout(function(){n()},106)})})},new Promise(function(e,t){e()}))},_downloadFromFCS:function(e){var t=document.createElement("div");t.style.display="none",e+="&__fcs__attachment=true",t.innerHTML='<a href="'+e+'" download></a>';var i=t.querySelector("a");document.body.appendChild(t),setTimeout(function(){i.click(),document.body.removeChild(t)},66)},removeDocument:function(i,o,r){return new Promise(function(a,s){var l={relInfo:{parentId:i,parentRelName:r?n.rel_specification:n.rel_document,parentDirection:"from"},tenant:t.getTenant(),securityContext:t.getSecurityContext(),tenantUrl:t.getServiceURL("3DSpace"),onComplete:a,onFailure:s},c=t.getAuthorizedWorkUnder();c&&(l.additionalHeaders=c),e.disconnectDocumentFromParent(o,l)})},attachDocument:function(i,n,o){return new Promise(function(r,a){var s={relInfo:{parentId:i,parentRelName:o,parentDirection:"from"},tenant:t.getTenant(),securityContext:t.getSecurityContext(),tenantUrl:t.getServiceURL("3DSpace"),onComplete:r,onFailure:a},l=t.getAuthorizedWorkUnder();l&&(s.additionalHeaders=l),e.connectDocumentToParent(n,s)})}}}),define("DS/CATFLCockpitWidget/services/dimensions.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util"],function(e,t){"use strict";var i=e.getFullConfig();return{getAllDimensions:function(e){return t.get(e.webservices.getDimensionsFromDictionary).then(function(t){e.dimensions={},JSON.parse(t).results.forEach(function(t){var i={};t.Units.forEach(function(e){i[e.Name]={label:e.label,NLSName:e.NLSName}}),e.dimensions[t.Name]={MKSUnit:t.MKSUnit,NLS:t.NLS,Units:i}})})},convertValues:function(e){return t.post(i.webservices.convertValues,JSON.stringify(e)).then(function(e){return JSON.parse(e)})}}}),define("DS/CATFLCockpitWidget/commands/RelatedObjectCmd",["UWA/Utils/InterCom","DS/CATFLCockpitWidget/utils/config.util","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],function(e,t,i){"use strict";JSON.parse(i);return{execute:function(i,n){var o=t.form3DXContent([n]),r=new e.Socket("compassPageSocket");r.subscribeServer("com.ds.compass",window.parent),r.dispatchEvent("onSetX3DContent",o,"compassPageSocket"),o.appId=i,r.dispatchEvent("onLaunchApp",o,"compassPageSocket")}}}),define("DS/CATFLCockpitWidget/services/space.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o){var r=e.getFullConfig();return{getSpaceHierarchy:function(e){return i.get(r.webservices.getSpaceHierarchy+e).then(function(e){return JSON.parse(e).spaceHierarchy}).catch(function(e){var i=o.error_get_space_hierarchy,n=e.error.message.slice(e.error.message.indexOf("ResponseCode"));n&&n.indexOf("404")>=0&&(i=o.error_missing_space_media),t.displayError(e,null,null,i)})},createSPPConnection:function(e,a){var s={SPPConnections:[{Objects:[],Spaces:[]}]};return e instanceof Array&&e.length>20&&t.alertMessage("warning",null,o.replace(o.msg_bulkOperation_limitReached,{limit:20})),e.forEach(function(e){s.SPPConnections[0].Objects.push({physicalid:e.options.physicalid,logicalid:e.options.logicalid,majorid:e.options.majorid,type:e.options.type})}),a.forEach(function(e){s.SPPConnections[0].Spaces.push({physicalid:e.options.physicalid,logicalid:e.options.logicalid,majorid:e.options.majorid,type:e.options.type||r.identifiers.type_design_ref})}),i.post(r.webservices.createSPPConnection,JSON.stringify(s),0).then(function(i){return t.alertMessage("success",null,o.msg_assign_spaces_success),n.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:e}),JSON.parse(i)},function(e){var i=e.error.message.slice(e.error.message.indexOf("ResponseCode"));if(i){if(i.indexOf("401")>=0)return void t.displayError("error",o.error_assign_space_failed_title,o.error_assign_space_failed_subtitle,null);if(i.indexOf("404")>=0)return void t.displayError("error",null,null,o.error_missing_space_media)}t.displayError("error",null,null,o.error_generic_system_and_network)})},navigateSPPConnection:function(e){return i.makeServiceCall(r.webservices.navigateSPPConnection,"POST",JSON.stringify({physicalids:e}),!0).then(function(e){return JSON.parse(e).results}).catch(function(e){var i=o.error_get_spaces_attached,n=e.error.message.slice(e.error.message.indexOf("ResponseCode"));n&&n.indexOf("404")>=0&&(i=o.error_missing_space_media),t.displayError(e,null,null,i)})},deleteSPPConnection:function(e,a){return i.post(r.webservices.deleteSPPConnection,JSON.stringify({physicalids:e})).then(function(){t.alertMessage("success",null,o.msg_delete_spaces_success),n.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:a})},function(e){let i=e.error.message.slice(e.error.message.indexOf("ResponseCode"));if(i){if(i.indexOf("401")>=0)return void t.displayError("error",o.error_del_space_failed_title,o.error_assign_space_failed_subtitle,null);if(i.indexOf("404")>=0)return void t.displayError("error",null,null,o.error_missing_space_media)}t.displayError("error",null,null,o.error_generic_system_and_network)})}}}),define("DS/CATFLCockpitWidget/components/ConvergenceCues/ConvergenceCues.export",["DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){"use strict";return{exportCuesForItems:function(){var o,r,a=this.contentListViewController.contentView.treeDocument.getSelectedNodes(),s=[];if(a.length<=0)i.alertMessage("error",null,n.error_cue_export_noSelItems);else if(o=this.contentListViewController.contentView.treeDocument.getRoots()[0].options.physicalid,1!==a.length||a[0]._options.physicalid!==o){for(var l=[],c=!1,d=0;d<a.length;d++)a[d].options.instance&&(r=a[d].options.instance.physicalid,s.push(r),l.push(a[d]),a[d].options.cueDetails&&(c=!0));var u=t.confAllImplPathsOnNodes(l,!1,!1);s&&s.length>0&&(a.length>20&&i.alertMessage("info",null,n.info_download_short_while),c&&i.alertMessage("warning",null,n.msg_cue_export_warning),e.exportVisualCues(s,u.payload))}else i.alertMessage("error",null,n.error_export_cue_computation_root)}}}),define("DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrix",["DS/Menu/Menu","DS/CATFLWebMatrix/TraceabilityMatrix","DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbar","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/implementlink.service","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s){"use strict";var l=JSON.parse(a);return{init:function(e){var n=this;n.field={inverted:!1,expandLevel:0},n.firstSystem=e.system1,n.secondSystem=e.system2,n.linkType=e.linkType,n.typesMap=e.typesMap,n.trMatrixModelEvents=e.modelEvents;var r=n.container=UWA.createElement("div",{class:"trmatrix-main-container"}),a=UWA.createElement("div",{class:"trmatrix-toolbar-container"}).inject(r);if(n.trMatrixToolbar=new i(n,a),n.trMatrixContainer=UWA.createElement("div",{class:"traceability-matrix-container"}).inject(r),n.field.rows=[],n.field.columns=[],n.firstSystem.getChildren()&&n.secondSystem.getChildren())return n.firstSystem.getChildren().forEach(function(e){n.field.rows.push(n.generateStructure(e,!0))}),n.secondSystem.getChildren().forEach(function(e){n.field.columns.push(n.generateStructure(e,!1))}),t.resetRefRefMap(),n.createMatrix(),r;o.alertMessage("error",null,"",s.msg_system_missing_children)},injectMatrix:function(){this.trMatrix&&this.trMatrix.inject(this.trMatrixContainer)},createMatrix:function(){var e=this;e.trMatrix&&e.trMatrix.container.remove();var i={rows:e.field.inverted?e.field.columns:e.field.rows,columns:e.field.inverted?e.field.rows:e.field.columns,fixedHeaders:!0},o={onContextMenu:e.manageContextualMenuEvt.bind(e),onNewCell:e.manageCellDisplay.bind(e)};e.trMatrix=new t.Matrix(i,o),e.trMatrix.onCellSelected=function(i,o,r){if(t.Matrix.prototype.onCellSelected.call(this,i,o,r),!e.trMatrix.loading&&i&&i.getState()===t.CellState.NORMAL)if(i.relations.length>0){var a=o.data&&o.data.name?o.data.name:"",l=r.data&&r.data.name?r.data.name:"",c=UWA.createElement("p",{html:s.msg_delete_implementLink_confrimation+a+" & "+l});n.createWindow(s.label_delete_implementLink_header,c,s.action_delete,e.deleteImplementLink.bind(e,i,o,r))}else e.createImplementLink(i,o,r)}},generateStructure:function(e,t){var i,n,o=e.options.label||e.options.grid.name;o+=" "+e.options.grid.revision,e.options.instance&&e.options.instance.name&&(o+="("+e.options.instance.name+")"),i={id:e.options.instance?e.options.instance.physicalid:e.options.physicalid,type:e.options.instance.type,name:o+" "+e.options.grid.revision,refId:e.options.physicalid,refType:e.options.grid.actualType,node:e,isContext:t,children:[],relations:e.relations};var r=e.getChildren();if(r)for(n=0;n<r.length;n++)i.children.push(this.generateStructure(r[n],t));return i},_setLoading:function(e){this.trMatrix.loading=e,this.trMatrix.table.toggleClass("loading",e)},createImplementLink:function(e,i,n){var a=this;e.setState(t.CellState.LOADING),a._setLoading(!0);var l=a.formDataObjFromCell(i,n);r.createOccurrenceLinks(l).then(function(){var r={id:e.id};r.path=i.getPath(),a._setLoading(!1),e.setState(t.CellState.NORMAL),e.addRelation(r),a.trMatrix.registerRelation(i,n,r);var c={};i.data.isContext?(c.firstSystemNode=i.data.node,c.secondSystemNode=n.data.node,c.ctxPath=l[0].implementing):(c.secondSystemNode=i.data.node,c.firstSystemNode=n.data.node,c.ctxPath=l[0].implemented),a.trMatrixModelEvents.publish({event:"occLink-refresh",data:c}),o.alertMessage("success",null,"",s.msg_occ2occ_create_success)}).catch(function(i){a._setLoading(!1),e.setState(t.CellState.NORMAL),o.displayError(i,null,null,s.error_create_occocc_link)})},deleteImplementLink:function(e,i,n){var a=this;e.setState(t.CellState.LOADING),a._setLoading(!0);var l=a.formDataObjFromCell(i,n);r.deleteOccurrenceLinks(l).then(function(){a._setLoading(!1),e.setState(t.CellState.NORMAL);var r=e.relations[0];e.removeRelation(r),a.trMatrix.unregisterRelation(i,n,r);var c={};i.data.isContext?(c.firstSystemNode=i.data.node,c.secondSystemNode=n.data.node,c.ctxPath=l[0].implementing):(c.secondSystemNode=i.data.node,c.firstSystemNode=n.data.node,c.ctxPath=l[0].implemented),a.trMatrixModelEvents.publish({event:"occLink-refresh",data:c}),o.alertMessage("success",null,"",s.msg_delete_link_success)}).catch(function(i){a._setLoading(!1),e.setState(t.CellState.NORMAL),o.displayError(i,null,null,s.error_delete_link)})},formDataObjFromCell:function(e,t){var i,n,o=this.getPathFromNodeToRoot(e.data.node,[]),r=this.getPathFromNodeToRoot(t.data.node,[]),a=o.path,s=r.path,l=[];return o.root===this.firstSystem.options.physicalid?(i=a,n=s):(i=s,n=a),"implementing"===this.linkType?l.push({implementing:i,implemented:n}):l.push({implementing:n,implemented:i}),l},getPathFromNodeToRoot:function(e,t){return e.isRoot()?(t.reverse(),{path:t,root:e.options.physicalid}):(t.push(e.options.instance.physicalid),this.getPathFromNodeToRoot(e.getParent(),t))},manageCellDisplay:function(e,i,n){i.data.refType!==l.type_chapter&&n.data.refType!==l.type_chapter||e.setState(t.CellState.DISABLED)},manageContextualMenuEvt:function(t,i){e.show(this.getContextualMenu(t),{input:"mouse",position:{x:i.pageX,y:i.pageY},submenu:"auto"})},getContextualMenu:function(e){var t=this;return[{type:"PushItem",title:s.action_set_root,fonticon:{content:"wux-ui-3ds wux-ui-3ds-open"},action:{callback:function(){t.trMatrix.setCurrentRoot(e)}}}]},getOption:function(e){if(this.field&&this.field.hasOwnProperty(e))return this.field[e]},setOption:function(e,t){this.field||(this.field={}),this.field[e]=t}}}),define("DS/CATFLCockpitWidget/components/IDCard/decorators/idcard.database-icon",["DS/Controls/TooltipModel","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/tooltip.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r){"use strict";let a=i.getFullConfig();const s="only_db",l="only_index",c="index_and_db";return{addDatabaseIcon:function(e){this.idcard=e,this.tooltips=n.loadTooltips(["indexModeActive","databaseModeActive"]),this.databaseIcon=this.idcard.container.querySelector(".generic-icon"),this.prefIndexDatabaseMode=widget.getPreference(a.localStorageKeys.indexDatabaseMode).value,this.prefTimeoutIndex=parseInt(widget.getPreference(a.localStorageKeys.timeoutIndex).value,10),this._reset(),this.prefIndexDatabaseMode===a.localStorageKeys.indexAndDatabaseMode&&(this.flwebModelEvents=o.getFLWebModelEventsObj("flweb-model-events"),this.flwebModelEvents.subscribe({event:"item-loaded-from-database"},this._onItemLoadedFromDatabase.bind(this)),this.flwebModelEvents.subscribe({event:"flweb-ngfilter-added"},this._reset.bind(this)))},_reset:function(){this.prefIndexDatabaseMode===a.localStorageKeys.onlyDatabaseMode?this._updateDatabaseIcon(s):this._updateDatabaseIcon(l),this._clearTimeoutSwitchBackToIndexMode()},_updateDatabaseIcon:function(e){this.currentState=e,this.databaseIcon.classList.remove("fonticon-database","fonticon-database-refresh","fonticon-database-hourglass","active","active-light"),e===l?(widget.setValue("databaseModeActive",0),n.setTooltip(this.databaseIcon,this.tooltips.indexModeActive),this.databaseIcon.classList.add("fonticon","fonticon-database-refresh")):(widget.setValue("databaseModeActive",1),n.setTooltip(this.databaseIcon,this.tooltips.databaseModeActive),e===c?this.databaseIcon.classList.add("fonticon","fonticon-database-hourglass","active"):e===s&&this.databaseIcon.classList.add("fonticon","fonticon-database","active-light"))},_onItemLoadedFromDatabase:function(e){this.prefIndexDatabaseMode===a.localStorageKeys.indexAndDatabaseMode&&(this.currentState!==c&&(e.authoring&&t.alertMessage("info",r.title_switched_to_db_mode,null,r.msg_switched_to_db_mode),this._updateDatabaseIcon(c)),this.timeoutSwitchBackToIndex?e.timestamp+1e3*this.prefTimeoutIndex>this.timeoutEnd&&this._launchTimeoutSwitchBackToIndexMode(e.timestamp):this._launchTimeoutSwitchBackToIndexMode(e.timestamp))},_launchTimeoutSwitchBackToIndexMode:function(e){let i=this;i._clearTimeoutSwitchBackToIndexMode(),i.timeoutEnd=e+1e3*this.prefTimeoutIndex,i.timeoutSwitchBackToIndex=setTimeout(function(){t.alertMessage("info",r.title_switched_to_index_mode,null,r.replace(r.msg_switched_to_index_mode_auto,{timeout:i.prefTimeoutIndex/60})),i._updateDatabaseIcon(l)},i.timeoutEnd-Date.now())},_clearTimeoutSwitchBackToIndexMode:function(){this.timeoutSwitchBackToIndex&&clearTimeout(this.timeoutSwitchBackToIndex),this.timeoutEnd=null}}}),define("DS/CATFLCockpitWidget/components/ExportCSV/ExportGridView",["DS/DataGridView/DataGridView","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r){"use strict";var a=n.getFullConfig().localStorageKeys;return{exportgridViewCSV:function(i){var n=[{text:r.label_export_row_order,dataIndex:"order",typeRepresentation:"number"},{text:r.label_export_level,dataIndex:"level"}];let a={},s=o.getUserCustomAttributes()||[],l=o.getUserCustomAttributes(!0)||[],c=s.concat(l);c&&c.forEach(function(e){e.isOnPhysicalProduct?a["physical_"+e.curi]=e:e.bo?a[e.curi]=e:a["instance_"+e.curi]=e});var d=i.layout.getVisibleOrderedLeafColumns(),u=["cue","ConfigurationContext","Effectivity","VariantEffectivity","CurrentEvolutionEffectivity","ProjectedEvolutionEffectivity","assignedSpaces"];d.forEach((e,t)=>{if(!u.includes(e.dataIndex)){let t=a[e.dataIndex];var i=e.text;t?t.bo||(i="("+r.label_export_instance+") "+i):"instance_description"!==e.dataIndex&&"instanceName"!==e.dataIndex||(i="("+r.label_export_instance+") "+i),n.push({text:i,dataIndex:e.dataIndex,getCellValueForExport:function(i){if(i.nodeModel){var n=i.cellModel;if(void 0!==n)if("modificationDate"===e.dataIndex||"creationDate"===e.dataIndex){if(n instanceof Date)return n.toISOString()}else{if(Array.isArray(n))return t&&"date"===t.type&&(n=n.map(e=>{if(e)return o.formatDate(e).toLocaleDateString()})),n.join(",");if(t&&"date"===t.type){if(n)return o.formatDate(n).toLocaleDateString()}else if("customBoolean"===e.typeRepresentation||"boolean"===e.typeRepresentation)return n.toString()}}return i.cellModel}})}});var p=new e({treeDocument:new t({useAsyncPreExpand:!0}),columns:n}),g=this._processTreeDocumentForExport(p,i),m=i.treeDocument.getRoots()[0].options.label+".csv",f=p.getAsCSV();f=this._addFilterInformation(f,p,i),f=this._addHeaderInformation(f,m,g,i),o.downloadFile(m,f,!0)},_addFilterInformation:function(e,t,i){var n="",o=i.treeDocument.getFilterManager().filterModel;return t.columns.forEach((e,t)=>{var i="",r=e.dataIndex;if("tree"===e.dataIndex&&(r="label"),o[r]&&o[r].filterModel&&Object.keys(o[r].filterModel).length>0){var a=o[r].filterModel;i='"'+(i=a.condition1?function e(t,i,n){var o=t["condition"+n];if(o)return 1!==n&&(i=i+" "+t.operator),i=i+" "+o.type+(o.filter?' "'+o.filter+'"':""),e(t,i,n+1);return i}(a,"",1):JSON.stringify(a)).replace(/\"/g,'""')+'"'}n=n+i+","}),e=n+"\n"+e},_addHeaderInformation:function(e,t,i,o){var s=new Date,l=n.getUser("isFullName"),c=r.label_none,d=widget.getValue("ngFilter"),u=widget.getValue("currentConfig");if(d&&d.length>0)c=JSON.parse(d).filterTitle;else if(u&&u.modelVersion&&u.modelVersion.physicalid){var p=u.modelVersion.name+" "+u.modelVersion.revision;if(u.pc&&u.pc.physicalid){var g=u.pc.label?u.pc.label:u.pc.name;g.startsWith("[")&&g.endsWith("]")&&(g=g.slice(1,g.length-1)),p=p+" "+g}c=p}var m=widget.getValue("component-view"),f="";"structured-view"===m?f=r.action_structured:"flattened-view"===m?f=r.replace(r.action_flattened,{levelCnt:parseInt(widget.getPreference(a.depthFlattenedView).value,10)}):"flattend-view-only-architecture-item"===m&&(f=r.replace(r.action_flattened_arch,{levelCnt:parseInt(widget.getPreference(a.depthFlattenedViewArchitectureItemOnly).value,10)}).replace(",",""));var h=widget.getValue("configurable_expand"),v=h.specDocs,C=h.proposedSolution,b=h.implementing&&"structured-view"===m,y=o.options.currentSpecificFilter,_=r.label_none;return"PilotingDisciplines"===y?_=r.action_piloting_discipline_filter:"Disciplines"===y?_=r.action_discipline_filter:"ProposedSolutions"===y&&(_=r.action_proposed_solutions_filter),e=r.label_export_gridview+"\n"+r.label_filename+","+t+"\n"+r.label_export_datetime_utcformat+","+s+"\n"+r.label_exported_by+","+l+"\n"+r.label_applied_current_view+","+f+"\n"+r.label_applied_product_configuration+","+c+"\n"+r.label_applied_current_specific_filter+","+_+"\n"+r.label_export_proposed_solutions+","+(C?r.label_yes:r.label_no)+"\n"+r.label_export_specification_documents+","+(v?r.label_yes:r.label_no)+"\n"+r.label_export_discipline_references+","+(b?r.label_yes:r.label_no)+"\n"+r.label_number_of_exported_items+","+i.nb_exported_objects+"\n"+r.label_number_of_exported_logical_instances_in_structure+","+i.nb_exported_log_instance+"\n"+r.label_number_of_exported_proposed_solutions+","+i.nb_exported_prop_sol+"\n"+r.label_number_of_exported_spec_docs+","+i.nb_exported_spec_doc+"\n"+r.label_number_of_exported_piloting_disc_ref+","+i.nb_exported_piloting_disc+"\n\n"+r.label_export_legend+"\n"+r.label_export_SPD+","+r.label_export_spec_doc+"\n"+r.label_export_SOL+","+r.label_export_prop_sol+"\n"+r.label_export_PDR+","+r.label_export_piloting_disc+"\n"+"\n\n"+e},_processTreeDocumentForExport:function(e,t){e.treeDocument.prepareUpdate();var n=1,o={nb_exported_objects:0,nb_exported_log_instance:0,nb_exported_prop_sol:0,nb_exported_spec_doc:0,nb_exported_piloting_disc:0};function a(t){if(t&&t.getChildren()){var i=[];t.getChildren().forEach((a,l)=>{a.options.type.includes("Category")?function(t,i){if(t&&t.getChildren()&&!t.isFiltered()&&t.isVisible()){var a="",l=t.options.type,c=!!i.options.grid.architectureNumber;("specificationDocumentsCategory"===l||"proposedSolutionCategory"===l||"implementLinksCategory"===l&&c)&&t.getChildren().forEach((t,i)=>{if(!t.isFiltered()&&t.isVisible()){if("implementLinksCategory"===l){var c=t.options.linkInfo,d="ref"===c.objType&&"implementing"===c.linkType,u="L"===t.options.grid.kindOfRFLP;if(!d||!u)return;a=r.label_export_PDR,o.nb_exported_piloting_disc++}else"specificationDocumentsCategory"===l?(a=r.label_export_SPD,o.nb_exported_spec_doc++):"proposedSolutionCategory"===l&&(a=r.label_export_SOL,o.nb_exported_prop_sol++);var p=s(t,a,n);n++,o.nb_exported_objects++,e.treeDocument.addChild(p)}})}}(a,t):i.push(a)}),i.forEach(t=>(function(t){if(!t.isFiltered()&&t.isVisible()){var i=t.getNodeDepth();i>0&&o.nb_exported_log_instance++,o.nb_exported_objects++;var r=s(t,i,n);n++,e.treeDocument.addChild(r),a(t)}})(t))}}function s(e,t,n){var o=new i({label:e.options.label,grid:{...{level:t,order:n},...e.options.grid}});return Object.keys(o.options.grid).forEach((e,t)=>{if(o.options.grid[e]){var i=e.indexOf("_actual");if(-1!==i&&e.endsWith("_actual")){const t=e.substring(0,i);t&&o.options.grid[t].length<=0&&(o.options.grid[t]=o.options.grid[e])}}}),o.options.grid.isReserved="TRUE"===e.options.isReserved?r.label_export_reserved:r.label_export_not_reserved,o}return a(t.treeDocument),e.treeDocument.pushUpdate(),o}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.additionalcolumns",["DS/CATFLCockpitWidget/utils/config.util"],function(){"use strict";return{_getAdditionalColumns:function(e){return e.gridview||(e.gridview={}),Promise.all([this._getConfigurationColumns(e)])},_getConfigurationColumns:function(e){let t=[],i={},n=[];var o=new Promise(function(e){require(["DS/CfgWebAppEffectivityUX/scripts/CfgConfigurationContextColumn"],function(n){n.isAdditionalColumnsAvailable(function(o){if(!0===o){let e=[];n.getAdditionalColumnsUXDGV(e),e.forEach(e=>{e.columnModule="cfgContext",t.push(e)}),i.cfgContext=n}e()}),o.name="Add "+n.getName()})});n.push(o);var r=new Promise(function(e){require(["DS/CfgWebAppEffectivityUX/scripts/CfgEffectivityColumns"],function(n){n.isAdditionalColumnsAvailable(function(o){if(!0===o){let e=[];n.getAdditionalColumnsUXDGV(e),e.forEach(e=>{e.columnModule="cfgEffectivty",t.push(e)}),i.cfgEffectivty=n}e()}),r.name="Add "+n.getName()})});n.push(r);var a=new Promise(function(e){require(["DS/CfgWebAppEffectivityUX/scripts/CfgConfigurationRevisionColumn"],function(n){n.isAdditionalColumnsAvailable(function(o){if(!0===o){let e=[];n.getAdditionalColumnsUXDGV(e),e.forEach(e=>{e.columnModule="ConfigurationRevision",t.push(e)}),i.ConfigurationRevision=n}e()}),a.name="Add "+n.getName()})});return n.push(a),Promise.all(n).then(function(){t.length>0&&(e.gridview._additionalColumns?e.gridview._additionalColumns.push(...t):e.gridview._additionalColumns=t),Object.keys(i).length>0&&(e.gridview.additionalColumnsModules=i)})}}}),define("DS/CATFLCockpitWidget/services/config.service",["DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.additionalcolumns","text!DS/CATFLCockpitWidget/assets/config/mapping.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a){"use strict";var s={PRIVATE:"Private",IN_WORK:"In Work",FROZEN:"Frozen",RELEASED:"Released",OBSOLETE:"Obsolete",Private:"Private",InWork:"In Work",Frozen:"Frozen",Release:"Release",Obsolete:"Obsolete"};return{extendConfiguration:function(e){return Promise.all([this._getSubTypesMetaData(e),this._getBasicAttributesProperties(e),this._getAdditionalAttributesRangeValues(e),this._getNlsMaturityValues(e),this._getConfiguredAdminStatus(e),o._getAdditionalColumns(e),t.getAllDimensions(e)])},_getNlsMaturityValues:function(t){return new Promise(function(i){e.getNlsOfPropertiesValues(JSON.stringify({"ds6w:status":["PRIVATE","IN_WORK","FROZEN","RELEASED","OBSOLETE","Private","InWork","Frozen","Release","Obsolete"]}),{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){var n=e["ds6w:status"];for(var o in t.MAPPING_MATURITY={},n)n.hasOwnProperty(o)&&(t.MAPPING_MATURITY[o]=n[o]);i()},onFailure:function(){t.MAPPING_MATURITY=s,i()}})})},getNLSOfKeyValues:function(t){return new Promise(function(i){e.getNlsOfPropertiesValues(JSON.stringify(t),{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){e&&i(e)},onFailure:function(){console.warn("FedDictionaryAccessAPI.getNlsOfPropertiesValues failed for"+t),i()}})})},_getBasicAttributesProperties:function(t){return new Promise(function(i,n){e.getPropertiesForClass(t.identifiers.type_act_logref+","+t.identifiers.type_act_loginstance,{apiVersion:"R2019x",lang:widget.lang||"en",tenantId:widget.getValue("x3dPlatformId"),onComplete:function(e){t.nlsBasicAttributesBO={},t.nlsBasicAttributesRel={},e[0].properties.forEach(function(e){-1!==t.identifiers.index_services.select_bo.indexOf(e.curi.toLowerCase())&&(t.nlsBasicAttributesBO[e.curi]=e.label)}),e[1].properties.forEach(function(e){-1!==t.identifiers.index_services.select_rel.indexOf(e.curi)&&(t.nlsBasicAttributesRel[e.curi]=e.label)}),i()},onFailure:function(){n()}})})},_getAdditionalAttributesRangeValues:function(){var t=n.getUserCustomAttributes()||[],i=n.getUserCustomAttributes(!0)||[],o=t.concat(i),r={},a={};return o.forEach(function(e){if(void 0!==e.rangeValues){r[e.curi]=[],a[e.curi]={};for(var t=0;t<e.rangeValues.length;t++)r[e.curi].push(e.rangeValues[t].value),a[e.curi][e.rangeValues[t].value]=e.rangeValues[t]}}),new Promise(function(t){e.getNlsOfPropertiesValues(JSON.stringify(r),{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(e){o.forEach(function(t){if(void 0!==e[t.curi])for(var i in e[t.curi])e[t.curi].hasOwnProperty(i)&&(a[t.curi][i].nlsValue=e[t.curi][i])}),t()},onFailure:function(){t()}})})},_getSubTypesMetaData:function(e){return e.logicalRefSubTypes=[],i.post(e.webservices.dsfl_getSubTypesMetaData,JSON.stringify([e.identifiers.type_act_logref]),0).then(function(t){e.logicalRefSubTypes=JSON.parse(t).Types,e.logicalRefSubTypes.forEach(function(t){void 0===e.mappingType[t.Name]&&(e.mappingType[t.Name]={nlsName:t.NLS,icon:t.IconName})})}).catch(function(e){var t=e.error.message.slice(e.error.message.indexOf("ResponseCode")),i=a.error_get_subtypes;t&&t.indexOf("404")>=0&&(i=a.error_get_subtypes_media),n.displayError(e,null,null,i)})},_getConfiguredAdminStatus:function(e){let t=e.webservices.getReadOnlyAdminSettings;return e.adminStatus={},i.post(t,JSON.stringify({})).then(function(t){for(var i in t=JSON.parse(t))"status"!==i&&(e.adminStatus[i]=t[i])}).catch(function(){})}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.configure.expand",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l){"use strict";var c=JSON.parse(s),d=function(e){this.options=e};return d.prototype.render=function(e){var n=this,o=n.getExpandOptionsContainer();n.dialog=new t({title:l.action_configure_expand,content:o,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new i({label:l.apply_button,emphasize:"primary",disabled:!0,onClick:n._applyConfiguredExpandOperation.bind(n,e)}),Cancel:new i({emphasize:"secondary",onClick:function(){n.dialog.close()}})},activateButtonsIfActionPerformed:!1}),n.dialog.addEventListener("close",function(){n.dialog.destroy()})},d.prototype.getExpandOptionsContainer=function(){let t=this,i=widget.getValue("configurable_expand"),a=!1;i||(a=!0,i={});var s=widget.getValue(c.componentView);let d=e.createElement("div",{class:"configure-expand-options-container"});t.optsButtonGroup=new n({type:"checkbox"});let u=s===c.structuredView;return t.optsButtonGroup.addChild(new o({type:"checkbox",label:l.label_implementing,value:"implementing",checkFlag:i.implementing||a,visibleFlag:u})),t.optsButtonGroup.addChild(new o({type:"checkbox",label:l.label_is_implementing,value:"isImplementing",checkFlag:i.isImplementing||a,visibleFlag:u})),t.optsButtonGroup.addChild(new o({type:"checkbox",label:l.label_implemented_by,value:"implementedBy",checkFlag:i.implementedBy||a,visibleFlag:u})),t.optsButtonGroup.addChild(new o({type:"checkbox",label:l.label_is_implemented_by,value:"isImplementedBy",checkFlag:i.isImplementedBy||a,visibleFlag:u})),t.optsButtonGroup.addChild(new o({type:"checkbox",label:l.label_proposed_solution,value:"proposedSolution",checkFlag:i.proposedSolution||a})),t.optsButtonGroup.addChild(new o({type:"checkbox",label:l.label_spec_documents,value:"specDocs",checkFlag:i.specDocs||a})),t.optsButtonGroup.addEventListener("change",function(){let e,n=Object.keys(i)||[],o=t.optsButtonGroup.value,a=!1;o.indexOf("isImplementing")>=0&&o.indexOf("implementing")<0&&(t.optsButtonGroup.getButtonFromValue("implementing").checkFlag=!0,a=!0),o.indexOf("isImplementedBy")>=0&&o.indexOf("implementedBy")<0&&(t.optsButtonGroup.getButtonFromValue("implementedBy").checkFlag=!0,a=!0),a&&(o=t.optsButtonGroup.value,r.alertMessage("warning",null,l.msg_config_exp_occLink_warning)),e=o.length===n.length&&o.every(function(e){return n.indexOf(e)>=0});var s=t.dialog.buttons.Ok;s.disabled=!!e}),t.optsButtonGroup.inject(d),d},d.prototype._applyConfiguredExpandOperation=function(e){let t={};this.optsButtonGroup.value.forEach(function(e){t[e]=!0}),widget.setValue("configurable_expand",t),e.setConfigureExpandButtonActiveState(t),a.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-refresh"}),this.dialog.close()},d}),define("DS/CATFLCockpitWidget/services/pno.service",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util"],function(e,t){var i=e.getFullConfig();return{getPnO:function(e){return t.get(i.webservices.pno+e).then(function(e){return JSON.parse(e)})}}});var map={};define("DS/CATFLCockpitWidget/utils/pno.util",["DS/CATFLCockpitWidget/services/pno.service"],function(e){return{getFullName:function(t){return void 0===map[t]&&(map[t]=e.getPnO(t)),map[t].then(function(e){return e.firstname+" "+e.lastname})}}}),define("DS/CATFLCockpitWidget/parser/index.parser",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/utils/pno.util","DS/CATFLCockpitWidget/services/config.service","text!DS/CATFLCockpitWidget/assets/config/mapping.conf.json"],function(e,t,i,n,o,r){"use strict";var a=JSON.parse(r),s=t.getFullConfig(),l=s.identifiers;return{attributes:function(t){let i=this,n=[],o=e.getUserCustomAttributes(),r=[],l=[],c=[];return o&&o.forEach(function(e){e.manipulationUnit&&r.push(e.curi),e.multiValuated&&l.push(e.curi),(e.isSharedPredicateOnSameType||e.isSharedPredicate&&(e.isClassification||e.isOnExtension))&&c.push(e.curi)}),t&&t.forEach(function(t){let d,u,p={};for(d in t)if(t.hasOwnProperty(d))if(u=a[d],"ds6w:label"===d)p.label=t[d];else if("ds6wg:revision"===d)p.revision=t[d];else if("ds6wg:PLMReference.V_isLastVersion"===d)p.isLastVersion="TRUE"===t[d].toUpperCase();else if("ds6w:islastrevision"!==d||p.hasOwnProperty("isLastVersion"))if("ds6w:status"===d)p.status=t[d],p[u]=s.MAPPING_MATURITY[t[d].split(".")[1]]||t.current;else if("ds6w:responsible"===d)p.owner=t[d];else if("ds6w:reserved"===d)p.isReserved=t[d];else if("ds6w:created"===d||"ds6w:modified"===d)p[u]=e.formatDate(t[d]);else if("ds6w:description"===d)p.description=t[d];else if("ds6w:type"===d){let e=s.mappingType[t[d]];e&&e.nlsName&&(p[u]=e.nlsName),p.actualType=t[d]}else if("type_icon_url"===d)p.icons={iconPath:t[d],iconSize:{height:"16px",width:"16px"}};else if("ds6w:identifier"===d)p[u]=t[d];else if("ds6wg:architectureextension.v_architecturenumber"===d)p[u]=t[d];else if("taxonomies"===d){let e,n=t[d];if(Array.isArray(n))for(var g=0;g<n.length&&null===(e=i.getKindOfRFLPFromTaxonomy(n[g]));g++);else e=i.getKindOfRFLPFromTaxonomy(n);p.kindOfRFLP=e,p[d]=t[d]}else"ds6wg:EnterpriseExtension.V_PartNumber"===d?p["physical_"+d]=t[d]:((l.indexOf(d)>=0||c.indexOf(d)>=0)&&!Array.isArray(t[d])&&(t[d]=t[d]?[t[d]]:[]),r.indexOf(d)>=0?(p[d+"_actual"]=t[d],p[d]=""):p[d]=t[d]);else p.isLastVersion="TRUE"===t[d].toUpperCase();o&&o.forEach(function(t){e.getNLSValueFromRangeValuesAttribute(t,t.curi,p)}),n.push(p)}),n},parseDataToNodeFormat:function(e){let t=e.data,i=[];return t.forEach(function(t){let n={physicalid:t.physicalid,label:t.label,type:t.actualType||t.type,icons:[t.icons],children:void 0};e.virtual&&(n.virtual=e.virtual),n.grid=JSON.parse(JSON.stringify(t)),i.push(n)}),i},getKindOfRFLPFromTaxonomy:function(e){return e.indexOf(l.type_usecase)>=0||e.indexOf(l.type_requirement)>=0||e.indexOf(l.type_reqSpec)>=0||e.indexOf(l.type_reqGroup)>=0?"R":e.indexOf(l.type_act_functref)>=0?"F":e.indexOf(l.type_act_logref)>=0?"L":e.indexOf(l.type_act_physical)>=0?"P":null},progressiveExpandParser:function(t){let i=this;if(!t.results)return null;let n={},r={},a=[],s=[];if(t){let c=t.results||[],d=e.getUserCustomAttributes(),u=[],p=[],g=[],m={},f={};d&&d.forEach(function(e){e.manipulationUnit&&u.push(e.curi),e.multiValuated&&p.push(e.curi),(e.isSharedPredicateOnSameType||e.isSharedPredicate&&(e.isClassification||e.isOnExtension))&&g.push(e.curi)});for(let e=0;e<c.length;e++){let t,n=c[e];n.taxonomies?(-1!==n.taxonomies.indexOf(l.type_act_logref)?t=i.parseProgressiveExpandItemAttr(n,u,p,g,m,f):-1!==n.taxonomies.indexOf(l.type_act_loginstance)&&(t=i.parseProgressiveExpandInstAttr(n,u,p,g,m,f)),t&&(r[t.resourceid]={attributes:t})):n.Path&&a.push(n.Path)}s.push(o.getNLSOfKeyValues(m).then(function(e){for(let t of Object.keys(f)){if(!r[t])continue;let i=r[t].attributes,n=f[t];for(let t in n)if(n.hasOwnProperty(t)){let o=e[t][n[t]];if(!o)continue;i.grid[t]=o}}})),n.map=r,n.paths=a}return Promise.all(s).then(function(){return n})},parseProgressiveExpandItemAttr:function(n,o,r,c,d,u){if(n){let m=t.getUser("isTrigram"),f=t.getUser("isFullName"),h={grid:{}};for(let i in n)if(n.hasOwnProperty(i)){let m=a[i];if("taxonomies"===i)h.type=l.type_act_logref,h.grid.kindOfRFLP="L",h.grid[i]=n[i];else if("physicalid"===i||"logicalid"===i||"majorid"===i||"resourceid"===i)h[i]=n[i],h.grid[i]=n[i];else if("ds6w:label"===i)h.label=n[i];else if("ds6w:type"===i){var p=s.mappingType[n[i]];p?(h.grid[m]=p.nlsName,h.icons=[t.getTypeIconUrl(n[i])]):(h.grid[m]=n[i],h.icons=[t.getTypeIconUrl(l.type_act_logref)]),h.grid.actualType=n[i]}else if("ds6w:status"===i)h[m]=n[i],h.grid[m]=s.MAPPING_MATURITY[n[i].split(".")[1]];else if("ds6w:created"===i||"ds6w:modified"===i)h.grid[m]=e.formatDate(n[i]);else if("ds6wg:plmreference.v_islastversion"===i)h.grid.isLastVersion="TRUE"===n[i];else if("ds6w:reserved"===i)h.grid.isReserved=n[i];else if("ds6w:reservedBy"===i)h.grid["ds6w:reservedBy"]=n[i]?n[i]:"";else if("ro.plminstance.v_effectivitycompiledform"===i)h[m]=n[i];else{var g=m||i;if(r.indexOf(g)>=0||c.indexOf(g)>=0)o.indexOf(g)>=0?(h.grid[g+"_actual"]=[],n[i]&&(h.grid[g+"_actual"]=n[i].split(","))):h.grid[g]=n[i].split(",");else if(o.indexOf(g)>=0)h.grid[g+"_actual"]=n[i],h.grid[g]="";else if("ds6w:organizationResponsible"===g){let e=n[g];d[g]||(d[g]=[]),d[g].indexOf(e)<0&&d[g].push(e),u[h.resourceid]||(u[h.resourceid]={}),u[h.resourceid][g]=e,h.grid[g]=n[i]}else h.grid[g]=n[i]}}if(h.type===l.type_act_logref){h.grid.isReservedByOther=!1,"FALSE"===h.grid.isReserved?(h.isReserved=h.grid.isReserved,h.grid.isReserved=i.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_CheckIn.png")):h.grid["ds6w:reservedBy"]===m||h.grid["ds6w:reservedBy"]===f?(h.isReserved=h.grid.isReserved,h.grid.isReserved=i.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_lock.png")):(h.isReserved=h.grid.isReserved,h.grid.isReserved=i.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_ReservedByOthers.png"),h.grid.isReservedByOther=!0);let t=e.getUserCustomAttributes();t&&t.forEach(function(t){t.bo&&(void 0===h.grid[t.curi]&&(r.indexOf(t.curi)>=0||c.indexOf(t.curi)>=0?h.grid[t.curi]=[]:h.grid[t.curi]=""),e.getNLSValueFromRangeValuesAttribute(t,t.curi,h.grid,h))}),h.grid.description=h.grid.description||"",h.grid.architectureNumber=h.grid.architectureNumber||""}return h.physicalid||(h.physicalid=h.resourceid),h}},parseProgressiveExpandInstAttr:function(i,n,o,r,c,d){if(i){let g={grid:{}};for(let e in i)if(i.hasOwnProperty(e)){let m=a[e];if("taxonomies"===e)g.type=l.type_act_loginstance;else if("physicalid"===e||"logicalid"===e||"majorid"===e||"resourceid"===e)g[e]=i[e],g.grid[e]=i[e];else if("from"===e||"to"===e)g[e]=i[e];else if("ds6w:label"===e)g.label=i[e];else if("ds6w:description"===e)g.description=i[e];else if("ds6w:type"===e){var u=s.mappingType[i[e]];u?(g.grid[m]=u.nlsName,g.icons=[t.getTypeIconUrl(i[e])]):(g.grid[m]=i[e],g.icons=[t.getTypeIconUrl(l.type_act_logref)]),g.grid.actualType=i[e]}else{var p=m||e;if(o.indexOf(p)>=0||r.indexOf(p)>=0)n.indexOf(p)>=0?(g.grid[p+"_actual"]=[],i[e]&&(g.grid[p+"_actual"]=i[e].split(","))):g.grid[p]=i[e].split(",");else if(n.indexOf(p)>=0)g.grid[p+"_actual"]=i[e],g.grid[p]="";else if("ds6w:organizationResponsible"===p){let t=i[p];c[p]||(c[p]=[]),c[p].indexOf(t)<0&&c[p].push(t),d[g.resourceid]||(d[g.resourceid]={}),d[g.resourceid][p]=t,g.grid[p]=i[e]}else g.grid[p]=i[e]}}let m=e.getUserCustomAttributes();return m&&m.forEach(function(t){t.bo||(void 0===g.grid[t.curi]&&(o.indexOf(t.curi)>=0||r.indexOf(t.curi)>=0?g.grid[t.curi]=[]:g.grid[t.curi]=""),e.getNLSValueFromRangeValuesAttribute(t,t.curi,g.grid,g))}),g.description=g.description||"",g.physicalid||(g.physicalid=g.resourceid),g}},mapAttributes:function(t){var i,n=[];return t&&t.forEach(function(t){var o=t.attributes;let r={};for(var l=0;l<o.length;l++){let t=o[l].name.split("/").pop();i=a[t],"ds6w:label"===t?r.label=o[l].value:"ds6wg:revision"===t?r.revision=o[l].value:"ds6w:status"===t?(r.status=o[l].value,r[i]=s.MAPPING_MATURITY[o[l].value.split(".")[1]]||o[l].value):"ds6w:identifier"===t?r.name=o[l].value:"ds6w:type"===t?(r.type=o[l].value,r.NLStype=o[l].dispValue):"preview_url"===t?r.icon=o[l].value:"ds6wg:architectureextension.v_architecturenumber"===t?r.architectureNumber=o[l].value:"ds6w:responsible"===t?r.owner=o[l].value:"ds6w:created"===t||"ds6w:modified"===t?(r[i]=e.formatDate(o[l].value),r[i]=e.displayDate(r[i])):r[t]=o[l].value}n.push(r)}),n}}}),define("DS/CATFLCockpitWidget/services/index.service",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/parser/index.parser","text!DS/CATFLCockpitWidget/assets/config/expandv2.conf.json"],function(e,t,i,n,o){"use strict";var r=t.getFullConfig(),a=r.identifiers,s=r.localStorageKeys,l=JSON.parse(o);return{fetch:function(e,o,a){var s={physicalid:e,label:"CATFLCockpit-ExecuteFetch",select_predicate:o,tenant:t.getTenant()};return i.makeServiceCall(r.webservices.fetchService,"POST",JSON.stringify(s),!0,null,{timeout:0}).then(function(e){var t=JSON.parse(e).results,i=[];return a?i=n.mapAttributes(t):t.forEach(function(e){for(var t={},n=e.attributes,o=0;o<n.length;o++)if("type_icon_url"!==n[o].name&&"preview_url"!==n[o].name){var r=t[n[o].name];r?(r.value&&!Array.isArray(r.value)&&(r.value=[r.value]),n[o].value&&(r.value||(r.value=[]),r.value.push(n[o].value)),r.dispValue&&!Array.isArray(r.dispValue)&&(r.dispValue=[r.dispValue]),n[o].dispValue&&(r.dispValue||(r.dispValue=[]),r.dispValue.push(n[o].dispValue))):t[n[o].name]=n[o]}i.push(t)}),i})},expandV2:function(e){var t=r.webservices.progressiveExpand;return"Flat"===e.synthType&&(l.withConfigFilter_FlatSynth_Json.batch.expands[0].label="SAX_FlatSynthWithCfg_"+Date.now(),l.withConfigFilter_FlatSynth_Json.batch.expands[0].root.physical_id=e.forSynthesis.IDs,e.forSynthesis.configFilter?(l.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.config_filter=e.forSynthesis.configFilter,l.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.all&&delete l.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.all):(l.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.all=1,l.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.config_filter&&delete l.withConfigFilter_FlatSynth_Json.batch.expands[0].filter.config_filter)),i.makeServiceCall(t,"POST",JSON.stringify(l.withConfigFilter_FlatSynth_Json),!0,null,{timeout:0})},navigate:function(o){o.attributes=o.attributes.concat(e.getUserCustomAttributesCURI().bo);let a=r.webservices.navigateService+"?SecurityContext="+t.getSecurityContext();return i.makeServiceCall(a,"POST",JSON.stringify(o),!0,null,{timeout:0}).then(function(e){if((e=e&&UWA.is(e,"string")?JSON.parse(e):e)&&e.infos&&"OK"===e.infos.status){let t,i=e.result,o={};return i.forEach(function(e){let i={};i.input_object=n.attributes([e.input_object]);let r=e.outputs;for(t in r)r.hasOwnProperty(t)&&(i[t]=n.attributes(r[t]));o[e.input_object.physicalid]=i}),o}})},progressiveExpand:function(o){let l=this;console.log("inside progressiveExpand");let c={},d=[],u=o.expandLevel,p=widget.getValue("component-view");u||(u=p===s.flattenedView?widget.getPreference(s.depthFlattenedView).value:p===s.flattenedViewOnlyArchitectureItem?widget.getPreference(s.depthFlattenedViewArchitectureItemOnly).value:1);for(let e in o.rootWithPaths)if(o.rootWithPaths.hasOwnProperty(e)){let t={label:"CATFLCockpit-ExecuteExpand-"+e,root:{physical_id:e}};o.filter?(t.filter=o.filter,o.aggregation_processors&&(t.aggregation_processors=o.aggregation_processors)):(t.filter=l.getFiterQueryForProgExp(e,o.rootWithPaths,o.configFilter),t.graph=l.getGraphQueryForProgExp([a.type_act_logref],[a.type_act_loginstance]),-1!==u&&(t.aggregation_processors=l.getAggProcForProgExp(e,o.rootWithPaths,u))),d.push(t)}c.expands=d;var g={},m=o.select_bo?o.select_bo:r.identifiers.index_services.select_bo.slice(),f=o.select_rel?o.select_rel:r.identifiers.index_services.select_rel.slice(),h=e.getUserCustomAttributesCURI();m=m.concat(h.bo),f=f.concat(h.rel),g.select_object=m,g.select_relation=f,g.format="entity_relation_occurrence";let v={batch:c,outputs:g};var C=r.webservices.progressiveExpand+"?output_format=cvjson&SecurityContext="+t.getSecurityContext();return i.makeServiceCall(C,"POST",JSON.stringify(v),!0,null,{timeout:0}).then(e=>(e=UWA.is(e,"string")?JSON.parse(e):e,n.progressiveExpandParser(e)))},getFiterQueryForProgExp:function(e,t,i){let n=this,o=[];return t[e].length>0&&o.push(n.createOrFilterForPaths(t[e])),i&&o.push({config_filter:i}),o.push({and:{filters:[{sequence_filter:n.getSequenceFilter('(flattenedtaxonomies:"reltypes/RFLVPMLogicalInstance")')}]}}),{and:{filters:o}}},createOrFilterForPaths:function(e){let t=this,i=[];for(let n=0;n<e.length;n++)i.push(t.getPrefixFilter(e[n]));return{or:{filters:i}}},getPrefixFilter:function(e){return{prefix_filter:{prefix_path:[{physical_id_path:e}]}}},getSequenceFilter:function(e){return{sequence:[{uql:e}]}},getGraphQueryForProgExp:function(){let e={descending_condition_relation:{uql:'flattenedtaxonomies:"reltypes/RFLVPMLogicalInstance"'},descending_condition_object:{uql:'(flattenedtaxonomies:"types/RFLVPMLogicalReference")'}};return e},getAggProcForProgExp:function(e,t,i){let n=[],o=this.createOrFilterForPaths(t[e]);return o.max_distance_from_prefix=i.toString(),n.push({truncate:o}),n},getUserContent:function(){var e=t.getUser("isTrigram"),o={label:"CATFLCockpit-ExecuteFetch",nresults:40,order_by:"desc",order_field:"ds6w:modified",select_file:["icon","thumbnail_2d"],query:"[flattenedtaxonomies]:types/"+a.type_act_logref+" AND [owner]:"+e,select_predicate:r.identifiers.index_services.select_bo,start:"0",tenant:t.getTenant(),with_indexing_date:!0,with_nls:!0};let s={targetService:"3DSearch",authoringCtx:!1};return i.makeServiceCall("/search","POST",JSON.stringify(o),!0,null,s).then(function(e){var t=JSON.parse(e).results;return n.mapAttributes(t)})},getRecentsContent:function(){var e={label:"CATFLCockpit-ExecuteFetch",nresults:40,order_by:"desc",order_field:"ds6w:modified",select_file:["icon","thumbnail_2d"],select_predicate:r.identifiers.index_services.select_bo,start:"0",tenant:t.getTenant(),with_indexing_date:!0,with_nls:!1};let o={targetService:"3DSearch",authoringCtx:!1};return i.makeServiceCall("/recent","POST",JSON.stringify(e),!0,null,o).then(function(e){var t=JSON.parse(e).results;return n.mapAttributes(t)})}}}),define("DS/CATFLCockpitWidget/parser/database.parser",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/pno.util","WebappsUtils/WebappsUtils","text!DS/CATFLCockpitWidget/assets/config/mapping.conf.json"],function(e,t,i,n,o,r){"use strict";var a=JSON.parse(r),s=t.getFullConfig();return{attributes:function(t){let i=[],n={};if(n=e.createMapSelectableForAdditionalAttr(),t){if(!Array.isArray(t)&&("string"==typeof t||"object"==typeof t&&!t.member))return t;(t=t.member||t).forEach(function(t){let o,r,s={};for(o in t)if(r=a[o],"id"===o)s.physicalid=t[o];else if("title"===o)s.label=t[o];else if("revision"===o)s.revision=t[o];else if("isLastVersion"===o)s.isLastVersion="TRUE"===t[o];else if("state"===o)s.status=t[o],s.maturity=t[o];else if("owner"===o)s.owner=t[o];else if("ds6w:reserved"===o)s.isReserved=t[o];else if("created"===o)s.creationDate=e.formatDate(t[o]);else if("modified"===o)s.modificationDate=e.formatDate(t[o]);else if("description"===o)s.description=t[o];else if("type"===o)s.type=t.typeNLS||t[o],s.actualType=t.typeDB||t[o];else if("type_icon_url"===o)s.icons={iconPath:t[o],iconSize:{height:"16px",width:"16px"}};else if("name"===o)s.name=t[o];else if("architectureNumber"===o)s.architectureNumber=t[o];else{var l=n[o.toLowerCase()];if(l){if(l.multiValuated){var c=[];t[o]&&(c=t[o].split(/\u0007/)),s[l.curi]=c}else s[l.curi]=t[o]||"";l.manipulationUnit&&(s[l.curi+"_actual"]=s[l.curi],s[l.curi]=""),e.getNLSValueFromRangeValuesAttribute(l,l.curi,s)}else s[o]=t[o]}i.push(s)})}return i},parseDBSpaceData:function(e){let t=[];return e.forEach(function(e){let i={physicalid:e.objPhysicalId,label:e.objLabel,revision:e.objRevision,type:e.objType,connectionId:e.ownerPhysicalId,connectionType:e.ownerType};t.push(i)}),t},defaultInstanceParser:function(t,i){var n,o={};let r={};n=e.createMapSelectableForAdditionalAttr(),t.forEach(function(t){var i={grid:{}};if(t.attributes&&t.attributes.length)for(var a=0;a<t.attributes.length;a++){var s=t.attributes[a].name,l=t.attributes[a].value;if("PLMInstance.PLM_ExternalID"===s)i.grid.instanceName=l;else if("PLMInstance.V_description"===s)i.grid.instance_description=l;else if("modified"===s)i.instance={modificationDate:e.formatDate(l)};else{var c=n[s.toLowerCase()];if(c&&!c.bo){var d=c.multiValuated||c.isSharedPredicateOnSameType||c.isSharedPredicate&&(c.isClassification||c.isOnExtension);if(void 0!==i.grid["instance_"+c.curi]||void 0!==i.grid["instance_"+c.curi+"_actual"]){var u="instance_"+c.curi;if(c.manipulationUnit&&(u="instance_"+c.curi+"_actual",i.grid["instance_"+c.curi]=[]),Array.isArray(i.grid[u])||(i.grid[u]=i.grid[u]?[i.grid[u]]:[]),l)if(d){var p=[];l&&(p=l.split(/\u0007/)),i.grid[u]=i.grid[u].concat(p)}else i.grid[u].push(l)}else{if(d){p=[];l&&(p=l.split(/\u0007/)),i.grid["instance_"+c.curi]=p}else i.grid["instance_"+c.curi]=l||"";c.manipulationUnit&&(i.grid["instance_"+c.curi+"_actual"]=i.grid["instance_"+c.curi],c.multiValuated?i.grid["instance_"+c.curi]=[]:i.grid["instance_"+c.curi]="")}e.getNLSValueFromRangeValuesAttribute(c,"instance_"+c.curi,i.grid,i)}}}t.attributes=i,o[t.uuid]=t,r[t.physicalid]=t.uuid});let a={};return i.forEach(function(e){a[e]={map:o,rootUuid:r[e]}}),a},defaultExpandParser:function(i,n){var r,a={};let l={};r=e.createMapSelectableForAdditionalAttr(),i.forEach(function(i){var n={physicalid:i.physicalid,resourceid:i.physicalid,type:s.identifiers.type_act_logref,grid:{architectureNumber:"",kindOfRFLP:"L"}},c=s.mappingType[i.type];c&&c.nlsName?n.grid.type=c.nlsName:n.grid.type=i.type,c&&c.icon?n.icons=[t.getTypeIconUrl(i.type)]:n.icons=[t.getTypeIconUrl(s.identifiers.type_act_logref)],n.grid.actualType=i.type;let d={};if(i.attributes&&i.attributes.length){for(var u=0;u<i.attributes.length;u++){var p=i.attributes[u].name,g=i.attributes[u].value;if("PLMEntity.V_Name"===p||"Title"===p)n.label=g;else if("name"===p)n.grid.name=g;else if("PLMEntity.V_description"===p)n.grid.description=g||"";else if("revision"===p)n.grid.revision=g;else if("current"===p)n.maturity=g;else if("current_NLS"===p)n.grid.maturity=g;else if("owner"===p)n.owner=g;else if("owner_NLS"===p)n.grid.owner=g;else if("originated"===p)n.grid.creationDate=e.formatDate(g);else if("modified"===p)n.grid.modificationDate=e.formatDate(g);else if("reserved"===p)n.grid.isReserved=g;else if("reserved_NLS"===p)n.grid["ds6w:reservedBy"]=g||"";else if("PLMReference.V_isLastVersion"===p)n.grid.isLastVersion="TRUE"===g;else if("ArchitectureExtension.V_ArchitectureNumber"===p)n.grid.architectureNumber=g;else if("policy_NLS"===p||"organization_NLS"===p)d[p]=g;else{var m=r[p.toLowerCase()];if(m){var f=m.multiValuated||m.isSharedPredicateOnSameType||m.isSharedPredicate&&(m.isClassification||m.isOnExtension);if(void 0!==n.grid[m.curi]||void 0!==n.grid[m.curi+"_actual"]){var h=m.curi;if(m.manipulationUnit&&(h=m.curi+"_actual",n.grid[m.curi]=[]),Array.isArray(n.grid[h])||(n.grid[h]=n.grid[h]?[n.grid[h]]:[]),g)if(f){var v=[];g&&(v=g.split(/\u0007/)),n.grid[h]=n.grid[h].concat(v)}else n.grid[h].push(g)}else{if(f){v=[];g&&(v=g.split(/\u0007/)),n.grid[m.curi]=v}else n.grid[m.curi]=g||"";m.manipulationUnit&&(n.grid[m.curi+"_actual"]=n.grid[m.curi],m.multiValuated?n.grid[m.curi]=[]:n.grid[m.curi]="")}e.getNLSValueFromRangeValuesAttribute(m,m.curi,n.grid,n)}}}var C=t.getUser("isTrigram"),b=t.getUser("isFullName");n.type===s.identifiers.type_act_logref&&("FALSE"===n.grid.isReserved?(n.isReserved=n.grid.isReserved,n.grid.isReserved=o.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_CheckIn.png")):n.grid["ds6w:reservedBy"]===C||n.grid["ds6w:reservedBy"]===b?(n.isReserved=n.grid.isReserved,n.grid.isReserved=o.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_lock.png")):(n.isReserved=n.grid.isReserved,n.grid.isReserved=o.getWebappsAssetUrl("CATFLCockpitWidget","icons/I_ReservedByOthers.png")))}n.grid.owner||(n.grid.owner=n.owner),n.grid.maturity||(n.grid.maturity=n.maturity),n.grid["ds6w:organizationResponsible"]&&d.organization_NLS&&(n.grid["ds6w:organizationResponsible"]=d.organization_NLS),n.grid["ds6w:policy"]&&d.policy_NLS&&(n.grid["ds6w:policy"]=d.policy_NLS),i.attributes=n,a[i.uuid]=i,l[i.physicalid]=i.uuid});let c={};return n.forEach(function(e){c[e]={map:a,rootUuid:l[e]}}),Promise.resolve(c)},parseItemToConfigCtx:function(e){let t={};return e&&e.length>0&&e.forEach(function(e){let i=e.contextOf,n=e.content&&e.content.results&&e.content.results.length>0?e.content.results[0]:null;if(n&&i.length>0){let o={};o.backEndName=n.computed.label.value[0],o.name=n.data[0].value[0],o.physicalid=e.modelPID;for(let e=0;e<i.length;e++){let n,r=i[e],a={};t[r]?(n=t[r].displayValue,(a=t[r].contexts)[o.physicalid]||(n+=","+o.name,a[o.physicalid]=o)):(n=o.name,a[o.physicalid]=o),t[r]={displayValue:n,contexts:a}}}}),t},classificationParser:function(t){var i={};let n=e.createMapSelectableForAdditionalAttr()||{};return t.forEach(e=>{e.Attributes&&e.Attributes.length>0&&e.Attributes.forEach(e=>{var t=n[e.name.toLowerCase()]?n[e.name.toLowerCase()].curi:void 0;t&&(void 0!==i[t]?(Array.isArray(i[t])||(i[t]=i[t]||!1===i[t]?[i[t]]:[]),Array.isArray(e.value)?i[t].concat(e.value):(e.value||!1===e.value)&&i[t].push(e.value)):i[t]=e.value)})}),i}}}),define("DS/CATFLCockpitWidget/services/modeler.service",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/pno.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/parser/database.parser","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s){"use strict";var l=t.getFullConfig();var c={expand:function(t){var i=l.webservices.dsfl_getLogItem+"structure?addNLSValues=true",o=t.depth?t.depth:"0",r=a.defaultExpandParser,c=t.parser?t.parser:r,d={physicalids:t.itemIDs,depthLevel:o,filterExpression:t.configFilter};return n.post(i,JSON.stringify(d),0).then(function(e){return c(JSON.parse(e).rootObjects,t.itemIDs)}).catch(function(t){var i=t.error.message.slice(t.error.message.indexOf("ResponseCode")),n=s.error_get_structure;i&&i.indexOf("404")>=0&&(n=s.error_get_structure_media),e.displayError(t,null,null,n)})},getAttributes:function(t){var i=l.webservices.dsfl_getLogItem+t.itemID+"/attributes",o=t.parser?t.parser:a.defaultExpandParser;return n.get(i).then(function(e){return o(JSON.parse(e).rootObjects,[t.itemID]).then(function(e){if(e&&e[t.itemID]){var i=e[t.itemID];return i.map[i.rootUuid]}})}).catch(function(t){var i=t.error.message.slice(t.error.message.indexOf("ResponseCode")),n=s.error_get_logitem;i&&i.indexOf("404")>=0&&(n=s.error_get_logitem_media),e.displayError(t,null,null,n)})},getInstanceAttributes:function(t){var i=l.webservices.dsfl_getLogItem+t.parentID+"/dslog:LogInstance/"+t.instID+"/attributes",o=t.parser?t.parser:a.defaultInstanceParser;return n.get(i).then(function(e){let i=o(JSON.parse(e).rootObjects,[t.instID]);if(i&&i[t.instID]){var n=i[t.instID];return n.map[n.rootUuid]}}).catch(function(t){var i=t.error.message.slice(t.error.message.indexOf("ResponseCode")),n=s.error_get_logitem;i&&i.indexOf("404")>=0&&(n=s.error_get_logitem_media),e.displayError(t,null,null,n)})},getObjectAttributes:function(t,i){var o=l.webservices.dsfl_getObjectAttributes;return n.post(o,JSON.stringify({physicalids:t}),0).then(function(e){if(i){var n=a.defaultInstanceParser(JSON.parse(e).rootObjects,t);for(var o in n)n.hasOwnProperty(o)&&(n[o]=n[o].map[n[o].rootUuid]);return n}return a.defaultExpandParser(JSON.parse(e).rootObjects,t).then(function(e){for(var t in e)e.hasOwnProperty(t)&&(e[t]=e[t].map[e[t].rootUuid]);return e})}).catch(function(t){e.displayError(t,null,null,s.error_get_logitem)})},defaultCRSParser:function(t){return{physicalid:t.id,label:t.title,type:t.type,grid:{kindOfRFLP:t.kindOfRFLP,revision:t.revision,description:t.description,name:t.name,type:t.typeNLS||t.type,actualType:t.type,creationDate:e.formatDate(t.created),modificationDate:e.formatDate(t.modified),maturity:t.state,owner:t.owner,architectureNumber:t.architectureNumber}}},refreshTreeNodeModel:function(i,n,o){let r,a=this,s={},d=[];o&&(r=o.getGroupingOptions());let u=e.getUserCustomAttributes();u&&u.forEach(function(e){e.manipulationUnit&&e.manipulationUnit!==l.dimensions[e.dimension].MKSUnit?s[e.curi]=e:e.manipulationUnit&&d.push(e.curi)});let p=[];return c.getObjectAttributes(Object.keys(i)).then(function(e){for(var c in e)if(e.hasOwnProperty(c)){let o=e[c],r=i[c];n&&t.SAXStorage().setItem(l.localStorageKeys.recentlyAuthored+c,Date.now()),o.attributes&&o.attributes.grid&&("#DENIED!"===o.attributes.grid.owner?r.forEach(function(e){e.getParent().removeChild(e)}):p.push(a._convertValuesAndUpdateNodes(r,o,s,d)))}return Promise.all(p).then(()=>{r&&o.groupRows(r)})})},refreshInstanceNodeModel:function(i,n){let r=this,a={},s=[],d=e.getUserCustomAttributes();return d&&d.forEach(function(e){e.bo||(e.manipulationUnit&&e.manipulationUnit!==l.dimensions[e.dimension].MKSUnit?a[e.curi]=e:e.manipulationUnit&&s.push(e.curi))}),c.getObjectAttributes(Object.keys(i),!0).then(function(e){for(var c in e)if(e.hasOwnProperty(c)){var d=e[c],u=i[c];let p=u[0].getParent();widget.getValue("groupingEnabled")&&!p.getID&&(p=o.getGroupNodeParent(p));let g=p.options.physicalid;n&&t.SAXStorage().setItem(l.localStorageKeys.recentlyAuthored+g,Date.now()),d.attributes&&d.attributes.grid&&r._convertValuesAndUpdateNodes(u,d,a,s)}})},_convertValuesAndUpdateNodes:function(e,t,i,n){let o=[],a=[];for(let e in i)if(i.hasOwnProperty(e)){let n=i[e];if(n.bo||(e="instance_"+e),(""===t.attributes.grid[e]||t.attributes.grid[e]&&0===t.attributes.grid[e].length)&&t.attributes.grid[e+"_actual"]){let i;n.multiValuated||Array.isArray(t.attributes.grid[e+"_actual"])?0===(i=t.attributes.grid[e+"_actual"]).length?i=[(i=0).toString()]:i.map(e=>e.toString()):i=[(i=+t.attributes.grid[e+"_actual"]||0).toString()],o.push({UnitFrom:l.dimensions[n.dimension].MKSUnit,UnitTo:n.manipulationUnit,Dimension:n.dimension,Values:i}),a.push(e)}}return n.forEach(function(e){let i=t.attributes.grid[e+"_actual"];i&&(t.attributes.grid[e]=i)}),o.length>0?r.convertValues(o).then(function(i){i.Response&&(a.forEach(function(e,n){i.Response[n].ConvertedValues&&(t.attributes.grid[e]=UWA.is(i.Response[n].ConvertedValues,"string")?i.Response[n].ConvertedValues.split(";")[0]:i.Response[n].ConvertedValues)}),e.forEach(function(e){e.updateOptions(t.attributes)}))}):(e.forEach(function(e){e.updateOptions(t.attributes)}),Promise.resolve())},navigate:function(t){let i=l.webservices.getItems+l.webservices.keyFieldForService;t.fields&&(i+=t.fields.join());let o=t.payload;return n.post(i,JSON.stringify(o),0).then(function(e){e=e&&UWA.is(e,"string")?JSON.parse(e):e;let t={};if(e.member&&e.member.length>0){e.member.forEach(function(e,i){let n,r={};e.outputs;for(n in e)r[n]=a.attributes(e[n]);t[o[i]]=r})}return t},function(t){e.displayError(t,null,null,s.msg_generic_error_get_failed)})},getObjectClassificationAttributes:function(e){var t=l.webservices.getClassificationAttributes+e+l.webservices.classificationAttributesMask;return n.get(t).then(function(e){return e&&(e=JSON.parse(e)).member[0]&&e.member[0].ClassificationAttributes&&e.member[0].ClassificationAttributes.member&&e.member[0].ClassificationAttributes.member.length>0?a.classificationParser(e.member[0].ClassificationAttributes.member):{}})}};return c}),define("DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument",["UWA/Core","DS/TreeModel/TreeDocument","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/common.util","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json"],function(e,t,i,n,o,r){"use strict";JSON.parse(r);return t.extend({isMain:!1,_activeNode:null,defaultOptions:{shouldAcceptDrop:function(e){return!0}},init:function(t){this.mappedNodesToIds={},t=e.extend(e.clone(this.defaultOptions),t),this._parent(t),t.isMain&&(this.isMain=t.isMain)},updateTags:function(){this.isMain&&this.getModelEvents().publish({event:"setPathTags",context:this})},onRootAdded:function(){this.isMain&&this.getModelEvents().publish({event:"onRootAdded",context:this})},setActiveNode:function(e){null!==this._activeNode&&(this._activeNode.setActive(!1),this._activeNode.setColor("rgba(0, 0, 0, 0)")),this._activeNode=e,this._activeNode.setActive(!0),this._activeNode.setColor("rgba(54,142,196, 0.8)")},getActiveNode:function(e){return this._activeNode},empty:function(){this.mappedNodesToIds={},this._getTrueRoot().empty(),this._numberOfNodesInDocument=0,this._parent()},getRealRoots:function(t){var i=[],n=this.getRoots(t);if(null!=n&&n.forEach(function(e){if(e.isVirtual()){var t=e.getChildren();t&&t.length>0&&(i=i.concat(t))}else i.push(e)}),Boolean(t)&&e.is(this._getChildrenFilterInfo,"function")){var o=this._getChildrenFilterInfo();if(o&&e.is(o.childrenBeforeFiltering,"array")){var r=i;i=o.childrenBeforeFiltering.slice(0),r.forEach(function(e){i.indexOf(e)<0&&i.push(e)})}}return i},getRoots:function(t){var i=this._parent();if(Boolean(t)&&e.is(this._getChildrenFilterInfo,"function")){var n=this._getChildrenFilterInfo();if(n&&e.is(n.childrenBeforeFiltering,"array")){var o=i;i=n.childrenBeforeFiltering.slice(0),o.forEach(function(e){i.indexOf(e)<0&&i.push(e)})}}return i},removeRoot:function(t,i,n){this._doNotBroadcastSelect=!0;var o=this.hasOwnProperty("detachedRoots")?this.detachedRoots.indexOf(t):-1;if(o>=0)this.detachedRoots.splice(o,1);else{if(this.getRealRoots().indexOf(t)>=0)t.getParent().removeChild(t);if((!e.is(n,"boolean")||!n)&&e.is(this._getChildrenFilterInfo,"function")){var r=this._getChildrenFilterInfo();if(r&&e.is(r.childrenBeforeFiltering,"array")){var a=r.childrenBeforeFiltering.indexOf(t);a>=0&&r.childrenBeforeFiltering.splice(a,1)}if(r&&e.is(r.filteredOutChildren,"array")){var s=r.filteredOutChildren.indexOf(t);s>=0&&r.filteredOutChildren.splice(s,1)}}}if(this._doNotBroadcastSelect=!1,!e.is(i,"boolean")||!i){var l=this.getRealRoots().length;e.is(this.detachedRoots,"array")&&(l+=this.detachedRoots.length),this.getModelEvents().publish({event:"onRemoveRoot",data:{pid:t.getID(),remainingRoots:l}});var c=null;this.getRealRoots().length>0?c=this.getRealRoots()[0]:e.is(this.detachedRoots,"array")&&this.detachedRoots.length>0&&(c=this.detachedRoots[0]),this.getModelEvents().publish({event:"onRootAdded",data:{isremove:!0,added_node:c,nb_root:l}})}},getNodesByIDPath:function(e){var t=[];return this.getRealRoots().forEach(function(i){!function e(t,i,n,o){if(t.getID()===i[n])if(n===i.length-1)o.push(t);else{var r=t.getChildren();r&&r.length>0&&(n+=1,r.forEach(function(t){e(t,i,n,o)}))}}(i,e,0,t)}),t},getNodesById:function(e){var t=[];return this.getRoots().forEach(function(i){var n=i.getNodesById(e);t=t.concat(n)}),t},getMappedNodesFromId:function(e){return this.mappedNodesToIds&&this.mappedNodesToIds[e]?this.mappedNodesToIds[e]:this.getNodesById(e)},searchRootById:function(e){var t,i=this.getRoots(!0);this.hasOwnProperty("detachedRoots")&&(i=i.concat(this.detachedRoots));for(var n=0;n<i.length;n++)if(i[n].options.physicalid===e){t=i[n];break}return t},applyFilter:function(e,t){for(var r=this,a=[],s=o.checkIfRecentlyAuthored(e.filterRootIds[0],!0),l=0;l<e.filterRootIds.length;l++){var c=r.searchRootById(e.filterRootIds[l]);c&&(c.options.CVQuery=e.CVQuery,a.push(c))}if(e.empty){if(e.filterRootIds&&1===e.filterRootIds.length){var d=e.filterRootIds[0],u={},p=r.getConfigurationContext();if(p&&p.filterCompiledForm&&(u.configFilter=p.filterCompiledForm),s)u.itemIDs=[d],i.expand(u).then(function(e){e=e?e[a[0].options.physicalid]:{},r.onExpandComplete(a,t,s,e)});else{let e={};e[d]=[[d]],n.progressiveExpand({rootWithPaths:e,configFilter:u.configFilter}).then(r.onExpandComplete.bind(r,a,t,s))}}}else if(e.CVQueryV2){let i={};i[d=e.filterRootIds[0]]=[[d]];let o=e.CVQueryV2.filter,l=e.CVQueryV2.aggregation_processors;e.CVQueryV2.batch&&e.CVQueryV2.batch.expands[0]&&(o||(o=e.CVQueryV2.batch.expands[0].filter),l||(l=e.CVQueryV2.batch.expands[0].aggregation_processors)),n.progressiveExpand({rootWithPaths:i,filter:o,aggregation_processors:l}).then(r.onExpandComplete.bind(r,a,t,s))}},onExpandComplete:function(e,t,i,n){try{this.prepareUpdate();var o=!1;if(n&&n.map&&0!==Object.keys(n.map).length&&(i||n.paths&&0!==n.paths.length)||(o=!0),o)e.forEach(function(e){let t=e.getChildren();for(let i=t.length-1;i>=0;i--)t[i].getID()&&e.removeChild(t[i]);e.expand()}),t({response:null,recentlyAuthored:i});else n.srcFromNGFilter=!0,t({treedocument:this,root_nodes:e,response:n,expand_level:-1,selectPathLeaf:!1,recentlyAuthored:i})}catch(e){console.error("error in filtering",e)}finally{this.pushUpdate()}},setConfigurationContext:function(e){this._configurationContext={model:e.model,modelVersion:e.modelVer,pc:e.pc,filterCompiledForm:e.filterCompiledForm}},getConfigurationContext:function(){return this._configurationContext?this._configurationContext:null},addToMappedNodes:function(e){this.mappedNodesToIds[e.options.physicalid]?this.mappedNodesToIds[e.options.physicalid].push(e):this.mappedNodesToIds[e.options.physicalid]=[e]},removeFromMappedNodes:function(e){if(this.mappedNodesToIds[e.options.physicalid]){for(var t=this.mappedNodesToIds[e.options.physicalid],i=t.length-1;i>=0;i--){t[i]._id===e._id&&t.splice(i,1)}t.length<=0&&delete this.mappedNodesToIds[e.options.physicalid]}}})}),define("DS/CATFLCockpitWidget/utils/gridview.util",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/parser/index.parser","DS/CATFLCockpitWidget/parser/database.parser","text!DS/CATFLCockpitWidget/assets/config/navigate.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g){"use strict";var m=o.getFullConfig(),f=m.identifiers,h=m.localStorageKeys,v=JSON.parse(p),C={createTreeDocumentFromIndexResponse:function(e,i,o,r){var a,s,c,d,u={},p=[];if(!e)return;var g=e.map,m=e.paths,v=!1,C={},b=widget.getValue(h.componentView),y=widget.getValue("ngFilter"),_=y&&y.length>0;let w;if(b===h.flattenedView?w=widget.getPreference(h.depthFlattenedView).value:b===h.flattenedViewOnlyArchitectureItem&&(w=widget.getPreference(h.depthFlattenedViewArchitectureItemOnly).value),i||(v=!0,i=new t({useAsyncPreExpand:!0}),this._addExpandCollapseBehaviors(i,r,!1)),!v&&o||(1!==m[0].length||g[m[0][0]].attributes.grid||(g[m[0][0]].attributes.noIndexOrDBExpand=!0,g[m[0][0]].attributes.physicalid=g[m[0][0]].physicalid,g[m[0][0]].attributes.grid={physicalid:g[m[0][0]].physicalid}),o=this._addLogItemIndexResponse(i,null,g[m[0][0]]),0===Object.keys(i.mappedNodesToIds).length&&o.options.physicalid.length>0&&(i.mappedNodesToIds[o.options.physicalid]=[o])),1===m.length&&1===m[0].length)return i.getRoots()[0].expand(),i;let D={};i.getRoots()[0].getAllDescendants().forEach(function(e){e.options.type===f.type_act_logref&&e.options.instance&&(D[e.options.instance.physicalid]||(D[e.options.instance.physicalid]=[]),D[e.options.instance.physicalid].push(e))});var S,I=o;C[m[0][0]]=i.getRoots()[0];for(var A=0;A<m.length;A++)for(var F=1;F<m[A].length;F+=2)if(a=g[m[A][F]],s=g[m[A][F+1]],a&&s&&(s.attributes.type!==f.type_act_logref||b!==h.flattenedViewOnlyArchitectureItem||0!==s.attributes.grid.architectureNumber.length)){if(b===h.structuredView||a.alreadyAdded||(a.alreadyAdded=!0),(_||b!==h.structuredView&&F<m[A].length-2)&&(s.attributes.noIndexOrDBExpand=!0),d=m[A].slice(0,F).join("|"),I=b===h.structuredView?void 0!==d&&C[d]?C[d]:o:Math.floor(d.split("|").length/2)<w?o:C[d],S=void 0!==d&&C[d]?C[d]:o,D){let e=D[a.attributes.physicalid],t=S.getOccurencePath();if(e&&t){let i;t.push(a.attributes.physicalid,s.attributes.physicalid);let n=JSON.stringify(t);for(let t=0;t<e.length;t++)if(JSON.stringify(e[t].getOccurencePath())===n){i=!0,C[d=m[A].slice(0,F+2).join("|")]=e[t];break}if(i)continue}}if(!n.checkIfRecentlyAuthored(S.options.physicalid,!0)&&s.attributes.type===f.type_act_logref){var E=s.attributes.physicalid;if(n.checkIfRecentlyAuthored(E,!0)){var k={};a&&(k.pid=a.attributes.physicalid,k.visualCue=a.attributes.visualCue,k.name=a.attributes.label),p.push(l.expand({itemIDs:[E],depth:"1",configFilter:r}).then(this.addStructureToChild.bind(this,E,I,k,D)));break}C[d=m[A].slice(0,F+2).join("|")]?c=C[d]:(c=this._addLogItemIndexResponse(I,a,s,S),C[d]=c,c.options.type===f.type_act_logref&&c.options.instance&&(D[c.options.instance.physicalid]||(D[c.options.instance.physicalid]=[]),D[c.options.instance.physicalid].push(c)),n.checkIfRecentlyAuthored(E)&&(void 0===u[E]&&(u[E]=[]),u[E].push(c)))}}return n.checkIfRecentlyAuthored(o.options.physicalid)&&(u[o.options.physicalid]=[o]),Object.keys(u).length>0&&p.push(l.refreshTreeNodeModel(u),!1),Promise.all(p).finally(function(){o.options.noIndexOrDBExpand=!0,i&&!i.getRoots()[0].options.hasBeenExpanded&&i.getRoots()[0].expand()}),i},addStructureToChild:function(e,t,i,n,o){let r=o[e],a=r.map[r.rootUuid];this._addLogItemDslogModelerResponse(t,a,r.map,i,null,n)},createTreeDocumentFromDslogModelerResponse:function(e,i){i||(i=new t({useAsyncPreExpand:!0})),this._addLogItemDslogModelerResponse(i,e.map[e.rootUuid],e.map);var n=i.getRoots()[0];return 0===Object.keys(i.mappedNodesToIds).length&&n.options.physicalid.length>0&&(i.mappedNodesToIds[n.options.physicalid]=[n]),this._addExpandCollapseBehaviors(i,null,!0),i.getRoots()[0].expand(),i},_addLogItemIndexResponse:function(e,t,n,o){var r=JSON.parse(JSON.stringify(n));if(null!==t)for(var a in r.attributes.instance={physicalid:t.attributes.physicalid,visualCue:t.attributes.visualCue,effectivitycompiledform:t.attributes.effectivitycompiledform,modificationDate:t.attributes.grid.modificationDate},r.attributes.grid.instanceName=t.attributes.label,r.attributes.grid.instance_description=t.attributes.description,t.attributes.grid)t.attributes.grid.hasOwnProperty(a)&&(r.attributes.grid["instance_"+a]=t.attributes.grid[a]),t.attributes.hasOwnProperty(a)&&(r.attributes["instance_"+a]=t.attributes[a]);r.attributes.children=[];var s=e.addChild(new i(r.attributes));return t&&s.setRelationID(t.attributes.physicalid),o&&(s.options.actualParent=o),s},_addLogItemDslogModelerResponse:function(e,t,n,o,r,a){var s=this,l=r||0;!r&&e.options.actualDepth&&(l=e.options.actualDepth+1);var c,d,u=JSON.parse(JSON.stringify(t)),p=widget.getValue(h.componentView),g=!0;p===h.flattenedView?c=widget.getPreference(h.depthFlattenedView).value:p===h.flattenedViewOnlyArchitectureItem&&(c=widget.getPreference(h.depthFlattenedViewArchitectureItemOnly).value,e.getRoot&&0===u.attributes.grid.architectureNumber.length&&(g=!1,d=e));var m=!1;if(a&&void 0!==o){let t=a[o.pid],i=e.getOccurencePath();if(t&&i){i.push(o.pid,u.attributes.physicalid);let e=JSON.stringify(i);for(let i=0;i<t.length;i++)if(JSON.stringify(t[i].getOccurencePath())===e){m=!0,d=t[i];break}}}!m&&g&&(u.attributes.children=[],d=new i(u.attributes),o&&d.setRelationID(o.pid),d.options.actualParent=e,d.options.actualDepth=l,p!==h.structuredView&&void 0!==e.getRoot&&l<=parseInt(c,10)?e.getRoot().addChild(d):e.addChild(d),o&&(d.options.instance={physicalid:o.pid,visualCue:o.visualCue,modificationDate:o.modificationDate},d.options.grid.instanceName=o.name,d.options.grid.cue="",d.options.grid.instance_actualType=o.actualType,d.options.grid.instance_description=o.description||"",d.options.grid=Object.assign(d.options.grid,o.customAttributes),d.options=Object.assign(d.options,o.customAttributesInternalValues)),a&&o&&d.options.type===f.type_act_logref&&d.options.instance&&(a[d.options.instance.physicalid]||(a[d.options.instance.physicalid]=[]),a[d.options.instance.physicalid].push(d))),u.instances&&(d.options.noIndexOrDBExpand=!0,++l,u.instances.forEach(function(e){var t=s._getInstDetailsFromModelerResp(e);s._addLogItemDslogModelerResponse(d,n[e.toUuid],n,t,l,a)}))},_getInstDetailsFromModelerResp:function(e){if(!e)return;var t,i,o={},r={};let a,s;i=n.createMapSelectableForAdditionalAttr();for(var l={pid:e.physicalid,visualCue:e.visualCue,customAttributes:o,customAttributesInternalValues:r,actualType:e.type},c=0;c<e.attributes.length;c++)if("PLMInstance.PLM_ExternalID"===e.attributes[c].name)l.name=e.attributes[c].value;else if("PLMInstance.V_description"===e.attributes[c].name)l.description=e.attributes[c].value;else if("modified"===e.attributes[c].name)l.modificationDate=n.formatDate(e.attributes[c].value);else if("owner_NLS"===e.attributes[c].name)t=e.attributes[c].value;else if("reserved_NLS"===e.attributes[c].name)a=e.attributes[c].value;else if("organization_NLS"===e.attributes[c].name)s=e.attributes[c].value;else{var d=i[e.attributes[c].name.toLowerCase()];if(d){if(void 0!==o["instance_"+d.curi]||void 0!==o["instance_"+d.curi+"_actual"]){var u="instance_"+d.curi;if(d.manipulationUnit&&(u="instance_"+d.curi+"_actual",o["instance_"+d.curi]=[]),Array.isArray(o[u])||(o[u]=o[u]?[o[u]]:[]),e.attributes[c].value)if(d.multiValuated||e.attributes[c].value&&e.attributes[c].value.indexOf("")>=0){var p=[];e.attributes[c].value&&(p=e.attributes[c].value.split(/\u0007/)),o[u]=o[u].concat(p)}else o[u].push(e.attributes[c].value)}else{if(d.multiValuated||e.attributes[c].value&&e.attributes[c].value.indexOf("")>=0){p=[];e.attributes[c].value&&(p=e.attributes[c].value.split(/\u0007/)),o["instance_"+d.curi]=p}else o["instance_"+d.curi]=e.attributes[c].value||"";d.manipulationUnit&&(o["instance_"+d.curi+"_actual"]=o["instance_"+d.curi],d.multiValuated?o["instance_"+d.curi]=[]:o["instance_"+d.curi]="")}n.getNLSValueFromRangeValuesAttribute(d,"instance_"+d.curi,o,r)}}return o["instance_ds6w:responsible"]=t,o["instance_ds6w:reservedBy"]&&a&&(o["instance_ds6w:reservedBy"]=a),o["instance_ds6w:organizationResponsible"]&&s&&(o["instance_ds6w:organizationResponsible"]=s),l.customAttributes=o,l.customAttributesInternalValues=r,l},_createCategoryNode:function(e,t){return e.addChild(new i(t))},_addExpandCollapseBehaviors:function(e){e.onPreExpand(function(t){t.target.options.hasBeenExpanded||t.target.options.type!==f.type_act_logref?t.target.preExpandDone():C.expandNodestoNLevel({level:"1",selectedNodes:[t.target],params:{collectionView:{getContent:function(){return widget.body},treeDocument:e},onPreExpand:!0}})}),e.onPostExpand(function(){this.getModelEvents().publish({event:"colorizeNodesFromTagger"})})},crRecTimeoutToCheckTreeDocExp:function(e,t){var i=this;e&&(e.isExpanding()?setTimeout(function(){i.crRecTimeoutToCheckTreeDocExp(e,t)},200):t())},addDBExpandCallBack:function(e,t,i,n){var o=this;i.map[i.rootUuid]&&!i.map[i.rootUuid].instances||(n&&!t&&(t={},n.getRoots()[0].getAllDescendants().forEach(function(e){e.options.type===f.type_act_logref&&e.options.instance&&(t[e.options.instance.physicalid]||(t[e.options.instance.physicalid]=[]),t[e.options.instance.physicalid].push(e))})),i.map[i.rootUuid].instances.forEach(function(n){var r=o._getInstDetailsFromModelerResp(n);o._addLogItemDslogModelerResponse(e,i.map[n.toUuid],i.map,r,null,t)}))},addDBNavigate:function(e,t){let i,n=this,o=widget.getValue(h.componentView),a=[],s=[];for(i=e.length-1;i>=0;i--){var c=e[i];c.options.physicalid&&(c.isRoot()||c.options.instance&&c.options.instance.physicalid)?a.indexOf(c.options.physicalid)<0&&a.push(c.options.physicalid):e.splice(i,1)}let d=!0,p=!0,g=!0,m=!0,v=!0;if(t&&t.navigateTypes){let e=t.navigateTypes,i=widget.getValue("configurable_expand")||{};d=e.indexOf("ZONE")>=0||!1,p=e.indexOf("SPECIFICATION_DOCUMENT")>=0&&i.specDocs||!1,g=e.indexOf("PROPOSED_SOLUTION")>=0&&i.proposedSolution||!1,m=e.indexOf("IMPLEMENTEDBY_LINK")>=0&&i.implementedBy||!1,v=e.indexOf("IMPLEMENTING_LINK")>=0&&i.implementing||!1}if(d&&s.push("dsmvlog:Reference.SPPConnection.Details"),p&&s.push("dsmvlog:Reference.SpecificationDocument.Details"),g&&s.push("dsmvlog:Reference.ProposedSolution.Details"),m&&o===h.structuredView&&s.push("dsmvlog:Reference.ImplementLink.ImplementedBy.Details"),v&&o===h.structuredView&&s.push("dsmvlog:Reference.ImplementLink.Implementing.Details"),!(s.length<=0))return l.navigate({payload:a,fields:s}).then(function(i){let a=[],l=[],c=!1;return e.forEach(function(e){let r=i[e.options.physicalid];if(r){let i,a=[e];for(i in t&&t.treeDocument&&(a=t.treeDocument.getMappedNodesFromId(e.options.physicalid)),0===Object.keys(r).length&&d?r.SPPConnections=[]:1===Object.keys(r).length&&p&&1===s.length&&(r.specificationDocument=[]),m&&!r["Implemented by"]&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implemented=!1),v&&!r.Implementing&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implementing=!1),c||!v&&!m||(c=!0),r)if("proposedsolution"===i)a.forEach(function(e){l.push(n.updateSolutionsOnNode(e,r[i],t))});else if("Implementing"===i&&o===h.structuredView){let e={objType:"ref",linkType:"implementing"};a.forEach(function(o){l.push(n.updateLinksOnNode(e,o,r[i],t))})}else if("Implemented by"===i&&o===h.structuredView){let e={objType:"ref",linkType:"implemented"};a.forEach(function(o){l.push(n.updateLinksOnNode(e,o,r[i],t))})}else if("specificationDocument"===i)a.forEach(function(e){l.push(n.updateDocsOnNode(f.type_spec_document,e,r[i],t))});else if("SPPConnections"===i){var g=u.parseDBSpaceData(r[i]);a.forEach(function(e){n.updateSpacesOnNode(e,g)})}}e.options.instance&&a.push(e.options.physicalid)}),c&&a.length>0&&r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-referenceLinks-loaded",data:a}),Promise.all(l)})},addIndexNavigate:function(e,t){let i,n=this,o=widget.getValue(h.componentView),a=Object.assign({},v.basic);for(a.input_physical_ids=[],i=e.length-1;i>=0;i--){var l=e[i];l.options.physicalid&&(l.isRoot()||l.options.instance&&l.options.instance.physicalid)?a.input_physical_ids.push(l.options.physicalid):e.splice(i,1)}if(0===a.input_physical_ids.length)return;a.label="navigate_rel_logref",a.primitives=[],a.patterns={},a.patternTypeFilters={};let c=v[f.type_act_logref],u=!0,p=!0,g=!0,m=!0,C=!0,b=widget.getValue("configurable_expand")||{};if(t&&t.navigateTypes){let e=t.navigateTypes;u=e.indexOf("ZONE")>=0||!1,p=e.indexOf("SPECIFICATION_DOCUMENT")>=0&&b.specDocs||!1,g=e.indexOf("PROPOSED_SOLUTION")>=0&&b.proposedSolution||!1,m=e.indexOf("IMPLEMENTEDBY_LINK")>=0&&b.implementedBy||!1,C=e.indexOf("IMPLEMENTING_LINK")>=0&&b.implementing||!1}return u&&(a.primitives.push(c.ZONE.primitives),a.patterns.ZONE=c.ZONE.patterns),p&&(a.primitives.push(c.SPECIFICATION_DOCUMENT.primitives),a.patterns.SPECIFICATION_DOCUMENT=c.SPECIFICATION_DOCUMENT.patterns),g&&(a.primitives.push(c.PROPOSED_SOLUTION.primitives),a.patterns.PROPOSED_SOLUTION=c.PROPOSED_SOLUTION.patterns,a.attributes=a.attributes.concat(f.index_services.select_physical)),m&&o===h.structuredView&&(a.primitives.push(c.IMPLEMENTEDBY_LINK.primitives),a.patterns.IMPLEMENTEDBY_LINK=c.IMPLEMENTEDBY_LINK.patterns,a.patternTypeFilters.IMPLEMENTEDBY_LINK=c.IMPLEMENTEDBY_LINK.patternTypeFilters),C&&o===h.structuredView&&(a.primitives.push(c.IMPLEMENTING_LINK.primitives),a.patterns.IMPLEMENTING_LINK=c.IMPLEMENTING_LINK.patterns,a.patternTypeFilters.IMPLEMENTING_LINK=c.IMPLEMENTING_LINK.patternTypeFilters),a.primitives.length<=0?void 0:s.navigate(a).then(function(i){let a=[],s=[],l=!1;return e.forEach(function(e){let r=i[e.options.physicalid];if(r){let i;for(i in u&&!r.ZONE&&(r.ZONE=[]),m&&!r.IMPLEMENTEDBY_LINK&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implemented=!1),C&&!r.IMPLEMENTING_LINK&&(e.options.implementLinks||(e.options.implementLinks={}),e.options.implementLinks.implementing=!1),l||!C&&!m||(l=!0),r)if("PROPOSED_SOLUTION"===i)s.push(n.updateSolutionsOnNode(e,r[i],t));else if("IMPLEMENTING_LINK"===i&&o===h.structuredView){let o={objType:"ref",linkType:"implementing"},a=n.formImplLinksFromNavigatedData(r[i]);a=d.attributes(a),s.push(n.updateLinksOnNode(o,e,a,t))}else if("IMPLEMENTEDBY_LINK"===i&&o===h.structuredView){let o={objType:"ref",linkType:"implemented"},a=n.formImplLinksFromNavigatedData(r[i]);a=d.attributes(a),s.push(n.updateLinksOnNode(o,e,a,t))}else if("REFERENCE_DOCUMENT"===i)s.push(n.updateDocsOnNode(f.type_attach_document,e,r[i],t));else if("SPECIFICATION_DOCUMENT"===i)s.push(n.updateDocsOnNode(f.type_spec_document,e,r[i],t));else if("ZONE"===i){let t=n.formSpacesFromNavigatedData(r[i]);t=d.attributes(t),n.updateSpacesOnNode(e,t)}}e.options.instance&&a.push(e.options.physicalid)}),l&&a.length>0&&r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-referenceLinks-loaded",data:a}),Promise.all(s)})},formImplLinksFromNavigatedData:function(e){let t=[];return e&&e.length>0&&e.forEach(function(e){let i=e.elements[0];i.implementlink={id:e.owner.physicalid},t.push(i)}),t},formSpacesFromNavigatedData:function(e){let t=[];return e&&e.length>0&&e.forEach(function(e){let i=e.elements[0];i.connectionId=e.owner.physicalid,t.push(i)}),t},updateSolutionsOnNode:function(e,t,n){let r=e.options.instance?e.options.instance.physicalid:"",a=e.getNodesByRelId("proposedsolution"+r)[0];if(t&&!(t.length<=0))return e.options.hasProposedSolution=!0,a?a.removeChildren():((a=new i({label:g.label_proposed_solution,icons:[{iconName:"product"}],type:"proposedSolutionCategory",editableFlag:!1})).setRelationID("proposedsolution"+r),e.addChild(a),e.updateOptions()),this.validateNLSTypesForItems(t).then(function(){d.parseDataToNodeFormat({virtual:!0,data:t}).forEach(function(e){e.icons[0]||(e.icons=[o.getTypeIconUrl(f.type_act_physical)]),a.addChild(new i(e))}),n&&n.bExpand&&a.expand()});a&&e.removeChild(a)},validateNLSTypesForItems:function(e){let t=[],i=[];if(e.forEach(function(e){e.type||(t.indexOf(e.actualType)<0&&t.push(e.actualType),i.push(e))}),t.length>0){let e={"ds6w:type":t};return a.getPredicateValues(e).then(function(e){if(e){let t,n=e["ds6w:type"];for(t in i.forEach(function(e){!e.type&&n[e.actualType]&&(e.type=n[e.actualType])}),n)n.hasOwnProperty(t)&&(m.mappingType[t]||(m.mappingType[t]={}),m.mappingType[t].nlsName=n[t])}})}return Promise.resolve()},updateLinksOnNode:function(e,t,n,r){let a=this,s=t.options.instance?t.options.instance.physicalid:"",l=e.linkType+e.objType,c=g[l],u=t.getNodesByRelId(l+s)[0];if(n&&!(n.length<=0))return u?u.removeChildren():((u=a._createCategoryNode(t,{label:c,type:"implementLinksCategory",icons:[{iconName:"forward"}],editableFlag:!1})).setRelationID(l+s),t.addChild(u),t.updateOptions()),"ref"===e.objType&&(t.options.implementLinks||(t.options.implementLinks={}),n&&n.length>0?t.options.implementLinks[e.linkType]=!0:t.options.implementLinks[e.linkType]=!1),a.validateNLSTypesForItems(n).then(function(){d.parseDataToNodeFormat({virtual:!0,data:n}).forEach(function(n){n.linkInfo=JSON.parse(JSON.stringify(e));let r=n.implementlink||n.grid.implementlink;n.linkInfo.implementId=r?r.id:null;let a=n.implementLinkContext||n.grid.implementLinkContext;a||"ref"!==e.objType||("implementing"===e.linkType?(a=g.implementingref+": "+t.options.label+" "+t.options.grid.revision+"::",a+=g.implementedref+": "+n.label+" "+n.grid.revision):(a=g.implementingref+": "+n.label+" "+n.grid.revision+"::",a+=g.implementedref+": "+t.options.label+" "+t.options.grid.revision)),a&&(a=a.split("::"),n.grid.titleTooltip="",a.forEach(function(e){n.grid.titleTooltip+=e+"\n"}),n.grid.titleTooltip=n.grid.titleTooltip.substr(0,n.grid.titleTooltip.length-1)),n.icons[0]||("R"===n.grid.kindOfRFLP?void 0!==m.mappingType[n.type]?n.icons=[o.getTypeIconUrl(n.type)]:n.icons=[o.getTypeIconUrl(f.type_requirement)]:"F"===n.grid.kindOfRFLP?n.icons=[o.getTypeIconUrl(f.type_act_functref)]:"L"===n.grid.kindOfRFLP?n.icons=[o.getTypeIconUrl(f.type_act_logref)]:"P"===n.grid.kindOfRFLP&&(n.icons=[o.getTypeIconUrl(f.type_act_physical)])),u.addChild(new i(n))}),r&&r.bExpand&&u.expand()});u&&t.removeChild(u)},updateDocsOnNode:function(e,t,n,r){let a,s=t.options.instance?t.options.instance.physicalid:"",l=t.getNodesByRelId(e+s)[0];if(a=e===f.type_attach_document?g.label_ref_documents:g.label_spec_documents,n&&!(n.length<=0))return l?l.removeChildren():((l=new i({label:a,icons:[{iconName:"doc"}],type:e,editableFlag:!1})).setRelationID(e+s),t.addChild(l),t.updateOptions()),this.validateNLSTypesForItems(n).then(function(){d.parseDataToNodeFormat({virtual:!0,data:n}).forEach(function(e){e.icons[0]||(e.icons=[o.getTypeIconUrl(f.type_document)]),l.addChild(new i(e))}),r&&r.bExpand&&l.expand()});l&&t.removeChild(l)},updateSpacesOnNode:function(e,t){if(!t||t.length<=0)e.options.assignedSpacesPID=[],e.updateOptions({grid:{assignedSpaces:""}});else{var i={assignedSpacesPID:[],grid:{assignedSpaces:""}};e.options.grid.assignedSpaces="";for(var n=0;n<t.length;n++)i.assignedSpacesPID.push({obj:t[n].physicalid,owner:t[n].connectionId}),i.grid.assignedSpaces+=t[n].label+", ";i.grid.assignedSpaces=i.grid.assignedSpaces.slice(0,-2),e.updateOptions(i)}},_addOccImplementLinksToNode:function(e){var t=this;if(!e.isRoot())return c.getInstanceImplementLinks([e],!0).then(function(e){e&&e.forEach(function(e){t.manageImplementLinkResp(e.node,"inst",e,{keepNodes:!0})})})},manageImplementLinkResp:function(e,t,i,n){var o,r=this,a=e.options.instance?e.options.instance.physicalid:"";("ref"===t&&(e.options.implementLinks||(e.options.implementLinks={})),i)&&(i.implementing||n.keepNodes||(o=e.getNodesByRelId("implementing"+t+a)[0])&&o.remove(),i.implemented||n.keepNodes||(o=e.getNodesByRelId("implemented"+t+a)[0])&&o.remove(),["implementing","implemented"].forEach(function(o){if(i[o]){var s=g[o+t],l=e.getNodesByRelId(o+t+a)[0];l?n.keepNodes||l.removeChildren():(l=r._createCategoryNode(e,{label:s,type:"implementLinksCategory",icons:[{iconName:"forward"}]})).setRelationID(o+t+a);var c=i[o]&&i[o].member?i[o].member:i[o];"ref"===t&&(c&&c.length>0?e.options.implementLinks[o]=!0:e.options.implementLinks[o]=!1);var d={objType:t,linkType:o};r._parseImplementLinksAndAddToNode(c,d,l),n&&n.bExpand&&l.expand()}}))},_parseImplementLinksAndAddToNode:function(e,t,n){var r=!1;"inst"===t.objType&&(r=!0),e.forEach(function(e){var a,s,c;let d=e.implementlink;if(r&&(e=e.reference&&e.reference.member?e.reference.member[0]:e.reference),"R"===e.kindOfRFLP)a=f.type_requirement,s=[o.getTypeIconUrl(a)];else if("F"===e.kindOfRFLP)a=f.type_act_functref,s=[o.getTypeIconUrl(a)];else if("L"===e.kindOfRFLP)a=f.type_act_logref,s=[o.getTypeIconUrl(a)];else{if("P"!==e.kindOfRFLP)return;a=f.type_act_physical,s=[o.getTypeIconUrl(a)]}var u=l.defaultCRSParser(e);u.type=a,u.icons=s,u.grid.isLastVersion="TRUE"===e.isLastVersion,u.virtual=!0,u.linkInfo=JSON.parse(JSON.stringify(t)),u.linkInfo.implementId=d?d.id:null,(c=d?d.implementLinkContext:null)&&(c=c.split("::"),u.grid.titleTooltip="",c.forEach(function(e){u.grid.titleTooltip+=e+"\n"}),u.grid.titleTooltip=u.grid.titleTooltip.substr(0,u.grid.titleTooltip.length-1)),n.addChild(new i(u)),n.updateOptions()}),null===n.getChildren()&&n.getParent().removeChild(n)},addAssignedSpacesAttribute:function(e){let t=this,i=[];if(null==e||0===e.length)return Promise.resolve();let o=e.filter(function(e){return e.options.physicalid}),r=[],a=[];if(m.disableIndexAcceleration)r=o;else{let e=n.sortNodesIntoDBandIndex(o,!1);r=e.databaseNodes,a=e.indexNodes}return 0===r.length&&0===a.length?Promise.resolve():(r.length>0&&i.push(t.addDBNavigate(r,{navigateTypes:["ZONE"]})),a.length>0&&i.push(t.addIndexNavigate(a,{navigateTypes:["ZONE"]})),Promise.all(i))},expandNodestoNLevel:function(t){let i=t.level,o=t.params.collectionView.treeDocument.getRoots()[0],r=t.selectedNodes,a=[];for(var s=0;s<r.length;s++){let e,t=r[s];if("1"===i?e=!t.options.hasBeenExpanded:"2"===i?t.options.dontExpandTwoLvl?e=!1:t.options.hasBeenExpanded?t.getChildren().forEach(function(t){t.options.type===f.type_act_logref&&t.options.instance&&(t.options.hasBeenExpanded||(e=!0))}):e=!0:"-1"===i&&(t.options.dontExpandAllLvl?e=!1:t.options.hasBeenExpanded?(t.getAllDescendants().forEach(function(t){t.options.type===f.type_act_logref&&t.options.instance&&(t.options.hasBeenExpanded||(e=!0))}),e||(e=!1)):e=!0),e){if(t.options.physicalid===o.options.physicalid&&"-1"===i){a=[t];break}a.push(t)}else"-1"===i?t.expandAll():t.expandNLevels({numberOfLevelsToExpand:i})}if(a.length>0){var l=i||"-1";t.params.collectionView.treeDocument.prepareUpdate(),n.createBatchServiceReqExecution(a,l,t.params).then(function(){t.params.collectionView.treeDocument.reapplyFilterModel(),a&&a.forEach(function(e){"-1"===l?e.expandAll():"2"===l?e.expandNLevels({numberOfLevelsToExpand:l}):t.params.onPreExpand?e.preExpandDone():e.expandNLevels({numberOfLevelsToExpand:l})}),t.params.collectionView.treeDocument.pushUpdate(),e.unmask(t.params.collectionView.getContent())})}}};return C}),define("DS/CATFLCockpitWidget/services/logitem.service",["DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/gridview.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a){"use strict";var s=o.getFullConfig(),l=s.localStorageKeys;return{createLogItem:function(e){var t=s.webservices.createLogItem;return i.post(t,JSON.stringify(e)).then(function(e){var t=JSON.parse(e).member[0];return o.SAXStorage().setItem(l.recentlyAuthoredStructure+t.id,Date.now()),t}).catch(function(e){n.displayError(e,null,null,a.error_create_item)})},createLogItemInstanceNew:function(e,t,n){var r=s.webservices.createLogItemInstanceNew+t+"/dslog:LogInstancePRIVATE";return i.post(r,JSON.stringify(e),n?0:void 0).then(function(e){o.SAXStorage().setItem(l.recentlyAuthoredStructure+t,Date.now());var i=(e=JSON.parse(e)).member&&e.member[0]?e.member[0].reference:null;return i&&o.SAXStorage().setItem(l.recentlyAuthoredStructure+i,Date.now()),e})},getlogRefDiagramProposal:function(e,t){var n=s.webservices.createLogRefFromDiagramProp;return i.post(n,JSON.stringify(e),0,{wiwSecurityContext:t}).then(function(e){return JSON.parse(e)})},getDataForSetArchNumberOnPSpool:function(e,t){var n=s.webservices.getDataForSetArchNumberOnPSpool;return i.post(n,JSON.stringify(e),0,{wiwSecurityContext:t}).then(function(e){return JSON.parse(e)})},setArchitectureNumberOnPSpool:function(e,t,n){var o=s.webservices.setArchitectureNumberOnPSpool;return i.post(o,JSON.stringify(e),t,{wiwSecurityContext:n})},createItemFromDialogue:function(e,t,n){var o=s.webservices.createLogRefFromDiagram;return i.post(o,JSON.stringify(e),t,{wiwSecurityContext:n})},deleteLogItemInstance:function(e,t){t instanceof Array&&t.length>20&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:20}));var o="/resources/v1/modeler/dslog/dslog:LogItemPRIVATE/"+e+"/dslog:LogInstancePRIVATE/DELETE";return i.post(o,JSON.stringify(t),0).then(function(e){return JSON.parse(e)})},getLogItemWithExpand:function(t,i){var a=this;if(s.disableIndexAcceleration||n.checkIfRecentlyAuthored(t,!0))return a._expandFromModeler(t,i);let c={};c[t]=[[t]];let d={rootWithPaths:c};var u=widget.getValue("ngFilter");if(u&&u.length>0){var p=JSON.parse(u);d.filter=p.CVQueryV2.filter,d.aggregation_processors=p.CVQueryV2.aggregation_processors,p.CVQueryV2.batch&&p.CVQueryV2.batch.expands[0]&&(d.filter||(d.filter=p.CVQueryV2.batch.expands[0].filter),d.aggregation_processors||(d.aggregation_processors=p.CVQueryV2.batch.expands[0].aggregation_processors))}else d.configFilter=i;return e.progressiveExpand(d).then(function(e){if(null===e)return o.SAXStorage().setItem(l.recentlyAuthoredStructure+t,Date.now()),a._expandFromModeler(t,i);let n=!1;0===e.paths.length&&(e.paths.push([t]),e.map[t]={physicalid:t,attributes:{physicalid:t}},n=!0);let s=r.createTreeDocumentFromIndexResponse(e);if(n){let e=s.getRoots()[0];var c={},d=[];return c[e.options.physicalid]=[e],d.push(a.refreshTreeNodeModel(c,!1)),d.push(r.addDBNavigate([e],{navigateTypes:["ZONE"],treeDocument:s})),Promise.all(d).then(()=>(e.expand(),s))}return s})},_expandFromModeler:function(e,i){var n=widget.getValue("component-view"),o="1";return n===l.flattenedView?o=widget.getPreference(l.depthFlattenedView).value:n===l.flattenedViewOnlyArchitectureItem&&(o=widget.getPreference(l.depthFlattenedViewArchitectureItemOnly).value),t.expand({itemIDs:[e],depth:o,configFilter:i}).then(function(t){return r.createTreeDocumentFromDslogModelerResponse(t[e])})},updateAttribute:function(e){var t=[],o=s.webservices.updateAttributes;return e instanceof Array&&e.length>1e3&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:1e3})),e.forEach(function(e){var i={method:"PATCH",body:[],queryParams:{select:["physicalid","modified"]}};for(var n in e.instID?i.path="model/rel/"+e.instID:i.path="model/bus/"+e.refID,e.attributes)e.attributes.hasOwnProperty(n)&&(e.attributes[n]&&e.attributes[n].unitName&&e.attributes[n].dimensionType?i.body.push({op:"replace",path:n,value:e.attributes[n].value,unitName:e.attributes[n].unitName,dimensionType:e.attributes[n].dimensionType}):i.body.push({op:"replace",path:n,value:e.attributes[n]}),i.queryParams.select.push("attribute["+n+"]"));t.push(i)}),i.makeServiceCall(o,"PUT",JSON.stringify({requests:t})).then(function(e){var t=JSON.parse(e).results;if(t){var i=[];for(var n in t)0!==t[n].body.errors.length&&i.push({physicalid:t[n].body.physicalid,errors:t[n].body.errors});return 0!==i.length?Promise.reject({error:{message:a.msg_error_no_modification_possible,errorList:i}}):t}return Promise.reject()})},getLogItemModel:function(e){var t=s.webservices.dsfl_getLogItem+e+"/model";return i.get(t).then(function(e){var t={};e=JSON.parse(e);var i=null;return Object.keys(e).length>0&&e.rootObjects.length>0&&(i=[],e.rootObjects.forEach(function(e){(t={}).physicalid=e.physicalid?e.physicalid:null;for(var n=0;n<e.attributes.length;n++)"id"===e.attributes[n].name?t.id=e.attributes[n].value:"name"===e.attributes[n].name&&(t.name=e.attributes[n].value);i.push(t)})),i}).catch(function(e){var t=e.error.message.slice(e.error.message.indexOf("ResponseCode")),i=a.error_get_model;t&&t.indexOf("404")>=0&&(i=a.error_get_model_media),n.displayError(e,null,null,i)})},getLogItemAttributes:function(e){return t.getObjectAttributes([e])},displayMoreAttributes:function(t,i,o){var r=this,s=[],l=[],c=[],d=[],u=[];i.forEach(function(e){s.push(e.options.physicalid),void 0===c[e.options.physicalid]&&(c[e.options.physicalid]=[]),c[e.options.physicalid].push(e),e.options.instance&&e.options.instance.physicalid&&(l.push(e.options.instance.physicalid),void 0===d[e.options.instance.physicalid]&&(d[e.options.instance.physicalid]=[]),d[e.options.instance.physicalid].push(e))});var p=[],g=[],m=n.getUserCustomAttributes(o);m&&m.forEach(function(e){e.bo?p.push(e.curi):g.push(e.curi)}),p.length>0&&u.push(e.fetch(s,p).then(function(e){r._mapFetchResultsToTreeNodeModel(e,c,!1,o),t.requestDelayedModelData()})),g.length>0&&l.length>0&&u.push(e.fetch(l,g).then(function(e){r._mapFetchResultsToTreeNodeModel(e,d,!0),t.requestDelayedModelData()})),u.length>0?Promise.all(u).then(function(){1===i.length?o?n.alertMessage("info",null,a.msg_additional_attributes_displayed_success_single_solution):n.alertMessage("info",null,a.msg_additional_attributes_displayed_success_single):o?n.alertMessage("info",null,a.msg_additional_attributes_displayed_success_multiple_solutions):n.alertMessage("info",null,a.msg_additional_attributes_displayed_success_multiple)}):n.alertMessage("warning",null,a.warning_no_additional_attributes_to_displayed)},_mapFetchResultsToTreeNodeModel:function(e,t,i,o){let r=n.getUserCustomAttributes(o),a=[],s=[],l=[];r&&r.forEach(function(e){e.manipulationUnit&&a.push(e.curi),e.multiValuated&&s.push(e.curi),(e.isSharedPredicateOnSameType||e.isSharedPredicate&&(e.isClassification||e.isOnExtension))&&l.push(e.curi)});for(var c=0;c<e.length;c++){var d={grid:{}};for(var u in e[c])if("resourceid"!==u){var p=e[c][u].dispValue||e[c][u].value;(s.indexOf(u)>=0||l.indexOf(u)>=0)&&!Array.isArray(p)&&(p=p?[p]:[]),i?a.indexOf(u)>=0?(d.grid["instance_"+u+"_actual"]=p,d.grid["instance_"+u]=""):d.grid["instance_"+u]=p:o?a.indexOf(u)>=0?(d.grid["physical_"+u+"_actual"]=p,d.grid["physical_"+u]=""):d.grid["physical_"+u]=p:a.indexOf(u)>=0?(d.grid[u+"_actual"]=p,d.grid[u]=""):d.grid[u]=p}r.forEach(function(e){var t=e.curi;i?t="instance_"+t:o&&(t="physical_"+t),n.getNLSValueFromRangeValuesAttribute(e,t,d.grid)});for(var g=t[e[c].resourceid.value],m=0;m<g.length;m++)g[m].updateOptions(d)}},getCustomField:function(e){var t="",o="";null!=e&&(t=e.options.physicalid,o=e.options.label+" "+e.options.grid.revision);var r=s.webservices.dsfl_getCustomFields;return i.post(r,JSON.stringify({parentID:t}),0).then(function(e){return JSON.parse(e)}).catch(function(e){var t=a.replace(a.error_get_customFields,{title:o});return e.errorResp&&e.errorResp.message&&500!==e.errorResp.status?t+=e.errorResp.message:UWA.is(e.error,"string")&&(t+=e.error),n.alertMessage("error",null,t),Promise.reject()})},refreshTreeNodeModel:function(e,i,n){return t.refreshTreeNodeModel(e,i,n)},refreshInstanceNodeModel:function(e,i){return t.refreshInstanceNodeModel(e,i)},getArchitectureNumberProposal:function(e){var t=s.webservices.getArchitectureNumberProposal;return i.post(t,JSON.stringify(e),0)},getANProposalForReparent:function(e){var t=s.webservices.getANProposalForReparent;return i.post(t,JSON.stringify(e),0)},setArchitectureNumber:function(e){e.architectureNumbers&&e.architectureNumbers instanceof Array&&e.architectureNumbers.length>100&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:100}));var t=s.webservices.setArchitectureNumber;return i.post(t,JSON.stringify(e),0)},setANandReparent:function(e){e.architectureNumbers&&e.architectureNumbers instanceof Array&&e.architectureNumbers.length>5&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:5}));var t=s.webservices.setANandReparent+s.webservices.getLogInstMask;return i.post(t,JSON.stringify(e),0)},detachArchitectureReferenceExtension:function(e,t){e instanceof Array&&e.length>100&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:100}));var o={SelectedReferences:e,action:t},r=s.webservices.detachArchitectureReferenceExtension;return i.post(r,JSON.stringify(o),0)},updateSolutionIDAttributes:function(e){e instanceof Array&&e.length>20&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:20}));var t=s.webservices.addSolutions;return i.post(t,JSON.stringify(e),0).then(function(e){return JSON.parse(e)})},detachSolution:function(e){var t=s.webservices.removeSolutions;return i.post(t,JSON.stringify(e),0)},replaceWithExistingRef:function(e,t,n,o){var r=s.webservices.replaceWithExistingRef+s.webservices.getLogInstMask;return i.post(r,JSON.stringify([{referenceID:n,instanceID:t,replaceWith:o}])).then(function(e){return JSON.parse(e)})},replaceWithNewRef:function(e,t,n,o,r){var a=s.webservices.replaceWithExistingRef+s.webservices.getLogInstMask,l={};r&&Object.keys(r).length>0&&(l.CustomFields=r),o&&(l.type=o),l.attributes=n?{title:n}:{};var c={replaceWith:"newReference",instanceID:t,newReference:l};return Object.keys(r).length>0&&(c.CustomFields=r),i.post(a,JSON.stringify([c])).then(function(e){return JSON.parse(e)})},replaceWithNewRevision:function(e){var t=s.webservices.replaceWithExistingRef+s.webservices.getLogInstMask;return e instanceof Array&&e.length>100&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:100})),i.post(t,JSON.stringify(e),0).then(function(e){return JSON.parse(e)})},reparentInstances:function(e){var t=s.webservices.reparentInstances+s.webservices.getLogInstMask;return e instanceof Array&&e.length>5&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:5})),i.post(t,JSON.stringify(e),0).then(function(e){return e})},getSubTypes:function(e){return e||(e=""),i.post(s.webservices.dslog_getSubTypes,JSON.stringify({parentType:e}),0).then(function(e){return JSON.parse(e)})},getSubTypesOfLogicalReferenceAndInstance:function(){return i.post(s.webservices.getTypeInfo,JSON.stringify([s.identifiers.type_act_logref,s.identifiers.type_act_loginstance]),0).then(function(e){var t=JSON.parse(e),i={};for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];void 0!==o.parent&&(void 0===i[o.parent]&&(i[o.parent]=[o.parent]),i[o.parent].push(n))}return i})},consolidateLogicalDefinition:function(e){return e.instanceIds&&e.instanceIds instanceof Array&&e.instanceIds.length>1e3&&n.alertMessage("warning",null,a.replace(a.msg_bulkOperation_limitReached,{limit:1e3})),i.post(s.webservices.consolidateLogDefn,JSON.stringify(e),0).then(function(e){return JSON.parse(e)})},compareWithLastOutfitted:function(e){return i.post(s.webservices.compareWithLastOutfitted,JSON.stringify(e),0).then(function(e){return JSON.parse(e)}).catch(function(e){return Promise.reject(e)})},recomputeArchNum:function(e){return i.post(s.webservices.recomputeArchNum,JSON.stringify(e),0).then(function(e){return JSON.parse(e)}).catch(function(e){return Promise.reject(e)})},checkToUpdateSpace:function(e){var t=e.map(function(e){return e.options.physicalid});return i.post(s.webservices.checkToUpdateSpace,JSON.stringify(t),0).then(function(e){return JSON.parse(e)},function(e){return Promise.reject(e)})},getLogItemClassificationAttributes:function(e){return t.getObjectClassificationAttributes(e)}}}),define("DS/CATFLCockpitWidget/utils/refresh.util",["DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/UIKIT/Mask","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c){"use strict";var d=r.getFullConfig(),u=d.localStorageKeys;return{addChildrenToParent:function(e,t,n,o){var a=[],l={},c=[];o=o||!1,e.prepareUpdate(),t.forEach(function(e){n.forEach(function(t){var i=new s({hasBeenExpanded:!1,noIndexOrDBExpand:!1,physicalid:t.reference,instance:{physicalid:t.id},grid:{physicalid:t.reference,instanceName:t.name,instance_description:""},actualParent:e,children:[]});t.id&&i.setRelationID(t.id),e.addChild(i),c.indexOf(e.options.physicalid)<0&&(c.push(e.options.physicalid),r.SAXStorage().setItem(u.recentlyAuthoredStructure+e.options.physicalid,Date.now())),a.indexOf(t.reference)<0&&a.push(t.reference),Object.keys(l).indexOf(t.id)<0&&(l[t.id]=i)})}),e.pushUpdate(),i.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:a,tagAsRecentlyAuthored:o}})},refreshNodeDetails:function(t){var i=this,o=t.arrayOfPID,r=t.tagAsRecentlyAuthored,a={},s=[],l=[];o&&(o.forEach(function(e){var t=i.contentView.treeDocument.getMappedNodesFromId(e);if(a[e]=t||[],t&&t.length>0)for(var n=0;n<t.length;n++){var o=t[0];if(o.options.physicalid&&(o.isRoot()||o.options.instance&&o.options.instance.physicalid)){l.push(o);break}}}),s.push(e.refreshTreeNodeModel(a,r,i.contentView)),t.dontLoadSpaceInfo||s.push(n.addDBNavigate(l,{navigateTypes:["ZONE"],treeDocument:i.contentView.treeDocument})),Promise.all(s).then(()=>{}))},refreshInstDetailsonNode:function(t){let i,n=this,o=[],r={},a=Object.keys(t.instIdMap),s=[];if(a.forEach(function(e){(i=t.instIdMap[e])&&i instanceof Array||(i=n.contentView.treeDocument.getRoots()[0].getNodesByRelId(e)),s.push(i[0].options.physicalid),r[e]=i||[]}),t.bInstance&&o.push(e.refreshInstanceNodeModel(r,!0)),t.bEffectivity){var l={relids:a,pids:s},u=d.gridview.additionalColumnsModules.cfgEffectivty;u&&o.push(new Promise(function(e,t){u.updateAttributes(l,function(i){var n=UWA.is(i,"string")?JSON.parse(i):i;e(n),t("Error in Cfg_updateAttributes")},n)}).then(function(e){let t=e?e.relids:{};n.contentView.treeDocument.withTransactionUpdate(function(){a.forEach(function(e){var i=r[e],n=t[e];n&&(n.VariantEffectivity.trim()||(n.VariantEffectivity=c.label_none),i.forEach(e=>{e.updateOptions({grid:n})}))})})}))}Promise.all(o).then(()=>{let e=n.contentView.getGroupingOptions();e&&n.contentView.groupRows(e)})},refreshSpacesonNode:function(e){e&&(e.forEach(function(e){r.SAXStorage().setItem(u.recentlyAuthored+e.options.physicalid,Date.now())}),n.addDBNavigate(e,{navigateTypes:["ZONE"],treeDocument:this.contentView.treeDocument}))},refreshSolutionsonNode:function(e){e&&(e.forEach(function(e){r.SAXStorage().setItem(u.recentlyAuthored+e.options.physicalid,Date.now())}),n.addDBNavigate(e,{navigateTypes:["PROPOSED_SOLUTION"],treeDocument:this.contentView.treeDocument}))},refreshDocumentsOnNodes:function(e){var t=e.nodes,i=e.docType;if(t){let e=new Set;(t=t.filter(function(t){let i=t.options.physicalid;return!e.has(i)&&e.add(i)})).forEach(function(e){r.SAXStorage().setItem(u.recentlyAuthored+e.options.physicalid,Date.now())}),"attachedDocumentsCategory"===i?n.addDBNavigate(t,{navigateTypes:["REFERENCE_DOCUMENT"],treeDocument:this.contentView.treeDocument}):"specificationDocumentsCategory"===i?n.addDBNavigate(t,{navigateTypes:["SPECIFICATION_DOCUMENT"],treeDocument:this.contentView.treeDocument}):n.addDBNavigate(t,{navigateTypes:["SPECIFICATION_DOCUMENT","REFERENCE_DOCUMENT"],treeDocument:this.contentView.treeDocument})}},refreshReferenceLinksOnNodes:function(e){e&&(e.forEach(function(e){r.SAXStorage().setItem(u.recentlyAuthored+e.options.physicalid,Date.now())}),n.addDBNavigate(e,{navigateTypes:["IMPLEMENTEDBY_LINK","IMPLEMENTING_LINK"],treeDocument:this.contentView.treeDocument}))},removeItemsFromCatogry:function(e){var t=this,i=e.nodes,n=e.categoryType;let o=widget.getValue("groupingEnabled");i&&i.length>0&&i.forEach(function(e){var i=e.options.physicalid,r=e.getParent();if(r){var s=r.getParent();if(o&&!s.getID&&(s=a.getGroupNodeParent(s)),o&&s.isRoot()){let e=r.getParent();r.getChildren().forEach(function(e){e.options.physicalid===i&&e.remove()}),r.getChildren()&&0!==r.getChildren().length||r.remove(),a.removeGroupNodesOnEmpty(e)}else{(t.contentView.treeDocument.getMappedNodesFromId(s.options.physicalid)||[s]).forEach(function(e){var t=e.options.instance?e.options.instance.physicalid:"",o=e.getNodesByRelId(n+t)[0];o.getChildren().forEach(function(e){e.options.physicalid===i&&e.remove()}),o.getChildren()&&0!==o.getChildren().length||o.remove(),e.expand()})}}})},refreshNodesOnReparent:function(e){var t=e.resp,i=e.params,n=e.newParent,a=e.instArray;t=t&&UWA.is(t,"string")?JSON.parse(t):t;var s=i.collectionView.treeDocument.getMappedNodesFromId(n.options.physicalid),d=t&&t.member?t.member:[];a.forEach(function(e,t){r.SAXStorage().setItem(u.recentlyAuthoredStructure+e.getParent().options.physicalid,Date.now());var n=i.collectionView.treeDocument.getMappedNodesFromId(e.options.physicalid)||[e];for(t=n.length-1;t>=0;t--){var o=n[t];if(o.options.instance.physicalid===e.options.instance.physicalid){var a=o.getParent();a.removeChild(o),a.expand()}}}),this.addChildrenToParent(i.collectionView.treeDocument,s,d,!0),l.unmask(i.collectionView.getContent()),o.alertMessage("success",null,c.msg_reparentSuccess)},refreshNodesOnReplace:function(e){let t=e.replaceDetails,n=e.selectedNodes,o=this.contentView.treeDocument,a={};if(t&&t.length>0){let e={},d=[],p={};n.forEach(function(t){e[t.options.instance.physicalid]=t});for(var s=0;s<t.length;s++){r.SAXStorage().setItem(u.recentlyAuthoredStructure+t[s].parent,Date.now());let i=t[s].old,n=e[i];a[t[s].new.instance]=n;var l=o.getMappedNodesFromId(n.options.physicalid);l||(l=[n]);for(var c=l.length-1;c>=0;c--){let e=l[c];e.options.instance.physicalid===i&&(o.removeFromMappedNodes(e),e.removeChildren(),e.collapse(),e.updateOptions({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,configContexts:void 0,physicalid:t[s].new.reference,instance:{physicalid:t[s].new.instance},grid:{physicalid:t[s].new.reference,configCtx:void 0}}),e.setRelationID(t[s].new.instance),o.addToMappedNodes(e))}d.push(t[s].new.reference),p[t[s].new.instance]=n}i.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:d,tagAsRecentlyAuthored:!0}}),i.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-inst-by-id",data:{instIdMap:p,bInstance:!0,bEffectivity:!0}})}},refreshConnectedDIFNode:function(e){var i={itemID:e.options.physicalid};return t.getAttributes(i).then(function(t){e.updateOptions({grid:{maturity:t.attributes.grid.maturity}}),e.updateOptions({grid:{owner:t.attributes.grid.owner}})}).catch(function(e){o.alertMessage("error",null,e.errorResp.message)})},replaceNodeOnReplaceByNewRef:function(e){let t=[],n={};r.SAXStorage().setItem(u.recentlyAuthoredStructure+e.parentRefId,Date.now());let o=e.treeNodeToBeReplaced.options.instance.physicalid;for(var a=e.mappedNodes.length-1;a>=0;a--){var s=e.mappedNodes[a];s.options.instance.physicalid===o&&(e.treeDocument.removeFromMappedNodes(s),s.removeChildren(),s.collapse(),s.updateOptions({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,configContexts:void 0,physicalid:e.instanceData.reference,instance:{physicalid:e.instanceData.id},grid:{instanceName:e.instanceData.name,physicalid:e.instanceData.reference,hasEffectivity:void 0,configCtx:void 0}}),s.setRelationID(e.instanceData.id),e.treeDocument.addToMappedNodes(s))}t.push(e.instanceData.reference),n[e.instanceData.id]=e.treeNodeToBeReplaced,i.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:t,tagAsRecentlyAuthored:!0}}),i.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-inst-by-id",data:{instIdMap:n,bInstance:!0,bEffectivity:!0}})}}}),define("DS/CATFLCockpitWidget/services/predicate.service",["DS/CATFLCockpitWidget/services/logitem.service","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/xhr.util"],function(e,t,i,n){"use strict";var o,r,a=i.getFullConfig(),s=i.getFullConfig().identifiers;return{getLtypes:function(){return o||(o=e.getSubTypesOfLogicalReferenceAndInstance()),o},getPredicatesForLtypes:function(){var e=this;return r||(r=e.getLtypes().then(function(t){return e.getPredicates(t[s.type_act_logref],t[s.type_act_loginstance]).catch(function(t){return r=null,e.getPredicatesForLtypes()})})),r},getPredicates:function(e,t){return Promise.all([this._splicedGetPropertiesForClass(e),this._splicedGetPropertiesForClass(t)]).then(function(e){return[e[0],e[1]]})},getPropertiesPredicates:function(e){var t=a.webservices.getInfoProperties,i=[];for(var o in e){var r=[];for(var s in e[o])r.push(s);i.push({type:o,attributes:r})}return i.length>0?n.post(t,JSON.stringify(i)):Promise.resolve(null)},getNLSPredicates:function(e){var i=e.map(e=>e.curi),n=i.join(",");return new Promise(function(o,r){t.getResourcesInfo(n,{apiVersion:"R2019x",tenantId:widget.getValue("x3dPlatformId"),lang:widget.lang||"en",onComplete:function(t){var n="string"==typeof t?JSON.parse(t):t,r={};Array.isArray(n)&&i.length===n.length?n.forEach(function(e){r[e.curi]=e.label}):(console.warn("Inconsistent NLS answer compared to input"),e.forEach(function(e,t){r[e.curi]=e.nls})),o(r)},onFailure:function(){var t={};e.forEach(function(e,i){t[e.curi]=e.nls}),o(t)}})})},_splicedGetPropertiesForClass:function(e){if(0===e.length)return[];var i=[],n=[];if(e.length>25)for(var o=0;o<e.length;o+=25)i.push(e.slice(o,o+25));else i.push(e);for(var r=0;r<i.length;r++)n.push(new Promise(function(e,n){t.getPropertiesForClass(i[r],{apiVersion:"R2019x",lang:widget.lang||"en",tenantId:widget.getValue("x3dPlatformId"),onComplete:function(t){e(t)},onFailure:function(t){t.stack.contains("timedout")?n(t):e([])}})}));return Promise.all(n).then(function(e){return[].concat.apply([],e)})}}}),define("DS/CATFLCockpitWidget/utils/architectureNumber.util",["UWA/Core","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/logitem.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){"use strict";return{executeRecompute:function(e){let o,r,a,s,l,c,d,u,p=this,g=e.isWIWcall,m=e.an_action,f=e.rows,h=[],v=!0,C={AN_ACTION:m,anColumns:[],instances:[]},b=!1;for(let t=0;t<f.length;t++){var y=f[t];if("ok"===y.getChildren()[0].getAttribute("status")){h.push(y),o=g?y.getAttribute("data-id"):y.getAttribute("referenceID"),r=y.getElement(".archidcell").innerText,a=y.querySelectorAll('[required = "true"]'),s=!1,c=null,d=null,u={},l={},y.getElements("[architectureidcolumn=true]").forEach(e=>{if(c=e.getAttribute("id"),"true"===e.getAttribute("editable")){let t=e.getChildren()&&e.getChildren()[0];d=t.dsModel.value}else d=e.getHTML();u[c]=d,b||C.anColumns.push(c)}),C.anColumns.length>0&&(b=!0),e.forReparent?Array.isArray(y.getAttribute("instanceIDs"))?l.instanceIDs=y.getAttribute("instanceIDs"):l.instanceIDs=y.getAttribute("instanceIDs").split(","):l.instanceID=g?y.getAttribute("data-instance"):y.getAttribute("instanceID"),l.referenceID=o,l.ArchitectureNumber=r,l.ArchitectureNumberTokens=u,C.instances.push(l),y.getAttribute("data-type")&&(C.logicalRefType=y.getAttribute("data-type")),v=!1}}v?t.alertMessage("error",null,n.log_ref_selection_error):(e.SelectionContext&&(C.SelectionContext=e.SelectionContext),i.recomputeArchNum(C).then(function(e){p.updateRowsOnRecompute(g,e,h),t.alertMessage("success",null,"",n.msg_recompute_setArch_success)},function(e){t.displayError(e,null,null,n.error_recompute_failed)}))},updateRowsOnRecompute:function(e,t,i){let n,o,r=this,a=e?"data-instance":"referenceID";i.forEach(function(e){o=t[e.getAttribute(a)],Object.keys(o).forEach(function(t){if(n=e.getElement("#"+t))if("true"===n.getAttribute("editable")){let e=n.getChildren()[0].dsModel;e.value=o[t];let i=e.elementsList;if(i){let n;for(let e=0;e<i.length;e++)if(i[e].value===o[t]){n=e;break}n&&(e.selectedIndex=n,e._applySelectedIndex())}}else n.setHTML(o[t]);e.getElement("#ANRecompute")&&e.getElement("#ANRecompute").hasClassName("errordiv")&&e.getElement("#ANRecompute").removeClassName("errordiv")}),r.updateArchitectureID(null,e,!0)})},updateArchitectureID:function(e,t,i){let n=t.getElements("[architectureidcolumn=true]");var o="",r=null;e&&e.removeClassName&&e.removeClassName("errordiv"),n.forEach(e=>{if("true"===e.getAttribute("editable")){let t=e.getChildren()&&e.getChildren()[0];o+=t.dsModel._properties.valueToCommit?t.dsModel._properties.valueToCommit.value:t.dsModel.value?t.dsModel.value:""}else o+=e.getHTML()}),(r=t.getElement(".archidcell"))&&r.getText()!=o&&(r.setText(o),r.removeClassName("errordiv"),!i&&t.getElement("#ANRecompute")&&t.getElement("#ANRecompute").addClassName("errordiv"))}}}),define("DS/CATFLCockpitWidget/mixins/CATFLBIFilter",["UWA/Class","UWA/Class/Events","DS/ENOFilterBIUX/FilterBIComponentProxy","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","text!DS/CATFLCockpitWidget/assets/config/mapping.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c){"use strict";var d=o.getFullConfig(),u=d.identifiers,p=JSON.parse(l);return e.extend(t,{_biFilter:null,filterInitialized:!1,_id2removeFromFilterProxy:[],_filterAlreadyTreatedRoot:[],defaultOptions:{model:null},init:function(e){this.options={model:e.view?e.view.treeDocument:void 0,view:e.view},this.initializeBI()},initializeBI:function(){this._createProxy()},cleanProxy:function(){this._biFilter&&this._biFilter.cleanProxy&&this._biFilter.cleanProxy()},removeRootFromFilterProxy:function(e){this._biFilter&&(this._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:e.rootId2remove}),this._biFilter.removeRoot(e.rootId2remove))},addFilter:function(){},loadFilters:function(){},onModifyPreferences:function(){},onApplyNGFilter:function(e){null!==e&&this.options.model.applyFilter(e,this.processNGFilter.bind(this,e))},processNGFilter:function(e,t){if(e.empty)widget.setValue("ngFilter",null),widget._biFilter=null,a.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-ngfilter-removed",data:{filterName:null}});else{e&&e.filterMdl&&delete e.filterMdl;let t=this._biFilter.hasFilter(e.filterRootIds[0]);t.filterId&&(e.filterId=t.filterId),widget.setValue("ngFilter",JSON.stringify(e)),widget._biFilter=this._biFilter,a.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-ngfilter-added",data:{filterName:e.filterName,filterTitle:e.filterTitle}})}if(t.response?(t.recentlyAuthored&&!e.empty&&n.alertMessage("warning",null,c.warn_indexed_data_filtered),t.treedocument.empty(),t.treedocument.hasBeenExpanded=!0,t.recentlyAuthored&&e.empty?r.createTreeDocumentFromDslogModelerResponse(t.response,t.treedocument):r.createTreeDocumentFromIndexResponse(t.response,t.treedocument)):n.alertMessage("info",null,c.msg_no_match_in_filter),e.empty){let e=this.options.view.getGroupingOptions();e&&this.options.view.groupRows(e)}},onSetPathTags:function(){if(this._biFilter){var e=this;setTimeout(function(){var t={nodes:[],paths:[]},i={};function n(e){if(!e.isHidden()){var o=e.getRealPath().map(function(e){return function(e){return i.hasOwnProperty(e)||(t.nodes.push(e),i[e]=t.nodes.length-1),i[e]}(e.getID())});t.paths.push(o);var r=e.getChildren();r&&r.forEach(function(e){n(e)})}}e.options.model.getRealRoots().forEach(function(e){n(e)}),e._biFilter.setPathTags(t)})}},onSetTagsWithExpandSynthesis:function(){if(this._biFilter&&this.options.model&&this.options.model.getRealRoots()[0]){var e=this;this._biFilter.setSynthesisMode("flat"),setTimeout(function(){var t=e.options.model.getRealRoots()[0],i=t?t.getID():null;e._biFilter.setTagsWithExpandSynthesis&&i&&e._biFilter.setTagsWithExpandSynthesis([i],{type_filter_rel:["RFLVPMLogicalInstance","RFLPLMFunctionalInstance"]})})}},onTagsLoadingComplete:function(){},onFilterBIColorize:function(e){if(this.colorizeActivated=!0,e){this.predicateKind=e.tagColors&&e.tagColors.length?e.tagColors[0].type:null;for(var t=this.colorMap={map:{}},i=0;i<e.tagColors.length;i++){if(void 0===t.predicate){var n=e.tagColors[i].predicate.split("/"),o=n[n.length-1];t.predicate=o}var r=e.tagColors[i].object;UWA.is(e.tagColors[i].object,"array")&&(r=e.tagColors[i].object.join("/"),this.predicateKind="arrayPredicates"),t.map[r]=e.tagColors[i].color,t.map[e.tagColors[i].dispValue]=e.tagColors[i].color}this.colorizeNodes()}},colorizeNodes:function(){var e=this,t=p[this.colorMap.predicate]||this.colorMap.predicate;e.options.view.columns.find(e=>e.dataIndex===t)?e.options.model.withTransactionUpdate(function(){e.options.model.getAllDescendants().forEach(function(i){if(i.isVisible()&&!i.options.virtual){var n=t?i.options[t]?i.options[t]:i.options.grid[t]:void 0,o=null;if("date"===e.predicateKind){var r=new Date(n),a=r.getFullYear()+"/"+(r.getMonth()+1).toString().padStart(2,"0")+"/"+r.getDate().toString().padStart(2,"0"),s=r.getFullYear()+"/"+(r.getMonth()+1).toString().padStart(2,"0"),l=r.getFullYear();o=e.colorMap.map[a]?e.colorMap.map[a]:e.colorMap.map[s]?e.colorMap.map[s]:e.colorMap.map[l]?e.colorMap.map[l]:"rgba(0, 0, 0, 0)"}else"type"===t?o=e.colorMap.map[i.options.grid[t]]?e.colorMap.map[i.options.grid[t]]:"rgba(0, 0, 0, 0)":o||(o=e.colorMap.map[i.options[t]]?e.colorMap.map[i.options[t]]:e.colorMap.map[i.options.grid[t]]?e.colorMap.map[i.options.grid[t]]:"rgba(0, 0, 0, 0)");o||(o=e.colorMap.map[n]?e.colorMap.map[n]:"rgba(0, 0, 0, 0)");var c={color:o,isBeingCut:!1,grid:{bi_color:o}};i.updateOptions(c)}})}):(n.alertMessage("error",null,c.error_filter_colorize_predicate),this.onFilterBIUnColorize())},onFilterBIUnColorize:function(){var e=this;this.colorizeActivated=!1,e.options.model.withTransactionUpdate(function(){e.options.model.getRealRoots().forEach(function(e){var t={color:"rgba(0, 0, 0, 0)",grid:{bi_color:"rgba(0, 0, 0, 0)"}};e.updateOptions(t),e.getAllDescendants().forEach(function(e){e.updateOptions(t)})})})},onFilterBIFilteringEvent:function(e){var t=this;(t.getAllModels?t.getAllModels():[t.options.model]).forEach(function(i){i.withTransactionUpdate(function(){i.getRoots(!0).slice(0).forEach(function(e){e.filterIn(!0)});var n=i.getRealRoots(!0).slice(0);n.forEach(function(e){e.filterIn(!0)});var o=e.filteredSubjectList;if(o){for(var r=e.nodes,a=[],s={},l=function(e){return r[e]},c=0;c<o.length;c++){var d=o[c];s.hasOwnProperty(d)||a.push(d.map(l))}a.forEach(function(e){i.getNodesByIDPath(e).forEach(function(e){e._filterStatus="IN",e.getParents().forEach(function(e){e._filterStatus="IN"})})});n.forEach(function(e){!function e(t,i){if("IN"===t._filterStatus){var n=t.getChildren();n&&n.length>0&&n.slice(0).forEach(function(t){e(t)})}else t.filterOut(),i&&i.push(t),!0;delete t._filterStatus}(e);var t=!1;if(e.options._childrenFilterInfo){var i=e.options._childrenFilterInfo.filteredOutChildren;i&&i.length>0&&(t=!0)}t&&(e.setState({state:"partiallyExpanded"}),e.options.padstate="partiallyExpanded"),t=!1})}else console.error("Invalid Argument : %o",e);t.onSetPathTags()})})},onFilterSave:function(e){var t=widget.getValue("ngFilter");t?(t=JSON.parse(t)).filterId=e.filterId:t=e,widget.setValue("ngFilter",JSON.stringify(t))},onFilterClose:function(){},_createProxy:function(){var e=this,t={tenant:o.getTenant(),processingMode:"appProcessing",colorize:!0,widgetId:widget.id,appId:widget.id,ExpandSynthesisON:!0};UWA.is(e.onFilterFilteringEvent,"function")&&(t.events={addFilterChangeListener:e.onFilterFilteringEvent.bind(e)}),e._biFilter=new i(t),e._biFilter.addEvent("TagsLoadingComplete",e.onTagsLoadingComplete,e),e._biFilter.addEvent("SaveNGFilter",e.onFilterSave,e),e._biFilter.addEvent("NGFilter_Close",e.onFilterClose,e),e._biFilter.addEvent("FilterBIColorize",e.onFilterBIColorize,e),e._biFilter.addEvent("FilterBIUnColorize",e.onFilterBIUnColorize,e),e._biFilter.addEvent("FilterBIFilteringEvent",e.onFilterBIFilteringEvent,e);var n=e.options.model;if(void 0!==n&&(e.options.model.getModelEvents().subscribe({event:"onRootAdded"},e.onSetTagsWithExpandSynthesis.bind(e)),e.options.model.getModelEvents().subscribe({event:"colorizeNodesFromTagger"},function(){e.colorizeActivated&&e.colorizeNodes()})),UWA.is(e._biFilter.setNGFilterOptions,"function")){var r={expandServices:["progressive","expand"],appId:widget.id};e._biFilter.setNGFilterOptions(r),e._biFilter.addEvent("ApplyNGFilter",e.onApplyNGFilter,e),void 0!==n&&(e.options.model._isVolumeFilter=!0)}e.filterInitialized=!0,e.dispatchEvent("filterInitialized",e.filterInitialized)},updateModel:function(e){var t=this;t.options.view=e,t.options.model=e.treeDocument,t.options.model.getModelEvents().subscribe({event:"onRootAdded"},t.onSetTagsWithExpandSynthesis.bind(t)),t.options.model.getModelEvents().subscribe({event:"colorizeNodesFromTagger"},function(){t.colorizeActivated&&t.colorizeNodes()}),t.options.model._isVolumeFilter=!0},retrieveFilterInfo:function(e,t){var i=t.objectId;this._biFilter.retrieveFilters({filterObjects:[t],droppedEnvId:widget.getValue("x3dPlatformId"),doNotFillTheTagger:!1,callback:this.processFilterInfo.bind(this,e,i)})},processFilterInfo:function(e,t,i){var r=this;if(i&&Array.isArray(i.success)&&i.success.length>0){var l=i.success[0],p=l.rootId;l.filter||(widget.deleteValue("currentOpenedItem"),widget.deleteValue("currentlyOpenedItems"),widget.setValue("currentView","LandingPage"),widget.deleteValue("ngFilter"),p&&e.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:p}),a.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"}));var g={filterRootIds:[p],empty:!1,filterName:l.filterName,filterTitle:l.filterTitle,filterId:t,CVQuery:l.filter.CVQuery,CVQueryV2:l.filter.CVQueryV2};if(e.itemId!==p)s.getKindOfRFLP([p]).then(function(t){if(t&&"L"===t[0]){var i=a.getFLWebModelEventsObj("flcockpit-content-list-view"),s=i.subscribe({event:"content-list-view-refresh-complete"},function(e){i.unsubscribe(s),r.crRecTimeoutToCheckTreeDocExp(e,g)});e.load(p)}else{n.alertMessage("error",null,c.error_invalid_filter);var l=widget.getValue("ngFilter");if(l&&l.length>0){var d=JSON.parse(l);d.filterId?(p&&e.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:p}),e.contentListView.catflBIFilter._biFilter.retrieveFilters({filterObjects:[{envId:o.getTenant(),serviceId:"3DSpace",contextId:"ctx::"+o.getSecurityContext(),objectId:d.filterId,objectType:u.type_act_advfilter,displayName:d.filterTitle}],droppedEnvId:o.getTenant(),doNotFillTheTagger:!1})):(e.contentListView.catflBIFilter._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:[e.itemId]}),e.contentListView.catflBIFilter._biFilter.removeRoot(e.itemId),g={filterRootIds:[e.itemId],empty:!0,filterName:""},n.alertMessage("warning",null,c.warn_clear_filter),e.contentListView.catflBIFilter._biFilter.dispatchEvent("ApplyNGFilter",g))}else widget.getValue("currentOpenedItem")?p&&(e.contentListView.catflBIFilter._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:[p]}),e.contentListView.catflBIFilter._biFilter.removeRoot(p)):(widget.deleteValue("X3DContentId"),widget.deleteValue("currentOpenedItem"),widget.deleteValue("currentlyOpenedItems"),widget.setValue("currentView","LandingPage"),widget.deleteValue("ngFilter"),p&&(e.contentListView.catflBIFilter._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:[p]}),e.contentListView.catflBIFilter._biFilter.removeRoot(p)),a.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"}))}});else{if(d.disableIndexAcceleration)return void n.alertMessage("warning",null,c.warn_filter_only_indexed_mode);r.onSetTagsWithExpandSynthesis(),e.contentListView.catflBIFilter._biFilter.dispatchEvent("ApplyNGFilter",g)}}else i&&Array.isArray(i.failure)&&i.failure.length>0&&n.alertMessage(i.failure[0].eventID,null,i.failure[0].msg)},crRecTimeoutToCheckTreeDocExp:function(e,t){var i=this;if(e.contentListView&&e.contentListView.contentView.treeDocument)if(e.contentListView.contentView.treeDocument.isExpanding())setTimeout(function(){i.crRecTimeoutToCheckTreeDocExp(e,t)},200);else{if(d.disableIndexAcceleration)return void n.alertMessage("warning",null,c.warn_filter_only_indexed_mode);e.contentListView.catflBIFilter._biFilter.dispatchEvent("ApplyNGFilter",t)}}})}),define("DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment",["DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/Handlebars/Handlebars","DS/DataGridView/DataGridView","DS/Windows/Dialog","DS/Controls/Button","DS/UIKIT/Mask","DS/CATFLCockpitWidget/services/space.service","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/model.events.util","text!DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m){"use strict";var f=c.getFullConfig(),h=f.identifiers,v=f.localStorageKeys,C={main:i.compile(g)},b=function(e){this.logicalRef=e;var t=this;l.checkToUpdateSpace([e]).then(function(i){t.pilotingDisciplineWarnMsg=null,"WARNING_PILOTDISC"===i[e.options.physicalid]&&(t.pilotingDisciplineWarnMsg=m.msg_has_piloting_discipline_warn),t.render()},function(e){d.displayError(e,null,null,m.msg_generic_error_get_failed)})};return b.prototype.render=function(){var e=this;e.dialog=new o({title:m.action_assign_space+" - "+e.logicalRef.options.label,content:C.main({labelSpaceConceptRoot:m.label_space_concept_root,labelNoSelection:m.message_no_space_concept_root_selected,iconTooltip:m.select_space_concept_root,warningMsg:e.pilotingDisciplineWarnMsg}),height:500,width:700,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new r({label:m.label_assign,emphasize:"primary",disabled:!0,onClick:function(){a.mask(e.dialog.elements._mainContentDiv,m.msg_processing);var t=e.treeDocument.getSelectedNodes(),i=e.logicalRef.options.assignedSpacesPID,n=[],o=[];i&&i.length>0&&(e.treeDocument.getAllDescendants().forEach(function(e){i.forEach(function(t){e.options.physicalid!==t.obj||e.isSelected()||n.push(t.owner)})}),n.length>0&&o.push(s.deleteSPPConnection(n,[e.logicalRef]))),t.length>0&&(t=t.filter(function(e){if(i&&i.length>0)for(var t=0;t<i.length;t++)if(e.options.physicalid===i[t].obj)return!1;return!0})).length>0&&o.push(s.createSPPConnection([e.logicalRef],t)),Promise.all(o).then(function(){p.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-spaces-by-id",data:[e.logicalRef]}),e.dialog.close()}).catch(function(){a.unmask(e.dialog.elements._mainContentDiv)})}}),Cancel:new r({emphasize:"secondary",onClick:function(){e.dialog.close()}})}}),e.dialog.addEventListener("close",function(){e.dialog.destroy()}),e.dialog.elements.container.classList.add("flweb-space-assigment-panel"),new r({label:m.label_search,emphasize:"primary",icon:{iconName:"search"}}).inject(e.dialog.elements.container.querySelector(".search-icon")).getContent().addEventListener("buttonclick",function(){u.launchSearch({searchTitle:m.label_search_spConceptRoot,allowedTypes:h.type_spaceRoot,role:"",criteria:h.type_spaceRoot,bMultiSel:!1,in_apps_callback:function(t){e._loadSpaceHierarchy(t[0].id,t[0]["ds6w:label"],t[0]["ds6wg:revision"])}})});var t=widget.getValue(v.previousSpaceHierarchy);t&&(t=JSON.parse(t),e._loadSpaceHierarchy(t.id,t.label,t.revision))},b.prototype._loadSpaceHierarchy=function(e,t,i){var n=this;s.getSpaceHierarchy(e).then(function(o){o.length>1&&(n.dialog.elements.container.querySelector(".label-space-concept-root-name").textContent=t,widget.setValue(v.previousSpaceHierarchy,JSON.stringify({id:e,label:t,revision:i})),n._createDataGridView(t,i,o,n.logicalRef.options.assignedSpacesPID))})},b.prototype._createDataGridView=function(i,o,r,a){var s=this;s.treeDocument=new e({useAsyncPreExpand:!0}),s.treeDocument.prepareUpdate(),s.treeDocument.options.shouldBeSelected=function(e){return e.options.type===h.type_design_ref};var l=s.treeDocument.addChild(new t({label:i,isSpaceRoot:!0,icons:[{iconPath:c.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_SppSpaceConceptRoot.png",iconSize:{height:"16px",width:"16px"}}],grid:{revision:o}}));r.forEach(function(e){s._parseSpaceNode(l,e)}),a&&l.getAllDescendants().forEach(function(e){for(var t=0;t<a.length;t++)a[t].obj===e.options.physicalid&&e.select()}),s.treeDocument.getXSO().onPostAdd(s._activateOkButton.bind(s)),s.treeDocument.getXSO().onPostRemove(s._activateOkButton.bind(s)),s.treeDocument.setFilterModel({label:{filterId:"stringRegexp"},revision:{filterId:"stringRegexp"}}),s.treeDocument.pushUpdate(),s.treeDocument.expandAll();var d=new n({identifier:"SystemArchitectureRelease_SpaceAssignment",height:"inherit",treeDocument:s.treeDocument,selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{text:c.getNlsBasicAttributesBO("ds6w:label"),dataIndex:"tree",alwaysVisibleFlag:!0,pinned:"left"},{text:c.getNlsBasicAttributesBO("ds6wg:revision"),dataIndex:"revision"},{text:c.getNlsBasicAttributesBO("ds6w:description"),dataIndex:"description"},{text:c.getNlsBasicAttributesBO("ds6wg:PLMReference.V_isLastVersion"),dataIndex:"isLastVersion",typeRepresentation:"boolean",width:95,visibleFlag:!1},{text:c.getNlsBasicAttributesBO("ds6w:modified"),dataIndex:"modificationDate",visibleFlag:!1},{text:c.getNlsBasicAttributesBO("ds6w:created"),dataIndex:"creationDate",visibleFlag:!1},{text:c.getNlsBasicAttributesBO("ds6w:status"),dataIndex:"maturity",visibleFlag:!1},{text:c.getNlsBasicAttributesBO("ds6w:responsible"),dataIndex:"owner",visibleFlag:!1},{text:c.getNlsBasicAttributesBO("ds6w:reserved"),dataIndex:"isReserved",typeRepresentation:"boolean",width:95,visibleFlag:!1},{text:c.getNlsBasicAttributesBO("ds6w:type"),dataIndex:"type",visibleFlag:!1}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},sortModel:[{dataIndex:"tree",sort:"asc"}]}),u=s.dialog.elements._contentDiv.querySelector(".dgv-container");u.innerHTML="",u.appendChild(d.getContent())},b.prototype._parseSpaceNode=function(e,i){var n=this;if(void 0===i.icons){var o=e.addChild(new t({physicalid:i.physicalid,label:i.title,type:i.type,grid:{description:i.description,isLastVersion:"TRUE"===i.isLastRevision,maturity:f.MAPPING_MATURITY[i.maturityState],type:i.nlsType,owner:i.ownerFullName,isReserved:"TRUE"===i.reservation,revision:i.revision}}));o.options.icons=[{iconSize:{height:"16px",width:"16px"}}],o.options.type===h.type_space_concept_node?o.options.icons[0].iconPath=c.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_SppSpaceConceptNode.png":o.options.type===h.type_design_ref&&(o.options.icons[0].iconPath=c.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_3DPart.png"),o.options.grid.creationDate=d.formatDate(i.creationDate),o.options.grid.modificationDate=d.formatDate(i.modificationDate),i.children&&i.children.forEach(function(e){n._parseSpaceNode(o,e)})}},b.prototype._activateOkButton=function(){this.dialog.buttons.Ok.disabled=!1},b}),define("DS/CATFLCockpitWidget/utils/checkArchitectureNumberUnicity.util",["UWA/Core","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/xhr.util","DS/TreeModel/BaseFilter","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r){"use strict";return{updateEffectivityCompiledFormForNodes:function(e){var t=[],n={};return e&&e.forEach(function(e,i){e.options.instance&&e.options.instance.physicalid&&(t.push(e.options.instance.physicalid),n[e.options.instance.physicalid]=e)}),t.length>0?i.fetch(t,["ro.plminstance.v_effectivitycompiledform"]).then(function(e){if(e)for(var t=0;t<e.length;t++){var i=n[e[t].resourceid.value];i.options.instance.effectivitycompiledform=void 0,e[t]["ro.plminstance.v_effectivitycompiledform"]&&void 0!==e[t]["ro.plminstance.v_effectivitycompiledform"]&&(i.options.instance.effectivitycompiledform=e[t]["ro.plminstance.v_effectivitycompiledform"].value)}}):Promise.resolve()},updateDisplayedEffectivityForNodes:function(e){var i={};return t.getEffectivityInfo(e).then(function(e){for(var t in e){var n=e[t];if(n.content){if(i[t]={},n.content.Evolution){var o=n.content.Evolution.Current;i[t].evolution=o?o.replace(/(\r\n|\n|\r)/gm," "):""}if(n.content.Variant){var r=n.content.Variant;i[t].variant=r?r.replace(/(\r\n|\n|\r)/gm," "):""}}}return i})},getInstancesWithDuplicatedAN:function(e){var t=e||[];return(t=t.filter(function(e){return e.options.grid.architectureNumber})).length<1?null:(t=t.reduce(function(e,t){return e[[t.options.grid.architectureNumber]]=(e[t.options.grid.architectureNumber]||[]).concat(t),e},{}),t=Object.values(t).filter(function(e){return e.length>=2}),t=[].concat.apply([],t))},checkANOnEvolution:function(e,i,o){var r=this,a=[],s=[];return i.forEach(function(e,i){s.push(t.createVolatileFilter({modelID:o.physicalid,modelName:o.name,modelVerName:e.name,modelVerRev:e.revision}))}),n.makeMultipleServiceCalls(s,!0).then(function(n){return n.forEach(function(e,t){a.push({FilterCompiledForm:e.filterBinaryForExpand,mv:i[t]})}),t.allFilterValidation(e,a,!0).then(function(e){return r.calculIntersection(e)})})},checkANOnVariant:function(e,i){var n=this,o=[];return i.forEach(function(e,t){e.productConfiguration.attributes.FilterCompiledForm&&o.push({FilterCompiledForm:e.productConfiguration.attributes.FilterCompiledForm,mv:e.modelversion,pc:e.productConfiguration})}),o.length>0?t.allFilterValidation(e,o,!0).then(function(e){return n.calculIntersection(e)}):Promise.reject(new Error("all_PC_empty"))},calculIntersection:function(e){var t={};return e&&e.length>0&&e.forEach(function(e,i){var n=e.instances.reduce(function(e,t){return e[[t.nodeInstance.options.grid.architectureNumber]]=(e[t.nodeInstance.options.grid.architectureNumber]||[]).concat(t),e},{});for(var o in n){var r=n[o].reduce(function(e,t){return e[[t.filterValidationStatus]]=(e[t.filterValidationStatus]||[]).concat(t),e},{});t[o]||(t[o]={}),r.valid&&r.valid.length>0&&r.valid.forEach(function(i,n){t[o][i.nodeInstance.options.instance.physicalid]||(t[o][i.nodeInstance.options.instance.physicalid]={nodeInstance:i.nodeInstance,intersectionEffectivity:[]}),r.valid.length>=2&&t[o][i.nodeInstance.options.instance.physicalid].intersectionEffectivity.push({modelversion:e.modelversion,productConfiguration:e.productConfiguration})}),r.invalid&&r.invalid.length>0&&r.invalid.forEach(function(e,i){t[o][e.nodeInstance.options.instance.physicalid]||(t[o][e.nodeInstance.options.instance.physicalid]={nodeInstance:e.nodeInstance,intersectionEffectivity:[]})})}}),t},createFilterForArraysValues:function(){return o.inherit({publishedProperties:{},isDataFiltered:function(e){var t=e.getAttributeValue(this.propertyId);return!t||!!(t&&this.filterModel&&this.filterModel.selectedValues)&&!this.filterModel.selectedValues.every(e=>t.includes(e))},isEmpty:function(){return!this.filterModel||void 0===this.filterModel.selectedValues}})},registerFilterForArraysValues:function(e){var t=e.getFilterManager(),i=this.createFilterForArraysValues();t.registerFilter("stringArray",i)}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.columns",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/services/predicate.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/Utilities/StringUtils","DS/Utilities/Utils","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d){"use strict";var u=e.getFullConfig(),p=u.identifiers,g=u.localStorageKeys;return{getDataGridViewColumns:async function(e){this.contentView=e;var t=e.invalidateLayout.bind(e),i=this.getBaseColumns(t);return this.addAdditionalColumns(i,t),await this.addUserAdditionalColumns(i,t),i},getBaseColumns:function(t){var i=new Intl.Collator,n=[{value:!0,icon:{iconName:"check",fontIconFamily:1,className:"sax-is-last-version-true"}},{value:!1,icon:{iconName:"close",fontIconFamily:1,className:"sax-is-last-version-false"}}];return[{text:e.getNlsBasicAttributesBO("ds6w:label"),dataIndex:"tree",editableFlag:!0,sortableFlag:!0,alwaysVisibleFlag:!0,pinned:"left",width:300,setCellValue:this._defaultSetCellValue.bind(this,t,"title"),getCellEditableState:this._defaultGetCellEditableState,compareFunction:function(e,t,n,o){var r=n.options.type,a=o.options.type;return"attachedDocumentsCategory"===r?-1:"attachedDocumentsCategory"===a?1:"specificationDocumentsCategory"===r?-1:"specificationDocumentsCategory"===a?1:"proposedSolutionCategory"===r?-1:"proposedSolutionCategory"===a?1:"implementLinksCategory"===r?-1:"implementLinksCategory"===a?1:s.compareLocal(e,t,{intlCollator:i})}},{text:d.action_cue_status,dataIndex:"cue",alignment:"center",typeRepresentation:"icon",sortableFlag:!0,compareFunction:function(e,t){return e===t?0:"group"===e?-1:"group"===t?1:"alert"===e?-1:"alert"===t?1:"status-ko"===e?-1:"status-ko"===t?1:"attention"===e?-1:"attention"===t?1:"info"===e?-1:"info"===t?1:"status-ok"===e?-1:"status-ok"===t?1:void 0},groupableFlag:!1},{text:e.getNlsBasicAttributesBO("ds6wg:revision"),dataIndex:"revision",getCellTypeRepresentation:this._getCellTypeResentation.bind(null,"revision"),hyperlinkTarget:"_self",getCellValue:this._defaultGetCellValueForClickableColumn.bind(this,"revision"),getCellGroupingKey:this._getCellGroupingKey.bind(this,"revision")},{text:e.getNlsBasicAttributesBO("ds6wg:PLMReference.V_isLastVersion"),dataIndex:"isLastVersion",typeRepresentation:"customBoolean",width:95,getCellSemantics:function(){return{possibleValues:n}},getCellGroupingKey:this._getCellGroupingKey.bind(this,"isLastVersion")},{text:e.getNlsBasicAttributesBO("ds6w:label"),icon:{iconName:"object-instance"},dataIndex:"instanceName",editableFlag:!0,setCellValue:this._defaultSetCellValue.bind(this,t,"instanceName"),getCellEditableState:this._defaultGetCellEditableState,getCellGroupingKey:this._getCellGroupingKey.bind(this,"instanceName")},{text:e.getNlsBasicAttributesBO("ds6w:status"),dataIndex:"maturity",getCellTypeRepresentation:this._getCellTypeResentation.bind(null,"maturity"),hyperlinkTarget:"_self",getCellValue:this._defaultGetCellValueForClickableColumn.bind(this,"maturity"),getCellGroupingKey:this._getCellGroupingKey.bind(this,"maturity")},{text:e.getNlsBasicAttributesBO("ds6w:responsible"),dataIndex:"owner",typeRepresentation:"url",getCellTypeRepresentation:this._getCellTypeResentation.bind(null,"owner"),hyperlinkTarget:"_self",getCellValue:this._defaultGetCellValueForClickableColumn.bind(this,"owner"),getCellGroupingKey:this._getCellGroupingKey.bind(this,"owner")},{text:e.getNlsBasicAttributesBO("ds6w:reserved"),dataIndex:"isReserved",alignment:"center",typeRepresentation:"image",width:95,getCellGroupingKey:this._getCellGroupingKey.bind(this,"isReserved")},{text:e.getNlsBasicAttributesBO("ds6w:modified"),dataIndex:"modificationDate",getCellValue:this._defaultGetCellValueForDate.bind(this,"modificationDate")},{text:e.getNlsBasicAttributesBO("ds6w:description"),dataIndex:"description",editableFlag:!0,setCellValue:this._defaultSetCellValue.bind(this,t,"description"),getCellEditableState:this._defaultGetCellEditableState,typeRepresentation:"multilineString",editionPolicy:"EditionOnClick"},{text:e.getNlsBasicAttributesBO("ds6w:description"),icon:{iconName:"object-instance"},dataIndex:"instance_description",setCellValue:this._defaultSetCellValue.bind(this,t,"instance_description"),visibleFlag:!1,editableFlag:!0,typeRepresentation:"multilineString",editionPolicy:"EditionOnClick"},{text:e.getNlsBasicAttributesBO("ds6w:type"),dataIndex:"type"},{text:e.getNlsBasicAttributesBO("ds6w:identifier"),dataIndex:"name"},{text:e.getNlsBasicAttributesBO("ds6w:created"),dataIndex:"creationDate",getCellValue:this._defaultGetCellValueForDate.bind(this,"creationDate")},{text:d.label_arch_no,dataIndex:"architectureNumber",getCellTypeRepresentation:this._getCellTypeResentation.bind(null,"architectureNumber"),hyperlinkTarget:"_self",getCellValue:this._defaultGetCellValueForClickableColumn.bind(this,"architectureNumber"),getCellGroupingKey:this._getCellGroupingKey.bind(this,"architectureNumber")},{text:d.label_assigned_spaces,dataIndex:"assignedSpaces",typeRepresentation:"url",hyperlinkTarget:"_self",sortableFlag:!1,groupableFlag:!1,getCellValue:this._defaultGetCellValueForClickableColumn.bind(this,"assignedSpaces"),getCellGroupingKey:this._getCellGroupingKey.bind(this,"assignedSpaces")}]},addAdditionalColumns:function(e){if(u.gridview&&u.gridview._additionalColumns){let t=u.gridview._additionalColumns;t.forEach(function(e){let t={groupableFlag:!1};"ConfigurationRevision"===e.dataIndex&&(t.getCellValue=function(e){return e.nodeModel.options.grid.ConfigurationRevision||""===e.nodeModel.options.grid.ConfigurationRevision||(e.nodeModel.options.grid.ConfigurationRevision=""),e.nodeModel.options.grid.ConfigurationRevision}),UWA.extend(e,t)}),e.push(...t)}},addUserAdditionalColumns:async function(e,i){var n=this,o=t.getUserCustomAttributes()||[],a=t.getUserCustomAttributes(!0)||[],s=o.concat(a),c=await r.getNLSPredicates(s);s.forEach(function(t){var o={text:c[t.curi]||t.curi,typeRepresentation:t.type,isCustomAttribute:!0};if(t.multiLine&&(o.typeRepresentation="multilineString",o.editionPolicy="EditionOnClick"),t.dimension){var r=u.dimensions[t.dimension];t.manipulationUnit?(o.text=o.text+" ("+r.Units[t.manipulationUnit].NLSName+")",o.groupableFlag=!1):o.text=o.text+" ("+r.Units[r.MKSUnit].NLSName+")"}t.readOnly?o.editableFlag=!1:(o.getCellEditableState=n._additionalAttributeGetCellEditableState.bind(n,t),"boolean"===t.type?o.setCellValue=l.debounce(n._additionalAttributeSetCellValue.bind(n,i,t),500):o.setCellValue=n._additionalAttributeSetCellValue.bind(n,i,t)),t.bo?t.isOnPhysicalProduct?(o.dataIndex="physical_"+t.curi,o.icon={iconName:"3dproduct"}):o.dataIndex=t.curi:(o.dataIndex="instance_"+t.curi,o.icon={iconName:"object-instance"});var a=t.isSharedPredicateOnSameType||t.isSharedPredicate&&(t.isClassification||t.isOnExtension);if((t.multiValuated||a)&&(o.editionPolicy="EditionOnClick",o.getCellSemantics=function(){return{allowMultipleValuesFlag:!0}},t.multiLine&&(o.editableFlag=!1,o.getCellEditableState=void 0,o.getCellValue=function(e){var t=e.nodeModel.options.grid[o.dataIndex];return t&&Array.isArray(t)?t.join(" , "):t})),"date"===t.type&&void 0===t.rangeValues&&(o.getCellValue=n._additionalAttributeGetCellValueDate.bind(n,o.dataIndex,t.multiValuated||a)),"boolean"===t.type)t.multiValuated||a||(o.getCellValue=function(e){var t=e.nodeModel.options.grid[o.dataIndex];if(t){if("TRUE"===t.toUpperCase())return!0;if("FALSE"===t.toUpperCase())return!1}});else if(void 0!==t.rangeValues&&t.rangeValues.length>0){o.typeRepresentation="string",o.editionPolicy="EditionOnClick";for(var s=[],d=0;d<t.rangeValues.length;d++)t.rangeValues[d].formatDateValue?s.push(t.rangeValues[d].formatDateValue):s.push(t.rangeValues[d].nlsValue);var p=!1;t.readOnly&&(p=!0),o.getCellSemantics=function(){return{possibleValues:p?null:s,allowMultipleValuesFlag:t.multiValuated||a}}}e.push(o)})},_getCellTypeResentation:function(e,t){return t.nodeModel?(t.nodeModel.options.type!==p.type_act_logref||t.nodeModel.options.virtual)&&("maturity"!==e&&"owner"!==e||t.nodeModel.options.type!==p.type_act_logref||!t.nodeModel.options.linkInfo||"implementing"!==t.nodeModel.options.linkInfo.linkType||"ref"!==t.nodeModel.options.linkInfo.objType)&&("maturity"!==e&&"owner"!==e||!(t.nodeModel.getParent()&&t.nodeModel.getParent().options.type===p.type_spec_document||"DIF"===t.nodeModel.options.grid.kindOfRFLP))?"string":"url":"string"},_defaultGetCellEditableState:function(e){return!(!e.nodeModel||e.nodeModel.options.type!==p.type_act_logref||e.nodeModel.options.virtual)&&!(t.checkIfMaturityIsReleasedOrObsolete(e.nodeModel.options.maturity)||e.nodeModel.options.grid&&e.nodeModel.options.grid.isReservedByOther)},_additionalAttributeGetCellEditableState:function(e,t){var i=!1;return!e.isOnExtension&&!e.isClassification&&e.declaredInArray&&t&&t.nodeModel&&(e.bo&&!e.declaredInArray.includes(t.nodeModel.options.grid.actualType)||!e.bo&&!e.declaredInArray.includes(t.nodeModel.options.grid.instance_actualType))&&(i=!0),!i&&this._defaultGetCellEditableState(t)},_defaultGetCellValueForClickableColumn:function(e,t){var i=t.nodeModel.options.physicalid,n=d.label_none;("architectureNumber"===e&&(t.nodeModel.getParent()&&t.nodeModel.getParent().options.type===p.type_spec_document||"F"===t.nodeModel.options.grid.kindOfRFLP||"R"===t.nodeModel.options.grid.kindOfRFLP||"DIF"===t.nodeModel.options.grid.kindOfRFLP)||!i||i.length<=0)&&(n="");var o=t.nodeModel.options.grid[e]||n;return"url"===this._getCellTypeResentation(e,t)?{label:o}:o},_defaultSetCellValue:function(o,r,s,l){var p=this,m="instanceName"===r||"instance_description"===r;let f=u.adminStatus.ReferenceTitleMaxLength||100;if("title"===r&&(0===l.length||l.length>f)){if(0===l.length)t.alertMessage("error",null,d.msg_mandatory_field_title);else if(l.length>f){let e=d.replace(d.msg_too_long_field_title,{fieldName:d.label_title,maxLength:f});t.alertMessage("error",null,e)}o({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}else{var h;if("instanceName"===r){let e=u.adminStatus.InstanceNameMaxLength||100;if(l.length>e){let i=d.replace(d.msg_too_long_field_title,{fieldName:d.label_instance_title,maxLength:e});return t.alertMessage("error",null,i),void o({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1})}h=n.updateAttribute([{refID:s.nodeModel.options.physicalid,instID:s.nodeModel.options.instance.physicalid,attributes:{"PLMInstance.PLM_ExternalID":l}}])}else if("instance_description"===r)h=n.updateAttribute([{refID:s.nodeModel.options.physicalid,instID:s.nodeModel.options.instance.physicalid,attributes:{"PLMInstance.V_description":l}}]);else{var v={};"title"===r?v["PLMEntity.V_Name"]=l:"description"===r?v["PLMEntity.V_description"]=l:v[r]=l,h=n.updateAttribute([{refID:s.nodeModel.options.physicalid,attributes:v}])}p.contentView.displayModalLoader(d.msg_processing),h.then(function(n){let d=n&&n[0]&&n[0].body,u=[],f=[];if("title"===r||"description"===r){var h=widget.getValue("currentOpenedItem");h&&h===s.nodeModel.options.physicalid&&a.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"})}var v=n[0].body.modified?t.formatDate(d.modified.value[0]):null;if((p.contentView.treeDocument.getMappedNodesFromId(s.nodeModel.options.physicalid)||[s.nodeModel]).forEach(function(e){if("title"===r)e.options.label=l,e.options.grid.modificationDate=v;else if(m)if(d.oldInstancePhysicalid){let t=e.getParent(),i=new c({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,physicalid:e.options.physicalid,instance:{physicalid:d.physicalid},grid:{physicalid:e.options.physicalid},actualParent:e.options.actualParent,children:[]});i.setRelationID(d.physicalid),t.addChild(i,e._rowID),u.push(i),f.push(e)}else e.options.instance&&e.options.instance.physicalid===s.nodeModel.options.instance.physicalid&&(e.options.grid[r]=l,e.options.instance.modificationDate=v);else e.options.grid[r]=l,e.options.grid.modificationDate=v}),m){if(u.length>0&&f.length>0){s.nodeModel.unselect(),s.nodeModel.getNextNode().select();let e={};e[d.oldInstancePhysicalid]=f,e[d.physicalid]=u;let t=a.getFLWebModelEventsObj("flcockpit-content-list-view");t.publish({event:"refresh-nodes-by-id",data:{arrayOfPID:[f[0].options.physicalid],tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!0}}),t.publish({event:"refresh-inst-by-id",data:{instIdMap:e,bInstance:!0,bEffectivity:!0}})}let t=widget.getValue("groupingEnabled"),n=s.nodeModel.getParent();t&&!n.getID&&(n=i.getGroupNodeParent(n)),e.SAXStorage().setItem(g.recentlyAuthoredStructure+n.getID(),Date.now())}else e.SAXStorage().setItem(g.recentlyAuthored+s.nodeModel.getID(),Date.now());o({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0});let C=p.contentView.getGroupingOptions();C&&p.contentView.groupRows(C)}).catch(function(){o({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),t.displayError({},d.msg_error_no_modification_possible,null,d.msg_error_modification_not_allowed)}).finally(function(){p.contentView.removeModalLoader(d.msg_processing)})}},_additionalAttributeSetCellValue:function(e,i,r,a){let s,l,c=this,p=!1;c.contentView.displayModalLoader(d.msg_processing);var g=Array.isArray(a),m=null;if(void 0!==i.rangeValues){if(g){var f=[];if("string"===i.type||"date"===i.type){m=a.slice();for(var h=0;h<a.length;h++){let e=i.rangeValues.find(function(e){return e.formatDateValue?new Date(e.formatDateValue).getTime()===new Date(a[h]).getTime():e.nlsValue===a[h]});void 0!==e?f.push(e.value):f.push(a[h])}a=f}}else if("string"===i.type||"date"===i.type){m=a;let e=i.rangeValues.find(function(e){return e.formatDateValue?new Date(e.formatDateValue).getTime()===new Date(a).getTime():e.nlsValue===a});void 0!==e&&(a=e.value)}}else i.manipulationUnit&&i.manipulationUnit!==u.dimensions[i.dimension].MKSUnit?(p=!0,g&&a.length<=0&&(p=!1)):"boolean"!==i.type||g?"integer"!==i.type&&"number"!==i.type||g?"date"===i.type&&(a=g?a.map(function(e){return e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+"@12:00:00:GMT"}):a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate()+"@12:00:00:GMT"):a=a.toString():a=a.toString().toUpperCase();var v=!1;if(r.cellModel&&(g&&a.length===r.cellModel.length?"date"===i.type&&a.every((e,t)=>new Date(e).getTime()===new Date(r.cellModel[t]).getTime())?v=!0:a.every((e,t)=>e===r.cellModel[t])&&(v=!0):"date"===i.type&&new Date(a).getTime()===new Date(r.cellModel).getTime()?v=!0:a===r.cellModel&&(v=!0)),v)return void c.contentView.removeModalLoader(d.msg_processing);let C={refID:r.nodeModel.options.physicalid,attributes:{}},b=function(i,n){if(e({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),i&&i.error&&i.error.errorList&&i.error.errorList[0]&&i.error.errorList[0].errors){var o=i.error.errorList[0].errors.map(e=>e.message).join(". ");t.displayError({},d.msg_error_no_modification_possible,null,o)}else n.isOnExtension?t.displayError({},d.msg_error_no_modification_possible,null,d.msg_error_edit_attributes_on_extensions_failed):t.displayError({},d.msg_error_no_modification_possible,null,d.msg_error_modification_not_allowed)};var y=i.selectable;if(void 0===y.length){var _=null;(_=!i.bo&&r.nodeModel.options.instance?r.nodeModel.options.grid.instance_actualType:r.nodeModel.options.grid.actualType)&&(y=i.selectable[_])}if(i.manipulationUnit?(a=g?a.map(e=>e.toString()):a.toString(),C.attributes[y]={unitName:i.manipulationUnit,dimensionType:i.dimension,value:a}):C.attributes[y]=a,!i.bo&&r.nodeModel.options.instance&&(C.instID=r.nodeModel.options.instance.physicalid),p){let t=[{UnitFrom:i.manipulationUnit,UnitTo:u.dimensions[i.dimension].MKSUnit,Dimension:i.dimension,Values:g?a:[a]}];l=o.convertValues(t).then(function(t){t.Response&&(s=UWA.is(t.Response[0].ConvertedValues,"string")?t.Response[0].ConvertedValues.split(";")[0]:t.Response[0].ConvertedValues[0],n.updateAttribute([C]).then(function(t){c._checkUpdateAttributeResults(e,t,r,i,y,a,m,s)}).catch(function(e){b(e,i)}))})}else l=i.manipulationUnit?n.updateAttribute([C]).then(function(t){c._checkUpdateAttributeResults(e,t,r,i,y,a,m,a)}).catch(function(e){b(e,i)}):n.updateAttribute([C]).then(function(t){c._checkUpdateAttributeResults(e,t,r,i,y,a,m)}).catch(function(e){b(e,i)});l.finally(function(){c.contentView.removeModalLoader(d.msg_processing);let e=c.contentView.getGroupingOptions();e&&c.contentView.groupRows(e)})},_defaultGetCellValueForDate:function(e,i){if(i&&i.nodeModel&&i.nodeModel.options.grid[e])return t.displayDate(i.nodeModel.options.grid[e])},_additionalAttributeGetCellValueDate:function(e,i,n){if(n&&n.nodeModel){var o=n.nodeModel.getAttributeValue(e);return o?i?(Array.isArray(o)?o:o.split(",")).map(function(e){return t.formatDate(e)}):t.formatDate(o):o}},_checkUpdateAttributeResults:function(i,n,o,r,s,l,u,p){var m=n[0].body.modified?t.formatDate(n[0].body.modified.value[0]).getTime():null,f=new Date(o.nodeModel.options.grid.modificationDate).getTime(),h=m!==(o.nodeModel.options.instance?new Date(o.nodeModel.options.instance.modificationDate).getTime():null);if(m!==f&&r.bo||h&&!r.bo){let i={grid:{}},s=!1;r.bo?(u?(i[r.curi]=l,i.grid[r.curi]=u):(i.grid[r.curi]=l,p&&(i.grid[r.curi+"_actual"]=p)),i.grid.modificationDate=t.formatDate(n[0].body.modified.value[0]),e.SAXStorage().setItem(g.recentlyAuthored+o.nodeModel.getID(),Date.now())):(s=!0,u?(i["instance_"+r.curi]=l,i.grid["instance_"+r.curi]=u):(i.grid["instance_"+r.curi]=l,p&&(i.grid["instance_"+r.curi+"_actual"]=p)),i.instance={modificationDate:t.formatDate(n[0].body.modified.value[0])},e.SAXStorage().setItem(g.recentlyAuthoredStructure+o.nodeModel.getParent().getID(),Date.now()));let d=[],m=[];(this.contentView.treeDocument.getMappedNodesFromId(o.nodeModel.options.physicalid)||[o.nodeModel]).forEach(function(e){if(s)if(n[0].body.oldInstancePhysicalid){let t=e.getParent(),i=new c({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,physicalid:e.options.physicalid,instance:{physicalid:n[0].body.physicalid},grid:{physicalid:e.options.physicalid},actualParent:e.options.actualParent,children:[]});i.setRelationID(n[0].body.physicalid),t.addChild(i,e._rowID),m.push(i),d.push(e)}else e.options.instance&&e.options.instance.physicalid===o.nodeModel.options.instance.physicalid&&e.updateOptions(i);else e.updateOptions(i)});var v=widget.getValue("currentOpenedItem");if(v&&v===o.nodeModel.options.physicalid&&a.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"}),m.length>0&&d.length>0){o.nodeModel.unselect(),o.nodeModel.getNextNode().select();let e={};e[n[0].body.oldInstancePhysicalid]=d,e[n[0].body.physicalid]=m;let t=a.getFLWebModelEventsObj("flcockpit-content-list-view");t.publish({event:"refresh-nodes-by-id",data:{arrayOfPID:[d[0].options.physicalid],tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!0}}),t.publish({event:"refresh-inst-by-id",data:{instIdMap:e,bInstance:!0,bEffectivity:!0}})}}else i({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),r.isOnExtension?t.displayError({},d.msg_error_no_modification_possible,null,d.msg_error_edit_attributes_on_extensions_failed):t.displayError({},d.msg_error_no_modification_possible,null,d.msg_error_edit_attributes_not_on_extensions_failed)},_getCellGroupingKey:function(e,t){let i=this;if(t.nodeModel&&t.columnID){let n=i.contentView.getColumnOrGroup(t.columnID).typeRepresentation,o=t.nodeModel.options.grid[e];if("icon"===n){if("cue"===e){let e;switch(o){case"group":e="cue_combined";break;case"alert":e="cue_critical";break;case"status-ko":e="cue_error";break;case"attention":e="cue_warning";break;case"info":e="cue_info"}return d[e]}}else{if("customBoolean"===n)return o?d.label_true:d.label_false;if("image"===n&&"isReserved"===e){return"TRUE"===t.nodeModel.options[e]?d.label_true:d.label_false}}return t.nodeModel.options.grid[e]}}}}),define("DS/CATFLCockpitWidget/components/AttributesManagement/AttributesManagement",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/UIKIT/Mask","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/ClassificationUtil/ClassificationUtil","DS/CATFLCockpitWidget/services/predicate.service","DS/Windows/Dialog","DS/Controls/Button","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/preferences.util","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m){"use strict";var f=d.getFullConfig(),h=d.getFullConfig().identifiers,v={"http://www.w3.org/2001/XMLSchema#boolean":"boolean","http://www.w3.org/2001/XMLSchema#integer":"integer","http://www.w3.org/2001/XMLSchema#real":"number","http://www.w3.org/2001/XMLSchema#timestamp":"date"},C=function(e,t,i){var n=this;this.isForPhysicalProduct=e||!1,this.dialogTitle=e?m.attributes_browser_for_physical_product:m.attributes_browser,this.isForPhysicalProduct?(this.types=t||[],this.typesInstance=i||[],this.render()):a.getLtypes().then(function(e){n.types=e[h.type_act_logref],n.typesInstance=e[h.type_act_loginstance],n.render()})};return C.prototype.render=function(){var t=this;t.dialog=new s({title:t.dialogTitle+" - "+m.label_select_extensions,height:500,width:700,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new l({label:m.label_next,emphasize:"primary"}),Cancel:new l({emphasize:"secondary"})}}),t.dialog.addEventListener("close",function(){t.dialog.destroy()}),t.dgv=new i({identifier:"SystemArchitectureRelease_AttributesManagement_DGV",height:"inherit",treeDocument:new e({useAsyncPreExpand:!0}),selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{typeRepresentation:"icon",dataIndex:"iconType",width:40},{text:m.label_name,dataIndex:"name"},{text:m.label_declared_in,dataIndex:"declaredIn"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!0,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID?{shortHelp:t.isForPhysicalProduct?m.label_declared_in_physical_product:e.nodeModel.options.isOnInstance?m.label_declared_in_instance:m.label_declared_in_reference,updateModel:!1}:t.dgv.getCellDefaultTooltip(e)}}),t.dialog.elements._contentDiv.appendChild(t.dgv.getContent()),t.dgv.treeDocument.setFilterModel({name:{filterId:"stringRegexp"}}),t.dgv.sortModel=[{dataIndex:"iconType",sort:"desc"},{dataIndex:"name",sort:"asc"}],t.renderListOfExtensions()},C.prototype.renderListOfExtensions=function(){var e=this;n.mask(e.dialog.elements._contentDiv,m.msg_loading);var i=[];e.types&&e.types.length>0&&i.push(c.getExtensionsForClass(e.types)),e.typesInstance&&e.typesInstance.length>0&&i.push(c.getExtensionsForClass(e.typesInstance,!0)),Promise.all(i).then(function(i){e.dgv.treeDocument.empty();for(var o=[{},{}],r=0;r<i.length;r++)for(var a=1===r,s=0;s<i[r].length;s++)for(var c=i[r][s].interfaces,d=0;d<c.length;d++)if("Yes"!==c[d].automatic){var u=c[d].name;void 0===o[r][u]?o[r][u]={uri:c[d].name,isOnInstance:a,grid:{iconType:a?"object-instance":"object-reference",name:c[d].nlsName,declaredIn:[i[r][s].name]}}:o[r][u].grid.declaredIn.push(i[r][s].name)}for(r=0;r<o.length;r++)for(var p in o[r])o[r].hasOwnProperty(p)&&(o[r][p].grid.declaredIn.length===i[r].length&&(o[r][p].grid.declaredIn=m.label_all_levels),e.dgv.treeDocument.addChild(new t(o[r][p])));var g=e.isForPhysicalProduct?f.localStorageKeys.userAdditionalAttributesForPhysicalProduct:f.localStorageKeys.userAdditionalAttributes,h=JSON.parse(localStorage.getItem(g)),v=h?h.extensions:null;null!==v&&e.dgv.treeDocument.getAllDescendants().forEach(function(e){-1!==v.indexOf(e.options.uri)&&e.select()}),e.dgv.treeDocument.getFilterManager().setPropertyFilterModel("declaredIn",{filterId:"set"}),e.dgv.reapplySortModel(),e.dialog.title=e.dialogTitle+" - "+m.label_select_extensions,e.dialog.buttons={Ok:new l({label:m.label_next,emphasize:"primary",onClick:function(){e.renderListOfAttributes()}}),Cancel:new l({emphasize:"secondary",onClick:function(){e.dialog.close()}})},n.unmask(e.dialog.elements._contentDiv)})},C.prototype.renderListOfAttributes=function(){var e=this;n.mask(e.dialog.elements._contentDiv,m.msg_loading);for(var i=e.dgv.treeDocument.getSelectedNodes(),o=[],s=[],c=[],d=0;d<i.length;d++)o.push(i[d].options.uri),i[d].options.isOnInstance?s.push(i[d].options.uri):c.push(i[d].options.uri);var C=[];if(this.isForPhysicalProduct){var b=e.types.concat(c),y=e.typesInstance.concat(s);C.push(a.getPredicates(b,y))}else C.push(a.getPredicatesForLtypes()),C.push(a.getPredicates(c,s));C.push(r.classificationAttributesPromise({apiVersion:"R2019x",lang:"fr"})),Promise.all(C).then(function(i){var r=[{},{},{}],s=[[],[],[]];e.isForPhysicalProduct?(s[0]=i[0][0],s[1]=i[0][1],s[2]=i[1]):(s[0]=i[0][0].concat(i[1][0]),s[1]=i[0][1].concat(i[1][1]),s[2]=i[2]),s.forEach(function(e,t){for(var i=0;i<e.length;i++)for(var n=e[i],a=0;a<n.properties.length;a++){var s=n.properties[a],l=n.classInfo.curi.replace("ds6w:","").replace("ds6wg:","");if(void 0===r[t][s.curi])s.declaredIn=[],r[t][s.curi]=s,-1!==o.indexOf(l)&&(s.isOnExtension=!0);else{var c=r[t][s.curi];if(c.selectable!==s.selectable)if(c.isSharedPredicate=!0,(c.dimension&&s.dimension&&c.dimension!==s.dimension||c.manipulationUnit&&s.manipulationUnit&&c.manipulationUnit!==s.manipulationUnit)&&(c.notConvertible=!0,c.manipulationUnit=null),-1!==o.indexOf(l)&&(c.isOnExtension=!0),2===t)Array.isArray(c.selectable)||(c.selectable=[c.selectable]),c.selectable.push(s.selectable);else if(c.selectable){if(void 0!==c.selectable.length){var d=c.selectable;c.selectable={},c.declaredIn.forEach(function(e){c.selectable[e]=d})}void 0===c.selectable[l]?c.selectable[l]=s.selectable:(Array.isArray(c.selectable[l])||c.selectable[l]===s.selectable||(c.selectable[l]=[c.selectable[l]]),c.selectable[l].includes(s.selectable)||(c.selectable[l].push(s.selectable),c.isSharedPredicateOnSameType=!0))}}2===t||r[t][s.curi].declaredIn.includes(l)||r[t][s.curi].declaredIn.push(l)}});var c=Object.values(r[2]).map(function(e){return{curi:e.curi,nls:e.label}}),d={};a.getNLSPredicates(c).then(function(e){d=e||{}}).finally(function(){e.dgv.treeDocument.empty();for(var i=0;i<r.length;i++)for(var c in r[i])if(r[i].hasOwnProperty(c)){var C=r[i][c];if(0===i&&-1===f.identifiers.index_services.select_bo.indexOf(C.curi.toLowerCase())||1===i&&-1===f.identifiers.index_services.select_rel.indexOf(C.curi.toLowerCase())||2===i){var b=new t({attribute:C,isOnInstance:1===i,isClassification:2===i,isOnExtension:C.isOnExtension,grid:{iconType:0===i||2===i?"object-reference":"object-instance",name:2===i&&d[C.curi]||C.label,declaredIn:C.declaredIn.length===s[i].length||2===i?m.label_all_levels:C.declaredIn.join()},declaredInArray:C.declaredIn});e.dgv.treeDocument.addChild(b)}}var y=e.isForPhysicalProduct?f.localStorageKeys.userAdditionalAttributesForPhysicalProduct:f.localStorageKeys.userAdditionalAttributes,_=JSON.parse(localStorage.getItem(y));if(_){var w={bo:[],rel:[]};_.userAdditionalAttributes&&_.userAdditionalAttributes.forEach(function(e){e.bo?w.bo.push(e.curi):w.rel.push(e.curi)}),(w.bo.length>0||w.rel.length>0)&&e.dgv.treeDocument.getAllDescendants().forEach(function(e){e.options.isOnInstance&&-1!==w.rel.indexOf(e.options.attribute.curi)?e.select():e.options.isOnInstance||-1===w.bo.indexOf(e.options.attribute.curi)||e.select()})}e.dgv.treeDocument.getFilterManager().setPropertyFilterModel("declaredIn",{filterId:"stringRegexp"}),e.dgv.reapplySortModel(),e.dialog.title=e.dialogTitle+" - "+m.label_select_attributes,e.dialog.buttons={Ok:new l({label:m.action_close,emphasize:"primary",onClick:function(){var t,i={},n={},r=e.dgv.treeDocument.getSelectedNodes();0!==r.length&&(t=[],r.forEach(function(o){var r=o.options.attribute.isSharedPredicateOnSameType||o.options.attribute.isSharedPredicate&&(o.options.isClassification||o.options.isOnExtension);r=o.options.attribute.notConvertible||r;var a=o.options.attribute.manipulationUnit&&o.options.attribute.manipulationUnit!==f.dimensions[o.options.attribute.dimension].MKSUnit&&void 0!==o.options.attribute.rangeValues&&o.options.attribute.rangeValues.length>0,s={year:"numeric",month:"short",day:"numeric"};"date"===v[o.options.attribute.dataType]&&void 0!==o.options.attribute.rangeValues&&o.options.attribute.rangeValues.length>0&&o.options.attribute.rangeValues.forEach((e,t)=>{e.formatDateValue=u.formatDate(e.value).toLocaleDateString(void 0,s)});var l={curi:o.options.attribute.curi,nls:o.options.attribute.label,type:v[o.options.attribute.dataType]||"string",isClassification:o.options.isClassification,bo:!o.options.isOnInstance,isOnExtension:o.options.isOnExtension,isOnPhysicalProduct:e.isForPhysicalProduct,rangeValues:o.options.attribute.rangeValues,selectable:o.options.attribute.selectable,dimension:o.options.attribute.dimension,manipulationUnit:o.options.attribute.manipulationUnit,declaredIn:o.options.grid.declaredIn,declaredInArray:o.options.declaredInArray,readOnly:r||a||"computed"===o.options.attribute.nature||"ReadOnly"===o.options.attribute.userAccess,isSharedPredicate:o.options.attribute.isSharedPredicate,isSharedPredicateOnSameType:o.options.attribute.isSharedPredicateOnSameType,notConvertible:o.options.attribute.notConvertible,multiValuated:o.options.isClassification&&o.options.attribute.valuetype&&"multival"===o.options.attribute.valuetype};if(t.push(l),!o.options.isClassification){var c;c=o.options.attribute.declaredIn.includes(h.type_act_logref)?h.type_act_logref:o.options.attribute.declaredIn[0],i[c]||(i[c]={},n[c]={});var d=o.options.attribute.originCuri.replace("ds6w:","").replace("ds6wg:","");i[c][d]?(i[c][d]=[i[c][d]],i[c][d].push(l)):(i[c][d]=l,n[c][d]=l)}})),a.getPropertiesPredicates(n).then(function(n){n&&(n=JSON.parse(n)).forEach(function(e,t){e.info.forEach(function(t,n){i[e.type][t.Name].length>0?i[e.type][t.Name].forEach((e,i)=>{e.multiLine="Yes"===t.MultiLine,e.multiValuated="Yes"===t.MultiValuated}):(i[e.type][t.Name].multiLine="Yes"===t.MultiLine,i[e.type][t.Name].multiValuated="Yes"===t.MultiValuated)})}),p.saveUserCustomAttributes({extensions:o,userAdditionalAttributes:t,isForPhysicalProduct:e.isForPhysicalProduct}),g.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-refresh-columns",data:{refreshView:!0}}),g.getFLWebModelEventsObj("flweb-model-events").publish({event:"save-user-custom-attributes"})}),e.dialog.close()}}),Cancel:new l({label:m.action_back,emphasize:"secondary",onClick:function(){e.renderListOfExtensions()}})},n.unmask(e.dialog.elements._contentDiv)})})},C}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.creation",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/document.service","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a){"use strict";var s=JSON.parse(r);return{createDocument:function(n,r){this.launchFileExplorer(n.options.physicalid,function(l){var c,d;r&&(c=s.rel_specification,d="specificationDocumentsCategory"),e.mask(widget.body,a.msg_creating),o.createDocument(n.options.physicalid,l,c).then(function(o){e.unmask(widget.body),t.alertMessage("success",null,a.msg_header_create_success,o.data[0].dataelements.title+a.msg_add_doc_success),i.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-documents-by-id",data:{nodes:[n],docType:d}})},function(i){e.unmask(widget.body),t.displayError(i,a.error_creation,null,a.replace(a.error_no_access,{errorOp:a.action_insert_new+" "+a.label_document}))})})},createNewItemReference:function(e,i,o){var r={items:[{attributes:{}}]};return""!==e.trim()&&(r.items[0].attributes.title=e),i&&(r.items[0].type=i),Object.keys(o).length>0&&(r.items[0].CustomFields=o),n.createLogItem(r).then(function(i){if(i)return t.alertMessage("success",null,a.msg_header_create_success,e+a.msg_create_success),i})},createNewItemInstance:function(e,i,o,r,s){var l=r;l||(l="dslog:LogItemPRIVATE");var c={instances:[{attributes:{},referencedItem:{type:l,attributes:{}}}]};return Object.keys(s).length>0&&(c.instances[0].referencedItem.CustomFields=JSON.parse(JSON.stringify(s))),""!==o.trim()&&(c.instances[0].referencedItem.attributes.title=o),n.createLogItemInstanceNew(c,e).then(function(e){return 0===o.length&&c.name&&c.name.length>0&&(o=c.name.slice(0,-2)),o.length>0?t.alertMessage("success",null,a.msg_header_create_success,o+a.msg_create_success):t.alertMessage("success",null,a.msg_header_create_success,a.create_log_ref_from_dialog_success),e},function(e){t.displayError(e,null,a.error_creation,a.msg_add_item_error)})},launchFileExplorer:function(e,i){var n=t.getFileInput();n.addEventListener("change",function(e){e.preventDefault(),e.stopImmediatePropagation();var t,o=[];t=null!==e.target.files&&e.target.files.length>0?e.target.files:e.dataTransfer.files;for(var r=0;r<t.length;r++)o.push(t[r]);i(o),n.destroy()}),n.click()}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.effectivity",["DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/parser/database.parser","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a){"use strict";var s=t.getFullConfig(),l={modifiedEditCfgCtx:function(t){let i=this.ctxItemPage?this.ctxItemPage:this,r=i.contentListView.contentView.getTreeDocument();if("cfgEditConfigurationContext"===t.commandName){let t,a=[],s=r.getSelectedNodes(),c=i.contentListView.contentView.layout.getColumnVisibleFlag("ConfigurationContext");s&&s.length>0?(t=s[0].options.physicalid===i.itemId||!1,s.forEach(function(e){a.push(e.options.physicalid)})):(t=!0,a.push(i.itemId));let d=!!c;t?n.getConfigContextInfo([i.itemId]).then(function(t){if(t){let n,s=o.parseItemToConfigCtx(t.contextInfo)[i.itemId];if(s&&s.contexts){n=[];for(let e in s.contexts)s.contexts.hasOwnProperty(e)&&n.push({name:s.contexts[e].backEndName,physicalid:e})}let c=e.getFLWebModelEventsObj("flweb-model-events"),u=widget.getValue("modelAttached"),p=widget.getValue("currentConfig"),g=function(){widget.setValue("modelAttached",n),widget.setValue("currentConfig",null),i._loadItemWithConfigCtx(n)};u?s?(widget.setValue("modelAttached",n),p&&Object.keys(s.contexts).indexOf(p.model.physicalid)<0?(d=!1,g()):d=!0):(d=!1,c.publish({event:"mod-selection-removed",data:{itemID:i.itemId}})):s?(d=!1,g()):d=!0,d&&l.updateCfgCtxColumn(a,r)}}):d&&l.updateCfgCtxColumn(a,r)}},updateCfgCtxColumn:function(e,t){var i=this,n={relids:[],pids:e},o=[],r=s.gridview.additionalColumnsModules.cfgContext;if(r){var a=new Promise(function(e){r.updateAttributes(n,function(t){var i=UWA.is(t,"string")?JSON.parse(t):t;e(i)},i)});o.push(a),o.length?Promise.all(o).then(function(i){let n=i&&i[0]?i[0].pids:{};t.withTransactionUpdate(function(){e.forEach(function(e){t.getMappedNodesFromId(e).forEach(function(t){let i={grid:n[e]};t.updateOptions(i)})})})}).catch(function(){console.log("An Error Occured")}):console.info("No cfg ctx to update")}},refreshEffectivityChanges:function(e){let t=this.ctxItemPage?this.ctxItemPage:this;e=JSON.parse(e);let i=t.contentListView.contentView.getTreeDocument(),n=e.commandName,o=e.response?e.response.results:null,r=[],a=[];switch(n){case"cfgExtendEvolutionEffectivity":case"cfgEditEvolution":case"cfgPasteEvolution":"cfgExtendEvolutionEffectivity"===n?(o=e.response.resources).forEach(function(e){"SUCCESS"===e.status&&e.identifier?a.push(e.identifier):"FAILED"===e.status&&r.push(e.errorDetails)}):o.forEach(function(e){e.existing&&"SUCCESS"===e.status?a.push(e.existing.pid):"FAILED"===e.status&&r.push(e.errorDetails)}),a.length&&l.refreshCfgValues({treeDocument:i,relids:a});break;case"cfgInlineVariant":case"cfgEditVariant":case"cfgPasteVariant":let u,p=[];o.forEach(function(e){"SUCCESS"===e.status?e.new?(u={oldId:e.existing.pid,newId:e.new.pid},p.push(u)):a.push(e.existing.pid):"FAILED"===e.status&&r.push(e.errorDetails)}),p.length&&l.splitInstance({treeDocument:i,couples:p}),a.length&&l.refreshCfgValues({treeDocument:i,relids:a});break;case"cfgRevManualComposition":let g=e.data.pids;var c={pids:g},d=s.gridview.additionalColumnsModules.ConfigurationRevision;d&&new Promise(function(e,i){d.updateAttributes(c,function(t){var n=UWA.is(t,"string")?JSON.parse(t):t;e(n),i("Error in CfgRev_updateAttributes")},t)}).then(function(e){let t=e?e.pids:{};Object.keys(t).length>0&&i.withTransactionUpdate(function(){g.forEach(function(e){var n=i.getMappedNodesFromId(e),o=t[e]?t[e].ConfigurationRevision:"";n.forEach(e=>{e.updateOptions({grid:{ConfigurationRevision:o}})})})})})}},refreshCfgValues:function(e){var i=this;if(e.relids&&e.relids){var n=e.pids||[],o=e.relMap||{};(n.length<=0||Object.keys(o).length<=0)&&e.relids.forEach(function(i){var r=e.treeDocument.getRoots()[0].getNodesByRelId(i);r&&r.length&&(r.forEach(e=>{t.SAXStorage().setItem(s.localStorageKeys.recentlyAuthoredStructure+e.getParent().options.physicalid,Date.now()),n.push(e.getID())}),o[i]?o[i].push(...r):o[i]=r)});var r={relids:e.relids,pids:n},l=[],c=s.gridview.additionalColumnsModules.cfgEffectivty;if(c){var d=new Promise(function(e){c.updateAttributes(r,function(t){var i=UWA.is(t,"string")?JSON.parse(t):t;e(i)},i)});l.push(d),l.length?Promise.all(l).then(function(t){let i={};t&&t.length&&t.forEach(e=>{e.relids&&(i=e.relids)}),e.treeDocument.withTransactionUpdate(function(){e.relids.forEach(function(e){var t=o[e];if(t&&t.length){var n=i[e];n.VariantEffectivity.trim()||(n.VariantEffectivity=a.label_none),n&&t.forEach(e=>{e.updateOptions({grid:n})})}})})}).catch(function(){console.log("An Error Occured")}):console.info("No cfg to update")}else console.info("No cfg Module")}else console.error("no relids to refresh")},splitInstance:function(e){let t,i,n,o,a,s,c,d={},u=[],p=[];e.treeDocument.withTransactionUpdate(function(){try{for(let l=0;l<e.couples.length;l++)if(t=e.couples[l].oldId,i=e.couples[l].newId,(n=e.treeDocument.getRoots()[0].getNodesByRelId(t))&&n.length>0){d[t]?d[t].push(...n):d[t]=n,d[i]||(d[i]=[]),u.indexOf(t)<0&&u.push(t),u.indexOf(i)<0&&u.push(i);for(let e=0;e<n.length;e++)(o=n[e])&&(p.push(o.getID()),(a=o.getParent())&&((c=UWA.clone(o.options,!1)).grid=UWA.clone(o.options.grid),c.instance=UWA.clone(o.options.instance),(s=new r(c)).setRelationID(i),s.options.instance.physicalid=i,s.options.hasBeenExpanded=!1,s.options.noIndexOrDBExpand=!1,s.collapse(),a.insertBefore(s,o),s.options.actualParent=a,d[i].push(s)))}}catch(e){console.error("error >>:",e)}finally{console.info("splitInstance done")}}),e.relids=u,e.pids=p,e.relMap=d,l.refreshCfgValues(e)}};return l}),define("DS/CATFLCockpitWidget/components/DisciplineIterations/lastOutfittedState.compare",["UWA/Core","DS/Windows/Dialog","DS/Controls/Button","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s){"use strict";var l=function(e){this.options=e};return l.prototype.render=function(){var e=this,a={instanceId:e.options.selectedNodes[0].options.instance.physicalid,occurrenceInfo:r.confAllImplPathsOnNodes(e.options.selectedNodes,!1,!1).payload};o.compareWithLastOutfitted(a).then(function(n){var o=e.getCompareOptionsContainer(n);e.dialog=new t({title:s.compareWithLastOutfitted,content:o,width:350,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Cancel:new i({emphasize:"secondary",onClick:function(){e.dialog.close()}})}}),e.dialog.addEventListener("close",function(){e.dialog.destroy()})}).catch(function(e){n.displayError(e,null,null,s.error_compare_last_outfitted)})},l.prototype.getCompareOptionsContainer=function(t){var i=e.createElement("div",{class:"compare-options-container"}),n=e.createElement("div",{class:"compare-options-subcontainer"}).inject(i);this._createItemCompareSection(t.compareLogicalItem).inject(n);var o=e.createElement("div",{class:"compare-options-subcontainer"}).inject(i);this._createPilotingDiscCompareSection(t.pilotingDisciplines).inject(o);var r=e.createElement("div",{class:"compare-options-subcontainer"}).inject(i);return this._createPropSolnCompareSection(t.proposedSolutions).inject(r),i},l.prototype._createItemCompareSection=function(t){var n=this,o=t.left,r=t.right,a=o.title+" "+o.revision,l=r.title+" "+r.revision,c=e.createElement("div",{class:"compare-item-container"});e.createElement("div",{class:"compare-options-subheader",html:s.label_log_ref}).inject(c);var d=e.createElement("div",{class:"compare-item-subcontainer"}).inject(c),u=e.createElement("div",{class:"compare-row-container"}).inject(d);e.createElement("div",{html:a+" with "+l}).inject(u);var p=[];return p.push({physicalid:o.physicalid,label:a},{physicalid:r.physicalid,label:l}),new i({label:s.compare,emphasize:"primary",onClick:function(){n.launchCompare(p)}}).inject(u),c},l.prototype._createPilotingDiscCompareSection=function(t){var n=this,o=e.createElement("div",{class:"compare-item-container"});e.createElement("div",{class:"compare-options-subheader",html:s.header_subtitle_piloting_disc}).inject(o);var r=e.createElement("div",{class:"compare-item-subcontainer"}).inject(o);if(t)return t&&t.compare&&t.compare.forEach(function(t){var o=e.createElement("div",{class:"compare-row-container"}).inject(r),a=t.left,l=t.right,c=a.title+" "+a.revision,d=l.title+" "+l.revision;e.createElement("div",{html:c+s.anchor_with+d}).inject(o);var u=[];u.push({physicalid:a.physicalid,label:c},{physicalid:l.physicalid,label:d}),new i({label:s.compare,emphasize:"primary",onClick:function(){n.launchCompare(u)}}).inject(o)}),t&&t.unchanged&&n._createViewRowDispSection({type:"pilotingDisciplines",items:t.unchanged,value:s.label_unchanged,container:r}),t&&t.newlyDefined&&n._createViewRowDispSection({type:"pilotingDisciplines",items:t.newlyDefined,value:s.label_newlyDefined,container:r}),t&&t.previouslyDefined&&n._createViewRowDispSection({type:"pilotingDisciplines",items:t.previouslyDefined,value:s.label_previouslyDefined,container:r}),o;r.innerHTML=s.label_none},l.prototype._createPropSolnCompareSection=function(t){var n=this,o=[],r=e.createElement("div",{class:"compare-item-container"}),a=e.createElement("div",{class:"compare-options-subheader"}).inject(r);e.createElement("div",{html:s.label_proposed_solution}).inject(a);var l=e.createElement("div",{class:"compare-item-subcontainer"}).inject(r);if(t){if(t&&t.compare){var c=e.createElement("div",{class:"compare-row-container"}).inject(l),d=e.createElement("div",{class:"solns-container"}).inject(c);t.compare.forEach(function(t){var i=t.title+" "+t.revision;e.createElement("div",{html:i}).inject(d),o.push({physicalid:t.physicalid,label:i})})}return t&&t.unchanged&&(n._createViewRowDispSection({type:"proposedSolutions",items:t.unchanged,value:s.label_unchanged,container:l}),t.unchanged.forEach(function(e){o.push({physicalid:e.physicalid,label:e.title+" "+e.revision})})),t&&t.newlyDefined&&(n._createViewRowDispSection({type:"proposedSolutions",items:t.newlyDefined,value:s.label_newlyDefined,container:l}),t.newlyDefined.forEach(function(e){o.push({physicalid:e.physicalid,label:e.title+" "+e.revision})})),t&&t.previouslyDefined&&(n._createViewRowDispSection({type:"proposedSolutions",items:t.previouslyDefined,value:s.label_previouslyDefined,container:l}),t.previouslyDefined.forEach(function(e){o.push({physicalid:e.physicalid,label:e.title+" "+e.revision})})),o&&o.length>1&&new i({label:s.compare_all,emphasize:"primary",onClick:function(){n.launchCompare(o)}}).inject(a),r}l.innerHTML=s.label_none},l.prototype._createViewRowDispSection=function(t){var i=e.createElement("div",{class:"info-row-container"}).inject(t.container);e.createElement("div",{html:"<b><em>"+t.value+"</em></b>"}).inject(i);var n=e.createElement("div",{class:"info-row-container"}).inject(i),o=e.createElement("div").inject(n);t.items.forEach(function(t){e.createElement("div",{html:t.title+" "+t.revision}).inject(o)})},l.prototype.launchCompare=function(e){a.init("CompareCmd",e)},l}),define("DS/CATFLCockpitWidget/components/ExportCSV/ExportCSV",["DS/DataGridView/DataGridView","DS/Windows/Dialog","DS/Controls/Button","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/Handlebars/Handlebars","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/services/predicate.service","DS/CATFLCockpitWidget/utils/model.events.util","text!DS/CATFLCockpitWidget/components/ExportCSV/ExportCSV.html","text!DS/CATFLCockpitWidget/components/ExportCSV/PreviewFormat.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g){"use strict";var m=a.getFullConfig(),f={bodyModal:r.compile(u),bodyPreviewFormat:r.compile(p)},h=function(e,t,i){var r=this;r.root={id:e,name:t},r.modelInfo=i,r.container=widget.body,r.render(),r.availableAttributes=new n({useAsyncPreExpand:!0}),r.availableAttributes.addChild([new o({key:"Col0",ds6w:"ds6w:label",bo:!0,grid:{iconType:"object-reference",name:a.getNlsBasicAttributesBO("ds6w:label"),declaredIn:g.label_all_levels}}),new o({key:"Col1",ds6w:"ds6wg:revision",bo:!0,grid:{iconType:"object-reference",name:a.getNlsBasicAttributesBO("ds6wg:revision"),declaredIn:g.label_all_levels}}),new o({key:"Col2",ds6w:"ds6w:isLastRevision",bo:!0,grid:{iconType:"object-reference",name:a.getNlsBasicAttributesBO("ds6w:isLastRevision"),declaredIn:g.label_all_levels}}),new o({key:"Col3",ds6w:"ds6w:label",bo:!1,grid:{iconType:"object-instance",name:a.getNlsBasicAttributesBO("ds6w:label"),declaredIn:g.label_all_levels}}),new o({key:"Col4",ds6w:"ds6w:status",bo:!0,grid:{iconType:"object-reference",name:a.getNlsBasicAttributesBO("ds6w:status"),declaredIn:g.label_all_levels}}),new o({key:"Col5",ds6w:"ds6w:responsible",bo:!0,grid:{iconType:"object-reference",name:a.getNlsBasicAttributesBO("ds6w:responsible"),declaredIn:g.label_all_levels}}),new o({key:"Col6",ds6w:"ds6w:reserved",bo:!0,grid:{iconType:"object-reference",name:a.getNlsBasicAttributesBO("ds6w:reserved"),declaredIn:g.label_all_levels}}),new o({key:"Col7",ds6w:"ds6w:created",bo:!0,grid:{iconType:"object-reference",name:a.getNlsBasicAttributesBO("ds6w:created"),declaredIn:g.label_all_levels}}),new o({key:"Col8",ds6w:"ds6w:modified",bo:!0,grid:{iconType:"object-reference",name:a.getNlsBasicAttributesBO("ds6w:modified"),declaredIn:g.label_all_levels}}),new o({key:"Col9",ds6w:"ds6w:description",bo:!0,grid:{iconType:"object-reference",name:a.getNlsBasicAttributesBO("ds6w:description"),declaredIn:g.label_all_levels}}),new o({key:"Col10",ds6w:"ds6w:type",bo:!0,grid:{iconType:"object-reference",name:a.getNlsBasicAttributesBO("ds6w:type"),declaredIn:g.label_all_levels}}),new o({key:"Col11",ds6w:"ds6w:identifier",bo:!0,grid:{iconType:"object-reference",name:a.getNlsBasicAttributesBO("ds6w:identifier"),declaredIn:g.label_all_levels}}),new o({key:"Col12",ds6w:"ds6wg:architectureextension.v_architecturenumber",bo:!0,grid:{iconType:"object-reference",name:g.label_arch_no,declaredIn:g.label_all_levels}})]);var l=[],d=s.getUserCustomAttributes(),u=s.getUserCustomAttributes(!0);if(d&&l.push(...d),u&&l.push(...u),l&&l.length>0){var p={};c.getNLSPredicates(l).then(function(e){p=e||{}}).finally(function(){l.forEach(function(e,t){let i,n=p[e.curi]||e.nls||e.curi;if(e.dimension){var a=m.dimensions[e.dimension];e.manipulationUnit?(n=n+" ("+a.Units[e.manipulationUnit].NLSName+")",i={dimension:e.dimension,manipulationUnit:e.manipulationUnit,MKSUnit:a.MKSUnit}):n=n+" ("+a.Units[a.MKSUnit].NLSName+")"}r.availableAttributes.addChild(new o({key:"UsrCol"+t,ds6w:e.curi,bo:e.bo,UoM:i,grid:{iconType:e.bo?"object-reference":"object-instance",name:n,declaredIn:e.declaredIn}}))}),r.restorePreviousAttributesSelection()})}else r.restorePreviousAttributesSelection()};return h.prototype.render=function(){var e=this,n=d.getFLWebModelEventsObj("flweb-model-events");e.modal=new t({title:g.action_export,content:f.bodyModal({NLS:g,defaultFileName:e.root.name}),width:580,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new i({label:g.action_export,emphasize:"primary",onClick:function(){e.launchExport(),e.modal.close()}}),Apply:new i({label:g.label_preview_format,emphasize:"secondary",onClick:function(){e.renderPreviewFormat()}}),Close:new i({label:g.cancel_button,emphasize:"secondary",onClick:function(){e.modal.close()}})}}),e.modal.addEventListener("close",function(){p&&n.unsubscribe(p),h&&n.unsubscribe(h),e.modal.destroy()});var o=e.modal.elements._contentDiv.querySelector("#export-all-levels"),r=e.modal.elements._contentDiv.querySelector("#input-nb-level-exported"),a=e.modal.elements._contentDiv.querySelector(".file-name-user-input"),s=e.modal.elements._contentDiv.querySelector(".info-exported-level"),l=e.modal.elements._contentDiv.querySelector(".checkbox-export-all-levels");o.addEventListener("click",function(){o.checked?r.disabled=!0:r.disabled=!1});var c=JSON.parse(localStorage.getItem(m.localStorageKeys.exportCSVOptions));null!==c&&(-1!==c.expandLevels&&(o.checked=!1,r.disabled=!1,r.value=c.expandLevels),c.addProposedSolutions||(e.modal.elements._contentDiv.querySelector("#export-proposed-solution").checked=!1),c.addSpecDocs||(e.modal.elements._contentDiv.querySelector("#export-specification-documents").checked=!1),c.addDiscRef||(e.modal.elements._contentDiv.querySelector("#export-discipline-references").checked=!1)),e.modal.elements._contentDiv.querySelector(".fonticon-cog").addEventListener("click",function(){e.renderAttributesSelector()}),a.addEventListener("input",function(){0===a.value.length?(e.modal.buttons.Ok.disabled=!0,e.modal.buttons.Apply.disabled=!0):(e.modal.buttons.Ok.disabled=!1,e.modal.buttons.Apply.disabled=!1)}),r.addEventListener("change",function(){var e=parseInt(r.value,10);isNaN(e)||e<0?r.value=0:r.value=e});let u=function(){var e=widget.getValue("ngFilter");e&&e.length>0?(l.hidden=!0,s.hidden=!1):(l.hidden=!1,s.hidden=!0)},p=n.subscribe({event:"flweb-ngfilter-added"},u),h=n.subscribe({event:"flweb-ngfilter-removed"},u);u(),e.modal.show()},h.prototype.launchExport=function(){var e=this.modal.elements._contentDiv,t=e.querySelector("#export-all-levels"),i=e.querySelector("#input-nb-level-exported"),n=e.querySelector(".file-name-user-input").value+".csv",o={root_physicalid:this.root.id,exportSpecDoc:e.querySelector("#export-specification-documents").checked,exportProposedSolution:e.querySelector("#export-proposed-solution").checked,exportDisciplineReferences:e.querySelector("#export-discipline-references").checked,exportFileName:n};if(t.checked?o.expand_iter=-1:o.expand_iter=parseInt(i.value,10),widget.getValue("ngFilter")&&widget.getValue("ngFilter").length>0){var r=JSON.parse(widget.getValue("ngFilter"));o.ngFilterV2={filterTitle:r.filterTitle},r.CVQueryV2.filter?o.ngFilterV2.CVQueryV2=r.CVQueryV2:r.CVQueryV2.batch&&r.CVQueryV2.batch.expands&&1===r.CVQueryV2.batch.expands.length&&(o.ngFilterV2.CVQueryV2=r.CVQueryV2.batch.expands[0])}else if(this.modelInfo&&this.modelInfo.modelVersion&&this.modelInfo.modelVersion.physicalid){var a=widget.getValue("currentConfig").filterCompiledForm,c=this.modelInfo.modelVersion.name+" "+this.modelInfo.modelVersion.revision;if(this.modelInfo.pc&&this.modelInfo.pc.physicalid){var d=this.modelInfo.pc.label?this.modelInfo.pc.label:this.modelInfo.pc.name;d.startsWith("[")&&d.endsWith("]")&&(d=d.slice(1,d.length-1)),c=c+" "+d}o.configFilteringContext={filter_compiledform:a,filter_info:c}}var u=[];this.availableAttributes.getSelectedNodes().forEach(function(e){var t={key:e.options.key,bo:e.options.bo,ds6w:e.options.ds6w,display:e.options.grid.name};e.options.UoM&&(t.UoM=e.options.UoM),u.push(t)}),o.selectedColumns=u,localStorage.setItem(m.localStorageKeys.exportCSVOptions,JSON.stringify({expandLevels:o.expand_iter,addProposedSolutions:o.exportProposedSolution,addSpecDocs:o.exportSpecDoc,addDiscRef:o.exportDisciplineReferences})),l.post(m.webservices.exportCSV,JSON.stringify(o),0).then(function(e){s.downloadFile(n,e,!0)}).catch(function(e){e&&e.errorResp&&s.alertMessage("error",null,e.errorResp.message)})},h.prototype.renderAttributesSelector=function(){var n=this;n.restorePreviousAttributesSelection(),n.dialog=new t({title:g.attributes_browser+" - "+g.label_select_attributes,height:500,width:700,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new i({label:g.save_button,emphasize:"primary",onClick:function(){var e=[];n.dgv.treeDocument.getSelectedNodes().forEach(function(t){e.push({ds6w:t.options.ds6w,bo:t.options.bo})}),localStorage.setItem(m.localStorageKeys.exportCSVSelectedColumns,JSON.stringify(e)),n.dialog.close()}}),Close:new i({label:g.cancel_button,emphasize:"secondary",onClick:function(){n.dialog.close()}})}}),n.dialog.addEventListener("close",function(){n.dgv.getNodesXSO().unsubscribe(o),n.dgv.getNodesXSO().unsubscribe(r),n.dialog.destroy()}),n.dgv=new e({identifier:"LogicalProductDefinition_ExportCSV",height:"inherit",treeDocument:n.availableAttributes,selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{typeRepresentation:"icon",dataIndex:"iconType",width:40},{text:g.label_name,dataIndex:"name"},{text:g.label_declared_in,dataIndex:"declaredIn"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID?{shortHelp:e.nodeModel.options.bo?g.label_declared_in_reference:g.label_declared_in_instance,updateModel:!1}:n.dgv.getCellDefaultTooltip(e)}}),n.dialog.elements._contentDiv.appendChild(n.dgv.getContent()),n.dgv.treeDocument.setFilterModel({name:{filterId:"stringRegexp"},declaredIn:{filterId:"stringRegexp"}});var o=n.dgv.getNodesXSO().onPostAdd(n.updateAttributesSelectorSaveButtonDisabledState.bind(n)),r=n.dgv.getNodesXSO().onPostRemove(n.updateAttributesSelectorSaveButtonDisabledState.bind(n))},h.prototype.restorePreviousAttributesSelection=function(){this.availableAttributes.unselectAll();var e=JSON.parse(localStorage.getItem(m.localStorageKeys.exportCSVSelectedColumns));null===e?this.availableAttributes.selectAll():this.availableAttributes.getAllDescendants().forEach(function(t){for(var i=0;i<e.length;i++)e[i].ds6w===t.options.ds6w&&e[i].bo===t.options.bo&&t.select()})},h.prototype.updateAttributesSelectorSaveButtonDisabledState=function(){0===this.availableAttributes.getSelectedNodes().length?this.dialog.buttons.Ok.disabled=!0:this.dialog.buttons.Ok.disabled=!1},h.prototype.renderPreviewFormat=function(){var o=this,r=o.modal.elements._contentDiv,s=r.querySelector(".file-name-user-input").value,l={fileName:0===s.length?"":s+".csv",exportedBy:a.getUser("isFullName"),exportedOn:(new Date).toLocaleString("fr-FR",{timeZone:"UTC"}),exportSpecDocs:r.querySelector("#export-specification-documents").checked?g.label_yes:g.label_no,exportProposedSolutions:r.querySelector("#export-proposed-solution").checked?g.label_yes:g.label_no,exportDiscRef:r.querySelector("#export-discipline-references").checked?g.label_yes:g.label_no},c=r.querySelector("#export-all-levels"),d=r.querySelector("#input-nb-level-exported");c.checked?l.expandLevels=g.label_all_levels:l.expandLevels=parseInt(d.value,10),widget.getValue("ngFilter")&&widget.getValue("ngFilter").length>0?(l.appliedConfiguration=JSON.parse(widget.getValue("ngFilter")).filterTitle,l.expandLevels=g.info_level_based_on_filter):o.modelInfo&&o.modelInfo.model&&o.modelInfo.model.physicalid?o.modelInfo.modelVersion&&o.modelInfo.modelVersion.physicalid?(l.appliedConfiguration=o.modelInfo.modelVersion.name+" "+o.modelInfo.modelVersion.revision+" ",o.modelInfo.pc&&o.modelInfo.pc.physicalid?l.appliedConfiguration+=o.modelInfo.pc.name:l.appliedConfiguration+=g.label_all):l.appliedConfiguration=g.label_all_models:l.appliedConfiguration=g.label_none,o.dialog=new t({title:g.label_preview,height:460,width:700,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,content:f.bodyPreviewFormat({NLS:g,infos:l}),buttons:{Ok:new i({label:g.action_export,emphasize:"primary",onClick:function(){o.launchExport(),o.dialog.close(),o.modal.hide()}}),Close:new i({label:g.cancel_button,emphasize:"secondary",onClick:function(){o.dialog.close()}})}}),o.dialog.addEventListener("close",function(){o.dialog.destroy()}),o.dialog.elements.container.classList.add("flweb-cockpit-export-csv-preview-format");var u=[];o.restorePreviousAttributesSelection(),o.availableAttributes.getSelectedNodes().forEach(function(e){var t={text:e.options.grid.name,dataIndex:e.options.key};e.options.bo||(t.icon={iconName:"object-instance"}),u.push(t)}),o.dgv=new e({identifier:"LogicalProductDefinition_ExportCSV_PreviewFormat",height:"inherit",treeDocument:new n({useAsyncPreExpand:!0}),rowSelection:"none",columns:u,placeholder:g.label_preview_warning_values_filled_at_actual_export,defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(){return!1}}),o.dialog.elements._contentDiv.querySelector(".dgv-container").appendChild(o.dgv.getContent())},h}),define("DS/CATFLCockpitWidget/components/BulkEdition/BulkEditionDialog",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/DataGridView/DataGridView","DS/Windows/Dialog","DS/Controls/Button","DS/UIKIT/Mask","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/predicate.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g){"use strict";var m=c.getFullConfig();return{open:function(i,a){var s=this;s.item=i,s.collectionView=a,s.treeDocument=a.treeDocument,s.availableAttributes=new e({useAsyncPreExpand:!0}),s.availableAttributes.addChild([new t({ds6w:"ds6w:label",dataIndex:"title",selectable:"PLMEntity.V_Name",bo:!0,grid:{iconType:"object-reference",name:c.getNlsBasicAttributesBO("ds6w:label"),declaredIn:g.label_all_levels}}),new t({ds6w:"ds6w:description",dataIndex:"description",selectable:"PLMEntity.V_description",bo:!0,grid:{iconType:"object-reference",name:c.getNlsBasicAttributesBO("ds6w:description"),declaredIn:g.label_all_levels}})]),i.options.instance&&(s.availableAttributes.addChild(new t({ds6w:"ds6w:label",dataIndex:"instanceName",selectable:"PLMInstance.PLM_ExternalID",bo:!1,grid:{iconType:"object-instance",name:c.getNlsBasicAttributesBO("ds6w:label"),declaredIn:g.label_all_levels}}),1),s.availableAttributes.addChild(new t({ds6w:"ds6w:description",dataIndex:"description",selectable:"PLMInstance.V_description",bo:!1,grid:{iconType:"object-instance",name:c.getNlsBasicAttributesBO("ds6w:description"),declaredIn:g.label_all_levels}})));var u=d.getUserCustomAttributes();if(u){var p={};l.getNLSPredicates(u).then(function(e){p=e||{}}).finally(function(){u.forEach(function(e){!e.bo&&!i.options.instance||e.readOnly||(!e.declaredInArray||e.isOnExtension||e.isClassification||e.bo&&e.declaredInArray.includes(s.item.options.grid.actualType)||!e.bo&&e.declaredInArray.includes(s.item.options.grid.instance_actualType))&&s.availableAttributes.addChild(new t({ds6w:e.curi,selectable:e.selectable,bo:e.bo,dimension:e.dimension,manipulationUnit:e.manipulationUnit,rangeValues:e.rangeValues,grid:{iconType:e.bo?"object-reference":"object-instance",name:p[e.curi]||e.nls||e.curi,declaredIn:e.declaredIn},declaredInArray:e.declaredInArray,isOnExtension:e.isOnExtension,isClassification:e.isClassification,type:e.type}))})})}s.dialogDGV=new o({title:g.attributes_browser+" - "+g.label_select_attributes,height:500,width:700,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new r({label:g.action_copy,emphasize:"primary",disabled:!0,onClick:function(){s.selectedAttributes=s.dgv.treeDocument.getSelectedNodes(),s.treeDocument.getSelectedNodes()[0].unselect(),s.tokenPostAdd=s.treeDocument.getXSO().onPostAdd(s._onXSOChanged.bind(s,s.item,s.treeDocument)),s.tokenPostRemove=s.treeDocument.getXSO().onPostRemove(s._onXSOChanged.bind(s,s.item,s.treeDocument)),d.alertMessage("success",null,g.msg_copy_attributes_success),s.dialogDGV.close()}}),Close:new r({emphasize:"secondary",onClick:function(){s.dialogDGV.close()}})}}),s.dgv=new n({identifier:"LogicalProductDefinition_CopyAttributes_AttributesSelector",height:"inherit",treeDocument:s.availableAttributes,selectionBehavior:{unselectAllOnEmptyArea:!1},columns:[{typeRepresentation:"icon",dataIndex:"iconType",width:40},{text:g.label_name,dataIndex:"name"},{text:g.label_declared_in,dataIndex:"declaredIn"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!0,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID?{shortHelp:e.nodeModel.options.bo?g.label_declared_in_reference:g.label_declared_in_instance,updateModel:!1}:s.dgv.getCellDefaultTooltip(e)}}),s.dialogDGV.elements._contentDiv.appendChild(s.dgv.getContent()),s.dgv.treeDocument.setFilterModel({name:{filterId:"stringRegexp"},declaredIn:{filterId:"stringRegexp"}}),s.tokenPostAdd=s.dgv.treeDocument.getXSO().onPostAdd(function(){s.dialogDGV.buttons.Ok.disabled=!1}),s.tokenPostRemove=s.dgv.treeDocument.getXSO().onPostRemove(function(){0===s.dgv.treeDocument.getSelectedNodes().length&&(s.dialogDGV.buttons.Ok.disabled=!0)}),s.dialogDGV.addEventListener("close",function(){s.dialogDGV.destroy()})},_postSelectionCall:function(){this.treeDocument.getSelectedNodes()[0].unselect(),this.tokenPostAdd=this.treeDocument.getXSO().onPostAdd(this._onXSOChanged.bind(this,this.item,this.treeDocument)),this.tokenPostRemove=this.treeDocument.getXSO().onPostRemove(this._onXSOChanged.bind(this,this.item,this.treeDocument))},submit:function(){var e=this;if(void 0!==e.selectedNodes&&0!==e.selectedNodes.length){a.mask(widget.body,g.msg_processing);var t,n=[],o=!1,r=!1,l={};e.selectedNodes.forEach(function(i){var a={},s={},c={objectLabel:i.options.label,instance_pid:i.options.instance?i.options.instance.physicalid:null,icons:[i.options.icons[0]],refAttributes:[],instAttributes:[]};l[i.options.physicalid]=c;for(var u=0;u<e.selectedAttributes.length;u++){var p=e.selectedAttributes[u].options.dataIndex||e.selectedAttributes[u].options.ds6w,g=!1,m=e.selectedAttributes[u].options.isOnExtension,f=e.selectedAttributes[u].options.isClassification;!e.selectedAttributes[u].options.declaredInArray||m||f?g=!0:(e.selectedAttributes[u].options.bo&&e.selectedAttributes[u].options.declaredInArray.includes(i.options.grid.actualType)||!e.selectedAttributes[u].options.bo&&e.selectedAttributes[u].options.declaredInArray.includes(i.options.grid.instance_actualType))&&(g=!0),e.selectedAttributes[u].options.bo?c.refAttributes.push({name:e.selectedAttributes[u].options.grid.name,iconType:e.selectedAttributes[u].options.grid.iconType,copySuccessful:!1,isDeclaredIn:g,isOnExtension:m,isClassification:f,responsibleForError:void 0,bo:!0}):c.instAttributes.push({name:e.selectedAttributes[u].options.grid.name,iconType:e.selectedAttributes[u].options.grid.iconType,copySuccessful:!1,isDeclaredIn:g,isOnExtension:m,responsibleForError:void 0});var h=e.selectedAttributes[u].options.selectable;if(void 0===h.length){var v=null;(v=!e.selectedAttributes[u].options.bo&&i.options.instance?i.options.grid.instance_actualType:i.options.grid.actualType)&&(h=e.selectedAttributes[u].options.selectable[v])}if("title"===p)a[h]=e.item.options.label;else if("instanceName"===p)s[h]=e.item.options.grid.instanceName;else{let i=e.selectedAttributes[u].options.bo?p:"instance_"+p,n=Array.isArray(e.item.options.grid[i]),o={};if(e.selectedAttributes[u].options.manipulationUnit)o={unitName:e.selectedAttributes[u].options.manipulationUnit,dimensionType:e.selectedAttributes[u].options.dimension,value:e.item.options.grid[i]};else if("date"===e.selectedAttributes[u].options.type)if(void 0!==e.selectedAttributes[u].options.rangeValues)if(n){for(var C=[],b=0;b<e.item.options.grid[i].length;b++){let t=e.selectedAttributes[u].options.rangeValues.find(function(t){if(t.formatDateValue)return d.isDateEqual(t.value,e.item.options.grid[i][b])});void 0!==t?C.push(t.value):C.push(e.item.options.grid[i][b])}o=C}else{let t=e.selectedAttributes[u].options.rangeValues.find(function(t){if(t.formatDateValue)return d.isDateEqual(t.value,e.item.options.grid[i])});o=void 0!==t?t.value:e.item.options.grid[i]}else n?(t=[],t=e.item.options.grid[i].map(function(e){let t=d.formatDate(e);return t=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+"@12:00:00:GMT"})):(t="",e.item.options.grid[i]&&(t=(t=d.formatDate(e.item.options.grid[i])).getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+"@12:00:00:GMT")),o=t;else o=e.item.options[i]?e.item.options[i]:e.item.options.grid[i];e.selectedAttributes[u].options.bo?a[h]=o:s[h]=o}}Object.keys(a).length>0&&(n.push({refID:i.options.physicalid,attributes:a}),o=!0),Object.keys(s).length>0&&i.options.instance&&(n.push({instID:i.options.instance.physicalid,attributes:s}),r=!0)}),s.updateAttribute(n).then(function(t){let n={};for(var a=0;a<t.length;a++)t[a].body.oldInstancePhysicalid?n[t[a].body.oldInstancePhysicalid]=t[a].body:n[t[a].body.physicalid]=t[a].body;for(var s={grid:{}},p={grid:{}},g=0;g<e.selectedAttributes.length;g++){var f=e.selectedAttributes[g].options.dataIndex||e.selectedAttributes[g].options.ds6w;"title"===f?s.label=e.item.options.label:e.selectedAttributes[g].options.bo?(e.selectedAttributes[g].options.manipulationUnit&&(s.grid[f+"_actual"]=e.item.options.grid[f+"_actual"]),e.item.options[f]&&(s[f]=e.item.options[f]),s.grid[f]=e.item.options.grid[f]):"instanceName"===f?p.grid[f]=e.item.options.grid[f]:(e.selectedAttributes[g].options.manipulationUnit&&(p.grid["instance_"+f+"_actual"]=e.item.options.grid["instance_"+f+"_actual"]),e.item.options["instance_"+f]&&(s["instance_"+f]=e.item.options["instance_"+f]),p.grid["instance_"+f]=e.item.options.grid["instance_"+f])}let h={},v=[],C=[],b=[];for(var y=0;y<e.selectedNodes.length;y++){var _,w,D,S,I=e.selectedNodes[y],A=!1,F=!1;let t=[],a=[];if(o){_=n[I.options.physicalid],D=_&&_.modified?d.formatDate(_.modified.value[0]):null;var E=new Date(I.options.grid.modificationDate);A=!(!D||!E)&&D.getTime()!==E.getTime()}if(r&&I.options.instance){w=n[I.options.instance.physicalid],S=w&&w.modified?d.formatDate(w.modified.value[0]):null;var k=I.options.instance?new Date(I.options.instance.modificationDate):null;F=!(!S||!k)&&S.getTime()!==k.getTime()}if(o&&A&&c.SAXStorage().setItem(m.localStorageKeys.recentlyAuthored+I.options.physicalid,Date.now()),r&&F&&c.SAXStorage().setItem(m.localStorageKeys.recentlyAuthoredStructure+I.getParent().options.physicalid,Date.now()),(e.treeDocument.getMappedNodesFromId(I.options.physicalid)||[I]).forEach(function(e){if(A&&(s.grid.modificationDate=D,e.updateOptions(JSON.parse(JSON.stringify(s))),l[I.options.physicalid].refAttributes.forEach(function(e){e.copySuccessful=!0})),e.options.instance&&F)if(w&&w.oldInstancePhysicalid){let n=e.getParent(),o=new i({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,physicalid:e.options.physicalid,instance:{physicalid:w.physicalid},grid:{physicalid:e.options.physicalid},actualParent:e.options.actualParent,children:[]});o.setRelationID(w.physicalid),n.addChild(o,e._rowID),t.push(o),a.push(e),l[I.options.physicalid].instAttributes.forEach(function(e){e.copySuccessful=!0})}else e.options.instance.physicalid===I.options.instance.physicalid&&(p.instance={modificationDate:S},e.updateOptions(JSON.parse(JSON.stringify(p))),l[I.options.physicalid].instAttributes.forEach(function(e){e.copySuccessful=!0}));function n(e,t){var i=!1;for(const[n,o]of Object.entries(t))if("grid"===n){for(const[t,n]of Object.entries(o))if(e.grid[t]!==n){i=!0;break}}else if("instance"!==n&&e[n]!==o){i=!0;break}return!i}o&&!A&&n(e.options,s)&&l[I.options.physicalid].refAttributes.forEach(function(e){e.equalValues=!0}),r&&e.options.instance&&!F&&n(e.options,p)&&l[I.options.physicalid].instAttributes.forEach(function(e){e.equalValues=!0})}),t.length>0&&a.length>0){let e=n[I.options.instance.physicalid];h[e.oldInstancePhysicalid]=a,h[e.physicalid]=t,v.push(a[0].options.physicalid),b.push(I),C.push(I.getNextNode())}}if(C.length>0&&C.forEach(e=>{e.select()}),b.length>0&&b.forEach(e=>{e.unselect()}),Object.keys(h).length>0){let e=u.getFLWebModelEventsObj("flcockpit-content-list-view");e.publish({event:"refresh-nodes-by-id",data:{arrayOfPID:v,tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!0}}),e.publish({event:"refresh-inst-by-id",data:{instIdMap:h,bInstance:!0,bEffectivity:!0}})}let x=e.collectionView.getGroupingOptions();x&&e.collectionView.groupRows(x),e._createSummaryPastDialog(l)}).catch(function(t){if(t&&t.error&&t.error.errorList){var i={};for(var n in t.error.errorList.forEach(e=>{i[e.physicalid]=e.errors||[]}),l)if(l.hasOwnProperty(n)){var o=l[n].refAttributes.concat(l[n].instAttributes);for(var r in o)void 0!==i[n]?(o[r].responsibleForError=!0,o[r].errorMsg=i[n].map(e=>e.message).join(". ")):void 0!==i[l[n].instance_pid]?(o[r].responsibleForError=!0,o[r].errorMsg=i[l[n].instance_pid].map(e=>e.message).join(" ")):o[r].responsibleForError=!1}e._createSummaryPastDialog(l)}else{var a=t&&t.errorResp&&t.errorResp.error?t.errorResp.error:"";d.displayError(t,g.error_copy_attributes_failed,null,a)}}).finally(function(){a.unmask(widget.body),setTimeout(function(){e._cleanAndDestroy()},500)})}else e._cleanAndDestroy()},_onXSOChanged:function(e,t){this.selectedNodes=t.getSelectedNodes().filter(function(t){return t.options.physicalid!==e.options.physicalid})},_cleanAndDestroy:function(){this.treeDocument.getXSO().unsubscribe(this.tokenPostAdd),this.treeDocument.getXSO().unsubscribe(this.tokenPostRemove),this.dialogDGV&&(this.dialogDGV.destroy(),this.dialogDGV=null)},_createSummaryPastDialog:function(i){var a=this;for(var s in a.treedocumentSummaryPaste=new e({useAsyncPreExpand:!0}),i)if(i.hasOwnProperty(s)){var l=i[s],c=new t({label:l.objectLabel,icons:l.icons});a.treedocumentSummaryPaste.addChild(c);var d=l.refAttributes.concat(l.instAttributes);for(var u in d)if(d.hasOwnProperty(u)){var p=d[u],m="";p.copySuccessful||(m=!0===p.responsibleForError?p.errorMsg?p.errorMsg:p.isDeclaredIn?p.isOnExtension?g.msg_copy_attribute_on_extension_failed:p.isClassification?g.msg_copy_attribute_classif_failed:g.msg_copy_attribute_failed_not_allowed:g.msg_copy_attribute_on_type_failed:!1===p.responsibleForError?g.msg_copy_all_attributes_failed:p.isDeclaredIn?p.equalValues?g.msg_copy_attribute_equal_values_failed:p.isOnExtension?g.msg_copy_attribute_on_extension_failed:p.isClassification?g.msg_copy_attribute_classif_failed:g.msg_copy_attribute_failed:g.msg_copy_attribute_on_type_failed),c.addChild(new t({label:p.name,icons:[p.iconType],grid:{copySuccessful:p.copySuccessful,message:m},bo:p.bo}))}}a.treedocumentSummaryPaste.expandAll();var f=new n({identifier:"LogicalProductDefinition_SummaryPasteAttributes",height:"inherit",treeDocument:a.treedocumentSummaryPaste,rowSelection:"none",columns:[{dataIndex:"tree",text:g.label_title,width:"30%"},{typeRepresentation:"boolean",text:g.label_copy_successful,dataIndex:"copySuccessful",width:95,getCellClassName:function(e){return e&&e.nodeModel?!0===e.nodeModel.options.grid.copySuccessful?"sax-is-copySuccessful-true":"sax-is-copySuccessful-false":null}},{text:g.label_information,dataIndex:"message"}],defaultColumnDef:{typeRepresentation:"string",width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t}});a.dialogSummaryPaste=new o({title:g.title_summary_paste_attributes,height:500,width:1e3,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Apply:new r({label:g.action_export,emphasize:"secondary",onClick:function(){a._exportSummaryPastDialog(a.treedocumentSummaryPaste)}}),Close:new r({emphasize:"primary",onClick:function(){a.dialogSummaryPaste.close()}})}}),a.dialogSummaryPaste.addEventListener("close",function(){a.dialogSummaryPaste.destroy()}),a.dialogSummaryPaste.elements._contentDiv.appendChild(f.getContent()),f.treeDocument.setFilterModel({label:{filterId:"stringRegexp"},copySuccessful:{filterId:"set",filterModel:[]},message:{filterId:"stringRegexp"}})},_exportSummaryPastDialog:function(i){var o=[{dataIndex:"objectName",text:g.label_title},{dataIndex:"attributeName",text:g.label_attribute_name},{typeRepresentation:"boolean",text:g.label_copy_successful,dataIndex:"copySuccessful"},{text:g.label_information,dataIndex:"message"}],r=new n({treeDocument:new e({useAsyncPreExpand:!0}),columns:o,defaultColumnDef:{width:"auto"}});r.treeDocument.empty(),r.treeDocument.prepareUpdate(),i&&i.getChildren()&&i.getChildren().forEach(e=>{var i=new t({label:"",grid:{objectName:e.options.label}});r.treeDocument.addChild(i),e.getChildren().forEach(e=>{var i=new t({grid:{attributeName:e.options.label+(e.options.bo?"":" "+g.label_instance),copySuccessful:e.options.grid.copySuccessful,message:e.options.grid.message}});r.treeDocument.addChild(i)})}),r.treeDocument.expandAll(),r.treeDocument.pushUpdate();var a=r.getAsCSV(),s=g.action_export+"_"+g.title_summary_paste_attributes+".csv",l=new Date,u=c.getUser("isFullName");a=g.title_summary_paste_attributes+"\nFile Name,"+s+"\nExport Date Time,"+l+"\nExported By,"+u+"\n\n\n"+a,d.downloadFile(s,a,!0),d.alertMessage("success",null,g.msg_summary_paste_attributes_export_success)}}}),define("DS/CATFLCockpitWidget/components/PropertiesPanel/propertiespanel.controller",["DS/CoreEvents/ModelEvents","DS/EditPropWidget/EditPropWidget","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/models/EditPropAttributeModel","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/refresh.util","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l){"use strict";let c=JSON.parse(s);return{init:function(n,o){this.contentView=o,this.modelEvents=new e,this.parentContainer=n;var a=[i.FACET_PROPERTIES,i.FACET_INSTANCE,i.FACET_SHARING,i.FACET_RELATIONS,i.FACET_EFFECTIVITY,i.FACET_CHANGE,i.FACET_iCHANGE,i.FACET_IPPROTECTION,i.FACET_SWYMCOMMENTS,i.FACET_ADMIN],s={typeOfDisplay:i.ALL,selectionType:i.NO_SELECTION,facets:a,extraNotif:!0,editMode:!1,readOnly:!1,context:{getSecurityContext:function(){return{SecurityContext:r.getSecurityContext()}}}};return this.EditPropWidget=new t(s),this.addAttachmentsTab(),this.addSpecDocsTab(),this.EditPropWidget.elements.container.inject(this.parentContainer),this},loadModel:function(e,t,i){var o=this;o.contentView=i;var a=[],s=[];e.forEach(function(e){s.push(e.physicalid);var i=new n({metatype:e.metatype?e.metatype:t,objectId:e.physicalid,instrefid:e.childPID,tenant:r.getTenant(),source:"3DSpace"});i.set("isTransient",!1),i.addEvent("onSave",function(){o.modelEvents.publish({event:"properties-panel-on-save",data:s})}),a.push(i)}),o.EditPropWidget.initDatas(a)},addAttachmentsTab:function(){this.EditPropWidget.addFacets([{require:"DS/CATFLCockpitWidget/components/PropertiesPanel/facets/RelatedDocumentsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"REFERENCE_DOCUMENT",icon:"attach",text:l.label_attachmentsTab},options:{getAppContext:this.getContentView.bind(this),specificationDocuments:!1}}])},addSpecDocsTab:function(){c.showSpecDocs&&widget.getPreference(c.showSpecDocs)&&widget.getPreference(c.showSpecDocs).value&&this.EditPropWidget.addFacets([{require:"DS/CATFLCockpitWidget/components/PropertiesPanel/facets/RelatedDocumentsFacet",alwaysVisible:!0,services:["3DSpace"],inheritance:!0,content:null,facet:{name:"SPECIFICATION_DOCUMENT",icon:"doc-log",text:l.label_specifcationsTab},options:{getAppContext:this.getContentView.bind(this),specificationDocuments:!0}}])},getContentView:function(){return this.contentView}}}),define("DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWItemCreationModalView",["UWA/Core","UWA/Class/View","DS/UIKIT/Spinner","DS/UIKIT/Input/Text","DS/UIKIT/Scroller","DS/UIKIT/Tooltip","DS/Controls/LineEditor","DS/WUXAutoComplete/AutoComplete","DS/Controls/Toggle","DS/UIKIT/Mask","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/architectureNumber.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g){"use strict";return t.extend({name:"WIWItemCreationModalView",tagName:"div",collection:null,toupdate:null,spinner:null,init:function(t){t=e.clone(t||{},!1),this._parent(t),this.collection=t.collection,this.action=t.collection.winInfo.action},setCollection:function(e){return this.collection=e,this.action=e.winInfo.action,this},createTableComponent:function(t,i,n){var o=e.createElement(t,n);return o.inject(i),o},createTableHeaderView:function(t,i,n){var o=this,r=null,a=e.createElement("tr"),s=o.createTableComponent("th",a,{status:"ok",class:"archNo-th-checkbox"});(r=new l({type:"checkbox",value:0,checkFlag:!0})).addEventListener("change",function(e){o.toggleAllEvent(e,this,o.container)}),r.inject(s);o.createTableComponent("th",a,{html:"#"});t.forEach(function(e){var t={html:i[e].label};i[e].architectureIdColumn&&(t.class="archidcolumn"),o.createTableComponent("th",a,t)}),this.collection.showRowLevelRecomputation&&o.createTableComponent("th",a,{styles:{"background-color":"#E2E4E3"}}).appendText(g.label_reEvaluate_ArchNo),n>=1&&o.createTableComponent("th",a,{html:g.arch_no_header});let c=o.options.cfgCtxInfo;return c&&(c.bCopyEff||c.bApplyConfig)&&o.createTableComponent("th",a,{html:g.label_apply_evolution}),a},createMetaDataOfRow:function(e){var t={};return t["data-id"]=e.referenceID,t["data-instance"]=e.instanceID,e.logicalRefType&&(t["data-type"]=e.logicalRefType),t.addRefRef=e.addRefRef,t},createTableBodyView:function(t,i,n,o,c){let d,u,m=this,f=null,h=!0,v=m.options.cfgCtxInfo;for(let C=0;C<o.length;C++){h=!0!==o[C].forbidSetAN;let b=m.createMetaDataOfRow(o[C]);b.class="item-row";let y=m.createTableComponent("tr",t.getElement(".itemDetails"),b),_="",w="";if(h){let e=m.createTableComponent("td",y,{status:"ok",class:"archNo-td-checkbox",styles:{"background-color":"#D5E8F2"}});(f=new l({type:"checkbox",value:0,checkFlag:!0})).addEventListener("buttonclick",function(e){m.toggleEvent(e,this,m.container)}),f.inject(e)}else{let t=m.createTableComponent("td",y,{class:"iconColor",styles:{color:"#EA4F37"}});e.createElement("span",{class:"fonticon fonticon-status-ko"}).inject(t);let i="";o[C].forbidSetANErrorMessages.forEach(function(e){i=i+e+"<br><br>"}),new r({target:t,body:i})}if(h){if(m.createTableComponent("td",y,{html:C+1,editable:!1,styles:{"background-color":"#D5E8F2"}}),i.forEach(function(e){let t,i,r=n[e];if(u={id:r.key,name:r.label,architectureidcolumn:void 0!==r.architectureIdColumn&&r.architectureIdColumn,required:r.required,editable:r.editable,styles:{"background-color":"#D5E8F2"}},d=m.createTableComponent("td",y,u),r.editable)if(d.setAttribute("type","lineEditor"),"enum"===r.format){let n=r.range,a=r.rangeLabel,l=r.rangeTooltip,c="",u=[];c=""!==o[C][e]?o[C][e]:r.defaultValue?r.defaultValue:"";for(let e=0;e<n.length;e++)u.push({label:a?a[e]:n[e],value:n[e],description:l&&l[e]?l[e]:null});(t=new s({elementsTree:u,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1})).value=c,t.inject(d),i=t.getContent().getElement("input"),t.addEventListener("change",p.updateArchitectureID.bind(m,i,y,!1))}else(t=new a({className:"form-control",placeholder:"Enter "+n[e].label,attributes:{autocomplete:"off",name:r.label},value:o[C][e],requiredFlag:r.required})).inject(d),(i=t._myInput).addEventListener("keyup",p.updateArchitectureID.bind(m,i,y,!1)),i.addEventListener("keydown",m.nextEditableCell);else d.setHTML(o[C][e]);n[e].architectureIdColumn&&(w="enum"===r.format?t.value?t.value:"":o[C][e],_+=w)}),m.collection.showRowLevelRecomputation&&(u={id:"ANRecompute",architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":"#D5E8F2",cursor:"pointer"}},d=m.createTableComponent("td",y,u),e.createElement("span",{class:"fonticon fonticon-compute"}).inject(d),d.addEventListener("click",function(e){"ok"===e.currentTarget.closest("tr").getChildren()[0].getAttribute("status")&&p.executeRecompute({isWIWcall:!0,an_action:m.collection.AN_ACTION,rows:[e.currentTarget.closest("tr")],SelectionContext:m.collection.SelectionContext})})),c>=1){let e={class:"archidcell",html:_,styles:{"background-color":"#D5E8F2"}};m.createTableComponent("td",y,e)}}else if(m.createTableComponent("td",y,{html:C+1,editable:!1,styles:{"background-color":"#f9f9f9"}}),i.forEach(function(e){let t=n[e],i={id:t.key,name:t.label,architectureidcolumn:void 0!==t.architectureIdColumn&&t.architectureIdColumn,required:t.required,editable:!1,styles:{"background-color":"#f9f9f9"}};m.createTableComponent("td",y,i).setHTML(o[C][e])}),m.collection.showRowLevelRecomputation&&(u={id:"ANRecompute",architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":"#f9f9f9"}},d=m.createTableComponent("td",y,u)),c>=1){let e={class:"archidcell",styles:{"background-color":"#f9f9f9"}};m.createTableComponent("td",y,e)}if(v&&(v.bCopyEff||v.bApplyConfig)){let e=h?"#D5E8F2":"#f9f9f9",t={id:"applicableEvolution",name:g.label_apply_evolution,architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":e}};m.createTableComponent("td",y,t).setHTML(o[C].applicableEvolution)}}},toggleAllEvent:function(e,t,i){var n=t.getParent(),o=n.getAttribute("status"),r=i.getElements(".archNo-td-checkbox"),a=!0;"ok"===o?(a=!1,n.setAttribute("status","ko")):n.setAttribute("status","ok");for(var s=0;s<r.length;s++){r[s].getParent().getChildren().forEach(function(e,t){var i=e.getElement(".wux-controls-checkbox"),n=e.getElement(".wux-ui-fa.wux-icon");a?(0==t&&(e.setAttribute("status","ok"),i.dsModel.checkFlag=!0,n.addClassName("wux-ui-fa-check")),e.setStyle("background-color","#D5E8F2"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!1)):(0==t&&(e.setAttribute("status","ko"),i.dsModel.checkFlag=!1,n.removeClassName("wux-ui-fa-check")),e.setStyle("background-color","hsl(0, 0%, 98%)"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!0))})}},toggleEvent:function(e,t,i){var n=t.getParent(),o=n.getAttribute("status");"ok"===o?(n.getParent().getChildren().forEach(function(e){e.setStyle("background-color","hsl(0, 0%, 98%)"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!0)}),n.setAttribute("status","ko")):"ko"===o&&(n.getParent().getChildren().forEach(function(e){e.setStyle("background-color","#D5E8F2"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!1)}),n.setAttribute("status","ok"));for(var r=i.getElements(".archNo-td-checkbox"),a=i.getElements(".archNo-th-checkbox")[0].getParent().getChildren()[0],s=a.getElement(".wux-controls-checkbox"),l=a.getElement(".wux-ui-fa.wux-icon"),c=!0,d=0,u=0;u<r.length;u++)"ko"===r[u].getAttribute("status")&&c?c=!1:"ok"===r[u].getAttribute("status")&&d++;c?(s.dsModel.checkFlag=!0,l.removeClassName("wux-toggle-mixed-icon"),l.addClassName("wux-ui-fa-check")):!c&&d>0?(l.removeClassName("wux-ui-fa-check"),l.addClassName("wux-toggle-mixed-icon")):0===d&&(s.dsModel.checkFlag=!1,l.removeClassName("wux-toggle-mixed-icon"))},render:function(e){this.container=e;let t=this.collection.columnNames,i=this.collection.columns,n=this.collection.rows;this.createTableComponent("sup",e.getElement(".identifier-msg"),{html:g.arch_no_identifier_message});let o,r=0;t.forEach(function(e,t){i[e].architectureIdColumn&&(r++,o||(o=t))});let a=this.options.cfgCtxInfo;if(a&&(a.bCopyEff||a.bApplyConfig)&&a.effectivityResponse){let e={};for(let t in a.effectivityResponse){let i=a.effectivityResponse[t];if(i&&"YES"===i.hasEffectivity){let n=i.content&&i.content.Evolution;e[t]=n.Current.replace(/(\r\n|\n|\r)/gm," ")}}n.forEach(t=>{let i=Array.isArray(t.instanceID)?t.instanceID:[t.instanceID];t.evolutionEffectivity="";let n=[];i.forEach(i=>{let o=e[i];o&&n.indexOf(o)<0&&(t.evolutionEffectivity+=o,n.push(o))}),a.bCopyEff&&(t.applicableEvolution=t.evolutionEffectivity)})}this.createTableHeaderView(t,i,r).inject(e.getElement(".columnHeader")),this.createTableBodyView(e,t,i,n,r)},nextEditableCell:function(e){if(e.stopPropagation(),9==e.which){e.preventDefault();var t=e.currentTarget.getParent().getParent(),i=t.cellIndex,n=t.getParent().getChildren(),o=n.length,r=!1;if(i<o-1)for(var a=i+1;a<o;a++)if("true"==n[a].getAttribute("editable")){n[a].getChildren()[0].getChildren()[0].focus(),r=!0;break}if(!r){var s=e.currentTarget.getParent().getParent().getParent().nextSibling;s&&s.getElementsByClassName("wux-controls-abstract wux-controls-lineeditor")[0].getChildren()[0].focus()}}},applyCopyEffectivity:function(){let e=this.container.getElements(".item-row"),t=this.collection.rows;e.forEach((e,i)=>{e.getElement("#applicableEvolution").setText(t[i].evolutionEffectivity)})},applySelectedConfiguration:function(e){let t=this.container.getElements(".item-row"),i=e.modelVersionName+": Model Version "+e.modelVersionName+"-"+e.revision+"<";t.forEach(e=>{e.getElement("#applicableEvolution").setText(i)})},resetApplicableEvolution:function(){this.container.getElements(".item-row").forEach(e=>{e.getElement("#applicableEvolution").setText("")})}})}),define("DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWItemCreationModal",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Toggle","DS/Controls/Button","DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWItemCreationModalView","DS/Handlebars/Handlebars4","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/architectureNumber.util","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/UIKIT/Autocomplete","DS/CATFLCockpitWidget/services/model.service","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/components/WIWItemCreationModal/WIWItemCreationModal.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f,h,v){f=JSON.parse(f);return{init:function(e,t,i,n){return this.windowTitle=t.winInfo.title,this.okBtnTxt=t.winInfo.submitBtn,this.action=t.winInfo.action,this.changeControl=t.changecontrol,this.cfgCtxInfo=i,this.duplicateP2LWarningIDs={},this.activeModel=null,this.activeModelVersion=null,this.securityContext=n,this.createModal(e,t),"createLogRefFromDiagram"===this.action&&(this.instanceCount=t.instanceCount,this.previousModelVersion=JSON.parse(localStorage.getItem("flwebcockpit-selectedModelVersion-"+t.SelectionContext.LinkedSystem)),this.cfgCtxInfo.bCopyEff&&this.addCopyEffView(),this.cfgCtxInfo.bApplyConfig&&this.pushSelectModelVerView(t.SelectionContext.LinkedSystem)),this.pushSetArchView(t)},createModal:function(e,i){let n=this,r=a.compile(h),s=!!n.cfgCtxInfo&&n.cfgCtxInfo.bCopyEff,l=!!n.cfgCtxInfo&&n.cfgCtxInfo.bApplyConfig,d=UWA.createElement("div",{html:r({copyEff:s,workUnderEvol:l,workUnderEvolTitle:v.action_apply_evol_eff}),class:"wiw-set-architecture-number"});d.getElement(".table-wrapper").setStyles({"padding-bottom":"20px"}),d.inject(e),n.modalWindow=e;let p=n.modalWindow.getElement(".wiw-footer");if(new o({label:n.okBtnTxt,emphasize:"primary",onClick:function(e){n.architectureIdMap=[];let i,o,r=0,a=[],s=n.modalWindow.getElements(".item-row"),l=null,d=null;t.mask(n.modalWindow);let u={};for(let e=0;e<s.length;e++){let t={},p=s[e];if(!p.getChildren()[0].getAttribute("status")||"ko"===p.getChildren()[0].getAttribute("status")){r++;continue}let g,m=p.getAttribute("data-id");i=p.querySelectorAll('[required = "true"]'),o=!1;for(let e=0;e<i.length;e++){let t=i[e];if("true"===t.getAttribute("editable"))if(""==t.getElement("input").value.trim()){t.getElement("input").scrollIntoView(),t.getElement("input").addClassName("errordiv"),c.alertMessage("error",null,v.req_field_error_header,t.getAttribute("name")+v.arch_number_required_field),o=!0;break}}if(o)break;g=p.getElement(".archidcell")?p.getElement(".archidcell").getHTML():p.querySelector('[architectureidcolumn = "true"]').getElement("input").value.trim();let f=null,h=null,C={};p.getChildren().forEach(function(e){if("true"===e.getAttribute("architectureidcolumn")){if(f=e.getAttribute("id"),"true"===e.getAttribute("editable")){let t=e.getChildren()&&e.getChildren()[0];h=t.dsModel.value}else h=e.getHTML();C[f]=h}}),"createLogRefFromDiagram"===n.action?(m=p.getAttribute("data-id"),u[l=p.getAttribute("data-instance")]=g,d=p.getAttribute("data-type"),t.referenceID=m,t.instanceID=l,t.ArchitectureNumber=g,d&&(t.logicalRefType=d),t.addRefRef=p.getAttribute("addRefRef"),t.ArchitectureNumberTokens=C,n.architectureIdMap.push(t)):"setArcNumPhysical"===n.action&&(a.push(p.getAttribute("data-id")),p.getChildren()[0].hasClassName("archNo-td-checkbox")&&(m=p.getAttribute("data-id"),l=p.getAttribute("data-instance"),n.architectureIdMap.push({referenceID:m,instanceID:l,ArchitectureNumber:g,ArchitectureNumberTokens:C})))}if(r===s.length&&(c.alertMessage("error",null,v.log_ref_selection_error),o=!0),o)t.unmask(n.modalWindow);else if("createLogRefFromDiagram"===n.action)n.createLogRefServiceCall(u);else if("setArcNumPhysical"===n.action){var p={architectureNumbers:n.architectureIdMap};n.callPromiseService(p,a)}}}).inject(p),i.showBulkRecomputation&&"createLogRefFromDiagram"===n.action)new o({label:v.label_reEvaluate_ArchNo,onClick:function(e){u.executeRecompute({isWIWcall:!0,an_action:i.AN_ACTION,rows:n.modalWindow.getElement(".itemDetails").getChildren("tr"),SelectionContext:i.SelectionContext})}}).inject(p);new o({label:v.cancel_button,emphasize:"secondary",onClick:function(e){n.modalWindow.destroy(),window.dscef&&("createLogRefFromDiagram"===n.action?dscef.sendString("createLogicalReferencesFromDiagramCanceledNotif"):"setArcNumPhysical"===n.action&&dscef.sendString("setArchitectureNumberOnPSpoolCanceledNotif"))}}).inject(p);n.modalWindow.addEventListener("close",function(e){window.dscef&&(dscef.sendString("createLogicalReferencesFromDiagramClosedNotif"),"createLogRefFromDiagram"===n.action?dscef.sendString("createLogicalReferencesFromDiagramCanceledNotif"):"setArcNumPhysical"===n.action&&dscef.sendString("setArchitectureNumberOnPSpoolCanceledNotif"))})},createLogRefServiceCall:function(e){(i=this).instanceCount&&i.instanceCount>100&&c.alertMessage("warning",null,v.msg_manyItemsToItemize);var t={},i=this;t.SelectionContext=i.collection.SelectionContext,t.ListSelectedInstances=i.architectureIdMap,t.AN_ACTION=i.collection.AN_ACTION,i.activeModelVersion&&i.activeModelVersion.physicalid?l.applyWorkUnderEvolution({model:i.activeModel,modelVer:i.activeModelVersion},!0).then(function(n){i.callPromiseService(t,e),localStorage.setItem("flwebcockpit-selectedModelVersion-"+i.collection.SelectionContext.LinkedSystem,JSON.stringify({modelVersion:i.activeModelVersion.physicalid}))}):i.callPromiseService(t,e)},callPromiseService:function(e,t){if("createLogRefFromDiagram"===this.action){var i=[];for(var n in this.duplicateP2LWarningIDs){this.duplicateP2LWarningIDs[n]===t[n]&&i.push(n)}e.ignoreP2LWarningIDs=i,this.duplicateP2LWarningIDs={},this.changeControl&&d.setAuthIDforWIW("change",this.changeControl),s.createItemFromDialogue(e,0,this.securityContext).then(this.createFromDiagramServiceCallback.bind(this,t),this.serviceCallFailureFunction.bind(this))}else"setArcNumPhysical"===this.action&&(this.removeCSS(t),s.setArchitectureNumberOnPSpool(e,0,this.securityContext).then(this.setArchitectureNumberOnPSpoolServiceCallback.bind(this),this.serviceCallFailureFunction.bind(this)))},setArchitectureNumberOnPSpoolServiceCallback:function(e){var i=JSON.parse(e);if(200===i.status){c.alertMessage("success",null,"",v.msg_set_arch_num_onP),this.modalWindow.destroy();var n={status:200,ModifiedPReferences:[]};for(var o in i)1==i[o]&&n.ModifiedPReferences.push(o);window.dscef&&dscef.sendString("setArchitectureNumberOnPSpoolEndNotif",JSON.stringify(n))}else if(400===i.status){var r,a=null,s=this.modalWindow.getElement(".itemDetails").getElements("tr"),l=[],d=[];s.forEach(function(e){var t=e.getAttribute("data-id");"NOCSGROUP"==i[t]||"FROZEN_REV"==i[t]||"NO_MODIFY_ACCESS"==i[t]?l.push(t):"KO"!=i[t]&&"UNICITY_KO"!=i[t]||d.push(t)}),l.length>0?(a="errordiv",this.setCSS(l,a),r={type:"error",message:v.msg_error_set_architecture_number_unselect_reference}):d.length>0?(a="errordiv",this.setCSS(d,a),r={type:"error",message:v.arch_number_unique_error}):r={type:"error",message:v.msg_set_arch_num_failed},r&&(t.unmask(this.modalWindow),c.alertMessage(r.type,null,"",r.message))}},setCSS:function(e,t){var i=this;e.forEach(function(e){var n=i.modalWindow.getElement('.itemDetails tr[data-id ="'+e+'"]'),o=n.getElement(".archidcell");if(t)if(o)o.addClassName(t),o.setStyle("color","#EA4F37"),o.scrollIntoView();else{var r=n.querySelector('[architectureidcolumn = "true"]');o.addClassName(t),r.getElement("input").setStyle("color","#EA4F37"),r.getElement("input").scrollIntoView()}else{if(!o)o=(r=n.querySelector('[architectureidcolumn = "true"]')).getElement("input");o.hasClassName("errordiv")&&o.setStyle("color","hsl(0, 0%, 0%)")}})},removeCSS:function(){for(var e=this.modalWindow.getElement(".itemDetails").getElements("tr"),t=0;t<e.length;t++)for(var i=0;i<e[t].getChildren().length;i++)e[t].getChildren()[i].hasClassName("archidcell errordiv")&&(e[t].getChildren()[i].removeClassName("errordiv"),e[t].getChildren()[i].setStyle("color","hsl(0, 0%, 0%)"))},createFromDiagramServiceCallback:function(e,i){var n=JSON.parse(i),o=this;if(200===n.status)if(o.copyEffToggle&&o.copyEffToggle.checkFlag){let e=Object.keys(o.cfgCtxInfo.mapIdToItemModel),t=[],i={},r=[];e.forEach(function(e){t.push({pid:e})}),m.getEffectivityInfo(o.cfgCtxInfo.instIds,"XML").then(function(e){let a=e;if(a){for(let e in a){let t=[],n=a[e];if("YES"===n.hasEffectivity){let o=n.content.Evolution&&n.content.Evolution.Current?n.content.Evolution.Current:null;o&&t.push({domain:"Evolution",content:o}),i[e]=t}}n.ImplementLinks.forEach(function(e){i[e.discipline.instanceID]&&r.push({pid:e.item.instanceID,expressions:i[e.discipline.instanceID]})}),r&&r.length>0?m.setMultipleFilterableObjectInfo(r,t).then(function(){c.alertMessage("success",null,"",v.create_log_ref_from_dialog_success),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n))},function(e){c.displayError(e,null,null,v.msg_error_wiw_copy_eff_failed),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n))}):(c.alertMessage("success",null,"",v.create_log_ref_from_dialog_success),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n)))}else c.alertMessage("success",null,"",v.create_log_ref_from_dialog_success),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n))})}else c.alertMessage("success",null,"",v.create_log_ref_from_dialog_success),o.modalWindow.destroy(),window.dscef&&dscef.sendString("createLogicalReferencesFromDiagramEndNotif",JSON.stringify(n));else if(400===n.status){var r=o.modalWindow.getElement(".itemDetails").getElements("tr"),a=!1,s=!1,l=!1,d=null,u=null;r.forEach(function(t){var i=t.getAttribute("data-instance");"NON_COMPLIANCE"===n[i]?(u=!0,d="#EA4F37"):"NOCSGROUP"==n[i]?(l=!0,d="#844138"):"UNICITY_KO"==n[i]?(a=!0,d="#EA4F37"):"P2L_DUPLICATE_WARNING"==n[i]?(o.duplicateP2LWarningIDs[i]=e[i],s=!0,d="#E87B00"):d=null;var r=t.getElement(".archidcell");if(d){if(r)r.addClassName("errordiv"),r.setStyle("color",d),r.scrollIntoView();else(c=t.querySelector('[architectureidcolumn = "true"]')).getElement("input").setStyle("color",d),c.getElement("input").scrollIntoView()}else{var c;if(!r)r=(c=t.querySelector('[architectureidcolumn = "true"]')).getElement("input");r.setStyle("color","hsl(0, 0%, 0%)")}}),u?(t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.msg_arch_number_non_compliance)):l?(t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.msg_error_set_architecture_number_nocsgroup)):a?(t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.arch_number_unique_error)):s?(t.unmask(o.modalWindow),c.alertMessage("warning",null,"",v.msg_error_create_fromDiagram_p2lwarning)):c.alertMessage("error",null,"",v.msg_set_arch_num_failed)}else t.unmask(o.modalWindow),c.alertMessage("error",null,"",v.instance_creation_failed)},serviceCallFailureFunction:function(e){window.dscef&&(e.error&&e.error.message&&e.error.message.contains("timedout")?dscef.sendString("createLogicalReferencesFromDiagramRequestTimedoutNotif"):dscef.sendString("createLogicalReferencesFromDiagramRequestFailedNotif"));var i="";e.errorResp&&e.errorResp.message?i=e.errorResp.message:e.error&&e.error.message?i=e.error.message:e.message&&(i=e.message),t.unmask(this.modalWindow),c.alertMessage("error",null,"",i)},addCopyEffView:function(){var e=this,t=e.modalWindow.getElement(".copy-effectivity");e.copyEffToggle=new n({type:"switch",label:v.action_copy_effectivity,checkFlag:!0}).inject(t),e.copyEffToggle.addEventListener("change",function(t){let i=e.modVerAutoComplete.isDisabled();e.copyEffToggle.checkFlag?(!i&&e.modVerAutoComplete.setDisabled(!0),e.modVerAutoComplete.unselectAll(),e.activeModelVersion=null,d.setAuthIDforWIW("evolution",null),e._WIWItemCreationModalView.applyCopyEffectivity()):(i&&e.modVerAutoComplete.setDisabled(!1),e._WIWItemCreationModalView.resetApplicableEvolution())})},pushSelectModelVerView:function(e){var t=this;let i=t.cfgCtxInfo.itemModels;t.cfgCtxInfo.mapIdToItemModel={};var n=t.modalWindow.getElement(".config-selection").getElement(".autoCompleteSection");t.modVerAutoComplete=new g({showSuggestsOnFocus:!0,placeholder:v.ph_header_config_modver,disabled:t.cfgCtxInfo.bCopyEff,events:{onSelect:function(e){let i=t.cfgCtxInfo.mapIdToItemModel[e.model];t.activeModel={physicalid:i.physicalid,name:i.name},t.activeModelVersion={physicalid:e.physicalid?e.physicalid:e.modelVersionID,name:e.name?e.name:e.modelVersionName,revision:e.revision,backEndName:e.backEndName},t._WIWItemCreationModalView.applySelectedConfiguration(e)},onUnselect:function(){this.selectedItems&&0===this.selectedItems.length&&(t.activeModel=null,t.activeModelVersion=null,d.setAuthIDforWIW("evolution",null),t._WIWItemCreationModalView.resetApplicableEvolution())}}});let o=[],r=[];i.forEach(e=>{r.push(e.physicalid),t.cfgCtxInfo.mapIdToItemModel[e.physicalid]=e,o.push(m.getModelVersionFromModelPID(e))}),Promise.all(o).then(function(e){let i=[],o=[];e.forEach((e,t)=>{let n=r[t];e.forEach(e=>{o.indexOf(e.id)<0&&i.push({modelVersionID:e.id,modelVersionName:e.attributes.MarketingName,revision:e.revision,value:e.attributes.MarketingName+" "+e.revision,subLabel:e.current_NLS,backEndName:e.name,model:n})})}),t.modVerAutoComplete.addDataset({name:"model_version_select_data",items:i}),!t.cfgCtxInfo.bCopyEff&&t.previousModelVersion&&t.previousModelVersion.modelVersion&&t._retrieveModelVersionFromDataset(t.previousModelVersion.modelVersion),t.modVerAutoComplete.inject(n)})},pushSetArchView:function(e){return this.collection=e,this._WIWItemCreationModalView=new r({collection:e,cfgCtxInfo:this.cfgCtxInfo}),this._WIWItemCreationModalView.render(this.modalWindow),this.modalWindow},_retrieveModelVersionFromDataset:function(e){var t=this;e&&e.indexOf("pid")>=0&&(e=e.substring(4)),t.modVerAutoComplete.datasets.forEach(function(i){i.items.forEach(function(i){if(i.modelVersionID.indexOf("pid")>=0&&(i.modelVersionID=i.modelVersionID.substring(4)),i.modelVersionID===e)return t.modVerAutoComplete.onSelect(i),void t.modVerAutoComplete.dispatchEvent("onSelect",[i])})})}}}),define("DS/CATFLCockpitWidget/components/SpaceAssignment/Copy/SpaceAssignmentCopy",["DS/Windows/Dialog","DS/Controls/Button","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/space.service","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l){return{open:function(e,t){this.item=e,this.treeDocument=t,this.treeDocument.getSelectedNodes()[0].unselect(),this.tokenPostAdd=t.getXSO().onPostAdd(this._onXSOChanged.bind(this,e,t)),this.tokenPostRemove=t.getXSO().onPostRemove(this._onXSOChanged.bind(this,e,t)),o.alertMessage("success",null,l.msg_copy_space_success)},validateAndSubmit:function(){var e=this;if(void 0!==e.selectedNodes&&0!==e.selectedNodes.length){var t="";a.checkToUpdateSpace(e.selectedNodes).then(function(i){if(e.selectedNodes.forEach(function(e){"WARNING_PILOTDISC"==i[e.options.physicalid]&&(t+=e.options.label+"<br>")}),e._cleanAndDestroy(),""!==t){var n=UWA.createElement("div",{html:l.msg_has_piloting_discipline_list+"<br>"+t,styles:{"min-height":"100px","max-height":"210px","overflow-y":"auto"}});s.createWindow(widget.body,l.label_confirm_warn_piloting_header,n,l.label_confrim_warn_piloting_button,function(){e._submit()})}else e._submit()},function(t){e._cleanAndDestroy(),o.displayError(t,null,null,l.msg_generic_error_get_failed)})}else e._cleanAndDestroy()},_submit:function(){var e=this,t=[];e.item.options.assignedSpacesPID&&e.item.options.assignedSpacesPID.length>0&&e.item.options.assignedSpacesPID.forEach(function(e){t.push({options:{physicalid:e.obj}})});var i,a=[],s=[];if(e.selectedNodes.forEach(function(e){var t=e.options.assignedSpacesPID;if(t&&t.length>0)for(var i=0;i<t.length;i++)a.push(t[i].owner),s.push(e)}),0===a.length){if(0==t.length)return void o.displayError("error",null,l.msg_error_no_space_assigned_src_dest);i=Promise.resolve()}else i=r.deleteSPPConnection(a,s);i.then(function(){(t.length>0?i.then(function(){return r.createSPPConnection(e.selectedNodes,t)}):Promise.resolve()).then(function(){n.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-spaces-by-id",data:e.selectedNodes})})})},_onXSOChanged:function(e,t){this.selectedNodes=t.getSelectedNodes().filter(function(t){return t.options.physicalid!==e.options.physicalid})},_cleanAndDestroy:function(){this.treeDocument.getXSO().unsubscribe(this.tokenPostAdd),this.treeDocument.getXSO().unsubscribe(this.tokenPostRemove)}}}),define("DS/CATFLCockpitWidget/components/ArchitectureNumber/checkArchitectureNumberUnicity",["UWA/Core","DS/Controls/Loader","DS/Controls/ModalContainer","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/pno.util","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/Controls/Button","DS/Controls/Accordeon","DS/Controls/Label","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/utils/checkArchitectureNumberUnicity.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f,h,v,C,b){"use strict";var y=r.getFullConfig(),_=function(e){this.refWithConfig=e.refWithConfig,this.nodesToCheck=e.nodesToCheck,this.dialog=null,this.gridView=null,this.multiModels=!1;var n=new t({text:b.msg_loading});i.createModal(widget.body,n.elements.container),n.on(),this._createCheckANUnicityComponent().then(function(){n.off(),i.removeModal(widget.body)})};return _.prototype._createModalArchitectureNumberUnicity=function(){var t=this,i=new s({title:b.action_architecture_number_unicity_effectivity,height:700,width:1400,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,visibleFlag:!1});i.addEventListener("close",function(){i.destroy(),t.gridView&&t.gridView.destroy()});var n=e.createElement("div",{class:"container-unicity-AN"});return i.elements._contentDiv.appendChild(n),i},_.prototype._displayModalArchitectureNumberUnicity=function(){this.dialog&&!this.dialog.visibleFlag&&(this.dialog.visibleFlag=!0)},_.prototype._createCheckANUnicityComponent=function(){var e=this;return v.getConfigContextInfo([e.refWithConfig.options.physicalid]).then(function(i){i?(e.configCtxResp=i,i.contextInfo&&i.contextInfo.length>0?(e.dialog=e._createModalArchitectureNumberUnicity(),e.loader=new t({text:b.msg_loading}),i.contextInfo.length>1?(e.multiModels=!0,e._displayModalArchitectureNumberUnicity(),e._manageComponentForMoreThanOneModel(i)):e._manageComponentForOneModel(i)):n.alertMessage("error",null,b.error_no_model_attached)):n.alertMessage("error",null,b.error_info_models)})},_.prototype._manageComponentForOneModel=function(e){var t=e.contextInfo[0].content&&e.contextInfo[0].content.results&&e.contextInfo[0].content.results.length>0?e.contextInfo[0].content.results[0]:null,i="",n="";t.data&&t.data.length>0&&t.data[0]&&t.data[0].value&&t.data[0].value.length>0&&t.data[0].value[0]&&"Marketing Name"==t.data[0].name&&(n=t.data[0].value[0]),t.basicData.forEach((e,t)=>{"name"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(i=e.value[0])});var o={physicalid:t.physicalID,name:i,title:n};this._manageCheckANUnicityForModel(o)},_.prototype._manageComponentForMoreThanOneModel=function(e){var t=this;t.tilecollectionOfModels=t.displayModelListChoice(e.contextInfo,t.dialog.elements._contentDiv.getElementsByClassName("container-unicity-AN")[0]),t.tilecollectionOfModels.onSelectionAdd(function(){t.dialog.buttons.Ok.disabled=!1}),t.dialog.title=b.action_architecture_number_unicity_effectivity+" - "+t.refWithConfig.options.label+" - "+b.label_select_model,t.dialog.buttons={Ok:new g({label:b.label_next,emphasize:"primary",onClick:function(){if(t.tilecollectionOfModels&&t.tilecollectionOfModels.TreedocModel&&t.tilecollectionOfModels.TreedocModel.getSelectedNodes().length>0){t.dialog.buttons.Ok.disabled=!0;var e=t.tilecollectionOfModels.TreedocModel.getSelectedNodes()[0].options.dataModel;t._manageCheckANUnicityForModel(e)}},disabled:!0}),Cancel:new g({emphasize:"secondary",onClick:function(){t.dialog.close()}})}},_.prototype.displayDuplicatedArchitectureNumbers=function(t,i,n){var o=[{text:b.label_title,dataIndex:"tree",editableFlag:!1,sortableFlag:!0,alwaysVisibleFlag:!0,pinned:"left"},{dataIndex:"revision",text:y.nlsBasicAttributesBO["ds6wg:revision"],textExport:y.nlsBasicAttributesBO["ds6wg:revision"],visibleFlag:!0,editableFlag:!1,pinned:"left",width:90},{icon:{iconName:"object-instance"},dataIndex:"instanceName",text:y.nlsBasicAttributesBO["ds6w:label"],textExport:b.label_title_instance,visibleFlag:!0,editableFlag:!1},{text:b.label_an_valid,dataIndex:"isANValid",typeRepresentation:"boolean",width:80,getCellClassName:function(e){return e&&e.nodeModel?!0===e.nodeModel.options.grid.isANValid?"sax-is-valid-AN-true":"sax-is-valid-AN-false":null},getCellTooltip:function(e){var t="";if(e&&e.nodeModel){var i=e.nodeModel.options.grid.isANValid;void 0!==i&&(t=!0===i?b.label_valid:b.label_invalid)}return{getAllInformationCB:()=>({model:{shortHelp:t}})}},alwaysVisibleFlag:!0},{text:b.label_intersection_effectivity,dataIndex:"intersectionEffectivity",typeRepresentation:"string",alwaysVisibleFlag:!0},{text:b.label_current_evolution,dataIndex:"effCurrentEvol",alwaysVisibleFlag:!0,sortableFlag:!1,editableFlag:!1}];n&&o.push({text:b.label_variant_option,dataIndex:"effVariant",alwaysVisibleFlag:!0,sortableFlag:!1,editableFlag:!1});var r=new d({identifier:"grid-view-unicity-AN-effectivity",height:"inherit",treeDocument:new l({useAsyncPreExpand:!0}),columns:o,rowSelection:"none",defaultColumnDef:{width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t}}),a={label:{filterId:"stringRegexp"},isANValid:{filterId:"set",filterModel:[]}};n?C.registerFilterForArraysValues(r.treeDocument):a.intersectionEffectivity={filterId:"stringRegexp"},r.treeDocument.setFilterModel(a),r.treeDocument.empty();var s=[];return Object.values(t)&&Object.values(t).length>0&&Object.values(t).forEach((e,t)=>{s=s.concat(Object.keys(e))}),C.updateDisplayedEffectivityForNodes(s).then(function(n){var o=n,a=e.createElement("div",{class:"container-checkAN-gridView"});for(var s in i.appendChild(a),a.appendChild(r.getContent()),r.treeDocument.prepareUpdate(),t){var l=new c({label:s,icons:["progress-3"]});for(var d in t[s]){var u={isANValid:!(t[s][d].intersectionEffectivity.length>0),intersectionEffectivity:t[s][d].intersectionEffectivity.map(function(e){var t=e.productConfiguration?"-"+e.productConfiguration.marketingName:"";return e.modelversion.displayValue+"-"+e.modelversion.revision+t}),effCurrentEvol:o[d]?o[d].evolution:t[s][d].nodeInstance.options.grid.CurrentEvolutionEffectivity,effVariant:o[d]?o[d].variant:t[s][d].nodeInstance.options.grid.VariantEffectivity};u=e.merge(u,t[s][d].nodeInstance.options.grid);var p=new c({label:t[s][d].nodeInstance.options.label,icons:t[s][d].nodeInstance.options.icons,grid:u});l.addChild(p)}r.treeDocument.addRoot(l)}return r.treeDocument.expandAll(),r.treeDocument.pushUpdate(),r})},_.prototype._createMessageContentInDialog=function(t){var i=e.createElement("div",{class:"dialogMessage",html:t}),n=this.dialog.elements._contentDiv.getElementsByClassName("container-unicity-AN")[0];n.empty(),n.appendChild(i)},_.prototype._manageCheckANUnicityForModel=function(e){var t=this,o=C.getInstancesWithDuplicatedAN(t.nodesToCheck);if(o&&o.length>0)return t.loader.visibleFlag||(i.createModal(t.dialog.elements.container,t.loader.elements.container),t.loader.on()),v.getMVandPCinformationFromModel(e).then(function(e){if(e.modelversions.filter(e=>e.productConfigurations.length>0&&e.productConfigurations.filter(e=>e.attributes.FilterCompiledForm).length>0).length>0){var n=JSON.parse(localStorage.getItem(y.localStorageKeys.selectedPCcheckAN||null));t.manageCheckANForProductConfig(e,n),t.loader.visibleFlag&&(t.loader.off(),i.removeModal(t.dialog.elements.container))}else t.manageCheckANForEvolution(e)}).catch(function(o){o&&"No_ModelVersions"===o.message?n.alertMessage("error",null,b.replace(b.msg_no_modelVersions,{modelName:e.title})):n.alertMessage("error",null,b.msg_error_an_unicity_configuration),t.loader.visibleFlag&&(t.loader.off(),i.removeModal(t.dialog.elements.container)),t.multiModels||t.dialog.close()});var r="";return r=o?b.msg_no_an_duplication:b.msg_an_not_assigned,t._displayModalArchitectureNumberUnicity(),t.dialog.title=b.action_architecture_number_unicity_effectivity+" - "+e.title,t._createMessageContentInDialog(r),t.dialog.buttons={Close:new g({emphasize:"secondary",onClick:function(){t.dialog.close()}})},t.multiModels&&(t.dialog.buttons.Reset=new g({label:b.action_previous,emphasize:"secondary",onClick:function(){t._manageComponentForMoreThanOneModel(t.configCtxResp)}}),t.dialog._applyButtons()),Promise.resolve()},_.prototype.displayModelListChoice=function(e,t){var i=new l,n=new h({selectionBehavior:{canMultiSelect:!1,toggle:!1,unselectAllOnEmptyArea:!1}}).inject(t);return e.forEach((e,t)=>{var n=e.content&&e.content.results&&e.content.results.length>0?e.content.results[0]:null;if(n){var o="",a="",s="",l="",d=r.getServiceURL("3DSpace")+"/common/images/I_Model_Thumbnail.png";n.data&&n.data.length>0&&n.data[0]&&n.data[0].value&&n.data[0].value.length>0&&n.data[0].value[0]&&"Marketing Name"==n.data[0].name&&(o=n.data[0].value[0]),n.basicData.forEach((e,t)=>{"name"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(a=e.value[0]),"owner"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(s=e.value[0]),"current"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(l=e.value[0])});var u=new c({label:o,thumbnail:n.preview_url&&""!==n.preview_url?n.preview_url:d,subLabel:a+" | "+s,description:b.label_maturity+" : "+l,dataModel:{physicalid:n.physicalID,name:a,title:o}});i.addRoot(u)}}),n.loadApplicativeModel(i),n},_.prototype.exportCSV=function(e,t,i){var o=this.gridView.treeDocument,a=[{text:b.label_arch_no,dataIndex:"architectureNo"}];this.gridView.columns.forEach((e,t)=>{a.push({text:e.textExport?e.textExport:e.text,dataIndex:e.dataIndex})});var s=new d({treeDocument:new l({useAsyncPreExpand:!0}),columns:a,defaultColumnDef:{width:"auto"}});s.treeDocument.empty(),s.treeDocument.prepareUpdate(),o&&o.getChildren()&&o.getChildren().forEach((e,t)=>{var i=new c({label:"",grid:{architectureNo:e.options.label}});s.treeDocument.addChild(i),e.getChildren().forEach((e,t)=>{var i=new c({label:e.options.label,grid:{...e.options.grid,...{intersectionEffectivity:e.options.grid.intersectionEffectivity.join(","),isANValid:e.options.grid.isANValid?b.label_valid:b.label_invalid}}});s.treeDocument.addChild(i)})}),s.treeDocument.expandAll(),s.treeDocument.pushUpdate();var u=s.getAsCSV(),p=this.refWithConfig.options.label+"_"+e.title+"_"+(t?b.title_export_an_unicity_variant:b.title_export_an_unicity_evolution)+".csv",g=new Date,m=r.getUser("isFullName"),f=b.label_none;widget.getValue("ngFilter")?f=JSON.parse(widget.getValue("ngFilter")).filterTitle:widget.getValue("currentConfig")&&(f=widget.getValue("currentConfig").modelVersion.name+" "+widget.getValue("currentConfig").modelVersion.revision+" "+widget.getValue("currentConfig").pc.label);var h="";t&&i.forEach((e,t)=>{h=h+e.modelversion.displayValue+"-"+e.modelversion.revision+"-"+e.productConfiguration.marketingName+"; "}),u=(t?b.action_architecture_number_unicity_product_congiguration:b.action_architecture_number_unicity_evolution)+"\n"+b.label_filename+","+p+"\n"+b.label_export_datetime_utcformat+","+g+"\n"+b.label_exported_by+","+m+"\n"+b.label_applied_product_configuration+","+f+"\n"+(t?b.label_PC_selected+","+h:"")+"\n\n\n"+u,n.downloadFile(p,u,!0),n.alertMessage("success",null,b.msg_an_unicity_on_effectivity_export_success)},_.prototype.displayProductConfigChoices=function(t,i,n){var o=[{text:b.label_title,dataIndex:"tree",editableFlag:!1,sortableFlag:!0,alwaysVisibleFlag:!0,pinned:"left"},{text:b.label_name,dataIndex:"name",typeRepresentation:"string",alwaysVisibleFlag:!0},{text:b.label_owner,dataIndex:"owner",typeRepresentation:"string",alwaysVisibleFlag:!0},{text:b.label_maturity,dataIndex:"maturity",typeRepresentation:"string",alwaysVisibleFlag:!0},{text:b.label_description,dataIndex:"description",typeRepresentation:"string"}],r=new d({identifier:"grid-view-pc-choices",height:"inherit",treeDocument:new l({useAsyncPreExpand:!0,shouldBeSelected:function(e){return!!e.options.pcInfo}}),columns:o,rowSelection:"multiple",defaultColumnDef:{width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{insertRow:!1,expandCollapse:!0,pin:!0,firstColumnsVisibility:!1,columnsManagement:!1})),t}});r.treeDocument.setFilterModel({label:{filterId:"stringRegexp"},name:{filterId:"stringRegexp"},description:{filterId:"stringRegexp"},owner:{filterId:"stringRegexp"},maturity:{filterId:"set"}}),r.treeDocument.empty();var s=e.createElement("div",{class:"container-checkAN-gridView"});return i.appendChild(s),s.appendChild(r.getContent()),r.treeDocument.prepareUpdate(),t.modelversions.forEach(function(e,t){var i=new c({label:e.modelversion.displayValue+"-"+e.modelversion.revision}),n=!1;e.productConfigurations.forEach(function(t,o){if(t.attributes.FilterCompiledForm){n=!0;var r=t.basics?t.basics.owner:"",a=new c({label:t.marketingName,pcInfo:t,mvInfo:e.modelversion,grid:{name:t.name,owner:r,maturity:t.basics?t.basics.current:"",description:t.basics?t.basics.description:""}});i.addChild(a)}}),n&&r.treeDocument.addRoot(i)}),r.treeDocument.expandAll(),r.treeDocument.pushUpdate(),r.treeDocument.withTransactionUpdate(function(){r.treeDocument.getAllDescendants().forEach((e,t)=>{var i=e.options.grid.owner;i&&a.getFullName(i).then(function(t){t&&e.setAttribute("owner",t)}),n&&e.options.pcInfo&&-1!==n.indexOf(e.options.pcInfo.id)&&e.select()})}),r},_.prototype.manageDisplayCheckANResults=function(t,i,o,r){var a=this;a._displayModalArchitectureNumberUnicity();var s=o?b.action_architecture_number_unicity_product_congiguration:b.action_architecture_number_unicity_evolution;if(a.dialog.title=s+" - "+a.refWithConfig.options.label+" - "+i.title,0!==Object.keys(t).length){a.dialog.buttons={SaveAll:new g({label:b.action_export,emphasize:"primary",onClick:function(){a.exportCSV(i,o,r)}}),Close:new g({emphasize:"secondary",onClick:function(){a.dialog.close()}})},a.dialog._applyButtons();var l=a.dialog.elements._contentDiv.getElementsByClassName("container-unicity-AN")[0];if(l.empty(),o){var c=e.createElement("div",{class:"container-checkAN-selection-PC"});l.appendChild(c),a.filterListPC=[];var d=new e.Element("div");r.forEach((e,t)=>{let i=new f({value:e.modelversion.displayValue+"-"+e.modelversion.revision+"-"+e.productConfiguration.marketingName,emphasize:"secondary"});i.inject(d),i.addEventListener("click",function(e){"secondary"===i.emphasize?(i.emphasize="primary",a.filterListPC.push(i.value)):(i.emphasize="secondary",a.filterListPC=a.filterListPC.filter(e=>e!==i.value)),a.manageFilterSelectionPC(a.filterListPC)})}),new m({items:[{header:b.label_PC_selected,content:d}],style:"filled-group"}).inject(c)}return a.displayDuplicatedArchitectureNumbers(t,l,o).then(function(e){a.gridView=e}).catch(function(e){n.alertMessage("error",null,b.msg_error_an_unicity_update_evolution),a.multiModels||o||a.dialog.close()})}return a._createMessageContentInDialog(b.msg_no_an_duplication),a.dialog.buttons={Close:new g({emphasize:"secondary",onClick:function(){a.dialog.close()}})},Promise.resolve()},_.prototype.manageFilterSelectionPC=function(e){if(this.gridView){let t=this.gridView.getTreeDocument().getFilterManager(),i={};e.length>0&&(i={selectedValues:e}),t.setPropertyFilterModel("intersectionEffectivity",{filterId:"stringArray",filterModel:i})}},_.prototype.manageCheckANForProductConfig=function(t,o){var r=this;r._displayModalArchitectureNumberUnicity(),r.dialog.title=b.action_architecture_number_unicity_effectivity+" - "+r.refWithConfig.options.label;var a=r.dialog.elements._contentDiv.getElementsByClassName("container-unicity-AN")[0];a.empty();var s=e.createElement("div",{class:"container-checkAN-info-selectPC",html:b.label_info_select_PC});a.appendChild(s),r.gridView=r.displayProductConfigChoices(t,a,o),r.dialog.buttons={SaveAll:new g({label:b.label_next,emphasize:"primary",onClick:function(){var e=r.gridView.treeDocument.getSelectedNodes();if(e.length>0){var o=e.map(function(e){return{productConfiguration:e.options.pcInfo,modelversion:e.options.mvInfo}}),a=e.map(function(e){return e.options.pcInfo.id});localStorage.setItem(y.localStorageKeys.selectedPCcheckAN,JSON.stringify(a)),r.loader.visibleFlag||(i.createModal(r.dialog.elements.container,r.loader.elements.container),r.loader.on()),C.checkANOnVariant(r.nodesToCheck,o).then(function(e){r.manageDisplayCheckANResults(e,t.model,!0,o).then(function(){r.loader.visibleFlag&&(r.loader.off(),i.removeModal(r.dialog.elements.container))}),r.dialog.buttons.Reset=new g({label:b.action_previous,emphasize:"secondary",onClick:function(){r.manageCheckANForProductConfig(t,a)}}),r.dialog._applyButtons()}).catch(function(e){r.loader.visibleFlag&&(r.loader.off(),i.removeModal(r.dialog.elements.container)),n.alertMessage("error",null,b.msg_error_an_unicity_variant)})}else localStorage.setItem(y.localStorageKeys.selectedPCcheckAN,null),r.manageCheckANForEvolution(t,!0)}}),Cancel:new g({emphasize:"secondary",onClick:function(){r.dialog.close()}})},r.multiModels&&(r.dialog.buttons.Reset=new g({label:b.action_previous,emphasize:"secondary",onClick:function(){r._manageComponentForMoreThanOneModel(r.configCtxResp)}})),r.dialog._applyButtons()},_.prototype.manageCheckANForEvolution=function(e,t){var o=this,r=e.modelversions.map(e=>e.modelversion);C.checkANOnEvolution(o.nodesToCheck,r,e.model).then(function(n){o.manageDisplayCheckANResults(n,e.model,!1).then(function(){o.loader.visibleFlag&&(o.loader.off(),i.removeModal(o.dialog.elements.container))}),t?(o.dialog.buttons.Reset=new g({label:b.action_previous,emphasize:"secondary",onClick:function(){o.manageCheckANForProductConfig(e)}}),o.dialog._applyButtons()):o.multiModels&&(o.dialog.buttons.Reset=new g({label:b.action_previous,emphasize:"secondary",onClick:function(){o._manageComponentForMoreThanOneModel(o.configCtxResp)}}),o.dialog._applyButtons())}).catch(function(e){n.alertMessage("error",null,b.msg_error_an_unicity_evolution),o.loader.visibleFlag&&(o.loader.off(),i.removeModal(o.dialog.elements.container)),o.multiModels||o.dialog.close()})},_}),define("DS/CATFLCockpitWidget/components/ArchitectureNumber/monoInstantiationStatus",["DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/config.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n){"use strict";var o=i.getFullConfig();return{downloadStatus:function(i,r,a){this.root={id:i},this.container=widget.body;var s=r+"_ArchitectureNumberUnicityInStructure.csv",l={root_physicalid:this.root.id,exportFileName:s};if(a&&a.modelVersion&&a.modelVersion.physicalid){var c=widget.getValue("currentConfig").filterCompiledForm,d=a.modelVersion.name+" "+a.modelVersion.revision;a.pc&&a.pc.physicalid&&(d=d+" "+a.pc.label),l.configFilteringContext={filter_compiledform:c,filter_info:d}}t.post(o.webservices.exportMonoInstantiationStatus,JSON.stringify(l),0).then(function(t){e.downloadFile(s,t,!0),e.alertMessage("success",null,n.msg_arch_unicity_export_success)}).catch(function(t){t&&t.errorResp&&e.alertMessage("error",null,t.errorResp.message)})}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.replace",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/model.events.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s){"use strict";var l=i.getFullConfig().identifiers,c=i.getFullConfig().localStorageKeys;return{replaceByExisting:function(e,t,i,o,r){var a,c=this.replaceByExistingCallback.bind(this,e,t,i,o,r);a=l.type_act_logref,n.launchSearch({searchTitle:s.label_search_logref,allowedTypes:a,role:"",criteria:a,bMultiSel:!1,in_apps_callback:c})},replaceByExistingCallback:function(n,o,l,d,u,p){var g=u.getContent();e.mask(g,s.msg_processing),p&&1===p.length?r.replaceWithExistingRef(n,o,p[0].id?p[0].id:p[0].objectId,"otherReference").then(function(o){e.unmask(g);var r=o.member?o.member[0]:null,l=[],p={};if(r){i.SAXStorage().setItem(c.recentlyAuthoredStructure+n,Date.now());var m=d.options.instance.physicalid,f=u.treeDocument.getMappedNodesFromId(d.options.physicalid);f||(f=[d]);for(var h=f.length-1;h>=0;h--){var v=f[h];v.options.instance.physicalid===m&&(u.treeDocument.removeFromMappedNodes(v),v.removeChildren(),v.collapse(),v.updateOptions({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,configContexts:void 0,physicalid:r.reference,instance:{physicalid:r.id},grid:{instanceName:r.name,physicalid:r.reference,configCtx:void 0}}),v.setRelationID(r.id),u.treeDocument.addToMappedNodes(v))}l.push(r.reference),p[r.id]=d,a.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:l,tagAsRecentlyAuthored:!1}}),a.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-inst-by-id",data:{instIdMap:p,bInstance:!0,bEffectivity:!0}})}t.alertMessage("success",null,s.msg_replace_success)}).catch(function(i){e.unmask(g),t.displayError(i,null,null,s.error_repl_failed)}):t.alertMessage("error",null,s.msg_select_single_Logical)}}}),define("DS/CATFLCockpitWidget/components/VersionExplorer/versionexplorer.controller",["UWA/Core","DS/UIKIT/Mask","DS/UIKIT/Input/Toggle","DS/ENOFloatingPanel/ENOFloatingPanel","DS/ENOXVersionExplorerController/VersionExplorerController","DS/ENOXVersionExplorerUtils/VersionExplorerEnums","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/model.service","DS/ApplicationFrame/ActionBar","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f,h){"use strict";m=JSON.parse(m);var v=JSON.parse(f);return new g({context:{displayNotification:function(e){"error"===e.eventID?l.alertMessage("error",null,e.msg):"warning"===e.eventID?l.alertMessage("warning",null,e.msg):l.alertMessage("success",null,e.msg)}},file:"CATFLCockpitWidgetAFR.xml",module:"CATFLCockpitWidget"}),{initializeVersionExplorer:function(t){var i=e.createElement("div",{class:"arch-version-expl-content"});if(widget.getValue("currentConfig")){var r=e.createElement("div",{class:"evolution-view-content"}).inject(i);this.createEvolutionView(r)}var a=e.createElement("div",{class:"version-expl-content"}).inject(i),s=e.merge(t,{className:"fl-cockpit-version-expl",body:i,closable:!0,animate:!0,resizable:!0,autocenter:!0,visible:!0,limitParent:!0,overlay:!0,title:h.revision_explorer,events:{onClose:function(){}}});return this._verExplDlg=new n(s),this._verExplDlg.onClose=this.onVersionExplClose.bind(this),this.versionGraphComponent=new o({versionGraphContainer:a,widget:widget}),this.callBackOnVersionCreation=t.versionCreationCallBack?t.versionCreationCallBack:null,this.versionGraphComponent.subscribeEvent("ENOXVersionExplorerOpenVersion",this.openVersion.bind(this,t.modelKey.isReplaceCall?t.modelKey.isReplaceCall:null)),this.versionGraphComponent.subscribeEvent("ENOXVersionExplorerNewVersionCreated",this.onNewVersionCreation.bind(this)),this.versionGraphComponent},onNewVersionCreation:function(e){this.callBackOnVersionCreation&&this.callBackOnVersionCreation(),s.SAXStorage().setItem(v.recentlyAuthored+e.options.id,Date.now())},displayVersionGraph:function(e){var t=this;t.oldEvolValue=widget.getValue("evolutionView"),t.options=e;var i=e.modelKey;this.versionGraphComponent&&delete this.versionGraphComponent,t.initializeVersionExplorer(e),t.versionGraphComponent.setCheckVersionExternalFunction("ENOXVersionExplorerCreateNewRevision",function(){return t.isCreateNewRevision(i)}),t.versionGraphComponent.setCheckVersionExternalFunction("ENOXVersionExplorerDeleteVersion",function(){return e.modelKey.isConfigured}),t.versionGraphComponent.setCheckVersionExternalFunction("ENOXVersionExplorerShowMaturity",function(){return e.modelKey.isConfigured}),t.versionGraphComponent.setCheckVersionExternalFunction("ENOXVersionExplorerCreateNewBranch",function(){return e.modelKey.isConfigured}),t.versionGraphComponent.setCheckVersionExternalFunction("ENOXVersionExplorerDuplicate",function(){return e.modelKey.isConfigured}),t.versionGraphComponent.setCheckVersionExternalFunction("ENOXVersionExplorerOpenVersion",function(e){return!0}),t.versionGraphComponent.publishEvent("ENOXVersionExplorerLoadVersionModel",{id:i.id,type:i.kind,dataModelType:r.DATA_MODEL_TYPES.MODEL_ER,securityContext:s.getSecurityContext(),tenantId:s.getTenant(),onComplete:function(){t.versionGraphComponent.publishEvent("ENOXVersionExplorerSetActiveVersion",{id:i.id})}}),t._verExplDlg.inject(widget.body)},openSelectedVersion:function(e){t.mask(widget.body,h.msg_loading);var i=this,n=e.options.id,o=i.options.modelKey;if(o.kind===m.type_modelVersion){var r=e.options.grid,a={physicalid:r.physicalid?r.physicalid:r.id,name:r.title,revision:r.revision,current:r.current,backEndName:o.modelVer.backEndName},s=d.getFLWebModelEventsObj("flweb-model-events");p.createVolatileFilter({modelID:o.model.physicalid,modelName:o.model.name,modelVerName:a.backEndName,modelVerRev:a.revision}).then(function(e){s.publish({event:"mod-PC-selection-successful",data:{itemID:o.itemData.physicalid,model:o.model,modelVer:a,pc:null,filterCompiledForm:e.filterBinaryForExpand}}),i._verExplDlg.destroy()})}else{n=e.options.id;d.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:n}}),i.versionGraphComponent.publishEvent("ENOXVersionExplorerSetActiveVersion",{id:n})}t.unmask(widget.body),i._verExplDlg.destroy()},openVersion:function(e,t){(t&&t.options?t.options.id:null)&&!e&&this.openSelectedVersion(t)},isCreateNewRevision:function(e){return e.kind!==m.type_modelVersion},createEvolutionView:function(t){var n=widget.getValue("evolutionView"),o=e.createElement("div",{class:"evolution-subview"}).inject(t);e.createElement("div",{class:"header-evol-subview",html:h.header_evolution_view}).inject(o);var r=e.createElement("div",{class:"official-toggle-evol-subview"}).inject(o),a=new i({name:"officialToggle",value:"officialToggle",className:"primary",label:h.label_official_view,checked:!1,events:{onChange:function(e,t){this.isChecked()&&(l.uncheck(),widget.setValue("evolutionView",m.view_evolution_current))}}}).inject(r),s=e.createElement("div",{class:"projected-toggle-evol-subview"}).inject(o),l=new i({name:"projectedToggle",value:"projectedToggle",className:"primary",label:h.label_projected_view,checked:!1,events:{onChange:function(e){this.isChecked()&&(a.uncheck(),widget.setValue("evolutionView",m.view_evolution_projected))}}}).inject(s);n===m.view_evolution_current?a.check():l.check()},onVersionExplClose:function(){var e=this,t=widget.getValue("currentConfig"),i=d.getFLWebModelEventsObj("flweb-model-events");e.oldEvolValue!==widget.getValue("evolutionView")?(p.createVolatileFilter({modelID:t.model.physicalid,modelName:t.model.name,modelVerName:t.modelVersion.backEndName,modelVerRev:t.modelVersion.revision}).then(function(n){i.publish({event:"mod-PC-selection-successful",data:{itemID:e.options.modelKey.itemData.physicalid,model:t.model,modelVer:t.modelVersion,pc:null,filterCompiledForm:n.filterBinaryForExpand}})}),e._verExplDlg.destroy()):e._verExplDlg.destroy()}}}),define("DS/CATFLCockpitWidget/components/ImplementLinks/CATFLTraceabilityMatrixFilter",["DS/Controls/Button","DS/Controls/Toggle","DS/Controls/Expander","DS/Controls/LineEditor","DS/Windows/Dialog","DS/Windows/ImmersiveFrame","DS/CATFLCockpitWidget/utils/common.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s){"use strict";var l=function(e,t){this.wrapper=e,this.filterParams={options:{},allocation:{},references:{},instances:{},FilterNames:{}},this.render(t)};return l.prototype.render=function(t){var i=this;if(i.filterimmersiveFrame&&i.filterDialog)i.filterimmersiveFrame.show(),i.filterDialog.show();else{i.filterimmersiveFrame=new r({}),i.filterimmersiveFrame.inject(t);var n=i._createFilterContent();i.filterDialog=new o({immersiveFrame:i.filterimmersiveFrame,title:s.header_filters,content:n,resizableFlag:!0,autoCloseFlag:!1,buttons:{Ok:new e({label:s.apply_button,onClick:function(e){i.wrapper.trMatrix.applyFilter(i.filterParams)}}),Reset:new e({label:s.reset_button,onClick:function(e){i.resetMode=!0,i.filterDialog.content.remove(),i.filterDialog.content=i._createFilterContent(),i.resetMode=!1}})}}),i.filterDialog.addEventListener("close",function(e){e.preventDefault(),e.stopPropagation(),i.filterDialog.hide(),i.filterimmersiveFrame.hide()})}},l.prototype._createFilterContent=function(){var e=UWA.createElement("div",{class:"filter-trMatrix-container"});return this._createOptionsContent().inject(e),this._createAllocationContent().inject(e),this._createReferencesContent().inject(e),this._createInstancesContent().inject(e),this._createNamesContent().inject(e),e},l.prototype._createOptionsContent=function(){var e=this,n=new i({header:s.header_options,body:new UWA.Element("div"),style:"styled",expandedFlag:!0});e.filterParams.options.displayParents=!0;var o=new t({type:"checkbox",label:s.header_disp_parents,checkFlag:!0});return o.addEventListener("buttonclick",function(t){e.filterParams.options.displayParents=t.dsModel.checkFlag}),o.inject(n.body),n},l.prototype._createAllocationContent=function(){var e=this,n=new i({header:s.header_allocation,body:new UWA.Element("div"),style:"styled",expandedFlag:!0});e.filterParams.allocation.allocated=!0;var o=new t({type:"checkbox",label:s.header_allocated,checkFlag:!0});o.addEventListener("buttonclick",function(t){e.filterParams.allocation.allocated=t.dsModel.checkFlag}),o.inject(n.body),e.filterParams.allocation.notAllocated=!0;var r=new t({type:"checkbox",label:s.header_not_allocated,checkFlag:!0});return r.addEventListener("buttonclick",function(t){e.filterParams.allocation.notAllocated=t.dsModel.checkFlag}),r.inject(n.body),n},l.prototype._createReferencesContent=function(){var e=new i({header:s.header_references,body:new UWA.Element("div"),style:"styled",expandedFlag:!0}),t=this.wrapper.typesMap.references;if(t){var n=Object.keys(t).sort(function(e,i){return t[e].name.toLowerCase()<t[i].name.toLowerCase()?-1:t[e].name.toLowerCase()>t[i].name.toLowerCase()?1:0}).reduce(function(e,i){return e[i]=t[i],e},{});for(var o in n)this._declareType("references",e.body,o)}return e},l.prototype._createInstancesContent=function(){var e=new i({header:"Instances",body:new UWA.Element("div"),style:"styled",expandedFlag:!0}),t=this.wrapper.typesMap.instances;if(t)for(var n in t)t.hasOwnProperty(n)&&this._declareType("instances",e.body,n);return new UWA.Element("div")},l.prototype._createNamesContent=function(){var e=this,o=new i({header:s.header_names,body:new UWA.Element("div"),style:"styled",expandedFlag:!0});e.filterParams.FilterNames.FilterNamesString="",e.filterParams.FilterNames.FilterCheckToDo="";var r=new n({placeholder:s.ph_enter_text});r.addEventListener("change",function(t){var i=t.dsModel.value,n=i?i.trim():"",o="";if(n.length>0){var r=n.startsWith("*"),a=n.endsWith("*");r&&(n=n.substring(1)),a&&(n=n.substring(0,n.length-1)),n.length>0&&(o=r&&!a?"endsWith":!r&&a?"startsWith":"includes")}e.filterParams.FilterNames.FilterNamesString=n,e.filterParams.FilterNames.FilterCheckToDo=o}),r.inject(o.body),e.filterParams.FilterNames.ApplyToRows=!0;var a=new t({type:"checkbox",label:s.header_app_to_rows,checkFlag:!0});a.addEventListener("buttonclick",function(t){e.filterParams.FilterNames.ApplyToRows=t.dsModel.checkFlag}),a.inject(o.body),e.filterParams.FilterNames.ApplyToColumns=!0;var l=new t({type:"checkbox",label:s.header_app_to_cols,checkFlag:!0});return l.addEventListener("buttonclick",function(t){e.filterParams.FilterNames.ApplyToColumns=t.dsModel.checkFlag}),l.inject(o.body),o},l.prototype._declareType=function(e,i,n){var o,r=this,a=r.wrapper.typesMap[e][n];r.types||(r.types={}),r.types.hasOwnProperty(n)?(o=r.types[n],r.resetMode&&(r.filterParams[e][n]=!0,o.el.checkFlag=!0),o.el.inject(i)):((o={}).el=new t({type:"checkbox",label:a.name,checkFlag:!0}),o.el.addEventListener("buttonclick",function(t){r.filterParams[e][n]=t.dsModel.checkFlag}),r.filterParams[e][n]=!0,o.el.inject(i),this.types[n]=o)},l}),define("DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrixToolbarActions",["DS/CATFLWebMatrix/ExcelExporter","DS/CATFLCockpitWidget/components/ImplementLinks/CATFLTraceabilityMatrixFilter","DS/CATFLCockpitWidget/utils/common.util"],function(e,t,i){"use strict";return{executeToolbarCmd:function(n){var o=n.id,r=n.toolbarCtx,a=r.wrapper,s=a.trMatrix;if("collapse_btn"===o){var l=1!==s.rows.length||s.rows[0].isVisible()?0:1;s.setExpandLevel(l),r.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=-1}else if("export_btn"===o){var c=e.createXML(s.generateExcelData({prefixes:{}}));i.downloadFile("TraceabilityMatrix.xml",c)}else if("switchMatrix_btn"===o){var d=!a.getOption("inverted");a.setOption("inverted",d),a.createMatrix(),r.catflGeneratedToolbar.getNodeModelByID("expAll_btn")._associatedView.count=-1,a.trMatrix.inject(a.trMatrixContainer)}else"filter_btn"===o&&(r.trMatrixFilter?r.trMatrixFilter.render():r.trMatrixFilter=new t(a,a.container))}}}),define("DS/CATFLCockpitWidget/components/CreateLogicalItemModal/SAXPLMNew/SAXPLMNewCmdUtils",["DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/components/CreateLogicalItemModal/SAXPLMNew/PLMNewSAXCmd","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r){"use strict";var a=e.getFullConfig().identifiers;return{init:function(e){this.parentItem=e.parentItem,this.treeDocument=e.treeDocument,this.isReplaceCall=e.isReplaceCall;let t=this.getCreateoptions();new o(t).execute()},getCreateoptions:function(){let t={options:{typeName:a.type_act_logref,objType:a.type_act_logref},context:{serviceBaseUrl:e.getServiceURL("3DSpace"),tenant:e.getTenant(),header:{SecurityContext:"ctx::"+e.getSecurityContext()}},viewType:"tabView",labelTopBar:r.action_add_new,facets:this.getFacets(),notification:!1,events:this.getCallbacks(this,this.parentItem,this.treeDocument,this.isReplaceCall)};var i=e.getAuthorizedWorkUnder();return null!=i&&0!=Object.keys(i).length&&Object.assign(t.context.header,i),this.parentItem&&this.parentItem.options.physicalid&&(t.options.parentPIDs=[this.parentItem.options.physicalid],this.isReplaceCall&&this.parentItem.options.instance&&this.parentItem.options.instance.physicalid&&(t.options.selectedIDs=[this.parentItem.options.instance.physicalid])),t},getCallbacks:function(e,o,a,s){let l={onSuccess:function(e){if("success"!==e.status||!e.result||!e.result[0].identifier)return;let l,c=e.result[0].identifier,d=e.result[0].relations;if(o&&o.options.physicalid&&(l=o.options.physicalid),!s||l){if(a&&o&&l&&d){let e={id:d[0].relationshipID,name:d[0].instanceName,reference:c};var u=a.getMappedNodesFromId(l);u||(u=o),s?n.replaceNodeOnReplaceByNewRef({treeNodeToBeReplaced:o,mappedNodes:u,treeDocument:a,instanceData:e,parentRefId:o.getParent().options.physicalid}):n.addChildrenToParent(a,u,[e],!0)}else t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:c}});s?i.alertMessage("success",null,"",r.msg_replace_success):i.alertMessage("success",null,r.msg_header_create_success,r.create_log_ref_from_dialog_success)}},onFailure:function(){i.displayError({},r.error_creation,null,r.replace(r.error_no_access,{errorOp:r.action_insert_new+" "+r.label_log_ref}))},onCancel:function(){}};return l.onSuccess.bind(),l},getFacets:function(){return[{name:"classificationFacet",facetoptions:{isBookmark:!0,isLibrary:!0,isExportControl:!0}}]}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.deletion",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/document.service","DS/CATFLCockpitWidget/utils/config.util","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l){"use strict";var c=JSON.parse(s);return{deleteLogItemInstance:function(n){var r=n.collectionView.getContent(),s=n.collectionView.treeDocument.getSelectedNodes();e.mask(r,l.msg_processing);let d=widget.getValue("groupingEnabled");var u={},p={};s.forEach(function(e){var t=e.options.instance.physicalid,n=e.getParent();d&&!n.getID&&(n=i.getGroupNodeParent(n));let o=n.options.physicalid;void 0===u[o]&&(u[o]=[],p[o]=[]),u[o].push(t),p[o].push(e)});var g=[],m={success:[],failure:[],errorMessages:[]};for(var f in u)a.SAXStorage().setItem(c.recentlyAuthoredStructure+f,Date.now()),u.hasOwnProperty(f)&&g.push(o.deleteLogItemInstance(f,u[f]).then(this.updateViewOnDelete.bind(this,n.collectionView.treeDocument,p[f],"success",m)).catch(this.updateViewOnDelete.bind(this,n.collectionView.treeDocument,p[f],"failure",m)));Promise.all(g).finally(function(){if(m&&m.success.length>0){let e=n.collectionView.getGroupingOptions();e&&n.collectionView.groupRows(e),t.alertMessage("success",null,l.msg_inst_detach_success+m.success.toString())}if(m&&m.failure.length>0){let e=m.failure.toString();if(m.errorMessages&&Object.keys(m.errorMessages).length>0){e+="<br><br>"+l.error_details;for(let t in m.errorMessages)e+="<br><b>"+m.errorMessages[t].toString()+"</b><br>",t.indexOf("\n\n")>=0&&(t=t.split("\n\n")[1]),e+=t}t.alertMessage("error",null,null,l.msg_inst_detach_failure+e)}e.unmask(r)})},updateViewOnDelete:function(e,t,n,o,r){let s=widget.getValue("groupingEnabled"),l=t[0].getParent();s&&!l.getID&&(l=i.getGroupNodeParent(l));let d=l.options.physicalid;"success"===n?(o.success.push(l.options.label),s&&l.isRoot()?t.forEach(function(e){let t=e.getParent();t.getChildren().forEach(function(t){t.options.instance&&t.options.instance.physicalid===e.options.instance.physicalid&&t.remove()}),i.removeGroupNodesOnEmpty(t)}):t.forEach(function(t){let i;(i=e.getMappedNodesFromId(d)).forEach(function(e){e.getChildren().forEach(function(e){e.options.instance&&e.options.instance.physicalid===t.options.instance.physicalid&&e.remove()}),e.expand()})}),a.SAXStorage().setItem(c.recentlyAuthoredStructure+d,Date.now())):(r.errorResp&&r.errorResp.message&&(Object.keys(o.errorMessages).indexOf(r.errorResp.message)<0?o.errorMessages[r.errorResp.message]=[l.options.label]:o.errorMessages[r.errorResp.message].push(l.options.label)),o.failure.push(l.options.label))}}}),define("DS/CATFLCockpitWidget/components/ImplementLinks/implementLinks.controller",["DS/UIKIT/Mask","DS/Windows/Dialog","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/components/ImplementLinks/CATFLCockpitTraceabilityMatrix","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/assets/config/localStorage.keys.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f,h){"use strict";var v=JSON.parse(m),C=JSON.parse(f);return{manageRef2RefImplRel:function(e){let t;t=e.isReleased?v.type_act_physical:v.type_usecase+","+v.type_requirement+","+v.type_reqSpec+","+v.type_reqGroup+","+v.type_act_functref+","+v.type_act_logref+","+v.type_act_physical,i.launchSearch({allowedTypes:t,role:"",criteria:t,bMultiSel:!0,in_apps_callback:function(t){var i,o=e.selectedNode,a=[],s=[];t.forEach(function(e){s.push(e.id)}),l.getKindOfRFLP(s).then(function(e){e&&e.length>0&&(e.forEach(function(e,t){i={},"P"===e?(i.implementing=s[t],i.implemented=o.options.physicalid):(i.implementing=o.options.physicalid,i.implemented=s[t]),a.push(i)}),d.createScopeLinks(a).then(function(){r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-refLinks-by-id",data:[o]}),n.alertMessage("success","",h.msg_ref2ref_create_success)}).catch(function(e){n.displayError(e,null,null,h.error_create_refref_link)}))},function(e){n.displayError(e,null,h.error_create_refref_link)})}})},manageOcc2OccImplRel:function(t){var i=this;let p=widget.getValue(C.componentView);var g=widget.body.querySelector(".fl-cockpit-app-container");e.mask(g,h.msg_loading);var m=t.selectedNode,f=m.getParent().getRelationID();f=f.slice(0,f.indexOf("ref"));var v=m.getParent().getParent();widget.getValue("groupingEnabled")&&!v.getID&&(v=s.getGroupNodeParent(v)),c.expand({itemIDs:[v.options.physicalid,m.options.physicalid]}).then(function(t){i.instToNodeMap={},i.refTypes=[],i.instTypes=[];var s=i.mapParentToChildren(t[v.options.physicalid]),c=i.mapParentToChildren(t[m.options.physicalid]);if(s&&c){if(!s.getChildren()||!c.getChildren())return e.unmask(g),void n.alertMessage("error",null,"",h.msg_system_missing_children);s.options.implementLinks=v.options.implementLinks;var b=new u({useAsyncPreExpand:!0});b.addChild(s),b.addChild(c);var y=[];y.push(l.getTypeSchemaDetails({Type:i.refTypes,Relationship:i.instTypes})),y.push(d.getInstanceImplementLinks(Object.values(i.instToNodeMap))),o.makeMultipleServiceCalls(y,!0).then(function(t){var n=t[0],o=t[1],l=i.mapRefNInstTypes(n);o.forEach(function(e){if(e[f]){var t=e.node,i=[];e[f].forEach(function(n){i.push({id:e.node.options.instance.physicalid,path:n.path,state:"nochange"}),t.relations=i})}}),i.trMatrixModelEvents=r.createAppEventObject("trMatrix-model-events"),i.trMatrixModelEvents.subscribe({event:"occLink-refresh"},function(e){if(e&&e.firstSystemNode){var t=v.getTreeDocument().getNodesById(e.firstSystemNode.options.physicalid);t&&t.forEach(function(t){let i=d.getAllImplPaths(f,t,[],[]);t.options.instance.physicalid===e.firstSystemNode.options.instance.physicalid&&i.indexOf(e.ctxPath)&&(r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:[t]}),p===C.structuredView&&t.options.hasBeenExpanded&&a._addOccImplementLinksToNode(t))})}}),i.launchTraceabilityMatrix({system1:s,system2:c,linkType:f,typesMap:l,modelEvents:i.trMatrixModelEvents}),e.unmask(g)})}}).catch(function(t){e.unmask(g),n.displayError(t,null,null,h.error_manage_occocc_link)})},mapParentToChildren:function(e){var t,i=e.map,n=e.rootUuid;return i[n]&&(t=this.createNodeStruct(null,i[n],i,null)),t},createNodeStruct:function(e,t,i,n){var o,r=this,a=new p(t.attributes);e?e.addChild(a):o||(o=a),r.refTypes.indexOf(a.options.grid.actualType)<0&&r.refTypes.push(a.options.grid.actualType),n&&(a.options.instance={physicalid:n.pid,type:n.type,name:n.name},r.instToNodeMap[n.pid]=a,r.instTypes.indexOf(n.type)<0&&r.instTypes.push(n.type));var s=t.instances||t.relations;return s&&s.forEach(function(e){let t;if(e.attributes)for(let i=0;i<e.attributes.length;i++)if("PLMInstance.PLM_ExternalID"===e.attributes[i].name){t=e.attributes[i].value;break}r.createNodeStruct(a,i[e.toUuid],i,{pid:e.physicalid,type:e.type,name:t})}),o},mapRefNInstTypes:function(e){var t,i={references:{},instances:{}};return this.refTypes.forEach(function(n){t=e.Type[n],i.references[n]={name:t.TypeNLS||n,parent:t.Hierarchy}}),this.instTypes.forEach(function(n){t=e.Relationship[n],i.instances[n]={name:t.RelationshipNLS||n,parent:t.Hierarchy}}),i},launchTraceabilityMatrix:function(e){var i=e.system1.options.label+" "+e.system1.options.grid.revision,n=e.system2.options.label+" "+e.system2.options.grid.revision,o=g.init(e);if(o){var r=new t({title:h.replace(h.header_traceability_matrix,{system1:i,system2:n}),content:o,height:600,width:1400,resizableFlag:!0,movableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame});g.injectMatrix(),r.addEventListener("close",function(){r.destroy()})}},deleteImplRel:function(e){var t,i=e.selectedNodes,o=[];if(i.forEach(function(e){(t=e.options.linkInfo)&&o.push(t.implementId)}),o.length>0)return d.deleteImplementLinks(o).then(function(){var o,a=[];let l=widget.getValue("groupingEnabled");i.forEach(function(i){t=i.options.linkInfo;var n=i.getParent().getParent();l&&!n.getID&&(n=s.getGroupNodeParent(n)),(o=e.treeDocument.getMappedNodesFromId(n.options.physicalid))||(o=[n]),o.forEach(function(e){a.push(e);var i=e.options.instance?e.options.instance.physicalid:"",n=e.getNodesByRelId(t.linkType+t.objType+i)[0];n&&(n.getChildren().forEach(function(e){e.options.linkInfo.implementId===t.implementId&&e.remove()}),n.getChildren()&&0!==n.getChildren().length||n.remove()),e.expand()})}),n.alertMessage("success","",h.msg_delete_link_success),r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:a})}).catch(function(e){n.displayError(e,null,null,h.error_delete_link)})}}}),define("DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumberView",["UWA/Core","UWA/Class/View","DS/UIKIT/Tooltip","DS/Controls/LineEditor","DS/WUXAutoComplete/AutoComplete","DS/Controls/Toggle","DS/UIKIT/Mask","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/architectureNumber.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d){"use strict";return t.extend({name:"architectureNumberView",tagName:"div",collection:null,toupdate:null,spinner:null,setCollection:function(e){return this.collection=e,this.columnNames=this.collection.columnNames,this.columnDetails=this.collection.columns,this.itemDetails=this.collection.rows,this},init:function(e){this.modelEvents=e.modelEvents,this._parent(e)},createTableComponent:function(t,i,n,o){var r=e.createElement(t,n);return o&&r.appendText(o),r.inject(i),r},createDynamicColHeader:function(e){var t=this,i={};t.columnNames.forEach(function(n){t.columnDetails[n].architectureIdColumn&&(i.class="archidcolumn"),t.createTableComponent("th",e,i,t.columnDetails[n].label)})},createCheckBox:function(e,t,i){var n=new r({type:"checkbox",value:0,checkFlag:!0});n.addEventListener(t,i),n.inject(e)},createTableHeaderView:function(t,i,n){var o,r=this,a=e.createElement("tr");return o=r.createTableComponent("th",a,{status:"ok",id:"archNo-th-checkbox"}),r.createCheckBox(o,"change",function(e){r.toggleAllEvent(e,this,r.container)}),r.createTableComponent("th",a,{},"#"),r.createDynamicColHeader(a),this.collection.showRowLevelRecomputation&&r.createTableComponent("th",a,{},d.label_reEvaluate_ArchNo),r.createTableComponent("th",a,{},d.arch_no_header),r.collection.bEffectivityCol&&r.createTableComponent("th",a,{},d.label_current_evolution),a},createInActiveTableRow:function(t){var n,o,r,a,s=this,l="",c=s.columnNames,d=s.columnDetails;n=s.createTableComponent("tr",t.parent,t.elementProperty),t.fontIcon&&(o=s.createTableComponent("td",n,t.checkBoxCol.elementProperty),e.createElement("span",{class:t.checkBoxCol.fontIconClass}).inject(o),t.itemDetails.forbidSetANErrorMessages.forEach(function(e){l=l+e+"<br><br>"}),new i({target:o,body:l})),s.createTableComponent("td",n,{editable:!1,styles:{"background-color":"#f9f9f9"}},t.itemCount),c.forEach(function(e){r=d[e],a={id:r.key,name:r.label,architectureidcolumn:void 0!==r.architectureIdColumn&&r.architectureIdColumn,required:r.required,editable:!1,styles:{"background-color":"#f9f9f9"}},s.createTableComponent("td",n,a,t.itemDetails[e])}),s.collection.showRowLevelRecomputation&&(a={id:"ANRecompute",architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":"#f9f9f9"}},s.createTableComponent("td",n,a)),s.createTableComponent("td",n,{styles:{"background-color":"#f9f9f9"}},void 0).addClassName("archidcell"),s.addEffectivityColumnDetails(n,t.itemDetails,!0)},createTableBodyView:function(t,i){var r,a,s,l,u,p,g,m,f,h,v=this;let C=v.columnDetails;for(var b=v.itemDetails,y=t.getElement(".itemDetails"),_=0;_<b.length;_++)if(b[_].forbidSetAN&&Array.isArray(b[_].forbidSetANReasons))f="",h="",null,w=null,"REPARENT_BLANK_AN"===b[_].forbidSetANReasons[0]?(f="fonticon fonticon-checkbox-on",w={referenceID:b[_].referenceID,instanceIDs:b[_].instanceIDs,instanceID:null},m="onlyReparent"):(f="fonticon fonticon-status-ko",h="iconColor",w={referenceID:b[_].referenceID,instanceID:null,instanceIDs:null},m="ko"),v.createInActiveTableRow({itemDetails:b[_],parent:y,elementProperty:w,checkBox:!1,fontIcon:!0,itemCount:_+1,checkBoxCol:{elementProperty:{class:h,styles:{"background-color":"#f9f9f9"},status:m},fontIconClass:f}});else{r=v.createTableComponent("tr",t.getElement(".itemDetails"),{referenceID:b[_].referenceID,instanceIDs:b[_].instanceIDs,instanceID:b[_].instanceID}),a="",s="",g=v.createTableComponent("td",r,{status:"ok",id:"archNo-td-checkbox",styles:{"background-color":"#D5E8F2"}}),v.createCheckBox(g,"buttonclick",function(e){v.toggleEvent(e,this,v.container)}),v.createTableComponent("td",r,{html:_+1,editable:!1,styles:{"background-color":"#D5E8F2"}}),v.columnNames.forEach(function(e){var t,i;if(l=C[e],u={id:l.key,name:l.label,architectureidcolumn:l.architectureIdColumn||!1,required:l.required,editable:l.editable,styles:{"background-color":"#D5E8F2"}},p=v.createTableComponent("td",r,u),l.editable)if("enum"===l.format){var g=l.range,m=l.rangeLabel,f=l.rangeTooltip,h="",y=[];h=""!==b[_][e]?b[_][e]:l.defaultValue?l.defaultValue:"";for(var w=0;w<g.length;w++)y.push({label:m?m[w]:g[w],value:g[w],description:f&&f[w]?f[w]:null});(t=new o({elementsTree:y,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1,value:h})).inject(p),i=t.getContent().getElement("input"),t.addEventListener("change",c.updateArchitectureID.bind(v,i,r,!1))}else t=new n({className:"form-control",placeholder:d.ph_enter+C[e].label,attributes:{autocomplete:"off",name:l.label},value:b[_][e],requiredFlag:l.required}),p.classList.add("architecture-number-line-editor"),t.inject(p),(i=t._myInput).addEventListener("keyup",c.updateArchitectureID.bind(v,i,r,!1)),i.addEventListener("keydown",function(e){v.nextEditableCell(e),13===e.keyCode&&v.modelEvents.publish({event:"enter-key-pressed"})});else p.setHTML(b[_][e]);C[e].architectureIdColumn&&(s="enum"===l.format?t.value?t.value:"":b[_][e],a+=s)}),v.collection.showRowLevelRecomputation&&(u={id:"ANRecompute",architectureidcolumn:!1,required:!1,editable:!1,styles:{"background-color":"#D5E8F2",cursor:"pointer"}},p=v.createTableComponent("td",r,u),e.createElement("span",{class:"fonticon fonticon-compute"}).inject(p),p.addEventListener("click",function(e){"ok"===e.currentTarget.closest("tr").getChildren()[0].getAttribute("status")&&c.executeRecompute({an_action:v.collection.AN_ACTION,rows:[e.currentTarget.closest("tr")],forReparent:v.collection.forReparent})}));var w={class:"archidcell",styles:{"background-color":"#D5E8F2"}};v.createTableComponent("td",r,w).appendText(a),v.addEffectivityColumnDetails(r,b[_],!1)}},addEffectivityColumnDetails:function(t,i,n){let o=this,r=n?"#f9f9f9":"#D5E8F2";if(o.collection.bEffectivityCol){let n={},a={architectureIdColumn:!1,editable:!1,format:"string",required:!1,styles:{"background-color":r}};n.currentEvolution=e.extend(a,{key:"currentEvolution",label:d.label_current_evolution});let s=o.createTableComponent("td",t,n.currentEvolution),l=i.instanceIDs;if(l&&l.length>0){let e="";l.forEach(t=>{o.collection.instEffectivity[t]&&(e+=o.collection.instEffectivity[t].current)}),s.setHTML(e)}}},toggleAllEvent:function(e,t,i){var n=t.getParent(),o=n.getAttribute("status"),r=i.getElements("#archNo-td-checkbox"),a=!0;"ok"===o?(a=!1,n.setAttribute("status","ko")):n.setAttribute("status","ok");for(var s=0;s<r.length;s++){r[s].getParent().getChildren().forEach(function(e,t){var i=e.getElement(".wux-controls-checkbox"),n=e.getElement(".wux-ui-fa.wux-icon");a?(0==t&&(e.setAttribute("status","ok"),i.dsModel.checkFlag=!0,n.addClassName("wux-ui-fa-check")),e.setStyle("background-color","#D5E8F2"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!1)):(0==t&&(e.setAttribute("status","ko"),i.dsModel.checkFlag=!1,n.removeClassName("wux-ui-fa-check")),e.setStyle("background-color","hsl(0, 0%, 98%)"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!0))})}},toggleEvent:function(e,t,i){var n=t.getParent(),o=n.getAttribute("status");"ok"===o?(n.getParent().getChildren().forEach(function(e){e.setStyle("background-color","hsl(0, 0%, 98%)"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!0)}),n.setAttribute("status","ko")):"ko"===o&&(n.getParent().getChildren().forEach(function(e){e.setStyle("background-color","#D5E8F2"),"lineEditor"===e.getAttribute("type")&&(e.getChildren()[0].getChildren()[0].readOnly=!1)}),n.setAttribute("status","ok"));for(var r=i.getElements("#archNo-td-checkbox"),a=i.getElements("#archNo-th-checkbox")[0].getParent().getChildren()[0],s=a.getElement(".wux-controls-checkbox"),l=a.getElement(".wux-ui-fa.wux-icon"),c=!0,d=0,u=0;u<r.length;u++)"ko"===r[u].getAttribute("status")&&c?c=!1:"ok"===r[u].getAttribute("status")&&d++;c?(s.dsModel.checkFlag=!0,l.removeClassName("wux-toggle-mixed-icon"),l.addClassName("wux-ui-fa-check")):!c&&d>0?(l.removeClassName("wux-ui-fa-check"),l.addClassName("wux-toggle-mixed-icon")):0===d&&(s.dsModel.checkFlag=!1,l.removeClassName("wux-toggle-mixed-icon"))},render:function(e){var t=this;t.container=e;var i=this.collection.columnNames,n=this.collection.columns,o=(this.collection.rows,0),r=d.arch_no_identifier_message+(t.collection.showRowLevelRecomputation?d.arch_no_recompute_message:"");t.collection.forReparent&&(r+="<br>"+d.label_reparent_archNo_header),t.createTableComponent("p",e.getElement(".identifier-msg"),{html:r}),t.columnNames.forEach(function(e){t.columnDetails[e].architectureIdColumn&&o++}),t.createTableHeaderView(i,n,o).inject(e.getElement(".columnHeader")),t.createTableBodyView(e,o)},nextEditableCell:function(e){if(e.stopPropagation(),9==e.which){e.preventDefault();var t=e.currentTarget.closest("td"),i=t.closest("tr").getChildren(),n=!1;if(t.cellIndex<i.length-1)for(var o=t.cellIndex+1;o<i.length;o++)if("true"==i[o].getAttribute("editable")){i[o].getElement("input").focus(),n=!0;break}if(!n){var r=e.currentTarget.closest("tr").nextSibling;r&&r.getElement("[editable=true] div input").focus()}}}})}),define("DS/CATFLCockpitWidget/components/RefineSelection/RefineSelection",["DS/Windows/Dialog","DS/Controls/Button","DS/Handlebars/Handlebars","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","text!DS/CATFLCockpitWidget/components/RefineSelection/RefineSelection.html","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util"],function(e,t,i,n,o,r,a){"use strict";var s=r.getFullConfig(),l=s.identifiers,c=[{id:"structureInstances",nlsName:n.label_structure_instances,checkedByDefault:!0,subcategory:[{id:"onlystructureleaves",nlsName:n.label_only_structure_leaves,checkedByDefault:!1},{id:"onlykeyarchcomp",nlsName:n.label_only_key_arch_comp,checkedByDefault:!1}]},{id:"implementing",nlsName:n.label_implementing,checkedByDefault:!1,subcategory:[{id:"implementingReq",nlsName:n.label_requirement,checkedByDefault:!1},{id:"implementingFunc",nlsName:n.label_functional,checkedByDefault:!1},{id:"implementingLog",nlsName:n.label_logical,checkedByDefault:!1}]},{id:"isimplementing",nlsName:n.label_is_implementing,checkedByDefault:!1,subcategory:[{id:"isimplementingReq",nlsName:n.label_requirement,checkedByDefault:!1},{id:"isimplementingFunc",nlsName:n.label_functional,checkedByDefault:!1},{id:"isimplementingLog",nlsName:n.label_logical,checkedByDefault:!1}]},{id:"implmentedBy",nlsName:n.label_implemented_by,checkedByDefault:!1,subcategory:[{id:"implmentedByLog",nlsName:n.label_logical,checkedByDefault:!1},{id:"implmentedByPrd",nlsName:n.label_product,checkedByDefault:!1}]},{id:"isImplmentedBy",nlsName:n.label_is_implemented_by,checkedByDefault:!1,subcategory:[{id:"isImplmentedByLog",nlsName:n.label_logical,checkedByDefault:!1},{id:"isImplmentedByPrd",nlsName:n.label_product,checkedByDefault:!1}]},{id:"proposedsolution",nlsName:n.label_proposed_solution,checkedByDefault:!1},{id:"specDocs",nlsName:n.label_spec_documents,checkedByDefault:!1}],d={main:i.compile(o)},u=function(e,t){this.selectedNodes=e,this.treeDocument=t,this.render()};return u.prototype.render=function(){var i=this;i.dialog=new e({title:n.label_refine_selection,content:d.main({Header:i.selectedNodes.length+" "+n.label_data_grid,CategoryObject:c,CombCuesid:"combcues",CombCuesName:n.label_only_comb_cues}),height:630,width:340,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new t({label:n.label_refine,emphasize:"primary",onClick:function(){var e,t=[];if(i.contentDiv.querySelector(".checkbox-refine-by-cues").checked)for(e=0;e<i.selectedNodes.length;e++)void 0===i.selectedNodes[e].options.cueDetails?t.push(i.selectedNodes[e]):"group"!==i.selectedNodes[e].options.cueDetails.cue&&t.push(i.selectedNodes[e]);else for(e=0;e<i.selectedNodes.length;e++){var o=i.dialog.elements.container;if(o.querySelector("#structureInstances").checked||i.selectedNodes[e].options.virtual)if(!o.querySelector("#onlystructureleaves").checked||i.selectedNodes[e].options.virtual||i._isNodeLeaf(i.selectedNodes[e]))if(!o.querySelector("#onlykeyarchcomp").checked||i.selectedNodes[e].options.virtual||i.selectedNodes[e].options.grid.architectureNumber){if(i.selectedNodes[e].options.virtual){if(!o.querySelector("#implementingReq").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementingref")&&"R"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#implementingFunc").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementingref")&&"F"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#implementingLog").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementingref")&&"L"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#isimplementingReq").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementinginst")&&"R"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#isimplementingFunc").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementinginst")&&"F"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#isimplementingLog").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementinginst")&&"L"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#implmentedByLog").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementedref")&&"L"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#implmentedByPrd").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementedref")&&"P"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#isImplmentedByLog").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementedinst")&&"L"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#isImplmentedByPrd").checked&&i.selectedNodes[e].getParent().options.relationid.contains("implementedinst")&&"P"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#proposedsolution").checked&&i.selectedNodes[e].getParent().getType()===l.type_proposed_solution){t.push(i.selectedNodes[e]);continue}if(!o.querySelector("#specDocs").checked&&i.selectedNodes[e].getParent().getType()===l.type_spec_document){t.push(i.selectedNodes[e]);continue}if("DIF"===i.selectedNodes[e].options.grid.kindOfRFLP){t.push(i.selectedNodes[e]);continue}}}else t.push(i.selectedNodes[e]);else t.push(i.selectedNodes[e]);else t.push(i.selectedNodes[e])}t.length===i.selectedNodes.length?a.alertMessage("warning",null,n.warn_refine_selection_empty_result):i.treeDocument.getXSO().remove(t),i._saveUserSelection(),i.dialog.close()}}),Close:new t({emphasize:"secondary",onClick:function(){i.dialog.close()}})}}),i.dialog.elements.container.classList.add("flweb-refine-selection-panel"),i.contentDiv=i.dialog.elements._contentDiv;var o=JSON.parse(localStorage.getItem(s.localStorageKeys.refineSelectionOptions));null!==o&&i.contentDiv.querySelectorAll("[type=checkbox]").forEach(function(e){e.checked=o[e.id].checked,e.indeterminate=o[e.id].indeterminate,e.disabled=o[e.id].disabled}),i._disableRefineByCategoryCheckboxes(i.contentDiv.querySelector("#combcues").checked),i._checkifOkButtonIsEnabled(),c.forEach(function(e){if(i.contentDiv.querySelector("#"+e.id).addEventListener("click",function(){"structureInstances"===e.id?i._disableStructureSubCategoriesCheckboxes():i._updateSubcategorySelection(e),i._checkifOkButtonIsEnabled()}),void 0!==e.subcategory)for(var t=0;t<e.subcategory.length;t++){var n=e.subcategory[t];i.contentDiv.querySelector("#"+n.id).addEventListener("click",function(){"onlystructureleaves"===n.id||"onlykeyarchcomp"===n.id?i._updateStructureRootCategory():i._updateRootCategorySelection(e),i._checkifOkButtonIsEnabled()})}}),i.contentDiv.querySelector("#combcues").addEventListener("click",function(e){i._disableRefineByCategoryCheckboxes(e.currentTarget.checked),i._checkifOkButtonIsEnabled()})},u.prototype._saveUserSelection=function(){var e={};this.contentDiv.querySelectorAll("[type=checkbox]").forEach(function(t){e[t.id]={checked:t.checked,indeterminate:t.indeterminate,disabled:t.disabled}}),localStorage.setItem(s.localStorageKeys.refineSelectionOptions,JSON.stringify(e))},u.prototype._updateSubcategorySelection=function(e){var t=this;void 0!==e.subcategory&&e.subcategory.forEach(function(i){t.contentDiv.querySelector("#"+i.id).checked=t.contentDiv.querySelector("#"+e.id).checked})},u.prototype._updateRootCategorySelection=function(e){var t=this.contentDiv.querySelectorAll("[parentid="+e.id+"]:checked").length;t===e.subcategory.length?(this.contentDiv.querySelector("#"+e.id).checked=!0,this.contentDiv.querySelector("#"+e.id).indeterminate=!1):t>0?(this.contentDiv.querySelector("#"+e.id).indeterminate=!0,this.contentDiv.querySelector("#"+e.id).checked=!0):0===t&&(this.contentDiv.querySelector("#"+e.id).checked=!1,this.contentDiv.querySelector("#"+e.id).indeterminate=!1)},u.prototype._isNodeLeaf=function(e){if(!e.isVisible())return!1;if(e.isExpanded()&&e.options.children.length>0)for(var t=0;t<e.options.children.length;t++)if(e.options.children[t].options.physicalid&&e.options.children[t].isVisible())return!1;return!0},u.prototype._updateStructureRootCategory=function(){0===this.contentDiv.querySelectorAll("[parentid=structureInstances]:checked").length?(this.contentDiv.querySelector("#structureInstances").checked=!0,this.contentDiv.querySelector("#structureInstances").indeterminate=!1):(this.contentDiv.querySelector("#structureInstances").checked=!0,this.contentDiv.querySelector("#structureInstances").indeterminate=!0)},u.prototype._disableStructureSubCategoriesCheckboxes=function(){var e=this.contentDiv.querySelector("#structureInstances").checked||this.contentDiv.querySelector("#structureInstances").indeterminate||!1;this.contentDiv.querySelectorAll("[parentid=structureInstances]").forEach(function(t){t.disabled=!e}),this.contentDiv.querySelectorAll("[parentid=structureInstances]:not([disabled]):checked").length>0&&(this.contentDiv.querySelector("#structureInstances").indeterminate=!0)},u.prototype._disableRefineByCategoryCheckboxes=function(e){this.contentDiv.querySelectorAll(".checkbox-refine-by-category, .checkbox-refine-by-subcategory").forEach(function(t){t.disabled=e}),e||this._disableStructureSubCategoriesCheckboxes()},u.prototype._checkifOkButtonIsEnabled=function(){0===this.contentDiv.querySelectorAll("[type=checkbox]:not([disabled]):checked").length?this.dialog.buttons.Ok.disabled=!0:this.dialog.buttons.Ok.disabled=!1},u}),define("DS/CATFLCockpitWidget/components/ContentListView/decorators/contentlistview.cues",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/ConvergenceCues/ConvergenceCues.export","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a){"use strict";return{addConvergenceCuesListeners:function(e){this.contentListViewController=e,this.contentListViewController.modelEvents.subscribe({event:"content-list-view-validate-cues"},this.validateCuesForItems.bind(this,null,!1)),this.contentListViewController.modelEvents.subscribe({event:"content-list-view-clear-cues"},this.clearCuesForItems.bind(this)),this.contentListViewController.modelEvents.subscribe({event:"content-list-view-update-cues"},this.updateCuesForItems.bind(this)),this.contentListViewController.modelEvents.subscribe({event:"content-list-view-export-cues"},r.exportCuesForItems.bind(this))},validateCuesForItems:function(r,s){var l=this,c=!1;r?c=!0:r=l.contentListViewController.contentView.treeDocument.getSelectedNodes();var d,u,p=[];if(!s&&r.length<=0)t.alertMessage("error",null,a.error_cue_computation_noSelItems);else if(l.contentListViewController.selectedItemsForCues||(l.contentListViewController.selectedItemsForCues={}),l.contentListViewController._cueGlobalCount||(l.contentListViewController._cueGlobalCount={COMBINED:0,CRITICAL:0,ERROR:0,WARNING:0,INFO:0}),l.contentListViewController._cueComputedIds||(l.contentListViewController._cueComputedIds=[]),d=l.contentListViewController.contentView.treeDocument.getRoots()[0].options.physicalid,s||1!==r.length||r[0]._options.physicalid!==d){for(var g=!1,m=[],f=0;f<r.length;f++)r[f]._options.instance?(u=r[f]._options.instance.physicalid,p.push(u),l.contentListViewController.selectedItemsForCues[u]=r[f],m.push(r[f])):g||r[f]._options.physicalid===d||(g=!0);var h=n.confAllImplPathsOnNodes(m,!1,!1);if(p&&p.length>0){var v=l.contentListViewController.contentView.getContent();e.mask(v,a.msg_processing),o.validateVisualCues(p,h.payload).then(function(e){if(e){if(l.mapCueResponse(p,e),l.contentListViewController.selectedItemsForCues)for(var n in l.contentListViewController.selectedItemsForCues){var o=l.contentListViewController.selectedItemsForCues[n],r="",d=o._options.cueDetails;if(d&&d.cue.length<=0)o.setAttribute("cue",d.cue);else if(d&&l.contentListViewController._cueGlobalCount){for(var u in l.contentListViewController._cueGlobalCount){0!==r.length&&(r+="; "),r+=l.getNLSValueCueSeverity(u)+":"+l.contentListViewController._cueGlobalCount[u]}d.cueTooltip.indexOf(a.total)>=0&&(d.cueTooltip=d.cueTooltip.substring(0,d.cueTooltip.indexOf(a.total))),d.cueTooltip+=a.total+" "+r,o.setAttribute("cue",d.cue),o.setAttribute("cueTooltip",d.cueTooltip)}}s||t.alertMessage("success",null,a.msg_cue_computation_complete),c&&i.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-cues-report"})}}).catch(function(e){return t.displayError(e,null,null,a.msg_generic_error_get_failed),Promise.reject()}).finally(function(){e.unmask(v)})}!s&&g&&t.alertMessage("warning",null,a.warn_cue_computation_otherTypes)}else t.alertMessage("error",null,a.error_cue_computation_root)},mapCueResponse:function(e,t){var i,n,o=this;e.forEach(function(e){var r=o.contentListViewController.selectedItemsForCues[e],s=t[e];if(i={COMBINED:0,CRITICAL:0,ERROR:0,WARNING:0,INFO:0},r&&s){n="COMBINED"===s.cueSeverity?"group":"CRITICAL"===s.cueSeverity?"alert":"ERROR"===s.cueSeverity?"status-ko":"WARNING"===s.cueSeverity?"attention":"INFO"===s.cueSeverity?"info":"status-ok",o.contentListViewController._cueComputedIds.indexOf(e)<0&&o.contentListViewController._cueComputedIds.push(e);var l="",c="-",d=s.cueCount?s.cueCount:s.cueRowCount;if(r._options.cueDetails){var u=r._options.cueDetails.cueCount;for(var p in u)u[p]>0&&o.contentListViewController._cueGlobalCount[p]>=u[p]&&(o.contentListViewController._cueGlobalCount[p]-=u[p])}if(d){for(var p in c="",d)i[p]=d[p],o.contentListViewController._cueGlobalCount[p]+=d[p];for(var g in i){var m=i[g];if(m>0)0!==c.length&&(c+="; "),c+=o.getNLSValueCueSeverity(g)+":"+m}l=a.row+" "+c+"\n"}r._options.cueDetails={cue:n,cueTooltip:l,cueCount:d}}})},clearCuesForItems:function(){var e=this.contentListViewController.contentView.treeDocument.getSelectedNodes();if(e.length<=0)t.alertMessage("error",null,a.error_cue_clear_noSelItems);else if(this.contentListViewController._cueComputedIds&&0!==this.contentListViewController._cueComputedIds.length){for(var i=0;i<e.length;i++){if((c=e[i])._options.instance){var n=c._options.instance.physicalid,o=c._options.cueDetails?c._options.cueDetails.cueCount:null;if(o)for(var r in o)o[r]>0&&(this.contentListViewController._cueGlobalCount[r]-=o[r]);this.contentListViewController._cueComputedIds.indexOf(n)>=0&&this.contentListViewController._cueComputedIds.splice(this.contentListViewController._cueComputedIds.indexOf(n),1),delete this.contentListViewController.selectedItemsForCues[n];var s="";if(this.contentListViewController._cueGlobalCount)for(var l in this.contentListViewController._cueGlobalCount)0!==s.length&&(s+="; "),s+=l+":"+this.contentListViewController._cueGlobalCount[l];if(this.contentListViewController.selectedItemsForCues)for(var r in this.contentListViewController.selectedItemsForCues){var c,d=(c=this.contentListViewController.selectedItemsForCues[r])._options.cueDetails;if(d&&0!==s.length){var u=d.cueTooltip;u=u.substring(0,u.indexOf(a.total))+a.total+" "+s,d.cueTooltip=u,c.setAttribute("cueTooltip",u)}}e[i].setAttribute("cue",""),e[i].setAttribute("cueTooltip",""),delete e[i]._options.cueDetails}}0===this.contentListViewController._cueComputedIds.length&&(this.contentListViewController._cueGlobalCount=null),this.contentListViewController.modelEvents.publish({event:"close-properties-panel"}),t.alertMessage("success",null,a.msg_cue_clear_success)}else t.alertMessage("error",null,a.error_cue_clear_noCueComputation)},updateCuesForItems:function(e){var t=this,i=[];e&&e.length>0&&(e.forEach(function(e){var n=e.options.instance?e.options.instance.physicalid:null;t.contentListViewController._cueComputedIds&&n&&t.contentListViewController._cueComputedIds.indexOf(n)>=0&&i.push(e)}),t.validateCuesForItems(i,!0))},getNLSValueCueSeverity:function(e){var t="";return"WARNING"===e?t=a.cue_warning:"ERROR"===e?t=a.cue_error:"CRITICAL"===e?t=a.cue_critical:"INFO"===e?t=a.cue_info:"COMBINED"===e&&(t=a.cue_combined),t}}}),define("DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumber",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/CoreEvents/ModelEvents","DS/Windows/ImmersiveFrame","DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumberView","DS/Handlebars/Handlebars4","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/architectureNumber.util","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumber.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f){return g=JSON.parse(g),{init:function(e,t){return t?(this.forReparent=!0,this.newParentID=t.newParent.options.physicalid,this.reparentRefreshData={params:t.params,newParent:t.newParent,instArray:t.selectedNodes,resp:null}):this.forReparent=!1,this.modelEvents=new o,this.duplicateP2LWarningIDs={},this.createModal(e),this.pushSetArchView(e)},createModal:function(e){var o=this,r=s.compile(m),a=(o.forReparent?f.label_reparent_set_archNo:f.label_set_arch_no)+" - ";1===e.rows.length?a+=e.rows[0].title:a+=e.rows.length+" "+f.label_objects;var d={Cancel:new n({onClick:function(e){o.modalWindow.destroy()}}),Ok:new n({label:o.forReparent?f.label_reparent:f.set_button,onClick:function(i){t.mask(o.modalWindow.elements._contentDiv,f.msg_processing);for(var n=[],r=0,a=o.modalWindow.getContent().getElement(".itemDetails").getChildren("tr"),s=0;s<a.length;s++)("ko"===a[s].getChildren()[0].getAttribute("status")||a[s].getChildren()[0].hasClassName("iconColor"))&&r++;if(r===a.length)return l.alertMessage("error",null,f.log_ref_selection_error),void t.unmask(o.modalWindow.elements._contentDiv);var d,u={},p=null;for(s=0;s<a.length;s++){var g,m=a[s],h=(p={},m.getAttribute("referenceID")),v=m.querySelectorAll('[required = "true"]'),C=!1;if(!m.getChildren()[0].getAttribute("status")||"ko"===m.getChildren()[0].getAttribute("status")){o.reparentRefreshData&&o.reparentRefreshData.instArray.forEach(function(e,t,i){e.options.physicalid!==h||i.splice(t,1)});continue}if("onlyReparent"===m.getChildren()[0].getAttribute("status")){d=Array.isArray(m.getAttribute("instanceIDs"))?m.getAttribute("instanceIDs"):[m.getAttribute("instanceIDs")],n.push({referenceID:h,instanceIDs:d});continue}for(var b=0;b<v.length;b++){if(requiredCell=v[b],"true"===requiredCell.getAttribute("editable"))if(""==requiredCell.getElement("input").value.trim()){requiredCell.getElement("input").scrollIntoView(),requiredCell.getElement("input").addClassName("errordiv"),l.alertMessage("error",null,f.req_field_error_header,requiredCell.getAttribute("name")+f.arch_number_required_field),C=!0;break}}if(C)break;if((g=m.getElement(".archidcell")?m.getElement(".archidcell").getHTML():m.querySelector('[architectureidcolumn = "true"]').getElement("input").value.trim())==m.getElement("#existing").getHTML()){t.unmask(o.modalWindow.elements._contentDiv),l.alertMessage("error",null,"",f.existing_architecture_number_error),m.getElement(".archidcell")?m.getElement(".archidcell").addClassName("errordiv"):row.querySelector('[architectureidcolumn = "true"]').addClassName("errordiv"),C=!0;break}u[h]=g;var y=null,_=null,w={};m.getElements("[architectureidcolumn=true]").forEach(e=>{if(y=e.getAttribute("id"),"true"===e.getAttribute("editable")){let t=e.getChildren()&&e.getChildren()[0];_=t.dsModel.value}else _=e.getHTML();w[y]=_});let e=m.getAttribute("instanceIDs");e?p.instanceIDs=Array.isArray(e)?e:e.split(","):m.getAttribute("instanceID")&&(p.instanceID=m.getAttribute("instanceID")),p.referenceID=h,p.ArchitectureNumber=g,p.ArchitectureNumberTokens=w,n.push(p)}if(C)t.unmask(o.modalWindow.elements._contentDiv);else{var D=o.setPayload(n,u);D.AN_ACTION=e.AN_ACTION,o.removeCSS(),o.forReparent?c.setANandReparent(D).then(function(e){e=JSON.parse(e),o.setArchitectureNumber(e,u)}).catch(function(e){t.unmask(o.modalWindow.elements._contentDiv),l.displayError(e,null,null,f.error_set_archno)}):c.setArchitectureNumber(D).then(function(e){e=JSON.parse(e),o.setArchitectureNumber(e,u)}).catch(function(e){t.unmask(o.modalWindow.elements._contentDiv),l.displayError(e,null,null,f.error_set_archno)})}}})};e.showBulkRecomputation&&(d.Apply=new n({label:f.label_reEvaluate_ArchNo,onClick:function(){p.executeRecompute({an_action:e.AN_ACTION,rows:o.modalWindow.getContent().getElement(".itemDetails").getChildren("tr"),forReparent:o.forReparent})}})),o.modalWindow=new i({title:a,content:r(),domId:"set-architecture-number",immersiveFrame:widget.immersiveFrame,width:900,height:400,resizableFlag:!0,modalFlag:!0,buttons:d}),o.modelEvents.subscribe({event:"enter-key-pressed"},function(){d.Ok.onClick()})},pushSetArchView:function(e){return this._architectureNumberView=new a({modelEvents:this.modelEvents}),e.forReparent=this.forReparent,this._architectureNumberView.setCollection(e).render(this.modalWindow.getContent()),this.modalWindow},modalSubmit:function(){},setPayload:function(e,t){var i={},n=[];for(var o in this.duplicateP2LWarningIDs){this.duplicateP2LWarningIDs[o]===t[o]&&n.push(o)}return this.forReparent?(i.newParentID=this.newParentID,i.instances=e):i.architectureNumbers=e,i.ignoreP2LWarningIDs=n,this.duplicateP2LWarningIDs={},i},setCSS:function(e,t){var i=this;e.forEach(function(e){var n=i.modalWindow.getContent().getElement('.itemDetails tr[referenceID ="'+e+'"]'),o=n.getElement(".archidcell");if(t)if(o)o.addClassName(t),o.scrollIntoView();else{var r=n.querySelector('[architectureidcolumn = "true"]');r.addClassName(t),r.getElement("input").scrollIntoView()}else o||(o=n.querySelector('[architectureidcolumn = "true"]')),o.hasClassName("errordiv")&&o.removeClassName("errordiv")})},removeCSS:function(){for(var e=this.modalWindow.getContent().getElement(".itemDetails").getElements("tr"),t=0;t<e.length;t++)for(var i=0;i<e[t].getChildren().length;i++)e[t].getChildren()[i].hasClassName("archidcell errordiv")&&e[t].getChildren()[i].removeClassName("errordiv")},setArchitectureNumber:function(e,i){var n=this,o=n.modalWindow.getContent().getElement(".itemDetails").getElements("tr");if(t.unmask(n.modalWindow.elements._contentDiv),e.status&&200!=e.status){var r,a=null,s=[],c=[],p=[],g=[],m=[];o.forEach(function(t){var o=t.getAttribute("referenceID");"NON_COMPLIANCE"===e[o]?m.push(o):"NOCSGROUP"==e[o]||"FROZEN_REV"==e[o]||"NO_MODIFY_ACCESS"==e[o]?s.push(o):"KO"==e[o]||"UNICITY_KO"==e[o]?c.push(o):"P2L_DUPLICATE_WARNING"==e[o]?(n.duplicateP2LWarningIDs[o]=i[o],p.push(o)):"UNICITY_OK"==e[o]&&g.push(o)}),m.length>0?(a="errordiv",n.setCSS(m,a),n.duplicateP2LWarningIDs={},r={type:"error",message:f.msg_arch_number_non_compliance}):s.length>0?(a="errordiv",n.setCSS(s,a),n.duplicateP2LWarningIDs={},r={type:"error",message:f.msg_error_set_architecture_number_unselect_reference}):c.length>0?(a="errordiv",n.setCSS(c,a),n.duplicateP2LWarningIDs={},r={type:"error",message:f.arch_number_unique_error}):p.length>0?(a="errordiv",n.setCSS(p,a),r={type:"warning",message:f.msg_error_set_architecture_number_p2lwarning}):r={type:"error",message:f.msg_set_arch_num_failed},r&&(t.unmask(n.modalWindow.elements._contentDiv),l.alertMessage(r.type,null,"",r.message))}else{if(n.forReparent)n.reparentRefreshData.resp=e,u.refreshNodesOnReparent(n.reparentRefreshData),l.alertMessage("success",null,"",f.msg_reparent_setArch_success);else{var h=[];for(var v in e)i.hasOwnProperty(v)&&h.push(v);d.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:h,tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!0}});var C=widget.getValue("currentOpenedItem");C&&h.indexOf(C)>=0&&d.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"}),l.alertMessage("success",null,"",f.set_arch_number_success)}e.postProcessWarningMessage&&l.alertMessage("warning",null,"",e.postProcessWarningMessage),n.modalWindow.destroy()}}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment",["DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/ENOXEmptyContent/js/ENOXEmptyContent","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/document.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/components/ArchitectureNumber/architectureNumber","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f,h){"use strict";let v=o.getFullConfig(),C=v.identifiers;return{addExistingDoc:function(e,t){var i=this.addExistingDocAsInstance.bind(this,e,t);a.launchSearch({searchTitle:h.label_search_doc,allowedTypes:C.types_addExistingDoc,role:"",criteria:C.type_documents,bMultiSel:!0,in_apps_callback:i})},addExistingDocAsInstance:function(t,i,n){if(n){var o,a;e.mask(widget.body,h.msg_processing),i&&(o=C.rel_specification,a="specificationDocumentsCategory");var s=[];return n.forEach(function(e){var i=e.id?e.id:e.objectId;s.push(u.attachDocument(t.options.physicalid,i,o))}),Promise.all(s).then(function(){e.unmask(widget.body),r.alertMessage("success",null,h.msg_attach_doc_success),c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-documents-by-id",data:{nodes:[t],docType:a}})},function(t){e.unmask(widget.body),r.displayError(t,h.msg_add_item_error,null,h.replace(h.error_no_access,{errorOp:h.action_insert_existing+" "+h.label_document}))})}},setArchitectureNumber:function(t,i){let n=!1;i&&i.newParent&&(n=!0);let o=document.body.querySelector(".fl-cockpit-content-list-container");e.mask(o,h.msg_loading);let a,s,l={};if(n){a={newParentID:i.newParent.options.physicalid};let e=[];t.forEach(function(t){e.push({instanceID:t.options.instance.physicalid,referenceID:t.options.physicalid})}),a.instances=e}else a=[],Array.isArray(t)?(s=[],t.forEach(function(e){let t=e.options.physicalid,i={referenceID:t};if(e.options.instance){let n=e.options.instance.physicalid;i.instanceID=n,s.push(n),l[t]?l[t].push(n):l[t]=[n]}a.push(i)})):a.push({referenceID:t});let c=[];return n?c.push(d.getANProposalForReparent(a)):(c.push(d.getArchitectureNumberProposal(a)),s&&s.length>0&&c.push(g.getEffectivityInfo(s))),Promise.all(c).then(function(e){let o=JSON.parse(e[0]),r=e[1],a=!1,s={};if(n&&(i.selectedNodes=t),r){let e,t;for(let i in r)r.hasOwnProperty(i)&&"YES"===(e=r[i]).hasEffectivity&&(t=e.content&&e.content.Evolution)&&t.Current&&t.Projected&&(s[i]={current:t.Current.replace(/(\r\n|\n|\r)/gm," "),projected:t.Projected.replace(/(\r\n|\n|\r)/gm," ")},a||(a=!0));o.bEffectivityCol=a,o.instEffectivity=s}m.init(o,i)}).catch(function(e){r.displayError(e,null,h.error_header,h.error_get_archno_proposal)}).finally(function(){e.unmask(o)})},detachArchitectureReferenceExtension:function(t,i){e.mask(i,h.msg_processing);var n=this,o=[];return t.forEach(function(e){o.push(e.options.physicalid)}),d.detachArchitectureReferenceExtension(o,"VALIDATE_AND_REMOVE").then(function(a){var s=JSON.parse(a);if(s.requirePreprocess){var l=UWA.createElement("div",{styles:{"min-height":"100px","max-height":"210px","overflow-y":"auto"}});l.innerText=s.message,f.createWindow(h.action_remove_architecture_number,l,h.label_archNum_remove_confirm_preprocess,function(){e.mask(i,h.msg_processing),d.detachArchitectureReferenceExtension(o,"PRE_PROCESS_AND_REMOVE").then(function(e){let i="success";(e=JSON.parse(e)).ignored&&(i="warning"),r.alertMessage(i,null,e.message),n.detachArchNumUpdateView(o,t)},function(e){r.displayError(e,null,h.error_header,h.error_rem_archno)}).finally(function(){e.unmask(i)})})}else r.alertMessage("success",null,s.message),n.detachArchNumUpdateView(o,t)}).catch(function(e){r.displayError(e,null,h.error_header,h.error_rem_archno)}).finally(function(){e.unmask(i)})},detachArchNumUpdateView:function(e){var t=widget.getValue("currentOpenedItem");t&&e.indexOf(t)>=0&&c.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"}),c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:e,tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:!1}})},openModalSolutionSelection:function(e){var o=this,s=new i({label:h.label_search,emphasize:"primary",onClick:function(){a.launchSearch({searchTitle:h.label_search_product,allowedTypes:C.type_act_physical,role:"",criteria:C.type_act_physical,bMultiSel:!1,in_apps_callback:function(t){o.updateSolutionID(t[0].id,l,d,e)}})}}),l=new n({sentences:[{type:"dom",DOMelement:s.getContent()},{type:"drop",text:h.msg_drop_to_open}]}),c=h.action_set_proposed_solution+" - ";1===e.length?c+=e[0].options.label:c=c+e.length+" "+h.label_objects;var d=new t({title:c,content:l._containerEmptyContent,width:580,resizableFlag:!1,modalFlag:!0,immersiveFrame:widget.immersiveFrame});d.addEventListener("close",function(){d.destroy()}),r.makeDroppable(d.elements._contentDiv,"",function(t){null!==t&&p.getKindOfRFLP([t[0].objectId]).then(function(i){"P"===i[0]?o.updateSolutionID(t[0].objectId,l,d,e):r.alertMessage("error",null,h.error_dropped_item_not_physical)})})},detachDocuments:function(t){e.mask(widget.body,h.msg_processing);let i=widget.getValue("groupingEnabled"),n=[];var a=[],s=[],d=[];return t.forEach(function(e){var t=e.getParent().getParent();i&&!t.getID&&(t=l.getGroupNodeParent(t));var o=t.options.physicalid;n.push(o);var r="specificationDocumentsCategory"===e.getParent().options.type;r?d.push(e):s.push(e);var c=e.options.physicalid;a.push(u.removeDocument(o,c,r))}),Promise.all(a).then(function(){1===t.length?r.alertMessage("success",null,t[0].options.label+h.msg_detach_document):r.alertMessage("success",null,t.length+h.msg_detach_documents),s.length>0&&c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"remove-items-from-category",data:{nodes:s,categoryType:"attachedDocumentsCategory"}}),d.length>0&&c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"remove-items-from-category",data:{nodes:d,categoryType:"specificationDocumentsCategory"}}),n&&n.length>0&&n.forEach(e=>{o.SAXStorage().setItem(v.localStorageKeys.recentlyAuthored+e,Date.now())}),e.unmask(widget.body)},function(t){r.displayError(t,null,h.error_remove_item),e.unmask(widget.body)})},detachSolution:function(e,t,i){var n,a=[];let s=widget.getValue("groupingEnabled");for(n in t)t.hasOwnProperty(n)&&a.push({refId:n,solIds:t[n]});return d.detachSolution(a).then(function(){var t=[];i.forEach(function(i){var n=i.options.physicalid,r=i.getParent();if(r){var a=r.getParent();if(s&&!a.getID&&(a=l.getGroupNodeParent(a)),s&&a.isRoot()){let e=r.getParent();r.getChildren().forEach(function(e){e.options.physicalid===n&&e.remove()}),r.getChildren()&&0!==r.getChildren().length||r.remove(),l.removeGroupNodesOnEmpty(e)}else{(e.getMappedNodesFromId(a.options.physicalid)||[a]).forEach(function(e){t.push(e);var i=e.options.instance?e.options.instance.physicalid:"",o=e.getNodesByRelId("proposedsolution"+i)[0];o.getChildren().forEach(function(e){e.options.physicalid===n&&e.remove()}),o.getChildren()&&0!==o.getChildren().length||o.remove()})}o.SAXStorage().setItem(v.localStorageKeys.recentlyAuthored+a.options.physicalid,Date.now())}}),r.alertMessage("success",null,h.msg_remove_solution_success),t.length>0&&c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:t})}).catch(function(e){r.displayError(e,null,h.error_header,h.error_rem_prop_soln)})},addExistingItem:function(e,t,i){require(["DS/CATFLCockpitWidget/utils/SAXTracker"],function(e){e.trackCommandLaunched("createExistingLogRef-sax")});var n,o=this.addExistingItemAsInstance.bind(this,e,t,i);n=C.type_act_logref,a.launchSearch({searchTitle:h.label_search_logref,allowedTypes:n,role:"",criteria:n,bMultiSel:!0,in_apps_callback:o})},addExistingItemAsInstance:function(t,i,n,o){e.mask(i,h.msg_processing);var a={instances:[]};if(o)for(var l=0;l<o.length;l++)a.instances.push({referencedID:o[l].id?o[l].id:o[l].objectId,attributes:{}});d.createLogItemInstanceNew(a,t.options.physicalid,!0).then(function(a){var l=[];if(o.forEach(function(e){l.push(e["ds6w:label"]+" "+e["ds6wg:revision"])}),a&&a.member){var c=n.getMappedNodesFromId(t.options.physicalid);c||(c=[t]),s.addChildrenToParent(n,c,a.member,!1),e.unmask(i),r.alertMessage("success",null,h.msg_header_add_success,h.msg_add_success+l.toString())}},function(t){e.unmask(i),r.displayError(t,null,h.error_header,h.msg_add_item_error)})},updateSolutionID:function(e,t,i,n){var o=[],a=!1,s=!1;return n.forEach(function(t){o.push({refId:t.options.physicalid,solIds:[e]})}),d.updateSolutionIDAttributes(o).then(function(e){for(var t in e)if(e.hasOwnProperty(t)&&(e[t].ignoredAlreadyExist.length>0&&(a=!0),e[t].success.length>0&&(s=!0),s&&a))break;a&&r.alertMessage("error",null,h.msg_proposed_solution_ignored),s&&(r.alertMessage("success",null,h.msg_proposed_solution_added),c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-update-cues",data:n}),c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-solutions-by-id",data:n}))}).catch(function(e){r.displayError(e,null,h.error_header,h.error_add_prop_soln)}).finally(function(){t.destroy(),i.destroy()})}}}),define("DS/CATFLCockpitWidget/components/CreateLogicalItemModal/logRef.createPanel.modalWindow",["UWA/Core","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/WUXAutoComplete/AutoComplete","DS/Controls/Button","DS/Controls/LineEditor","DS/Controls/SpinBox","DS/Controls/Toggle","DS/UIKIT/Mask","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.creation","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f,h,v,C){"use strict";var b=m.getFullConfig(),y=(b.localStorageKeys,b.identifiers);return{createFieldRowDiv:function(t,i,n,o,r){var a=e.createElement("div",{class:t});i&&a.setStyles(i);var s=e.createElement("label",{html:n}),l=e.createElement("div",{class:"field-container"});return s.inject(l),l.inject(a),o.addClassName("elem-container"),o.inject(a),a},formatSubTypeList:function(e){if(this.logRefSubTypes=m.getFullConfig().logicalRefSubTypes,this.logRefSubTypes&&this.logRefSubTypes.length<1&&(this.showSubtype=!1),this.logRefSubTypesCurated=[],this.showSubtype&&e){var t=null,i=null,n=null;for(var t in e){n=!1;for(var o=0;o<this.logRefSubTypes.length;o++)if(t===(i=this.logRefSubTypes[o]).Name){this.logRefSubTypesCurated.push(i),n=!0;break}n||this.logRefSubTypesCurated.push({NLS:t,Name:t,Package:e[t],PackageName:e[t],Parent:y.type_act_logref})}this.logRefSubTypesCurated.sort(function(e,t){return e.NLS.toLowerCase()<t.NLS.toLowerCase()?1:e.NLS.toLowerCase()>t.NLS.toLowerCase()?-1:0}),this.logRefSubTypesCurated.sort(function(e,t){return e.PackageName.toLowerCase()<t.PackageName.toLowerCase()?1:e.PackageName.toLowerCase()>t.PackageName.toLowerCase()?-1:0}),this.logRefSubTypesCurated.reverse()}},createAutocomplete:function(){var e=null,t=null,i=null;let a=!1,s=!1,l=localStorage.getItem("prevSelSubType");var c=new n({shouldBeSelected:function(e){return!e.options.isPackage}}),d=null;c.prepareUpdate();for(var u=null,p=0;p<this.logRefSubTypesCurated.length;p++)"True"!==(u=this.logRefSubTypesCurated[p]).Abstract&&(!(t=u.PackageName)||null!==e&&e===t||(null!==i&&(c.addRoot(i),i.expandAll()),i=new o({label:t,value:u.Package,isPackage:!0}),e=t),d=u.IconName?m.getServiceURL("3DSpace")+"/snresources/images/icons/small/"+u.IconName:m.getTypeIconUrl(y.type_act_logref).iconPath,i.addChild(new o({label:u.NLS,icons:[d],isPackage:!1,value:u.Name})),u.Name===l?s=!0:u.Name===y.type_act_logref&&(a=!0));null!==i&&(c.addRoot(i),i.expandAll()),c.pushUpdate();var g=new r({elementsTree:c,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1});return g.getContent().addClassName("basicFieldAttribute"),g.addEventListener("change",this.manageEmptyField.bind(this,g,!0)),g.value=this.getPreviousSelectedSubType(l,s,a),g},getPreviousSelectedSubType:function(e,t,i){if(t)return e;if(i)return y.type_act_logref;let n="";for(var o=0;o<this.logRefSubTypesCurated.length;o++){let e=this.logRefSubTypesCurated[o];if("True"!==e.Abstract){n=e.Name;break}}return n},createCustomFields:function(t,i){var n,o,a,d=this,u=null;t.forEach(function(t){var p,g={};if(u=i[t],n=u.format,o=void 0!==u.editable&&!u.editable,p=null,a=null,null,"string"==n||"number"==n||"enum"==n||"boolean"==n){switch(n){case"string":(p=new s({placeholder:C.ph_title,value:void 0===u.value?void 0===u.defaultValue?"":u.defaultValue:u.value,disabled:o,selectAllOnFocus:!0,displayClearFieldButtonFlag:!0})).getContent().getElement("input").addClassName("customFieldAttribute"),g.type="textBox",g.required=u.required,p.addEventListener("change",d.manageEmptyField.bind(d,p,g.required));break;case"enum":var m=u.range,f=u.rangeLabel,h="";h=u.value?u.value:u.defaultValue?u.defaultValue:"";for(var v=[],b=0;b<m.length;b++)v.push({label:void 0!==f?f[b]:m[b],value:m[b]});(p=new r({elementsTree:v,multiSearchMode:!1,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!1,disabled:o})).value=h,g.type="dropDown",g.required=u.required,p.addEventListener("change",d.manageEmptyField.bind(d,p,g.required));break;case"number":h="";u.defaultValue&&(h=u.defaultValue),u.value&&(h=u.value),p=new l({value:h,maxValue:1e7,stepValue:1,disabled:o}),g.type="numberBox",g.required=u.required,p.addEventListener("change",d.manageEmptyField.bind(d,p,g.required));break;case"boolean":p=new c({type:"switch",disabled:o,checkFlag:void 0===u.value?void 0!==u.defaultValue&&u.defaultValue:u.value}),g.type="checkBox",g.required=u.required;break;default:return}a=e.createElement("div",{class:"custom-field-container"}),g.element=p,g.label=u.label,g.key=t,p.inject(a),p.getContent().addClassName("customFieldAttribute"),d.createFieldRowDiv("customFieldRow",null,u.label,a,null).inject(d.logRefCreateForm),d._inputElemList.push(g)}})},createFooter:function(){var e=null,t=null,i=null,n={};if(null===this.rootID)e=C.msg_create_and_open,t="btn-create-and-close";else if(this.isReplaceCall)e=C.msg_create_and_replace,t="btn-replace-and-close";else{e=C.action_create,i=C.msg_create_and_close,t="btn-create";var o=new a({label:i});o.getContent().classList.add("btn-create-and-close")}var r=new a({label:e});r.getContent().classList.add(t);var s=new a({label:C.action_close,onClick:function(e){document.getElementById("create-logicalref-immersiveFrame").destroy()}});return s.getContent().classList.add("btn-close"),n={Cancel:s,Ok:r},null!=i&&o&&(n.Apply=o),n},createTitleField:function(){var t,i=new s({placeholder:C.ph_title,selectAllOnFocus:!0,sizeInCharNumber:b.adminStatus.ReferenceTitleMaxLength||100,displayClearFieldButtonFlag:!0});i.getContent().getElement("input").addClassName("basicFieldAttribute"),t={type:"textBoxNameField",required:!1,element:i},this._inputElemList.push(t);var n=e.createElement("div",{class:"title-box"});i.inject(n),this.createFieldRowDiv("titleFieldRow",null,C.label_title,n,null).inject(this.logRefCreateForm)},createTypeField:function(){var t=this.createAutocomplete(),i={type:"dropDownTypeField",required:!1,element:t,label:C.label_type};this._inputElemList.push(i);var n=e.createElement("div",{class:"item-type-selector"});t.inject(n),this.createFieldRowDiv("typeFieldRow",null,C.label_type,n,null).inject(this.logRefCreateForm)},create:function(n,o,r,a,s,l,c){var d=this;d._inputElemList=[],d.showSubtype=s,d.isReplaceCall=a,d.modelEventsContentListView=h.getFLWebModelEventsObj("flcockpit-content-list-view"),d.parentID=o?o.options.physicalid:null,d.rootID=o?o.getRoot().options.physicalid:null,d.parentItem=o,o&&d.isReplaceCall&&(d.replaceRefId=o.getParent().options.physicalid,d.replaceInsId=o.options.instance.physicalid,d.replaceRootId=o.getRoot().options.physicalid);var u=d.createFooter(),p=new t({domId:"create-logicalref-immersiveFrame"});null!=n&&p.inject(n),d.logRefCreateForm=e.createElement("div",{class:"logRef-create-form"}),d.modal=new i({title:C.action_add_new,content:d.logRefCreateForm,domId:"create-logicalref-dialog",immersiveFrame:p,width:450,resizableFlag:!0,buttons:u,modalFlag:!0}),d.modal.close=function(){document.getElementById("create-logicalref-immersiveFrame").destroy()},d.createTitleField(),d.showSubtype&&(d.formatSubTypeList(l),d.createTypeField());var g=r.fieldNames,m=r.fields;for(var f in g&&d.createCustomFields(g,m),d.modal.buttons){var v=d.modal.buttons[f];null===d.rootID||d.isReplaceCall||v.getContent().hasClassName("btn-create")&&(v.onClick=function(){d._createReferenceItem(!1,c)}),d.isReplaceCall?v.getContent().hasClassName("btn-replace-and-close")&&(v.onClick=function(){d._createReferenceItem(!0,c)}):v.getContent().hasClassName("btn-create-and-close")&&(v.onClick=function(){d._createReferenceItem(!0,c)})}return d.modal},_createReferenceItem:function(e,t){for(var i,n,o,r,a=this,s={},l=0;l<a._inputElemList.length;l++)if("textBoxNameField"===(r=a._inputElemList[l]).type)i=r.element.value.trim();else if("dropDownTypeField"===r.type){if(!r.element.value||""==r.element.value)return g.alertMessage("error",null,C.req_field_error_header,C.replace(C.error_field_reqd,{field:r.label})),r.element.getContent().getElement("input").addClassName("error-empty-field"),void r.element.getContent().focus();n=r.element.value,localStorage.setItem("prevSelSubType",n)}else{if("checkBox"===r.type)o=r.element.checkFlag;else if(o=r.element.value,r.required&&(!o||""==r.element.value))return g.alertMessage("error",null,C.req_field_error_header,C.replace(C.error_field_reqd,{field:r.label})),r.element.getContent().getElement("input").addClassName("error-empty-field"),void r.element.getContent().focus();s[r.key]=o}d.mask(a.modal.elements._contentDiv,C.msg_creating),(a.isReplaceCall&&a.replaceRefId&&a.replaceInsId?p.replaceWithNewRef(a.replaceRefId,a.replaceInsId,i,n,s):null===a.rootID?u.createNewItemReference(i,n,s):u.createNewItemInstance(a.parentID,a.rootID,i,n,s)).then(function(i){if(d.unmask(a.modal.elements._contentDiv),null!==a.rootID||a.isReplaceCall)if(a.isReplaceCall&&a.replaceRootId)if(document.getElementById("create-logicalref-immersiveFrame").destroy(),200==i.status||i.member){var n=i.member?i.member[0]:null;if(n)(o=t.getMappedNodesFromId(a.parentItem.options.physicalid))||(o=[selectedNode]),f.replaceNodeOnReplaceByNewRef({treeNodeToBeReplaced:a.parentItem,mappedNodes:o,treeDocument:t,instanceData:n,parentRefId:a.parentItem.getParent().options.physicalid});g.alertMessage("success",null,"",C.msg_replace_success)}else g.alertMessage("error",null,"",i.message);else{var o;if(e&&document.getElementById("create-logicalref-immersiveFrame").destroy(),i&&i.member)(o=t.getMappedNodesFromId(a.parentItem.options.physicalid))||(o=[a.parentItem]),f.addChildrenToParent(t,o,i.member,!0)}else document.getElementById("create-logicalref-immersiveFrame").destroy(),h.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:i.id?i.id:i.physicalid}})},function(e){document.getElementById("create-logicalref-immersiveFrame").destroy(),g.displayError(e,null,null,C.error_create_item)})},manageEmptyField:function(e,t){t&&(e.value&&e.value.length>0?e.getContent().getElement("input").removeClassName("error-empty-field"):e.getContent().getElement("input").addClassName("error-empty-field"))}}}),define("DS/CATFLCockpitWidget/components/CreateLogicalItemModal/CreateLogicalItemHelper",["DS/CATFLCockpitWidget/utils/config.util","DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/CreateLogicalItemModal/logRef.createPanel.modalWindow","DS/CATFLCockpitWidget/components/CreateLogicalItemModal/SAXPLMNew/SAXPLMNewCmdUtils","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s){"use strict";var l=e.getFullConfig(),c=l.identifiers;return{createNewLogicalItem:function(e){var t=null,i=!1;!e.isRoot&&e.treeDocument&&(t=0===e.treeDocument.getSelectedNodes().length?e.treeDocument.getRoots()[0]:e.treeDocument.getSelectedNodes()[0]),e.data&&e.data.isReplaceCall&&(i=!0),l.adminStatus.NewCreationPanelEnabled?this.createNewPLMNew({parentItem:t,isReplaceCall:i,treeDocument:e.treeDocument}):this.createNewSAX({parentItem:t,isReplaceCall:i,treeDocument:e.treeDocument})},createNewSAX:function(e){let a=widget.body.querySelector(".fl-cockpit-app-container");t.mask(a,s.msg_loading),n.getCustomField(e.parentItem).then(function(l){var d=c.param_subtype_key;o.getParameterizationSetting([d]).then(function(o){var c=!o||o[d];if(c){let o="";e.parentItem&&e.parentItem.options.grid&&e.parentItem.options.grid.actualType&&(o=e.parentItem.options.grid.actualType),n.getSubTypes(o).then(function(n){n&&Object.keys(n).length>0?r.create(a,e.parentItem,l,e.isReplaceCall,c,n,e.treeDocument):i.alertMessage("info",null,s.warn_instantiation_not_allowed),t.unmask(a)},function(){i.alertMessage("error",null,s.error_get_subtypes),t.unmask(a)})}else r.create(a,e.parentItem,l,e.isReplaceCall,c,null,e.treeDocument),t.unmask(a)},function(){t.unmask(a)})},function(){t.unmask(a)})},createNewPLMNew:function(e){a.init(e)}}}),define("DS/CATFLCockpitWidget/utils/gridview.util.extended",["DS/UIKIT/Mask","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/implementlink.service"],function(e,t,i,n,o,r,a){"use strict";let s=i.getFullConfig(),l=s.identifiers,c=s.localStorageKeys;return{expandNFetchOtherNodes:function(i,n,o){var r;if("-1"===o){if(0===(r=n.getAllDescendants().filter(function(e){return!(e.options.type!==l.type_act_logref||!e.options.instance)&&!e.options.hasBeenExpanded})).length)return void n.expandAll()}else if(0===(r=n.getChildren().filter(function(e){return!(e.options.type!==l.type_act_logref||!e.options.instance)&&!e.options.hasBeenExpanded})).length)return void n.expandNLevels({numberOfLevelsToExpand:o});return e.mask(i.collectionView.getContent()),n.expand(),t.createBatchServiceReqExecution(r,o,i,!0,n)},getExpandServicesForBatchCalls:function(e,i,o,r,a){let l=this,d=[],u=s.disableIndexAcceleration,p=widget.getValue(c.componentView),g=!1;if(!o){let n=[];if(e.forEach(function(e){("1"!==r||"1"===r&&!e.options.noIndexOrDBExpand)&&n.push(e)}),u)d.push(l.addDBExpandForBatch(n,i,r,a));else{var m=t.sortNodesIntoDBandIndex(n,!0);m.indexNodes.length>0&&d.push(l.addIndexExpandForBatch(m.indexNodes,i,r,a)),m.databaseNodes.length>0&&d.push(l.addDBExpandForBatch(m.databaseNodes,i,r,a))}p===c.structuredView&&("2"!==r&&"-1"!==r||(g=!0),d.push(l.addOccImplementLinksToNodesInBatch(e,null,null,{bExpand:g})))}let f=[],h=[];if(u)f=e;else{let i=t.sortNodesIntoDBandIndex(e,!1);f=i.databaseNodes,h=i.indexNodes}let v=["SPECIFICATION_DOCUMENT","PROPOSED_SOLUTION","REFERENCE_DOCUMENT","IMPLEMENTING_LINK","IMPLEMENTEDBY_LINK"];return o||"2"!==r&&"-1"!==r||(g=!0),f.length>0&&d.push(n.addDBNavigate(f,{navigateTypes:v,bExpand:g})),h.length>0&&d.push(n.addIndexNavigate(h,{navigateTypes:v,bExpand:g})),Promise.all(d)},addIndexExpandForBatch:function(e,t,i,r){let a,s=this,l=[],c={},d={},u=widget.getValue("ngFilter");if(u&&u.length>0){if("1"!==i){let t=[];return e.forEach(function(e){t.push(s.expandNFetchOtherNodes(r,e,i))}),Promise.all(t)}return Promise.resolve()}return e.forEach(function(e){if(a||(a=e.getTreeDocument()),"1"!==i||"1"===i&&!e.options.noIndexOrDBExpand){l.push(e.options.physicalid);let t=e.getOccurencePath();c[t[0]]?c[t[0]].push(t):c[t[0]]=[t],d[e.options.physicalid]=e}}),l.length<=0?Promise.resolve():o.progressiveExpand({rootWithPaths:c,configFilter:t,expandLevel:parseInt(i)}).then(function(o){n.createTreeDocumentFromIndexResponse(o,a,a.getRoots()[0],t);let l=[];return e.forEach(function(e){"1"!==i&&l.push(s.expandNFetchOtherNodes(r,e,i))}),Promise.all(l)})},addDBExpandForBatch:function(e,t,i,o){let a=this;0;let s,l=[],c={},d=widget.getValue("ngFilter");if(d&&d.length>0){if("1"!==i){let t=[];return e.forEach(function(e){t.push(a.expandNFetchOtherNodes(o,e,i))}),Promise.all(t)}return Promise.resolve()}return e.forEach(function(e){s||(s=e.getTreeDocument()),("1"!==i||"1"===i&&!e.options.noIndexOrDBExpand)&&(l.push(e.options.physicalid),c[e.options.physicalid]=e)}),l.length<=0?Promise.resolve():r.expand({itemIDs:l,depth:"-1"===i?"0":i,configFilter:t}).then(function(t){let r=[];return e.forEach(function(e){let l=e.options.physicalid;n.addDBExpandCallBack(e,null,t[l],s),"1"!==i&&r.push(a.expandNFetchOtherNodes(o,e,i))}),Promise.all(r)})},addOccImplementLinksToNodesInBatch:function(e,t,i,o){for(var r={},s=0;s<e.length;s++)e[s].isRoot()||(r[e[s].options.instance.physicalid]=e[s]);return 0,widget.getValue(c.componentView)!==c.structuredView?Promise.resolve():a.getInstanceImplementLinks(e,!0).then(function(e){0,e&&((o=o||{}).keepNodes=!0,t&&t.prepareUpdate(),e.forEach(function(e){n.manageImplementLinkResp(e.node,"inst",e,o)}),t&&t.pushUpdate()),i&&i()})}}}),define("DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.actions",["DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/CATFLCockpitWidget/components/AttributesManagement/AttributesManagement","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/gridview.util.extended","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p){"use strict";var g=s.getFullConfig(),m=g.localStorageKeys;return{openAttributesManagementForProposedSolution:function(e){for(var t=[],i=0;i<e.length;i++)-1===t.indexOf(e[i].options.type)&&t.push(e[i].options.type);new n(!0,t,null)},getNodeInfoForEffectivity:function(e,t){var i,n=[];return t.forEach(function(t){i=t.getParent();var o={context:e,physicalid:t.options.instance.physicalid,label:t.options.grid.instanceName||t.options.label,type:t.options.type,parent:{physicalid:i.options.physicalid,label:i.options.label,type:i.options.type},nodeModel:t};n.push(o)}),n},replaceByNewRevision:function(t,i,n){e.mask(i.collectionView.getContent(),p.msg_processing);for(var o=[],a=[],c=[],u=[],g=n?p.label_replace_new_branch_report:p.label_replace_new_rev_report,f=0;f<t.length;f++){if(!t[f].options.instance||!t[f].options.instance.physicalid)return e.unmask(i.collectionView.getContent()),void l.createReportStatusPanel(g,{error:[p.msg_remove_root]});a.push(t[f].options.physicalid),c.push(t[f].getParent().options.physicalid),o.push({replaceWith:n?"newBranch":"newRevision",instanceID:t[f].options.instance.physicalid}),u.push(t[f])}for(f=0;f<c.length;f++)if(a.includes(c[f]))return e.unmask(i.collectionView.getContent()),void l.createReportStatusPanel(g,{error:[p.msg_Replace_Parent_Child]});r.replaceWithNewRevision(o).then(function(t){if(e.unmask(i.collectionView.getContent()),200===t.status||t.member){for(var n=t.member?t.member:null,o=[],r={},a=[],f=0;f<c.length;f++)s.SAXStorage().setItem(m.recentlyAuthoredStructure+c[f],Date.now());n&&(u.forEach(function(e,t){var s=e.options.instance.physicalid;a.push(e.options.label);var l=i.collectionView.treeDocument.getMappedNodesFromId(e.options.physicalid);l||(l=[e]);for(var c=l.length-1;c>=0;c--){var d=l[c];d.options.instance.physicalid===s&&(i.collectionView.treeDocument.removeFromMappedNodes(d),d.removeChildren(),d.collapse(),d.updateOptions({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,configContexts:void 0,physicalid:n[t].reference,instance:{physicalid:n[t].id},grid:{instanceName:n[t].name,physicalid:n[t].reference,configCtx:void 0}}),d.setRelationID(n[t].id),i.collectionView.treeDocument.addToMappedNodes(d))}o.push(n[t].reference),r[n[t].id]=e}),d.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:o,tagAsRecentlyAuthored:!0}}),d.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-inst-by-id",data:{instIdMap:r,bInstance:!0,bEffectivity:!0}}));var h=a.map(e=>e+" "+p.msg_replace_success);l.createReportStatusPanel(g,{success:h})}else l.createReportStatusPanel(g,{error:[t.message]})}).catch(function(t){e.unmask(i.collectionView.getContent()),l.displayError(t,null,null,p.error_repl_failed)})},reparentAction:function(e,t,i){i.instances.every(function(e){return!e.options.grid.architectureNumber||""===e.options.grid.architectureNumber})?this.showGenericConfirmWindow(e,t,i):g.adminStatus.ReparentEnforceSetAN?o.setArchitectureNumber(i.instances,{newParent:e[0],params:t}):this.showGenericConfirmWindow(e,t,i)},showGenericConfirmWindow:function(n,o,a){for(var s=0;s<a.instances.length;s++)if(n[0].options.physicalid===a.instances[s].options.physicalid)return void l.alertMessage("error",null,p.msg_reparent_cyclic_error);var d=a.nameList,u=new t({title:p.label_reparent,content:UWA.createElement("p",{html:p.msg_reparent_confirm+n[0].options.label+" ? <br>"+d}),modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new i({label:p.label_reparent,emphasize:"primary",onClick:function(){u.close(),e.mask(o.collectionView.getContent(),p.msg_processing);var t=[];a.instances.forEach(function(e){t.push({parentID:n[0].options.physicalid,instanceID:e.options.instance.physicalid,itemID:e.options.physicalid})}),r.reparentInstances(t).then(function(e){c.refreshNodesOnReparent({resp:e,params:o,newParent:n[0],instArray:a.instances})},function(t){e.unmask(o.collectionView.getContent()),l.displayError(t,null,null,p.error_reparent_failed)})}}),Cancel:new i({emphasize:"secondary",onClick:function(){u.close()}})}});return u.addEventListener("close",function(){u.destroy()}),u},checkInstanceCount:function(e,t){a.expandV2({forSynthesis:{IDs:e[0].options.physicalid,configFilter:t},synthType:"Flat"}).then(function(e){var t=null;e=e.slice(0,-2),(e=JSON.parse(e)).results&&(t=((t=e.results[0].synthesis.value)-1)/2)&&t>1e3&&l.alertMessage("warning",null,p.replace(p.msg_expand_largeData_warning))},function(){l.alertMessage("error",null,"",p.msg_generic_error_get_failed)})}}}),define("DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.actions",["UWA/Core","DS/UIKIT/Scroller","DS/Handlebars/Handlebars4","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","text!DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCueActions.html","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m){"use strict";var f=JSON.parse(p);return{displayCuesActionsonInstance:function(e,t,i){var n=this;n.container=t.triptych._rightPanelContent,n.cueActionsInfo={},n.userPref=e,n.appContext=t,n.rowData=i,n.refresh(),n.container.getElementsByClassName("EditProp_MasterContain")[0].hide(),n.appContext.triptych.modelEvents.subscribe({event:"triptych-hide-panel"},function(e){if("right"===e){var t=n.container.getElementsByClassName("EditProp_MasterContain");t&&t[0].isHidden()&&t[0].show()}}),n.appContext.triptych.modelEvents.publish({event:"triptych-show-panel",data:"right"})},getCuesActionlistContent:function(){var n=this.cuesContainer=e.createElement("div",{class:"ConvergenceCues_ActionsContainer"}),o=i.compile(g),r={};r.header=m.replace(m.header_cues_actions,{title:this.rowData.instParentTitle}),r.cueRows=this.getCuesRowListContent(this.cuesActionList),n.addContent(o(r));var a=n.getElement(".actionlist-container").remove(),s=n.getElement(".container-scroll");return new t({element:a}).inject(s),this.manageEvents(),this.subscribeToEvents(),n},getCuesRowListContent:function(t){var i=this,o=[];if(t){var r;i.cueMsgList={};var a,s=n.getWebappsAssetUrl("CATFLCockpitWidget","icons")+"/I_RFLPLMImplementConnection.png",l=widget.getValue("currentConfig"),c=!1;l&&l.modelVersion&&(l.modelVersion.current===f.state_act_Release||l.modelVersion.current===f.state_act_Obsolete)?c=!0:i.rowData.nodeModel.options.grid.maturity!==f.state_act_Released&&i.rowData.nodeModel.options.grid.maturity!==f.state_act_Obsolete||(c=!0),t.forEach(function(t){i.cueActionsInfo[t.id]=t;var n=t.msg,l={};n.indexOf("\n")>=0&&n.split("\n").forEach(function(e,t){0===t?n=e:n+=" <br> "+e});if(t.itemsInfo){var d=[];t.itemsInfo.forEach(function(t,i){if(d.indexOf(t.itemPhysicalId)<0){d.push(t.itemPhysicalId),l[i]=t,t.displayText=t.itemTitle+" "+t.itemRevision;var o=e.createElement("div",{id:i,draggable:!0,class:"drag-text",html:' <span class="wux-ui-3ds wux-ui-3ds-lg wux-ui-3ds-drag-grip"></span> '+t.displayText+" "});let a=new RegExp(`(?:^|\\W)${t.displayText}(?:$|\\W)`,"g");var r=n.split(a);r.length>=0&&r.forEach(function(e,t){0===t?n=r[t]:n+=" "+o.outerHTML+" "+r[t]})}})}n=n.replace(" <br> ","<br>"),i.cueActionsInfo[t.id].cueLinks=l,a=t.icon&&t.icon.indexOf("https")>=0?t.icon:s,r={cueId:t.id,cueSeverity:t.severity.toUpperCase(),cueImg:a,cueTitle:t.title,cueSubtitle:n},f.cues_with_actions.indexOf(t.id)>=0&&!c&&(r.isLink="link"),o.push(r)})}return o},manageEvents:function(){var e=this;e.cuesContainer.getElements(".drag-text").forEach(function(t){t.addEventListener("dragstart",function(t){var i=t.target.getParent().getParent().getParent().id,n=e.cueActionsInfo[i].cueLinks[t.target.id],r={protocol:"3DXContent",version:"1.1",source:widget&&widget.getValue("appId"),widgetId:widget.id,data:{items:[{envId:o.getTenant(),serviceId:"3DSpace",contextId:"ctx::"+o.getSecurityContext(),objectId:n.itemPhysicalId,objectType:n.itemType,displayName:n.displayText}]}};t.dataTransfer.setData("Text",JSON.stringify(r))})}),e.cuesContainer.getElements(".link").forEach(function(t){t.addEventListener("click",function(t){var i=t.target.getParent().getParent().id;e.manageActionLinks(i,e.rowData)})})},subscribeToEvents:function(){s.getFLWebModelEventsObj("flweb-model-events");s.getFLWebModelEventsObj("flcockpit-content-list-view").subscribe({event:"refresh-cues-report"},this.refresh.bind(this))},manageActionLinks:function(e,t){"ENOXSolutionsCueNoSolution"===e?d.openModalSolutionSelection([t.nodeModel]):"ENOXSpaceAssignmentsCueNoAssignment"!==e&&"ENOXSpaceAssignmentsCueMultipleAssignments"!==e||("ENOXSpaceAssignmentsCueMultipleAssignments"!==e||t.nodeModel.options.assignedSpacesPID?new u(t.nodeModel):a.addAssignedSpacesAttribute([t.nodeModel]).then(()=>{new u(t.nodeModel)}))},refresh:function(){var e=this.container.getElementsByClassName("ConvergenceCues_ActionsContainer");e&&e[0]&&e[0].destroy(),this.getCuesReport()},getCuesReport:function(){var e=this,t=e.userPref.cues_state,i=Object.values(t),n=e.userPref.combined_state,o=e.rowData.nodeModel,r=!1;o.options.cueDetails&&"group"===o.options.cueDetails.cue&&(r=!0);var a=c.confAllImplPathsOnNodes([o],!1,!1);l.getCuesReportOnInstance(i,e.rowData.instanceID,a.payload).then(function(i){if(i){var o=i[e.rowData.instanceID],a=i.cueNLSInfo,s={};if(e.cuesActionList=[],o&&(o.forEach(function(i){s=t[i.cueId];var n=i.cueMessageInfo;e.cuesActionList.push({id:i.cueId,title:i.cueLabel,icon:i.cueIcon,msg:n?n.Message:i.cueMessage,severity:s?s.cueSeverity:"",itemsInfo:n?n.RelatedObjects:null})}),r&&n&&n.active)){var l="<b>"+m.label_operator+": "+m["label_operator_"+n.operator]+"</b>\n";for(var c in n.combinedCues)if(n.combinedCues.hasOwnProperty(c)){var d=n.combinedCues[c];l+=a[c]+" = "+m["val_"+d]+"\n"}var u={id:"combined_conv_state",title:m.header_combined_convg_cues,msg:l,severity:"COMBINED",itemsInfo:null};e.cuesActionList.splice(0,0,u)}var p=e.getCuesActionlistContent(),g=e.container.getElementsByClassName("ConvergenceCues_ActionsContainer");g&&g[0]&&g[0].destroy(),p.inject(e.container)}})}}}),define("DS/CATFLCockpitWidget/components/IDCard/decorators/idcard.dropdown-menu",["DS/CATFLCockpitWidget/components/ExportCSV/ExportCSV","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/ArchitectureNumber/monoInstantiationStatus","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","DS/CATFLCockpitWidget/commands/RelatedObjectCmd","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/SAXTracker","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l){"use strict";var c=r.getFullConfig();let d=c.identifiers,u=c.localStorageKeys;return{createIDCardDropdownMenu:function(r){let c=this,p=c.activeModelVersion?c.activeModelVersion:null,g=c.itemData,m=!1;(!p||p.current!==d.state_act_Release&&p.current!==d.state_act_Obsolete)&&(!g||g.attributes.grid.maturity!==d.state_act_Released&&g.attributes.grid.maturity!==d.state_act_Obsolete)||(m=!0);let f=widget.getValue("component-view");return{content:[{name:"setArchNo",type:"PushItem",fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-progress-3"},title:l.set_architecture_number,action:{callback:function(){let e=r.itemData.physicalid;a.trackCommandLaunched("setArchitectureNumber-sax"),t.setArchitectureNumber(e)}},state:m?"disabled":"enabled"},{name:"setConfigCtx",type:"PushItem",fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-3dproduct-pencil"},title:l.action_edit_config_ctx,action:{callback:function(){r.contentView&&r.contentView.getTreeDocument().unselectAll();let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label,i=[{context:c,physicalid:e,label:t,type:r.itemData.type}];n.init("EditConfigurationContextCmd",i)}}},{name:"setConfigCriteria",type:"PushItem",fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-configuration-effectivity"},title:l.action_select_config_critera,action:{callback:function(){r.contentView&&r.contentView.getTreeDocument().unselectAll();let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label,i=r.contentView.getTreeDocument().getRoots()[0],o=[{context:c,physicalid:e,label:t,type:r.itemData.type,treeData:i}];n.init("SelectByConfigurationCriteriaCmd",o)}}},{type:"SeparatorItem"},{name:"revisions",type:"PushItem",title:l.revisions,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-flow-branch-list"},action:{callback:function(){var e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;n.init("HistoryCommand",[{physicalid:e,label:t,type:r.itemData.type,displayType:r.itemData.attributes.grid.type,revision:r.itemData.attributes.grid.revision,current:r.itemData.attributes.grid.maturity,icons:r.itemData.attributes.grid.icons}])}}},{name:"revisionExplorer",type:"PushItem",title:l.revision_explorer,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-flow-branch"},action:{callback:function(){c.versionExplHandler.apply(c)}}},{name:"duplicate",type:"PushItem",title:l.duplicate,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-duplicate"},action:{callback:function(){let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;n.init("DuplicateCommand",[{physicalid:e,type:r.itemData.type,label:t,displayType:r.itemData.attributes.grid.type,revision:r.itemData.attributes.grid.revision,current:r.itemData.attributes.grid.maturity,icons:r.itemData.attributes.icons}])}}},{name:"compareWith",type:"PushItem",title:l.compare,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-part-compare"},action:{callback:function(){let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;n.init("CompareCmd",[{physicalid:e,label:t}])}}},{name:"maturity",type:"PushItem",title:l.maturity,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-collaborative-lifecycle-management"},action:{callback:function(){let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;n.init("MaturityCommand",[{physicalid:e,label:t}])}}},{type:"SeparatorItem"},{name:"reserve",type:"PushItem",title:l.action_lock,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-lock"},action:{callback:function(){let e,t,i,o=r.itemData.physicalid;t=null,i=o,(e=[]).push({physicalid:o,relID:"",parent:{physicalid:""}}),n.init("ReserveCmd",e)}},state:m?"disabled":"enabled"},{name:"unreserve",type:"PushItem",title:l.action_unlock,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-lock-open"},action:{callback:function(){let e,t,i,o=r.itemData.physicalid;t=null,i=o,(e=[]).push({physicalid:o,relID:"",parent:{physicalid:""}}),n.init("UnreserveCmd",e)}},state:m?"disabled":"enabled"},{name:"moveTo",type:"PushItem",title:l.action_move_to,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-user-change"},action:{callback:function(){let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;n.init("ChangeOwnerCommand",[{physicalid:e,type:r.itemData.type,label:t,displayType:r.itemData.attributes.grid.type,revision:r.itemData.attributes.grid.revision,owner:r.itemData.attributes.grid.owner,icons:r.itemData.attributes.icons}])}}},{name:"share",type:"PushItem",title:l.action_share,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-forward"},action:{callback:function(){let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;n.init("ShareCmd",[{physicalid:e,type:r.itemData.type,label:t,displayType:r.itemData.attributes.grid.type,revision:r.itemData.attributes.grid.revision,owner:r.itemData.attributes.grid.owner,icons:r.itemData.attributes.icons}])}}},{type:"SeparatorItem"},{name:"relatedObjs",type:"PushItem",title:l.relations,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-object-related"},action:{callback:function(){o.execute("ENORIPE_AP",new s(c.itemData.attributes))}}},{name:"ANUnicity",type:"PushItem",title:l.action_architecture_number_unicity_effectivity,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-progress-3-ok"},action:{callback:function(){a.trackCommandLaunched("architectureNumberUnicityonEvolution-sax"),c.idcardModelEvents.publish({event:"check-unicity-AN"})}},state:widget.getValue("modelAttached")&&f!==u.flattenedView&&f!==u.flattenedViewOnlyArchitectureItem?"enabled":"disabled"},{type:"PushItem",title:l.action_export,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-export"},submenu:[{name:"exportStructure",type:"PushItem",title:l.action_export_structure,action:{callback:function(){let t=r.itemData.physicalid,i=r.itemData.label?r.itemData.label:r.itemData.attributes.label;a.trackCommandLaunched("exportStructure-sax"),new e(t,i,{model:c.activeModel,modelVersion:c.activeModelVersion,pc:c.activePC})}}},{name:"monoInstant",type:"PushItem",title:l.action_mono_instantiation_status,action:{callback:function(){let e=r.itemData.physicalid,t=r.itemData.label?r.itemData.label:r.itemData.attributes.label;a.trackCommandLaunched("exportArcNumberUnicityInStructure-sax"),i.downloadStatus(e,t,{model:c.activeModel,modelVersion:c.activeModelVersion,pc:c.activePC})}}}]},{name:"customizeHeader",type:"PushItem",title:l.customize_header,fonticon:{family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-cog"},action:{callback:function(){c.idcardModelEvents.publish({event:"open-idcard-manage-displayed-attributes"})}}}],callbacks:{onShow:function(){},onHide:function(){}}}},updateIDCardDropdownMenu:function(){let e=this.activeModelVersion?this.activeModelVersion:null,t=this.itemData,i=!1,n=widget.getValue("component-view");(!e||e.current!==d.state_act_Release&&e.current!==d.state_act_Obsolete)&&(!t||t.attributes.grid.maturity!==d.state_act_Released&&t.attributes.grid.maturity!==d.state_act_Obsolete)||(i=!0),this._dropdownMenu.content.forEach(e=>{"setArchNo"===e.name||"reserve"===e.name||"unreserve"===e.name?(e.state=i?"disabled":"enabled","disabled"===e.state?e.tooltip={shortHelp:l.tootlip_disabled_command_released_obsolete}:e.tooltip=null):"ANUnicity"===e.name&&(e.state=widget.getValue("modelAttached")&&n!==u.flattenedView&&n!==u.flattenedViewOnlyArchitectureItem?"enabled":"disabled","disabled"===e.state?e.tooltip={shortHelp:l.tootlip_disabled_command_unicity_AN}:e.tooltip=null)})}}}),define("DS/CATFLCockpitWidget/components/ContentListView/decorators/contentlistview.dragdrop",["DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.actions","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/gridview.dnd.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/implementlink.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l){"use strict";var c=o.getFullConfig();return{addDragAndDropBehaviorToContentView:function(){var o=this;o.contentView.onDragStartCell=function(e){return e.dataTransfer.setData("Text",JSON.stringify(i.create3DXJsonFromDGVSelection(o.contentView.treeDocument.getSelectedNodes()))),!0},o.contentView.onDragStartRowHeader=function(e,t){return e.dataTransfer.setData("Text",JSON.stringify(i.create3DXJsonFromDGVSelection([t.nodeModel]))),!0},n.makeGridViewDroppable({contentView:o.contentView,acceptDrop:function(e,t){if(t.nodeModel&&widget.getValue("component-view")===c.localStorageKeys.structuredView){var i=null;if("middle"===t.dropPosition)i=t.nodeModel;else if("top"===t.dropPosition||"bottom"===t.dropPosition){if(t.nodeModel.isRoot())return!1;i=t.nodeModel.getParent()}if(!i||i&&(i.options.type.includes("Category")||!0===i.options.virtual||i.options.linkInfo))return!1;if(t.draggedNodes){for(var n=0;n<t.draggedNodes.length;n++)if(t.draggedNodes[n].isAscendantOf(i))return!1;return!0}return!0}return!1},onDropCallback:function(n,c){var d=null;"middle"===c.dropPosition?d=c.nodeModel:"top"!==c.dropPosition&&"bottom"!==c.dropPosition||(d=c.nodeModel.getParent());var u=n.dataTransfer?JSON.parse(n.dataTransfer.getData("Text")):null,p=c.droppedNodes;if(d&&p&&p.length>0){var g,m="";if(p.map(e=>e.isRoot()?void 0:e.getParent().getID()).every(e=>e===d.getID()))return void i.alertMessage("warning",l.msg_error_reparent,"",l.msg_warning_reparent_same_parent);for(var f=0;f<p.length;f++){if(p[f].isRoot())return void i.alertMessage("error",l.msg_error_reparent,"",l.msg_remove_root);if(!p[f].options.instance||!p[f].options.instance.physicalid)return void(p[f].options.linkInfo?i.alertMessage("error",l.msg_error_reparent,"",l.msg_error_reparent_impl_link):i.alertMessage("error",l.msg_error_reparent,"",l.msg_error_reparent_logical_instances));m=m+p[f].options.label+"<br>"}g={instances:p,nameList:m};var h={openFromToolbar:!1,collectionView:o.contentView};g&&e.reparentAction([d],h,g)}else if(d&&u){var v=u.data.items;v&&v.length&&a.getKindOfRFLP(v.map(e=>e.objectId)).then(function(e){if(n.altKey)if(v.length===e.length&&e.every(e=>"R"===e||"F"===e||"L"===e||"P"===e)){var a=[];v.forEach((t,i)=>{var n={};"P"===e[i]?(n.implementing=t.objectId,n.implemented=d.options.physicalid):(n.implementing=d.options.physicalid,n.implemented=t.objectId),a.push(n)}),s.createScopeLinks(a).then(function(){r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-refLinks-by-id",data:[d]}),i.alertMessage("success","",l.msg_ref2ref_create_success)}).catch(function(e){i.displayError(e,null,null,l.error_create_refref_link)})}else i.alertMessage("error",l.msg_invalid_type,l.msg_drop_invalid_type_RFLP);else if(v.length===e.length&&e.every(e=>"L"===e)){var c=v.map(function(e){return{id:e.objectId,"ds6w:label":e.displayName,"ds6wg:revision":""}});t.addExistingItemAsInstance(d,o.contentViewContainer,o.contentView.treeDocument,c)}else i.alertMessage("error",l.msg_invalid_type,l.msg_drop_invalid_type_Logical)}).catch(function(){n.altKey?i.alertMessage("error",null,l.msg_error_drop_add_alt):i.alertMessage("error",null,l.msg_error_drop_add)})}},getTextInvite:function(e,t,i){return i?t.draggedNodes?{text:l.msg_drop_to_reparent,icon:"plus"}:e.altKey?{text:l.msg_drop_to_create_link,icon:"plus"}:{text:l.msg_drop_to_add,icon:"plus"}:widget.getValue("component-view")!==c.localStorageKeys.structuredView?{text:l.error_action_unavailable_in_flattened_view,icon:"block"}:void 0}})}}}),define("DS/CATFLCockpitWidget/components/IDCard/idcard.controller",["DS/CoreEvents/ModelEvents","DS/ENOXIDCard/js/IDCard","DS/Controls/TooltipModel","DS/CATFLCockpitWidget/components/IDCard/decorators/idcard.database-icon","DS/CATFLCockpitWidget/components/IDCard/decorators/idcard.dropdown-menu","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/predicate.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/preferences.util","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m){"use strict";var f=d.getFullConfig(),h=f.identifiers;function v(e){return e.replace(/[^A-Z0-9_-]/gi,"_").replace(/[\.:]/gi,"_")}return{init:function(i,o,r,a,s,l,c){var d=this;return d.activeItem={},d.activeModel={},d.activeModelVersion={},d.activePC={},d.idcardModelEvents=new e,d.itemData=o.itemData,d.getClassificationAttributesOnItem(d.itemData).then(function(e){return o.classifiedData=e,d.createIDCardModel(o,a).then(function(e){d.idcardModel=e,d.subscribeToIdCardEvents(),d.subscribeToGlobalEvents();var o=new t({model:d.idcardModel});o.render().inject(i),o.attachResizeSensor(),d.idcard=o;return a?(d.enableActionOnNavigate("navigateBackward"),c&&d.updateTooltipOnNavigate("navigateBackward",m.go_back_to+c.attributes.label)):d.disableActionOnNavigate("navigateBackward"),s?(d.enableActionOnNavigate("navigateForward"),l&&d.updateTooltipOnNavigate("navigateForward",m.go_forward_to+l.attributes.label)):d.disableActionOnNavigate("navigateForward"),n.addDatabaseIcon(d.idcard),d.retreiveSavedAttributesCustomHeaderView(),r.subscribe({event:"triptych-panel-visible"},function(e){"right"===e&&o.toggleInformationIcon(!0)}),r.subscribe({event:"triptych-panel-hidden"},function(e){"right"===e&&o.toggleInformationIcon(!1)}),d.parentContainer=i.parentElement,d.parentContainer.classList.add("flweb-cockpit-idcard-minified"),d})})},subscribeToIdCardEvents:function(){var e=this;e.idcardModelEvents.subscribe({event:"idcard-open-modelVersion-selector"},e.modVerNameClickHandler.bind(e)),e.idcardModelEvents.subscribe({event:"idcard-open-configuration-selector"},e.configurationClickHandler.bind(e)),e.idcardModelEvents.subscribe({event:"idcard-open-version-explorer"},e.versionExplHandler.bind(e)),e.idcardModelEvents.subscribe({event:"idcard-minified"},function(){document.body.querySelector(".fl-cockpit-triptych-main-container").classList.add("flweb-cockpit-idcard-minified"),e.parentContainer.classList.add("flweb-cockpit-idcard-minified")}),e.idcardModelEvents.subscribe({event:"idcard-expanded"},function(){document.body.querySelector(".fl-cockpit-triptych-main-container").classList.remove("flweb-cockpit-idcard-minified"),e.parentContainer.classList.remove("flweb-cockpit-idcard-minified")}),e.idcardModelEvents.subscribe({event:"idcard-attributes-clicked"},e.attributeClickHandler.bind(e,{id:e.itemData.physicalid,type:e.itemData.type,name:e.itemData.attributes.label})),e.idcardModelEvents.subscribe({event:"idcard-open-actions-menu"},function(){o.updateIDCardDropdownMenu.call(e)}),e.idcardModelEvents.subscribe({event:"saved-displayedAttributes-idcard"},function(e){var t={};for(var i of Object.keys(e.savedAttributes))t[i]={id:e.savedAttributes[i].attribute.id,displayWhenMinified:e.savedAttributes[i].attribute.displayWhenMinified,visibility:e.savedAttributes[i].visibility,order:e.savedAttributes[i].order};u.saveCustomHeaderView(t)})},subscribeToGlobalEvents:function(){if(!r.getSubscriptionList().includes("idCardController")){var e=r.getFLWebModelEventsObj("flweb-model-events");e.subscribe({event:"idcard-refresh"},this._refreshIDCardInformation.bind(this)),e.subscribe({event:"mod-PC-selection-successful"},this._updateIDCardOnConfigSelectionDone.bind(this)),e.subscribe({event:"allmod-selection-successful"},this._updateIDCardOnAllModelSelection.bind(this)),e.subscribe({event:"mod-selection-removed"},this._updateIDCardOnModelRemoved.bind(this)),e.subscribe({event:"flweb-ngfilter-added"},this.updateNGFilter.bind(this)),e.subscribe({event:"flweb-ngfilter-removed"},this.updateNGFilter.bind(this)),e.subscribe({event:"save-user-custom-attributes"},this.updateListAvailableAttributes.bind(this)),r.addToSubscriptionList("idCardController")}},createDataFullListAvailableAttributes:function(e,t){var i=this,n=e.attributes.grid.architectureNumber?e.attributes.grid.architectureNumber:m.label_none,o=(c.getUserCustomAttributes()||[]).filter(function(e){return e.bo}),r={};return l.getNLSPredicates(o).then(function(a){r=a||{};var s=[];return o.forEach(function(n){var o=i.parseValueIDCardData(n,e.attributes,t),a=v(n.curi);s.push({id:a,name:r[n.curi]||n.nls||n.curi,value:o,displayWhenMinified:!1,defaultVisibility:!1})}),[{id:"responsible",name:m.label_owner,value:e.attributes.grid.owner,displayWhenMinified:!0,type:"type-hyperlink",editable:!0,defaultVisibility:!0,icon:"wux-ui-3ds wux-ui-3ds-user",image:d.getUserImage(e.attributes.owner),defaultAttribute:!0},{id:"status",name:m.label_maturity,value:e.attributes.grid.maturity,displayWhenMinified:!0,editable:!0,defaultVisibility:!0,isMaturity:!0,defaultAttribute:!0},{id:"created",name:m.label_creation_date,value:c.displayDate(e.attributes.grid.creationDate),displayWhenMinified:!0,defaultVisibility:!0,defaultAttribute:!0},{id:"modified",name:m.label_modification_date,value:c.displayDate(e.attributes.grid.modificationDate),displayWhenMinified:!0,defaultVisibility:!0,defaultAttribute:!0},{id:"architectureNo",name:m.label_arch_no,value:n,type:"type-hyperlink",editable:!0,defaultVisibility:!0,defaultAttribute:!0}].concat(s)})},createIDCardModel:function(e,t){var i=this,n=e.itemData,r=e.classifiedData;i.setCurrentItem(n.physicalid,n.attributes.label,n.attributes.grid.revision),i._dropdownMenu=o.createIDCardDropdownMenu.call(i,e);var a=n.attributes.grid.description?n.attributes.grid.description:m.label_noDescription;return i.createDataFullListAvailableAttributes(n,r).then(function(e){return new UWA.Class.Model({minified:!0,id:n.physicalid,name:n.attributes.label,version:n.attributes.grid.revision,configuration:"",thumbnail:d.getServiceURL("3DSpace")+"/snresources/images/icons/large/I_VPMNavLogical108x144.png",withHomeButton:!0,showBackButton:!1,withExpandCollapseButton:!0,withActionsButton:!0,withInformationButton:!0,withToggleMinifiedButton:!0,withGenericButton:!0,enableNavigation:!0,withDivider:!0,modelEvents:i.idcardModelEvents,freezones:['<p title="'+a+'">'+a+"</p>"],fullListAvailableAttributes:e,customEvents:{versionModelLabelClick:{event:"idcard-open-modelVersion-selector"}},dropdown:i._dropdownMenu,securityContext:"ctx::"+d.getSecurityContext(),immersiveFrame:widget.immersiveFrame})})},updateIDCardData:function(e){e.forEach(function(e){var t=e.key,i=e.value,n=e.editable,o=e.image;if(e.isAttributeSet){for(var r=this.idcardModel.get("fullListAvailableAttributes"),a=[],s=0;s<r.length;s++)r[s].id!==t?a.push({id:r[s].id,name:r[s].name,value:r[s].value,editable:r[s].editable,type:r[s].type,displayWhenMinified:r[s].displayWhenMinified,defaultVisibility:r[s].defaultVisibility,icon:r[s].icon,image:r[s].image,isMaturity:r[s].isMaturity,defaultAttribute:r[s].defaultAttribute}):a.push({id:r[s].id,name:r[s].name,value:i,editable:n,type:e.type,displayWhenMinified:r[s].displayWhenMinified,defaultVisibility:r[s].defaultVisibility,icon:r[s].icon,image:o,isMaturity:r[s].isMaturity,defaultAttribute:r[s].defaultAttribute});this.idcardModel.set("fullListAvailableAttributes",a)}else this.idcardModel.set(t,i)}.bind(this))},_updateIDCardOnConfigSelectionDone:function(e){c.alertMessage("success",null,m.attachedConfigurationUpdated);var t=m.label_all;e.pc&&(t=e.pc.label?e.pc.label:e.pc.name),this.updateIDCardData([{key:"version",value:"",isAttributeSet:!1},{key:"modelVersion",value:e.modelVer.name,isAttributeSet:!1},{key:"versionModel",value:e.modelVer.revision,isAttributeSet:!1},{key:"configuration",value:t,isAttributeSet:!1}]),this.setCurrentModel(e.model.physicalid,e.model.id,e.model.name),this.setCurrentModelVersion(e.modelVer.physicalid?e.modelVer.physicalid:e.modelVer.id,e.modelVer.name,e.modelVer.revision,e.modelVer.backEndName,e.modelVer.current),null!==e.pc?this.setCurrentPC(e.pc.physicalid,e.pc.name,e.pc.revision,t):this.setCurrentPC(null,null,null,m.label_all),widget.setValue("currentConfig",{model:this.activeModel,modelVersion:this.activeModelVersion,pc:this.activePC,filterCompiledForm:e.filterCompiledForm})},_updateIDCardOnAllModelSelection:function(){this.updateIDCardData([{key:"version",value:"",isAttributeSet:!1},{key:"modelVersion",value:m.label_all_models,isAttributeSet:!1},{key:"versionModel",value:"",isAttributeSet:!1},{key:"configuration",value:"",isAttributeSet:!1}]),this.setCurrentModel(null,null,null),this.setCurrentModelVersion(null,null,null,null),this.setCurrentPC(null,null,null,null),widget.setValue("currentConfig",null)},_updateIDCardOnModelRemoved:function(){this.updateIDCardData([{key:"version",value:this.activeItem.revision?this.activeItem.revision:m.label_active_rev,isAttributeSet:!1},{key:"modelVersion",value:"",isAttributeSet:!1},{key:"versionModel",value:"",isAttributeSet:!1},{key:"configuration",value:"",isAttributeSet:!1}]),this.setCurrentModel(null,null,null),this.setCurrentModelVersion(null,null,null,null),this.setCurrentPC(null,null,null,null),widget.setValue("currentConfig",null),widget.setValue("modelAttached",null),c.alertMessage("success",null,m.attachedConfigurationRemoved)},attributeClickHandler:function(e,t){if(t.attributeName===m.label_owner){var i={};i.physicalid=e.id,i.label=e.name,i.type=e.type,i.displayType=this.itemData.attributes.grid.type,i.revision=this.itemData.attributes.grid.revision,i.owner=this.itemData.attributes.grid.owner,i.icons=this.itemData.attributes.icons,g.init("ChangeOwnerCommand",[i])}else if(t.attributeName===m.label_arch_no){var n=e.id;p.setArchitectureNumber(n)}},modVerNameClickHandler:function(){var e=this,t=widget.getValue("modelAttached"),i=[],n={};t.forEach(function(e){e.id||(i.push(e.physicalid),n[e.physicalid]=e)}),i.length>0?s.getItemInfo(i).then(function(i){(i=i.member).forEach(function(e){e.objectid&&(n[e.physicalid].id=e.objectid)}),t=Object.values(n),require(["DS/CATFLCockpitWidget/components/ModelPCSelector/configurationSelector"],function(t){t.init("MODELVERSION",e.itemData.physicalid,widget.getValue("modelAttached"),e.activeModelVersion)}.bind(e))}):require(["DS/CATFLCockpitWidget/components/ModelPCSelector/configurationSelector"],function(t){t.init("MODELVERSION",e.itemData.physicalid,widget.getValue("modelAttached"),e.activeModelVersion)}.bind(e))},configurationClickHandler:function(){var e=this,t=widget.getValue("ngFilter");t&&t.length>0?r.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-ngFilter-open"}):require(["DS/CATFLCockpitWidget/components/ModelPCSelector/configurationSelector"],function(t){t.init("PC",e.itemData.physicalid,e.activeModel,e.activeModelVersion,e.activePC,e.activeItem)}.bind(e))},versionExplHandler:function(){var e={};if(widget.getValue("modelAttached")){if(!this.activeModelVersion.id||!this.activeModel.physicalid)return void c.alertMessage("info",null,m.info_modelVersion_not_set);e.id=this.activeModelVersion.id,e.kind=h.type_modelVersion,e.model=this.activeModel,e.modelVer=this.activeModelVersion,e.itemData=this.activeItem,e.isConfigured=!1}else e.id=this.itemData.physicalid,e.kind=this.itemData.type,e.isConfigured=!0;require(["DS/CATFLCockpitWidget/components/VersionExplorer/versionexplorer.controller"],function(t){t.displayVersionGraph({modelKey:e})})},updateNGFilter:function(e){var t="";e.filterName||e.filterTitle?(t=e.filterTitle?"["+e.filterTitle+"]":"["+e.filterName+"]",this.updateIDCardData([{key:"version",value:"",editable:!1,isAttributeSet:!1},{key:"modelVersion",value:"",isAttributeSet:!1},{key:"versionModel",value:"",isAttributeSet:!1},{key:"configuration",value:t,editable:!1,isAttributeSet:!1}])):widget.getValue("modelAttached")&&!this.activeModelVersion.physicalid?this._updateIDCardOnAllModelSelection():this.updateIDCardData([{key:"version",value:this.activeModelVersion.revision?"":this.activeItem.revision,isAttributeSet:!1},{key:"modelVersion",value:this.activeModelVersion.name?this.activeModelVersion.name:"",isAttributeSet:!1},{key:"versionModel",value:this.activeModelVersion.revision?this.activeModelVersion.revision:"",isAttributeSet:!1},{key:"configuration",value:this.activePC.label,isAttributeSet:!1}])},_refreshIDCardInformation:function(){var e=this;Promise.all([a.getLogItemAttributes(e.itemData.physicalid),e.getClassificationAttributesOnItem(e.itemData)]).then(function(t){var i=t[0],n=t[1],o=i[e.itemData.physicalid].attributes,r=o.grid.architectureNumber||m.label_none;e.idcard.container.getElement(".free-zone-0").setHTML("<p>"+(o.grid.description||m.label_noDescription)+"</p>");var a=c.getUserCustomAttributes()||[],s=[];a.forEach(t=>{var i=e.parseValueIDCardData(t,o,n);s.push({key:v(t.curi),value:i,editable:!1,isAttributeSet:!0})}),e.updateIDCardData([{key:"name",value:o.label,editable:!1,isAttributeSet:!1},{key:"responsible",value:o.grid.owner,editable:!0,isAttributeSet:!0,image:d.getUserImage(o.owner)},{key:"status",value:o.grid.maturity,editable:!0,isAttributeSet:!0},{key:"modified",value:c.displayDate(o.grid.modificationDate),editable:!1,isAttributeSet:!0},{key:"architectureNo",value:r,editable:!0,isAttributeSet:!0}].concat(s)),e.itemData.attributes.label=o.label,e.itemData.attributes.maturity=o.maturity,e.itemData.attributes.grid.maturity=o.grid.maturity,e.itemData.attributes.grid.owner=o.grid.owner,e.itemData.attributes.grid.description=o.grid.description,e.itemData.attributes.grid.modificationDate=o.grid.modificationDate,e.itemData.attributes.grid.architectureNumber=r})},setCurrentItem:function(e,t,i){this.activeItem={physicalid:e,id:e,name:t,revision:i}},setCurrentModel:function(e,t,i,n){this.activeModel={physicalid:e||t,id:t,name:i,revision:n}},setCurrentModelVersion:function(e,t,i,n,o){this.activeModelVersion={physicalid:e,id:e,name:t,revision:i,backEndName:n,current:o}},setCurrentPC:function(e,t,i,n){this.activePC={physicalid:e,id:e,name:t,label:n,revision:i}},disableActionOnNavigate:function(e){let t=this.idcard.container.getElement("#"+e);!t||!t.classList||t.classList.contains("disabled")||t.classList.add("disabled")},enableActionOnNavigate:function(e){let t=this.idcard.container.getElement("#"+e);!(!t||!t.classList)&&t.classList.contains("disabled")&&t.classList.remove("disabled")},updateTooltipOnNavigate:function(e,t){let n=this.idcard.container.getElement("#"+e);n.tooltipInfos=new i({shortHelp:t}),n.setAttribute("title","")},updateListAvailableAttributes:function(){var e=this,t=this.idcardModel.get("fullListAvailableAttributes"),i=c.getUserCustomAttributes()||[],n=i.filter(function(e){var i=v(e.curi);return e.bo&&!t.some(e=>i===e.id)}),o=[];n.forEach(function(t){var i=v(t.curi);o.push({id:i,name:t.nls,value:void 0!==e.itemData.attributes.grid[t.curi]?e.itemData.attributes.grid[t.curi]:m.label_none,displayWhenMinified:!1,defaultVisibility:!1})});var r=t.filter(function(e){return i.some(function(t){var i=v(t.curi);return e.id===i})||!0===e.defaultAttribute}).concat(o);this.idcardModel.set("fullListAvailableAttributes",r)},retreiveSavedAttributesCustomHeaderView:function(){var e=c.getUserCustomHeaderView()||{};Object.keys(e).length&&this.idcard.IDCardDisplayedAttributes.setStatusForAttributes(e)},getClassificationAttributesOnItem:function(e){return a.getLogItemClassificationAttributes(e.physicalid)},parseValueIDCardData:function(e,t,i){var n=m.label_none;if(e.isClassification)void 0!==i[e.curi]&&(n=i[e.curi]);else if(void 0!==t.grid[e.curi]&&(n=t.grid[e.curi],e.dimension)){t.grid[e.curi+"_actual"]&&(n=t.grid[e.curi+"_actual"]);var o=f.dimensions[e.dimension],r=o.Units[o.MKSUnit].NLSName;n=Array.isArray(n)?n.map(e=>e+" "+r):n+" "+r}if(void 0!==e.rangeValues&&e.rangeValues.length>0&&"string"===e.type){var a=e.isSharedPredicateOnSameType||e.isSharedPredicate&&(e.isClassification||e.isOnExtension);if(e.multiValuated||a){let t=Array.isArray(n)?n:n.split(",");for(var s=[],l=0;l<t.length;l++){let i=e.rangeValues.find(function(e){return e.value===t[l]});s.push(i?i.nlsValue:t[l])}n=s}else{let t=e.rangeValues.find(function(e){return e.value===n});n=t?t.nlsValue:n}}return n}}}),define("DS/CATFLCockpitWidget/components/DisciplineIterations/consolidateDefinition",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/ButtonGroup","DS/Controls/Toggle","DS/Controls/ComboBox","DS/DataGridView/DataGridView","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/implementlink.service","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m){"use strict";var f=function(e){this.options=e};return f.prototype.render=function(){var e=this,t=e.getConsolidateOptionsContainer();e.dialog=new i({title:m.header_consolidate_log_defn,content:t,modalFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Ok:new n({label:m.action_consolidate,emphasize:"primary",onClick:e._performCollectDefinitionOperation.bind(e)}),Cancel:new n({emphasize:"secondary",onClick:function(){e.dialog.close()}})}}),e.dialog.addEventListener("close",function(){e.dialog.destroy()})},f.prototype.getConsolidateOptionsContainer=function(){var t=this,i=e.createElement("div",{class:"consolidate-options-container"});return t.optsButtonGroup=new o({type:"checkbox"}),t.optsButtonGroup.addChild(new r({type:"checkbox",label:m.label_copy_spaces,checkFlag:!0})),t.optsButtonGroup.addChild(new r({type:"checkbox",label:m.label_remove_spaces,checkFlag:!0})),t.optsButtonGroup.addChild(new r({type:"checkbox",label:m.label_change_maturity_to,checkFlag:!1})),t.optsMaturity=new a({elementsList:[{label:m.maturityStates.FROZEN,value:"FROZEN"},{label:m.maturityStates.RELEASED,value:"RELEASED"}],enableSearchFlag:!1}),t.optsButtonGroup.addEventListener("change",function(e){var i=t.optsButtonGroup._getButtonList(),n=t.dialog.buttons.Ok,o=i.every(function(e){return!e.checkFlag});n.disabled=!!o}),t.optsMaturity.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation()}),t.optsButtonGroup.inject(i),t.optsMaturity.inject(i.getElement(".wux-controls-abstract.wux-controls-toggle.wux-controls-checkbox:nth-child(3)")),i},f.prototype._performCollectDefinitionOperation=function(){var o=this;if(o.processing)l.alertMessage("info",null,m.info_process_in_progress);else{o.processing=!0,t.mask(o.dialog.content,m.msg_processing);var r={},a=[],s=o.options.selectedNodes;s.forEach(function(e){r[e.options.physicalid]=e,a.push(e.options.instance.physicalid)});var p=u.confAllImplPathsOnNodes(s,!1,!1),g={copyAssignedDesignSpaces:o.optsButtonGroup.getButton(0).checkFlag,removePreviouslyAssignedDesignSpaces:o.optsButtonGroup.getButton(1).checkFlag,changeMaturity:o.optsButtonGroup.getButton(2).checkFlag};!0===g.changeMaturity&&(g.maturityStateSelected=o.optsMaturity._properties.currentValue.value);var f={consolidateLogicalDefinition:g,instanceIds:a,occurrenceInfo:p.payload,frozenStatesDB:["FROZEN","RELEASED"],frozenStatesNLS:[m.maturityStates.FROZEN,m.maturityStates.RELEASED]};d.consolidateLogicalDefinition(f).then(function(t){var a,s=t.rowsData;for(var l in s){if((p=s[l]).authoringStatus&&1==p.authoringStatus){a=!0;break}}a&&(c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-nodes-by-id",data:{arrayOfPID:Object.keys(r),tagAsRecentlyAuthored:!0}}),c.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"refresh-refLinks-by-id",data:Object.values(r)}));var d=[],u=0;for(var l in s){var p=s[l],f={},h=r[p.referenceId];f.title={value:h.options.label,tooltip:h.options.label},f.revision={value:h.options.grid.revision,tooltip:h.options.grid.revision},f.maturity={value:p.maturity,tooltip:p.maturity},f.instTitle={value:p.instanceTitle,tooltip:p.instanceTitle};var v={value:"",tooltip:""};if(p.status)if("processed"===p.status.toLowerCase())v.value="check",u++;else if("error"===p.status.toLowerCase()?v.value="wrong":v.value="status-noway",p.errors&&p.errors.length>0){var C=p.errors.join("\r\n");v.tooltip=C}f.status=v;var b={released:"",frozen:"",inwork:"",tooltip:""};p.pilotingDisciplines&&(b.released=p.pilotingDisciplines.released.join("\r\n"),b.frozen=p.pilotingDisciplines.frozen.join("\r\n"),b.inwork=p.pilotingDisciplines.inwork.join("\r\n")),f.pilotingDisc=b;var y={value:"",tooltip:""};g.removePreviouslyAssignedDesignSpaces&&(p.spacesRemoved&&(y.value=p.spacesRemoved.join("\r\n")),f.removedSpaces=y);var _={value:"",tooltip:""};g.copyAssignedDesignSpaces&&(p.spacesAdded&&(_.value=p.spacesAdded.join("\r\n")),f.addedSpaces=_);var w={value:"",tooltip:""};g.changeMaturity&&(p.maturityMoved&&("moved"===p.maturityMoved.value.toLowerCase()?w.value="check":"notmoved"===p.maturityMoved.value.toLowerCase()?w.value="wrong":"moverestrictedfromopenness"===p.maturityMoved.value.toLowerCase()?w.value="status-ko":w.value="status-noway",w.tooltip=p.maturityMoved.tooltip.join()),f.freezeLR=w),d.push(f)}var D=e.createElement("div",{class:"report-consolidation-container"});e.createElement("div",{html:"<em>"+m.replace(m.msg_consolidation_processed_report,{countOk:u,totalCount:d.length})+"<em>"}).inject(D);var S=e.createElement("div",{class:"report-consolidation-dgv"}).inject(D),I=(o._createDataGridView({items:d,consolidateOptions:g}).inject(S),new i({title:m.header_summary_consolidate_log_defn,height:500,width:1200,content:D,modalFlag:!0,resizableFlag:!0,immersiveFrame:widget.immersiveFrame,buttons:{Cancel:new n({emphasize:"secondary",onClick:function(){I.close()}})}}));I.addEventListener("close",function(){I.destroy()})}).catch(function(e){l.displayError(e,null,null,m.error_consolidate_definition)}).finally(function(){o.processing=!1,t.unmask(o.dialog.content),o.dialog.close()})}},f.prototype._createDataGridView=function(e){var t=new p({useAsyncPreExpand:!0});t.prepareUpdate();var i=e.consolidateOptions;e.items.forEach(function(e){var n={label:e.title.value,grid:{revision:e.revision.value,maturity:e.maturity.value,instanceTitle:e.instTitle.value,status:e.status.value,pilotingDisc_released:e.pilotingDisc.released,pilotingDisc_frozen:e.pilotingDisc.frozen,pilotingDisc_inwork:e.pilotingDisc.inwork},item:e,editableFlag:!1};i.removePreviouslyAssignedDesignSpaces&&(n.grid.removedSpaces=e.removedSpaces.value),i.copyAssignedDesignSpaces&&(n.grid.addedSpaces=e.addedSpaces.value),i.changeMaturity&&(n.grid.freezeLR=e.freezeLR.value),t.addChild(new g(n))}),t.setFilterModel({label:{filterId:"stringRegexp"},revision:{filterId:"stringRegexp"},maturity:{filterId:"set"},instanceTitle:{filterId:"stringRegexp"},pilotingDisc_released:{filterId:"stringRegexp"},pilotingDisc_frozen:{filterId:"stringRegexp"},pilotingDisc_inwork:{filterId:"stringRegexp"},addedSpaces:{filterId:"stringRegexp"},removedSpaces:{filterId:"stringRegexp"}}),t.pushUpdate();var n=new s({identifier:"SystemArchitectureRelease_ConsolidateDefnReport",height:"inherit",treeDocument:t,columns:this._getDataGridViewColumns(i),rowSelection:"none",defaultColumnDef:{typeRepresentation:"string",width:"auto"},sortModel:[{dataIndex:"tree",sort:"asc"}],getCellTooltip:function(e){let t;return e.nodeModel&&(t=n.getColumnOrGroup(e.columnID)),!t||"status"!==t.dataIndex&&"freezeLR"!==t.dataIndex?n.getCellDefaultTooltip(e):{shortHelp:e.nodeModel.options.item[t.dataIndex].tooltip,updateModel:!1}},onContextualEvent:function(e){if(e.cellInfos){if(e.cellInfos&&-1===e.cellInfos.rowID){let t={firstColumnsVisibility:!1,columnsManagement:!1};return e.collectionView.buildDefaultContextualMenu(e,t)}return!1}}});return n.getContent()},f.prototype._getDataGridViewColumns=function(e){var t=[{text:m.label_title,dataIndex:"tree",alwaysVisibleFlag:!0,pinned:"left"},{text:m.label_revision,dataIndex:"revision",width:80,pinned:"left"},{text:m.label_maturity,dataIndex:"maturity",width:120,pinned:"left"},{text:m.label_instance_title,dataIndex:"instanceTitle",pinned:"left"},{text:m.label_piloting_disciplines,dataIndex:"pilotingDisc",children:[{dataIndex:"pilotingDisc_inwork",text:m.label_inwork,typeRepresentation:"textBlock",autoRowHeightFlag:!0},{dataIndex:"pilotingDisc_frozen",text:m.label_frozen,typeRepresentation:"textBlock",autoRowHeightFlag:!0},{dataIndex:"pilotingDisc_released",text:m.label_released,typeRepresentation:"textBlock",autoRowHeightFlag:!0}]},{text:m.label_consolidation_status,dataIndex:"status",alignment:"center",typeRepresentation:"icon",width:80}];if(e.copyAssignedDesignSpaces||e.removePreviouslyAssignedDesignSpaces){var i={text:m.label_design_spaces,dataIndex:"designSpaces",children:[]};e.copyAssignedDesignSpaces&&i.children.push({text:m.label_added,dataIndex:"addedSpaces",typeRepresentation:"textBlock",autoRowHeightFlag:!0}),e.removePreviouslyAssignedDesignSpaces&&i.children.push({text:m.label_removed,dataIndex:"removedSpaces",typeRepresentation:"textBlock",autoRowHeightFlag:!0}),t.push(i)}if(e.changeMaturity){const i="FROZEN"===e.maturityStateSelected?m.label_move_to_selected_state.replace("{selectedMaturity}",m.maturityStates.FROZEN):m.label_move_to_selected_state.replace("{selectedMaturity}",m.maturityStates.RELEASED);t.push({text:i,dataIndex:"freezeLR",alignment:"center",typeRepresentation:"icon",width:120})}return t},f}),define("DS/CATFLCockpitWidget/services/DisplayConnectedDIFStructure.service",["DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/common.util"],function(e,t,i,n){"use strict";var o=t.getFullConfig(),r={primitives:[{navigate_to_rel:{id:1,rel_type:["VPLMrel_47_PLMConnection_47_V_Owner"]},navigate_to_sr:{id:2,mode:"last",filter:{role:["325"],semantics:["1"]}}}],patterns:{LAYOUT_OR_SHEET:[{id:1},{id:2}]},patternTypeFilters:{LAYOUT_OR_SHEET:{typesToReturn:["DIFLayout","DIFSheet"]}},attributes:["physicalid","logicalid","majorid","ds6w:type","ds6w:description","ds6w:label","ds6wg:revision","current","ds6w:status","ds6w:responsible","ds6w:created","ds6w:modified","ds6w:islastrevision","ds6w:project","ds6w:organizationresponsible"],fileAttributes:["icon","thumbnail_2d"],flags:["returnMatches"],version:3,label:"$User-$ApplicationName-$Timestamp"};return{GetConnectedDIFs:function(e){for(var t=[],o=0;o<e.length;o++)t.push(e[o].options.physicalid);return r.input_physical_ids=t,i.navigate(r).then(function(e){return e}).catch(function(e){e&&e.errorResp&&n.alertMessage("error",null,e.errorResp.message)})},GetExpandedDIFStructure:function(t){for(var i={batch:{expands:[]},outputs:{format:"entity_relation_occurrence",select_object:["physicalid","logicalid","majorid","ds6w:type","ds6w:description","ds6w:label","ds6wg:revision","current","ds6w:status","ds6w:responsible","ds6w:created","ds6w:modified","ds6w:islastrevision","ds6w:project","ds6w:organizationresponsible"],select_relation:["physicalid","ds6w:label","ds6w:type"]}},r=0;r<t.length;r++)i.batch.expands.push({label:"CATFLCockpit-ExecuteExpand",root:{physical_id:t[r]},filter:{all:1},graph:{descending_condition_relation:{uql:'flattenedtaxonomies:"reltypes/DIFSheetInstance" OR flattenedtaxonomies:"reltypes/DIFViewInstance"'}},aggregation_processors:[{truncate:{max_distance_from_prefix:3,prefix_filter:{prefix_path:[{physical_id_path:[t[r]]}]}}}]});var a=o.webservices.progressiveExpand+"?output_format=cvjson";return e.makeServiceCall(a,"POST",JSON.stringify(i),!0,null,{timeout:0}).then(function(e){return e}).catch(function(e){e&&e.errorResp&&n.alertMessage("error",null,e.errorResp.message)})}}}),define("DS/CATFLCockpitWidget/utils/configuration.util",["UWA/Core","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/CATFLCockpitWidget/utils/config.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r){"use strict";return{updateContentWithListOfModels:function(e){let a=e.container,s=e.cfgContexts;var l=new t,c=new n({selectionBehavior:{canMultiSelect:e.canMultiSelect||!1,toggle:e.toggle||!1,unselectAllOnEmptyArea:e.unselectAllOnEmptyArea||!1}}).inject(a);return s.forEach((e,t)=>{var n=e.content&&e.content.results&&e.content.results.length>0?e.content.results[0]:null;if(n){var a="",s="",c="",d="",u=o.getServiceURL("3DSpace")+"/common/images/I_Model_Thumbnail.png";n.data&&n.data.length>0&&n.data[0]&&n.data[0].value&&n.data[0].value.length>0&&n.data[0].value[0]&&"Marketing Name"==n.data[0].name&&(a=n.data[0].value[0]),n.basicData.forEach((e,t)=>{"name"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(s=e.value[0]),"owner"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(c=e.value[0]),"current"===e.name&&e.value&&e.value.length>0&&e.value[0]&&(d=e.value[0])});var p=new i({label:a,thumbnail:n.preview_url&&""!==n.preview_url?n.preview_url:u,subLabel:s+" | "+c,description:r.label_maturity+" : "+d,dataModel:{physicalid:n.physicalID,name:s,title:a}});l.addRoot(p)}}),c.loadApplicativeModel(l),c}}}),define("DS/CATFLCockpitWidget/utils/DisplayConnectedDIFStructure.util",["DS/CATFLCockpitWidget/services/DisplayConnectedDIFStructure.service","DS/CATFLCockpitWidget/parser/index.parser","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.columns","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s){"use strict";var l=new Map,c={},d=n.getFullConfig(),u={DisplayConnectedDIFStructure:function(t){return r.getPredicateValues({"ds6w:type":["DIFView","DIFLayout","DIFSheet"]}).then(function(e){return c=e["ds6w:type"]}),e.GetConnectedDIFs(t).then(function(i){for(var n=[],r=0,a=0;a<t.length;a++)if(void 0!==i[t[a].options.physicalid]&&void 0!==i[t[a].options.physicalid].LAYOUT_OR_SHEET){for(var c=[],d=0;d<i[t[a].options.physicalid].LAYOUT_OR_SHEET.length;d++)n.push(i[t[a].options.physicalid].LAYOUT_OR_SHEET[d].physicalid),c.push(i[t[a].options.physicalid].LAYOUT_OR_SHEET[d].physicalid);l.set(t[a].options.physicalid,c)}else++r;if(0!==n.length)return e.GetExpandedDIFStructure(n).then(function(e){var i;i="string"==typeof e?JSON.parse(e):e;var{PathsIDWithLRef:n,mapDIFIdsAttr:a}=u._ExpandV2Parser(l,i);u._UpdateDIFOnNode(t,n,a),1===t.length?o.alertMessage("info",null,s.msg_diagrams_loaded_success_single):o.alertMessage("info",null,s.msg_diagrams_loading_success_multiple),r>0&&(1===r?o.alertMessage("warning",null,s.warn_DisplayConDIF_no_connected_diagram_single):o.alertMessage("warning",null,s.replace(s.warn_DisplayConDIF_no_connected_diagram_multiple,{count:r})))}).catch(function(e){e&&e.errorResp&&o.alertMessage("error",null,e.errorResp.message)});1===t.length?o.alertMessage("warning",null,s.warn_DisplayConDIF_emptyConDIF_single):o.alertMessage("warning",null,s.warn_DisplayConDIF_emptyConDIF_multiple)}).catch(function(e){e&&e.errorResp&&o.alertMessage("error",null,e.errorResp.message)})},_ExpandV2Parser:function(e,t){for(var i=[],n={},o=0;o<t.results.length;o++)void 0!==t.results[o].Path&&i.push(t.results[o].Path);for(let t=0;t<i.length;t++)for(const[n,o]of e)for(var r=Array.isArray(o)?o:[o],a=0;a<r.length;a++)i[t].includes(r[a])&&i[t].unshift(n);for(let e=0;e<t.results.length;e++)void 0!==t.results[e].resourceid&&(n[t.results[e].resourceid]=u._createDGVAttrToPredicatsAttrMap(t.results[e]));return{PathsIDWithLRef:i,mapDIFIdsAttr:n}},_UpdateDIFOnNode:function(e,t,n){for(var o=0;o<e.length;o++){var r=e[o].options.instance?e[o].options.instance.physicalid:"",a=e[o].getNodesByRelId("connectedDIF"+r)[0];if(a)a.empty(),u._computeConnectedDIFSTructureUnderDIFCategoryNode(e[o],t,a,n);else{for(var l=0;l<t.length;l++)if(t[l][0]===e[o].options.physicalid){(a=new i({label:s.label_diagrams,icons:[{iconName:"fl-diagrams"}],type:"DiagramsCategory",editableFlag:!1})).setRelationID("connectedDIF"+r),e[o].addChild(a),e[o].updateOptions(),a.updateOptions();break}u._computeConnectedDIFSTructureUnderDIFCategoryNode(e[o],t,a,n)}}},_createDGVAttrToPredicatsAttrMap:function(e){var t,i,r,a={},s={iconSize:{height:"16px",width:"16px"}};"DIFLayout"===e["ds6w:type"]?s.iconPath=n.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_VPMNavDifLayout.png":"DIFSheet"===e["ds6w:type"]?s.iconPath=n.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_VPMNavDifSheet.png":"DIFView"===e["ds6w:type"]&&(s.iconPath=n.getServiceURL("3DSpace")+"/snresources/images/icons/small/I_VPMNavDifView.png"),a.physicalid=e.resourceid,a.label=e["ds6w:label"],a.icons=[s],a.type=e["ds6w:type"],a.description=e["ds6w:description"],a.virtual=!0,t=e["ds6w:created"]?o.formatDate(e["ds6w:created"]):"",i=e["ds6w:modified"]?o.formatDate(e["ds6w:modified"]):"",r=e.current?d.MAPPING_MATURITY[e.current]:"";var l={creationDate:t,description:e["ds6w:description"],isLastVersion:e["ds6w:islastrevision"],maturity:r,revision:e["ds6wg:revision"],physicalid:e.resourceid,modificationDate:i,owner:e["ds6w:responsible"],type:c[e["ds6w:type"]],name:e["ds6w:label"],kindOfRFLP:"DIF",actualType:e["ds6w:type"],"ds6w:project":e["ds6w:project"],"ds6w:organizationResponsible":e["ds6w:organizationresponsible"]};return a.grid=l,a},_computeConnectedDIFSTructureUnderDIFCategoryNode:function(e,t,n,o){for(var r=[],a=0;a<t.length;a++)if(t[a][0]===e.options.physicalid){a>0?t[a-1][1]!==t[a][1]&&(r=[],u._attachRootDIFNodeToconnectedDIFCategory(r,o[t[a][1]],n)):u._attachRootDIFNodeToconnectedDIFCategory(r,o[t[a][1]],n);for(var s=r.length,l=3;l<t[a].length;l+=2)if(a>0){if(t[a][l]!==t[a-1][l]){let e=new i(o[t[a][l]]);r.push(e),3===l?r[0].addChild(r[s]):u._attachnode(r,r[s]),r[s].updateOptions(),s++}}else{let e=new i(o[t[a][l]]);r.push(e),3===l?r[0].addChild(r[s]):r[s-1].addChild(r[s]),r[s].updateOptions(),s++}}},_attachRootDIFNodeToconnectedDIFCategory:function(e,t,n){var o=new i(t);e.push(o),n.addChild(e[0]),e[0].updateOptions()},_attachnode:function(e,t){for(var i=e.length-1;i>=0;i--)if("DIFSheet"===e[i].options.type){e[i].addChild(t);break}}};return u}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.filter",["UWA/Core","DS/DataGridView/DataGridViewSetFilterView","DS/DataGridView/DataGridViewStringRegExpFilterView","DS/DataGridView/DataGridViewNumberFilterView","DS/TreeModel/SetFilter","DS/TreeModel/StringRegExpFilter","DS/TreeModel/NumberFilter","DS/CATFLCockpitWidget/services/common.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l){return{createFilterOnAttributeCategory:function(e,t){var i=this;return e.inherit({isDataFiltered:function(e){return this._parent(e)||!t.call(i,e)},_applyFilterModel:function(e){if(this.filterManager){if(this.filterManager.model.prepareUpdate&&this.filterManager.model.prepareUpdate(),this._listOfFilteredData.forEach(function(e){e.decrementFilteredCount()}),this._listOfFilteredData=[],!this.filterModel)return this.filterManager.publish("filterModelChange",{propertyId:this.propertyId,filter:this}),this.filterManager.filterModel[this.propertyId]&&delete this.filterManager.filterModel[this.propertyId].filterModel,void(this.filterManager.model.pushUpdate&&this.filterManager.model.pushUpdate({updateType:WUXModelUpdateTypes.Filtering}));this.filterManager.filterModel[this.propertyId].filterModel=this.filterModel;var t=this;this.filterManager.model.processDescendants&&this.filterManager.model.processDescendants({treeTraversalOrder:"postOrder",processNode:function(e){if(!0!==this._preventFiltering)if(e.nodeModel.canBeFiltered(t.propertyId)&&t.isDataFiltered(e.nodeModel))this.incrementFilteredCount(),t._listOfFilteredData.push(this);else{function i(e){if(e!==o){!function(e){var i=t._listOfFilteredData.indexOf(e);-1!==i?(t._listOfFilteredData.splice(i,1),e.decrementFilteredCount()):e._preventFiltering=!0}(e);var n=e.getChildren();n&&n.forEach(function(e){i(e)})}}this.getParents().forEach(function(e){e._preventFiltering=!0});var n=this.getParent(),o=this,r=n.getParent();childrenLogicalParent=r.getChildren(),childrenLogicalParent.forEach(function(e){e._options.type.includes("Category")&&i(e)})}else delete this._preventFiltering}}),this.filterManager.publish("filterModelChange",{propertyId:this.propertyId,filter:this}),this.filterManager.model.pushUpdate&&this.filterManager.model.pushUpdate({updateType:WUXModelUpdateTypes.Filtering})}}})},registerSpecificFilters:function(e,s,l){var c=this.createFilterOnAttributeCategory(o,l),d=this.createFilterOnAttributeCategory(a,l),u=this.createFilterOnAttributeCategory(r,l),p=e.getTreeDocument().getFilterManager();p.registerFilter("set"+s,c),p.registerFilter("number"+s,d),p.registerFilter("stringRegexp"+s,u);var g=e.getFilterViewManager();g.registerFilterView("set"+s,t.inherit({})),g.registerFilterView("number"+s,n.inherit({})),g.registerFilterView("stringRegexp"+s,i.inherit({}))},createFilterModelWithCustomCondition:function(t,i){var n=e.clone(i);for(var o in n)switch(n[o].filterId){case"stringRegexp":n[o].filterId="stringRegexp"+t,n[o].filterModel={};break;case"set":n[o].filterId="set"+t,n[o].filterModel=[];break;case"number":n[o].filterId="number"+t,n[o].filterModel={}}return n},registerAndCreateSpecificFilter:function(e,t,i){var n=null;if("PilotingDisciplines"===t)n=this.isNodePilotingDiscipline;else if("Disciplines"===t)n=this.isNodeDiscipline;else{if("ProposedSolutions"!==t)return null;n=this.isNodeProposedSolution}return this.registerSpecificFilters(e,t,n),this.createFilterModelWithCustomCondition(t,i)},copyOldFilterModelInNewFilterModel:function(e,t){for(var i in e)t[i]&&t[i].filterModel&&(e[i].filterModel=t[i].filterModel)},changeFilterModel:function(e,t){var i=e.getTreeDocument().getFilterManager().filterModel;this.copyOldFilterModelInNewFilterModel(t,i),e.getTreeDocument().setFilterModel(t)},isNodePilotingDiscipline:function(e){var t=!1,i=!1,n=!1,o=e._options.linkInfo;o&&(t="ref"===o.objType&&"implementing"===o.linkType,e._options.grid.kindOfRFLP&&(i="L"===e._options.grid.kindOfRFLP),n=!!e.getParent().getParent()._options.grid.architectureNumber);return t&&i&&n},isNodeDiscipline:function(e){var t=!1,i=!1,n=e._options.linkInfo;if(n){t="implementing"===n.linkType&&"inst"===n.objType,i="RFLVPMLogicalReference"===e._options.type;var o=e.getParent().getParent();hasLogicalRefParentWithAN=!!o._options.grid.architectureNumber}return t&&i&&hasLogicalRefParentWithAN},isNodeProposedSolution:function(e){var t="P"===e.options.grid.kindOfRFLP,i=!1;t&&(i="proposedSolutionCategory"===e.getParent().options.type);return t&&i},clearFilterModels:function(e){var t=e.getTreeDocument().getFilterManager().getFilters();for(var i in t)t[i]&&t[i].filterModel&&(t[i].filterModel=void 0)}}}),define("DS/CATFLCockpitWidget/components/ModelPCSelector/checkEffectivityConsistency",["UWA/Core","DS/UIKIT/Mask","DS/Windows/Dialog","DS/Controls/Button","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/DataGridView/DataGridView","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/configuration.util","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/implementlink.service","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p){"use strict";var g=s.getFullConfig().identifiers;let m=function(e){let t=this,i=e.selectedNodes;t.action=e.action,t.instDetails={},t.parentDetails={},t.nodesToProcess={instanceIds:[],nodes:[]},t.errorNodes={noContexts:[],noEffectivity:[],noOccLinks:[],ctxWUC:[]};for(let e=0;e<i.length;e++){let n=i[e];if(n.options.instance&&n.options.instance.physicalid){let e=n.options.actualParent;if(e){let i=n.options.instance.physicalid;t.instDetails[i]=t.instDetails[i]?t.instDetails[i].push(n):[n],t.parentDetails[e.options.physicalid]||(t.parentDetails[e.options.physicalid]=[]),t.parentDetails[e.options.physicalid].indexOf(i)<0&&t.parentDetails[e.options.physicalid].push(i)}}}let n=Object.keys(t.parentDetails);n&&n.length>0&&t._validateRelatedContexts(n).then(()=>{let e=[],i=[];if(t.cfgContextDetails){let n=t.cfgContextDetails.contextInfo,o=t.cfgContextDetails.referencesInfo,r=t.cfgContextDetails.chgCtrl;if(o.forEach(i=>{"no"===i.hasConfigContext.toLowerCase()&&e.push(...t.parentDetails[i.pid])}),r)for(let e in r)"none"!==r[e]&&i.push(...t.parentDetails[e]);for(let n in t.instDetails){let o=!1,r=t.instDetails[n];e.indexOf(n)>=0&&(o=!0,t.errorNodes.noContexts.push(...r)),i.indexOf(n)>=0&&(o=!0,t.errorNodes.ctxWUC.push(...r)),o||(t.nodesToProcess.instanceIds.push(n),t.nodesToProcess.nodes.push(...r))}t.checkEffDialog=t._createDialogCheckEffConsistency(n),n.length>1?t._manageViewForMoreThanOneContext(n):t._manageViewForOneContext(n)}})};return m.prototype._validateRelatedContexts=function(e){let t=this;var i=[];i.push(d.getConfigContextInfo(e));let n=e.map(e=>"pid:"+e);return i.push(d.getChangeControl({ObjectsListForGetChangeControl:n})),Promise.all(i).then(e=>{let i=e[0],n=e[1];if(i?i.contextInfo&&i.contextInfo.length>0?t.cfgContextDetails=i:l.alertMessage("error",null,p.error_no_model_attached):l.alertMessage("error",null,p.error_info_models),n){let e={};n.objectListChangeControlled.forEach(t=>{e[t.id.slice(4)]=t.changeControlValue}),t.cfgContextDetails.chgCtrl=e}})},m.prototype._createDialogCheckEffConsistency=function(){let t=this,n=e.createElement("div",{class:"effectivity-consistency-container"}),o=new i({title:p.action_check_effectivity_consistency,height:500,width:1200,resizableFlag:!0,modalFlag:!0,immersiveFrame:widget.immersiveFrame,content:n});o.addEventListener("close",function(){t.gridView&&t.gridView.destroy(),t.checkEffDialog.destroy()});let r="outfitting"===t.action?p.outfitting_message:p.discipline_message,a=e.createElement("div");return e.createElement("p",{html:r}).inject(a),a.inject(o.getContent().getElement(".effectivity-consistency-container")),o},m.prototype._manageViewForMoreThanOneContext=function(t){var i=this;let o="outfitting"===i.action?p.action_outfitting:p.action_discipline;i.checkEffDialog.title=p.action_check_effectivity_consistency+" - "+o+" - "+p.label_select_model;let r=i.checkEffDialog.getContent().getElement(".effectivity-consistency-container .model-selection-container"),a=i.checkEffDialog.getContent().getElement(".effectivity-consistency-container .eff-consistency-griview");if(r)r&&r.show(),a&&a.hide();else{let n=e.createElement("div",{class:"model-selection-container"});n.inject(i.checkEffDialog.getContent().getElement(".effectivity-consistency-container")),i.tileCollectionOfModels=c.updateContentWithListOfModels({cfgContexts:t,container:n}),i.tileCollectionOfModels.onSelectionAdd(function(){i.checkEffDialog.buttons.Open.disabled=!1})}i.checkEffDialog.buttons={Open:new n({label:p.label_next,emphasize:"primary",onClick:i._onSelectionOfModel.bind(i,t),disabled:!0}),Cancel:new n({emphasize:"secondary",onClick:function(){i.checkEffDialog.close()}})},i.checkEffDialog._applyButtons()},m.prototype._manageViewForOneContext=function(e){let t=this,i=e[0].content,o=i&&i.results&&i.results.length>0?i.results[0]:null,r="";o&&(o.data.forEach(e=>{"attribute[Marketing Name]"===e.selectable&&e.value&&e.value.length>0&&e.value[0]&&(r=e.value[0])}),t.checkEffConsistencyOfItemNProduct({model:{physicalid:o.physicalID,title:r}}).then(function(){t.checkEffDialog.buttons={Ok:new n({label:p.action_close,emphasize:"primary",onClick:function(){t.checkEffDialog.close()}}),Cancel:new n({onClick:function(){t.checkEffDialog.close()},visibleFlag:!1})},t.checkEffDialog._applyButtons()}))},m.prototype._onSelectionOfModel=function(e){let t=this;if(t.tileCollectionOfModels&&t.tileCollectionOfModels.TreedocModel){var i=t.tileCollectionOfModels.TreedocModel.getSelectedNodes();if(1===i.length){let o=i[0].options.dataModel;t.checkEffConsistencyOfItemNProduct({model:{physicalid:o.physicalid,title:o.title}}).then(function(){t.checkEffDialog.buttons={Ok:new n({label:p.action_close,emphasize:"primary",onClick:function(){t.checkEffDialog.close()}}),Reset:new n({label:p.action_previous,emphasize:"secondary",onClick:t._manageViewForMoreThanOneContext.bind(t,e)})},t.checkEffDialog._applyButtons()})}}},m.prototype.checkEffConsistencyOfItemNProduct=function(e){let i=this,n=i.checkEffDialog.getContent().querySelector(".effectivity-consistency-container");if(t.mask(n,p.msg_loading),i.nodesToProcess.nodes.length<=0)return i.checkEffDialog.title=p.action_check_effectivity_consistency+" - "+e.model.title,i.viewEffConsistencyReport(),t.unmask(n),Promise.resolve();var o=u.confAllImplPathsOnNodes(i.nodesToProcess.nodes,!1,!1,{bIsImplementedBy:"outfitting"===this.action,bIsImplementing:"discipline"===this.action});if(e.model.physicalid&&"outfitting"===this.action){let r=o&&o.payload&&o.payload.isImplementedByPath;if(!r)return void l.alertMessage("error",null,"Unable to fetch effectivity consistency details");let a={model:e.model.physicalid,instanceIds:i.nodesToProcess.instanceIds,occurrenceInfo:{isImplementedByPath:r}};return d.getEffConsistencyReportofItemNProduct(a).then(function(o){i.checkEffDialog.title=p.action_check_effectivity_consistency+" - "+p.action_outfitting+" - "+e.model.title,i.viewEffConsistencyReport({effConsistencyMap:o}),t.unmask(n)}).catch(function(e){t.unmask(n),i.checkEffDialog.close(),l.alertMessage("error",null,e.message)})}if(e.model.physicalid&&"discipline"===this.action){let r=o&&o.payload&&o.payload.isImplementingPath;if(!r)return void l.alertMessage("error",null,"Unable to fetch effectivity consistency details");let a={model:e.model.physicalid,instanceIds:i.nodesToProcess.instanceIds,occurrenceInfo:{isImplementingPath:r}};return d.getEffConsistencyReportofItemNDiscipline(a).then(function(o){i.checkEffDialog.title=p.action_check_effectivity_consistency+" - "+p.action_discipline+" - "+e.model.title,i.viewEffConsistencyReport({effConsistencyMap:o}),t.unmask(n)}).catch(function(e){t.unmask(n),i.checkEffDialog.close(),l.alertMessage("error",null,e.message)})}l.alertMessage("error",null,"Unable to fetch effectivity consistency details")},m.prototype.viewEffConsistencyReport=function(t){let i=this,n=t&&t.effConsistencyMap,c=i.checkEffDialog.getContent().getElement(".effectivity-consistency-container .model-selection-container"),d=i.checkEffDialog.getContent().getElement(".effectivity-consistency-container .eff-consistency-griview");if(c&&c.hide(),d&&d.show(),i.gridView)i.gridView.treeDocument.empty(),i.errorNodes.noOccLinks=[],i.errorNodes.noEffectivity=[];else{let t=i.getColumnDefForEffConsistencyReport(),n=e.createElement("div",{class:"eff-consistency-griview"});i.gridView=new a({identifier:"grid-view-effectivity-consistency",height:"inherit",treeDocument:new o({useAsyncPreExpand:!0}),columns:t,rowSelection:"none",rowDragEnabledFlag:!0,rowReorderEnabledFlag:!1,defaultColumnDef:{width:"auto"},onContextualEvent:function(e){var t=[];return e&&e.collectionView&&(t=e.collectionView.buildDefaultContextualMenu(e,{expandCollapse:!0})),t}}),i.gridView.sortModel=[{dataIndex:"isEffConsistent",sort:"asc"}];var u={label:{filterId:"stringRegexp"},revision:{filterId:"stringRegexp"},instanceName:{filterId:"stringRegexp"},type:{filterId:"stringRegexp"}};"discipline"===i.action&&(u.isEffConsistent={filterId:"set"}),i.gridView.treeDocument.setFilterModel(u),i.gridView.onDragStartRowHeader=function(e,t){return e.dataTransfer.setData("Text",JSON.stringify(l.create3DXJsonFromDGVSelection([t.nodeModel],!1))),!0},i.gridView.getContent().inject(n),i.checkEffDialog.getContent().getElement(".effectivity-consistency-container").appendChild(n)}i.gridView.treeDocument.prepareUpdate();let m=[];if(n)for(let e in n){let t=n[e],o=t.effectivityCheck&&t.effectivityCheck.status,a={instanceName:t.instanceTitle,instanceId:t.instanceID,CurrentEvolutionEffectivity:t.currentEffectivity&&t.currentEffectivity.replace(/(\r\n|\n|\r)/gm," "),revision:t.referenceRevision,type:t.referenceTypeNLS};"outfitting"===i.action&&(a.isEffConsistent=!(!o||"valid"!==o.toLowerCase()));let l=new r({physicalid:t.referenceID,label:t.referenceTitle,type:t.referenceType,icons:[s.getTypeIconUrl(g.type_act_logref)],grid:a});"outfitting"===i.action&&o&&"notprocessed"===o.toLowerCase()||"discipline"===i.action&&t.effectivityCheck.isOccOccEmpty?(t.effectivityCheck.isOccOccEmpty&&i.errorNodes.noOccLinks&&i.errorNodes.noOccLinks.push(l),t.effectivityCheck.isEvolutionEmpty&&i.errorNodes.noEffectivity&&i.errorNodes.noEffectivity.push(l)):("outfitting"===i.action&&t.isImplementedBy?t.isImplementedBy.forEach(e=>{var t=new r({physicalid:e.referenceID,label:e.referenceTitle,type:e.referenceType,icons:[s.getTypeIconUrl(g.type_act_physical)],grid:{instanceName:e.instanceTitle,instanceId:e.instanceID,CurrentEvolutionEffectivity:e.currentEffectivity&&e.currentEffectivity.replace(/(\r\n|\n|\r)/gm," "),revision:e.referenceRevision,type:e.referenceTypeNLS}});l.addChild(t)}):"discipline"===i.action&&t.isImplementing&&t.isImplementing.forEach(e=>{var t=new r({physicalid:e.referenceID,label:e.referenceTitle,type:e.referenceType,icons:[s.getTypeIconUrl(g.type_act_logref)],grid:{instanceName:e.instanceTitle,instanceId:e.instanceID,CurrentEvolutionEffectivity:e.currentEffectivity&&e.currentEffectivity.replace(/(\r\n|\n|\r)/gm," "),isEffConsistent:!(!e.status||"valid"!==e.status.toLowerCase()),revision:e.referenceRevision,type:e.referenceTypeNLS}});l.addChild(t)}),o&&"computationerror"===o.toLowerCase()?(delete l.options.grid.isEffConsistent,m.push(l)):i.gridView.treeDocument.addRoot(l))}if(m&&m.length>0){let e=new r({label:p.label_processed_error});m.forEach(t=>{e.addChild(t)}),e.getChildren()&&e.getChildren().length>0&&i.gridView.treeDocument.addRoot(e)}if(i.errorNodes){let e=new r({label:p.label_unprocessed_items});if(i.errorNodes.noContexts.length>0){let t=new r({label:p.label_no_cfg_ctx});i.errorNodes.noContexts.forEach(e=>{var i=new r({physicalid:e.options.physicalid,label:e.options.label,icons:[s.getTypeIconUrl(g.type_act_logref)],grid:{instanceName:e.options.grid.instanceName,instanceId:e.options.instance.physicalid,revision:e.options.grid.revision,type:e.options.grid.type}});t.addChild(i)}),t.getChildren().length>0&&e.addChild(t)}if(i.errorNodes.noOccLinks.length>0){let t=new r({label:p.label_no_occ_link});i.errorNodes.noOccLinks.forEach(e=>{var i=new r({physicalid:e.options.physicalid,label:e.options.label,icons:[s.getTypeIconUrl(g.type_act_logref)],grid:{instanceName:e.options.grid.instanceName,instanceId:e.options.grid.instanceId,revision:e.options.grid.revision,type:e.options.grid.type}});t.addChild(i)}),t.getChildren().length>0&&e.addChild(t)}if(i.errorNodes.noEffectivity.length>0){let t=new r({label:p.label_no_eff});i.errorNodes.noEffectivity.forEach(e=>{var i=new r({physicalid:e.options.physicalid,label:e.options.label,icons:[s.getTypeIconUrl(g.type_act_logref)],grid:{instanceName:e.options.grid.instanceName,instanceId:e.options.grid.instanceId,revision:e.options.grid.revision,type:e.options.grid.type}});t.addChild(i)}),t.getChildren().length>0&&e.addChild(t)}if(i.errorNodes.ctxWUC.length>0){let t=new r({label:p.label_ctx_wuc});i.errorNodes.ctxWUC.forEach(e=>{var i=new r({physicalid:e.options.physicalid,label:e.options.label,icons:[s.getTypeIconUrl(g.type_act_logref)],grid:{instanceName:e.options.grid.instanceName,instanceId:e.options.instance.physicalid,revision:e.options.grid.revision,type:e.options.grid.type}});t.addChild(i)}),t.getChildren().length>0&&e.addChild(t)}e.getChildren()&&e.getChildren().length>0&&i.gridView.treeDocument.addRoot(e)}i.gridView.treeDocument.expandAll(),i.gridView.treeDocument.pushUpdate()},m.prototype.getColumnDefForEffConsistencyReport=function(){return[{text:p.label_title,dataIndex:"tree",editableFlag:!1,alwaysVisibleFlag:!0,pinned:"left",width:200},{text:s.getNlsBasicAttributesBO("ds6wg:revision"),dataIndex:"revision",editableFlag:!1,alwaysVisibleFlag:!0},{text:s.getNlsBasicAttributesBO("ds6w:type"),dataIndex:"type",editableFlag:!1,alwaysVisibleFlag:!0},{text:s.getNlsBasicAttributesBO("ds6w:label"),icon:{iconName:"object-instance"},dataIndex:"instanceName",editableFlag:!1,alwaysVisibleFlag:!0},{text:p.label_current_evolution,dataIndex:"CurrentEvolutionEffectivity",alwaysVisibleFlag:!0,sortableFlag:!1,editableFlag:!1,width:500},{text:p.label_valid,dataIndex:"isEffConsistent",typeRepresentation:"boolean",editableFlag:!1,width:95,getCellClassName:function(e){return e&&e.nodeModel?!0===e.nodeModel.options.grid.isEffConsistent?"sax-is-valid-true":"sax-is-valid-false":null},alwaysVisibleFlag:!0}]},m}),define("DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.factory",["DS/UIKIT/Mask","DS/CfgBaseUX/scripts/CfgData","DS/CATFLCockpitWidget/components/BulkEdition/BulkEditionDialog","DS/CATFLCockpitWidget/components/ConfirmationWindow_Generic/ConfirmationWindow","DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.actions","DS/CATFLCockpitWidget/components/DisciplineIterations/consolidateDefinition","DS/CATFLCockpitWidget/components/DisciplineIterations/lastOutfittedState.compare","DS/CATFLCockpitWidget/components/RefineSelection/RefineSelection","DS/CATFLCockpitWidget/components/SpaceAssignment/Copy/SpaceAssignmentCopy","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.creation","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.replace","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.deletion","DS/CATFLCockpitWidget/components/ImplementLinks/implementLinks.controller","DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment","DS/CATFLCockpitWidget/components/VersionExplorer/versionexplorer.controller","DS/CATFLCockpitWidget/components/ModelPCSelector/checkEffectivityConsistency","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/document.service","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/group.util","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","DS/CATFLCockpitWidget/commands/RelatedObjectCmd","DS/CATFLCockpitWidget/utils/SAXTracker","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","DS/CATFLCockpitWidget/utils/DisplayConnectedDIFStructure.util"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f,h,v,C,b,y,_,w,D,S,I,A,F,E){"use strict";var k=y.getFullConfig(),x=function(e,t,i,n,o,r,a){var s={type:"PushItem",title:e};return r&&(s.icon=r),t&&(s.fonticon={family:"DSFontIcon",content:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-"+t}),i&&(s.action={callback:i.bind(N)}),n&&(s.state="disabled",o&&(s.tooltip=o)),a&&(s.id=a),s},T=function(e){var t=[];return e.forEach(function(e){var i=e.getParent(),n=e.options.instance;t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,relID:n&&n.physicalid?n.physicalid:"",parent:{physicalid:i&&i.options?i.options.physicalid:""}})}),t},L=function(e,t){let i=null,n=!0;for(let o=0;o<e.submenu.length;o++){let r=e.submenu[o];r.id===N.defaultMenu[t]&&(e.title=r.title,"disabled"!==r.state?r.state="selected":n=!1,r.fonticon&&(e.fonticon=r.fonticon),"disabled"===e.state?r.state="disabled":e.action=r.action),r.type="RadioItem",null===i&&"disabled"!==r.state&&(i=o)}if("disabled"!==e.state&&!n&&null!==i){let t=e.submenu[i];e.title=t.title,e.action=t.action,t.fonticon&&(e.fonticon=t.fonticon),t.state="selected"}},N={defaultMenu:{expand:"oneLevel",insertNew:"logicalReference",insertExisting:"logicalReference",replaceBy:"replaceByNewRevision",copy:"attributes"},createAddToConfigurationRevisionMenu:function(e,t){return x(F.add_to_config_rev,"configuration-add",function(){var i={items:o.getNodeInfoForEffectivity(t,e)};S.init("AddToConfigurationRevisionCmd",i)})},createSpaceAssignmentMenu:function(e,t){return x(F.action_assign_space,"space-management",function(){A.trackCommandLaunched("assignSpaces-sax"),e.options.assignedSpacesPID?new m(e):_.addAssignedSpacesAttribute([e]).then(()=>{new m(e)})},t,F.error_action_unavailable_in_release)},createCollapseAllMenu:function(e){return x(F.action_collapse_all,"flow-tree-expand-up",function(){A.trackCommandLaunched("collapseAll-sax"),e.forEach(function(e){e.collapseAll()})})},createCompareWithLastOutfitted:function(e,t){return x(F.compareWithLastOutfitted,"part-compare",function(){var i=e[0].options.maturity;-1===i.indexOf("PRIVATE")&&-1===i.indexOf("IN_WORK")||b.alertMessage("warning",null,F.warn_incomplete_definition),new a({selectedNodes:e,view:t}).render()})},createConsolidateLogicalDefinitionMenu:function(e,t){return x(F.header_consolidate_log_defn,"merge",function(){A.trackCommandLaunched("consolidateLogicalDefinition-sax"),new r({selectedNodes:e,view:t.collectionView}).render()})},createCompareMenu:function(e){return x(F.compare,"part-compare",function(){var t=[];e.forEach(function(e){t.push({physicalid:e.options.physicalid,label:e.options.label})}),S.init("CompareCmd",t)})},createCopyMenu:function(e,t,n){var o=x(F.label_copy_attributes2,"copy");return o.submenu=[x(F.label_copy_attributes2,"attributes",function(){A.trackCommandLaunched("copyAttributes-sax"),this.defaultMenu.copy="attributes",i.open(e[0],t.collectionView),n.dataCopied="attributes-copied"},null,null,null,"attributes"),x(F.label_space_assignement_copy_2,"space-management",function(){A.trackCommandLaunched("copySpaceAssignment-sax"),this.defaultMenu.copy="spaceAssignment",l.open(e[0],t.collectionView.treeDocument),n.dataCopied="spaces-copied"},null,null,null,"spaceAssignment")],L(o,"copy"),o},createPasteCommand:function(e,t,n){return"attributes-copied"===t.dataCopied?x(F.label_paste_attributes,"paste",function(){A.trackCommandLaunched("pasteAttributes-sax"),t.dataCopied=null,i.submit()},n,F.error_action_unavailable_in_release):x(F.label_space_assignement_copy,"paste",function(){A.trackCommandLaunched("pasteSpaceAssignment-sax"),t.dataCopied=null,l.validateAndSubmit()},n,F.error_action_unavailable_in_release)},createCreateImplementLinkOccToOccMenu:function(e,t){return x(F.action_create_implrel_occ2occ,"convergence-state",function(){A.trackCommandLaunched("createOccOccImplementRelation-sax"),g.manageOcc2OccImplRel({selectedNode:e[0]})},t,F.error_action_unavailable_in_release)},createCreateImplementLinkRefToRefMenu:function(e,t){let i="structured-view"!==widget.getValue("component-view");return x(F.action_create_implrel_ref2ref,"convergence-state",function(){A.trackCommandLaunched("createRefRefImplementRelation-sax"),g.manageRef2RefImplRel({selectedNode:e,isReleased:t})},i,F.error_action_unavailable_in_flattened_view)},createDeleteImplementLinkMenu:function(e,t,i,o){return x(F.action_delete_impl_rel,"remove",function(){A.trackCommandLaunched("deleteImplementRelation-sax");var o=F.label_delete_implementLink_header+" - ";1===e.length?o+=e[0].options.label:o+=e.length+" "+F.label_objects;var r=UWA.createElement("p",{html:F.msg_delete_manyimplementLink_confirmation});n.createWindow(o,r,F.action_delete,function(){g.deleteImplRel({treeDocument:i.collectionView.treeDocument,rootNode:t,selectedNodes:e})})},o,F.error_action_unavailable_in_release)},createDetachMenu:function(t,i,o,r,a){var s=x(F.label_detach,"tree-delete",function(){A.trackCommandLaunched("detachLogItem-sax");var a=UWA.createElement("div");UWA.createElement("p",{html:F.msg_detach_log_confirm}).inject(a),o&&UWA.createElement("div",{class:"warn-stable-with-archno",html:'<span class="wux-ui-3ds wux-ui-3ds-attention" style=""></span>'+F.warn_detach_item_with_archNo}).inject(a),!o&&r&&UWA.createElement("div",{class:"warn-stable-with-archno",html:'<span class="wux-ui-3ds wux-ui-3ds-attention" style=""></span>'+F.warn_detach_stable_item}).inject(a);var s=F.label_detach+" - ";1===t.length?s+=t[0].options.label:s=s+t.length+" "+F.label_objects,n.createWindow(s,a,F.label_detach,function(){e.mask(i.collectionView.getContent(),F.msg_processing),p.deleteLogItemInstance(i)})});return"structured-view"!==widget.getValue("component-view")?(s.state="disabled",s.tooltip=F.error_action_unavailable_in_flattened_view):a&&(s.state="disabled",s.tooltip=F.error_action_unavailable_in_release),s},createDisplayMoreAttributesMenu:function(e,t,i){return x(F.action_display_more_attributes,"attributes-add",function(){v.displayMoreAttributes(e,t,i)})},createDocumentDownloadMenu:function(e){return x(F.action_download,"download",function(){A.trackCommandLaunched("downloadSpecDoc-sax");var t=[];e.forEach(function(e){t.push(e.options.physicalid)}),C.downloadDocument(t).then(function(){b.alertMessage("success",null,F.msg_download_success)})})},createDocumentDetachMenu:function(e){return x(F.label_detach,"tree-delete",function(){A.trackCommandLaunched("detachSpecDoc-sax"),c.detachDocuments(e)})},createDuplicateMenu:function(e){return x(F.duplicate,"duplicate",function(){var t=[{physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,current:e.options.grid.maturity,icons:e.options.icons}];S.init("DuplicateCommand",t)})},createEditConfigurationContextMenu:function(e){return x(F.action_edit_config_ctx,"3dproduct-pencil",function(){var t=[];e.forEach(function(e){t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,owner:e.options.grid.owner,icons:e.options.icons})}),S.init("EditConfigurationContextCmd",t)})},createSelectbyConfigurationCriteria:function(e){return x(F.action_select_config_critera,"configuration-effectivity",function(){var t=[];e.forEach(function(e){t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,owner:e.options.grid.owner,icons:e.options.icons})}),t[0].treeData=e[0],S.init("SelectByConfigurationCriteriaCmd",t)})},createVariantEffectivityMenu:function(e,i,n,r){var a=x(F.action_variant_effectivity,"variants-and-options",!1);return a.submenu=[],n||(r=!0),a.submenu.push(x(F.action_copy,"copy",function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};S.init("CopyVariantEffectivityCmd",t)},r),x(F.label_paste,"paste",function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};S.init("PasteVariantEffectivityCmd",t)},!t.isVariantEffAvailable),x(F.action_edit,"pencil",function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};S.init("EditVariantEffectivityCmd",t)},r)),a},createEvolutionEffectivityMenu:function(e,i,n,r){var a=x(F.action_evolution_effectivity,"evolution-effectivity",!1);return a.submenu=[],n||(r=!0),a.submenu.push(x(F.action_copy,"copy",function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};S.init("CopyEvolutionEffectivityCmd",t)},r),x(F.label_paste,"paste",function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};S.init("PasteEvolutionEffectivityCmd",t)},!t.isEvolutionEffAvailable),x(F.action_edit,"pencil",function(){var t={items:o.getNodeInfoForEffectivity(i,e),treeDocument:i.collectionView.treeDocument};S.init("EditEvolutionEffectivityCmd",t)},r),x(F.action_extend_evolution,"evolution-effectivity-extension",function(){var t={items:o.getNodeInfoForEffectivity(i,e)};e instanceof Array&&e.length>1e3&&b.alertMessage("warning",null,F.replace(F.msg_bulkOperation_limitReached,{limit:1e3})),S.init("ExtendEvolutionEffectivityCmd",t)})),a},createCheckEffectivityConsistencyMenu:function(e,t){let i=widget.getValue(k.localStorageKeys.componentView)!==k.localStorageKeys.structuredView;var n=x(F.action_check_effectivity_consistency,"implementation-validation",null,i,F.error_action_unavailable_in_flattened_view);return n.submenu=[this.createOutfittingOrDisciplineMenu(e,t,F.action_outfitting,"outfitting",i),this.createOutfittingOrDisciplineMenu(e,t,F.action_discipline,"discipline",i)],n},createOutfittingOrDisciplineMenu:function(e,t,i,n,o){let r=x(i,null,function(){new h({selectedNodes:e,params:t,action:n})}),a=widget.getValue("configurable_expand");return"outfitting"===n?o?(r.state="disabled",r.tooltip=F.error_action_unavailable_in_flattened_view):a&&!a.implementedBy&&(r.state="disabled",r.tooltip=F.error_action_unavailable_implBy_links):"discipline"===n&&(o?(r.state="disabled",r.tooltip=F.error_action_unavailable_in_flattened_view):a&&!a.implementing&&(r.state="disabled",r.tooltip=F.error_action_unavailable_impling_links)),r},createExpandMenu:function(e,t){var i,n,r=x(F.action_expand_one_level,"flow-tree-expand-down");return"structured-view"!==widget.getValue("component-view")&&(i=!0,n=F.error_action_unavailable_in_flattened_view),r.submenu=[x(F.action_expand_one_level,"flow-tree-child-1-expand-down",function(){A.trackCommandLaunched("expandOneLevel-sax"),this.defaultMenu.expand="oneLevel",_.expandNodestoNLevel({level:"1",selectedNodes:t,params:e})},null,null,null,"oneLevel"),x(F.action_expand_two_level,"flow-tree-expand-down-cog",function(){A.trackCommandLaunched("expandTwoLevel-sax"),this.defaultMenu.expand="twoLevel";var i=widget.getValue("currentConfig");i&&i.filterCompiledForm&&i.filterCompiledForm,t.length>1&&b.alertMessage("warning",null,F.msg_expandMultiLvl_multiSelect_warning),_.expandNodestoNLevel({level:"2",selectedNodes:t,params:e})},i,n,null,"twoLevel"),x(F.action_expand_all,"flow-tree-expand-down",function(){A.trackCommandLaunched("expandAll-sax"),this.defaultMenu.expand="allLevel";var i=null,n=widget.getValue("currentConfig");n&&n.filterCompiledForm&&(i=n.filterCompiledForm),1===t.length?o.checkInstanceCount(t,i):t.length>1&&b.alertMessage("warning",null,F.msg_expandMultiLvl_multiSelect_warning),_.expandNodestoNLevel({level:"-1",selectedNodes:t,params:e})},i,n,null,"allLevel")],L(r,"expand"),r},createInformationMenu:function(e,t,i){return x(F.action_information,"info",function(){let t=w.getFLWebModelEventsObj("flweb-model-events");t.publish({event:"flweb-load-properties",data:{items:e,contentView:i}}),t.publish({event:"open-properties-panel"})})},createInsertNewMenu:function(e,t,i){var n=x(F.action_insert_new_log_ref,"plus");return n.submenu=[x(F.action_insert_new_log_ref,!1,function(){this.defaultMenu.insertNew="logicalReference",t.publish({event:"create-new-logical-item"})},null,null,null,"logicalReference"),x(F.action_insert_new_spec_doc,!1,function(){A.trackCommandLaunched("insertNewSpecDocument-sax"),this.defaultMenu.insertNew="specificationDocument",d.createDocument(e[0],!0)},null,null,null,"specificationDocument")],widget.getValue(k.localStorageKeys.componentView)!==k.localStorageKeys.structuredView?(n.state="disabled",n.tooltip=F.error_action_unavailable_in_flattened_view):i&&(n.state="disabled",n.tooltip=F.error_action_unavailable_in_release),L(n,"insertNew"),n},createInsertExistingMenu:function(e,t,i){var n=x(F.action_insert_existing_log_ref,"insert");return n.submenu=[x(F.action_insert_existing_log_ref,!1,function(){this.defaultMenu.insertExisting="logicalReference",c.addExistingItem(e[0],t.getContent(),t.treeDocument)},null,null,null,"logicalReference"),x(F.action_insert_existing_spec_doc,!1,function(){A.trackCommandLaunched("insertExistingSpecDocument-sax"),this.defaultMenu.insertExisting="specificationDocument",c.addExistingDoc(e[0],!0,t.getContent())},null,null,null,"specificationDocument")],widget.getValue(k.localStorageKeys.componentView)!==k.localStorageKeys.structuredView?(n.state="disabled",n.tooltip=F.error_action_unavailable_in_flattened_view):i&&(n.state="disabled",n.tooltip=F.error_action_unavailable_in_release),L(n,"insertExisting"),n},createImplementLinkInformationMenu:function(e,t,i){return x(F.action_impLink_information,"info",function(){A.trackCommandLaunched("implementRelationInformation-sax");let t=w.getFLWebModelEventsObj("flweb-model-events");t.publish({event:"flweb-load-properties",data:{items:e,contentView:i,isImplLinkInfo:!0}}),t.publish({event:"open-properties-panel"})})},createMaturityMenu:function(e){return x(F.maturity,"collaborative-lifecycle-management",function(){var t=[];e.forEach(function(e){var i={};i.physicalid=e.options.physicalid,i.label=e.options.label,t.push(i)}),S.init("MaturityCommand",t)})},createMoveToMenu:function(e){return x(F.action_move_to,"move-to",function(){var t=[];e.forEach(function(e){t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,owner:e.options.grid.owner,icons:e.options.icons})}),S.init("ChangeOwnerCommand",t)})},createShareMenu:function(e){return x(F.action_share,"forward",function(){var t=[];e.forEach(function(e){t.push({physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,owner:e.options.grid.owner,icons:e.options.icons})}),S.init("ShareCmd",t)})},createOpenAttributesManagementForProposedSolutions:function(e){return x(F.attributes_management_proposed_solutions,"attributes",function(){A.trackCommandLaunched("openAttributesManagementForProposedSolutions-sax"),o.openAttributesManagementForProposedSolution(e,!0)})},createOpenInSAXMenu:function(e){return x(F.action_open,"open",function(){w.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:e[0].options.physicalid}})})},createOpenWithMenu:function(e){var t;return e&&e.length>0&&((t=x(F.action_open_with,"open-menu-dot")).submenu=[],e.forEach(function(e){t.submenu.push(x(e.text,e.fonticon,e.handler,null,null,e.icon))})),t},createRefineMenu:function(e,t){return x(F.action_refine_selection,"list-delete",function(){new s(e,t)})},createRelationsMenu:function(e){return x(F.relations,"object-related",function(){I.execute("ENORIPE_AP",e)})},createRemoveArchitectureNumberMenu:function(e,t,i){return x(F.action_remove_architecture_number,"remove",function(){A.trackCommandLaunched("removeArchitectureNumber-sax"),c.detachArchitectureReferenceExtension(e,t)},i,F.error_action_unavailable_in_release)},createRemoveProposedSolutionMenu:function(e,t,i){var n,o,r,a={};let s=widget.getValue("groupingEnabled");for(var l=0;l<t.length;l++)o=t[l].getParent().getParent(),s&&!o.getID&&(o=D.getGroupNodeParent(o)),r=o.options.physicalid,!i&&b.checkIfMaturityIsReleasedOrObsolete(o.options.maturity)&&(i=!0),(n=a[r]?a[r]:[]).push(t[l].options.physicalid),a[r]=n;var d=x(F.action_remove_proposed_solution,"remove",function(){A.trackCommandLaunched("removeProposedSolution-sax"),c.detachSolution(e,a,t)});return i&&(d.state="disabled",d.tooltip=F.error_action_unavailable_in_release),d},createReparentMenu:function(e,t,i,n){var r=x(F.action_reparent,"tree-reorder",null,n,F.error_action_unavailable_in_release);return r.submenu=[x(F.action_clear_reparent,"tree-reorder",function(){A.trackCommandLaunched("reparentActionClearSelection-sax"),i.reparentInstances=null,b.alertMessage("success",null,F.msg_reparentCleared)}),x(F.action_newparent,"tree-reorder",function(){A.trackCommandLaunched("reparentActionSetAsNewParent-sax"),o.reparentAction(e,t,i.reparentInstances),i.reparentInstances=null})],r},createReplaceByMenu:function(e,t,i,n){var r;(r="structured-view"!==widget.getValue("component-view")?x(F.action_replace_new_rev,"replace",!1,!0,F.error_action_unavailable_in_flattened_view):x(F.action_replace_new_rev,"replace",!1,n,F.error_action_unavailable_in_release)).submenu=[];var a=x(F.action_replace_new_rev,"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-replace",function(){this.defaultMenu.replaceBy="replaceByNewRevision",o.replaceByNewRevision(e,t)},null,null,null,"replaceByNewRevision");r.submenu.push(a);var s=x(F.action_replace_new_branch,"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-replace",function(){this.defaultMenu.replaceBy="replaceByNewBranch",o.replaceByNewRevision(e,t,!0)},null,null,null,"replaceByNewBranch");return r.submenu.push(s),r.submenu.push(x(F.action_replace_latest_rev,"replace-by-latest-version",function(){this.defaultMenu.replaceBy="replaceByLatestRevision",S.init("ReplaceByLatestRevCmd",e)},null,null,null,"replaceByLatestRevision"),x(F.action_replace_other_rev,"replace-by-revision",function(){this.defaultMenu.replaceBy="replaceByRevision",S.init("ReplaceByRevCmd",t.collectionView.treeDocument)},null,null,null,"replaceByRevision")),1===e.length&&e[0].options.instance&&e[0].options.instance.physicalid&&r.submenu.push(x(F.action_replace_exist_ref,"replace-by-existing",function(){this.defaultMenu.replaceBy="replaceByExistingReference";var i=e[0].getParent().options.physicalid,n=e[0].options.instance.physicalid,o=e[0].getRoot().options.physicalid;u.replaceByExisting(i,n,o,e[0],t.collectionView)},null,null,null,"replaceByExistingReference"),x(F.action_replace_new_ref,"replace",function(){this.defaultMenu.replaceBy="replaceByNewReference",i.publish({event:"create-new-logical-item",data:{isReplaceCall:!0}})},null,null,null,"replaceByNewReference")),L(r,"replaceBy"),r},createRevisionExplorerMenu:function(e){return x(F.revision_explorer,"flow-branch",function(){f.displayVersionGraph({modelKey:{id:e.options.physicalid,kind:e.options.type,isConfigured:!0}})})},createRevisionsMenu:function(e){return x(F.revisions,"flow-branch-list",function(){var t=[{physicalid:e.options.physicalid,label:e.options.label,type:e.options.type,displayType:e.options.grid.type,revision:e.options.grid.revision,current:e.options.grid.maturity,icons:e.options.icons}];S.init("HistoryCommand",t)})},createReserveMenu:function(e,t){return x(F.action_lock,"lock",function(){S.init("ReserveCmd",T(e))},t,F.error_action_unavailable_in_release)},createSelectToReparentMenu:function(e,t,i,n){return x(F.action_select_toreparent,"tree-reorder",function(){A.trackCommandLaunched("selectToReparent-sax");var i="";if(e&&e.length>0){for(var n=0;n<e.length;n++){if(!e[n].options.instance||!e[n].options.instance.physicalid)return void b.alertMessage("error",null,"",F.msg_remove_root);i=i+e[n].options.label+"<br>"}t.reparentInstances={instances:e,nameList:i},b.alertMessage("success",null,F.msg_reparentSaved)}},i,n)},createSetArchitectureNumberMenu:function(e,t){return x(F.set_architecture_number,"progress-3",function(){A.trackCommandLaunched("setArchitectureNumber-sax"),c.setArchitectureNumber(e,!1)},t,F.error_action_unavailable_in_release)},createSetProposedSolutionMenu:function(e,t){return x(F.action_set_proposed_solution,"3dproduct-add",function(){A.trackCommandLaunched("setProposedSolution-sax"),c.openModalSolutionSelection(e)},t,F.error_action_unavailable_in_release)},createUnreserveMenu:function(e){return x(F.action_unlock,"lock-open",function(){S.init("UnreserveCmd",T(e))},null,F.error_action_unavailable_in_release)},createDisplayConnectedDIFStructureMenu:function(e){return x(F.action_display_connected_DIF_structure,"display-layout-vertical-33",function(){E.DisplayConnectedDIFStructure(e)})}};return N}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.contextualmenu",["DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.actions","DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.factory","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o){"use strict";var r=n.getFullConfig(),a=r.identifiers,s=r.localStorageKeys;return{getMenu:function(e,n,l){var c=!1,d=!1,u=!1,p=!1,g=!1,m=!1,f=!1,h=e.collectionView.treeDocument.getRoots()[0],v=r.adminStatus,C=e.modelInfo;C&&C.modelVersion&&(C.modelVersion.current===a.state_act_Release||C.modelVersion.current===a.state_act_Obsolete)?d=!0:h&&i.checkIfMaturityIsReleasedOrObsolete(h.options.maturity)&&(d=!0);var b=e.collectionView.treeDocument.getSelectedNodes(),y=!1,_=!1;if(b[0].isRoot()&&(_=!0),1===b.length&&(b[0].isRoot()&&(y=!0),b[0].options.linkInfo&&(p=!0),b[0].options.linkInfo&&"implementing"===b[0].options.linkInfo.linkType&&"ref"===b[0].options.linkInfo.objType&&(f=!0),g||!b[0].options.maturity||-1===b[0].options.maturity.indexOf(a.state_act_Frozen)&&-1===b[0].options.maturity.indexOf(a.state_act_Released.toUpperCase())||!b[0].options.grid.architectureNumber||""===b[0].options.grid.architectureNumber||(g=!0),!m&&v.ReparentEnforceSetAN&&b[0].options.grid.architectureNumber&&""!==b[0].options.grid.architectureNumber&&(m=!0)),b.length>1)for(var w=!1,D=!1,S=0;S<b.length&&(b[S].options.grid.kindOfRFLP!==b[0].options.grid.kindOfRFLP&&(c=!0),i.checkIfMaturityIsReleasedOrObsolete(b[S].options.maturity)&&(u=!0),!c||!u);S++)w||(b[S].options.linkInfo?(p=!0,D||("implementing"===b[S].options.linkInfo.linkType&&"ref"===b[S].options.linkInfo.objType?f=!0:(D=!0,f=!1))):(w=!0,p=!1)),g||!b[S].options.maturity||-1===b[S].options.maturity.indexOf(a.state_act_Frozen)&&-1===b[S].options.maturity.indexOf(a.state_act_Released.toUpperCase())||!b[S].options.grid.architectureNumber||""===b[S].options.grid.architectureNumber||(g=!0),!m&&v.ReparentEnforceSetAN&&b[S].options.grid.architectureNumber&&""!==b[S].options.grid.architectureNumber&&(m=!0);else u=i.checkIfMaturityIsReleasedOrObsolete(b[0].options.maturity);var I=t.createOpenWithMenu(l),A=t.createInformationMenu(b,n,e.collectionView),F=t.createRefineMenu(b,e.collectionView.treeDocument),E=t.createImplementLinkInformationMenu(b,n,e.collectionView),k=t.createExpandMenu(e,b),x=t.createCollapseAllMenu(b),T=t.createReserveMenu(b,d),L=t.createUnreserveMenu(b),N=t.createMoveToMenu(b),M=t.createShareMenu(b),V=t.createDisplayConnectedDIFStructureMenu(b);if(c||b[0].options.type===a.type_requirement||b[0].options.type===a.type_act_functref||"R"===b[0].options.grid.kindOfRFLP||"F"===b[0].options.grid.kindOfRFLP){var O=[];return b[0].options.type!==a.type_requirement&&b[0].options.type!==a.type_act_functref&&"R"!==b[0].options.grid.kindOfRFLP&&"F"!==b[0].options.grid.kindOfRFLP||(I&&(O.push(I),O.push({type:"SeparatorItem"})),1===b.length&&b[0].options.linkInfo&&"ref"===b[0].options.linkInfo.objType&&O.push(t.createCreateImplementLinkOccToOccMenu(b,d),{type:"SeparatorItem"})),b.length>1&&O.push(F,{type:"SeparatorItem"}),O.push(A),p&&O.push(E),p&&O.push({type:"SeparatorItem"},t.createDeleteImplementLinkMenu(b,h,e,d)),O}if(b[0].options.type===a.type_act_physical||"P"===b[0].options.grid.kindOfRFLP){var P=[];return I&&P.push(I,{type:"SeparatorItem"}),b.length>1&&P.push(F),1===b.length&&b[0].options.linkInfo&&"ref"===b[0].options.linkInfo.objType&&P.push(t.createCreateImplementLinkOccToOccMenu(b)),p||P.push(t.createOpenAttributesManagementForProposedSolutions(b),t.createDisplayMoreAttributesMenu(e.collectionView,b,!0)),P.push({type:"SeparatorItem"},A),p&&P.push(E),function(){for(var e=0;e<b.length;e++)if("proposedSolutionCategory"!==b[e].getParent().options.type)return!1;return!0}()?P.push({type:"SeparatorItem"},t.createRemoveProposedSolutionMenu(e.collectionView.treeDocument,b,d||u)):p&&P.push({type:"SeparatorItem"},t.createDeleteImplementLinkMenu(b,h,e)),P}if(b[0].getParent().options.type===a.type_spec_document){var R=[];return I&&R.push(I,{type:"SeparatorItem"}),b.length>1&&R.push(F,{type:"SeparatorItem"}),R.push(N,M,{type:"SeparatorItem"},t.createDocumentDownloadMenu(b),A,{type:"SeparatorItem"},t.createDocumentDetachMenu(b)),R}if(b[0].options.type===a.type_act_logref||"L"===b[0].options.grid.kindOfRFLP){var W=[],B=null,U=this.reparentInstances;if(widget.getValue("component-view")!==s.structuredView)y||(B=t.createSelectToReparentMenu(b,null,!0,o.error_action_unavailable_in_flattened_view));else if(U&&U.instances.length>0&&1===b.length){var j=!1;(d||i.checkIfMaturityIsReleasedOrObsolete(b[0].options.maturity))&&(j=!0),B=t.createReparentMenu(b,e,this,j)}else B=U&&U.instances.length>0&&b.length>1||y?null:t.createSelectToReparentMenu(b,this,d,o.error_action_unavailable_in_release);1!==b.length||y||W.push(t.createOpenInSAXMenu(b)),I&&W.push(I),W.length>0&&W.push({type:"SeparatorItem"}),b.length>1&&W.push(F);for(var G=0;G<b.length;G++)if("implementLinksCategory"===b[G].getParent().options.type)return p&&W.push(t.createDisplayMoreAttributesMenu(e.collectionView,b),{type:"SeparatorItem"}),1===b.length&&b[0].options.linkInfo&&"ref"===b[0].options.linkInfo.objType&&W.push(t.createCreateImplementLinkOccToOccMenu(b,d),{type:"SeparatorItem"}),f&&W.push(t.createMaturityMenu(b),{type:"SeparatorItem"},t.createMoveToMenu(b),M,{type:"SeparatorItem"}),W.push(A),p&&W.push(E),W.push({type:"SeparatorItem"}),p&&W.push(t.createDeleteImplementLinkMenu(b,h,e,d)),W;W.push(k,x,{type:"SeparatorItem"}),1===b.length&&W.push(t.createCopyMenu(b,e,this)),this.dataCopied&&W.push(t.createPasteCommand(b,this,d||u)),1===b.length&&W.push(t.createInsertNewMenu(b,n,d||u),t.createInsertExistingMenu(b,e.collectionView,d||u)),W.push(t.createSetArchitectureNumberMenu(b,d||u));for(let i=0;i<b.length;i++)if(void 0!==b[i].options.grid.architectureNumber&&""!==b[i].options.grid.architectureNumber){W.push(t.createRemoveArchitectureNumberMenu(b,e.collectionView.getContent(),d||u));break}return W.push(t.createSetProposedSolutionMenu(b,d||u)),W.push(t.createEditConfigurationContextMenu(b,e)),1===b.length&&W.push(t.createSelectbyConfigurationCriteria(b,e)),y||_||(v.ConfiguredRevisionEnabled&&W.push(t.createAddToConfigurationRevisionMenu(b,e)),W.push(t.createVariantEffectivityMenu(b,e,1===b.length,!1)),W.push(t.createEvolutionEffectivityMenu(b,e,1===b.length,!1))),1===b.length&&(W.push(t.createSpaceAssignmentMenu(b[0],d||u)),W.push(t.createCreateImplementLinkRefToRefMenu(b[0],d||u))),y||_||W.push(t.createConsolidateLogicalDefinitionMenu(b,e)),y||W.push(t.createReplaceByMenu(b,e,n,d)),null!==B&&W.push(B),W.push({type:"SeparatorItem"}),1===b.length&&W.push(t.createRevisionsMenu(b[0]),t.createRevisionExplorerMenu(b[0]),t.createDuplicateMenu(b[0])),b.length<=2&&W.push(t.createCompareMenu(b)),v.FullCompareEnabled&&1===b.length&&!y&&W.push(t.createCompareWithLastOutfitted(b,e.collectionView)),W.push(t.createMaturityMenu(b),{type:"SeparatorItem"}),W.push(T,L,N,M,{type:"SeparatorItem"}),y||_||W.push(t.createCheckEffectivityConsistencyMenu(b,e)),W.push(V,t.createRelationsMenu(b[0]),A),y||_||W.push({type:"SeparatorItem"},t.createDetachMenu(b,e,m,g,d)),W}if("DIF"===b[0].options.grid.kindOfRFLP)return[t.createMaturityMenu(b),{type:"SeparatorItem"},N,M,{type:"SeparatorItem"},t.createRelationsMenu(b[0]),A]}}}),define("DS/CATFLCockpitWidget/components/LandingPage/referencesView",["DS/CoreEvents/ModelEvents","DS/CATFLCockpitWidget/utils/model.events.util","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Mask","DS/ENOXEmptyContent/js/ENOXEmptyContent","DS/ENOXPageToolBar/js/PageToolBar","DS/Tweakers/GeneratedToolbar","DS/Menu/Menu","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CollectionView/ResponsiveThumbnailsCollectionView","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/ResponsiveLargeTilesCollectionView","DS/CATFLCockpitWidget/components/ContextualMenu/contextualmenu.factory","DS/Controls/Button","DS/Controls/ModalContainer","DS/Controls/Loader","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/components/CreateLogicalItemModal/logRef.createPanel.modalWindow","DS/CATFLCockpitWidget/components/CreateLogicalItemModal/CreateLogicalItemHelper","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/index.service","DS/CATFLCockpitWidget/utils/SAXTracker","text!DS/CATFLCockpitWidget/assets/config/navigate.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f,h,v,C,b,y,_,w,D,S,I,A,F,E){"use strict";var k=d.getFullConfig(),x=(k.localStorageKeys,k.identifiers);return{init:function(e){let i=e.id,n=e.title;this.container=e.container,this.triptych=e.triptych,this.propertiesPanel=e.rightPanel;t.createAppEventObject("flweb-triptych-model-events");this.createContents(this.container),widget.setTitle(""),this.createToolbar(),this.createGeneratedToolbar(i),this.highlightWelcomePanelAction(i),this.setTitle(n),this.subscribeToEvents(),this.validateWorkUnder(),u.makeDroppable(this.container,E.msg_drop_to_open,function(e){t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-drop-item",data:{item:e}})});var o,r=widget.getValue("previouslyOpenedItems");return o=r?JSON.parse(r):null,this.itemView=this.getItemContent(i,o),this},createToolbar:function(){this.modelEvents=new e;var t={withInformationButton:!0,withWelcomePanelButton:!0,modelEvents:this.modelEvents,parentContainer:this.headerContainer};this._pageToolBar=new r(t),this._pageToolBar.render().inject(this.headerContainer)},setTitle:function(e){this._pageToolBar.getBodyContent().innerHTML=e},subscribeToEvents:function(){var e=this;e.modelEvents.subscribe({event:"welcome-panel-collapse"},function(){e.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"left"}),e.modelEvents.publish({event:"welcome-panel-collapsed"})}),e.modelEvents.subscribe({event:"welcome-panel-expand"},function(){e.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"left"}),e.modelEvents.publish({event:"welcome-panel-expanded"})}),e.modelEvents.subscribe({event:"information-panel-open"},function(){t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-properties",data:{items:e.treeDocument.getSelectedNodes(),contentView:e.collectionView}}),e.triptych.modelEvents.publish({event:"triptych-show-panel",data:"right"})}),e.modelEvents.subscribe({event:"information-panel-close"},function(){e.triptych.modelEvents.publish({event:"triptych-hide-panel",data:"right"})}),e.modelEvents.subscribe({event:"triptych-panel-hidden"},function(t){"right"===t&&e.triptych.modelEvents.publish({event:"information-panel-hidden",data:null})}),e.modelEvents.subscribe({event:"information-panel-hidden"},function(t){e.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"right"})}),e.triptych.modelEvents.subscribe({event:"triptych-panel-hidden"},function(t){"right"===t&&e.triptych._container.getElement(".fonticon.fonticon-2x.fonticon-info")&&e.triptych._container.getElement(".fonticon.fonticon-2x.fonticon-info").classList.remove("selected")}),widget.subscribedToAuthoringInLanding||(i.subscribe("DS/PADUtils/PADCommandProxy/refresh",e.refreshCollectionViewOnItemUpdate.bind(e)),widget.subscribedToAuthoringInLanding=!0)},getItemContent:function(e,t){var i=this;let n=i.container.getElement(".fl-"+e+"-container .fl-view-container"),o={};i.recentsResponse=[],i.userContent=[],i.treeDocument=new l,i.collectionView=new p({displayedOptionalCellProperties:["contextualMenu"]}).inject(n);var r=JSON.parse(F);i.loader=new C,i.loader.on(E.msg_loading);try{v.createModal(n,i.loader.elements.container)}catch(e){console.error("Error: "+e)}if("recents"===e)if(t&&t.length>0){var a=[];a.push(I.fetch(t,r.basic.attributes,!0)),a.push(I.getRecentsContent()),Promise.all(a).then(function(e){if("Recents"!==widget.getValue("landingPage"))return;let r=e[0],a=e[1];r.forEach(function(e){let t=i.createNodeModel(e);t.options.customTooltip=i.getTooltip(t,e),o[t.getID()]=t}),a.forEach(function(e){let n=i.createNodeModel(e);n.options.customTooltip=i.getTooltip(n,e),t.includes(n.getID())&&(o[n.getID()]=n)});let s=[];t.forEach(e=>{o[e]&&s.push(o[e])}),i.renderCollectionView(n,s),i.updateView(),i.sortUpdate(),i.loader.off(E.msg_loading),v.removeModal(n)})}else i.createEmptyPage();else I.getUserContent().then(function(e){if("Recents"===widget.getValue("landingPage"))return;let t=[];e&&e.length>0?(e.forEach(function(e){let n=i.createNodeModel(e);n.options.customTooltip=i.getTooltip(n,e),t.push(n)}),i.renderCollectionView(n,t),i.updateView(),i.sortUpdate(),i.loader.off(E.msg_loading),v.removeModal(n)):i.createEmptyPage()})},createNodeModel:function(e){var t,i,n,o;(o=e.NLStype)||(o=k.mappingType[e.type]?k.mappingType[e.type].nlsName:e.type),t=e.architectureNumber?e.architectureNumber:"",i=e.label+" - "+e.revision,n=e.maturity+" | "+o+" | "+e.owner+" | "+e.creationDate+" | "+e.modificationDate;let r=E.label_arch_no+": "+t+"<br>"+E.label_owner+": "+e.owner+"<br>"+E.label_creation_date+": "+e.creationDate+"<br>"+E.label_modification_date+": "+e.modificationDate;return new c({label:i,thumbnail:e.icon,subLabel:n,description:r,contextualMenu:["contextual menu"],emptyStatusbarVisibleFlag:!1,activeFlag:!1,physicalid:e.resourceid,name:e.name,type:e.type,nlsType:o,maturity:e.status,owner:e.owner,creationDate:e.creationDate,modificationDate:e.modificationDate,maturityState:e.maturity,archNo:t,customTooltip:""})},getTooltip:function(e,t){var i;return e&&(i=E.label_title.bold()+": "+t.label+"\n",i+=E.label_revision.bold()+": "+t.revision+"\n",i+=E.label_type.bold()+": "+e.options.nlsType+"\n",i+=E.label_maturity.bold()+": "+e.options.maturityState+"\n",i+=E.label_owner.bold()+": "+e.options.owner+"\n",i+=E.label_creation_date.bold()+": "+e.options.creationDate+"\n",i+=E.label_modification_date.bold()+": "+e.options.modificationDate+"\n",i+=E.label_arch_no.bold()+": "+e.options.archNo+"\n"),i},selectedChange:function(e,i){var n=this;t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-properties",data:{items:n.treeDocument.getSelectedNodes(),contentView:n.collectionView}}),n.viewGeneratedToolbar.elements.farContainer.querySelector(".wux-ui-style-smartIcon.arrow-icon.wux-tweaker-function-displaycount").addEventListener("click",function(e){s.show(n.getMenuLanding(n.modelEvents),{input:"mouse",position:{x:e.pageX,y:e.pageY},submenu:"auto"})});var o=n.collectionView.TreedocModel.getSelectedNodes().length;0===o?n.viewGeneratedToolbar.updateNodeModel("selectionMenu",{visibleFlag:!1}):n.viewGeneratedToolbar.updateNodeModel("selectionMenu",{visibleFlag:!0,count:o});let r=n.treeDocument.getSelectedNodes();var a=d.form3DXContent(r);d.setObjectOnCompass(a),d.launchCrossAppSelection(r)},openItem:function(e){let i=e.nodeModel||e.cellModel;t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:i.getID()}})},configureView:function(e){var t=this;e.useDragAndDrop=!0,e.allowUnsafeHTMLContent=!0,e.onDragStartCell=function(e,i){return e.dataTransfer.setData("Text",JSON.stringify(u.create3DXJsonFromDGVSelection(t.treeDocument.getSelectedNodes(),!1))),!1},e.onDragCell=function(e,i){return e.dataTransfer.setData("Text",JSON.stringify(u.create3DXJsonFromDGVSelection(t.treeDocument.getSelectedNodes(),!1))),!1},e.onCellDoubleClick(t.openItem.bind(t)),e.onSelectionAdd(t.selectedChange.bind(t,t.triptych,t.propertiesPanel)),e.onSelectionRemove(t.selectedChange.bind(t,t.triptych,t.propertiesPanel)),e.onContextualEvent={callback:function(e){var i=e.cellInfos.cellView.collectionView.TreedocModel.getSelectedNodes();return i.length>1?t.getMenuLanding(t.modelEvents,e):1===i.length?S.getTypeHierarchy(i[0].options.type).then(function(n){return u.getOpenWithCompatibleApps(i[0],n).then(function(i){return t.getMenuLanding(t.modelEvents,e,i)})}):void 0}}},getMenuLanding:function(e,t,i){var n,o=[];return 1===(n=this.collectionView.TreedocModel.getSelectedNodes()).length?(t&&o.push(f.createOpenInSAXMenu(n),f.createOpenWithMenu(i)),o.push(f.createRevisionsMenu(n[0]),f.createRevisionExplorerMenu(n[0]),f.createDuplicateMenu(n[0]),f.createCompareMenu(n),f.createMaturityMenu(n),{type:"SeparatorItem"},f.createReserveMenu(n),f.createUnreserveMenu(n),f.createMoveToMenu(n),f.createShareMenu(n),{type:"SeparatorItem"},f.createRelationsMenu(n[0]),f.createInformationMenu(n,e,this.collectionView))):o.push(f.createDuplicateMenu(n[0]),f.createCompareMenu(n),f.createMaturityMenu(n),{type:"SeparatorItem"},f.createReserveMenu(n),f.createUnreserveMenu(n),f.createMoveToMenu(n),f.createShareMenu(n),{type:"SeparatorItem"},f.createInformationMenu(n,e,this.collectionView)),o},newLogRef:function(e,t){require(["DS/CATFLCockpitWidget/utils/SAXTracker"],function(e){e.trackCommandLaunched("createNewLogRef-sax")}),_.createNewLogicalItem({data:{selectedItem:null},treeDocument:this.thumbnailcollectionView?this.thumbnailcollectionView.TreedocModel:null,isRoot:!0})},createContents:function(e){this.flHeaderContainer=UWA.createElement("div",{class:"fl-header-container"}).inject(e),this.headerContainer=UWA.createElement("div",{class:"header-container"}).inject(this.flHeaderContainer),UWA.createElement("div",{class:"toolbar-container"}).inject(this.flHeaderContainer),UWA.createElement("div",{class:"fl-view-container"}).inject(e)},highlightWelcomePanelAction:function(e){"recents"===e?document.body.querySelector("#action_recents").classList.value="activity-btn selected":document.body.querySelector("#action_my_references").classList.value="activity-btn selected"},createEmptyPage:function(){var e=this,i=e.container.getElement(".fl-view-container");i&&i.empty();var n=new h({domId:"addButton",label:E.label_start_with_new_reference_button,emphasize:"primary",type:"standard"}),r={sentences:[{type:"drop",text:E.label_drop_here_to_open},{type:"dom",DOMelement:n.getContent()}],orderedListType:"none"};e.emptyView=new o(r),e.emptyView.inject(i),e.loader&&(e.loader.off(E.msg_loading),v.removeModal(i)),n.addEventListener("buttonclick",()=>{var n=t.createAppEventObject("flcockpit-content-list-view");e.newLogRef(n,i)})},renderCollectionView:function(e,t){var i=this;0==t.length?i.createEmptyPage():t.length>0&&t.forEach(function(e){i.treeDocument.addRoot(e)})},createGeneratedToolbar:function(e){var t=this;let i=UWA.createElement("div",{class:"landingPage-toolbar"}).inject(t.headerContainer);var n;n="recents"===e?widget.getValue("recentsCollectionView")?widget.getValue("recentsCollectionView"):"Thumbnails":widget.getValue("myReferencesCollectionView")?widget.getValue("myReferencesCollectionView"):"Thumbnails";let o={id:"selectionMenu",dataElements:{typeRepresentation:"functionMenuIconCount",tooltip:E.multi_select_btn,icon:{iconName:"select-on",fontIconFamily:1,fontIconSize:"2x"},count:1,position:"far",category:"1",visibleFlag:!1}},r={id:"sortToolbar",dataElements:{typeRepresentation:"icon",tooltip:E.sort_btn,value:"label1",possibleValues:[{value:"label1",label:E.label_title,icon:{iconName:"alpha-sorting-a-z",fontIconFamily:1,fontIconSize:"2x"}},{value:"label2",label:E.label_title,icon:{iconName:"alpha-sorting-z-a",fontIconFamily:1,fontIconSize:"2x"}},{value:"maturity",label:E.label_maturity,icon:{iconName:"alpha-sorting-a-z",fontIconFamily:1,fontIconSize:"2x"}},{value:"owner",label:E.label_owner,icon:{iconName:"alpha-sorting-a-z",fontIconFamily:1,fontIconSize:"2x"}},{value:"creationDate",label:E.label_creation_date,icon:{iconName:"date-sorting-1-31",fontIconFamily:1,fontIconSize:"2x"}},{value:"modificationDate",label:E.label_modification_date,icon:{iconName:"date-sorting-1-31",fontIconFamily:1,fontIconSize:"2x"}}],position:"far",category:"2"},onNodeUpdate:function(e){t.sortUpdate(e)}},s={id:"viewOptions",dataElements:{typeRepresentation:"icon",tooltip:E.switch_view,value:n,possibleValues:[{value:"SmallTiles",label:E.tile_view,icon:{iconName:"view-small-tile",fontIconFamily:1,fontIconSize:"2x"}},{value:"Thumbnails",label:E.thumbnail_view,icon:{iconName:"view-big-thb",fontIconFamily:1,fontIconSize:"2x"}},{value:"LargeTiles",label:E.large_tile_view,icon:{iconName:"view-big-tile",fontIconFamily:1,fontIconSize:"2x"}}],position:"far",category:"2"},onNodeUpdate:function(e){t.updateView(e)}};var l={entries:[o,{id:"searchField",dataElements:{typeRepresentation:"string",value:"",placeholder:E.label_search,allowResetToUndefinedByUIFlag:!0,position:"far",category:"2"},onNodeLiveUpdate:function(e,i){t.searchView(e,i)}},{id:"searchBtn",dataElements:{typeRepresentation:"functionIcon",tooltip:E.search_log_Refs,value:function(){t.openSearchField()},icon:{iconName:"search",fontIconFamily:1},position:"far",category:"2"}},s,r],useWebUITooltip:!0};t.toolbarTreeDocument=a.prototype.createTreeDocument(l),t.viewGeneratedToolbar=new a({overflowManagement:"dropdown",direction:"horizontal",items:t.toolbarTreeDocument}),t.viewGeneratedToolbar.inject(i),t.viewGeneratedToolbar.updateNodeModel("searchField",{visibleFlag:!1}),t.visibleFlag=!0},sortUpdate:function(e){var t,i;e?(t=e.getAttributeValue("data"),i="label2"===t?-1:1):(t="label1",i=1),this.treeDocument.prepareUpdate(),this.treeDocument._getTrueRoot().sortChildren({isRecursive:!0,sortFunction:function(e,n){return i*(e.getSortableAttributeValue(t)<n.getSortableAttributeValue(t)?-1:1)}}),this.treeDocument.pushUpdate()},updateView:function(e){var t,i,n;"Recents"===(n=widget.getValue("landingPage"))||void 0===n?(t=widget.getValue("recentsCollectionView")?widget.getValue("recentsCollectionView"):"Thumbnails",e&&(t=e.getAttributeValue("data")),i=this.container.querySelector(".fl-recents-container .fl-view-container"),widget.setValue("recentsCollectionView",t)):(t=widget.getValue("myReferencesCollectionView")?widget.getValue("myReferencesCollectionView"):"Thumbnails",e&&(t=e.getAttributeValue("data")),i=this.container.querySelector(".fl-myReferences-container .fl-view-container"),widget.setValue("myReferencesCollectionView",t)),i.empty(),this.collectionView="SmallTiles"===t?new g({displayedOptionalCellProperties:["contextualMenu"]}):"LargeTiles"===t?new m({displayedOptionalCellProperties:["contextualMenu"]}):new p({displayedOptionalCellProperties:["contextualMenu"]}),this.collectionView.inject(i),this.collectionView.loadApplicativeModel(this.treeDocument),this.configureView(this.collectionView)},searchView:function(e,t){this.treeDocument.search({match:function(e){if(t&&-1===e.nodeModel.options.label.indexOf(t))return e.nodeModel.hide(),!0;e.nodeModel.show()}})},openSearchField:function(){this.viewGeneratedToolbar.updateNodeModel("searchField",{visibleFlag:this.visibleFlag}),this.visibleFlag=!this.visibleFlag},validateWorkUnder:function(){S.getUserPreferences(x.user_pref_workunder).then(function(e){e&&t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-manage-workUnder",data:{rez:e}})})},refreshCollectionViewOnItemUpdate:function(e){var t,i=this,n=[];if("Recents"===widget.getValue("landingPage")){if(e.data.authored){if(e.data.authored.deleted){let n=widget.getValue("previouslyOpenedItems");n=n?JSON.parse(n):[],i.treeDocument.prepareUpdate(),e.data.authored.deleted.forEach(function(e){var o=i.treeDocument.getNodesById(e)[0];i.treeDocument.removeRoot(o),t=n.indexOf(e),n.splice(t,1)}),i.treeDocument.pushUpdate(),widget.setValue("previouslyOpenedItems",JSON.stringify(n))}e.data.authored.modified&&(e.data.authored.modified.forEach(function(e){e.key?n.push(e.physicalid):n.push(e)}),D.getObjectAttributes(n).then(function(e){var t=Object.keys(e);i.treeDocument.prepareUpdate();for(let d=0;d<t.length;d++){var n=t[d],o=e[n].attributes,r=o.label+" - "+o.grid.revision,a=u.displayDate(o.grid.creationDate),s=u.displayDate(o.grid.modificationDate),l=o.grid.maturity+" | "+o.grid.type+" | "+o.grid.owner+" | "+a+" | "+s,c=i.treeDocument.getNodesById(n)[0];c&&(c.options.label=r,c.options.subLabel=l,c.options.maturityState=o.grid.maturity,c.options.owner=o.grid.owner,c.options.description=E.label_arch_no+": "+o.grid.architectureNumber+"\n"+E.label_owner+": "+o.grid.owner+"\n"+E.label_creation_date+": "+a+"\n"+E.label_modification_date+": "+s)}i.treeDocument.pushUpdate()}))}}else u.alertMessage("info",null,E.msg_authoring_my_logical_references)}}}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.toolbar",["UWA/Core","DS/CATFLCockpitWidget/utils/model.events.util","DS/Tweakers/GeneratedToolbar","DS/Controls/TooltipModel","DS/Menu/Menu","DS/CATFLCockpitWidget/components/AttributesManagement/AttributesManagement","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.contextualmenu","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.configure.expand","DS/CATFLCockpitWidget/components/ExportCSV/ExportGridView","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/preferences.util","DS/CATFLCockpitWidget/utils/tooltip.util","DS/CATFLCockpitWidget/utils/SAXTracker","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m){"use strict";var f=d.getFullConfig(),h=f.localStorageKeys,v=f.identifiers,C=function(e,t,i){this.container=e,this.gridView=t,this.modelEvents=i,this.createToolbarOptions(),this.render()};return C.prototype.createToolbarOptions=function(){var e,n=this;n.currentCompView=widget.getValue("component-view");t.getFLWebModelEventsObj("flweb-model-events");var o=widget.getValue("modelAttached"),a=n.gridView.treeDocument.getRoots()[0],c=n.gridView.treeDocument.getSelectedNodes(),d=!1,u={openFromToolbar:!0,collectionView:n.gridView};o&&(u.bModelAttached=!0,u.modelInfo=widget.getValue("currentConfig")),o&&o.modelVersion&&(o.modelVersion.current===v.state_act_Release||o.modelVersion.current===v.state_act_Obsolete)?d=!0:(!a||a.options.grid.maturity!==v.state_act_Released&&a.options.grid.maturity!==v.state_act_Obsolete)&&(!c||1!==c.length||c[0].options.grid.maturity!==v.state_act_Released&&c[0].options.grid.maturity!==v.state_act_Obsolete)||(d=!0),n.currentCompView===h.structuredView?e="structuredView":n.currentCompView===h.flattenedView?e="flattenedView":n.currentCompView===h.flattenedViewOnlyArchitectureItem&&(e="flattenedViewOnlyArchitectureItem");let f={id:"selectionMenu",dataElements:{typeRepresentation:"functionMenuIconCount",tooltip:"Multiselect",value:{menu:n.getMenuItems()},icon:{iconName:"select-on",fontIconFamily:1},count:1,position:"far",category:"1",visibleFlag:!1}},C={id:"addaction",dataElements:{typeRepresentation:"functionMenuIcon",icon:{iconName:"plus",fontIconFamily:1,fontIconSize:"3x"},position:"far",category:"2"},children:[{id:"create-new-logical-ref",dataElements:{typeRepresentation:"PushItem",label:m.action_add_new,action:{callback:n.insertNewLogRef.bind(n,d)}},icon:{iconName:"plus",fontIconFamily:1,fontIconSize:"0.75x"}},{id:"create-existing-ref",dataElements:{typeRepresentation:"PushItem",label:m.action_add_existing,action:{callback:n.insertExistingLogRef.bind(n,d)}},icon:{iconName:"insert",fontIconFamily:1,fontIconSize:"0.75x"}}],disabled:"structured-view"!==n.currentCompView},b={id:"ngFilter",dataElements:{typeRepresentation:"functionIcon",value:function(){n.modelEvents.publish({event:"content-list-view-ngFilter-open"})},icon:{iconName:"filter",fontIconFamily:1,fontIconSize:"0.75x"},position:"far",category:"2",disabled:!0}},y={id:"cues-status",dataElements:{typeRepresentation:"functionMenuIcon",icon:{iconName:"dataflow-input-output",fontIconFamily:1},position:"far",category:"2",disabled:!0},children:[{id:"compute-cues",dataElements:{typeRepresentation:"PushItem",label:m.action_compute_cues,action:{callback:function(){g.trackCommandLaunched("computeConvergenceStates-sax"),n.modelEvents.publish({event:"content-list-view-validate-cues"})}},icon:{iconName:"compute",fontIconFamily:1,fontIconSize:"0.75x"}}},{id:"clear-cues",dataElements:{typeRepresentation:"PushItem",label:m.action_clear_cues,action:{callback:function(){g.trackCommandLaunched("clearConvergenceStates-sax"),n.modelEvents.publish({event:"content-list-view-clear-cues"})}},icon:{iconName:"clear",fontIconFamily:1,fontIconSize:"0.75x"}}},{id:"export-cues",dataElements:{typeRepresentation:"PushItem",label:m.action_export_cues,action:{callback:function(){g.trackCommandLaunched("exportConvergenceStates-sax"),n.modelEvents.publish({event:"content-list-view-export-cues"})}},icon:{iconName:"export",fontIconFamily:1,fontIconSize:"0.75x"}}}]},_={id:"attributes-management",dataElements:{typeRepresentation:"functionIcon",value:function(){new r},icon:{iconName:"attributes",fontIconFamily:1,fontIconSize:"3x"},position:"far",category:"2"}},w={id:"configure-expand",dataElements:{typeRepresentation:"functionIcon",value:function(){g.trackCommandLaunched("configureExpand-sax"),new s({}).render(n)},icon:{iconName:"flow-tree-expand-down-cog",fontIconFamily:1,fontIconSize:"0.75x"},position:"far",category:"2"}},D={id:"viewSwitcher",dataElements:{typeRepresentation:"icon",icon:{iconName:"tree-table",fontIconFamily:1},value:e,possibleValues:[{value:"structuredView",label:m.action_structured,tooltip:m.action_structured,icon:{iconName:"tree-table",fontIconFamily:1}},{value:"flattenedView",label:m.replace(m.action_flattened,{levelCnt:parseInt(widget.getPreference(h.depthFlattenedView).value,10)}),tooltip:m.replace(m.action_flattened,{levelCnt:parseInt(widget.getPreference(h.depthFlattenedView).value,10)}),icon:{iconName:"table",fontIconFamily:1}},{value:"flattenedViewOnlyArchitectureItem",label:m.replace(m.action_flattened_arch,{levelCnt:parseInt(widget.getPreference(h.depthFlattenedViewArchitectureItemOnly).value,10)}),tooltip:m.replace(m.action_flattened_arch,{levelCnt:parseInt(widget.getPreference(h.depthFlattenedViewArchitectureItemOnly).value,10)}),icon:{iconName:"table",fontIconFamily:1}}],position:"far",category:"3"},onNodeUpdate:function(e){n.viewSwitcherUpdate(e)}};var S={entries:[f,C,b,y,_,w,{id:"exportGrid",dataElements:{typeRepresentation:"functionIcon",value:function(){l.exportgridViewCSV(n.gridView)},icon:{iconName:"export-to-csv",fontIconFamily:1,fontIconSize:"3x"},position:"far",category:"2",disabled:widget.getValue("groupingEnabled")}},D],currentView:n.currentCompView,modelEvents:n.modelEvents,useWebUITooltip:!0};S.entries.splice(3,0,{id:"specificFilter",dataElements:{typeRepresentation:"icon",value:"noSpecificFilter",possibleValues:[{value:"noSpecificFilter",label:m.action_no_filter,icon:{iconName:"filter-add",fontIconFamily:1}},{value:"filterAllDisciplines",label:m.action_discipline_filter,icon:{iconName:"filter-add",fontIconFamily:1}},{value:"filterPilotingDisciplines",label:m.action_piloting_discipline_filter,icon:{iconName:"filter-add",fontIconFamily:1}},{value:"filterProposedSolutions",label:m.action_proposed_solutions_filter,icon:{iconName:"filter-add",fontIconFamily:1}}],position:"far",category:2,visibleFlag:!0,disabled:!0},onNodeUpdate:function(e){n.specificFilterFun(e)}}),n.toolbarTreeDocument=i.prototype.createTreeDocument(S),n.tooltips=p.loadTooltips(["addaction","ngFilter","cuesStatus","attributesManagement","configureExpand","specificFilter","structuredView","flattenedView","flattenedViewOnlyArchitectureItem","exportGrid"]),n._setToolbarBtnTooltip("addaction",n.tooltips.addaction),n._setToolbarBtnTooltip("ngFilter",n.tooltips.ngFilter),n._setToolbarBtnTooltip("cues-status",n.tooltips.cuesStatus),n._setToolbarBtnTooltip("attributes-management",n.tooltips.attributesManagement),n._setToolbarBtnTooltip("configure-expand",n.tooltips.configureExpand),n._setToolbarBtnTooltip("specificFilter",n.tooltips.specificFilter),n._setToolbarBtnTooltip("viewSwitcher",n.tooltips[e]),n._setToolbarBtnTooltip("exportGrid",n.tooltips.exportGrid),n.modelEvents.subscribe({event:"wux-generated-toolbar-multiselect-icon-update-count"},n.updateCountOfMultiSelect.bind(n)),n.modelEvents.subscribe({event:"content-list-view-refresh-complete"},n.enableDisableFilterCues.bind(n)),n.modelEvents.subscribe({event:"content-list-view-grouping-status-change"},n.enableDisableExportGrid.bind(n)),t.getFLWebModelEventsObj("flweb-model-events").subscribe({event:"flweb-ngfilter-removed"},n.resetFilters.bind(n)),t.getFLWebModelEventsObj("flweb-model-events").subscribe({event:"flweb-ngfilter-added"},n.resetFilters.bind(n))},C.prototype._setToolbarBtnTooltip=function(e,t){if(t){if(t.isEmpty())return setTimeout(this._setToolbarBtnTooltip.bind(this,e,t),1e3);"viewSwitcher"===e&&(t._properties.mouseRelativePosition.value=!0),this.myGeneratedToolbar&&this.myGeneratedToolbar.updateNodeModel(e,{tooltip:t})}},C.prototype.insertNewLogRef=function(e){this.gridView.treeDocument.getSelectedNodes().length>0&&e?c.alertMessage("error",null,"",m.error_additem_in_release):this.modelEvents.publish({event:"create-new-logical-item"})},C.prototype.insertExistingLogRef=function(e){this.gridView.treeDocument.getSelectedNodes().length>0&&e?c.alertMessage("error",null,"",m.error_additem_in_release):this.modelEvents.publish({event:"content-view-add-existing-item"})},C.prototype.viewSwitcherUpdate=function(e){var t,i=e.getAttributeValue("data");e._options.disabled||("structuredView"===i?t="structured-view":"flattenedView"===i?t="flattened-view":"flattenedViewOnlyArchitectureItem"===i&&(t="flattend-view-only-architecture-item"),t!==this.currentCompView&&(widget.setValue(h.componentView,t),this.currentCompView=t,this.modelEvents.publish({event:"content-list-view-refresh"}),this._setToolbarBtnTooltip("viewSwitcher",this.tooltips[i]),"structured-view"===t?this.myGeneratedToolbar.updateNodeModel("addaction",{disabled:!1}):this.myGeneratedToolbar.updateNodeModel("addaction",{disabled:!0}))),this.setConfigureExpandButtonActiveState()},C.prototype.updateCountOfMultiSelect=function(e){var t=this;if(t.multiSelEvt||(t.myGeneratedToolbar.elements.farContainer.querySelector(".wux-ui-style-smartIcon.arrow-icon.wux-tweaker-function-displaycount").addEventListener("click",function(e){var i={openFromToolbar:!0,collectionView:t.gridView};widget.getValue("modelAttached")&&(i.bModelAttached=!0,i.modelInfo=widget.getValue("currentConfig")),o.show(a.getMenu(i,t.modelEvents),{input:"mouse",position:{x:e.pageX,y:e.pageY},submenu:"auto"})}),t.multiSelEvt=!0),0===e?t.myGeneratedToolbar.updateNodeModel("selectionMenu",{visibleFlag:!1}):t.myGeneratedToolbar.updateNodeModel("selectionMenu",{visibleFlag:!0,count:e}),"structured-view"!==widget.getValue(h.componentView)||e>1)t.myGeneratedToolbar.updateNodeModel("addaction",{disabled:!0});else if(1===e){let e=t.gridView.treeDocument.getSelectedNodes()[0];t.myGeneratedToolbar.updateNodeModel("addaction",{disabled:"L"!==e.options.grid.kindOfRFLP||"implementLinksCategory"===e.getParent().options.type})}else t.myGeneratedToolbar.updateNodeModel("addaction",{disabled:!1})},C.prototype.enableDisableFilterCues=function(){var e=this;e._firstRefreshComplete||(e.myGeneratedToolbar.updateNodeModel("ngFilter",{disabled:!1}),e.myGeneratedToolbar.updateNodeModel("cues-status",{disabled:!1}),e.myGeneratedToolbar.updateNodeModel("specificFilter",{disabled:!1}),e._firstRefreshComplete=!0);var t=e.myGeneratedToolbar.elements.farContainer.querySelector(".wux-button-icon-fi.wux-ui-genereatedicon-fi.wux-ui-3ds.wux-ui-3ds-filter-add.wux-ui-3ds-lg");t&&t.removeClassName("active");var i=e.myGeneratedToolbar.getNodeModelByID("specificFilter");i&&(i._associatedView._properties.value.value="noSpecificFilter");var n=e.myGeneratedToolbar.getNodeModelByID("specificFilter");n&&(n.options.grid.data="noSpecificFilter"),u.getUserCustomViews().then(function(t){t&&t.customViews&&e.gridView.getCustomViewsManager().setCustomViews(t.customViews,t.currentCustomViewIdentifier,!0)})},C.prototype.setConfigureExpandButtonActiveState=function(e){let t=widget.getValue("component-view"),i=e||widget.getValue("configurable_expand"),n=this.myGeneratedToolbar.elements.farContainer.querySelector(".wux-button-icon-fi.wux-ui-genereatedicon-fi.wux-ui-3ds.wux-ui-3ds-flow-tree-expand-down-cog.wux-ui-3ds");t===h.structuredView&&Object.keys(i).length<6||t!==h.structuredView&&(!i.proposedSolution||!i.specDocs)?n.addClassName("active"):n.removeClassName("active")},C.prototype.specificFilterFun=function(e){var t,i,n=e.getAttributeValue("data");if("noSpecificFilter"===n)this.myGeneratedToolbar.elements.farContainer.querySelector(".wux-button-icon-fi.wux-ui-genereatedicon-fi.wux-ui-3ds.wux-ui-3ds-filter-add.wux-ui-3ds-lg").removeClassName("active"),this.modelEvents.publish({event:"content-list-view-noSpecificFilter"});else if("filterAllDisciplines"===n){if(t=widget.getValue("configurable_expand"),i=widget.getValue("component-view"),!t.implementing||!t.isImplementing)return c.alertMessage("error",null,m.error_filter_missing_implementing_isImplementing),this.myGeneratedToolbar.getNodeModelByID("specificFilter")._associatedView._properties.value.value="noSpecificFilter",void e.setAttribute("data","noSpecificFilter");if("structured-view"!==i)return c.alertMessage("error",null,m.error_specific_filter_flattened_view),this.myGeneratedToolbar.getNodeModelByID("specificFilter")._associatedView._properties.value.value="noSpecificFilter",void e.setAttribute("data","noSpecificFilter");this.myGeneratedToolbar.elements.farContainer.querySelector(".wux-button-icon-fi.wux-ui-genereatedicon-fi.wux-ui-3ds.wux-ui-3ds-filter-add.wux-ui-3ds-lg").addClassName("active"),this.modelEvents.publish({event:"content-list-view-filterDisciplines"})}else if("filterPilotingDisciplines"===n){if(t=widget.getValue("configurable_expand"),i=widget.getValue("component-view"),!t.implementing)return c.alertMessage("error",null,m.error_filter_missing_implementing),this.myGeneratedToolbar.getNodeModelByID("specificFilter")._associatedView._properties.value.value="noSpecificFilter",void e.setAttribute("data","noSpecificFilter");if("structured-view"!==i)return c.alertMessage("error",null,m.error_specific_filter_flattened_view),this.myGeneratedToolbar.getNodeModelByID("specificFilter")._associatedView._properties.value.value="noSpecificFilter",void e.setAttribute("data","noSpecificFilter");this.myGeneratedToolbar.elements.farContainer.querySelector(".wux-button-icon-fi.wux-ui-genereatedicon-fi.wux-ui-3ds.wux-ui-3ds-filter-add.wux-ui-3ds-lg").addClassName("active"),this.modelEvents.publish({event:"content-list-view-filterPilotingDisciplines"})}else if("filterProposedSolutions"===n){if(t=widget.getValue("configurable_expand"),i=widget.getValue("component-view"),!t.proposedSolution)return c.alertMessage("error",null,m.error_filter_missing_solutions),this.myGeneratedToolbar.getNodeModelByID("specificFilter")._associatedView._properties.value.value="noSpecificFilter",void e.setAttribute("data","noSpecificFilter");this.myGeneratedToolbar.elements.farContainer.querySelector(".wux-button-icon-fi.wux-ui-genereatedicon-fi.wux-ui-3ds.wux-ui-3ds-filter-add.wux-ui-3ds-lg").addClassName("active"),this.modelEvents.publish({event:"content-list-view-filterProposedSolutions"})}},C.prototype.render=function(){var e=this;e.container.empty(),e.myGeneratedToolbar=new i({overflowManagement:"dropdown",direction:"horizontal",items:e.toolbarTreeDocument}),e.myGeneratedToolbar.inject(e.container,"top"),setTimeout(function(){C.prototype.tooltipOfDisabled=function(){var t;t={title:"Structured View icon is disabled because group By is applied"},e.myGeneratedToolbar.updateNodeModel("viewSwitcher",{tooltip:t})}},200)},C.prototype.getMenuItems=function(){if(this.gridView.treeDocument.getSelectedNodes().length<=0)return[]},C.prototype.enableDisableExportGrid=function(){widget.getValue("groupingEnabled")?this.myGeneratedToolbar.updateNodeModel("exportGrid",{disabled:!0}):this.myGeneratedToolbar.updateNodeModel("exportGrid",{disabled:!1})},C.prototype.resetFilters=function(){var e=this.myGeneratedToolbar.elements.farContainer.querySelector(".wux-button-icon-fi.wux-ui-genereatedicon-fi.wux-ui-3ds.wux-ui-3ds-filter-add.wux-ui-3ds-lg");e&&e.removeClassName("active");var t=this.myGeneratedToolbar.getNodeModelByID("specificFilter");t&&(t._associatedView._properties.value.value="noSpecificFilter",t.options.grid.data="noSpecificFilter"),this.gridView.options&&this.gridView.options.currentSpecificFilter&&this.modelEvents.publish({event:"content-list-view-noSpecificFilter"}),this.modelEvents.publish({event:"content-list-view-clearFilterModels"})},C}),define("DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller",["UWA/Core","DS/CATFLCockpitWidget/model/CATFLCockpitTreeDocument","DS/CATFLCockpitWidget/model/CATFLCockpitTreeNodeModel","DS/UIKIT/Mask","DS/DataGridView/DataGridView","DS/CfgBaseUX/scripts/CfgUtility","DS/CfgBaseUX/scripts/CfgData","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.toolbar","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.contextualmenu","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.attachment","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.columns","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.filter","DS/CATFLCockpitWidget/components/ContentListView/decorators/contentlistview.dragdrop","DS/CATFLCockpitWidget/components/ContentListView/decorators/contentlistview.cues","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/preferences.util","DS/CATFLCockpitWidget/utils/contextManager.util","DS/CATFLCockpitWidget/mixins/CATFLBIFilter","DS/CATFLCockpitWidget/components/CommandsCtrl/command.controller","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/dimensions.service","DS/CATFLCockpitWidget/components/CreateLogicalItemModal/CreateLogicalItemHelper","DS/CATFLCockpitWidget/components/SpaceAssignment/SpaceAssignment","DS/Utilities/Utils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/refresh.util","DS/CATFLCockpitWidget/utils/gridview.util","DS/PlatformAPI/PlatformAPI","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f,h,v,C,b,y,_,w,D,S,I,A,F,E,k,x,T){"use strict";var L=A.getFullConfig(),N=L.identifiers,M=[];return{init:function(i){var n=this;n.modelEvents=h.createAppEventObject("flcockpit-content-list-view");var r=h.getFLWebModelEventsObj("flweb-model-events");r.subscribe({event:"allmod-selection-successful"},n.viewNonFilteredContent.bind(n)),r.subscribe({event:"mod-PC-selection-successful"},n.modelPCSelected.bind(n)),r.subscribe({event:"mod-selection-removed"},n.viewNonFilteredContent.bind(n));var a=e.createElement("div",{class:"fl-cockpit-toolbar-container"});return i.appendChild(a),n.contentViewContainer=document.createElement("div"),n.contentViewContainer.classList.add("fl-cockpit-data-grid-view-container"),n.contentView=new o({identifier:"SystemArchitectureRelease_ContentView",height:"inherit",treeDocument:new t({useAsyncPreExpand:!0}),selectionBehavior:{unselectAllOnEmptyArea:!1},showNodeKPIColorFlag:!0,rowDragEnabledFlag:!0,cellDragEnabledFlag:!0,defaultColumnDef:{typeRepresentation:"string",width:"auto"},rowGroupingOptions:{depth:1,hideGroupedColumns:!1},onContextualEvent:function(e){if(e.cellInfos){if(e.cellInfos&&-1===e.cellInfos.rowID)return e.collectionView.buildDefaultContextualMenu(e);widget.getValue("modelAttached")&&(e.bModelAttached=!0,e.modelInfo=widget.getValue("currentConfig")),e.cellInfos.nodeModel.isSelected()||(e.collectionView.treeDocument.unselectAll(),e.cellInfos.nodeModel.select());var t=e.collectionView.treeDocument.getSelectedNodes();return t.length>1?c.getMenu(e,n.modelEvents):1===t.length?_.getTypeHierarchy(t[0].options.grid.actualType).then(function(i){return F.getOpenWithCompatibleApps(t[0],i).then(function(t){return c.getMenu(e,n.modelEvents,t)})}):void 0}},getCellTooltip:function(e){return e.nodeModel&&0===e.columnID&&e.nodeModel._options.grid.titleTooltip?{shortHelp:e.nodeModel._options.grid.titleTooltip,updateModel:!1}:e.nodeModel&&1===e.columnID&&e.nodeModel._options.grid.cueTooltip?{shortHelp:e.nodeModel._options.grid.cueTooltip,updateModel:!1}:n.contentView.getCellDefaultTooltip(e)}}),u.getDataGridViewColumns(n.contentView).then(function(e){n.contentView.onDelayedModelDataRequest=I.debounce(n.getDelayedModelData.bind(n),200),n.contentView.columns=e,g.addDragAndDropBehaviorToContentView.call(n),m.addConvergenceCuesListeners(n),n.customViewsManager=n.contentView.getCustomViewsManager(),n.customViewsManager.onCustomViewsSave=n.onCustomViewsSave.bind(n),n.customViewsManager.showCustomViewsDialog(),n.customViewsManager._customViewsDialog.visibleFlag=!1,new l(a,n.contentView,n.modelEvents),n.setPADContext(),n.contentView.inject(n.contentViewContainer),i.appendChild(n.contentViewContainer),n.modelEvents.subscribe({event:"content-list-view-ngFilter-open"},function(){L.disableIndexAcceleration?F.alertMessage("warning",null,T.warn_filter_only_indexed_mode):y.init("NGFilterCmd",{viewController:n})}),n.modelEvents.subscribe({event:"create-new-logical-item"},function(e){require(["DS/CATFLCockpitWidget/utils/SAXTracker"],function(e){e.trackCommandLaunched("createNewLogRef-sax")}),D.createNewLogicalItem({data:e,treeDocument:n.contentView.treeDocument})}),n.modelEvents.subscribe({event:"content-view-add-existing-item"},function(){var e;e=0===n.contentView.treeDocument.getSelectedNodes().length?n.contentView.treeDocument.getRoots()[0]:n.contentView.treeDocument.getSelectedNodes()[0],d.addExistingItem(e,n.contentViewContainer,n.contentView.treeDocument)}),n.modelEvents.subscribe({event:"content-list-view-refresh"},function(e){if(null!=e)n.refresh(e.itemID,e.expandFilterBinary);else{var t=widget.getValue("currentConfig");t&&t.filterCompiledForm?n.refresh(null,t.filterCompiledForm):n.refresh()}n.contentView.reapplySortModel()}),n.modelEvents.subscribe({event:"content-list-view-refresh-columns"},function(e){u.getDataGridViewColumns(n.contentView).then(function(t){n.contentView.columns=t,n.contentView.layout.applyColumns(),e.refreshView&&n.modelEvents.publish({event:"content-list-view-refresh"})})}),n.modelEvents.subscribe({event:"refresh-nodes-by-id"},E.refreshNodeDetails.bind(n)),n.modelEvents.subscribe({event:"refresh-inst-by-id"},E.refreshInstDetailsonNode.bind(n)),n.modelEvents.subscribe({event:"refresh-spaces-by-id"},E.refreshSpacesonNode.bind(n)),n.modelEvents.subscribe({event:"refresh-solutions-by-id"},E.refreshSolutionsonNode.bind(n)),n.modelEvents.subscribe({event:"refresh-documents-by-id"},E.refreshDocumentsOnNodes.bind(n)),n.modelEvents.subscribe({event:"refresh-refLinks-by-id"},E.refreshReferenceLinksOnNodes.bind(n)),n.modelEvents.subscribe({event:"remove-items-from-category"},E.removeItemsFromCatogry.bind(n)),n.modelEvents.subscribe({event:"refresh-items-on-replace"},E.refreshNodesOnReplace.bind(n)),n.contentView.addEventListener("click",n.manageClickInGridView.bind(n)),n.contentView.sortModel=[{dataIndex:"tree",sort:"asc"}],widget.subscribedToAuthoringInItemPage||(x.subscribe("DS/PADUtils/PADCommandProxy/refresh",n.refreshGridViewOnItemUpdate.bind(n)),widget.subscribedToAuthoringInItemPage=!0),x.subscribe("Lifecycle.Modification",function(e){var t=JSON.parse(e);if(t&&t.Refresh&&t.Refresh.created&&t.Refresh.created.length>0){for(var i=[],o=0;o<t.Refresh.created.length;o++)i.push(t.Refresh.created[o].sourceObjectId);n.refreshGridViewOnItemUpdate({data:{authored:{modified:i}}})}if(t&&t.Refresh&&t.Refresh.modified&&t.Refresh.modified.length>0){var r=null;if("function"==typeof s.getConfigurationRevisionDetails){let e=s.getConfigurationRevisionDetails().configurationRevision;e&&e.configRevision&&(r=e.configRevision[0].id)}if(r){for(i=[],o=0;o<t.Refresh.modified.length;o++)t.Refresh.modified[o].policy===N.policy_Configured_Baseline&&i.push(t.Refresh.modified[o].physicalid);if(i.indexOf(r)>=0){let e=widget.getValue("currentOpenedItem");n.catflBIFilter._biFilter.resetNGFilterUI({appId:widget.id,widgetId:widget.id,rootIds:[e]}),n.catflBIFilter._biFilter.removeRoot(e);let t={filterRootIds:[e],empty:!0,filterName:""};F.alertMessage("warning",null,T.warn_clear_filter_CRMaturity),n.catflBIFilter._biFilter.dispatchEvent("ApplyNGFilter",t)}}}})}),n},setPADContext:function(){var e=this;require(["DS/PADUtils/PADContext"],function(t){e.contentView.getEditMode=function(){return!0},e.contentView.getPADTreeDocument=function(){return e.contentView.getTreeDocument()},e.contentView.getSelectedNodes=function(){let t=C.getSelectedNodes();return t&&0!==t.length||(t=e.contentView.getTreeDocument().getSelectedNodes())&&0!==t.length||(t=[e.contentView.getTreeDocument().getRoots()[0]]),t},e.contentView.displayNotification=function(e){"error"===e.eventID?F.alertMessage("error",null,e.msg||e):"warning"===e.eventID?F.alertMessage("error",null,e.msg||e):F.alertMessage("success",null,e.msg||e)},e.contentView.getSecurityContext=function(){return{SecurityContext:"ctx::"+A.getSecurityContext()}},e.contentView.getRoots=function(){return e.contentView.getTreeDocument().getRoots()},t.set(e.contentView)})},onCustomViewsSave:function(e,t){let i=this.contentView.getCustomViewsManager(),n=!!i.getCurrentCustomView()&&i.getCurrentCustomView().groupingOptions;widget.setValue("groupingEnabled",!!n),v.saveUserCustomViews(e,t);let o=this.contentView.getTreeDocument().getRoots()[0];o&&!o._isExpanded&&(o.expand(),v.getUserCustomViews().then(function(e){e&&e.customViews&&i.setCustomViews(e.customViews,e.currentCustomViewIdentifier,!0)})),this.modelEvents.publish({event:"content-list-view-grouping-status-change"})},manageClickInGridView:function(e,t){if(t&&t.nodeModel&&t.columnID&&!(t.columnID<0)){var i=t.nodeModel.options.type===N.type_act_logref,n=t.nodeModel.getParent().options.type===N.type_spec_document,o="DIF"===t.nodeModel.options.grid.kindOfRFLP,s=t.nodeModel.options.virtual;if(i||n||o){var l=this.contentView.columns[t.columnID].dataIndex,c=e.target.className,u=widget.getValue("currentConfig"),p=this.contentView.treeDocument.getRoots()[0],g=!1;if(u&&u.modelVersion&&(u.modelVersion.current===N.state_act_Release||u.modelVersion.current===N.state_act_Obsolete)?g=!0:(!p||p.options.grid.maturity!==N.state_act_Released&&p.options.grid.maturity!==N.state_act_Obsolete)&&("VariantEffectivity"===l||t.nodeModel.options.grid.maturity!==N.state_act_Released&&t.nodeModel.options.grid.maturity!==N.state_act_Obsolete)||(g=!0),"cue"===l){if(N.clickable_cue_icons.some(function(e){return c.indexOf(e)>=0})){var m=h.getFLWebModelEventsObj("flweb-model-events"),f={};f.rootID=this.contentView.treeDocument.getRoots()[0].options.physicalid,f.instanceID=t.nodeModel._options.instance.physicalid,f.instParentID=t.nodeModel._options.physicalid,f.instParentTitle=t.nodeModel._options.label+" "+t.nodeModel._options.grid.revision,f.nodeModel=t.nodeModel,m.publish({event:"flcockpit-convergence-cues-actions",data:f})}}else if("revision"===l&&i&&!s){var v=[{physicalid:t.nodeModel.options.physicalid,label:t.nodeModel.options.label,type:t.nodeModel.options.type,displayType:t.nodeModel.options.grid.type,revision:t.nodeModel.options.grid.revision,current:t.nodeModel.options.grid.maturity,icons:t.nodeModel.options.icons}];y.init("HistoryCommand",v)}else if("maturity"===l&&(n||!s||s&&t.nodeModel.options.type===N.type_act_logref&&t.nodeModel.options.linkInfo&&"implementing"===t.nodeModel.options.linkInfo.linkType&&"ref"===t.nodeModel.options.linkInfo.objType||s&&"DIF"===t.nodeModel.options.grid.kindOfRFLP))y.init("MaturityCommand",[{physicalid:t.nodeModel.options.physicalid,label:t.nodeModel.options.label}]);else if("owner"===l&&(n||!s||s&&t.nodeModel.options.type===N.type_act_logref&&t.nodeModel.options.linkInfo&&"implementing"===t.nodeModel.options.linkInfo.linkType&&"ref"===t.nodeModel.options.linkInfo.objType||s&&"DIF"===t.nodeModel.options.grid.kindOfRFLP))y.init("ChangeOwnerCommand",[{physicalid:t.nodeModel.options.physicalid,type:t.nodeModel.options.type,label:t.nodeModel.options.label,displayType:t.nodeModel.options.grid.type,revision:t.nodeModel.options.grid.revision,owner:t.nodeModel.options.grid.owner,icons:t.nodeModel.options.icons}]);else if(i&&!s&&"architectureNumber"===l){if(g)return void F.alertMessage("error",null,"",T.error_authOperations_in_release);d.setArchitectureNumber([t.nodeModel])}else if(i&&!s&&"assignedSpaces"===l){if(g)return void F.alertMessage("error",null,"",T.error_authOperations_in_release);new S(t.nodeModel)}else if(i&&L.gridview.additionalColumnsModules&&e.dsModel.layout.getColumnOptionValue(t.columnID,"isAdditionalColumn")){let i=e.dsModel.layout.getColumnOptionValue(t.columnID,"columnModule"),n=L.gridview.additionalColumnsModules[i]||{},o=n.getOnCellClickCB;if(o){var b=o.call(n,l);b&&("VariantEffectivity"===l?(t.nodeModel.options.grid["ds6w:label-Instance"]=t.nodeModel.options.grid.instanceName,window.cfgCmdWidgetData={_isDecouplingActivated:!0,_isConfigAvailable:!0},r.checkDecouplingActivation().then(function(e){e&&!1===e.isEditVariantEnabled?a.isEditVariantEnabled=!1:a.isEditVariantEnabled=!0}).catch(function(){a.isEditVariantEnabled=!0}).finally(function(){b(t)})):(C.resetSelection(),this.contentView.getTreeDocument().unselectAll(),t.nodeModel.select(),t.nodeModel.getParent()&&!t.nodeModel.getParent()._isTrueRoot()&&(t.nodeModel.options.from=t.nodeModel.getParent().options.physicalid),b(t)))}}}}},getDelayedModelData:function(t){let i,n,o,r,a,s=this,l=t.collectionView,c=l.treeDocument,d=l.layout.columns,u=widget.getValue("ngFilter");if(t.displayedColumnsIndexes.length>0){t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("assignedSpaces"))>=0&&(i=!0),(t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("Effectivity"))>=0||t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("VariantEffectivity"))>=0||t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("CurrentEvolutionEffectivity"))>=0||t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("ProjectedEvolutionEffectivity"))>=0)&&(n=!0),t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("ConfigurationContext"))>=0&&(o=!0),t.displayedColumnsIndexes.indexOf(l.layout.getColumnIndex("ConfigurationRevision"))>=0&&(a=!0,u&&u.length>0&&(r=!0));let m={},f=F.getUserCustomAttributes()||[],h=F.getUserCustomAttributes(!0)||[],v=f.concat(h);v&&v.forEach(function(e){e.isOnPhysicalProduct?m["physical_"+e.curi]=e:e.bo?m[e.curi]=e:m["instance_"+e.curi]=e});let C=[],b=Object.keys(m),y={},_=[],D={};t.displayedColumnsIndexes.forEach(function(e){if(d[e]&&b.indexOf(d[e].dataIndex)>=0){let t=m[d[e].dataIndex],i=t.dimension+"_"+t.manipulationUnit;t.manipulationUnit&&t.manipulationUnit!==L.dimensions[t.dimension].MKSUnit?(C.push(d[e].dataIndex),y[i]||(y[i]=[]),y[i].push(d[e].dataIndex),D[i]={UnitFrom:L.dimensions[t.dimension].MKSUnit,UnitTo:t.manipulationUnit,Dimension:t.dimension,Values:[]}):t.manipulationUnit&&_.push(d[e].dataIndex)}});let S=[],I=[],A={},E=[],x=[],M={},V={},O=[],P=[],R=[];for(let e=t.startNodeIndex;e<=t.endNodeIndex;e++){let t=l.model[e];if(t){N.type_act_logref===t.options.type&&(i&&!t.options.assignedSpacesPID&&P.push(t),!o||t.options.grid.ConfigurationContext||t.options.linkInfo||O.push(t.options.physicalid),n&&t.options.instance&&!t.options.grid.Effectivity&&(S.push(t.options.instance.physicalid),I.push(t.options.physicalid),A[t.options.instance.physicalid]=t),r?(t.options.instance&&(M[t.options.physicalid]=t.options.instance.physicalid,E.push(t.options.instance.physicalid)),x.push(t.options.physicalid),V[t.options.physicalid]=t):a&&t.updateOptions({grid:{ConfigurationRevision:""}}));let e=!1;C.forEach(function(i){if((!t.options.grid[i]||t.options.grid[i].length<=0)&&t.options.grid[i+"_actual"]){let n=t.options.grid[i+"_actual"]||0;e=!0;let o=m[i],r=D[o.dimension+"_"+o.manipulationUnit];o.multiValuated||Array.isArray(n)?n.forEach(e=>{r.Values.indexOf(e)<0&&r.Values.push(e)}):r.Values.indexOf(n)<0&&r.Values.push(n)}}),e&&R.push(t),_.forEach(function(e){var i=t.options.grid[e+"_actual"];i&&t.setAttribute(e,i)})}}let W=[];if(P.length>0&&W.push(k.addAssignedSpacesAttribute(P)),O.length>0){var p={relids:[],pids:O};(g=L.gridview.additionalColumnsModules.cfgContext)&&W.push(new Promise(function(t,i){g.updateAttributes(p,function(n){var o=e.is(n,"string")?JSON.parse(n):n;t(o),i("Error in Cfg_updateAttributes")},s)}).then(function(e){let t=e?e.pids:{};c.withTransactionUpdate(function(){O.forEach(function(e){c.getMappedNodesFromId(e).forEach(function(i){let n={grid:{ConfigurationContext:t[e].ConfigurationContext}};i.updateOptions(n)})})})}))}if(S.length>0){p={relids:S,pids:I};(g=L.gridview.additionalColumnsModules.cfgEffectivty)&&W.push(new Promise(function(t,i){g.updateAttributes(p,function(n){var o=e.is(n,"string")?JSON.parse(n):n;t(o),i("Error in Cfg_updateAttributes")},s)}).then(function(e){let t=e?e.relids:{};c.withTransactionUpdate(function(){S.forEach(function(e){var i=A[e],n=t[e];n&&(n.VariantEffectivity.trim()||(n.VariantEffectivity=T.label_none),i.updateOptions({grid:n}))})})}))}if(x.length>0||E.length>0){var g;p={pids:x,relids:E,pairs:M};(g=L.gridview.additionalColumnsModules.ConfigurationRevision)&&W.push(new Promise(function(t,i){g.updateAttributes(p,function(n){var o=e.is(n,"string")?JSON.parse(n):n;t(o),i("Error in CfgRev_updateAttributes")},s)}).then(function(e){let t=e?e.pids:{};Object.keys(t).length>0&&c.withTransactionUpdate(function(){x.forEach(function(e){var i=V[e],n=t[e]?t[e].ConfigurationRevision:"";let o="";n&&n.crValues&&n.crValues.forEach(e=>{e.value&&"string"===e.type&&(o+=e.value)}),i.updateOptions({grid:{ConfigurationRevision:n}})})})}))}if(C.length>0&&R.length>0){for(let e in D)if(D[e].Values.length<=0){delete D[e];let t=y[e];for(let e of t)C.splice(C.indexOf(e),1)}W.push(w.convertValues(Object.values(D)).then(function(t){let i={},n=Object.keys(D);t.Response&&(t.Response.forEach(function(t,o){let r={},a=e.is(t.ValuesToConvert,"string")?t.ValuesToConvert.split(";"):t.ValuesToConvert,s=e.is(t.ConvertedValues,"string")?t.ConvertedValues.split(";"):t.ConvertedValues;a.forEach(function(e,t){r[e]=s[t]}),i[n[o]]=r}),R.forEach(function(e){C.forEach(function(t){let n=m[t];if(e.options.grid[t+"_actual"])if(n.multiValuated||Array.isArray(e.options.grid[t+"_actual"])){var o=[];e.options.grid[t+"_actual"].forEach(e=>{let t=i[n.dimension+"_"+n.manipulationUnit][e];t&&o.push(t)}),o.length>0&&e.setAttribute(t,o)}else{let o=i[n.dimension+"_"+n.manipulationUnit][e.options.grid[t+"_actual"]];o&&e.setAttribute(t,o)}})}))}))}W.length>0&&Promise.all(W)}},refreshGridViewOnItemUpdate:function(t){let n=this,o=[],r=[],a={},s=!1,l=!0;if(t.data.authored){let c=n.contentView.treeDocument.getRoots(),d=n.contentView.treeDocument.getSelectedNodes();if(c&&c.length>0){let u=c[0].options.physicalid;if(t.data.authored.deleted){let e=widget.getValue("previouslyOpenedItems"),i=widget.getValue("currentlyOpenedItems"),n=widget.getValue("currentlyClosedItems");if(e=e?JSON.parse(e):[],i=i?JSON.parse(i):[],n=n?JSON.parse(n):[],t.data.authored.deleted.forEach(function(t){let o=t,r=e.indexOf(o);r>=0&&e.splice(r,1);for(let e=0;e<=i.length+n.length-1;e++){let e=i.indexOf(o),t=n.indexOf(o);if(-1===e&&-1===t)break;e>=0&&i.splice(e,1),t>=0&&n.splice(t,1)}}),i.length>0&&i[i.length-1]===i[i.length-2]&&i.pop(),widget.setValue("previouslyOpenedItems",JSON.stringify(e)),widget.setValue("currentlyOpenedItems",JSON.stringify(i)),widget.setValue("currentlyClosedItems",JSON.stringify(n)),i.length>0){let e=i[i.length-1];h.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:e}})}else h.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"})}if(e.is(t.data.authored,"array")&&t.data.authored.length>0){let e,r=[],c=[];t.data.authored.forEach(t=>{if(t.previous&&t.modified!==t.previous){if(s=!0,(e=n.contentView.treeDocument.getRoots()[0].getNodesByRelId(t.previous))&&e.length>0){let s=[];n.contentView.treeDocument.prepareUpdate(),e.forEach(e=>{let n=e.getParent(),o=new i({hasBeenExpanded:!1,noIndexOrDBExpand:!1,dontExpandTwoLvl:!1,dontExpandAllLvl:!1,physicalid:e.options.physicalid,instance:{physicalid:t.modified},grid:{physicalid:e.options.physicalid},actualParent:e.options.actualParent,children:[]});o.setRelationID(t.modified),n.addChild(o,e._rowID),s.push(o)}),n.contentView.treeDocument.pushUpdate(),a[t.previous]=e,a[t.modified]=s,o.push(e[0].options.physicalid),l=!1,d.forEach(e=>{e.options.instance.physicalid===t.previous&&(r.push(e.getNextNode()),c.push(e))})}}else(e=n.contentView.treeDocument.getRoots()[0].getNodesByRelId(t.modified))&&e.length>0&&(a[t.modified]=e)}),r.length>0&&r.forEach(e=>{e.select()}),c.length>0&&c.forEach(e=>{e.unselect()})}else t.data.authored.modified&&t.data.authored.modified.forEach(function(e){e===u&&h.getFLWebModelEventsObj("flweb-model-events").publish({event:"idcard-refresh"});let t=n.contentView.treeDocument.getMappedNodesFromId(e);t&&t.length>0?t.forEach(function(t){void 0===t.getParent()||t.getParent().options.type!==L.identifiers.type_attach_document&&t.getParent().options.type!==L.identifiers.type_spec_document?"DIFSheet"===t.options.type&&t.options.virtual||t.options.virtual||t.options.virtual?E.refreshConnectedDIFNode(t):o.push(e):r.push(t.getParent().getParent())}):(t=n.contentView.treeDocument.getRoots()[0].getNodesByRelId(e))&&t.length>0&&(a[e]=t)})}o.length>0&&n.modelEvents.publish({event:"refresh-nodes-by-id",data:{arrayOfPID:o,tagAsRecentlyAuthored:!0,dontLoadSpaceInfo:l}}),r.length>0&&n.modelEvents.publish({event:"refresh-documents-by-id",data:{nodes:r}}),Object.keys(a).length>0&&n.modelEvents.publish({event:"refresh-inst-by-id",data:{instIdMap:a,bInstance:!0,bEffectivity:s}})}},refresh:function(e,t,i){if(!e){if(void 0===this.contentView.treeDocument.getRoots()[0])return;e=this.contentView.treeDocument.getRoots()[0].options.physicalid}n.mask(this.contentView.getContent(),T.msg_loading),this.contentView.treeDocument.getXSO().empty(),this._cueGlobalCount=null,this.selectedItemsForCues={},f.getLogItemWithExpand(e,t).then(this.itemPageRefCallBack.bind(this,i))},itemPageRefCallBack:function(e,t){var i=this;t.options.shouldBeSelected=function(e){return e.options.physicalid&&e.options.physicalid.length>0},i.contentView.treeDocument=t,i.contentView.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!1}),i.configData&&i.contentView.treeDocument.setConfigurationContext(i.configData),n.unmask(i.contentView.getContent()),i.catflBIFilter?i.catflBIFilter.updateModel(i.contentView):i.catflBIFilter=new b({view:i.contentView}),setTimeout(function(){i.catflBIFilter.onSetTagsWithExpandSynthesis(),i.contentView.reapplySortModel()},1e3),i.contentView.treeDocument.getXSO().onPostAdd(i._onXSOChanged.bind(i)),i.contentView.treeDocument.getXSO().onPostRemove(i._onXSOChanged.bind(i));var o={revision:{filterId:"stringRegexp"},isLastVersion:{filterId:"set"},instanceName:{filterId:"stringRegexp"},owner:{filterId:"stringRegexp"},modificationDate:{filterId:"stringRegexp"},description:{filterId:"stringRegexp"},type:{filterId:"stringRegexp"},name:{filterId:"stringRegexp"},creationDate:{filterId:"stringRegexp"},architectureNumber:{filterId:"stringRegexp"},instance_description:{filterId:"stringRegexp"},label:{filterId:"stringRegexp"},maturity:{filterId:"set"}};i.contentView.columns.forEach(function(e){e.isCustomAttribute&&("date"===e.typeRepresentation?o[e.dataIndex]={filterId:"date"}:"integer"===e.typeRepresentation||"number"===e.typeRepresentation?o[e.dataIndex]={filterId:"number"}:"boolean"===e.typeRepresentation?o[e.dataIndex]={filterId:"set"}:"multilineString"===e.typeRepresentation?o[e.dataIndex]={filterId:"stringRegexp"}:o[e.dataIndex]={filterId:"string",filterOptions:{allowRegexp:!0}})}),i.contentView.treeDocument.setFilterModel(o);var r=p.registerAndCreateSpecificFilter(i.contentView,"PilotingDisciplines",o),a=p.registerAndCreateSpecificFilter(i.contentView,"Disciplines",o),s=p.registerAndCreateSpecificFilter(i.contentView,"ProposedSolutions",o);for(var l of(i.contentView.options.currentSpecificFilter=null,M))i.modelEvents.unsubscribe(l);(M=[]).push(i.modelEvents.subscribe({event:"content-list-view-noSpecificFilter"},function(){p.changeFilterModel(i.contentView,o),i.contentView.getTreeDocument().reapplyFilterModel(),i.contentView.options.currentSpecificFilter=null})),M.push(i.modelEvents.subscribe({event:"content-list-view-filterPilotingDisciplines"},function(){p.changeFilterModel(i.contentView,r),i.contentView.options.currentSpecificFilter="PilotingDisciplines"},!0)),M.push(i.modelEvents.subscribe({event:"content-list-view-filterDisciplines"},function(){p.changeFilterModel(i.contentView,a),i.contentView.options.currentSpecificFilter="Disciplines"})),M.push(i.modelEvents.subscribe({event:"content-list-view-filterProposedSolutions"},function(){p.changeFilterModel(i.contentView,s),i.contentView.options.currentSpecificFilter="ProposedSolutions"})),M.push(i.modelEvents.subscribe({event:"content-list-view-clearFilterModels"},function(){p.clearFilterModels(i.contentView)})),e&&i.selectNodesById(e),k.crRecTimeoutToCheckTreeDocExp(i.contentView.treeDocument,function(){i.modelEvents.publish({event:"content-list-view-refresh-complete",data:{contentListView:i}})})},modelPCSelected:function(e){this.configData=e,this.refresh(e.itemID,e.filterCompiledForm)},viewNonFilteredContent:function(e){this.configData=null,this.refresh(e.itemID)},_onXSOChanged:function(){var e=this,t=e.contentView.treeDocument.getSelectedNodes(),i=widget.body.getElement(".triptych-right");i&&!i.hasClassName("close")&&(!0,F.formObjForEditProp(t)),setTimeout(function(){h.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-properties",data:{items:e.contentView.treeDocument.getSelectedNodes(),contentView:e.contentView}}),e.modelEvents.publish({event:"wux-generated-toolbar-multiselect-icon-update-count",data:t.length})});var n=A.form3DXContent(t);A.setObjectOnCompass(n),A.launchCrossAppSelection(t)},selectNodesById:function(e){var t=this.contentView.treeDocument.getRoots()[0];e.forEach(function(e){e===t.options.physicalid?t.select():t.getNodesById(e).length>0&&t.getNodesById(e)[0].select()})}}}),define("DS/CATFLCockpitWidget/components/WelcomePanel/welcomepanel.controller",["DS/CoreEvents/ModelEvents","DS/CATFLCockpitWidget/utils/model.events.util","DS/ENOXWelcomePanel/js/ENOXWelcomePanel","DS/CATFLCockpitWidget/components/LandingPage/referencesView","DS/CATFLCockpitWidget/utils/SAXTracker","text!DS/CATFLCockpitWidget/assets/config/welcomepanel.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a){"use strict";var s=JSON.parse(r),l=!1;return{init:function(r,c,d){l||this.mapNLSLabels();var u=new e,p={collapsed:!1,activities:s.activities,parentContainer:r,modelEvents:u};u.addEventListener("welcome-panel-action-selected",function(e){if("action_new_logical_ref"===e.id){var i=document.body.getElement(".fl-cockpit-triptych-main-container"),r=t.getFLWebModelEventsObj("flcockpit-content-list-view");r||(r=t.createAppEventObject("flcockpit-content-list-view")),n.newLogRef(r,i)}else if("action_conf_convergence_cues"===e.id)o.trackCommandLaunched("manageConvergence-sax"),t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flcockpit-convergence-cues-checklist"});else if("action_my_references"===e.id){let e=(s=document.body.getElement(".fl-cockpit-triptych-main-container")).getElement(".fl-recents-container");e.empty(),e.hide();let t=s.getElement(".fl-itemPage-container");t&&(t.empty(),t.hide());let i=s.getElement(".fl-myReferences-container");i.show(),document.body.querySelector("#action_recents").classList.value="activity-btn",widget.setValue("currentView","LandingPage"),widget.setValue("landingPage","My References"),widget.deleteValue("currentlyOpenedItems"),widget.deleteValue("currentlyClosedItems"),widget.deleteValue("currentOpenedItem"),widget.deleteValue("ngFilter"),n.init({id:"myReferences",title:a.label_myReferences,container:i,triptych:c,rightPanel:d})}else if("action_recents"===e.id){var s;let e=(s=document.body.getElement(".fl-cockpit-triptych-main-container")).getElement(".fl-myReferences-container");e.empty(),e.hide();let t=s.getElement(".fl-itemPage-container");t&&(t.empty(),t.hide());let i=s.getElement(".fl-recents-container");i.show(),document.body.querySelector("#action_my_references").classList.value="activity-btn",widget.setValue("currentView","LandingPage"),widget.setValue("landingPage","Recents"),widget.deleteValue("currentlyOpenedItems"),widget.deleteValue("currentlyClosedItems"),widget.deleteValue("currentOpenedItem"),widget.deleteValue("ngFilter"),n.init({id:"recents",title:a.label_recents,container:i,triptych:c,rightPanel:d})}else"action_open"===e.id&&t.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-open-welcomePanel"})}),new i(p).render()},mapNLSLabels:function(){s.activities&&s.activities.forEach(function(e){e.title=a[e.title],e.actions&&e.actions.forEach(function(e){e.text=a[e.text]})}),l=!0}}}),define("DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.combinedState",["UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Mask","DS/UIKIT/Iconbar","DS/UIKIT/Scroller","DS/UIKIT/Input/Button","DS/Controls/ButtonGroup","DS/Controls/Toggle","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f){"use strict";return m=JSON.parse(m),{displayCombinedConvergenceView:function(e){var i=this.getCombinedConvDefCont(e),n=this.getCombinedConvFooterActions(e);this.combinedCuesModal=new t({className:"combined_convergence_definition",closable:!0,header:f.header_combined_convg_cues,body:i,footer:n}).inject(widget.body),this.combinedCuesModal.show()},getCombinedConvDefCont:function(t){var i,n,r=this,l=e.createElement("div",{class:"combined-conv-maincontainer"}),c=e.createElement("div",{class:"operator-container"}).inject(l);e.createElement("div",{class:"operator-label",html:f.label_operator}).inject(c),"or"===t.operator?(n=!0,i=!1):(i=!0,n=!1);var d=new a({type:"radio"}).inject(c);d.addChild(new s({type:"radio",label:f.label_operator_and,value:"and",checkFlag:i})),d.addChild(new s({type:"radio",label:f.label_operator_or,value:"or",checkFlag:n})),d.addEventListener("change",function(e){r.submitButton.isDisabled()&&e.dsModel.value[0]!==t.operator&&r.submitButton.enable()});var u=e.createElement("div",{class:"combined-conv-container"}).inject(l),p=e.createElement("div",{class:"ccs-header-container"}).inject(u);e.createElement("section",{class:"ccs-title",html:f.label_title}).inject(p),e.createElement("section",{class:"ccs-operation",html:f.label_contribution}).inject(p);var g=e.createElement("div",{class:"combined-cues-container"}).inject(u),m=e.createElement("div",{class:"cues-scroll-container"}).inject(g),h=e.createElement("div",{class:"cues-rowCont-container"}).inject(m);return r.getCuesRowListContent(t.cuesList,h),new o({element:m}).inject(g),l},getCombinedConvFooterActions:function(e){var t=this,i=[];return t.submitButton=new r({id:"combinedConvDefSubmit",value:f.save_button,className:"primary",disabled:!0,events:{onClick:t.onSubmitCombinedCuesDef.bind(t,e.callback)}}),t.cancelButton=new r({id:"combinedConvDefCancel",value:f.cancel_button,events:{onClick:function(){t.combinedCuesModal.destroy()}}}),i.push(t.submitButton),i.push(t.cancelButton),i},getCuesRowListContent:function(t,i){var n,o=this;t&&t.forEach(function(t){n=e.createElement("div",{class:"ccs-row-container",id:"ccs_"+t.id}).inject(i),e.createElement("img",{class:"ccs-icon hidden-xs",src:t.icon_url}).inject(n),e.createElement("section",{class:"ccs-title",html:t.title}).inject(n),t.combinedState||(t.combinedState="ignore"),new r({className:"btn_operation",name:t.combinedState,value:f["val_"+t.combinedState],dropdown:{items:[{name:"yes",text:f.val_yes},{name:"no",text:f.val_no},{name:"ignore",text:f.val_ignore}]},events:{onDropdownClick:function(e,t){this.getName()!==t.name&&(this.setName(t.name),this.setValue(t.text),o.submitButton.isDisabled()&&o.submitButton.enable())}}}).inject(n)})},onSubmitCombinedCuesDef:function(e,t,i){var n,o,r={},a=this.combinedCuesModal.getContent().getElement(".wux-controls-buttongroup .wux-controls-toggle[checked]");a&&(this.combinedCuesModal.getContent().getElements(".ccs-row-container").forEach(function(e){"ignore"!==(o=e.getElement(".btn_operation").name)&&(n=e.id.substring(4),r[n]=o)}),e({operator:a.dsModel.value,combinedCues:r}),this.combinedCuesModal.destroy())}}}),define("DS/CATFLCockpitWidget/components/LandingPage/itemPage",["DS/CATFLCockpitWidget/utils/model.events.util","DS/ENOXIDCard/js/IDCard","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller","DS/CATFLCockpitWidget/components/IDCard/idcard.controller","DS/CATFLCockpitWidget/components/ArchitectureNumber/checkArchitectureNumberUnicity","DS/CATFLCockpitWidget/utils/checkArchitectureNumberUnicity.util","DS/CATFLCockpitWidget/mixins/CATFLBIFilter","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/services/model.service","DS/CATFLCockpitWidget/services/logitem.service","DS/CATFLCockpitWidget/services/modeler.service","DS/CATFLCockpitWidget/utils/xhr.util","DS/CATFLCockpitWidget/utils/SAXTracker","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f,h){"use strict";var v=l.getFullConfig().identifiers;return{init:function(e,t,i,o){if(this.container=t,this.triptych=i,this.propertiesPanel=o,this.contentListContainer=this.container.getElement(".fl-cockpit-content-list-container"),this.contentListView=n.init(this.contentListContainer),this.idcardContainer=this.container.getElement(".fl-cockpit-idcard-container"),widget.setValue("currentView","ItemPage"),e.itemPID){let t,i=widget.getValue("ngFilter"),n=e.itemPID;if(i&&i.length>0&&(t=JSON.parse(i)),t&&t.filterId){this.contentListView.catflBIFilter=new s({view:this.contentListView.contentView}),delete this.itemId,n&&this.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:n});let e={envId:l.getTenant(),serviceId:"3DSpace",contextId:"ctx::"+l.getSecurityContext(),objectId:t.filterId,objectType:v.type_act_advfilter,displayName:t.filterTitle};this.contentListView.catflBIFilter.retrieveFilterInfo(this,e)}else i&&(this.contentListView.catflBIFilter||(this.contentListView.catflBIFilter=new s({view:this.contentListView.contentView})),n&&this.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:n})),this.load(n,!1)}return this},load:function(t,i){var n=this,o={},r=[];if(""!==t){n.itemId=t;var a=widget.getValue("currentlyClosedItems");n.currentlyClosedItems=a?JSON.parse(a):[],n.currentlyClosedItems.length>0&&n.currentlyClosedItems[n.currentlyClosedItems.length-1]===t&&n.currentlyClosedItems.pop();var s=widget.getValue("previouslyOpenedItems");if(n.previouslyOpenedItems=s?JSON.parse(s):[],!i&&n.previouslyOpenedItems[n.previouslyOpenedItems.length-1]!==t){let e=n.previouslyOpenedItems.indexOf(t);e>=0?n.previouslyOpenedItems.splice(e,1):n.previouslyOpenedItems.length===v.limit_recents&&n.previouslyOpenedItems.shift(),n.previouslyOpenedItems.push(t)}if(widget.getValue("currentlyOpenedItems")?n.currentlyOpenedItems=JSON.parse(widget.getValue("currentlyOpenedItems")):(n.currentlyOpenedItems=[],n.currentlyOpenedItems.push(t)),i||n.currentlyOpenedItems[n.currentlyOpenedItems.length-1]===t||(n.currentlyOpenedItems.length+n.currentlyClosedItems.length===v.limit_history&&n.currentlyOpenedItems.shift(),n.currentlyOpenedItems.push(t)),n.currentlyClosedItems.length>0)var l=n.currentlyClosedItems[n.currentlyClosedItems.length-1];if(n.currentlyOpenedItems.length>1)var u=n.currentlyOpenedItems[n.currentlyOpenedItems.length-2];widget.setValue("currentlyOpenedItems",JSON.stringify(n.currentlyOpenedItems)),widget.setValue("currentOpenedItem",n.itemId),widget.setValue("previouslyOpenedItems",JSON.stringify(n.previouslyOpenedItems)),widget.deleteValue("ngFilter"),widget.setValue("evolutionView",v.view_evolution_current);var f=[];f=l&&u?[u,t,l]:l?[t,l]:u?[u,t]:[t],r.push(g.getObjectAttributes(f)),r.push(p.getLogItemModel(t)),r.push(d.getUserPreferences(v.user_pref_openedItems_conf)),r.push(d.getUserPreferences(v.user_pref_workunder)),m.makeMultipleServiceCalls(r,!0).then(function(i){o.itemData=i[0][t],o.nextItemData=i[0][l],o.prevItemData=i[0][u],o.modelData=i[1],o.usrPrfItemConf=i[2],o.usrPrfWorkUnder=i[3],l&&u?(n.nextItemData=o.nextItemData,n.prevItemData=o.prevItemData):l?(n.nextItemData=o.nextItemData,n.prevItemData=null):u&&(n.prevItemData=o.prevItemData,n.nextItemData=null),o.usrPrfWorkUnder&&e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-manage-workUnder",data:{rez:o.usrPrfWorkUnder}}),c.cleanDragNDrop(n.contentListView.contentView.getContent()),widget.setTitle(o.itemData.attributes.label),o.modelData&&o.modelData.length>0?widget.setValue("modelAttached",o.modelData):(widget.setValue("modelAttached",null),widget.setValue("currentConfig",null)),n._createIdCard(o).then(function(){n.contentListContainer.getElementsByClassName("modelPCSelector").length&&(n.contentListContainer.getElementsByClassName("modelPCSelector")[0].destroy(),n.contentListContainer.getElementsByClassName("modal-overlay in")[0].destroy()),o.modelData&&o.modelData.length>0?n._loadItemWithConfigCtx(o.modelData,o.usrPrfItemConf):n.contentListView.refresh(t)})}).catch(function(){if(n.itemId&&n.contentListView&&n.contentListView.catflBIFilter&&n.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:n.itemId}),n.currentlyOpenedItems[n.currentlyOpenedItems.length-1]===n.itemId)if(n.previouslyOpenedItems.indexOf(n.itemId)>=0&&(n.previouslyOpenedItems=n.previouslyOpenedItems.filter(e=>e!==n.itemId)),n.currentlyOpenedItems.indexOf(n.itemId)>=0&&(n.currentlyOpenedItems=n.currentlyOpenedItems.filter(e=>e!==n.itemId)),widget.setValue("previouslyOpenedItems",JSON.stringify(n.previouslyOpenedItems)),widget.setValue("currentlyOpenedItems",JSON.stringify(n.previouslyOpenedItems)),0===n.currentlyOpenedItems.length)widget.deleteValue("currentOpenedItem"),n.itemId=null,e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"});else{let t=n.currentlyOpenedItems[n.currentlyOpenedItems.length-1];t&&e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:t}})}else widget.deleteValue("currentOpenedItem"),n.itemId=null,e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"})}),e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-properties",data:{items:n.contentListView.contentView.treeDocument.getSelectedNodes(),contentView:n.contentListView.contentView}})}else c.alertMessage("error",null,h.error_non_existing_item)},_loadItemWithConfigCtx:function(t,i){var n=this,o=e.getFLWebModelEventsObj("flweb-model-events"),r=widget.getValue("currentConfig");i=i&&UWA.is(i,"string")?JSON.parse(i):i;var a=[];if(t.forEach(function(e){a.push(e.physicalid)}),i){var s,l,c,p=i[n.itemId];if(p&&(s=p.model,l=p.modelVersion,c=p.pc),!p||a.indexOf(s)<0)return void o.publish({event:"allmod-selection-successful",data:{itemID:n.itemId}});var g=[];s&&g.push(s),l&&g.push(l),c&&g.push(c),d.getItemInfo(g).then(function(e){var t,i,r;(e=e.member).forEach(function(e){e.type===v.type_model?((t={}).physicalid=e.physicalid,t.name=e.name,t.id=e.objectid):e.type===v.type_products?((i={}).physicalid=e.physicalid,i.backEndName=e.name,i.name=e.title,i.revision=e.revision,i.current=e.current):v.type_productConfiguration&&((r={}).physicalid=e.physicalid,r.name=e.title,r.filterCompiledForm=e.filterCompiledForm)}),r?r.filterCompiledForm?o.publish({event:"mod-PC-selection-successful",data:{itemID:n.itemId,model:t,modelVer:i,pc:r,filterCompiledForm:r.filterCompiledForm}}):u.createVolatileFilter({modelID:t.physicalid,modelName:t.name,modelVerName:i.backEndName,modelVerRev:i.revision}).then(function(e){o.publish({event:"mod-PC-selection-successful",data:{itemID:n.itemId,model:t,modelVer:i,pc:r,filterCompiledForm:e.filterBinaryForExpand}})}):u.createVolatileFilter({modelID:t.physicalid,modelName:t.name,modelVerName:i.backEndName,modelVerRev:i.revision}).then(function(e){o.publish({event:"mod-PC-selection-successful",data:{itemID:n.itemId,model:t,modelVer:i,pc:null,filterCompiledForm:e.filterBinaryForExpand}})})})}else{var m;r&&(m=r.model?r.model.physicalid:r.physicalid),(!r||m&&a.indexOf(m)<0)&&o.publish({event:"allmod-selection-successful",data:{itemID:n.itemId}})}},_createIdCard:function(t){var i=this;return i.idcardContainer.innerHTML="",i.triptych.getMainPanelContainer().querySelector(".fl-cockpit-triptych-main-container").classList.remove("fl-cockpit-idcard-container-hidden"),t.contentView=i.contentListView.contentView,o.init(i.idcardContainer,t,i.triptych.modelEvents,i.currentlyOpenedItems&&i.currentlyOpenedItems.length>1,i.currentlyClosedItems&&i.currentlyClosedItems.length>0,i.nextItemData,i.prevItemData).then(function(t){i.idcard=t,t.idcardModelEvents.subscribe({event:"triptych-toggle-panel"},function(){e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-properties",data:{items:i.contentListView.contentView.treeDocument.getSelectedNodes(),contentView:i.contentListView.contentView}}),i.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"right"})}),t.idcardModelEvents.subscribe({event:"welcome-panel-toggle"},function(){i.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"left"})}),t.idcardModelEvents.subscribe({event:"navigate-backward"},function(){if(i.currentlyOpenedItems.length>1){var e=i.currentlyOpenedItems.pop();i.currentlyClosedItems.push(e),i.navigate()}}),t.idcardModelEvents.subscribe({event:"navigate-forward"},function(){if(i.currentlyClosedItems.length>0){var e=i.currentlyClosedItems.pop();i.currentlyOpenedItems.push(e),i.navigate()}}),t.idcardModelEvents.subscribe({event:"idcard-show-landing-page"},function(){widget.deleteValue("currentOpenedItem"),widget.deleteValue("currentlyOpenedItems"),widget.deleteValue("currentlyClosedItems"),widget.setValue("currentView","LandingPage"),widget.deleteValue("ngFilter"),i.itemId&&i.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:i.itemId}),i.itemId=null,i.currentlyOpenedItems=null,e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"})}),t.idcardModelEvents.subscribe({event:"check-unicity-AN"},function(){if(1===widget.getValue("databaseModeActive"))c.alertMessage("warning",null,h.warn_check_an_duplication_only_indexed_mode);else{var e=i.contentListView.contentView.treeDocument.getRoots()[0],t=[];e&&(t=e.getChildren());var n;n=t.filter(function(e){return e.options.grid.architectureNumber&&!e.options.linkInfo&&"RFLVPMLogicalReference"===e.options.type&&e.options.instance}),a.updateEffectivityCompiledFormForNodes(t).then(function(){new r({refWithConfig:e,nodesToCheck:n})}).catch(function(){c.alertMessage("error",null,h.error_check_an_services_failed)})}}),c.makeDroppable(i.idcardContainer.querySelector(".xapp-id-card-container"),h.msg_drop_to_open,i.manageIDCardDrop.bind(i))})},manageIDCardDrop:function(t){e.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-drop-item",data:{item:t,context:this}})},navigate:function(){widget.setValue("previouslyOpenedItems",JSON.stringify(this.previouslyOpenedItems)),widget.setValue("currentlyOpenedItems",JSON.stringify(this.currentlyOpenedItems)),widget.setValue("currentlyClosedItems",JSON.stringify(this.currentlyClosedItems));var e=this.triptych.getMainPanelContainer().querySelector(".fl-cockpit-triptych-main-container");e.classList.add("fl-cockpit-idcard-container-hidden"),e.classList.add("flweb-cockpit-idcard-minified");var t=this.currentlyOpenedItems[this.currentlyOpenedItems.length-1];this.load(t,!0);var i=this.contentListView.contentView.treeDocument.getRoots()[0];i&&this.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:i.getID()})}}}),define("DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.checklist",["UWA/Core","DS/UIKIT/Modal","DS/UIKIT/Mask","DS/UIKIT/Iconbar","DS/UIKIT/Scroller","DS/UIKIT/Input/Button","DS/UIKIT/Input/Toggle","WebappsUtils/WebappsUtils","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.controller","DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.combinedState","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f){"use strict";return m=JSON.parse(m),{displayCuesChecklist:function(e,i){this.ccsConfiguration=i,this.allCuesChecked=!0;var n=this.getCuesChecklistContent(e),o=this.getCuesChecklistFooterActions();this.cuesModal=new t({className:"convergence_cues_checklist",closable:!0,header:f.header_convg_cues_checklist,body:n,footer:o,events:{onHide:function(){this.destroy()}}}).inject(widget.body),this.cuesModal.show()},getCuesChecklistContent:function(t){var i=e.createElement("div",{class:"cues-checklist-maincontainer"}),n=e.createElement("div",{class:"cues-checklist-container"}).inject(i),r=e.createElement("div",{class:"header-container"}).inject(n),a=e.createElement("div",{class:"checklist-container"}).inject(n),s=e.createElement("div",{class:"checklist-scroll-container"}).inject(a),l=e.createElement("div",{class:"checklist-rowCont-container"}).inject(s);return this.getCuesRowListContent(t,l,r),new o({element:s}).inject(a),i},getCuesChecklistFooterActions:function(){var e=this,t=[];return e.combinedConv=e.getCombinedConvergenceContainer(),t.push(e.combinedConv),e.submitButton=new r({id:"cuesChecklistSubmit",value:f.save_button,className:"primary",events:{onClick:e.onSubmitCuesChecklist.bind(e)},disabled:!0}),e.cancelButton=new r({id:"cuesChecklistCancel",value:f.cancel_button,events:{onClick:function(){e.cuesModal.destroy()}}}),t.push(e.submitButton),t.push(e.cancelButton),t},getCombinedConvergenceContainer:function(){var t=this,i=!1,n=e.createElement("div",{class:"combined-convergence-footer"});return t.ccsConfiguration&&t.ccsConfiguration.active&&(i=!0),t.confCombinedConvCB=new a({type:"checkbox",className:"primary",id:"cb_combined_conv",label:"",checked:i,events:{onChange:function(){this.isChecked()?t.confCombinedConvBtn.enable():t.confCombinedConvBtn.disable(),t.submitButton.isDisabled()&&t.submitButton.enable()}}}).inject(n),t.confCombinedConvBtn=new r({id:"combined-convergence-configure",class:"combined-convergence-configure",icon:"pencil",disabled:!i,events:{onClick:t._configureCombinedConvergence.bind(t)}}).inject(n),e.createElement("section",{class:"combined-convergence-label",html:f.action_combined_convergence}).inject(n),n},getCuesRowListContent:function(t,i,n){var o=this;let l=[];if(t){var d,u,p,g=s.getWebappsAssetUrl("CATFLCockpitWidget","icons"),m=e.createElement("div",{class:"cue-header-container"}).inject(n);e.createElement("section",{class:"cue-title",html:f.label_title}).inject(m),e.createElement("section",{class:"cue-severity",html:f.label_severity}).inject(m);var h=new a({type:"checkbox",className:"primary",id:"cb_select",label:"",checked:!1,events:{onChange:function(){this.isChecked()||!this.isChecked()&&h.getContent().classList.contains("mixed")?o._selectAllHandler.call(o,h):o._selectNoneHandler.call(o,h)}}}).inject(m);t.forEach(function(t){p=t.icon&&t.icon.indexOf("https")>=0?t.icon:g+"/I_RFLPLMImplementConnection.png",d=e.createElement("div",{class:"cue-row-container",id:t.id}).inject(i),e.createElement("img",{class:"cue-icon hidden-xs",src:p}).inject(d),e.createElement("section",{class:"cue-title",html:t.title}).inject(d),"CRITICAL"===t.severity?u=f.val_critical:"ERROR"===t.severity?u=f.val_error:"WARNING"===t.severity?u=f.val_warning:(t.severity="INFO",u=f.val_info),new r({className:"btn_severity "+t.severity.toUpperCase(),name:t.severity,value:u,dropdown:{items:[{name:"CRITICAL",text:f.val_critical},{name:"ERROR",text:f.val_error},{name:"WARNING",text:f.val_warning},{name:"INFO",text:f.val_info}]},events:{onDropdownClick:function(e,t){if(this.getName()!==t.name){this.setName(t.name),this.setValue(t.text);var i=this.getContent();"CRITICAL"===t.name?(i.addClassName("CRITICAL"),i.removeClassName("ERROR"),i.removeClassName("WARNING"),i.removeClassName("INFO")):"ERROR"===t.name?(i.addClassName("ERROR"),i.removeClassName("CRITICAL"),i.removeClassName("WARNING"),i.removeClassName("INFO")):"WARNING"===t.name?(i.addClassName("WARNING"),i.removeClassName("CRITICAL"),i.removeClassName("ERROR"),i.removeClassName("INFO")):(i.addClassName("INFO"),i.removeClassName("CRITICAL"),i.removeClassName("ERROR"),i.removeClassName("WARNING")),i.parentNode.getElement('input[type="checkbox"]').checked?o.submitButton.isDisabled()&&o.submitButton.enable():c.alertMessage("warning",null,f.warn_cue_unselected)}}}}).inject(d),new a({type:"checkbox",className:"primary",id:"cb_"+t.id,label:"",checked:t.checked,events:{onChange:function(){var e=o.cuesModal.getContent().getElements(".cue-row-container"),t=o.cuesModal.getContent().getElements(".cue-row-container input:checked");0===t.length?(h.setMixed(!1),h.uncheck(),o.allCuesChecked=!1):e.length===t.length?(o.allCuesChecked=!0,h.setMixed(!1),h.check()):(h.setMixed(!0),h.check()),o.submitButton.isDisabled()&&o.submitButton.enable(),t&&0===t.length&&(o.confCombinedConvCB.uncheck(),o.confCombinedConvBtn.disable(),o.ccsConfiguration={})}}}).inject(d),t.checked?l.push(t.id):o.allCuesChecked=!1}),o.allCuesChecked?h.check():l.length>0&&(h.check(),h.setMixed(!0))}},onSubmitCuesChecklist:function(){var e,t,i,n=this,o={},r={},a=[];n.cuesModal.getContent().getElements(".cue-row-container input:checked").forEach(function(r){h=r.id.substring(3),e=n.cuesModal.getContent().getElement("#"+h),i=e.getElement(".btn_severity"),t=i.name,o[h]={cueId:h,cueSeverity:t},a.push(h)}),r.cues_state=o;var s=n.cuesModal.getContent().getElement("#cb_combined_conv"),l=!1;if(s&&s.checked){if(Object.keys(o).length<=0)return void c.alertMessage("error","",f.error_cues_for_combination,"");var p=n.ccsConfiguration.combinedCues,g=[];if(a&&p){for(var h in p)if(a.indexOf(h)<0){var v=n.cuesModal.getContent().getElement("#"+h+" .cue-title");g.push(v.innerText)}if(g.length>0)return void c.alertMessage("error","",f.replace(f.error_combined_cues_missing,{missingCues:g.join()}),"")}l=!0}n.ccsConfiguration.active=l,r.combined_state=n.ccsConfiguration,u.setUserPreferences({name:m.user_pref_cues,value:JSON.stringify(r)}).then(function(){d.getFLWebModelEventsObj("flcockpit-content-list-view").publish({event:"content-list-view-refresh"}),n.cuesModal.destroy(),c.alertMessage("success","",f.msg_cues_saved_success,"")})},_selectAllHandler:function(e){var t=this.cuesModal.getContent().getElements(".cue-row-container input[type=checkbox]");t&&(t.forEach(function(e){e.checked=!0}),this.allCuesChecked=!0,e.setMixed(!1),e.check()),this.submitButton.isDisabled()&&this.submitButton.enable()},_selectNoneHandler:function(e){var t=this.cuesModal.getContent().getElements(".cue-row-container input[type=checkbox]");t&&(t.forEach(function(e){e.checked=!1}),this.allCuesChecked=!1,e.setMixed(!1),e.uncheck()),this.submitButton.isDisabled()&&this.submitButton.enable(),this.confCombinedConvCB.uncheck(),this.confCombinedConvBtn.disable(),this.ccsConfiguration={}},_configureCombinedConvergence:function(){var e,t,i=this,n=[],o=i.ccsConfiguration,r=o.operator,a=o.combinedCues||{},s=i.cuesModal.getContent().getElements(".cue-row-container input:checked");s&&0!==s.length?(s.forEach(function(o){e=o.id.substring(3);var r=i.cuesModal.getContent().getElement("#"+e);t=a[e],n.push({id:e,icon_url:r.getElement(".cue-icon").src,title:r.getElement(".cue-title").innerHTML,combinedState:t})}),g.displayCombinedConvergenceView({active:!0,operator:r,cuesList:n,callback:function(e){i.ccsConfiguration=e,i.submitButton.isDisabled()&&i.submitButton.enable()}})):c.alertMessage("error","",f.error_cues_for_combination,"")}}}),define("DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.controller",["UWA/Core","DS/UIKIT/Mask","DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.checklist","DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.actions","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/services/common.service","text!DS/CATFLCockpitWidget/assets/config/identifiers.conf.json","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l){"use strict";return l=JSON.parse(l),{init:function(e){this.appContext=e,this.cuesChecklist=[];var t=a.getFLWebModelEventsObj("flweb-model-events");t.subscribe({event:"flcockpit-convergence-cues-checklist"},this.displayCuesChecklist.bind(this)),t.subscribe({event:"flcockpit-convergence-cues-actions"},this.displayCuesActionLinks.bind(this))},displayCuesChecklist:function(){var e=this;e.cuesChecklist.length>0?e.viewCuesChecklist():s.getVisualCues().then(function(t){t.cues.length>0&&(t.cues.forEach(function(t){e.cuesChecklist.push({id:t.cueId,title:t.cueLabel,icon:t.cueIcon})}),e.viewCuesChecklist())})},viewCuesChecklist:function(){var e=this;s.getUserPreferences(l.user_pref_cues).then(function(t){if(t){var n=t.cues_state||t,o=t.combined_state||{};e.cuesChecklist.forEach(function(e){n.hasOwnProperty(e.id)?(e.checked=!0,e.severity=n[e.id].cueSeverity):(e.checked=!1,e.severity="INFO")})}i.displayCuesChecklist(e.cuesChecklist,o)})},displayCuesActionLinks:function(e){var t=this;s.getUserPreferences(l.user_pref_cues).then(function(i){i&&Object.keys(i).length>0&&n.displayCuesActionsonInstance(i,t.appContext,e)})}}}),define("DS/CATFLCockpitWidget/CATFLCockpitWidgetLandingPage",["DS/Windows/ImmersiveFrame","DS/ENOXTriptych/js/ENOXTriptych","DS/PlatformAPI/PlatformAPI","DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext","DS/CATFLCockpitWidget/components/ContentListView/contentlistview.actions.effectivity","DS/CATFLCockpitWidget/components/PropertiesPanel/propertiespanel.controller","DS/CATFLCockpitWidget/components/WelcomePanel/welcomepanel.controller","DS/CATFLCockpitWidget/components/ConvergenceCues/convergenceCues.controller","DS/CATFLCockpitWidget/utils/common.util","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/model.events.util","DS/CATFLCockpitWidget/utils/search.util","DS/CATFLCockpitWidget/services/common.service","DS/CATFLCockpitWidget/components/LandingPage/referencesView","DS/CATFLCockpitWidget/components/LandingPage/itemPage","DS/CATFLCockpitWidget/mixins/CATFLBIFilter","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s,l,c,d,u,p,g,m,f,h){var v=c.getFullConfig(),C=v.identifiers;v.localStorageKeys;return u.configureSearch(),{init:function(e){var t=this;d.clearSubscriptionList(),t.ctxItemPage=null;var i=d.createAppEventObject("flweb-model-events");t.setImmersiveFrame(e),t._initTriptychComponent(t.container),s.init(t),t.propertiesPanel=r.init(t.triptych.getRightPanelContent()),t.propertiesPanel.modelEvents.subscribe({event:"properties-panel-on-save"},function(e){widget.getValue("currentView")&&"LandingPage"!==widget.getValue("currentView")&&i.publish({event:"idcard-refresh"})}),t.welcomePanelController=a.init(t.triptych.getLeftPanelContent(),t.triptych,t.propertiesPanel),t.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"left"}),t.createLayoutContainers(t.triptychMainContainer),t.manageLandingPageEvents(i),widget.bSubscribedToCfgEvents||t.subscribeToCfgEvents();var n=widget.getValue("X3DContentId"),o=widget.getValue("previouslyOpenedItems");if(o&&(o=JSON.parse(o)),(!o||o.length<=0)&&n){var u=JSON.parse(n).data.items;if(u.length>1)l.alertMessage("error",null,h.error_open_several_obj),widget.deleteValue("X3DContentId"),d.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"});else{var m=u[0],v=m.objectId,b=m.objectType;if(m.envId=m.envId?m.envId:c.getTenant(),b&&""!==b)if(b===C.type_act_advfilter){t.ctxItemPage||t.loadItemPage({});var y=t.ctxItemPage;y.contentListView.catflBIFilter=new f({});var _=y.contentListView.contentView.treeDocument.getRoots()[0];_&&y.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:_.getID()}),y.contentListView.catflBIFilter.retrieveFilterInfo(y,m)}else p.getKindOfRFLP([v]).then(function(e){e&&"L"===e[0]?d.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:v}}):(l.alertMessage("error",h.msg_invalid_type,h.msg_open_invalid_type),widget.deleteValue("X3DContentId"),d.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"}))});else p.getItemInfo([v]).then(function(e){(e=e.member).forEach(function(e){if(e.type===C.type_act_advfilter){t.ctxItemPage||t.loadItemPage({});var i=t.ctxItemPage;i.contentListView.catflBIFilter=new f({});var n=i.contentListView.contentView.treeDocument.getRoots()[0];n&&i.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:n.getID()}),i.contentListView.catflBIFilter.retrieveFilterInfo(i,e)}else p.getKindOfRFLP([v]).then(function(e){e&&"L"===e[0]?d.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:v}}):(l.alertMessage("error",h.msg_invalid_type,h.msg_open_invalid_type),widget.deleteValue("X3DContentId"),d.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-landingPage"}))})})})}}else if(widget.getValue("currentView")&&"LandingPage"!==widget.getValue("currentView")){var w={itemPID:widget.getValue("currentOpenedItem")};t.loadItemPage(w)}else"Recents"===widget.getValue("landingPage")||void 0===widget.getValue("landingPage")?(widget.setValue("landingPage","Recents"),widget.deleteValue("currentlyOpenedItems"),title=h.label_recents,id="recents",t.triptychMainContainer.getElement(".fl-myReferences-container").hide(),g.init({id:id,title:title,container:t.triptychMainContainer.getElement(".fl-"+id+"-container"),triptych:t.triptych,rightPanel:t.propertiesPanel})):"My References"===widget.getValue("landingPage")&&(widget.deleteValue("currentlyOpenedItems"),title=h.label_myReferences,id="myReferences",t.triptychMainContainer.getElement(".fl-recents-container").hide(),g.init({id:id,title:title,container:t.triptychMainContainer.getElement(".fl-"+id+"-container"),triptych:t.triptych,rightPanel:t.propertiesPanel}))},manageLandingPageEvents:function(e){let t=this;e.subscribe({event:"flweb-load-landingPage"},function(){widget.body.empty(),widget.setValue("currentView","LandingPage"),t.ctxItemPage=null,t.init(widget.body)}),e.subscribe({event:"flweb-load-item"},function(e){"LandingPage"===widget.getValue("currentView")?(t.ctxItemPage=null,t.loadItemPage(e)):t.loadItemPage(e)}),e.subscribe({event:"flweb-drop-item"},function(e,i,n){t.manageDrop(e)}),e.subscribe({event:"flweb-load-properties"},function(e){var i=t.triptych._rightPanelContent.getElementsByClassName("EditProp_MasterContain");i&&i[0].isHidden()&&i[0].show();var n=l.formObjForEditProp(e.items,e.isImplLinkInfo);t.propertiesPanel.loadModel(n,"businessobject",e.contentView)}),e.subscribe({event:"open-properties-panel"},function(){t.triptych.modelEvents.publish({event:"triptych-show-panel",data:"right"}),t.triptych._container.getElement(".fonticon.fonticon-2x.fonticon-info")&&t.triptychMainContainer.getElement(".fonticon.fonticon-2x.fonticon-info").classList.add("selected")}),e.subscribe({event:"flweb-open-welcomePanel"},function(){t.openSearchPage()}),e.subscribe({event:"flweb-manage-workUnder"},function(e){t.updateWorkUnder(e)}),e.subscribe({event:"allmod-selection-successful"},t.updateUserPrefOnItemConf.bind(t,"allmod-selection-successful")),e.subscribe({event:"mod-PC-selection-successful"},t.updateUserPrefOnItemConf.bind(t,"mod-PC-selection-successful")),e.subscribe({event:"mod-selection-removed"},t.updateUserPrefOnItemConf.bind(t,"mod-selection-removed"))},subscribeToCfgEvents:function(){let e=this;i.subscribe("cfgEditConfigurationContextModification_"+widget.id,o.modifiedEditCfgCtx.bind(e)),i.subscribe("cfgEffectivityModifications_"+widget.id,o.refreshEffectivityChanges.bind(e)),i.subscribe(n.myAuthkey,function(t){var i=t.change,n={};n.type=C.workUnder_change,n.id=i.id,n.name=i.name,n.id&&e.updateUserPrefOnWorkUnder(n,"active")}),i.subscribe("sessionEff",function(t){var i={};i.type=C.workUnder_evolution,i.ACId=t.ACId,i.evolutionExpression=t.evolutionExpression,i.dictionaryContext=t.dictionaryContext,i.displayExpression=t.displayExpression,i.ACId&&e.updateUserPrefOnWorkUnder(i,"active")}),i.subscribe("toggleActiveSE"+n.myAuthkey,function(){e.updateUserPrefOnWorkUnder(null,"active")}),i.subscribe("toggleDeActiveSE"+n.myAuthkey,function(){e.updateUserPrefOnWorkUnder(null,"deactive")}),i.subscribe("removeAuthCtxSessionEvent"+n.myAuthkey,function(){e.updateUserPrefOnWorkUnder(null,"remove")}),i.subscribe("toggleActiveCA"+n.myAuthkey,function(){e.updateUserPrefOnWorkUnder(null,"active")}),i.subscribe("toggleDeActiveCA"+n.myAuthkey,function(){e.updateUserPrefOnWorkUnder(null,"deactive")}),i.subscribe("removeAuthCtxEvent"+n.myAuthkey,function(){e.updateUserPrefOnWorkUnder(null,"remove")}),widget.bSubscribedToCfgEvents=!0},manageDrop:function(e){let t=e.item,i=e.context,n=i?i.contentListView:void 0;var o=d.getFLWebModelEventsObj("flweb-model-events");if(t&&t.length>0&&t[0].envId!==c.getTenant()){if(!l.validateTenant(t[0]))return;widget.deleteValue("previouslyOpenedItems"),n&&n.catflBIFilter&&(n.catflBIFilter._biFilter._biFilter._tenantId=c.getTenant())}if(t&&t.length>0&&t[0].objectType===C.type_act_logref)d.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:t[0].objectId}});else if(t&&t.length>0&&t[0].objectType===C.type_act_advfilter){if(v.disableIndexAcceleration)return l.alertMessage("warning",null,h.warn_filter_only_indexed_mode),void o.publish({event:"flweb-drop-success"});var r=t[0];n||(i||(this.loadItemPage({}),i=this.ctxItemPage),(n=i.contentListView).catflBIFilter=new f({view:n.contentView}));var a=n.contentView.treeDocument.getRoots()[0];a&&n.catflBIFilter.removeRootFromFilterProxy({rootId2remove:a.getID()}),n.catflBIFilter.retrieveFilterInfo(i,r),o.publish({event:"flweb-drop-success"})}else t&&t.length>0?p.getKindOfRFLP([t[0].objectId]).then(function(e){if(e&&"L"===e[0]){if(n&&n.catflBIFilter){var i=n.contentView.treeDocument.getRoots()[0];i&&n.catflBIFilter.removeRootFromFilterProxy({rootId2remove:i.getID()})}d.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:t[0].objectId}}),o.publish({event:"flweb-drop-success"})}else l.alertMessage("error",null,h.msg_drop_invalid_type)}).catch(function(e){l.displayError(e,null,null,h.msg_drop_invalid_type)}):l.alertMessage("error",null,h.msg_drop_invalid_type);var s=c.form3DXContent([]);c.setObjectOnCompass(s)},_initTriptychComponent:function(e){var i=d.createAppEventObject("flweb-triptych-model-events"),n={left:{resizable:!0,overMobile:!1,minWidth:300},right:{resizable:!0,overMobile:!1},container:e,withtransition:!0,modelEvents:i};this.triptychMainContainer=UWA.createElement("div"),this.triptychMainContainer.classList.add("fl-cockpit-triptych-main-container");var o=UWA.createElement("div");o.classList.add("fl-cockpit-triptych-right-container");var r=UWA.createElement("div");r.classList.add("fl-cockpit-triptych-left-container"),this._initCfgAuthoringContext(this.triptychMainContainer),this.triptych=new t,this.triptych.init(n,r,this.triptychMainContainer,o),this.triptych.modelEvents=i},_initCfgAuthoringContext:function(e){var t=l.getUserWorkUnderPositionPref();if(n.initialize2(e,widget.id,"show",t,function(e){console.warn(e)},{isEditable:!0,isEvolution:!0,isChange:!0,isMovable:!0,resetDefault:!1}),t===C.workUnder_pos_freeValue){var i=widget.getValue("bubble-top"),o=widget.getValue("bubble-left"),r=e.querySelector("#BubbleContainer");r&&(i&&o&&r.setStyles({top:i,left:o}),l.setCfgAuthoringContextDragEvent(e))}},setImmersiveFrame:function(t){var i=UWA.createElement("div");i.classList.add("fl-cockpit-app-container"),this.container=i,widget.immersiveFrame=new e({}),widget.immersiveFrame.setContentInBackgroundLayer(i),widget.immersiveFrame.inject(t)},createLayoutContainers:function(e){UWA.createElement("div",{class:"fl-recents-container"}).inject(e),UWA.createElement("div",{class:"fl-myReferences-container"}).inject(e),UWA.createElement("div",{class:"fl-itemPage-container"}).inject(e)},loadItemPage:function(e){var t=this.triptych.getMainPanelContainer().querySelector(".fl-cockpit-triptych-main-container");if(t.classList.add("fl-cockpit-idcard-container-hidden"),t.classList.add("flweb-cockpit-idcard-minified"),document.body.querySelector("#action_my_references").classList.value="activity-btn",document.body.querySelector("#action_recents").classList.value="activity-btn",this.ctxItemPage){if(this.ctxItemPage.contentListView&&this.ctxItemPage.contentListView.catflBIFilter){var i=this.ctxItemPage.contentListView.contentView.treeDocument.getRoots()[0];i&&this.ctxItemPage.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:i.getID()})}m.load(e.itemPID)}else{this.triptych.getLeftOpen()&&this.triptych.modelEvents.publish({event:"triptych-toggle-panel",data:"left"});let i=t.getElement(".fl-myReferences-container");i.empty(),i.hide();let n=t.getElement(".fl-recents-container");n.empty(),n.hide();let o=t.getElement(".fl-itemPage-container");o&&(UWA.createElement("div",{class:"fl-cockpit-idcard-container"}).inject(o),UWA.createElement("div",{class:"fl-cockpit-content-list-container"}).inject(o)),o.show(),this.ctxItemPage=m.init(e,o,this.triptych,this.propertiesPanel)}},updateUserPrefOnItemConf:function(e,t){p.getUserPreferences(C.user_pref_openedItems_conf).then(function(i){if(i){var n=UWA.is(i,"string")?JSON.parse(i):i,o=!1;if("allmod-selection-successful"===e||"mod-selection-removed"===e)n[t.itemID]&&(delete n[t.itemID],o=!0);else{if(!n[t.itemID]){if(Object.keys(n).length===C.limit_usrPref_openedItems_conf)delete n[Object.keys(n)[0]];n[t.itemID]={}}n[t.itemID].model=t.model.physicalid,n[t.itemID].modelVersion=t.modelVer.physicalid,n[t.itemID].pc=t.pc?t.pc.physicalid:null,o=!0}o&&p.setUserPreferences({name:C.user_pref_openedItems_conf,value:JSON.stringify(n)}).then(function(){})}})},updateUserPrefOnWorkUnder:function(e,t){e&&t?(e.status=t,p.setUserPreferences({name:C.user_pref_workunder,value:JSON.stringify(e)}).then(function(){})):"active"===t||"deactive"===t?p.getUserPreferences(C.user_pref_workunder).then(function(e){if(e){var i=UWA.is(e,"string")?JSON.parse(e):e;i.status=t,p.setUserPreferences({name:C.user_pref_workunder,value:JSON.stringify(i)}).then(function(){})}}):p.setUserPreferences({name:C.user_pref_workunder,value:null}).then(function(){})},updateWorkUnder:function(e){if(e){var t=e.rez;if(t){var i=UWA.is(t,"string")?JSON.parse(t):t,o=()=>{"deactive"===i.status?n.deactivateBubble():n.activateBubble()};if(i.type===C.workUnder_change){var r={change:{id:i.id,name:i.name}};n.set(r,o)}else if(i.type===C.workUnder_evolution){r={ACId:i.ACId,evolutionExpression:i.evolutionExpression,dictionaryContext:i.dictionaryContext,displayExpression:i.displayExpression};n.setEffectivity(r,o)}}}},openSearchPage:function(){var e=this;let t=C.type_act_logref;u.launchSearch({searchTitle:h.label_select_reference_to_open,allowedTypes:t,role:"",criteria:t,bMultiSel:!1,in_apps_callback:function(t){let i=t[0];if(i)if(i["ds6w:type_value"]===C.type_act_advfilter){if(v.disableIndexAcceleration)return void l.alertMessage("warning",null,h.warn_filter_only_indexed_mode);var n=e.ctxItemPage;n||(e.loadItemPage({}),(n=e.ctxItemPage).contentListView.catflBIFilter=new f({view:n.contentListView.contentView}));var o=n.contentListView.contentView.treeDocument.getRoots()[0];o&&n.contentListView.catflBIFilter.removeRootFromFilterProxy({rootId2remove:o.getID()}),i.objectId=i.resourceid,n.contentListView.catflBIFilter.retrieveFilterInfo(n,i)}else d.getFLWebModelEventsObj("flweb-model-events").publish({event:"flweb-load-item",data:{itemPID:i.resourceid}})}})}}}),define("DS/CATFLCockpitWidget/CATFLCockpitWidgetMain",["DS/CATFLCockpitWidget/CATFLCockpitWidgetLandingPage","DS/CATFLCockpitWidget/services/config.service","DS/CATFLCockpitWidget/utils/config.util","DS/CATFLCockpitWidget/utils/common.util","DS/WUXAutoComplete/AutoComplete","DS/CATFLCockpitWidget/utils/preferences.util","DS/PlatformAPI/PlatformAPI","i18n!DS/CATFLCockpitWidget/assets/nls/CATFLCockpitWidget","css!DS/CATFLCockpitWidget/CATFLCockpitWidget"],function(e,t,i,n,o,r,a,s){"use strict";var l=i.getFullConfig(),c=l.localStorageKeys,d=l.identifiers;return{onLoad:function(){var n=widget.body;n.empty(),void 0===widget.getValue(c.componentView)&&widget.setValue(c.componentView,c.structuredView),widget.getValue("configurable_expand")||widget.setValue("configurable_expand",{refDocs:!0,specDocs:!0,proposedSolution:!0,implementedBy:!0,isImplementedBy:!0,implementing:!0,isImplementing:!0}),i.getPlatformServices().then(function(o){var a=[];if(a.push(i.retrieveCurrentUser()),a.push(i.retrieveCSRFToken()),a.push(r.getNSaveUserCustomAttributes()),a.push(r.getNSaveUserCustomAttributes(!0)),a.push(r.getCustomHeaderView()),i.refreshCSRFToken(),!1===o){var l=UWA.createElement("div",{styles:{height:"100%",width:"100%","font-size":"14px",display:"flex","flex-direction":"column"}}),c=UWA.createElement("div",{styles:{margin:"auto",width:"60%",padding:"10px"}}),d=UWA.createElement("div",{class:"wux-ui-3ds wux-ui-3ds-3x wux-ui-3ds-alert",styles:{height:"100%",float:"left","padding-right":"9px","padding-top":"5px",color:"#77797C"}}),u=UWA.createElement("div",{html:s.label_widgetError+"<br>"+s.label_noCredentialError,styles:{"font-size":"18px",color:"#77797C",height:"100%"}});return d.inject(c),u.inject(c),c.inject(l),l.inject(n),1}o.defaultValue||""==i.getSecurityContext()||(o.defaultValue=i.getSecurityContext()),r.buildPreferences({credentialList:o}).then(function(){Promise.all(a).then(function(){t.extendConfiguration(i.getFullConfig()).finally(function(){widget.body.empty(),e.init(widget.body)})})})})},onRefresh:function(){if(widget.body.empty(),widget.getPreference("xPref_3DEXPERIENCE_PLATFORM")&&widget.getPreference("xPref_3DEXPERIENCE_PLATFORM").value!==i.getTenant()){let e={},t=widget.getPreference("xPref_3DEXPERIENCE_PLATFORM").options;for(let i=0;i<t.length;i++)t[i].value===widget.getPreference("xPref_3DEXPERIENCE_PLATFORM").value&&(e.envId=t[i].value,e.displayName=t[i].label);n.validateTenant(e)&&(widget.deleteValue("currentOpenedItem"),widget.deleteValue("currentlyOpenedItems"),widget.setValue("currentView","LandingPage"),widget.deleteValue("ngFilter"),widget.setValue("previouslyOpenedItems",JSON.stringify([])),widget.setTitle(""))}e.init(widget.body),a.publish("NGFilter.RemoveConfigurationRevision_"+widget.id),enoviaServerFilterWidget&&(enoviaServerFilterWidget.tenant=i.getTenant())},endEdit:function(){n.getUserWorkUnderPositionPref()===d.workUnder_pos_freeValue?n.setCfgAuthoringContextDragEvent():n.unsetCfgAuthoringContextDragEvent()}}});