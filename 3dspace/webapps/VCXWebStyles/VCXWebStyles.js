define("DS/VCXWebStyles/VCXModifiableStyle",["DS/VCXWebProperties/VCXPropertySet","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,i,l,r,o){"use strict";return t.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,i){if(i||(i={}),i.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if("Actor.Name"===e)this.GetObject().SetName(t.Value);else{var l=this.GetObject().GetPropertySet().GetProperty(e);if(!l)return i.fromChildClass=!0,this._parent(e,t,i);l.SetPropertyValue(t.Clone()),this.GetObject().GetPropertySet().AddOrModifyProperty(l)}return!0},OnChangePropertiesEnd:function(){},GetProperty:function(e){var t;if("Actor.Name"===e){var n=new i,a=this.GetObject().GetName();n.SetValue(a);var s=new r(e,r.EBehaviorType.Singleton,!0,o);t=new l(s,n)}else t=(t=this.GetObject().GetPropertySet().GetProperty(e))?t.Clone():this._parent(e);return t},GetProperties:function(){var e=this._parent();return e.AddOrModifyProperty(this.GetProperty("Actor.Name")),e.Merge(this.GetObject().GetPropertySet()),e}})}),define("DS/VCXWebStyles/VCXComponentStyle",["require","exports","DS/WebComponentModeler/WebComponentBase","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebProperties/VCXPropertyValueString"],function(e,t,i,l,r,o,n,a){"use strict";class s extends i{constructor(){super(...arguments),this.propSet=new o,this.name="Style Name",this.origin=s.EOriginType.custom}GetName(){return this.name}SetName(e){this.name=e}SetPropertySet(e){this.propSet=e.Clone()}GetPropertySet(){return this.propSet}GetPropertyMapToSave(){const e=this._experienceBase.getManager("VCXStylesManager"),t=new n;let i=0;t.SetValueAtIndex(i++,new a("1.0.0")),t.SetValueAtIndex(i++,new a(this.GetName())),t.SetValueAtIndex(i++,new a(this.GetID())),t.SetValueAtIndex(i++,new a(e.GetForType(this)));const l=new n;t.SetValueAtIndex(i++,l);const r=this.QueryInterface("VCXIModifiable").GetProperties(!0),o=[];r.GetListPropertyNames(o);let s=0;return o.forEach(e=>{if("Actor.Name"===e)return;const t=new n;l.SetValueAtIndex(s++,t),t.SetValueAtIndex(0,new a(e)),t.SetValueAtIndex(1,r.GetProperty(e).GetPropertyValue())}),t}static BuildFromPropertyMapToLoad(e,t){let i=1;const n=e.GetValueAtIndex(i++).GetValue(),a=e.GetValueAtIndex(i++).GetValue(),s=e.GetValueAtIndex(i++).GetValue(),y=e.GetValueAtIndex(i++).GetValue(),c=new o;return y.forEach(e=>{const t=e.GetValueAtIndex(0).GetValue(),i=e.GetValueAtIndex(1),o=new l(new r(t,r.EBehaviorType.Singleton),i);c.AddOrModifyProperty(o)}),t.CreateStyleFromPropertySet(c,s,a,n)}GetOrigin(){return this.origin}SetOrigin(e){this.origin=e}GetThumbnail(e){const t=this.GetPropertySet(),i=e=>{for(let i=0;i<e.length;i++){const l=t.GetProperty(e[i])&&t.GetProperty(e[i]).GetPropertyValue()&&t.GetProperty(e[i]).GetPropertyValue().GetValue();if(void 0!==l)return l}},l=i(["Collab.Background.Color","Arrow.Body.2.Color","Actor.Color"]),r=i(["Collab.Background.Color.Opacity","Arrow.Body.2.Color.Opacity","Actor.Color.Opacity"]),o=i(["Collab.Background.Color","Arrow.Body.Color","Actor.Color"]),n=i(["Collab.Background.Color.Opacity","Arrow.Body.Color.Opacity","Actor.Color.Opacity"]),a=i(["Collab.Border.Line.Color"]),s=i(["Collab.Border.Line.Color.Opacity"]),y=i(["Collab.Text.Color"]),c=i(["Collab.Text.Color.Opacity"]),d=i(["Collab.Attach.Line.Color"]),p=i(["Collab.Attach.Line.Color.Opacity"]),S=(e,t)=>{return e+Math.round(255*Math.min(Math.max(t||1,0),1)).toString(16).toUpperCase()},u=document.createElement("canvas");u.width=128,u.height=128;const h=u.getContext("2d");if(!h)return null;h.globalAlpha=1,h.lineWidth=16;for(let e=0;e<128;e+=16)for(let t=0;t<128;t+=16)h.fillStyle=(e/16+t/16)%2?"#BFBFBF":"#FFFFFF",h.fillRect(e,t,16,16);if(h.globalAlpha=1,d&&void 0!==p&&0!==p&&(h.strokeStyle="#"+d.getHexString(),void 0!==p&&1!==p&&(h.globalAlpha=p),h.beginPath(),h.moveTo(89.6,89.6),h.lineTo(128,128),h.stroke()),h.globalAlpha=1,a&&void 0!==s&&0!==s&&(h.fillStyle="#"+a.getHexString(),void 0!==s&&1!==s&&(h.globalAlpha=s),h.beginPath(),h.ellipse(64,64,51.2,51.2,0,0,2*Math.PI),h.fill()),h.globalAlpha=1,l&&o){const e=h.createLinearGradient(25.6,102.4,102.4,25.6);let t="#"+l.getHexString();void 0!==r&&1!==r&&(t=S(t,r),h.globalAlpha=r);let i="#"+o.getHexString();void 0!==n&&1!==n&&(i=S(i,n)),e.addColorStop(0,t),e.addColorStop(1,i),h.fillStyle=e,h.beginPath(),h.ellipse(64,64,38.4,38.4,0,0,2*Math.PI),h.fill()}return h.globalAlpha=1,y&&void 0!==c&&0!==c&&(h.font="60px Arial Black",h.textAlign="center",h.textBaseline="middle",h.fillStyle="#"+y.getHexString(),void 0!==c&&1!==c&&(h.globalAlpha=c),h.fillText("A",64,64)),e&&(h.strokeStyle="#000000",h.strokeRect(0,0,128,128)),u.toDataURL()}get componentType(){return"VCXComponentStyle"}}return function(e){let t;!function(e){e[e.application=0]="application",e[e.admin=1]="admin",e[e.custom=2]="custom"}(t=e.EOriginType||(e.EOriginType={}))}(s||(s={})),s}),define("DS/VCXWebStyles/VCXIStylesHolder",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}),define("DS/VCXWebStyles/VCXModifiableStylesManager",["DS/VCXWebStyles/VCXComponentStyle","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebModifiables/VCXModifiable","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables"],function(e,t,i,l,r,o,n,a){"use strict";return i.extend({init:function(){this._parent()},OnChangeProperty:function(t,i,l){if(l||(l={}),l.fromChildClass);else if(this.OnChangePropertyBegin(t,i))return!0;return"Actor.Custom.Styles"===t?i.GetValue().forEach(t=>{e.BuildFromPropertyMapToLoad(t,this.GetObject())}):"Actor.Custom.Styles.Favorites"===t&&i.GetValue().forEach(e=>{this.GetObject().SetFavorite(e.GetValueAtIndex(0).GetValue(),e.GetValueAtIndex(1).GetValue())}),!0},OnChangePropertiesEnd:function(){},GetProperty:function(t){let i;if("Actor.Custom.Styles"===t){const r=new n(t,n.EBehaviorType.Singleton,!0,a),s=new l;let y=0;for(const t in this.GetObject()._styles){const i=this.GetObject()._styles[t];i.GetOrigin()===e.EOriginType.custom&&s.SetValueAtIndex(y++,i.GetPropertyMapToSave())}i=new o(r,s)}else if("Actor.Custom.Styles.Favorites"===t){const e=new n(t,n.EBehaviorType.Singleton,!0,a),s=new l;let y=0;for(const e in this.GetObject()._stylesFavorites){const t=this.GetObject()._stylesFavorites[e],i=new l;i.SetValueAtIndex(0,new r(e)),i.SetValueAtIndex(1,new r(t)),s.SetValueAtIndex(y++,i)}i=new o(e,s)}return i},GetProperties:function(){var e=this._parent();return e.AddOrModifyProperty(this.GetProperty("Actor.Custom.Styles")),e.AddOrModifyProperty(this.GetProperty("Actor.Custom.Styles.Favorites")),e}})}),define("DS/VCXWebStyles/VCXStylesManager",["require","exports","DS/WebappsUtils/WebappsUtils","DS/CoreEvents/Events","DS/VCXWebIO/VCXFileServices","DS/VCXWebExperienceLoader/VCXExperienceLoaderBase","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebKernelCommands/VCXCmdChangeLinkedProperties","DS/VCXWebKernelCommands/VCXCmdChangeNeutralProperties","DS/VCXWebKernelCommands/VCXCmdChangeKeys","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebStyles/VCXComponentStyle"],function(e,t,i,l,r,o,n,a,s,y,c,d,p,S,u){"use strict";return class{constructor(){this._experienceBase=null,this.stylesForType={},this._stylesID={},this._stylesfiles={},this._styles={},this._stylesIntegerID={},this._stylesVisibility={},this._stylesFavorites={},this._stylesNextIntegerID=1,this._isInitialized=!0,this._numberOfFilesToLoad=0,this._numberOfFilesLoaded=0,this._masterfilevar=null,this._moduleName=""}initialize(){return this.stylesForType={},this._stylesID={},this._stylesfiles={},this._styles={},this._stylesIntegerID={},this._stylesVisibility={},this._stylesFavorites={},this._stylesNextIntegerID=1,this._isInitialized=!0,this._numberOfFilesToLoad=0,this._numberOfFilesLoaded=0,this._masterfilevar=null,this.LoadStyles(this._moduleName)}unInitialize(){this._isInitialized=!1,this._styles={}}postInitialize(){}SetModuleName(e){this._moduleName=e}GetModuleName(){return this._moduleName}ParseMasterFiles(e){var t=[];this._masterfilevar=e;for(var i=0;i<e.styles.length;i++){var l=e.styles[i];if(l.x){for(var r=0;r<l.x.length;r++){var o=l.x[r];this._numberOfFilesToLoad++,t.push(this.LoadStyle(this._moduleName,"styles/"+o+".json",o))}for(var n=0;n<l.y.length;n++){var a=l.y[n];this._numberOfFilesToLoad++,t.push(this.LoadStyle(this._moduleName,"styles/"+a+".json",a))}}if(l.list)for(var s=0;s<l.list.length;s++){var y=l.list[s];this._numberOfFilesToLoad++,t.push(this.LoadStyle(this._moduleName,"styles/"+y+".json",y))}}return Promise.all(t)}async LoadStyles(e){if(!this._moduleName)return;var t=i.getWebappsAssetUrl(e,"styles/styles_list.json");const l=await r.PBlobURLToJSONText(t);return this.ParseMasterFiles(l)}async LoadStyle(e,t,l){var r=i.getWebappsAssetUrl(e,t);return this.LoadStyleURL(r,l)}async LoadStyleURL(e,t){var i=t;const l=await r.PBlobURLToBlob(e,""),o=await r.PBlobToFileVar(l);var n=i;if(this._isInitialized&&(this._stylesID[n]=o.objectID,this._stylesfiles[n]=this.BuildStyle(o),o.visible?this._stylesVisibility[o.objectID]=!0:this._stylesVisibility[o.objectID]=!1,this._numberOfFilesLoaded++,this._numberOfFilesLoaded===this._numberOfFilesToLoad)){this.stylesForType={};const e=this._masterfilevar;for(var a=0;a<e.styles.length;a++){var s=e.styles[a],y=s.type;if(this.stylesForType[y]=[],s.x)for(var c=0;c<s.x.length;c++)for(var d=s.x[c],p=0;p<s.y.length;p++){var S=s.y[p],h=this._stylesfiles[d],C=this._stylesfiles[S];(b=h.Clone()).Merge(C);var m=this._stylesID[d]+"."+this._stylesID[S];const e=this.BuildStyleFromPropertySet(b,m,d+" "+S);e&&e.SetOrigin(u.EOriginType.application),this.stylesForType[y].push(m)}if(s.list)for(var g=0;g<s.list.length;g++){n=s.list[g];var b=(h=this._stylesfiles[n]).Clone();m=this._stylesID[n];const e=this.BuildStyleFromPropertySet(b,m,n);e&&e.SetOrigin(u.EOriginType.application),this.stylesForType[y].push(m)}}}}GetStylesForType(e){const t=this.stylesForType[e],i=[];return t&&t.forEach(e=>{if(this._stylesVisibility[e]){const t=this.GetStyleFromSTRId(e);i.push({idx:e,style:t})}}),i.sort((e,t)=>e.style.GetOrigin()>t.style.GetOrigin()?-1:e.style.GetOrigin()<t.style.GetOrigin()?1:e.idx<t.idx?-1:e.idx>t.idx?1:0)}BuildStyle(e){var t=new o;return t.InitLoader(this._experienceBase),t.LoadPropSet(e.properties)}GetStyleIDAndTranslatedName(e,t,i){const l=this._stylesIntegerID[e];if(void 0===l)return{id:null,name:""};let r,o=e;return 0===this._styles[l].origin?(o=t[e]||this._styles[l].name||e,r=i?"brush-ok":"brush"):(o=this._styles[l].name||e,r=i?"user-ok":"user"),{id:l,style:this._styles[l],name:o,iconName:r}}SetStyleName(e,t){const i=this._stylesIntegerID[e];return 0!==this._styles[i].origin&&(this._styles[i].name=t,!0)}DeleteStyle(e){this.UnSubscribeAll(e);const t=this._stylesIntegerID[e],i=this._experienceBase.getManager("VCXScenarioManager"),l=new s(i);let r=0;const o=new y(i);let n=0;return i.SearchAllValuesForOneProperty("Modifiable.StyleID",e,e=>{this._styles[t].GetPropertySet().onEachProperty((t,i)=>{const a=e.modifiable.QueryInterface("VCXIStylesHolder");a.GetStyleExclusion&&a.GetStyleExclusion().includes(t)||(e&&"Neutrals"===e.type&&(l.ChangeProperty(e.modifiable,t,i.GetPropertyValue()),r++),e&&"Track"===e.type&&(o.ChangeKey(e.Scenario,e.modifiable,t,e.Frame,i.GetPropertyValue(),e.Easing),n++))}),e&&"Neutrals"===e.type&&(l.ChangeProperty(e.modifiable,"Modifiable.StyleID",new p("")),l.ChangeProperty(e.modifiable,"Modifiable.Style.Exclusion",new S),r++),e&&"Track"===e.type&&(o.ChangeKey(e.Scenario,e.modifiable,"Modifiable.StyleID",e.Frame,new p(""),e.Easing),o.ChangeKey(e.Scenario,e.modifiable,"Modifiable.Style.Exclusion",e.Frame,new S,e.Easing),n++)}),r&&this._experienceBase.getManager("VCXCommandManager").Push(l),n&&this._experienceBase.getManager("VCXCommandManager").Push(o),0!==this._styles[t].origin&&(delete this._styles[t],delete this._stylesIntegerID[e],delete this._stylesVisibility[e],!0)}GetStyleFromSTRId(e){const t=this._stylesIntegerID[e];return t&&this._styles[t]}BuildStyleFromPropertySet(e,t,i,l){if(e.onEachProperty((e,t)=>{t.GetPropertyInfo().SetBehaviorType(c.EBehaviorType.Singleton)}),l||(l=this._experienceBase.Factory.BuildComponent("VCXComponentStyle"))&&(l.SetPersistency(2),l.SetID(t),l.SetName(i),this._experienceBase.ComponentsMap.AddComponent(l),this._styles[this._stylesNextIntegerID]=l,this._stylesIntegerID[l.GetID()]=this._stylesNextIntegerID,this._stylesNextIntegerID++),!l)return null;l.SetPropertySet(e);var r=l.QueryInterface("VCXIModifiable"),o=this._experienceBase.getManager("VCXScenarioManager"),a=new n(o,this._experienceBase.getManager("VCXCommandManager"));return e.onEachProperty((e,t)=>{a.ChangeProperty(r,t)}),this._experienceBase.getManager("VCXCommandManager").Do(a),l}FindStyleName(e){let t,i=0,l=!1;for(;!l;){l=!0,t=e+" - New Style("+ ++i+")";for(const e in this._styles)this._styles[e].name===t&&(l=!1)}return t}GetForType(e){for(const t in this.stylesForType)if(this.stylesForType[t].indexOf(e.GetID())>=0)return t;return null}CreateStyleFromPropertySet(e,t,i,r){const o=this.BuildStyleFromPropertySet(e,i,r);if(!o)return null;this.stylesForType[t]||(this.stylesForType[t]=[]),this.stylesForType[t].push(o.GetID()),this._stylesVisibility[o.GetID()]=!0;const n=[];return n.push(o),l.publish({event:"VCX_STYLE_ADDED",data:n}),o}CreateStyle(e,t,i){for(var l=new d,r=0;r<e.length;r++)l.AddOrModifyProperty(t.GetProperty(e[r]));return this.CreateStyleFromPropertySet(l,t.GetObject().componentType,"",i)}UpdateStyle(e,t,i){for(var r=new d,o=0;o<e.length;o++)r.AddOrModifyProperty(t.GetProperty(e[o]));const n=this._stylesIntegerID[i],a=this._styles[n];this.BuildStyleFromPropertySet(r,"","",a);const s=[];return s.push(a),l.publish({event:"VCX_STYLE_UPDATED",data:s}),a}SetFavorite(e,t){this._stylesFavorites[e]=t}GetFavorite(e){return this._stylesFavorites[e]}Subscribe(e,t){const i=this._stylesIntegerID[t],l=this._styles[i];if(l){const i=this._experienceBase.getManager("VCXLinkedPropertyManager"),r=this._experienceBase.getManager("VCXScenarioManager"),o=this._experienceBase.getManager("VCXCommandManager"),n=new a(i,r,o);return l.GetPropertySet().onEachProperty((i,l)=>{const r=e.QueryInterface("VCXIStylesHolder");r.GetStyleExclusion&&r.GetStyleExclusion().includes(i)||n.AddLink(t,i,e.GetObject().GetID(),i,null)}),this._experienceBase.getManager("VCXCommandManager").Do(n),!0}return!1}UnSubscribe(e,t){var i=this._stylesIntegerID[t],l=this._styles[i];if(l){var r=this._experienceBase.getManager("VCXLinkedPropertyManager"),o=this._experienceBase.getManager("VCXScenarioManager"),n=this._experienceBase.getManager("VCXCommandManager"),s=new a(r,o,n);l.GetPropertySet().onEachProperty((i,l)=>{s.RemoveLink(t,i,e.GetObject().GetID(),i)}),n.Do(s)}}UnSubscribeAll(e){const t=this._experienceBase.getManager("VCXLinkedPropertyManager"),i=t.GetLinksFromInComponentID(e),l=this._experienceBase.getManager("VCXScenarioManager"),r=this._experienceBase.getManager("VCXCommandManager");if(i){var o=new a(t,l,r);i.forEach(e=>{o.RemoveLink(e.inID,e.inProp,e.outID,e.outProp)}),r.Do(o)}}get componentType(){return"VCXStylesManager"}}}),define("DS/VCXWebStyles/VCXStylesModifiableServices",["require","exports","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebStyles/VCXComponentStyle"],function(e,t,i,l){"use strict";class r{static emptyExclusionList(e){const t=e.GetObject()._experienceBase,l=r.checkStyleContext(e),o=t.getManager("VCXCommandManager"),n=t.getManager("VCXScenarioManager"),a=t.getManager("VCXStylesManager"),s=new i(n,o),y=l.modifiable.GetProperty("Modifiable.Style.Exclusion");y.GetPropertyValue().Value=[],y.SetPropertyValue(y.GetPropertyValue()),s.ChangeProperty(l.modifiable,y),o.Push(s),a.Subscribe(l.modifiable,l.styleID)}static checkStyleContext(e){const t=e.GetObject()._experienceBase,i=e.QueryInterface("VCXIModifiable"),r=t.getManager("VCXStylesManager"),o=i.GetProperty("Modifiable.StyleID").GetPropertyValue().GetValue(),n=e.GetObject().GetType(),a=o&&r.GetStyleFromSTRId(o),s=r.GetFavorite(n),y={styleName:a&&a.name,styleID:o,style:a,modifiable:i,favorite:s,componentType:n,isFavorite:s===o,createAvailable:!1,updateAvailable:!1,restoreAvailable:!1,favoriteAvailable:!1,renameAvailable:!1,deleteAvailable:!1},c=i.QueryInterface("VCXIStylesHolder");return(c.GetStyleExclusion&&c.GetStyleExclusion().length>0||!o)&&(y.createAvailable=!0),o&&a&&a.GetOrigin()!==l.EOriginType.application&&c.GetStyleExclusion&&c.GetStyleExclusion().length>0&&(y.updateAvailable=!0),o&&c.GetStyleExclusion&&c.GetStyleExclusion().length>0&&(y.restoreAvailable=!0),!o||c.GetStyleExclusion&&c.GetStyleExclusion().length>0||(y.favoriteAvailable=!0),!a||a.GetOrigin()===l.EOriginType.application||c.GetStyleExclusion&&c.GetStyleExclusion().length>0||(y.renameAvailable=!0,y.deleteAvailable=!0),y}static createStyle(e,t){const l=e.GetObject()._experienceBase,r=l.getManager("VCXStylesManager"),o=l.getManager("VCXCommandManager"),n=l.getManager("VCXScenarioManager"),a=this.checkStyleContext(e),s=e.QueryInterface("VCXIModifiableFormatPainter");if(!s)return;const y=s.getPropertiesFormatPainter(),c=r.CreateStyle(y,a.modifiable,t),d=new i(n,o),p=a.modifiable.GetProperty("Modifiable.StyleID");p.SetPropertyValue(p.GetPropertyValue().SetValue(c.GetID())),d.ChangeProperty(a.modifiable,p),this.emptyExclusionList(e),o.Push(d)}static updateStyle(e){const t=e.GetObject()._experienceBase.getManager("VCXStylesManager"),i=this.checkStyleContext(e),l=e.QueryInterface("VCXIModifiableFormatPainter");if(!l)return;const r=l.getPropertiesFormatPainter();t.UpdateStyle(r,i.modifiable,i.styleID),this.emptyExclusionList(e)}}return r}),define("DS/VCXWebStyles/VCXAStylesHolder",["require","exports","DS/VCXWebKernelCommands/VCXCmdChangePropertiesAutokey","DS/VCXWebKernelCommands/VCXCmdChangeLinkedProperties","DS/CoreEvents/Events","DS/ApplicationFrame/CommandsManager","DS/WebappsUtils/WebappsUtils","DS/WebComponentModeler/WebExtensionBase","UWA/Core","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertySet","DS/VCXWebProperties/VCXPropertyValueMap","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebStyles/VCXStylesModifiableServices","i18n!DS/VCXWebStyles/assets/nls/VCXWebStyles","DS/Controls/LineEditor","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Core/WebUXGlobalEnums"],function(e,t,i,l,r,o,n,a,s,y,c,d,p,S,u,h,C,m,g,b,f,V){"use strict";return class extends a{constructor(){super(...arguments),this._styleID="",this._styleExclusion=[],this._InCriticalSectionOnChangePropertyStyle=!1}GetProperty(e,t){let i,l;if("Modifiable.Style.Exclusion"===e){const t=new p;let r=0;this.GetStyleExclusion().forEach(e=>{t.SetValueAtIndex(r++,new S(e))}),(l=new c(e,c.EBehaviorType.NotAnimable,!0,m)).SetVisible(!1),i=new y(l,t)}else if("Modifiable.StyleID"===e){const t=new S;t.SetValue(this._styleID||""),(l=new c(e,c.EBehaviorType.NotAnimable,!0,m)).SetVisible(!1),i=new y(l,t)}else if("Modifiable.Style"===e){this._iconList={list:{}};const o=this.GetObject();if(!o)return i;if("VCXComponentStyle"!==o.GetType()){const o=this.buildStylesEnumInfo(t);var r=new u;l=new h(e,c.EBehaviorType.NotAnimable,!1,m);let n=0;for(let e in null==o?void 0:o.list)l.AddOrModifyChoice(e,null==o?void 0:o.list[e].name),n++;r.SetValue(null==o?void 0:o.selectedIndex),0===n&&l.SetVisible(!1),i=new y(l,r)}}return i}SetStyle(e){if(!this._InCriticalSectionOnChangePropertyStyle){this._InCriticalSectionOnChangePropertyStyle=!0;var t=this.GetObject();if(!t)return!1;if("VCXComponentStyle"!==t.GetType()){var i=t._experienceBase.getManager("VCXStylesManager");return i?e!=this._styleID&&(i.UnSubscribe(this,this._styleID),(i.Subscribe(this,e)||""===e)&&(this._styleID=e)):this._styleID="",this._InCriticalSectionOnChangePropertyStyle=!1,!0}this._InCriticalSectionOnChangePropertyStyle=!1}return!1}OnChangeProperty(e,t){switch(e){case"Modifiable.StyleID":var i=t.GetValue();return this.SetStyle(i);case"Modifiable.Style.Exclusion":const l=[];return t.GetValue().forEach(e=>{l.push(e.GetValue())}),this.SetStyleExclusion(l),!0}return!1}GetProperties(e,t){e.AddOrModifyProperty(this.GetProperty("Modifiable.StyleID",t)),e.AddOrModifyProperty(this.GetProperty("Modifiable.Style",t)),e.AddOrModifyProperty(this.GetProperty("Modifiable.Style.Exclusion",t))}RequestModification(e,t){var i;if(e){const l=this.GetObject(),r=null==l?void 0:l._experienceBase,o=null==r?void 0:r.getManager("VCXStylesManager"),n=null===(i=null==e?void 0:e.GetPropertyInfo())||void 0===i?void 0:i.GetPropertyName(),a=r.getManager("VCXScenarioManager").ModifiableServer;t.Iterate((i,l)=>{var s,d;const u=a.GetModifiableFromHashing(i).GetObject();if(!(n&&r&&o&&u))return!0;if("Modifiable.Style"===n){let r=e.GetPropertyValue().GetValue();if(5===r)return this._editedPropertySet?(t.AddOrModifyPropertySet(i,this._editedPropertySet),!0):(t.AddOrModifyPropertySet(i,l),!0);var h="";if(10===r){if(h="",this._noStylePropertySet)l=this._noStylePropertySet;else if(this._styleID){const e=null===(s=o.GetStyleFromSTRId(this._styleID))||void 0===s?void 0:s.GetPropertySet();e&&e.onEachProperty((e,t)=>{this.GetStyleExclusion().includes(e)||l.AddOrModifyProperty(t)})}}else{const e=u.GetType(),t=o.GetStylesForType(e);h=t&&t[r-20]&&t[r-20].idx}const n=new p,a=new c("Modifiable.Style.Exclusion",c.EBehaviorType.NotAnimable,!0,m),d=new y(a,n);l.AddOrModifyProperty(d),(C=new S).SetValue(h);const g=new c("Modifiable.StyleID",c.EBehaviorType.NotAnimable,!0,m),b=new y(g,C);return l.AddOrModifyProperty(b),t.AddOrModifyPropertySet(i,l),!0}if(l.AddOrModifyProperty(e),this._styleID){if(!o._stylesVisibility[this._styleID]){const e=null===(d=o.GetStyleFromSTRId(this._styleID))||void 0===d?void 0:d.GetPropertySet();e&&e.onEachProperty((e,t)=>{this.GetStyleExclusion().includes(e)||l.AddOrModifyProperty(t)});var C=new S;const r=new c("Modifiable.StyleID",c.EBehaviorType.NotAnimable,!0,m),n=new y(r,C);l.AddOrModifyProperty(n);const a=new p,s=new c("Modifiable.Style.Exclusion",c.EBehaviorType.NotAnimable,!0,m),u=new y(s,a);return l.AddOrModifyProperty(u),t.AddOrModifyPropertySet(i,l),!0}const e=[...this.GetStyleExclusion()];let n=!1;const a=r.getManager("VCXLinkedPropertyManager");if(null==l||l.onEachProperty(t=>{if(null==a?void 0:a.IsLinkedAndNotInFollow(u.GetID(),t)){let i=!1;e&&e.every(e=>(e===t&&(i=!0),!i)),i||(e.push(t),n=!0)}}),n){const t=new p;let i=0;e.forEach(e=>{t.SetValueAtIndex(i++,new S(e))});const r=new c("Modifiable.Style.Exclusion",c.EBehaviorType.NotAnimable,!0,m),o=new y(r,t);l.AddOrModifyProperty(o)}}return t.AddOrModifyPropertySet(i,l),!0})}return null}GetStyleExclusion(){return this._styleExclusion}SetStyleExclusion(e){const t=this.GetObject();if(!t)return;const i=t._experienceBase;if(i.getManager("VCXStylesManager").GetStyleFromSTRId(this._styleID)){const r=i.getManager("VCXLinkedPropertyManager"),o=i.getManager("VCXScenarioManager"),n=i.getManager("VCXCommandManager"),a=new l(r,o,n);this._styleExclusion.forEach(i=>{e.indexOf(i)<0&&a.AddLink(this._styleID,i,t.GetID(),i,null)}),e.forEach(e=>{this._styleExclusion.indexOf(e)<0&&a.RemoveLink(this._styleID,e,t.GetID(),e)}),n.Do(a)}this._styleExclusion=e}getPropertyGroups(e){const t=this.GetObject();if(!t)return e;const i=t.GetType(),l=t._experienceBase.getManager("VCXStylesManager");return l&&l.GetStylesForType(i).length&&e["Group.Essentials"].addProperty({propertyName:"Modifiable.Style",i18n:m}),e}buildStylesEnumInfo(e){var t;this._iconList={list:{}};const i=this.GetObject();if(i){if(i._experienceBase){var l=i._experienceBase.getManager("VCXStylesManager");if(l){let a=0;const s=this.QueryInterface("VCXIModifiable");let y=!1;if(this._styleID&&this.GetStyleExclusion&&this.GetStyleExclusion().length>0){const t=l.GetStyleIDAndTranslatedName(this._styleID,e);t.name=m.get("Style.Edited.Name",{originalName:t.name}),y=!0,this._iconList.list[5]={name:t.name,iconPath:n.getWebappsAssetUrl("VCXWebStyles","icons/22/VCX_Palette.png")},this._editedPropertySet=new d,this._editedPropertySet.AddOrModifyProperty(s.GetProperty("Modifiable.StyleID").Clone()),this._editedPropertySet.AddOrModifyProperty(s.GetProperty("Modifiable.Style.Exclusion").Clone()),this.GetStyleExclusion().forEach(e=>{var t,i;null===(t=this._editedPropertySet)||void 0===t||t.AddOrModifyProperty(null===(i=s.GetProperty(e))||void 0===i?void 0:i.Clone())})}this._iconList.list[10]={name:m["Style.NoStyle"],iconPath:n.getWebappsAssetUrl("VCXWebStyles","icons/22/VCX_White.png")};const c=null===(t=l.GetStyleFromSTRId(this._styleID))||void 0===t?void 0:t.GetPropertySet();this._styleID?(this._noStylePropertySet=new d,c&&c.onEachProperty((e,t)=>{var i,l;this.GetStyleExclusion().includes(e)?null===(l=this._noStylePropertySet)||void 0===l||l.AddOrModifyProperty(s.GetProperty(e).Clone()):null===(i=this._noStylePropertySet)||void 0===i||i.AddOrModifyProperty(t)})):delete this._noStylePropertySet;const p=i.GetType(),S=l.GetStylesForType(p);if(S)for(var r=0;r<S.length;r++){var o=S[r].idx;if(l.GetStyleIDAndTranslatedName){const t=l.GetStyleIDAndTranslatedName(o,e,l.GetFavorite(p)===o);l.GetFavorite(p)===o&&(t.name+=" ");const i=this.getStyleIcon(o,p);this._iconList.list[r+20]=i?{name:t.name,iconPath:i}:{name:t.name,iconPath:n.getWebappsAssetUrl("VCXWebStyles","icons/22/VCX_Palette.png")}}else this._iconList.list[r+20]={name:o,iconName:"i-question"};this._styleID===o&&(a=r+20)}this._iconList.selectedIndex=y?5:a}}return this._iconList}}getStyleIcon(e,t){var i;const l=o.getCommands().Context;for(let t in l){const r=l[t].getArguments&&l[t].getArguments();if((r&&r.length>0&&r[0].styleID)===e){const e=this.QueryInterface("VCXIContextualContent"),l={};if(null==e||e.appendContent(l,[this.GetObject()],null),null===(i=null==l?void 0:l.StylesList)||void 0===i?void 0:i.content)for(let e in l.StylesList.content)if(l.StylesList.content[e].cmdId===t)return n.getWebappsAssetUrl(l.StylesList.content[e].iconFolder,l.StylesList.content[e].icon)}}}getAdditionalPropertySettings(e,t){var i;const l=this.GetObject();if(!l)return e;const o=l._experienceBase.getManager("VCXStylesManager");if(o){const n=C.checkStyleContext(this);this._pushAdditionalPropertyButton(e,"Modifiable.Style",{functionCB:e=>{if(!C.checkStyleContext(this).createAvailable)return;const t=o.FindStyleName(l.getDefaultName()),i=new b({}),r=new s.Element("div",{class:"VCXDialogContainer"});new s.Element("div",{class:"VCXDialogDescription",html:m["Style.CreateNewStyle.html"]}).inject(r);const n=new s.Element("div",{class:"VCXDialogInput"}).inject(r);new s.Element("span",{class:"VCXDialogLabel",html:m["Style.CreateNewStyle.Title"]}).inject(n);const a=new g({placeholder:m["Style.CreateNewStyle.PlaceHolder"],value:t,sizeInCharNumber:40,selectAllOnFocus:!0,maxLength:20}).inject(n),y=new f({touchMode:!0,immersiveFrame:i,modalFlag:!0,title:m["Style.CreateNewStyle.Dialog.Title"],content:r,customButtonsDefinition:[{label:m["Style.CreateNewStyle.Dialog.OK"],emphasize:"primary",onClick:()=>{C.createStyle(this,a.value||t),y.close()},role:V.WUXCustomButtonRoleEnum.Validate},{label:m["Style.CreateNewStyle.Dialog.Cancel"],onClick:()=>{y.close()},role:V.WUXCustomButtonRoleEnum.Escape}]}),c=l._experienceBase.getManager("VCXContextManager").getFrameWindow();c&&c.elements.modalDialogContainer&&i.inject(c.elements.modalDialogContainer)},type:"createStyle",iconName:"plus",tooltip:m["Style.CreateNewStyle.Button.Tooltip"],location:20,data:{object:l},buttonDisabled:!n.createAvailable,available:!n.renameAvailable}),this._pushAdditionalPropertyButton(e,"Modifiable.Style",{functionCB:e=>{const t=C.checkStyleContext(this);t.favoriteAvailable&&(o.SetFavorite(t.componentType,t.styleID),r.publish({event:"VCX_PROPERTIES_CHANGED"}))},type:"favoriteOn",iconName:"favorite-off",tooltip:m["Style.SetAsFavorite.Tooltip"],location:10,data:{object:l},available:!n.isFavorite&&n.favoriteAvailable}),this._pushAdditionalPropertyButton(e,"Modifiable.Style",{type:"favoriteOff",iconName:"favorite-on",location:10,data:{object:l},available:n.isFavorite&&n.favoriteAvailable}),this._pushAdditionalPropertyButton(e,"Modifiable.Style",{functionCB:e=>{if(C.checkStyleContext(this).updateAvailable)if(o._updateConfirmed)C.updateStyle(this);else{const e=new b,t=new f({touchMode:!0,title:m["Style.UpdateStyle.Dialog.Title"],modalFlag:!0,content:new s.Element("div",{html:m["Style.UpdateStyle.html"]}),immersiveFrame:e,recId:"UpdateStyleDialog",resizableFlag:!0,customButtonsDefinition:[{label:m["Style.UpdateStyle.Dialog.OK"],emphasize:"primary",onClick:()=>{o._updateConfirmed=t.checkboxInfos.checkFlag,C.updateStyle(this),t.close(),r.publish({event:"VCX_PROPERTIES_CHANGED"})},role:V.WUXCustomButtonRoleEnum.Validate},{label:m["Style.UpdateStyle.Dialog.Cancel"],onClick:()=>{t.close()},role:V.WUXCustomButtonRoleEnum.Escape}],checkboxInfos:{label:m["Style.UpdateStyle.Dialog.DoNotShowAgain"],checkFlag:!0}}),i=l._experienceBase.getManager("VCXContextManager").getFrameWindow();i&&i.elements.modalDialogContainer&&e.inject(i.elements.modalDialogContainer)}},type:"updateStyle",iconName:"update",tooltip:m["Style.UpdateStyle.Button.Tooltip"],location:30,data:{object:l},available:!n.renameAvailable&&!n.favoriteAvailable,buttonDisabled:!n.updateAvailable});const a=()=>({functionCB:e=>{const t=C.checkStyleContext(this);if(!t.renameAvailable)return;const i=t&&t.styleID,n=t.styleName,a=new b({}),y=new s.Element("div",{class:"VCXDialogContainer"});new s.Element("div",{class:"VCXDialogDescription",html:m["Style.RenameStyle.html"]}).inject(y);const c=new s.Element("div",{class:"VCXDialogInput"}).inject(y);new s.Element("span",{class:"VCXDialogLabel",html:m["Style.RenameStyle.Title"]}).inject(c);const d=new g({placeholder:m["Style.RenameStyle.PlaceHolder"],value:n,sizeInCharNumber:40,selectAllOnFocus:!0,maxLength:20}).inject(c),p=new f({touchMode:!0,immersiveFrame:a,modalFlag:!0,title:m["Style.RenameStyle.Dialog.Title"],content:y,customButtonsDefinition:[{label:m["Style.RenameStyle.Dialog.OK"],emphasize:"primary",onClick:()=>{o.SetStyleName(i,d.value||n),p.close(),r.publish({event:"VCX_PROPERTIES_CHANGED"})},role:V.WUXCustomButtonRoleEnum.Validate},{label:m["Style.RenameStyle.Dialog.Cancel"],onClick:()=>{p.close()},role:V.WUXCustomButtonRoleEnum.Escape}]}),S=l._experienceBase.getManager("VCXContextManager").getFrameWindow();S&&S.elements.modalDialogContainer&&a.inject(S.elements.modalDialogContainer)},type:"renameStyle",iconName:"rename",label:m["Style.RenameStyle.Button.Label"],tooltip:m["Style.RenameStyle.Button.Tooltip"],location:40,data:{object:l},available:n.renameAvailable}),y=()=>({functionCB:e=>{const t=C.checkStyleContext(this);if(!t||!t.deleteAvailable)return;const i=t.styleID,n=new b,a=new f({touchMode:!0,title:m["Style.DeleteStyle.Dialog.Title"],modalFlag:!0,content:new s.Element("div",{html:m["Style.DeleteStyle.html"]}),immersiveFrame:n,recId:"DeleteStyleDialog",resizableFlag:!0,customButtonsDefinition:[{label:m["Style.DeleteStyle.Dialog.OK"],emphasize:"primary",onClick:()=>{o.DeleteStyle(i),a.close(),r.publish({event:"VCX_PROPERTIES_CHANGED"})},role:V.WUXCustomButtonRoleEnum.Validate},{label:m["Style.DeleteStyle.Dialog.Cancel"],onClick:()=>{a.close()},role:V.WUXCustomButtonRoleEnum.Escape}]}),y=l._experienceBase.getManager("VCXContextManager").getFrameWindow();y&&y.elements.modalDialogContainer&&n.inject(y.elements.modalDialogContainer)},type:"deleteStyle",iconName:"trash",label:m["Style.DeleteStyle.Button.Label"],tooltip:m["Style.DeleteStyle.Button.Tooltip"],location:50,data:{object:l},available:n.deleteAvailable});n.renameAvailable&&n.deleteAvailable?this._pushAdditionalPropertyButton(e,"Modifiable.Style",{available:n.renameAvailable&&n.deleteAvailable,type:"Contextual",data:[a(),y()]}):(n.renameAvailable&&this._pushAdditionalPropertyButton(e,"Modifiable.Style",a()),n.deleteAvailable&&this._pushAdditionalPropertyButton(e,"Modifiable.Style",y())),e["Modifiable.Style"]||(e["Modifiable.Style"]={}),e["Modifiable.Style"].enumInfo=null===(i=this.buildStylesEnumInfo(t))||void 0===i?void 0:i.list,e["Modifiable.Style"].displayInHeader=!0}return e}_pushAdditionalPropertyButton(e,t,i){e[t]||(e[t]={}),e[t].buttons||(e[t].buttons=[]),e[t].buttons.push(i)}}});