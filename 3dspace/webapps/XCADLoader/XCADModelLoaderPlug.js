define("DS/XCADLoader/XCADModelLoaderPlug",["DS/XCADLoader/IModelLoaderPlug","DS/XCADLoader/XCADLoader","DS/XCADSTEPDocument/STEPInputDocument","DS/XCADSTPDocument/STPInputDocument","DS/XCADSTPZDocument/STPZInputDocument","DS/XCADSTPXDocument/STPXInputDocument","DS/XCADSTPXZDocument/STPXZInputDocument","DS/XCADSTPADocument/STPAInputDocument","DS/XCADSTLDocument/STLInputDocument","DS/XCADIFCDocument/IFCInputDocument","DS/CoreEvents/Events"],function(e,t,n,o,u,r,i,l,D,a,c){"use strict";var p=2,d=1,s=!1,A=!1,S=new function(e){let t=new Array(e),n=0,o=0,u=!1;this.addValue=function(e,r){u&&n!=t.length&&n++,n==t.length&&(n=0),u&&n==o&&o++,o==t.length&&(o=0),t[n]={x:e,y:r},u=!0},this.findValue=function(e){let r=o,i=0;for(o>n||n==t.length-1?i=t.length:u&&(i=n-o+1);0!=i;){if(null!=t[r]&&e==t[r].x)return t[r].y;++r==t.length&&(r=0),i--}return null}}(3),f=function(){this.converter=null;var e=this;c.subscribe({event:"3DPLAY/EXPLODE/START"},function(t){e.hideAllAnnot(),s=!0}),c.subscribe({event:"3DPLAY/EXPLODE/END"},function(t){s=!1,e.showAllAnnot()}),c.subscribe({event:"/Default/3DPLAY/HIDE"},function(e){A=e.data.length>0}),c.subscribe({event:"/Default/3DPLAY/SHOW_ALL"},function(e){A=!1}),c.subscribe({event:"/VISU/"},function(t){!1===A&&("@onViewpointBeginMove"==t.eventType?e.hideAllAnnot():"@onViewpointEndMove"==t.eventType&&(s||e.showAllAnnot()))})};return(f.prototype=Object.create(e)).isManagedType=function(e){var t=e.toUpperCase()+"InputDocument";return"cgr"!=e&&("obj"==e&&(t="XCAD"+e.toUpperCase()+"InputDocument"),void 0!==require("DS/XCAD"+e.toUpperCase()+"Document/"+t))},f.prototype.showAllAnnot=function(){var e=window.debugWebGLV6Viewer;if(null!=e&&(void 0===e.endLoaded||null!=e.endLoaded&&1==e.endLoaded)){var t=e.getRootNode().getChildrenByName("3DPlay_XCAD_Annotation");if(null!=t){for(var n=0;n<t.length;n++)t[n].setVisibility(!0);e.render()}}},f.prototype.hideAllAnnot=function(){var e=window.debugWebGLV6Viewer;if(null!=e){var t=e.getRootNode().getChildrenByName("3DPlay_XCAD_Annotation");if(null!=t){for(var n=0;n<t.length;n++)t[n].setVisibility(!1);e.render()}}},f.prototype.isSuppotedStep=async function(e){let t=!1;return null!=e&&(t=await async function(e){let t=!1;try{const n=await fetch(e);if(!n.ok)throw new Error(n.statusText);const o=await n.text();return S.addValue(e,o),null!=o.match(/#\d*=TESSELLATED_SHAPE_REPRESENTATION/)&&(t=!0),t}catch(e){throw console.error(e),e}}(e)),t},f.prototype.loadModel=function(e,n,o,u,r,i,l,D,a,c,s,A,f){var h=e.toUpperCase()+"InputDocument";"obj"==e&&(h="XCAD"+e.toUpperCase()+"InputDocument");var v=require("DS/XCAD"+e.toUpperCase()+"Document/"+h);if(void 0===v)return!1;window.debugWebGLV6Viewer.endLoaded=void 0;var C=S.findValue(u);null===C&&(C=f),null===this.converter&&(this.converter=new t);var m=new v;return"stpz"==e?(m.zipped=!0,m.zipMethod=p):"stpx"==e?m.sceneGraph=s:"stpxz"==e?m.zipped=!0:"stpa"==e?(m.zipped=!0,m.zipMethod=d):m.zipped=!1,m.spec=A,m.url=u,this.converter.load(m,u,r,i,l,D,s,m.zipped,m.requestResponseType,A,C),m=null,!0},f});