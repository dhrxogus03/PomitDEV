define("DS/PlatformManagementStaging/Collection/StagingCollection",["UWA/Core","UWA/Class/Model","DS/i3DXCompassCore/Collection/i3DXCompassCollection"],function(t,e,n){"use strict";return n.extend({url:"api/v1/staging/",model:e,parse:function(t){return t}})}),define("DS/PlatformManagementStaging/View/StagingTileView",["UWA/Core","DS/W3DXComponents/Views/Item/TileView","i18n!DS/PlatformManagementStaging/assets/nls/PlatformManagementStaging"],function(t,e,n){"use strict";return e.extend({tagName:"div",name:"staging-tile",extendedEvents:!1,render:function(){return this._parent(),this.container.addClassName("staging grid"),this.container.setAttribute("data-id",this.model.get("id")),this.container.setStyles({width:"100%"}),this.container.getElement(".tile-subtitle")&&""===this.container.getElement(".tile-subtitle").getText()&&this.container.getElement(".tile-subtitle").addClassName("hidden"),this.container.getElement(".staging-tile-header").setContent({tag:"i",class:"tile-header-icon "+this.options.fonticon}),this.container.getElement(".tile-content").setContent([{tag:"div",class:"tile-content-type",html:[{tag:"span",class:"fonticon fonticon-cloud-alt"},{tag:"span",class:"nowrap-title",text:this.isPreview()?t.String.format(n.get("Type: {0}"),"Preview"):t.String.format(n.get("Type: {0}"),"Regular")}]},{tag:"div",class:"tile-content-user hidden",html:[{tag:"span",class:"fonticon fonticon-users"},{tag:"span",class:"nowrap-title",text:t.String.format("User: {0}","10")}]},{tag:"div",class:"tile-content-expire hidden",html:[{tag:"span",class:"fonticon fonticon-calendar-clock"},{tag:"span",class:"nowrap-title",text:t.String.format(n.get("Expired on: {0}"),this.options.expiration)}]}]),this},isPreview:function(){return this.model.get("isPreview")},destroy:function(){return this.container&&this.container.getElement(".tile-sub-container")&&this.container.getElement(".tile-sub-container").removeEvent("click"),this._dropDownMenu&&this._dropDownMenu.destroy(),this._parent()},_isActionElement:function(t){return t.getParent(".actions-inline-container")||t.hasClassName("actions-inline-container")}})}),define("DS/PlatformManagementStaging/Collection/DeployedStagingCollection",["UWA/Core","UWA/Class/Model","DS/i3DXCompassCore/Collection/i3DXCompassCollection"],function(t,e,n){"use strict";return n.extend({url:"",model:e,parse:function(t){return t.deployedCarts.filter(function(t){return"CANCELLED"!==t.currentState})}})}),define("DS/PlatformManagementStaging/Modal/CreateModal",["UWA/Core","UWA/Utils","UWA/Json","UWA/Class/View","DS/i3DXCompass/EventManager","DS/i3DXCompass/Data","DS/i3DXCompass/Tools","DS/UIKIT/Alert","DS/UIKIT/Modal","DS/UIKIT/Form","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassRegistryClient","DS/PlatformManagement/Controls/PlatformNotify","DS/PlatformAPI/PlatformAPI","i18n!DS/PlatformManagementStaging/assets/nls/PlatformManagementStaging"],function(t,e,n,i,o,a,l,s,r,c,g,d,u,m,f,p,h){"use strict";return i.extend({tagName:"div",className:"staging-create-modal",init:function(t){this._parent(t),this.deployUrl=t.deployUrl},setup:function(t){return this.options=t||{},t.platform&&(this.platform=t.platform),t.stagingCollection&&(this.stagingCollection=t.stagingCollection),t.currentUsageModel&&(this.currentUsageModel=t.currentUsageModel),this._parent(t)},launchStagingPlatform:function(e,n){var i=this,o={parentWATenant:i.platform.get("id"),isPreview:i.isPreview};this.dispatchEvent("onCreateClick"),u.authenticatedRequest(e.replace("/"+i.platform.get("id"),""),this.buildRequestOptions("POST",o,{patch:!0,onComplete:function(){f.success(h.get("Staging successfully created")),i.dispatchEvent("onCreateComplete"),i.dispatchEvent("onRefresh"),u.authenticatedRequest(n.url,i.buildRequestOptions("POST",i.platform.get("id"),{patch:!0,onComplete:function(){t.log("POST staging collection success")},onFailure:function(){t.log("POST staging collection failed")}}))},onFailure:function(){i.dispatchEvent("onDeleteFailure"),f.alert(h.get("Staging creation failed"))}}))},buildRequestOptions:function(t,e,n){return{method:t,type:"json",headers:{Accept:"application/json,text/javascript,*/*","Content-Type":"application/json","x-ds-csrftoken":this.options.csrf},data:e&&JSON.stringify({parentWATenant:e.parentWATenant,isPreview:e.isPreview}),onComplete:n.onComplete,onFailure:n.onFailure}},buildModal:function(){var e=this,n=new d({value:h.get("Create"),name:"create-button",className:"primary",events:{onClick:function(){e.launchStagingPlatform(e.deployUrl,e.stagingCollection),o.hide()}}}),i=new d({value:h.get("Cancel"),className:"default",events:{onClick:function(){o.hide()}}}),o=new r({closable:!0,visible:!0,events:{onHide:function(){o.destroy()}},header:t.String.format(h.get("Create Staging")),body:{html:[{tag:"div",class:"",styles:{"padding-right":"15px","padding-left":"15px","max-width":"80%"},html:[new c({fields:[{type:"select",className:"createSB-type-wrapper",label:h.get("Type"),helperText:h.get("A Staging PreProduction has the same level of code as a production environment."),options:this._buildSelectOptions(),events:{onChange:function(){var t=this.getValue()[0].toLowerCase();e._manageFields(t,this)}}}]})]}]},footer:[n,i]}).inject(document.body)},isRegularAvailable:function(){return this.stagingCollection.find(function(t){return"SGR"===t.get("name")})},isPreviewAvailable:function(){return this.stagingCollection.find(function(t){return"SGP"===t.get("name")})},_buildSelectOptions:function(){var t=[],e=this.stagingCollection.find(function(t){return"SGR"===t.get("name")}),n=this.stagingCollection.find(function(t){return"SGP"===t.get("name")}),i=this.currentUsageModel.get("data")[1],o=this.currentUsageModel.get("data")[2];return e||i.get("deployed")<i.get("count")?t.push({label:h.get("Staging PreProduction"),"data-id":"regular"}):e&&i.get("deployed")!==i.get("count")||t.push({label:h.get("Staging PreProduction (Not available)"),"data-id":"regular",disabled:!0}),n||o.get("deployed")<o.get("count")?t.push({label:h.get("Staging PreRelease"),"data-id":"preview"}):n&&o.get("deployed")!==o.get("count")||t.push({label:h.get("Staging PreRelease (Not available)"),"data-id":"preview",disabled:!0}),t},_manageFields:function(t){var e=document.body.getElement(".createSB-type-wrapper").getParent();switch(t){case"staging preproduction":case"staging preproduction (not available)":e.getElement(".form-control-helper-text").textContent=h.get("A Staging PreProduction has the same level of code as a production environment."),this.isPreview=!1;break;case"staging prerelease":e.getElement(".form-control-helper-text").textContent=h.get("A Staging PreRelease has an advanced level of code compared to a production environment."),this.isPreview=!0;break;case"staging prerelease (not available)":e.getElement(".form-control-helper-text").textContent=h.get("A Staging PreRelease has an advanced level of code compared to a production environment."),this.isPreview=!1}},render:function(){return this.container.setContent(this.buildModal()),this}})}),define("DS/PlatformManagementStaging/Modal/DeleteModal",["UWA/Core","UWA/Utils","UWA/Json","UWA/Class/View","DS/i3DXCompass/EventManager","DS/i3DXCompass/Data","DS/i3DXCompass/Tools","DS/UIKIT/Alert","DS/UIKIT/Modal","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassRegistryClient","DS/PlatformManagement/Controls/PlatformNotify","DS/PlatformAPI/PlatformAPI","i18n!DS/PlatformManagementStaging/assets/nls/PlatformManagementStaging"],function(t,e,n,i,o,a,l,s,r,c,g,d,u,m,f,p){"use strict";return i.extend({tagName:"div",className:"staging-delete-modal",init:function(t){this._parent(t),this.title=t.title},setup:function(t){return this.deleteStagingUrl="",this.options=t||{},t.model&&(this.model=t.model),t.platform&&(this.platform=t.platform),t.stagingCollection&&(this.stagingCollection=t.stagingCollection),this._parent(t)},deleteStagingEnv:function(){var e=this,n=this.model.get("Items")[0].OnlineInstance;this.dispatchEvent("onDeleteClick"),d.authenticatedRequest(this.collection.url.replace("/"+this.platform.get("id"),"/"+n),this.buildRequestOptions("DELETE","",{patch:!0,onComplete:function(){t.log("Staging tenant well deleted"),m.success(t.i18n("Staging successfully deleted")),e.dispatchEvent("onDeleteComplete"),e.dispatchEvent("onRefresh"),d.authenticatedRequest(e.stagingCollection.url,e.buildRequestOptions("DELETE"),e.platform.get("id"),{patch:!0,onComplete:function(){t.log("Delete informations to Myapps success")},onFailure:function(){t.log("Delete informations to Myapps failed")}})},onFailure:function(){e.dispatchEvent("onDeleteFailure"),t.log("Staging tenant deletion failed"),m.alert(t.i18n("Staging deletion failed"))}}))},buildRequestOptions:function(t,e,n){return{method:t,type:"json",headers:{Accept:"application/json,text/javascript,*/*","Content-Type":"application/json","x-ds-csrftoken":this.options.csrf},data:""!==e?e&&JSON.stringify({parentWATenant:e}):"",onComplete:n.onComplete,onFailure:n.onFailure}},buildModal:function(){var e=this,n=new g({value:p.get("Delete"),className:"error",events:{onClick:function(){e.deleteStagingEnv(),o.hide()}}}),i=new g({value:p.get("Cancel"),className:"default",events:{onClick:function(){o.hide()}}}),o=new r({closable:!0,visible:!0,events:{onHide:function(){o.destroy()}},header:t.String.format(p.get("Delete {0}"),e.title),body:{html:[{tag:"div",class:"",html:[{tag:"ul",styles:{padding:"0 0"},html:[{tag:"li",text:p.get("Deleting this environment is a permanent action.")},{tag:"li",text:p.get("You will no longer have access to it.")}]}]}]},footer:[n,i]}).inject(document.body)},render:function(){return this.container.setContent(this.buildModal()),this}})}),define("DS/PlatformManagementStaging/View/TileAddView",["UWA/Core","DS/W3DXComponents/Views/Item/TileView"],function(t,e){"use strict";return e.extend({tagName:"div",name:"add-staging-tile",render:function(){return this.container.addClassName("grid add-container"),this._parent(),this.container.getElement(".add-staging-tile-header").setContent({tag:"i",class:"tile-header-icon "+this.model.get("fonticon")}),this.container.getElement(".add-staging-tile-body").removeClassName("tile-body").setContent({tag:"div",class:"add-tile-title",text:this.model.get("title")}),this.container.addEvent("click",this.model.get("action")),!0===this.model.get("disabled")?this.container.getElement(".add-staging-tile-sub-container").addClassName("disabled"):!1===this.model.get("disabled")&&this.container.hasClassName("disabled")&&this.container.removeClassName("disabled"),this}})}),define("DS/PlatformManagementStaging/View/CurrentUsageView",["UWA/Core","UWA/Class/View","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/PlatformAPI/PlatformAPI","DS/PlatformManagement/Utils","DS/PlatformManagement/Utils/Data","DS/WAFData/WAFData","DS/i3DXCompassCore/Collection/i3DXCompassCollection","DS/PlatformManagementStaging/Collection/DeployedStagingCollection","DS/i3DXCompassPlatformServices/i3DXCompassRegistryClient","i18n!DS/PlatformManagementStaging/assets/nls/PlatformManagementStaging"],function(t,e,n,i,o,a,l,s,r,c,g,d){"use strict";return e.extend({setup:function(e){this.container=t.createElement("div",{class:"staging-box"}),this.options=e||{},e.platform&&(this.platform=e.platform,this.collection=e.collection,this.widget=e.widget)},render:function(){return this.container.setContent(this._createTemplate()),this},_createTemplate:function(){return{class:"content-current-usage",html:{tag:"content",html:[this._buildTitle(),this._buildBlocks()]}}},_buildTitle:function(){return{tag:"h3",html:[{tag:"i",class:"fonticon fonticon-computer-connected",styles:{color:"#77797C","margin-top":"30px"}},{tag:"span",text:t.i18n("Current Usage")}]}},_buildBlocks:function(){var e=this,n=[],i=this.model.get("data"),o=!1;return i.forEach(function(t){parseInt(t.get("count"),10)>=999&&(o=!0)}),i.forEach(function(i){var a=i.get("title"),l=t.createElement("div",{class:"stat"+(i.get("warn")?" warn":"")+(i.get("hidden")?" hidden":"")+(o?" small":""),styles:{width:"50%"},html:[{class:"count"+(i.get("color")?" light":"")+(i.get("warn")?" warn":""),text:e._formatNumber(e.getCount(i))},{class:"title",text:a}]});n.push(l)}),{class:"blocks",html:n}},getCount:function(t){var e=0,n=this.collection._models;return"deploy"===t.get("type")?e=this.collection.length:"regular"===t.get("type")?n.forEach(function(t){!1===t.get("isPreview")&&(e+=1)}):"preview"===t.get("type")&&n.forEach(function(t){!0===t.get("isPreview")&&(e+=1)}),t.set("deployed",e),e+"/"+t.get("count")},_formatNumber:function(t){return t||(t=0),t.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}})}),define("DS/PlatformManagementStaging/PlatformManagementStaging",["UWA/Core","UWA/Class/View","UWA/Class/Model","DS/PlatformManagementStaging/View/CurrentUsageView","DS/PlatformManagementStaging/View/AvailableStagingView","DS/PlatformManagementStaging/Collection/DeployedStagingCollection","DS/PlatformManagementStaging/Collection/StagingCollection","DS/UIKIT/Input/Button","DS/i3DXCompassCore/Model/i3DXCompassModel","DS/i3DXCompassCore/CacheManager","DS/UIKIT/Mask","DS/PlatformManagement/Utils","DS/i3DXCompassPlatformServices/i3DXCompassRegistryClient","DS/i3DXCompassServices/i3DXCompassServices","DS/PlatformAPI/PlatformAPI","i18n!DS/PlatformManagementStaging/assets/nls/PlatformManagementStaging"],function(t,e,n,i,o,a,l,s,r,c,g,d,u,m,f,p){"use strict";return e.extend({tagName:"div",className:"body-wrap",collection:new a,stagingCollection:new l,publicMarketplaceUrl:null,setup:function(e){var n=this._parent(e),i=this;return g.mask(i.container),u.getAllServicesAllPlatforms({config:{url:f.getApplicationConfiguration("app.urls.registry")}}).then(function(t){if(1===t.length){var n=t[0].services.find(function(t){return"MPDataMgt"===t.id});n&&(i.marketPlaceService={id:t[0].id,url:n.url})}else t.forEach(function(t,e){t.services.forEach(function(e,n){"MPDataMgt"!==e.id||i.marketPlaceService||(i.marketPlaceService={id:t.id,url:e.url})})});i.render(e)},function(e){t.log(e)}),n},_countByType:function(t){var e=this.stagingCollection.find(function(e){return e.get("name")===t});return e?e.get("count"):0},_countTotal:function(){var t=0;return this.stagingCollection.forEach(function(e){t+=e.get("count")}),t},render:function(t){var e=this;if(t&&void 0!==this.publicMarketplaceUrl){var a=function(){var a=e._countTotal(),l=e._countByType("SGR"),s=e._countByType("SGP"),r=new n({title:p.get("Current Usage"),icon:"fonticon fonticon-computer-connected",data:[new n({title:p.get("Staging Deployed"),count:a,type:"deploy"}),new n({title:p.get("Staging PreProduction"),count:l,type:"regular",color:"light"}),new n({title:p.get("Staging PreRelease"),count:s,type:"preview",color:"light"}),new n({title:p.get("User Access"),count:0,warn:!0,hidden:!0})]});console.log("GET staging collection success"),e.container.setContent({tag:"ul",class:"introduction",styles:{"list-style":"none",padding:"0","font-size":"12px","z-index":"1",position:"relative"},html:[{tag:"li",text:p.get("The 3DEXPERIENCE platform enables you to create staging environments and carry out your tests.")}]},{tag:"div",class:"staging-container",html:[new i({platform:t.platform,collection:e.collection,model:r,widget:t.widget}).render(),new o({platform:t.platform,collection:e.collection,currentUsageModel:r,widget:t.widget,stagingCollection:e.stagingCollection,expiration:e.stagingCollection._models[0].get("expire"),sandboxTotal:a}).render()]})};-1===e.stagingCollection.url.indexOf(t.platform.get("id"))&&(e.stagingCollection.url=e.stagingCollection.url+t.platform.get("id")),this.collection.url=e.marketPlaceService.url+"/resources/api/v2/staging/platforms/"+t.platform.get("id")+"?tenant="+e.marketPlaceService.id,e.stagingCollection.fetch({onComplete:function(){e.collection.fetch({onComplete:a,onFailure:a}),g.unmask(e.container)},onFailure:function(t,n){4===n.code?e.container.setContent({tag:"span",text:p.get("You don't have access to this widget")}):e.collection.fetch({onComplete:a,onFailure:a}),g.unmask(e.container)}})}}})}),define("DS/PlatformManagementStaging/Widgets/PlatformManagementStagingWdg",["UWA/Core","UWA/Class","DS/UIKIT/Mask","DS/i3DXCompassCore/RequestOptions","DS/PlatformManagementComponents/Collection/Platform","DS/i3DXCompassCore/Model/PlatformModel","DS/PlatformManagement/Utils","DS/W3DXComponents/Views/Layout/ScrollView","DS/PlatformManagementStaging/PlatformManagementStaging","DS/PlatformManagement/Model/I18nModel","DS/PlatformAPI/PlatformAPI","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","i18n!DS/PlatformManagementStaging/assets/nls/PlatformManagementStaging","css!DS/PlatformManagementStaging/PlatformManagementStaging","css!DS/PlatformManagement/PlatformManagement"],function(t,e,n,i,o,a,l,s,r,c,g,d,u){"use strict";return e.extend({widget:null,init:function(t){this.widget=t.widget,this.platform=t.platform,i.setupLanguage(this.widget.lang),l.setWidget(this.widget),this._initWidgetEvents()},_initWidgetEvents:function(){this.widget.addEvents({onLoad:this._onBeforeLoad.bind(this),onRefresh:this._onBeforeLoad.bind(this)})},_onBeforeLoad:function(){var t=this;"en"!==this.widget.lang?(new c).fetch({onComplete:function(e,n){u.get(n),t._initWidgetPreferences()},onFailure:function(){t._initWidgetPreferences()}}):t._initWidgetPreferences()},_initWidgetPreferences:function(){var t=this,e=t.widget;n.mask(e.body),this.collection=new o({includeWu:!1,lang:this.widget.lang}),d.getUser({onComplete:function(e){var n=e.platforms;n&&n.length>0&&(n=n.filter(function(t){return"admin"===t.role})),d.getPlatformServices({onComplete:function(e){var i=[];n.forEach(function(t){var n=e.detect(function(e){return e.platformId===t.id});n&&i.push({id:n.platformId,displayName:n.displayName})}),t.collection.set(i),t._getCurrentPlatform().fetch({data:{id:t._getCurrentPlatform().get("id")},onComplete:function(e,n){var i=t.collection.get(t._getCurrentPlatform().get("id"));i&&i.set(n),t._onLoad()}})}})}}),n.unmask(e.body)},_getCurrentPlatform:function(){var t,e=this.widget.getValue("x3dPlatformId");return e&&""!==e&&(t=this.collection.get(e)),this.platform||(this.platform=new a(t?t.toJSON():this.collection.first().toJSON())),this.platform},_onLoad:function(){this.widget.id;var e=this.widget.body,n=this._getCurrentPlatform();this.widget.setTitle(""),l.setCurrentPlatform(this._getCurrentPlatform()),e.setContent(t.createElement("div",{class:"getting-started",html:new s({useInfiniteScroll:!1,usePullToRefresh:!1,view:new r({widget:this.widget,platformCollection:this.collection,platform:n})}).render()}))}})}),define("DS/PlatformManagementStaging/View/AvailableStagingView",["UWA/Core","UWA/Class/View","UWA/Class/Model","DS/PlatformAPI/PlatformAPI","DS/UIKIT/Tooltip","DS/UIKIT/Mask","DS/UIKIT/DropdownMenu","DS/PlatformManagementStaging/View/StagingTileView","DS/PlatformManagementStaging/PlatformManagementStaging","DS/W3DXComponents/Collections/ActionsCollection","DS/PlatformManagementStaging/Collection/StagingCollection","i18n!DS/PlatformManagementStaging/assets/nls/PlatformManagementStaging","DS/PlatformManagement/Utils","DS/PlatformManagementStaging/View/TileAddView","DS/W3DXComponents/Views/Item/TileView","DS/PlatformManagementStaging/Modal/CreateModal","DS/PlatformManagementStaging/Modal/DeleteModal","DS/i3DXCompassPlatformServices/i3DXCompassRegistryClient","DS/PlatformManagement/Controls/PlatformNotify","DS/PlatformManagement/Utils/Data","DS/WAFData/WAFData"],function(t,e,n,i,o,a,l,s,r,c,g,d,u,m,f,p,h,S,C,D,P){"use strict";return e.extend({tagName:"div",className:"content-wrapper",setup:function(t){t.platform&&(this.platform=t.platform,this.expiration=t.expiration,this.sandboxTotal=t.sandboxTotal,this.widget=t.widget),this.stagingCollection=t.stagingCollection,this.currentUsageModel=t.currentUsageModel,this.getPersistedData()},render:function(){return this.container.setContent(this._createTemplate()),this},_createTemplate:function(){return[this._buildTitle(),this._buildTiles()]},_buildTitle:function(){return{tag:"h3",html:[{tag:"i",class:"fonticon fonticon-list ",styles:{color:"#77797C","margin-top":"50px"}},{tag:"span",text:d.get("Staging List")}]}},getPersistedData:function(){var t=this,e=function(){t.collection.length>0?t.container.setContent(t._createTemplate()):(t.collection.length,t.container.setContent(t._createTemplate()))};this.collection.fetch({onComplete:e,onFailure:e})},buildAddTile:function(){var t=this;return new m({lazyLoading:!1,model:new n({fonticon:"fonticon fonticon-computer-add",disabled:!(!t.sandboxTotal===t.collection.length||t.collection.length<t.sandboxTotal),title:d.get("Create Staging"),action:function(){(!t.sandboxTotal===t.collection.length||t.collection.length<t.sandboxTotal)&&t.openCreateModal(t.collection.url,t.stagingCollection)}})}).render()},openCreateModal:function(t,e){var n=this,i=this.widget.body;new p({platform:n.platform,collection:this.collection,stagingCollection:e,currentUsageModel:n.currentUsageModel,deployUrl:t,events:{onCreateClick:function(){a.mask(i)},onCreateComplete:function(){a.unmask(i)},onCreateFailure:function(){a.unmask(i)},onRefresh:function(){n.widget.dispatchEvent("onRefresh")}}}).render()},_buildTiles:function(){var t,e=[],n=this,i=this.collection._models.sort().reverse();return e.push(n.buildAddTile()),0!==i.length&&i.forEach(function(i,o){i.actions=null,t=n.buildTile(i,o),e.push(t)}),e},buildTile:function(t,e){var n=this,i=this.isDeployed(t);i&&(t.actions=new c({id:"open",icon:"fonticon fonticon-open-down"}));var o=new s({lazyLoading:!1,expiration:t.get("Items")[0].EndDate,model:t,fonticon:i?"fonticon fonticon-status-ok":"fonticon fonticon-status-ok-ongoing",mapping:{title:function(){return i?"STAGING "+t.get("Items")[0].OnlineInstance:"STAGING "+(e+1)+" "+d.get("(pending)")}},onSelect:n.options.onSelect,events:{onActionClick:function(e,a,s){var r=[];i&&(r.push({text:d.get("Delete"),fonticon:"trash",selectable:!0,action:"select-delete"}),s.stopPropagation(),o._dropDownMenu||(o._dropDownMenu=new l({target:this.getElement(".fonticon-open-down"),position:"bottom right",renderTo:document.querySelector(".content-wrapper"),items:r,events:{onClick:function(e,i){"select-open"===i.action?n.goToMyPlatform(t):"select-delete"===i.action&&n.openDeleteModal(t,n.platform,n.stagingCollection,o.getElement(".tile-title").getText())}}}).show()))}}});return o.render()},isDeployed:function(t){return"DELIVERED"===t.get("currentState")},isDeleted:function(t){return"CANCELLED"===t.get("currentState")},goToMyPlatform:function(e){S.getServicesByPlatform({platforms:[e.get("Items")[0].OnlineInstance],services:["3DDASHBOARD"],config:{url:i.getApplicationConfiguration("app.urls.registry")}}).then(function(t){var e="";t&&t[0]&&t[0].services[0]&&(e=t[0].services[0].url),window.open(e+"/#dashboard:e88a79f9-b86c-449d-b438-dca5445d4a9b/tab:MyPlatform","_blank")},function(e){t.log(e)})},openDeleteModal:function(e,n,i,o){var l=this,s=this.widget.body;t.log("Delete modal should open"),new h({model:e,platform:n,collection:this.collection,stagingCollection:i,title:o,events:{onDeleteClick:function(){a.mask(s)},onDeleteComplete:function(){a.unmask(s)},onDeleteFailure:function(){a.unmask(s)},onRefresh:function(){l.widget.dispatchEvent("onRefresh")}}}).render()}})});