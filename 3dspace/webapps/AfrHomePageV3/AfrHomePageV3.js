define("DS/AfrHomePageV3/AfrHomePage",["DS/Controls/Button","i18n!DS/AfrHomePageV3/assets/nls/afr-home-page","css!DS/Core/wux.css","css!DS/AfrHomePageV3/afr-home-page-v3.css","css!DS/Core/wux-3ds-fonticons.css"],function(e,t){"use strict";function i(e,t,...i){let s=null;s="function"==typeof e?new e:document.createElement(e);for(const e in t){const i=t[e];if("function"==typeof i){const t=e.replace(/-([a-z])/g,e=>e[1].toUpperCase());s[t]=i}else s.setAttribute(e,i)}return i.forEach(e=>{null!==e&&null!=e&&("string"==typeof e?s.appendChild(document.createTextNode(e)):s.appendChild(e))}),s}function s(e,t){if(!(e&&e.title&&e.id&&e.icon))throw new Error("Missing parameter(s)");const s=i("button",{class:"afr-home-page-guidance-button"},i("i",{class:`wux-ui-3ds-${e.icon} wux-ui-3ds`}),e.title),r=e.controller.onAction.bind(e.controller,t);return s.addEventListener("click",r),[s,"click",r]}function r(e,t){if(!(e&&e.title&&e.icon&&e.id))throw new Error("Missing parameter(s)");let s=i("button",{class:"afr-home-page-navigation-button"},i("i",{class:`wux-ui-3ds-${e.icon?e.icon:"collection"} wux-ui-3ds`}),i("span",{class:"afr-home-page-navigation-button-label"},e.title)),r=()=>e.controller.isSelected()?t._unselectCollection(e.id):t._selectCollection(e.id);return s.addEventListener("click",r),[s,"click",r]}function a(t,i){let s={label:t.title,showLabelFlag:!0,emphasize:t.emphasize?t.emphasize:"secondary",icon:{iconName:t.icon,fontIconFamily:WUXManagedFontIcons.Font3DS},touchMode:!0},r=new e(s),a=t.controller.onAction.bind(t.controller,i),n="buttonclick";return r.addEventListener(n,a),[r.getContent(),n,a]}function n(e){return[i("li",null,i("a",{href:e.url,target:"_blank"},i("i",{class:`wux-ui-3ds-${e.icon} wux-ui-3ds`}),e.title))]}const o={CATIA:"blue",GEOVIA:"blue",SIMULIA:"blue",DELMIA:"yellow",SOLIDWORKS:"red",BIOVIA:"green",MEDIDATA:"green",ENOVIA:"orange",NETVIBES:"orange","3DEXCITE":"black","3DVIA":"black","CENTRIC PLM":"black",GENERIC:"default",TST_BRAND:"pink"};function l(e){if(e&&e.size>0&&e){for(let[t,i]of e)i.event&&i.view.removeEventListener(i.event,i.callback),i.view.parentNode&&i.view.parentNode.removeChild(i.view),i.controller&&i.controller.destroy(),i.view.dsModel&&i.view.dsModel.destroy(),i.view=null,i.callback=null,i.event=null;e.clear()}}Object.freeze(o);class c{constructor(e){if(this._private=Object.create(null),e.touchStrategy)throw new Error("DEPRECATED USE");this._buildView(e),this._setDragAndDropController(e.dragAndDropController)}getDOM(){let e=null;return this._private.views&&this._private.views.container&&(e=this._private.views.container),e}show(){this.getDOM().classList.remove("afr-home-page-hidden")}hide(){this.getDOM().classList.add("afr-home-page-hidden")}isVisible(){return!this.getDOM().classList.contains("afr-home-page-hidden")}_setApplicationIcon(e){const t=this._private.views.applicationIcon;t.style.backgroundImage=e?`url(${e})`:""}_setGuidance(e){return this._setViewMap("guidance",e,s,this)}setCollections(e){return this._setViewMap("collections",e,r,this)}hasCollection(e){return Boolean(this._private.collections&&this._private.collections.get(e))}addCollection(e,t){if(!e)throw new Error("Invalid parameter",e);const i=this._private.collections;i&&0!==i.size?this._addViewMapItem("collections",e,r,t,this):this.setCollections([e])}_unselectCollection(){let e=Promise.resolve();if(this._private.selectedCollection){let t=this._private.collections.get(this._private.selectedCollection);t&&(e=t.controller.onUnselect().then(()=>{t.view.removeAttribute("checked"),this._private.selectedCollection=null,this._setCustomContent(null);const e=this.getDOM();e.classList.remove("afr-home-page-navigate"),e.classList.remove("afr-home-page-side-panel-collapsed")},e=>{console.error("Impossible to unselect the collection",e)}))}return e}_selectCollection(e){return this._unselectCollection().then(()=>{if(e){let t=this._private.collections.get(e);if(t)return t.controller.onSelect().then(i=>{if(!i)throw new Error("onSelect must return a HTMLElement");t.view.setAttribute("checked",""),this._private.selectedCollection=e,this._setCustomContent(i),this.getDOM().classList.add("afr-home-page-navigate")});console.error("collection not found",e)}})}_setCustomContent(e){const t=this._private.views.content,i=this._private.views.customContent;if(e){if(i.children&&i.children.length>0)throw new Error("The previous custom content was not removed from the DOM");i.appendChild(e),t.classList.remove("afr-home-page-custom-content-hidden")}else t.classList.add("afr-home-page-custom-content-hidden"),i.innerHTML=""}setCommands(e){return this._setViewMap("commands",e,a,this)}hasCommand(e){return Boolean(this._private.commands&&this._private.commands.get(e))}addCommand(e,t){if(!e)throw new Error("Invalid parameter",e);const i=this._private.commands;i&&0!==i.size?this._addViewMapItem("commands",e,a,t,this):this.setCommands([e])}_setLinks(e){if(e&&(!Array.isArray(e)||e.length>2))throw new Error("links must be an array and must contain a maximum of 2 array");const t=e&&e.length?e.length:0;t>0?(this._private.views.linksC1.classList.remove("afr-home-page-side-panel-links-hidden"),t>1?this._private.views.linksC2.classList.remove("afr-home-page-side-panel-links-hidden"):this._private.views.linksC2.classList.add("afr-home-page-side-panel-links-hidden")):(this._private.views.linksC1.classList.add("afr-home-page-side-panel-links-hidden"),this._private.views.linksC2.classList.add("afr-home-page-side-panel-links-hidden"));const i=t>0?e[0]:null,s=t>1?e[1]:null;this._setViewMap("linksC1",i,n),this._setViewMap("linksC2",s,n)}_setViewMap(e,t,i,s){let r=this._private[e];if(l(r),t){if(!Array.isArray(t))throw new Error("items must be an array.");if(t.length>0){if(!this._private.views[e])throw new Error(`Impossible to retrieve the ${r} view.`);const a=this._private.views[e];r||(r=new Map,this._private[e]=r);for(const e of t){if(!e.id)throw new Error("Missing identifier for item",e);if(r.has(e.id))throw new Error("Identifier already used for item.",e.id);let[t,n,o]=i(e,s);r.set(e.id,{view:t,event:n,controller:e.controller,callback:o}),a.appendChild(t)}}}}_addViewMapItem(e,t,i,s,r){const a=this._private[e],n=this._private.views[e];if(!t.id)throw new Error("Missing identifier for item",t);if(a.has(t.id))throw new Error("Identifier already used for item.",t.id);let[o,l,c]=i(t,r);if(a.set(t.id,{view:o,event:l,controller:t.controller,callback:c}),s&&"last"!==s.anchor)if("first"===s.anchor)n.firstElementChild?n.insertBefore(o,n.firstElementChild):n.appendChild(o);else{const e=a.get(s.reference);if(!e)throw new Error("reference not found",s.reference);if("before"===s.anchor)n.insertBefore(o,e.view);else{if("after"!==s.anchor)throw new Error("Wrong parameter anchor",s.anchor);n.insertBefore(o,e.view.nextSibling)}}else n.appendChild(o)}_buildView(e){this._private.views=Object.create(null);let s="NLS_DropMessage",r="NLS_NoContent",a="NLS_DnDPlaceholder";s=t.get(s)||s,r=t.get(r)||r,a=t.get(a)||a;const n=i("div",{class:`afr-home-page-v3 afr-home-page-container${e.background?" afr-home-page-container-background":""}`,style:`background-image: url(${e.background?e.background:""})`},i("button",{class:"afr-home-page-side-panel-show-button"}),i("button",{class:"afr-home-page-side-panel-back-button"}),i("aside",{class:"afr-home-page-side-panel"},i("button",{class:"afr-home-page-side-panel-hide-button"}),i("div",{class:"afr-home-page-side-panel-content"},i("header",{class:"afr-home-page-header"},i("div",{class:`afr-home-page-application-icon afr-home-page-application-icon-${function(e){let t=o.GENERIC,i=e.toUpperCase();return Object.hasOwn(o,i)&&(t=o[i]),t}(e.brand)}`}),i("h1",{class:"afr-home-page-title"},e.title),i("h2",{class:"afr-home-page-subtitle"},e.subtitle)),i("div",{class:"afr-home-page-side-panel-guidance"},i("menu",{class:"afr-home-page-side-panel-guidance-menu"})),i("nav",{class:"afr-home-page-side-panel-navigation"}),i("menu",{class:"afr-home-page-side-panel-menu"}),i("footer",{class:"afr-home-page-side-panel-footer"},i("span",{class:"afr-home-page-side-panel-drop-message"},s),i("nav",{class:"afr-home-page-side-panel-footer-navigation"},i("ol",{class:"afr-home-page-side-panel-links afr-home-page-side-panel-links-hidden"}),i("ol",{class:"afr-home-page-side-panel-links afr-home-page-side-panel-links-hidden"}))))),i("section",{class:"afr-home-page-content afr-home-page-custom-content-hidden"},i("article",{class:"afr-home-page-content-placeholder"},i("i",{class:"afr-home-page-content-placeholder-icon"}),i("span",null,r),i("span",null,a)),i("article",{class:"afr-home-page-custom-content"})),i("div",{class:"afr-home-page-overlay"}));this._private.views.container=n,this._private.buttons=new Map;const l={view:n.getElementsByClassName("afr-home-page-side-panel-hide-button")[0],event:"click",callback:()=>{n.classList.add("afr-home-page-side-panel-collapsed")}};l.view.addEventListener(l.event,l.callback),this._private.buttons.set("collapse",l);const c={view:n.getElementsByClassName("afr-home-page-side-panel-show-button")[0],event:"click",callback:()=>{n.classList.remove("afr-home-page-side-panel-collapsed")}};c.view.addEventListener(c.event,c.callback),this._private.buttons.set("expand",c);const d={view:n.getElementsByClassName("afr-home-page-side-panel-back-button")[0],event:"click",callback:()=>{this._unselectCollection(),n.classList.remove("afr-home-page-side-panel-collapsed")}};d.view.addEventListener(d.event,d.callback),this._private.buttons.set("back",d),this._private.views.applicationIcon=n.getElementsByClassName("afr-home-page-application-icon")[0],this._setApplicationIcon(e.icon),this._private.views.guidance=n.getElementsByClassName("afr-home-page-side-panel-guidance-menu")[0],this._setGuidance(e.guidance),this._private.views.collections=n.getElementsByClassName("afr-home-page-side-panel-navigation")[0],this.setCollections(e.collections),this._private.selectedCollection=null,this._private.views.content=n.getElementsByClassName("afr-home-page-content")[0],this._private.views.customContent=n.getElementsByClassName("afr-home-page-custom-content")[0],this._private.views.commands=n.getElementsByClassName("afr-home-page-side-panel-menu")[0],this.setCommands(e.commands),this._private.views.dragAndDropMessage=n.getElementsByClassName("afr-home-page-side-panel-drop-message")[0],this._private.views.links=n.getElementsByClassName("afr-home-page-side-panel-footer-navigation")[0],this._private.views.linksC1=this._private.views.links.firstElementChild,this._private.views.linksC2=this._private.views.links.lastElementChild,this._setLinks(e.links);const h=n.getElementsByClassName("afr-home-page-overlay")[0];this._private.views.overlay=h}_setDragAndDropController(e){const t=this._getOverlay();if(this._private.dragAndDrop){let e=this._private.dragAndDrop.subscriptions;for(const t of e)t.view.removeEventListener(t.event,t.cb);e.splice(0,e.length),this._private.dragAndDrop.controller&&this._private.dragAndDrop.controller.hasOverlay(t.firstChild)&&this.hideOverlay(),this._private.dragAndDrop.hideOverlayTimeout&&(clearTimeout(this._private.dragAndDrop.hideOverlayTimeout),this._private.dragAndDrop.hideOverlayTimeout=null)}else this._private.dragAndDrop=Object.create(null),this._private.dragAndDrop.controller=null,this._private.dragAndDrop.subscriptions=[],this._private.dragAndDrop.hideOverlayTimeout=null;const i=this._private.dragAndDrop.subscriptions,s=this.getDOM();if(e){this._private.views.dragAndDropMessage.classList.remove("afr-home-page-side-panel-drop-message-hidden");{const t={event:"dragenter",view:s,cb:t=>{this.hasOverlay()||e.onDragEnter(t).then(e=>{this.showOverlay(e)})}};t.view.addEventListener(t.event,t.cb),i.push(t)}{const r={event:"dragleave",view:s,cb:()=>{this._private.dragAndDrop.hideOverlayTimeout=setTimeout(()=>{e.hasOverlay(t.firstChild)&&this.hideOverlay()},300)}};r.view.addEventListener(r.event,r.cb),i.push(r)}{const e={event:"dragover",view:s,cb:e=>{e.stopPropagation(),e.preventDefault(),clearTimeout(this._private.dragAndDrop.hideOverlayTimeout),this._private.dragAndDrop.hideOverlayTimeout=null}};e.view.addEventListener(e.event,e.cb),i.push(e)}{const t={event:"drop",view:s,cb:t=>{if(t.stopPropagation(),t.preventDefault(),this.hasOverlay()){const i=this._getOverlay();e.hasOverlay(i.firstChild)&&e.onDrop(t).then(()=>{this.hideOverlay()})}}};t.view.addEventListener(t.event,t.cb),i.push(t)}}else this._private.views.dragAndDropMessage.classList.add("afr-home-page-side-panel-drop-message-hidden")}showOverlay(e){if(!e)throw new Error("No content to display in the overlay");this._private.views.overlay.appendChild(e),this.getDOM().classList.add("afr-home-page-overlay-show")}hideOverlay(){this.getDOM().classList.remove("afr-home-page-overlay-show");const e=this._getOverlay();let t=null;return e.hasChildNodes()&&(t=e.firstChild,e.removeChild(t)),t}hasOverlay(){return this.getDOM().classList.contains("afr-home-page-overlay-show")}_getOverlay(){return this._private.views.overlay}destroy(){const e=this._private.views.container;e.parentNode&&e.parentNode.removeChild(e),this._setDragAndDropController(null),delete this._private.dragAndDrop,l(this._private.buttons),this._setGuidance(null),delete this._private.guidance,this.setCollections(null),delete this._private.collections,this.setCommands(null),delete this._private.commands,delete this._private.views.dragAndDropMessage,this._setLinks(null),delete this._private.linksC1,delete this._private.linksC2,this.hideOverlay(),delete this._private.views.overlay,delete this._private.views.customContent,delete this._private.views.container}}return c.RSC={I_Overview:"eye-windowed",I_GuidedTour:"touch",I_WhatsNew:"megaphone",I_UserAssistance:"i-question",I_Training:"graduation-cap",I_Tutorial:"video",I_UserCommunity:"topbar-users",get:function(e){return this[e]}},c.NLS=t,c}),define("DS/AfrHomePageV3/mod_AfrHomePageControllers",[],function(){"use strict";class e{constructor(e){if(!e||!e.onDragEnter||!e.onDrop)throw new Error("Missing parameters");this._private=Object.create(null),this._private.overlays=Object.create(null),this._private.onDragEnter=e.onDragEnter,this._private.onDrop=e.onDrop,e.destroy&&(this._private.destroy=e.destroy)}get onDragEnter(){return e=>{if(!this._private.onDragEnter)throw new Error("No onDragEnter callback registered in HomePageDragAndDropController");return Promise.resolve(this._private.onDragEnter.call(this,e)).then(e=>{let t=null;return e?(this._private.overlays.authorized||((t=document.createElement("div")).setAttribute("class","afr-home-page-overlay-dnd afr-home-page-overlay-dnd-authorized"),this._private.overlays.authorized=t),t=this._private.overlays.authorized):(this._private.overlays.forbidden||((t=document.createElement("div")).setAttribute("class","afr-home-page-overlay-dnd afr-home-page-overlay-dnd-forbidden"),this._private.overlays.forbidden=t),t=this._private.overlays.forbidden),t})}}get onDrop(){return e=>{if(!this._private.onDrop)throw new Error("No onDrop callback registered in HomePageDragAndDropController");return Promise.resolve(this._private.onDrop.call(this,e))}}hasOverlay(e){return Boolean(e===this._private.overlays.authorized||e===this._private.overlays.forbidden)}destroy(){this._private.destroy&&this._private.destroy.call(this)}}return e.OverlayTypes={forbidden:0,authorized:1},{HomePageButtonController:class{constructor(e){if(!e||!e.onAction)throw new Error("Missing parameters");this._private=Object.create(null),this._private.onAction=e.onAction,e.destroy&&(this._private.destroy=e.destroy)}get onAction(){return e=>Promise.resolve(this._private.onAction.call(this,e))}destroy(){this._private.destroy&&this._private.destroy.call(this)}},HomePageCollectionController:class{constructor(e){if(!e||!e.onSelect||!e.onUnselect)throw new Error("Missing parameters");this._private=Object.create(null),this._private.isSelected=!1,this._private.onSelect=e.onSelect,this._private.onUnselect=e.onUnselect,e.destroy&&(this._private.destroy=e.destroy)}isSelected(){return this._private.isSelected}get onSelect(){return e=>(this._private.isSelected=!0,Promise.resolve(this._private.onSelect.call(this,e)))}get onUnselect(){return e=>(this._private.isSelected=!1,Promise.resolve(this._private.onUnselect.call(this,e)))}destroy(){this._private.destroy&&this._private.destroy.call(this)}},HomePageDragAndDropController:e}});