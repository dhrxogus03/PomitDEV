define("DS/DELPPWMfgStructureModule/CreateMBOMStatusUI",["UWA/Core"],function(e){"use strict";return function(t,n,i){const o=[{text:i.getNLSValue("CreateMBOMStatusUI.Column.Action"),description:i.getNLSValue("CreateMBOMStatusUI.Column.Action"),dataIndex:"tree",width:"9.5%"},{text:i.getNLSValue("CreateMBOMStatusUI.Column.Details"),description:i.getNLSValue("CreateMBOMStatusUI.Column.Details"),dataIndex:"details",width:"35%"},{text:i.getNLSValue("CreateMBOMStatusUI.Column.Owner"),description:i.getNLSValue("CreateMBOMStatusUI.Column.Owner"),dataIndex:"owner",width:"5%"},{text:i.getNLSValue("CreateMBOMStatusUI.Column.Started"),description:i.getNLSValue("CreateMBOMStatusUI.Column.Started"),dataIndex:"started",width:"13.5%"},{text:i.getNLSValue("CreateMBOMStatusUI.Column.Ended"),description:i.getNLSValue("CreateMBOMStatusUI.Column.Ended"),dataIndex:"ended",width:"13.5%"},{text:i.getNLSValue("CreateMBOMStatusUI.Column.Status"),description:i.getNLSValue("CreateMBOMStatusUI.Column.Status"),dataIndex:"status",width:"8%"},{text:i.getNLSValue("CreateMBOMStatusUI.Column.MoreDetails"),description:i.getNLSValue("CreateMBOMStatusUI.Column.MoreDetails"),dataIndex:"moreDetails",width:"15%"}];let a,r,s;const l=function(t){if(-1===t.columnID)return this.getCellDefaultTooltip(t);let n="";const{dataIndex:i,description:o}=this.getColumnOrGroup(t.columnID);if(-1===t.rowID)return e.is(o)&&(n=o),{longHelp:n};const a=t.nodeModel,r="tree"===i?a.getLabel():a.getAttributeValue(i);if(e.is(r))switch(i){case"tree":case"details":case"owner":case"started":case"ended":case"status":case"moreDetails":n=r}return{longHelp:n}},u=function(e,t){const o=n.getComponent("TreeNodeModel"),a=t.map(e=>{let t;if(e.details.startsWith("{")){const n=JSON.parse(e.details),{rootMfgTitle:i,rootPrdTitle:o}=n;t="Scoped Mfg Item: "+i+", Scoped Product: "+o}else t=e.details;return new o({label:i.getNLSValue(`CreateMBOMStatusUI.Action.${e.action}`),grid:{details:t,owner:e.owner,started:e.started,ended:e.ended,status:i.getNLSValue(`CreateMBOMStatusUI.Status.${e.status}`),moreDetails:e.moreDetails}})});e.withTransactionUpdate(()=>{a.forEach(t=>e.addRoot(t))})};return{display:function(d){s=d;const m=d();e.is(m.then,"function")&&m.then(d=>{let m=e.createElement("div",{class:"CreateMBOMStatus-content-container"});const{panel:c,treeDocument:g}=function(r){const d=n.getComponent("WUXFrameWindowsManager").getFrameWindow(t.getAppContext()).getImmersiveFrame(),m=n.getComponent("Button");let c=e.createElement("div");c.className="cm-status-header",c.setAttribute("id","cm-status-header"),c.setStyles({left:"10px",position:"relative",width:"fit-content"});let g=e.createElement("div");g.className="header-base",g.setStyles({display:"flex","align-items":"center",height:"25px"});const p=new m({domId:"RefreshButton",label:i.getNLSValue("CreateMBOMStatusUI.RefreshAll"),onClick:()=>{e.is(s,"function")&&(p.disabled=!0,s().then(t=>{e.is(a)&&(a.empty(),u(a,t)),p.disabled=!1}).catch(e=>{p.disabled=!1}))}});p.inject(g),c.setContent(g);const I=n.create("Panel",{header:c,title:i.getNLSValue("CreateMBOMStatusUI.Title"),icon:"",immersiveFrame:d,content:r,width:1100,height:250,position:{my:"center",at:"center"},resizableFlag:!0,closeButtonFlag:!0,useBordersFlag:!0,visibleFlag:!1,collapsibleFlag:!0,verticallyStretchableFlag:!0});I.close=(()=>I.hide());const f=n.getComponent("TreeDocument"),S=n.getComponent("DataGridView"),M=new f;return new S({treeDocument:M,columns:o,getCellTooltip:l}).getContent().inject(r),{panel:I,treeDocument:M}}(m);r=c,a=g,u(g,d),c.show()})},destroy:function(){e.is(a)&&(a.empty(),a=null),e.is(s)&&(s=null),e.is(r)&&(r.destroy(),r=null)}}}}),define("DS/DELPPWMfgStructureModule/MfgStructureModule",["UWA/Core","DS/DELPPWMfgStructureModule/CreateMBOMStatusUI"],function(e,t){"use strict";return{behaviors:["UXFactoryBehavior","ResourceBehavior","ModelBehavior","WUXNodeModelBehavior","TreeListViewBehavior","ProductImplementBehavior","SelectionBehavior","MfgItemBehavior","ViewBehavior","RootsBehavior"],creator:function(n,i,o,a,r,s,l,u,d,m,c){var g,p,I,f,S,M,C,h,B,P,w,D,L,v,U,b,N,O=null,V={},x=null,R=null;p=function(t,n){if(V={},!e.is(t))throw new Error("Command ID is null");V.cmdId=t,V.onOKCallBack=n,V.onCancelCallback=P},S=function(){e.is(O)&&(O.isVisible()&&O.destroyUI(),O=void 0)},M=function(e){var t=!0,n=m.getActiveView();return!1===e.changed.isSelected&&e.sourceId!==n&&(t=!1),t},f=function(){var t,n,i,o,r={},s=[],u=!1;return t=O.getImplementingID(),o=O.getImplementedIDs()[0],e.is(t)&&(n=a.getReferenceId(t),(i=l.getScopeLinksOfImplementing(n)).length>0&&(r.id=i[0].get("to"),s.push(r),e.is(o)?a.getReferenceId(o)!==r.id&&(O.updateImplemented(s),u=!0):(O.updateImplemented(s),u=!0))),u},I=function(e){var t,n;!0===e.bUpdateImplemented?(O.updateImplemented(e.selNodes),t="ImplementUI.ImplementedSelectionNotAllowed",n="error"):!0===e.bUpdateImplementing&&(O.updateImplementing(e.selNodes),t="ImplementUI.ImplementedSelectionChanged",n="info"),!0===f()&&O.showMessages(o.getNLSValue(t),n)},C=function(t){if(V={},!e.is(t))throw new Error("Command ID is null");V.cmdId=t,V.moduleOptions=g,V.onOKCallBack=D,V.onCancelCallback=P},h=function(e,t){x.updateImplementingLabel(e),a.getMajorRevisions(t,function(e){x.updateImplementedRevnList(t,e,!1)})},B=function(){e.is(x)&&(x.isVisible()&&x.destroyUI(),x=void 0)};const y=function(){e.is(R)&&(R.destroy(),R=null)};return w=function(t){var r,s,u,m,g,p,I,f,M,C={};if(e.is(t)){r=a.getReferenceModel(t.implementingId),s=a.getReferenceModel(t.implementedIDs[0]),u=a.getInstance(t.implementingId),m=a.getInstance(t.implementedIDs[0]),M=t.implementingId,e.is(t.implementingPaths[0])&&e.is(t.implementingPaths[0][0])&&(M=a.getInstance(t.implementingPaths[0][0]).get("isAggregatedBy")),u&&m&&l.isImplementLinkPossible(t.implementingPaths[0],t.implementedPaths[0])&&(g=u.get("PID"),p=l.getPathToScope(t.implementedPaths[0])),I=r.get("PLMEntity.V_Name"),f=s.get("PLMEntity.V_Name"),C.scopeCreation=t.scopeCreation,C.prefix=t.mfgItemPrefix,C.logMessage=o.getNLSValue("CreateMfgItemStructure.LogMessage",{mbom:I,ebom:f}),C.computeResultReport=!!e.is(t.resultReportMode)&&"no_report"!==t.resultReportMode;const h=c.getCompatibleConfigurationFilters([s.id]);if(!e.is(h)||null===h)return void n.warn(o.getNLSValue("Error.NoConfigurationFiltersExists.Failure"));d.webservice("Create",{product:{referencePID:s.get("PID"),OccPath:p,productConfigFilter:h[s.id]},mfgItem:{referencePID:r.get("PID"),instancePID:g,topRootMfgItemPID:M}},C,function(n){var o;n=n||{},e.is(n.resultReport)&&(e.is(t.resultReportMode)&&(o=t.resultReportMode),i.create("MfgItemCreateReportUI",{report:n.resultReport,mode:o}))}),S()}},D=function(t){var n,i,r={};e.is(t)&&(n=a.getReferenceModel(t.implementingId).get("PLMEntity.V_Name"),r.backgroundJobFlag=!1,r.scopeCreation=t.scopeCreation,r.prefix=t.mfgItemPrefix,r.logMessage=o.getNLSValue("UpdateMfgItemStructure.LogMessage",{mbom:n}),r.updateIntermediateScopedAssemblies=t.updateIntermediateScopedAssemblies,i=t.implementingId,e.is(t.implementingPaths[0])&&e.is(t.implementingPaths[0][0])&&(i=a.getInstance(t.implementingPaths[0][0]).get("isAggregatedBy")),d.webservice("Update",{product:{referencePID:t.implementedId,productConfigFilter:N[t.implementedId]},mfgItem:{referencePID:t.implementingId,processConfigFilter:b[t.implementingId],topRootMfgItemPID:i}},r),B())},P=function(){S(),B()},L=function(){P(),p("CreateMfgItemStructure",w),V.cmdTitle="Dialog.CreateMfgItemStructure.Title",V.implementingSection=!0,V.implementedSection=!0,V.optionsSection=!0,V.scopeOption="ComboBox",V.mfgItemPrefix=!0,V.mfgItemResultReport=!d.isCreateMBOMv2(),V.multiSelectionOfImplementing=!1,V.multiSelectionOfImplemented=!1,O=i.create("ImplementUI",V),I(O.getSelectionsWithPaths())},v=function(){e.is(R)&&y(),(R=new t(n,i,o)).display(()=>d.getCreateMfgItemStatus())},U=function(){var t,r,s,d,m,g=u.getSelectionsWithPaths()[1][0],p=g.id,I=a.getReferenceModel(p);if(P(),!e.is(I))return void n.debug("UpdateMfgItemStructure: Reference Model not found for pid:"+p);if(s=I.get("PID"),(t=l.getScopeLinksOfImplementing(s)).length<=0)return void n.warn(o.getNLSValue("Error.NoProductScopeExists.Title"));if(r=t[0].get("to"),e.is(g.path,"array")&&g.path.length>0){const e=g.path[0];m=a.getInstance(e).get("isAggregatedBy");const t=l.getScopeLinksOfImplementing(m);if(0===t.length)return void n.warn(o.getNLSValue("Error.NoProductScopeExists.Title"));d=t[0].get("to")}else d=r,m=s;const f=c.getCompatibleConfigurationFilters([m]),S=c.getCompatibleConfigurationFilters([d]);e.is(f)&&e.is(S)?(b={...f},N={...S},C("UpdateMfgItemStructure"),V.cmdTitle="Dialog.UpdateMfgItemStructure.Title",V.implementedRevTreeListCSSStyle="implementedSection-container-withChkBox",V.optionsSection=!0,V.scopeOption="ComboBox",V.mfgItemPrefix=!0,V.defaultHeight="430",V.modalFlag=!0,(x=i.create("ImplementedRevChooserUI",V)).updateImplementing(),h(s,r)):n.warn(o.getNLSValue("BI.Computation.IncompatibleFilter"))},{listenTo:function(){return{select:this.onSelect,CreateMfgItemStructure:L,CreateMBOMStatus:v,UpdateMfgItemStructure:U}},onStart:function(e){g=e},onStop:function(){S(),B(),y()},onSelect:function(t){if(e.is(O)&&O.isVisible()&&e.is(t)){if(!1===M(t))return;e.is(t.changed)&&I(O.getSelectionsWithPaths())}}}}}});