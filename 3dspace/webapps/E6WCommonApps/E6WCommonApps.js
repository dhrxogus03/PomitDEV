define("DS/E6WCommonApps/Collections/ConstraintsPseudoCollection",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","UWA/Class/Collection"],function(e,t,n,s,i){"use strict";var o=t.extend(n,s,{_iterateOverWorkscopes:function(e,t){var n,s=this;if(e instanceof i)return e.some(function(e){return s._iterateOverWorkscopes(e,t)});if(n=t.call(this,e))return n;for(var o=e.getWorkscopes(),a=o.length,r=0;r<a&&!n;r++){var l=o.at(r);n=this._iterateOverWorkscopes(l,t)}return n},_onCollectionEvent:function(e,t,n,s,i){if(!this.requestReset){switch(e){case"onReset":var o=this;this.requestReset=window.requestAnimationFrame(function(){delete o.requestReset,o.dispatchEvent(e,[t,o,s])}),this._handleConstraintResetForWorkscope(t,n,i);break;case"onAdd":return void this.add(t,i,s);case"onRemove":return void this.remove(t,i,s)}this.dispatchEvent(e,[t,this,s])}},_handleConstraintResetForWorkscope:function(t,n,s){var i,a,r=[],l=e.is(n.previousModels,"array")?n.previousModels.slice():[];for(t.forEach(function(e){var t=l.indexOf(e);-1===t?r.push(e):l.splice(t,1)}),i=0;i<r.length;i++)a=r[i],this.add(a,s);for(i=0;i<l.length;i++)a=l[i],o.parentProjectIsDisplayed(a)||this.remove(a,s)},_listenToWorkscopeConstraints:function(e){var t=e.getOwnConstraints();this.listenTo(t,"onAnyEvent",function(t,n,s,i){this._onCollectionEvent(t,n,s,i,e)}),this._addConstraintsFromWorkscope(e)},_startListeningToWorkscope:function(e){this._listenToWorkscopeConstraints(e);var t=e.getWorkscopes(),n={onAdd:this._onAddWorkscope,onReset:this._onResetWorkscope,onRemove:this._onRemoveWorkscope};this.listenTo(t,n)},_stopListeningToWorkscope:function(e){var t=e.getWorkscopes();this.stopListening(t),this.stopListening(e.getOwnConstraints())},_onAddWorkscope:function(e){this._iterateOverWorkscopes(e,this._startListeningToWorkscope,!1),this._iterateOverWorkscopes(e,function(e){this._addConstraintsFromWorkscope(e)})},_addConstraintsFromWorkscope:function(e){var t=e.getOwnConstraints(),n=this;t.forEach(function(t){t.dispatchEvent("onAdd",[t,n]),n.add(t,e)})},_listenToWorkscopeAndAddConstraintsToMap:function(e){if(e instanceof t.Model){this._startListeningToWorkscope(e);var n=this;e.getOwnConstraints().forEach(function(t){n.add(t,e,{silent:!0})})}},_onResetWorkscope:function(e,t){if(0!==e.length||0!==t.previousModels.length){this._constraintMap.clear(),this._constraintParentMap.clear(),this._constraintIDMap.clear(),this.stopListening();var n=this;this._iterateOverWorkscopes(this.model,function(e){n._listenToWorkscopeAndAddConstraintsToMap(e)}),this.dispatchEvent("onReset",[this])}},_onRemoveWorkscope:function(e){var t=this;this._iterateOverWorkscopes(e,this._stopListeningToWorkscope,!1),this._iterateOverWorkscopes(e,function(n){n.getOwnConstraints().forEach(function(n){n.dispatchEvent("onRemove",[n,t]),t.remove(n,e)})});var n=e.hasViewAccess()&&e.getParent();n&&n.hasViewAccess()&&n.getOwnConstraints().forEach(function(n){t.add(n,e,{silent:!0})})},init:function(e){this.model=e,this._constraintMap=new Map,this._constraintIDMap=new Map,this._constraintParentMap=new Map,Object.defineProperty(this,"id",{get:function(){return(this.model.id||this.model.getUri())+":allConstraints"}}),Object.defineProperty(this,"length",{get:function(){return this._constraintMap.size}});var t=this;if(this._iterateOverWorkscopes(this.model,function(e){t._listenToWorkscopeAndAddConstraintsToMap(e)}),this.model instanceof i){var n={onAdd:this._onAddWorkscope,onRemove:this._onRemoveWorkscope,onReset:this._onResetWorkscope};this.listenTo(this.model,n)}},first:function(){return this.at(0)},get:function(e){return this._constraintIDMap.get(e)},add:function(e,t,n){var s=this._constraintParentMap.get(e.cid)?this._constraintParentMap.get(e.cid):new Set,i=0===s.size,o=i&&(!n||!n.silent);s.add(t.id),i&&this._constraintMap.set(e.cid,e),i&&this._constraintParentMap.set(e.cid,s),e.id&&this._constraintIDMap.set(e.id,e),o&&this.dispatchEvent("onAdd",[e,this,n])},remove:function(e,t,n){var s=this._constraintParentMap.get(e.cid);s&&(s.delete(t.id),0===s.size&&this._constraintMap.delete(e.cid),0===s.size&&this._constraintIDMap.delete(e.id),!(0!==s.size||n&&n.silent)&&this.dispatchEvent("onRemove",[e,this,n]))},at:function(e){var t,n=0;if(!(e>this._constraintMap.size-1)){if(this._constraintMap.values){for(var s=this._constraintMap.values(),i=s.next();!i.done&&n<e;)i=s.next(),n++;return i.value}return this._constraintMap.forEach(function(s){n===e&&(t=s),n++}),t}},forEach:function(e,t){var n=0;this._constraintMap.forEach(function(s){e.call(t,s,n),n++})},destroy:function(){window.cancelAnimationFrame(this.requestReset),this.stopListening(),delete this.model,delete this.requestReset,this._constraintMap.clear(),this._constraintParentMap.clear(),this._constraintIDMap.clear(),delete this._constraintMap,delete this._constraintParentMap,delete this._constraintIDMap},contains:function(e){return Boolean(this._constraintIDMap.get(e.id))}});return o.parentProjectIsDisplayed=function(e){let t=e.getPredecessor(),n=t&&t.hasViewAccess()&&t.getParent();return t&&n&&n.hasViewAccess()&&n.hasDataForMask("dsplan:MVMask.WorkPackage.ScheduleView")},o}),define("DS/E6WCommonApps/Models/Document/CollabspaceDocument",["UWA/Core","UWA/Class"],function(e,t){"use strict";return t.extend({data:{title:null,fileName:null,file:null,icon:null,id:null,type:null,document:null,fileData:null,serviceId:"3DSpace"},init:function(t,n){var s=e.clone(t||{},!1);this.set("document",s.documents[0]),this.set("fileData",this.get("document").relateddata.files[0]),this._setupDocument(s,n)},_setupDocument:function(t,n){var s=e.clone(t||{},!1);this.set("type",s.type),this.set("title",this.get("document").dataelements.title),this.set("fileName",this.get("fileData").dataelements.title),this.set("file",this._getCurrentFile(n)),this.set("icon",this.get("document").dataelements.image),this.set("id",this.get("document").id),this.set("type",this.get("document").type),this.set("serviceId","3DSpace")},_getCurrentFile:function(e){for(let t=0;t<e.length;t++){const n=e[t];if(n.name.contains(this.get("fileName")))return n}},get:function(e){if(this.data[e])return this.data[e]},set:function(e,t){this.data[e]=t}})}),define("DS/E6WCommonApps/Models/ChildModelMixin",["DS/E6WCommonUI/PlatformManager"],function(e){"use strict";return{canModify:function(t){let n=this.getParent();return!(!n||!(n._accessModify||"function"==typeof n.canModify&&n.canModify())||e.isXppViewer())||this._parent.apply(this,arguments)}}}),define("DS/E6WCommonApps/SubscribeUtil",["DS/E6WCommonUI/SubscribeUtilBase","DS/DocumentManagement/DocumentManagement","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n){"use strict";return e.i18n=function(){return n.get.bind(n)},e.getMessage=function(t){var s=t&&e.i18n(t.reason);return t.args&&(s=n.replace(s,t.args)),s},Object.defineProperty(e,"events",{get:function(){return t.events}}),e}),define("DS/E6WCommonApps/Models/AssigneeMixin",["UWA/Core","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager"],function(e,t,n){"use strict";return{hasPermissionToAssignToSelf:function(){let e=!this.isComplete()&&(this.get("canEdit")||this._isUserACandidateAssigneeOrPartOfUserGroup());return e||(e="TRUE"===this.get("canClaimTask")),e},canAssignToSelf:function(e){return this.hasPermissionToAssignToSelf()&&!this.isAssignedToCurrentUser(e)},isAssignedToCurrentUser:function(n){var s=!1,i=n||this.get(this.ASSIGNEESATTR)||this.get("dsxplan:hasAssignee");if(i)for(var o=0;o<i.length;o++){var a=i.at?i.at(o):i[o],r=a&&e.is(a.get,"function")&&a.get("dsaccess:accountName")||a&&a["dsaccess:accountName"];if(t.isLoggedInUser(r)){s=!0;break}}return s},_isUserACandidateAssigneeOrPartOfUserGroup:function(){if(this._membersChecked)return this._isUserACandidateAssignee;var e=this.get("dsxplan:hasCandidateAssignee"),t=this,s=!1;const i=[];return e&&e.some(function(e){if("pno:Person"===e.getObjectType()){var o=e.get("dsaccess:accountName");i.push(o),i.includes(n.getContextUser())&&(s=!0)}else"foaf:Group"===e.getObjectType()&&(s=e.includesCurrentUser(t));return s}),s}}}),define("DS/E6WCommonApps/SubscriptionUtils",["DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t){"use strict";const n={subscriptionsFetched:{},isUserSubscribedTo:function(t){n.subscriptionsFetched[t.id]||(n.subscriptionsFetched[t.id]=!0,e.request(e.expandUrl("invoke/dsplan:isUserSubscribingNotif"),{method:"POST",type:"json",data:JSON.stringify([t.get("@id")]),onComplete:function(e){t.set("_xplanSubscribed",e["@value"])}}))},toggleUserSubscription:function(n){e.request(e.expandUrl("invoke/dsplan:toggleUserNotifSubscription"),{method:"POST",type:"json",data:JSON.stringify([n.get("@id")]),onComplete:function(e){n.set("_xplanSubscribed",e["@value"]),t.trackPageEvent({eventCategory:"ProjectSubscription",eventAction:"toggleUserSubscription",eventLabel:"Subscribe-Or-Unsubscribe",eventValue:n.get("_xplanSubscribed")})}})}};return n}),define("DS/E6WCommonApps/Views/DetailedToggleView",["UWA/Core","DS/Handlebars/Handlebars4","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/E6WCommonUI/Views/DetailsDisplaySharedView","text!DS/E6WCommonApps/assets/templates/detailedToggle.html.handlebars"],function(e,t,n,s,i,o){"use strict";var a=t.compile(o);return i.extend({_uwaClassName:"DetailedToggleView",tagName:"div",render:function(){const e=this;this.container.empty(!0);let t={title:e.model.get(e._config.titleAttribute),description:e.model.get(e._config.descriptionAttribute)};var i=this.normalizedGet(this.model,this._config.name);if(this.canReadWrite()&&this.normalizedGet(this.model,"canEdit")){if(this.container.setHTML(a(t)),this._buttonGroup=new s({type:this._config.toggleType}),this._config&&this._config.values&&this._config.values.length)for(var o=0;o<this._config.values.length;o++){let e=this._config.values[o];this._buttonGroup.addChild(new n({type:this._config.toggleType,value:e.actualValue,label:e.displayValue,checkFlag:i&&i===e.actualValue}))}var r=this.container.getElement(".eno-toggle-grid");this._buttonGroup&&this._buttonGroup.addEventListener("change",function(){var t=e._config,n=e._buttonGroup.value,s=t.values.detect(function(e){return e.actualValue===n[0]});e.model.model.set(t.name,s.actualValue)}),this._buttonGroup.inject(r)}else i&&(t.readonlyvalue=i,this.container.setHTML(a(t)));return this}})}),define("DS/E6WCommonApps/Models/CalendarModel",["UWA/Core","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/Collections/ResultCollection","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s){"use strict";var i="dsplan:MVMask.Calendar.Basic",o="dsplan:timezoneOffset",a=t.extend({_uwaClassName:"CalendarModel",hasViewAccess:function(){return!0},timeOffsetToUTCString:function(){var e,t=this.get(o)/60;return!isNaN(t)||Math.abs(t)>24?(e=t>=0?"UTC+":"UTC",e+=t):(e="Invalid Calendar timeOffset: "+t,console.error("Invalid time offset: "+t)),e},getDateInWorkscopeCalendarTimeZone:function(e){var t=this.get(a.OFFSET_ATTR)+e.getTimezoneOffset();return new Date(e.getTime()+60*t*1e3)},getDropdownDisplayValue:function(){var e,t=this.get("dsplan:representativeCities").replace(/ /g,"").replace(/,/g,"_");return this.timeOffsetToUTCString()+" "+(e="E6WCommonApps.Calendar."+t,s.get(e))}}),r=n.extend({_uwaClassName:"CalendarCollection",comparator:function(e,t){return parseInt(e.get(o))-parseInt(t.get(o))},getUri:function(){return"/classes/dsplan:Calendar"},getMask:function(){return i}});return a.calendarCollection=new r(void 0,{detailsMask:i,defaultModel:a}),a.fetchCalendars=function(t){var n=e.clone(t||{},!1),s=n.onComplete;n.onComplete=function(){a._calendarsFetched=!0,e.is(s,"function")&&s()},n.reset=!0,a.calendarCollection.fetch(n)},a.haveCalendarsBeenFetched=function(){return Boolean(a._calendarsFetched)},a.getCalendarsForDropdown=function(){var e=[];return a.calendarCollection.forEach(function(t){e.push({actualValue:t.id,displayValue:t.getDropdownDisplayValue&&t.getDropdownDisplayValue()})}),e},a.getCalendarClosestToUserTimeZone=function(){if(!a._closestCalendar){var e=(n=new Date(2018,0,1,0,0,0,0),s=n.toUTCString(),(n-new Date(s.substring(0,s.lastIndexOf(" ")-1)))/36e5),t=25;a.calendarCollection.forEach(function(n){var s=parseInt(n.get(o))/60-e;!isNaN(s)&&Math.abs(s)<t&&(t=Math.abs(s),a._closestCalendar=n)})}var n,s;return a._closestCalendar},a.OFFSET_ATTR=o,a.CITIES_ATTR="dsplan:representativeCities",a.LOAD_ALL_CALENDARS_URL="/classes/dsplan:Calendar",a}),define("DS/E6WCommonApps/ColorUtil",[],function(){"use strict";var e={rgbToHex:function(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t},parseColor:function(e){return{red:Number.parseInt(e.slice(1,3),16),green:Number.parseInt(e.slice(3,5),16),blue:Number.parseInt(e.slice(5,7),16)}},squareColorObject:function(e){return{red:Math.floor(e.red*e.red/255),green:Math.floor(e.green*e.green/255),blue:Math.floor(e.blue*e.blue/255)}},colorObjectToHex:function(t){return`#${e.rgbToHex(t.red)}${e.rgbToHex(t.green)}${e.rgbToHex(t.blue)}`},getHighlightColorForTaggedObject:function(t){const n=e.parseColor(t),s=e.squareColorObject(n);return e.colorObjectToHex(s)}};return e}),define("DS/E6WCommonApps/DateUtils",[],function(){"use strict";return{_toISOStringIgnoringUTC:function(e){return e.getFullYear()+"-"+this._pad(e.getMonth()+1)+"-"+this._pad(e.getDate())+"T"+this._pad(e.getHours())+":"+this._pad(e.getMinutes())+":"+this._pad(e.getSeconds())+"."+String((e.getMilliseconds()/1e3).toFixed(3)).slice(2,5)},_pad:function(e){var t=String(e);return 1===t.length&&(t="0"+t),t}}}),define("DS/E6WCommonApps/Constants",["i18n!DS/E6WCommonApps/assets/nls/TimelineNLS"],function(e){"use strict";var t=e.get.bind(e);return{MONTH_LONG_NAMES:[t("January"),t("February"),t("March"),t("April"),t("May"),t("June"),t("July"),t("August"),t("September"),t("October"),t("November"),t("December")],MONTH_SHORT_NAMES:[t("Jan"),t("Feb"),t("Mar"),t("Apr"),t("May"),t("Jun"),t("Jul"),t("Aug"),t("Sep"),t("Oct"),t("Nov"),t("Dec")],DAY_LONG_NAMES:[t("Sunday"),t("Monday"),t("Tuesday"),t("Wednesday"),t("Thursday"),t("Friday"),t("Saturday")],DAY_SHORT_NAMES:[t("Sun"),t("Mon"),t("Tue"),t("Wed"),t("Thu"),t("Fri"),t("Sat")],NCAPSULATOR_BUFFER:18,DIVIDER_WIDTH:8}}),define("DS/E6WCommonApps/Views/ProgressBarPopupView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/FoundationBaseView","DS/DocumentManagement/DocumentManagement","DS/Controls/Accordeon","DS/Controls/ProgressBar","text!DS/E6WCommonApps/assets/templates/popover.html.handlebars","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r){"use strict";var l=function(e){return r.get(e)},d={error:"error",fail:"error",info:"info",warning:"warning"},c=t.compile(a);return n.extend({_uwaClassName:"ProgressBarPopupView",id:function(){return"progressBar_"+this.cid},domEvents:{"click .minimize-btn":"toggleMinimizedMaximized","click .cancel-btn":"cancel"},setup:function(t){var n=e.clone(t||{},!1);this._activityElementObj={},this._progressBarObj={},this._isHidden=!0,this._error={},this._warning={};var i={onActivityStart:this.addActivityView,onActivityProgress:this.updateActivityView,onActivityComplete:this.removeActivityView,onActivityFailure:this.removeActivityView};n.additionalEventProducer&&this.listenTo(n.additionalEventProducer,i);var o=s.events;this.listenTo(o,i),this._activityCount=0},render:function(){return this.container.setHTML(c({title:l("E6WCommonApps.ProgressBar.Title")})),this._parent.apply(this,arguments),this.container.toggleClassName("hidden",this._isHidden),this},toggleMinimizedMaximized:function(){var e=this.getPopupOver(),t=e.getElement(".minimize-btn"),n=t.hasClassName("fonticon-down-open");t.toggleClassName("fonticon-down-open",!n),t.toggleClassName("fonticon-up-open",n),e.toggleClassName("minimized")},cancel:function(){this.close()},getPopupOver:function(){return this.getElement(".popover")},getPopupOverBody:function(){return this.getElement(".popover-body")},updateActivityView:function(t){var n=e.clone(t||{},!1),s=n.activity,i=s.name+"_"+s.id,o=this._activityElementObj[i];if(o){var a=this._progressBarObj[i],r=o.getElement(".process-log"),c=o.getElement(".status");c.setText(l("E6WCommonApps.ProgressBar.Processing")),o.addClassName("processing");var p=Math.ceil(100*t.loaded/t.total);if(n.log&&isNaN(p)&&(p=a.value||0),isNaN(p)||"fail"===n.type?(o.removeClassName("processing"),c.setText(l("E6WCommonApps.ProgressBar.Failure"))):a.value=p,"error"===n.type||"fail"===n.type){var u=this._error[i]||[];u.push(n.log),this._error[i]=u}if("warning"===n.type){var h=this._warning[i]||[];h.push(n.log),this._warning[i]=h}if(n.log)o.removeClassName("no-log"),e.createElement("li",{class:d[n.type],html:n.log}).inject(r)}},removeActivityView:function(e){var t=e.name+"_"+e.id,n=this.getPopupOverBody(),s=this._activityElementObj[t],i=this._progressBarObj[t],o=this;if(this._activityCount--,0===this._activityCount&&0===Object.keys(this._error).length&&0===Object.keys(this._warning).length)this._hideTimeout=setTimeout(function(){o.close()},1e3);else if(this._error[t]||this._warning[t])if(this._error[t])this._error[t]&&(i.emphasize="high-attention");else{s.removeClassName("processing"),s.getElement(".status").setText(l("E6WCommonApps.ProgressBar.Completed"))}else n.removeChild(s),delete this._activityElementObj[t],delete this._progressBarObj[t]},addActivityView:function(t,n){var s=e.clone(n||{},!1);this.show(),this._activityCount++,t.id=t.id?t.id:(new Date).getTime();var i=this.createActivityView(t,s);this.getPopupOverBody().appendChild(i),this._activityElementObj[t.name+"_"+t.id]=i},createActivityView:function(t,n){var s=e.clone(n||{},!1).update?l("E6WCommonApps.ProgressBar.Updating"):l("E6WCommonApps.ProgressBar.Pending"),a=e.createElement("div",{id:t.name+"_"+t.id,class:"task-view no-log"}),r=new i({items:[{id:t.id,header:t.name,content:new e.Element("ul",{class:"process-log"})}],style:"simple"}).getContent(),d=r.getElement(".wux-controls-expander-header"),c=new o({value:0,statusFlag:!1}).inject(d);return this._progressBarObj[t.name+"_"+t.id]=c,e.createElement("div",{class:"status",text:s}).inject(d),r.inject(a),a},destroy:function(){this._parent(),this._hideTimeout&&clearTimeout(this._hideTimeout)},show:function(){this._isHidden=!1,this.container.toggleClassName("hidden",this._isHidden)},hide:function(){this._isHidden=!0,this.container.toggleClassName("hidden",this._isHidden)},close:function(){this.hide(),this._error={},this._warning={},this._activityElementObj=[],this._progressBarObj=[],this._activityCount=0,this.getPopupOverBody().empty()}})}),define("DS/E6WCommonApps/Views/LinkLauncherUtils",["UWA/Core","UWA/Promise","DS/RDFFoundation/SecurityContextUtils","DS/E6WCommonUI/Views/ObjectCardView","DS/E6WCommonUI/PlatformManager","DS/TransientWidget/TransientWidget","DS/E6WCommonUI/WidgetUtils","DS/PlatformAPI/PlatformAPI","UWA/Class/Collection","DS/E6WCommonAppsLightbox/Views/Lightbox","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,n,s,i,o,a,r,l,d,c){"use strict";var p=["VPMReference","Drawing","XCADModelRepReference","SLDPRT",".SLDPRT","SLDASM",".SLDASM","SLDDRW",".SLDDRW"],u=["VPMReference","VPMRepReference","Drawing","XCADNonPSBaseRepReference","CATPart",".CATPart","CATProduct",".CATProduct","CATShape",".CATShape","CATDrawing",".CATDrawing","CATAnalysis",".CATAnalysis","CATAnalysisResults",".CATAnalysisResults","CATAnalysisComputation",".CATAnalysisComputation","CATProcess",".CATProcess","CATMaterial",".CATMaterial"],h=["person","pno:person","Simulation","Simulation Template","DriveFolder"],m=["Project Management","Route"],T=function(e){return c.get(e)},g={showPreview:function(e){var t=e&&e.get("parentTypes");if(t&&t.length&&t.find(e=>m.includes(e)))return!1;var n=e&&e.get("type"),s=e&&e.serviceHosting;return("3DSpace"===s||"3DDrive"===s)&&!h.includes(n)},launchProperties:function(e,t){var n=t&&t.model,s=n&&n.serviceHosting,i=n&&n.tenant,o=n&&n.physicalId||e,r={model:{objectId:o,tenant:i,source:s}};switch(n.sourceName&&(r.model.sourceName=n.sourceName),s){case"3dspace":case"3DSpace":break;case"3DDrive":r.model.sourceName="drive";break;default:r.model.sourceName=n.sourceName,r.model.source="fedsearch",r.model.objectId=n.fedSearchIdQuery,r.model["ds6w:type"]=n.get("ds6w:type")||n.get("dsxplan:jsType")}let l=!0;if(g.showPreview(n)){sessionStorage.setItem(a.getSessionId(),widget.getView().type),widget.dispatchEvent("onViewRequest",{type:"fullscreen"});var c=this;(l=g.getPropertiesElement(r.model)).then(function(e){var s={inode:n,properties:e,actions:[c.getDownloadButton&&c.getDownloadButton(t)],config3dPlay:g.get3DPlayOptions(n)};if(!g.lightbox){const e=d.init(s);widget.body.prepend(e),g.lightbox=e}g.lightbox.toggleVisibility(!0),g.lightbox.animationFrameId=window.requestAnimationFrame(function(){g.lightbox.refresh(s)})})}else require(["DS/LifecycleControls/EditPropDialog"],function(e){new e({ID:"propFor"+o}).launchProperties(r)});return l},get3DPlayOptions:function(t){const s={contextId:n.getDefaultSecurityContext(),physicalid:t.get("physicalId"),serverurl:i.getServiceUrl(t.serviceHosting),tenant:t.get("tenant")||i.getTenant()};return"3DDrive"===t.serviceHosting?e.extend(s,{provider:"FILE",filename:t.get("preview_url"),format:t.get("fileExtension")}):e.extend(s,{provider:"EV6",dtype:t.get("type"),requiredAuth:"passport"}),{asset:s}},getPropertiesElement:function(e){return new t(function(t,n){require(["DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/EditPropWidget"],function(n,s,i){var o=new n(e),a=new i({className:"editTaskProperties",setEditButton:!1,readOnly:!0,typeOfDisplay:s.ONLY_EDIT_PROPERTIES,selectionType:s.NO_SELECTION,multiselection:!1,collapseTabs:!1,context:widget,actions:[]});a.initDatas([o]),t(a.elements.container.elements)},function(e){n(e)})})},polymorphicOpenMenuItem:function(t,n,s,i){var o=e.clone(t||{},!1),a=this._getAddInMode(),r=i.normalizedGet(i.model,i._config.name);r=e.is(r,"array")?r[o.index||0]:r instanceof l?r.at(o.index||0):r;var d;if(!((d=this._isDPMProject(i,r))||r.getObjectType&&"Project"===r.getObjectType())){if(o.isProjectOrPlan=d,o.model=r,o.isProject=!1,o.isURL="dsplan:url"===i.normalizedGet(r,"dsxplan:jsType")||"URL"===i.normalizedGet(r,"type"),o.isURL){let e=i.normalizedGet(r,"dsplan:linkURL")||i.normalizedGet(r,"linkURL");o.handler=this.urlLinkHandler.bind(this,e)}return"solidworks"===a&&this.isSolidWorksFile(o.model)||"catiav5"===a&&this._isCatiaFile(o.model)?this.getAddInOpenMenuItem(o,n,s,i):this.getWebAppOpenMenuItem(o,n,s,i)}},urlLinkHandler:function(e){e.toLowerCase().startsWith("http://")||e.toLowerCase().startsWith("https://")||(e="http://"+e),window.open(e,"_blank")},_isDPMProject:function(e,t){var n=t.get("parentTypes");return"Project Space"===e.normalizedGet(t,"type")||n&&n.includes("Project Space")},openInApp:function(e){var t=e.getLaunchOptions(),n=t.appId;delete t.appId,o.showWidget(n,"",t)},getRedirectUrl:function(e){return`${window.enoviaServer["3dplan"]}/dsplan/redirectlink/${encodeURIComponent(e)}`},getDashboardUrl:function(e,t){return t=t||widget.getValue("appId"),window.enoviaServer["3DDashboard"]+"#app:"+t+"/content:ids="+encodeURIComponent(e)},getAddInOpenMenuItem:function(e,t,n){var s=this._getAddInMode(),i="solidworks"===s&&this.isSolidWorksFile(e.model)||"catiav5"===s&&this._isCatiaFile(e.model);return{className:t+(i?"":" disabled"),text:T("E6WCommonUI.Label.Open"),fonticon:"open",handler:function(){return i&&r.publish("webinwin:web:notification",JSON.stringify({operation:"open/setObject",operationVersion:"1.0",content:[{phid:e.model.get("physicalId")}]})),n.apply(this,arguments)}}},getWebAppOpenMenuItem:function(e){var t;return(e.isProjectOrPlan||e.isURL)&&(t={id:"open",text:e.isURL?T("E6WCommonUI.Label.OpenLink"):T("E6WCommonUI.Label.Open"),fonticon:"open",handler:e.handler}),t},isSolidWorksFile:function(e){var t=e.get("type"),n=e.get("busType");return-1!==p.indexOf(t)||-1!==p.indexOf(n)},_isCatiaFile:function(e){var t=e.get("type"),n=e.get("busType");return-1!==u.indexOf(t)||-1!==u.indexOf(n)},_getAddInMode:function(){return widget.getValue("addinmode")}};return g}),define("DS/E6WCommonApps/Views/E6WCustomUomView",["UWA/Core","DS/E6WCommonUI/Views/UomView"],function(e,t){"use strict";return t.extend({_uwaClassName:"E6WCustomUomView",isValidInput:function(){return!0}})}),define("DS/E6WCommonApps/CommonAppsHandlebarsHelper",["DS/E6WCommonUI/CommonUIHandlebarsHelper"],function(e){"use strict";return e}),define("DS/E6WCommonApps/Utils/RapidUtils",["UWA/Class/Events","UWA/Class/Listener","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel"],function(e,t,n,s){"use strict";const i={tasksWithSubtasks:{},dispatcher:new e,listener:new t,rapidServerResponseToRDF:function(e,t){const s={"dsplan:enterpriseIdentificationNumber":t["dsplan:enterpriseIdentificationNumber"],"@id":t.uri,"dsplan:comment":t.description,"dsxplan:label":t.name,"dsplan:estimatedDate":t.estimatedDate,"dsplan:actualDate":t.actualDate,"dsplan:userDefinedDates":"true"===t.fixed,"dsxplan:hasMaturity":t.maturity?{"@id":t.maturity.replace(/.*xPlan\//i,"dsxplan:")}:void 0,"dspol:ceStamp":t.ceStamp,"dsplan:suggestedDate":t.suggestedDate,"dsxplan:vocabularyType":t.vocabularyType,"@etag":t["dspol:ceStamp"],"dsplan:actualEndDate":t.actualEndDate,"dsplan:actualStartDate":t.actualStartDate,"dsxplan:jsType":t["dsxplan:jsType"]||t["dsplan:jsType"],"dsplan:durationIntervalMax":t.durationIntervalMax,"dsplan:durationIntervalMin":t.durationIntervalMin,"dsplan:estimatedDuration":t.estimatedDuration,"dsplan:estimatedEndDate":t.estimatedEndDate,"dsplan:estimatedStartDate":t.estimatedStartDate,"dsplan:userDefinedEnd":"true"===t.fixedEnd,"dsplan:userDefinedStart":"true"===t.fixedStart,"dsplan:percentageCompletion":t.percentage?parseFloat(t.percentage):void 0,"dsplan:hasPriority":t.priority?{"@id":t.priority}:void 0,"dsxplan:sequenceOrder":t.sequenceOrder?parseFloat(t.sequenceOrder):void 0,"dsxplan:hasAssignee":t.assignees?i.parseRapidCollectionToRDF(e,"dsxplan:hasAssignee",t.assignees):void 0,"dsplan:hasScheduleError":t.scheduleError,"dsxplan:hasConstraint":t.constraints?i.parseRapidCollectionToRDF(e,"dsxplan:hasConstraint",t.constraints):void 0,"dsxplan:to":t.to,"dsxplan:from":t.from,"dsxplan:constraintType":t.type,"dsxplan:isEnforced":t.isEnforced,"dsplan:resolution":t.resolution,"dskern:owner":n.getObjectById(t.owner),"dsxplan:lag":t.lag,"dsxplan:customExtensionName":t["dsxplan:customExtensionName"]};return Object.keys(s).forEach(e=>{s[e]||delete s[e]}),i.tasksWithSubtasks[t.uri]=t.hasSubtasks,s},hasSubtasks:function(e){return e.getSubtasks().length>0||i.tasksWithSubtasks[e.id]},createRapidProxy:function(e){return{getRDFModel:()=>e,rdfModel:e,id:e.id}},fetchTasks:function(e){e.fetching=!0,e.fetchingMask("dsplan:MVMask.Task.Complex.All"),n.request(n.expandUrl("/invoke/dsxplan:getSubTasks"),{method:"POST",data:JSON.stringify([n.jsonURIToSparqlURI(e.id),100,-1]),onComplete:t=>{e.doneFetchingMask("dsplan:MVMask.Task.Complex.All"),e.addMask("dsplan:MVMask.Task.Complex.All");const o=JSON.parse(t)["@value"],a=JSON.parse(o),r=[];i.bindSubtasks(e);for(let t=0;t<a.tasks.length;t++){const o=a.tasks[t],l=i.rapidServerResponseToRDF(e.id,o);l["dsxplan:taskParent"]={"@id":e.id};const d=s.mergeOrCreateObject(l);e.getSubtasks().add(d,{dontRegisterChange:!0,silent:!0}),o.constraints&&o.constraints.forEach(e=>{r.push(n.getObjectById(e.uri))})}r.forEach(e=>e.updateParentWorkscopes({forceDispatchEvent:!0})),a.tasks.length>0&&(i.tasksWithSubtasks[e.id]=!0),e.fetching=!1,e.dispatchEvent("onChange:dsxplan:hasSubtask",[e,!0]),e.getSubtasks().dispatchEvent("loaded"),i.dispatcher.dispatchEvent("refreshTagger",[e.getAllSubTasks()])},onFailure:()=>{e.doneFetchingMask("dsplan:MVMask.Task.Complex.All"),e.fetching=!1}})},bindSubtasks:function(e){const t=e.getSubtasks();i.listener.stopListening(e),i.listener.stopListening(t);const n=(t,n)=>{i.tasksWithSubtasks[e.id]=e.hasSubtasks(),i.dispatcher.dispatchEvent(n,[t,e])};i.listener.listenTo(t,{onAdd:e=>n(e,i.events.subTaskAdded),onRemove:e=>n(e,i.events.subTaskRemoved),loaded:e=>n(e,i.events.loaded)}),i.listener.listenToOnce(e,{onDestroy:()=>i.listener.stopListening(e.getSubtasks())})},parseRapidCollectionToRDF:function(e,t,n){let s=n;return n[0]&&n[0].uri&&(s=n.map(e=>i.rapidServerResponseToRDF(e.uri,e))),{"@type":"Collection","@href":`/resources/${e}/${t}`,"@id":`${e}/${t}`,member:s}},events:{destroyed:"destroyed",loaded:"loaded",expanded:"expanded",subTaskRemoved:"subTaskRemoved",subTasksLoaded:"subTasksLoaded",subTaskAdded:"subTaskAdded"}};return i}),define("DS/E6WCommonApps/Utils/ModalManager",["DS/UIKIT/SuperModal"],function(e){"use strict";const t={getSuperModal:function(){return this._modal},initSuperModal:function(t){return this._modal=new e({renderTo:t}),this._modal},cleanupModals:function(){this._modal&&this._modal.modals.current&&this._modal.modals.current.destroy()},getCurrentContent:function(){return t.getCurrentModal().getContent()},getCurrentModal:function(){return t._modal.modals.current}};return t}),define("DS/E6WCommonApps/Utils/3DSpaceUtils",["DS/Foundation2/FoundationV2Data","DS/RDFFoundation/Models/ComponentProxyModel","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/UIHelper"],function(e,t,n,s){"use strict";const i={fetchParentTypesWithCallback:function(e,t){if("3DSpace"!==(e.serviceHosting||"3DSpace")||e.get("parentTypes"))t();else{var n=s.getParentTypesFromMap(e.get("type"));n?(e.set("parentTypes",n,{silent:!0}),t()):i.fetchParentTypes(e,{onComplete:function(){t()}})}},fetchParentTypes:function(n,i){var o=n.id;if(n instanceof t&&(o=o.replace("dscom:3DSpace_",""),n.isMBSE()))i&&i.onComplete&&i.onComplete();else{var a={url:"/resources/v3/e6w/service/ParentTypes/"+o,type:"GET",callback:function(e){if(e&&!e.error&&e.data||i&&i.onComplete&&i.onComplete.apply(n,arguments),e&&e.data&&e.data[0]){var t=e.data[0].parentTypes;n.set("parentTypes",t,{silent:!0}),s.addToParentTypesMap(n.get("type"),t),i&&i.onComplete&&i.onComplete.apply(n,arguments)}},dataType:"json",headers:{"content-type":"application/json"}};e.ajaxRequest(a)}},loadSubTypes:function(t){return new Promise((s,o)=>{n.isServiceDataLoaded()?n.getServiceUrl("3DSpace",!0)?e.ajaxRequest({url:`/resources/v3/e6w/service/TypeDerivatives?typePattern=${t}`,type:"POST",dataType:"json",callback:function(e){e.success?s(e.data[0].derivatives):o(e.error)}}):o("No access to 3dspace"):n.addEventOnce("serviceDataLoaded",()=>i.loadSubTypes(t).then(e=>{s(e)}).catch(e=>o(e)))})}};return i}),define("DS/E6WCommonApps/Models/InvokeSolver",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper"],function(e,t,n){"use strict";var s=t.createRequestQueue(1);return s.solve=function(i,o,a){var r=i&&i.additionalElementsToSolve||[];r.unshift(o);var l=i&&i.additionalParentElementsToSolve||[];a&&l.unshift(a);var d={IsWhatIf:!1};d[i&&i.listName||"ScheduleElementList"]=r,d.ParentScheduleElementList=l,d=[d];var c=t.getPendingRequests(s),p=new Set;c.forEach(function(e){var t=JSON.parse(e.options.data)[0];t.ParentScheduleElementList&&t.ParentScheduleElementList.forEach(e=>p.add(e)),t.ProjectList&&t.ProjectList.forEach(e=>p.add(e))});var u=d[0],h=!1;if(u.ParentScheduleElementList)for(let e of u.ParentScheduleElementList)if(!p.has(e)){h=!0;break}if(u.ProjectList)for(let e of u.ProjectList)if(!p.has(e)){h=!0;break}if(h){var m=e.clone(i||{},!1);m.onFailure=function(){return widget.alerter?n.displayWarning(n.i18n("SolverFailed")):console.log("Solver failed. Likely no solution found"),i&&e.is(i.onFailure,"function")&&i.onFailure.apply(this,arguments)},m.queue=s,m.data=d,t.invokeAsLRT("dsmf:xplan.Scheduler.JSONScheduleObjects?$mask=dsplan:MVMask.ScheduleElements.Complex",m)}else i&&i.onCancel&&i.onCancel()},s}),define("DS/E6WCommonApps/PreferenceUtils",[],function(){"use strict";return{get:function(e){return widget.getValue(e)},set:function(e,t){widget.setValue(e,t)},parse:function(e){return e?JSON.parse(e):e}}}),define("DS/E6WCommonApps/Models/E6WCommonAppsConstants",["UWA/Core","DS/E6WCommonUI/E6WCommonUIConstants"],function(e,t){"use strict";var n={TASK:"Task",TASK_RDF_TYPE:"dsplan:Task",URL_RDF_TYPE:"dsplan:url",ENDDATE_ATTR:"dsplan:estimatedEndDate",DSLC_ENDDATE_ATTR:"dsxplan:estimatedEndDate",STARTDATE_ATTR:"dsplan:estimatedStartDate",DSLC_STARTDATE_ATTR:"dsxplan:estimatedStartDate",ESTIMATED_DATE_ATTR:"dsplan:estimatedDate",SUGGESTED_DATE_ATTR:"dsplan:suggestedDate",RESOLUTION_ATTR:"dsplan:resolution",TASK_VOCABULARY_ATTR:"dsplan:hasTaskVocabulary",START_DATE_MIN_ATTR:"dsplan:startDateIntervalMin",START_DATE_MAX_ATTR:"dsplan:startDateIntervalMax",END_DATE_MIN_ATTR:"dsplan:endDateIntervalMin",END_DATE_MAX_ATTR:"dsplan:endDateIntervalMax",ACTUAL_START_DATE:"dsplan:actualStartDate",ACTUAL_END_DATE:"dsplan:actualEndDate",BASELINE_ESTIMATED_START_DATE:"dsplan:baselineEstimatedStartDate",BASELINE_ESTIMATED_END_DATE:"dsplan:baselineEstimatedEndDate",BASELINE_ACTUAL_START_DATE:"dsplan:baselineActualStartDate",BASELINE_ACTUAL_END_DATE:"dsplan:baselineActualEndDate",DSLC_ACTUAL_START_DATE:"dsxplan:actualStartDate",DSLC_ACTUAL_END_DATE:"dsxplan:actualEndDate",ACTUAL_DELIVERABLE_ATTR:"dsplan:actualDeliverable",ATTACHMENT_ATTR:"dsplan:hasAttachment",ASSIGNEE_ATTR:"dsplan:hasAssignee",USER_DEFINED_DATES_ATTR:"dsplan:userDefinedDates",USER_DEFINED_START_DATE_ATTR:"dsplan:userDefinedStart",USER_DEFINED_END_DATE_ATTR:"dsxplan:userDefinedEnd",CHILDREN_ATTR:"dsplan:hasWorkDecomposition",OBJECT:"Object",COMPLETE_PERCENT_ATTR:"dsplan:percentageCompletion",SEQUENCE_ORDER_ATTR:"dsplan:sequenceOrder",SEQUENCE_ORDER_ATTR_DSLC:"dsxplan:sequenceOrder",CALENDAR_ATTR:"dsxplan:scheduleCalendar",WORK_CONTEXT_ATTR:"dsxplan:hasWorkContext",RESTRICT_ASSIGNEE_ATTR:"dsxplan:restrictAssigneeAccess",RESTRICT_ASSIGNEE_ATTR_SERVER:"dsplan:restrictAssigneeAccess",STORY_POINTS:"dsplan:storyPoints",RESPONSE_ATTR:"dsplan:response",CHECKLIST_PARENT_ATTR:"dsplan:checklistParent",RESPONSE_ATTR:"dsplan:response",RICH_TEXT_FIELD:"dsplan:RichTextField",DURATION:"dsplan:duration",DURATION_RANGE:"dsplan:durationRange",DURATION_MIN:"dsplan:durationIntervalMin",DURATION_MAX:"dsplan:durationIntervalMax",DURATION_SUGGESTED:"dsplan:suggestedDuration",DURATION_ESTIMATED:"dsplan:estimatedDuration",DURATION_ESTIMATED_RANGE:"dsplan:estimatedDurationRange",DURATION_ACTUAL_RANGE:"dsplan:actualDurationRange",DURATION_ACTUAL:"dsplan:actualDuration",DEFAULT_END_HOUR:16,TITLE_ATTR:"title",ACCUMULATED_STORY_POINTS:"dsplan:accumulatedStoryPoints",ITERATION_CAPACITY:"dsplan:iterationCapacity",UNIQUE_OBJECT_ID_ATTR:"dsxplan:enterpriseIdentificationNumber",IMAGE_TILE_ATTR:"image_tile",INV_DSLC_TITLE_ATTR:"dskern:label",DSLC_DESCRIPTION_ATTR:"dsxplan:comment",HAS_SUB_TASKS:"dsxplan:hasSubtasks",PARENT_ATTR:"dsxplan:workscopeParent",HAS_PARENT_ATTR:"dsplan:hasParent",PARENT_HAS_SWYM_COMMUNITY:"dsplan:hasCommunity",PARENT_HAS_LEAN_BOARD:"dsxplan:hasLeanBoard",LASTUPDATED_ATTR:"dspol:modificationDate",CREATION_DATE_ATTR:"dspol:creationDate",WORKSCOPE_PARENT_ATTR:"dsxplan:workDecompositionParent",PARENT_REFERENCE_PROJECT_ATTR:"dsxplan:parentReferenceProject",CREATED_FROM_ATTR:"dsxplan:createdFrom",REFERENCE_PROJECT_ATTR:"dsxplan:hasReferenceProject",TASK_PARENT_ATTR:"dsxplan:taskParent",COMMON_TASK_PARENT_ATTR:"commonTaskParent",WORKSCOPE_PARENT_ALL_ATTR:"dsplan:workscopeParentForAll",MILESTONE_PARENT_ATTR:"dsxplan:workscopeParentForMilestone",GATE_PARENT_ATTR:"dsxplan:workscopeParentForGate",HAS_CHECKLIST_ATTR:"dsplan:hasChecklistItem",CHECKLIST_PARENT_ATTR:"dsplan:checklistParent",DSLC_DURATION_RANGE:"dsxplan:durationRange",DSLC_DURATION_MIN:"dsxplan:durationIntervalMin",DSLC_DURATION_MAX:"dsxplan:durationIntervalMax",DSLC_DURATION_ESTIMATED:"dsxplan:estimatedDuration",PRIORITY_ATTR:"dsplan:hasPriority",PRIORITY_HIGH:"dsxplan:High",PRIORITY_MEDIUM:"dsxplan:Medium",PRIORITY_LOW:"dsxplan:Low",PRIORITY_URGENT:"dsxplan:Urgent",STATE_OPEN:"dsxplan:Open",STATE_IN_PROGRESS:"dsxplan:InProgress",STATE_DONE:"dsxplan:Done",STATE_ATTR:"dscom:hasMaturity",STATE_DRAFT:"dsxplan:Draft",STATE_ON_HOLD:"dsxplan:OnHold",STATE_PUBLISHED:"dsxplan:Published",PUBLISHED_MATURITY_VALUE:"Published",BASELINE_STATE_OPEN:"Open",BASELINE_STATE_IN_PROGRESS:"InProgress",BASELINE_STATE_DONE:"Done",MILESTONE_SUBTYPE_EXTERNAL:"External",DSLC_STATE_ATTR:"dsxplan:hasMaturity",DSLC_PRIORITY_ATTR:"dsxplan:hasPriority",dslcMapping:{title:"dsxplan:label","dskern:label":"dsxplan:label","dsplan:durationIntervalMin":"dsxplan:durationIntervalMin","dsplan:estimatedStartDate":"dsxplan:estimatedStartDate","dsplan:accumulatedStoryPoints":"dsxplan:accumulatedStoryPoints","dsplan:estimatedEndDate":"dsxplan:estimatedEndDate","dsplan:comment":"dsxplan:comment","dsplan:sequenceOrder":"dsxplan:sequenceOrder","dsplan:durationIntervalMax":"dsxplan:durationIntervalMax","dsplan:estimatedDuration":"dsxplan:estimatedDuration","dsplan:endDateIntervalMin":"dsxplan:endDateIntervalMin","dsplan:endDateIntervalMax":"dsxplan:endDateIntervalMax","dsplan:startDateIntervalMax":"dsxplan:startDateIntervalMax","dsplan:startDateIntervalMin":"dsxplan:startDateIntervalMin","dsplan:solveStart":"dsxplan:solveStart","dsplan:solveEnd":"dsxplan:solveEnd","dsplan:percentageCompletion":"dsxplan:percentageCompletion","dsplan:actualStartDate":"dsxplan:actualStartDate","dsplan:actualEndDate":"dsxplan:actualEndDate","dsplan:actualDeliverable":"dsxplan:actualDeliverable","dscom:hasMaturity":"dsxplan:hasMaturity","dsplan:userDefinedDates":"dsxplan:userDefinedDates","dsplan:userDefinedStart":"dsxplan:userDefinedStart","dsplan:userDefinedEnd":"dsxplan:userDefinedEnd","dsplan:hasAssignee":"dsxplan:hasAssignee","dsplan:requiresSkill":"dsxplan:requiresSkill","rdf:type":"dsxplan:type",subtitle:"dsxplan:comment","dsplan:hasAttachment":"dsxplan:hasAttachment","dsplan:hasPriority":"dsxplan:hasPriority","dsplan:hasCommunity":"dsxplan:hasCommunity","dsplan:hasSubtask":"dsxplan:hasSubtask","dsplan:estimatedDate":"dsxplan:estimatedDate","dsplan:dateIntervalMax":"dsxplan:dateIntervalMax","dsplan:dateIntervalMin":"dsxplan:dateIntervalMin","dsplan:actualDate":"dsxplan:actualDate","dspol:modificationDate":"dsxplan:modificationDate","dsplan:suggestedDate":"dsxplan:suggestedDate","dsplan:ScheduleUpdateStatus":"dsxplan:ScheduleUpdateStatus","dsplan:schedulingStrategy":"dsxplan:schedulingStrategy","dskern:image":"dxplan:image","dsplan:hasThumbnail":"dsxplan:hasThumbnail","dsplan:hasWorkContext":"dsxplan:hasWorkContext","dsplan:hasWorkDecomposition":"dsxplan:hasWorkDecomposition","dsplan:hasTask":"dsxplan:hasTask","dsplan:hasBacklogTask":"dsxplan:hasBacklogTask","dsplan:hasMilestone":"dsxplan:hasMilestone","dsplan:hasGate":"dsxplan:hasGate","dsplan:hasReferenceProject":"dsxplan:hasReferenceProject","dsplan:hasContentRepository":"dsxplan:hasContentRepository","dsplan:scheduleCalendar":"dsxplan:scheduleCalendar","dsplan:reminderDays":"dsxplan:reminderDays","dsplan:enterpriseIdentificationNumber":"dsxplan:enterpriseIdentificationNumber","dsplan:vocabularyType":"dsxplan:vocabularyType","dsplan:jsType":"dsxplan:jsType"},attributeImpactingSolve:{"dsplan:durationIntervalMin":!0,"dsplan:durationIntervalMax":!0,"dsplan:startDateIntervalMin":!0,"dsplan:startDateIntervalMax":!0,"dsplan:estimatedStartDate":!0,"dsplan:endDateIntervalMin":!0,"dsplan:endDateIntervalMax":!0,"dsplan:estimatedEndDate":!0,"dsplan:hasAssignee":!0,"dsplan:actualStartDate":!0,"dsplan:actualEndDate":!0,"dscom:hasMaturity":!0,"dsplan:userDefinedDates":!0,"dsplan:userDefinedStart":!0,"dsplan:userDefinedEnd":!0,"dsxplan:workscopeParent":!0,"dsxplan:taskParent":!0,"dsxplan:scheduleCalendar":!0},attributeImpactingSubTaskSolve:{"dsplan:actualStartDate":!0,"dsplan:actualEndDate":!0,"dscom:hasMaturity":!0},PROGRAM:"Program",PROGRAM_RDF_TYPE:"dsplan:Program",PROJECT:"Project",XPROJECT:"Enterprise Project",TYPE_AGILE_PROJECT:"AgileProject",TYPE_XPROJECT:"xProject",PROJECT_RDF_TYPE:"dsplan:Project",XPROJECT_RDF_TYPE:"dsplan:xProject",AGILE_PROJECT_RDF_TYPE:"dsplan:AgileProject",DELETED_PROJECT_RDF_TYPE:"dsplan:DeletedProject",ACTUAL_DATES_STRATEGY_ATTR:"dsplan:actualDatesStrategy",SCHEDULING_FROM_STRATEGY_ATTR:"dsplan:schedulingFromStrategy",PLANNED_DATES_STRATEGY:"Keep Planned Dates",CURRENT_DATES_STRATEGY:"Use Current Dates",STARTDATE_SCHEDULINGFROM_STRATEGY:"Start Date",CURRENTDATE_SCHEDULINGFROM_STRATEGY:"Current Date",ENDDATE_SCHEDULINGFROM_STRATEGY:"End Date",PROJECT_TYPE:"dsplan:projectType",RELATED_PLANS:"dsxplan:relatedPlans",WORKPACKAGE:"WorkPackage",WORKPACKAGE_RDF_TYPE:"dsplan:WorkPackage",CONSTRAINT_RELATION_ATTR:"dsplan:hasConstraint",SHOW_SCHEDULE_HIGHLIGHTS:"_showScheduleHighlight",AUTOSOLVE_OFF:1,AUTOSOLVE_ON:2,ACTUAL_TYPE_ATTR:"dsplan:actualType",TYPE_ATTR:"@type",DESCRIPTION_ATTR:"subtitle",FONTICON_ATTR:"fonticon",KPI_RELATION_ATTR:"dsplan:hasSpecification",MILESTONE_VOCABULARY_ATTR:"dsplan:hasMilestoneVocabulary",MILESTONE_RDF_TYPE:"dsplan:Milestone",GATE_RDF_TYPE:"dsplan:Gate",MILESTONE_VOCABULARY_TYPE:"dsxplan:vocabularyType",MILESTONE:"Milestone",GATE:"Gate",OWNER_ATTR:"dskern:owner",CONTENT_REPOSITORY:"dsxplan:hasContentRepository",RISK_REPOSITORY:"dsplan:hasCollaborativeSpace",BOOKMARK_FOR_FILE_REPOSITORY:"dsplan:hasBookmark",REQUEST_TYPE_ADD:"addOperation",REQUEST_TYPE_REPLACE:"resetOperation",REQUEST_TYPE_REMOVE:"removeOperation",REQUEST_TYPE_PREVIEW:"previewOperation",REQUEST_TYPE_PROFILE:"viewProfileOperation",REQUEST_TYPE_EDIT:"editOperation",REQUEST_TYPE_ASSIGN:"assignOperation",REQUEST_TYPE_DELETE:"deleteOperation",NO_SOLVER_ERROR:"dsxplan:NoSolverError",PARENT_CHILD_ERROR:"ParentChildError",TRANSIENT_CONSTRAINT_ERROR:"TransientConstraintError",RESOURCE_AFFECTATION:"ResourceAffectation",RESPONSIBILITY_LEADER:"dsplan:Leader",RESPONSIBILITY_VIEWER:"dsplan:Viewer",RESPONSIBILITY_AUTHOR:"dsplan:Author",APP_3DPLAN:"ENXPLAN_AP",APP_TSK:"ENOTASK_AP",APP_RELATIONS:"ENORIPE_AP",PRIORITY_LOW_ICON:"fonticon-low",PRIORITY_MEDIUM_ICON:"fonticon-medium",PRIORITY_HIGH_ICON:"fonticon-high",PRIORITY_URGENT_ICON:"fonticon-alert",TODO_STATE_COLOR:"#488EB8",IN_PROGRESS_STATE_COLOR:"#005686",DONE_STATE_COLOR:"#B5B6BA",DROP_CLASS_NAME:"drag-over",STATE_FOR_DISPLAY_ATTR:"stateForDisplay",PRIORITY_DISPLAY:"priority",DUE_DATE_CATEGORY:"dueDateCategory",COOWNERATTR:"co-owners",PERCENT_COMPLETE:"percentComplete",SIMULATION_TYPE:"Simulation",SIMULATION_TEMPLATE_TYPE:"Simulation Template",PAST_DUE:"PAST_DUE",NO_DATE:"NO_DATE",DUE_TODAY:"DUE_TODAY",DUE_TOMORROW:"DUE_TOMORROW",DUE_THIS_WEEK:"DUE_THIS_WEEK",DUE_FUTURE:"DUE_FUTURE",EXPLICIT_TAGS_DATA:"explicitTagsData",TAGS_DATA:"tagsData",USER_TAGS:"userTags",TEAM_MEMBERS:"team_members",ALL_LEVEL_TASKS:"allLevelTasks",FIRST_LEVEL_TASKS:"firstLevelTasks",LEVEL_PREF:"taskLevelPref",NONRDF_ATTACHMENT_ATTR:"references",NONRDF_DELIVERABLE_ATTR:"deliverables",SCHEDULE_ERROR_ATTR:"dsplan:hasScheduleError",DEPENDENCY_FILTER_TYPE:"dependencyType",DEPENDENCY_FILTER_STATUS:"dependencyStatus",DEPENDENCY_FILTER_SOURCE:"dependencySource",DEPENDENCY_FILTER_SUBPROJECTS:"subprojectDependencies",DEPENDENCY_FILTER_ALL:"all",DEPENDENCY_TYPE_ENFORCED:"enforced",DEPENDENCY_TYPE_FLEXIBLE:"flexible",DEPENDENCY_STATUS_BROKEN:"broken",DEPENDENCY_STATUS_OK:"OK",DEPENDENCY_SOURCE_EXTERNAL:"external",DEPENDENCY_SOURCE_INTERNAL:"internal",SCOPEATTR:"scopes",DPMPROJECTATTR:"DPMProject",BUSINESS_METHOD_TEMPLATE:"businessMethodTemplate",BUSINESS_METHOD_SNAPSHOTDATE:"snapshotDate",DUPLICATE_TASK:"duplicate",SPLIT_TASK:"split",ADD_AS_REFERENCE:"reference",ADD_AS_SUBPROJECT:"subproject",ACTIVE:"Active",COMPLETE:"Complete",TASK_TABLE:"taskTable",ONE_DAY:864e5,REMINDER_DAYS:"dsxplan:reminderDays",PREVIEW:"Preview",SHOW_CONTEXT_FILTER:"showContextFilter",GET_FIRST_LEVEL_LEAF_TASKS_URL:"invoke/dsxplan:getFirstLevelLeafTasks?$mask=dsplan:MVMask.Task.CollaborativeTask.Basic",OWNER_RESPONSIBILITY_ATTR:"ownerResponsibilityModel",ASSIGNEE_RESPONSIBILITIES_ATTR:"assigneeResponsibilityModels",RICH_TEXT_DESCRIPTION:"richTextDescription"};return e.merge(n,t),n}),define("DS/E6WCommonApps/CSRFUtil",["UWA/Core","DS/DocumentManagement/DocumentFoundationAjax","DS/ENOProjectMgmtModels/Models/CSRFDataModel"],function(e,t,n){"use strict";var s={getCsrf:function(e){var n={url:"/resources/v1/application/E6WFoundation/CSRF",type:"get",dataType:"json",callback:function(t){t&&t.csrf&&e(t.csrf)},headers:{"content-type":"application/json"}};return t.ajaxRequest(n)},checkAndSetCSRF:function(t,i){let o=e.clone(t||{},!1),a=n.prototype.getCSRF();a.value?(o.csrf=a,i(o)):s.getCsrf(e=>{n.prototype.setCSRF(e.value),o.csrf=e,i(o)})}};return s}),define("DS/E6WCommonApps/SharedWidgetUwaUtils",["UWA/Core","UWA/Class","UWA/Array","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,n,s,i,o){"use strict";var a={processStorages:function(t,n,s){var o=e.clone(s||{},!1),r=widget.getValue("x3dPlatformId"),l=r&&t.find(function(e){return e.platformId.toUpperCase()===r.toUpperCase()});l&&(l["3DSpace"]||l[o.additionalStorage])?(enoviaServer.storageUrl=l.url,enoviaServer.tenant=l.platformId,enoviaServer.swym=l["3DSwym"],enoviaServer.searchUrl=l["3DSearch"],enoviaServer.tenantDisplayName=l.displayName,e.extend(enoviaServer,l),i.setInvalidTenant(),widget.setValue("x3dPlatformId",enoviaServer.tenant)):(i.setInvalidTenant(r),a.showTenantError())},onRefresh:function(){var e=window.parent.document.getElementById("frame-"+widget.id);e.src=e.src},showTenantError:function(){if(widget.alerter){var e=o.get("E6WCommonUI.Warning.TenantNotAvailable");s.displayError(o.replace(e,{TENANT:i.getInvalidTenant()}))}},setStoragesPrefs:function(e,t,n,s){var i=[];t.forEach(function(e){n===e.platformId&&(enoviaServer.storageUrl=e.url,enoviaServer.tenant=e.platformId),i.push({label:e.displayName,value:e.platformId})}),e.addPreference({name:"collabstorage",type:"list",defaultValue:enoviaServer.tenant,options:i,label:WidgetConstants.str.CollaborativeStorages,onchange:"onStorageChange"}),"false"!==s.toLowerCase()&&e.addPreference({name:"collabspace",type:"list",defaultValue:"",options:[{label:"",value:""}],label:WidgetConstants.str.CollaborativeSpaces})}};return a}),define("DS/E6WCommonApps/Views/SignaturePopup",["UWA/Core","UWA/Class/Listener","DS/UIKIT/SuperModal","DS/UIKIT/Input/Password","DS/UIKIT/Input/Text","DS/UIKIT/Input/Toggle","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r){"use strict";var l=function(e){return r.get(e)};return n.extend({init:function(n){this._parent.apply(this,arguments);var s=e.clone(n||{},!1);this._initializeOptionsForDialog(s),this._listener=new t,this.dialog(this._createDialog()),this._setFocusToFirstField(),this._setDisabledClassOnSignButton(!0),this._parent.apply(this,arguments)},_initializeOptionsForDialog:function(t){this.container=e.createElement("div"),this._callback=t.callback},_setFocusToFirstField:function(){a.isIpad()||a.isAndroid()||this.container.getElement("[id='username']").focus()},destroy:function(){this.destroyed||(this.dispatchEvent("onDestroy",[this]),this._listener&&(this._listener.stopListening(),delete this._listener),this._modalRef&&(this._modalRef.destroy(),delete this._modalRef),this._parent.apply(this,arguments),this.destroyed=!0)},modalFactory:function(){var e=this;return this._modalRef=this._parent.apply(this,arguments),this._listener.listenTo(this,"onHide",function(){e.destroy()}),this._modalRef},getBody:function(){return this._modalRef&&this._modalRef.getBody()},_getTitle:function(){return this._dialogTitle||l("E6WCommonApps.Signature.Title")},_setDisabledClassOnSignButton:function(e){var t=document.getElementsByClassName("modal")[0];t&&t.getElement(".btn-create").toggleClassName("disabled",e)},_validate:function(){var e=function(e){return!e||e.trim&&!e.trim().length},t=e(this.usernameField.getValue())||e(this.passwordField.getValue())||!this.toggleField.isChecked();this._setDisabledClassOnSignButton(t)},_createDialog:function(){var t=this;e.createElement("p",{html:l("E6WCommonApps.Signature.Instructions")}).inject(this.container),e.createElement("label",{text:l("E6WCommonApps.Signature.Label.Id")}).inject(this.container);this.usernameField=new i({id:"username",label:l("E6WCommonApps.Signature.Label.Id"),placeholder:l("E6WCommonApps.Signature.Placeholder.UserName"),events:{onChange:function(e){t._validate()}}}).inject(this.container);e.createElement("label").inject(this.container);return this.passwordField=new s({id:"password",placeholder:l("E6WCommonApps.Signature.Placeholder.Password"),events:{onChange:function(e){t._validate()}}}).inject(this.container),this.toggleField=new o({id:"readAndUnderstands",type:"checkbox",label:l("E6WCommonApps.Signature.ReadAndUnderstands"),checked:!1,events:{onChange:function(e){t._validate()}}}).inject(this.container),{body:this.container,title:this._getTitle(),buttons:[{className:"primary btn-create",value:l("E6WCommonApps.Signature.Label.OK"),action:function(){t.save()}},{className:"default",value:l("E6WCommonApps.Signature.Label.Cancel"),action:function(){t.destroy()}}]}},save:function(){this.destroy(),this._callback&&this._callback({username:this.usernameField.getValue(),password:this.passwordField.getValue()})}})}),define("DS/E6WCommonApps/Views/RichTextEditorConfig",["DS/E6WCommonUI/PlatformManager"],function(e){"use strict";var t={},n={paragraphStyle:{command:"paragraphCommand",toolbar:"paragraph",label:"Paragraph",style:"p",type:"style"},h1Style:{command:"h1Command",toolbar:"paragraph",label:"Heading 1",style:"h1",type:"style"},h2Style:{command:"h2Command",toolbar:"paragraph",label:"Heading 2",style:"h2",type:"style"},BulletedListStyle:{command:"BulletedListCommand",toolbar:"paragraph",ckCommand:"bulletedlist",label:"Insert/Remove Bulleted List",style:"ul",type:"command"},NumberedListStyle:{command:"NumberedListCommand",ckCommand:"numberedlist",toolbar:"paragraph",label:"Insert/Remove Numbered List",style:"ol",type:"command"},BlockquoteStyle:{command:"BlockquoteCommand",toolbar:"paragraph",ckCommand:"blockquote",label:"Block Quote",style:"blockquote",type:"command"}};return t.getConfig=function(t){var s="../../E6WCommonApps/assets/ckeditor/";CKEDITOR.plugins.addExternal("resize",s+"plugins/resize/","plugin.js"),CKEDITOR.plugins.addExternal("autogrow",s+"plugins/autogrow/","plugin.js"),CKEDITOR.plugins.addExternal("custmaximize",s+"plugins/maximize/","plugin.js"),CKEDITOR.plugins.addExternal("custtoolbar",s+"plugins/toolbar/","plugin.js"),CKEDITOR.plugins.addExternal("imageresize",s+"plugins/imageresize/","plugin.js"),CKEDITOR.plugins.addExternal("highlight",s+"plugins/highlight/","plugin.js"),function(){for(let e in n)n.hasOwnProperty(e)&&!CKEDITOR.plugins.registered[e]&&CKEDITOR.plugins.add(e,{init:function(e){var t=this.name;e.addCommand(n[t].command,{contextSensitive:!0,exec:function(e,s){if(!s)for(let s in e.toolbar)if(e.toolbar.hasOwnProperty(s)&&e.toolbar[s].hasOwnProperty("name")&&e.toolbar[s].hasOwnProperty("items")&&"paragraph"===e.toolbar[s].name){let i=e.toolbar[s].items;for(let s in i)i.hasOwnProperty(s)&&i[s].hasOwnProperty("type")&&"button"===i[s].type&&i[s].getState()===CKEDITOR.TRISTATE_ON&&i[s].command!==n[t].command&&e.execCommand(i[s].command,!0)}const i=this.state===CKEDITOR.TRISTATE_ON?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_ON;"command"===n[t].type?e.execCommand(n[t].ckCommand):e[this.state===CKEDITOR.TRISTATE_ON?"removeStyle":"applyStyle"](new CKEDITOR.style({element:n[t].style})),this.setState(i)},refresh:function(e,s){if(s&&s.block){var i=s.block.getName();"p"!==i&&"li"!==i||(i=s.block.getParent().getName()),this.setState(i===n[t].style?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}}}),e.ui.addButton(n[t].command,{label:n[t].label,command:n[t].command,toolbar:n[t].toolbar})}})}();var i=["custtoolbar","autogrow","resize","custmaximize","imageresize","customlink","pastefromword","h1Style","h2Style","paragraphStyle","BulletedListStyle","NumberedListStyle","BlockquoteStyle"],o=["BulletedListCommand","NumberedListCommand","BlockquoteCommand","formattedCommand","Table","-"];t.richTextField&&(CKEDITOR.plugins.addExternal("base64image",s+"plugins/base64image/","plugin.js"),i.push("base64image"),o.push("base64image")),t.isRoute||i.push("quicktable");var a=[{name:"basicstyles",groups:["paragraph","cleanup"],items:["Undo","Redo","-","paragraphCommand","h1Command","h2Command","-"]},{name:"basicstyles",items:["Bold","Italic","Underline","Strike"]},{name:"format",items:o},"/",{name:"paragraph",items:["Outdent","Indent","-","Highlight"]},{name:"links",items:["RemoveFormat","Link","Unlink"]},{name:"styles",items:["TextColor","BGColor"]}];return t.isRoute&&(a=[{name:"links",items:["Link","Unlink"]}]),{extraPlugins:i,resize_enabled:!1,allowedContent:!0,startupFocus:!1,language:e.getCurrentLanguage(),toolbar:a,height:100,toolbarStartupExpanded:!1,toolbarCanCollapse:!t.isRoute,autoGrow_minHeight:100,autoGrow_onStartup:!1,removeButtons:t.isRoute?"Source,Save,Cut,Undo,Find,SelectAll,NewPage,Preview,Print,PasteFromWord,PasteText,Paste,Copy,Redo,Templates,Replace,Checkbox,Form,Scayt,Radio,TextField,Textarea,Select,Button,ImageButton,HiddenField,CopyFormatting,Subscript,Superscript,NumberedList,BulletedList,Blockquote,Indent,Outdent,CreateDiv,JustifyLeft,JustifyCenter,JustifyRight,JustifyBlock,Language,BidiRtl,BidiLtr,Anchor,Image,Flash,Table,HorizontalRule,Smiley,SpecialChar,PageBreak,Iframe,FontSize,Font,Format,Styles,Maximize,ShowBlocks,BGColor,TextColor,About":"",removeDialogTabs:"image:advanced;link:advanced",removePlugins:"customlink,maximize,image,elementspath,about,a11yhelp,dialogadvtab,bidi,templates,newpage,exportpdf,pagebreak,scayt,wsc,forms,div,flash,smiley,save,print,preview",linkShowTargetTab:!1}},t}),define("DS/E6WCommonApps/Models/Document/DriveDocument",["UWA/Core","UWA/Class"],function(e,t){"use strict";return t.extend({data:{title:null,fileName:null,file:null,icon:null,id:null,type:null,document:null,fileData:null,serviceId:"3DDrive"},init:function(t,n){var s=e.clone(t||{},!1);this._setupDocument(s,n)},_setupDocument:function(t,n){var s=e.clone(t||{},!1);this.set("title",s.title),this.set("icon",s.icon),this.set("id",s.id),this.set("type",s.type),this.set("file",n),this.set("type",s.type),this.set("fileName",n?n.name:s.title)},get:function(e){if(this.data[e])return this.data[e]},set:function(e,t){this.data[e]=t}})}),define("DS/E6WCommonApps/Views/DocumentFileChooserPopup",["UWA/Core","UWA/Class/Listener","DS/UIKIT/SuperModal","DS/UIKIT/Input/File","DS/UIKIT/Input/Text","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,n,s,i,o,a,r){"use strict";var l=function(e){var t=r.get(e);return t===e&&(t=a.get(e)),t};return n.extend({init:function(n){this._parent.apply(this,arguments);var s=e.clone(n||{},!1);this._initializeDialogOptions(s),this._listener=new t,this.dialog(this._createDialog(s)),this._parent.apply(this,arguments)},_initializeDialogOptions:function(t){this.container=e.createElement("div")},_createDialog:function(t){var n=this;n.docModel=t.docModel.contentModel||t.docModel,n.fileInfo={},this.fileField=new s({id:"fileSelect",multiple:!1,label:l("E6WCommonUI.Label.File"),placeholder:l("E6WCommonUI.Label.FileChooser"),buttonClassName:"primary",events:{onChange:function(e){n.fileInfo.file=e.target.files}}}).inject(this.container);e.createElement("label",{text:l("E6WCommonApps.Command.Comments")}).inject(this.container);return this.commentsField=new i({id:"filecomments",label:l("E6WCommonApps.Command.Comments"),placeholder:l("E6WCommonApps.Command.Comments"),events:{onChange:function(e){n.fileInfo.comment=e.target.value}}}).inject(this.container),{body:this.container,title:l("E6WCommonUI.Label.Update"),buttons:[{className:"primary btn-create",value:l("E6WCommonUI.Label.Update"),action:function(e){e.hide(),o.updateDocumentConfirmation(n.fileInfo.file,n.docModel,t.updateDocumentCallback,n.fileInfo.comment)}},{className:"default",value:l("E6WCommonUI.Label.Cancel"),action:function(e){e.hide()}}]}}})}),define("DS/E6WCommonApps/Models/NoAccessModel",["DS/RDFFoundation/Models/NoAccessModel"],function(e){"use strict";return e}),define("DS/E6WCommonApps/Models/RollUpModel",["DS/RDFFoundation/Models/ResultModel"],function(e){"use strict";return e.extend({isDSLC:function(){return!0},dslcMapping:{"dsplan:estimatedEndDate":"dsxplan:estimatedEndDate","dsplan:estimatedStartDate":"dsxplan:estimatedStartDate","dsplan:accumulatedStoryPoints":"dsxplan:accumulatedStoryPoints"},_propertyDictionary:{"dsplan:isRolledUpInfoFor":{inverseProperty:"dsplan:hasRolledUpInfo"}},hasViewAccess:()=>!0})}),define("DS/E6WCommonApps/Models/SolverModelMixin",[],function(){"use strict";return{setup:function(){this._previous.apply(this,arguments),this.listenTo(this,"onChange:solveCounter",function(){var e=this.getParent&&this.getParent();e&&(e.solveCounter+=this.solveCounter-this.prevSolveCounter)})},prevSolveCounterDef:{get:function(){return this.previousAttributes().solveCounter||0}},solveCounterDef:{get:function(){return this.get("solveCounter")||0},set:function(e){this.set("solveCounter",e)}}}}),define("DS/E6WCommonApps/Views/CreateDialogTabMixin",["UWA/Core","UWA/Class/Listener","UWA/Element","UWA/Class/Events","DS/Controls/TabBar","DS/Controls/ComboBox","DS/WAFData/WAFData","DS/RDFFoundation/CustomExtensionUtils","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d,c,p){"use strict";var u=function(e){var t=p.get(e);return t===e&&(t=c.get(e)),t};return{_setupTabBar:function(){this.tabBar=new i({displayStyle:"strip"}),this.tabBar.add({label:u("E6WCommonApps.Command.Properties"),icon:{iconName:"attributes",fontIconFamily:WUXManagedFontIcons.Font3DS},showTitleFlag:!1,isSelected:!0}),this.tabBar.add({label:u("E6WCommonUI.Label.AttributeExtensions"),icon:{iconName:"properties",fontIconFamily:WUXManagedFontIcons.Font3DS},showTitleFlag:!1}),this.tabBar.addEventListener("tabButtonClick",()=>{this._updateFormDisplay()}),this._dialogTabContainer=this.container.getElement("#dialogTab"),this._propertiesForm=this.container.getElement("#propertiesContainer"),this._extendedAttributesContainer=this.container.getElement("#extendedAttributesContainer"),this._extendedAttributes=this.container.getElement("#extensionAttributes"),this.tabBar.inject(this._dialogTabContainer,"top"),this._templateComboBox=new o({elementsList:[],selectedIndex:0,enableSearchFlag:!1}),this._templateComboBox.addEventListener("change",()=>{this.charEditor&&this.charEditor.destroy(),this.charEditor=void 0,""===this._templateComboBox.value?(this._extendedAttributes.innerHTML="",this.tabBar&&this.tabBar.getButtonFromValue(1).elements.container.classList.remove("has-error")):this._refreshCharacteristicEditorView()}),this._templateComboBox.inject(this.container.getElement("#extensionSelector"))},_updateFormDisplay:function(){if(this._tabSelected=0!==this.tabBar.value[0],this._propertiesForm.toggleClassName("hide",this._tabSelected),this._extendedAttributesContainer.toggleClassName("hide",!this._tabSelected),!this._extendedAttributesContainer.classList.contains("hide")){var e=this._detailsView&&this._detailsView.model||this._detailsViewCreateTask&&this._detailsViewCreateTask.model,t=e.get("@type")||e["dsplan:actualType"];let n=[...new Set(r.getExtensionsForTaxonomy(t))];n.splice(0,0,{value:"",label:u("E6WCommonUI.Label.SelectExtension")}),this._updateExtensionsField(n)}},_updateExtensionsField:function(e){this._extendedAttributes&&e&&e.length&&(this._templateComboBox.elementsList=e)},_refreshCharacteristicEditorView:function(){this._extendedAttributes&&(this._extendedAttributes.innerHTML="",""!==this._templateComboBox.value&&this._loadCustomAttributesView())},_loadCustomAttributesView:function(){var e=this,n=this._templateComboBox&&this._templateComboBox.value,s={rdfServerURL:l.getServiceUrl("3dplan")+"/",resourceURI:n,platformId:l.getTenant(),customization:{editMode:!0,onChangeSensitive:!1,display:{title:!1,subtitle:!1,switchMode:!1,scroller:!1,buttons:!1,switchLanguage:!1,characteristics:{tooltip:!0}},getInfos:function(){var e={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","Accept-Language":widget.lang};return new Promise(function(t,s){a.authenticatedRequest(l.getServiceUrl("3dplan")+"/resources/v1/templates/"+n+"/parameters",{method:"GET",headers:e,type:"json",onComplete:function(e){var n={},s=["dskern:nlsLabel","dskern:nlsComment"];Object.keys(e).forEach(function(t){s.includes(t)?delete e[t]:(e[t].ReadOnly=!1,n[t]=e[t].value)}),t({characteristics:n,schema:{characteristics:e}})},onFailure:function(e,t,n){s(n)},timeout:3e5})})}},events:{onValueChange:function(){var t=e.charEditor.elements.form,n=!0;t.unvalidate(),t.getAllInputInstances().forEach(function(e){e.validateForForm()||(n=!1)}),e.charEditor.dispatchEvent("areCustomAttributesValid",[n])}}};d.loadJSDependency("DS/dsbaseUIControls/CharacteristicsView").then(n=>{e.charEditor=new n(s),e.charEditor.inject(e._extendedAttributes),e._listener=new t,e._listener.listenTo(e.charEditor,"areCustomAttributesValid",function(t){t&&e.tabBar?e.tabBar&&e.tabBar.getButtonFromValue(1).elements.container.classList.remove("has-error"):e.tabBar&&e.tabBar.getButtonFromValue(1).elements.container.classList.add("has-error")})}).catch(e=>{"scripterror"===e.requireType&&console.error(e.message)})}}}),define("DS/E6WCommonApps/Views/LifecycleMenu",["DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s){"use strict";const i=s.get.bind(s),o=[{id:n.STATE_DRAFT,cssSuffix:"draft",labelAfter:i("E6WCommonApps.Label.SaveAsDraft")},{id:n.STATE_OPEN,cssSuffix:"todo",labelBefore:i("E6WCommonApps.Label.Start"),labelAfter:i("E6WCommonApps.Label.Restart")},{id:n.STATE_IN_PROGRESS,cssSuffix:"inwork",labelBefore:i("E6WCommonApps.Label.BeginWork"),labelAfter:i("E6WCommonApps.Label.BackToInWork")},{id:n.STATE_ON_HOLD,cssSuffix:"onhold",labelBefore:i("E6WCommonApps.Label.PutOnHold"),labelAfter:i("E6WCommonApps.Label.PutOnHold")},{id:n.STATE_DONE,cssSuffix:"completed",labelBefore:i("E6WCommonApps.Label.MarkAsComplete")}],a={_buildItem:function(s,i,o){return{type:"PushItem",title:o?i.labelBefore:i.labelAfter,fonticon:{content:`fonticon fonticon-status-change maturity-state-${i.cssSuffix}${o?"":" demote"}`,family:"DSFontIcon"},action:{callback:()=>{s.set([n.STATE_ATTR],e.getObjectForAdding(t,i.id)),s.save()}}}},build:function(e){const t=[],s=o.findIndex(t=>{return(e.get(n.STATE_ATTR).id||e.get(n.STATE_ATTR))===t.id});return o.forEach((n,i)=>{if(s!==i){const o=a._buildItem(e,n,s<i);o&&t.push(o)}}),t}};return a}),define("DS/E6WCommonApps/Views/WorkscopeStartStopView",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonUI/Views/StartStopView"],function(e,t,n){"use strict";return n.extend({setup:function(){this._parent.apply(this,arguments)},_highlightValidationErrors:function(){if(this._parent.apply(this,arguments),this.model&&this.model.validationError&&this.model.validationError.fields){var e,t,n=this._config;-1!==this.model.validationError.fields.indexOf(n.name)?(e=n.name,t=this.container&&this.container.getElement(".start")):-1!==this.model.validationError.fields.indexOf(n.endDateAttribute)&&(e=n.endDateAttribute,t=this.container&&this.container.getElement(".stop"));var s=this.model.validationError.messages&&this.model.validationError.messages[e];s&&this._displayValidationError(s,t)}},_displayValidationError:function(t,n){this._errorSpanNode||(this._errorSpanNode=e.createElement("span",{class:"form-control-error-text"})),this._errorSpanNode.inject(n),this._errorSpanNode.setText(t)},_clearValidationErrors:function(){this._errorSpanNode&&this._errorSpanNode.remove();var e=this.container,t=e&&e.getElement(".start");t&&t.toggleClassName("has-error",!1);var n=e&&e.getElement(".stop");n&&n.toggleClassName("has-error",!1)},render:function(){if(this._parent.apply(this,arguments),this.model&&this._config.name===t.START_DATE_MIN_ATTR){let s=this.model.get(t.SCHEDULING_FROM_STRATEGY_ATTR);var n;s===t.ENDDATE_SCHEDULINGFROM_STRATEGY?n=this.container.getElement(".stop label span"):s===t.STARTDATE_SCHEDULINGFROM_STRATEGY&&(n=this.container.getElement(".start label span")),n&&e.createElement("span",{class:"required-field-indicator",text:"*"}).inject(n)}return this}})}),define("DS/E6WCommonApps/TaggerChipColorMixin",["UWA/Core","UWA/Class/Listener","DS/E6WCommonApps/ColorUtil","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS"],function(e,t,n,s,i,o){"use strict";var a=function(e){var t=o.get(e);return t===e&&(t=i.get(e)),t},r={_stopListeningToTaggerEvents:function(){this.stopListening&&this.stopListening(void 0,"onChangeTaggerColoring")},addTaggerChipColorChangeEvents:function(t){var n=e.clone(t||{},!1).model||this.model;this._stopListeningToTaggerEvents(),this.listenTo(n,"onChangeTaggerColoring",function(){this.colorTaggerChip(t)})},addTaggerChipColorChangeEventsForMilestoneGroupView:function(){var e=this;this._stopListeningToTaggerEvents(),this.options.milestoneCollection.forEach(function(t){let n=t.rdfModel||t;e.listenTo(n,"onChangeTaggerColoring",function(){var s={container:e.getBody().getElement('li[milestone-id="'+t.id+'"]'),model:n};e.colorTaggerChip.apply(s)})})},colorTaggerChip:function(t){var s=e.clone(t||{},!1).model||this.model,i=this.container;if(s.tagColor){i.style.setProperty("--te-fill",s.tagColor);const e=n.getHighlightColorForTaggedObject(s.tagColor);i.style.setProperty("--te-highlight",e),i.toggleClassName&&i.toggleClassName("tag-color",!0)||i.classList.add("tag-color")}else i.removeClassName&&i.removeClassName("tag-color")||i.classList.remove("tag-color"),i.style.removeProperty("--te-fill"),i.style.removeProperty("--te-highlight")},getTaggerChipElement:function(){return e.createElement("span",{class:"tag-color-chip"})},getMilestoneTaggerChipElement:function(){var e=this.createSVGElement("svg",{class:"tag-color-chip",width:8,height:16,x:0,y:2,viewBox:"0 0 8 16"});return this.createSVGElement("path",{class:"badge",d:"M6,16H2c-1.1,0-2-0.9-2-2V2c0-1.1,0.9-2,2-2h4c1.1,0,2,0.9,2,2v12C8,15.1,7.1,16,6,16z"}).inject(e,"top"),e},setTaggerColorMap:function(e){var t={"ds6w:why/ds6w:priority":[{object:a("E6WCommonApps.Label.Low"),type:"string",color:"#57b847"},{object:a("E6WCommonApps.Label.Medium"),type:"string",color:"#00b8de"},{object:a("E6WCommonApps.Label.High"),type:"string",color:"#e87b00"},{object:a("E6WCommonApps.Label.Urgent"),type:"string",color:"#ea4f37"}],"ds6w:what/ds6w:status":[{object:a("emxCollaborativeTasks.Label.ToDo"),type:"string",color:s.TODO_STATE_COLOR},{object:"Project Task.Assign",type:"string",color:s.TODO_STATE_COLOR},{object:"ds6w:status.task_open",type:"string",color:s.TODO_STATE_COLOR},{object:"Project Task.Create",type:"string",color:s.TODO_STATE_COLOR},{object:a("emxCollaborativeTasks.Label.InWork"),type:"string",color:s.IN_PROGRESS_STATE_COLOR},{object:"Project Task.Active",type:"string",color:s.IN_PROGRESS_STATE_COLOR},{object:"Project Task.Review",type:"string",color:s.IN_PROGRESS_STATE_COLOR},{object:"ds6w:status.task_inprogress",type:"string",color:s.IN_PROGRESS_STATE_COLOR},{object:a("emxCollaborativeTasks.Label.Completed"),type:"string",color:s.DONE_STATE_COLOR},{object:"Project Task.Complete",type:"string",color:s.DONE_STATE_COLOR},{object:"ds6w:status.task_done",type:"string",color:s.DONE_STATE_COLOR}]};e.setColorMap(t)},TAG_COLOR_CLASS:"tag-color",TAG_COLOR_CHIP_CLASS:"tag-color-chip"};return r}),define("DS/E6WCommonApps/Views/StoryPointsView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/NumberView","DS/E6WCommonApps/Models/E6WCommonAppsConstants","text!DS/E6WCommonUI/assets/templates/storyPoints.html.handlebars"],function(e,t,n,s,i){"use strict";var o=t.compile(i),a=n.extend({_uwaClassName:"StoryPointsView",tagName:"div",name:"E6WCommonApps.StoryPointsView",setup:function(){this.model&&this.model.addEvent&&this._config.name&&this.listenTo(this.model,"onChange:"+this._config.name,function(){this._toggleStoryPointsAttention()}),this._parent.apply(this,arguments)},render:function(){var e=this._parent.apply(this,arguments);return this._toggleStoryPointsAttention(),e},_toggleStoryPointsAttention:function(){var e=this.container.getElement(".input-group.accumulated-story-points .input-element");this.model&&this.model.get(s.ACCUMULATED_STORY_POINTS)>this.model.get(s.ITERATION_CAPACITY)?e.toggleClassName("has-error",!0):e.toggleClassName("has-error",!1)}});return a.prototype.compiledTemplate=o,a}),define("DS/E6WCommonApps/Views/ProcessImageView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/ObjectView","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/E6WCommonAppsConstants","text!DS/E6WCommonUI/assets/templates/imageUpload.html.handlebars","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a){"use strict";var r=a.get.bind(a);return n.extend({compiledTemplate:t.compile(o),_uwaClassName:"E6WCommonUIProcessImageView",tagName:"div",name:"E6WCommonUI.ProcessImageView",domEvents:{"click .ds-drop-target-overlay":"_openFileExplorer","click .plan-image-clear":"_removeImage"},render:function(){this._parent.apply(this,arguments),this.container.getElement(".plan-image-clear").toggleClassName("disabled",void 0===this.model.get(this._config.name))},handleDrop:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault();var n=e.Event.getElement(t);n.removeClassName(i.DROP_CLASS_NAME);var o=t.dataTransfer.files,a=r("E6WCommonApps.Error.GenericNotSupported");if(this.canReadWrite()){if(o&&o.length)return void this._processImage(n,o);var l=s.getDataTransferJSON(t.dataTransfer);if(a=r("E6WCommonApps.Error.ObjectPreviewNotAvailable"),l&&l.data&&l.data.items&&l.data.items.length>0){var d=l.data.items[0];if(d.displayPreview)return void this._processObjectPreview(n,d.displayPreview)}}s.displayError(a)},_processImage:function(t,n){if(n&&!n[0].type.contains("image"))s.displayError(r("E6WCommonUI.Error.UnsupportedFileType"));else{var i=this,o=this._config,a=e.clone(this._options||{},!1),l=t.getElement("img");n&&n.length&&s.processDroppedImage(n,l,function(e){e&&i.model&&i.model.set(o.name,e,a)})}},_processObjectPreview:function(t,n){var i=this,o=this._config,a=e.clone(this._options||{},!1),l=t.getElement("img");s.processDroppedObjectPreview(n,l,function(e){e?i.model&&i.model.set(o.name,e,a):s.displayError(r("E6WCommonApps.Error.ObjectPreviewNotAvailable"))})},_openFileExplorer:function(){var e=this.container.getElement(".plan-image-clear");if(event.target!==e&&event.target.parentElement!==e){var t=this;s.openFileExplorer({callback:function(e){var n=t.container.getElement(".form-control");t._processImage(n,e)},accept:"image/*"})}},_removeImage:function(){this.model&&this.model.set(this._config.name,void 0)}})}),define("DS/E6WCommonApps/ScheduleConstants",["UWA/Core","UWA/Utils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],function(e,t,n,s){"use strict";var i={PROGRAM_MANAGER_LABEL:"Program Manager",PROJECT_MANAGER_LABEL:"Project Manager",WORKPACKAGE_MANAGER_LABEL:"Work Package Manager",MILESTONE:"Milestone",GATE:"Gate",ACTUAL_DATE:"dsplan:actualDate",GATE_RESOLUTION:"dsplan:resolution",CONSTRAINT:"Constraint",IMAGE_ATTR:"image",THUMBNAIL_ATTR:"dsplan:hasThumbnail",OWNER_FIRSTNAME_ATTR:"foaf:givenName",OWNER_LASTNAME_ATTR:"foaf:familyName",RDF_TYPE:n.RDF_TYPE,ACTUAL_TYPE_ATTR:n.ACTUAL_TYPE_ATTR,REQUIRES_SKILL_ATTR:"dsplan:requiresSkill",SCHEDULE_UPDATE_STATUS_ATTR:"dsplan:ScheduleUpdateStatus",PERSON_ID_ATTR:"ds6w:identifier",PLAN_TO_ADD:"addPlan",TYPE_TEMPLATE:"dsbase:Template",DEFAULT_PROJECT_TEMPLATE:"TeamProject",CUSTOMER_EXTENSION:"dsbase:customerExtension",SAVE_AS_TEMPLATE:"SaveAsTemplate",CREATE_PROJECT:"Create",CREATE_PROJECT_FROM_PROJECT:"CreateFromProject",CREATE_PROJECT_FROM_TEMPLATE:"CreateFromTemplate",CREATE_PROJECT_FROM_CUSTOMER_EXTENSION:"CreateProjectFromCustomerExtension",TOOLBAR_ID_TASKS:"taskViewToolbar",TOOLBAR_ID_SCHEDULE:"scheduleToolbar",TOOLBAR_ID_DEPENDENCIES:"dependenciesToolbar",TOOLBAR_ID_MEMBERS:"memberViewToolbar",TOOLBAR_ID_CONTENT:"contentViewToolbar",TOOLBAR_ID_RISKS:"riskViewToolbar",TOOLBAR_ID_BACKLOG:"backlogToolbar",SCHEDULING_STRATEGY_ATTR:"dsplan:schedulingStrategy",SCHEDULING_STRATEGY_LABEL:"Scheduling Strategy",RESOURCE_LEVELING_STRATEGY:"Resource Levelling",TEMPORAL_SCHEDULING_STRATEGY:"Temporal Scheduling",RESOURCE_AUTOMATED_ALLOCATION_STRATEGY:"Resource Automated Allocation",RESOURCE_AUTOMATED_ALLOCATION_STRATEGY_LABEL:"Auto Resource Allocation",PROPERTY_PANEL_ACTIVE:"active",PROPERTY_PANEL_CLASS:"slide-in-panel right ds-dialog property-panel",CAN_READ:"dsplan:canRead",CAN_MODIFY:"dsplan:canModify",CAN_DELETE:"dsplan:canDelete",TASK_TYPE:"taskType",CREATED:"Created",ADDED:"Added",DELETED:"Deleted",REMOVED:"Removed",MODIFIED:"Modified",TRANSITIONED:"Transitioned",REPEAT_CREATE_TASK:"repeatCreateTask",REPEAT_CREATE_OBJ:"repeatCreateObject",TASK_COLLAB_SPACE:"taskCollabSpace",TASK_ORGANIZATION:"taskOrganization",STANDALONE_TASK:"standaloneTask",SIMPLE_TASK:"simpleTask",XPP_TASK:"xppTask",DPM_TASK:"dpmTask",SCHEDULE_RELATION_ATTR:"dsplan:hasSchedule",SCHEDULE_RDF_TYPE:"dsplan:Schedule",TASK_HEIGHT:22,MIN_CART_HEIGHT:38,ANIMATION_DURATION:500,SUMMARY_FACET:"summary",SCHEDULE_FACET:"schedule",DEPENDENCIES_FACET:"dependencies",TASK_FACET:"tasks",MEMBER_FACET:"team",CONTENT_FACET:"content",RISK_FACET:"risk",BACKLOG_FACET:"backlog",TEAM_LEADERS:"team_leaders",TEAM_MEMBERS:"team_members",HAS_SWYM_COMMUNITY:"dsxplan:hasCommunity",LOAD_MORE:"loadMoreProjectsPlease",DEACTIVATE_WIDGET_FILTER_EVENT:"deactivate3DWidgetFilter",ACTIVATE_WIDGET_FILTER_EVENT:"activate3DWidgetFilter",TAGGER_FILTER_CRITERIA:"tagger",TAGS_DATA:"tagsData",SEARCH_FILTER_CRITERIA:"search",WIDGET_FILTER_CRITERIA:"3dwidgetFilter",CRITICAL_PATH_FILTERS:"criticalPathFilters",EOD_TIMEOFFSET:612e5,ROLLED_UP_INFO_ATTR:"dsxplan:hasRolledUpInfo",CREATE_LU_BUTTON_ID:"create-logical-user",TASK_DRAG_HANDLE_WIDTH:16,TASK_DRAG_HANDLE_HEIGHT:24,TASK_DRAG_HANDLE_OFFSET:2,TITLE_OFFSET_CONSTRAINT:7,CONSTRAINT_CIRCLE_RADIUS:t.Client.Features.touchEvents?8:6.5,TASK_CONSTRAINT_OFFSET_Y:8,CONSTRAINT_OFFSET:3,STYLE_EXPANSION:"expansion",STYLE_COMPRESSION_LOW:"compression-low",STYLE_COMPRESSION_HIGH:"compression-high",MIN_COMPRESSION_DECORATION_WIDTH:18,POLYGON_COMPRESSION_LOW_RIGHT:["89.775,64.57 125.893,1.993 111.332,1.993 75.203,64.57 111.332,125.899 125.893,125.899"],POLYGON_COMPRESSION_HIGH_RIGHT:["89.775,64.51 125.893,1.933 111.332,1.933 75.203,64.51 111.332,125.838 125.893,125.838","60.63,64.51 96.748,1.933 82.187,1.933 46.058,64.51 82.187,125.838 96.748,125.838"],POLYGON_EXPANSION_RIGHT:["111.324,63.392 75.907,125.953 90.463,125.953 125.893,63.392 90.463,2.047 75.907,2.047"],POLYGON_OFFSET_Y:5,POLYGON_OFFSET_X:2,ITERATION_REORDER:"iterationReorder",PROJECT_TYPES:["dsplan:Project","dsplan:xProject","dsplan:ProjectPlanningTemplate","dsplan:AgileProject"]};return i.POLYGON_SCALING_FACTOR=(i.TASK_HEIGHT-4)/128,i.POLYGON_WIDTH=128*i.POLYGON_SCALING_FACTOR,i.TASK_DRAG_HANDLE_FULL_WIDTH=i.TASK_DRAG_HANDLE_WIDTH+i.TASK_DRAG_HANDLE_OFFSET,e.merge(i,s),i}),define("DS/E6WCommonApps/SmartSchedulerUtils",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/SecurityContextUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/Utils/3DSpaceUtils","DS/Foundation2/Models/FoundationV2Model","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/Views/DocumentFileChooserPopup","DS/E6WCommonApps/ScheduleConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h){"use strict";var m=function(e){var t=p.get(e);return t===e&&(t=u.get(e)),t},T={getCompletedTaskFilter:function(){var e="all",t=widget.getValue(T.COMPLETED_TASK_PREF_NAME);if(t&&"all"!==t){var n=new Date;n.setDate(n.getDate()-t),e=n.toISOString()}return e},setCompletedTaskFilter:function(e){widget.setValue(T.COMPLETED_TASK_PREF_NAME,e)},getCompletedTasksFilterPref:function(e){return{name:T.COMPLETED_TASK_PREF_NAME,type:"list",defaultValue:e,options:[{label:m("E6WCommonApps.Label.CompletedTasksLast10Days"),value:10},{label:m("E6WCommonApps.Label.CompletedTasksLast30Days"),value:30},{label:m("E6WCommonApps.Label.CompletedTasksLast60Days"),value:60},{label:m("E6WCommonApps.Label.CompletedTasksAllDays"),value:"all"}],label:m("E6WCommonApps.Label.CompletedTasksDisplayPref")}},getDropDownMenuItems:function(e,t){var n=Boolean(this._config.readWrite),s=this.normalizedGet(this.model,this._config.name),i="Project"===this.normalizedGet(s,"type"),o=T.getManagementView(),a=[o?T.getOpenMenuConfig(s,o):T.getPreviewMenuConfig(s,i),T.getDetachMenuConfig.call(this,n,t)];if(s){var r=T.getPropertiesMenuConfig.call(this,t);a.splice(0,0,r)}return a},getCalendarDropDownMenuItems:function(e,t,n){return[T.getCalendarPreviewMenuConfig(t.model||n,this),this.getRemoveItemButton(t)]},getPreviewMenuConfig:function(e){return{text:m("E6WCommonApps.Label.Open"),fonticon:"open",name:"preview-button",className:e.hasViewAccess&&!e.hasViewAccess()?" disabled":"",handler:function(){l.openInApp(e)}}},getCalendarPreviewMenuConfig:function(e,t){return{text:m("E6WCommonApps.Label.Preview"),fonticon:"eye",name:"calendar-preview-button",className:e.hasViewAccess&&!e.hasViewAccess()?" disabled":"",handler:function(){var n=this;i.loadJSDependency("DS/ENOProjectMgmtCommonComponents/views/CalendarPopup").then(function(s){let i={model:e,calendarId:e.get("physicalId")};const o=new s(n,i);o.render(),t.addChildView(o)}).catch(e=>{"scripterror"===e.requireType&&console.error(e.message)})}}},getDetachMenuConfig:function(e,t){var n=this;return{text:m("E6WCommonApps.Label.Detach"),fonticon:"link-off",name:"detach-button",className:n.normalizedGet(n.model,"canEdit")&&e?"":" hidden",handler:function(){var e=n._config.name;if("commonTaskParent"===e){var s=p.replace(m("E6WCommonApps.Alert.TaskDetach"),{OBJECT_NAME:n.model.get("title")});i.displayWarning(s)}n.model.remove(e,t.index,t.options)}}},getOpenMenuConfig:function(e,n){var s=n.currentModel===e;return{text:m("E6WCommonApps.Label.Open"),fonticon:"open",name:"open-project-button",className:e.hasViewAccess&&!e.hasViewAccess()||s?"disabled":"",handler:function(){n.collection.add(e),n.skel.setRoute("/projects/"+t.removeBracketLongURI(e.id)+"/"+n._getFacetToOpenOnLoad(e)+"/")}}},getPropertiesMenuConfig:function(e){var t=this;return{text:m("E6WCommonApps.Command.Properties"),fonticon:"attributes",handler:function(){t.objectClick(e.event)},name:"propertiesButton"}},getDividerConfig:function(){return{className:"divider"}},getEditMenuConfig:function(t,n,s){var o=e.clone(s||{},!1),a=n.currentModel===t;return{text:m("E6WCommonApps.Label.Information"),fonticon:"info",handler:function(){n.openPropertyPanel({modelIsRoot:a,selectedModel:t,isShadowMilestoneGate:o.isShadowMilestoneGate,isSummaryTask:o.isSummaryTask}),i.trackPageEvent({eventCategory:"edit-through-property-panel",eventLabel:"model",eventValue:t})}}},getFlexibleConfig:function(e){var t=e.canEnforce()||!e.hasFetchedAccessData(),n=e.get("dsxplan:isEnforced");return void 0===n&&(n=!0),{text:m("E6WCommonApps.Label.flexible"),fonticon:"dependency",className:t?"":"disabled",selectable:!0,selected:!n,handler:function(){var t=m(n?"E6WCommonApps.Alert.ConstraintNotEnforced":"E6WCommonApps.Alert.ConstraintEnforced"),s={};s["dsxplan:isEnforced"]=!n,e.save(s,{onComplete:function(){i.displaySuccess(t),i.trackPageEvent({eventCategory:"contraint-enforced",eventLabel:"new_enforced_attribute",eventValue:s["dsxplan:isEnforced"]})},onFailure:function(){i.displayError(m("E6WCommonApps.Error.ConstraintEnforceFailed"))}})}}},getDeleteMenuConfig:function(e,t){var n=e.canDelete(!0)||!e.hasFetchedAccessData();return{id:"deleteButton",text:m("E6WCommonApps.Label.Delete"),fonticon:"trash",className:n?"":"disabled",handler:t}},getRemoveReferenceConfig:function(e,t){return{text:m("E6WCommonUI.Label.Remove"),fonticon:"remove",handler:function(){e.removeReferenceFromParent({onComplete:function(){i.displaySuccess(m("E6WCommonApps.Alert.RemoveReferenceProjectSuccessful"))},onFailure:function(){i.displayError(m("E6WCommonApps.Alert.RemoveReferenceProjectFailed"))},parent:t})}}},getPinMenuConfig:function(e,t){var n=e.isFixed(),s=e.canModify(!0)||!e.hasFetchedAccessData(),i="Milestone"===e.getObjectType()&&e.isStartOrEndMilestone();return{text:m(n?"E6WCommonApps.Label.Unpin":"E6WCommonApps.Label.Pin"),fonticon:n?"pin-off":"pin",className:!s||e.isComplete()||i?"disabled":"",handler:t}},getBookmarkURLMenuConfig:function(e){return{id:"bookmarkButton",text:m("E6WCommonApps.Label.CopyBookmark"),title:m("E6WCommonApps.Label.CopyBookmark"),fonticon:"link",handler:function(){var t="",n=e.get("physicalId")||e.id;t=e instanceof r?l.getDashboardUrl(n):l.getRedirectUrl(n),i.copyTextToClipboard(t),i.displaySuccess(m("E6WCommonApps.Alert.BookmarkCopied"))}}},getSaveAsTemplateMenuConfig:function(e){var t=this,n=e&&e.isAgile(),s=T.getManagementView();return{id:"saveAsTemplateButton",text:m("E6WCommonApps.Label.SaveAsTemplate"),fonticon:"template",disabled:n||o.isXppViewer(),handler:function(){t.popup&&t.popup.destroy(),t.popup=s.createNewWorkScope(void 0,{selectedModel:e,createFrom:"SaveAsTemplate"})}}},createFromTemplate:function(e){var t=this,n=e&&e.isAgile(),s=T.getManagementView();return{id:"createFromTemplate",text:m("E6WCommonApps.Label.CreateProjectFromTemplate"),fonticon:"template",disabled:n||i.isTemplate(e)&&e.getMaturityState()!==c.PUBLISHED_MATURITY_VALUE,handler:function(){t.popup&&t.popup.destroy(),t.popup=s.createNewWorkScope(void 0,{prefillWithTemplate:e,createFrom:c.CREATE_PROJECT_FROM_TEMPLATE})}}},getDocumentServiceDropDownMenuItems:function(e,t){require(["DS/DocumentCommands/ENOXDocumentCommands"],n=>{var i=e.get("dscom:Tenant")||enoviaServer.tenant,o=enoviaServer["3DSpace"],a=enoviaServer["3DDashboard"],r=e.get("type")||e.get("@type"),l=s.getDefaultSecurityContext(),d={document:{id:e.get("physicalId"),contextId:l,serviceId:"3DSpace",envId:i,index:1,data:{id:e.get("physicalId"),title:e.get("title")},type:r},platformUrls:{"3DSpace":o,"3DDashboard":a}};d.document.filesCallback=function(n){e._actionsData=n,t(n)};var c=new n;c.init(d);var p=window.enoviaServer&&window.enoviaServer.space;c.render(),(window.enoviaServer&&window.enoviaServer.space)!==p&&(window.enoviaServer.space=p)})},getDocumentTypeDropDownMenuItems:function(e,t,s){var i=this.options?this.options.docMenuItems:t,o=t.model||s,l=this.getDropDownMenuItems(e,t);if(o instanceof r||o instanceof n&&"3DSpace"===o.serviceHosting){var d=T.updateMenuItemsWithDocumentCommands.bind(this,i,l,o);a.fetchParentTypesWithCallback(o,d)}return l},updateMenuItemsWithDocumentCommands:function(e,t,n){var s=n.get("parentTypes");if(s&&s.includes("DOCUMENTS")){var i=t.findIndex(e=>"documentUpdateButton"===e.id),a=i>0;if(o.isXppViewer()){var r=t.find(e=>"documentUpdateButton"===e.id);a=a&&!(r.className.includes("disabled")||r.className.includes("hidden"))}var l=function(e){i=e.findIndex(e=>"documentUpdateButton"===e.id),a&&e.splice(i,1)};if(a)if(e.Edit)l(t),t.splice(1,0,e.Edit);else if(e.UndoEdit){if(e.Update){r=t[i];l(t),t.splice(1,0,r)}t.splice(2,0,e.UndoEdit)}e.Preview&&t.find((n,s)=>{n.name===h.PREVIEW&&(t[s]=e.Preview)})}return t},createDocumentUpdateModal:function(e,t){this.fileChooserModal=new d({renderTo:widget.body,docModel:e,updateDocumentCallback:t})},findIndex:function(e,t,n){return(e=e&&e.length&&(e.findIndex?e:e.toArray()))&&e.findIndex(e=>e[t]===n)},getManagementView:function(){return this._mgmtView},setManagementView:function(e){this._mgmtView=e},COMPLETION_DATE_TASK_FILTER_ATTR:"fromCompletionDate",COMPLETED_TASK_PREF_NAME:"completedTasksDisplayPref",COMPLETED_TASK_FILTER_ALL_DAYS:"all",COMPLETED_TASK_FILTER_30_DAYS:"30",BOOKMARK_BUTTON:"bookmarkButton"};return T}),define("DS/E6WCommonApps/Models/TaskModelMixin",["UWA/Core","UWA/Promise","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/FeatureFlagUtils","DS/PlatformAPI/PlatformAPI","DS/E6WCommonApps/Models/AssigneeMixin","DS/E6WCommonApps/Utils/3DSpaceUtils","UWA/Utils","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS"],function(e,t,n,s,i,o,a,r,l,d){"use strict";var c=function(e,t,n){var s=new Date(n);return e<t?s.setHours(s.getHours()+1):s.setHours(24),s},p={OWNERATTR:"ownerInfo",DPMPROJECTATTR:"DPMProject",ASSIGNEESATTR:"assignees",REFERENCEATTR:"references",SCOPESATTR:"scopes",DUEDATECATEGORY:l.DUE_DATE_CATEGORY,DUEDATEATTR:"dueDate",ACTUALSTARTDATEATTR:"actualStartDate",_categories:["PAST_DUE","NO_DATE","DUE_TODAY","DUE_TOMORROW","DUE_THIS_WEEK","DUE_FUTURE"],isComplete:function(){return"Complete"===this.get("state")},_onRequest:function(e){this.nbInFlightRequests++,1===this.nbInFlightRequests&&this.dispatchEvent("onChange:nbInFlightRequests",[this,e])},_onCompleteRequest:function(e){this.nbInFlightRequests--,this.nbInFlightRequests=this.nbInFlightRequests<0?0:this.nbInFlightRequests,0===this.nbInFlightRequests&&this.dispatchEvent("onChange:nbInFlightRequests",[this,e])},add:function(t,n,s){var i=e.clone(s||{}),o=i.onFailure,a=i.onComplete,r=this;i.onComplete=function(){r._onCompleteRequest(),a&&a.apply(this,arguments)},i.onFailure=function(){r._onCompleteRequest(),o&&o.apply(this,arguments)};var l,d=n.split(",").map(function(e){return e.trim()});return(l=this.addObjects(d,t))&&l.length&&(this._onRequest(),l[0].save(void 0,i)),l},addSelfAssignToInWorkMessage:function(){var t=n.setHelper.apply(this,arguments).options||{},s=t.onComplete,i=this.get("title");e.extend(t,{onComplete:function(){s.apply(this,arguments);var e,t=(e="emxCollaborativeTasks.Label.InWorkTaskSelfAssigned",d.get(e));t=t.replace("%TASK_TITLE%",i),n.displaySuccess(t)}})},remove:function(t,n,s){var i=this.removeObject(t,n),o=e.clone(s||{}),a=o.onFailure,r=o.onComplete,l=this;return o.onComplete=function(e,t,n){l._onCompleteRequest(n),r&&r.apply(this,arguments)},o.onFailure=function(e,t,n){l._onCompleteRequest(n),a&&a.apply(this,arguments)},i&&(this._onRequest(),i.save(void 0,o)),i},fetchDeliverableParentTypes:function(e){const s=function(){const t=n.parentTypesMap[this.get("type")];t&&-1!==t.indexOf("VPMReference")&&e.push(this.get("physicalId"))},i=[];return(()=>{const e=this.getDeliverables();if(e&&e.length>0){const o={};e.forEach(function(e){const t=e.get("type");n.parentTypesMap[t]?s.call(e):o[t]=e}),Object.values(o).forEach(function(e){i.push(new t(function(t,n){a.fetchParentTypes(e,{onComplete:function(){s.call(this),t()},onFailure:n})}))})}return t.all(i)})()},markDeliverablesOn3DNavigate:function(){if(s.is3DViewerEnabled()){var e=[];let t={metadata:{ignoreFromSameWidgetId:!1,appid:widget&&widget.getValue("appId"),originUid:this.id,originWidgetId:widget&&widget.id,timestamp:Date.now(),uid:r.getUUID()},data:{intent:"focus",referenceIds:e}};this.fetchDeliverableParentTypes(e).then(function(){e.length&&i.publish("DS/PADUtils/PADCommandProxy/focus",t)})}},getMappedAttribute:function(e){return this.rdfCollabTaskInverseMapping&&this.rdfCollabTaskInverseMapping[e]||e},removeAssigneeByIndex:function(e){return this.removeObject(this.ASSIGNEESATTR,e)},addReferencesById:function(e){return this.addObjects(e,this.REFERENCEATTR)},sync:function(e,t,n){var s=Array.prototype.slice.call(arguments,0),i=n.onFailure,o=n.onComplete,a=this;n.onFailure=function(e,t,n){a._onCompleteRequest(n),n&&(n.response=t),i&&i.apply(this,arguments)},n.onComplete=function(e,t,n){a._onCompleteRequest(n),o&&o.apply(this,arguments)},a._onRequest(n),this._parent.apply(this,s)},dueDateCategory:function(t){var n=void 0===t?this.get("dueDate"):t,s="NO_DATE";if(n=e.is(n,"string")?parseInt(n,10):n,(n=e.is(n,"number")||n instanceof Date?new Date(n):n)instanceof Date)if(isNaN(n))s="NO_DATE";else{n.setHours(0,0,0,0);var i=new Date;i.setHours(0,0,0,0);var o=n-i;if(o<0)s="PAST_DUE";else if(0===o)s="DUE_TODAY";else{var a=new Date(i);if(a.setDate(a.getDate()+1),n.getTime()===a.getTime())s="DUE_TOMORROW";else s=(o=n-this.dateHelper.getLastDayofThisWeek())<0?"DUE_THIS_WEEK":"DUE_FUTURE"}}return s},dueDateCategory2DueDate:function(e){var t,n=this.dateHelper;switch(e){case"DUE_TOMORROW":t=n.getTomorrow();break;case"DUE_TODAY":t=n.getToday();break;case"NO_DATE":t=new Date(NaN);break;case"PAST_DUE":t=n.getPast();break;case"DUE_THIS_WEEK":t=n.getLastDayofThisWeek();break;case"DUE_FUTURE":t=n.getFuture()}return t},dateHelper:{ONE_DAY:864e5,THIRTY_DAYS:2592e6,getLocaleDate:function(e){return e.toLocaleDateString()},getToday:function(){var e=new Date;return e.setHours(23,59,59,999),e},getTomorrow:function(){var e=new Date((new Date).getTime()+this.ONE_DAY);return e.setHours(23,59,59,999),e},getFuture:function(){var e=new Date((new Date).getTime()+this.THIRTY_DAYS);return e.setHours(23,59,59,999),e},getPast:function(){var e=new Date((new Date).getTime()-this.ONE_DAY);return e.setHours(23,59,59,999),e},getLastDayofThisWeek:function(){var e=new Date;e.setHours(23,59,59,999);var t=(e.getDay()+6)%7;return e.setDate(e.getDate()-t+4),e}},isAtRisk:function(){if(this.isProjectTask())return"behindSchedule"===this.get("status");var e=this.isComplete(),t=this.get(this.DUEDATEATTR);if(e||!t)return!1;var n=!1,s=this.getStartDate(),i=s instanceof Date?s.getTime():Date.parse(s),o=this.getPercentComplete();if(i&&o>=0){var a=new Date(i+(t.getTime()-i)*(o/100));n=new Date>c(this.getDuration(),this.getWorkingHoursInMilliseconds(),a)}return n},isLate:function(){if(this.isProjectTask())return"late"===this.get("status");var e=this.isComplete(),t=this.get(this.DUEDATEATTR);if(e||!t)return!1;var n=c(this.getDuration(),this.getWorkingHoursInMilliseconds(),t);return new Date>n},getDuration:function(){var e=this.getDefinedDuration(),t=this.getWorkDayLength()+2;return(isNaN(e)?t:e)*this.getWorkingHoursInMilliseconds()},THRESHOLD:36e5};return e.extend(p,o),p}),define("DS/E6WCommonApps/XTaskScope",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/Foundation/WidgetUwaUtils","DS/Foundation/WidgetAPIs","DS/Foundation2/FoundationV2Data","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/ScheduleConstants"],function(e,t,n,s,i,o,a){"use strict";var r="scopeId_18x",l={getCollection:function(){return this._collection},setCollection:function(e){this._collection=e},isScopeRDF:function(){return!this._initialized&&this.initialize(),this._scopeIsRDF},isScopeSwym:function(){return!this._initialized&&this.initialize(),this._scopeIsSwym},getTSKTaskType:function(){var e=l.getObjectData(),t=!1;return e&&e.contextFilter&&(t=e.contextFilter&&!e.isSwym),this.getScopeType()?this.isScopeRDF()?t?a.DPM_TASK:a.XPP_TASK:(e&&e.type,a.DPM_TASK):o.getServiceUrl("3dplan",!0)?a.STANDALONE_TASK:a.SIMPLE_TASK},getScopeId:function(){return!this._initialized&&this.initialize(),this._scopeId},getScope:function(){return t.getObjectById(this.getScopeId())},getScopeType:function(){return!this._initialized&&this.initialize(),this._scopeType},getObjectData:function(){return!this._initialized&&this.initialize(),this._objectData},initialize:function(){var e=widget.getValue(r);if(void 0!==e)(e=JSON.parse(e))&&e.id?(e.localOnly=!0,this.setScopeData(e)):this.removeScopeData();else{var t=widget.getValue("scopeId"),n={};if(t){var s="~~";-1===t.indexOf("~~")&&(s=":");var i=t.split(s);n={id:i[1],type:i[0],isRDF:Boolean(widget.getValue("scopeIsRDF")),isSwym:Boolean(widget.getValue("scopeIsSwym"))},this.setScopeData(n),widget.deleteValue("scopeIsRDF"),widget.deleteValue("scopeIsSwym"),widget.deleteValue("scopeId")}else this.removeScopeData()}},setScopeData:function(t){var n=e.clone(t||{},!1);if(!n.id||!n.type||void 0===n.isRDF)throw new Error("id, type, and isRDF must be passed in an options object to setScopeData");var s={id:n.id,type:n.type,objectData:n.objectData,isRDF:Boolean(n.isRDF),isSwym:Boolean(n.isSwym)};n.localOnly||widget.setValue(r,JSON.stringify(s)),window.enoviaServer.preferences.scopeId=s.id,window.enoviaServer.preferences.scopeType=s.type,window.enoviaServer.preferences.scopeObjectData=s.objectData,this._scopeId=s.id,this._scopeType=s.type,this._objectData=s.objectData,this._scopeIsRDF=s.isRDF,this._scopeIsSwym=s.isSwym,this._widgetScopeId=s.id,this._widgetScopeType=s.type,this._widgetScopeIsRDF=s.isRDF,this._widgetScopeIsSwym=s.isSwym,this._initialized=!0,n.hasOwnProperty(n.collection)&&this.setCollection(n.collection)},removeScopeData:function(){widget.setValue(r,JSON.stringify({id:void 0,type:void 0,isRDF:void 0,isSwym:void 0})),this._widgetScopeId=void 0,this._widgetScopeType=void 0,this._widgetScopeIsRDF=void 0,this._widgetScopeIsSwym=void 0,this.removeUserScopeData()},removeUserScopeData:function(){this._scopeId=void 0,this._scopeType=void 0,this._objectData=void 0,this._scopeIsRDF=void 0,this._scopeIsSwym=void 0,this._initialized=!0,this._collection=void 0,window.enoviaServer.preferences&&(delete window.enoviaServer.preferences.scopeId,delete window.enoviaServer.preferences.scopeType,delete window.enoviaServer.preferences.scopeIsRDF,delete window.enoviaServer.preferences.scopeIsSwym,delete window.enoviaServer.preferences.scopeObjectData)},resetLocalScopeData:function(){delete this._widgetScopeId,delete this._widgetScopeType,delete this._widgetScopeIsRDF,delete this._widgetScopeIsSwym,delete this._initialized,this._collection=void 0},getFilter:function(){return widget.getValue("currentTaskFilter")||"all"},setFilter:function(e){widget.setValue("currentTaskFilter",e)},setScopeToInvalid:function(e){this._isInvalidScope=e},isInvalidScope:function(){return this._isInvalidScope},FILTER_ASSIGNED:"assigned",FILTER_OWNED:"owned",FILTER_ALL:"all",FILTER_CANDIDATE_ASSIGNEE:"candidateAssignee"};return l}),define("DS/E6WCommonApps/Collections/ChecklistItemCollection",["UWA/Core","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],function(e,t,n){"use strict";return t.extend({_uwaClassName:"ChecklistItemCollection",sync:Function.prototype,getModelsToRemove:function(e){return this.filter(function(t){return!e[t.id]&&!t.keepWhenUpdating})},getSequenceOrder:function(e){return e.get(n.SEQUENCE_ORDER_ATTR)},sort:function(){this._parent.apply(this,arguments)},comparator:function(e,t){var s=e.get(n.SEQUENCE_ORDER_ATTR_DSLC),i=t.get(n.SEQUENCE_ORDER_ATTR_DSLC);if(void 0!==s&&void 0!==i)return s-i}})}),define("DS/E6WCommonApps/Models/TeamMemberResponsibilityModel",["UWA/Core","UWA/Class/Model","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/MemberUtils","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/Models/UsersGroupRDFModel","DS/RDFFoundation/Models/LogicalUserModel","DS/RDFFoundation/Models/ResultModel","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d){"use strict";var c=d.get.bind(d),p={"dsplan:Viewer":0,"dsplan:Author":1,"dsplan:Leader":2},u=l.extend({_uwaClassName:"TeamMemberResponsibilityModel",idAttribute:"@id",dragDisabled:!0,hasViewAccess:function(){return!0},setup:function(e){this._parent.apply(this,arguments),e.memberPersonModel&&this.listenTo(e.memberPersonModel,"onAnyEvent",function(e){var t=Array.prototype.slice.call(arguments,1);this.dispatchEvent(e,t)}),e.assignedUserModel&&this.listenTo(e.assignedUserModel,"onAnyEvent",function(e){var t=Array.prototype.slice.call(arguments,1);this.dispatchEvent(e,t)})},parse:function(t,n){var s=e.clone(t||{},!1);return this._parent(s,n)},getActualPerson:function(){return this.get("memberPersonModel")instanceof r?this.get("assignedUserModel"):this.get("memberPersonModel")},get:function(e){var t=this._parent.apply(this,arguments);switch(e){case"name":case"userName":return this.get("memberPersonModel")instanceof r?this.get("assignedUserModel")?this.get("assignedUserModel").fullName:"":this.get("memberPersonModel").fullName;case"title":return this.get("memberPersonModel")instanceof r?this.get("memberPersonModel").get("name"):this.get("memberPersonModel").fullName;case"type":return this.get("memberPersonModel").getObjectType();case"image":return this.get("memberPersonModel").get("image");case"businessRole":return this.get("memberPersonModel")instanceof r?this.get("memberPersonModel").get("businessRole"):"";case"skills":return this.get("memberPersonModel")instanceof r?this.get("memberPersonModel").get("skills"):"";case"personRDFId":case"physicalId":return this.get("memberPersonModel").id;case"dsaccess:accountName":return this.get("memberPersonModel").get("dsaccess:accountName");case"responsibility":return this.getHighestResponsibility();case"responsibilityNLS":return this.getResponsibilityNLS();case"roleAndResponsibilityNLS":return this.getRoleAndResponsibilityNLS();case"userProfileName":return this.get("memberPersonModel")instanceof r?this.get("memberPersonModel").get("name"):""}return t},canBeRemoved:function(e){if(this.get("memberPersonModel")instanceof r)switch(e){case"team_members":return!1;case"assigneeResponsibilityModels":default:return!0}return!0},setIsOwner:function(e){this.isOwner=e},setIsAssignee:function(e){this.isAssignee=e},getResponsibilityNLS:function(){var e=this.get("responsibility");if(e){var t=s.splitUri(e)[1];return i.isPendingUser(this.get("memberPersonModel"))?c("E6WCommonApps.Label.ResponsibilityDisplayPending."+t):c("E6WCommonApps.Label."+t)}return""},getRoleAndResponsibilityNLS:function(){let e=[];this.get("isAssignee")&&e.push(c("E6WCommonApps.Label.ProjectManager")),this.get("isOwner")&&e.push(c("E6WCommonApps.Label.Owner"));let t=this.get("businessRole");return t&&e.push(t),e.push(this.getResponsibilityNLS()),e.join(", ")},isAssignedLogicalUser:function(){return!!this.get("linkedLogicalUser")},toJSON:function(e){var t=this._parent.apply(this,arguments);t.responsibilityNLS=this.get("responsibilityNLS"),t.roleAndResponsibilityNLS=this.get("roleAndResponsibilityNLS");let n=e&&e.ancestors||{},s=this.get("memberPersonModel");t.businessRole=this.get("businessRole"),t.skills=this.get("skills"),n[s.id]?delete t.memberPersonModel:t.memberPersonModel=s.toJSON(e);let i=this.get("parentWorkscopeModel");return i&&!n[i.id]?t.parentWorkscopeModel=i.toJSON(e):delete t.parentWorkscopeModel,t.title=this.get("title"),t.userName=this.get("userName"),t.image=this.get("image"),t.linkedLogicalUser=this.get("linkedLogicalUser"),t.userProfileName=this.get("userProfileName"),t.physicalId=this.get("physicalId"),t},getHighestResponsibility:function(){for(var e=this.get("allResponsibilitiesArray"),t=e[0],n=p[t],s=1;s<e.length;s++){var i=e[s],o=p[i];o>n&&(n=o,t=i)}return t},getTaggerURI:function(){var e=this.get("physicalId")||this.id;return this.isRDF&&(e=this.getTagPrefix()+s.conditionalShortToLongURI(e)),e},canShowProperties:function(){var e=this.get("memberPersonModel")&&this.get("memberPersonModel")instanceof r,t=this.get("memberPersonModel")&&this.get("memberPersonModel")instanceof a;return!e&&!t||this.get("memberPersonModel").canShowProperties()},getTransferObject:function(){return this.get("memberPersonModel").getTransferObject()}});return u.processRawData=function(e,t){for(var o=[],a=Object.keys(e),l=a.length,d=0;d<l;d++){var c=a[d],p=e[c],h=p&&p.member;if(h){let e=h[0]["dsplan:jsType"];var m;"foaf:Person"===e&&(e="pno:Person",(m=h[0]["dsaccess:accountName"])&&i.addUserUIdToMap(i.addIamToURI(m),s.removeBracketLongURI(c)));let a=[];if(h[0].logicalUsers)for(let e=0;e<h[0].logicalUsers.member.length;e++){let t=h[0].logicalUsers.member[e],o=t["@id"],l=s.getObjectById(o);if(!l){let e={mask:i.getPersonMask(),attrs:{workforceRequestId:t["dsplan:requestId"],title:t.title,"dsxplan:jsType":n.LOGICAL_USER_TYPE}};l=s.getObjectForAdding(r,o,e)}a.push(l)}var T=[],g=function(n,i,o){let a=n[0].title,r=u.getAllResponsibilitiesArray(n);return{"@id":s.removeBracketLongURI(i),id:s.removeBracketLongURI(i),type:e,allResponsibilitiesArray:r,parentWorkscopeModel:t,title:a,workforceRequestId:n[0].requestId,assignedUserData:o}};if(e===n.LOGICAL_USER_TYPE)T.push(g(h,c));else{var E=u.getAllResponsibilitiesArray(p.member);let n=E.indexOf("dsplan:Admin");if(-1!==n&&E.splice(n,1),!E.length)continue;let s={id:c,type:e,allResponsibilitiesArray:E,parentWorkscopeModel:t,accountName:m};if(T.push(s),a.length)for(let e=0;e<a.length;e++){let t=h[0].logicalUsers.member[e],n=t["@id"];T.push(g([t],n,s))}}T.forEach(function(e){o.push(u.getMemberObj(e))})}}return o},u.getAllResponsibilitiesArray=function(e){for(var t=[],n=0;n<e.length;n++){var s=e[n].responsibility?e[n].responsibility:e[n]["dsplan:logicalResponsibility"]["@id"];t.push(s)}return t},u.getMemberObjFromUser=function(e){return{"@id":u.getInstanceId(e.memberPersonModel.id,e.parentWorkscopeModel.id),allResponsibilitiesArray:[n.RESPONSIBILITY_AUTHOR],memberPersonModel:e.memberPersonModel,parentWorkscopeModel:e.parentWorkscopeModel}},u.getMemberObj=function(t){var l;let d={attrs:{"dsxplan:jsType":t.type}};var c,p;d.mask=i.getPersonMask(),d.attrs["dsxplan:jsType"]=t.type,"pno:Person"===t.type?(l=o,d.attrs["dsaccess:accountName"]=t.accountName):t.type===n.LOGICAL_USER_TYPE?(l=r,d.attrs.type=t.type,d.attrs.title=t.title,d.attrs.workforceRequestId=t.workforceRequestId,c=s.getObjectById(t.id)):(l=a,d.attrs["dsaccess:accountName"]=t.accountName),c?(c.set(d.attrs),p=c):(!d.attrs["dsaccess:accountName"]&&t.assignedUserData&&(d.attrs["dsaccess:accountName"]=t.assignedUserData.accountName),p=s.getObjectForAdding(l,t.id,d));var h=t.allResponsibilitiesArray;h&&e.is(h,"string")&&(h=[h]);var m={allResponsibilitiesArray:h,memberPersonModel:p,parentWorkscopeModel:t.parentWorkscopeModel,isOwner:t.parentWorkscopeModel.get(n.OWNER_ATTR)===p,isAssignee:t.parentWorkscopeModel.get(n.ASSIGNEE_ATTR).contains(p)};return t.assignedUserData&&(d.attrs["dsaccess:accountName"]=t.assignedUserData.accountName,m.assignedUserModel=s.getObjectForAdding(o,t.assignedUserData.id,d)),t.linkedLogicalUser?(m.linkedLogicalUser=t.linkedLogicalUser,m["@id"]=u.getInstanceId(t.id,t.parentWorkscopeModel.id,t.linkedLogicalUser.id)):m["@id"]=u.getInstanceId(t.id,t.parentWorkscopeModel.id),m},u.getInstanceId=function(e,t,n){let i;return i=s.getObjectIDFromUserMap(e)?s.getObjectIDFromUserMap(e)+"_"+t:e+"_"+t,n&&(i=i+"_"+n),i},Object.defineProperty(u.prototype,"fetching",{get:function(){return this.get("memberPersonModel").fetching}}),Object.defineProperty(u.prototype,"tagsData",{get:function(){return this.get("memberPersonModel").tagsData}}),Object.defineProperty(u.prototype,"serviceId",{get:function(){return this.get("memberPersonModel").serviceId}}),Object.defineProperty(u.prototype,"fullName",{get:function(){return this.get("name")}}),Object.defineProperty(u.prototype,"serviceHosting",{get:function(){if(this.getActualPerson())return this.getActualPerson().serviceId}}),Object.defineProperty(u.prototype,"physicalId",{get:function(){if(this.getActualPerson())return this.getActualPerson().get("physicalId")}}),Object.defineProperty(u.prototype,"fedSearchIdQuery",{get:function(){if(this.getActualPerson())return this.getActualPerson().idAttributeForFederatedSearch+':"'+this.getActualPerson().getIdForFederatedSearch()+'"'}}),Object.defineProperty(u.prototype,"sourceName",{get:function(){if(this.getActualPerson())return this.getActualPerson().sourceName}}),Object.defineProperty(u.prototype,"ds6w:type",{get:function(){if(this.getActualPerson())return this.getActualPerson().get("ds6w:type")}}),Object.defineProperty(u.prototype,"tenant",{get:function(){if(this.getActualPerson())return this.getActualPerson().tenant}}),u}),define("DS/E6WCommonApps/TaskUtils",["DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonUI/TopBarSearchDispatcher"],function(e,t){"use strict";return{useFTS:function(){var n=widget.getValue(e.LEVEL_PREF)===e.ALL_LEVEL_TASKS,s=Boolean(t.getSearchString());return n||s},comparator:function(e,t){var n=e.get("dsxplan:sequenceOrder"),s=t.get("dsxplan:sequenceOrder");if(void 0!==n&&void 0!==s&&n!==s)return n-s;var i,o,a=e.newThisSession?1:0,r=t.newThisSession?1:0;return e.newThisSession||t.newThisSession||(i=new Date(e.getStartDate()),o=new Date(t.getStartDate()),a=i.getTime(),r=o.getTime()),a===r&&(i=new Date(e.get("dspol:creationDate")),o=new Date(t.get("dspol:creationDate")),a=i.getTime(),r=o.getTime()),a-r}}}),define("DS/E6WCommonApps/TreeNodeUtil",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/Collections/ResultCollection","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TaskUtils","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r){"use strict";const l="correspondingModel";var d=function(e){return r.get(e)},c={title:"title",uniqueObjectId:"uniqueObjectId",description:"description",context:"context",project:"project",maturity:"maturity",priority:"priority",percent:"percent",routeContent:"routeContent",routeTaskAction:"routeTaskAction",routeTaskInstructions:"routeTaskInstructions",estimatedStartDate:"estimatedStartDate",estimatedFinishDate:"estimatedFinishDate",estimatedDuration:"estimatedDuration",attachments:"references",deliverables:"deliverables",community:"community",actualStartDate:"actualStartDate",actualFinishDate:"actualFinishDate",created:"created",modified:"modified",assignees:"assignees",owner:"owner",auditModifiedBy:"auditModifiedBy",auditType:"auditType",auditAction:"auditAction",auditDetails:"auditDetails"},p={[c.title]:"dsplan:MVMask.Task.Title",[c.uniqueObjectId]:"dsplan:MVMask.Task.UniqueObjectId",[c.description]:"dsplan:MVMask.Task.Description",[c.project]:"dsplan:MVMask.Task.Project",[c.maturity]:"dsplan:MVMask.Task.Maturity",[c.priority]:"dsplan:MVMask.Task.Priority",[c.percent]:"dsplan:MVMask.Task.Percent",[c.estimatedStartDate]:"dsplan:MVMask.Task.PlannedStart",[c.estimatedFinishDate]:"dsplan:MVMask.Task.PlannedEnd",[c.estimatedDuration]:"dsplan:MVMask.Task.EstimatedDuration",[c.attachments]:"dsplan:MVMask.Task.Attachments",[c.deliverables]:"dsplan:MVMask.Task.Deliverables",[c.community]:"dsplan:MVMask.Task.Community",[c.actualStartDate]:"dsplan:MVMask.Task.ActualStart",[c.actualFinishDate]:"dsplan:MVMask.Task.ActualEnd",[c.created]:"dsplan:MVMask.Task.Created",[c.modified]:"dsplan:MVMask.Task.Modified",[c.assignees]:"dsplan:MVMask.Task.Assignees",[c.owner]:"dsplan:MVMask.Task.Owner"},u={[o.DSLC_TITLE_ATTR]:c.title,[o.UNIQUE_OBJECT_ID_ATTR]:c.uniqueObjectId,[o.DESCRIPTION_ATTR]:c.description,[o.COMMON_TASK_PARENT_ATTR]:c.project,[o.TASK_PARENT_ATTR]:c.project,[o.PARENT_ATTR]:c.project,[o.DSLC_STATE_ATTR]:c.maturity,[o.DSLC_PRIORITY_ATTR]:c.priority,[o.COMPLETE_PERCENT_ATTR]:c.percent,[o.STARTDATE_ATTR]:c.estimatedStartDate,[o.ENDDATE_ATTR]:c.estimatedFinishDate,[o.DSLC_DURATION_ESTIMATED]:c.estimatedDuration,[o.ATTACHMENT_ATTR]:c.attachments,[o.ACTUAL_DELIVERABLE_ATTR]:c.deliverables,[o.PARENT_HAS_SWYM_COMMUNITY]:c.community,[o.ACTUAL_START_DATE]:c.actualStartDate,[o.ACTUAL_END_DATE]:c.actualFinishDate,[o.CREATION_DATE_ATTR]:c.created,[o.LASTUPDATED_ATTR]:c.modified,"dsxplan:hasAssignee":c.assignees,[o.OWNER_ATTR]:c.owner,[o.STORY_POINTS]:o.STORY_POINTS,[o.DSLC_DESCRIPTION_ATTR]:c.description,isWedo:"isWedo",icon:"icon",richTextDescription:"richTextDescription",hasChildren:"hasChildren"},h={title:c.title,uniqueObjectId:c.uniqueObjectId,description:c.description,context:c.context,DPMProject:c.project,scopes:c.context,contents:c.routeContent,routeTaskAction:c.routeTaskAction,routeTaskInstructions:c.routeTaskInstructions,state:c.maturity,percentComplete:c.percent,estimatedStartDate:c.estimatedStartDate,dueDate:c.estimatedFinishDate,routeTaskDueDate:c.estimatedFinishDate,estimatedDuration:c.estimatedDuration,estimatedDurationInputValue:c.estimatedDuration,estimatedDurationInputUnit:c.estimatedDuration,references:c.attachments,deliverables:c.deliverables,actualStartDate:c.actualStartDate,actualFinishDate:c.actualFinishDate,originated:c.created,modified:c.modified,assignees:c.assignees,owner:c.owner},m=[o.DSLC_DURATION_ESTIMATED,o.DSLC_DURATION_MIN,o.DSLC_DURATION_MAX,"estimatedDuration","estimatedDurationInputValue","estimatedDurationInputUnit"],T=[o.DSLC_STATE_ATTR,"state"],g=[o.DSLC_DESCRIPTION_ATTR,"subtitle"],E=function(e){return e%1==0?Math.round(e):e},A=function(e){if(e.isRouteTask()){var t=e.dataForRendering({attributes:"cardTitle"}).cardTitle;return t&&t.split("|")[1]}return""},C=function(e){var t;if(e.isRDFTask())return((t=e.get(o.DSLC_DURATION_ESTIMATED))?e.getEstimatedDuration():e.getSuggestedDuration())+" "+d("E6WCommonApps.Label.Days")+" +/- "+e.getSuggestedOffset();t=e.get("estimatedDuration");var n=e.get("estimatedDurationInputValue"),s=e.get("estimatedDurationInputUnit");return"d"===s?E(t)+" "+d("E6WCommonApps.Label.Days"):"h"===s?E(n)+" "+d("E6WCommonApps.Label.Hours"):void 0},f=function(e){switch(e){case"Create":case"Draft":return d("E6WCommonApps.Label.Preliminary");case"Open":case"Assign":return d("E6WCommonApps.Label.ToDo");case"InProgress":case"Active":return d("E6WCommonApps.Label.InWork");case"Review":return d("E6WCommonApps.Label.InApproval");case"OnHold":return d("E6WCommonApps.Label.OnHold");case"Done":case"Complete":return d("E6WCommonApps.Label.Completed");default:return""}},_=function(e){let t={};return e.cellModel===d("E6WCommonApps.Label.Medium")&&(t.icon="fonticon fonticon-medium priority-for-grid"),e.cellModel===d("E6WCommonApps.Label.Low")?t.icon="fonticon fonticon-low":e.cellModel===d("E6WCommonApps.Label.High")?t.icon="fonticon fonticon-high":e.cellModel===d("E6WCommonApps.Label.Urgent")&&(t.icon="fonticon fonticon-alert"),t},D=function(e){return e?e.replaceAll("</p>\n\n<p>","<br/>").replace(/<img .*?>/g,"<span class='fonticon fonticon-picture'></span>").replaceAll("\n",""):""},S=function(e){if(e){var t=e.dataForRendering();return t.get?t.get("title"):t.title}return""},R=function(e){return"TaskModel"!==e._uwaClassName||e.isProjectTask()?e.get(o.PERCENT_COMPLETE):" "},v={COLUMN_DATA_INDICES:c,RDF_TO_TREE_NODE:u,ER_TO_TREE_NODE:h,DURATION_ATTRS:m,DESCRIPTION_ATTRS:g,STATE_ATTRS:T,addListenersOnTreeNode:function(e){var t,n,s=e.getAttributeValue(l);if(s.isRDFTask()?(t=Object.keys(u),n=u):(t=Object.keys(h),n=h),t.forEach(t=>{s.addEvent("onChange:"+t,function(s,i){var a;a=-1!==m.indexOf(t)?C(s):-1!==T.indexOf(t)?f(s.getMaturityState()):-1!==g.indexOf(t)?D(i):t===o.DSLC_PRIORITY_ATTR?s.getPriorityValueNLSString():s.isRouteTask()&&"contents"===t?A(s):t==o.PARENT_HAS_SWYM_COMMUNITY?S(i):t==o.PERCENT_COMPLETE?R(s):s.get(t),e.setAttribute(n[t],a)})}),s.isRDFTask()){var i=s.get("dsxplan:hasAssignee");i&&s.listenTo(i,"onAccessSetOfGroup",function(t){e.setAttribute(c.assignees,t.get("ds6w:label"))})}else s.addEvent("onDestroy",function(){e.remove(),e.destroy()})},getMasksForFetchingRDFTaskDetails:function(e){return p[e]},getDisplayLabelForDuration:C,dateFieldsCompareFunc:function(e,t){return(e=e?new Date(e):new Date("10/10/200"))-(t=t?new Date(t):new Date("10/10/200"))},priorityCellSemantics:_,getDisplayLabelForState:f,getDisplayLabelForPriority:function(e){if(e)return e.length>8&&(e=e.substring(8)),d("Urgent"===e?"E6WCommonApps.Label.Urgent":"High"===e?"E6WCommonApps.Label.High":"Low"===e?"E6WCommonApps.Label.Low":"E6WCommonApps.Label.Medium")},getDisplayLabelForRouteContent:A,getDisplayLabelForDescription:D,getDisplayLabelForCommunity:S,getDisplayLabelForPercent:R,getClassForState:function(e){return e===d("E6WCommonApps.Label.Preliminary")?"maturity-state-draft":e===d("E6WCommonApps.Label.ToDo")?"maturity-state-todo":e===d("E6WCommonApps.Label.InWork")?"maturity-state-inwork":e===d("E6WCommonApps.Label.InReview")?"maturity-state-review":e===d("E6WCommonApps.Label.OnHold")?"maturity-state-onhold":e===d("E6WCommonApps.Label.Completed")?"maturity-state-completed":""},RDF_MODEL:l,comparator:function(e,t){const n=e.getAttributeValue(l),s=t.getAttributeValue(l);return"Milestone"===n.getObjectType()?"Milestone"!==s.getObjectType()&&"Gate"!==s.getObjectType()?-1:n.getStartDate()-s.getStartDate():"Gate"===n.getObjectType()?"Gate"===s.getObjectType()||"Milestone"===s.getObjectType()?n.getStartDate()-s.getStartDate():-1:n.getObjectType()===o.TASK?"Milestone"===s.getObjectType()?1:s.getObjectType()!==o.TASK?-1:a.comparator(n,s):s.get("dsxplan:jsType")&&s.get("dsxplan:jsType").includes("roject")?e.getAttributeValue("sequenceOrder")-t.getAttributeValue("sequenceOrder"):1},getAssigneesOnUpdate:function(e){if(!e)return"";if(e.member)return e.member;var t=[];return e instanceof n?t.push(e):t=e instanceof s&&e.getModels()[0]instanceof i&&!(e.getModels()[0]instanceof n)?e.getModels()[0].get("_models"):e.getModels(),t},COMMON_CSS_CLASS_FOR_GRID_COLUMNS:"column-text-color",MIN_WIDTH_OF_EACH_COLUMN:10,titleColumn:{text:d("E6WCommonApps.Label.Title"),dataIndex:"tree",typeRepresentation:"string",editableFlag:!1,className:"column-text-color grid-title-cell",minWidth:10,sortableFlag:!1,editionPolicy:"EditionOnDoubleClick",getCellSemantics:function(e){return{icon:e.nodeModel.getAttributeValue("icon")}}},priorityColumn:{text:d("E6WCommonApps.Label.Priority"),dataIndex:c.priority,editableFlag:!1,typeRepresentation:"string",className:"column-text-color",minWidth:10,sortableFlag:!1,editionPolicy:"EditionOnDoubleClick",getCellSemantics:_},stateColumn:{text:d("E6WCommonApps.Label.MaturityState"),dataIndex:c.maturity,editableFlag:!1,typeRepresentation:"enumString",className:"column-text-color",minWidth:10,sortableFlag:!1,editionPolicy:"EditionOnDoubleClick",getCellSemantics:function(){return{possibleValues:[d("E6WCommonApps.Label.Preliminary"),d("E6WCommonApps.Label.ToDo"),d("E6WCommonApps.Label.InWork"),d("E6WCommonApps.Label.OnHold"),d("E6WCommonApps.Label.Completed")]}},getCellClassName:function(e){return v.getClassForState(e.cellModel)}},percentCompleteColumn:{text:d("E6WCommonApps.Label.Percent"),dataIndex:c.percent,editableFlag:!1,typeRepresentation:"number",className:"column-text-color",minWidth:10,sortableFlag:!1},assigneesColumn:{text:d("E6WCommonApps.Label.Assignees"),dataIndex:"assignees",editableFlag:!1,typeRepresentation:"string",minWidth:10,sortableFlag:!1,editionPolicy:"EditionOnDoubleClick",getCellClassName:function(e){return"column-text-color grid-assignee-cell "+(e.nodeModel&&e.nodeModel.getAttributeValue("@id")&&e.nodeModel.getAttributeValue("@id").replace(":","").split("-").join(""))},customContentId:"assigneesContent",onCellRequest:function(t){var n=this.reuseCellContent("assigneesContent");if(n.empty(),!t.nodeModel)return;const s=t.nodeModel.getAttributeValue(l);if(s&&s.getAssignees){var i=function(e){var t=[];return e.getAssignees().getModels().forEach(e=>{t.push(e.getTransferObject().data.items[0])}),t||[]}(s);if(i.forEach(function(t){if(!t)return;let s=e.createElement("div",{class:"grid-user-image"});e.createElement("img",{draggable:"true",class:"grid-user-image-img",src:t.image,title:t.name||t.displayName||d("xPlan.Label.AnonymousUser"),"data-id":t.id||t["@id"]}).inject(s),s.inject(n)}),1===i.length){var o=i.getModels&&i.getModels()[0]||i[0];e.createElement("span",{class:"wux-tweakers-string-label",html:o.name||o.displayName||d("xPlan.Label.AnonymousUser")}).inject(n)}t.cellView._setReusableContent(n)}}},descriptionColumn:{text:d("E6WCommonApps.Label.Description"),dataIndex:c.description,typeRepresentation:"string",editableFlag:!1,sortableFlag:!0,visibleFlag:!0,className:"grid-description-cell",allowUnsafeHTMLContent:!0}};return v}),define("DS/E6WCommonApps/Models/E6WTreeNodeModel",["UWA/Core","UWA/Class/Listener","DS/TreeModel/TreeNodeModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TreeNodeUtil"],function(e,t,n,s,i){"use strict";const o=function(s){this.rdfModel=s.grid&&s.grid.correspondingModel;const o=e.clone(s,!1);if(this.rdfModel&&(Object.entries(i.RDF_TO_TREE_NODE).forEach(([e,t])=>{o.grid[t]=this.getTreeNodeValueForRdfAttribute(e)}),o.label=o.grid.title,o.icon=o.grid.icon),n.call(this,o),this.listener=new t,!s._isTrueRoot){if(!this.rdfModel)throw new Error("No associated rdf model!");this.addRdfModelListeners(),this._addRdfChildrenTimeout=setTimeout(()=>{this._addRdfChildrenTimeout=void 0,this.addExistingRdfChildren()},0)}};return(o.prototype=Object.create(n.prototype,{constructor:{value:o}})).addRdfModelListeners=function(){this.listener.listenTo(this.rdfModel,"onDestroy",()=>{this.remove(),this.destroy()}),this.listener.listenTo(this.rdfModel,"onAnyEvent",e=>{const t=/onChange:(.*)/.exec(e);t&&this.onRdfModelAttributeChange(t[1])})},o.prototype.onRdfModelAttributeChange=function(e){const t=i.RDF_TO_TREE_NODE[e];t&&(this.setAttribute(t,this.getTreeNodeValueForRdfAttribute(e)),e===s.DSLC_TITLE_ATTR&&this.setLabel(this.getTreeNodeValueForRdfAttribute(e)),this.acceptChangesDelayed())},o.prototype.getTreeNodeValueForRdfAttribute=function(e){switch(e){case s.DSLC_DESCRIPTION_ATTR:return i.getDisplayLabelForDescription(this.rdfModel.get(s.DSLC_DESCRIPTION_ATTR));case"dsxplan:hasMaturity":return i.getDisplayLabelForState(this.rdfModel.getMaturityState());case"dsxplan:hasAssignee":return i.getAssigneesOnUpdate(this.rdfModel.get("dsxplan:hasAssignee"));case"icon":if(this.rdfModel.getDefaultImage)return this.rdfModel.getDefaultImage();break;default:return this.rdfModel.get(e)}},o.prototype.acceptChangesDelayed=function(){this._acceptChangesTimeout&&clearTimeout(this._acceptChangesTimeout),this._acceptChangesTimeout=setTimeout(()=>{this.acceptChanges()},100)},o.prototype.sortChildren=function(){!this._sortTimeout&&(this._sortTimeout=setTimeout(()=>{this._sortTimeout=void 0,n.prototype.sortChildren.call(this,{sortFunction:i.comparator})},200))},o.prototype.addChild=function(e,t,s){const o=s&&s.treeDocument?s.treeDocument:this.getTreeDocument(),a=o.options.nodeModelClass;let r=e;if(e instanceof n){const t=o.getTreeNodeModelFromRdfModel(e.rdfModel);if(t&&t!==e)throw new Error("Attempting to add duplicate TreeNodeModel to the document");r=e}else{const t=e&&e.grid&&e.grid[i.RDF_MODEL];o.getTreeNodeModelFromRdfModel(t)?r=o.getTreeNodeModelFromRdfModel(t):o.options.nodeModelClass=this.getTreeDocument().getTreeNodeModelConstructor(t)}const l=n.prototype.addChild.call(this,r,t,s);o.options.nodeModelClass=a;const d=this.getTreeDocument().shouldBeExpanded(this)?"expanded":"collapsed";return this.getState()!==d&&this.setState({state:d}),this.sortChildren(),l},o.prototype.addExistingRdfChildren=Function.prototype,o.prototype.addRdfChild=function(e){this.addChild(e.getTreeNodeModelData())},o.prototype.removeRdfChild=function(e){this.getChildren()&&this.getChildren().includes(this.getTreeDocument().getTreeNodeModelFromRdfModel(e))&&this.removeChild(this.getTreeDocument().getTreeNodeModelFromRdfModel(e))},o.prototype.destroy=function(){this._addRdfChildrenTimeout&&clearTimeout(this._addRdfChildrenTimeout),this._addRdfChildrenTimeout=void 0,this._sortTimeout&&clearTimeout(this._sortTimeout),this._sortTimeout=void 0,this.listener.stopListening(),this._modelEvents.publish({event:"onDestroy"}),n.prototype.destroy.call(this,arguments)},o.ADD_CHILD_TIMEOUT=0,o.ACCEPT_CHANGE_DELAY=100,o}),define("DS/E6WCommonApps/Models/BacklogWorkscopeTreeNodeModel",["DS/E6WCommonApps/Models/E6WTreeNodeModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],function(e,t){"use strict";const n=function(){e.apply(this,arguments)};return(n.prototype=Object.create(e.prototype,{constructor:{value:n}})).addRdfModelListeners=function(){e.prototype.addRdfModelListeners.apply(this,arguments),this.listener.listenTo(this.rdfModel.getTasks(),"onAdd",e=>e.get(t.WORK_CONTEXT_ATTR)&&this.addRdfChild(e)),this.listener.listenTo(this.rdfModel.getTasks(),"onRemove",e=>this.removeRdfChild(e)),this.listener.listenTo(this.rdfModel.getTasks(),"onChange:dsplan:sequenceOrder",()=>this.sortChildren()),this.listener.listenTo(this.rdfModel.getTasks(),`onChange:${t.WORK_CONTEXT_ATTR}`,(e,t)=>{t?this.addRdfChild(e):this.removeRdfChild(e)})},n.prototype.addExistingRdfChildren=function(){this.rdfModel.getTasks().forEach(e=>e.get(t.WORK_CONTEXT_ATTR)&&this.addRdfChild(e))},n}),define("DS/E6WCommonApps/Models/AccessModel",["UWA/Core","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/Models/XPPModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/TreeNodeUtil","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/SubscriptionUtils","DS/E6WCommonApps/Models/E6WTreeNodeModel","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/UIHelper","DS/RDFFoundation/MemberUtils"],function(e,t,n,s,i,o,a,r,l,d,c,p){"use strict";var u,h="invoke/dsxplan:checkOperationOnResourceClone",m="dsaccess:Operation.Shareable.Modify",T="dsaccess:Operation.Shareable.Delete",g=s.extend({_uwaClassName:"AccessModel",sourceName:"3dplan",setup:function(){this._parent.apply(this,arguments),this.listenTo(this,`onChange:${a.ASSIGNEE_ATTR}`,()=>{let e=this.get(a.ASSIGNEE_ATTR)&&this.get(a.ASSIGNEE_ATTR).some(e=>e.get("dsaccess:accountName")&&e.get("dsaccess:accountName").includes(d.getContextUser()));!this.canModify()&&e?this.refreshAccessData():this.canModify()&&!e&&this.refreshAccessData()})},parse:function(){var e=this._parent.apply(this,arguments);return this.handleRepositoryAttributes(e,"dsxplan:hasContentRepository"),this.handleRepositoryAttributes(e,"dsplan:hasCollaborativeSpace"),e},handleRepositoryAttributes:function(t,n){var s=t[n]||this.get(n);if(s&&e.is(s,"string")){var i=this._normalizedRepo(s);this._models[n]=i,t[n]=i}},get:function(e){return"canEdit"===e?this.canModify(!0):"deleteAccess"===e?this.canDelete(!0):"source"===e?"3dplan":this._parent.apply(this,arguments)},isDSLC:function(e){var t=e||this._attributes;return!(!t||!t["dsxplan:jsType"]&&!t["@type"])},syncCreate:function(e,t){this._parent.apply(this,arguments);var s=t.idToDuplicate?n.CLONE_ITEM_VERSION_URI:n.CREATE_ITEM_VERSION_URI,o=t.mask||this.writeMask||this.getMask(),a=o?"?$mask="+o:"";t.url=i.expandUrl(s+a);var r=this.getParentPath(),l=t.idToDuplicate,d=t.activityIdToSubscribe;t.data=l?JSON.stringify([t.attrs,l,r,d,Boolean(this.get("dsplan:isTemplate")||t.parentModelIsTemplate)]):JSON.stringify([t.attrs,r]),t.method="POST"},canModify:function(e){return!d.isXppViewer()&&(!this.hasFetchedAccessData()&&e&&u.requestFetch(this),Boolean(this._accessModify))},canDelete:function(e){return!d.isXppViewer()&&(!this.hasFetchedAccessData()&&e&&u.requestFetch(this),Boolean(this._accessDelete))},canShare:function(){return!d.isXppViewer()&&(c.isModelOwnerTheLoggedInUser(this)||Boolean(this._accessShare))},getTreeNodeModelData:function(){const e=this.createNodeData();return{label:e.title,grid:e,icons:e.icons,children:e.hasChildren?[]:null}},createNodeData:function(){return{"@id":this.id,tree:this.get(a.DSLC_TITLE_ATTR),title:this.get(a.DSLC_TITLE_ATTR),uniqueObjectId:this.get(a.UNIQUE_OBJECT_ID_ATTR),[o.RDF_MODEL]:this,sequenceOrder:this.get(a.SEQUENCE_ORDER_ATTR),"dsxplan:jsType":this.get("dsxplan:jsType"),maturity:o.getDisplayLabelForState(this.getMaturityState()),priority:o.getDisplayLabelForPriority(this.get("dsplan:hasPriority")),assignees:this.getAssignees().getModels()}},getTreeNodeModel:function(){return this._treeNodeModel?this._treeNodeModel.show():this._treeNodeModel=new l({grid:{correspondingModel:this}}),this._treeNodeModel},fetchAccess:function(e){this.hasFetchedAccessData()||u.requestFetch(this,e)},refreshAccessData:function(e){this.hasFetchedAccessData()&&u.requestFetch(this,e)},getAccessBatch:function(t){var n,s=this;(n=t&&t.batchBuilder?t.batchBuilder:i.getBatchGenerator({ignoreDictionary:t&&t.ignoreDictionary})).ajax(i.expandUrl(h),{method:"POST",onComplete:function(n){return s.setModifyAccess(n["@value"]),t&&e.is(t.onComplete,"function")&&t.onComplete.apply(this,arguments)},onFailure:function(){return t&&e.is(t.onFailure,"function")&&t.onFailure.apply(this,arguments)},onTimeout:t&&t.onFailure,headers:{"Content-Type":"application/json"},data:JSON.stringify([this.id,m]),type:"json"}),n.ajax(i.expandUrl(h),{method:"POST",onComplete:function(n){return s.setDeleteAccess(n["@value"]),t&&e.is(t.onComplete,"function")&&t.onComplete.apply(this,arguments)},onFailure:function(){return t&&e.is(t.onFailure,"function")&&t.onFailure.apply(this,arguments)},onTimeout:t&&t.onFailure,headers:{"Content-Type":"application/json"},data:JSON.stringify([this.id,T]),type:"json"});var o=n.sendBatch;return n.sendBatch=function(t){var n=e.clone(t||{},!1);s.fetchingAccessRights=!0,n.onComplete=function(){delete s.fetchingAccessRights,t&&t.onComplete&&t.onComplete()},n.onFailure=function(){delete s.fetchingAccessRights,t&&t.onFailure&&t.onFailure()},o.call(this,n)},n},hasFetchedAccessData:function(){return!!d.isXppViewer()||Boolean(void 0!==this._accessModify&&void 0!==this._accessDelete)},setAccess:function(t,n){var s=e.clone(n||{},!1),i=s.silent;s.silent=!0;var o=this._accessModify,a=this._accessDelete,r=this._accessShare;this.setModifyAccess(t,s),this.setDeleteAccess(t,s),this.setShareAccess(t,s),i||(a!==t&&this.dispatchEvent("onDeleteAccessChanged"),o!==t&&this.dispatchEvent("onModifyAccessChanged",[this]),r!==t&&this.dispatchEvent("onShareAccessChanged"))},setModifyAccess:function(t,n){var s=e.clone(n||{},!1);this._accessModify!==t&&(this._accessModify=t,!s.silent&&this.dispatchEvent("onModifyAccessChanged",[this]))},setDeleteAccess:function(t,n){var s=e.clone(n||{},!1);this._accessDelete!==t&&(this._accessDelete=t,!s.silent&&this.dispatchEvent("onDeleteAccessChanged"))},setShareAccess:function(t,n){var s=e.clone(n||{},!1);this._accessShare!==t&&(this._accessShare=t,!s.silent&&this.dispatchEvent("onShareAccessChanged"))},clearAccess:function(e){this.setDeleteAccess(void 0,e),this.setModifyAccess(void 0,e),this.setShareAccess(void 0,e)},onShareNotification:function(e,t){var n,s=t&&t.agentList,o=!1,a=t&&Object.keys(t)[0];if(!s&&"dsplan:hasAssignee"===a){var r=t["dsplan:hasAssignee"]["@id"];s=[r],(n=i.getObjectById(r))&&"foaf:Group"===n.get("dsxplan:jsType")&&(o=!0)}(s=s.map(function(e){if(e)return i.removeBracketLongURI(e)}))&&(s.includes(p.addUUIDToURI(d.getContextUserUid()))||o)&&(this.refreshAccessData(),this.fetch({mask:"dsplan:MVMask.ScheduleElements.Basic",ajax:e.ajax,onComplete:function(e,t){t["dsxplan:jsType"]?"dsplan:Task"===t["dsxplan:jsType"]&&"dsplan:hasAssignee"===a&&e.unset("dsxplan:hasAssignee"):(e.dispatchEvent("liveUpdateAccessRevoked"),e.destroy({noServer:!0,fromNotification:!0}))},onFailure:function(e){e.dispatchEvent("liveUpdateAccessRevoked"),e.destroy({noServer:!0,fromNotification:!0})},onTimeout:function(){}}))},getRelatedModelCompactJson:function(e,n){return"dsxplan:hasContentRepository"===n&&e instanceof t?e.id:this._parent.apply(this,arguments)},currentUserIsLeader:function(){return this.canShare()},isComplete:function(){var e=this.get(a.STATE_ATTR);return enoviaServer.useFD01CodeFor3DPlan?"Done"===e:(e&&(e.id||e["@id"]||e))===a.STATE_DONE},getMaturityState:function(){var e=this.get(a.DSLC_STATE_ATTR),t=e&&(e["@id"]||e.get&&e.get("@id"));return t&&t.substring(8)}}),E={cancel:function(){this.model.fetchingAccessRights=!1,this.fetching?(delete this._onComplete,delete this.queue.fetching[this.model.id]):delete this.queue.toBeFetched[this.model.id]},onComplete:function(){this._onComplete&&this._onComplete.apply(this,arguments),delete this.queue.fetching[this.model.id],delete this.model.fetchingAccessRights},onFailure:function(){this._onFailure&&this._onFailure.apply(this,arguments),delete this.queue.fetching[this.model.id],delete this.model.fetchingAccessRights}},A=function(){this.onComplete=E.onComplete.bind(this),this.onFailure=E.onFailure.bind(this),this.cancel=E.cancel.bind(this)};return(u={fetchAccess:function(){delete this.fetchTimeout;var t=this.toBeFetched;this.toBeFetched={};var n=Object.keys(t),s=n.length;if(!s)return{cancel:function(){}};for(var o=i.getBatchGenerator(),a=0;a<s;a++){var r=n[a],l=t[r];l.fetching=!0,this.fetching[r]=l;var d=l.model;o.addRequestsFromBatch(d.getAccessBatch(e.extend(l,{ignoreDictionary:!0})))}return o.sendBatch()},requestFetch:function(t,n){if(!t.id)return t.setAccess(!0),{cancel:function(){}};if(t.fetchingAccessRights)return{cancel:function(){}};t.fetchingAccessRights=!0;var s=e.clone(n||{},!1),i=this.toBeFetched[t.id]||this.fetching[t.id];return i||((i=new A).model=t,i._onComplete=s.onComplete,i._onFailure=s.onFailure,i.queue=this,this.toBeFetched[t.id]=i,this.fetchTimeout||(this.fetchTimeout=setTimeout(this.fetchAccess.bind(this),this.TIMEOUT_LENGTH)),Object.keys(this.toBeFetched).length>=g.MAX_FETCH_COUNT&&(clearTimeout(this.fetchTimeout),delete this.fetchTimeout,this.fetchAccess()),i)},resetQueue:function(){this.toBeFetched={},this.fetching={},clearTimeout(this.fetchTimeout),delete this.fetchTimeout}}).toBeFetched={},u.fetching={},u.TIMEOUT_LENGTH=97,g.AccessModelQueue=u,g.DELETE_DATA=T,g.MODIFY_DATA=m,g.ACCESS_URL=h,g.SHARE_DATA="dsaccess:Operation.Shareable.Share",Object.defineProperty(g,"MAX_FETCH_COUNT",{get:function(){return g._maxFetchCountGet()}}),g._maxFetchCountGet=function(){return 20},g.AccessModelQueue=u,g}),define("DS/E6WCommonApps/Models/ConstraintModel",["UWA/Core","DS/RDFFoundation/Models/XPPModel","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Models/AccessModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/TaskModelMixin","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l){"use strict";var d="dsxplan:constraintType",c="dsxplan:deleteTemporalConstraint",p="dsxplan:createTemporalConstraint",u="dsxplan:modifyTemporalConstraint",h=function(e){return l.get(e)},m=t.extend({_uwaClassName:"ConstraintModel",liveUpdateCreateMask:"dsplan:MVMask.Constraint.Complex",init:function(t,n){const s=e.clone(t||{},!1);s["dsplan:jsType"]=s["dsplan:jsType"]||s["dsxplan:jsType"]||"dsplan:TemporalConstraint",this._parent(s,n)},setup:function(t,n){var s=e.clone(n||{},!1);this._parent.apply(this,arguments),s.dontUpdateConstrainedScheduleElements||this.updatePointers(s),this.hasAccessListeners=!1},updatePointers:function(e){this.updateBackpointers(),this.updateParentWorkscopes({silent:e&&e.silent})},save:function(t,n){var s=this,i=e.clone(n||{},!1),o=Array.prototype.slice.call(arguments,0);o[1]=i;var a=this.getPredecessor(),r=this.getSuccessor();if(a&&a.shouldWeSolve({assumeChanges:!0})){var l=i.onComplete;i.onComplete=function(){if(s.get(m.ENFORCE_ATTR)||t&&void 0!==t[m.ENFORCE_ATTR]){var n={};if(r){var i=r.getParent();n.additionalElementsToSolve=[r.id],n.additionalParentElementsToSolve=[i&&i.id]}a.solve(n)}e.is(l,"function")&&l.apply(this,arguments)}}return this._parent.apply(this,o)},destroy:function(t){var n=this,s=this.getPredecessor(),i=this.getSuccessor();this.stopListening(s),this.stopListening(i);var o=e.clone(t||{},!1),a=Array.prototype.slice.call(arguments,0);if(a[0]=o,!o.fromNotification&&s&&s.shouldWeSolve({assumeChanges:!0})){var r=o.onComplete;o.onComplete=function(t){if(!t.isNew()){var o=n.get(m.ENFORCE_ATTR);if(e.is(o)&&o){var a=i.getParent(),l=i&&{additionalElementsToSolve:[i.id],additionalParentElementsToSolve:[a&&a.id]};s.solve(l)}n.removeFromScheduleElements(),e.is(r,"function")&&r.apply(this,arguments)}}}this._parent.apply(this,a)},getLeadLagTime:function(e){return e=void 0!==e?i.xsdDayTimeDurationToMilliseconds(e)/(60*o.WORKING_HOURS_IN_A_DAY*60*1e3):0,String(e)},isCompleted:function(){return this.get("dsxplan:from").isCompleted&&this.get("dsxplan:from").isCompleted()&&this.get("dsxplan:to").isCompleted&&this.get("dsxplan:to").isCompleted()},get:function(e){return"canEdit"===e?this.canModify(!0):this._parent.apply(this,arguments)},getObjectType:function(){return"Constraint"},toJSON:function(t){var n=e.clone(t||{},!1),s=this._parent.apply(this,arguments);return n.dataForRendering&&(s=e.merge(s,this.dataForRendering({excludeCanEdit:t.excludeCanEdit}))),s},getErrorStatus:function(){var e=this.get(o.SCHEDULE_ERROR_ATTR);return e&&("function"==typeof e.get&&e.id!==o.NO_SOLVER_ERROR||"string"==typeof e&&i.longToShortURI(e)!==o.NO_SOLVER_ERROR)?o.DEPENDENCY_STATUS_BROKEN:o.DEPENDENCY_STATUS_OK},getDateForRendering:function(e){return r.getIntlDateFormat(e).displayValue},dataForRendering:function(t){var s,i=this.get("dsxplan:from"),a=this.get("dsxplan:to"),l=this.get("dsxplan:lag"),c={type:this.get(d),subtitle:this.get("subtitle"),physicalId:this.get("physicalId")||this.cid,enforcedType:this.get("dsxplan:isEnforced")?o.DEPENDENCY_TYPE_ENFORCED:o.DEPENDENCY_TYPE_FLEXIBLE};if(t&&t.excludeCanEdit||(c.canEdit=this.get("canEdit")),c[m.DAYS_STRING]=r.getDaysStringForDate(l),i instanceof m.ScheduleElementModel){let t,n="",s=i.get(o.PARENT_ATTR);s&&(t=s.get("@id"),n=s.get(o.DSLC_TITLE_ATTR)),c=e.extend(c,{predecessor:{id:i.get("@href"),ref:i.get("@id"),title:i.get("title")},predecessorTitle:i.get("title"),predecessorImage:i.getIconURL(),predecessorParent:n,predecessorParentId:t}),i.get(o.DSLC_STATE_ATTR)&&(c.fromStatus=i.get(o.DSLC_STATE_ATTR).get("title")),i.get("fromDate")&&(c.fromDate=this.getDateForRendering(i.get("fromDate")))}else s=new n,(c=e.extend(c,{predecessorTitle:s.get("dsxplan:label"),predecessorImage:s.get("image")})).fromStatus=s.get("dsxplan:label"),c.fromDate=s.get("dsxplan:label"),c.fromStatusImage=s.get("image");if(a instanceof m.ScheduleElementModel){let t,n="",s=a.get(o.PARENT_ATTR);s&&(t=s.get("@id"),n=s.get(o.DSLC_TITLE_ATTR)),c=e.extend(c,{successor:{id:a.get("@href"),ref:a.get("@id"),title:a.get("title")},successorTitle:a.get("title"),successorImage:a.getIconURL(),successorParent:n,successorParentId:t}),a.get(o.DSLC_STATE_ATTR)&&(c.toStatus=a.get(o.DSLC_STATE_ATTR).get("title")),a.get("toDate")&&(c.toDate=this.getDateForRendering(a.get("toDate")))}else s=new n,(c=e.extend(c,{successorTitle:s.get("dsxplan:label"),successorImage:s.get("image")})).toStatus=s.get("dsxplan:label"),c.toDate=s.get("dsxplan:label"),c.toStatusImage=s.get("image");c.leadLagTime=this.getLeadLagTime(this.get("dsxplan:lag")),c.status=this.getErrorStatus();let p=this.get(d),u="";return m.TYPES_DISPLAY_MAPPING.forEach(function(e){e.actualValue===p&&(u=e.displayValue)}),c.relationship=u,c},_getFullEndPoint:function(e){var t,n=this.get(e);return n instanceof m.ScheduleElementModel&&(t=n),t},getSuccessor:function(){return this._getFullEndPoint("dsxplan:to")},getPredecessor:function(){return this._getFullEndPoint("dsxplan:from")},getType:function(){return this.get(d)},updateBackpointers:function(e){var t=this,n=this.getPredecessor();n&&n.addPredecessorConstraint&&(n.addPredecessorConstraint(this,e),this.stopListening(n),this.listenTo(n,"onModifyAccessChanged",function(){t.dispatchEvent("onModifyAccessChanged")}),this.listenTo(n,"onDeleteAccessChanged",function(){t.dispatchEvent("onDeleteAccessChanged")}));var s=this.getSuccessor();s&&s.addSuccessorConstraint&&s.addSuccessorConstraint(this,e)},removeFromScheduleElements:function(){var e=this.getPredecessor(),t=this.getSuccessor();e&&e.removePredecessorConstraint&&e.removePredecessorConstraint(this),t&&t.removeSuccessorConstraint&&t.removeSuccessorConstraint(this)},syncDelete:function(e){this._parent.apply(this,arguments),e.url=i.expandUrl("invoke/"+c),e.data=JSON.stringify([this.id]),e.method="POST"},syncCreate:function(e,t){t.noStringify=!0,this._parent(e,t),t.url=i.expandUrl("invoke/"+p),t.data=JSON.stringify([t.attrs]),t.method="POST"},syncPatch:function(e,t){if(t.noStringify=!0,this._parent(e,t),!t.attrs)return{cancel:function(){}};t.url=i.expandUrl("invoke/"+u),t.data=JSON.stringify([t.attrs,this.id]),t.method="POST"},canModify:function(e){var t=!1,n=this.getPredecessor(),s=this.getSuccessor(),i=this.hasFetchedAccessData();if(s&&n){!this.hasAccessListeners&&this.listenToAccessChanged(s,n);var o=s.hasViewAccess()&&n.hasViewAccess(),a=n.canModify(!0)||s.canModify(!0);t=o&&a}return!i&&e&&this.fetchAccessData(),!i||t},hasFetchedAccessData:function(){var e=this.getPredecessor(),t=this.getSuccessor();return e&&t&&e.hasFetchedAccessData()&&t.hasFetchedAccessData()},fetchAccessData:function(e){var t=this.getPredecessor(),n=this.getSuccessor();t&&s.AccessModelQueue.requestFetch(t,e),n&&s.AccessModelQueue.requestFetch(n,e)},getPropertyMask:function(){return"dsplan:MVMask.Constraint.Complex"},fetchForProperty:function(t){let n=e.clone(t||{},!1);var s={mask:this.getPropertyMask&&this.getPropertyMask(),dontUpdateMask:!0,onlyIfNeeded:!0};n.batchBuilder&&(s.ajax=n.batchBuilder.ajax),this.fetch(s)},listenToAccessChanged:function(e,t){this.hasAccessListeners=!0;var n={onModifyAccessChanged:function(){this.dispatchEvent("onModifyAccessChanged",[this])}.bind(this),onDeleteAccessChanged:function(){this.dispatchEvent("onDeleteAccessChanged",[this])}.bind(this)};this.listenTo(e,n),this.listenTo(t,n)},canDelete:function(){return this.canModify(!0)},canEnforce:function(){return this.canModify(!0)},updateParentWorkscopes:function(t){var n=e.clone(t||{},!1),s=n.fromParent||this.getParentWorkscope(this.getPredecessor()),i=n.toParent||this.getParentWorkscope(this.getSuccessor());s&&s.hasViewAccess()&&s&&s.addModelToAttributeWithCollection(o.CONSTRAINT_RELATION_ATTR,this,t),!i||!i.hasViewAccess()||s&&s.id===i.id||i.addModelToAttributeWithCollection(o.CONSTRAINT_RELATION_ATTR,this,t),n.dontRetryParents||s&&i||setTimeout(()=>{this.updateParentWorkscopes(e.merge(n,{dontRetryParents:!0,forceDispatchEvent:!0}))},0)},getParentWorkscope:function(e){var t=e&&e.hasViewAccess()&&e.getParent();return e&&e.hasViewAccess()&&(t=e.getProjectParent(e)),t},getParentPath:function(){return""},getWorkDayLength:function(){return 8},processLiveUpdateCreation:function(e){var t=i.getObjectById(e["@parentFromId"]),n=i.getObjectById(e["@fromId"]),s=i.getObjectById(e["@parentToId"]),a=i.getObjectById(e["@toId"]);(t&&t.hasFetchedAttribute(o.CONSTRAINT_RELATION_ATTR)||s&&s.hasFetchedAttribute(o.CONSTRAINT_RELATION_ATTR)||a&&a.hasFetchedAttribute("dsplan:taskHasConstraint")||n&&n.hasFetchedAttribute("dsplan:taskHasConstraint"))&&this.fetch({mask:this.liveUpdateCreateMask,onComplete:function(e){e.updateBackpointers(),e.updateParentWorkscopes({fromParent:t,toParent:s})}})},_parseNestedModelsAndCollections:function(e){var t,n,s=e["dsplan:hasScheduleError"];return s&&s.member&&(n=(t=s).member,t["dsxplan:jsType"]||n||(t["dsxplan:jsType"]="dsxplan:ScheduleError"),n&&n.forEach(function(e){e["dsxplan:jsType"]||(e["dsxplan:jsType"]="dsxplan:ScheduleError")})),this._parent.apply(this,arguments)}});return m.shouldCreateOnLiveUpdate=function(e){var t=i.getObjectById(e["@parentFromId"]),n=i.getObjectById(e["@fromId"]),s=i.getObjectById(e["@parentToId"]),o=i.getObjectById(e["@toId"]);return t||n||s||o},m.PREDECESSOR_ATTR="dsxplan:from",m.SUCCESSOR_ATTR="dsxplan:to",m.TYPE_ATTR=d,m.CONSTRAINT_TYPE_ATTR="relationship",m.ENFORCE_ATTR="dsxplan:isEnforced",m.LAG_ATTR="dsxplan:lag",m.TYPE_FINISH_TO_START="Before",m.TYPE_START_TO_START="SS",m.TYPE_FINISH_TO_FINISH="FF",m.TYPE_START_TO_FINISH="SF",m.CONSTRAINT_RDF_TYPE="dsplan:TemporalConstraint",m.CONSTRAINT_FLEXIBLE_RDF_TYPE="dsplan:ControlledTemporalConstraint",m.DELETE_URL=c,m.CREATE_URL=p,m.MODIFY_URL=u,m.ENFORCED_TYPE="enforcedType",m.ERROR_STATUS="status",m.FROM="from",m.TO="to",m.FROM_DATE="fromDate",m.TO_DATE="toDate",m.FROM_MATURITY="fromStatus",m.TO_MATURITY="toStatus",m.FROM_MATURITY_IMAGE="fromStatusImage",m.TO_MATURITY_IMAGE="toStatusImage",m.DAYS_STRING="daysString",m.LEAD_LAG_TIME="leadLagTime",m.TYPES_DISPLAY_MAPPING=[{actualValue:m.TYPE_START_TO_START,displayValue:h("E6WCommonApps.Label.StartToStart")},{actualValue:m.TYPE_FINISH_TO_START,displayValue:h("E6WCommonApps.Label.FinishToStart")},{actualValue:m.TYPE_FINISH_TO_FINISH,displayValue:h("E6WCommonApps.Label.FinishToFinish")},{actualValue:m.TYPE_START_TO_FINISH,displayValue:h("E6WCommonApps.Label.StartToFinish")}],m}),define("DS/E6WCommonApps/Models/BaselineModel",["UWA/Core","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],function(e,t,n,s){"use strict";const i=["start","end","actualStart","actualEnd"];var o=t.extend({init:function(t,n){const s=e.clone(t||{},!1);s.forceDslc=!0,this._parent(s,n)},loadFCSFile:function(t){let s=e.clone(t||{});this._modelMap||(this._loading=!0,n.downloadFCSFile(this.id,{onComplete:e=>{this._parseFCSFile(e),s.onComplete&&t.onComplete(),this._loading=!1},onFailure:()=>{this._loading=!1,s.onFailure&&s.onFailure()}}))},_parseFCSFile:function(t){let s=JSON.parse(t);this._modelMap={},s.elements.forEach(t=>{let s=e.clone(t||{},!1);i.forEach(e=>{s[e]&&(s[e]=new Date(s[e]))}),this._modelMap[n.removeBracketLongURI(t.id)]=s})},isLoading:function(){return this._loading},hasLoadedFCSData:function(){return Boolean(this._modelMap)},getDataForModel:function(e){if(this.hasLoadedFCSData())return this.getDataForId(e.id)},getDataForId:function(t){let n=this._modelMap?this._modelMap[t]:"";if(n){let t=e.clone(n);return"Task"===n.type&&"Open"!==n.state||"Gate"===n.type&&"Done"===n.state||"Milestone"===n.type&&"Done"===n.state?t.start=n.actualStart:t.start=n.start,t.end="Done"===n.state?n.actualEnd:n.end,t}},getChangedModels:function(e){var t=[];return e.forEach(e=>{const s=this.getDataForId(e);if(this._modelMap&&!this._modelMap[e])-1===t.indexOf(e)&&t.push(e);else{const i=n.getObjectById(e);!s||"Task"!==s.type&&"Milestone"!==s.type&&"Gate"!==s.type||this.filterScheduleElements(s,i,t,e)}}),t},filterScheduleElements:function(e,t,n,s){if(t&&e){var i=!1;i=this.areSameDescription(t,e);const o=t.getStartDate(),a=e.start,r=t.getEndDate(),l=e.end;!i&&o&&a&&(i=!this.areSameDate(o,a)),!i&&r&&l&&(i=!this.areSameDate(r,l)),i&&-1===n.indexOf(s)&&n.push(s)}},areSameDescription:function(e,t){var n=e.get(s.DSLC_DESCRIPTION_ATTR);n=n||"";var i=t.description;return n!==(i=i||"")},areSameDate:function(e,t){var n=!1;let s=new Date(e).getTime(),i=new Date(t).getTime();return Math.abs(s-i)<18e4&&(n=!0),n},hasViewAccess:()=>!0});return o.COMPLETE="Done",o.OPEN="Open",o.TASK="Task",o}),define("DS/E6WCommonApps/Preferences",["UWA/Core","UWA/Class/Events","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/PreferenceUtils","DS/E6WCommonApps/Models/BaselineModel","DS/E6WCommonApps/SmartSchedulerUtils"],function(e,t,n,s,i,o,a,r){"use strict";var l=o.get,d=o.set,c=o.parse;const p={DATE_RANGE:"timeline-daterange1",DIVIDER:"timeline-divider",FONT_SIZE:"timeline-fontsize",ZOOM:"timeline-zoom",EXPAND_LIST:"timeline-expand-list",SCROLL_TOP:"timeline-scroll-top",TIME_MACHINE:"timeline-time-machine",LEFT_MARGIN:"timeline-left-margin1",SHOW_TIME_MACHINE:"show-time-machine",SHOW_ACTIONBAR:"show-action-bar",SHOW_CONSTRAINTS:"show-constraints",SHOW_COMPRESSION:"show-compression",HIDE_WEEKLABEL:"hide-weeklabel",EXPAND_IDS:"expand-ids",COLLAPSED_IDS:"collapsed-ids",HIDE_TASKS:"hide-tasks",USE_FTS_ON_SCHEDULE_TAB:"useFTSonScheduleTab",SHOW_SUMMARY_TIMELINE:"show-summary-timeline",SHOW_BASELINES:"show-baselines",SHOW_PROGRESSLINES:"show-progresslines",ACTIVE_BASELINE:"active-baseline",SCHEDULE_TAGGER_FILTER:"scheduleTaggerFilter",HIGHLIGHT_CRITCIAL_PATH:"highlightCriticalPath",EXEC_ASSIST:"execAssistant",FILTER_CRITCIAL_PATH:"filterCriticalPath",HIDE_ASSIGNEES:"hideAssignees",WORK_HOURS:"workHours",ENABLE_CALENDAR:"enableCalendar",filteredIterations:"filteredIterations",roadmapPrefs:"roadmapPrefs",iterationView:"iterationView",iterationViewExpanded:"iterationViewExpanded"};var u=new(t.extend({POSTFIX:"",PREF_KEYS:p,setCurrentProject:function(t){if(this.PREF_KEYS=e.clone(p,!0),Object.keys(this.PREF_KEYS).forEach(function(e){this[e]=this[e]+t},this.PREF_KEYS),void 0===this.useFTSonScheduleTab()){this.setUseFTSonScheduleTab(!1)}void 0===c(l(this.PREF_KEYS.EXPAND_IDS))&&this.setExpandIds([t]),i.isXppViewer()&&void 0===c(l(this.PREF_KEYS.SHOW_CONSTRAINTS))&&this.setShowConstraints(!1),this._currentProjectId=t},getDateRange:function(){return c(l(this.PREF_KEYS.DATE_RANGE))},setDateRange:function(e){d(this.PREF_KEYS.DATE_RANGE,JSON.stringify(e))},getDividerPositionAsTimelinePercentage:function(){return c(l(this.PREF_KEYS.DIVIDER))},setDividerPositionAsTimelinePercentage:function(e){d(this.PREF_KEYS.DIVIDER,JSON.stringify(e))},getFontSize:function(){return c(l(this.PREF_KEYS.FONT_SIZE))},setFontSize:function(e){d(this.PREF_KEYS.FONT_SIZE,JSON.stringify(e))},getZoomLevel:function(){return c(l(this.PREF_KEYS.ZOOM))},setZoomLevel:function(e){d(this.PREF_KEYS.ZOOM,JSON.stringify(e))},getExpandList:function(){return c(l(this.PREF_KEYS.EXPAND_LIST))},setExpandList:function(e){d(this.PREF_KEYS.EXPAND_LIST,JSON.stringify(e))},getScrollTop:function(){return c(l(this.PREF_KEYS.SCROLL_TOP))},setScrollTop:function(e){d(this.PREF_KEYS.SCROLL_TOP,JSON.stringify(e))},getTimeMachineRange:function(){return c(l(this.PREF_KEYS.TIME_MACHINE))},setTimeMachineRange:function(e){d(this.PREF_KEYS.TIME_MACHINE,JSON.stringify(e))},getShowTimeMachine:function(){return c(l(this.PREF_KEYS.SHOW_TIME_MACHINE))},setShowTimeMachine:function(e){d(this.PREF_KEYS.SHOW_TIME_MACHINE,JSON.stringify(!0===e))},getShowActionBar:function(){return c(l(this.PREF_KEYS.SHOW_ACTIONBAR))},setShowActionBar:function(e){d(this.PREF_KEYS.SHOW_ACTIONBAR,JSON.stringify(!0===e))},getShowConstraints:function(){return!1!==c(l(this.PREF_KEYS.SHOW_CONSTRAINTS))},setShowConstraints:function(e){d(this.PREF_KEYS.SHOW_CONSTRAINTS,JSON.stringify(!0===e))},getShowCompression:function(){return!1!==c(l(this.PREF_KEYS.SHOW_COMPRESSION))},setShowCompression:function(e){d(this.PREF_KEYS.SHOW_COMPRESSION,JSON.stringify(!0===e))},getHideWeekLabel:function(){return!1!==c(l(this.PREF_KEYS.HIDE_WEEKLABEL))},setHideWeekLabel:function(e){d(this.PREF_KEYS.HIDE_WEEKLABEL,JSON.stringify(!0===e)),this.dispatchEvent("onChange:"+p.HIDE_WEEKLABEL)},setExpandIds:function(e){d(this.PREF_KEYS.EXPAND_IDS,JSON.stringify(e))},getExpandIds:function(){return c(l(this.PREF_KEYS.EXPAND_IDS))||[]},setCollapsedIds:function(e){d(this.PREF_KEYS.COLLAPSED_IDS,JSON.stringify(e))},getCollapsedIds:function(){return c(l(this.PREF_KEYS.COLLAPSED_IDS))||[]},setHideTasks:function(e){d(this.PREF_KEYS.HIDE_TASKS,JSON.stringify(!0===e))},getHideTasks:function(){var e=c(l(this.PREF_KEYS.HIDE_TASKS));return void 0===e&&(e=!1),e},getHighlightCriticalPath:function(){return c(l(this.PREF_KEYS.HIGHLIGHT_CRITCIAL_PATH))||!1},setHighlightCriticalPath:function(e){d(this.PREF_KEYS.HIGHLIGHT_CRITCIAL_PATH,JSON.stringify(e))},getExecutionAssisstant:function(){return c(l(this.PREF_KEYS.EXEC_ASSIST))||!1},setExecutionAssisstant:function(e){d(this.PREF_KEYS.EXEC_ASSIST,JSON.stringify(e))},getCriticalPathFilters:function(){return c(l(this.PREF_KEYS.FILTER_CRITCIAL_PATH))||!1},setCriticalPathFilters:function(e){d(this.PREF_KEYS.FILTER_CRITCIAL_PATH,JSON.stringify(e))},setWorkHours:function(e){d(this.PREF_KEYS.WORK_HOURS,e)},getWorkHours:function(){return c(l(this.PREF_KEYS.WORK_HOURS))||8},useFTSonScheduleTab:function(){return c(l(this.PREF_KEYS.USE_FTS_ON_SCHEDULE_TAB))},setUseFTSonScheduleTab:function(e){d(this.PREF_KEYS.USE_FTS_ON_SCHEDULE_TAB,JSON.stringify(e))},getShowSummaryTimeline:function(){return c(l(this.PREF_KEYS.SHOW_SUMMARY_TIMELINE))},setShowSummaryTimeline:function(e){d(this.PREF_KEYS.SHOW_SUMMARY_TIMELINE,JSON.stringify(e))},setShowBaselines:function(e){var t=this.getShowBaselines();d(this.PREF_KEYS.SHOW_BASELINES,JSON.stringify(e)),t!==this.getShowBaselines()&&this.dispatchEvent("onChange:"+p.SHOW_BASELINES)},getShowBaselines:function(){return c(l(this.PREF_KEYS.SHOW_BASELINES))},setShowProgresslines:function(e){var t=this.getShowProgresslines();d(this.PREF_KEYS.SHOW_PROGRESSLINES,JSON.stringify(e)),t!==this.getShowProgresslines()&&this.dispatchEvent("onChange:"+p.SHOW_PROGRESSLINES)},getShowProgresslines:function(){return c(l(this.PREF_KEYS.SHOW_PROGRESSLINES))},setActiveBaselineModel:function(e){let t=e?e.id:void 0;var n=this.getActiveBaselineModel();d(this.PREF_KEYS.ACTIVE_BASELINE,JSON.stringify(t)),e!==n&&this.dispatchEvent("onChange:"+p.ACTIVE_BASELINE)},getActiveBaselineModel:function(){let e=c(l(this.PREF_KEYS.ACTIVE_BASELINE));if(e)return n.getObjectForAdding(a,e,{})},getBaselineDataForModelToRender:function(e){const t=u.getActiveBaselineModel(),n=t&&t.getDataForModel(e);return u.getShowBaselines()?n:void 0},getBaselineFormattedDate:function(e,t){let n=this.getBaselineDataForModelToRender(t);if(n)return s.getIntlDateFormat(n[e])},setScheduleTaggerFilters:function(e){this[this.PREF_KEYS.SCHEDULE_TAGGER_FILTER]=e},getScheduleTaggerFilters:function(){return this[this.PREF_KEYS.SCHEDULE_TAGGER_FILTER]},showScheduleElement:function(e){var t=this.getScheduleTaggerFilters();return!(t&&!t[e])},getHideAssignees:function(){return c(l(this.PREF_KEYS.HIDE_ASSIGNEES))},setHideAssignees:function(e){d(this.PREF_KEYS.HIDE_ASSIGNEES,JSON.stringify(!0===e))},isCalendarEnabled:function(){return window.widget&&window.widget.getValue("enableCalendar")},validateCurrentProject:function(){const e=r.getManagementView().currentModel||r.getManagementView().collection.first();this._currentProjectId!==e.id&&this.setCurrentProject(e.id)},set:function(e,t){this.validateCurrentProject(),d(this.PREF_KEYS[e],t)},get:function(e){return this.validateCurrentProject(),l(this.PREF_KEYS[e])}}));return u.KEYS=p,u.FILTERED_ITERATIONS="filteredIterations",u.ROADMAP_PREFS="roadmapPrefs",u.ITERATION_VIEW="iterationView",u.ITERATION_VIEW_EXPANDED="iterationViewExpanded",u}),define("DS/E6WCommonApps/Models/AddTaskMixin",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Preferences","DS/RDFFoundation/RDFUtils"],function(e,t,n,s){"use strict";var i={addTask:function(n,s){var i=e.clone(n||{},!1),o=this.getDefaultTaskAttributes(),a="RDFTaskModel"===this._uwaClassName?"dsxplan:hasSubtask":"dsxplan:hasTask";o[t.SEQUENCE_ORDER_ATTR]=this._getDefaultSequenceOrderForAttribute(a);var r=i[t.DURATION_MIN];e.is(r,"number")&&(i[t.DURATION_MIN]=this.getDurationString(r));var l=i[t.DURATION_MAX];e.is(l,"number")&&(i[t.DURATION_MAX]=this.getDurationString(l)),e.extend(o,i);var d=e.clone(s||{},!1);d._defaultModel=void 0;var c=d.isToBacklog?"dsplan:hasBacklogTask":this.TASK_RELATION_ATTR,p=this._addScheduleElement(c,o,d);return p.newThisSession=!0,p},getDefaultTaskAttributes:function(){var e=new Date,n={};return n["@type"]=t.TASK_RDF_TYPE,n["dsxplan:jsType"]="dsplan:Task",n[t.TITLE_ATTR]="Task",n[t.DURATION_MIN]=this.getDurationString(1),n[t.DURATION_MAX]=this.getDurationString(1),n[t.STARTDATE_ATTR]=e,n[t.ENDDATE_ATTR]=new Date(e.getTime()+864e5),n[t.COMPLETE_PERCENT_ATTR]=0,n[t.PRIORITY_ATTR]={"@id":"dsxplan:Medium"},n},getDurationString:function(e){var t=n.getWorkHours();return s.millisecondsToXsdDayTimeDuration(parseFloat(e)*t*60*60*1e3)},_addScheduleElement:function(n,s,i){var o=e.clone(s||{},!1),a=enoviaServer.useFD01CodeFor3DPlan?"Open":{"@id":"dsxplan:Open"};o[t.DESCRIPTION_ATTR]=o[t.DESCRIPTION_ATTR]||"",o[t.STATE_ATTR]=o[t.STATE_ATTR]||a,o[t.CONTENT_REPOSITORY]=o[t.CONTENT_REPOSITORY]||this.get(t.CONTENT_REPOSITORY),o["dsxplan:usesCalendar"]=this.get("dsxplan:usesCalendar"),this.isDSLC()&&(n=this.dslcMapping[n]);var r=this.addModelToAttributeWithCollection(n,o,i);return this._registerAsElementParent(r,n),r},_getDefaultSequenceOrderForAttribute:function(e){var t=Math.random(),n=i.RapidRDFModelRegistry?i.RapidRDFModelRegistry.getRapidModelByURI(this.id):void 0,s=n||this;if(s.getRDFModel()&&s.getRDFModel().hasFetchedAttribute(e))return this.computeAndReturnCorrectSequenceNumber(t,s.getRDFModel(),e)},computeAndReturnCorrectSequenceNumber:function(e,n,s){var i=n.get(s).last();return i&&(void 0===(e=i.get(t.SEQUENCE_ORDER_ATTR_DSLC))&&(e=0,i.rdfModel&&(e=i.rdfModel.get(t.SEQUENCE_ORDER_ATTR_DSLC))),e+=Math.random()),e},getDefaultSequenceOrderForReference:function(){var e=0;if(this.get("dsplan:referenceConfig")){var n=JSON.parse(this.get("dsplan:referenceConfig")),s=Object.values(n);e=s.length?Math.max(s):0}var i=this.get(t.CHILDREN_ATTR),o=0;i.size()&&(o=i.last().get(t.SEQUENCE_ORDER_ATTR_DSLC));var a=Math.max(parseFloat(e),parseFloat(o));return void 0===a&&(a=0),a+=Math.random()}};return i}),define("DS/E6WCommonApps/Views/E6WObjectCardView",["UWA/Core","DS/E6WCommonUI/Views/ObjectCardView","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonApps/Utils/3DSpaceUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/E6WCommonUIConstants","DS/Foundation2/Models/FoundationV2Model","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/MemberUtils","DS/E6WCommonApps/Models/TeamMemberResponsibilityModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/TransientWidget/TransientWidget","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T){"use strict";var g=function(e){return!e||!e.hasViewAccess||e.hasViewAccess()},E=function(e){var t=m.get(e);return t===e&&(t=T.get(e)),t},A=[u.WORKSCOPE_PARENT_ATTR,u.PARENT_ATTR,u.COMMON_TASK_PARENT_ATTR],C=t.extend({_uwaClassName:"E6WObjectCardView",getPropertiesButton:function(t){var n=this._parent.apply(this,arguments);return e.extend(n,C.getPropertiesButtonInfo(t.model)),n},getRemoveItemButton:function(t){var n=e.clone(t||{},!1).model;if(n){var i=!1,o=n.getObjectType&&n.getObjectType();if(g(n)&&("Project"!==o&&"Enterprise Project"!==o||-1===A.indexOf(this._config.name)?"Task"===o&&"commonTaskParent"===this._config.name&&(i=!0):i=!0,i))return s.getDetachMenuConfig.call(this,Boolean(this._config.readWrite),t)}var a=this._parent.apply(this,arguments);let r=this._config.disableRemove||n&&!n.canBeRemoved(this._config.name);r=this._config.name===u.TEAM_MEMBERS&&n.get("isOwner")?"true":r;let l=null===a.className&&"scope"===t.options.config.name;var d;return a.className=null===a.className&&(l||(d=this.model.model)&&(d.canModify?d.canModify(!0):d.get("canEdit")))&&!r?"":"disabled",a=this.addClassNamesToButton(a)},createMenuButtons:function(t){const n=e.clone(t||{},!1);n.zIndex=1050;var s=n.model;if(s)if("Group"!==s.get("type")&&s instanceof l||s instanceof d&&"3DSpace"===s.serviceHosting){var o=this._parent.bind(this,n);i.fetchParentTypesWithCallback(s,o)}else this._parent(n);else this._parent(n)},createAndShowContextMenu:function(e){e.preventDefault(),this._createDropDownMenu(e)},addOpenAndOpenWith:function(e){var t=n.polymorphicOpenMenuItem(e,"openAppInCompass",function(e){this.selectModelInCompass(e.model)},this);t&&this.dropdownMenu.addItem(t),this._config.noOpenWith||"person"===this._config.type||this.addOpenWith(e.model)},getUpdateButton:function(e){var t=this._parent.apply(this,arguments),n=e.model&&e.model.get("files"),s=this.normalizedGet(this.model,"canEdit"),i=(!n||n&&"object"==typeof n&&1===n.length)&&s;return t.className=null===t.className&&i?"":"disabled",t=this.addClassNamesToButton(t)},getDownloadButton:function(e){var t=this._parent.apply(this,arguments);return t.className=null===t.className&&g(e.model)?"":"disabled",t=this.addClassNamesToButton(t)},getViewProfileButtonConfig:function(t){var s,i=e.clone(t||{},!1);s=i.model instanceof p?i.model.get("memberPersonModel"):i.model;var o=c.getUserNameForSwymUserProfile(s),a=window.enoviaServer.swym;return a=a+"/v3/home?profile="+o,{text:E("E6WCommonUI.Label.ViewProfile"),id:"profile",fonticon:"eye",handler:function(){h.isWidgetOpen(window.widget.data.appId)?window.open(a,"_blank"):n.launchProperties(s.id,t)}}},addClassNamesToButton:function(e){return e.className+=e.className&&e.className.contains("disabled")&&"propertiesButton"!==e.name?" hidden":"",e},getDropDownMenuItems:function(t,i){var o=e.clone(i||{},!1),r=o.model,l=!!r&&n.isSolidWorksFile(r);o.documentUpdateHandler=s.createDocumentUpdateModal;var d=r&&this.normalizedGet(r,"dsxplan:jsType");o.isUrl="dsplan:url"===d||"URL"===this.normalizedGet(r,"type");var c=this._parent(t&&!l,o);if(r&&g(r)){var p,h=r.getObjectType&&("Project"===r.getObjectType()||"Enterprise Project"===r.getObjectType()),m=r.getObjectType&&"swym:Community"===r.getObjectType(),T="3dportfolio"===r.serviceHosting,A=c.findIndex(function(e){return"detach-button"===e.name}),C=s.getManagementView(),f=widget.getValue("appId");h&&(f===u.APP_3DPLAN||a.isXppViewer())?((p=C?s.getOpenMenuConfig(r,C):s.getPreviewMenuConfig(r,h)).text=E("E6WCommonApps.Label.SetAsRoot"),p.fonticon="tree-view-root"):(m||T)&&(p=s.getPreviewMenuConfig(r,h)),p&&(-1===A?c.push(p):c.splice(A,0,p))}return c},_showDropDownMenu:function(e){this._parent(e,!0)},_addDropDownMenuListener:function(e){for(var t=this,n=this.getElements(".fonticon-down-open"),s=n.length,i=0;i<s;i++){n[i].getClosest("button").addEvent("click",function(e){t._createDropDownMenu(e)})}},_createDropDownMenu:function(t){var n=this,a=e.Event.getElement(t),r=a.getClosest(".object-card").getAttribute("data-id"),c=function(){n.createMenu(t,{target:a}),o.showAndUpdateContextualDropdownMenuPosition(n.dropdownMenu,t,!0),n.listenToOnce(n._parentView,"onScroll",()=>{n.dropdownMenu&&n.dropdownMenu.hide()})};if(r){var p=n.getActiveModel(r);if("Group"!==p.get("type")&&p instanceof l||p instanceof d&&"3DSpace"===p.serviceHosting){i.fetchParentTypesWithCallback(p,function(){var i=p.get("parentTypes");i&&i.includes("DOCUMENTS")?(s.getDocumentServiceDropDownMenuItems(p,function(e){n.options.docMenuItems=e,c()}),n.dropdownMenu&&n.dropdownMenu.destroy(),n.createDropdownMenu({target:e.Event.getElement(t),items:[{text:E("E6WCommonUI.Info.LoadingData")}]}),o.showAndUpdateContextualDropdownMenuPosition(n.dropdownMenu,t,!0)):c()})}else c()}else c()},_submodelCallback:function(){this._parent.apply(this,arguments);var e={config:this._config},t=this.model;this.model.dispatchEvent("onChange",[t,e])},destroy:function(){o.destroyOpenWith(this),this._parent.apply(this,arguments)},validateDroppedObject:function(e){e.serviceId,e.objectType,this._config.name;let t=this._config.validateDroppedObject;if(t){let n=t(e,this._config);if(n)return n}return this._parent.apply(this,arguments)}});return C.getPropertiesButtonInfo=function(e){return n.showPreview(e)?{text:E("E6WCommonApps.Label.Preview"),name:u.PREVIEW,fonticon:"eye"}:{text:E("E6WCommonUI.Label.Properties"),fonticon:"attributes"}},C}),define("DS/E6WCommonApps/Models/TaskTreeNodeModel",["DS/E6WCommonApps/Models/E6WTreeNodeModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TreeNodeUtil","DS/E6WCommonApps/Utils/RapidUtils"],function(e,t,n,s){"use strict";const i=function(){e.apply(this,arguments)};return(i.prototype=Object.create(e.prototype,{constructor:{value:i}})).getTreeNodeValueForRdfAttribute=function(i){switch(i){case t.TASK_PARENT_ATTR:case t.COMMON_TASK_PARENT_ATTR:case t.PARENT_ATTR:return this.rdfModel.getParentAsLabel();case t.COMPLETE_PERCENT_ATTR:return this.rdfModel.getPercentComplete();case t.DSLC_DURATION_ESTIMATED:return n.getDisplayLabelForDuration(this.rdfModel);case t.ATTACHMENT_ATTR:return this.rdfModel.getAttachments().getModels();case t.ACTUAL_DELIVERABLE_ATTR:return this.rdfModel.getDeliverables().getModels();case t.PARENT_HAS_SWYM_COMMUNITY:return n.getDisplayLabelForCommunity(this.rdfModel.get(t.PARENT_HAS_SWYM_COMMUNITY));case"isWedo":return this.rdfModel.isWedo();case"icon":return this.rdfModel.getIconURL();case"dsxplan:hasPriority":return n.getDisplayLabelForPriority(this.rdfModel.getPriorityValueNLSString());case"hasChildren":return s.hasSubtasks(this.rdfModel)}return e.prototype.getTreeNodeValueForRdfAttribute.apply(this,arguments)},i.prototype.addRdfModelListeners=function(){e.prototype.addRdfModelListeners.apply(this,arguments),this.listener.listenTo(this.rdfModel.getSubtasks(),"onAdd",e=>this.addRdfChild(e)),this.listener.listenTo(this.rdfModel.getSubtasks(),"onRemove",e=>this.removeRdfChild(e)),this.listener.listenTo(this.rdfModel.getSubtasks(),"onChange:dsplan:sequenceOrder",()=>this.sortChildren()),this.listener.listenTo(this.rdfModel,`onChange:${t.DSLC_DURATION_MIN}`,()=>this.onRdfModelAttributeChange(t.DSLC_DURATION_ESTIMATED)),this.listener.listenTo(this.rdfModel,`onChange:${t.DSLC_DURATION_MAX}`,()=>this.onRdfModelAttributeChange(t.DSLC_DURATION_ESTIMATED))},i.prototype.addExistingRdfChildren=function(){this.rdfModel.getSubtasks().forEach(e=>this.addRdfChild(e))},i}),define("DS/E6WCommonApps/Models/BacklogTaskTreeNodeModel",["DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/TaskTreeNodeModel","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n){"use strict";t=t||require("DS/E6WCommonApps/Models/TaskTreeNodeModel");const s=function(){t.apply(this,arguments),this._updateWorkContextListener()};return(s.prototype=Object.create(t.prototype,{constructor:{value:s}})).getTreeNodeValueForRdfAttribute=function(s){const i=this.rdfModel.get(e.WORK_CONTEXT_ATTR);if(s===e.DSLC_TITLE_ATTR){let e=this.rdfModel.get("title");return i&&(i.hasViewAccess()&&i.get("title")?(e=i.get("title"),i.get("dsxplan:hasContributingElements")&&i.get("dsxplan:hasContributingElements").length>1&&(e+=` (${this.rdfModel.get("title")})`)):i.hasViewAccess()||(e=`${o="E6WCommonApps.Label.NoAccess",n.get(o)} (${this.rdfModel.get("title")})`)),e}if("icon"===s&&i){if(!i.hasViewAccess())return require.toUrl("DS/RDFFoundation/assets/img/NoAccess.png");if(i.get("image"))return i.get("image")}var o;return t.prototype.getTreeNodeValueForRdfAttribute.apply(this,arguments)},s.prototype.addRdfModelListeners=function(){t.prototype.addRdfModelListeners.apply(this,arguments),this.listener.listenTo(this.rdfModel,`onChange:${e.WORK_CONTEXT_ATTR}`,()=>{this._updateWorkContextListener(),this.onRdfModelAttributeChange(e.DSLC_TITLE_ATTR),this.onRdfModelAttributeChange("icon")})},s.prototype._updateWorkContextListener=function(){const t=this.rdfModel.previous(e.WORK_CONTEXT_ATTR);t&&(this.listener.stopListening(t),this.listener.stopListening(t.getCollectionAttribute("dsxplan:hasContributingElements")),this.onRdfModelAttributeChange("icon")),this.rdfModel.get(e.WORK_CONTEXT_ATTR)&&(this.listener.listenTo(this.rdfModel.get(e.WORK_CONTEXT_ATTR).getCollectionAttribute("dsxplan:hasContributingElements"),{onAdd:()=>this.onRdfModelAttributeChange(e.DSLC_TITLE_ATTR),onRemove:()=>this.onRdfModelAttributeChange(e.DSLC_TITLE_ATTR)}),this.listener.listenTo(this.rdfModel.get(e.WORK_CONTEXT_ATTR),{"onChange:image":()=>this.onRdfModelAttributeChange("icon"),onModelAccessChanged:()=>this.onRdfModelAttributeChange(e.DSLC_TITLE_ATTR)}))},s.prototype.addChild=Function.prototype,s}),define("DS/E6WCommonApps/Models/ChecklistParentModelMixin",["DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/RDFFoundation/RDFUtils"],function(e,t){"use strict";return{syncPatch:function(t,n){let s=this.getChangedAttributesSinceLastSave().includes(e.HAS_CHECKLIST_ATTR),i=this.get(e.HAS_CHECKLIST_ATTR).toArray().some(e=>e.getChangedAttributesSinceLastSave().length>0);if(s||i){let e=this.syncPatchChecklist.apply(this,arguments);return this._changedAttributesSinceLastSave={},e}return this._parent.apply(this,arguments)},getCreateOperations:function(e){const t=this;let n={};if(e._added.length>0){n.op="create";let s=[];e._added.forEach(function(e){let n=t.getRelatedModelCompactJson(e);delete n["dsxplan:jsType"],delete n["dsplan:checklistParent"],n["@id"]&&delete n["@id"],n["@href"]&&delete n["@href"],n["@mask"]&&delete n["@mask"],s.push(n)}),n.data=s}return n},getRemoveOperations:function(e){let t={};if(e._removed.length>0){t.op="delete";let n=[];e._removed.forEach(function(e){n.push(e.id)}),t.data=n}return t},getModifyOperations:function(e){let t=e.toArray().filter(function(e){return e.getChangedAttributesSinceLastSave().length>0}),n={};if(t.length>0){n.op="modify";let e=[];t.forEach(function(t){let n=[],s=t.getChangedAttributesSinceLastSave(),i={};s.forEach(e=>{let n=t.dataForRendering({attributes:[e]});i[e]=n[e].actualValue?n[e].actualValue:n[e]}),t._changedAttributesSinceLastSave={},n.push(i),n.push(t.id),e.push(n)}),n.data=e}return n},syncPatchChecklist:function(n,s){var i=[],o=this._changedAttributesSinceLastSave;this._changedAttributesSinceLastSave={};var a,r={},l=e.HAS_CHECKLIST_ATTR,d=n[l];let c=this.getCreateOperations(d),p=this.getModifyOperations(d),u=this.getRemoveOperations(d);if(d.resetFlags(),c.data&&i.push(c),p.data&&i.push(p),u.data&&i.push(u),i.length||(s&&s.onComplete&&s.onComplete({}),a={cancel:function(){}}),!a){s.attrs=s.noStringify||this.isDSLC()?i:JSON.stringify(i);var h=UWA.clone(s||{},!1),m=s.onFailure;s.onFailure=function(e){m&&m(e),this.dispatchEvent("onError",[this,e,h]),this.rollbackChanges(o,r,n)}.bind(this)}if(!a&&this.isDSLC()){var T=s.mask||this.getMask();s.url=t.expandUrl("/invoke/dsxplan:updateChecklist"+(T?"?$mask="+T:"")),s.data=JSON.stringify([s.attrs,this.id]),s.method="POST"}return a}}}),define("DS/E6WCommonApps/Models/ScheduleElementModel",["UWA/Core","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/AccessModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/ConstraintModel","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/MemberUtils","DS/E6WCommonUI/PlatformManager","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/Collections/CollectionTaggerHelper","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/InvokeSolver","DS/E6WCommonApps/Models/AssigneeMixin","DS/E6WCommonApps/Models/SolverModelMixin","DS/E6WCommonApps/Models/ChildModelMixin","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Models/ChecklistParentModelMixin","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,g,E,A){"use strict";var C=function(e){var t=E.get(e);return t===e&&(t=A.get(e)),t},f={"dsxplan:Open":"To Do","dsxplan:InProgress":"In Work","dsxplan:Done":"Completed"},_={parentMask:"dsplan:MVMask.ScheduleElements.Basic",_uwaClassName:"ScheduleElementModel",_propertyDictionary:{subscribed:{volatility:!0},solveCounter:{volatility:!0},toConstraints:{volatility:!0},fromConstraints:{volatility:!0}},onChangeState:Function.prototype,addPredecessorConstraint:function(t,n){var s=e.clone(n||{},!1);this.addModelToAttributeWithCollection("fromConstraints",t,n),this._changing||(this._changed={}),!s.silent&&this._fireRelationshipChangeEvents("fromConstraints")},addSuccessorConstraint:function(t,n){var s=e.clone(n||{});this.addModelToAttributeWithCollection("toConstraints",t,n),this._changing||(this._changed={}),!s.silent&&this._fireRelationshipChangeEvents("toConstraints")},removePredecessorConstraint:function(e){this.get("fromConstraints").remove(e),this._fireRelationshipChangeEvents("fromConstraints")},removeSuccessorConstraint:function(e){this.get("toConstraints").remove(e),this._fireRelationshipChangeEvents("toConstraints")},getParent:function(){return o.getObjectById(this.parentId)},getProjectParent:Function.prototype,getStateForDisplayValue:function(e){return f[e["@id"]||e.id||e]},isCompleted:function(){return this.get(s.DSLC_STATE_ATTR).id===s.STATE_DONE},getValidTypes:function(e){var t=[],n=this.getParent();if(n){var s=n.get(e);if(s){var i=s.get("dsxplan:vocabularyTerms")||s.get("dsplan:vocabularyTerms");if(i){for(var o=0;o<i.length;o++){var a=i.at(o),r="E6WCommonApps.Type."+a.id.substring(a.id.indexOf(":")+1);t.push({actualValue:a.id,displayValue:C(r)})}return t}}}return t},setup:function(){return this.setCollection("toConstraints",new t),this.setCollection("fromConstraints",new t),this.listenTo(this,"onChange:"+s.STATE_ATTR,function(e,t){this.onChangeState.apply(this,arguments);var n=t&&(t["@id"]||t.id);d.dispatcher.dispatchEvent("refreshTagger",[e,"ds6w:what/ds6w:status",C("emxCollaborativeTasks.Label."+f[n])])}),this._parent.apply(this,arguments)},addAssigneesById:function(e){var t=o.getObjectForAdding(l,e,{mask:a.getPersonMask(),attrs:{"dsaccess:accountName":a.addIamToURI(r.getContextUser())}});return this.addObjects([t],"dsxplan:hasAssignee")},assignToSelf:function(){var e=this;r.getContextUserUid()&&(this.addAssigneesById(a.addUUIDToURI(r.getContextUserUid())),this.save(null,{patch:!0,onComplete:function(){e.dispatchEvent("onChange:"+e.ASSIGNEESATTR);var t=C("emxCollaborativeTasks.Label.SuccessfullyAssignedToSelf");c.displaySuccess(t)},onFailure:function(){var e=C("emxCollaborativeTasks.Error.FailAssignToSelf");c.displayError(e)}}))},canDelete:function(){return!(!this.getParent()||!this.getParent()._accessDelete||r.isXppViewer())||this._parent.apply(this,arguments)},canShare:function(){return!(!this.getParent()||!this.getParent()._accessShare||r.isXppViewer())||this._parent.apply(this,arguments)},sync:function(t,n,s){if("update"===t||"patch"===t){var i=e.clone(s||{},!1);if(i.hasOwnProperty("solve")||(i.solve=this.shouldWeSolve(i)),i.solve){var o=this;i.onComplete=function(){var t=s&&e.is(s.onComplete,"function")&&s.onComplete.apply(this,arguments);return o.solve(),t};var a=Array.prototype.slice.call(arguments,0);return a[2]=i,this._parent.apply(this,a)}}return this._parent.apply(this,arguments)},isAttributeImpactingSolve:function(e,t){var n=e;return this.isDSLC()&&this.inverseDslcMapping&&(n=this.inverseDslcMapping[n]||n),t&&t.dontSolveSubTask?this.attributeImpactingSubTaskSolve&&this.attributeImpactingSubTaskSolve[n]:this.attributeImpactingSolve&&this.attributeImpactingSolve[n]},shouldWeSolve:function(t){if(this.isWedo&&this.isWedo()&&!this.get(s.PARENT_ATTR))return!1;if(this.isLeanTask&&this.isLeanTask()&&!this.get(s.PARENT_ATTR))return!1;var n=this.getChangedAttributesSinceLastSave();let i=this.getParent();if(i&&c.isTask(i.getObjectType())){var o=e.clone(t||{},!1);if(o.dontSolveSubTask=!0,n.some(e=>this.isAttributeImpactingSolve(e,o)))return!1}if(t&&t.fromNotification)return!1;if(n.some(this.isAttributeImpactingSolve.bind(this))||t.assumeChanges){for(var a=this.getParent();a&&a.hasViewAccess();a=a.getParent()){if(a.autosolve===s.AUTOSOLVE_OFF)return _.dispatcher.dispatchEvent("solveNeeded",[this]),!1;if(a.autosolve===s.AUTOSOLVE_ON)return!0}return!0}return!1},solve:function(t){var n=this;this.solveCounter++;var s=e.clone(t||{},!1),i=s.onComplete;s.onComplete=function(e){n.solveCounter--;for(var t=e&&e.member||[],a=0;a<t.length;a++)o.getExistingAndMerge(t[a],{animate:!0,keepPanelOpen:s.keepPanelOpen});return i&&i.apply(this,arguments)};var a=s.onFailure;s.onFailure=function(){return n.solveCounter--,a&&a.apply(this,arguments)},s.onCancel=function(){n.solveCounter--};var r=this.getParent(),l=r&&r.id;p.solve(s,this.id,l)},getDurationAttributeAsDays:Function.prototype,getFromConstraints:function(){return this.get("fromConstraints")},getToConstraints:function(){return this.get("toConstraints")},removeObject:function(e,t,n){t instanceof i?t.destroy(n):this._parent.apply(this,arguments)},getIconURL:function(){return""},checkForCircularOrDuplicateDependency:function(e,t){var n,s=this.getFromConstraints().find(function(t){return t.getSuccessor().id===e.id}),o=this.getToConstraints().find(function(t){return t.getPredecessor()&&t.getPredecessor().id===e.id});return{hasCircularDependency:!!(n=s||o),isDuplicateDependency:n&&n.get(i.TYPE_ATTR)===t&&n.getPredecessor()&&n.getPredecessor().id===e.id&&n.getSuccessor()&&n.getSuccessor().id===this.id}},isVersion:function(){return!0},get:function(e){var t,n=this._parent.apply(this,arguments),i=!1;return e===s.COMMON_TASK_PARENT_ATTR&&!n&&this.hasFetchedAttribute(e)&&(i=!0,t=this.isStandaloneTask&&this.isStandaloneTask()),!i||t||c.isWedoTask(this.get(s.JS_TYPE_ATTR))||(n=new T),n},_parseNestedModelsAndCollections:function(e){var t,n,s=e["dsplan:hasScheduleError"];return s&&(n=(t=s).member,t["dsxplan:jsType"]||n||(t["dsxplan:jsType"]="dsxplan:ScheduleError"),n&&n.forEach(function(e){e["dsxplan:jsType"]||(e["dsxplan:jsType"]="dsxplan:ScheduleError")})),this._parent.apply(this,arguments)},destroy:function(e){this._parent(e),this.getFromConstraints().forEach(function(e){e.get("dsxplan:to").removeSuccessorConstraint(e)}),this.getToConstraints().forEach(function(e){e.get("dsxplan:from").removePredecessorConstraint(e)})},syncDelete:function(e){var t=this.getParent();this._parent.apply(this,arguments);var n=e.onComplete;e.onComplete=function(){n&&n.apply(this,arguments),t&&t.solve()}}};return _._propertyDictionary["dsplan:actualType"]={volatility:!0},(_=n.extend(_,h,g,u,m)).dispatcher=new e.Class.Events,Object.defineProperty(_.prototype,"solveCounter",h.solveCounterDef),Object.defineProperty(_.prototype,"prevSolveCounter",h.prevSolveCounterDef),_.SOLVER_URI="dsmf:xplan.Scheduler.JSONScheduleObjects?$mask=dsplan:MVMask.ScheduleElements.Complex",i.ScheduleElementModel=_,_}),define("DS/E6WCommonApps/E6WNonWorkingDayIterator",["UWA/Core","UWA/Class","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Constants","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Preferences","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/DateUtils","text!DS/E6WCommonApps/assets/CalendarData.json"],function(e,t,n,s,i,o,a,r,l){"use strict";return t.extend({init:function(e){this._workingHours={},this._avgWorkingHours=0,this._recurringNonWorkingDays=[],this._staticHolidayEvents={},this._variableHolidayEvents={},this._variableHolidayDates=[],this._weeklyHolidays={},this._dailyHolidays=[],this._hasCalendar=!1,this._rootProjectId=e&&e.rootProject&&e.rootProject.id,this._dateline&&this._dateline.listenToOnParseCalendarData(),e.loadCalendar&&this.getCalendarData()},_isCalendarHoliday:function(e,t){if(e){let n=new Date(t).getMonth();if(!this._hasCalendar)return"Yearly"!==e.relelements.Frequency||s.MONTH_LONG_NAMES.indexOf(e.relelements["Month Of Year"])===n;if("Yearly"===e.frequency&&s.MONTH_LONG_NAMES.indexOf(e.monthOfYear)!==n)return!1;if(t>=e.startDate&&t<=e.endDate)return!0}return!1},_isHoliday:function(e){const t=r._toISOStringIgnoringUTC(e);var n=!1;if(this._dailyHolidays.forEach(e=>{e.startDate&&e.endDate&&t.substring(0,10)>=e.startDate.substring(0,10)&&t.substring(0,10)<=e.endDate.substring(0,10)&&(n=!0)}),n)return!0;if(0!==Object.keys(this._weeklyHolidays).length){const n=this._weeklyHolidays[s.DAY_SHORT_NAMES[e.getDay()]];if(n&&0!==n.length){var i=!1;return n.forEach(e=>{t>=e.startDate&&t<=e.endDate&&(i=!0)}),i}}var o=String(e.getDate()),a=String(e.getMonth());if(0!==Object.keys(this._staticHolidayEvents).length){var l=this._staticHolidayEvents[`${o}-${a}`]?this._staticHolidayEvents[`${o}-${a}`]:this._staticHolidayEvents[`${o}-00`];if(this._isCalendarHoliday(l,t))return!0}if(0!==Object.keys(this._variableHolidayEvents).length){var d=`${["First","Second","Third","Fourth","Last"][Math.ceil(o/7)-1]}`,c=`${d}-${s.DAY_LONG_NAMES[e.getDay()]}`;if("Fourth"===d&&!this._variableHolidayEvents[c]){let t=new Date(e);t.setDate(t.getDate()+7),t.getMonth()!==e.getMonth()&&(c=c.replace("Fourth","Last"))}const n=this._variableHolidayEvents[c];if(this._isCalendarHoliday(n,t))return!0}return!1},_isNWD:function(e){return-1!==this._recurringNonWorkingDays.indexOf(e.getDay())},countWorkingDays:function(e,t){var n=new Date(e.getTime());let s=0;for(;n.getTime()<=t.getTime();){var i=new Date(n);i.setDate(n.getDate()+1),this._isHoliday(n)||this._isNWD(n)||s++,n=i}return s},getTimeFromWorkingHours:function(e){var t=e.split(/[-,]+/),n=Object.create(null);n.hours=parseInt(t[0].slice(0,2)),n.minutes=parseInt(t[0].slice(2,4)),n.totalMinutes=60*n.hours+n.minutes;var s=Object.create(null);return s.hours=parseInt(t[t.length-1].slice(0,2)),s.minutes=parseInt(t[t.length-1].slice(2,4)),s.totalMinutes=60*s.hours+s.minutes,{start:n,end:s}},getCalendarData:function(){var e=this;const t=a.expandUrl("invoke/dsplan:getScheduleCalendar");a.request(t,{method:"POST",headers:{"Content-Type":"application/json"},type:"json",data:JSON.stringify({ProjectList:this._rootProjectId?[this._rootProjectId]:[]}),onComplete:function(t){e._parseCalendarData(t["@value"])},onFailure:function(){e._parseCalendarData(null)}})},_addHoliday:function(e){if("Daily"===e.frequency)return void this._dailyHolidays.push(e);if("Weekly"===e.frequency&&e.daysOfWeek)return void e.daysOfWeek.split(",").forEach(t=>{this._weeklyHolidays[t]?this._weeklyHolidays[t].push(e):""!==t&&(this._weeklyHolidays[t]=[e])});const t=e.dayOfMonth||e.relelements["Day Of Month"];if("0"!==t)if("Monthly"===e.frequency)this._staticHolidayEvents[`${t}-00`]=e;else{const i=e.monthOfYear||e.relelements["Month Of Year"];var n=s.MONTH_LONG_NAMES.indexOf(i);this._staticHolidayEvents[`${t}-${n}`]=e}else{const t=e.weekOfMonth||e.relelements["Week Of Month"],n=e.dayOfWeek||e.relelements["Day Of Week"];this._variableHolidayEvents[`${t}-${n}`]=e}},_parseCalendarData:function(e){var t,n=this;if(e){n._hasCalendar=!0;let s=(t=e[Object.keys(e)[0]].data.member[0]).workweek.member;for(const e in s)"Non Working"===s[e].workdayType?n._recurringNonWorkingDays.push(Number(e)):(n._workingHours[Number(e)]=n.getTimeFromWorkingHours(s[e].workingHours),n._avgWorkingHours+=n._workingHours[Number(e)].end.totalMinutes-n._workingHours[Number(e)].start.totalMinutes);n._avgWorkingHours=Math.round(n._avgWorkingHours/60/Object.keys(this._workingHours).length),o.setWorkHours(n._avgWorkingHours);let i=t.exceptions.member;for(const e in i){const t=i[e];"Non Working"===t.exceptionType&&n._addHoliday(t)}}else{(t=JSON.parse(l).data[0].relateddata.events).forEach(function(e){var t=e.relelements["Event Type"],s=e.relelements["Calendar Exception Type"];"Work Week"===t&&"Non Working"===s?n._recurringNonWorkingDays.push(e.relelements.Title-1):"Exception"===t&&"Non Working"===s&&n._addHoliday(e)}),o.setWorkHours(i.WORKING_HOURS_IN_A_DAY)}this._dateline&&this._dateline.dispatchEvent("onParse")}})}),define("DS/E6WCommonApps/Models/ChecklistItemModel",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/AccessModel","DS/E6WCommonApps/Models/ChildModelMixin"],function(e,t,n,s){"use strict";var i={_uwaClassName:"ChecklistItemModel",_propertyDictionary:{"dsplan:checklistParent":{volatility:!0}},get:function(e){var t=this._parent.apply(this,arguments);switch(e){case"title":return this.get("dsxplan:label");default:return t}},getTransferObject:function(n){var s=e.clone(n||{},!1);return s.sequenceOrder=this.get(t.SEQUENCE_ORDER_ATTR_DSLC),s.description=this.get(t.DSLC_DESCRIPTION_ATTR),this._parent(s)},getParent:function(){return this.get(t.CHECKLIST_PARENT_ATTR)},_addToModelOrCollectionProperty:function(){var t=e.clone(arguments[1]||{},!1);t.silent=!0,this._parent.apply(this,[arguments[0],t])},_removeFromModelOrCollectionProperty:function(){var t=e.clone(arguments[1]||{},!1);t.silent=!0,this._parent.apply(this,[arguments[0],t])},getSequenceOrder:function(){let e=Math.random();var n=this.getParent&&this.getParent();if(n&&n.hasFetchedAttribute(t.HAS_CHECKLIST_ATTR))return this.computeAndReturnCorrectSequenceOrder(e,n,t.HAS_CHECKLIST_ATTR)},computeAndReturnCorrectSequenceOrder:function(e,n,s){var i=n.get(s).last();return i&&(void 0===(e=i.get(t.SEQUENCE_ORDER_ATTR_DSLC))&&(e=0,i.rdfModel&&(e=i.rdfModel.get(t.SEQUENCE_ORDER_ATTR_DSLC))),e+=Math.random()),e},compactJson:function(){var e=this._parent.apply(this,arguments),n=this.getSequenceOrder();return e[t.SEQUENCE_ORDER_ATTR_DSLC]=n,e}};return i=n.extend(i,s)}),define("DS/E6WCommonApps/Collections/ProjectTeamCollection",["UWA/Core","DS/RDFFoundation/Collections/ResultCollection","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/Models/LogicalUserModel","DS/E6WCommonApps/Models/TeamMemberResponsibilityModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/SubscribeUtil","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d){"use strict";var c=function(e){return d.get(e)},p={resetOperation:c("E6WCommonApps.Member.ProgressBar.ModifyOperation"),addOperation:c("E6WCommonApps.Member.ProgressBar.AddOperation"),removeOperation:c("E6WCommonApps.Member.ProgressBar.RemoveOperation")},u=function(e){e.data[e.action]=e.data[e.action]||[];var t=function(e){var t=e.data[e.action].detect(function(t){return t.responsibility===e.role});return t||(t=t||{responsibility:e.role,persons:[],groups:[]},e.data[e.action].push(t)),t}(e);"pno:Person"===e.type||e.type===r.LOGICAL_USER_TYPE?-1===t.persons.indexOf(e.id)&&t.persons.push(e.id):-1===t.groups.indexOf(e.id)&&t.groups.push(e.id)};return t.extend({_uwaClassName:"ProjectTeamCollection",model:a,setup:function(t,n){var s=e.clone(n||{},!1);s["@mask"]="dsplan:MVMask.Person.Complex",this._workscope=s.workscope,this._uri=s.uri,this._workscope&&!s.noListeners&&this._addCollectionListeners(),this._parent(t,s)},_addCollectionListeners:function(){var e=this._workscope.getCollectionAttribute(r.ASSIGNEE_ATTR);this.listenTo(e,"onAdd",this._onAssigneeAddedToParentWorkscopeCollection),this.listenTo(this,"onRemove",function(e){this._removeMemberFromParentWorkscope.apply(this,arguments),e.destroy({noServer:!0})}),this.listenTo(this,"onAdd",function(){this._workscope.dispatchEvent("onChange:"+r.TEAM_MEMBERS)})},_onAssigneeAddedToParentWorkscopeCollection:function(e){if(!(e instanceof o)&&!this.get(a.getInstanceId(e.id,this._workscope.id))){var t={id:e.id,type:e.getObjectType(),allResponsibilitiesArray:r.RESPONSIBILITY_LEADER};this.addMember(t)}},isUserAssignedToMultipleLogicalUsers:function(e){let t=0;return this.forEach(function(n){n.get("memberPersonModel").getObjectType()===r.LOGICAL_USER_TYPE&&n.get("assignedUserModel")===e&&(t+=1)}),t>1},_removeMemberFromParentWorkscope:function(e,t,n){n&&!n.dontRemoveParentWorkscope&&this._workscope.removeObject(r.ASSIGNEE_ATTR,e.get("memberPersonModel"),n)},fetch:function(t){var n=e.clone(t||{},!1);if(!n.dontFetch){var s=[this._workscope.id];return n.searchStr&&s.push(n.searchStr),n.data=JSON.stringify(s),this._parent(n)}},getUri:function(){return this._uri||"/invoke/dsxplan:getResourceSharing"},parse:function(e){return a.processRawData(e,this._workscope)},getResponsibilityModelForMember:function(e){return this.find(function(t){if(t.get("memberPersonModel")===e)return t})},onSaveComplete:function(e){var t=this,n=[],s=[];e.forEach(function(e){var t=e.memberModel;t&&(e.requestType===r.REQUEST_TYPE_ADD?n[t.id]="":e.requestType===r.REQUEST_TYPE_REPLACE&&(s[t.id]=""))}),e.forEach(function(e){var i=e.memberModel;if(i){var o,a=e.requestType;a===r.REQUEST_TYPE_ADD?o=c("E6WCommonApps.Label.AddMember"):a===r.REQUEST_TYPE_REMOVE?(o=c("E6WCommonApps.Label.RemoveMember"),e.options&&e.options.isLoggedInUser&&t._destroyModelAndSetNewRoute(t._workscope)):a===r.REQUEST_TYPE_REPLACE&&(o=c("E6WCommonApps.Label.ReplaceMember")),i.get("title")?t._showAlertAndRemoveProgress(n,s,e,o):i.addEventOnce("onSync",function(){t._showAlertAndRemoveProgress(n,s,e,o)})}})},onSaveFailure:function(e,t,i){var o=this;e.forEach(function(e){o.rollbackMemberChanges(e),o._workscope.dispatchEvent("onChange:"+r.TEAM_MEMBERS);var t,a=i&&i.msg;a?(t=n.splitUri(a)[1].trim(),i.error||(t=n.splitUri(JSON.parse(a).msg)[1].trim()),"E6WCommonApps.Error.ownerRefused"===t&&(t=d.replace(c(t),{MEMBER_NAME:e.memberModel.get("title")})),s.displayError(c(t))):s.displayError(c("E6WCommonApps.Error.SaveFailed"));e.memberModel.dispatchEvent("removeProgress")})},onSaveTimeout:function(e){e.forEach(function(e){e.memberModel.dispatchEvent("removeProgress")})},save:function(t,s){s=s||{};var i=function(t){var n={};return t.forEach(function(t){n[t.requestType]=n[t.requestType]||[];var s=t.memberModel.get("type"),i=t.memberModel.get("personRDFId"),o={data:n,id:i,action:t.requestType,type:s};switch(t.requestType){case r.REQUEST_TYPE_REMOVE:t.memberModel.get("allResponsibilitiesArray").forEach(function(t){u(e.extend(o,{role:t}))});break;default:u(e.extend(o,{role:t.memberModel.get("responsibility")}))}}),Object.keys(n).forEach(function(e){n[e].forEach(function(e){e.persons&&(e.persons=JSON.stringify(e.persons)),e.groups&&(e.groups=JSON.stringify(e.groups))})}),n}(t),a=Object.keys(i),d={};let c=function(){for(var e of a){var t=p[e],n=l.subscribeActivity(t);d[e]=n,l.startActivity(t,n)}};var h;1===t.length?t[0].memberModel.get("memberPersonModel")instanceof o||c():t.length>1&&c();h=0===Object.keys(d).length?JSON.stringify([i,this._workscope.id]):JSON.stringify([i,this._workscope.id,{identifier:d}]);var m=this;let T;T=s.onComplete?function(){m.onSaveComplete(t),s.onComplete()}:this.onSaveComplete.bind(this,t),n.request(n.expandUrl("/invoke/dsxplan:shareResources","v0"),{method:"POST",type:"json",data:h,headers:{"Content-Type":"application/json"},onComplete:T,onFailure:this.onSaveFailure.bind(this,t),onTimeout:this.onSaveTimeout.bind(this,t)})},addMember:function(t,n){var s=e.clone(n||{},!1);s.dontRegisterChange=!0,e.extend(t,{parentWorkscopeModel:this._workscope});var i=a.getMemberObj(t),o=this.add(i,s),l=r.REQUEST_TYPE_ADD;return!s.rollBackFlag&&o.dispatchEvent("addProgress"),{memberModel:o,requestType:l}},resetMember:function(t,n,s){var i=e.clone(s||{},!1);e.is(n,"string")&&(n=[n]);var o=r.REQUEST_TYPE_REPLACE,a=t.get("allResponsibilitiesArray");return t.set("allResponsibilitiesArray",n),!i.rollBackFlag&&t.dispatchEvent("addProgress"),{memberModel:t,requestType:o,oldResponsibilitiesArray:a}},removeMember:function(t,n){var s=e.clone(n||{},!1);s.dontRegisterChange=!0;var i=r.REQUEST_TYPE_REMOVE,o=t.get("allResponsibilitiesArray");return this.remove(t,s),{memberModel:t,requestType:i,oldResponsibilitiesArray:o,options:s}},rollbackMemberChanges:function(e){var t=e.memberModel.get("personRDFId"),n=e.requestType;if(n===r.REQUEST_TYPE_ADD)this.removeMember(e.memberModel);else if(n===r.REQUEST_TYPE_REMOVE){var s={id:t,type:e.memberModel.get("type"),allResponsibilitiesArray:e.oldResponsibilitiesArray};this.addMember(s,{rollBackFlag:!0})}else this.resetMember(e.memberModel,e.oldResponsibilitiesArray,{rollBackFlag:!0})},_destroyModelAndSetNewRoute:function(e,t){var n=t&&s.getNewRouteIndexFromManagmentView(e,t);e.destroy({noServer:!0}),t&&t.setRoute(n)},_showAlertAndRemoveProgress:function(e,t,n,i){var o=n.memberModel,a=d.replace(i,{MEMBER_NAME:o.get("title"),ROLE:o.getResponsibilityNLS()}),l=Object.keys(e).length,p=Object.keys(t).length;n.requestType===r.REQUEST_TYPE_REMOVE?s.displaySuccess(a):Object.keys(e).length+Object.keys(t).length===1?s.displaySuccess(a):(n.requestType===r.REQUEST_TYPE_ADD?e[n.memberModel.id]=a:t[n.memberModel.id]=a,(a=function(){var n,s="",i="";for(var o in e){if(!(n=e[o]))return"";s&&(s+=",<br>"),s+=n}for(var o in t){if(!(n=t[o]))return"";i&&(i+=",<br>"),i+=n}return n="",s&&(l>1||p>=1)&&(s="<p>"+c("E6WCommonApps.Label.AddMembers")+s+"</p>"),n=s,i&&(l>=1||p>1)&&(i="<p>"+c("E6WCommonApps.Label.ReplaceMembers")+i+"</p>"),i&&(n+=i),n}())&&s.displaySuccess(a)),o.dispatchEvent("removeProgress")},comparator:function(e){let t=e.get("memberPersonModel");return t&&t.getObjectType()===r.LOGICAL_USER_TYPE?t.get("title"):t.get("name")}})}),define("DS/E6WCommonApps/Collections/TasksSplitCollection",["UWA/Core","UWA/Class/Collection","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],function(e,t,n){"use strict";var s=function(e){return e&&e.actualValue||e},i=n.DUE_DATE_CATEGORY;return t.extend({_uwaClassName:"XTaskSplitCollection",model:{},fetch:function(){},complete:function(){this._parentCollection.complete.apply(this._parentCollection,arguments)},setup:function(e,t){var n=Array.prototype.slice.call(arguments,0);this._filterAttr=t.filterAttr,this._valueForFiltering=t.valueForFiltering,this._parentCollection=t.parentCollection;var s="onChange:"+this._filterAttr,o={onAdd:this._onParentAdd,onRemove:this._onParentRemove,onReset:this._onParentReset};o[s]=this._onAttrChange,this._filterAttr!==i&&"priority"!==this._filterAttr||(o["onChange:state"]=this._onAttrChange),this.listenTo(this._parentCollection,o),this._parent.apply(this,n)},_onParentAdd:function(t,n,i){if(n===this._parentCollection){var o=s(t.get(this._filterAttr)),a=s(this._valueForFiltering),r=e.clone(i||{},!1);r.at=0,r.parse=!1,i&&i.parse&&(r.fromServer=!0),o===a&&this._canIncludeModel(t)&&this.add(t,r)}else this.stopListening(n,"onAdd")},_onParentRemove:function(e,t){t===this._parentCollection?this.remove(e):this.stopListening(t,"onRemove")},_onParentReset:function(e){if(e===this._parentCollection){var t=e.tasksWithAttrValue(this._valueForFiltering,this._filterAttr);this.reset(t)}else this.stopListening(e,"onReset")},_onAttrChange:function(e,t,n){s(e.get(this._filterAttr))===s(this._valueForFiltering)&&this._canIncludeModel(e)?(this.add(e,{at:0}),n.at=0):this.remove(e,n)},_canIncludeModel:function(e){var t;return this._filterAttr===n.DUE_DATE_CATEGORY&&(t=s(e.get("state"))),"priority"===this._filterAttr&&(t=s(e.get("stateForDisplay"))),!("Complete"===t||"Done"===t)},dataForRendering:function(){var t={};if("state"===this._filterAttr)if("string"===e.typeOf(this._valueForFiltering)){var n={actualValue:this._valueForFiltering,displayValue:this._valueForFiltering};t.state=n}else t.state=this._valueForFiltering;if(this._filterAttr===i){var s=this._valueForFiltering;s.displayValue||(s.displayValue=s.actualValue),t.dueDate=s}return t.collabSpace=this.collabSpace,t.extid=this.extid,t.filteredByAttr=this._filterAttr,t.filteredByValue=this._valueForFiltering,t.filteredCount=this.size(),t},getSaveAttributes:function(){var e={},t=s(this._valueForFiltering);return e[this._filterAttr]=t,e}})}),define("DS/E6WCommonApps/Models/TaskValidator",["UWA/Core","UWA/Class","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/ScheduleConstants"],function(e,t,n,s){"use strict";return t.extend({_uwaClassName:"TaskValidator",_attributesGet:function(e,t){var n;return e&&(n=e[t]),n||this.get(t)},_validateDuration:function(e,t){var s=!0,i=this._attributesGet(e,n.DURATION),o=this._attributesGet(e,n.DURATION_RANGE);return(i<0||o<0||(void 0===i||void 0===o)||i-o<0||isNaN(i)||isNaN(o)||i>=1e6)&&(t.fields.push(n.DURATION),t.fields.push(n.DURATION_RANGE),t.fields.push(n.DURATION_MIN),t.fields.push(n.DURATION_MAX),s=!1),s},_validateActualDates:function(e,t){var s=!0,i=this._attributesGet(e,n.STATE_ATTR);i=i&&i["@id"]?i["@id"]:i;var o=this._attributesGet(e,n.ACTUAL_START_DATE);o=o&&o.actualValue?o.actualValue:o;var a=new Date;return o>a&&i!==n.STATE_OPEN&&(t.fields.push(n.ACTUAL_START_DATE),s=!1),(o=(o=this._attributesGet(e,n.ACTUAL_END_DATE))&&o.actualValue?o.actualValue:o)>a&&i===n.STATE_DONE&&(t.fields.push(n.ACTUAL_END_DATE),s=!1),s},_validateEstimatedDates:function(e,t){var s=this.getStartDate(e);s=s&&s.actualValue||s;var i=this.getEndDate(e);i=i&&i.actualValue||i;var o=this._validateStartDate(s,e,t),a=this._validateEndDate(i,e,t);return s>i&&!this.isStartOrEndDateAutomatic(e)?(t.fields.push(this.isStarted(e)?n.ACTUAL_START_DATE:n.STARTDATE_ATTR),t.fields.push(this.isComplete(e)?n.ACTUAL_END_DATE:n.ENDDATE_ATTR),!1):o&&a},_validateStartDate:function(e,t,s){return!(this.isStartDateFixed(t)&&(!e||isNaN(e.getTime())))||(s.fields.push(this.isStarted(t)?n.ACTUAL_START_DATE:n.STARTDATE_ATTR),!1)},_validateEndDate:function(e,t,s){return!(this.isEndDateFixed(t)&&(!e||isNaN(e.getTime())))||(s.fields.push(this.isComplete(t)?n.ACTUAL_END_DATE:n.ENDDATE_ATTR),!1)},validate:function(e){var t={fields:[]},s=!0;s=this._validateDuration(e,t);var i=this._validateActualDates(e,t);s=s&&i,i=this._validateEstimatedDates(e,t),s=s&&i;var o=this._attributesGet(e,n.TITLE_ATTR);null==o&&(o=this._attributesGet(e,n.DSLC_TITLE_ATTR)),o&&o.trim().length||(t.fields.push(n.TITLE_ATTR),s=!1);var a=this._validateCredentials(e,t);if(!(s=s&&a))return t},_validateCredentials:function(e,t){var n=this._attributesGet(e,s.TASK_COLLAB_SPACE),i=this._attributesGet(e,s.TASK_ORGANIZATION);if(!n&&!i)return!0;var o=!0;return n&&n instanceof Array&&n[0]&&!n[0].actualValue&&(t.fields.push(s.TASK_COLLAB_SPACE),o=!1),i&&i instanceof Array&&i[0]&&!i[0].actualValue&&(t.fields.push(s.TASK_ORGANIZATION),o=!1),o},getStartDate:function(t){var s;return s=(s=this.isStarted(t)&&this._attributesGet(t,n.ACTUAL_START_DATE)||this._attributesGet(t,n.STARTDATE_ATTR))&&e.is(s,"string")?new Date(s):s},getEndDate:function(t){var s;return s=(s=this.isComplete(t)&&this._attributesGet(t,n.ACTUAL_END_DATE)||this._attributesGet(t,n.ENDDATE_ATTR))&&e.is(s,"string")?new Date(s):s},isComplete:function(e){return this._attributesGet(e,n.STATE_ATTR)===n.STATE_DONE},isStarted:function(e){return this.isComplete(e)||this._attributesGet(e,n.STATE_ATTR)===n.STATE_IN_PROGRESS},isFixed:function(e){return this._attributesGet(e,n.USER_DEFINED_DATES_ATTR)||this.isStartDateFixed(e)||this.isEndDateFixed(e)},isStartDateFixed:function(e){return this._attributesGet(e,n.USER_DEFINED_START_DATE_ATTR)},isEndDateFixed:function(e){return this._attributesGet(e,n.USER_DEFINED_END_DATE_ATTR)},isStartDateAutomatic:function(e){return!this.isStartDateFixed(e)&&!this.isStarted(e)},isEndDateAutomatic:function(e){return!this.isEndDateFixed(e)&&!this.isComplete(e)},isStartOrEndDateAutomatic:function(e){return this.isStartDateAutomatic(e)||this.isEndDateAutomatic(e)}})}),define("DS/E6WCommonApps/Views/PriorityView",["UWA/Core","DS/Handlebars/Handlebars4","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/DocumentManagement/DocumentManagement","text!DS/E6WCommonApps/assets/templates/popover.html.handlebars","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d){"use strict";var c=function(e){return d.get(e)};return o.extend({_uwaClassName:"PriorityView",id:function(){return"PriorityView_"+this.cid},setup:function(){this._parent.apply(this,arguments),this.titleElement=this.createPriorityButtonGroupTitle(),this.priorityButtonGroup=this.createPriorityButtonGroup()},render:function(){this.container.empty();let e=this._config.readWrite;e||(e=!1);let t=!this.normalizedGet(this.model,"canEdit")||!e;return this.priorityButtonGroup.setDisabled(t),this.titleElement.inject(this.container),this.priorityButtonGroup.inject(this.container),this},createPriorityButtonGroup:function(){var e=this.model.get(this._config.name);e&&e.id&&(e=e&&e.id),this._config.priorityMapping&&(e=this._config.priorityMapping[e]);var t=new s({type:"radio",buttons:[new n({name:l.PRIORITY_LOW,className:"success large",icon:"low",attributes:{title:c("E6WCommonApps.Label.Low")},active:e===l.PRIORITY_LOW}),new n({name:l.PRIORITY_MEDIUM,className:"info large",icon:"medium",attributes:{title:c("E6WCommonApps.Label.Medium")},active:e===l.PRIORITY_MEDIUM}),new n({name:l.PRIORITY_HIGH,className:"warning large",icon:"high",attributes:{title:c("E6WCommonApps.Label.High")},active:e===l.PRIORITY_HIGH}),new n({name:l.PRIORITY_URGENT,className:"error large",icon:"alert",attributes:{title:c("E6WCommonApps.Label.Urgent")},active:e===l.PRIORITY_URGENT})],events:{onClick:this.onClickButton.bind(this)}});return t.setClassName("item-priority"),t},createPriorityButtonGroupTitle:function(){return e.createElement("label",{text:c("E6WCommonApps.Label.Priority")})},destroy:function(){this.priorityButtonGroup.destroy(),this._parent.apply(this,arguments)},onClickButton:function(e,t){this.model.set(this._config.name,t.options.name)}})}),define("DS/E6WCommonApps/Collections/MemberResponsibilityCollection",["UWA/Core","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/TeamMemberResponsibilityModel"],function(e,t,n){"use strict";return t.extend({_uwaClassName:"MemberResponsibilityCollection",model:n,mask:"dsplan:MVMask.Person.Complex",setup:function(t,n){var s=e.clone(n||{},!1);this._workscope=s.workscope,this._parent(t,s)},parse:function(e){return n.processRawData(e,this._workscope)}})}),define("DS/E6WCommonApps/Views/HistoryGridViewConfig",["DS/E6WCommonApps/TreeNodeUtil","DS/E6WCommonUI/UIHelper","DS/Controls/TooltipModel","DS/Handlebars/Handlebars4","DS/E6WCommonApps/ScheduleConstants","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","text!DS/E6WCommonApps/assets/templates/historyDetailsField.html.handlebars"],function(e,t,n,s,i,o,a,r){"use strict";var l=function(e){var t=o.get(e);return t===e&&(t=a.get(e)),t},d=s.compile(r),c={auditDetails:"auditDetails"},p={};p[i.CREATED]="plus fonticon fonticon-plus",p[i.ADDED]="plus fonticon fonticon-plus",p[i.REMOVED]="remove fonticon fonticon-remove",p[i.DELETED]="trash fonticon fonticon-trash",p[i.MODIFIED]="pencil fonticon fonticon-pencil",p[i.TRANSITIONED]="scene-transition fonticon fonticon-scene-transition";return{columns:[{text:l("E6WCommonApps.Label.AuditHistoryDate"),dataIndex:"tree",typeRepresentation:"textBlock",editableFlag:!1,width:150,visibleFlag:!0,className:"grid-title-cell",getCellSemantics:function(){return{icon:"bpa fonticon fonticon-bpa "}},getCellValue:function(e){if(e.nodeModel){var n=e.nodeModel.getAttributeValue("date");if(e.nodeModel.isRoot())return n;var s=new Date(n);return t.TIME_FORMAT.format(s)}},compareFunction:function(e,t){return new Date(e)-new Date(t)}},{text:l("E6WCommonApps.Label.AuditHistoryDetails"),dataIndex:e.COLUMN_DATA_INDICES.auditDetails,typeRepresentation:"textBlock",className:"grid-cell-audit-description",autoRowHeightFlag:!0,customContentId:c.auditDetails,getCellValueForExport:function(t){if(t.nodeModel){var n=t.nodeModel.getAttributeValue(e.COLUMN_DATA_INDICES.auditModifiedBy),s=t.nodeModel.getAttributeValue(e.COLUMN_DATA_INDICES.auditAction),i=t.nodeModel.getAttributeValue(e.COLUMN_DATA_INDICES.auditDetails),o="";return n&&(o+=`'${n.fullName}' `),s&&(o+=`${s} `),i&&(o+=`${i}`),o}},onCellRequest:function(t){t.nodeModel&&t.cellView&&(function(t,n){var s=t.getAttributeValue(e.COLUMN_DATA_INDICES.auditDetails),i=t.getAttributeValue(e.COLUMN_DATA_INDICES.auditModifiedBy),o=t.getAttributeValue(e.COLUMN_DATA_INDICES.auditAction),a=this.reuseCellContent(c.auditDetails);a.empty();var r={};i&&(r.fullName=i.fullName,r.image=window.enoviaServer.swym+"/api/user/getpicture/login/"+i.accountName),o&&(r.actionIcon=p[o],r.actionIconTooltip=o),s&&(r.description=s),a.setHTML(d(r)),n._setReusableContent(a)}.call(this,t.nodeModel,t.cellView),function(t,s){var i=t.getAttributeValue(e.COLUMN_DATA_INDICES.auditModifiedBy),o=t.getAttributeValue(e.COLUMN_DATA_INDICES.auditAction),a="";i&&(a+=`'${i.fullName}' `),o&&(a+=o),s.tooltipInfos=new n({title:a,shortHelp:t.getAttributeValue(e.COLUMN_DATA_INDICES.auditDetails)})}.call(this,t.nodeModel,t.cellView))}}],reusableComponentIDs:c,lengthOfEachCharacter:10}}),define("DS/E6WCommonApps/Models/Document/DocumentObject",["UWA/Core","UWA/Class","DS/E6WCommonApps/Models/Document/DriveDocument","DS/E6WCommonApps/Models/Document/CollabspaceDocument"],function(e,t,n,s){"use strict";var i=[".gif",".jpg",".png",".gif",".jpeg",".3dxml",".cgr",".pdf",".bpm",".psd",".ai"];return t.extend({init:function(t,i,o){var a=e.clone(t||{},!1);this.type=o,this.model="drive"===o?new n(a,i):new s(a,i)},_isImageFile:function(){var e,t=this.model.get("fileName").lastIndexOf(".");if(-1!==t){var n=this.model.get("fileName").substring(t);e=-1!==i.indexOf(n.toLowerCase())}return e},_createImageBlob:function(){try{return window.URL.createObjectURL(this.model.get("file"))}catch(e){return null}},get:function(e){return"image"===e?this._getImage():this.model.get(e)},_getImage:function(){return this._isImageFile(this.model.file)?this._createImageBlob():this.model.get("icon")?this.model.get("icon"):this.model.get("image")}})}),define("DS/E6WCommonApps/Models/FileManagementMixin",["UWA/Core","DS/DocumentManagement/DocumentManagement","DS/DocumentManagement/DriveDocumentManagement","DS/DocumentCreateNew/CreateNew","DS/RDFFoundation/SecurityContextUtils","DS/Foundation/FoundationAjax","DS/E6WCommonUI/UIHelper","DS/RDFFoundation/Models/CollabspaceRepositoryModel","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/Models/DriveRepositoryProxyModel","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ObjectProxyUtil","DS/E6WCommonUI/PlatformManager","DS/Windows/ImmersiveFrame","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Models/Document/DocumentObject","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,g,E,A){"use strict";var C=function(e){return E.get(e)},f={_normalizedRepo:function(e){var t=this.getRepositoryModelConstructor(e),n=c.getObjectForAdding(t,e);return n.hasViewAccess()?n:new T},uploadFiles:function(e,t,n){if(this.getDriveRepositoryId(n))for(let s=0;s<e.length;s++)this.uploadFileToDrive(e[s],t,n);else this.uploadFile(e,t,n)},getRepositoryModelConstructor:function(e){return e.startsWith(d.ID_PREFIX)?d:r},uploadFile:function(t,n,i){var o=this;this._validateBeforeUpload(),this._fileUploadCount=this._fileUploadCount?this._fileUploadCount+1:1;var a,r=e.clone(i||{},!1);r.fieldName=n;try{a=this._getCreateDocumentOptions(r)}catch(e){return void o.onFileUploadFailureMessage(r,e.message)}a.onDocumentUpload=function(e){let n=new g(e,t);o.onFileUploadComplete(n,r)},a.onError=function(n){n&&e.merge(r,{errorMsg:n.error||n.message}),o._onFileUploadFailure(t,r)};var l=new h;l.reactToPointerEventsFlag=!1,l.inject(widget.body),a.immersiveFrame=l;var d=this.get("dsplan:hasBookmark");d&&(a.parentId=d.get("physicalId"),a.parentRelName="Vaulted Objects");try{new s(a).create(t)}catch(e){console.log(e)}},_getCreateDocumentOptions:function(t){var n=e.clone(t||{},!1);if(n.csrf=this.csrf,n.tenant=u.getTenant(),e.is(this.isRDFTask,"function")&&!this.isRDFTask()){n.parentId=this.id,n.parentRelName="deliverables"===n.fieldName?"Task Deliverable":"Reference Document";let e=i.fetchSecurityContextByRepo(this.get("project"));n.securityContext=e?e.actualValue:null}else{let e=this.get(m.CONTENT_REPOSITORY)&&i.fetchSecurityContextByRepo(this.get(m.CONTENT_REPOSITORY).id);n.securityContext=e?e.actualValue:null}n.securityContext||(n.securityContext=i.getDefaultSecurityContext()),n.onCancel=Function.prototype;var s=this._validateFileUploadRepositoryAccess(n);if(s)throw n.onFailure&&n.onFailure(s),new Error(s);var o=this.getDriveRepositoryId(n);return n.tenantUrl=o?u.getServiceUrl("3DDrive"):u.getServiceUrl("3DSpace"),n.driveFolderId=o,n},uploadFileToDrive:function(n,s,i){var o,a=this,r=e.clone(i||{},!1);r.fieldName=s;try{o=this._getCreateDocumentOptions(i)}catch(e){return}var l={fileInfo:{file:n},relInfo:o.relInfo,collabspace:!o.driveFolderId&&(o.collabspaceId||this.get(m.CONTENT_REPOSITORY).id),driveFolderId:o.driveFolderId};o.onComplete=function(e){let t=new g(e,n,"drive");a.onFileUploadComplete(t,r)},o.onFailure=function(t){var s=t&&t.error;s&&e.merge(r,{errorMsg:s}),a._onFileUploadFailure(n,r)},t.createDocument(l,o)},_validateBeforeUpload:function(){if(!this.id)throw new Error("Invalid object, cannot upload file on a model not saved yet")},_validateFileUploadRepositoryAccess:function(e){var t,n=this.get(m.CONTENT_REPOSITORY),s=e.driveFolderProxyId||e.collabspaceId;!s&&n&&(s=n.id),s?s&&s.startsWith(d.ID_PREFIX)?(n=c.getObjectById(s))&&!n.hasViewAccess()&&(t=C("E6WCommonApps.Error.NoContentRepositoryAccess")):i.hasAccessToContentRepository(s)||0===i.getUsersContentRepositories().length&&(t=C("E6WCommonApps.Error.NoContentRepositoryAndNoneAvailable")):0===i.getUsersContentRepositories().length&&(t=C("E6WCommonApps.Error.NoContentRepositoryAndNoneAvailable"));var o=this.get("dsplan:hasBookmark");return o&&!o.hasViewAccess()&&(t=A.get("E6WCommonUI.Error.noAccessOnBookmark")),t},getDriveRepositoryId:function(e){var t,n=e?e.driveFolderProxyId:null,s=this.get(m.CONTENT_REPOSITORY);return n||(n=s&&s.id),n&&n.startsWith(d.ID_PREFIX)&&(t=(s=c.getObjectById(n))&&s.get("physicalId")),t},_onFileUploadFailure:function(t,n){this._fileUploadCount--;var s=e.clone(n||{},!1);s.file=t;var i=s.errorMsg||null;e.is(n.onFailure,"function")&&n.onFailure(s,i),this.onFileUploadFailureMessage(s,i)},isUploadingFiles:function(){return Boolean(this._fileUploadCount)},updateDocument:function(s,i,o){var r=i.get("dscom:ServiceHosting"),l=i.get("physicalId"),d=i.get("dscom:Tenant");"3DDrive"===r&&(s=n.getNewBlobFileWithOldName(s,i));var c={id:l,fileInfo:{file:s,comments:o}};t.modifyDocument(c,{tenant:d,serviceId:r,tenantUrl:window.enoviaServer[r],onComplete:function(t,n){var o=e.clone(n||{},!1);if(o.proxyModel=i,f._updateModificationDate(t,o),"3DDrive"!==r){var l=s.name.substring(0,s.name.lastIndexOf("."));l!==i.get("title")&&i.set("title",l)}a.displaySuccess(C("E6WCommonApps.Alert.UpdateSucess"))},onFailure:function(e){e.internalError?a.displayError(e.internalError):a.displayError(C("E6WCommonApps.Alert.UpdateFail"))}})},_addFile:function(t,n,s){var i=e.clone(s||{},!1);let o=this;if(n.isThumbnail)o.uploadThumbnail(n.input,t,{fileWrapper:n.value});else{var a,r,l={fieldName:t,fileName:n.input.FileName};e.merge(l,i),n.input instanceof window.File&&(l.fileName=n.input.name),a=this.onFileUploadComplete.bind(this),r=this.onFileUploadFailure.bind(this),e.is(this.uploadFiles,"function")&&this.uploadFiles([n.input],t,e.merge({fileWrapper:n.value,onComplete:a,onFailure:r,fieldName:t},i))}},_updateModificationDate:function(e,t){if(e){var n=e.modified;"3DSpace"===t.serviceId&&(n=e.data[0].relateddata.files[0].dataelements.modified);var s=p.getDate(n);t.proxyModel.set("modified",s)}},buildBatchWithPreprocessedObjects:function(e){var t=e&&e.batch,n=e&&e.attributesToBeUpdated||{},s=Object.keys(n);if(s.length){var i=e.onFailure;t=t||c.getBatchGenerator();for(var o=0;o<s.length;o++)for(var a=s[o],r=0;r<n[a].length;r++){var d=n[a][r];d instanceof l!=!1&&(delete d.collection,d.save(void 0,{ajax:t.ajax,newTransaction:!0,onFailure:i}))}}return t},saveModelAfterFileUpload:function(t,n){var s=e.clone(t||{},!1),i=s.onFailure;s.onFailure=function(e,t){t&&401===t["@code"]&&a.displayError(A.get("E6WCommonUI.Error.noAccessOnObject")),i&&i(arguments)},n?(s.changed=!0,s.ajax=n.ajax,s.newTransaction=!0,this.save(void 0,s),delete(s=e.clone(s||{},!1)).ajax,delete s.onComplete,delete s.onFailure,n.sendBatch(s)):this.save(void 0,s)},onFileUploadCompleteMessage:function(e){var t=C("emxFoundation.Label.FileUploadSuccess");t=t.replace("%FILE_NAME%",e.fileName),a.displaySuccess(t)},onFileUploadComplete:function(t,n){this._fileUploadCount--,e.merge(n,this._options||{});var s=n.fieldName,i={};if(e.is(this.isRDFTask,"function")&&!this.isRDFTask()){let e=t.get("document"),n=t.get("file");e.dataelements.hasfiles="TRUE",t._isImageFile()&&!n.FileName&&(e.dataelements.image=window.URL.createObjectURL(n)),i.fileName=t.get("title"),this.updateRelatedObjectWithNewEntry(e,s),this.onFileUploadCompleteMessage(i)}else{var o={id:t.get("id"),title:t.get("title"),serviceId:t.get("serviceId"),tenant:window.enoviaServer.tenant,image:t.get("image")},a=l.getNewProxyModel(o);if(a.forceAccess=!0,a["@type"]=t.get("type"),n&&n.config&&n.config.singleObjectOnly){var r=this.get(s);r&&r.length&&this.removeObject(s,r._models[0],n),this.set(s,a)}else this.addObjects([a],s,void 0,{silentOnChange:!0,at:0,values:[a]});i.attributesToBeUpdated=i.attributesToBeUpdated||{};var d=i.attributesToBeUpdated[s]||[];d.push(a),i.attributesToBeUpdated[s]=d;var c=this.buildBatchWithPreprocessedObjects(i);i.fileName=t.get("title");var p=this.get("dsplan:hasBookmark");p&&(i.relInfo={parentDirection:"From",parentId:p.get("physicalId"),parentRelName:"Vaulted Objects"});var u=this;i.onComplete=function(){u.onFileUploadCompleteMessage(i),u.dispatchEvent("onChange:"+s,[u,n])},this.saveModelAfterFileUpload(i,c)}},onFileUploadFailure:function(t,n){e.merge(t,this._options),this._parent.apply(this,arguments)},onFileUploadFailureMessage:function(e,t){e&&e.model?e.model.dispatchEvent("onChange:"+e.fieldName,[e.model]):this&&this.dispatchEvent&&this.dispatchEvent("onChange:"+e.fieldName,[this]);var n=t;n||(n=(n=C("emxFoundation.Error.FileUploadFailed")).replace("%FILE_NAME%",e.fileName)),a.displayError(n)}};return f}),define("DS/E6WCommonApps/Models/MilestoneModel",["UWA/Core","UWA/Utils","UWA/Class/Collection","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Collections/ChecklistItemCollection","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/FileManagementMixin","DS/E6WCommonApps/Models/ScheduleElementModel"],function(e,t,n,s,i,o,a,r,l,d){"use strict";r.HAS_CHECKLIST_ATTR;var c=r.dslcMapping,p=s.inverseMapping(c),u=d.extend({attributeImpactingSolve:{"dsplan:dateIntervalMin":!0,"dsplan:dateIntervalMax":!0,"dsplan:estimatedDate":!0,"dsplan:suggestedDate":!0,"dscom:hasMaturity":!0,"dsplan:userDefinedDates":!0,"dsplan:vocabularyType":!0},_uwaClassName:"MilestoneModel",_propertyDictionary:{explicitTagsData:{volatility:!0},_xplanSubscribed:{volatility:!0},"dsxplan:workscopeParent":{inverseProperty:"dsxplan:hasMilestone",inversePropertyIsCollection:!0},"dsxplan:workscopeParentForMilestone":{inverseProperty:"dsxplan:hasMilestone",inversePropertyIsCollection:!0},"dsplan:workscopeParentForAll":{volatility:!0},"dsplan:hasChecklistItem":{inverseProperty:r.CHECKLIST_PARENT_ATTR}},_relations:[{key:"dsplan:hasChecklistItem",relatedCollection:o}],writeMask:"dsplan:MVMask.Milestone.Property",liveUpdateCreateMask:"dsplan:MVMask.Milestone.Complex",getAttachments:function(){return this.getCollectionAttribute(r.ATTACHMENT_ATTR,{"@mask":"dsplan:MVMask.Milestone.Property"})},init:function(t,n){const s=e.clone(t||{},!1);s["dsplan:jsType"]=s["dsplan:jsType"]||s["dsxplan:jsType"]||"dsplan:Milestone",this._parent(s,n)},getEndDate:function(){return this.getStartDate()},setup:function(){this._parent.apply(this,arguments),this.getAttachments(),this.getChecklist(),this._shadowParents=new n},getChecklist:function(){return this.getCollectionAttribute(r.HAS_CHECKLIST_ATTR,{"@mask":this.getPropertyMask()})},save:function(){var e=a.setHelper.apply(this,arguments).options;return this.isGhost()?(e&&e.onFailure&&e.onFailure(this,{msg:"Error: xPlan.Error.NoModifyDPMMilestone","@code":401}),this.rollbackChanges(),!1):this._parent.apply(this,arguments)},validate_:function(e){var t,n={fields:[]},s=this,i=!0,o=function(t){var n;return e&&(n=e[t]),n||s.get(t)},a=Date(o.call(this,u.STARTDATE_ATTR)),l=Date(o.call(this,u.DATE_MIN_ATTR)),d=Date(o.call(this,u.DATE_MAX_ATTR)),c=o.call(this,r.SUGGESTED_DATE_ATTR);c||(n.fields.push(r.SUGGESTED_DATE_ATTR),i=!1),u.prototype._validateDateBoundaries(a,l,d,n)||(i=!1),u.prototype._validateSuggestedDate(c,n)||(i=!1);var p=o(r.TITLE_ATTR);return null==p&&(p=o(r.DSLC_TITLE_ATTR)),p&&p.trim().length||(n.fields.push(r.TITLE_ATTR),i=!1),i||(t=n),t},_validateSuggestedDate:function(e,t){var n=!0;return e&&e.actualValue&&(e=e.actualValue),e instanceof Date||(e=new Date(e),a.isValidDate(e)||(t.fields.push(r.SUGGESTED_DATE_ATTR),n=!1)),n},_validateDateBoundaries:function(e,t,n,s){var i=!0;return t>n&&(s.fields.push(u.DATE_MIN_ATTR),s.fields.push(u.DATE_MAX_ATTR),i=!1),(e>n||e<t)&&(s.fields.push(u.STARTDATE_ATTR),e>n&&-1===s.fields.indexOf(u.DATE_MAX_ATTR)&&s.fields.push(u.DATE_MAX_ATTR),e<t&&-1===s.fields.indexOf(u.DATE_MIN_ATTR)&&s.fields.push(u.DATE_MIN_ATTR),i=!1),i},getObjectType:function(){return"Milestone"},getValidTypes:function(){var e=this.isDSLC()?"dsxplan:hasMilestoneVocabulary":r.MILESTONE_VOCABULARY_ATTR;return this._parent(e)},get:function(e,t){var n=this._parent.apply(this,arguments);switch(e){case"dsplan:estimatedDate":case"dsplan:suggestedDate":case"dsplan:actualDate":case"dsplan:dateIntervalMin":case"dsplan:dateIntervalMax":t&&t.rawValue||void 0!==n&&(n=new Date(n));break;case"dsplan:actualType":case"dsxplan:actualType":t&&t.rawValue||(n=n?{actualValue:n.id,displayValue:n.get("title")}:null);break;case"dsxplan:vocabularyType":n||(n="dsplan:Milestone");break;case"title":n=n||this.get("dsxplan:label");break;case"canEdit":n=!this.isGhost()&&n;break;case"image":n=n||this._getImage(this._parent.apply(this,arguments))}return n},getStartDate:function(){return this.isComplete()&&this.get("dsplan:actualDate")?this.get("dsplan:actualDate"):this.get(u.STARTDATE_ATTR)},_getImage:function(e){return e||(e=this.getDefaultImage()),e&&!t.isAbsoluteUrl(e)?require.toUrl("E6WCommonApps/assets/img/I_Milestone_22.png"):e},getDefaultImage:function(){var e;if((this.get("dsxplan:jsType")||this.get("@type"))&&(e=require.toUrl("E6WCommonApps/assets/img/iconSmallMilestone.png")),e)return e},setStartDate:function(e,t){var n,s,i,o,a,r=new Date(this.getStartDate());this._setDateAttribute(u.STARTDATE_ATTR,e,t),this._setDateAttribute(u.SUGGESTEDDATE_ATTR,e,t),t&&(t.updateRestrictionWithStartDate&&(n=e-r,s=[],o=this.get(u.DATE_MIN_ATTR),a=this.get(u.DATE_MAX_ATTR),o&&(o=o.getTime(),o+=n,this.setDateIntervalMin(new Date(o),{silent:!0}),s.push("onChange:"+u.DATE_MIN_ATTR),i=!0),a&&(a=a.getTime(),a+=n,this.setDateIntervalMax(new Date(a),{silent:!0}),s.push("onChange:"+u.DATE_MAX_ATTR),i=!0),i&&this.dispatchEvent("onChange:minAndMax",[s])),t.updateRestrictionIfExceeded&&(s=[],(o=this.get(u.DATE_MIN_ATTR))&&(o-e>0&&o-r<=0)&&(this.setDateIntervalMin(e,{silent:!0}),s.push("onChange:"+u.DATE_MIN_ATTR),i=!0),(a=this.get(u.DATE_MAX_ATTR))&&(e-a>0&&r-a<=0)&&(this.setDateIntervalMax(e,{silent:!0}),s.push("onChange:"+u.DATE_MAX_ATTR),i=!0),i&&this.dispatchEvent("onChange:minAndMax",s)))},setDateInterval:i.prototype._setDateAttribute,setDateIntervalMin:function(t,n){var s=e.clone(n||{},!1),i=this.getDateIntervalMin(),o=this.getDateIntervalMax();this.setDateInterval(u.DATE_MIN_ATTR,t,s);var a=new Date(this.getStartDate());t-a>0&&i-a<=0&&(s.updateRestrictionIfExceeded=!0,this.setStartDate(t,s)),t-o>0&&(delete s.updateRestrictionIfExceeded,this.setDateIntervalMax(t,s))},setDateIntervalMax:function(t,n){var s=e.clone(n||{},!1),i=this.getDateIntervalMax(),o=this.getDateIntervalMin();this.setDateInterval(u.DATE_MAX_ATTR,t,s);var a=new Date(this.getStartDate());a-t>0&&a-i<=0&&(s.updateRestrictionIfExceeded=!0,this.setStartDate(t,s)),o-t>0&&(delete s.updateRestrictionIfExceeded,this.setDateIntervalMin(t,s))},getDateIntervalMin:function(){return this.get(u.DATE_MIN_ATTR)},getDateIntervalMax:function(){return this.get(u.DATE_MAX_ATTR)},isFixed:function(){return this.get(u.FIXED_DATE)},isComplete:function(){var e=this.get(r.STATE_ATTR);return(e&&(e.id||e["@id"]))===r.STATE_DONE},isInWork:function(){var e=this.get(r.STATE_ATTR);return(e&&(e.id||e["@id"]))===r.STATE_IN_PROGRESS},isStartOrEndMilestone:function(){return this.get(r.MILESTONE_VOCABULARY_TYPE)&&("dsxnpi:MilestoneLaunched"===this.get(r.MILESTONE_VOCABULARY_TYPE)||"dsxnpi:MilestoneClosed"===this.get(r.MILESTONE_VOCABULARY_TYPE))},canModify:function(){return!this.isGhost()&&this._parent.apply(this,arguments)},canDelete:function(){return!this.isGhost()&&this._parent.apply(this,arguments)},getIconURL:function(){return require.toUrl("DS/E6WCommonApps/assets/img/iconSmallMilestone.png")},getPropertyMask:function(){return"dsplan:MVMask.Milestone.Property"},getParentWorkScope:function(){return this.getProjectParent()},getProjectParent:function(){return this.getParent()},getParent:function(){return this._parent.apply(this,arguments)||this.get(r.WORKSCOPE_PARENT_ALL_ATTR)},fetchForProperty:function(t){let n=e.clone(t||{},!1);var s={mask:this.getPropertyMask&&this.getPropertyMask(),dontUpdateMask:!0,onlyIfNeeded:!0};n.batchBuilder&&(s.ajax=n.batchBuilder.ajax),this.fetch(s),this.fetchWorkscopeCalendar()},fetchWorkscopeCalendar:function(t){this.getParent().fetch({mask:"dsplan:MVMask.WorkPackage.CalendarOnly",onlyIfNeeded:!0,onComplete:function(){e.is(t,"function")&&t()}})},isGhost:function(){return"dsxnpi:MilestoneExternal"===this.get("dsxplan:vocabularyType")},addShadowParent:function(e){this._shadowParents.add(e)},removeShadowParent:function(e){this._shadowParents.remove(e)},getShadowParents:function(){return this._shadowParents},processLiveUpdateCreation:function(e){this._parent.apply(this,arguments),this.parentId||(this.parentId=e["@parentId"])},set:function(){var t=a.setHelper.apply(this,arguments);e.clone(t.attrs||{},!1),e.clone(t.options||{},!1);return this._parent.apply(this,arguments)},getAssignees:function(){return this.getCollectionAttribute(r.ASSIGNEE_ATTR,{detailsMask:"dsplan:MVMask.Person.Complex"})},getMaturityState:function(){var e=this.get(r.DSLC_STATE_ATTR),t=e&&(e["@id"]||e.get&&e.get("@id"));return t>8&&(t=s.longToShortURI(t)),t&&t.substring(8)},createNodeData:function(){let t=this._parent.apply(this,arguments);return e.merge(t,{icon:require.toUrl("E6WCommonApps/assets/img/I_Milestone_22.png"),sequenceOrder:0,owner:this.get(r.OWNER_ATTR),nodeType:"milestone"}),t}});return u.STARTDATE_ATTR="dsplan:estimatedDate",u.SUGGESTEDDATE_ATTR="dsplan:suggestedDate",u.DATE_MIN_ATTR="dsplan:dateIntervalMin",u.DATE_MAX_ATTR="dsplan:dateIntervalMax",u.FIXED_DATE="dsplan:userDefinedDates",u.STATE_ATTR="dscom:hasMaturity",u.ACTUAL_DATE="dsplan:actualDate",u.prototype.dslcMapping=c,u.prototype.inverseDslcMapping=p,u.implement(l),u}),define("DS/E6WCommonApps/Models/GateModel",["UWA/Core","UWA/Utils","UWA/Class/Collection","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TreeNodeUtil","DS/E6WCommonApps/Models/MilestoneModel"],function(e,t,n,s,i,o,a,r){"use strict";a.COLUMN_DATA_INDICES;var l=o.dslcMapping,d=s.inverseMapping(l),c=r.extend({attributeImpactingSolve:{"dsplan:dateIntervalMin":!0,"dsplan:dateIntervalMax":!0,"dsplan:estimatedDate":!0,"dsplan:suggestedDate":!0,"dscom:hasMaturity":!0,"dsplan:userDefinedDates":!0,"dsxplan:vocabularyType":!0},_uwaClassName:"GateModel",_propertyDictionary:{explicitTagsData:{volatility:!0},_xplanSubscribed:{volatility:!0},"dsxplan:workscopeParent":{inverseProperty:"dsxplan:hasGate",inversePropertyIsCollection:!0},"dsxplan:workscopeParentForGate":{inverseProperty:"dsxplan:hasGate",inversePropertyIsCollection:!0},"dsplan:workscopeParentForAll":{volatility:!0}},writeMask:"dsplan:MVMask.Gate.Property",liveUpdateCreateMask:"dsplan:MVMask.Milestone.Complex",getAttachments:function(){return this.getCollectionAttribute(o.ATTACHMENT_ATTR,{"@mask":"dsplan:MVMask.Gate.Property"})},getPropertyMask:function(){return"dsplan:MVMask.Gate.Property"},setup:function(){this._parent.apply(this,arguments),this.getAttachments(),this._shadowParents=new n},save:function(){var e=i.setHelper.apply(this,arguments).options;return this.isGhost()?(e&&e.onFailure&&e.onFailure(this,{msg:"Error: xPlan.Error.NoModifyDPMGate","@code":401}),this.rollbackChanges(),!1):this._parent.apply(this,arguments)},validate_:function(){return this._parent.apply(this,arguments)},getObjectType:function(){return"Gate"},getDefaultImage:function(){var e;if((this.get("dsxplan:jsType")||this.get("@type"))&&(e=require.toUrl("E6WCommonApps/assets/img/iconSmallGate.png")),e)return e},get:function(e){var t=Array.prototype.slice.call(arguments,0);t[0]=e;var n=this._parent.apply(this,t),s=this._propertyDictionary[e];if(s&&s.date){return n?new Date(n):void 0}switch(e){case"card_icon":n=require.toUrl("DS/E6WCommonApps/assets/img/I_Gate_16.png");break;case"dsxplan:vocabularyType":n="dsplan:Gate"}return n},getValidTypes:function(){var e=this.isDSLC()?"dsxplan:hasMilestoneVocabulary":o.MILESTONE_VOCABULARY_ATTR;return this._parent(e)},getIconURL:function(){return require.toUrl("DS/E6WCommonApps/assets/img/I_Gate_22.png")},createNodeData:function(){let t=this._parent.apply(this,arguments);return e.merge(t,{resolution:this.get("dsplan:resolution"),nodeType:"gate"}),t.icon=this.getDefaultImage(),t}});return c.prototype.dslcMapping=l,c.prototype.inverseDslcMapping=d,c}),define("DS/E6WCommonApps/LiveUpdateUtils",["UWA/Core","UWA/Class/Events","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/MaskUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],function(e,t,n,s,i,o){"use strict";var a=new t,r=new WeakMap,l=new WeakMap;function d(e){try{var t=n.getObjectById(e["@id"]);t&&t.get("dsxplan:jsType")!==o.DELETED_PROJECT_RDF_TYPE&&(t.dispatchEvent("onDeleteNotification"),t.destroy({onFailure:Function.prototype,noServer:!0,fromNotification:!0})),a.dispatchEvent("onDeleteNotification",e)}catch(e){console.error(e)}}function c(t){try{var s=function(){var s=n.getModelConstructor(t);if((s.shouldCreateOnLiveUpdate||i.shouldCreateOnLiveUpdate)(t)){var o=e.clone(t,!1);delete o["@parentId"],n.getObjectForAdding(s,t["@id"],{attrs:o}).processLiveUpdateCreation(t)}a.dispatchEvent("onCreateNotification",t)},r=n.getObjectById(t["@id"]);r?r.get("dsxplan:jsType")===o.DELETED_PROJECT_RDF_TYPE&&(r.destroy({onFailure:Function.prototype,noServer:!0,fromNotification:!0}),s()):s(),a.dispatchEvent("onAllCreateNotification",t)}catch(e){console.error(e)}}function p(e){try{n.getExistingAndMerge(e);var t=n.getObjectById(e["@id"]);t&&!e.hasOwnProperty("dsxplan:estimatedEndDate")&&t.unset("dsxplan:estimatedEndDate"),t&&!e.hasOwnProperty("dsxplan:estimatedStartDate")&&t.unset("dsxplan:estimatedStartDate"),t&&!e.hasOwnProperty("dsxplan:accumulatedStoryPoints")&&t.unset("dsxplan:accumulatedStoryPoints")}catch(e){console.error(e)}}return a.attributeTimestampMap=r,a.ignoreLiveUpdateMap=l,a.shouldBeUpdated=function(e,t,n){return!a.attributeTimestampMap.get(e)||!a.attributeTimestampMap.get(e)[t]||n>a.attributeTimestampMap.get(e)[t]},a.updateAttributeTimestamps=function(e,t,n){if(t){Object.keys(t).forEach(t=>{e.isDSLC()&&e.dslcMapping[t]&&(t=e.dslcMapping[t]),a.attributeTimestampMap.get(e)||a.attributeTimestampMap.set(e,{}),a.attributeTimestampMap.get(e)[t]=n})}},a.addToIgnoreLiveUpdateMap=function(e){l.set(e,!0)},a.resetObjectMap=function(){a.ignoreLiveUpdateMap={}},a.updateFunc=function(e){var t=this;let i=function(e,n){var i=e.id;(t.uniqueMap||(t.uniqueMap={}),t.uniqueMap[i])||(t.uniqueMap[i]=i,r=!0,(n?s.getMinMaskArray(e.getMasks(),{attributes:n}):s.getMinMaskArray(e.getMasks())).forEach(function(n){var s=t.masksToFetch[n]||[];s.push(e.id),t.masksToFetch[n]=s}))};var r=!1,d=n.getObjectById(e["@id"]);if(!d||!l.get(d)){if(d&&e.data){let t=Object.keys(e.data),n={"@etag":e.ceStamp},s=[];t.forEach(function(t){if("operation"===t)return;let i=o.dslcMapping[t]||t;"object"==typeof e.data[t]?s.push(i):e.timeStamp&&a.shouldBeUpdated(d,i,e.timeStamp)&&(n[i]=e.data[t])});const r=d.parse(n);d.save(r,{noServer:!0,fromNotification:!0,dontRegisterChange:!0}),a.updateAttributeTimestamps(d,n,e.timeStamp),0!==Object.keys(s).length&&i(d,s)}else d&&d.get("@etag")!==e.ceStamp&&i(d);return r}l.delete(d)},a.onNotification=function(e){this._notifQueue.push(e),this._notifTimeout||(this._notifTimeout=setTimeout(function(e){delete e._notifTimeout,a.handlenotifications(e._notifQueue)},2e3,this))},a.handlenotifications=function(e){var t=Object.create(null),s=Object.create(null),i=[],o=n.getBatchGenerator(),r=function(e,t){try{var s=n.getObjectById(t["@id"]),i=t.data;s&&s.onShareNotification(e,i),a.dispatchEvent("onShareNotification",t)}catch(e){console.error(e)}}.bind(void 0,o),l=function(e,t){try{var s=n.getObjectById(t["@id"]),i=t.data;s&&s.onShareNotification(e,i),a.dispatchEvent("onUnShareNotification",t)}catch(e){console.error(e)}}.bind(void 0,o);const u=e.reduce((e,t)=>(t.updated&&e.push(...t.updated),e),[]);for(a.dispatchEvent("onUpdateNotification",[u]);e.length;){var h=e.shift();try{h&&h.deleted&&h.deleted.forEach(d),h&&h.shared&&h.shared.forEach(r),h&&h.unshared&&h.unshared.forEach(l),h&&h.updated&&i.splice.apply(i,[1,0].concat(h.updated.filter(a.updateFunc,{masksToFetch:t,uniqueMap:s}))),h&&h.created&&h.created.forEach(c,this),h&&h.updatedRollUp&&h.updatedRollUp.forEach(p)}catch(e){console.error(e)}}if(i.length)for(var m=Object.keys(t),T=m.length,g=0;g<T;g++){var E=m[g],A=t[E];n.complete(void 0,A,{batchGenerator:o,mask:E,animate:!0})}for(;o.requests.length>50;){var C=o.requests.splice(0,50),f=n.getBatchGenerator();f.requests=C,f.sendBatch({waitOnInFlightRequests:!0})}o.sendBatch({waitOnInFlightRequests:!0})},a.NOTIFICATION_PROCESSING_DELAY=2e3,a}),define("DS/E6WCommonApps/Models/RDFTaskModel",["UWA/Core","UWA/Array","UWA/Class/Collection","DS/Foundation2/FoundationV2Data","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/Collections/ResultCollection","DS/RDFFoundation/Collections/UserCollection","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/MaskUtils","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/MemberUtils","DS/RDFFoundation/Collections/CollectionTaggerHelper","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/Models/ScheduleElementModel","DS/E6WCommonApps/Models/TaskModelMixin","DS/E6WCommonApps/Models/FileManagementMixin","DS/E6WCommonApps/XTaskScope","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/AddTaskMixin","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Models/CalendarModel","DS/E6WCommonApps/LiveUpdateUtils","DS/E6WCommonApps/TaskUtils","DS/E6WCommonApps/Preferences","DS/E6WCommonApps/Models/TaskTreeNodeModel","DS/E6WCommonApps/Collections/ChecklistItemCollection","DS/E6WCommonApps/Utils/RapidUtils","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonApps/assets/nls/CollaborativeTasksNLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,g,E,A,C,f,_,D,S,R,v,y,b,M,I){"use strict";var O=function(e){var t=M.get(e);return t===e&&(t=I.get(e)),t===e&&(t=s.getWidgetConstant.apply(this,arguments)),t},P=A.dslcMapping;delete P["dspol:modificationDate"];var k=d.inverseMapping(P),N=function(e){e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0)},F=A.STATE_FOR_DISPLAY_ATTR,W=A.REMINDER_DAYS,w=(A.HAS_CHECKLIST_ATTR,{"dsxplan:Open":"To Do","dsxplan:InProgress":"In Progress","dsxplan:Done":"Done"}),L={"dsxplan:Low":"Low","dsxplan:Medium":"Medium","dsxplan:High":"High","dsxplan:Urgent":"Urgent"},U={Low:O("E6WCommonApps.Label.Low"),Medium:O("E6WCommonApps.Label.Medium"),High:O("E6WCommonApps.Label.High"),Urgent:O("E6WCommonApps.Label.Urgent")},x={Low:"dsxplan:Low",Medium:"dsxplan:Medium",High:"dsxplan:High",Urgent:"dsxplan:Urgent"},V={"To Do":"dsxplan:Open","In Progress":"dsxplan:InProgress",Done:"dsxplan:Done"},j={"dsxplan:Open":"Assign","dsxplan:InProgress":"Active","dsxplan:Done":"Complete"},B={Create:"dsxplan:Open",Assign:"dsxplan:Open",Active:"dsxplan:InProgress",Review:"dsxplan:InProgress",Complete:"dsxplan:Done"},H={Open:"To Do","In Progress":"In Progress",Done:"Done"},G={"To Do":"Open","In Progress":"In Progress",Done:"Done"},Y={Open:"Assign","In Progress":"Active",Done:"Complete"},K={Create:"Open",Assign:"Open",Active:"In Progress",Review:"In Progress",Complete:"Done"},q={"dsplan:hasAssignee":T.ASSIGNEESATTR,"dskern:owner":T.OWNERATTR,"dsplan:actualStartDate":"actualStartDate","dspol:modificationDate":"modified","dsplan:hasAttachment":"references","dsplan:actualDeliverable":"deliverables","dsplan:percentageCompletion":"percentComplete"};q["dsplan:estimatedEndDate"]=T.DUEDATEATTR;var J=d.inverseMapping(q),X={"dsxplan:estimatedEndDate":{format:"UTC",itemType:"field",name:"dsxplan:estimatedEndDate"},"dsxplan:modificationDate":{format:"UTC",itemType:"field",name:"dsxplan:modificationDate"}},z="DS/E6WCommonApps/assets/img/I_ProjectPlanningTask_22.png",Q="DS/E6WCommonApps/assets/img/I_WeDoTask_22.png",$=m.extend({writeMask:"dsplan:MVMask.Task.Complex",liveUpdateCreateMask:"dsplan:MVMask.Task.CollaborativeTasks.Complex",TASK_RELATION_ATTR:"dsplan:hasSubtask",_propertyDictionary:{solveCounter:{volatility:!0},toConstraints:{volatility:!0},fromConstraints:{volatility:!0},dueDateCategory:{volatility:!0},dueDate:{date:!0},modified:{date:!0},actualStartDate:{date:!0},_xplanSubscribed:{volatility:!0},"dsxplan:workscopeParent":{inverseProperty:"dsxplan:hasTask",inversePropertyIsCollection:!0},"dsxplan:taskParent":{inverseProperty:"dsxplan:hasSubtask",inversePropertyIsCollection:!0},"dsxplan:backlogParent":{inverseProperty:"dsplan:hasBacklogTask",inversePropertyIsCollection:!0},"dsxplan:hasScheduleError":{volatility:!0},"dsplan:hasScheduleError":{volatility:!0},hasFiles:{volatility:!0},atRisk:{volatility:!0},readyToStart:{volatility:!0},late:{volatility:!0},compressionLevel:{volatility:!0},_tagData:{volatility:!0},explicitTagsData:{volatility:!0},"dsplan:workscopeParentForAll":{volatility:!0},"dsxplan:hasWorkContext":{inverseProperty:"dsxplan:hasContributingElements",inversePropertyIsCollection:!0},"dsplan:hasChecklistItem":{inverseProperty:A.CHECKLIST_PARENT_ATTR}},idAttribute:"@id",_uwaClassName:"RDFTaskModel",_relations:[{key:"rdf:type",relatedCollection:o},{key:"dsxplan:hasAssignee",relatedCollection:a},{key:"dsplan:hasChecklistItem",relatedCollection:y}],_collectionConstructor:o,init:function(t,n){const s=e.clone(t||{},!1);s["dsplan:jsType"]=s["dsplan:jsType"]||s["dsxplan:jsType"]||"dsplan:Task",this._parent(s,n)},getObjectType:function(){return A.TASK},getTreeNodeModel:function(){return this._treeNodeModel?this._treeNodeModel.show():this._treeNodeModel=new v({grid:{correspondingModel:this}}),this._treeNodeModel},getParent:function(){var e=this.get(A.COMMON_TASK_PARENT_ATTR);if(e&&"dsplan:DummyProject"!==e.id)return e},getParentWorkScope:function(){return this.getProjectParent(this)},getProjectParent:function(e){if(e)return u.isProject(e.get(A.PROJECT_TYPE))||"WorkscopeModel"===e._uwaClassName?e:this.getProjectParent(e.getParent())},getTagPrefix:function(){return this.hasWeDoTagData()?d.WEDO_TAGGER_URI_PREFIX:d.TAGGER_URI_PREFIX},getAttachments:function(){return this.getCollectionAttribute(A.ATTACHMENT_ATTR,{"@mask":"dsplan:MVMask.Task.Property"})},getDeliverables:function(){return this.getCollectionAttribute(A.ACTUAL_DELIVERABLE_ATTR,{"@mask":"dsplan:MVMask.Task.Property"})},setup:function(){var t=this;this.nbInFlightRequests=0,this._parent.apply(this,arguments);var n={};n["onChange:"+A.ACTUAL_START_DATE]=this._clearStartDateCachedValue,n["onChange:"+A.STARTDATE_ATTR]=this._clearStartDateCachedValue,n["onChange:"+A.STATE_ATTR]=this._clearStartDateCachedValue;var s=this.getParent();s&&this.listenTo(s,"onChange:title",function(){this.dispatchEvent("onChange",[this])}),this.listenTo(this,n),this.listenTo(this,"onReset",this._filterDatabyScope),this.listenTo(this,"onChange:"+this.ASSIGNEESATTR,function(){this._filterDatabyScope()}),this.listenTo(this,"onChange:"+A.OWNER_ATTR,function(){this._filterDatabyScope()}),this.listenTo(this,"onChange:"+A.PRIORITY_ATTR,function(t,n,s){var i=e.clone(s||{},!1),o=n&&L[n["@id"]||n.id];!i.silent&&t.dispatchEvent("onChange:priority",[t,o,i]),p.dispatcher.dispatchEvent("refreshTagger",[t,"ds6w:why/ds6w:priority",O("E6WCommonApps.Label."+o)])}),Object.keys(q).forEach(function(e){t.listenTo(t,"onChange:"+e,function(t,n,s){s&&s.silent||t.dispatchEvent("onChange:"+q[e],arguments)})}),this.listenTo(this,"onChange:"+this.DUEDATEATTR,function(e,t,n){var s=new Date(this.previousAttributes()["dsxplan:estimatedEndDate"]),i=this.dueDateCategory(s),o=this.dueDateCategory(t);n.silent||i===o||e.dispatchEvent("onChange:"+this.DUEDATECATEGORY,arguments)});var i=function(){var e=this.get(A.ACTUAL_DELIVERABLE_ATTR),t=e?e.length:0,n=this.get(A.ATTACHMENT_ATTR),s=t+(n?n.length:0)>0;s!==this.get("hasFiles")&&this.set("hasFiles",s)};this.getAttachments(),this.getDeliverables(),this.getChecklist(),this.listenTo(this,"onChange:"+A.ACTUAL_DELIVERABLE_ATTR,i),this.listenTo(this,"onChange:"+A.ATTACHMENT_ATTR,i),this.listenTo(this,"onChange:"+A.PARENT_ATTR,function(e,t){this===e?t||(this.parentId=void 0,this.parentConstructor=void 0):console.error("invalid onChange parent to be checked")}),this.getSubtasks()},getChecklist:function(){return this.getCollectionAttribute(A.HAS_CHECKLIST_ATTR,{"@mask":this.getPropertyMask()})},getDefaultImage:function(){return this.isWedo()?require.toUrl(Q):require.toUrl(z)},onChangeState:function(e,t,n){var s,i;window.enoviaServer&&enoviaServer.useFD01CodeFor3DPlan?(s=H[t],i=Y[t]):(s=t&&w[t["@id"]||t.id],i=j[t]);var o=A.STATE_ATTR;this.isDSLC()&&(o=this.dslcMapping[A.STATE_ATTR]),w[this.previousAttributes()[o]]===s||n.silent||(this.dispatchEvent("onChange:"+F,[e,s,n]),this.dispatchEvent("onChange:state",[e,i,n]))},addNewCollectionData:function(e){const t="dsxplan:hasSubtask"===e&&!this._collections[e],n=this._parent.apply(this,arguments);return t&&(Object.defineProperty(n,"loaded",{get:()=>this.hasDataForMask("dsplan:MVMask.Task.Complex.All",{checkFetching:!0})||this.hasDataForMask("dsplan:MVMask.Task.Apollo")}),Object.defineProperty(n,"models",{get:()=>n.toArray()}),n.load=(()=>b.fetchTasks(this)),n.getSize=(()=>n.length),n.getSequenceOrder=(e=>e.get(A.SEQUENCE_ORDER_ATTR)),n.comparator=((e,t)=>S.comparator(e,t))),n},getSubtasks:function(){var e=this.getCollectionAttribute("dsplan:hasSubtask",{mask:"dsplan:MVMask.Task.Complex",detailsMask:"dsplan:MVMask.Task.Basic"});const t=function(){const t=[];return e&&e.length&&e.forEach((e,n)=>{t.push(...e.getToConstraints().toArray())}),t}();return t&&t.length>0&&t.forEach((e,t)=>{e.updateParentWorkscopes({forceDispatchEvent:!0})}),e},getAllSubTasks:function(){let e=[];return this.getSubtasks().forEach(t=>{e=[...e,t,...t.getAllSubTasks()]}),e},hasSubtasks:function(){var e=this.getSubtasks();return Boolean(e.length||e.hasMoreItems())},updateReadyToStart:function(){this.set("readyToStart",this.isReadyToStart())},updateAtRisk:function(){this.set("atRisk",this.isAtRisk())},updateLate:function(){this.set("late",this.isLate())},updateCompressionLevel:function(){this.set("compressionLevel",this.getCompressionLevel())},calculateAndSetUpListenersForVisualAttributesIfNeeded:function(){void 0===this.get("readyToStart")&&(this.updateReadyToStart(),this.listenTo(this,"onChange:"+A.STATE_ATTR,this.updateReadyToStart),this.listenTo(this,"onChange:"+A.STARTDATE_ATTR,this.updateReadyToStart)),void 0===this.get("atRisk")&&(this.updateAtRisk(),this.listenTo(this,"onChange:state",this.updateAtRisk),this.listenTo(this,"onChange:"+this.DUEDATEATTR,this.updateAtRisk),this.listenTo(this,"onChange:"+A.ACTUAL_START_DATE,this.updateAtRisk),this.listenTo(this,"onChange:"+A.STARTDATE_ATTR,this.updateAtRisk),this.listenTo(this,"onChange:"+A.COMPLETE_PERCENT_ATTR,this.updateAtRisk),this.listenTo(this,"onChange:"+A.DURATION_MIN,this.updateAtRisk),this.listenTo(this,"onChange:"+A.DURATION_MAX,this.updateAtRisk)),void 0===this.get("late")&&(this.updateLate(),this.listenTo(this,"onChange:state",this.updateLate),this.listenTo(this,"onChange:"+this.DUEDATEATTR,this.updateLate),this.listenTo(this,"onChange:"+A.DURATION_MIN,this.updateLate),this.listenTo(this,"onChange:"+A.DURATION_MAX,this.updateLate)),void 0===this.get("compressionLevel")&&(this.updateCompressionLevel(),this.listenTo(this,"onChange:"+A.DURATION_MIN,this.updateCompressionLevel),this.listenTo(this,"onChange:"+A.DURATION_MAX,this.updateCompressionLevel),this.listenTo(this,"onChange:"+A.DURATION_ESTIMATED,this.updateCompressionLevel))},isProjectTask:function(){return!1},isRouteTask:function(){return!1},isRDFTask:function(){return!0},isIteropTask:function(){return!1},isWedo:function(){return Boolean(u.isWedoTask(this.get("dsxplan:jsType"))||this.get(A.PARENT_HAS_SWYM_COMMUNITY))},getFonticonValue:function(){return"fonticon-plan-task"},hasWeDoTagData:function(){return!!this.tagsData&&this.tagsData.filter(e=>"ds6w:what/ds6w:type"===e.sixw&&"swym:WeDo"===e.object).length>0},dataForRendering:function(){var e=this._parent.apply(this,arguments);return e.name=this.get(A.DSLC_TITLE_ATTR),e.image=this.get("dsplan:hasThumbnail")||this.get("image"),e.physicalId=this.get("physicalId"),e.percentComplete||(e.percentComplete=0),e},createNodeData:function(){let t=this._parent.apply(this,arguments);return e.merge(t,{icon:this.isWedo()?require.toUrl(Q):require.toUrl(z),nodeType:"task"}),t},isLeanTask:function(){return Boolean(this.get(A.PARENT_HAS_LEAN_BOARD))},isStandaloneTask:function(){return Boolean(!this.get(A.HAS_PARENT_ATTR))},subscriptionsEnabled:function(){return!1},getCustomFields:function(){},isInCurrentScope:function(){if(this.noFilter)return!0;var e=E.getScope(),t=E.getObjectData(),n=E.getCollection();if(E._scopeType&&E._scopeType.indexOf("swym")>-1||t&&t.contextFilter)return!0;if(E.isScopeRDF()&&!e.ownsOrContainsTask(this,n))return!1;if("all"===E.getFilter()&&E.isScopeRDF())return!0;if("candidateAssignee"===E.getFilter())return!0;var s=this._isOwnedByOrAssignedToCurrentUser();return!(E.getScopeId()||!s)||!(!E.isScopeRDF()||!s)},_hasWorkscopeParent:function(){let e=this.get("dsxplan:workscopeParent");return!!e&&"dsplan:DummyProject"!==e.id},_isAssignedToCurrentUser:function(){var e,n,s=this.hasFetchedAttribute("dsxplan:hasAssignee");if(s){var i=this.getAssignees().toArray().map(function(e){if("foaf:Person"===e.get("dsxplan:jsType"))return e.get("dsaccess:accountName",{noMapping:!0});"foaf:Group"===e.get("dsxplan:jsType")&&(n=!0)});e=t.detect(i,function(e){return e&&e.toUpperCase()===window.enoviaServer.user.toUpperCase()})}return Boolean(!s||e)||n},_isOwnedByCurrentUser:function(){var e,t=this.hasFetchedAttribute(A.OWNER_ATTR);if(t){var n=this.get(A.OWNER_ATTR);if(n){var s=n.get("dsaccess:accountName");e=u.isLoggedInUser(s)}}return Boolean(!t||e||this.isNew())},_isOwnedByOrAssignedToCurrentUser:function(){return this._isOwnedByCurrentUser()||this._isAssignedToCurrentUser()},_filterDatabyScope:function(t){var n=this;E.getCollection()&&!E.isScopeRDF()&&e.Utils.setImmediate(function(){var e=E.getCollection();e&&!n.isInCurrentScope()&&e.remove(n,{dontRegisterChange:!0}),"function"==typeof t&&t()})},getValidTypes:function(){var e=this.isDSLC()?"dsxplan:hasTaskVocabulary":A.TASK_VOCABULARY_ATTR;return this._parent(e)},get:function(e){var t=Array.prototype.slice.call(arguments,0),n=J[e]||e;t[0]=n;var s=this._parent.apply(this,t),i=this._propertyDictionary[e];if(i&&i.date){return s?new Date(s):void 0}if(!s&&"dsplan:hasAssignee"===n){var o=C.RapidRDFModelRegistry?C.RapidRDFModelRegistry.getRapidModelByURI(this.id):void 0;if(!o)return s;if(s=s||[],o&&o.assigneeIds&&o.assigneeIds.length)for(var a=o.assigneeIds,l=a.length,p=0;p<l;p++){var m=d.getObjectForAdding(r,a[p],{mask:c.getPersonMask(),attrs:{"dsaccess:accountName":c.addIamToURI(h.getContextUser())}});s.push(m)}}return n===e&&(s=this._getAttributeValue(e,s)),"source"===n&&u.isWedoTask(this.get(A.JS_TYPE_ATTR))&&(s="swym"),"card_icon"===n&&(s=this.isWedo()?require.toUrl("DS/E6WCommonApps/assets/img/I_WeDoTask_16.png"):require.toUrl("DS/E6WCommonApps/assets/img/I_ProjectPlanningTask_16.png")),"endDate"===n&&(s=this.getEndDate()),s},_getParentProjectOrTask:function(e){var t=this.get(A.PARENT_ATTR),n=this.get(A.TASK_PARENT_ATTR);return n||(t||((this.hasFetchedAttribute(A.PARENT_ATTR)||this.hasFetchedAttribute(A.TASK_PARENT_ATTR))&&this.isStandaloneTask&&!this.isStandaloneTask()?new f:e))},_getAttributeValue:function(e,t){switch(e){case"image":return this.getIconURL();case"dsplan:actualType":case"dsxplan:actualType":var n=t;return n?{actualValue:t.id,displayValue:n.get("title")}:null;case"dsxplan:vocabularyType":t||(t="dsplan:Task");break;case"state":var s=this.get(A.STATE_ATTR);return s&&(t=enoviaServer.useFD01CodeFor3DPlan?Y[s]:j[s["@id"]||s.id||s]),t;case F:var i=this.get(A.STATE_ATTR);return this.getStateForDisplayValue(i);case this.DUEDATECATEGORY:return this.dueDateCategory(this.get(this.DUEDATEATTR));case this.REFERENCEATTR:case"deliverables":return[];case A.PARENT_ATTR:const o=t||m.prototype.getParent.call(this);return o instanceof $?void 0:o;case A.COMMON_TASK_PARENT_ATTR:return this._getParentProjectOrTask(t);case"priority":return this.getPriorityValue()}return t},getStateForDisplayValue:function(e){let t;return e&&(t=enoviaServer.useFD01CodeFor3DPlan?H[e]:w[e["@id"]||e.id||e]),t},getPriorityValue:function(){var e=this.get(A.PRIORITY_ATTR);return L[e&&e.id]},getPriorityValueNLSString:function(){return U[this.getPriorityValue()]},getFieldDef:function(e){return X[e]},addObjects:function(e,t){var n=Array.prototype.slice.call(arguments,0);return n[1]=this.rdfCollabTaskInverseMapping[t]||t,this._parent.apply(this,n)},set:function(){var t=u.setHelper.apply(this,arguments),n=e.clone(t.attrs||{},!1),s=e.clone(t.options||{},!1);if(n){if(n.hasOwnProperty("state")&&(n[A.STATE_ATTR]=enoviaServer.useFD01CodeFor3DPlan?K[n.state]:d.getObjectForAdding(i,B[n.state]),delete n.state),n.hasOwnProperty(F)&&(n[A.STATE_ATTR]=enoviaServer.useFD01CodeFor3DPlan?G[n[F]]:d.getObjectForAdding(i,V[n[F]]),delete n[F]),n.hasOwnProperty(this.DUEDATECATEGORY)&&(n[this.DUEDATEATTR]=this.dueDateCategory2DueDate(n[this.DUEDATECATEGORY]),delete n[this.DUEDATECATEGORY]),n.hasOwnProperty(this.DUEDATEATTR)&&this._processDueDate(n),!n[A.STATE_ATTR]||"dsxplan:InProgress"!==n[A.STATE_ATTR].id&&"dsxplan:Done"!==n[A.STATE_ATTR].id||(s.dontAdjustDates=!0),n.hasOwnProperty(W)&&n[W]&&(n[W]=parseInt(n[W])),s.parse||s.dontAdjustDates||this._adjustStartAndEndDates(n,s),n.hasOwnProperty(A.DSLC_TITLE_ATTR)&&void 0!==n[A.DSLC_TITLE_ATTR]&&(n[A.DSLC_TITLE_ATTR]=n[A.DSLC_TITLE_ATTR].substring(0,128)),n.hasOwnProperty("priority")&&(n[A.PRIORITY_ATTR]=d.getObjectForAdding(i,x[n.priority]),delete n.priority),n.hasOwnProperty(A.SEQUENCE_ORDER_ATTR)&&(!isNaN(n[A.SEQUENCE_ORDER_ATTR])&&n[A.SEQUENCE_ORDER_ATTR]||delete n[A.SEQUENCE_ORDER_ATTR]),n.hasOwnProperty("dsxplan:backlogParent")&&(this.getParent()&&this.getParent().getTasks().remove(this,{dontRegisterChange:!0}),this._parent("dsxplan:workscopeParent",void 0,{dontRegisterChange:!0})),n.hasOwnProperty(A.PARENT_ATTR)){const e=this.get("dsxplan:backlogParent");e&&(this._parent("dsxplan:backlogParent",void 0,{dontRegisterChange:!0}),e.getBacklogTasks().remove(this,{dontRegisterChange:!0}))}return this._parent(n,s)}return this._parent.apply(this,arguments)},_processDueDate:function(t){var n=t[this.DUEDATEATTR];if(delete t[this.DUEDATEATTR],n=(n=e.is(n,"string")?parseInt(n,10):n)instanceof Date?n:new Date(n),t["dsplan:estimatedEndDate"]=n,!this.isStarted()){var s=new Date(this._attributes["dsxplan:estimatedEndDate"]).getTime()-new Date(this._attributes["dsxplan:estimatedStartDate"]).getTime(),i=new Date(n).getTime()-s;t["dsplan:estimatedStartDate"]=new Date(i)}var o=!isNaN(n);t[A.USER_DEFINED_START_DATE_ATTR]=o,t[A.USER_DEFINED_END_DATE_ATTR]=o},_adjustStartAndEndDates:function(t,n){var s=this,i=e.clone(n||{},!1),o=function(e,o,a,r){var l=t[e],d=t[o];if(l||d){var c=l||s.getStartDate(),p=d||s.getEndDate(),u=s._getDatesWithAdjustedHours(l,d,c,p,a,r,n);(i.adjustStartDate||l||u.end<new Date(c))&&(t[e]=u.start.toISOString()),(i.adjustEndDate||(d||u.start>new Date(p))&&!s.isInProgress())&&(t[o]=u.end.toISOString())}},a=this.isStartDateFixed(t[A.USER_DEFINED_START_DATE_ATTR]),r=this.isEndDateFixed(t[A.USER_DEFINED_END_DATE_ATTR]);if(t[A.STARTDATE_ATTR]||t[A.ENDDATE_ATTR]){o(A.STARTDATE_ATTR,A.ENDDATE_ATTR,a,r);let e=this.getParent&&this.getParent().id;(a||this.get(A.ACTUAL_START_DATE))&&r&&this.calculateAndSetDuration(e,{startDate:t[A.STARTDATE_ATTR],endDate:t[A.ENDDATE_ATTR]})}(t[A.ACTUAL_START_DATE]||t[A.ACTUAL_END_DATE])&&o(A.ACTUAL_START_DATE,A.ACTUAL_END_DATE,a,r)},_getDatesWithAdjustedHours:function(e,t,n,s,i,o,a){var r;return n&&s?(r={start:new Date(n),end:new Date(s)},this.adjustDatesBasedOnDuration(r,i,o,a)):r={start:new Date(e),end:new Date(t)},r},toJSON:function(t){var n,s=e.clone(t||{},!1);if(s.attributes&&s.dataForRendering){n=Object.create(null);for(var i=e.clone(s.attributes,!1),o=i.length,a=0;a<o;a++){var r=i[a],l=J[r];n[r]=!0,l&&(n[l]=!0,i.push(l))}s.attributes=i}var d=this._parent(s);if(s.dataForRendering||delete d.dueDateCategory,s.dataForRendering){var c=!n,p=this,h=function(e){if(c||n[e]){var t=p.get(e);t&&(d[e]=t)}};if(c||n[A.PARENT_ATTR]){var m=this.get(A.PARENT_ATTR);if(m){var T=s.ancestors;T||(s.ancestors=T={}),T[m.id]=!0,d[A.PARENT_ATTR]=m.toJSON(s)}}h("state"),h(this.DUEDATEATTR),h(this.DUEDATECATEGORY),h("modified"),h("actualStartDate"),h("canEdit"),h("priority"),d.image=this.get("dsplan:hasThumbnail")||this.get("image"),d.id=this.id,Object.keys(J).forEach(e=>{(c||n[e])&&(d[e]=d[J[e]])}),h(F),d.date=new Date(this.getEndDate())}for(var g=Object.keys(d),E=g.length,C=0;C<E;C++){var f=g[C],_=d[f];_ instanceof Date&&(d[f]=_=u.dateForJSON(_,"UTC",this.dateHelper,t))}return d.physicalId=this.get("physicalId"),d},getCreationDate:function(){return this.get(A.CREATION_DATE_ATTR)},getStartAndFinishDates:function(){return{start:new Date(this.getStartDate()),finish:new Date(this.getEndDate())}},getStartDateAttr:function(){return this.isStarted()?A.ACTUAL_START_DATE:$.STARTDATE_ATTR},getStartDate:function(){var e=this.getStartDateAttr();return this._changing&&this.hasChanged(e)&&this._clearStartDateCachedValue(),this._startDate||(this._startDate=this.get(e)),this._startDate},setStartDate:function(e,t){this.isStarted()&&e>new Date||this._setDateAttribute(this.getStartDateAttr(),e,t)},_clearStartDateCachedValue:function(){delete this._startDate},getEndDateAttribute:function(){return this.isComplete()?A.ACTUAL_END_DATE:$.ENDDATE_ATTR},getEndDate:function(){return this.get(this.getEndDateAttribute())},setEndDate:function(e,t){this.isComplete()&&e>new Date||this._setDateAttribute(this.getEndDateAttribute(),e,t)},getPercentComplete:function(){return this.get("dsplan:percentageCompletion")||0},getDurationMinAsDays:function(){return this.getDurationAttributeAsDays(A.DURATION_MIN)},getDurationMaxAsDays:function(){return this.getDurationAttributeAsDays(A.DURATION_MAX)},getDurationAttributeAsDays:function(e){var t=this.get(e)||1;return t=t&&this.getDaysAsUnit(t)},getSuggestedDuration:function(){var e=this.getDurationMinAsDays(),t=this.getDurationMaxAsDays();return void 0===e?t:void 0===t?e:(e+t)/2},getSuggestedOffset:function(){if(this.get("dsxplan:hasSubtask")&&this.get("dsxplan:hasSubtask").length>0){let e=this.getSubtasks(),t=0;return e._models.forEach(e=>{t=e.getSuggestedOffset&&e.getSuggestedOffset()>t?e.getSuggestedOffset():t}),this.set(A.DURATION_MIN,this.getDaysAsString(t)),this.set(A.DURATION_MAX,this.getDaysAsString(t)),t}var e=this.getDurationMinAsDays(),t=this.getDurationMaxAsDays();return void 0===e||void 0===t?0:(t-e)/2},getEstimatedDuration:function(){var e=this.getParent&&this.getParent();if(b.hasSubtasks(this)&&this.getStartDate&&this.getEndDate){this.nonWorkingDayIterator=e&&e.getNonWorkingDayIterator&&e.getNonWorkingDayIterator();let t=this.nonWorkingDayIterator&&this.nonWorkingDayIterator.countWorkingDays(new Date(this.getStartDate()),new Date(this.getEndDate()));return this.set(A.DURATION_ESTIMATED,t),t}var t=this.get(A.DURATION_ESTIMATED);return t&&(t=this.getDaysAsUnit(t)),t},getAssignees:function(){return this.getCollectionAttribute(A.ASSIGNEE_ATTR,{detailsMask:"dsplan:MVMask.Person.Complex"})},isStoryTask:function(){return d.isStoryTask(this)},isStarted:function(){var e=this.get(A.STATE_ATTR);if(window.enoviaServer&&enoviaServer.useFD01CodeFor3DPlan)return"Done"===e||"In Progress"===e;var t=e&&(e.id||e["@id"]||e);return t===A.STATE_DONE||t===A.STATE_IN_PROGRESS},isInProgress:function(){var e=this.get(A.STATE_ATTR);return window.enoviaServer&&enoviaServer.useFD01CodeFor3DPlan?"In Progress"===e:(e&&(e.id||e["@id"]||e))===A.STATE_IN_PROGRESS},isFixed:function(){return this.isStartDateFixed()||this.isEndDateFixed()},isStartDateFixed:function(e){return Boolean(e)||this.get(A.USER_DEFINED_START_DATE_ATTR)},isEndDateFixed:function(e){return Boolean(e)||this.get(A.USER_DEFINED_END_DATE_ATTR)},getPropertyMask:function(){return"dsplan:MVMask.Task.Property"},fetchForProperty:function(t){let n=e.clone(t||{},!1);var s=this;let i;var o;i=this.hasFetchedAccessData()?n.batchBuilder||d.getBatchGenerator():n.batchBuilder?this.getAccessBatch({batchBuilder:n.batchBuilder}):this.getAccessBatch(),o=i.ajax,s.fetch({ajax:o,mask:s.getPropertyMask&&s.getPropertyMask(),onlyIfNeeded:!0});const a=this.getProjectParent(this.getParent());a&&a.fetch({mask:"dsplan:MVMask.WorkPackage.CalendarOnly",onlyIfNeeded:!0,ajax:i.ajax}),this.getParent()&&!e.is(this.getParent()._accessModify)&&this.getParent().getAccessBatch&&this.getParent().getAccessBatch({batchBuilder:i}),n.batchBuilder||i.sendBatch()},getCompressionLevel:function(){var e=0;if(!this.isComplete()&&!b.hasSubtasks(this)){var t=this.getSuggestedDuration(),n=this.getEstimatedDuration(),s=this.getSuggestedOffset();n&&t<n?n>=t+s&&(e=-1):n&&n<t&&(e=n<t-s/2?2:1)}return e},getCollectionAttributeBasedOnModel:function(e){if(e instanceof $)return"dsxplan:hasSubtask"},getIconURL:function(){return this.isWedo()?require.toUrl(Q):require.toUrl(z)},getWorkDayLength:function(){return R.getWorkHours()},_getStartOfWorkDay:function(e){return e?this._getUTCStartOrEndInMinutes(e):this._getUTCStartOrEndInMinutes(8)},_getEndOfWorkDay:function(e){return e?this._getUTCStartOrEndInMinutes(e):this._getUTCStartOrEndInMinutes(16)},_getUTCStartOrEndInMinutes:function(e){var t=this.getProjectParent(this.getParent()),n=t&&t.getTimezone();return n?60*e-n.get(_.OFFSET_ATTR):60*e+240},getWorkingHoursInMilliseconds:function(){return 60*this.getWorkDayLength()*60*1e3},getErrorAssigneeIds:function(){var e=this.get("dsplan:hasScheduleError"),t=[];if(e){var s=function(e){if(e.get("@id")!==A.NO_SOLVER_ERROR){var n=e.get("dsplan:errorObject");n&&n.get&&t.push(n.get("@id"))}};e instanceof n?e.forEach(s):s(e)}return t},getDaysAsUnit:function(e){var t=d.xsdDayTimeDurationToMilliseconds(e)/this.getWorkingHoursInMilliseconds();return Math.round(100*t)/100},getDaysAsString:function(e){return d.millisecondsToXsdDayTimeDuration(e*this.getWorkingHoursInMilliseconds())},getDefinedDuration:function(){var e=this.getSuggestedDuration();return e||this.getEstimatedDuration()},handleUnsetActualStartDate:function(e){var t=this.isDSLC()?"dsxplan:hasMaturity":"dscom:hasMaturity",n=e&&"To Do"===e[F];(n=n||"To Do"===(e&&e[t]||this.changedAttributes()[t]))&&this.get(A.ACTUAL_START_DATE)&&this.unset(A.ACTUAL_START_DATE,{silent:!0})},handleUnsetParent:function(e){if(e){var t=this.getParent(),n=t&&t.getObjectType();if(n&&n!==A.TASK&&-1!==e.indexOf(A.TASK_PARENT_ATTR)&&-1===e.indexOf(A.PARENT_ATTR)&&this.unset(A.PARENT_ATTR),!this.get(A.PARENT_ATTR)&&!this.get(A.TASK_PARENT_ATTR)){this.get("dsplan:taskHasConstraint")&&this.unset("dsplan:taskHasConstraint",{silent:!0,dontRegisterChange:!0});var s=this.get("toConstraints");if(s&&s.length)s.toArray().forEach(e=>{e.destroy({noServer:!0})});var i=this.get("fromConstraints");if(i&&i.length)i.toArray().forEach(e=>{e.destroy({noServer:!0})})}}},handleSelfAssignToInWorkTask:function(){var e=u.setHelper.apply(this,arguments).attrs||{},t=this.get(this.ASSIGNEESATTR),n=!t||0===t.length,s=e.state,i=e.stateForDisplay,o=e["dscom:hasMaturity"]&&e["dscom:hasMaturity"].id,a=e["dsplan:percentageCompletion"],r=this.get("state");n&&("Active"===s||"In Progress"===i||"dsxplan:InProgress"===o||"Active"!==r&&a>0&&a<100)&&(this.addAssigneesById(c.addUUIDToURI(h.getContextUserUid())),this.addSelfAssignToInWorkMessage.apply(this,arguments))},save:function(){var e,t=u.setHelper.apply(this,arguments).attrs||{},n=this.getCombinedAttributes(t);this.markDeliverablesOn3DNavigate(),this.handleUnsetActualStartDate(t),this.handleUnsetParent(n),this.handleSelfAssignToInWorkTask.apply(this,arguments),u.isWedoTask(this.get("dsxplan:jsType"))&&(e=-1!==n.indexOf(A.PARENT_ATTR)),e&&(arguments[1].mask="dsplan:MVMask.Task.Property",arguments[1].onComplete=function(e){e.getParent()&&u.displaySuccess(O("E6WCommonApps.Alert.WedoAdded"))}),t.hasOwnProperty(A.DURATION_ESTIMATED)&&D.addToIgnoreLiveUpdateMap(this),this._parent.apply(this,arguments)},isAttributeImpactingSolve:function(e,t){var n=this._parent.apply(this,arguments);if(!n&&"dsxplan:percentageCompletion"===e){var s=this.get(A.STATE_ATTR),i=this.get(A.COMPLETE_PERCENT_ATTR);if(s&&(s.id===A.STATE_OPEN&&i>0||s.id===A.STATE_IN_PROGRESS&&0===i))return!0}return n},parse:function(t){var n=this.getParent();const s=this.hasFetchedAttribute(A.PARENT_ATTR)&&this.hasFetchedAttribute(A.TASK_PARENT_ATTR);var i=this._parent.apply(this,arguments);if(t&&e.is(t,"object")){var o=t["@mask"],a=l.getMask(o)||{};s&&void 0===n&&(a[A.PARENT_ATTR]&&!t[A.PARENT_ATTR]&&this.dispatchEvent("onChange:"+A.PARENT_ATTR,[this]),a[A.TASK_PARENT_ATTR]&&!t[A.TASK_PARENT_ATTR]&&this.dispatchEvent("onChange:"+A.TASK_PARENT_ATTR,[this]))}return i},adjustDatesBasedOnDuration:function(t,n,s,i){var o=e.clone(i||{},!1);N(t.start),N(t.end);var a=(this.getDefinedDuration()||1)-1;o.resized||(n&&!s?(t.end=new Date(t.start),t.end.setDate(t.start.getDate()+a)):this.get(A.DSLC_ACTUAL_START_DATE)||!s||n?o.fromDragHandler&&s&&n&&(t.start=new Date(t.end),t.start.setDate(t.end.getDate()-a)):(t.start=new Date(t.end),t.start.setDate(t.end.getDate()-a)));var r,l=t.start;o.nonWorkingDayIterator&&(r=o.nonWorkingDayIterator._workingHours[l.getDay()]&&o.nonWorkingDayIterator._workingHours[l.getDay()].start.hours);var d=this._getStartOfWorkDay(r);t.start=new Date(Date.UTC(l.getFullYear(),l.getMonth(),l.getDate(),0,d,0));var c,p=t.end;o.nonWorkingDayIterator&&(c=o.nonWorkingDayIterator._workingHours[p.getDay()]&&o.nonWorkingDayIterator._workingHours[p.getDay()].end.hours);var u=this._getEndOfWorkDay(c);this.isComplete()&&p>new Date&&(p=new Date),t.end=new Date(Date.UTC(p.getFullYear(),p.getMonth(),p.getDate(),0,u,0))},canDelete:function(){return!u.isWedoTask(this.get(A.JS_TYPE_ATTR))&&this._parent.apply(this,arguments)},isReadyToStart:function(){var e=this.get("dsxplan:hasMaturity");if(e&&"dsxplan:Open"===e.id){var t=this.get("dsxplan:estimatedStartDate");return new Date(t)-T.THRESHOLD>Date.now()}return!1},getParentAsLabel:function(){var e,t=this.getParent&&this.getParent();if(t&&this.isRDFTask()){var n=t.get("title");if(n||(n=this.get("_workscopeParent")),n){let s=O("E6WCommonApps.Label.Parent");t instanceof f||(s=u.isProject(t.get("dsxplan:jsType"))?O("emxCollaborativeTasks.Label.Project"):O("emxCollaborativeTasks.Label.ParentTask")),e={key:s,value:n}}}else this.isWedo&&this.isWedo()?e={key:O("E6WCommonApps.Label.Community"),value:this.get(A.PARENT_HAS_SWYM_COMMUNITY)&&this.get(A.PARENT_HAS_SWYM_COMMUNITY).get("title")}:this.get("_workscopeParent")&&(e={key:O("emxCollaborativeTasks.Label.Project"),value:this.get("_workscopeParent")});return e},getTransferObject:function(t){var n=this.getDragType(),s=e.clone(t||{},!1);return u.isWedoTask(n)&&(s.serviceId="swym"),this._parent(s)},_registerAsElementParent:function(e){e.parentId=this.id||this.cid,e.parentConstructor=this.constructor,e.set(A.TASK_PARENT_ATTR,this,{fromServer:!0})},_getDefaultSequenceOrderForAttribute:function(e){var t=Math.random();if(this.hasFetchedAttribute(e)){var n=this.get(e).last();n&&(void 0===(t=n.get(A.SEQUENCE_ORDER_ATTR_DSLC))&&(t=0),t+=Math.random())}return t},calculateAndSetDuration:function(t,n){var s=this,i=e.clone(n||{},!1),o=i.startDate||this.getStartDate(),a=i.endDate||this.getEndDate();i.onComplete=function(t){t&&t["@value"]&&s._setDurationOnModel(t["@value"]),i.dontSave||s.save(void 0,{onFailure:function(){u.displayError(O("E6WCommonApps.Error.SaveFailed"))}}),n&&n.onComplete&&e.is(n.onComplete,"function")&&n.onComplete.apply(this,arguments)},i.onFailure=function(){u.displayError(O("E6WCommonApps.Error.SaveFailed"))},i.data={project:t||this.getParent().id,startDate:new Date(o).toISOString(),endDate:new Date(a).toISOString()},d.invokeAsLRT("dsmf:xplan.Scheduler.calculateTaskDuration",i)},_setDurationOnModel:function(e){var t=this.getDaysAsUnit(e),n=(this.getDaysAsUnit(this.get(A.DURATION_MAX))-this.getDaysAsUnit(this.get(A.DURATION_MIN)))/2;Math.abs(n)>t&&(n=t);var s=t+n,i=t-n;this.set(A.DURATION_ESTIMATED,e),this.set(A.DURATION_MIN,this.getDaysAsString(i)),this.set(A.DURATION_MAX,this.getDaysAsString(s))},parsePruneModel:function(e){this.get(A.TASK_PARENT_ATTR)&&"dsxplan:workscopeParent"===e||this._parent.apply(this,arguments)},getRDFModel:function(){return this},parseNestedCollection:function(e,t,n,s){"dsxplan:hasWorkContext"===n?(s.member&&s.member.length>0&&this.parseNestedModel(e,t,n,s.member[0]),s.member&&1===s.member.length||console.log(`Expected task to have exactly 1 member in dsxplan:hasWorkContext, but it had ${s.member&&s.member.length}`)):this._parent.apply(this,arguments)}});return $.implement(T,{fetchDeliverableParentTypes:function(e){if(!this.hasFetchedAttribute("dsxplan:hasAttachment")){const t=this._previous.bind(this,e);return new Promise((e,n)=>{this.fetch({mask:"dsplan:MVMask.Task.ScheduleView",onComplete:function(){t().then(()=>{e()})},onFailure:n})})}return this._previous(e)},canAssignToSelf:function(){return!this.hasFetchedAccessData()||this._previous.apply(this,arguments)}}),$.implement(g,C),$.PersonRDFModel=r,$.STARTDATE_ATTR="dsplan:estimatedStartDate",$.ENDDATE_ATTR="dsplan:estimatedEndDate",$.STATE_ATTR=A.STATE_ATTR,$.prototype.dslcMapping=P,$.prototype.inverseDslcMapping=k,$.prototype.attributeImpactingSolve=A.attributeImpactingSolve,$.prototype.attributeImpactingSubTaskSolve=A.attributeImpactingSubTaskSolve,$.prototype.rdfCollabTaskMapping=q,$.prototype.rdfCollabTaskInverseMapping=J,Object.defineProperty($.prototype,"completed",{get:function(){var e=this.collection&&this.collection.getDetailsMask&&this.collection.getDetailsMask()||"dsplan:MVMask.Task.CollaborativeTasks.Complex";return this.hasDataForMask(e)&&!this.fetching}}),Object.defineProperty($.prototype,"extid",{get:function(){return this.cid}}),Object.defineProperty($.prototype,"fixed",{get:function(){return this.isFixed()}}),Object.defineProperty($.prototype,"fedSearchIdQuery",{get:function(){if(this.id)return this.isWedo()?'resourceid:"'+d.removeBracketLongURI(this.id)+'"':'uri:"'+d.shortToLongURI(this.id)+'"'}}),$.ATTS={PARENT:A.PARENT_ATTR,TASK_PARENT:A.TASK_PARENT_ATTR},$.PROPERTY_MASK="dsplan:MVMask.Task.Property",$}),define("DS/E6WCommonApps/DuplicateItemUtils",["UWA/Core","DS/RDFFoundation/SecurityContextUtils","DS/E6WCommonUI/UIHelper","DS/UIKIT/Input/Toggle","DS/E6WCommonApps/Models/ConstraintModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/AddTaskMixin","DS/E6WCommonApps/XTaskScope","DS/E6WCommonApps/SubscribeUtil","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h){"use strict";var m=function(e){var t=u.get(e);return t===e&&(t=h.get(e)),t},T={_getDuplicateTaskModalBody:function(){var t=e.createElement("div");return this._radio1=new s({id:"duplicateTask",name:"radio1",value:o.DUPLICATE_TASK,className:"primary",label:m("E6WCommonApps.Label.CreateDuplicateTask"),checked:!0}).inject(t),this._radio2=new s({id:"splitTask",name:"radio1",value:o.SPLIT_TASK,label:m("E6WCommonApps.Label.SplitTask"),className:"primary"}).inject(t),t},getAssigneeList:function(e){var t=[];return e.getAssignees&&e.getAssignees().length&&(t=e.getAssignees()),t},duplicateItem:function(t){var n=this,s=e.clone(t||{},!1),i=s.model,a=s.parentView,r=s.modal||a&&a.getSuperModal(),l=i.get("title"),d=s.getAssignees&&s.getAssignees(i)||n.getAssigneeList(i);d.length>1||1===d.length&&"foaf:Group"===d.at(0).get("dsxplan:jsType")?r.dialog({body:T._getDuplicateTaskModalBody(),title:h.replace(m("E6WCommonApps.Label.CreateDuplicateTask"),{NAME:l}),buttons:[{id:"duplicateBtn",className:"primary",value:m("E6WCommonUI.Label.Duplicate"),action:function(e){var t;n._radio1.isChecked()?t=n._radio1.getValue():n._radio2.isChecked()&&(t=n._radio2.getValue()),T._createDuplicateTask(i,a,{toggleValue:t,assigneeList:d,...s}),e.hide()}},{id:"duplicateCancelBtn",className:"default",value:m("E6WCommonApps.Command.Cancel"),action:function(e){e.hide()}}]}):T._createDuplicateTask(i,a,{toggleValue:o.DUPLICATE_TASK,assigneeList:d,...s})},getDurationString:function(e){return a.millisecondsToXsdDayTimeDuration(8*parseFloat(e)*60*60*1e3)},_getDefaultDupTaskAttributes:function(e){var t=d.getDefaultTaskAttributes();return t[o.TITLE_ATTR]=e.get("title"),t[o.DESCRIPTION_ATTR]=e.get("subtitle"),t[o.DSLC_DESCRIPTION_ATTR]=e.get("dsxplan:comment"),t[o.RICH_TEXT_DESCRIPTION]=e.get("richTextDescription"),t[o.RICH_TEXT_FIELD]=e.get("dsplan:RichTextField"),t[o.DURATION_MIN]=this.getDurationString(e.getDurationMinAsDays()),t[o.DURATION_MAX]=this.getDurationString(e.getDurationMaxAsDays()),t[o.STARTDATE_ATTR]=new Date(e.getStartDate()),t[o.ENDDATE_ATTR]=new Date(e.getEndDate()),t[o.STATE_ATTR]={"@id":"dsxplan:Open"},t},_addDummyModelToCollection:function(e,t,n){t&&t.add(e),n&&n.add(e)},_createDummyModel:function(e,t){var n=this._getDefaultDupTaskAttributes(e);let s;return s=t.addTask?t.addTask(n,{parse:!0,dontRegisterChange:!0}):new l(n,{parse:!0,dontRegisterChange:!0})},_handleConstraintsForDuplicateTask:function(e){var t=function(e){e.updateParentWorkscopes({forceDispatchEvent:!0})};e.forEach(e=>{e.getToConstraints().forEach(e=>t(e)),e.getFromConstraints().forEach(e=>t(e))})},_createDuplicateTask:function(s,i,l){var d=e.clone(l||{},!1),u=d.toggleValue?d.toggleValue:"duplicate",h=d.assigneeList?d.assigneeList:[],T=a.expandUrl("invoke/dsxplan:createDuplicateTask?$mask=dsplan:MVMask.Task.Property","v1"),g=e.is(s.getParent,"function")&&s.getParent();if(g instanceof r)return n.displayError(m("E6WCommonApps.Error.NoModifyAccessOnParent"));if(!s.get("dsxplan:jsType"))return n.displayError(m("E6WCommonApps.Error.StandaloneTaskDuplicateFailed"));var E=s.get(o.PARENT_ATTR),A=s.get(o.TASK_PARENT_ATTR),C=[];E&&(C=e.is(E.getTasks,"function")&&E.getTasks()),A&&(C=e.is(A.getSubtasks,"function")&&A.getSubtasks());var f=g&&g.get("dsxplan:hasLeafTasks");t.isTSKContext()&&c.getCollection()&&(C=c.getCollection());var _=[];if(u===o.SPLIT_TASK)for(let e=0;e<h.length;e++){let e=this._createDummyModel(s,C);this._addDummyModelToCollection(e,C,f),_.push(e)}else{let e=this._createDummyModel(s,C);this._addDummyModelToCollection(e,C,f),_.push(e)}o.SPLIT_TASK;let D=p.subscribeActivity(m("E6WCommonUI.Label.SavingChanges"),{start:!0});a.request(T,{method:"POST",type:"json",data:JSON.stringify([{taskId:s.get("@id"),option:u,identifier:D}]),headers:{"Content-Type":"application/json"},onComplete:e=>{e.member?(this.onCompleteHandler(e,s,_,d),d.onDupTaskComplete&&d.onDupTaskComplete(_),d.onDupTaskComplete?d.onDupTaskComplete(_):!t.isTSKContext()&&this._handleConstraintsForDuplicateTask(_),s.solve(),n.trackPageEvent({eventCategory:"taskMenu",eventAction:"duplicateItem",eventLabel:"NewModelList",eventValue:_})):this.onFailedHandler(e,void 0,_)},onFailure:(e,t)=>{this.onFailedHandler(e,t,_)}})},onCompleteHandler:function(e,t,s,i){var o,a=s.length<=1?m("E6WCommonApps.Label.TaskDuplicateSuccess"):m("E6WCommonApps.Label.TaskSplitSuccess");n.displaySuccess(a),s.forEach((t,n)=>{o=t._mapDslcAttributes(e.member[n]),o=t.parse(o),i.parse=!0,i.noServer=!0,t.set(o,i),t._updateInverseProperties()})},onFailedHandler:function(e,t,s){s.forEach(e=>{e.destroy({noServer:!0})});var i=t&&t.message;i||(i=m("E6WCommonApps.Error.TaskDuplicateFailed")),n.displayError(m(i))}};return T}),define("DS/E6WCommonApps/Collections/RDFTasksCollection",["UWA/Core","UWA/Class/Collection","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/AddTaskMixin","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/XTaskScope","DS/E6WCommonApps/TaskUtils","DS/RDFFoundation/Models/PersonRDFModel","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonApps/Collections/TasksSplitCollection","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T){"use strict";var g=Function.prototype,E=function(e){return e&&e.actualValue||e},A=n.extend({_uwaClassName:"RDFWorkscopeCollection"}),C=n.extend({model:i,_relations:{key:"scopes",relatedCollection:A},_uwaClassName:"RDFTasksCollection",comparator:function(e,t){return c.comparator(e,t)},_completeModelsInQueue:function(){let e=this.toComplete&&Object.keys(this.toComplete);if(e&&e.size){var t=this.toComplete;delete this.toComplete;let n=[],s=[];e.forEach(e=>{t[e].onlyIfNeeded?n.push(e):s.push(e)}),this.complete(n,{onlyIfNeeded:!0}),this.complete(s)}},complete:function(t,n){var s=e.clone(n||{},!1),i=t.filter(function(t){return t instanceof r||e.is(t,"string")}).map(function(e){return e.id||e});if(i.length)if(!this.completing||n&&n.mask){var o=this;this.completing=!0,a.complete(this.model,i,{mask:n&&n.mask||this.getDetailsMask(),onComplete:function(){o.completing=!1,o._completeModelsInQueue(),n&&n.onComplete&&n.onComplete(),o.dispatchEvent("doneCompleting")},onlyIfNeeded:s.onlyIfNeeded,attrs:{forceDslc:!0}})}else{this.toComplete||(this.toComplete={});for(let e of i)this.toComplete[e]||!n||n.onlyIfNeeded||(this.toComplete[e]=n)}},setAttrToSplitBy:function(e){this._attrToSplitBy=e},setIdForCreateChild:function(e){this._createChildId=e},getIdForCreateChildDSLC:function(){return this._createChildId?this._createChildId:this._parent.apply(this,arguments)},createStandaloneRDFTask:function(t){var n=e.clone(t||{},!1),s=o.getDefaultTaskAttributes();e.extend(s,n);return s[l.STATE_ATTR]={"@id":"dsxplan:Open"},new i(s)},addNewTask:function(t,n,i){var o,a=e.clone(i||{},!1);if(widget){var r={title:t,subtitle:a.createDescription,"dsxplan:durationIntervalMin":"PT86400S","dsxplan:durationIntervalMax":"PT86400S"};a&&a.extensionAttrs&&(r["dsbase:extension"]=a.extensionAttrs);var l=n||this.parentModel;o=l&&e.is(l.addTask,"function")?l.addTask(r):this.createStandaloneRDFTask(r);var d="/invoke/dsxplan:getTasks"===this.getUri()?this.currentScopeCollection:this;(!l||!e.is(l.addTask,"function")||d&&d!==l.getTasks())&&(this.add(o),o.keepWhenUpdating=!0),o.save(null,{onFailure:function(){var e,t;s.displayError((e="E6WCommonApps.Error.FailedToCreateTask",(t=T.get(e))===e&&(t=m.get(e)),t)),i&&i.onFailure&&i.onFailure.apply(this,arguments)},onComplete:function(e){e.solve(),i&&i.onComplete&&i.onComplete.apply(this,arguments)},at:0})}return o},setup:function(t,n){var s=Array.prototype.slice.call(arguments,0);this._TasksByAttr={},this._attrToSplitBy="state",this.extid="allTasks";var i=e.clone(n,!1);this.parentModel=i.parentModel,s[1]=i,this._parent.apply(this,s)},setSearch:function(e){this._search=e.toLowerCase(),this._cleanupSubCollections()},resetSearch:function(){delete this._search,this._cleanupSubCollections()},getSearch:function(){return this._search},tasksWithAttrValue:function(e,t){var n=this,i=t||this._attrToSplitBy,o=E(e);return this.filter(function(e){var t=E(e.get("state")),a=E(e.get(i)),r=E(e.get("dsxplan:label"));r=r?r.toLowerCase():"";let d=E(e.get("dsxplan:enterpriseIdentificationNumber"));var c=!n._search||(s.match(n._search,r)||s.match(n._search,d));return(i!==l.DUE_DATE_CATEGORY&&"priority"!==i||"Complete"!==t)&&(a===o&&c)})},tasksWithAttrValueCollection:function(e,t){if(void 0===e)throw new Error("Invalid attribute value passed.");var n=t||this._attrToSplitBy,s=E(e),i=this._TasksByAttr[n];if(!i||!i[s]){var o=this.tasksWithAttrValue(e,n),a={filterAttr:n,valueForFiltering:e,parentCollection:this},r=new C.TasksSplitCollection(o,a);r.extid="tasks-"+n+"-"+s,i||(this._TasksByAttr[n]=i={}),i[s]=r}return i[s]},_cleanupSubCollections:function(){var e=Object.prototype.hasOwnProperty;for(var t in this._TasksByAttr)e.call(this._TasksByAttr,t)&&this._cleanupSubCollectionForAttr(t)},_cleanupSubCollectionForAttr:function(e){var t=Object.prototype.hasOwnProperty,n=this._TasksByAttr[e];for(var s in n){if(t.call(n,s))n[s].stopListening(),delete n[s]}},scopesTypesForSearch:function(){return[]},scopesTypes:function(){return[]},projectTypesForSearch:function(){if(a.typeDictionary&&a.typeDictionary.typeHierarchy)return a.typeDictionary.typeHierarchy["dsplan:WorkPackage"]},projectTypes:function(){if(a.typeDictionary&&a.typeDictionary.typeHierarchy)return a.typeDictionary.typeHierarchy["dsplan:WorkPackage"]},reset:function(e,t){var n=Array.prototype.slice.call(arguments,0);if(d.isScopeRDF()&&t&&t.parse){var s={};try{s.member=e["dsxplan:hasTask"].member,s["@href"]="/classes/dsplan:Task",s["@id"]="dsplan:Task",s["@mask"]="dsplan:MVMask.Task.CollaborativeTask.Basic",s["@type"]="Collection",s.totalItems=s.member.length,n[0]=s}catch(e){}}this._parent.apply(this,n)},_scopeCollectionAdd:function(t,n,s){var i=e.clone(s||{},!1);i.parse=!1,this.add(t,i)},_scopeCollectionRemove:function(t,n,s){e.clone(s||{},!1).parse=!1,this.remove(t,s)},_scopeCollectionReset:function(e){var t=e.toArray();this.reset(t)},fetch:function(s){var i=this,o={cancel:g,noFetch:!0},r=e.clone(s||{},!1);if(r.dontFetch)return o;if(d.getScopeId()&&!d.isScopeRDF())return this.reset(void 0,r),o;var l={onAdd:this._scopeCollectionAdd,onRemove:this._scopeCollectionRemove,onReset:this._scopeCollectionReset};if(this.stopListening(void 0,l),d.isScopeRDF()&&r.reset||r.skipReset){var c=a.hasLoadedDictionary()?void 0:{newTransaction:!0,onFailure:function(){i.dispatchEvent("onFailToFindScope")},attrs:{forceDslc:!0}},p=d.getObjectData()||r.filterScope;if(p&&p.contextFilter||r.skipReset){var h=[{filter:d.getFilter(),fromCompletionDate:u.getCompletedTaskFilter(),hasWorkContext:d.getScopeId()}];return this.fetchLeafTaskCollection(h,function(e){e.member=e.member||[],i.updateScopeListener(new n(e,{parse:!0}),l)},r)}if(d.isScopeSwym()){h=[{filter:d.getFilter(),fromCompletionDate:u.getCompletedTaskFilter(),communityId:d.getScopeId()}];return this.fetchLeafTaskCollection(h,function(e){e.member=e.member||[],i.updateScopeListener(new n(e,{parse:!0}),l)},r)}var m=a.getObjectForAdding(C.RDFWorkscopeModel,d.getScopeId(),c).getTaskCollectionForFilter(d.getFilter(),c);return i.updateScopeListener(m,l),o}if(r.reset){var T={fromCompletionDate:u.getCompletedTaskFilter()};!1===window.widget.getValue("showProjectTasks")&&(T.standAloneTasks=!0),e.merge(r,{method:"POST",data:JSON.stringify([d.getFilter(),T]),headers:{"Content-Type":"application/json"}})}return r.url?(r.reset=!0,t.prototype.fetch.call(this,r)):(r.onComplete=function(){i._completeModelsInQueue(),s&&s.onComplete&&s.onComplete.apply(this,arguments)},r.onFailure=function(){i._completeModelsInQueue(),s&&s.onFailure&&s.onFailure()},this._parent(r))},fetchLeafTaskCollection:function(t,n,s){let i=e.clone(s||{},!1);return a.request(a.expandUrl(l.GET_FIRST_LEVEL_LEAF_TASKS_URL),{method:"POST",type:"json",data:JSON.stringify(t),headers:{"Content-Type":"application/json"},onComplete:function(){return n.apply(this,arguments),i.onComplete&&i.onComplete.apply(this,arguments)},onFailure:i.onFailure,onTimeout:i.onTimeout})},updateScopeListener:function(e,t){this.listenTo(e,t),this.currentScopeCollection=e,this.reset(e.toArray())},getRelatedObject:function(e,t){var n=new p(a.createPlaceholder(t));return n.fetch({mask:"dsplan:MVMask.Person.Complex"}),n},add:function(e){var t,n=this._parent.apply(this,arguments);if(n){t=n,n instanceof i&&(t=[n]);for(var s=0;s<t.length;s++){var o=t[s];this.stopListening(o,"onChange:"+l.SEQUENCE_ORDER_ATTR),this.listenTo(o,"onChange:"+l.SEQUENCE_ORDER_ATTR,this.sort)}}return e&&this._dispatchModelEvent(t,"onRapidAdd"),n},remove:function(e){var t=this._parent.apply(this,arguments);return e&&this._dispatchModelEvent(e,"onRapidRemove"),t},_dispatchModelEvent:function(e,t){var n=this;e&&e.forEach?e.forEach(function(e){n.dispatchEvent(t,[e])}):e&&this.dispatchEvent(t,[e])}});return C.TasksSplitCollection=h.extend({model:i,_uwaClassName:"RDFTasksSplitCollection",setup:function(){var e=this._parent.apply(this,arguments);return this.listenTo(this._parentCollection,"onTaskCollectionFetchComplete",function(){this.dispatchEvent("onTaskCollectionFetchComplete")}),e},add:function(t){var n=Array.prototype.slice.call(arguments,0);if(e.is(t,"array"))n[0]=t.filter(function(e){return e.isInCurrentScope&&e.isInCurrentScope()});else if(t.isInCurrentScope&&!t.isInCurrentScope())return!1;return this._parent.apply(this,n)},comparator:function(e,t){var n=e.get("dsplan:sequenceOrder"),s=t.get("dsplan:sequenceOrder");if(void 0!==n&&void 0!==s)return n-s;var i=new Date(e.getStartDate()),o=new Date(t.getStartDate());return i.getTime()-o.getTime()}}),C}),define("DS/E6WCommonApps/ReparentingUtils",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/RDFTaskModel"],function(e,t,n){"use strict";var s={checkParentHierarchyForId:function(e){var s,i,o,a,r=t.getBatchGenerator(),l=JSON.stringify([e.parentId,e.childId]);r.ajax(t.expandUrl("/invoke/dsxplan:checkIfChildIsAlreadyInAncestor"),{method:"POST",type:"json",data:l,headers:{"Content-Type":"application/json"},onComplete:function(e){s=e.value||e["@value"]}}),o=e.type===n?"dsplan:MVMask.Task.CollaborativeTask.siblings":"dsplan:MVMask.WorkPackage.Drop";var d=(a=t.getObjectForAdding(e.type,e.childId,void 0)).getParent&&a.getParent();d?i=d.id===e.parentId:a.fetch({mask:o,ajax:r.ajax,onlyIfNeeded:!0,onComplete:function(t){var n=t&&t.getParent();i=Boolean(n&&n.id===e.parentId)}}),r.sendBatch({onComplete:function(){e.onComplete({value:s||i,parentName:d&&d.get("title"),childName:a&&a.get("title")})}})}};return s}),define("DS/E6WCommonApps/Collections/HasConstraintsCollection",["UWA/Core","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/ConstraintModel"],function(e,t,n){"use strict";var s=t.extend({_uwaClassName:"HasConstraintCollection",setup:function(){this._parent.apply(this,arguments),this.setDetailsMask("dsplan:MVMask.Constraint.Complex")},getUri:function(e){return e&&e.forNewObject&&s.computedProperty?"/classes/"+n.CONSTRAINT_RDF_TYPE:this._parent.apply(this,arguments)}});return s.computedProperty=!0,s}),define("DS/E6WCommonApps/Collections/PaginatedTasksCollection",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/RequestUtils","DS/E6WCommonApps/XTaskScope","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/TaskModelMixin","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Collections/RDFTasksCollection","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager"],function(e,t,n,s,i,o,a,r,l,d,c,p,u){"use strict";var h=["dsplan:estimatedEndDate","dsplan:hasPriority","dscom:hasMaturity","dsplan:actualEndDate"],m=["dsplan:estimatedEndDate","dsplan:sequenceOrder"],T={stateForDisplay:"dscom:hasMaturity",priority:"dsplan:hasPriority"};T[d.DUE_DATE_CATEGORY]=d.DUE_DATE_CATEGORY;var g={"To Do":"dsxplan:Open","In Progress":"dsxplan:InProgress",Done:"dsxplan:Done",Low:"dsxplan:Low",Medium:"dsxplan:Medium",High:"dsxplan:High",Urgent:"dsxplan:Urgent"},E={id:"blankModel",isBlank:!0,isNew:function(){return!1},dataForRendering:function(){return{}},calculateAndSetUpListenersForVisualAttributesIfNeeded:Function.prototype,get:Function.prototype},A=l.dateHelper,C=new n,f=t.extend({_uwaClassName:"PaginatedTasksCollection",init:function(e,t){this._parent.apply(this,arguments),this.setup(e,t)},setup:function(e,t){this._view=t.view,this._filterAttr=T[t.view],this._filterAttrNLS=t.attrNLSValue,this.actualValueForFiltering=g[t.attrValue]?g[t.attrValue]:t.attrValue,this._valueForFiltering=t.attrValue,this._filterValue=t.attrValue,this.initialLoad=!0,this.parentModel=t.parentModel,this._models=[],this.loadedRanges=[],this.fetching=null,this.nextFetching=null},url:function(){var e=i.expandUrl("/invoke/dsxplan:getProjectTasks");return e=e.replace("3DPLAN","3drdfindex")},readyToFetch:function(e){return this.hasContextUserBeenSet()||(f._isSettingUserContext||f.loginToRDFIndexVM(),this.listenTo(C,"onLogin",function(){this.fetch(e)})),this.hasContextUserBeenSet()},fetch:function(t){if(this.readyToFetch(t)){var n=e.clone(t||{},!1);n.limit=n.limit||f.LIMIT,n.offset=e.is(n.offset)?n.offset:0,this.fetching&&this.fetching.offset===n.offset&&this.fetching.limit===n.limit||(this.fetching?this.nextFetching=n:(this.fetching=n,n.model=this.parentModel,this.currentFetchRequest=i.request(this.url(),this.buildFetchOptions(n))))}},buildFetchOptions:function(e){var t={id:this.parentModel.id,limit:e.limit,includeCount:e.includeCount,attrs:h,offset:e.offset,sortKeys:m,filterAttrs:[],jsType:e.jsType};this._view===d.DUE_DATE_CATEGORY?t.filterAttrs=t.filterAttrs.concat(this.getDateFilters(this.actualValueForFiltering)):t.filterAttrs.push({name:this._filterAttr,value:this.actualValueForFiltering,comparator:"="}),"priority"!==this._view&&this._view!==d.DUE_DATE_CATEGORY||t.filterAttrs.push({name:"dscom:hasMaturity",value:"dsxplan:Done",comparator:"!="}),this._addOwnerAndAssigneeFilterIfNeeded(t.filterAttrs),this._addJSType(t);var n={method:"POST",type:"json",at:e.offset,data:JSON.stringify(t),fromServer:!0,onComplete:t=>{this.currentFetchRequest=void 0,e.onComplete&&e.onComplete(t)},onFailure:t=>{this.currentFetchRequest=void 0,e.onFailure&&e.onFailure(t)},headers:{"Content-Type":"application/json"}};if(!e.noSet){var s=this;n.onComplete=function(t){this.currentFetchRequest=void 0,s.set(t.items.member,{at:e.offset,totalItems:t.totalItems}),e.onComplete&&e.onComplete()},n.onFailure=(t=>{this.currentFetchRequest=void 0,e.onFailure&&e.onFailure(t)})}return n},_addOwnerAndAssigneeFilterIfNeeded:function(e){var t=a.getFilter();t===a.FILTER_ASSIGNED?e.push({name:"dsplan:hasAssignee",value:u.getContextUserUid(),comparator:"="}):t===a.FILTER_OWNED&&e.push({name:"dskern:owner",value:u.getContextUserUid(),comparator:"="})},_addJSType:function(e){if(e.jsType){for(var t=JSON.parse(e.jsType),n=0;n<t.length;n++)e.filterAttrs.push({name:"dsplan:jsType",value:' "'+t[n]+'" ',comparator:"="});delete e.jsType}},cancelCurrentRequest:function(){this.currentFetchRequest&&this.currentFetchRequest.cancel()},indexOf:function(e){return this._models.indexOf(e)},find:function(e){return this._models.find(e)},add:function(e,t){var n,s;if(s=t&&void 0!==t.position?{position:t.position,blank:!1}:this.findInsertable(e),this.loadedRanges.length>0&&(this.loadedRanges.forEach(function(e){e.start=s.position<=e.start?e.start+1:e.start,e.end=s.position<=e.end?e.end+1:e.end}),n=s.position),n&&0!==n||(n=0,this.updateLoadedRanges({start:0,end:1})),e=s.blank?E:e,this._models.splice(n,0,e),t&&t.replace){var i=this.indexOf(E);-1!==i&&this._models.splice(i,1)}return this.dispatchEvent(f.Events.SizeEvent,[this._models.length]),this.dispatchEvent("onAdd",e),this._listenToModel(e),n},_listenToModel:function(e){function t(e,t){!t&&e&&this.remove(e)}this.listenTo(e,"onAnyEvent",function(e,t,n,s){this.dispatchEvent(e,[t,n,s])}),this.listenTo(e,"onChange:"+d.TASK_PARENT_ATTR,t),this.listenTo(e,"onChange:"+d.PARENT_ATTR,t),this.listenTo(e,"onDestroy",this.remove)},comparator:function(e,t){var n=Date.parse(e.getEndDate()),s=Date.parse(t.getEndDate());return this.actualValueForFiltering===d.STATE_DONE?s-n:n!==s?n-s:e.get(d.SEQUENCE_ORDER_ATTR)-t.get(d.SEQUENCE_ORDER_ATTR)},findInsertable:function(e){var t={position:-1,blank:!0};if(e.isNew())t.position=0,t.blank=!1;else if(this.loadedRanges.length>0)e:for(var n=0;n<this.loadedRanges.length;n++){var s=this.loadedRanges[n],i=this.comparator(e,this.at(s.start))<=0;if(!i&&this.comparator(e,this.at(s.end-1))<=0){t.blank=!1;for(var o=s.start;o<s.end;o++){if(!(this.comparator(e,this.at(o))<=0)){t.position++;break e}t.position=o}}else if(i&&-1===t.position){0===s.start?(t.blank=!1,t.position=0):t.position=s.start-1;break e}}return-1===t.position&&(t.blank=!1,t.position=this._models.length),t},at:function(e){return this._models[e]},getSelection:function(e,t){return this._models.slice(e,t)},contains:function(e){return this._models.includes(e)},reset:function(){var e=this;this._models.forEach(t=>{e.stopListening(t)}),this._models=[],this.loadedRanges=[],this.dispatchEvent(f.Events.SizeEvent,[0])},remove:function(e){var t=this.indexOf(e),n=-1;return this.loadedRanges.forEach(function(e,s){e.start=t<=e.start&&0!==e.start?e.start-1:e.start,e.end=t<=e.end?e.end-1:e.end,e.start===e.end&&(n=s)}),-1!==n&&this.loadedRanges.splice(n,1),-1!==t&&this._models.splice(t,1),this.stopListening(e),this.dispatchEvent(f.Events.SizeEvent,[this._models.length]),this.dispatchEvent("onRemove",[e,this,{index:t}]),e},get:function(){},size:function(){return this._models.length},set:function(e,t){t.totalItems&&0===this._models.length&&(this._models=Array.apply(null,Array(t.totalItems)).map(function(){return E}));for(var n=e.length,s=0;s<n;s++){var o=s+t.at,a=e[s],l=i.getExistingAndMerge(a);l||(l=new r(a,{parse:!0,mask:"dsplan:MVMask.Task.Basic"})),this._models[o]=l,this._listenToModel(l)}this.updateLoadedRanges({start:t.at,end:t.at+n}),this.dispatchEvent(f.Events.ModelsAdded,[t.at,n]),this.fetching=null,this.nextFetching&&(this.fetch(this.nextFetching),this.nextFetching=null)},updateLoadedRanges:function(e){if(e.start!==e.end){var t,n,s=this.loadedRanges.length;for(t=0;t<this.loadedRanges.length;t++)if(n=this.loadedRanges[t],e.start<n.start){s=t;break}this.loadedRanges.splice(s,0,e);for(var i=[],o=1;o<this.loadedRanges.length;){var a=this.loadedRanges[o-1];for(t=o++;t<this.loadedRanges.length;t++){n=this.loadedRanges[t];var r=a.start<=n.start&&a.end>=n.start,l=a.start<=n.end&&a.end>=n.end;r&&l?i.push(n):r?(a.end=n.end,i.push(n)):l&&(e.start=n.start,i.push(n))}this.loadedRanges=this.loadedRanges.filter(function(e){return!i.includes(e)})}}},getMissingDataInRange:function(e,t,n){var s,i;void 0===n&&(n=!1),n?(s=e-t,i=e):(s=e,i=e+t),s=s>0?s:0,i=i<this._models.length?i:this._models.length;for(var o,a,r={},l=0;l<this.loadedRanges.length;l++){var d=this.loadedRanges[l],c=d.start<=s&&d.end>=s,p=d.start<=i&&d.end>=i,u=d.end>i;if(c&&p){r=null;break}if(c){o=d.end;break}if(p){a=d.start;break}if(u)break}return o?r.start=o:a&&(r.end=a),r},dataForRendering:function(){var e={},t={actualValue:this.actualValueForFiltering,displayValue:this._filterAttrNLS};return e.state=t,e.collabSpace=this.collabSpace,e.extid=this.extid,e.filteredByAttr=this._filterAttr,e.filteredByValue={actualValue:this._valueForFiltering,displayValue:this._filterAttrNLS},e.filteredCount=this.size(),e},getSaveAttributes:function(){var e,t={},n=(e=this._filterValue)&&e.actualValue||e;return t[this._view]=n,t},getMask:function(){return"dsplan:MVMask.Task.CollaborativeTasks.Complex"},getDateFilters:function(e){var t,n=[];switch(e){case"PAST_DUE":t={name:"dsplan:estimatedEndDate",value:p.getIntlDateFormat(A.getPast()).actualValue,comparator:"<"},n.push(t);break;case"DUE_TODAY":this.addBetweenDates(n,A.getPast(),A.getToday());break;case"DUE_TOMORROW":this.addBetweenDates(n,A.getToday(),A.getTomorrow());break;case"DUE_THIS_WEEK":this.addBetweenDates(n,A.getTomorrow(),A.getLastDayofThisWeek());break;case"DUE_FUTURE":t={name:"dsplan:estimatedEndDate",value:p.getIntlDateFormat(A.getLastDayofThisWeek()).actualValue,comparator:">"},n.push(t)}return n},addBetweenDates:function(e,t,n){var s={name:"dsplan:estimatedEndDate",value:p.getIntlDateFormat(t).actualValue,comparator:">"},i={name:"dsplan:estimatedEndDate",value:p.getIntlDateFormat(n).actualValue,comparator:"<"};e.push(s),e.push(i)},destroy:function(){this.stopListening()},hasContextUserBeenSet:function(){return f._hasContextUserBeenSet},forEach:function(e){this._models.forEach(t=>{t!==E&&e(t)})}});return f.loginToRDFIndexVM=function(){f._isSettingUserContext=!0,i.request(i.expandUrl("resources/dsplan:Task","v1",{rdfIndex:!0}),{ignoreDictionary:!0,method:"GET",data:{},onComplete:function(){f._isSettingUserContext=void 0,f.setContextUserSet(!0),C.dispatchEvent("onLogin")},onFailure:function(){f._isSettingUserContext=void 0,f.setContextUserSet(!0),C.dispatchEvent("onLogin")}})},f.setContextUserSet=function(e){f._hasContextUserBeenSet=e},Object.defineProperty(f.prototype,"length",{get:function(){return this._models.length}}),f.implement(n,s),f.Events={SizeEvent:"sizeEvent",ModelsAdded:"modelsAdded"},f.ATTRIBUTE_MAP=T,f.LIMIT=300,f.INITIAL=30,f.TASK_ATTRS=h,f.BLANK_MODEL=E,f.SORT_KEYS=m,f.loginListener=C,f}),define("DS/E6WCommonApps/Collections/FTSTaskPseudoCollection",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/ApolloUtils","DS/RDFFoundation/Models/PersonRDFModel","DS/E6WCommonApps/XTaskScope","DS/E6WCommonApps/Models/TaskModelMixin","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Collections/PaginatedTasksCollection","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonUI/TopBarSearchDispatcher","DS/E6WCommonUI/PlatformManager"],function(e,t,n,s,i,o,a,r,l,d,c){"use strict";var p={};p[a.STATE_FOR_DISPLAY_ATTR]="custom_ProjectTasksByMaturity",p[a.PRIORITY_DISPLAY]="custom_ProjectTasksByPriority",p[a.DUE_DATE_CATEGORY]="custom_ProjectTasksByDate",p[a.TASK_TABLE]="custom_ProjectTaskIds";var u={};u[a.STATE_FOR_DISPLAY_ATTR]="state",u[a.PRIORITY_DISPLAY]="priority";var h={[i.FILTER_ASSIGNED]:"assigneeFilter",[i.FILTER_OWNED]:"ownerFilter",[i.FILTER_CANDIDATE_ASSIGNEE]:"candidateAssignee"},m=o.dateHelper,T=r.extend({_uwaClassName:"FTSTaskPseudoCollection",setup:function(e,t){this._parent.apply(this,arguments),this._getAdditionalFetchOptions=t.getAdditionalFetchOptions},url:function(){return n.getServiceUrl()},readyToFetch:()=>!0,buildFetchOptions:function(n){const s=this._getAdditionalFetchOptions?this._getAdditionalFetchOptions():{};let i=T.getCommonParameters(e.merge(s,n));i=i.concat([{key:"limit",value:JSON.stringify(n.limit)},{key:"offset",value:JSON.stringify(n.offset)},{key:"includeCount",value:JSON.stringify(Boolean(n.includeCount))}]),this._view===a.DUE_DATE_CATEGORY?i=i.concat(this.getDateFilters()):this._view!==a.TASK_TABLE&&i.push({key:u[this._view],value:JSON.stringify(t.shortToLongURI(this.actualValueForFiltering))});var o=this;return{data:JSON.stringify({data_query_name:p[this._view],parameters:i}),method:"POST",fromServer:!0,headers:{"Content-Type":"application/json"},onComplete:function(e){try{o.parse(n,e),n.onComplete&&n.onComplete()}catch(e){console.error(e),n.onFailure&&n.onFailure(),T.setWorkingCorrectly(!1)}},onFailure:n.onFailure,onTimeout:n.onTimeout}},parse:function(e,s){var i,o,r=JSON.parse(s),l=r.body.outputs.tasks?r.body.outputs.tasks.views.tasks.data:r.body.outputs.structure.views.structure.data,d=e.includeCount&&r.body.outputs.count?r.body.outputs.count.views.count.data:r.body.outputs.tasks.views.tasks.data.length;this._view===a.TASK_TABLE?i=l.map(e=>({"@id":t.removeBracketLongURI(e),"dsxplan:jsType":"dsplan:Task"})):l?(i=(o=n.parse(l)).models,d-=o.deletedModelsFound):i=[],this.set(i,{at:e.offset,totalItems:d})},getDateFilters:function(){var e=[];switch(this.actualValueForFiltering){case"PAST_DUE":e.push({key:"end",value:JSON.stringify(m.getPast().toISOString())});break;case"DUE_TODAY":this.addBetweenDates(e,m.getPast(),m.getToday());break;case"DUE_TOMORROW":this.addBetweenDates(e,m.getToday(),m.getTomorrow());break;case"DUE_THIS_WEEK":this.addBetweenDates(e,m.getTomorrow(),m.getLastDayofThisWeek());break;case"DUE_FUTURE":e.push({key:"start",value:JSON.stringify(m.getLastDayofThisWeek().toISOString())})}return e},addBetweenDates:function(e,t,n){var s={key:"start",value:JSON.stringify(t.toISOString())},i={key:"end",value:JSON.stringify(n.toISOString())};e.push(s),e.push(i)},hasContextUserBeenSet:function(){return!0},toArray:function(){return[...this._models]}});return T.addOwnerAndAssigneeFilterIfNeeded=function(e){var n,s,o=i.getFilter();if(o in h){var a=h[o];n=e.find(function(e){return e.key===a}),s="candidateAssignee"===a?JSON.stringify(!0):JSON.stringify([t.getCurrentUserName()]),n?n.value=s:e.push({key:a,value:s})}},T.addSearchTermAsParameter=function(e){var t=d.getSearchStringConvertedToRegex();t&&e.push({key:"searchTerm",value:JSON.stringify(t)})},T.getCommonParameters=function(n){var s=c.getTenant().toLowerCase(),i=[{key:"parentID",value:n.model&&JSON.stringify(t.shortToLongURI(n.model.id))},{key:"lang",value:JSON.stringify(c.getCurrentLanguage())},{key:"tenant",value:e.is(s,"string")?s:JSON.stringify("tenant")}],o=l.getCompletedTaskFilter();return""!==o&&o!==l.COMPLETED_TASK_FILTER_ALL_DAYS&&i.push({key:"fromCompletionDate",value:JSON.stringify(o)}),n.tagFilters&&(i=i.concat(n.tagFilters)),n.workContexts&&n.workContexts.length&&(i=i.concat({key:"workContextsFilter",value:JSON.stringify(n.workContexts)})),widget.getValue(a.LEVEL_PREF)===a.FIRST_LEVEL_TASKS&&i.push({key:"firstLevelOnly",value:JSON.stringify(!0)}),T.addSearchTermAsParameter(i),T.addOwnerAndAssigneeFilterIfNeeded(i),i},T._isWorkingCorrectly=!0,T.setWorkingCorrectly=function(e){T._isWorkingCorrectly=e},T.isWorkingCorrectly=function(){return Boolean(T._isWorkingCorrectly)},T}),define("DS/E6WCommonApps/Views/RichTextEditorView",["DS/E6WCommonUI/Views/TextAreaView","UWA/Core","UWA/Element","DS/Handlebars/Handlebars4","text!DS/E6WCommonApps/assets/templates/richtexteditor.html.handlebars","DS/CKEditor/CKEditor","DS/E6WCommonApps/Views/RichTextEditorConfig","DS/RDFFoundation/Models/ComponentProxyModel","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d){"use strict";var c=function(e){return d.get(e)};return e.extend({_uwaClassName:"RichTextEditorView",className:"RTEditor-container details-display-shared-view ddv-field form-group",compiledTemplate:s.compile(i),domEvents:{"click .expandEditor":"toggleMinimizedMaximized"},setup:function(){this._config.title=this.model?this.model.get(this._config.titleAttribute):"",this._parent.apply(this,arguments),this._initializing=!1},enableRefreshView:()=>!1,render:function(){return this.instance||this._parent.apply(this,arguments),this.editorInstanceName="editor_"+this._config.name+"_"+this.cid,this.updateData(),this},_renderEditor:function(e){if(this._initializing=!1,this.container&&!this.editorInitInterval){var t=function(e){this.editorInitialize?this.container&&this.container.getElement(".ck-editor")&&(this.createTextAreaField(),this.destroyEditor(),this.setupEditor(a.getConfig(this._config),e),this.updateEditorData(e),clearInterval(this.editorInitInterval),delete this.editorInitInterval):this.editorInitialize=!0}.bind(this);this.editorInitInterval=window.setInterval(()=>t(e),10)}},createTextAreaField:function(){let e=Math.random().toString(16).slice(2);this._textField=new n("textarea",{id:`editor_${this._config.name}_${this.cid}_${e}`,name:`editor_${this._config.name}_${this.cid}_${e}`}),this._textField.inject(this.container.getElement(".ck-editor")),this.editorInstanceName=`editor_${this._config.name}_${this.cid}_${e}`},updateData:function(){const e=this.model,t=this.container,n=this._config,s=n.richTextField;if(e&&t)try{const t=this.normalizedGet(e,"richTextDescription");s&&t?(!t.fetching&&this.updateEditorData(e.get("richTextDescription")),this.listenTo(e,"onChange:richTextDescription",e=>{this.updateEditorDataIfValid(e,"richTextDescription")}),"richTextDescription"!==s&&this.listenTo(e,`onChange:${s}`,e=>{this.updateEditorDataIfValid(e,s)})):this.updateEditorData(this.normalizedGet(e,n.name))}catch(e){console.log("Panel Closed")}},updateEditorDataIfValid:function(e,t){const n=e.get(t);(n&&!n.fetching||null==n)&&this.updateEditorData(n)},updateEditorData:function(e){const t=this.container.getElement("#"+this.editorInstanceName);if(this.instance&&t){t.value=e&&null!=e?e:"";try{this.instance.getData()!==e&&this.instance.setData&&this.instance.setData(e,{noSnapshot:!0})}catch(e){}}else this._renderEditor(e)},setupEditor:function(e,t){if(this.container&&this.container.getElement("#"+this.editorInstanceName)&&!this.instance&&!this._initializing)try{this._initializing=!0;var n=this;o.addCss("html{cursor:auto;}::-webkit-scrollbar {width: 6px;height: 6px;} ::-webkit-scrollbar-track { background: #f1f1f1;} ::-webkit-scrollbar-thumb {background: #888;border-radius: 0.25em; } ::-webkit-scrollbar-thumb:hover { background: #555; } a { cursor : pointer} "),this.instance=o.replace(this.container.getElement("#"+this.editorInstanceName),e),this.instance&&(this.instance.on("instanceReady",function(e){n._initializing=!1,n._createToolbar(this),n._handleEmoji();try{e.editor.setReadOnly(!(n.normalizedGet(n.model,"canEdit")&&n._config.readWrite))}catch(e){console.log(e)}}),this.instance.on("paste",function(e){var t=e.data.dataValue;try{n.checkForImg(e.data.dataValue)}catch(e){console.log(e)}try{(t=JSON.parse(t)).protocol&&t.data.items&&t.data.items.length>0&&(e.data.imageLoaded||(e.data.dataValue=""))}catch(e){}e.data&&e.data.imageLoaded&&(e.data.dataValue=e.data.imageLoaded)}),this.instance.once("contentDom",function(){var e=n.instance.editable();e.attachListener(n.instance.document,"dragover",function(e){n.handleDragOver(e)}),e.attachListener(n.instance.document,"dragenter",function(e){n.handleDragOver(e)}),e.attachListener(n.instance.document,"drop",function(e){let t=e.data.$.dataTransfer,s=n.container.getElement("#hidden_img"),i=function(t){n.container.getElement("#hidden_img").src=t,e.dataValue='<img src="'+t+'" />',e.imageLoaded='<img src="'+t+'" />',e.type="text",e.method="drop",n.instance.fire("paste",e)};if(-1!==t.types.indexOf("Files")){let n=t.files[0];if(n.type.match("image.*")){if(FileReader){let e=new FileReader;e.onload=(e=>{s.onload=(()=>{l.scaleImage(s,n.name,n.type,i,{maxWidth:1200,maxHeight:1200,maxByteSize:25e4}),s.onload=null}),s.src=e.target.result}),e.onerror=function(){},e.onabort=function(){},e.readAsDataURL(n)}e.data.preventDefault(!0)}}else{var o=t.getData("text/plain");if(o)try{o=JSON.parse(o);const{protocol:e,data:{items:t}}=o;if(e&&t){const e=t[0];if(1===t.length&&e){if(e.displayPreview)s.src=e.displayPreview;else{e.id=r.computeURI(e);var a=r.getNewProxyModel(l.getObjectDataFromDropSearchOrTypeAhead({dropObj:e}));a&&a.indexModel&&n.listenTo(a.indexModel,"onChange",function(){const e=a.get("image");s.src=e,n.createBase64Img(s,i)})}n.createBase64Img(s,i)}}}catch(e){}}n.handleDragLeave(e)}),e.attachListener(n.instance.document,"dragend",function(e){n.handleDragLeave(e)}),e.attachListener(n.instance.document,"dragleave",function(e){n.handleDragLeave(e)}),e.attachListener(e,"click",function(e){var t=new CKEDITOR.dom.elementPath(e.data.getTarget(),this).contains("a");t&&2!==e.data.$.button&&window.open(t.getAttribute("href"),"_blank")},null,null,15)}))}catch(e){this._initializing=!1,this._renderEditor(t),console.log(e)}this.instance&&(this.instance.setActiveFilter(!1),this._registerEvents()),o.on("dialogDefinition",function(e){var t=e.data.name,n=e.data.definition;"link"===t&&n.getContents("info").get("linkType").items.splice(1,1)})},checkForImg:function(e){if(!e)return e;const t=e.match(/<img [^>]*src="[^"]*"[^>]*>/gm);return t&&t.length>0&&t.forEach(e=>{this.container.getElement("#hidden_div").innerHTML=e;const t=this.container.getElement("#hidden_div img");t&&t.src&&this.createBase64Img(t.src,e=>{this.updateEditorImagesToBase64(t.src,e)})}),e},updateEditorImagesToBase64:function(e,t){try{this.instance.setData(this.instance.getData().htmlDecode().replace(e,t))}catch(e){console.log(e)}},_createToolbar:function(e){if(e.ui){var t=e.ui.space("toolbar_collapser");if(t&&t.getPrevious()){var n=t.getPrevious();if(null!=n){n.addClass("iterate_tbx_hidden"),n.isVisible()||n.show(),t.getFirst().setText("◀"),t.addClass("cke_toolbox_collapser_min"),t.setAttribute("title",c("xPlan.Label.Expand.Collapse")),this.switchVisibilityAfter1stRow(n,!1);var s=n.getParent().$.offsetHeight,i=e.ui.space("contents"),o=parseInt(i.$.style.height,10);i.setStyle("height",o-s+"px"),e.fire("resize",{outerHeight:e.container.$.offsetHeight,contentsHeight:i.$.offsetHeight,outerWidth:e.container.$.offsetWidth})}}}return!1},_registerEvents:function(){var e=this;this.instance.on("change",function(){e._checkIfChangeNeeded()&&e.onCKEInputDataEvent()})},convertUrltoBase64:function(e,t){var n=new Image;n.setAttribute("crossorigin","anonymous"),n.onload=function(){t(n)},n.src=e.src?e.src:e},createBase64Img:function(e,t){this.convertUrltoBase64(e,function(e){l.scaleImage(e,null,null,t,{maxWidth:1200,maxHeight:1200,maxByteSize:25e4})})},_checkIfChangeNeeded:function(){return this.instance&&this.normalizedGet(this.model,this._config.name)!==this.instance.getData()},onCKEInputDataEvent:function(){null!==this.container&&this.normalizedSet(this.model,this._config,this.instance.getData())},_postTreatmentTextArea:()=>{},switchVisibilityAfter1stRow:function(e,t){if(void 0!==e)for(var n=!0,s=e.getChildren(),i=s.count(),o=0;o<i;o++){var a=s.getItem(o);(n=n&&!(a.is("span")&&a.hasClass("cke_toolbar_break")))||(t?a.show():a.hide())}},_handleEmoji:function(){var e=this,t=this.instance&&this.instance.editable();t&&t.attachListener(t,"input",function(){e.instance.fire("change")})},handleDragLeave:function(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.container.removeClassName("drag-over")},handleDragOver:function(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.normalizedGet(this.model,"canEdit")&&this._config.readWrite&&this.container.addClassName("drag-over")},destroy:function(){this.destroyEditor(),this._parent.apply(this,arguments)},destroyEditor:function(){var e=this.instance;if(e){switch(e.status){case"destroyed":break;case"ready":case"unloaded":e.removeAllListeners(),e.destroy(),delete e.mode;break;default:e.once("instanceReady",function(){e.removeAllListeners(),e.destroy()})}try{o.remove(this.editorInstanceName)}catch(e){console.log(e)}delete this.instance}},toggleMinimizedMaximized:function(e){if(e.target&&(e.target.hasClassName("fonticon-resize-fullscreen")||e.target.hasClassName("fonticon-resize-fullscreen-off"))){var t=this.container.getElement(".expandEditor > span"),n=t.hasClassName("fonticon-resize-fullscreen");this.instance&&(t.toggleClassName("fonticon-resize-fullscreen-off",n),t.toggleClassName("fonticon-resize-fullscreen",!n),this.instance.execCommand("maximize"),this.container.getElement(".expandEditor").setAttribute("title",t.hasClassName("fonticon-resize-fullscreen")?c("E6WCommonApps.Label.Expand"):c("E6WCommonApps.Label.Collapse")))}},getTextValue:function(){var e=this.instance&&this.instance.getData();return e=e&&e.replace(/^(?=\n)$|^\s*|\s*$|\n\n+/gm,"")},getViewAllHeight:function(){return this._parent()+10},getDesiredHeight:function(){return this._parent()+10},getFocusDesiredHeight:function(){return this._parent()+10}})}),define("DS/E6WCommonApps/Models/ScheduleElementCloneModel",["DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/CSRFUtil","DS/E6WCommonUI/PlatformManager","DS/RDFFoundation/MemberUtils","DS/RDFFoundation/Models/CloneModelForRepository","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r){"use strict";var l=r.get.bind(r);return o.extend({i18n:l,buildBatchWithPreprocessedObjects:function(){var t=this._parent.apply(this,arguments);return(this.localRelatedData.toConstraints||this.localRelatedData.fromConstraints)&&(t=t||e.getBatchGenerator(),this._processAddedConstraints(t),this._processRemovedConstraints(t)),delete this.localRelatedData.toConstraints,delete this.localRelatedData.fromConstraints,t},getIsActualDatesChanged:function(){return this.localAttributes.hasOwnProperty(a.ACTUAL_START_DATE)||this.localAttributes.hasOwnProperty(a.ACTUAL_END_DATE)},checkAndSetCSRF:function(e,t){n.checkAndSetCSRF(e,t)},_processAddedConstraints:function(e){var n=this,s=function(e){return"add"===e.operation},i=function(s,i){s.updateBackpointers({silent:!0}),s.updateParentWorkscopes(),s.save(void 0,{ajax:e.ajax,onComplete:function(){t.displaySuccess(n.i18n("E6WCommonApps.Label.SuccessfulSave"))},onFailure:function(e,t){n._onConstraintFailure(i,t.message,s),s.destroy({noServer:!0})}})};this.localRelatedData.toConstraints&&this.localRelatedData.toConstraints.filter(s).forEach(function(e){i(e.value,"toConstraints")}),this.localRelatedData.fromConstraints&&this.localRelatedData.fromConstraints.filter(s).forEach(function(e){i(e.value,"fromConstraints")})},_processRemovedConstraints:function(e){var n=this;this.localRelatedData.toConstraints&&this.localRelatedData.toConstraints.forEach(function(s){"remove"===s.operation&&n.model.removeObject("toConstraints",s.value,{silentOnChange:!0,ajax:e.ajax,onComplete:function(){t.displaySuccess(n.i18n("E6WCommonApps.Label.SuccessfulSave"))},onFailure:n._onConstraintFailure.bind(n,"toConstraints","E6WCommonApps.Error.ConstraintNotRemoved")})}),this.localRelatedData.fromConstraints&&this.localRelatedData.fromConstraints.forEach(function(t){"remove"===t.operation&&n.model.removeObject("fromConstraints",t.value,{silentOnChange:!0,ajax:e.ajax,onFailure:n._onConstraintFailure.bind(n,"fromConstraints","E6WCommonApps.Error.ConstraintNotRemoved")})})},_onConstraintFailure:function(e,n,s){var i,o=("toConstraints"===e?s.getPredecessor():s.getSuccessor()).get("dsxplan:label");"E6WCommonApps.Error.ConstraintNotCreated"!==n&&"E6WCommonApps.Error.ConstraintNotRemoved"!==n||(i=r.replace(r.get(n),{OBJECT_NAME:o}),t.displayError(i)),this._fireRelationshipChangeEvents(e,{})},getModelForAssigneeTypeahead:function(){return this},assignToSelf:function(e){this.add(e.config.name,i.addUUIDToURI(s.getContextUserUid()),e)}})}),define("DS/E6WCommonApps/Collections/RDFLeafTasksCollection",["UWA/Core","DS/E6WCommonApps/Collections/RDFTasksCollection","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/SmartSchedulerUtils"],function(e,t,n,s,i){"use strict";return t.extend({_uwaClassName:"RDFLeafTasksCollection",setup:function(t,n){var s=e.clone(n||{},!1);s["@mask"]="dsplan:MVMask.Task.CollaborativeTask.Basic",s.detailsMask="dsplan:MVMask.Task.Complex",s["@href"]="invoke/dsxplan:getFirstLevelLeafTasks",this.ownerFilter=s.ownerFilter,this.trackNextFetch=s.trackNextFetch,this._parent(t,s)},_trackFetch:function(e){var t=Date.now()-e;s.trackPageEvent({eventCategory:"taskView",eventAction:"Open",eventLabel:"loadTasks",eventValue:t,persDim:{pd2:this.ownerFilter},persVal:{pv4:t}})},fetch:function(t){var s=this,o=e.clone(t||{},!1),a=i.getCompletedTaskFilter(),r=[{versionURI:this.parentModel.id,openTask:o.taskIdToOpen?o.taskIdToOpen:null,filter:this.ownerFilter,fromCompletionDate:a}],l=Date.now();return o.data=JSON.stringify(r),this.reset(),o.onComplete=function(){function e(e,t){!t&&e&&s.remove(e)}s.forEach(t=>{s.listenTo(t,"onChange:"+n.TASK_PARENT_ATTR,e),s.listenTo(t,"onChange:"+n.PARENT_ATTR,e)}),s.cacheCollection(),s.dispatchEvent("onTaskCollectionFetchComplete"),t&&t.onComplete&&t.onComplete.apply(s,arguments),s.trackNextFetch&&(s._trackFetch(l),delete s.trackNextFetch)},this._parent(o)}})}),define("DS/E6WCommonApps/Models/WorkscopeModel",["UWA/Core","UWA/Class/Collection","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Collections/ResultCollection","DS/RDFFoundation/Collections/UserCollection","DS/E6WCommonApps/Collections/ChecklistItemCollection","DS/RDFFoundation/ProjectTypeUtils","DS/E6WCommonApps/Collections/ProjectTeamCollection","DS/E6WCommonApps/Collections/MemberResponsibilityCollection","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/ScheduleConstants","DS/E6WCommonApps/Models/ScheduleElementModel","DS/E6WCommonApps/Collections/ConstraintsPseudoCollection","DS/E6WCommonApps/Models/ConstraintModel","DS/E6WCommonApps/Collections/RDFTasksCollection","DS/E6WCommonApps/Collections/HasConstraintsCollection","DS/E6WCommonApps/Models/SolverModelMixin","DS/E6WCommonApps/Models/CalendarModel","DS/E6WCommonApps/Models/AccessModel","DS/E6WCommonApps/Models/FileManagementMixin","DS/E6WCommonApps/Models/MilestoneModel","DS/E6WCommonApps/Models/GateModel","DS/E6WCommonApps/Models/AddTaskMixin","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Models/TeamMemberResponsibilityModel","DS/E6WCommonApps/Models/ChecklistParentModelMixin","DS/E6WCommonApps/ReparentingUtils","DS/E6WCommonApps/Collections/RDFLeafTasksCollection","DS/E6WCommonApps/E6WNonWorkingDayIterator","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/Models/DropValidator","DS/E6WCommonUI/PlatformManager","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,g,E,A,C,f,_,D,S,R,v,y,b,M,I,O,P,k,N){"use strict";var F=function(e){var t=N.get(e);return t===e&&(t=k.get(e)),t},W=c.CONSTRAINT_RELATION_ATTR,w=c.RESTRICT_ASSIGNEE_ATTR,L=c.RESTRICT_ASSIGNEE_ATTR_SERVER,U={"dsplan:schedulingStrategy":!0,"dsxplan:schedulingStrategy":!0,"dsplan:schedulingFromStrategy":!0,"dsplan:startDateIntervalMin":!0,"dsxplan:startDateIntervalMin":!0,"dsplan:endDateIntervalMax":!0,"dsxplan:endDateIntervalMax":!0,"dsxplan:usesCalendar":!0,"dsxplan:scheduleCalendar":!0};var x={all:{attribute:"dsxplan:hasLeafTasks",parentMask:"dsplan:MVMask.WorkPackage.Complex"},owned:{attribute:"dsplan:ownedTasks",parentMask:"dsplan:MVMask.WorkPackage.CollaborativeTasks.owned"},assigned:{attribute:"dsplan:assignedTasks",parentMask:"dsplan:MVMask.WorkPackage.CollaborativeTasks.assigned"},assignedToMyGroups:{attribute:"dsplan:assignedToMyGroupTasks"},candidateAssignee:{attribute:"dsxplan:candidateAssigneeTasks"}},V=A.extend({TASK_RELATION_ATTR:"dsplan:hasTask",liveUpdateCreateMask:"dsplan:MVMask.WorkPackage.Collapsed",dslcMapping:c.dslcMapping,_propertyDictionary:{team_members:{volatility:!0},ownerResponsibilityModel:{volatility:!0},assigneeResponsibilityModels:{volatility:!0},thumbnail:{volatility:!0},solveCounter:{volatility:!0},"dsxplan:hasConstraint":{volatility:!0},"dsplan:hasConstraint":{volatility:!0},"dsxplan:workDecompositionParent":{inverseProperty:"dsxplan:hasWorkDecomposition",inversePropertyIsCollection:!0},"dsxplan:hasWorkDecomposition":{inverseProperty:c.WORKSCOPE_PARENT_ATTR},"dsxplan:hasReferenceProject":{inverseProperty:c.PARENT_REFERENCE_PROJECT_ATTR,inversePropertyIsCollection:!0},"dsxplan:parentReferenceProject":{inverseProperty:c.REFERENCE_PROJECT_ATTR,inversePropertyIsCollection:!0,volatility:!0},"dsxplan:hasTask":{inverseProperty:"dsxplan:workscopeParent"},"dsplan:hasBacklogTask":{inverseProperty:"dsxplan:backlogParent",volatility:!0},"dsplan:hasRolledUpInfo":{inverseProperty:"dsplan:isRolledUpInfoFor"},"dsplan:hasParent":{volatility:!0},explicitTagsData:{volatility:!0},_xplanSubscribed:{volatility:!0},"dsplan:accessedDate":{volatility:!0},"dsplan:isFavorite":{volatility:!0},"dsxplan:hasWorkContext":{inverseProperty:"dsxplan:hasContributingElements",inversePropertyIsCollection:!0},"dsplan:hasChecklistItem":{inverseProperty:c.CHECKLIST_PARENT_ATTR}},_relations:[{key:c.CHILDREN_ATTR},{key:"dsxplan:hasWorkDecomposition"},{key:c.PARENT_REFERENCE_PROJECT_ATTR},{key:c.REFERENCE_PROJECT_ATTR},{key:"dsplan:hasTask",relatedCollection:m},{key:"dsxplan:hasLeafTasks",relatedCollection:b,volatility:!0},{key:"dsxplan:hasAttachment",relatedCollection:s},{key:"dsxplan:hasWorkContext",relatedCollection:s},{key:"dsxplan:actualDeliverable",relatedCollection:s},{key:"dsplan:assignedToMyGroupTasks",relatedCollection:b},{key:"dsxplan:candidateAssigneeTasks",relatedCollection:b},{key:"dsxplan:hasTask",relatedCollection:m},{key:"dsxplan:hasBacklogTask",relatedCollection:m},{key:"dsplan:assignedTasks",relatedCollection:b},{key:"dsplan:ownedTasks",relatedCollection:b},{key:W,relatedCollection:T},{key:"dsxplan:hasConstraint",relatedCollection:T},{key:"dsxplan:hasMilestone",relatedCollection:s},{key:"dsxplan:hasGate",relatedCollection:s},{key:"dsxplan:hasAssignee",relatedCollection:i},{key:"dsxplan:hasBaseline",relatedCollection:s},{key:"dsplan:hasChecklistItem",relatedCollection:o}],_uwaClassName:"WorkscopeModel",parentMask:"dsplan:MVMask.WorkPackage.Complex",mask:"dsplan:MVMask.WorkPackage.Basic",writeMask:"dsplan:MVMask.WorkPackage.Complex",init:function(t,n){const s=e.clone(t||{},!1);s["dsplan:jsType"]=s["dsplan:jsType"]||s["dsxplan:jsType"]||"dsplan:Project",this._parent(s,n)},syncWithDPMIfNeeded:function(){n.request(n.expandUrl("invoke/dsplan:syncWithDPMIfNeeded"),{method:"POST",type:"json",data:JSON.stringify([this.compactJson()]),headers:{"Content-Type":"application/json"},onComplete:()=>{this.dispatchEvent("onSyncWithDPMObjects")}})},isFavorite:function(){return this.get("dsplan:isFavorite")},_getImage:function(e){return e||(e=this.getDefaultImage()),e&&-1===e.indexOf("http://")&&-1===e.indexOf("https://")&&-1===e.indexOf("E6WCommonApps")?require.toUrl("E6WCommonApps/assets/img/"+e):e},getAllWorkContexts:function(){var e=[];return this.getCollectionAttribute("dsxplan:hasBacklogTask").forEach(t=>{var n=t.get("dsxplan:hasWorkContext");n&&e.push(n)}),this.getCollectionAttribute("dsxplan:hasWorkDecomposition").forEach(t=>{t.get("dsxplan:hasTask").forEach(t=>{var n=t.get("dsxplan:hasWorkContext");n&&e.push(n)})}),e},getIconURL:function(){return this.getDefaultImage()},getDefaultImage:function(t){let n=e.clone(t||{},!1);return n.isTemplate=this.get("dsplan:isTemplate"),a.getDefaultProjectImage(this.get(c.PROJECT_TYPE),n)},solve:function(t){var n=e.clone(t||{},!1);return n.listName="ProjectList",p.prototype.solve.call(this,n)},sync:function(t,n,s){var i=e.clone(s||{},!1);if("update"===t&&(i.solve||(i.solve=this.shouldWeSolve(i)),i.solve)){var o=this;i.onComplete=function(){var t=s&&e.is(s.onComplete,"function")&&s.onComplete.apply(this,arguments);return o.solve(),t};var a=Array.prototype.slice.call(arguments,0);return a[2]=i,this._parent.apply(this,a)}return this._parent.apply(this,arguments)},syncCreate:function(e,t){var n=Array.prototype.slice.call(arguments,0),s=n[1],i=this;i.beingCreatedOnServer=!0;var o=t.onFailure,a=t.onComplete,r=t.onTimeout;s.onComplete=function(){i.beingCreatedOnServer=!1,a&&a.apply(this,arguments)},s.onFailure=function(e,t,n){i.beingCreatedOnServer=!1,n&&(n.response=t),o&&o.apply(this,arguments)},s.onTimeout=function(e,t,n){i.beingCreatedOnServer=!1,n&&(n.response=t),r&&r.apply(this,arguments)},this._parent.apply(this,n)},shouldWeSolve:function(e){var t;if(this.getChangedAttributesSinceLastSave().some(this.isAttributeImpactingSolve.bind(this))||e.assumeChanges){for(t=this.getParent();t;t=t.getParent()){if(t.autosolve===c.AUTOSOLVE_OFF)return p.dispatcher.dispatchEvent("solveNeeded",[this]),!1;if(t.autosolve===c.AUTOSOLVE_ON)return!0}if(!t){if(this.autosolve===c.AUTOSOLVE_OFF)return p.dispatcher.dispatchEvent("solveNeeded",[this]),!1;if(this.autosolve===c.AUTOSOLVE_ON)return!0}return!0}return!1},_registerAsElementParent:function(e,t){var n=this.id;"dsplan:hasBacklogTask"!==t&&"dsxplan:hasBacklogTask"!==t?(e.parentId=n||this.cid,e.parentConstructor=this.constructor,e instanceof V&&n&&e.set(c.WORKSCOPE_PARENT_ATTR,this,{dontRegisterChange:!0})):e.set("dsxplan:backlogParent",this,{dontRegisterChange:!0})},onAtIdChange:function(){this._parent.apply(this,arguments),this.getCollectionAttribute(c.CHILDREN_ATTR).forEach(this._registerAsElementParent,this),this.getTasks().forEach(this._registerAsElementParent,this),this.getMilestones().forEach(this._registerAsElementParent,this),this.getGates().forEach(this._registerAsElementParent,this)},updateThumbnailImage:function(e){var t=e||this.get("dsplan:hasThumbnail");this.thumbnail=t},hasParent:function(){return Boolean(this.get(c.HAS_PARENT_ATTR))},setup:function(){this._beingCreatedOnServer=!1,this._listenToModel(),this._listenToChildrenCollections(),this._registerAsParentOfAllChildrenModels(),this._parent.apply(this,arguments),this.updateThumbnailImage(),this.isNew()&&(this.mask="dsplan:MVMask.WorkPackage.Complex"),this.getCollectionAttribute(c.CONSTRAINT_RELATION_ATTR,void 0,{}),this.getAttachments(),this.getDeliverables(),this.getBaselines(),this.getBacklogTasks(),this.getChecklist(),this.workscopeId="WorkscopeModel"+parseInt(1e4*Math.random())},getChecklist:function(){return this.getCollectionAttribute(c.HAS_CHECKLIST_ATTR,{"@mask":this.getPropertyMask()})},getNonWorkingDayIterator:function(){return this.nonWorkingDayIterator?this.nonWorkingDayIterator:(this.nonWorkingDayIterator=new M({rootProject:{id:this.id},loadCalendar:!0}),this.nonWorkingDayIterator)},_listenToModel:function(){var e={"onChange:title":function(){this.dispatchEvent("onChange:name",arguments)}};e["onChange:"+c.WORKSCOPE_PARENT_ATTR]=function(e,t){this===e?t||(this.parentId=void 0,this.parentConstructor=void 0):console.error("invalid onChange parent to be checked")},e["onChange:dsplan:hasThumbnail"]=(()=>this.updateThumbnailImage()),e.onSync=function(){this._setAndSaveSequenceOrders(this.getTasks()),this._setAndSaveSequenceOrders(this.getWorkscopes())},e["onChange:"+c.WORK_CONTEXT_ATTR]=this._onContextChanged,e["onChange:"+c.OWNER_ATTR]=this.setOwnerResponsibilityModel,e["onChange:"+c.ASSIGNEE_ATTR]=this.setAssigneeResponsibilityModel,e["onChange:"+c.TEAM_MEMBERS]=function(){this.setOwnerResponsibilityModel(),this.setAssigneeResponsibilityModel()},this.listenTo(this,e)},_onContextRemoved:function(e){var t;(t=e&&e instanceof V?e:e["@id"]&&n.getObjectById(e["@id"]))&&t instanceof V&&(this.stopListening(t.getMilestones()),t.getMilestones().forEach(e=>{e.removeShadowParent(this)}),this.stopListening(t.getGates()),t.getGates().forEach(e=>{e.removeShadowParent(this)}))},_onContextAdded:function(e){e&&e instanceof V&&(e.getMilestones().forEach(e=>{e.addShadowParent(this)}),this.listenTo(e.getMilestones(),{onAdd:e=>{e.addShadowParent(this)},onRemove:e=>{e.removeShadowParent(this)}}),e.getGates().forEach(e=>{e.addShadowParent(this)}),this.listenTo(e.getGates(),{onAdd:e=>{e.addShadowParent(this)},onRemove:e=>{e.removeShadowParent(this)}}))},_onContextChanged:function(){let e=this.previousAttributes()[c.WORK_CONTEXT_ATTR];e&&("Collection"===e["@type"]||e.values)&&(e=e.member||e.values),e&&e.forEach(e=>this._onContextRemoved(e));let t=this.get(c.WORK_CONTEXT_ATTR);t&&("Collection"===t["@type"]||t.values)&&(t=t.member||t.values),t&&t.forEach(e=>this._onContextAdded(e))},_listenToChildrenCollections:function(){for(var e=[this.getWorkscopes(),this.getTasks(),this.getMilestones(),this.getGates()],t=0;t<e.length;t++){var n=e[t];this.listenTo(n,{onAdd:this._registerAsElementParent,onReset:this._registerAsParentOfEachElement})}this.listenTo(this.getTasks(),"onSync",function(){this._setAndSaveSequenceOrders(this.getTasks())}),this.listenTo(this.getWorkscopes(),"onSync",function(){this._setAndSaveSequenceOrders(this.getWorkscopes())}),this.listenTo(this.get(c.WORK_CONTEXT_ATTR),{onAdd:e=>this._onContextAdded(e),onRemove:e=>this._onContextRemoved(e)})},_registerAsParentOfEachElement:function(e){e.forEach(this._registerAsElementParent,this)},_registerAsParentOfAllChildrenModels:function(){this.getWorkscopes().forEach(this._registerAsElementParent,this),this.getTasks().forEach(this._registerAsElementParent,this),this.getMilestones().forEach(this._registerAsElementParent,this),this.getGates().forEach(this._registerAsElementParent,this)},getParent:function(){return n.getObjectById(this.parentId)||this.get(c.WORKSCOPE_PARENT_ATTR)},getTimezone:function(){return this.get("dsxplan:usesCalendar")},getObjectTypeLabel:function(e){return e===c.PROGRAM_RDF_TYPE||"dsxplan:Program"===e||"dsxplan:ProgramVersion"===e?c.PROGRAM:e===c.PROJECT_RDF_TYPE?c.PROJECT:e===c.XPROJECT_RDF_TYPE?c.XPROJECT:e===c.WORKPACKAGE_RDF_TYPE||"dsxplan:WorkPackage"===e||"dsxplan:WorkPackageVersion"===e?c.WORKPACKAGE:c.OBJECT},getObjectType:function(){var e=this.get("dsxplan:jsType")||this.get("dsxplan:actualType")||this.get(c.ACTUAL_TYPE_ATTR)||this.get(c.TYPE_ATTR);if(e){var t=e.id||e;return this.getObjectTypeLabel(t)}return c.OBJECT},getProjectTypeNLS:function(){var e=this.get(c.PROJECT_TYPE);if(e){if(e===c.PROJECT_RDF_TYPE)return k.get("E6WCommonApps.Type.TeamProject");if(e===c.XPROJECT_RDF_TYPE)return k.get("E6WCommonApps.Type.EnterpriseProject")}},get:function(e){var t=this._parent.apply(this,arguments);switch(e){case c.SHOW_SCHEDULE_HIGHLIGHTS:return this.isAgile()||this.isXProject();case"image":var n=this.get("dsplan:hasThumbnail");return n||this._getImage(this._parent.apply(this,arguments));case c.IMAGE_TILE_ATTR:return this.get("dsplan:hasThumbnail")||this.getDefaultImage({imageType:c.IMAGE_TILE_ATTR});case c.IMAGE_THUMBNAIL_ATTR:return this.get("dsplan:hasThumbnail")||this.getDefaultImage({imageType:c.IMAGE_THUMBNAIL_ATTR});case"type":return this.getObjectType();case"name":return this._parent("title");case"description":return this.get(c.DESCRIPTION_ATTR);case"ds6w:type":return this.get(c.PROJECT_TYPE);case"dsplan:actualDatesStrategy":return t||(t=c.CURRENT_DATES_STRATEGY),t;case c.SCHEDULING_FROM_STRATEGY_ATTR:return t||(t=c.CURRENTDATE_SCHEDULINGFROM_STRATEGY),t;case c.WORKSCOPE_PARENT_ATTR:return!t&&this.hasParent()&&(t=new S),t;case"rollupStart":return this.getStartDate();case"rollupEnd":return this.getEndDate();case"dsplan:accumulatedStoryPoints":return this.getAccumulatedStoryPoints();case c.WORK_CONTEXT_ATTR:return t||this.addNewCollectionData(e);default:return t}},getTeamMembers:function(){var e=this.get("team_members");return e||(e=new r(void 0,{workscope:this,"@mask":"dsplan:MVMask.WorkPackage.Property"}),this.setCollection("team_members",e)),e},setOwnerResponsibilityModel:function(){var e=this.get("team_members");if(e){let t=e.getResponsibilityModelForMember(this.get(c.OWNER_ATTR));t&&(t.set("isOwner",!0),this.set(c.OWNER_RESPONSIBILITY_ATTR,t))}},setAssigneeResponsibilityModel:function(){var e=this.get("team_members");if(e){let t=this.get(c.ASSIGNEE_ATTR).map(function(t){let n=e.getResponsibilityModelForMember(t);return n||(n=new R({memberPersonModel:t,assignedPersonModel:t,allResponsibilitiesArray:[]})),n}),n=new l;t.forEach(function(e){e.set("isAssignee",!0)}),n.add(t),this.setCollection(c.ASSIGNEE_RESPONSIBILITIES_ATTR,n),this.dispatchEvent("onChange:"+c.ASSIGNEE_RESPONSIBILITIES_ATTR)}},dataForRendering:function(t){var n,s=e.clone(t||{},!1);if(s.attributes){n=Object.create(null);for(var i=s.attributes,o=i.length,a=0;a<o;a++){var r=i[a];n[r]=!0}s.attributes=i}var l=!n,d=this._parent.apply(this,arguments),p=this;return d.autosolve=this.autosolve!==c.AUTOSOLVE_OFF,d.name=this.get(c.DSLC_TITLE_ATTR),d.image=this.get("dsplan:hasThumbnail")||this.get("image"),d.physicalId=this.get("physicalId"),this.get(c.OWNER_RESPONSIBILITY_ATTR)&&(d.ownerResponsibilityModel=this.get(c.OWNER_RESPONSIBILITY_ATTR).toJSON()),this.get(c.ASSIGNEE_RESPONSIBILITIES_ATTR)&&(d.assigneeResponsibilityModels=this.get(c.ASSIGNEE_RESPONSIBILITIES_ATTR).map(function(e){return e.toJSON()})),function(s){if(l||n[s]){var i=p.get(s);i&&(e.is(i.dataForRendering,"function")&&(i=i.dataForRendering(t)),d[s]=i)}}(this.get(c.WORKSCOPE_PARENT_ATTR)),d},toJSON:function(){let e=this._parent.apply(this,arguments);return e.isFavorite=e["dsplan:isFavorite"],e},getWorkscopes:function(){return this.getCollectionAttribute(c.CHILDREN_ATTR)},getReferenceWorkscopes:function(){return this.getCollectionAttribute(c.REFERENCE_PROJECT_ATTR)},getConstraints:function(){return this._allConstraints=this._allConstraints||new u(this),this._allConstraints},getPropertyMask:function(){return"dsplan:MVMask.WorkPackage.Property"},fetchForProperty:function(t){let s=e.clone(t||{},!1);var i=this,o={};E.haveCalendarsBeenFetched()||(o=s.batchBuilder||n.getBatchGenerator(),E.fetchCalendars({ajax:o.ajax}));var a={mask:this.getPropertyMask&&this.getPropertyMask(),dontUpdateMask:!0,ajax:o.ajax,onlyIfNeeded:!0};this.getTeamMembers().fetch({ajax:o.ajax,onComplete:function(){i.setOwnerResponsibilityModel(),i.setAssigneeResponsibilityModel()}}),this.fetch(a),E.haveCalendarsBeenFetched()||o.sendBatch()},destroy:function(){this.getWorkscopes().reset([],{silent:!1}),this._parent.apply(this,arguments)},getMilestoneTypes:function(){return this._getTypes(c.MILESTONE_VOCABULARY_ATTR)},getTaskTypes:function(){return this._getTypes(c.TASK_VOCABULARY_ATTR)},getDSLCTaskTypes:function(){return this._getTypes("dsxplan:hasTaskVocabulary")},getDSLCMilestoneTypes:function(){return this._getTypes("dsxplan:hasMilestoneVocabulary")},_getTypes:function(e){var t=[],n=this,s=function(){for(var t=n.get(e);!t&&n&&n.hasViewAccess();)(n=n.getParent())&&(t=n.get(e));return t}();if(s){var i=s.get("dsplan:vocabularyTerms");if(i)for(var o=0;o<i.length;o++){var a=i.at(o),r="E6WCommonApps.Type."+a.id.substring(a.id.indexOf(":")+1);t.push({actualValue:a.id,displayValue:F(r)})}}return t},createChildWorkscope:function(t,n){var s=this._getDefaultChildWorkscopeAttributes();e.extend(s,t);var i=this._getChildWorkscopeType(s[c.TYPE_ATTR]),o=c.CHILDREN_ATTR.replace("dsplan","dsxplan");s[c.TYPE_ATTR]=i;var a=e.clone(n||{},!1);a._defaultModel=V;var r=this.addModelToAttributeWithCollection(o,s,a);return this._registerAsElementParent(r),r},_getChildWorkscopeType:function(e){return e||(e="Program"===this.getObjectType()?c.PROJECT_RDF_TYPE:c.WORKPACKAGE_RDF_TYPE),e},getStartAndFinishDates:function(){var e={},t=function(t){isNaN(t.start)||e.start&&!(t.start<e.start)||(e.start=t.start),isNaN(t.end)||e.finish&&!(t.end>e.finish)||(e.finish=t.end)};this.getMilestones().forEach(function(e){var n=new Date(e.getStartDate());t({start:n,end:n})}),this.getGates().forEach(function(e){var n=new Date(e.getStartDate());t({start:n,end:n})});var n=this.getRollupDates();return n&&t(n),e},getRollupDates:function(){var e=this.get("dsxplan:hasRolledUpInfo");if(e)return{start:e.get("dsxplan:estimatedStartDate")&&new Date(e.get("dsxplan:estimatedStartDate")),end:e.get("dsxplan:estimatedEndDate")&&new Date(e.get("dsxplan:estimatedEndDate"))}},isAttributeImpactingSolve:function(e){return U[e]},getAssignees:function(){return this.getCollectionAttribute(c.ASSIGNEE_ATTR,{detailsMask:"dsplan:MVMask.Person.Complex"})},save:function(){var t=I.setHelper.apply(this,arguments),n=t.attrs||{};n=this.handleRestrictAssigneeAccess(n);var s=t.options,i=e.clone(s||{},!1),o=this.getCombinedAttributes(n);if(i.onComplete=this._getCallbackThatWillFetchTeamMembersOnCompleteIfNeeded(o,s),!i.forceSequenceOrder&&this._hasNewWorkscopeParentAttributeWithoutNewSequenceOrderAttribute(o)){var a=this._calculateNewSequenceOrderFromParentThenSave(n,s);if(a)return a}return this._parent(n,i)},restore:function(e){n.request(n.expandUrl("/invoke/dsxplan:restore"),{method:"POST",type:"json",data:JSON.stringify([this.id]),headers:{"Content-Type":"application/json"},onComplete:e&&e.onComplete,onFailure:e&&e.onFailure,onTimeout:e&&e.onTimeout})},_hasNewWorkscopeParentAttributeWithoutNewSequenceOrderAttribute:function(e){var t=-1!==e.indexOf(c.WORKSCOPE_PARENT_ATTR),n=this.isDSLC()?this.dslcMapping[c.SEQUENCE_ORDER_ATTR]:c.SEQUENCE_ORDER_ATTR,s=-1!==e.indexOf(n);return t&&!s},_calculateNewSequenceOrderFromParentThenSave:function(t,n){var s=t[c.WORKSCOPE_PARENT_ATTR]||this.get(c.WORKSCOPE_PARENT_ATTR),i=this;return s&&s.fetch({onlyIfNeeded:!0,mask:"dsplan:MVMask.WorkPackage.Collapsed",onComplete:function(){var o=e.clone(t||{},!1),a=e.clone(n||{},!1);o[i.isDSLC()?i.dslcMapping[c.SEQUENCE_ORDER_ATTR]:c.SEQUENCE_ORDER_ATTR]=s.getWorkscopes().getTotalRecords()+Math.random(),delete a.ajax,i.save(o,a)}})},_getCallbackThatWillFetchTeamMembersOnCompleteIfNeeded:function(e,t){var n=t&&t.onComplete;if(e.some(function(e){return c.dslcMapping[c.ASSIGNEE_ATTR]===e})){var s=this;n=function(){var e=s.get("team_members");e&&e.fetch(),t&&t.onComplete&&t.onComplete.apply(this,arguments)}}return n},getMilestoneById:function(e){var t;return this.getMilestones().some(function(n){return n.id===e&&(t=n,!0)}),t},getMilestones:function(){return this.getCollectionAttribute("dsplan:hasMilestone",{"@mask":"dsplan:MVMask.WorkPackage.MilestonesOnly"})},getGates:function(){return this.getCollectionAttribute("dsplan:hasGate",{"@mask":"dsplan:MVMask.WorkPackage.MilestonesOnly"})},getShadowMilestones:function(){const t=this.get(c.WORK_CONTEXT_ATTR),n=t&&t.first();return n&&n.getMilestones?n.getMilestones():new e.Class.Collection},getShadowGates:function(){const t=this.get(c.WORK_CONTEXT_ATTR),n=t&&t.first();return n&&n.getGates?n.getGates():new e.Class.Collection},getTaskById:function(e){return this.getTasks().get(e)},getTasks:function(){return this.getCollectionAttribute("dsplan:hasTask",{"@mask":"dsplan:MVMask.WorkPackage.CollaborativeTasks.all",detailsMask:"dsplan:MVMask.Task.Complex"})},getBacklogTasks:function(){return this.getCollectionAttribute("dsplan:hasBacklogTask",{"@mask":"dsplan:MVMask.Project.BacklogTasks",detailsMask:"dsplan:MVMask.Task.Complex"})},getAttachments:function(){return this.getCollectionAttribute(c.ATTACHMENT_ATTR,{"@mask":"dsplan:MVMask.WorkPackage.Property"})},getDeliverables:function(){return this.getCollectionAttribute(c.ACTUAL_DELIVERABLE_ATTR,{"@mask":"dsplan:MVMask.WorkPackage.Property"})},getBaselines:function(){return this.getCollectionAttribute("dsxplan:hasBaseline",{"@mask":"dsplan:MVMask.WorkPackage.Baselines"})},getBaselinesForComboBox:function(){return this.getBaselines().toArray().map(e=>({label:e.get("dsxplan:label"),icon:"stop",value:e.id}))},getTaskCollectionForFilter:function(t,n){var s=e.clone(n||{},!1),i=x[t];return this.getCollectionAttribute(i.attribute,{ownerFilter:t,onComplete:s.onComplete})},getOwnConstraints:function(){return this.getCollectionAttribute(W,{"@mask":"dsplan:MVMask.WorkPackage.ScheduleView"})},addConstraint:function(t,n){var s,i=e.clone(n||{},!1);return i._defaultModel=h,t[h.PREDECESSOR_ATTR].id!==t[h.SUCCESSOR_ATTR].id&&(s=this.addModelToAttributeWithCollection(W,t,i)),s},addMilestone:function(t){var n=e.clone(t||{},!1),s=n[c.SUGGESTED_DATE_ATTR]||new Date,i=n[c.ESTIMATED_DATE_ATTR]||new Date(s);return n["@type"]=n["@type"]||c.MILESTONE_RDF_TYPE,n["dsxplan:jsType"]=n["dsxplan:jsType"]||c.MILESTONE_RDF_TYPE,n[c.TITLE_ATTR]=n[c.TITLE_ATTR]||"Milestone",n[c.SUGGESTED_DATE_ATTR]=s,n[c.ESTIMATED_DATE_ATTR]=i,this._addScheduleElement("dsplan:hasMilestone",n)},addGate:function(t){var n=e.clone(t||{},!1),s=n[c.SUGGESTED_DATE_ATTR]||new Date,i=n[c.ESTIMATED_DATE_ATTR]||new Date(s);return n["@type"]=n["@type"]||c.GATE_RDF_TYPE,n["dsxplan:jsType"]=n["dsxplan:jsType"]||c.GATE_RDF_TYPE,n[c.TITLE_ATTR]=n[c.TITLE_ATTR]||"Gate",n[c.SUGGESTED_DATE_ATTR]=s,n[c.ESTIMATED_DATE_ATTR]=i,this._addScheduleElement("dsplan:hasGate",n)},addChildWorkscopeAndSave:function(t,s){var i=this,o=e.clone(s||{},!1);e.extend(o,{parentId:this.id,childId:t.id,type:V,onComplete:function(e){if(e.value||e["@value"]){var o=k.replace(I.i18n("E6WCommonUI.Alert.ChildIsAlreadyInParentStructure"),{PARENT_NAME:i.get("title"),CHILD_NAME:t.get("title")});I.displayError(o),s&&s.onFailure&&s.onFailure(void 0,void 0,{dontShowFailureMessage:!0})}else i.addValidatedChildWorkscopeAndSave(n.getObjectById(t.id),s)}}),y.checkParentHierarchyForId(o)},addValidatedChildWorkscopeAndSave:function(t,n){var s=e.clone(n||{},!1).sequenceOrder||this._getDefaultSequenceOrderForAttribute(c.CHILDREN_ATTR),i={};i[this.isDSLC()?"dsxplan:sequenceOrder":c.SEQUENCE_ORDER_ATTR]=s,i[c.WORKSCOPE_PARENT_ATTR]=this,t.save(i,{onComplete:n.onComplete,onFailure:n.onFailure,mask:"dsplan:MVMask.WorkPackage.Collapsed"})},updateReferenceSequenceOrder:function(e,t){let n=this.get("dsplan:referenceConfig"),s=n?JSON.parse(n):{};s[e]=t,this.set("dsplan:referenceConfig",JSON.stringify(s))},addValidatedReferenceWorkscopeAndSave:function(e,t){var n=this.getDefaultSequenceOrderForReference();this.updateReferenceSequenceOrder(e.get("@id"),n),this.addModelToAttributeWithCollection(c.REFERENCE_PROJECT_ATTR,e),this.save({},{onComplete:t.onComplete,onFailure:t.onFailure,mask:"dsplan:MVMask.WorkPackage.Collapsed"})},removeReferenceFromParent:function(e){var t=this;let n=e&&e.parent;n&&n.getRDFModel&&(n=n.getRDFModel());let s=this.get(c.PARENT_REFERENCE_PROJECT_ATTR);if(n||s.size()>0){let i=n||s.at(0);i.removeObject(c.REFERENCE_PROJECT_ATTR,this),this.parentId=void 0,i.save(void 0,{onComplete:function(){t.dispatchEvent("onRemoveReferenceFromParent",[{id:t.id}]),e.onComplete&&e.onComplete()},onFailure:e.onFailure,mask:"dsplan:MVMask.WorkPackage.Collapsed"})}},add:function(e,t,n){if(e===c.CHILDREN_ATTR)throw new Error("Use addChildWorkscopeAndSave method instead");return[this.addModelToAttributeWithCollection(e,t,n)]},isReferenceProject:function(e){let t=this.get("dsplan:referenceConfig"),n=t?JSON.parse(t):{};return Object.keys(n).indexOf(e)>-1},isVersion:function(){return!0},getDurationString:function(e){return n.millisecondsToXsdDayTimeDuration(8*parseFloat(e)*60*60*1e3)},_onRequest:function(){this.fetching=!0},_onCompleteRequest:function(){this.fetching=!1},_getDefaultChildWorkscopeAttributes:function(){var e={};return e[c.TITLE_ATTR]="Child WS",e[c.DESCRIPTION_ATTR]="",e[c.STATE_ATTR]="dsxplan:Open",e["dsxplan:jsType"]="dsplan:Project",e[c.SEQUENCE_ORDER_ATTR]=this._getDefaultSequenceOrderForAttribute(c.CHILDREN_ATTR),e},insertChildWorkscopeAtTop:function(e,t){var n=this.getSequenceOrderForNewFirstChild("dsxplan:hasWorkDecomposition");this._insertChildWorkscopeWithSequenceOrder(e,n,t)},insertChildWorkscopeBefore:function(e,t){var n=this.getSequenceOrderForObject({model:e,collection:this.getWorkscopes(),referenceModel:t.referenceModel,placement:"before"});this._insertChildWorkscopeWithSequenceOrder(e,n,t)},insertChildWorkscopeAfter:function(e,t){var n=this.getSequenceOrderForObject({model:e,collection:this.getWorkscopes(),referenceModel:t.referenceModel,placement:"after"});this._insertChildWorkscopeWithSequenceOrder(e,n,t)},insertChildWorkscopeAtBottom:function(e,t){var n=this;this.fetch({mask:"dsplan:MVMask.WorkPackage.Expanded",onlyIfNeeded:!0,onComplete:function(){var s=n.getSequenceOrderForLastChild("dsplan:hasWorkDecomposition");n._insertChildWorkscopeWithSequenceOrder(e,s,t)}})},_insertChildWorkscopeWithSequenceOrder:function(t,n,s){var i=e.clone(s,!1);this.getWorkscopes().contains(t)?(t.set(c.SEQUENCE_ORDER_ATTR,n),t.save(void 0,{onComplete:i&&i.onComplete,onFailure:i&&i.onFailure})):this.addChildWorkscopeAndSave(t,{sequenceOrder:n,onComplete:i&&i.onComplete,onFailure:i&&i.onFailure})},getSequenceOrderForObject:function(e){var t=e.placement||"after",n=e.collection.indexOf(e.referenceModel),s=e.referenceModel.get(c.SEQUENCE_ORDER_ATTR);if(0===n&&"after"!==t)return s-1-Math.random();if(n===e.collection.length-1&&"after"===t)return s+1+Math.random();var i="after"===t?n+1:n-1,o=e.collection.at(i).get(c.SEQUENCE_ORDER_ATTR);return(s+o)/2+(Math.random()-.5)*(s-o)/2},getSequenceOrderForNewFirstChild:function(e){var t=this.get(e);return 0===t.length?Math.random():t.first().get(c.SEQUENCE_ORDER_ATTR)-1-Math.random()},getSequenceOrderForLastChild:function(e){var t=this.get(e);return 0===t.length?Math.random():t.last().get(c.SEQUENCE_ORDER_ATTR)+1+Math.random()},_setAndSaveSequenceOrders:function(){},getCollectionAttributeBasedOnModel:function(e){return e instanceof h?"dsxplan:hasConstraint":e instanceof _?"dsxplan:hasGate":e instanceof f?"dsxplan:hasMilestone":e instanceof d?"dsxplan:hasTask":e instanceof V?"dsxplan:hasWorkDecomposition":void 0},onShareNotification:function(e){this._parent.apply(this,arguments),this.getTeamMembers().length>0&&this.getTeamMembers().fetch({ajax:e.ajax,remove:!0,forceFetch:!0,onFailure:function(){this.destroy({noServer:!0})}.bind(this)})},onCollectionRollback:function(e){"dsxplan:hasAssignee"===e&&this.getTeamMembers().length>0&&this.getTeamMembers().fetch({reset:!0})},hasChildWorkscopes:function(){var e=this.getWorkscopes();return Boolean(e.length||e.hasMoreItems())},hasTasks:function(){var e=this.getTasks();return Boolean(e.length||e.hasMoreItems())},ownsOrContainsTask:function(e,t){var n=this,s=t&&t._models;return!!["dsplan:ownedTasks","dsplan:assignedTasks","dsxplan:hasLeafTasks","dsxplan:candidateAssigneeTasks"].find(function(t){return(t=n.get(t))&&-1!==t.indexOf(e)})||(s?s.includes(e):-1!==this.getTasks().indexOf(e))},_parseNestedModelsAndCollections:function(e){var t=e["dsxplan:hasTaskVocabulary"],n=e["dsxplan:hasMilestoneVocabulary"];function s(e){e["dsxplan:jsType"]||(e["dsxplan:jsType"]="dsxplan:Vocabulary");var t=e["dsplan:vocabularyTerms"];t&&t.member.forEach(function(e){e["dsxplan:jsType"]||(e["dsxplan:jsType"]="dsxplan:VocabTerm")})}return t&&s(t),n&&s(n),this._parent.apply(this,arguments)},canShare:function(){return P.isXppViewer()?this._parent.apply(this,arguments):(void 0===this._accessShare&&A.AccessModelQueue.requestFetch(this),Boolean(this._accessShare))},exportToCSV:function(t){var s=e.clone(t||{},!1);s.data=this.id,n.invokeAsLRT("dsxplan:downloadCSV",s)},getAccessBatch:function(t){var s=this,i=this._parent.apply(this,arguments);return i.ajax(n.expandUrl(A.ACCESS_URL),{method:"POST",onComplete:function(n){return s.setShareAccess(n["@value"]),t&&e.is(t.onComplete,"function")&&t.onComplete.apply(this,arguments)},onFailure:function(){return t&&e.is(t.onFailure,"function")&&t.onFailure.apply(this,arguments)},onTimeout:t&&t.onFailure,headers:{"Content-Type":"application/json"},data:JSON.stringify([this.id,A.SHARE_DATA]),type:"json"}),i},handleDeleteFailure:function(e){var t=e.onTimeout,n=this;e.onTimeout=function(){delete n._collectionsRemovedFrom,t&&t.apply(n,arguments)},this._parent(e)},parse:function(e,t){var n;this.dispatchEvent("onParseStart");try{n=this.handleIsFavoriteAndAccessedDate(e),n=this.handleRestrictAssigneeAccess(e),n=this._parent(n,t)}finally{this.dispatchEvent("onParseEnd")}return n},handleRestrictAssigneeAccess:function(e){if(e&&e.hasOwnProperty(L)&&(e[w]=e[L],delete e[L]),e&&e[w]){let t=e[w];e[w]=t&&"boolean"==typeof t?t?"TRUE":"FALSE":"TRUE"===t}return e},handleIsFavoriteAndAccessedDate:function(e){if(e){let t=e["dsxplan:projectAccess"];t&&(e["dsplan:accessedDate"]=t["dsplan:accessedDate"],e["dsplan:isFavorite"]=t["dsplan:isFavorite"],delete e["dsxplan:projectAccess"])}return e},unset:function(e){e===c.WORKSCOPE_PARENT_ATTR&&this.unset(c.HAS_PARENT_ATTR),this._parent.apply(this,arguments)},isXProject:function(){return"dsplan:xProject"===(this.get(c.PROJECT_TYPE)||this.get("@type")||this.get(c.JS_TYPE_ATTR))},isAgile:function(){return(this.get(c.PROJECT_TYPE)||this.get(c.JS_TYPE_ATTR))===a.AGILE_PROJECT},getDragType:function(){var e=this.get(c.PROJECT_TYPE);return e||(e=this._parent.apply(this,arguments)),e=this.get("dsplan:isTemplate")?"dsplan:ProjectPlanningTemplate":e},set:function(){var t=I.setHelper.apply(this,arguments),n=e.clone(t.attrs||{},!1),s=e.clone(t.options||{},!1);return this.isXProject()&&!s.dontRegisterChange&&delete n[c.PROJECT_TYPE],this._parent(n,s)},addAsRecent:function(e){var t=this;let s=[n.jsonURIToSparqlURI(this.id)];e&&(s.push(!0),this.set("dsplan:isFavorite",!0)),this.adding=!0,n.request(n.expandUrl("invoke/dsxplan:addToRecentProjects?mask=dsplan:MVMask.WorkPackage.Favorite"),{method:"POST",type:"json",data:JSON.stringify(s),headers:{"Content-Type":"application/json"},onComplete:function(n){t.adding=!1,t.set("dsplan:accessedDate",n.accessedDate),e&&I.displaySuccess(F("E6WCommonApps.Alert.AddToFavoritesSuccess").replace("{PROJECT_NAME}",t.get("title")))},onFailure:function(){t.adding=!1,e&&(t.set("dsplan:isFavorite",!1),I.displayError(F("E6WCommonApps.Alert.AddToFavoritesFailure").replace("{PROJECT_NAME}",t.get("title"))))}})},removeFromFavorites:function(){var e=this;this.set("dsplan:isFavorite",!1),n.request(n.expandUrl("invoke/dsxplan:removeFromFavorites?mask=dsplan:MVMask.WorkPackage.Favorite"),{method:"POST",type:"json",data:JSON.stringify(n.jsonURIToSparqlURI(this.id)),headers:{"Content-Type":"application/json"},onComplete:function(){I.displaySuccess(F("E6WCommonApps.Alert.RemoveFromFavoritesSuccess").replace("{PROJECT_NAME}",e.get("title")))},onFailure:function(){e.set("dsplan:isFavorite",!0),I.displayError(F("E6WCommonApps.Alert.RemoveFromFavoritesFailure").replace("{PROJECT_NAME}",e.get("title")))}})},getStartDate:function(){const e=this.getRollupDates();return e?e.start:void 0},getEndDate:function(){const e=this.getRollupDates();return e?e.end:void 0},getAccumulatedStoryPoints:function(){var e=this.get("dsxplan:hasRolledUpInfo");if(e){var t=e.get("dsxplan:accumulatedStoryPoints");return t||0}},checkFeatureAccess:{scheduleHighlight:function(){},addingSubTasks:function(){},risk:function(){}},getNonAgileWorkscopes:function(){return this.getWorkscopes().filter(e=>!e.isAgile())},getRDFModel:function(){return this},createNodeData:function(){let t=this._parent.apply(this,arguments);return e.merge(t,{nodeType:"workscope"}),t},getStartingFacet:function(){return this.isAgile()?c.BACKLOG_FACET:c.TASK_FACET}},g,v);V.SEQUENCE_ORDER_ATTR="dsplan:sequenceOrder",Object.defineProperty(V.prototype,"beingCreatedOnServer",{get:function(){return this._beingCreatedOnServer},set:function(e){var t=this._beingCreatedOnServer;this._beingCreatedOnServer=e,t!==this._beingCreatedOnServer&&this.dispatchEvent("onChange:beingCreatedOnServer")}}),Object.defineProperty(V.prototype,"solveCounter",g.solveCounterDef),Object.defineProperty(V.prototype,"prevSolveCounter",g.prevSolveCounterDef),V.KPI_URI="dsmf:xplan.xPlanKPI.getKPIsForUpcomingMilestone?$mask=dsplan:MVMask.KeyPerformanceIndicator.Complex";var j=V.prototype.dslcMapping,B=n.inverseMapping(j);return V.prototype.inverseDslcMapping=B,V.TIMEZONE_ATTR="dsxplan:usesCalendar",V.implement(C,D),V.parentPlanTypeAhead=function(e,t,s,i){var o=i.model.get("dsxplan:jsType");t=V.sanitizeTermForSearch(t);var a=[];a="dsplan:Task"===o?["dsplan:Project","dsplan:Task"]:["dsplan:Project"];var r=JSON.stringify([a,!1,t,[],["dsplan:Leader","dsplan:Author"],10]);return n.request(n.expandUrl("/invoke/dsxplan:getFilteredVersions?$mask=dsplan:MVMask.WorkPackage.Basic"),{method:"POST",type:"json",data:r,headers:{"Content-Type":"application/json"},onComplete:function(e){var t,n,o,a=[];if(e){var r=e.member;if(r)for(var l=0;l<r.length&&l<10;l++)i.model&&i.model.id===r[l]["@id"]||a.push((t=r[l],n=void 0,o=void 0,n={},o=t[c.THUMBNAIL_ATTR]||t["dsxplan:hasThumbnail"],n.value=t["@id"],n.label=t["dsxplan:label"],n.image=o||I.getDefaultImage(t),n.model=t,n.serviceId=c.SERVICE_3DPLAN,n["ds6w:type"]=t["dsxplan:jsType"],n))}s(a,i)},onFailure:function(){I.displayError(F("E6WCommonApps.Alert.NoResultFound"))}})},V.processDropData=function(e,t){var s=this&&this.id,i=I.getDataTransferJSON(e),o=!1;return i.data&&i.data.items.forEach(function(e){var i=O.validateDroppedObject(e,t);i||s!==n.removeBracketLongURI(e.objectId)||(i=I.i18n("E6WCommonUI.Alert.PlanOwnChild")),i&&(I.displayError(i),o=!0)}),o},V.sanitizeTermForSearch=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},V.MILESTONE_RELATION_ATTR="dsplan:hasMilestone",V.TASK_RELATION_ATTR="dsplan:hasTask",V.TEAM_MEMBERS="team_members",V.ROLLUP_START="rollupStart",V.ROLLUP_END="rollupEnd",V}),define("DS/E6WCommonApps/E6WCommonAppsTypeDictionary",["UWA/Core","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/Models/UsersGroupRDFModel","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/Models/URLModel","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/Models/LogicalUserModel","DS/E6WCommonApps/Models/ConstraintModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/MilestoneModel","DS/E6WCommonApps/Models/GateModel","DS/E6WCommonApps/Models/CalendarModel","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/Models/RollUpModel","DS/E6WCommonApps/Models/BaselineModel","DS/E6WCommonApps/Models/ChecklistItemModel"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,g){"use strict";return e.merge(s.typeDictionary,{mapping:[{key:"dsplan:Project",type:h},{key:"dsplan:xProject",type:h},{key:"dsxplan:WorkPackageVersion",type:h},{key:"dsplan:WorkPackage",type:h},{key:"dsxplan:WorkPackage",type:h},{key:"dsplan:Task",type:d},{key:"dsxplan:Task",type:d},{key:"dsxplan:TaskVersion",type:d},{key:"dsplan:Milestone",type:c},{key:"dsxplan:Milestone",type:c},{key:"dsxplan:MilestoneVersion",type:c},{key:"dsplan:Gate",type:p},{key:"dsxplan:Gate",type:p},{key:"dsxplan:GateVersion",type:p},{key:"dsplan:TemporalConstraint",type:l},{key:"dsxplan:TemporalConstraint",type:l},{key:"dsplan:ControlledTemporalConstraint",type:l},{key:"dsxplan:ControlledTemporalConstraint",type:l},{key:"foaf:Person",type:t},{key:"foaf:Group",type:n},{key:"dsplan:LogicalUser",type:r},{key:"dscom:ComponentProxy",type:i},{key:"dsplan:url",type:o},{key:"Person",type:t},{key:"dsplan:Calendar",type:u},{key:"swym:WeDo",type:d},{key:"dsplan:RolledUpInfo",type:m},{key:"dsplan:Baseline",type:T},{key:"dsplan:ProjectPlanningTemplate",type:h},{key:"dsplan:AgileProject",type:h},{key:"dsplan:ChecklistItem",type:g}],masksStrength:{"dsplan:MVMask.Task.CollaborativeTask.siblings":2,"dsplan:MVMask.WorkPackage.Basic":15,"dsplan:MVMask.WorkPackage.Collapsed":27,"dsplan:MVMask.WorkPackage.Expanded":32,"dsplan:MVMask.WorkPackage.Complex":111,"dsplan:MVMask.Task.Property":235,"dsplan:MVMask.Task.Basic":42,"dsplan:MVMask.Task.Complex":53,"dsplan:MVMask.Task.CollaborativeTasks.Complex":57}}),s.typeDictionary}),define("DS/E6WCommonApps/DeleteUtil",["UWA/Core","DS/E6WCommonUI/UIHelper","DS/UIKIT/Input/Toggle","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/Models/ConstraintModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Utils/ModalManager","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","DS/Handlebars/Handlebars4"],function(e,t,n,s,i,o,a,r,l){"use strict";var d=function(e){return r.get(e)},c={_getDeleteModalBody:function(t,s,i){var o=e.createElement("div"),a=s?"E6WCommonApps.Label.AreYouSureDeleteProject":"E6WCommonApps.Label.AreYouSureDelete";return a=i?"E6WCommonApps.Label.AreYouSureConstraint":a,e.createElement("p",{html:r.replace(d(a),{NAME:l.Utils.escapeExpression(t)})}).inject(o),s&&(this._deleteCheckBox=new n({type:"checkbox",label:d("E6WCommonApps.Label.DeleteSubprojects"),checked:!1,className:"primary"}).inject(o)),o},deleteItem:function(t){var n=e.clone(t||{},!1),o=n.model,l=n.parentView,p=n.modal||l&&l.getSuperModal()||a.getSuperModal(),u=o.get("title"),h=o instanceof s,m=o instanceof i,T=m?"E6WCommonApps.Label.ConfirmDeleteConstraint":"E6WCommonApps.Label.ConfirmDelete";p.dialog({body:c._getDeleteModalBody(u,h,m),title:r.replace(d(T),{NAME:u}),buttons:[{className:"primary",value:d("E6WCommonApps.Label.Delete"),action:function(e){n.isStructureDelete=h&&c._deleteCheckBox.isChecked(),c._destroyModelAndSetNewRoute(o,l,{isProject:h,isStructureDelete:h&&c._deleteCheckBox.isChecked()}),e.hide()}},{value:d("E6WCommonApps.Command.Cancel"),action:function(e){e.hide()}}]})},_destroyModelAndSetNewRoute:function(e,n,i){var o=i.isProject;s.justDeletedProjectID=e.get("@id"),setTimeout(function(){delete s.justDeletedProjectID},1e4),e.destroy({onComplete:function(){var s=r.replace(d("E6WCommonApps.Alert.ObjectDeleted"),{OBJECT_NAME:d("E6WCommonApps.Type."+e.getObjectType())});t.displaySuccess(s),n&&n.closePropertyPanel&&n.closePropertyPanel()},onFailure:function(n,s){var i;i=s&&s.message&&d(s.message)!==s.message?d(s.message):r.replace(d("E6WCommonApps.Error.FailedToDeleteObject"),{OBJECT_NAME:d("E6WCommonApps.Type."+e.getObjectType())}),t.displayError(i)},onTimeout:function(){o&&t.displaySuccess(d("E6WCommonApps.Label.ProjectDeleted"))},isStructureDelete:i.isStructureDelete})},restoreItem:function(e){var n=e.collection;n&&n.remove(e),e.restore({onComplete:function(){t.displaySuccess(d("E6WCommonApps.Alert.ProjectRestored"))},onFailure:function(){t.displayError(d("E6WCommonApps.Alert.RestoreFailed")),n.add(e)},onTimeout:function(){t.displaySuccess(d("E6WCommonApps.Alert.ProjectRestored"))}})}};return c}),define("DS/E6WCommonApps/Models/AssigneeTypeAhead",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/Foundation2/Models/ReferenceModel","UWA/Class/Listener","DS/E6WCommonApps/Models/WorkscopeModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Collections/ProjectTeamCollection","DS/E6WCommonUI/Models/BulkModel","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","DS/E6WCommonUI/FeatureFlagUtils"],function(e,t,n,s,i,o,a,r,l,d){"use strict";var c=function(e){return l.get(e)};var p={callback:function(t,n,s,i){var o=e.clone(i||{},!1).model;return n.length>0&&n.length<3?p._buildTypeAhead([],o,t,n,s):p._callback(o,t,n,s)},noResultsMessageCallback:function(e){return e.length>0&&e.length<3?c("E6WCommonUI.Label.Type3Characters"):c("emxFoundation.Label.NoResultsFound")},_callback:function(e,t,n,a){var l,d,c=function(e){return e.fetching},u=e.model,h=u instanceof r;return h||(d=function(e){return e instanceof i?e:e.getParent()}(u)),!h&&d&&d.hasViewAccess()?((l=p.getTeamMembers(e.model)).fetch({onlyIfNeeded:!0,onComplete:function(i){if(i.some(c)){var o=new s;o.listenTo(i,"onFetchDone",function(){i.some(c)||(p._buildTypeAhead(i,e,t,n,a),o.stopListening())})}else i,p._buildTypeAhead(i,e,t,n,a)}}),l.fetching?{cancel:function(){}}:p._buildTypeAhead(l,e,t,n,a)):o.typeAheadCallback.call(this,t,n,a)},getTeamMembers:function(e){return new a(void 0,{workscope:e,uri:"/invoke/dsxplan:getProjectMembers"})},_buildTypeAhead:function(n,s,a,r,l){var d={cancel:function(){}},c=s.get("dsxplan:hasAssignee");c=c||[];var p=function(n,l){var d=[];c=c||[];var p=s.getModelForAssigneeTypeahead(),u=p.get(t.CANDIDATE_ASSIGNEE_ATTR);u&&u.forEach(function(e){e.getObjectType()!==t.USER_GROUP_TYPE&&-1===c.indexOf(e)&&d.push({value:e.id,label:e.getFullName(),image:e.get("image"),login:e.get("ds6w:identifier"),sourceid:o.sourceFromService(e.serviceHosting)})});const h=d.reduce((t,n)=>e.merge(t,{[n.value]:!0}),{});return function(e){let t=[];for(let n=0;n<e.length;n++){let s=e[n];s.get("assignedUserModel")||t.some(function(e){return e.get("memberPersonModel")===s.get("memberPersonModel")})||t.push(s)}return t}(n).forEach(function(e){if(function(e,n,s,o,a){var r,l=s.get("memberPersonModel"),d=l.getObjectType();if("pno:Person"===d||o.name===t.CANDIDATE_ASSIGNEE_ATTR&&"foaf:Group"===d||o.name!==t.CANDIDATE_ASSIGNEE_ATTR&&d===t.LOGICAL_USER_TYPE){var c=e instanceof i;r=-1===n.indexOf(s)&&s.id,"foaf:Group"===d&&(r=!!l.getFullName()&&r),c&&(r=r&&s.get("responsibility")===t.RESPONSIBILITY_LEADER),a[l.id]&&(r=!1)}return r}(p,c,e,a,h)){var n=e.get("memberPersonModel");let s;if(n.getObjectType()===t.LOGICAL_USER_TYPE&&n.get("title")){s=n.get("title").split(" ").some(e=>e.toLowerCase().startsWith(r.toLowerCase()))}else s=n.get("title")&&n.get("title").toLowerCase().startsWith(r.toLowerCase());n.getObjectType()!==t.LOGICAL_USER_TYPE||l&&!s?l||d.push({value:n.id,label:n.getFullName(),image:n.get("image"),login:n.get("ds6w:identifier"),sourceid:o.sourceFromService(n.serviceHosting)}):d.push({value:n.id,label:n.get("title"),image:n.get("image"),sourceid:"3dplan"})}}),d};let u;if(r.length<3){T=[],(m=n)&&!m.isEmpty()&&m.forEach(function(e){e.get("responsibility")!==t.RESPONSIBILITY_VIEWER&&T.push(e)});let e=p(u=T);l(e)}else{var h={};u=n.toArray(),n.forEach(function(e){var t=e.get("memberPersonModel");h[t.id]=!0});d=o.typeAheadCallback.call(this,a,r,function(e,t){var n=[],s=[];e.forEach(function(e){h[e.resourceUid]?n.push(e):s.push(e)});var i=p(u,!0),o=n.concat(s).concat(i);l(o,t)})}var m,T;return d}};return p}),define("DS/E6WCommonApps/Models/IteropTaskModel",["UWA/Core","UWA/Class/Model","DS/RDFFoundation/RDFUtils","DS/TreeModel/TreeNodeModel","DS/E6WCommonApps/TreeNodeUtil","DS/E6WCommonUI/UIHelper","UWA/Ajax","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Models/TaskModelMixin"],function(e,t,n,s,i,o,a,r,l){"use strict";var d={3:"Low",2:"Medium",1:"High",0:"Urgent"};return t.extend({_uwaClassName:"IteropModel",getParentAsLabel:function(){},getPriorityValue:function(e){return d[e]},isRDFTask:function(){return!1},dataForRendering:function(e){return e&&(e.dataForRendering=!0),this.toJSON.apply(this,arguments)},hasFetchedAccessData:function(){return!0},canAssignToSelf:function(){return!0},isProjectTask:function(){return!1},subscriptionsEnabled:function(){return!1},isComplete:function(){return!1},isRouteTask:function(){return!1},canDelete:function(){return!1},isLate:function(){return!1},isAtRisk:function(){return!1},isReadyToStart:function(){return!1},isLeanTask:function(){return!1},isIteropTask:function(){return!0},getCustomFields:function(){},getState:function(){return this.get("state")},getStartDate:function(){return this._startDate},isStarted:function(){var e=this.get("dscom:hasMaturity"),t=e&&(e.id||e["@id"]);return"dsxplan:Done"===t||"dsxplan:InProgress"===t},toJSON:function(e){var t=this._parent.apply(this,arguments);e&&e.dataForRendering&&(t.card_icon=this.get("card_icon"),t.date=new Date(this.get("creation")),void 0!==t.percentComplete&&(t.percentComplete=parseInt(t.percentComplete).toString()));for(var n=Object.keys(t),s=n.length,i=0;i<s;i++){var a=n[i],r=t[a];r instanceof Date&&(t[a]=r=o.dateForJSON(r,"UTC",l.dateHelper,e))}return t},set:function(){var t=o.setHelper.apply(this,arguments),n=e.clone(t.attrs||{},!1),s=t.options;return this._parent(n,s)},get:function(e){switch(e){case r.DESCRIPTION_ATTR:return i.getDisplayLabelForDescription(this.get("description"));case"card_icon":return this.getFonticonValue();case"endDate":return this.get("date")}return this._parent.apply(this,arguments)},getDeliverables:function(){return[]},getReferences:function(){return[]},getFonticonValue:function(){return require.toUrl("DS/E6WCommonApps/assets/img/I_BusinessProcessTask_16.png")},createNodeData:function(){var e={title:this.get("title"),description:i.getDisplayLabelForDescription(this.get("description")),maturity:i.getDisplayLabelForState(this.get("state")),priority:this.get("priority"),attachments:this.getReferences(),deliverables:this.getDeliverables(),created:this.get("creation"),[i.RDF_MODEL]:this};return e.icon=this.getFonticonValue(),e},getTreeNodeModel:function(){if(this._treeNodeModel)this._treeNodeModel.show();else{var e=this.createNodeData();this._treeNodeModel=new s({label:e.title,grid:e}),i.addListenersOnTreeNode(this._treeNodeModel)}return this._treeNodeModel},markDeliverablesOn3DNavigate:Function.prototype})}),define("DS/E6WCommonApps/Collections/IteropTasksCollection",["UWA/Core","UWA/Class","UWA/Class/Collection","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/IteropTaskModel","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Collections/TasksSplitCollection","DS/WAFData/WAFData","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","DS/E6WCommonUI/PlatformManager"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m){"use strict";var T=function(e){return e&&e.actualValue||e},g={3:"Low",2:"Medium",1:"High",0:"Urgent"},E=s.extend({model:a,_uwaClassName:"IteropTasksCollection",setAttrToSplitBy:function(e){this._attrToSplitBy=e},_doneCompleting:function(){if(this.completing=!1,this.toComplete&&this.toComplete.length){var e=this.toComplete;delete this.toComplete,this.complete(e)}},complete:function(t,n){e.clone(n||{},!1);var s=t.filter(function(t){return t instanceof a||e.is(t,"string")}).map(function(e){return e.id||e});if(s.length)if(this.completing)this.toComplete||(this.toComplete=[]),Array.prototype.push.apply(this.toComplete,s);else{this._doneCompleting.bind(this);this.completing=!0}},setup:function(t,n){var s=Array.prototype.slice.call(arguments,0);this._TasksByAttr={},this._attrToSplitBy="stateForDisplay",this.extid="allTasks";var i=e.clone(n,!1);s[1]=i,this._parent.apply(this,s)},fetchIteropToken:function(e,t){var n=this,s=m.getServiceUrl("3DPassport"),i=m.getServiceUrl("businessprocess")+"/api/v2/auth/cas",o=s+"/login?service="+encodeURIComponent(i),a=p.authenticatedRequest,r=Date.now(),l={headers:{"Accept-Language":"en","content-type":"application/json",Accept:"application/json"},method:"GET",onComplete:function(s){try{var o=JSON.parse(s).access_token;a(i=i+"?ticket="+o,{headers:{"Accept-Language":"en","content-type":"application/json",Accept:"application/json"},data:"",method:"POST",onComplete:function(s){try{var i=JSON.parse(s).token;n.iteropBearerToken=i,n.tokenExpirationDate=r+18e5,e.call(n,t)}catch(e){t&&t.onFailure&&t.onFailure(s)}},onFailure:function(e){console.log(e),t&&t.onFailure&&t.onFailure(e)},url:i})}catch(e){t&&t.onFailure&&t.onFailure(s)}},onFailure:function(e){console.log(e),t&&t.onFailure&&t.onFailure(e)},url:o};a(o,l)},getPriorityValue:function(e){let t=2;return 5==e?t=0:e<3?t=3:e>3&&(t=1),g[t]},tasksWithAttrValue:function(e,t){var n=this,s=t||this._attrToSplitBy,o=T(e);return this.filter(function(e){var t=T(e.get("stateForDisplay")),a=T(e.get(s)),r=T(e.get("dsxplan:label"));r=r?r.toLowerCase():"";var l=!n._search||i.match(n._search,r);return(s!==d.DUE_DATE_CATEGORY&&"priority"!==s||"Complete"!==t)&&(a===o&&l)})},tasksWithAttrValueCollection:function(e,t){if(void 0===e)throw new Error("Invalid attribute value passed.");var n=t||this._attrToSplitBy,s=T(e),i=this._TasksByAttr[n];if(!i||!i[s]){var o=this.tasksWithAttrValue(e,n),a={filterAttr:n,valueForFiltering:e,parentCollection:this},r=new E.TasksSplitCollection(o,a);r.extid="tasks-"+n+"-"+s,i||(this._TasksByAttr[n]=i={}),i[s]=r}return i[s]},fetch:function(t){var n=e.clone(t||{},!1);void 0!==this.iteropBearerToken&&Date.now()<this.tokenExpirationDate?this.fetchCurrentIteropTasks(n):this.fetchIteropToken(this.fetchCurrentIteropTasks,n)},fetchCurrentIteropTasks:function(e){var t=this,n=t.iteropBearerToken,s=(p.authenticatedRequest,p.proxifiedRequest),i=m.getServiceUrl("businessprocess")+"/api/v2/runtime/tasks";s(i,{headers:{"Accept-Language":"en",Authorization:"Bearer "+n,Accept:"application/json"},method:"GET",onComplete:function(n){try{for(var s=JSON.parse(n),i=0;i<s.length;i++)t.add(t.buildIteropModel(s[i]))}catch(t){return void(e&&e.onFailure&&e.onFailure())}e&&e.onComplete&&e.onComplete.apply(this,arguments)},onFailure:function(n){if(console.log(n),401==n.code&&void 0!==n.message&&n.message.startWith("Expired token"))try{t.fetchIteropToken(t.fetchCurrentIteropTasks)}catch(n){e&&e.onFailure&&e.onFailure()}else e&&e.onFailure&&e.onFailure()},url:i})},buildIteropModel:function(e){return new a({"@id":e.id,id:e.id,title:e.name.htmlDecode(),"dscom:hasMaturity":{"@id":"dsxplan:Open"},"dsxplan:label":e.name,stateForDisplay:"To Do",state:"Assign",references:[],deliverables:[],priority:this.getPriorityValue(e.priority),"dsxplan:jsType":"iteropTask",date:i.getIntlDateTimeFormat(e.startDate),creation:e.startDate,process:e.process,processName:e.process.name,processIdentificator:e.process.identificator,description:e.description,percentComplete:0,dueDateCategory:"NO_DATE"})},add:function(e){var t=this._parent.apply(this,arguments);return t&&(t,t instanceof a&&[t]),t}});return E.TasksSplitCollection=c.extend({model:a}),E}),define("DS/E6WCommonApps/Views/TaskDurationEstimatedRangeStartStop",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonUI/Views/StartStopView"],function(e,t,n){"use strict";return n.extend({setup:function(){this._parent.apply(this,arguments),this.model&&(this.listenTo(this.model,"onChange:"+t.ACTUAL_START_DATE,this.render),this.listenTo(this.model,"onChange:"+t.ACTUAL_END_DATE,this.render))},render:function(){return this._parent.apply(this,arguments),this}})}),define("DS/E6WCommonApps/AgileProjectUtils",["DS/i3DXCompassPlatformServices/OpenWith","DS/WAFData/WAFData","DS/RDFFoundation/FederatedSearchUtil","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Utils/3DSpaceUtils","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,n,s,i,o,a,r){"use strict";const l={_openWithInst:new e,contextSearchSourceTypes:{swym:["Idea","Post","Question","Wiki","WikitreePage","Wikitree","swym:WikitreePage","swym:Wikitree","swym:Question","swym:Idea","swym:Post","question","post","idea","wiki"],"3dspace":["Requirement","Requirement Specification","Document","Issue","URL"],drive:["DriveFile"]},getContextSearchSources:function(){return n.filterSearchSources(Object.keys(l.contextSearchSourceTypes))},getContextTypes:function(){const e=[];return Object.values(l.contextSearchSourceTypes).forEach(t=>{e.push(...t)}),e},updateTaskParent:function(e,t,n,s){s?(e.set(o.SEQUENCE_ORDER_ATTR,n.getSequenceOrderForLastChild(i.TASK_RELATION_ATTR)),e.set("dsxplan:backlogParent",n)):e.set("dsxplan:workscopeParent",n)},addTaskForWorkContext:function(e,t,n,s,i){const a=e.addTask({},{isToBacklog:s});return a.set(o.WORK_CONTEXT_ATTR,t),a.set(o.TITLE_ATTR,t.get("title")),i&&a.set("dsplan:sequenceOrder",i),a.save(void 0,{ajax:n.ajax}),a},getOpenWith:function(e){return{id:"Open_With",type:"PushItem",title:(t="E6WCommonUI.Label.OpenWith",n=t,n===t&&(n=r.get(t)),n),fonticon:{content:"wux-ui-3ds wux-ui-3ds-open-menu-dot",family:"DSFontIcon"},submenu:async()=>new Promise(t=>{const n=[];a.fetchParentTypesWithCallback(e,()=>{l._openWithInst.set3DXContent(e.getTransferObject()).retrieveCompatibleApps(function(e){e.length>0&&e.forEach(function(e){n.push({name:e.text,type:"PushItem",title:e.text,icon:e.icon,action:{callback:function(t){e.handler.call(t)}}})}),t(n)})})})};var t,n}};return l}),define("DS/E6WCommonApps/Models/WorkscopeTreeNodeModel",["DS/E6WCommonApps/Models/E6WTreeNodeModel"],function(e){"use strict";const t=function(){e.apply(this,arguments)};return(t.prototype=Object.create(e.prototype,{constructor:{value:t}})).addRdfModelListeners=function(){e.prototype.addRdfModelListeners.apply(this,arguments),this.listener.listenTo(this.rdfModel.getTasks(),"onAdd",e=>this.addRdfChild(e)),this.listener.listenTo(this.rdfModel.getTasks(),"onRemove",e=>this.removeRdfChild(e)),this.listener.listenTo(this.rdfModel.getTasks(),"onChange:dsplan:sequenceOrder",()=>this.sortChildren())},t.prototype.addExistingRdfChildren=function(){this.rdfModel.getTasks().forEach(e=>this.addRdfChild(e))},t}),define("DS/E6WCommonApps/Collections/E6WTreeDocument",["UWA/Core","DS/Tree/TreeDocument","DS/E6WCommonApps/Models/E6WTreeNodeModel","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/Models/WorkscopeTreeNodeModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/TaskTreeNodeModel"],function(e,t,n,s,i,o,a){"use strict";const r=function(s){this._pushUpdateTimeoutCount=0,this._isExpandedCallback=s&&s.isExpanded;let i={nodeModelClass:n};e.merge(i,s),t.call(this,i),this._modelMap=new WeakMap,this.addEventListener("addChild",e=>this.registerModel(e.data.nodeModel)),this.addEventListener("removeChild",e=>this.unregisterModel(e.data.nodeModel))};return(r.prototype=Object.create(t.prototype,{constructor:{value:r}})).registerModel=function(e){if(!e._isTrueRoot()){const t=this._modelMap.get(e.rdfModel);if(t&&t!==e)throw new Error("Registering duplicate tree node model");this._modelMap.set(e.rdfModel,e)}},r.prototype.unregisterModel=function(e){e._isTrueRoot()||this._modelMap.delete(e.rdfModel)},r.prototype.getTreeNodeModelFromRdfModel=function(e){return this._modelMap.get(e)},r.prototype.shouldBeExpanded=function(e){return!this._isExpandedCallback||this._isExpandedCallback(e)},r.prototype.pushUpdateDelayed=function(){this._pushUpdateTimeout=this._pushUpdateTimeout||setTimeout(()=>{for(let e=0;e<this._pushUpdateTimeoutCount;e++)this.pushUpdate();this._pushUpdateTimeoutCount=0},0),this._pushUpdateTimeoutCount++},r.prototype.destroy=function(){this._pushUpdateTimeout&&clearTimeout(this._pushUpdateTimeout),this._pushUpdateTimeout=void 0,t.prototype.destroy.apply(this,arguments)},r.prototype.getTreeNodeModelConstructor=function(e){return e instanceof s?i:e instanceof o?a:n},r}),define("DS/E6WCommonApps/Views/HistoryGridView",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","DS/Foundation2/FoundationV2Data","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/BatchBuilder","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/Models/MemberModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/Models/BaselineModel","DS/E6WCommonApps/Models/MilestoneModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/ScheduleConstants","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewPaginationManager","DS/CollectionView/CollectionViewStatusBar","DS/Controls/TooltipModel","DS/Tree/TreeDocument","DS/TreeModel/TreeNodeModel","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/TreeNodeUtil","DS/E6WCommonApps/Views/HistoryGridViewConfig","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,g,E,A,C,f,_,D,S,R,v){"use strict";var y,b=function(e){var t=i.getWidgetConstant.apply(this,arguments);return t===e&&(t=v.get(e)),t},M=R.columns,I=["http://www.3ds.com/RDF/Corpus/Plan/hasAttachment","http://www.3ds.com/RDF/Corpus/Plan/actualDeliverable","http://www.3ds.com/RDF/Corpus/Plan/hasWorkContext","http://www.3ds.com/RDF/Corpus/Plan/hasContentRepository","http://www.3ds.com/RDF/Corpus/Plan/hasBookmark","http://www.3ds.com/RDF/Corpus/Plan/scheduleCalendar","http://www.3ds.com/RDF/Corpus/Plan/hasCommunity","http://www.3ds.com/RDF/Corpus/Plan/hasLeanBoard"],O=["http://www.3ds.com/RDF/Corpus/Plan/hasAssignee","http://www.3ds.com/RDF/Corpus/Plan/hasCandidateAssignee","http://www.3ds.com/RDF/Corpus/Kernel/owner","http://www.3ds.com/RDF/Corpus/Plan/hasNotifSubscriber","http://www.3ds.com/RDF/Corpus/Plan/hasNotifUnsubscriber"],P=["http://www.3ds.com/RDF/Corpus/Kernel/nlsLabel"],k=["http://www.3ds.com/RDF/Corpus/com/hasMaturity","http://www.3ds.com/RDF/Corpus/Plan/hasPriority"];t.extend({}).implement(n);var N=T.extend({_uwaClassName:"HistoryGridView",tagName:"span",createTreeDocument:function(){return new C},callRegisterReusableCellContent:function(t){t.forEach(t=>{this.registerReusableCellContent({id:t.id,buildContent:t.buildContent||function(){return e.createElement("div",{class:t.className})},getTweakerPadding:function(){return R.lengthOfEachCharacter}})})},setupResuableComponents:function(){this.callRegisterReusableCellContent([{id:R.reusableComponentIDs.auditDetails,className:"grid-object grid-member"}])},createNodeData:function(e){var t={};return t.date=e.date,t[S.COLUMN_DATA_INDICES.auditModifiedBy]=e.modifiedBy,t[S.COLUMN_DATA_INDICES.auditAction]=e.action,t[S.COLUMN_DATA_INDICES.auditType]=e.changetype,t[S.COLUMN_DATA_INDICES.auditDetails]=e.details,t},_mapRDFDataToS3Format:function(e){return e.historyEntries&&e.historyEntries.member.length>0?e.historyEntries.member.map(t=>{return{actorId:t.user,changeType:t.changetype,changes:t.changes.member,entryDate:t.date,resourceId:t.objectId,userAction:t.action,rootResourceId:e.rootObject.id}}):[]},_getGridViewData:function(t){var n=e.clone(t||{},!1),s=this._mapRDFDataToS3Format(n.rdfDataResponse).concat(n.s3BucketResponse).filter(e=>e.resourceId===n.parentView.model.id||e.rootResourceId===n.parentView.model.id&&"Deleted"===e.userAction),i={};return s.forEach(e=>{var n=e.entryDate,s=new Date(n),o=_.DATE_FORMAT.format(s),a=i[o];if(a)a.push(...this._getHistoryChangesDetails(n,e.changeType,e.userAction,e.actorId,e.changes,e.resourceId,t));else{var r=this._getHistoryChangesDetails(n,e.changeType,e.userAction,e.actorId,e.changes,e.resourceId,t);i[o]=r}}),i},_convertToModel:function(e,t,n,s,i){var a=!1;if(["<uuid:","uuid:","dscom:","dsplan:","dsxplan:","iam:","dskern:Person","dsxnpi:"].every(t=>!e.startsWith(t)||(a=!0,!1)),!a)return;let l;return(l=o.getObjectById(e))&&(l.get(t)||l.fetching||l.hasUsedMask(n)||l.getMask()===n)?l:i.fetchModelFromServer?l=s===r?o.getObjectForAdding(s,e,{attrs:{"@type":"dscom:ComponentProxy"},mask:n,ajax:i&&i.batchGenerator.ajax}):o.getObjectForAdding(s,e,{mask:n,ajax:i&&i.batchGenerator.ajax}):l},_isCustomAttribute:function(e,t){var n=t.parentView.model.get("customAttributes");return!!n&&[...new Set(Object.keys(JSON.parse(n)).map(e=>e.split(":")?e.split(":")[0]:""))].some(t=>e.includes(t))},_getHistoryChangesDetails:function(t,n,s,i,o,a,T){var g={},E=e.clone(T||{},!1);if("object"==typeof i&&null!==i)g.fullName=`${i.firstName} ${i.lastName}`,g.accountName=i.accountName;else{var A=this._convertToModel(i,"name","dsplan:MVMask.Person.Complex",d,T);A&&(g.fullName=A.getFullName()||A.get("dsxplan:jsType"),g.accountName=A.get("accountName"))}return(o=o.filter(e=>!P.includes(e.changedProperty))).map(e=>{var i=e.description,o=e.changedProperty;return I.includes(o)?i=this._getMeaningfulDescription(s,e,"title",a,"dsplan:MVMask.ComponentProxy.Complex",r,T):O.includes(o)||this._isCustomAttribute(o,T)?(i=this._getMeaningfulDescription(s,e,"name",a,"dsplan:MVMask.Person.Complex",d,T),_.isProject(E.parentView.model.get(h.PROJECT_TYPE))&&(i=i.replace("Assignee",b("E6WCommonApps.Label.ProjectManager")))):"http://www.3ds.com/RDF/Corpus/Plan/hasWorkDecomposition"===o?i=(i=this._getMeaningfulDescription(s,e,"name",a,"dsplan:MVMask.WorkPackage.Basic",D,T)).replace("Work Decomposition",b("E6WCommonApps.Label.SubProject")):"http://www.3ds.com/RDF/Corpus/Plan/hasTask"===o?i=this._getMeaningfulDescription(s,e,"title",a,"dsplan:MVMask.Task.Basic",c,T):"http://www.3ds.com/RDF/Corpus/Plan/hasMilestone"===o?i=this._getMeaningfulDescription(s,e,"title",a,"dsplan:MVMask.Milestone.Basic",u,T):"http://www.3ds.com/RDF/Corpus/Plan/hasBaseline"===o?i=this._getMeaningfulDescription(s,e,"dsxplan:label",a,"dsplan:MVMask.Baseline.Basic",p,T):"http://www.3ds.com/RDF/Corpus/Plan/hasReferenceProject"===o?i=this._getMeaningfulDescription(s,e,"name",a,"dsplan:MVMask.WorkPackage.Complex",D,T):"http://www.3ds.com/RDF/Corpus/Kernel/comment"===o?i=i.replace("dskern:comment",b("E6WCommonApps.Label.Description")):"http://www.3ds.com/RDF/Corpus/Plan/schedulingStrategy"===o?i=(i=i.replace(m.TEMPORAL_SCHEDULING_STRATEGY,b("E6WCommonApps.Label.TimeOnly"))).replace(m.RESOURCE_LEVELING_STRATEGY,b("E6WCommonApps.Label.TimeAndResource")):(E.fetchModelFromServer=k.includes(o),i=this._getMeaningfulDescription(s,e,"title",a,"dskern:Mask.Default",l,E)),{date:t,modifiedBy:g,changetype:n,action:s,details:i}})},_getMeaningfulDescription:function(e,t,n,s,i,o,a){var r,l,d=t.newValue,c=t.oldValue,p=t.description;const u=e=>{r=this._convertToModel(e,n,i,o,a),p=r&&(l=r.get(n))?(p=(p=p.replace(e,l)).replace(/[<>]/g,"")).includes(l)?p:`'${l}' ${p}`:p.includes(e)?p:`${p}`};return e===m.ADDED?u(d):e===m.DELETED?u(s):e===m.REMOVED?u(c):e===m.MODIFIED&&(u(c),u(d)),p},_handleAddAuditHistory:function(){for(var e in y=this.createTreeDocument(),this._historyData){var t=this._historyData[e],n={date:e},s=new f({label:n.date,grid:n});t.forEach(e=>{var t=this.createNodeData(e);s.addChild({label:t.date,grid:t})}),y.addChild(s)}y.prepareUpdate(),y.expandAll(),y.pushUpdate()},destroy:function(){y&&e.is(y.getTreeDocument,"function")&&y.getTreeDocument().destroy(),y.destroy(),this._parent.apply(this,arguments)},_addFilterModel:function(){S.COLUMN_DATA_INDICES.auditDetails;y&&y.setFilterModel({auditDetails:{filterId:"string",filterModel:{condition1:{type:"startsWith"},operator:"and",condition2:{type:"contains"}}}})},_onCompleteAsyncProcess:function(t){var n=e.clone(t||{},!1);this._historyData=this._getGridViewData(t),this._handleAddAuditHistory(),this._parentInit&&(this._parentInit({identifier:"HistoryGridView",treeDocument:y,columns:M,rowSelection:"single",cellSelection:"none",showRowIndexFlag:!1,showSelectionCheckBoxesFlag:!1,cellActivationFeedback:"row",paginationManager:new g({pageSize:30,nodeDepth:-1,currentPage:1})}),this.sortModel=[{dataIndex:"tree",sort:"desc"}],this.buildStatusBar([{type:E.STATUS.PAGINATION,position:"far"}]),this.setupResuableComponents(),this.onPostUpdateViewOnce(()=>{var e=this.elements.statusBar.elements.container;e.hasAttribute("touch-mode")&&e.removeAttribute("touch-mode"),e.getElements("[touch-mode]").forEach(e=>e.removeAttribute("touch-mode")),this._renderToolbar(t)}),n.onComplete&&n.onComplete.apply(this,arguments))},_renderToolbar:function(t){var n=e.clone(t||{},!1).parentView.model,s={entries:[{id:"exportToCSVId",dataElements:{typeRepresentation:"functionIcon",icon:{iconName:"export",fontIconFamily:1},value:()=>{_.displayInfo(b("E6WCommonApps.Label.ExportStarted"));var e=this._getWholeHistoryDataAsCsv();_.saveBlobToFile(e,n),_.displaySuccess(b("E6WCommonApps.Label.ExportDone"))},tooltip:"Export History contents to CSV"}}]},i=this.setToolbar(s);this.elements.container&&this.elements.container.prepend(i.getContent())},_getWholeHistoryDataAsCsv:function(){var e=`${b("E6WCommonApps.Label.AuditHistoryDate")},${b("E6WCommonApps.Label.AuditHistoryAction")},${b("E6WCommonApps.Label.AuditHistoryType")},${b("E6WCommonApps.Label.AuditHistoryDetails")},${b("E6WCommonApps.Label.AuditHistoryModifiedBy")}\n`,t=[];for(var n in this._historyData)if(this._historyData.hasOwnProperty(n)){var s=this._historyData[n];t=t.concat(s)}return t.sort(function(e,t){return new Date(t.date)-new Date(e.date)}),e+t.map(function(e){return`${e.date},${e.action},${e.changetype},"${e.details}",${e.modifiedBy.fullName}`}).join("\n")},init:function(t){var n=e.clone(t||{},!1);n.fetchModelFromServer=!0,n.batchGenerator=o.getBatchGenerator(),this._parentInit=this._parent,this._onCompleteAsyncProcess(n),n.batchGenerator.requests.length>0&&n.batchGenerator.sendBatch({onComplete:t=>{if(1===n.batchGenerator.requests.length)n.parentView&&n.parentView.initAuditHistoryView(n.rdfDataResponse,n.s3BucketResponse);else{var s=a.parseBatchRequest(t);e.is(s[0],"array")&&n.parentView&&n.parentView.initAuditHistoryView(n.rdfDataResponse,n.s3BucketResponse)}}})}});return N.implement(s),N.implement(n),N}),define("DS/E6WCommonApps/Models/RDFTaskCloneModel",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/Models/ScheduleElementCloneModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/E6WCommonApps/ReparentingUtils","DS/E6WCommonApps/E6WNonWorkingDayIterator","DS/E6WCommonApps/Preferences","DS/RDFFoundation/MemberUtils","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/TaskValidator","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h){"use strict";var m=function(e){return h.get(e)};return i.extend(u,{_uwaClassName:"RDFTaskCloneModel",getWorkDayLength:function(){return this.model.getWorkDayLength()},_updateRanges:function(e,n,s){var i=this.get(t.DURATION),o=this.get(t.DURATION_RANGE),a=s&&s.settingDuration,r=s&&s.settingRange;!a&&i!==e&&this.dispatchEvent("onChange:"+t.DURATION,[this,i]),!r&&o!==n&&this.dispatchEvent("onChange:"+t.DURATION_RANGE,[this,o]),this.validationError=this.validate(this.toJSON()),this.validationError?this.dispatchEvent("onValidationFailure"):this.dispatchEvent("onValidationSuccess")},setupNonWorkingDayIterator:function(){var t;if(this.model.id)t=this.model.getProjectParent(this.model);else{var s=this.model.model;t=s&&e.is(s.getObjectType,"function")&&n.isTask(s.getObjectType())?s.getProjectParent(s):s}this.nonWorkingDayIterator=t&&t.getNonWorkingDayIterator&&t.getNonWorkingDayIterator()},init:function(){this._parent.apply(this,arguments),this.setupNonWorkingDayIterator();var e={};e["onChange:"+t.DURATION_MAX]=e["onChange:"+t.DURATION_MIN]=function(e,t,n){this._updateRanges(void 0,void 0,n)},this.listenTo(this,e)},toJSON:function(){var e=this._parent.apply(this,arguments);return e[t.DURATION]=this.get(t.DURATION),e[t.DURATION_RANGE]=this.get(t.DURATION_RANGE),e[t.DURATION_ESTIMATED]=this.get(t.DURATION_ESTIMATED),e},dataForRendering:function(e){var s=this._parent.apply(this,arguments);s[t.DURATION]=this.get(t.DURATION),s[t.DURATION_RANGE]=this.get(t.DURATION_RANGE),s[t.DURATION_ESTIMATED]=this.get(t.DURATION_ESTIMATED),s[t.DURATION_ESTIMATED_RANGE]=this.get(t.DURATION_ESTIMATED_RANGE),s[t.DURATION_ACTUAL]=this.get(t.DURATION_ACTUAL),s[t.ESTIMATED_DATE_ATTR]=this.get(t.ESTIMATED_DATE_ATTR),s[t.STARTDATE_ATTR]=this.get(t.STARTDATE_ATTR),s[t.ENDDATE_ATTR]=this.get(t.ENDDATE_ATTR),s[t.ACTUAL_START_DATE]=this.get(t.ACTUAL_START_DATE),s[t.ACTUAL_END_DATE]=this.get(t.ACTUAL_END_DATE),s[t.BASELINE_ESTIMATED_START_DATE]=this.get(t.BASELINE_ESTIMATED_START_DATE),s[t.BASELINE_ESTIMATED_END_DATE]=this.get(t.BASELINE_ESTIMATED_END_DATE),s[t.BASELINE_ACTUAL_START_DATE]=this.get(t.BASELINE_ACTUAL_START_DATE),s[t.BASELINE_ACTUAL_END_DATE]=this.get(t.BASELINE_ACTUAL_END_DATE),s[t.CREATION_DATE_ATTR]=this.get(t.CREATION_DATE_ATTR),s[t.LASTUPDATED_ATTR]=this.get(t.LASTUPDATED_ATTR);var i=s[t.COMMON_TASK_PARENT_ATTR];if(i&&"dsplan:DummyProject"===i.physicalId)s[t.COMMON_TASK_PARENT_ATTR]=[];else if(e.attributes.includes(t.COMMON_TASK_PARENT_ATTR)){var o=this.get(t.COMMON_TASK_PARENT_ATTR);o&&"dsplan:DummyProject"!==o.id&&(s[t.COMMON_TASK_PARENT_ATTR]=[o.toJSON(e)]),n.removeFromArray(e.attributes,t.COMMON_TASK_PARENT_ATTR)}return e.attributes&&e.attributes.forEach(e=>{s[e]||(s[e]=this.get(e),"object"==typeof s[e]&&(s[e]=this.get(e),this.get(e)&&this.get(e).dataForRendering&&(s[e]=this.get(e).dataForRendering())))}),s},get:function(s){switch(s){case t.DURATION:return this.getDuration();case t.DURATION_ACTUAL:return this.getFormattedActualDuration();case t.DURATION_RANGE:return this.getDurationOffset();case t.DURATION_ESTIMATED_RANGE:return this.getDurationRangeFormat(this.getDuration(),this.getDurationOffset());case t.BASELINE_ESTIMATED_START_DATE:return l.getBaselineFormattedDate("start",this.model);case t.BASELINE_ESTIMATED_END_DATE:return l.getBaselineFormattedDate("end",this.model);case t.BASELINE_ACTUAL_START_DATE:return l.getBaselineFormattedDate("actualStart",this.model);case t.BASELINE_ACTUAL_END_DATE:return l.getBaselineFormattedDate("actualEnd",this.model)}var i=this._parent.apply(this,arguments);if(i)switch(s){case t.ESTIMATED_DATE_ATTR:case t.ENDDATE_ATTR:case t.STARTDATE_ATTR:case t.ACTUAL_START_DATE:case t.ACTUAL_END_DATE:i=n.getIntlDateFormat(i);break;case t.CREATION_DATE_ATTR:case t.LASTUPDATED_ATTR:i=n.getIntlDateTimeFormat(i);break;case t.DURATION_ESTIMATED:case t.DURATION_MIN:case t.DURATION_MAX:i=p.xsdDayTimeDurationToMilliseconds(i)/(60*this.getWorkDayLength()*60*1e3);break;case t.STATE_ATTR:return e.is(i,"object")&&!enoviaServer.useFD01CodeFor3DPlan?i.id:i}return i},getFormattedActualDuration:function(){var e,n=this.get(t.ACTUAL_START_DATE),s=this.get(t.ACTUAL_END_DATE);if(n&&s){var i=s.actualValue.getTime()-n.actualValue.getTime(),o=(this.nonWorkingDayIterator&&this.nonWorkingDayIterator.countWorkingDays(n.actualValue,s.actualValue)||Math.round(i/p.MS_DAY))+" "+m("E6WCommonApps.Label.Days");e={actualValue:o,displayValue:o}}return e},getDurationRangeFormat:function(e,t){let n=e+" "+m("E6WCommonApps.Label.Days")+" "+m("E6WCommonApps.Label.PlusMinusOffset")+" "+t;return{actualValue:n,displayValue:n}},getDurationOffset:function(){if(this.model.get("dsxplan:hasSubtask")&&this.model.get("dsxplan:hasSubtask").length>0){let e=this.model.getSubtasks(),t=0;return e._models.forEach(e=>{t=e.getSuggestedOffset&&e.getSuggestedOffset()>t?e.getSuggestedOffset():t}),t}var e=i.prototype.get.call(this,t.DURATION_RANGE);if(void 0===e||isNaN(e)){var n=this.get(t.DURATION_MIN),s=this.get(t.DURATION_MAX);void 0!==n&&void 0!==s||(e=0),e=(s-n)/2}return e},getDuration:function(){if(this.model.get("dsxplan:hasSubtask")&&this.model.get("dsxplan:hasSubtask").length>0&&this.getEndDate()&&this.getStartDate()){return this.nonWorkingDayIterator&&this.nonWorkingDayIterator.countWorkingDays(this.getStartDate().actualValue,this.getEndDate().actualValue)}var e=i.prototype.get.call(this,t.DURATION);if(void 0===e){var n=this.get(t.DURATION_MIN),s=this.get(t.DURATION_MAX);e=void 0===n?s:void 0===s?n:(n+s)/2}if(e<1e6)return e},_setDuration:function(n,s,i){var o,a,r;o=!1;var l=s,d=e.clone(i||{},!1),c=d&&d.whisper;c&&delete d.silent;var p,u=d&&d.silent;if(n===t.DURATION_MIN||n===t.DURATION_MAX){var h=this.get(t.DURATION),m=this.get(t.DURATION_RANGE);l=this.model.getDaysAsString(s),this.cleanupLocalAttributes(),o=d.parent.call(this,n,l,d);var T=d.settingDuration;!d.settingRange&&!T&&this._updateRanges(h,m,d),o={handled:!0,returnValue:o}}else n===t.DURATION?(e.is(s,"string")&&(l=parseFloat(s,10)),r=this.get(t.DURATION_RANGE),a=l,d.settingDuration=!0,p=d.validate,d.validate=!1,o=this._setComputedMinAndMaxVal(a,r,d),d.validate=p,d.parent.call(this,n,l,d),u||c||this.dispatchEvent("onChange:"+t.DURATION,[this,l,d]),o={handled:!0,returnValue:o}):n===t.DURATION_RANGE&&(e.is(s,"string")&&(l=parseFloat(s,10)),a=this.get(t.DURATION),r=l,d.settingRange=!0,p=d.validate,d.validate=!1,o=this._setComputedMinAndMaxVal(a,r,d),d.validate=p,d.parent.call(this,n,l,d),u||c||this.dispatchEvent("onChange:"+t.DURATION_RANGE,[this,l,d]),o={handled:!0,returnValue:o});return o},add:function(s,i,r){var l,d;if(s!==t.COMMON_TASK_PARENT_ATTR||(r&&(r.isObject=!(i instanceof e.Class.Model||i instanceof FileList||i instanceof File)),(l=this.getDetailedObjectToBeAdded(s,i,r))&&(d=l.getObjectType()),!d||d!==t.TASK||p.removeBracketLongURI(i)!==p.removeBracketLongURI(this.model.id))){var c=this._parent.apply(this,arguments),u=Array.prototype.slice.call(arguments,0);if(s===t.COMMON_TASK_PARENT_ATTR&&d&&d!==t.OBJECT){if(d===t.TASK){var m=this,T={};T.parentId=i,T.childId=this.model.id,T.type=o,T.onComplete=function(e){if(e["@value"]||e.value){var s=u[2].dropObj,i=r.detailedObjects,o=i?i[0].label:s.displayName,a=h.replace(n.i18n("E6WCommonUI.Alert.ChildIsAlreadyInParentStructure"),{PARENT_NAME:o,CHILD_NAME:m.model.get("title")});n.displayError(a),m.remove(t.PARENT_ATTR,void 0,r)}else m.remove(t.PARENT_ATTR,void 0,r),m.add(t.TASK_PARENT_ATTR,m.id,r)},a.checkParentHierarchyForId(T)}d!==t.PROJECT&&d!==t.XPROJECT||(this.remove(t.TASK_PARENT_ATTR,void 0,r),this.add(t.PARENT_ATTR,l.id,r))}return c}n.displayError(n.i18n("E6WCommonUI.Alert.PlanOwnChild"))},isProjectTask:function(){return this.model.isProjectTask()},isStandaloneTask:function(){return Boolean(!this.get(t.HAS_PARENT_ATTR))},set:function(s,i,o){var a=i,r=e.clone(o||{},!1);r.parent=this._parent;var l,d=this._setDuration(s,i,r);if(delete r.parent,d.handled)return d.returnValue;if(((l=s)===t.ENDDATE_ATTR||l===t.STARTDATE_ATTR||l===t.ACTUAL_START_DATE||l===t.ACTUAL_END_DATE)&&a&&a.actualValue&&(a=new Date(a.actualValue),s===t.ENDDATE_ATTR)){let e=a.getDay(),n=this.nonWorkingDayIterator&&this.nonWorkingDayIterator._workingHours[e]&&this.nonWorkingDayIterator._workingHours[e].end.totalMinutes||60*t.DEFAULT_END_HOUR;a=new Date(a.getTime()+6e4*n)}if((s===t.STATE_ATTR&&!enoviaServer.useFD01CodeFor3DPlan||s===t.PRIORITY_ATTR)&&(a=a&&a.actualValue?a.actualValue:a)&&(a=p.getObjectForAdding(c,a)),s===t.STATE_ATTR&&i&&i.actualValue&&i.actualValue===t.STATE_IN_PROGRESS&&void 0===this.get(t.ACTUAL_START_DATE)){var u=this.get(t.PARENT_ATTR);if(u&&n.isProject(u.get(t.TYPE_ATTR))){var h=u.get(t.ACTUAL_DATES_STRATEGY_ATTR);if(h&&h.toString()===t.PLANNED_DATES_STRATEGY){var m=this.get(t.STARTDATE_ATTR);if(m){var T=new Date(m.actualValue),g=new Date,E=T<g?m:g;this.set(t.ACTUAL_START_DATE,E,r)}}else this.set(t.ACTUAL_START_DATE,new Date,r)}else this.isStandaloneTask()&&this.set(t.ACTUAL_START_DATE,new Date,r)}s===t.STATE_ATTR&&i&&i.actualValue&&i.actualValue===t.STATE_OPEN&&void 0!==this.get(t.ACTUAL_START_DATE)&&delete this.localAttributes[t.ACTUAL_START_DATE];var A=this._parent(s,a,o);return s!==t.USER_DEFINED_START_DATE_ATTR&&s!==t.USER_DEFINED_END_DATE_ATTR||this.dispatchEvent("onChange:"+s,[this,a,r]),A},remove:function(e,n,s){if(e===t.COMMON_TASK_PARENT_ATTR){var i=this.get(e);if(i){var o=i.getObjectType()===t.TASK?t.TASK_PARENT_ATTR:t.PARENT_ATTR;this.remove(o,i.id,s)}}this._parent(e,n,s)},_setComputedMinAndMaxVal:function(n,s,i){var o=i&&i.silent,a=e.clone(i||{},!1),r=n-s,l=n+s,d=this.modificationsPending;this.modificationsPending=!0,o||d===this.modificationsPending||this.dispatchEvent("onChange:modificationsPending",[this]);var c=a.validate;a.validate=!1;var p=!isNaN(r)&&this.set(t.DURATION_MIN,r,a),u=!isNaN(l)&&this.set(t.DURATION_MAX,l,a);a.validate=c;var h,m,T=new Date(this.getStartDate()&&(this.getStartDate().actualValue||this.getStartDate()));if(this.isEndDateFixed()){if(!this.isStarted()&&!this.isStartDateFixed()){var g=this.get(t.ENDDATE_ATTR);g=g&&(g.actualValue||g),(T=new Date(g)).setDate(T.getDate()-(l+r)/2),h=T,m=t.STARTDATE_ATTR}}else{let e=(l+r)/2;m=t.ENDDATE_ATTR,h=this.calculateEndDate(T,e)}return this.set(m,h,a),a.whisper&&(delete a.detailsDisplayViewDebounce,this.dispatchEvent("onChange:"+m,[this,h,a])),this.set(t.DURATION_ESTIMATED,this.model.getDaysAsString(n),a),p&&u},calculateEndDate:function(e,t){let n=new Date(e),s=0;if(this.nonWorkingDayIterator&&!isNaN(t))if(t<=30)for(;s<t-1;)n.setDate(n.getDate()+1),this.nonWorkingDayIterator._recurringNonWorkingDays.includes(n.getDay())||this.nonWorkingDayIterator._isHoliday(n)||s++;else{let s=new Date(e),i=Math.floor(t/(7-this.nonWorkingDayIterator._recurringNonWorkingDays.length))*this.nonWorkingDayIterator._recurringNonWorkingDays.length;s.setDate(s.getDate()+(t+i-1)),0===s.getDay()&&s.setDate(s.getDate()-2),n=s}return n},cleanupLocalAttributes:function(){delete this.localAttributes[t.DURATION],delete this.localAttributes[t.DURATION_RANGE],delete this.localAttributes[t.COMMON_TASK_PARENT_ATTR],delete this.localRelatedData[t.COMMON_TASK_PARENT_ATTR]},save:function(t){this.cleanupLocalAttributes();var n=Array.prototype.slice.call(arguments,0),s=e.clone(t||{},!1);return n[0]=s,s.animate=!0,this.nonWorkingDayIterator&&(s.nonWorkingDayIterator=this.nonWorkingDayIterator),this._parent.apply(this,n)},isWedo:function(){return Boolean(this.get(t.PARENT_HAS_SWYM_COMMUNITY))},isLeanTask:function(){return Boolean(this.get(t.PARENT_HAS_LEAN_BOARD))}})}),define("DS/E6WCommonApps/Models/ScheduleElementPopupModel",["UWA/Core","UWA/Class/Events","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/ScheduleConstants","DS/E6WCommonApps/Models/MilestoneModel","DS/E6WCommonApps/Models/GateModel","DS/E6WCommonApps/Models/RDFTaskCloneModel","DS/E6WCommonApps/Models/RDFTaskModel","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/TaskValidator","DS/E6WCommonApps/Models/ConstraintModel","DS/E6WCommonApps/Models/WorkscopeModel","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h){"use strict";var m=h.get.bind(h);return t.extend(c,a,{_uwaClassName:"ScheduleElementPopupModel",init:function(t){this._parent.apply(this,arguments);var n=e.clone(t||{},!1);if(this.model=n.model,this.type=n.elementType,this[s.TITLE_ATTR]="",this[s.DESCRIPTION_ATTR]="",this.parent=n.model&&e.is(n.model.get,"function")&&n.model.get(s.TITLE_ATTR),this.canEdit=!0,this.listenTo(this,"onChange:"+s.ASSIGNEE_ATTR,this.handleAssigneeField),this.listenTo(this,"onChange:"+p.ENFORCE_ATTR,this.handleAssigneeField),this.listenTo(this,"onChange:"+p.TYPE_ATTR,this.handleAssigneeField),n.elementType===s.MILESTONE||n.elementType===s.GATE){var i=Date.now(),o=new Date(i);o.setHours(0,0,0,0);var a=o.getTime()+s.EOD_TIMEOFFSET,r=new Date(a);this[s.SUGGESTED_DATE_ATTR]={actualValue:r},this[s.USER_DEFINED_DATES_ATTR]="TRUE",n.elementType===s.MILESTONE?this[s.ACTUAL_TYPE_ATTR]=s.MILESTONE_RDF_TYPE:n.elementType===s.GATE&&(this[s.ACTUAL_TYPE_ATTR]=s.GATE_RDF_TYPE)}else n.elementType===s.TASK?(this[s.ACTUAL_TYPE_ATTR]=s.TASK_RDF_TYPE,this[s.DURATION_MIN]=1,this[s.DURATION_MAX]=1,this[s.DURATION]="1",this[s.DURATION_RANGE]="0",n.taskTab&&(2===n.noOfClicks?this[s.REPEAT_CREATE_TASK]=!0:this[s.REPEAT_CREATE_TASK]=!1),l.serverHasDSLC()&&(this[s.ACTUAL_TYPE_ATTR]="dsplan:Task")):n.elementType===s.CONSTRAINT&&(this[p.LAG_ATTR]="0",this[p.TYPE_ATTR]={actualValue:p.TYPE_FINISH_TO_START,displayValue:m("E6WCommonApps.Label.FinishToStart")},this[p.ENFORCE_ATTR]=!0)},_clearTaskFields:function(){this[s.TITLE_ATTR]="",this[s.DESCRIPTION_ATTR]="",this[s.DURATION_MIN]=1,this[s.DURATION_MAX]=1,this[s.DURATION]="1",this[s.DURATION_RANGE]="0",delete this[s.ASSIGNEE_ATTR],delete this[s.STARTDATE_ATTR],delete this[s.USER_DEFINED_START_DATE_ATTR],delete this[s.ENDDATE_ATTR],delete this[s.USER_DEFINED_END_DATE_ATTR],delete this[p.SUCCESSOR_ATTR],delete this[p.PREDECESSOR_ATTR],delete this[p.CONSTRAINT_TYPE_ATTR],this.localRelatedData={}},_getTaskIconURL:function(){return require.toUrl("DS/E6WCommonApps/assets/img/iconSmallTask.png")},_getMilestoneIconURL:function(){return require.toUrl("DS/E6WCommonApps/assets/img/iconSmallMilestone.png")},add:function(e,t,s){if(e!==p.PREDECESSOR_ATTR&&e!==p.SUCCESSOR_ATTR||!s)return this._parent.apply(this,arguments);var o,a=s.detailedObjects,d=s.dropObj,c=d?d.objectId:a[0].id;o=d?d.objectType:a[0].model?a[0].model.getObjectType():a[0]["ds6w:type"];var u=n.isTaskAnyType(o)?r:i,h=l.getObjectForAdding(u,c,{mask:"dsplan:MVMask.WorkPackage.Basic"});d?(d.image?h.image=d.image:n.isTaskAnyType(d.objectType)?h.image=this._getTaskIconURL():h.image=this._getMilestoneIconURL(),h.label=d.displayName):a[0]["ds6w:created"]?(h.image=a[0].preview_url,h.label=a[0]["ds6w:label"]):(h.image=a[0].image,h.label=a[0].label),this[e]=h,this.dispatchEvent("onChange:"+e),this._setDisabledClassOnCreateButton()},remove:function(e,t,n){this[e].at?this[e].remove(this[e].at(t)):delete this[e],this.dispatchEvent("onChange:"+e,[this,n]),t>-1&&this.localRelatedData[e]&&this.localRelatedData[e].splice(t,1),this._setDisabledClassOnCreateButton()},set:function(t,n,i){var o=n,a=e.clone(i||{},!1);if(a&&a.whisper&&delete a.silent,"dsplan:suggestedDate"===t)o.actualValue+=s.EOD_TIMEOFFSET;else if(t===p.ENFORCE_ATTR)o="FALSE"===n;else if(t===s.TASK_TYPE)o=n.actualValue?n.actualValue:"";else if(t===s.TASK_COLLAB_SPACE){var r=this[s.TASK_COLLAB_SPACE].filter(e=>e.displayValue!==n.displayValue);r.unshift(n),o=r,this._updateOrganizationDropdownOptions(n.actualValue),window.enoviaServer.space=this._getAssignedCollabSpaceOrganization(n.actualValue[0].value)}else if(t===s.TASK_ORGANIZATION){var l=this[s.TASK_ORGANIZATION].filter(e=>e.displayValue!==n.displayValue);l.unshift(n),o=l,window.enoviaServer.space=this._getAssignedCollabSpaceOrganization(n.actualValue)}this[t]=o,this.setTaskAttr(t,n,a),t!==p.ENFORCE_ATTR&&t!==s.TASK_TYPE&&t!==s.TASK_COLLAB_SPACE&&t!==s.CUSTOMER_EXTENSION||this.dispatchEvent("onChange:"+t),a.validate&&this.validate&&(this.validationError=this.validate(this,a),!a.silent&&this.validationError&&this.dispatchEvent("onValidationFailure")),this._setDisabledClassOnCreateButton()},_getAssignedCollabSpaceOrganization:function(e){var t=e.find(e=>e.includes("Leader")),n=e.find(e=>e.includes("Admin")),s=e.find(e=>e.includes("Reader"))||e.find(e=>e.includes("Viewer"));return t||n||s||e[0]},_updateOrganizationDropdownOptions:function(e){var t=e.map(e=>({actualValue:e.value,displayValue:e.name}));this[s.TASK_ORGANIZATION]=t},_setDisabledClassOnCreateButton:function(){var e=this[s.TITLE_ATTR],t=this[p.PREDECESSOR_ATTR],n=this[p.SUCCESSOR_ATTR];this.type===s.CONSTRAINT?this.createButton.toggleClassName("disabled",Boolean(!(t&&n&&t.id!==n.id))):(this.createAndOpenButton&&this.createAndOpenButton.toggleClassName("disabled",Boolean(!e||!e.trim().length||this.validationError)),this.createButton&&this.createButton.toggleClassName("disabled",Boolean(!e||!e.trim().length||this.validationError)))},setTaskAttr:function(e,t,i){if(e===s.DURATION||e===s.DURATION_RANGE){var o=parseFloat(this.get(s.DURATION)),a=parseFloat(this.get(s.DURATION_RANGE));this[s.DURATION_MIN]=o-a,this[s.DURATION_MAX]=o+a}var r;"startStop"===i.type&&(t=t&&new Date(t.actualValue)||"",this[e]={actualValue:t},e===s.STARTDATE_ATTR?(r=s.USER_DEFINED_START_DATE_ATTR,n.isIpad()||n.isAndroid()||this.dispatchEvent("onChange:"+s.STARTDATE_ATTR)):e===s.ENDDATE_ATTR&&(r=s.USER_DEFINED_END_DATE_ATTR,n.isIpad()||n.isAndroid()||this.dispatchEvent("onChange:"+s.ENDDATE_ATTR)),this[r]=n.isValidDate(t))},get:function(e){return this[e]},getModelForAssigneeTypeahead:function(){return this},validate:function(){var e;switch(this.type){case s.TASK:e=c.prototype.validate.apply(this,arguments);break;case s.MILESTONE:e=i.prototype.validate_.apply(this,arguments)}return e},dataForRendering:function(){var e=this._parent.apply(this,arguments);return n.setHelper.apply(this,arguments).attrs.attributes.forEach(function(t){if(t!==s.ASSIGNEE_ATTR)t===p.ENFORCE_ATTR?(void 0===this[t]&&(this[t]=!0),e[t]=this[t]?"FALSE":"TRUE"):e[t]=this[t];else{var n=[],i=this[t];if(i)for(var o=i.length,a=0;a<o;a++)n.push(i.at(a).dataForRendering());e[t]=n}}.bind(this)),e},handleAssigneeField:function(e,t){var n=e[s.ASSIGNEE_ATTR];if(n||(n=new d),"add"===t.operation){var i=t.added;n.add(i,{at:0})}if("remove"===t.operation){var o=t.removed;n.remove(o)}e[s.ASSIGNEE_ATTR]=n}})}),define("DS/E6WCommonApps/Views/FixedStartStopView",["UWA/Core","DS/Controls/Toggle","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonUI/Views/StartStopView","DS/E6WCommonUI/UIHelper","DS/Handlebars/Handlebars4","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","text!DS/E6WCommonApps/assets/templates/fixedstartstop.html.handlebars"],function(e,t,n,s,i,o,a,r){"use strict";var l=o.compile(r);return s.extend({setup:function(){this._parent.apply(this,arguments),this.model&&(this.listenTo(this.model,"onValidationSuccess",function(){for(var e=this.container.getElements(".has-error"),t=0;t<e.length;t++)e[t].toggleClassName("has-error",!1)}),this.listenTo(this.model,"onChange:"+this._config.isEndDateManualAttribute,this.render),this.listenTo(this.model,"onChange:"+this._config.isStartDateManualAttribute,this.render))},domEvents:{'change input.data-entry[type="checkbox"]':"_toggleDataEntry"},setFixed:function(t,s){var i=e.clone(this._config,!1),o=s?n.USER_DEFINED_START_DATE_ATTR:n.USER_DEFINED_END_DATE_ATTR;i.name=o,this.normalizedSet(this.model,i,t)},render:function(){this._parent.apply(this,arguments);let e=this._config.readWrite;e||(e=!1);let t=this.normalizedGet(this.model,"canEdit")&&e;if(this.moveLabelPosition("top"),!0===this._config.showFixedPin){var s=this.model.get(n.STARTDATE_ATTR),i=this.model.get(n.ENDDATE_ATTR),o=this.container.getElement(".start label"),r=this.container.getElement(".stop label");this._togglePinVisibility(o,s),this._togglePinVisibility(r,i)}else{var d=!t||this.model.isStarted();d||this.container.getElement(".start").addContent(l({id:"start"+(new Date).getTime(),label:a.get("E6WCommonApps.Label.Fixed"),checked:!0===this.model.isStartDateFixed(),disabled:d}));var c=!t||this.model.isComplete();c||this.container.getElement(".stop").addContent(l({id:"stop"+(new Date).getTime(),label:a.get("E6WCommonApps.Label.Fixed"),checked:!0===this.model.isEndDateFixed(),disabled:c}))}return this},_togglePinVisibility:function(t,n){t.addClassName("fixed-date"),e.createElement("span",{class:"fonticon fonticon-pin hidden"}).inject(t);var s=t.getElement(".fonticon-pin");n=n&&n.actualValue||n,s&&s.toggleClassName("hidden",!i.isValidDate(n))},_toggleDataEntry:function(t){var n=e.Event.getElement(t);this.setFixed(n.checked,n.id.startsWith("start"))}})}),define("DS/E6WCommonApps/Views/PropertyPanel",["UWA/Core","DS/UIKIT/Scroller","DS/WAFData/WAFData","DS/SocialToolbar/SocialToolbar","DS/Handlebars/Handlebars4","DS/UIKIT/SuperModal","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplayView","DS/E6WCommonUI/Views/E6WHandlebarsHelpers","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/TagUtils","DS/E6WCommonApps/SubscriptionUtils","DS/E6WCommonApps/Views/HistoryGridView","DS/E6WCommonApps/ScheduleConstants","DS/E6WCommonApps/Models/E6WCommonAppsConstants","text!DS/E6WCommonApps/assets/templates/propertypanel.html.handlebars","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,g,E,A,C){"use strict";var f=i.compile(E),_=r.extend({i18n:function(e){var t=C.get(e);return t===e&&(t=A.get(e)),t},propertyComponentFields:{},_uwaClassName:"E6WCommonUIPropertyPanel",tagName:"div",className:"property-panel",name:"E6WCommonUI.PropertyPanel",domEvents:{"click #cancelButton":"cancel","click #commentsTab":"onCommentsTabClicked","click #detailsTab":"onDetailsTabClicked","click #membersTab":"onMembersTabClicked","click #classificationTab":"onClassificationTabClicked","click #characteristicsEditorViewTab":"onCharacteristicsEditorViewTabClicked","click #historyTab":"onHistoryTabClicked","click #checklistTab":"onChecklistTabClicked","click #closeButton":"close","click #saveButton":"save","dragover  .panel-tab":"handleDragOver","dragleave  .panel-tab":"handleDragLeave","click #openMenuButton":"openMenu","click #openSubButtonPropertPanel":"openSubButtonPropertPanel"},id:function(){return"e6WCommonUIPropertyPanel"+this.cid},handleDragLeave:function(){this._dragOverTimeout&&clearTimeout(this._dragOverTimeout),delete this._dragOverTimeout},openMenu:function(){this._dropDownMenu&&0==this._dropDownMenu.isVisible&&this._dropDownMenu.show()},openSubButtonPropertPanel:function(){h.toggleUserSubscription(this.model)},handleDragOver:function(t){var n=this;return this._dragOverTimeout||(this._dragOverTimeout=setTimeout(function(){t.preventDefault&&t.preventDefault(),t.dataTransfer&&(t.dataTransfer.dropEffect="copy");var s=e.Event.getElement(t);s.getElement(".panel-tab")||(s=s.getClosest(".panel-tab")),"detailsTab"===s.id?n.onDetailsTabClicked():"membersTab"===s.id?n.onMembersTabClicked():"commentsTab"===s.id?n.onCommentsTabClicked():"historyTab"===s.id?n.onHistoryTabClicked():"checklistTab"===s.id&&n.onChecklistTabClicked()},1e3)),!1},createDetailsDisplayView:function(e){this._detailsView=new l(e)},setup:function(t){var n=e.clone(t||{},!1),s=n.alertMessageContainer||this.container;this._parent.apply(this,arguments),this.modal=new o({renderTo:s,okButtonText:this.i18n("E6WCommonApps.Command.Yes"),koButtonText:this.i18n("E6WCommonApps.Command.No")});var i=this.cloneModelForDetailDisplayView();i&&(i.validationError=e.is(i.validate,"function")&&i.validate(i.toJSON()));var a=e.clone(t.detailsViewParameters||{},!1);a.model=i,a.context=t.context,a.i18n=this.i18n,a.tenant=window.enoviaServer.tenant,a.isPropertyPanel=!0,a.isShadowMilestoneGate=n.isShadowMilestoneGate,this.createDetailsDisplayView(a),this.addChildView(this._detailsView),this.buttonConfig=n.buttons||[],this._selectedTab="detailsTab",this.model&&(n.force=!0,this.resetModel(this.model,n),this.listenTo(this._detailsView.model,"onChange:modificationsPending",this.setSaveState)),this.listenTo(this._detailsView,"scrollToElement",this.scrollToElement)},createCommonLibrary:function(e){c.loadJSDependency("DS/ENOProjectMgmtCommonComponents/components/CommonInitializer").then(t=>{c.fixDisplayMessageMethod(),_.commonInitializerLibrary=new t({isComponent:!0,loadClassification:!0,isLibraryInstalled:e,securityContext:window.enoviaServer.space})}).catch(e=>{"scripterror"===e.requireType&&console.error(e.message)})},onFieldValueChange:function(){this._onFieldValueChangeTimeout=this._onFieldValueChangeTimeout||setTimeout(()=>{this._onFieldValueChange(),this._onFieldValueChangeTimeout=void 0},0)},_onFieldValueChange:function(){var e=this._scroller&&this._scroller.getInnerElement().scrollTop,t=this._scroller&&this._scroller.getInnerElement().scrollLeft;this._detailsView.setConfig(this.getConfig()),this._smartRender(),this._scroller&&this._scroller.scrollTo(t,e)},updateCommonInitializerLibrary:function(){_.commonInitializerLibrary&&_.commonInitializerLibrary.initializeComponent&&_.commonInitializerLibrary.initializeComponent({isComponent:!0,loadClassification:!0,securityContext:window.enoviaServer.space})},setupAdditionalTabs:function(){var e=this.container.getElement("#commentsTab"),t=this.container.getElement("#classificationTab"),n=this.container.getElement("#characteristicsEditorViewTab"),s=this.container.getElement("#historyTab"),i=this.container.getElement("#checklistTab");this.addChildView(c.createTooltip(e,this.i18n("E6WCommonApps.Command.Comments"))),this.addChildView(c.createTooltip(t,this.i18n("E6WCommonApps.Command.Classification"))),this.addChildView(c.createTooltip(n,this.i18n("E6WCommonApps.Command.Extension"))),this.addChildView(c.createTooltip(s,this.i18n("E6WCommonApps.Command.AuditHistory"))),this.addChildView(c.createTooltip(i,this.i18n("E6WCommonApps.Command.Checklist")))},render:function(){if(!this.model)return this;this.container.setHTML(this.template()),this._initButtons(this.buttonConfig),this._renderBodyContent({fromRender:!0});var e=this.container.getElement("#detailsTab"),t=this.container.getElement("#membersTab");return this.addChildView(c.createTooltip(e,this.i18n("E6WCommonApps.Command.Properties"))),this.addChildView(c.createTooltip(t,this.i18n("E6WCommonApps.Command.Members"))),this.setupAdditionalTabs(),this},_removeTabs:function(){this._detailsView.remove(),this._commentsView&&this._commentsView.remove(),this._auditHistoryView&&this._auditHistoryView.remove(),this._classificationTabContainer&&this._classificationTabContainer.remove(),this._charEditor&&this._charEditor.remove()},injectScroller:function(){this._scrollerElement=e.createElement("div",{id:"detailsPanelScroller",styles:{"-webkit-user-select":"text"}}),this._scrollerElement.inject(this.container.getElement("#detailsPanelFrame"))},_handleCommentsTabContainer:function(e){var t=this.container.getElement("#commentsTab");void 0!==this.model.isIteropTask&&this.model.isIteropTask()?(t.style.display="none","commentsTab"===this._selectedTab&&this._setSelectedTab("detailsTab")):t.style.display="inline-block","commentsTab"===this._selectedTab&&(e.remove(),this._commentsView.inject(this._scrollerElement))},_handleClassificationTabContainer:function(e){var t=this.container.getElement("#classificationTab");this.validTypesForClassificationTab(e)&&!this.model.isRDF?t.style.display="inline-block":(t.style.display="none","classificationTab"===this._selectedTab&&this._setSelectedTab("detailsTab"))},_handleHistoryTabContainer:function(e){var t=this.container.getElement("#historyTab");c.isTask(e)&&!this.model.isRDF||this.model.get("policy")?(t.style.display="none","historyTab"===this._selectedTab&&this.onDetailsTabClicked()):t.style.display="none"},_handleCharacteristicsTabContainer:function(){var e=this.container.getElement("#characteristicsEditorViewTab");this.model.get("dsxplan:customExtensionName")?e.style.display="inline-block":(e.style.display="none","characteristicsEditorViewTab"===this._selectedTab&&this._setSelectedTab("detailsTab"))},_handleChecklistTabContainer:function(e,t){var n=this.container.getElement("#checklistTab");this.validTypesForChecklistTab(e)&&!t?n.style.display="inline-block":(n.style.display="none","checklistTab"===this._selectedTab&&this.onDetailsTabClicked())},_handleAdditionalTabContainers:function(e,t,n){this._handleCommentsTabContainer(e),this._handleClassificationTabContainer(t),this._handleCharacteristicsTabContainer(),this._handleHistoryTabContainer(t),this._handleChecklistTabContainer(t,n)},_clearExistingBodyContent:function(){this._detailsView.remove(),this.container.getElement("#detailsPanelFrame").empty(),this._scrollerElement&&this._scrollerElement.destroy()},_renderBodyContent:function(t){var n=e.clone(t||{},!1);if(this.model.fetchingHistory&&"historyTab"===this._selectedTab&&!n.fromRender)return;this._removeTabs(),this._clearExistingBodyContent(),this.injectScroller(),this._setSelectedTab(this._selectedTab);var s=this._detailsView.render({boundingElement:this._scrollerElement}).container;s.inject(this._scrollerElement);var i=this.model.get("dsxplan:jsType")||this.model.get("type");let o="dsxnpi:MilestoneExternal"===this.model.get("dsxplan:vocabularyType");this._handleAdditionalTabContainers(s,i,o);var a=this,r=function(){(a._scrollerTimeout&&clearTimeout(a._scrollerTimeout),delete a._scrollerTimeout,"checklistTab"===a._selectedTab)&&("none"===a.container.getElement("#checklistTab").style.display&&(a._selectedTab="detailsTab"));if("detailsTab"!==a._selectedTab&&"membersTab"!==a._selectedTab&&"checklistTab"!==a._selectedTab||!a._detailsView){var e=a.validTypesForClassificationTab(i);"commentsTab"===a._selectedTab?(!a._commentsView&&a._initCommentsView(),a._setScrollerContent(a._commentsView)):"classificationTab"===a._selectedTab&&e&&!a.model.isRDF?(!a._classificationTabContainer&&a._initClassificationTabView(),a._setScrollerContent(a._classificationTabContainer)):"characteristicsEditorViewTab"===a._selectedTab?(!a._charEditor&&a._initCharacteristicsView(),a._setScrollerContent(a._charEditor)):"historyTab"===a._selectedTab&&(!a._auditHistoryView||!a._auditHistoryView.container)&&a._resetHistoryTab()}else a._detailsView.container.offsetWidth?a._setScrollerContent(a._detailsView):a._scrollerTimeout=setTimeout(r,10)};r()},showLoadingMessage:function(){this._scrollerElement&&c.showLoadingMessage(this._scrollerElement)},hideLoadingMessage:function(){c.hideLoadingMessage(this._scrollerElement)},validTypesForClassificationTab:function(e){return["dsplan:Task","swym:WeDo","Task","Gate","Milestone","Phase"].includes(e)},validTypesForChecklistTab:function(e){return["dsplan:Task","dsplan:Project","dsplan:Milestone","dsplan:Gate"].includes(e)},cancel:function(t){var n=e.clone(t||{},!1),s=this,i=function(){n.keepPanelOpen||s.close(),e.is(n.onCancel,"function")&&n.onCancel(),s.dispatchEvent("onCancel")};this._detailsView&&this._detailsView.model&&this._detailsView.model.modificationsPending?this.model.destroying?(c.displayInfo(this.model.get("title")+" "+this.i18n("E6WCommonApps.Error.HasBeenDeleted")),this._detailsView.model.cancel(),i()):this.modal.confirm(this.i18n("E6WCommonApps.Warning.PendingChanges"),this.i18n("E6WCommonApps.Command.CancelChanges"),function(t){t?(s._detailsView.model.cancel(),i()):e.is(n.onAbortCancel,"function")&&n.onAbortCancel()}):i()},getClassificationAttributes:function(){var e=this.classificationView&&this.classificationView.currentModel;return e&&e.get("ClassificationAttributes")},_saveClassificationAttributes:function(t,n){t&&(t.length>0||t.relatedDataToDelete&&t.relatedDataToDelete.length>0)&&this.classificationView.save({onComplete:function(){n&&e.is(n.onComplete,"function")&&n.onComplete.apply(this,arguments),arguments[0]&&arguments[0].err&&c.displayError(arguments[0].err.message)}})},getIsActualDatesChanged:function(e){return e.localAttributes.hasOwnProperty(g.ACTUAL_START_DATE)||e.localAttributes.hasOwnProperty(g.ACTUAL_END_DATE)},_setupStoryTaskListeners:function(){this.model.getObjectType&&c.isTask(this.model.getObjectType())&&this._addStoryTaskListeners()},save:function(){var t=this,n=this._detailsView._config,s=n&&e.clone(n.options||{},!1);t.model.isSavePending=!0;var i=this.model,o=this._detailsView.model,a=this.getClassificationAttributes(),r=function(){o.urlUpdated=!1,t._detailsView.model.save({mask:i.getPropertyMask&&i.getPropertyMask(),onComplete:function(){delete i.isSavePending,i.dispatchEvent("saveCompleted"),s&&e.is(s.onComplete,"function")&&s.onComplete.apply(t,arguments)},onFailure:function(){s&&e.is(s.onFailure,"function")&&s.onFailure.apply(t,arguments)}})};if("dsplan:Task"===i.getObjectType()&&"function"==typeof o.getIsActualDatesChanged&&o.getIsActualDatesChanged(o)){var l=i.getProjectParent(i).id;i.calculateAndSetDuration(l,{startDate:o.getStartDate().actualValue,endDate:o.getEndDate().actualValue,dontSave:!0,onComplete:function(){o._isUrlAttached(t._detailsView.model)||r()}})}else{var d=t._charEditor&&t._charEditor.elements.form.getModifiedValues();d&&(o.localAttributes.modifiedExtensionValues=d,Object.entries(d).forEach(([e,t])=>{i.set(e,t,{dontRegisterChange:!0})})),o._isUrlAttached(t._detailsView.model)||r()}this._saveClassificationAttributes(a,s)},resetModel:function(t,n){var s=e.clone(n||{},!1),i=s.force;t&&t.fetchForProperty&&t.fetchForProperty(),t&&this.getTagInfoForModel(t),!i&&this.isSameModel(t,this.model)||(this._detailsView.model&&this.stopListening(this._detailsView.model),(i||this._detailsView)&&this.resetDetailsDisplayView(t,n,s),this._initCommentsView(),this._addModelEvents(),this._resetClassificationTab(),this.setSaveState(),!s.noRender&&this._smartRender(),t.isValid()?this.enableSaveButton():this.disableSaveButton(),this._handlePeopleTabDisplay(n),this._updateStateOfAssignToSelfButton(),this._resetHistoryTab(),this._resetCharacteristicsTab(),this._setupStoryTaskListeners())},resetDetailsDisplayView:function(t,n,s){var i=this._detailsView.model;this.model&&t.constructor!==this.model.constructor&&this._detailsView.setConfig([]),this.model=t;var o=this.cloneModelForDetailDisplayView();o.validationError=e.is(o.validate,"function")&&o.validate(o.toJSON()),this._detailsView.resetModel(o,void 0,{noRender:!0,isShadowMilestoneGate:s.isShadowMilestoneGate}),this.config=this.getConfig(n),this._detailsView.setConfig(this.getConfig(n)),i&&i.destroy()},isSameModel:function(e,t){return e===t},getTagInfoForModel:function(e){u.getTagInfo(e)},_resetClassificationTab:function(){var e=this.model.get("dsxplan:jsType")||this.model.get("type");this.validTypesForClassificationTab(e)&&!this.model.isRDF&&this._detailsView.model?this._handleClassificationTabDisplay():this.classificationView=void 0},_resetHistoryTab:function(){"historyTab"===this._selectedTab&&this._fetchAuditHistoryData({onComplete:(e,t)=>{this.initAuditHistoryView(e,t)},onFailure:function(){c.displayError(this.i18n("E6WCommonApps.Error.FetchAuditHistoryFailed"))}})},_resetCharacteristicsTab:function(){"characteristicsEditorViewTab"===this._selectedTab&&(this._charEditor&&this._charEditor.remove(),this._initCharacteristicsView())},_addStoryTaskListeners:function(){let e=Boolean(a.isStoryTask(this._detailsView.model)&&this._detailsView.model.get(T.WORK_CONTEXT_ATTR));const t=()=>{this._storyTaskTimeout=this._storyTaskTimeout||setTimeout(()=>{this._storyTaskTimeout=void 0;const t=Boolean(a.isStoryTask(this._detailsView.model)&&this._detailsView.model.get(T.WORK_CONTEXT_ATTR));e!==t&&(e=t,this.onFieldValueChange())},0)};this.listenTo(this._detailsView.model,`onChange:${T.PARENT_ATTR}`,t),this.listenTo(this._detailsView.model,`onChange:${T.WORK_CONTEXT_ATTR}`,t)},_handleClassificationTabDisplay:function(){this._initClassificationTabView(),this.renderClassificationView()},renderClassificationView:function(){var e=this;c.loadJSDependency("DS/ENOProjectMgmtCommonComponents/views/ClassificationView").then(function(t){c.fixDisplayMessageMethod(),e.classificationView=new t(e._classificationTabContainer,{isComponent:"true",currentModel:e._detailsView.model,homeView:e}),e.classificationView.render()}).catch(e=>{"scripterror"===e.requireType&&console.error(e.message)})},onDeleteAccessChange:function(){this._detailsView.setConfig(this.getConfig({isShadowMilestoneGate:this.isShadowMilestoneGate})),this._smartRender(),this._updateStateOfDeleteButton()},getManagementView:function(){return this.managementView},_addModelEvents:function(){var e={"onChange:modificationsPending":this.setSaveState,onValidationFailure:this.disableSaveButton,onValidationSuccess:this.enableSaveButton,onChange:function(e,t){if(t&&t.config&&("dsplan:hasAssignee"===t.config.name||"assignees"===t.config.name)){var n=e.get(t.config.name);this._updateStateOfAssignToSelfButton(n)}}};this.listenTo(this._detailsView.model,e);var t={"onChange:dsxplan:hasAssignee":this._updateActionButtonsState,onChange:function(e,t){t&&"assignees"===t.relationshipChanged&&this._updateActionButtonsState()},onModifyAccessChanged:function(){this._detailsView.setConfig(this.getConfig({isShadowMilestoneGate:this.isShadowMilestoneGate})),this._detailsView.render()},onDeleteAccessChanged:this.onDeleteAccessChange,onDestroy:this.close};this.listenTo(this.model,t),this.listenTo(this._detailsView.model,"onChange:"+g.CONTENT_REPOSITORY,this.onFieldValueChange),this.listenTo(this.model,"onChange:"+g.MILESTONE_VOCABULARY_TYPE,this.onFieldValueChange),this.listenTo(this._detailsView.model,"onChange:"+g.MILESTONE_VOCABULARY_TYPE,this.onFieldValueChange),this.listenTo(this._detailsView.model,"onChange:dsxplan:customExtensionName",this.onFieldValueChange),this.listenTo(this._detailsView.model,"onUrlFailure",this.onFieldValueChange),this.listenTo(this._detailsView.model,"onUrlUpdate",this.save),this.listenTo(this.model,"onChange:"+g.USER_DEFINED_START_DATE_ATTR,this.onFieldValueChange),this.listenTo(this.model,"onChange:"+g.USER_DEFINED_END_DATE_ATTR,this.onFieldValueChange),this.listenTo(this._detailsView.model,"onChange:routeTaskApprovalComments",()=>{"Approve"===this._detailsView.model.get("routeTaskAction")&&this.onFieldValueChange()})},_updateActionButtonsState:function(e){this._updateStateOfAssignToSelfButton(),this._updateStateOfDuplicateButton(e),this._updateStateOfDeleteButton(e),this._handlePeopleTabDisplay(e)},_updateStateOfAssignToSelfButton:function(e){var t=this.getElement("#assignToSelfItem");t&&(this.model&&!this.model.canAssignToSelf(e)?t.toggleClassName("disabled",!0):t.toggleClassName("disabled",!1))},_updateStateOfDuplicateButton:function(t){var n=this._dropDownMenu;n&&(t&&t.isSummaryTask||e.is(this.model.canModify,"function")&&!this.model.canModify(!0)?n.disableItem(this.i18n("E6WCommonUI.Label.Duplicate")):n.enableItem(this.i18n("E6WCommonUI.Label.Duplicate")))},_updateStateOfDeleteButton:function(e){var t=this._dropDownMenu;t&&(e&&e.isShadowMilestone||this.isShadowMilestone||this.model&&(this.model.isRouteTask&&this.model.isRouteTask()||!this.model.canDelete(!0))?t.disableItem(this.i18n("E6WCommonApps.Label.Delete")):t.enableItem(this.i18n("E6WCommonApps.Label.Delete")))},getChecklistConfig:function(){throw new Error("In PropertyPanel getChecklistConfig, this should be implemented in subclass.")},_handlePeopleTabDisplay:function(t){var n=e.clone(t||{},!1);n.isShadowMilestoneGate=t&&t.isShadowMilestoneGate||this.isShadowMilestoneGate;var s=this.getPersonConfig(this.getOriginalConfig(n)),i=this.container.getElement("#membersTab");n.isShadowMilestoneGate&&i&&(i.style.display="none"),i&&(0===s.length?(i.style.display="none","membersTab"===this._selectedTab&&this._setSelectedTab("detailsTab")):i.style.display="inline-block")},_smartRender:function(){0!==this.container.childElementCount?this._renderBodyContent():this.render()},disableSaveButton:function(){var e=this.container.getElement("#saveButton");e&&e.setAttribute("disabled","disabled")},enableSaveButton:function(){var e=this._detailsView.isModelValid()&&this.container.getElement("#saveButton");e&&e.removeAttribute("disabled")},showOrHideBookmarkForRepositoryField:function(e){let t=this._detailsView&&this._detailsView.model;if(t){var n=t.get(g.CONTENT_REPOSITORY)||t.get("dsplan:hasContentRepository");if(!n||"3DDrive"===n.serviceHosting){var s=e.findIndex(function(e){return e.name===g.BOOKMARK_FOR_FILE_REPOSITORY});-1!==s&&e.splice(s,1)}}},template:function(t){var n=e.clone(t||{},!1).data;n={};var s=d.i18n;d.i18n=this.i18n;var i=f(n);return d.i18n=s,i},selectTab:function(e){"commentsTab"===e&&this.onCommentsTabClicked()},destroyToolbarElementAndRemoveExtraClassInBody:function(){const e=this.container.getElement(".body-toolbar");e&&e.destroy(),this.container.getElement(".body").classList.remove("eno-empty-set")},onCommentsTabClicked:function(){"commentsTab"!==this._selectedTab&&(this.destroyToolbarElementAndRemoveExtraClassInBody(),this._setSelectedTab("commentsTab"),this._setScrollerContent(this._commentsView))},onMembersTabClicked:function(){"membersTab"!==this._selectedTab&&(this.destroyToolbarElementAndRemoveExtraClassInBody(),this._setSelectedTab("membersTab"),this._detailsView.setConfig(this.getConfig()),this._setScrollerContent(this._detailsView.render().container),this._updateStateOfAssignToSelfButton())},onDetailsTabClicked:function(){"detailsTab"!==this._selectedTab&&(this.destroyToolbarElementAndRemoveExtraClassInBody(),this._setSelectedTab("detailsTab"),this._detailsView.setConfig(this.getConfig({isShadowMilestoneGate:this.isShadowMilestoneGate})),this._setScrollerContent(this._detailsView.render().container))},onClassificationTabClicked:function(){if("classificationTab"!==this._selectedTab){this.destroyToolbarElementAndRemoveExtraClassInBody(),this._setSelectedTab("classificationTab");this._classificationTabContainer;this.renderClassificationView(),this.classificationView&&this._setScrollerContent(this.classificationView.container)}},onCharacteristicsEditorViewTabClicked:function(){"characteristicsEditorViewTab"!==this._selectedTab&&(this.destroyToolbarElementAndRemoveExtraClassInBody(),this._setSelectedTab("characteristicsEditorViewTab"),this._scrollerElement&&this._scrollerElement.empty(),void 0===this._charEditor||this._charEditor&&!this._charEditor.hasModifiedValues()?(this._charEditor&&this._charEditor.remove(),this._initCharacteristicsView()):this._setScrollerContent(this._charEditor))},_initCharacteristicsView:function(){var e=this;let t=!c.isProject(e.model.get(g.PROJECT_TYPE))&&e.model.get(g.RESTRICT_ASSIGNEE_ATTR);c.loadJSDependency("DS/dsbaseUIControls/CharacteristicsView").then(s=>{var i={rdfServerURL:p.getServiceUrl("3dplan")+"/",resourceURI:e.model.get("@id"),platformId:p.getTenant(),customization:{editMode:e.model.get("canEdit")&&!t,display:{title:!1,subtitle:!1,switchMode:!1,scroller:!1,switchLanguage:!1},constraintsPosition:"right",getInfos:function(){var t=n.authenticatedRequest,s={"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest","Accept-Language":widget.lang};return new Promise(function(n,i){t(p.getServiceUrl("3dplan")+"/resources/v1/template-instances/"+e.model.get("@id")+"?denyCharac=dskern:owner,dspol:creationDate,dspol:modificationDate,dskern:nlsLabel,dskern:nlsComment",{method:"GET",headers:s,type:"json",onComplete:function(e){n(e)},onFailure:function(e,t,n){i(n)},timeout:3e5})})}},events:{onValueChange:function(){var t=e._charEditor.elements.form,n=!0;t.unvalidate(),t.getAllInputInstances().forEach(function(e){e.validateForForm()||(n=!1)}),e._charEditor.hasModifiedValues()&&n&&(e._detailsView.model.modificationsPending=!0,e._detailsView.model.dispatchEvent("onChange:modificationsPending",[e._detailsView.model]),e.enableSaveButton())}}};e._charEditor=new s(i),e._setScrollerContent(e._charEditor)}).catch(e=>{"scripterror"===e.requireType&&console.error(e.message)})},onHistoryTabClicked:function(){"historyTab"!==this._selectedTab&&(this.destroyToolbarElementAndRemoveExtraClassInBody(),this._setSelectedTab("historyTab"),this._scrollerElement&&this._scrollerElement.empty(),this._fetchAuditHistoryData({onComplete:(e,t)=>{this.initAuditHistoryView(e,t)},onFailure:function(){c.displayError(this.i18n("E6WCommonApps.Error.FetchAuditHistoryFailed"))}}))},onChecklistTabClicked:function(){"checklistTab"!==this._selectedTab&&(this._scrollerElement&&this._scrollerElement.empty(),this.destroyToolbarElementAndRemoveExtraClassInBody(),this._setSelectedTab("checklistTab"),this._detailsView.setConfig(this.getConfig()),this._setScrollerContent(this._detailsView.render().container))},_disableTabFocusOnElements:function(){this._setTabIndexOnFocusableElements(-1)},_enableTabFocusOnElements:function(){this._setTabIndexOnFocusableElements(0)},_setTabIndexOnFocusableElements:function(e){var t=-1===e?0:-1;this.container.getElements("input").concat(this.container.getElements("a")).concat(this.container.getElements("link")).concat(this.container.getElements("select")).concat(this.container.getElements("textarea")).concat(this.container.getElements("button")).concat(this.container.getElements(".autocomplete-searchbox")).concat(this.container.getElements("[tabIndex='"+t+"']")).forEach(function(t){t.setAttribute("tabIndex",e)})},close:function(){this._disableTabFocusOnElements()},open:function(){this._enableTabFocusOnElements()},getConfig:function(e){if(_.DEACTIVATE_MEMBERS_TAB)return e;var t=this.getPersonConfig(e),n=e.filter(e=>"person"!==e.type&&e.name!==g.REMINDER_DAYS);if("membersTab"===this._selectedTab)return t.options=e.options,t;if("historyTab"===this._selectedTab){var s=[];return s.options=e.options,s}return"checklistTab"===this._selectedTab?this.getChecklistConfig():(n.options=e.options,n)},getPersonConfig:function(e){return e.filter(e=>"person"===e.type||e.name===g.REMINDER_DAYS)},setSaveState:function(){this.container.toggleClassName("save-needed",this.saveNeeded())},saveNeeded:function(){return Boolean(this._detailsView.model.modificationsPending)},cloneModelForDetailDisplayView:function(){throw new Error("In PropertyPanel cloneModelForDetailDisplayView, this should be implemented in subclass.")},getOriginalConfig:function(){throw new Error("In PropertyPanel getOriginalConfig, this should be implemented in subclass.")},destroy:function(){this._onFieldValueChangeTimeout&&clearTimeout(this._onFieldValueChangeTimeout),this._onFieldValueChangeTimeout=void 0,this._parent(),delete this._detailsView,this._dropDownMenu&&this._dropDownMenu.destroy(),this._commentsView&&this._commentsView.destroy(),delete this._commentsView,this._classificationTabContainer&&this._classificationTabContainer.destroy(),delete this._classificationTabContainer,this._charEditor&&this._charEditor.remove(),delete this._charEditor,this.modal&&this.modal.destroy(),delete this.modal;var e=this._detailsView&&this._detailsView.model;e&&e.destroy(),this._scrollerElement&&this._scrollerElement.destroy(),delete this._scrollerElement,this._scroller&&this._scroller.destroy(),delete this._scroller,delete this.buttonConfig,this._scrollerTimeout&&clearTimeout(this._scrollerTimeout),delete this._scrollerTimeout,this._storyTaskTimeout&&clearTimeout(this._storyTaskTimeout),this._storyTaskTimeout=void 0},_initClassificationTabView:function(){this._classificationTabContainer&&this._classificationTabContainer.destroy(),this._classificationTabContainer=e.createElement("div",{class:"classification-tab"})},_fetchAuditHistoryData:function(t){var n=e.clone(t||{},!1);this.model.fetchingHistory||(this._currentAuditHistoryRequest&&this._currentAuditHistoryRequest.cancel(),this.showLoadingMessage(),this._currentAuditHistoryRequest=this.model.fetchAuditHistoryData({onComplete:(e,t)=>{n.onComplete&&n.onComplete.apply(this,[e,t])},onFailure:t=>{this.hideLoadingMessage(),n&&e.is(n.onFailure,"function")&&n.onFailure.call(this,t)}}))},initAuditHistoryView:function(e,t){"historyTab"===this._selectedTab&&(this.hideLoadingMessage(),this._auditHistoryView&&this._auditHistoryView.container&&this._auditHistoryView.destroy(),this._auditHistoryView=new m({rdfDataResponse:e,s3BucketResponse:t,parentView:this}),this._setScrollerContent(this._auditHistoryView))},_setSelectedTab:function(e){this._selectedTab=e,this.container.getElements(".panel-tab").forEach(function(t){t.toggleClassName("selected",t.id===e)})},_initCommentsView:function(){this._commentsView&&this._commentsView.destroy();var e={tenantId:enoviaServer.tenant,enableShare:!1,"3DSwymUrl":window.enoviaServer.swym,commentsNumberAtInit:8};this.model.isRDF?(e.subjectURI=this.model.id,e.serviceURL=p.getServiceUrl("3dplan")+"/dsplan"):(e.subjectURI="pid:"+this.model.id,e.serviceURL=window.enoviaServer.computeUrl("/resources/"),e.commentProxyToken={header:"X-DS-CSRFTOKEN"},e.appForcedLinkUri="/#app:"+widget.getValue("appId")+"/content:id="+this.model.id+"&propertyPanelTab=commentsTab&x3dPlatformId="+enoviaServer.tenant),this._commentsView=new s(e)},_setScrollerContent:function(e){this._scroller&&(this._scroller.destroy(),this._scrollerElement.empty()),e.inject(this._scrollerElement),this._scroller=new t({element:this._scrollerElement}).inject(this.getElement("#detailsPanelFrame")),this.getElement(".scroller-content").addEventListener("scroll",()=>{this._detailsView.handleParentScroll()})},_initButtons:function(t){var n=this.container.getElement(".panel-actions");if(t&&n){n.empty();var s=this,i=0;t.forEach(function(t){var o;o=t.content?e.createElement("div",{class:"panel-action",id:t.id,"data-title":t.title,html:t.content}):e.createElement("div",{class:"panel-action icon-only-button",html:{tag:"button",id:t.id||s.cid+"Button"+i,class:"btn","data-title":t.title,disabled:t.disabled,html:{tag:"span",class:"fonticon fonticon-"+(t.fonticon||"info")}}}),s.addChildView(c.createTooltip(o,t.title)),o.inject(n),i+=1})}},getCloneModel:function(){return this._detailsView.model},getFieldViewByName:function(e){return this._detailsView.getFieldViewByName(e)},scrollToElement:function(e){this._scroller.scrollToElement(e)}});return _.COMMENTS_TAB="commentsTab",_.HISTORY_TAB="historyTab",_.MEMBERS_TAB="membersTab",_.DETAILS_TAB="detailsTab",_.DEACTIVATE_MEMBERS_TAB=!1,_.DRAGOVER_DELAY=1e3,_}),define("DS/E6WCommonApps/Views/MultiPropertyPanel",["UWA/Core","DS/UIKIT/SuperModal","DS/E6WCommonUI/Views/MultiDetailsDisplayView","DS/E6WCommonUI/UIHelper","DS/E6WCommonApps/Views/PropertyPanel"],function(e,t,n,s,i){"use strict";return i.extend({_uwaClassName:"MultiPropertyPanel",DisplayView:n,setupAdditionalTabs:Function.prototype,createDetailsDisplayView:function(e){this._detailsView=new n(e)},resetConfigAndRender:function(){this._detailsView.setConfig(this.getConfig({isShadowMilestoneGate:this.isShadowMilestoneGate})),this.render()},save:function(){this.listenTo(this.model,"saveCompleted",this.resetConfigAndRender),this.listenTo(this.model,"massEditFailed",this.resetConfigAndRender),this._parent.apply(this,arguments)},_removeTabs:function(){this._detailsView.remove()},_handleAdditionalTabContainers:function(){this.container.getElement("#commentsTab").style.display="none",this.container.getElement("#classificationTab").style.display="none",this.container.getElement("#characteristicsEditorViewTab").style.display="none",this.container.getElement("#historyTab").style.display="none",this.container.getElement("#checklistTab").style.display="none"},_updateStateOfAssignToSelfButton:Function.prototype,getClassificationAttributes:Function.prototype,getIsActualDatesChanged:Function.prototype,_updateStateOfDeleteButton:Function.prototype,isSameModel:function(e,t){return"function"==typeof e.hasSameModels?e.hasSameModels(t):e===t},disableSaveButton:function(){var e=this.container.getElement("#saveButton");e&&e.setAttribute("disabled","disabled")},getTagInfoForModel:Function.prototype,_initCommentsView:Function.prototype,_resetClassificationTab:Function.prototype,_resetHistoryTab:Function.prototype,_resetCharacteristicsTab:Function.prototype,_setupStoryTaskListeners:Function.prototype,_initClassificationTabView:Function.prototype,_initCharacteristicsView:Function.prototype,_saveClassificationAttributes:Function.prototype})}),define("DS/E6WCommonApps/CustomAttributeMixin",["UWA/Core","UWA/Class/Listener","UWA/Element","UWA/Class/Events","DS/RDFFoundation/CustomExtensionUtils","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/TreeNodeUtil"],function(e,t,n,s,i,o,a){"use strict";var r=[];const l={};var d,c={"xsd:string":"string","dsbase:Hyperlink":"url","foaf:Person":"user"};return{fetchCustomAttributes:function(e){var t=this;return new Promise((n,s)=>{o.request(o.expandUrl("/invoke/dsxplan:getCustomAttributesInBulk"),{method:"POST",type:"json",data:JSON.stringify([e]),onComplete:e=>{var s=t,r=t.treeDocument;r.prepareUpdate();for(var d=0;d<e.ObjectsWithCustomAttributes.member.length;d++){var p=Object.keys(e.ObjectsWithCustomAttributes.member[d]);Object.values(e.ObjectsWithCustomAttributes.member[d]).forEach(function(e){const t=e.extension.columnValue;l[t]=l[t]||{},Object.entries(e).forEach(([e,n])=>{var r=n.columnType;a.RDF_TO_TREE_NODE[e]=e;var d=o.getObjectById(p),u=n.isList,h=n.columnValue;if(u&&n.columnValue.member&&(h=n.columnValue.member),"extension"!==e&&d.set(e,h,{dontRegisterChange:!0}),"extension"!==e&&!s.getColumnOrGroup(e)){var m=c[r]||"string",T={text:n.columnLabel,dataIndex:e,typeRepresentation:m,editableFlag:!1,className:a.COMMON_CSS_CLASS_FOR_GRID_COLUMNS,minWidth:a.MIN_WIDTH_OF_EACH_COLUMN,sortableFlag:!1,editionPolicy:"EditionOnDoubleClick",visibleFlag:!1};"url"===m?T.getCellValue=function(t){if(t.nodeModel&&t.nodeModel.getAttributeValue(e))return{label:t.nodeModel.getAttributeValue(e).label,url:t.nodeModel.getAttributeValue(e).url}}:"user"===m&&(T.getCellValue=function(t){if(t.nodeModel&&t.nodeModel.getAttributeValue(e))return{label:t.nodeModel.getAttributeValue(e).fullName}}),u&&(T.columngetCellSemantics=function(e){return{allowMultipleValuesFlag:!0}}),s&&"TasksTableView"===s.identifier&&(T.sortableFlag=!0),s.addColumnOrGroup(T),i.customAttrCols.push(T),l[t][e]=!0}})})}r.pushUpdate(),n()},onFailure:e=>{s(e)}})})},processQueue:async function(){clearTimeout(d);for(;r.length>0;){const e=r.splice(0,250).map(function(e){return"<"+e+">"});await this.fetchCustomAttributes(e)}d=r.length>0?setTimeout(this.processQueue.bind(this),500):null},startProcessing:function(){d||(d=setTimeout(this.processQueue.bind(this),500))},_addToQueue:function(t){var n=o.getObjectById(t);t&&!i.customAttrsMap[t]?(r.push(t),i.customAttrsMap[t]=!0):n&&setTimeout(()=>{var t=this.gridView||this.lTreeDocument&&this.lTreeDocument.gridView||this;const s=n.get("dsxplan:customExtensionName");if(s&&l[s]){Object.keys(l[s]).forEach(n=>{let s=i.customAttrCols.find(e=>e.dataIndex===n);var o=e.clone(s||{},!1);"TasksTableView"===t.identifier?o.sortableFlag=!0:o.sortableFlag=!1,t.getColumnOrGroup(o.dataIndex)||t.addColumnOrGroup(o)})}},0),this.startProcessing()}}}),define("DS/E6WCommonApps/Views/E6WDataGridView",["UWA/Core","UWA/Class/Listener","DS/DataGridView/DataGridView","DS/E6WCommonApps/CustomAttributeMixin"],function(e,t,n,s){"use strict";const i=n.extend({init:function(){this._parent.apply(this,arguments),this.getResuableComponentForAssignee(),this.getResuableComponentForDescription(),this.treeDocument.subscribe({event:"select"},e=>{e.stopPropagation(),!this._doingDnD&&this.dispatchEvent("onSelect",[e.data.nodeModel.rdfModel])}),this.treeDocument.subscribe({event:"unselect"},e=>{e.stopPropagation(),this.dispatchEvent("onUnselect",[e.data.nodeModel.rdfModel])})},_getReusableComponentBase:function(t,n){this.registerReusableCellContent({id:t,buildContent:function(){return e.createElement("div",{class:n})}})},_processDragAndDropCallbacks:function(e){"dragstart"===e.type?this._doingDnD=!0:"dragend"!==e.type&&"drop"!==e.type||(this._doingDnD=!1),this._parent.apply(this,arguments)},getResuableComponentForAssignee:function(){this._getReusableComponentBase("assigneesContent","grid-users-list")},getResuableComponentForDescription:function(){this._getReusableComponentBase("descriptionContent","grid-description-view")},destroy:function(){this.stopListening(),this._parent.apply(this,arguments)}});return i.implement(s),i.implement(t),i}),define("DS/E6WCommonApps/Views/UserTagsView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/E6WCommonUI/Views/TextAreaView","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i){"use strict";var o=t.extend({_uwaClassName:"UserTagsView",tagName:"div",className:"form-section accordion details-display-shared-view ddv-field form-group",domEvents:{"click .form-section-title":"_onUserTagsLabelClicked"},id:function(){return"UserTags_"+this.cid},setup:function(){this._parent.apply(this,arguments),this._userTagsi18n=i.get("E6WCommonApps.Label.UserTags"),this._labelElem=e.createElement("label",{class:"top-label"}),this.container.setAttribute("data-field-index",1),this._setupGroupElements()},render:function(){return this.container.empty(!0),this._titleElem.inject(this.container),this._fieldContainer.inject(this.container),this._expanded&&this._drawTags(),this},toggleExpanded:function(e){this._expanded=void 0!==e?e:!this._expanded,this.render()},_drawTags:function(){this._userTagsView||this._setupUserTagsViews(),this._fieldContainer.empty(!0),this._userTagsView.render().inject(this._fieldContainer)},_onUserTagsLabelClicked:function(){if(this.toggleExpanded(),this._expanded){var e=this;this._animationFrameForScroll=requestAnimationFrame(function(){e._parentView.dispatchScrollToElementEvent(e.container),delete e._animationFrameForScroll})}},_setupGroupElements:function(){this._titleElem=e.createElement("div",{class:"form-section-title",html:this._userTagsi18n}),this._fieldContainer=e.createElement("div",{class:"form-section-body"})},_setupUserTagsViews:function(){var t,s,a=this;this._userTagsView=new n((s=e.merge(o.getUserTagsFieldBasicConfig(a.model),t),{i18n:i,isPropertyPanel:!0,model:a.model,config:s})),this.addChildView(this._userTagsView),this.listenTo(this._parentView,"onScroll",()=>{this.dispatchEvent("onScroll")})},destroy:function(){void 0!==this._animationFrameForScroll&&(cancelAnimationFrame(this._animationFrameForScroll),delete this._animationFrameForScroll),this._parent.apply(this,arguments)}});return o.getUserTagsFieldBasicConfig=function(){return{type:"textarea",readWrite:!1,name:s.TAGS_DATA}},o}),define("DS/E6WCommonApps/Views/ChecklistItemView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/E6WCommonUI/Views/DetailsDisplayView","DS/E6WCommonUI/Models/CloneModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o){"use strict";var a=function(e){return o.get(e)},r=t.extend({_uwaClassName:"CheckListItemView",tagName:"div",className:"form-section accordion details-display-shared-view ddv-field",domEvents:{"click .fonticon-up":"_onUpArrowClicked","click .fonticon-down":"_onDownArrowClicked","click .fonticon-trash":"_onDeleteItem","click .form-section-title":"_onCheckListLabelClicked"},id:function(){return"CheckListItem_"+this.cid},setup:function(e){this._parent.apply(this,arguments),this._expanded=Boolean(e.config&&e.config.expand),this.cloneModel=new s(e.model),e.model.cloneModel=this.cloneModel,this.container.setAttribute("data-field-index",1),this._expanded&&this.container.classList.add("expanded"),this._setupGroupElements()},render:function(){this.container.empty();var e=this.model,t=e&&e.get("dsxplan:label");return this._titleElem.inject(this.container),this._fieldContainer.inject(this.container),t||this._titleSpanContainer.classList.add("empty-title"),this._titleSpanContainer.setText(t||"Checklist Item"),this._titleSpanContainer.inject(this._titleElem),this._accordionToolbar.inject(this._titleElem),this._downArrowElem.inject(this._accordionToolbar),this._upArrowElem.inject(this._accordionToolbar),this._trashElem.inject(this._accordionToolbar),this._expanded&&this._drawChecklistItemFields(),this},_drawChecklistItemFields:function(){this._detailsDisplayView||(this._detailsDisplayView=new n(this.cloneModel),this.addChildView(this._detailsDisplayView),this._detailsDisplayView.setConfig(r.getChecklistDetailsConfig())),this._detailsDisplayView.inject(this._fieldContainer),this._detailsDisplayView.render()},_setupGroupElements:function(){let t=this.model.collection,n=t.indexOf(this.model);this._isFirst=0===n,this._isLast=n===t.length-1,this._trashElem=e.createElement("span",{class:"fonticon fonticon-trash"}),this._accordionToolbar=e.createElement("div",{class:"accordion-toolbar"}),this._titleSpanContainer=e.createElement("span",{class:"title"}),this._upArrowElem=e.createElement("span",{class:"fonticon fonticon-up"}),this._downArrowElem=e.createElement("span",{class:"fonticon fonticon-down"}),this._titleElem=e.createElement("div",{class:"form-section-title"}),this._fieldContainer=e.createElement("div",{class:"form-section-body"})},toggleExpanded:function(){this._expanded=!this._expanded,this.dispatchEvent("onToggleExpandCollapse",[this.model,this._expanded]),this.render()},_onCheckListLabelClicked:function(){if(this.toggleExpanded(),this._expanded){var e=this;this._animationFrameForScroll=requestAnimationFrame(function(){e._parentView._parentView.dispatchScrollToElementEvent(e.container),delete e._animationFrameForScroll})}},_onDeleteItem:function(e){e.stopPropagation(),this.dispatchEvent("onDeleteChecklistItem",this.model)},insertChecklistBefore:function(e,t){var n=this.getSequenceOrderForObject({parentModel:e,collection:e.get(i.HAS_CHECKLIST_ATTR),currentModel:t,placement:"before"});this._insertChecklistWithSequenceOrder(e,t,n)},insertChecklistAfter:function(e,t){var n=this.getSequenceOrderForObject({parentModel:e,collection:e.get(i.HAS_CHECKLIST_ATTR),currentModel:t,placement:"after"});this._insertChecklistWithSequenceOrder(e,t,n)},_insertChecklistWithSequenceOrder:function(t,n,s){if(t.get(i.HAS_CHECKLIST_ATTR).contains(n)&&e.is(s,"array")){n.set(i.SEQUENCE_ORDER_ATTR_DSLC,s[0]);let e=t.get(i.HAS_CHECKLIST_ATTR);e&&e.at(s[2]).set(i.SEQUENCE_ORDER_ATTR_DSLC,s[1]),e&&e.sort(),this._parentView.render()}},getSequenceOrderForObject:function(e){var t=e.placement||"after",n=e.collection.indexOf(e.currentModel),s=e.currentModel.get(i.SEQUENCE_ORDER_ATTR_DSLC);if(0===n&&"after"!==t)return s-1-Math.random();if(n===e.collection.length-1&&"after"===t)return s+1+Math.random();var o="after"===t?n+1:n-1;return[e.collection.at(o).get(i.SEQUENCE_ORDER_ATTR_DSLC),s,o]},_onUpArrowClicked:function(e){if(e.stopPropagation(),!this._isFirst){var t=this.model.getParent();this.insertChecklistBefore(t,this.model)}},_onDownArrowClicked:function(e){if(e.stopPropagation(),!this._isLast){var t=this.model.getParent();this.insertChecklistAfter(t,this.model)}},destroy:function(){void 0!==this._animationFrameForScroll&&(cancelAnimationFrame(this._animationFrameForScroll),delete this._animationFrameForScroll),this._parent.apply(this,arguments)}});return r.getChecklistDetailsConfig=function(){return[{readWrite:!0,name:"dsxplan:label",label:a("E6WCommonApps.Label.Item"),type:"text",maxLength:128,required:!0,hideRequiredLegend:!0,removeCarriageReturns:!0,validate:!0},{readWrite:!0,name:"dsxplan:comment",label:a("E6WCommonApps.Label.Description"),type:"textarea",numberOfDisplayLines:3,numberOfEditableLines:6}]},r}),define("DS/E6WCommonApps/Views/ChecklistView",["UWA/Core","DS/UIKIT/Tooltip","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/E6WHandlebarsHelpers","DS/Controls/Button","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/Models/CloneModel","DS/PlatformAPI/PlatformAPI","DS/E6WCommonApps/Views/DetailedToggleView","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/Views/ChecklistItemView","DS/E6WCommonApps/Models/ChecklistItemModel","DS/E6WCommonApps/Collections/ChecklistItemCollection","DS/RDFFoundation/RDFUtils","text!DS/E6WCommonApps/assets/templates/checklist.html.handlebars","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,g,E){"use strict";var A=s.compile(T),C=function(e){return g.get(e)};return n.extend({_uwaClassName:"ChecklistView",tagName:"div",className:"details-display ddv-view checklist-panel",id:function(){return"ChecklistView_"+this.cid},setup:function(){this._editMode=!1,this.expandedModels=[];var e=window.widget.getValue("appId")+".copy";l.subscribe(e,function(e){widget.setValue("copiedData",e)}),this._parent.apply(this,arguments)},render:function(t){this.listenTo(this._parentView,"onScroll",()=>{this.dispatchEvent("onScroll")}),this.container.empty(!0);let n=this._getToolbar();n&&n.destroy(),this._createChecklistAccess=e.is(this.model.model.canModify,"function")&&this.model.model.canModify();let s=this._hasItems();var o=i.i18n;if(i.i18n=C,this.container.setHTML(A({hasItems:s,allowCreation:this._createChecklistAccess})),i.i18n=o,this.checklistItemViews=[],this._drawActionButtons(),s)this._editMode?this._setupChecklistItemViews(t):this._setupChecklistReadOnlyViews();else{this._parentView._parentView.getElement(".body").classList.add("eno-empty-set");const e=this.container.getElement("#emptyCreateButton");e&&e.addEventListener("click",this.addChecklistItem.bind(this))}return this},validate:function(){let e=!1;const t=this.model.get(c.HAS_CHECKLIST_ATTR);return t&&t.forEach(t=>{t.get("dsxplan:label")||(e=!0)}),e},refreshView:function(e){this._dispatchValidationEvent(),this.render(e)},_dispatchValidationEvent:function(){this.validate&&(this.validationError=this.validate(),this.validationError?this.model.dispatchEvent("onValidationFailure"):this.model.dispatchEvent("onValidationSuccess"))},_addChecklistItemView:function(e,t){const n=this;let s=new p(this.buildItemViewOptions({model:e,expand:this.expandedModels.includes(e)||!e.id}));this.listenTo(s,"onToggleExpandCollapse",function(e,t){t?n.expandedModels.push(e):n.expandedModels.indexOf(e)>-1&&n.expandedModels.splice(n.expandedModels.indexOf(e),1)}),this.listenTo(e,"onChange:dsxplan:label",this._dispatchValidationEvent),this.model.addChildCloneModel(s.cloneModel,"dsplan:hasChecklistItem"),this.listenTo(s,"onDeleteChecklistItem",this.removeChecklistItem),this.addChildView(s),this.checklistItemViews.push(s),this.listenTo(this._parentView,"onScroll",()=>{n.dispatchEvent("onScroll")}),s.render().inject(this.container)},_removeChecklistItemView:function(e){let t=this.checklistItemViews.findIndex(function(e){e.model}),n=this.checklistItemViews[t];this.checklistItemViews.splice(t,1),this.model.removeChildCloneModel(n.cloneModel),n.destroy()},_setupChecklistReadOnlyViews:function(){var e=this,t=[{actualValue:"Yes",displayValue:C("E6WCommonApps.Label.Yes")},{actualValue:"No",displayValue:C("E6WCommonApps.Label.No")},{actualValue:"No Answer",displayValue:C("E6WCommonApps.Label.NoAnswer")}];const n=this.model.get(c.HAS_CHECKLIST_ATTR);n&&n.forEach(n=>{let s=new d(function(e){return{i18n:g,isPropertyPanel:!0,config:{titleAttribute:"dsxplan:label",descriptionAttribute:"dsxplan:comment",name:"dsplan:response",readWrite:!0,type:"toggle",toggleType:"radio",values:t},model:e.model}}({model:new r(n)}));this.model.addChildCloneModel(n,"dsplan:hasChecklistItem"),e.addChildView(s),e.listenTo(this._parentView,"onScroll",()=>{e.dispatchEvent("onScroll")}),s.render().inject(this.container)})},_getToolbar:function(){return this._parentView&&this._parentView._parentView.getElement(".body-toolbar")},_hasItems:function(){const e=this.model.get("dsplan:hasChecklistItem");return e&&e.length>0},_drawActionButtons:function(){const n={displayStyle:"lite",label:"lite displayStyle",showLabelFlag:!1,icon:{fontIconFamily:WUXManagedFontIcons.Font3DS}},s=function(t,s,i,a,r){const l={icon:{iconName:t},domId:s};return i&&(l.checkFlag=!0),l.disabled=Boolean(a),l.visibleFlag=Boolean(r),new o(e.extend(l,n,!0))};let i=this._editMode,a=this._getToolbar();if(!a){let n=this._hasItems();a=e.createElement("div",{class:"body-toolbar"});const o=s("plus","addChecklistItem",!1,!i,this._createChecklistAccess),r=s("pencil","switchEditMode",i,!1,this._createChecklistAccess),l=s("copy","copyChecklist",!1,!i||!n,this._createChecklistAccess),d=s("paste","pasteChecklist",!1,!i,this._createChecklistAccess),c=s("trash","deleteChecklist",!1,!i||!n,this._createChecklistAccess);a.inject(this._parentView._parentView.getElement(".body"),"before");let p=e.createElement("span"),u=e.createElement("div",{class:"required-field-label"}),h=e.createElement("span",{class:"required-field-indicator",text:"*"});u.inject(a),h.inject(u),u.appendText(E.get("emxFoundation.Label.RequiredFieldLegend")),p.inject(a),o.inject(p),r.inject(p),l.inject(p),d.inject(p),c.inject(p),o.addEventListener("buttonclick",this.addChecklistItem.bind(this)),r.addEventListener("buttonclick",this.switchEditMode.bind(this)),l.addEventListener("buttonclick",this.copyChecklist.bind(this)),d.addEventListener("buttonclick",this.pasteChecklist.bind(this)),c.addEventListener("buttonclick",this.deleteChecklist.bind(this)),this._buttonTooltips=[],this._buttonTooltips.push(new t({target:o.elements.container,body:C("E6WCommonApps.Label.NewChecklistItem")})),this._buttonTooltips.push(new t({target:r.elements.container,body:C("E6WCommonApps.Label.EditChecklist")})),this._buttonTooltips.push(new t({target:l.elements.container,body:C("E6WCommonApps.Label.CopyChecklist")})),this._buttonTooltips.push(new t({target:d.elements.container,body:C("E6WCommonApps.Label.PasteChecklist")})),this._buttonTooltips.push(new t({target:c.elements.container,body:C("E6WCommonApps.Label.DeleteAllChecklistItems")}))}},buildItemViewOptions:function(t){var n=e.merge({name:"checklistItem",readWrite:!1},t);return{i18n:g,isPropertyPanel:!0,config:n,model:t.model}},_setupChecklistItemViews:function(e){var t=this;const n=this.model.get("dsplan:hasChecklistItem");n.sort(),n&&n.forEach(n=>{t._addChecklistItemView(n,e)})},addChecklistItem:function(){this._editMode||this._actualSwitchEditMode();let e=new u({"dsxplan:jsType":"dsplan:ChecklistItem","dsplan:response":"No Answer"});this.model.add("dsplan:hasChecklistItem",e)},removeChecklistItem:function(e){let t=this.model.get("dsplan:hasChecklistItem").indexOf(e);this.expandedModels.indexOf(e)>-1&&this.expandedModels.splice(this.expandedModels.indexOf(e),1),this.model.remove("dsplan:hasChecklistItem",t)},_actualSwitchEditMode:function(){this._editMode?this._editMode=!this._editMode:this._editMode=!0,this.render()},switchEditMode:function(){const e=this;this.model.modificationsPending?this._parentView._parentView.modal.confirm(this.i18n("E6WCommonApps.Warning.PendingChanges"),this.i18n("E6WCommonApps.Command.CancelChanges"),function(t){t&&(e.model.cancel(),e._actualSwitchEditMode())}):e._actualSwitchEditMode()},_getCopyOfModel:function(e){let t=[c.DSLC_TITLE_ATTR,c.DSLC_DESCRIPTION_ATTR,c.JS_TYPE_ATTR,c.SEQUENCE_ORDER_ATTR_DSLC],n={};return t.forEach(function(t){n[t]=e._attributes[t]}),n[c.RESPONSE_ATTR]="No Answer",new u(n)},pasteChecklistItemsOnPanel:function(e){var t=this.model.get(c.HAS_CHECKLIST_ATTR);t||(t=new h);let n=this._getCopyOfModel(e);t.add(n),this.model.set(c.HAS_CHECKLIST_ATTR,t);this.model.save({mask:"dsplan:MVMask.WorkPackage.Property"})},copyChecklist:function(){const e=this.model.get(c.HAS_CHECKLIST_ATTR);var t,n,s=e.length&&e.at(0).getTransferObject();for(let n=1;n<e.length;n++)t=e.at(n).getTransferObject(),s&&s.data.items.push(t.data.items[0]);n=window.widget.getValue("appId")+".copy",l.publish(n,s),a.displayInfo(C("E6WCommonApps.Alert.ChecklistCopied"))},pasteChecklist:function(){const e=widget.getValue("copiedData"),t=e&&e.data&&e.data.items;for(let e=0;e<t.length;e++)if(m.getObjectById(t[e].objectId))this.pasteChecklistItemsOnPanel(m.getObjectById(t[e].objectId));else{const n=new u({"dsxplan:jsType":t[e].objectType,"dsxplan:label":t[e].displayName,"dsxplan:sequenceOrder":t[e].sequenceOrder,"dsplan:response":"No Answer","dsxplan:comment":t[e].description});this.pasteChecklistItemsOnPanel(n)}},deleteChecklist:function(){this.model.removeAll("dsplan:hasChecklistItem")},destroy:function(){void 0!==this._animationFrameForScroll&&(cancelAnimationFrame(this._animationFrameForScroll),delete this._animationFrameForScroll),this._buttonTooltips.forEach(function(e){e.destroy()}),this._parent.apply(this,arguments)}})}),define("DS/E6WCommonApps/Models/ConstraintCloneModel",["UWA/Core","DS/E6WCommonUI/Models/CloneModel","DS/E6WCommonApps/Models/ConstraintModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonApps/Models/E6WCommonAppsConstants"],function(e,t,n,s,i){"use strict";var o=t.extend({init:function(){this._parent.apply(this,arguments)},dataForRendering:function(){var e=this._parent();e[n.TYPE_ATTR]=this.get(n.TYPE_ATTR);var t=this.get(n.PREDECESSOR_ATTR);e[n.PREDECESSOR_ATTR]=t&&{title:t.get(i.TITLE_ATTR)};var s=this.get(n.SUCCESSOR_ATTR);return e[n.SUCCESSOR_ATTR]=s&&{title:s.get(i.TITLE_ATTR)},e[n.LAG_ATTR]=this.get(n.LAG_ATTR),e[n.ENFORCE_ATTR]=this.getIsEnforcedValue()?"FALSE":"TRUE",e},getIsEnforcedValue:function(){var e=this.get(n.ENFORCE_ATTR);return void 0===e||e},get:function(e){var t=this._parent.apply(this,arguments);return e===n.PREDECESSOR_ATTR||e===n.SUCCESSOR_ATTR?t:(e===n.LAG_ATTR&&(t=void 0!==t?s.xsdDayTimeDurationToMilliseconds(t)/(60*this.getWorkDayLength()*60*1e3):0),t)},set:function(e,t){var s=t;e===n.LAG_ATTR?s=this.getDurationString(t):e===n.TYPE_ATTR?s=t.actualValue?t.actualValue:s:e===n.ENFORCE_ATTR&&(s="FALSE"===t);var i=this._parent(e,s,{whisper:!0});return e!==n.TYPE_ATTR&&e!==n.ENFORCE_ATTR||this.dispatchEvent("onChange:"+e),i},getWorkDayLength:function(){return this.model.getWorkDayLength()},getDurationString:function(e){var t=this.model.getWorkDayLength();return s.millisecondsToXsdDayTimeDuration(e*(60*t*60*1e3))}});return n.prototype.getClone=function(e,t){return new o(e,t)},o}),define("DS/E6WCommonApps/Views/CommonPropertiesConfig",["DS/RDFFoundation/RDFUtils","DS/RDFFoundation/FederatedSearchUtil","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/Models/DropValidator","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/Views/MultiObjectCardView","DS/E6WCommonApps/Views/E6WObjectCardView","DS/E6WCommonApps/Views/UserTagsView","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonApps/Models/AssigneeTypeAhead","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h){"use strict";const m=h.get.bind(h);return{deliverablesSources:()=>t.filterSearchSources(["swym","3dspace","drive","geovia","3dportfolio","bioexperiment","materials"]),attachmentSources:()=>t.filterSearchSources(["swym","3dspace","drive","geovia","3dportfolio","3dplan","bioexperiment","materials"]),deliverableDropValidator:function(e,t){let n=e.serviceId,s=e.objectType;if("dsplan:url"!==s&&("3dplan"===n||"swym:WeDo"===s))return u.replace(u.get("E6WCommonUI.Alert.FailedToAttachProjectPlanningObjects"))},getWorkContextField:function(){return{readWrite:!0,name:p.WORK_CONTEXT_ATTR,attributeToDisplay:"title",imageAttribute:"image",label:m("E6WCommonApps.Label.ContributesTo"),searchTitle:m("E6WCommonApps.Label.SearchForContext"),type:"object",customView:a,typeAheadCallback:e.typeAheadCallback,minLengthBeforeAutocomplete:2,allowFileManagement:!0,linkCallback:l.launchProperties,placeHolder:m("E6WCommonApps.Label.ObjectPlaceHolder"),searchSource:t.filterSearchSources(["swym","3dspace","drive","geovia","3dportfolio","3dplan"]),excludeSearchTypes:{"3dspace":["Person","Security Context"],swym:["pno:Person","swym:WeDo"]},validateSameTenant:!0,getDropDownMenuItems:d.getDocumentTypeDropDownMenuItems}},assigneeFieldConfig:function(e,n){return{readWrite:!n,name:p.ASSIGNEE_ATTR,attributeToDisplay:"fullName",imageAttribute:"image",label:m("E6WCommonApps.Label.Assignees"),searchSourceTypes:{swym:["pno:Person"]},dropTypes:s.RDF_ASSIGNEE_DROP_TYPES,mask:"dsplan:MVMask.Person.Complex",typeAheadCallback:c.callback,type:"person",customView:a,multiCustomView:o,agoraMode:!0,with_synthesis_attribute:!1,searchSource:t.filterSearchSources(["swym"]),dropHandler:s.hasInvalidDroppedObject,linkCallback:l.launchProperties,minLengthBeforeAutocomplete:0,placeHolder:m("E6WCommonApps.Label.ObjectPlaceHolder"),validateSameTenant:!0,addMembers:!0,searchTitle:m("E6WCommonApps.Label.assigneeSearchTitle"),customButtons:[i.assignToSelfButtonConfig()],noResultsMessageCallback:c.noResultsMessageCallback}},getTagsFieldConfig:function(){return{name:p.USER_TAGS,customView:r}}}}),define("DS/E6WCommonApps/Views/ConstraintFieldView",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ResultModel","DS/E6WCommonUI/Views/ObjectCardView","DS/E6WCommonUI/Views/DetailsDisplayView","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonApps/Models/ConstraintModel","DS/E6WCommonApps/Models/ConstraintCloneModel","DS/E6WCommonApps/Models/ScheduleElementModel","DS/E6WCommonApps/Utils/3DSpaceUtils","DS/E6WCommonApps/Views/LinkLauncherUtils","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u){"use strict";var h=10,m=[{name:r.TYPE_ATTR,label:u.get("E6WCommonApps.Label.Type"),type:"select",values:[{actualValue:r.TYPE_START_TO_START,displayValue:u.get("E6WCommonApps.Label.StartToStart")},{actualValue:r.TYPE_FINISH_TO_START,displayValue:u.get("E6WCommonApps.Label.FinishToStart")},{actualValue:r.TYPE_FINISH_TO_FINISH,displayValue:u.get("E6WCommonApps.Label.FinishToFinish")}]},{name:r.LAG_ATTR,label:u.get("E6WCommonApps.Label.LeadLag"),type:"uom",uomValues:[u.get("E6WCommonApps.Label.Days"),u.get("E6WCommonApps.Label.Hours")],minimumValue:"0",maximumValue:"999999999",conversionTable:[1,24]}],T=s.extend({_uwaClassName:"ConstraintFieldView",setup:function(){this._parent.apply(this,arguments),this._config.dropHandler=this.onDrop.bind(this)},getDataOptions:function(){var e=this._parent.apply(this,arguments);return e.level=2,e.attributes.push(r.PREDECESSOR_ATTR,r.SUCCESSOR_ATTR),e},createMenuButtons:function(e){var t=this;this.dropdownMenu&&(this.dropdownMenu.destroy(),delete this.dropdownMenu),this.createDropdownMenu({target:e.target,items:[]}),this.addOpenWith(this.getModelFromCard(e.target)),this.getDropDownMenuItems(e.model.get("type"),e).forEach(function(e){t.dropdownMenu.addItem(e)}),this.listenToOnce(this._parentView,"onScroll",()=>{this.dropdownMenu.hide()})},getDropDownMenuItems:function(e,t){var s,i=this,o=t.model,r=this.getPropertiesButton(t),l=this.getRemoveItemButton(t),d=o.canModify&&!o.canModify(!0);r.disabled=d,l.disabled=o.canDelete&&!o.canDelete(!0),s=a.isXppViewer()?!t.model.id:!t.model.id||d;var c={text:u.get("E6WCommonApps.Label.ToggleConstraintProperties"),fonticon:"doc-text",handler:function(){i._onConstraintDropdownSelected(t.event.target.getParent("li"))},disabled:s};return t.model instanceof n?[r,c,l]:[r]},_onConstraintDropdownSelected:function(e){var n=t.getObjectById(e.getAttribute("data-id"));this._selectedConstraint===n?(this._hideDetailsDisplay(),delete this._selectedConstraint):(this._setupDetailsDisplay(n),this._detailsDisplayContainer.inject(e,"after"),this._selectedConstraint=n)},_hideDetailsDisplay:function(){this._detailsDisplayContainer&&this._detailsDisplayContainer.remove()},_setupDetailsDisplay:function(t){this._detailsDisplayView||(this._detailsDisplayView=new i,this.addChildView(this._detailsDisplayView),this._detailsDisplayView.setConfig(m),this._detailsDisplayContainer=e.createElement("li",{class:"nested-properties",styles:{height:"152px","background-color":"rgb(240, 240, 240)",border:"1px solid rgb(161, 161, 161)"}}),this._detailsDisplayView.inject(this._detailsDisplayContainer)),this._detailsDisplayView.resetModel(new l(t)),this._detailsDisplayView.render()},getExistingObjs:function(){var e=[];return this.normalizedGet(this.model,"toConstraints").forEach(function(t){t.getPredecessor()&&e.push({id:t.getPredecessor().id})}),this.normalizedGet(this.model,"fromConstraints").forEach(function(t){t.getSuccessor()&&e.push({id:t.getSuccessor().id})}),e},getModelFromFullTextSearch:function(e){var n=t.getObjectById(e.id),s=this;if(!n){var i=e["ds6w:type_value"]||e["ds6w:type"];(n=new(t.getModelConstructor({"@type":i}))(t.createPlaceholder(t.removeBracketLongURI(e.id),"",i,{forceDslc:!0}))).addEventOnce("onSync",function(){s.model.dispatchEvent("onChange:"+s._config.name)}),n.fetch({mask:"dsplan:MVMask.Task.Basic"})}return n},_modelCanBeUsedAsDependency:function(e){var t;if(e instanceof d)if(e.id===this.model.model.id)t=u.replace(u.get("E6WCommonUI.Alert.CantBeConstrainedToItself"),{OBJECT_NAME:e.get("title")});else{var n=this.normalizedGet(this.model,"toConstraints").some(function(t){return t.getPredecessor()&&t.getPredecessor().id===e.id});(n=n||this.normalizedGet(this.model,"fromConstraints").some(function(t){return t.getSuccessor()&&t.getSuccessor().id===e.id}))&&(t=u.replace(u.get("E6WCommonUI.Alert.AlreadyHasConstraint"),{OBJECT_THIS:this.model.get("title"),OBJECT_THAT:e.get("title")}))}else t=u.get("E6WCommonUI.Alert.CanOnlyConstrainTasksAndMilestones");return t&&o.displayWarning(t),void 0===t},modelAdd:function(e,t,n){var s=this,i=[];n.detailedObjects.forEach(function(t){if(!t.model&&t["ds6w:type"]&&(t.model=s.getModelFromFullTextSearch(t)),s._modelCanBeUsedAsDependency(t.model)){var n=t.model,o={};o[r.TYPE_ATTR]=r.TYPE_FINISH_TO_START,o[r.PREDECESSOR_ATTR]="fromConstraints"===e?s.model.model:n,o[r.SUCCESSOR_ATTR]="fromConstraints"===e?n:s.model.model,o[r.ENFORCE_ATTR]=!0,i.push(new r(o,{mask:"dsplan:MVMask.TempConstraint.Complex",dontUpdateConstrainedScheduleElements:!0}))}}),i.length>0&&this.model.add(this._config.name,i,n)},getModelFromCard:function(){var e=this._parent.apply(this,arguments);return e instanceof r?"fromConstraints"===this._config.name?e.getSuccessor():e.getPredecessor():e},onDrop:function(e){if(this.validateDroppedObjects(e))return!0;var t=o.getDataTransferJSON(e);if(t){for(var n=[],s=0;s<t.data.items.length;s++){var i=t.data.items[s],a=i.objectType;n.push({id:i.objectId,"ds6w:type":a})}this.modelAdd(this._config.name,[],{detailedObjects:n})}return!0},getActiveModel:function(e){var t=this._parent.apply(this,arguments);t||this.normalizedGet(this.model,this._config.name).some(function(n){return n.cid===e&&(t=n),n.cid===e});return t},objectClick:function(e){var t=this.getModelFromCard(e.target);c.fetchParentTypesWithCallback(t,function(){p.launchProperties(t.id,{model:t})})}}),g=function(e){var t={};return t.value=e.id,t.label=e.get("dsxplan:label"),t.model=e,t.image=e.getIconURL(),t};return T.typeAheadCallback=function(e,n,s,i){var o=e.modelId,a=e.getVisibleModels,r=e.getModelsToFilter;(function(e,t,n,s){var i=new RegExp(e,"i"),o=this.model.model,a=function(){var a=[];if(e.length<2&&t)a=t();else{var r=[];if(n)r=n();else{var l=o.getParent();l&&(r=l.getTasks())}r.forEach(function(e){e.get("title")&&e.get("title").match(i)&&a.push(e)})}s(a)};if(n&&e.length>=2)a();else{var r=o.getParent();if(r&&r.hasViewAccess()&&r.getTasks().length)return void a();o.fetch({mask:"dsplan:MVMask.Task.CollaborativeTask.siblings",onComplete:a,onFailure:a})}}).call(this,s,a,r,function(e){var n=t.getBatchGenerator(),s=[],a=[];function r(e){var t=e.isComplete&&e.isComplete();return o!==e.id&&e.isRDF&&!t}function l(e){for(var t=0;t<e.length&&s.length<h;t++){var i=e[t];i.hasFetchedAccessData()?r(i)&&s.push(g(i)):(a.push(i),n.addRequestsFromBatch(i.getAccessBatch()))}}l(e),s.length<h&&n.requests.length?n.sendBatch({onComplete:function(){l(a),i(s)}}):i(s)})},T}),define("DS/E6WCommonApps/Views/ObjectIDPanelUtil",["UWA/Core","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/E6WCommonApps/TreeNodeUtil","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s){"use strict";var i=s.get.bind(s);return{getObjectIDFieldConfig:function(e){return{readWrite:e,name:t.UNIQUE_OBJECT_ID_ATTR,label:i("E6WCommonApps.Label.UniqueObjectId"),type:"text",maxLength:128,validate:!0,neverEditable:!0}},getObjectIDFieldForTableConfig:function(e){return{text:i("E6WCommonApps.Label.UniqueObjectId"),dataIndex:n.COLUMN_DATA_INDICES.uniqueObjectId,typeRepresentation:"string",editableFlag:e,sortableFlag:!0,visibleFlag:!0,className:"grid-title-cell"}}}}),define("DS/E6WCommonApps/FileUploadRepositoryUtil",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/DocumentManagement/DriveDocumentManagement","DS/RDFFoundation/SecurityContextUtils","DS/E6WCommonUI/UIHelper","DS/RDFFoundation/Models/CollabspaceRepositoryModel","DS/RDFFoundation/Models/DriveRepositoryProxyModel","DS/E6WCommonUI/Views/ObjectCardView","DS/RDFFoundation/FederatedSearchUtil","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/Views/E6WObjectCardView","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u){"use strict";var h=u.get.bind(u),m={fileUploadRepositoryTypeAheadCallback:function(n,s,i,o){var r=[],l=e.clone(o||{},!1);l.attribute=n.name,s.length>1&&n.searchSource&&n.searchSource.length>0?(r=m.getFiltered3DSpaceFileUploadRepository(s,l),t.typeAheadCallback(n,s,function(e,n){if(e&&e.length>0)for(var s=0;s<e.length;s++){var o=a.ID_PREFIX+e[s].value;e[s].value=o,t.getObjectForAdding(a,o),r.push(e[s])}i(r,n)},o)):i(m.getFiltered3DSpaceFileUploadRepository(s,l))},getFiltered3DSpaceFileUploadRepository:function(e,n){for(var i=new RegExp(e,"i"),a=[],r=s.getContentRepositoryValuesForDetailDisplay(n.model.model,n)(),l=0;l<r.length;l++){var d=r[l].actualValue,c=t.getObjectForAdding(o,d,{attrs:r[l]});c.get("title").match(i)&&a.push({id:c.id,label:c.get("title"),image:c.get("image"),model:c})}return a},repositoryDropHandler:function(e,n,s){if(s.objectView.validateDroppedObjects(e))return!1;var o=i.getDataTransferJSON(e);if(o&&o.data.items){var r=o.data.items[0];if("3DDrive"===r.serviceId){var l=a.ID_PREFIX+r.objectId;return o.data.items[0].objectId=l,t.getObjectForAdding(a,l),s.objectView.processDropData(o),!0}}return!1},getRepositoryFieldConfig:function(e){return{readWrite:!e,name:p.CONTENT_REPOSITORY,label:h("E6WCommonApps.Label.CollaborativeSpace"),attributeToDisplay:"title",imageAttribute:"image",searchTitle:h("E6WCommonApps.Label.SearchForUploadRepository"),type:"object",customView:c,minLengthBeforeAutocomplete:0,singleObjectOnly:!0,typeAheadCallback:m.fileUploadRepositoryTypeAheadCallback,dropHandler:m.repositoryDropHandler,placeHolder:h("E6WCommonApps.Label.ObjectPlaceHolder"),validateSameTenant:!0,linkCallback:d.launchProperties,searchSource:l.filterSearchSources(["drive"]),excludeSearchTypes:{drive:["DriveFile"]},noOpenWith:!0}},getCollaborativeSpaceForRiskConfig:function(e){return{readWrite:e.canShare(),name:p.RISK_REPOSITORY,label:h("E6WCommonApps.Label.CollaborativeSpaceForRisk"),attributeToDisplay:"title",imageAttribute:"image",type:"object",isThumbnail:!0,disableRemove:!0,customView:c,minLengthBeforeAutocomplete:0,singleObjectOnly:!0,typeAheadCallback:m.fileUploadRepositoryTypeAheadCallback,placeHolder:h("E6WCommonApps.Label.TypeAheadOnlyPlaceHolder"),validateSameTenant:!0,linkCallback:d.launchProperties,noOpenWith:!0,noAction:!0}},getBookmarkForRepositoryFieldConfig:function(e){return{readWrite:!e,name:p.BOOKMARK_FOR_FILE_REPOSITORY,attributeToDisplay:"title",imageAttribute:"image",singleObjectOnly:!0,label:h("E6WCommonApps.Label.BookmarkForRepository"),searchTitle:h("E6WCommonApps.Label.SearchForBookmark"),type:"object",customView:c,typeAheadCallback:t.typeAheadCallback,minLengthBeforeAutocomplete:2,linkCallback:d.launchProperties,placeHolder:h("E6WCommonApps.Label.ObjectPlaceHolder"),searchSourceTypes:{"3dspace":["Workspace","Workspace Vault"]},searchSource:["3dspace"]}}};return m}),define("DS/E6WCommonApps/Views/DependencyGroupView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/E6WCommonApps/Views/ConstraintFieldView","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o){"use strict";var a=t.extend({_uwaClassName:"DependencyGroupView",tagName:"div",className:"form-section accordion details-display-shared-view ddv-field form-group",domEvents:{"click .form-section-title":"_onGroupLabelClicked"},id:function(){return"DependencyGroup_"+this.cid},setup:function(t){this._parent.apply(this,arguments),this._dependencyi18n=o.get("E6WCommonApps.Label.Dependencies"),this._labelElem=e.createElement("label",{class:"top-label"}),this.container.setAttribute("data-field-index",1),this._setupGroupElements(),this._updateGroupTitle(),this._getVisibleModels=t.config.getVisibleModels,this._getModelsToFilter=t.config.getModelsToFilter,this.model&&this._listenToConstraints()},render:function(){return this._toConstraintView&&(this._toConstraintView.removeAutoCompleteFromDOM(),this._fromConstraintView.removeAutoCompleteFromDOM()),this.container.empty(!0),this._titleElem.inject(this.container),this._fieldContainer.inject(this.container),this._updateGroupTitle(),this._expanded&&this._drawConstraints(),this},resetModel:function(e){this._parent.apply(this,arguments),this._updateGroupTitle(),this._listenToConstraints(),this._fromConstraintView&&(this._fromConstraintView.resetModel(e),this._toConstraintView.resetModel(e))},toggleExpanded:function(e){this._expanded=void 0!==e?e:!this._expanded,this.render()},_getGroupTitle:function(){var e=this._dependencyi18n;if(this.model){var t=this.model.get("toConstraints")||this.model.get("predecessors"),n=t?t.length:0,s=this.model.get("fromConstraints")||this.model.get("successors");e+=" ("+((s?s.length:0)+n)+")"}return e},_updateGroupTitle:function(){this._titleElem.setText(this._getGroupTitle())},_drawConstraints:function(){this._fromConstraintView||this._setupConstraintViews(),this._fieldContainer.empty(!0),this._toConstraintView.render().inject(this._fieldContainer),this._fromConstraintView.render().inject(this._fieldContainer)},_listenToConstraints:function(){var e=this._updateGroupTitle.bind(this),t={"onChange:toConstraints":e,"onChange:fromConstraints":e};this.listenTo(this.model,t)},_onGroupLabelClicked:function(){if(this.toggleExpanded(),this._expanded){var e=this;this._animationFrameForScroll=requestAnimationFrame(function(){e._parentView.dispatchScrollToElementEvent(e.container),delete e._animationFrameForScroll})}},_setupGroupElements:function(){this._titleElem=e.createElement("div",{class:"form-section-title",html:this._getGroupTitle()}),this._fieldContainer=e.createElement("div",{class:"form-section-body"})},_setupConstraintViews:function(){var t=this,s=n.typeAheadCallback.bind(this,{modelId:t.model.id,getVisibleModels:t._getVisibleModels,getModelsToFilter:t._getModelsToFilter}),i=function(n){var i=e.merge(a.getConstraintFieldBasicConfig(t.model),n);return{i18n:o,isPropertyPanel:!0,model:t.model,config:e.merge(i,{typeAheadCallback:s})}},r=a.isModelProjectTask(t.model),l=r?"successors":"fromConstraints",d=r?"predecessors":"toConstraints",c=r?"typeicon":"successorImage",p=r?"typeicon":"predecessorImage",u=r?"title":"successorTitle",h=r?"title":"predecessorTitle";this._fromConstraintView=new n(i({name:l,label:o.get("E6WCommonApps.Label.Impacts"),searchTitle:o.get("E6WCommonApps.Label.Impacts"),attributeToDisplay:u,imageAttribute:c})),this._toConstraintView=new n(i({name:d,label:o.get("E6WCommonApps.Label.DependsOn"),searchTitle:o.get("E6WCommonApps.Label.DependsOn"),attributeToDisplay:h,imageAttribute:p})),this.addChildView(this._fromConstraintView),this.addChildView(this._toConstraintView),this.listenTo(this._parentView,"onScroll",()=>{this.dispatchEvent("onScroll")})},destroy:function(){void 0!==this._animationFrameForScroll&&(cancelAnimationFrame(this._animationFrameForScroll),delete this._animationFrameForScroll),this._parent.apply(this,arguments)}});return a.isModelProjectTask=function(e){return e&&e.isProjectTask&&e.isProjectTask()},a.getConstraintFieldBasicConfig=function(e){let t=e.get(i.RESTRICT_ASSIGNEE_ATTR);return{type:"object",readWrite:!a.isModelProjectTask(e)&&!t,minLengthBeforeAutocomplete:0,validateSameTenant:!0,searchSourceTypes:{"3dplan":["dsplan:Task","dsplan:Milestone"],swym:["swym:WeDo"]},searchSource:["3dplan","swym"],linkCallback:s.launchProperties,noOpenWith:!0}},a}),define("DS/E6WCommonApps/Views/RDFTaskDetailsPanelConfig",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/FederatedSearchUtil","DS/E6WCommonApps/Models/E6WCommonAppsConstants","DS/RDFFoundation/SecurityContextUtils","DS/E6WCommonApps/AgileProjectUtils","DS/E6WCommonApps/Views/LinkLauncherUtils","DS/E6WCommonApps/SmartSchedulerUtils","DS/E6WCommonApps/Views/DependencyGroupView","DS/E6WCommonApps/Models/AssigneeTypeAhead","DS/E6WCommonApps/Models/WorkscopeModel","DS/E6WCommonApps/Views/FixedStartStopView","DS/E6WCommonApps/Views/TaskDurationEstimatedRangeStartStop","DS/E6WCommonUI/Views/StartStopView","DS/E6WCommonApps/Views/RichTextEditorView","DS/E6WCommonApps/Views/PriorityView","DS/E6WCommonUI/Models/DropValidator","DS/E6WCommonUI/Views/ObjectCardView","DS/E6WCommonUI/Views/MultiPriorityView","DS/E6WCommonUI/Views/MultiStartStopView","DS/RDFFoundation/Models/RDFCloneModel","DS/E6WCommonApps/FileUploadRepositoryUtil","DS/E6WCommonApps/Models/NoAccessModel","DS/E6WCommonApps/Views/E6WObjectCardView","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/FeatureFlagUtils","DS/E6WCommonUI/Views/MultiObjectCardView","DS/E6WCommonUI/Views/MultiEditUomView","DS/E6WCommonApps/Views/E6WCustomUomView","DS/E6WCommonApps/Preferences","DS/E6WCommonApps/Views/CommonPropertiesConfig","DS/E6WCommonApps/Views/ObjectIDPanelUtil","DS/E6WCommonApps/Utils/RapidUtils","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r,l,d,c,p,u,h,m,T,g,E,A,C,f,_,D,S,R,v,y,b,M,I,O,P,k,N,F){"use strict";var W=function(e){return F.get(e)},w={};return w.config=function(i,d){var c=i.isComplete(),u=i.isStarted(),h=i.get(s.COMMON_TASK_PARENT_ATTR),g=R.isWedoTask(i.get(s.JS_TYPE_ATTR)),E=Boolean(h)||h&&"dsplan:DummyProject"!==h.id,f=O.getActiveBaselineModel(),D=N.hasSubtasks(i.model||i),v=i.get(s.RESTRICT_ASSIGNEE_ATTR),y=t.isStoryTask(i);var M=[{readWrite:!v,name:s.TITLE_ATTR,label:W("E6WCommonApps.Label.Title"),type:"text",maxLength:128,required:!0,removeCarriageReturns:!0,validate:!0},k.getObjectIDFieldConfig(!1),{readWrite:!v,name:s.DESCRIPTION_ATTR,titleAttribute:s.TITLE_ATTR,richTextField:g?null:"dsplan:RichTextField",label:W("E6WCommonApps.Label.Description"),type:"RichText",customView:m,numberOfDisplayLines:3,numberOfEditableLines:3},w.parentFieldConfig(i,v),{readWrite:!v,name:s.PRIORITY_ATTR,label:W("E6WCommonApps.Label.Priority"),multiCustomView:A,customView:T},{readWrite:!D,name:s.STATE_ATTR,label:W("E6WCommonApps.Label.MaturityState"),type:"select",validate:!0}];if(y&&(M.push(e.extend(P.getWorkContextField(),{singleObjectOnly:!0,searchSource:o.getContextSearchSources(),searchSourceTypes:o.contextSearchSourceTypes})),i.get(s.WORK_CONTEXT_ATTR)&&M.push({readWrite:!v,name:s.STORY_POINTS,label:W("E6WCommonApps.Label.StoryPoints"),type:"number",minimumValue:"0",maximumFractionDigits:15,validate:!0,allowEmpty:!0,tooltipTitle:W("E6WCommonApps.Label.SetStoryPoints"),tooltipBody:W("E6WCommonApps.Label.StoryPointsTooltip")})),M.push({readWrite:!D,name:s.COMPLETE_PERCENT_ATTR,label:W("E6WCommonApps.Label.Percent"),type:"range",step:5,percents:!0},{readWrite:!v,name:u||c?s.ACTUAL_START_DATE:s.STARTDATE_ATTR,startDateLabel:W(u||c?"E6WCommonApps.Label.ActualStart":"E6WCommonApps.Label.PlannedStart"),canEditStartDate:function(e){var t=(u||c)&&D;return(e.isStartDateFixed()||u)&&!t},endDateAttribute:c?s.ACTUAL_END_DATE:s.ENDDATE_ATTR,endDateLabel:W(c?"E6WCommonApps.Label.ActualEnd":"E6WCommonApps.Label.PlannedEnd"),isStartDateManualAttribute:s.USER_DEFINED_START_DATE_ATTR,isEndDateManualAttribute:s.USER_DEFINED_END_DATE_ATTR,canEditEndDate:function(e){var t=c&&D;return(e.isEndDateFixed()||c)&&!t},type:"startStop",customView:p,multiCustomView:C,validate:!0},w.durationFieldConfig(c,v,d,i),w.assigneeFieldConfig(i,v),w.candidateAssigneeFieldConfig(i,v),{readWrite:!0,name:s.REMINDER_DAYS,label:W("E6WCommonApps.Label.TaskReminder"),type:"number",minimumValue:"0",maximumValue:"999999999",validate:!0,integerOnly:!0}),M.push(w.attachmentFieldConfig,{readWrite:!0,name:s.ACTUAL_DELIVERABLE_ATTR,attributeToDisplay:"title",imageAttribute:"image",label:W("E6WCommonApps.Label.Deliverables"),searchTitle:W("E6WCommonApps.Label.SearchForDeliverables"),type:"object",customView:S,typeAheadCallback:t.typeAheadCallback,linkCallback:a.launchProperties,allowFileManagement:!0,allowUrlLink:!0,dropTypes:{"3dplan":["dsplan:url"]},placeHolder:W("E6WCommonApps.Label.ObjectPlaceHolder"),searchSource:P.deliverablesSources(),excludeSearchTypes:{"3dspace":["Person","Security Context","Business Role"],swym:["pno:Person","swym:WeDo"]},validateSameTenant:!0,limit:100,getDropDownMenuItems:r.getDocumentTypeDropDownMenuItems,validateDroppedObject:P.deliverableDropValidator},{readWrite:function(){let e=i&&i.canDelete&&i.canDelete(!0)||i.model&&i.model.canDelete(!0);return Boolean(!g&&(R.isModelOwnerTheLoggedInUser(i)||e))}(),name:s.OWNER_ATTR,attributeToDisplay:"fullName",imageAttribute:"image",label:W("E6WCommonApps.Label.Owner"),searchSourceTypes:{swym:["pno:Person"]},customView:S,multiCustomView:b,type:"person",searchSource:n.filterSearchSources(["swym"]),linkCallback:a.launchProperties,validateSameTenant:!0,typeAheadCallback:t.typeAheadCallback,singleObjectOnly:!0,disableRemove:!0,excludePendingUser:!0,searchTitle:W("E6WCommonApps.Label.ownerSearchTitle")},{name:s.CREATION_DATE_ATTR,label:W("E6WCommonApps.Label.Created"),type:"date"},{name:s.LASTUPDATED_ATTR,label:W("E6WCommonApps.Label.LastUpdated"),type:"date"},_.getRepositoryFieldConfig(v),_.getBookmarkForRepositoryFieldConfig(v),{name:"dependencies",customView:l},P.getTagsFieldConfig()),!E){var I=M.findIndex(e=>"dependencies"===e.name);M.splice(I,1)}if(g){var F=M.findIndex(e=>e.name===s.REMINDER_DAYS);M.splice(F,1)}var L=M.findIndex(e=>e.name===s.COMPLETE_PERCENT_ATTR);if(u&&!c?M.splice(L+1,0,{readWrite:!1,name:s.STARTDATE_ATTR,startDateLabel:W("E6WCommonApps.Label.PlannedStart"),type:"startStop",labelPosition:"top",disableMultiEdit:!0}):c&&M.splice(L+1,0,{readWrite:!1,name:s.STARTDATE_ATTR,startDateLabel:W("E6WCommonApps.Label.PlannedStart"),endDateAttribute:s.ENDDATE_ATTR,endDateLabel:W("E6WCommonApps.Label.PlannedEnd"),type:"startStop",disableMultiEdit:!0,labelPosition:"top"}),g?M.splice(3,0,{name:s.PARENT_HAS_SWYM_COMMUNITY,label:W("E6WCommonApps.Label.Community"),imageAttribute:"image",type:"object",customView:S,attributeToDisplay:"title",linkCallback:a.launchProperties,validateSameTenant:!0}):i.isLeanTask()&&M.splice(3,0,{name:s.PARENT_HAS_LEAN_BOARD,label:W("E6WCommonApps.Label.LeanBoard"),imageAttribute:"image",type:"object",customView:S,attributeToDisplay:"title",linkCallback:a.launchProperties,validateSameTenant:!0}),f&&O.getShowBaselines()){var U=f.getDataForModel(i);if(U){var x=U.state===s.BASELINE_STATE_IN_PROGRESS,V=U.state===s.BASELINE_STATE_DONE,j=M.findIndex(e=>e.name===s.DURATION_ESTIMATED_RANGE||e.name===s.DURATION);M.splice(j+1,0,{readWrite:!1,name:x||V?s.BASELINE_ACTUAL_START_DATE:s.BASELINE_ESTIMATED_START_DATE,startDateLabel:W(x||V?"E6WCommonApps.Label.BaselineActualStart":"E6WCommonApps.Label.BaselinePlannedStart"),endDateAttribute:V?s.BASELINE_ACTUAL_END_DATE:s.BASELINE_ESTIMATED_END_DATE,endDateLabel:W(V?"E6WCommonApps.Label.BaselineActualEnd":"E6WCommonApps.Label.BaselinePlannedEnd"),type:"startStop",labelPosition:"top"})}}return M},w.options={onFailure:function(e,t,n){if(t&&(t.msg||t.message)){var s=t.msg.replace("Error: ","");-1!==t.msg.indexOf("{")&&(t=JSON.parse(t.msg.trim())),t.message&&(s=t.message);var i=s.split("|");if(i.length>1){if("xPlan.Error.invalidReparenting"===(s=i[0])){var o=R.i18n("E6WCommonUI.Alert.ReparentingFailed");R.displayError(o)}}else"E6WCommonApps.Error.notALeader"===s?e.isStandaloneTask()?R.displayError(W("E6WCommonApps.Error.parentProjectChangeRefusedStandaloneTask")):R.displayError(W("E6WCommonApps.Error.parentProjectChangeRefused")):"xPlan.Error.InvalidParentChildConstraint"===s?R.displayError(W("E6WCommonApps.Error.InvalidParentChildConstraint")):R.displayError(W(s))}else"E6WCommonApps.Error.NoWedoModifyAccess"===t?R.displayError(W(t)):n&&n.isMassEdit||R.displayError(W("E6WCommonApps.Error.SaveFailed"))}},w.assigneeFieldConfig=function(e,t){var n=P.assigneeFieldConfig(e,t);return R.isWedoTask(e.get(s.JS_TYPE_ATTR))&&delete n.readWrite,n},w.candidateAssigneeFieldConfig=function(t,i){return e.extend(w.assigneeFieldConfig(t,i),{name:s.CANDIDATE_ASSIGNEE_ATTR,label:W("E6WCommonApps.Label.CandidateAssignees"),searchSourceTypes:{swym:["pno:Person"],usersgroup:["foaf:Group"]},searchSource:n.filterSearchSources(["swym","usersgroup"]),dropTypes:{swym:[s.PERSON_TYPE],usersgroup:[s.USER_GROUP_TYPE],"3dspace":["Person","Group Proxy","Group"]},searchTitle:W("E6WCommonApps.Label.candidateAssigneeSearchTitle"),customButtons:[]})},w.durationFieldConfig=function(e,t,n,i){var o={readWrite:!1,name:s.DURATION_ESTIMATED_RANGE,startDateLabel:W("E6WCommonApps.Label.Duration"),type:"startStop",customView:u,labelPosition:"top"};return!e&&i.get("dsxplan:hasSubtask")&&i.get("dsxplan:hasSubtask")._models.length>0?o:!e||n&&n.multiSelect?{readWrite:function(e,t){let n=t.isStarted&&t.isStarted(),s=t.isEndDateFixed();return!e&&!(t.isStartDateFixed()&&s&&!n||s&&n)}(t,i),name:s.DURATION,fieldLabel:W("E6WCommonApps.Label.Duration"),type:"uom",customView:I,uomValues:[W("E6WCommonApps.Label.Days"),W("E6WCommonApps.Label.Hours")],minimumValue:"0",maximumValue:"3652",toleranceName:s.DURATION_RANGE,toleranceLabel:W("E6WCommonApps.Label.PlusMinusOffset"),conversionTable:[1,8],validate:!0}:(o.endDateAttribute=s.DURATION_ACTUAL,o.endDateLabel=W("E6WCommonApps.Label.ActualDuration"),o)},w.parentFieldConfig=function(e,t){return{readWrite:!(e.get(s.COMMON_TASK_PARENT_ATTR)instanceof D)&&!t&&v.isXPPAuthorized(),name:s.COMMON_TASK_PARENT_ATTR,attributeToDisplay:"title",imageAttribute:"image",singleObjectOnly:!0,label:W("E6WCommonApps.Label.Parent"),typeAheadCallback:c.parentPlanTypeAhead,minLengthBeforeAutocomplete:2,type:"object",disableRemove:!0,customView:S,searchSourceTypes:{"3dplan":["dsplan:Project","dsplan:Task","dsplan:xProject"]},searchSource:["3dplan"],searchTitle:W("E6WCommonApps.Label.Parent"),placeHolder:W("E6WCommonApps.Label.ObjectPlaceHolder"),dropHandler:c.processDropData,linkCallback:a.launchProperties,validateSameTenant:!0}},Object.defineProperty(w,"attachmentFieldConfig",{get:function(){return{readWrite:!0,name:s.ATTACHMENT_ATTR,attributeToDisplay:"title",imageAttribute:"image",label:W("E6WCommonApps.Label.Attachments"),searchTitle:W("E6WCommonApps.Label.SearchForAttachments"),type:"object",customView:S,typeAheadCallback:t.typeAheadCallback,linkCallback:a.launchProperties,allowFileManagement:!0,allowUrlLink:!0,dropTypes:{"3dplan":["dsplan:url"]},placeHolder:W("E6WCommonApps.Label.ObjectPlaceHolder"),searchSourceTypes:{"3dplan":["dsplan:Project","dsplan:Task","dsplan:Milestone","dsplan:xProject","dsplan:AgileProject"]},searchSource:P.attachmentSources(),excludeSearchTypes:{"3dspace":["Person","Security Context","Business Role"],swym:["pno:Person"]},validateSameTenant:!0,limit:100,getDropDownMenuItems:r.getDocumentTypeDropDownMenuItems}}}),w}),define("DS/E6WCommonApps/Models/ModificationModel",["UWA/Core","UWA/Class/Model","UWA/Class/Collection","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/PersonRDFModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a,r){"use strict";var l=r.get.bind(r),d="dsplan:modificationType",c={};c.created=l("E6WCommonApps.Modification.ElementAdded"),c.commentAdded=l("E6WCommonApps.Modification.CommentAdded"),c.contentAdded=l("E6WCommonApps.Modification.ContentAdded"),c.contentRemoved=l("E6WCommonApps.Modification.ContentRemoved"),c.memberAdded=l("E6WCommonApps.Modification.MemberAdded"),c.memberRemoved=l("E6WCommonApps.Modification.MemberRemoved"),c.elementRemoved=l("E6WCommonApps.Modification.ElementRemoved"),c.projectCreated=l("E6WCommonApps.Modification.ProjectAdded"),c.projectChanged=l("E6WCommonApps.Modification.ProjectChanged"),c.completed=l("E6WCommonApps.Modification.ElementCompleted"),c.reopened=l("E6WCommonApps.Modification.ElementReopened"),c.taskDuplicated=l("E6WCommonApps.Modification.TaskDuplicated"),c.taskSplit=l("E6WCommonApps.Modification.TaskSplit");var p=new t({title:""});p.getObjectType=function(){return"Object"};var u=["contentAdded","contentRemoved","memberAdded","memberRemoved"],h=s.extend({_uwaClassName:"ModificationModel",_relations:[{key:"modifications",relatedCollection:n}],buildText:function(){var e=this.get(d),t=c[e];return r.replace(t,this._getNlsValuesToReplace())},_getNlsValuesToReplace:function(){var e=this.getModifiedObject(),t=this.getRelatedObject(),n=function(e){return"<strong>"+(e?e.htmlEncode():e)+"</strong>"},s={USER:n(this.getModifier().fullName)};switch(this.get(d)){case"created":case"completed":case"commentAdded":case"reopened":case"taskDuplicated":case"taskSplit":s.TYPE=l("E6WCommonApps.Type."+e.getObjectType()),s.TITLE=n(e.get("title"));break;case"contentAdded":case"contentRemoved":s.TYPE=l("E6WCommonApps.Type."+e.getObjectType()),s.TITLE=n(e.get("title")),s.CONTENT=n(t.get("title"));break;case"memberAdded":case"memberRemoved":s.MEMBER=n(t.fullName);break;case"projectCreated":s.TITLE=n(e.get("title"));break;case"projectChanged":s.TITLE=n(e.get("title")),s.NEW_PROJECT_TYPE=l(e.getProjectTypeNLS()),s.ORIGINAL_PROJECT_TYPE=l("E6WCommonApps.Type.TeamProject")}return s},get:function(e){switch(e){case"image":return this.getImage();case"text":return this.buildText();case"timeStamp":return this.getDate().strftime("%H:%M");default:return this._parent.apply(this,arguments)}},getProject:function(){return this.get("dsplan:forProject")},getModifiedObject:function(){var e=this.get("dsplan:modifies");return e&&e.getObjectType()?e:p},getModifier:function(){return this.get("dsplan:performedBy")},getDate:function(){return new Date(this.get("dspol:creationDate"))},getRelatedObject:function(){return this.get("dsplan:relatedObject")},getImage:function(){var e=this.getModifier()&&this.getModifier().get("image");if(-1!==u.indexOf(this.get(d))){var t=this.getRelatedObject();e=t&&t.get("image")}return e},hasViewAccess:()=>!0});return h.TYPE=d,h.MODIFIES="dsplan:modifies",h.MODIFICATIONS="modifications",h.FOR_PROJECT="dsplan:forProject",h.PERFORMED_BY="dsplan:performedBy",h.RELATED_OBJECT="dsplan:relatedObject",h.TYPE_CREATED="created",h.TYPE_COMMENT="commentAdded",h.TYPE_CONTENT_ADDED="contentAdded",h.TYPE_CONTENT_REMOVED="contentRemoved",h.TYPE_MEMBER_ADDED="memberAdded",h.TYPE_MEMBER_REMOVED="memberRemoved",h.TYPE_COMPLETED="completed",h.TYPE_ELEMENT_REMOVED="elementRemoved",h.TYPE_PROJECT_CREATED="projectCreated",h.TYPE_PROJECT_CHANGED="projectChanged",h.TYPE_HIDDEN="hidden",h.TYPE_REOPENED="reopened",h.TYPE_TASK_DUPLICATED="taskDuplicated",h.TYPE_TASK_SPLIT="taskSplit",h}),define("DS/E6WCommonApps/Models/GroupedModificationModel",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/RequestUtils","DS/RDFFoundation/Collections/ResultCollection","DS/E6WCommonApps/Models/ModificationModel","DS/E6WCommonApps/Models/E6WCommonAppsConstants","i18n!DS/E6WCommonApps/assets/nls/E6WCommonAppsNLS"],function(e,t,n,s,i,o,a){"use strict";var r=i.MODIFICATIONS,l=i.TYPE,d={};d[i.TYPE_CREATED]="E6WCommonApps.Modification.ElementsAdded",d[i.TYPE_COMMENT]="E6WCommonApps.Modification.CommentsAdded",d[i.TYPE_CONTENT_ADDED]="E6WCommonApps.Modification.ContentsAdded",d[i.TYPE_CONTENT_REMOVED]="E6WCommonApps.Modification.ContentsRemoved",d[i.TYPE_MEMBER_ADDED]="E6WCommonApps.Modification.MembersAdded",d[i.TYPE_COMPLETED]="E6WCommonApps.Modification.ElementsCompletedOrReopened",d[i.TYPE_REOPENED]="E6WCommonApps.Modification.ElementsCompletedOrReopened",d[i.TYPE_MEMBER_REMOVED]="E6WCommonApps.Modification.MembersRemoved",d[i.TYPE_ELEMENT_REMOVED]="E6WCommonApps.Modification.ElementsRemoved",d[i.TYPE_PROJECT_CREATED]="E6WCommonApps.Modification.ProjectsAdded",d[i.TYPE_PROJECT_CHANGED]="E6WCommonApps.Modification.ProjectsChanged",d[i.TYPE_TASK_DUPLICATED]="E6WCommonApps.Modification.TaskDuplicatedOrSplit",d[i.TYPE_TASK_SPLIT]="E6WCommonApps.Modification.TaskDuplicatedOrSplit";var c=s.extend({_uwaClassName:"GroupedModificationCollection",init:function(t,n){var s=e.clone(n||{},!1);s.defaultModel=i,this._parent(t,s),this._groupId=n.groupId},fetch:function(t){var n=e.clone(t||{},!1);return n.data=JSON.stringify([this._groupId]),n.method="POST",this._parent(n)},update:function(){var e=this.remove;this.remove=Function.prototype,this._parent.apply(this,arguments),this.remove=e},url:function(){var e=t.expandUrl("/invoke/dsxplan:expandModification","v1");return n.addQueryParams(e,[{name:"$mask",value:"dsplan:Modification.Basic"}])}}),p=i.extend({_uwaClassName:"GroupedModificationModel",_relations:[{key:r,relatedCollection:c}],setup:function(){this._parent.apply(this,arguments),this._createCollection(r,void 0,{groupId:this.get("dsplan:groupId")}),this.listenTo(this.getProject(),"onDestroy",function(){this.destroy({noServer:!0})})},buildGroupedText:function(){var e=d[this.get(l)]||this.get(l),t=".UnknownAmount",n="";return this.get("dsplan:groupedModificationsCount")&&(t=1===(n=this.get("dsplan:groupedModificationsCount").getTotalRecords())?".Singular":".Plural"),0!==this.get(r).length&&(t=1===(n=this.get(r).length)?".Singular":".Plural"),e+=t,a.replace(a.get(e),{COUNT:n})+" "},buildText:function(){var e="";return this.hasDataForMask("dsplan:Modification.Basic")&&(e=this._parent()),e},get:function(e){switch(e){case"projectImage":return this.getProject().get(o.IMAGE_TILE_ATTR);case"groupedText":return this.buildGroupedText();case"project":return this.getProject().get("title");case"modified":return new Date(this.get("dspol:modificationDate")).strftime("%H:%M");default:return this._parent.apply(this,arguments)}},fetchRelatedModificationsIfNeeded:function(){var e=this.get(r);0===e.length&&e.fetch()}});return p.MODIFICATIONS=r,p.MODIFICATION_COUNT_COLLECTION="dsplan:groupedModificationsCount",p});