define("DS/ENOXMEIQualification/utils/PlatformServices",["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","UWA/Class/Debug","DS/WAFData/WAFData","DS/UIKIT/Mask","i18n!DS/ENOXMEIQualification/assets/nls/ENOXMEIQualification"],function(e,t,i,n,o){"use strict";return UWA.Class.singleton(t,{_platforms:[],csrfTokenMap:{},init:function(){this._platforms=[]},getServiceURL:function(e){return this._platforms[e]?this._platforms[e]:null},getPlatformId:function(){let e=this;if(e._platformId)return e._platformId;try{return widget&&(e._platformId=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"),e._platformId}catch(e){return"OnPremise"}},getPlatformServices:function(t){let i=this;return new Promise(function(n,o){let a={platformId:i.getPlatformId(),onComplete:function(e){t.logger.info("Platform Services successfully retrieved");let o=e.hasOwnProperty("length")?e[0]:e;i._platforms=o,"OnPremise"===i.getPlatformId()&&(i._platforms.sourcing=i._platforms["3DSpace"],o.sourcing=i._platforms["3DSpace"]),n(o)},onFailure:function(e){t.logger.error("Failed to get platform Services"),t.logger.error("Reason: "+e),i.displayAlert("error","appLoadMessage"),o(e)}};e.getPlatformServices(a)})},getCSRFToken:function(e,t){let n=this,o=t||"3DSpace";return new Promise(function(t,a){if(n.csrfTokenMap&&n.csrfTokenMap[o])return void t(n.csrfTokenMap[o]);let r={},l=e+"/resources/v1/application/CSRF?tenant="+n.getPlatformId();r.method="GET",r.proxy="passport",r.onComplete=function(e){n.app&&n.app.logger.info("CSRF Token retrieved successfully"),n.csrfTokenMap[o]=e.csrf.value,t(e.csrf.value)},r.onFailure=function(e){n.app&&n.app.logger.error("Error while getting CSRF token"),a(e)},r.type="json",i.authenticatedRequest(l,r)})},displayAlert:function(e,t){widget.notificationUtil.showMessage({level:e,subtitle:o[t]}),n.mask(widget.body,o.loading)}})}),define("DS/ENOXMEIQualification/utils/Constants",["UWA/Class/Debug"],function(e){"use strict";return UWA.Class.singleton(e,{ONPREMISE:"OnPremise",SESSSION_EXPIRED:401,UNAUTHORISED_REQUEST:403,SERVICE_3DSPACE:"3DSpace",SOURCE_SOURCING:"sourcing",VPMREFERENCE:"VPMReference",OR:" OR ",SOURCE_3DSPACE:"3dspace",RELEASED:"Released",OBSOLETE:"Obsolete",MEI_EXTENSION:"ManufacturerEquivalentItemExtension",MEI_PROXY:"SRC Manufacturer Equivalent Item Proxy Item",UTILITY_PREDICATE_SELECTORS:["ds6w:label","physicalid","name","ds6w:description","ds6w:identifier","ds6w:created","ds6w:modified","ds6w:responsible","ds6w:responsibleUid","ds6w:project","ds6w:dataSource","ds6w:community","ds6wg:revision","ds6w:what/ds6w:status","ds6w:status","partnumber","ds6w:type","organization","owner","ds6wg:EnterpriseExtension.V_PartNumber","bo.ManufacturerEquivalentItemExtension.ManufacturerName","ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber","ds6wg:ManufacturerEquivalentItemExtension.ManufacturerName","ds6wg:ManufacturerEquivalentItemExtension.ManufacturerTitle","bo.srcQualification.MEI","bo.srcQualification.ENGINEERING_ITEM","bo.srcQualification.PREREQ","bo.srcQualification.Preferred","bo.srcQualification.Approved","bo.srcQualification.Comments","bo.srcQualification.IsOrderable","bo.srcQualification.USAGE_CONTEXT_ID"],UTILITY_FILE_SELECTORS:["icon","thumbnail_2d"]})}),define("DS/ENOXMEIQualification/utils/NotificationsUtil",["DS/UIKIT/Mask","UWA/Class","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t,i,n){"use strict";var o=t.singleton({_notificationsMgr:{},_defaultLevel:"info",_msgLevels:{INFO:"info",WARNING:"warning",ERROR:"error",SUCCESS:"success"},init:function(){this._notificationsMgr=i,n.setNotificationManager(this._notificationsMgr)},showMessage:function(e){if(e&&e.subtitle)return this._notificationsMgr.addNotif({category:e.category,level:e.level?e.level:this._defaultLevel,subtitle:e.subtitle,sticky:!!e.isSticky&&e.isSticky,allowUnsafeHTML:!!e.allowUnsafeHTML&&e.allowUnsafeHTML})},showError:function(t){if(t&&""!==t)return widget.app&&widget.app.logger&&widget.app.logger.error(t),this.showMessage({level:this._msgLevels.ERROR,subtitle:t});e.unmask(widget.body)}});return o.init(),o}),define("DS/ENOXMEIQualification/utils/Services",["UWA/Class","DS/WAFData/WAFData","DS/WidgetServices/WidgetServices","DS/ENOXMEIQualification/utils/PlatformServices","DS/ENOXMEIQualification/utils/Constants","i18n!DS/ENOXMEIQualification/assets/nls/ENOXMEIQualification"],function(e,t,i,n,o,a){"use strict";return e.singleton({initialize:function(){},isSessionExpired:function(e){let t=e.status||e.statusCode,i=!1;return!t||t!==o.SESSSION_EXPIRED&&t!==o.UNAUTHORISED_REQUEST||(widget.notificationUtil.showError(a.session_expired),i=!0),i},getServiceURL:function(e){let t=n.getServiceURL(e.source?e.source:"3DSpace")+e.endpoint;return t.includes("?")?t+"&tenant="+n.getPlatformId():t+"?tenant="+n.getPlatformId()},getSecurityContext:function(e){let t="",i=e||o.SERVICE_3DSPACE;return t=n.getPlatformId()!==o.ONPREMISE&&i===o.SOURCE_SOURCING?"ctx::VPLMProjectLeader.Company Name.SOURCING":"ctx::"+widget.getValue("SC")},getDataPromise:function(e){let a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:o.SERVICE_3DSPACE),e.source).then(function(n){return new Promise(function(o,r){let l=a.getServiceURL(e),s={"Content-Type":"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()};t.authenticatedRequest(l,{method:"GET",type:"json",headers:s,onComplete:function(e){o(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||r(t||(e.message?e.message:e))}})})},function(){})},performPostPromise:function(e){let a=this;return n.getCSRFToken(n.getServiceURL(e.source?e.source:o.SERVICE_3DSPACE),e.source).then(function(n){return new Promise(function(r,l){let s=a.getServiceURL(e),c=e.postData;"object"==typeof e.postData&&(c=UWA.Json.encode(e.postData),e.postData.csrf={name:"ENO_CSRF_TOKEN",value:n},e.postData.SecurityContext3DSpace=a.getSecurityContext(o.SERVICE_3DSPACE)),t.authenticatedRequest(s,{method:"POST",type:"json",headers:{"Content-Type":e.contentType?e.contentType:"application/json",ENO_CSRF_TOKEN:n,SecurityContext:a.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},data:c,onComplete:function(e){r(e)},onFailure:function(e,t){t&&a.isSessionExpired(t)||l(t)}})})},function(){})},getFederatedSearchDataPromise:function(e){let r=this;return new Promise(function(l,s){if(!e.searchPayLoad.login){let t={};t[o.SOURCE_3DSPACE]={SecurityContext:r.getSecurityContext(o.SOURCE_3DSPACE)},e.searchPayLoad.login=t}t.authenticatedRequest(n.getServiceURL("3DSearch")+(e.recent?"/recent":"/search"),{method:"POST",type:"json",headers:{"Content-Type":"application/json",SecurityContext:r.getSecurityContext(e.source),"Accept-Language":i.getLanguage()},onComplete:function(e){l(e)},data:UWA.Json.encode(e.searchPayLoad),onFailure:function(e,t){t&&r.isSessionExpired(t)||(widget.notificationUtil.showError(a.error_search_index_get),s(e))},onTimeout:function(e){s(e)}})})}})}),define("DS/ENOXMEIQualification/models/ManufacturerEquivalentItem",["DS/ENOXMEIQualification/utils/Services"],function(e){"use strict";var t=function(){this.source="sourcing"};return t.prototype.init=function(){e.initialize()},t.prototype.getAllEquivalentItemsFromContextItemId=function(t){return t.endpoint="/resources/v1/modeler/dssourcing/qualifications/context/"+t.id+"/equivalentqualifications",t.includeParams&&(t.endpoint=t.endpoint+"?"+t.includeParams),t.source=this.source,e.getDataPromise(t)},t.prototype.getTypesHierarchy=function(t){let i={endpoint:"/resources/enong/dico/gettypeshierarchy"};return i.postData={types:[t]},e.performPostPromise(i)},t.prototype.getAllEquivalentItemsFromAllContextItems=function(t){let i={endpoint:"/resources/v1/modeler/dssourcing/qualifications/contextQualifications?type=equivalentQualification"};return i.postData=t,i.source=this.source,e.performPostPromise(i)},t}),define("DS/ENOXMEIQualification/utils/SearchUtility",["DS/ENOXMEIQualification/utils/Services","DS/ENOXMEIQualification/utils/PlatformServices","DS/ENOXMEIQualification/utils/Constants"],function(e,t,i){"use strict";var n=function(){};return n.prototype.getSearchPayload=function(e,n,o){let a="";return n.map(function(e){a+=' flattenedtaxonomies:"types/'+e+'"'+i.OR}),a=a.substring(0,a.length-3),o=o.map(e=>e.toLowerCase()),i.ONPREMISE===t.getPlatformId()&&(o=[i.SOURCE_3DSPACE]),{nresults:e.length>1e3?999:e.length,order_field:"ds6w:label",with_indexing_date:!0,with_synthesis:!0,order_by:"asc",start:0,label:"test",login:this.prepareSecurityContexts(o),locale:widget.lang,select_predicate:i.UTILITY_PREDICATE_SELECTORS,select_file:i.UTILITY_FILE_SELECTORS,query:a,source:o,tenant:t.getPlatformId(),resourceid_in:e,with_nls:!0,specific_source_parameter:{}}},n.prototype.callFederatedSearch=function(t){return new Promise(i=>{t.nresults>0?e.getFederatedSearchDataPromise({searchPayLoad:t}).then(function(e){i(e)}):i([])})},n.prototype.processFedSearchData=function(e){if(!e.results)return[];let t=[];return e.results.forEach(e=>{let i={};e.attributes.forEach(e=>{e.dispValue?(i[e.name]=e.dispValue,e.dispValue!==e.value&&(i[e.name+"_value"]=e.value)):i[e.name]=e.value}),t.push(i)}),t},n.prototype.prepareSecurityContexts=function(t){let n={};return t.map(function(){n[i.SOURCE_3DSPACE]={SecurityContext:e.getSecurityContext(i.SOURCE_3DSPACE)}}),n},n}),define("DS/ENOXMEIQualification/utils/OpenWithService",["UWA/Core","UWA/Class","DS/i3DXCompassPlatformServices/OpenWith","UWA/Class/Promise","DS/ENOXMEIQualification/utils/PlatformServices","DS/ENOXMEIQualification/utils/Constants","DS/ENOXMEIQualification/models/ManufacturerEquivalentItem"],function(e,t,i,n,o,a,r){"use strict";return t.singleton({init:function(e){this.option=e,this.meiModel=new r},initialize:function(e){this.app=e},getOpenWithMenu:function(t){let o=this;return o.meiModel.getTypesHierarchy(o.getObjectActualType(t)).then(function(a){let r=o.getContentForCompassInteraction(t,a),l=new i;l.set3DXContent(r);let s=[];if(e.is(l.retrieveCompatibleApps,"function"))return new n(function(e,t){l.retrieveCompatibleApps(function(t){t.forEach(function(e){s.push(o.getSubmenuOptions(e,null))}),e(s)},function(){t(new Error("Error while getting Open with menus"))})})}).catch(function(e){widget.notificationUtil.showError(e)})},getSubmenuOptions:function(e,t){return{id:e.text,title:e.text,icon:e.icon?e.icon:e.fonticon,type:"PushItem",multisel:!1,action:{context:t,callback:e.handler}}},getContentForCompassInteraction:function(e,t){let i=e,n=[],o={envId:widget.getValue("x3dPlatformId"),serviceId:this.getServiceId(i),contextId:"",objectId:this.getObjectId(i),objectType:this.getObjectActualType(i),displayName:this.getDisplayName(i),displayType:this.getObjectActualType(i),facetName:"realized",path:[{resourceid:this.getObjectId(i),type:this.getObjectActualType(i)}],objectTaxonomies:this.getObjectTaxonomies(i,t)};return n.push(o),{protocol:"3DXContent",version:"1.1",source:widget.data.appId,widgetId:widget.id,data:{items:n}}},getServiceId:function(){let e=a.SOURCE_3DSPACE;return a.ONPREMISE===o.getPlatformId()&&(e=a.SERVICE_3DSPACE),e},getObjectId:function(e){let t="";return t=e&&e.options.grid.id&&a.ONPREMISE===o.getPlatformId()?e.options.grid.id:e.options.grid.actualId?e.options.grid.actualId:e.options.grid.id},getObjectActualType:function(e){let t="";return e&&e.options.grid.id&&(t=e.options.grid.actualType?e.options.grid.actualType:e.options.grid.type),t},getDisplayName:function(e){let t="";return e&&e.options.grid.id&&(t=e.options.grid.title),t},getObjectTaxonomies:function(e,t){let i=[];return e.options.grid.actualType===a.VPMREFERENCE?e.options.grid.additionalDragData&&e.options.grid.additionalDragData.objectTaxonomies.includes(a.MEI_EXTENSION)?(i.push(a.VPMREFERENCE),i.push(a.MEI_EXTENSION)):i.push(a.VPMREFERENCE):e.options.grid.actualType===a.MEI_PROXY?(i.push(a.VPMREFERENCE),i.push(a.MEI_EXTENSION)):e.options.grid.actualType&&i.push(e.options.grid.actualType),i=[...i,...t.types_hierarchies[0].hierarchy]}})}),define("DS/ENOXMEIQualification/controllers/ManufacturerEquivalentItemController",["DS/ENOXMEIQualification/models/ManufacturerEquivalentItem","DS/ENOXMEIQualification/utils/SearchUtility","DS/ENOXMEIQualification/utils/Constants","DS/ENOXMEIQualification/utils/NotificationsUtil","DS/ENOXMEIQualification/utils/OpenWithService"],function(e,t,i,n,o){"use strict";var a=function(i){this.app=i.app?i.app:void 0,this.NLS=this.app?this.app.i18NProvider:void 0,this.model=new e,this.searchUtil=new t,widget&&(widget.notificationUtil=n)};return a.prototype.getMEIData=function(e){let t=this;return new Promise(i=>{t.model.getAllEquivalentItemsFromContextItemId({id:e,includeParams:"$include=target"}).then(async function(e){let n=await t.processMEIData(e.data);i(n)},function(){i([])}).catch(function(){i([])})})},a.prototype.processMEIData=async function(e){let t=this;e.forEach(e=>{e.relateddata.target.forEach(t=>{t.dataelements.eqApproved=e.dataelements["SRC Approved"],t.dataelements.eqState=e.dataelements.state,t.dataelements.eqStateDisplay=e.dataelements.stateDisplay,t.dataelements.eqEffectivityEndDate=e.dataelements["Effectivity End Date"],t.dataelements.eqEffectivityStartDate=e.dataelements["Effectivity Start Date"],t.dataelements.eqName=e.dataelements.name,t.dataelements.eqRevision=e.dataelements.revision})});let n=e.map(e=>e.relateddata.target),o=[],a=[];n.forEach(e=>{e.forEach(e=>{o.push(e)})});let r=e[0].relateddata.Context[0].dataelements.Title+"("+e[0].relateddata.Context[0].dataelements.Revision+")",l=t.searchUtil.getSearchPayload(o.map(e=>e.dataelements.Proxy_Id),[i.VPMREFERENCE],[]),s=await t.searchUtil.callFederatedSearch(l);return t.searchUtil.processFedSearchData(s).forEach(n=>{let l=o.filter(e=>e.dataelements.Proxy_Id===n.physicalid)[0],s=t.checkMeiValidity(l.dataelements,n["ds6w:what/ds6w:status"]);a.push({grid:{id:n.physicalid,actualType:i.MEI_PROXY,status:s.icon,statusTip:s.tooltip,title:n["ds6w:label"],partNumber:n["ds6wg:ManufacturerEquivalentItemExtension.ManufacturerPartNumber"],prdName:n.name,revision:n["ds6wg:revision"],manufacturer:n["ds6w:who/ds6w:responsible/ds6w:manufacturer"],description:n["ds6w:description"]?n["ds6w:description"]:l.dataelements.Description,maturity:n["ds6w:what/ds6w:status"],eqName:l.dataelements.eqName,eqRevision:l.dataelements.eqRevision,eqApproved:t.NLS[l.dataelements.eqApproved],eqState:l.dataelements.eqStateDisplay,eqEffectivityStartDate:l.dataelements.eqEffectivityStartDate,eqEffectivityEndDate:l.dataelements.eqEffectivityEndDate,gqName:l.dataelements.genQualificationName,gqRevision:l.dataelements.genQualificationRevision,gqApproved:t.NLS[l.dataelements.genQualificationApproved],gqState:l.dataelements.stateDisplay,gqLastTimeBuy:l.dataelements.genQualificationLastTimeBuy,gqEffectivityStartDate:l.dataelements.genQualificationEffectivityStartDate,gqEffectivityEndDate:l.dataelements.genQualificationEffectivityEndDate},contextName:r,label:n["ds6w:label"],thumbnail:require.toUrl("ENOXMEIQualification/assets/icons/MEI-Thumbnail.png"),thumbnail_qual:require.toUrl("ENOXMEIQualification/assets/icons/Qualification16.png"),id:n.physicalid,statusbarIcons:s.icon,statusbarIconsTooltips:s.tooltip,subLabel:t.getSubLabel(n),description:t.getDescription(n),contextualMenu:t.onContextualEventCallback,isQualificationReleased:e.state&&e.state===i.RELEASED&&e.eqState===i.RELEASED||!e.state&&e.eqState===i.RELEASED})}),a},a.prototype.checkMeiValidity=function(e,t){let n=this;return t===i.RELEASED&&e.state===i.RELEASED&&e.eqState===i.RELEASED?"Yes"===e.genQualificationApproved&&"Yes"===e.eqApproved&&""===e.genQualificationLastTimeBuy&&(""===e.eqEffectivityEndDate||new Date(e.eqEffectivityEndDate)>new Date)&&(""===e.genQualificationEffectivityEndDate||new Date(e.genQualificationEffectivityEndDate)>new Date)?{icon:["check"],tooltip:[n.NLS.valid]}:"Yes"===e.genQualificationApproved&&"Yes"===e.eqApproved&&""!==e.genQualificationLastTimeBuy&&(""===e.eqEffectivityEndDate||new Date(e.eqEffectivityEndDate)>new Date)&&(""===e.genQualificationEffectivityEndDate||new Date(e.genQualificationEffectivityEndDate)>new Date)?{icon:["clock"],tooltip:[n.NLS.pending_obsolete]}:{icon:["wrong"],tooltip:[n.NLS.invalid]}:e.state&&e.state!==i.OBSOLETE&&e.eqState!==i.OBSOLETE?{icon:["expand-up"],tooltip:[n.NLS.in_progress]}:{icon:["wrong"],tooltip:[n.NLS.invalid]}},a.prototype.getDescription=function(e){let t={state:e["ds6w:what/ds6w:status"],revision:e["ds6wg:revision"],owner:e["ds6w:who/ds6w:responsible"]};return Object.values(t).filter(e=>e).join(" | ")},a.prototype.getSubLabel=function(e){let t=UWA.createElement("div");return function(e){let t=UWA.createElement("div",{name:"CompanyLabel"});return UWA.createElement("span",{class:"xsourcing-company-icon fonticon fonticon-fonticon fonticon-factory"}).inject(t),UWA.createElement("span",{class:"xsourcing-company-name"}).inject(t).innerHTML=e?e["ds6w:who/ds6w:responsible/ds6w:manufacturer"]:void 0,t}(e).inject(t),t},a.prototype.onContextualEventCallback=function(e){let t=[];if((e.cellInfos?e.cellInfos.rowID:null)<0)return this._contextualMenuBuilder?this._contextualMenuBuilder.buildMenu(e):[];if(e){let i=e.cellInfos.nodeModel?e.cellInfos.nodeModel:e.cellInfos.cellModel;if(i)return o.getOpenWithMenu(i).then(function(e){return t.push({id:"OpenWith",type:"PushItem",title:"Open with",icon:"open-menu-dot",submenu:e}),t})}return t},a.prototype.getContextData=function(e){let t=this,i={data:[]};return e.forEach(e=>{i.data.push({id:e})}),new Promise(n=>{t.model.getAllEquivalentItemsFromAllContextItems(i).then(async function(i){let o=await t.processEQData(i.data),a=t.getColumnData(o,e);n(a)},function(){n([])}).catch(function(){n([])})})},a.prototype.processEQData=async function(e){let t=this,n=[],o=t.searchUtil.getSearchPayload(e.map(e=>e.target[0].physicalid),[i.VPMREFERENCE],[]),a=await t.searchUtil.callFederatedSearch(o);return t.searchUtil.processFedSearchData(a).forEach(t=>{let i=e.filter(e=>e.target[0].physicalid===t.physicalid)[0];n[i.target[0].physicalid]=t["ds6w:what/ds6w:status"]}),e.map(e=>({contextId:e.Context[0].physicalid,eqState:e.state,gqState:e.target[0].generalQualification[0]?e.target[0].generalQualification[0].state:"",meiOK:!!e.target[0].generalQualification[0]&&(t.isMEIOK(n,e)&&""===e.target[0].generalQualification[0]["Last Time Buy"]),pendingObsolete:!!e.target[0].generalQualification[0]&&(t.isMEIOK(n,e)&&""!==e.target[0].generalQualification[0]["Last Time Buy"]),meiDeleted:n[e.target[0].physicalid]}))},a.prototype.isMEIOK=function(e,t){let n=t.target[0].generalQualification[0];return e[t.target[0].physicalid]===i.RELEASED&&t.state===i.RELEASED&&n.state===i.RELEASED&&"Yes"===t["SRC Approved"]&&"Yes"===n["SRC Approved"]&&(""===t["Effectivity End Date"]||new Date(t["Effectivity End Date"])>new Date)&&(""===n["Effectivity End Date"]||new Date(n["Effectivity End Date"])>new Date)},a.prototype.getColumnData=function(e,t){let n=this,o=[];return t.forEach(t=>{let a="",r=e.filter(e=>e.contextId===t&&!!e.meiDeleted),l=r.filter(e=>e.meiOK),s=r.filter(e=>e.pendingObsolete),c=r.filter(e=>e.eqState!==i.RELEASED&&e.eqState!==i.OBSOLETE||e.gqState!==i.RELEASED&&e.gqState!==i.OBSOLETE),u=r.filter(e=>""===e.gqState);switch(!0){case l.length>0&&0===c.length&&0===s.length:a={icon:["check"],tooltip:n.NLS.valid};break;case l.length>0&&1===s.length:a={icon:["check","clock"],tooltip:n.NLS.pending_obsolete};break;case l.length>0&&c.length>0:a={icon:["record"],tooltip:n.NLS.under_qualification};break;case 1===s.length:a={icon:["clock"],tooltip:n.NLS.last_pending_obsolete};break;case 0===l.length&&c.length>0&&0===u.length:a={icon:["expand-up"],tooltip:n.NLS.first_qualification};break;default:a={icon:["wrong"],tooltip:n.NLS.invalid}}o[t]=a}),o},a}),define("DS/ENOXMEIQualification/views/MEIColumnDataProvider",["UWA/Core","DS/ENOXMEIQualification/controllers/ManufacturerEquivalentItemController","DS/ENOXMEIQualification/utils/PlatformServices","DS/ENOXLogger/Logger","DS/Utilities/Dom","i18n!DS/ENOXMEIQualification/assets/nls/ENOXMEIQualification"],(e,t,i,n,o,a)=>{"use strict";let r;return r||(r=new class{constructor(){this.name="MEIColumns",this.i18NProvider=Object.freeze(a),this.columns={MEIColumn:{text:this.i18NProvider.mei,dataIndex:"MEIColumn",ds6w:a.mei,allowUnsafeHTMLContent:!0,getContentCallback:this.getContentCallback,maxWidth:800,minWidth:20,width:200}};let e={i18NProvider:this.i18NProvider};e.logger=n,i.getPlatformServices(e).then(async function(t){e.platformServices=t}),this.controller=new t({app:e})}isAdditionalColumnsAvailable(t){if(!1===e.is(t,"function"))throw new Error("A callback function should be defined");t(!0)}getName(){return this.name}getManagedColumnNames(){return Object.keys(this.columns)}toBeUpdated(t){return!!e.is(t)&&!e.is(t.MEIColumn)}getAdditionalColumnsUX(e){this.getManagedColumnNames().forEach(t=>{const i=e.findIndex(e=>e.dataIndex===t);e.splice(i,i>=0?1:0,this.columns[t])})}updateAttributes(e,t){const{pids:i}=e;this.getDetails(i).then(e=>{const i=e,n=this.buildAnswer({refPids:i});t(n)})}buildAnswer(e){const{refPids:t}=e,i={pids:{}};return Object.keys(t).forEach(e=>{i.pids[e]||(i.pids[e]={}),i.pids[e].MEIColumn=t[e]}),i}getDetails(e){let t=this;return new Promise(async i=>{i(await t.controller.getContextData(e))})}getContentCallback(t){return e.extend(t,{getCellValue:function(t){var i=e.createElement("div",{class:"icons"});let n=t.nodeModel.getAttributeValue("MEIColumn");if(n instanceof Object)return o.generateIcon({iconName:n.icon[0]}).inject(i),n.icon.length>1&&o.generateIcon({iconName:n.icon[1]}).inject(i),i.outerHTML},getCellTooltip:function(e){if(e&&(e.nodeModel||e.cellModel))return{shortHelp:e.rowID<0?e.cellModel:e.nodeModel.getAttributeValue("MEIColumn")?e.nodeModel.getAttributeValue("MEIColumn").tooltip:""}},getCellValueForExport:function(e){if(e&&(e.nodeModel||e.cellModel))return e.rowID<0?e.cellModel:e.nodeModel.getAttributeValue("MEIColumn")?e.nodeModel.getAttributeValue("MEIColumn").tooltip:""}})}}),Reflect.preventExtensions(r),r}),define("DS/ENOXMEIQualification/views/MEIView",["UWA/Core","UWA/Class/View","DS/UIKIT/Mask","DS/Utilities/Dom","DS/ENOXLogger/Logger","DS/DataGridView/DataGridView","DS/CollectionView/ResponsiveTilesCollectionView","DS/ENOXCollectionToolBar/js/ENOXCollectionToolBarV2","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/CoreEvents/ModelEvents","DS/ENOXMEIQualification/utils/PlatformServices","DS/ENOXMEIQualification/controllers/ManufacturerEquivalentItemController","i18n!DS/ENOXMEIQualification/assets/nls/ENOXMEIQualification","css!DS/ENOXMEIQualification/ENOXMEIQualification.css"],function(e,t,i,n,o,a,r,l,s,c,u,d,p,f){"use strict";return t.extend({name:"mei-view",tagName:"div",domEvents:{},setup:function(e){let t=this;this.container.addClassName(this.getClassNames("-container")),this.i18NProvider=Object.freeze(f);let i={i18NProvider:this.i18NProvider};i.logger=o,d.getPlatformServices(i).then(async function(n){i.platformServices=n,!t.multiple&&t.loadData(e)}),this.controller=new p({app:i})},update:function(){let e=this.outerDiv.parentElement.parentElement?this.outerDiv.parentElement.parentElement.getBoundingClientRect():this.outerDiv.parentElement.getBoundingClientRect();this.outerDiv.style.height=e.height+"px"},exportDataToCSV:function(e,t){let i=this._dataGridView.getAsCSV(e),n=t;let o=new Blob(["\ufeff"+i],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),r=URL.createObjectURL(o);a.setAttribute("href",r),a.setAttribute("download",n),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},render:function(t){let i=this;this.container.empty(),this._modelEvents=new u,this.multiple=t;let o=e.createElement("div",{class:"toolbar-container"}).inject(i.container),a={modelEvents:i._modelEvents,showItemCount:!0,filter:{},sort:[{id:"title",text:f.title,disabled:!0,type:"string"}],views:[{id:"Tile",text:f.tile,fonticon:"view-small-tile"},{id:"Table",text:f.table,fonticon:"view-list"}],currentView:["Tile"],actions:[{id:"exportToCSV",text:f.export_csv,disabled:!0,fonticon:"export-to-csv",handler:function(){let e=i.fileName;i.exportDataToCSV({forceQuotes:!0,allColumns:!0,addLevelInformation:!0},e)}}]};this.collectionToolbar=new l(a),this.collectionToolbar.inject(o),this.outerDiv=e.createElement("div",{class:"outerDiv",styles:{height:"100%"}}).inject(this.container);let r=e.createElement("div",{class:"emptyContainerStyle",html:t?f.select_only_one_item:f.data_unavailable_message});i.outerDiv.appendChild(r),i._modelEvents.subscribe({event:"enox-collection-toolbar-sort-activated"},function(e){var t={sortAttribute:e.sortAttribute,sortOrder:e.sortOrder},n="asc"===t.sortOrder.toLowerCase()?1:-1;i._tilecollectionView&&i._tilecollectionView.TreedocModel._trueRoot.sortChildren({isRecursive:!0,sortFunction:function(e,i){try{return n*e._options.grid[t.sortAttribute].localeCompare(i._options.grid[t.sortAttribute])}catch(e){}}})});let s="Tile";return i._modelEvents.subscribe({event:"enox-collection-toolbar-switch-view-activated"},function(e){s=e,i.gridModel&&(i.outerDiv.innerHTML="",i.gridModel.prepareUpdate(),i.gridModel.ungroupRoots(),i.gridModel.pushUpdate(),"Table"===e?i._dataGridView.getContent().inject(i.outerDiv):"Tile"===e&&i._tilecollectionView.getContent().inject(i.outerDiv))}),i._modelEvents.subscribe({event:"enox-collection-toolbar-filter-search-value"},function(e){i.handlefilterData(e.searchValue[0])}),i._modelEvents.subscribe({event:"enox-collection-toolbar-click-filter-search"},function(e){"Tile"===s?e.elements.container.hasClassName("enox-collection-toolbar-filter-activated")?document.querySelector(".outerDiv .wux-layouts-responsivecollectionview")&&document.querySelector(".outerDiv .wux-layouts-responsivecollectionview").style.setProperty("top","45px","important"):document.querySelector(".outerDiv .wux-layouts-responsivecollectionview")&&document.querySelector(".outerDiv .wux-layouts-responsivecollectionview").style.setProperty("top","90px","important"):"Table"===s&&(e.elements.container.hasClassName("enox-collection-toolbar-filter-activated")?document.querySelector(".outerDiv .wux-layouts-datagridview")&&document.querySelector(".outerDiv .wux-layouts-datagridview").style.setProperty("top","45px","important"):document.querySelector(".outerDiv .wux-layouts-datagridview")&&document.querySelector(".outerDiv .wux-layouts-datagridview").style.setProperty("top","90px","important"))}),n.addResizeListener(this.outerDiv,function(){i.update()},0),this.container},getLabelForCell:function(e){var t="";let i=this.layout.getLeafColumns()[e.columnID];if(i)if("functionIcon"===i.typeRepresentation)t=e.nodeModel._options.grid.statusTip[0];else{let n=i.dataIndex;t=(t=e.nodeModel.getAttributeValue(n))?t.label?t.label:t:""}return t},loadData:async function(e){let t=this,n=[{text:f.status,dataIndex:"tree",alignment:"center",typeRepresentation:"functionIcon",width:150,getCellValue:function(e){return e.nodeModel?e.nodeModel._options.grid.statusTip:""},getCellSemantics:function(e){if(e.nodeModel)return{icon:{iconName:e.nodeModel._options.grid.status,fontIconFamily:1}}},getCellTooltip:function(e){return{shortHelp:e.nodeModel?e.nodeModel._options.grid.statusTip:"",updateModel:!1}},getCellValueForExport:function(e){if(e.nodeModel&&e.nodeModel._options){if(e.nodeModel._options.identifier)return e.nodeModel._options.label;if(e.nodeModel._options.grid)return e.nodeModel._options.grid.statusTip[0]}return e.cellModel}},{text:f.mei,dataIndex:"MEI",children:[{text:f.title,dataIndex:"title",typeRepresentation:"url",width:150,getCellValue:function(e){let t;if(e.nodeModel&&e.nodeModel._options.grid.title)return t={icon:{iconPath:e.nodeModel._options.thumbnail},label:e.nodeModel._options.grid.title}},getCellValueForExport:function(e){return e.nodeModel?e.nodeModel._options.grid.title:e.cellModel}},{text:f.manufacturer_part_number,dataIndex:"partNumber",width:150},{text:f.name,dataIndex:"prdName",width:200},{text:f.revision,dataIndex:"revision",width:100},{text:f.manufacturer,dataIndex:"manufacturer",width:125},{text:f.description,dataIndex:"description",width:150},{text:f.maturity_state,dataIndex:"maturity",width:125}]},{text:f.equivalent_qualification,dataIndex:"equivalentQualificationDetails",children:[{text:f.name,dataIndex:"eqName",typeRepresentation:"url",width:150,getCellValue:function(e){let t;if(e.nodeModel&&e.nodeModel._options.grid.eqName)return t={icon:{iconPath:e.nodeModel._options.thumbnail_qual},label:e.nodeModel._options.grid.eqName}},getCellValueForExport:function(e){return e.nodeModel?e.nodeModel._options.grid.eqName:e.cellModel}},{text:f.revision,dataIndex:"eqRevision",width:125},{text:f.qualification_status,dataIndex:"eqApproved",width:150},{text:f.maturity_state,dataIndex:"eqState",width:150},{text:f.effective_date_from,dataIndex:"eqEffectivityStartDate",width:150},{text:f.effective_date_to,dataIndex:"eqEffectivityEndDate",width:150}]},{text:f.general_qualification,dataIndex:"genQualificationDetails",children:[{text:f.name,dataIndex:"gqName",width:150,typeRepresentation:"url",getCellValue:function(e){let t;if(e.nodeModel&&e.nodeModel._options.grid.gqName)return t={icon:{iconPath:e.nodeModel._options.thumbnail_qual},label:e.nodeModel._options.grid.gqName}},getCellValueForExport:function(e){return e.nodeModel?e.nodeModel._options.grid.gqName:e.cellModel}},{text:f.revision,dataIndex:"gqRevision",width:125},{text:f.qualification_status,dataIndex:"gqApproved",width:150},{text:f.maturity_state,dataIndex:"gqState",width:150},{text:f.last_time_buy,dataIndex:"gqLastTimeBuy",width:150},{text:f.effective_date_from,dataIndex:"gqEffectivityStartDate",width:150},{text:f.effective_date_to,dataIndex:"gqEffectivityEndDate",width:150}]}];t.container&&t.container.parentElement&&i.mask(t.container.parentElement,f.loading_mei);let o=await t.controller.getMEIData(e);if(o.length>0){this.fileName=o[0].contextName,t.outerDiv.innerHTML="",this.collectionToolbar._modelEvents.publish({event:"enox-collection-toolbar-enable-action",data:"exportToCSV"}),this.gridModel=new s,this._tilecollectionView=new r;let e={identifier:"MEI_QUAL_XEN",layoutOptions:{layoutDensity:"compact"},rowSelection:"none",defaultColumnDef:{getCellGroupingKey:t.getLabelForCell},rowGroupingOptions:{hideGroupedColumns:!1},columns:n};this._dataGridView=new a(e),this._dataGridView.treeDocument=this.gridModel,this._tilecollectionView.model=t.gridModel,this._tilecollectionView.onContextualEvent={callback:t.controller.onContextualEventCallback},t._dataGridView.onContextualEvent=t.controller.onContextualEventCallback,this._tilecollectionView.model=t.gridModel,this._tilecollectionView.inject(t.outerDiv),this.gridModel.prepareUpdate();for(const e of o)this.gridModel.addRoot(new c(e));this.gridModel.pushUpdate(),this._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:o.length}),this._tilecollectionView.supportsSelection=function(){return!1},t.gridModel.prepareUpdate(),t.gridModel.ungroupRoots(),t.gridModel.pushUpdate()}t.update(),t.container&&t.container.parentElement&&i.unmask(t.container.parentElement)},handlefilterData:function(e){let t=this,i=t.gridModel.getRoots();t.gridModel.prepareUpdate(),i.forEach(i=>{t.hideShowRow(e,i)});let n=t.gridModel.getNumberOfVisibleDescendants();t._modelEvents.publish({event:"enox-collection-toolbar-items-count-update",data:n}),t.gridModel.pushUpdate()},hideShowRow:function(e,t){if(e){var i=new RegExp(e,"i"),n=!1;(n=n||i.test(t.options.grid.title))?t.show():t.hide(!0)}else t.show()},onDestroy:function(){return this._parent.apply(this,arguments)}})}),define("DS/ENOXMEIQualification/views/MEIFacet",["UWA/Core","DS/UIKIT/Mask","DS/EditPropWidget/facets/Common/FacetsBase","DS/ENOXMEIQualification/views/MEIView"],(e,t,i,n)=>{"use strict";return class extends i{constructor(e){super(e),this.initView()}updateFacet(){this.contentDiv.empty(),t.mask(this.contentDiv);const e=this.retrieveSelection();new n(e[0].referenceId).render([...new Set(e.map(e=>e.referenceId))].length>1).inject(this.contentDiv),t.unmask(this.contentDiv)}initView(){this.elements.container||(this.elements.container=e.createElement("div",{id:"templateFacet-mainContainer"}),this.contentDiv=e.createElement("div",{id:"templateFacet-content"}),this.elements.container.appendChild(this.contentDiv))}retrieveSelection(){const e=this.getModel();return e?(e.getMergingModels?Object.values(e.getMergingModels()):[e]).map(e=>{const t=e.get("metatype"),i="relationship"===t?e.get("selReferenceID"):e.get("objectId"),n="relationship"===t?e.get("objectId"):void 0;return"relationship"===t?{metatype:t,referenceId:i,instanceId:n}:{metatype:t,referenceId:i}}):[]}destroyComponent(){}onResize(){}onRefresh(){}onAction(){}}});