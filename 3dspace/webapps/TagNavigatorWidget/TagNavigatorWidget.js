define("DS/TagNavigatorWidget/ParentModule",[],function(){"use strict";return{getParentModule:function(){var e={};return function(t,i){if(e[t])e[t]&&i(e[t]);else if(console.log("TagNavigatorProxyPrivate#getParentModule - trying to load the module"),function(){var e;try{top.document,e=!0}catch(t){e=!1}return e}())try{console.log("isParentAccessible: true, require from top window"),top.require([t],function(a){console.log("require from top window SUCCEEDED"),e[t]=a,i(a)})}catch(a){try{console.log("require from top window FAILED - retry on parent of current window.");let a=require;window.parent!=top?(a=window.parent.require,console.log("using require from parent of current window")):console.log("using require from current window"),a([t],function(a){console.log("require SUCCEEDED"),e[t]=a,i(a)})}catch(e){console.log("require from parent of current window FAILED !!, no further attempt"),i(null)}}}}()}}),define("DS/TagNavigatorWidget/WidgetUtils",["UWA/Core","UWA/Class","UWA/Promise","DS/WAFData/WAFData"],function(e,t,i,a){"use strict";return t.singleton({_service_url_promises:{},getServiceURL:function(e){if(UWA.is(e,"object")&&e.serviceId&&e.platformId){let t=e.serviceId+"__"+e.platformId,a=this._service_url_promises[t];return a||(this._service_url_promises[t]=a=new i(function(t){require(["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],function(i){i.getServiceUrl({serviceName:e.serviceId,platformId:e.platformId,onComplete:function(e){t(e)},onFailure:function(){t()}})})})),a}}})}),define("DS/TagNavigatorWidget/TaggerWidget",["UWA/Core","UWA/Class","UWA/Class/Debug","DS/UIKIT/Mask","DS/TagNavigatorWidget/ParentModule","DS/TagNavigator/Predicate","DS/TagNavigator/TagWidget/PredicateView","DS/MessageBus/MessageBus","DS/TagNavigator/TaggerNLS","DS/TagNavigator/TaggerTrackerApi","css!DS/UWA2/assets/css/inline.css","css!DS/UIKIT/UIKIT.css","css!DS/TagNavigatorWidget/TagNavigatorWidget.css"],function(e,t,i,a,n,r,s,o,d,c){"use strict";return t.extend(i,{init:function(e){let t=this;if(this._parent(e),this.widget=e.widget,a.mask(this.widget.body),c.set(),!this.widget.getValue("widgetDropped")){this.updateWidgetPreferences({predicateLineage:this.widget.data.predicateLineage,predicateId:this.widget.data.predicateId,predicateType:this.widget.data.type,contextId:this.widget.data.contextId,sort:this.widget.data.sort,currentViewMode:this.widget.data.currentViewMode,widgetDropped:!0});let e={pd1:this.widget.data.predicateId,pd2:this.widget.data.currentViewMode};try{o.publish({channel:"TaggerTrackerApi",topic:"hit",data:{category:"6WTagsWidget",action:"onTagWidgetDrop",persDim:e}})}catch(e){console.log("Message bus publish did not work!!")}}this.predicateLineage=this.widget.getValue("predicateLineage"),this.predicateId=this.widget.getValue("predicateId"),this.predicateType=this.widget.getValue("predicateType"),n.getParentModule("DS/TagNavigator/TagNavigator",function(e){t._navImpl=e.view.observedNavImpl,t._navImpl.registerTagWidget(t.widget.id),t.tenantId||(t.tenantId=t._navImpl.getCurrentTenantId()),t.createPredicateView(),t.updateWidgetPreferences({contextId:t._navImpl.id()})}),n.getParentModule("DS/MessageBus/MessageBus",function(e){e.subscribe({channel:"TagWidgetInterface",topic:"redraw",callback:t.onRedrawView.bind(t)}),e.subscribe({channel:"TagWidgetInterface",topic:"laoding",callback:t.addLoader.bind(t)}),e.subscribe({channel:"TagWidgetInterface",topic:"InfoMessageEvent",callback:t.sendInfoMessageEvent.bind(t)})}),this.widget.body.empty()},onLoad:function(){a.mask(this.widget.body);let e,t=this;this.predicateModel=new r({sixw:this.predicateLineage,type:this.widget.data.type}),e=this.predicateModel.is6WRoot()?d.getText("user-tags"):this.predicateModel.displayName();let i=d.getText(this.predicateModel.get6WRootFather().id().replace("ds6w:",""));if(e==this.predicateId){let e=function(e){if(e.vocabularyElementNLSInfo){let a=e.vocabularyElementNLSInfo;a.length&&a.forEach(e=>{e.uri&&e.nlsName&&(t.widget.setTitle(i+" - "+e.nlsName),t.predicateModel.setDisplayName(e.nlsName))})}};this.getElementNLS(e).then(function(){console.log("Elemnet retrieved")},function(){console.log("Elemnet could not be retrieved")})}else this.widget.setTitle(i+" - "+e);this._navImpl&&this.createPredicateView()},onRefresh:function(){this.onRedrawView()},onSearch:function(e){this.predicateView.onSearchEvent(e)},onResetSearch:function(){this.predicateView.onSearchEvent()},updateWidgetPreferences:function(t){if(e.is(t,"object"))for(var i in t)if("tagExpansion"==i){this.widget.getValue(i)||this.widget.setValue(i,{});let e=this.widget.getValue(i),a=t[i];for(let t in a)e[t]=a[t];this.widget.getValue(i,e)}else this.widget.setValue(i,t[i])},onRedrawView:function(e){let t=e&&e.event;if(this._navImpl){let e=this._navImpl.getTagInfo(this.predicateId);if(a.unmask(this.widget.body),this.predicateView){let i=this.widget.getValue("tagExpansion");this.predicateView.updateTagExpansion(i),this.predicateView.redrawPredicateView(e,t)}}},createPredicateView:function(){if(this.predicateModel&&this._navImpl){let e=this.widget.getValue("currentViewMode"),t=this.widget.getValue("sort"),i=this.widget.getValue("tagExpansion");this.predicateView=new s({navImpl:this._navImpl,predicate:this.predicateModel,viewMode:e,sort:t,tagsExpand:i,withScroll:!0,withNoTags:!0}).render().inject(this.widget.body),this.predicateView.addEvent("preferenceChange",this.updateWidgetPreferences.bind(this)),this.onRedrawView()}},addLoader:function(){a.mask(this.widget.body)},onRemove:function(){this._navImpl.deregisterTagWidget(this.widget.id)},getElementNLS:function(e){let t=this,i=this.predicateId;return new Promise(function(a){require([["DS","FedDictionaryAccess","FedDictionaryAccessAPI"].join("/")],function(n){var r;(r={tenantId:t.tenantId,lang:t.widget.lang}).onComplete=function(t){t&&(e(t),a())},r.onFailure=function(){a()},n.getResourcesInfo(i,r)})})},destroy:function(){this._navImpl.deregisterTagWidget(this.widget.id)},sendInfoMessageEvent:function(e){let t;UWA.is(e,"object")&&Object.keys(e).length&&(t=e),this.predicateView.showNewMessageOnView(t)}})});