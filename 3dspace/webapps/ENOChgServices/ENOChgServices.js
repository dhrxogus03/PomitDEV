define("DS/ENOChgServices/scripts/services/ChgLocalStorage",[],function(){"use strict";return{_appKey:void 0,_prefStructure:void 0,_contextUser:void 0,initialize:function(e){var t;(this._appKey=e.appKey,this._prefStructure=e.prefStructure,this._contextUser=e.contextUser,window.localStorage.getItem(this._appKey))?(t=JSON.parse(window.localStorage.getItem(this._appKey))).hasOwnProperty(this._contextUser)||(t[this._contextUser]=this._prefStructure,window.localStorage.setItem(this._appKey,JSON.stringify(t))):((t={})[this._contextUser]=this._prefStructure,window.localStorage.setItem(this._appKey,JSON.stringify(t)))},destroy:function(){window.localStorage.removeItem(this._appKey)},getLocalStorageValue:function(e){try{if(window.localStorage.getItem(this._appKey)){var t=JSON.parse(window.localStorage.getItem(this._appKey));return t.hasOwnProperty(this._contextUser)?t[this._contextUser][this._appKey][e]:void 0}return}catch(e){return void console.error(e)}},updateLocalStorageValue:function(e,t){try{if(window.localStorage.getItem(this._appKey)){var n=JSON.parse(window.localStorage.getItem(this._appKey));n.hasOwnProperty(this._contextUser)&&(n[this._contextUser][this._appKey][e]=t,window.localStorage.setItem(this._appKey,JSON.stringify(n)))}}catch(e){console.error(e)}}}}),define("DS/ENOChgServices/scripts/services/ChgWidgetPreferencesManager",[],function(){"use strict";return{_appKey:void 0,_prefStructure:void 0,initialize:function(e){this._appKey=e.appKey,this._prefStructure=e.prefStructure,widget.getValue(this._appKey)||widget.setValue(this._appKey,JSON.stringify(this._prefStructure))},updateWidgetPreference:function(e,t){try{var n=widget.getValue(this._appKey);if(n){var a=JSON.parse(n);a[this._appKey][e]=t,widget.setValue(this._appKey,JSON.stringify(a))}}catch(e){console.error(e)}},getWidgetPreference:function(e){try{var t=widget.getValue(this._appKey);return t?JSON.parse(t)[this._appKey][e]:void 0}catch(e){return void console.error(e)}}}}),define("DS/ENOChgServices/scripts/factories/ChangeRequestFactory",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events"],function(e,t,n,a){"use strict";return t.extend(n,a,{init:function(e){console.log(e),alert("In Change Request")},loadWidget:function(){console.log("load Change Request Widget")}})}),define("DS/ENOChgServices/scripts/services/UserPreferenceUtil",["UWA/Class"],function(e){"use strict";var t=e.singleton({initialize:function(e){this.prefix=e.prefix,this.storage=e.storage,this.storageProperty=this.prefix+"UserPreference"},fetchUserPreference:async function(e){return new Promise(function(n,a){let i="/resources/v1/chguxservices/connectedChange/getUserPreference?prefix="+t.prefix;var r=function(a){let i=e;for(const t in e)if(a.data[0])if((i=a.data[0]).hasOwnProperty(t)){let n=i[t];null!=n&&""!==n||(i[t]=e[t])}else i[t]=e[t];t.storage[t.storageProperty]=i,n(i)},o=function(a){console.log("Error in fetching user preference"+a),t.storage[t.storageProperty]=e,n(e)};require(["DS/ENOChgServices/scripts/services/ChgInfraService"],function(e){e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",r,o,!1)})})},getUserPreferences:function(){return t.storage[t.storageProperty]},getUserPreference:function(e){return t.storage[t.storageProperty][e]},saveUserPreference:function(e){return Object.keys(e).forEach(function(n){let a=e[n];console.log(`Key: ${n}, Value: ${a}`),t.storage[t.storageProperty][n]=a}),console.log("inputJson----\x3e"+e),new Promise(function(n,a){let i="/resources/v1/chguxservices/connectedChange/saveUserPreference?prefix="+t.prefix,r=[];r.push(e);let o={data:r};o=JSON.stringify(o);var s=function(e){n(e)};require(["DS/ENOChgServices/scripts/services/ChgInfraService"],function(e){e.makeWSCallWithCSRF(i,"POST","enovia","application/json",o,s,a,!1)})})}});return t}),define("DS/ENOChgServices/scripts/components/ChgCommonSelectDailog",["UWA/Class/View","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button"],function(e,t,n,a){"use strict";return{launchInfoDailog:function(e){var i=this;console.log("Inside launchInfoDailog >>>>>>>>>>>>>> "+e);var r=e.title,o=e.content,s=e.target;this.buttons=[],e.buttonArray.forEach(function(e){var t=new a({label:e.label,className:e.className,onClick:function(t){e.handler()}});i.buttons.push(t)}),this.immersiveFrame=new t({}),this.myDialog=new n({id:"myinfoDialogId",class:"myinfoclass",immersiveFrame:this.immersiveFrame,title:r,content:o,resizableFlag:!1,modalFlag:!0,height:100,width:400,buttons:{Yes:this.buttons[0],No:this.buttons[1]}}),this.myDialog.addEventListener("close",function(){i.closeDialog()}),this.immersiveFrame.inject(s)},closeDialog:function(){this.myDialog.destroy(),this.immersiveFrame.destroy()}}}),define("DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable",["UWA/Class"],function(e){"use strict";return e.singleton({getIconMap:function(){return this.iconMap},setIconMap:function(e){this.iconMap=e},getPreviewURLArray:function(){return this.previewURLArray},setPreviewURLArray:function(e){this.previewURLArray=e},getGlobalVariable:function(){return this.enoviaCAGlobalVariable||this.setGlobalVariable(),this.enoviaCAGlobalVariable},setGlobalVariable:function(){this.enoviaCAGlobalVariable={CHGUserPreference:[],serviceName:"3DSpace",tenantMappings:void 0,baseURL:"",swymURL:"",compassURL:"",InterCom:UWA.Utils.InterCom,compassSocket:null,prefIntercomServer:null,compassSocketName:"",prefSocketName:"",arrOid:[],timezone:(new Date).getTimezoneOffset(),wsCallTimeout:12e6,mySecurityContext:"",proxy:window.UWA.Data.proxies.passport?"passport":"ajax",myRole:"",contextUser:"",isNative:!1,isPoweredBy:null,is3DSpace:!1,fromIDCard:!1,referentialsSearchType:"",contextSearchType:"",proposedSearchType:"",datamodel:"new",project_space:"",organization:"",mySkeleton:null,PropWidget:null,NamePref:"Title",ViewPref:"Grid",UXPref:"New",lastSelectedInfoType:"",frameWorkName:"ENOChangeActionUX",TaggerInNative:!0,TriggerCustomeUpdate:!0,CHG_FLOWDOWN:"false",CHG_CHANGE_MATURITY:"false",CHG_CHANGE_SUMMARY_GRID:"false",CHG_OPEN_WITH_COLLAB:"false",CHG_CREATE_CA_AUTO_PROMOTE:"false",CHG_OPENWITH:"false",CHG_CA_VIEWS_ENHANCEMENT:"false",CHG_CHANGE_GROUP:"false",CHG_TRANSFER_REALIZED_CUST_TYPE:"false",CHG_CHANGE_REQUEST:"true",CHG_APPROVAL_COLUMN:"false",CHG_APPROVAL_CYCLE:"false",CHG_IA_CUSTOM_VIEW:"true",CHG_IA_COLUMN_ASSESSMENT:"true",CHG_NATIVE_BREADCRUMB:"false",ECMEnableDefaultChangeAnalysis:"false",CHG_OLD_CA_CREATE:"false",indexMode:"true",indexCRMode:"true",isChangeAvailable:!1,supportedOperationMap:new Object,slidePanelTagger:"false",CHG_EnableNonChangeGovernedToCA:"true",isFullLicence:"false",isLiteLicence:"false",isDerivativeLicense:"false",ECM_SearchRouteTemplateEnforcementForCA:"false",ECM_EnableRouteTemplateEnforcementForCA:"false",ECM_EnableChangeImpactsEnforcementForCR:"false",ECM_EnableExploreInCollabNApprovalForNative:"false",ECM_EnableAddMemberGenericComponent:"false",get3DSpaceURL:function(){return this.baseURL},getSwymURL:function(){return this.swymURL},getCompassURL:function(){return this.compassURL},computeUrl:function(e){return this.get3DSpaceURL()+e},computeSwymUrl:function(e){return this.getSwymURL()+e},getSecurityContext:function(){return this.mySecurityContext},getRole:function(){return this.myRole},collabspace:"",tenant:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",tenantnls:"",existingCAIds:null,existingCOIds:[],newlyAssignCAIds:null,changeActionSubTypePresent:!1,changeAnalysisSubTypePresent:!1,changeOrderSubTypePresent:!1,changeRequestSubTypePresent:!1,subTypePresent:!1,subTypes:null,changeActionSubTypes:null,changeAnalysisSubTypes:null,changeOrderSubTypes:null,changeRequestSubTypes:null,changeActionCustomColumns:void 0,changeAnalysisCustomColumns:void 0,changeOrderCustomColumns:void 0,changeRequestCustomColumns:void 0,ENO_CSRF_TOKEN:"",compassWindow:window.parent}}})}),define("DS/ENOChgServices/scripts/factories/ChangeOrderFactory",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events"],function(e,t,n,a){"use strict";return t.extend(n,a,{init:function(e){console.log(e),alert("In Change Order")},loadWidget:function(){console.log("load Change Order Widget")}})}),define("DS/ENOChgServices/scripts/services/ChgErrors",["DS/UIKIT/Alert"],function(e){"use strict";return{error:function(e){this.message(e,"error")},message:function(t,n,a){null!=this.alertCA&&(this.alertCA.hide(),this.alertCA.destroy());var i=!0;("error"==n||a&&"false"===a)&&(i=!1),this.alertCA=new e({closable:!0,visible:!0,autoHide:i,hideDelay:5e3,className:"wp-alert"}).inject(document.body,"top"),this.alertCA.add({className:n,message:t})},success:function(e){this.message(e,"success")},warn:function(e,t){this.message(e,"warning",t)},info:function(e){this.message(e,"primary")}}}),define("DS/ENOChgServices/scripts/services/ChgInfodialog",["UWA/Class/View","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button"],function(e,t,n,a){"use strict";return{launchInfoDailog:function(e){var i=e.title,r=e.content;r="<span class='fonticon fonticon-wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-attention iconAlert' style = 'font-size: large'></span> "+r,this.buttons=[];var o=this;e.buttonArray.forEach(function(e){var t=new a({label:e.label,className:e.className,onClick:function(t){e.handler()}});o.buttons.push(t)}),this.immersiveFrame=new t({}),this.myDialog=new n({id:"myinfo",class:"myinfoclass",immersiveFrame:this.immersiveFrame,title:i,content:r,activeFlag:!1,resizableFlag:!0,height:150,width:400,buttons:{Yes:this.buttons[0],No:this.buttons[1]}}),this.immersiveFrame.inject(widget.body),this.myDialog.addEventListener("close",function(e){o.immersiveFrame.remove()})},closeDialog:function(){this.myDialog.close()}}}),define("DS/ENOChgServices/scripts/components/ChgCommonDailog",["DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/Controls/Button","DS/Controls/Editor","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS"],function(e,t,n,a,i){"use strict";return{launchInfoDailog:function(r){var o=r.boxTitle,s=(r.subTitle,r.btnId),l=(r.chgPhysicalId,r.chgType);this.buttons=[];var c=this,u=[{label:i.CHG_Done_Button_Label,handler:r.DoneCallback,className:"primary",disabled:"true"},{label:i.CHG_CANCEL_Button_Label,handler:r.CancelCallback,className:"default"}],d="";u.forEach(function(e){var t=new n({label:e.label,className:e.className,disabled:e.disabled,onClick:function(n){if(t&&i.CHG_Done_Button_Label==t.label){var a={chgPhysicalId:r.chgPhysicalId,btnId:s,chgType:l,userComment:h.value};e.handler(a)}else e.handler(s)}});c.buttons.push(t),t&&i.CHG_Done_Button_Label==t.label&&(d=t)});var p=new e({}),g=new UWA.Element("div");g.id="contentDiv";var f=new UWA.Element("div");f.id="divheader";var m=new UWA.Element("label");m.setText(r.subTitle),m.inject(f);var h=new a({placeholder:r.txtPlaceHolder,requiredFlag:!0,widthInCharNumber:80,nbRows:3,newLineMode:"enter"});h.addEventListener("change",function(e){d&&(h.value?d.disabled=!1:d.disabled=!0)}),h.addEventListener("uncommittedChange",function(){d&&(""!=h.valueToCommit?d.disabled=!1:d.disabled=!0)});var v=new UWA.Element("div");v.id="divEditor",h.inject(v),g.appendChild(f),g.appendChild(v),this.CAUpdateDialog=new t({id:"updateCA",immersiveFrame:p,title:o,content:g,activeFlag:!1,resizableFlag:!0,height:160,width:470,buttons:{Yes:this.buttons[0],No:this.buttons[1]}}),p.inject(widget.body),this.CAUpdateDialog.addEventListener("close",function(e){c.CAUpdateDialog.immersiveFrame.remove()})},closeDialog:function(){this.CAUpdateDialog.close()}}}),define("DS/ENOChgServices/scripts/components/ChgCommonCreateDialog",["DS/Controls/Button","DS/Controls/Editor","DS/Windows/ImmersiveFrame","DS/Windows/Dialog","css!DS/ENOChgServices/ENOChgServices"],function(e,t,n,a){"use strict";return{launchCreateChangeOrderDialog:function(i){this.buttons=[];var r=this,o="";i.buttonArray.forEach(function(t){var n=new e({label:t.label,className:t.className,disabled:t.disabled,checkFlag:t.checkFlag,onClick:function(e){var n={titleText:s.value,DescText:l.value};t.handler(n)}});0==r.buttons.length?(n.value="Primary",r.buttons.push(n)):r.buttons.push(n),n&&"Primary"==n.value&&(o=n)});var s=new t({placeholder:i.TitlePlaceHolder,requiredFlag:!0,widthInCharNumber:80,nbRows:1,newLineMode:"enter"}),l=new t({placeholder:i.DescriptionPlaceHolder,requiredFlag:!1,widthInCharNumber:80,nbRows:3,newLineMode:"enter"});s.addEventListener("change",function(e){o&&(s.value?o.disabled=!1:o.disabled=!0)}),s.addEventListener("uncommittedChange",function(){o&&(""!=s.valueToCommit?o.disabled=!1:o.disabled=!0)});var c=new n({}),u=new UWA.Element("div");u.id="commonContentDiv";var d=new UWA.Element("label");d.setText(i.TitleLabel);var p=new UWA.Element("label");p.setText(i.DescriptionLabel);var g=new UWA.createElement("div",{id:"Titlecontainer"}),f=new UWA.createElement("div",{id:"DescrContainer"});g.appendChild(d),s.inject(g),f.appendChild(p),l.inject(f),g.inject(u),f.inject(u),this.CAUpdateDialog=new a({id:"updateCA",immersiveFrame:c,title:i.boxTitle,content:u,activeFlag:!1,resizableFlag:!0,modalFlag:!0,height:240,width:470,buttons:{Yes:this.buttons[0],No:this.buttons[1]}}),c.inject(widget.body)},closeDialog:function(){this.CAUpdateDialog.close()}}}),define("DS/ENOChgServices/scripts/services/DefaultPreferencesManager",["UWA/Class"],function(e){"use strict";return{preferences:{CA_DEF_TYPE:"Change Action",CO_DEF_TYPE:"Change Order",CR_DEF_TYPE:"Change Request",IA_DEF_TYPE:"Change Analysis",IR_DEF_TYPE:"Investigation Request",PROPOSED_DEF_VIEW:"DGV",REALIZED_DEF_VIEW:"DGV"},keys:{createKeys:{CA_DEF_TYPE:"CA_DEF_TYPE",CO_DEF_TYPE:"CO_DEF_TYPE",CR_DEF_TYPE:"CR_DEF_TYPE",IA_DEF_TYPE:"IA_DEF_TYPE",IR_DEF_TYPE:"IR_DEF_TYPE"},viewKeys:{PROPOSED_DEF_VIEW:"PROPOSED_DEF_VIEW",REALIZED_DEF_VIEW:"REALIZED_DEF_VIEW"}}}}),define("DS/ENOChgServices/scripts/services/ChgPropertiesServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/EditPropWidget/EditPropComponent","DS/EditPropWidget/constants/EditPropConstants","DS/EditPropWidget/models/EditPropModel","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS","DS/PlatformAPI/PlatformAPI","require"],function(e,t,n,a,i,r,o,s){"use strict";var l={createPropertiesComponent:function(e,r){var s="";!0===r&&(s="businessobject"),this.caEditComp=new n({typeOfDisplay:a.ALL,selectionType:a.ALL_SELECTION,displayType:a.POPUP,setCloseButton:!1,readOnly:this.getPropertyAccess(),extraNotif:!1,editMode:!1,appId:widget.getValue("appId")});var l=[];if(Array.isArray(e))l=e.map(e=>{var n,a=new i({tenant:t.getGlobalVariable().tenant,objectId:e,metatype:s});return a.addEvent("onChangeAttributes",function(e,t){n=e}),a.addEvent("onSave",function(){o.publish("CO-Properties-Update",n)}),a});else{var c,u=e,d=new i({tenant:t.getGlobalVariable().tenant,objectId:u,metatype:s});d.addEvent("onChangeAttributes",function(e,t){c=e}),d.addEvent("onSave",function(){o.publish("CO-Properties-Update",c)}),l.push(d)}this.caEditComp.show(l)},getPropertyAccess:function(){return"ChangeOrder"==t.getGlobalVariable().lastSelectedInfoType&&"false"==t.getGlobalVariable().isFullLicence},getPropertiesComponent:function(){return this.caEditComp},createPropertyPushItem:function(e,t){return{type:"PushItem",title:r.CHG_Properties_Menu,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-info-open-in-a-new-window"},action:{callback:function(){s(["DS/ENOChgGovernanceUX/scripts/util/ProbesRMBCommandUtil"],function(e){e.createProbesData("Information")});for(let n of e)n.contains("cid:")&&(t=!0);l.createPropertiesComponent(e,t)}}}}};return l}),define("DS/ENOChgServices/scripts/services/ChgApplicationPreferencesManager",["UWA/Class","DS/ENOChgServices/scripts/services/ChgLocalStorage","DS/ENOChgServices/scripts/services/ChgWidgetPreferencesManager","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,n,a){"use strict";return e.singleton({init:function(){var e=a.getGlobalVariable();this.contextUser=e.contextUser},initialize:function(e,a,i,r){var o={};o.appKey=e,o.prefStructure=a,o.contextUser=this.contextUser,this._withWidgetPreferences=i,this._withLocalStorage=r,i&&n.initialize(o),r&&t.initialize(o)},updatePreference:function(e,a){this._withWidgetPreferences&&n.updateWidgetPreference(e,a),this._withLocalStorage&&t.updateLocalStorageValue(e,a)},getPreference:function(e){return this._withWidgetPreferences&&null!=n.getWidgetPreference(e)?n.getWidgetPreference(e):this._withLocalStorage?t.getLocalStorageValue(e):void 0}})}),define("DS/ENOChgServices/scripts/services/ChgApplicabilityServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t){return{getApplicabilityExpression:function(e){"use strict";var t=!1;if(e&&""===e.expressionXML)t=!0;else if(e&&""!=e.expressionXML){var n=(new DOMParser).parseFromString(e.expressionXML,"text/xml").getElementsByTagName("Expression");if(n.length>0){for(var a=[],i=n[0].getElementsByTagName("Context"),r=0;r<i.length;r++){var o=i[r];if(o){var s=o.textContent;"false"===s&&a.push(s)}}i.length===a.length&&(t=!0)}}return t},refreshApplicabilityView:function(e){require(["DS/CfgEvolutionUX/CfgEvolutionLayoutFactory"],function(n){for(var a=document.querySelector("#FacetDivForApplicabilityContext");a&&a.hasChildNodes();)a.removeChild(a.lastChild);var i=t.getGlobalVariable().isNative?"Native":"Dashboard",r={mode:"Applicability",objectid:e.replace("pid:",""),parent:a,environment:i};r.tenant=t.getGlobalVariable().tenant,r.parent&&n.create(r)})}}}),define("DS/ENOChgServices/scripts/services/ChgNativeInitService",["DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e){"use strict";return{DispatchEventToWin:function(t,n){if(e.getGlobalVariable().isNative||"Work_Under"==t&&e.getGlobalVariable().isPoweredBy){var a=window.dscef;if(void 0!==a)"function"==typeof a.sendString&&a.sendString(t+"="+n);else if("undefined"!=typeof CATCefSendString)CATCefSendString(t+"="+n);else{var i=document.createElement("textarea");i.setAttribute("name",t),i.appendChild(document.createTextNode(n));var r=document.createElement("form");r.setAttribute("method","POST"),r.setAttribute("action","jsnotif://"),r.appendChild(i),document.documentElement.appendChild(r),r.submit(),r.parentNode.removeChild(r),r=null}}},getWebInWinParameters:function(t){window.COMPASS_CONFIG&&window.COMPASS_CONFIG.myAppsBaseUrl?t(window.COMPASS_CONFIG):this.getMyappsUrl(function(n){window.COMPASS_CONFIG||(window.COMPASS_CONFIG={}),n&&(window.COMPASS_CONFIG.myAppsBaseUrl=n,window.COMPASS_CONFIG.userId||(window.COMPASS_CONFIG.userId=e.getGlobalVariable().contextUser),window.COMPASS_CONFIG.lang||(window.COMPASS_CONFIG.lang=widget.lang)),t(window.COMPASS_CONFIG)})},getMyappsUrl:function(e){this.isNatifEnvironnement()&&"function"==typeof dscef.getMyAppsURL?dscef.getMyAppsURL().then(function(t){console.log("MyApps URL",t),e.call(null,t)}).catch(function(t){console.error("Failed to fetch MyApps URL: "+t),e.call(null,null)}):e.call(null,null)},isNatifEnvironnement:function(){return"undefined"!=typeof dscef},takeOffFromWorkUnder:function(){this.DispatchEventToWin("Work_Under","FALSE")}}}),define("DS/ENOChgServices/scripts/services/ChgInfraService",["DS/Foundation/WidgetUwaUtils","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/ENOChgServices/scripts/services/ChgErrors","DS/WAFData/WAFData","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS","DS/UIKIT/Mask","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/UIKIT/Input/Text","DS/UIKIT/Input/Button","DS/UIKIT/Dropdown","DS/ENOXWidgetPreferences/js/ENOXWidgetPreferences","DS/ENOChgServices/scripts/services/UserPreferenceUtil","DS/ENOChgServices/scripts/services/DefaultPreferencesManager","require"],function(e,t,n,a,i,r,o,s,l,c,u,d,p,g,f,m,h,v,C){"use strict";var S={URL:null,_SCPreferred:null,_theListSC:null,_theListSC_NLS:null,_SCPreferredDB:null,init:function(){e.setupEnoviaServer(),this.caGlobalObject=s.getGlobalVariable(),this.caGlobalObject||(s.setGlobalVariable(),this.caGlobalObject=s.getGlobalVariable()),this.caGlobalObject.isPoweredBy=this.IsPoweredBy(),this.caGlobalObject.nativeURL=document.location.href},setInfraValue:function(){var e=this;return new Promise(function(t,n){if(!widget.id){var a=Math.random();a.toString(36);var i=a.toString(36).substr(2,9);widget.id="ChangeMgt"+i,widget.setValue("x3dSharedId",widget.id),widget.setValue("appId","ENONCHA_AP"),widget.setValue("x3dAppId","ENONCHA_AP")}window.enoviaServer.widgetName="ChangeActionManagement",window.enoviaServer.widgetId=window.widget.id,window.enoviaServer.tenant=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",e.caGlobalObject.tenant=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise";var r="wdg_"+(new Date).getTime();if(e.setupIntercomConnections.call(e,widget,e.caGlobalObject,r),"undefined"==typeof dscef||e.caGlobalObject.isPoweredBy){var l=o.getUser();l&&(e.caGlobalObject.contextUser=l.login),S.populate3DSpaceURL().then(function(e){h.initialize({prefix:"CHG",storage:s.getGlobalVariable()}),h.fetchUserPreference(v.preferences).then(function(e){},function(e){return Promise.reject(e)}),S.caSubTypesFetched().then(function(e){S.PopulatePreferences().then(function(e){S.getSearchForbiddenTypes(),S.getSearchTypes().then(function(e){let a="";a="true"==s.getGlobalVariable().is3DSpace?"WebApp":"ENOWCHA_AP"==widget.getValue("appId")?"CExecution":"CGovernance",S.getLicenceAccess(a).then(function(e){s.getGlobalVariable().isFullLicence=e.data[0].IsFullLicense,s.getGlobalVariable().isLiteLicence=e.data[0].IsLiteLicense,s.getGlobalVariable().isDerivativeLicense=e.data[0].isDerivativeLicense,t()},function(e){n(e)})},function(e){n(e)})},function(e){n(e)})},function(e){n(e)})},function(e){n(e)})}else{e.initializeForNative(function(e){t(e)})}})},fetchCASubTypes:function(e){var t=this;t.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",'["Change Action"]',function(n){if(Object.keys(n).length>1){t.caGlobalObject.changeActionSubTypes=[];var a=[];Object.keys(n).forEach(function(e){var n=t.fetchNLSForSubType(e);a.push(n)}),Promise.all(a).then(function(){t.caGlobalObject.changeActionSubTypePresent=!0;var n=[],a=0;Object.keys(t.caGlobalObject.changeActionSubTypes).forEach(function(e){var i=t.caGlobalObject.changeActionSubTypes[e];n[a]={label:i,value:e},a++}),n.sort(function(e,t){return e.label.toUpperCase()>t.label.toUpperCase()?1:-1}),t.caGlobalObject.changeActionSubTypes=n,null!=e&&e()})}else if(1==Object.keys(n).length){var i=Object.keys(n),r={};r[i[0]]=i[0],t.caGlobalObject.changeActionSubTypePresent=!1,t.caGlobalObject.changeActionSubTypes=[],t.caGlobalObject.changeActionSubTypes.push(r),null!=e&&e()}else null!=e&&e()},function(n){t.caGlobalObject.changeActionSubTypePresent=!1,null!=e&&e()},!0)},fetchNLSForSubType:function(e){var t=this;return new Promise(function(n,a){var i="/resources/dictionary/class/"+e+"/attributes";t.makeWSCall(i,"GET","enovia","application/json","",function(a){UWA.is(a.NLSName)&&""!=a.NLSName?t.caGlobalObject.changeActionSubTypes[e]=a.NLSName:t.caGlobalObject.changeActionSubTypes[e]=e,n()},function(a){t.caGlobalObject.changeActionSubTypes[e]=e,n()},!0)})},IsPoweredBy:function(){var e={},t=document.createElement("a");t.href=location.href;for(var n=t.search.substring(1).split("&"),a=0;a<n.length;a++){var i=n[a].split("=");e[i[0]]=decodeURIComponent(i[1])}return!(!e.widgetDomain||!(e.widgetDomain.search("catiav5")>=0||e.widgetDomain.search("solidworks")>=0))},populate3DSpaceURL:function(e){var n=this;return new Promise(function(a,i){var r=null;e&&((r={}).myAppsBaseUrl=e.myAppsBaseUrl,r.userId=e.userId,r.lang=e.lang),t.getPlatformServices({config:r,onComplete:function(e){for(var t=0;t<e.length;t++){if(n.caGlobalObject&&(n.caGlobalObject.tenantMappings=e,n.caGlobalObject.tenant==e[t].platformId)){n.caGlobalObject.baseURL=e[t]["3DSpace"],n.caGlobalObject.federatedURL=e[t]["3DSearch"],n.caGlobalObject.swymURL=e[t]["3DSwym"],n.caGlobalObject.compassURL=e[t]["3DCompass"],n.caGlobalObject.dashboardURL=e[t]["3DDashboard"];var i=n.caGlobalObject.swymURL;n.caGlobalObject.isSwymInstalled=null!=i}if(n.caGlobalObject=s.getGlobalVariable(),n.caGlobalObject&&n.caGlobalObject.tenant==e[t].platformId){n.caGlobalObject.baseURL=e[t]["3DSpace"],n.caGlobalObject.federatedURL=e[t]["3DSearch"],n.caGlobalObject.swymURL=e[t]["3DSwym"],n.caGlobalObject.compassURL=e[t]["3DCompass"],n.caGlobalObject.dashboardURL=e[t]["3DDashboard"];i=n.caGlobalObject.swymURL;n.caGlobalObject.isSwymInstalled=null!=i}}a()},onFailure:i})})},populateSecurityContext:function(){var e=this;return new Promise(function(t,a){var r=widget.getValue("SC");if(null!=r&&null!=r&&""!=r){var o="ctx::"+r;o=o.replace("ctx::",""),e.caGlobalObject.myRole=o.substring(0,o.indexOf(".")),window.enoviaServer.myRole=o.substring(0,o.indexOf(".")),e.caGlobalObject.collabspace=o.substring(o.lastIndexOf(".")+1,o.length),t(o)}else e.makeWSCall("/resources/pno/person/getsecuritycontext","GET","enovia","application/json","",function(a){if((o=a.SecurityContext)&&null!=o){if(null!=a&&""!=a&&a.hasOwnProperty("SecurityContext")){var r="";0!=a.SecurityContext.indexOf("ctx::")&&(r="ctx::"),o=r+a.SecurityContext}console.log("Setting security Context: "+o),e.caGlobalObject.mySecurityContext=o,o=o.replace("ctx::",""),UWA.is(window.enoviaServer)&&(window.enoviaServer.context=o),e.caGlobalObject.myRole=o.substring(0,o.indexOf(".")),window.enoviaServer&&(window.enoviaServer.myRole=o.substring(0,o.indexOf("."))),e.caGlobalObject.collabspace=o.substring(o.lastIndexOf(".")+1,o.length),t(a)}else n.error(i.ECM_CA_Use_Preferences)},a,!0)})},PopulatePreferences:function(){var e=this;return new Promise(function(t,n){m.addPlatformSelectionPreferenceToWidget({roles:["CSV","InternalDS"],mustHaveAll:!1}).then(function(){console.log("New Platform Preference"),m.addCredentialPreferenceToWidget().then(function(){console.log("New Credential");let n=m.getCredentialPreferenceKey();e.caGlobalObject.mySecurityContext="ctx::"+widget.getValue(n);let a=widget.getValue(n);UWA.is(window.enoviaServer)&&(window.enoviaServer.context=a),e.caGlobalObject.myRole=a.substring(0,a.indexOf(".")),window.enoviaServer&&(window.enoviaServer.myRole=a.substring(0,a.indexOf("."))),e.caGlobalObject.collabspace=a.substring(a.lastIndexOf(".")+1,a.length);let i=m.getPlatformPreferenceKey();e.caGlobalObject.tenant=widget.getValue(i);let r,o=s.getGlobalVariable().changeActionSubTypes;var l=[];o.length>1&&(r=S.populateChangeActionTypePreferences(o),l.push(r)),Promise.all(l).then(function(e){if(o.length>1){let t=e.length-1;widget.addPreference(e[t].changeActionSubTypes),null==widget.getValue("DefaultCASubType")&&widget.setValue("DefaultCASubType","Change Action")}t("success")})})})})},PopulateViewPreferences:function(){var e=i.CHG_CA_Pref_View_Label,t=i.CHG_CA_Pref_Grid_Label,n=i.CHG_CA_Pref_Tile_Label,a={name:"ViewMode",type:"list",label:e,options:[]};return new Promise(function(e,i){a.options.push({value:"Grid",label:t}),a.options.push({value:"Tile",label:n});var r={};r.ViewPreference=a,e(r)})},PopulateSCPreferences:function(){return S._SCPreferredDB="",S._SCPreferred="",new Promise(function(e,t){S.makeWSCall("/resources/modeler/pno/person?current=true&select=collabspaces&select=preferredcredentials","GET","enovia","application/json","",function(t){var n={};n.collabspacesDetails=t,e(n)},t)})},populateChangeActionTypePreferences:function(e){let t={name:"DefaultCASubType",type:"list",label:i.CHG_CA_Pref_Default_SubType_Label,options:[]};return new Promise(function(n,a){for(let n=0;n<e.length;n++)t.options.push({value:e[n].value,label:e[n].label});let i={};i.changeActionSubTypes=t,n(i)})},getExpressionValue:function(){var e=this;return new Promise(function(t,n){S.makeWSCall("/resources/v2/e6w/service/ExpresssionSearch/CHG*,ECM*","GET","enovia","application/json","",function(n){var a=["CHG_CHANGE_MATURITY","CHG_OPEN_WITH_COLLAB","CHG_CREATE_CA_AUTO_PROMOTE","CHG_ADD_MASS_PROPOSED","CHG_CA_VIEWS_ENHANCEMENT","CHG_CHANGE_GROUP","CHG_TRANSFER_REALIZED_CUST_TYPE","CHG_APPROVAL_COLUMN","CHG_APPROVAL_CYCLE","CHG_IA_COLUMN_ASSESSMENT","CHG_IA_CUSTOM_VIEW","CHG_IA_COLUMN_ASSESSMEN","ECMEnableDefaultChangeAnalysis","CHG_NATIVE_BREADCRUMB","CHG_ADD_IA_FROM_PARENT_CR","CHG_CA_REALIZED_REFRESH","ECM_SearchRouteTemplateEnforcementForCA","ECM_EnableRouteTemplateEnforcementForCA","ECM_EnableChangeImpactsEnforcementForCR","ECM_EnableExploreInCollabNApprovalForNative","ECM_EnableAddMemberGenericComponent","CHG_CR_DUPLICATE","CHG_INVESTIGATION_REQUEST","CHG_EnableNonChangeGovernedToCA"];n&&n.data&&n.data.forEach(function(t){if(t.dataelements){var n=Object.keys(t.dataelements);for(var i in n)a.indexOf(n[i])>=0&&t.dataelements&&(e.caGlobalObject[n[i]]=t.dataelements[n[i]])}}),t()},n,!0)})},onPnORetrieve:function(e){if(e){var t=i.ECM_CA_SC_CREDENTIALS,n=S.getSCPreference(t);widget.addPreference(n);var a=widget.getValue("SC"),r=S.getSCPreferred(a);widget.setValue("SC",r),widget.setValue("xPref_CREDENTIAL",r)}},onRefresh:function(){var e="ctx::"+widget.getValue("SC");e=e.replace("ctx::",""),this.caGlobalObject.myRole=e.substring(0,e.indexOf(".")),this.caGlobalObject.collabspace=e.substring(e.lastIndexOf(".")+1,e.length)},checkValiditySC:function(e){var t=!1,n=0;if(S._theListSC)for(;!t&&n<S._theListSC.length;)e===S._theListSC[n]&&(t=!0),n++;return t},ComputeList:function(e){var t,n,a,i=!1,r=[],o=[],l=e.preferredcredentials;if(l&&l.collabspace&&l.role&&l.organization){var c=l.collabspace,u=l.role,d=l.organization;c.title,t=u.name,d.title,n=c.name,a=d.name,s.getGlobalVariable().organization=a,S._SCPreferredDB=t+"."+a+"."+n}var p=e.collabspaces;if(p&&p.length>0){for(var g=!1,f=0;f<p.length;f++){for(var m=(A=p[f]).couples||[],h=0;h<m.length;h++){var v=m[h];if(void 0===b&&(b=v.organization.name),b!==v.organization.name){g=!0;break}}if(g)break}var C,y,b=void 0,w=[];for(f=0;f<p.length;f++){var A,O=(A=p[f]).title,N=A.name;for(m=A.couples,h=0;h<m.length;h++){var I=m[h],P=I.organization,E=I.role,T=P.name,R=P.title,_=E.name,D=E.nls;w.push({collabspace:N,collabspaceNLS:O,organization:T,organizationNLS:R,role:_,roleNLS:D}),""!=S._SCPreferredDB?a===T&&t===_&&n===N&&(i=!0):i=!0}}g?w.sort(function(e,t){return e.collabspaceNLS.toLowerCase()>t.collabspaceNLS.toLowerCase()?1:e.collabspaceNLS.toLowerCase()===t.collabspaceNLS.toLowerCase()?e.organizationNLS.toLowerCase()>t.organizationNLS.toLowerCase()?1:e.organizationNLS.toLowerCase()===t.organizationNLS.toLowerCase()&&e.roleNLS.toLowerCase()>t.roleNLS.toLowerCase()?1:-1:-1}):w.sort(function(e,t){return e.collabspaceNLS.toLowerCase()>t.collabspaceNLS.toLowerCase()?1:e.collabspaceNLS.toLowerCase()===t.collabspaceNLS.toLowerCase()&&e.roleNLS.toLowerCase()>t.roleNLS.toLowerCase()?1:-1});for(f=0;f<w.length;f++)C=w[f].role+"."+w[f].organization+"."+w[f].collabspace,y=g?w[f].collabspaceNLS+" ● "+w[f].organizationNLS+" ● "+w[f].roleNLS:w[f].collabspaceNLS+" ● "+w[f].roleNLS,r.push(C),o.push(y);S._theListSC=r,S._theListSC_NLS=o}S.onPnORetrieve(i)},getSCPreference:function(e){var t={name:"SC",type:"list",label:e,options:[]};if(S._theListSC)for(var n=0;n<S._theListSC.length;n++)t.options.push({value:S._theListSC[n],label:S._theListSC_NLS[n]});return t},getSCPreferred:function(e){var t;if(null!=e&&""!=e&&S.checkValiditySC(e))t=e;else if(""!=S._SCPreferredDB)t=S._SCPreferredDB;else{t=S._theListSC[0];for(var n=0;n<S._theListSC.length;n++)if(S._theListSC[n].contains("VPLMProjectLeader")){t=S._theListSC[n];break}}return t},populateTenantPreferences:function(){var e={name:"x3dPlatformId",type:"list",label:i.ECM_CA_Pref_3DEXPERIENCE_Platform,options:[]},n=[];return new Promise(function(e,a){t.getGrantedRoles(function(t){t.forEach(function(e){"CSV"!==e.id&&"InternalDS"!==e.id||UWA.is(e.platforms,"array")&&(n=n.concat(e.platforms))}),e()})}).then(function(){return new Promise(function(a,i){t.getPlatformServices({onComplete:function(t){var i;if(n.length>0){var r=[];t.forEach(function(e){n.includes(e.platformId)&&r.push(e)}),i=r}else i=t;i.sort(function(e,t){var n=e.displayName.toLowerCase(),a=t.displayName.toLowerCase();return n<a?-1:n>a?1:0}),i.forEach(function(t){var n=t.platformId,a=t.displayName;e.options.push({value:n,label:a}),widget.getValue("x3dPlatformId")===n&&S.update3DspaceURL(t)}),(t={}).TenantPreference=e,a(t)},onFailure:function(e){console.log("Error getting Tenant details")}})})})},update3DspaceURL:function(e){this.caGlobalObject.baseURL=e["3DSpace"],this.caGlobalObject.federatedURL=e["3DSearch"],this.caGlobalObject.tenant=e.platformId},readyDragContent:function(e,t){var n=[];if(t.nodeModel.getTreeDocument().getSelectedNodes().length>1)t.nodeModel.getTreeDocument().getSelectedNodes().forEach(function(e){var a={envId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",serviceId:e.options.grid.serviceName?e.options.grid.serviceName:"3DSpace",contextId:s.getGlobalVariable().getSecurityContext(),objectId:e.options.grid.ref_details?e.options.grid.ref_details.id:e.options.grid.serviceBasedObjId?e.options.grid.serviceBasedObjId:e.options.grid.id,objectType:e.options.grid.ref_details?e.options.grid.ref_details.dataelements["ds6w:type"][0]:e.options.grid.type,displayName:e.options.grid.ref_details?e.options.grid.ref_details.dataelements["ds6w:label"][0]:e.options.grid.title,displayType:e.options.grid.ref_details?e.options.grid.ref_details.dataelements["ds6w:type"][0]:e.options.grid.displayType};e.options.grid.serviceBasedObjId&&e.options.grid.serviceBasedObjId!==e.options.grid.id?a.i3dx=e.options.grid.id:a.i3dx="",t.contextChangeType&&"ChangeAction"==t.contextChangeType&&(a.ChangeActionID=t.contextChangeId,a.caContextIds=t.caContextData),n.push(a)});else{var a=t.nodeModel.options.grid.ref_details?t.nodeModel.options.grid.ref_details.id:t.nodeModel.options.grid.serviceBasedObjId?t.nodeModel.options.grid.serviceBasedObjId:t.nodeModel.options.grid.id;a.contains("pid:")&&(a=a.replace("pid:",""));var i={envId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",serviceId:t.nodeModel.options.grid.serviceName?t.nodeModel.options.grid.serviceName:"3DSpace",contextId:s.getGlobalVariable().getSecurityContext(),objectId:a,objectType:t.nodeModel.options.grid.ref_details?t.nodeModel.options.grid.ref_details.dataelements["ds6w:type"][0]:t.nodeModel.options.grid.type,displayName:t.nodeModel.options.grid.ref_details?t.nodeModel.options.grid.ref_details.dataelements["ds6w:label"][0]:t.nodeModel.options.grid.title,displayType:t.nodeModel.options.grid.ref_details?t.nodeModel.options.grid.ref_details.dataelements["ds6w:type"][0]:t.nodeModel.options.grid.displayType};t.nodeModel.options.grid.serviceBasedObjId&&t.nodeModel.options.grid.serviceBasedObjId!==t.nodeModel.options.grid.id?i.i3dx=t.nodeModel.options.grid.id:i.i3dx="",t.contextChangeType&&"ChangeAction"==t.contextChangeType&&(i.ChangeActionID=t.contextChangeId,i.caContextIds=t.caContextData),n.push(i)}var r={protocol:"3DXContent",version:"2.1",source:widget.getValue("appId"),widgetId:widget.id,data:{items:n}};s.getGlobalVariable().isNative?r.source="ENONCHA_AP":r.source||(r.source="X3DCSMA_AP"),e.dataTransfer.setData("Text",JSON.stringify(r)),e.dataTransfer.effectAllowed="all"},updateWidgetTitle:function(e){var t=i.CHG_CA_Widget_Title;return null!=e&&(t=e),widget.setTitle(t)},getSearchTypes:function(){var e=this;return new Promise(function(t,n){e.makeWSCall("/resources/modeler/change/typeeallowed","GET","enovia","application/json","",function(n){e.caGlobalObject.referentialsSearchType=e.getResultStringFromJSONArrayObj(n.referentials),e.caGlobalObject.contextSearchType=e.getResultStringFromJSONArrayObj(n.context),e.caGlobalObject.proposedSearchType=e.getResultStringFromJSONArrayObj(n.proposed),t(n)},n,!0)})},getSearchForbiddenTypes:function(){var e=this;return new Promise(function(t,n){e.makeWSCall("/resources/modeler/change/typeeallowed/enhanced","GET","enovia","application/json","",function(n){e.caGlobalObject.referentialsSearchForbiddenType=UWA.is(n.referentials)&&UWA.is(n.referentials.forbidden)?e.getResultStringFromJSONArrayObj(n.referentials.forbidden):"",e.caGlobalObject.contextSearchForbiddenType=UWA.is(n.context)&&UWA.is(n.context.forbidden)?e.getResultStringFromJSONArrayObj(n.context.forbidden):"",e.caGlobalObject.proposedSearchForbiddenType=UWA.is(n.proposed)&&UWA.is(n.proposed.forbidden)?e.getResultStringFromJSONArrayObj(n.proposed.forbidden):"",t()},function(){console.log("typeeallowed enhanced web service fails...!"),t()},!0)})},getResultStringFromJSONArrayObj:function(e){var t="";if(null!=e&&""!=e&&e.length>0)for(var n=0;n<e.length;n++)t=""==t?e[n]:t+","+e[n];return t},IsChangeAction:function(e,t){var n=this;return new Promise(function(a,i){var r="/resources/modeler/change/changeaction/pid:"+e;t||(t=!0),n.makeWSCall(r,"GET","enovia","application/json","",function(e){a({isChangeAction:"TRUE"})},function(){a({isChangeAction:"FALSE"})},t)})},createCA:function(e,t,n){this.makeWSCall("/resources/modeler/change/changeaction","POST","enovia","application/json",e,t,n)},createCA_v1:function(e,t,n){this.makeWSCallWithCSRF("/resources/v1/chguxservices/changeaction/createChangeAction","POST","enovia","application/json",e,t,n)},createChangeOrder:function(e,t,n){this.makeWSCallWithCSRF("/resources/v1/chguxservices/changeorder","POST","enovia","application/json",e,t,n)},makeWSCall:function(e,t,o,l,c,u,d,p,g=!0){var f=null;if(this.caGlobalObject)f=this.caGlobalObject;else{var m=s.getGlobalVariable();m&&(f=m)}var h="";h=null!=(p=p||null)&&null!=p.isfederated&&1==p.isfederated?f.federatedURL+e:null!=p&&null!=p.isCompass&&1==p.isCompass?f.compassURL+e:f.computeUrl(e);var v="";v=null!=p&&null!=p.acceptType&&""!=p.acceptType?p.acceptType:"application/json";var C="Yes";null!=p&&null!=p.encodeSecurityContext&&""!=p.encodeSecurityContext&&(C=p.encodeSecurityContext);var S=(new Date).getTime();h=-1==h.indexOf("?")?h+"?tenant="+f.tenant+"&timestamp="+S:h+"&tenant="+f.tenant+"&timestamp="+S;var y=f.getSecurityContext();"No"!=C&&(y=encodeURIComponent(y)),u=u||function(){},d=d||function(){};var b=widget.getValue("lang");widget.lang&&(b=widget.lang);var w={};w.method=t,w.timeout=f.wsCallTimeout,null!=p&&null!=p.isSwymUrl&&0!=p.isSwymUrl||(w.type="json"),f.isNative?w.headers=y?{Accept:v,"Content-Type":l,SecurityContext:y,"Accept-Language":b}:{Accept:v,"Content-Type":l,"Accept-Language":b}:(o&&(w.auth={passport_target:o}),w.proxy=f.proxy,w.headers=y?{Accept:v,"Content-Type":l,SecurityContext:y,"Accept-Language":b}:{Accept:v,"Content-Type":l,"Accept-Language":b}),c&&(w.data=c),w.onComplete=function(e){if(e&&e["error report"]&&Array.isArray(e["error report"])){for(var t=e["error report"],a="",i=0;i<t.length;i++){var o=t[i];o&&o.message&&(a=a+o.message+"<br>")}n.error(a);var s=document.getElementById("outer-ca-div");s&&r.unmask(s);var l=document.getElementsByClassName("moduleWrapper")[0];l&&r.isMasked(l)&&r.unmask(l),widget.body&&r.unmask(widget.body)}else u(e||"")},w.onFailure=function(e,a){if(console.log("Error in calling url: "+h),console.log("Additional Details:: httpMethod: "+t+" authentication: "+o+" securityContext: "+y+" ContentType: "+l),console.log("Error Detail: "+e),console.log("Error Data: "+JSON.stringify(a)),h.includes("getapplicability"))var s={blockError:!0};g&&(a&&a.errorMessage?null!=s&&s.blockError?console.log("errorBlocked"):n.error(a.errorMessage):a&&a.error&&a.error.message?n.error(a.error.message):e&&e.message?n.error(e.message):n.error(i.CHG_GOV_ERROR_MSG)),d(e,a);var c=document.getElementById("outer-ca-div");c&&r.unmask(c);var u=document.getElementsByClassName("moduleWrapper")[0];u&&r.isMasked(u)&&r.unmask(u),widget.body&&r.unmask(widget.body)},w.onTimeout=function(){console.log("Timedout for url: "+h),n.error(i.CHG_GOV_ERROR_SERVICE_TIMEOUT);var e=document.getElementById("outer-ca-div");e&&r.unmask(e);var t=document.getElementsByClassName("moduleWrapper")[0];t&&r.isMasked(t)&&r.unmask(t),widget.body&&r.unmask(widget.body)},a.authenticatedRequest(h,w)},makeWSCallWithCSRF:function(e,t,o,l,c,u,d,p){var g=null;if(this.caGlobalObject)g=this.caGlobalObject;else{var f=s.getGlobalVariable();f&&(g=f)}var m="";m=null!=(p=p||null)&&null!=p.isfederated&&1==p.isfederated?g.federatedURL+e:g.computeUrl(e);var h="";h=null!=p&&null!=p.acceptType&&""!=p.acceptType?p.acceptType:"application/json";var v="Yes";null!=p&&null!=p.encodeSecurityContext&&""!=p.encodeSecurityContext&&(v=p.encodeSecurityContext);var C=(new Date).getTime();m=-1==m.indexOf("?")?m+"?tenant="+g.tenant+"&timestamp="+C:m+"&tenant="+g.tenant+"&timestamp="+C;var S=g.getSecurityContext(),y=g.ENO_CSRF_TOKEN;"No"!=v&&(S=encodeURIComponent(S)),u=u||function(){},d=d||function(){};var b=widget.getValue("lang");widget.lang&&(b=widget.lang);var w={};w.method=t,w.timeout=g.wsCallTimeout,null!=p&&null!=p.isSwymUrl&&0!=p.isSwymUrl||(w.type="json"),g.isNative?w.headers=S?{Accept:h,"Content-Type":l,SecurityContext:S,"Accept-Language":b,ENO_CSRF_TOKEN:y}:{Accept:h,"Content-Type":l,"Accept-Language":b}:(o&&(w.auth={passport_target:o}),w.proxy=g.proxy,w.headers=S?{Accept:h,"Content-Type":l,SecurityContext:S,"Accept-Language":b,ENO_CSRF_TOKEN:y}:{Accept:h,"Content-Type":l,"Accept-Language":b}),null!=p&&null!=p.issueVersion&&""!=p.issueVersion&&(w.headers[p.issueVersion]=p.version),c&&(w.data=c),w.onComplete=function(e){if(e.csrf){var t=e.csrf.value;s.getGlobalVariable().ENO_CSRF_TOKEN=t}var a=void 0;if(e.data&&Array.isArray(e.data)&&e.data[0]&&e.data[0]["error report"]&&Array.isArray(e.data[0]["error report"])){var i=e.data[0]["error report"],r="";a=[];for(var o=0;o<i.length;o++){var l=i[o];l&&l.message&&(r=r+l.message+"<br>"),l&&l.id&&a.push(l.id)}n.error(r),e.data.splice(0,1)}u(e,a)},w.onFailure=function(e,a){var s;console.log("Error in calling url: "+m),console.log("Additional Details:: httpMethod: "+t+" authentication: "+o+" securityContext: "+S+" ContentType: "+l),console.log("Error Detail: "+e),console.log("Error Data: "+JSON.stringify(a)),a&&a.errorMessage?n.error(a.errorMessage):a&&a.error&&a.error.message?n.error(a.error.message):a&&a.internalError?n.error(a.internalError):a&&a.error?n.error(a.error):e&&e.message?n.error(e.message):n.error(i.CHG_GOV_ERROR_MSG),d(e,a),widget.body&&r.unmask(widget.body),(s=document.getElementsByClassName("moduleWrapper")[0])&&r.isMasked(s)&&r.unmask(s),(s=document.getElementsByClassName("chg-affectedItems-container")[0])&&r.isMasked(s)&&r.unmask(s),(s=document.getElementsByClassName("chg-orchestration-container")[0])&&r.isMasked(s)&&r.unmask(s),(s=document.getElementById("crAffectedItemsFullViewContainer"))&&r.isMasked(s)&&r.unmask(s)},w.onTimeout=function(){console.log("Timedout for url: "+m),n.error(i.CHG_GOV_ERROR_SERVICE_TIMEOUT),widget.body&&r.unmask(widget.body)},a.authenticatedRequest(m,w)},setupIntercomConnections:function(e,t,n){t.compassSocketName=n+"EventSocket",t.compassSocket=new t.InterCom.Socket(t.compassSocketName),t.compassSocket.subscribeServer("com.ds.compass",window.parent),t.prefIntercomServer=new t.InterCom.Server("changeaction.intercom.server"),t.prefIntercomServer.addListener("onAddPref",function(n,a){"RefreshMe"!=n.name?n.value?e.setValue(n.name,n.value):e.deleteValue(n.name):t.onRefresh()})},initializeForNative:function(e){this.caGlobalObject.isNative=!0,this.caGlobalObject.callback=e,l.DispatchEventToWin("Native_Init","done")},initNative:function(e){this.caGlobalObject.isNative=!0,this.caGlobalObject.contextUser=e.userid,this.caGlobalObject.tenant=e.active_tenant,widget.setValue("x3dPlatformId",e.active_tenant),this.caGlobalObject.tenantnls=e.tenantDisplayName;let t={contextUser:e.userid,tenant:e.active_tenant,tenantnls:e.tenantDisplayName,isNative:!0};widget.setValue("native_user_info",t),widget.body.setStyle("height",document.body.parentElement.clientHeight+"px"),widget.addEvent("onResize",function(){widget.body.setStyle("height",document.body.parentElement.clientHeight+"px")});var n={},a=this;l.getWebInWinParameters(function(t){n=t||null,a.populate3DSpaceURL(n).then(function(t){a.populateSecurityContext().then(function(t){a.getSearchForbiddenTypes(),a.getSearchTypes().then(function(t){a.caGlobalObject.callback(e),h.initialize({prefix:"CHG",storage:s.getGlobalVariable()}),h.fetchUserPreference(v.preferences).then(function(e){},function(e){return Promise.reject(e)});S.getLicenceAccess("Native").then(function(e){return s.getGlobalVariable().isFullLicence=e.data[0].IsFullLicense,s.getGlobalVariable().isLiteLicence=e.data[0].IsLiteLicense,s.getGlobalVariable().isDerivativeLicense=e.data[0].isDerivativeLicense,Promise.resolve()},function(e){return Promise.reject(e)})},function(e){return console.log("Search Types failed"),Promise.reject(e)})},function(e){return console.log("Populate Security Context failed"),Promise.reject(e)})},function(e){return console.log("Populate 3DSpace URL failed"),Promise.reject(e)})})},getCSRFToken:function(){var e=this;return new Promise(function(t,n){e.makeWSCallWithCSRF("/resources/v1/application/CSRF","GET","enovia","application/json","",function(e){s.getGlobalVariable().ENO_CSRF_TOKEN=e.csrf.value,t("success")},n,!0)})},getNLSValuesPromise:function(e){return new Promise(function(t,n){null!=e?c.getNlsOfPropertiesValues(JSON.stringify(e),{tenantId:s.getGlobalVariable().tenant,lang:widget.lang,onComplete:function(e){t(e)},onFailure:function(e){n(e)}}):t(e)})},getNLSValuesPromiseForSource:function(e){return new Promise(function(t,n){null!=e?c.getNlsOfPropertiesValuesBySource(e,{tenantId:s.getGlobalVariable().tenant,lang:widget.lang,onComplete:function(e){t(e)},onFailure:function(e){n(e)}}):t(e)})},caSubTypesFetched:function(){return new Promise(function(e,t){null!=s.getGlobalVariable().changeActionSubTypes?e():S.fetchCASubTypes(e,t)})},iaSubTypesFetched:function(){return new Promise(function(e,t){null!=s.getGlobalVariable().changeAnalysisSubTypes?e():S.fetchIASubTypes(e,t)})},fetchIASubTypes:function(e){var t=this;t.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",'["Change Analysis"]',function(n){if(Object.keys(n).length>1){s.getGlobalVariable().changeAnalysisSubTypes=[];var a=[];Object.keys(n).forEach(function(e){var n=t.fetchNLSForIASubType(e);a.push(n)}),Promise.all(a).then(function(){s.getGlobalVariable().changeAnalysisSubTypePresent=!0;var t=[],n=0;Object.keys(s.getGlobalVariable().changeAnalysisSubTypes).forEach(function(e){var a=s.getGlobalVariable().changeAnalysisSubTypes[e];t[n]={label:a,value:e},n++}),t.sort(function(e,t){return e.label.toUpperCase()>t.label.toUpperCase()?1:-1}),s.getGlobalVariable().changeAnalysisSubTypes=t,null!=e&&e()})}else if(1==Object.keys(n).length){var i=Object.keys(n),r={};r[i[0]]=i[0],s.getGlobalVariable().changeAnalysisSubTypePresent=!1,s.getGlobalVariable().changeAnalysisSubTypes=[],s.getGlobalVariable().changeAnalysisSubTypes.push(r),null!=e&&e()}else null!=e&&e()},function(t){s.getGlobalVariable().changeAnalysisSubTypePresent=!1,null!=e&&e()},!0)},getLicenceAccess:function(e){return new Promise(function(t,n){var a="/resources/v1/chguxservices/connectedChange/license?platform="+e;S.makeWSCallWithCSRF(a,"GET","enovia","application/json","",function(e){t(e)},n,!1)})},fetchNLSForIASubType:function(e){var t=this;return new Promise(function(n,a){var i="/resources/dictionary/class/"+e+"/attributes";t.makeWSCall(i,"GET","enovia","application/json","",function(t){UWA.is(t.NLSName)&&""!=t.NLSName?s.getGlobalVariable().changeAnalysisSubTypes[e]=t.NLSName:s.getGlobalVariable().changeAnalysisSubTypes[e]=e,n()},function(t){s.getGlobalVariable().changeAnalysisSubType[e]=e,n()},!0)})},getCopyLink:function(e,n){return{type:"PushItem",title:i.LinkCopiedTitle,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-link"},action:{callback:function(){C(["DS/ENOChgGovernanceUX/scripts/util/ProbesRMBCommandUtil"],function(e){e.createProbesData("Copy Link")});var a=void 0;let r=void 0;1==e.length?e[0].options?(r=e[0].options.grid.typeNLS||e[0].options.grid.type,a=e[0].options.grid.title||e[0].options.grid.name):(r=e[0].type,a=e[0].name):a="";var o=UWA.createElement("div",{styles:{display:"flex"}}),l=new p("input",{attributes:{readonly:"readonly"}});l.getContent().setStyles({display:"inline-block","border-top-right-radius":0,"border-bottom-right-radius":0}),l.inject(o);var c=new g({value:"Copy Link",className:"block",events:{onClick:function(e){l.setFocus(),l.elements.input.select(),l.elements.input.setSelectionRange(0,99999),document.execCommand("cut"),d.hide(),a&&""!==a?S.showNotification("success",i.get("LinkCopiedTitle"),UWA.String.format(i.get("LinkCopiedMsg"),r,a),"",!1,""):S.showNotification("success",i.get("LinkCopiedTitle"),i.get("LinkCopied"),"",!1,"")}}});c.getContent().setStyles({display:"inline-block","border-top-left-radius":0,"border-bottom-left-radius":0,padding:"0 10px"}),c.inject(o);var u,d=new f({body:o,closeOnClick:!1,events:{onClickOutside:function(e){console.log("DDClickOutside")}}}),m=s.getGlobalVariable();if(m.isNative)for(var h=m.tenantMappings,v=0;v<h.length;v++)m.tenant==h[v].platformId&&(u=h[v]["3DDashboard"]);else u=widget.widgetDomain;if(null==u){u=[]["3DDashboard"]}if(null==u)t.getPlatformServices({platformId:"OnPremise",onComplete:function(t){let a="",i=0;for(let o of e){var r=S.makeCopyLinkObject(o,n);let e=widget.getValue("appId")?widget.getValue("appId"):"ENOWCHA_AP",s=t["3DDashboard"]+"#app:"+e+"/content:X3DContentId="+encodeURIComponent(JSON.stringify(r));0==i?(a+=s,i++):a=a+" "+s}d.hide(),d.show(),l.setFocus(),l.setValue(a),l.elements.input.select(),l.elements.input.setSelectionRange(0,99999,"backward"),c.getContent().click()}});else{let t="",a=0;for(let i of e){let e;var y=S.makeCopyLinkObject(i,n),b=widget.getValue("appId");e=null==b&&m.isNative?u+"#app:"+(b="ENOWCHA_AP")+"/content:X3DContentId="+encodeURIComponent(JSON.stringify(y)):u+"#app:"+widget.getValue("appId")+"/content:X3DContentId="+encodeURIComponent(JSON.stringify(y)),0==a?(t+=e,a++):t=t+" "+e}d.hide(),d.show(),l.setFocus(),l.setValue(t),l.elements.input.select(),l.elements.input.setSelectionRange(0,99999,"backward"),c.getContent().click()}}}}},makeCopyLinkObject:function(e,t){var n={protocol:"3DXContent",data:{items:[]}};return e._options&&"ChangeAnalysis"==e._options.grid.isKindOfType?n.data.items.push({envId:s.getGlobalVariable().tenant,objectId:t,openLink:!0,IAid:e.options.grid.id,tabName:"crAssessment"}):n.data.items.push({envId:s.getGlobalVariable().tenant,objectId:e.options?e.options.grid.id:e.id,openLink:!0}),n},recent:function(){return new Promise(function(e,t){var n={label:window.widget.name+"-"+s.getGlobalVariable().contextUser+"-"+Date.now(),nresults:100,delta_time_interval:300,tenant:s.getGlobalVariable().tenant,select_predicate:["resourceid","ds6w:identifier","ds6w:label","ds6w:type","ds6w:modified","ds6w:created","preview_url","type_icon_url","ds6w:responsible","owner","ds6w:docextension","ds6w:organizationResponsible","ds6w:status","ds6w:responsible_value","ds6w:responsible:snippet","ds6wg:revision","ds6w:project","ds6w:project_value"],select_file:["icon","thumbnail_2d"],login:{"3dspace":{SecurityContext:s.getGlobalVariable().getSecurityContext()}}},i={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},timeout:6e5,onComplete:function(n){try{var a=JSON.parse(n);e(a)}catch(e){t(e)}},onFailure:t,data:JSON.stringify(n)},r=s.getGlobalVariable().federatedURL+"/recent?tenant="+s.getGlobalVariable().tenant+"&_="+Date.now();a.authenticatedRequest(r,i)})},federatedSearch:function(e,t){return new Promise(function(n,i){var r={label:window.widget.name+"-"+s.getGlobalVariable().contextUser+"-"+Date.now(),query:e,nresults:200,tenant:s.getGlobalVariable().tenant,select_predicate:t,login:{"3dspace":{SecurityContext:s.getGlobalVariable().getSecurityContext()}}},o={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},timeout:6e5,onComplete:function(e){try{var t=JSON.parse(e);n(t)}catch(e){i(e)}},onFailure:i,data:JSON.stringify(r)},l=s.getGlobalVariable().federatedURL+"/search?tenant="+s.getGlobalVariable().tenant+"&_="+Date.now();a.authenticatedRequest(l,o)})},fetchbyService:function(e){let t=e.ids,n=e.url.trim();n+="?include=ds6w:icon,ds6w:kind,ds6w:previewURL,ds6w:resourceType";var i={method:"POST"};i.headers={Accept:"application/json","Content-Type":"application/json",SecurityContext:s.getGlobalVariable().getSecurityContext(),"Accept-Language":widget.getValue("lang")};var r={data:[]};return t.forEach(e=>{var t={"ds6w:i3dx":e};r.data.push(t)}),i.data=JSON.stringify(r),new Promise(function(e,t){window.widget;var r={method:"POST",headers:i.headers,timeout:6e5,onComplete:function(n){try{var a=JSON.parse(n);e(a)}catch(e){t(e)}},onFailure:t,data:i.data};a.authenticatedRequest(n,r)})},showNotification:function(e,t,n,a,i,r,o){var s={level:e,title:t,subtitle:n,message:a,sticky:i,allowUnsafeHTML:o||!1};window.notifs||(window.notifs=u,d.setNotificationManager(window.notifs)),r?d.inject(r):d.elements.container.isInjected()||d.inject(),window.notifs.addNotif(s)},coSubTypesFetched:function(){var e=this;return new Promise(function(t,n){null!=s.getGlobalVariable().changeOrderSubTypes?t():e.fetchCOSubTypes(t,n)})},parseObjectInformation:function(e){for(var t=[],a=!1,r=0;r<e.length;r++)e[r].serviceId?!("3DSPACE"!=e[r].serviceId.toUpperCase()||e[r].objectId&&e[r].objectId.contains(":"))||e[r].i3dx&&""!=e[r].i3dx.trim()?t.push({id:e[r].i3dx?e[r].i3dx:e[r].objectId,type:e[r].objectType,service:e[r].serviceId,updateAction:"CONNECT"}):(a=!0,console.log("Service: "+e[r].serviceId+" objectId:"+e[r].objectId+"droppedItemArr[0].i3dx:"+e[r].i3dx)):(a=!0,console.log("Service: "+e[r].serviceId+" objectId:"+e[r].objectId+"i3dx:"+e[r].i3dx));return a&&(n.warn(i.CHG_GOV_MISSING_INFO_WARNING),console.log("Objects with missing Service or i3dx information will be skipped")),t},fetchCOSubTypes:function(e){var t=this;S.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",'["Change Order"]',function(n){if(Object.keys(n).length>1){s.getGlobalVariable().changeOrderSubTypes=[];var a=[];Object.keys(n).forEach(function(e){var n=t.fetchNLSForCOSubType(e);a.push(n)}),Promise.all(a).then(function(){s.getGlobalVariable().changeOrderSubTypePresent=!0;var t=[],n=0;Object.keys(s.getGlobalVariable().changeOrderSubTypes).forEach(function(e){var a=s.getGlobalVariable().changeOrderSubTypes[e];t[n]={label:a,value:e},n++}),t.sort(function(e,t){return e.label.toUpperCase()>t.label.toUpperCase()?1:-1}),s.getGlobalVariable().changeOrderSubTypes=t,null!=e&&e()})}else if(1==Object.keys(n).length){var i=Object.keys(n),r={};r[i[0]]=i[0],s.getGlobalVariable().changeOrderSubTypePresent=!1,s.getGlobalVariable().changeOrderSubTypes=[],s.getGlobalVariable().changeOrderSubTypes.push(r),null!=e&&e()}else null!=e&&e()},function(t){s.getGlobalVariable().changeOrderSubTypePresent=!1,null!=e&&e()},!0)},fetchNLSForCOSubType:function(e){return new Promise(function(t,n){var a="/resources/dictionary/class/"+e+"/attributes";S.makeWSCall(a,"GET","enovia","application/json","",function(n){UWA.is(n.NLSName)&&""!=n.NLSName?s.getGlobalVariable().changeOrderSubTypes[e]=n.NLSName:s.getGlobalVariable().changeOrderSubTypes[e]=e,t()},function(n){s.getGlobalVariable().changeOrderSubTypes[e]=e,t()},!0)})},crSubTypesFetched:function(){var e=this;return new Promise(function(t,n){null!=s.getGlobalVariable().changeRequestSubTypes?t():e.fetchCRSubTypes(t,n)})},fetchCRSubTypes:function(e){var t=this;S.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",'["Change Request"]',function(n){if(Object.keys(n).length>1){s.getGlobalVariable().changeRequestSubTypes=[];var a=[];Object.keys(n).forEach(function(e){var n=t.fetchNLSForCRSubType(e);a.push(n)}),Promise.all(a).then(function(){s.getGlobalVariable().changeRequestSubTypePresent=!0;var t=[],n=0;Object.keys(s.getGlobalVariable().changeRequestSubTypes).forEach(function(e){var a=s.getGlobalVariable().changeRequestSubTypes[e];t[n]={label:a,value:e},n++}),t.sort(function(e,t){return e.label.toUpperCase()>t.label.toUpperCase()?1:-1}),s.getGlobalVariable().changeRequestSubTypes=t,null!=e&&e()})}else if(1==Object.keys(n).length){var i=Object.keys(n),r={};r[i[0]]=i[0],s.getGlobalVariable().changeRequestSubTypePresent=!1,s.getGlobalVariable().changeRequestSubTypes=[],s.getGlobalVariable().changeRequestSubTypes.push(r),null!=e&&e()}else null!=e&&e()},function(t){s.getGlobalVariable().changeRequestSubTypePresent=!1,null!=e&&e()},!0)},fetchNLSForCRSubType:function(e){return new Promise(function(t,n){var a="/resources/dictionary/class/"+e+"/attributes";S.makeWSCall(a,"GET","enovia","application/json","",function(n){UWA.is(n.NLSName)&&""!=n.NLSName?s.getGlobalVariable().changeRequestSubTypes[e]=n.NLSName:s.getGlobalVariable().changeRequestSubTypes[e]=e,t()},function(n){s.getGlobalVariable().changeRequestSubTypes[e]=e,t()},!0)})},fetchAllChangeSubTypes:async function(){var e=[],t=await S.caSubTypesFetched(),n=await S.iaSubTypesFetched(),a=await S.coSubTypesFetched(),i=await S.crSubTypesFetched();return e.push(t),e.push(n),e.push(a),e.push(i),e},initializeCommonInfra:async function(){var e=o.getUser(),t=s.getGlobalVariable();t.tenant||(t.tenant=widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"),e&&(t.contextUser=e.login);try{return await S.populate3DSpaceURL(),await h.initialize({prefix:"CHG",storage:s.getGlobalVariable()}),await h.fetchUserPreference(v.preferences),await S.populateSecurityContext(),await S.fetchAllChangeSubTypes(),await S.getCSRFToken(),Promise.resolve()}catch(e){return Promise.reject(e)}}};return S}),define("DS/ENOChgServices/scripts/services/ChgReferentialServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgInfraService"],function(e,t){"use strict";return{addReferentialToCA:function(e,n,a,i){var r="/resources/modeler/change/changeaction/"+n;t.makeWSCall(r,"PUT","enovia","application/json",e,a,i)},removeReferentialFromCA:function(e,n,a,i){var r="/resources/modeler/change/changeaction/"+n;t.makeWSCall(r,"PUT","enovia","application/json",e,a,i)},getCAReferentialData:function(e){return new Promise(function(n,a){var i="/resources/modeler/change/changeaction/"+e+"?referentials=1";t.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})}}}),define("DS/ENOChgServices/scripts/services/ChgIDCardHeaderServices",["UWA/Core","DS/UIKIT/Mask","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/ENOChgServices/scripts/services/ChgErrors","DS/LifecycleCmd/MaturityCmd","DS/PlatformAPI/PlatformAPI","text!DS/ENOChgServices/assets/ChangeActionMapping.json","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS"],function(e,t,n,a,i,r,o,s,l,c){"use strict";return{populateCOSearchResults:function(e,t,a){if(n.getGlobalVariable().isNative){for(var i=t.split("~"),r=[],o=0;o<i.length;o++)r.push(i[o]);for(var s=[],l=0;l<i.length;l++)s.push(r[l].split(","));t=s}var c=jQuery(".modal-footer")[0];c&&(c.childNodes[0].disabled=!1);var u=e.substr(0,e.indexOf("_")),d=document.getElementById(u),p=document.getElementById(u+"_hidden"),g="",f="",m=d.value.split(",");!a&&t.length>1&&(t=t.slice(0,1));for(o=0;o<t.length;o++){var h=t[o];(a&&-1==m.indexOf(h[1])||!a)&&(""!=g&&(g+=","),g+=h[1],""!=f&&(f+=","),f+=h[0])}a?(""!=g&&(""!=d.value?d.value=d.value+","+g:d.value=g),""!=f&&(""!=p.value?p.value=p.value+","+f:p.value=f)):(d.value=g,p.value=f)},getCompletedTaskDetails:function(e){return new Promise(function(t,n){var i="/resources/modeler/change/inboxtask/"+e;a.makeWSCall(i,"GET","enovia","application/json","",function(e){var n={};n.completedTaskDetail=e,t(n)},null,!1)})},getTaskDetails:function(e){return new Promise(function(t,n){var i="/resources/modeler/change/inboxtask/retrieveForUser/"+e;a.makeWSCall(i,"GET","enovia","application/json","",function(e){var n={};n.taskDetail=e,t(n)},null,!1)})},createLifecycleSpanContent:function(t){var n=this,a=e.extendElement(document.body).getElement("#lifecycleSpan");if(a){a.empty();t.get("current");var i=t.get("currentDisplay"),r=t.get("holdStatus"),o="cursorPointer",s="a",l=t.get("userAccess"),u=!0,d=!0;l&&(u="true"===l.Promote,d="true"===l.Demote),"true"!==r&&(u||d)||("true"===r&&(i=i+" ["+c.CHG_CA_Hold_State+"] "),o="cursorDefault",s="text");var p={hold:"true"===r,promote:u,demote:d},g=[];t.set("objectId",t.get("id")),g.push(t);var f=!1;a.addContent({tag:"span",html:[{tag:"label",text:c.ECM_CA_Maturity_State+" : "},{tag:"span",html:"&nbsp;&nbsp;"},{tag:s,text:i,id:"ca_header_maturity",class:o,events:{click:function(){setTimeout(function(){f||n.changeMaturity(g,t,p),f=!0},500)}}}]})}else;},changeMaturity:function(e,t,a){if(!(!a||a&&a.hold||a&&!a.promote&&!a.demote))if(n.getGlobalVariable().isNative)if("In Work"===t.get("current")){var r={stateName:""};r.caPhysicalId=t.id.replace("pid:","");var o=JSON.stringify(r);i.DispatchEventToWin("CA_MoveFrm_InWork",o)}else this.changeMaturityExecute(e,t);else this.changeMaturityExecute(e,t)},changeMaturityExecute:function(e,a){var i=[],r=[];e.forEach(function(e){var t=e.get("objectId");null!=t&&null!=t&&""!=t||(t=e.get("id")),r.push(t),i.push({physicalid:t.substring(4)})});var l={securityContext:{SecurityContext:n.getGlobalVariable().getSecurityContext(),tenant:n.getGlobalVariable().tenant},getSecurityContext:function(){return this.securityContext}};new o({context:l,ID:"MaturityHdr"}).executeAsync(i).then(function(){var e={};t.mask(widget.body),e.onComplete=function(e){t.unmask(widget.body),t.unmask(widget.body);var n={id:e.id,maturity:e.get("current"),groupId:e.get("groupid")};s.publish("ca-IDCard-on-change-maturity",n)},a.fetch(e),console.log("Maturity  updated")})},getCAthumbnailUrl:function(e){for(var t=e.get("referentials").toArray(),n="",a=JSON.parse(l).IMAGE,i=t.length-1;i>=0;i--){var r=null!=t[i]&&null!=t[i].get("fileExtension")?t[i].get("fileExtension").slice(1):"temp";if(a.includes(r.toUpperCase())){n=i;break}}return""!==n?t[n].get("image"):e.get("image")},getCAThumbnailUrl:function(e,t){for(var n=e.get("referentials").toArray(),a="",i=JSON.parse(l).IMAGE,r=n.length-1;r>=0;r--){var o=null!=n[r]&&null!=n[r].get("fileExtension")?n[r].get("fileExtension").slice(1):"temp";if(i.includes(o.toUpperCase())){a=r;break}}return""!==a?n[a].get("image"):e.get("image")},promoteChangeAction:function(e,t){return new Promise(function(n,i){var o='{ "data" : [{ "physicalid":"'+e+'","tostate":"'+t+'"}]}';a.makeWSCall("/resources/lifecycle/maturity/promote","POST","enovia","application/json",o,function(t){if(null!=t.status&&""!=t.status&&"failure"==t.status)r.error(t.report[0].error);else if(null!=t.status&&""!=t.status&&"success"==t.status)var a={id:e,maturity:t.results[0].current};n(a)},function(e,t){r.error(e),i(e)},!1)})}}}),define("DS/ENOChgServices/scripts/services/ChgContextServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgInfraService"],function(e,t){"use strict";return{addContextToCA:function(e,n,a,i){var r="/resources/modeler/change/changeaction/"+n;t.makeWSCall(r,"PUT","enovia","application/json",e,a,i,!0)},removeContextFromCA:function(e,n,a,i){var r="/resources/modeler/change/changeaction/"+n;t.makeWSCall(r,"PUT","enovia","application/json",e,a,i,!0)},getCAContextData:function(e){return new Promise(function(n,a){var i="/resources/modeler/change/changeaction/"+e+"?context=1";t.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})}}}),define("DS/ENOChgServices/scripts/services/ChgProposedServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,n){"use strict";var a={getCAProposedData:function(e){return new Promise(function(n,a){var i="/resources/modeler/change/changeaction/"+e+"?proposed=1&flowdown=1&attributes=1&context=1";t.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getCAFlowdownData:function(e){return new Promise(function(n,a){var i="/resources/modeler/change/changeaction/"+e+"?flowdown=1&attributes=1";t.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getDataForProposedFacet:function(e){var t=this;return new Promise(function(n,i){var r=t.getCAProposedData(e),o={context:[],proposedData:[]},s=[],l=[],c=[],u=[];r.then(function(e){e&&e.changeaction&&(e.changeaction.context&&(o.context=e.changeaction.context),e.changeaction.proposed&&(s=e.changeaction.proposed,o.proposedData=o.proposedData.concat(e.changeaction.proposed)),e.changeaction.flowdownActivities&&(l=a._getFlowdownOperations(e.changeaction.flowdownActivities),c=e.changeaction.flowdownActivities,u=e.changeaction.flowdownIgnoreds,o.proposedData=o.proposedData.concat(l),a.cachedFlowdownModels=l)),t.mapping=a._mappedForSlidein(s,c,u),n(o)})})},getSupportedOperations:function(){return"None,NewVersion,NewMinorVersion,NewEvolution,Create,Restore"},getSupportedActivities:function(){return"Modify,Release,Obsolete"},getAllowedOperationActivity:function(e,n,a){var i=this;return new Promise(function(r,o){if(e&&e.length>0){var s=[];if(a&&1==e.length){var l={existingProposedPid:a,objectPid:e[0]};s.push(l)}else for(var c in e){l={objectPid:e[c]};s.push(l)}var u={getOperationForPhysicalIds:s,changeactionid:n};u=JSON.stringify(u);t.makeWSCall("/resources/modeler/change/operation/fromIds","POST","enovia","application/json",u,function(e){var t,n=new Object;UWA.is(e)&&UWA.is(e.listOfOperationPerObject)&&e.listOfOperationPerObject.forEach(function(e){(t=new Object).allowedOperation=[],t.allowedActivity=[],t.defaultOperation="None",t.defaultActivity=void 0,e.allowedOperation.forEach(function(n){-1!=i.getSupportedOperations().indexOf(n)?t.allowedOperation.push(n):-1!=i.getSupportedActivities().indexOf(n)&&t.allowedActivity.push(n),t.allowedOperation.includes("Restore")&&(e.defaultOperation="None",t.allowedActivity.includes("Modify")||t.allowedActivity.push("Modify"))}),UWA.is(e.defaultOperation)&&-1!=i.getSupportedOperations().indexOf(e.defaultOperation)?t.defaultOperation=e.defaultOperation:UWA.is(e.defaultOperation)&&-1!=i.getSupportedActivities().indexOf(e.defaultOperation)&&(t.defaultActivity=e.defaultOperation),n[e.id.replace("pid:","")]=t});var a={};a.allowedOperationActivity=n,r(a)},o,!1)}else r(!0)})},addProposedFromFlowdownPanel:function(e){if(UWA.is(e)){var t=e.proposedArrToAdd;if(t)Object.keys(t)}},setFlowdownMapping:function(e){if(this.flowdownMapping={},UWA.is(e)){var t=e.proposedArrToAdd;if(t){var n=t.map(function(e){return"pid:"+e.proposedId});for(var a in n){var i=n[a];i&&""!=i&&(this.flowdownMapping[i]={flowdownForObjectId:e.proposedArrToAdd[i].flowdownForObjectId,flowdownForObjectTitle:e.proposedArrToAdd[i].flowdownForObjectTitle,flowdownForObjectType:e.proposedArrToAdd[i].flowdownForObjectType,flowdownForObjectTypeNLS:e.proposedArrToAdd[i].flowdownForObjectTypeNLS},e.moreInfo.length>1?this.flowdownMapping[i].moreInfo=e.moreInfo:(this.flowdownMapping[i].upstreamCAId=e.moreInfo[0].caID,this.flowdownMapping[i].upstreamCATitle=e.moreInfo[0].caTitle))}}}},setFlowdownForandFromMappingAndReturnProposedIds:function(e){this.flowdownForandFromMapping={};var t={forFlowdownOp:[],selectedProposedIds:[]};if(UWA.is(e)){var n=Object.keys(e.proposedArrToAdd);for(var a in n){var i=n[a],r=e.proposedArrToAdd[i];if(r){var o=r.selectedItems;if(o)for(var s in o){var l=o[s];l&&(l.fromAddResolutionTab?t.forFlowdownOp.push("pid:"+l.proposedId):t.selectedProposedIds.push("pid:"+l.proposedId),this.flowdownForandFromMapping["pid:"+l.proposedId]={flowdownForObjectId:i,flowdownForObjectTitle:r.objTitle,flowdownForObjectType:r.objType,flowdownForObjectTypeNLS:r.objTypeNLS,upstreamCAId:e.moreInfo.caID,upstreamCATitle:e.moreInfo.caTitle,upstreamAMOId:r.amoID})}}}}return t},getFlowdownForandFromMapping:function(){return this.flowdownForandFromMapping},getFlowdownMapping:function(){return this.flowdownMapping},getCachedFlowdownData:function(){return a.cachedFlowdownModels},_getFlowdownOperations:function(e){var t=[];for(var n in e){var a=e[n];if(UWA.is(a)){var i=a.flowdownElements,r=a.flowdownResolutions,o=(i.map(function(e){return e.elementPointedId}),i.map(function(e){return e.elementIdentifier}));if(r.length>0)for(var s in r){var l=r[s];UWA.is(l)&&o.forEach(function(e,n){-1!=l.resolutionValidIdentifiers.indexOf(e)?l.resolutionObject&&t.push(a):"Flowdown Pending"===i[n].elementStatus&&t.push(a),-1!=l.resolutionRejectedIdentifiers.indexOf(e)&&"Rejected"===i[n].elementStatus&&l.resolutionObject&&t.push(a)})}0===r.length&&t.push(a)}}return t},_mappedForSlidein:function(e,t,n){var i=[],r={};for(var o in t){var s=t[o];if(UWA.is(s)){var l=s.flowdownElements,c=s.flowdownResolutions;if(Array.isArray(c)&&c.length>0){var u=[],d=[],p=[];for(var g in l){var f=l[g];if(f){u.push(f.elementPointedId),d.push(f.elementIdentifier),p.push(f.elementPointedCAId);var m={amoID:f.elementPointedId,caID:f.elementPointedCAId,caTitle:f.elementPointedCATitle,caName:f.elementPointedCAName,flowdownStatus:f.elementStatus};"Complete"!==f.elementStatus&&"Flowdown Complete"!==f.elementStatus||(m.flowdownStatus="Flowdown Complete"),("Complete"!==f.elementStatus&&"Flowdown Complete"!==f.elementStatus||"Updated"!==f.elementSyncStatus)&&"Transferred"!==f.elementSyncStatus||(m.flowdownStatus="Flowdown Pending"),"Started"===f.elementStatus&&(m.flowdownStatus="Flowdown Pending"),"Rejected"===f.elementStatus&&(m.flowdownStatus="Flowdown Pending"),r[f.elementIdentifier]=m}}for(var h in c){var v=c[h];UWA.is(v)&&d.forEach(function(t){if(-1!=v.resolutionValidIdentifiers.indexOf(t))if(v.resolutionObject)i.push(s),r[t]&&(r[t].resolution||(r[t].resolution=[]),r[t].resolution.push({objectData:v.resolutionObject}),r[t].directResolution=!0,r[t].proposedResolution=!1);else{var n=v.resolutionPointedId;for(var a in e){var o=e[a];if(o)if(o.id===n){r[t].resolution||(r[t].resolution=[]),r[t].resolution.push({proposedId:n,objectData:o.where}),r[t].directResolution=!1,r[t].proposedResolution=!0,o.flowdownInfo||(o.flowdownInfo={flowdownFor:[],flowdownFrom:[]}),o.flowdownInfo.flowdownFor.push(s.where);var l={caID:r[t].caID,caTitle:r[t].caTitle,caName:r[t].caName};o.flowdownInfo.flowdownFrom.push(l)}}}-1!=v.resolutionRejectedIdentifiers.indexOf(t)&&v.resolutionObject&&(i.push(s),r[t]&&(r[t].resolution||(r[t].resolution=[]),r[t].resolution.push({objectData:v.resolutionObject}),r[t].directResolution=!0,r[t].proposedResolution=!1))})}}Array.isArray(c)&&0===c.length&&(r=a.setDirectResolvedPropsoed(s,r))}}for(var C in n){var S=n[C];UWA.is(S)&&(r[S.elementIdentifier]={amoID:S.elementPointedId,caID:S.elementPointedCAId,caTitle:S.elementPointedCATitle,caName:S.elementPointedCAName,flowdownStatus:"Ignored"})}return r},getFlowdownMappingForSlideIn:function(){return this.mapping},setDirectResolvedPropsoed:function(e,t){if(UWA.is(e)){var n=e.flowdownElements;for(var a in n){var i=n[a];i&&(t[i.elementIdentifier]={amoID:i.elementPointedId,caID:i.elementPointedCAId,caTitle:i.elementPointedCATitle,caName:i.elementPointedCAName,flowdownStatus:i.elementStatus},"Flowdown Pending"!==i.elementStatus&&"Flowdown Complete"!==i.elementStatus&&"Started"!==i.elementStatus&&"Complete"!==i.elementStatus||(t[i.elementIdentifier].resolution||(t[i.elementIdentifier].resolution=[]),t[i.elementIdentifier].resolution.push({objectData:e.where}),t[i.elementIdentifier].directResolution=!0,t[i.elementIdentifier].proposedResolution=!1))}}return t}};return a}),define("DS/ENOChgServices/scripts/services/ChgPropertiesComponentServices",["DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/TreeModel/DataModelSet","DS/UIKIT/Alert","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgErrors","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS"],function(e,t,n,a,i,r,o){"use strict";var s={GetChangeRequired:function(e){return new Promise(function(t,n){var a="pid:"+e,r=[];r.push(a);var o={ObjectsListForGetChangeControl:r};o=JSON.stringify(o);i.makeWSCall("/resources/modeler/change/changecontrol","POST","enovia","application/json",o,function(e){var n={};if(e&&e.objectListChangeControlled){var a=e.objectListChangeControlled[0];a&&(n.CCValue=a.changeControlValue)}e&&e.ChangeData&&(n.ChangeData=e.ChangeData[0]),e&&e.GroupChangeData&&(n.GroupChangeData=e.GroupChangeData[0]),t(n)},null)})},SetUnsetChangeRequired:function(e,t){return new Promise(function(n,a){var o="pid:"+e,s=[];s.push(o);var l={};l="Set"==t?{ObjectsListForSetChangeControl:s}:{ObjectsListForUnSetChangeControl:s},l=JSON.stringify(l);i.makeWSCall("/resources/modeler/change/changecontrol","PUT","enovia","application/json",l,function(e){var t={};if(e&&e.objectListChangeControlled){var a=e.objectListChangeControlled[0];a&&(t.CCValue=a.changeControlValue)}e&&e.ChangeData&&(t.ChangeData=e.ChangeData[0]),n(t)},function(e,t){r.error(t.errorMessage);a({})})})},getImpactedCA:function(e){return new Promise(function(t,n){var a="pid:"+e,r=[];r.push(a);var o={};o={"impacted items":r},o=JSON.stringify(o);i.makeWSCall("/resources/modeler/change/impactAnalysis","POST","enovia","application/json",o,function(e){var n={};e.object[0].impacting&&(n=e.object[0].impacting["complete ca"][0]),t(n)},null)})},getRouteFromChangeAction:function(e){return new Promise(function(t,n){var a="/resources/modeler/change/changeaction/"+e+"?lastApprovalRoute=1";i.makeWSCall(a,"GET","enovia","application/json","",function(e){var n={};n.lastApproveRoute=e.changeaction.lastApprovalRoute,t(n)},null,!1)})},getRouteDetails:function(e){return new Promise(function(t,n){var a="/resources/v1/modeler/routes/"+(e=e.replace("pid:",""))+"/tasks";i.makeWSCall(a,"GET","enovia","application/json","",function(e){var n={};n.routeInfo=e,t(n)},null,!1)})},checkIfObjectIsConfigurableAndHasConfigContext:function(e){return new Promise(function(t,n){var a={version:"1.0",pidList:[e]};a=JSON.stringify(a),i.makeWSCall("/resources/modeler/configuration/navigationServices/getMultipleConfigurationContextInfo","POST","enovia","application/ds-json",a,function(e){t(e)},function(e){t({})},!1)})},getConfiguredObjectInfo:function(e){return new Promise(function(t,n){s.checkIfObjectIsConfigurableAndHasConfigContext(e).then(function(e){if(e&&e.referencesInfo&&"YES"==e.referencesInfo[0].isConfigurable&&"YES"==e.referencesInfo[0].hasConfigContext){var n={error:o.ECM_CONFIGURED_DATA_ERR};t(n)}else t({})})})},getCADetails:function(e){return new Promise(function(t,n){var a="/resources/modeler/change/changeaction/"+e+"?people=1&attributes=1&referentials=1";i.makeWSCall(a,"GET","enovia","application/json","",function(e){t(e)},n,!1)})},buildApprovalSummaryDataGridModel:function(t){var a=new n,i=new e({dataModelSet:a,useAsyncPreExpand:!0});return t.forEach(function(e){var t=s.createTreeModel(a,e);i.addChild(t)}),i.prepareUpdate(),i.pushUpdate(),i},createTreeModel:function(e,n){return new t.createTreeNodeDataModel(e,{label:n.get("taskName"),children:[],icons:[],grid:{order:n.get("order"),title:n.get("taskTitle"),approver:n.get("taskApprover"),status:n.get("approvalStatus"),comments:n.get("approvalComments"),approvalDate:n.get("actualComplDate")}})},getChangeActionForGrop:function(e){return new Promise(function(t,n){var a="/resources/modeler/change/group/"+e+"?";i.makeWSCall(a,"GET","enovia","application/json","",function(e){t(e)},n,!1)})}};return s}),define("DS/ENOChgServices/scripts/services/ChgMembersServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService"],function(e,t,n){"use strict";return{reviewerType:{typeOfReviewer:"",labelSelected:!1},addPersonToCA:function(e,t,a,i){var r="";t&&(r="/resources/modeler/change/changeaction/"+t),""!=r&&n.makeWSCall(r,"PUT","enovia","application/json",e,a,i)},removePersonFromCA:function(e,t,a,i){var r="";null!=t&&(r="/resources/modeler/change/changeaction/"+t),""!=r&&n.makeWSCall(r,"PUT","enovia","application/json",e,a,i)},getSuggestionsForRoutesAndMembers:function(e){var t=this,n=e.members?e.members:null;if(n){var a=!1;n.forEach(function(e){e.get("role").indexOf("reviewer")>=0&&(a=!0,t.reviewerType.typeOfReviewer=e.get("type"))}),a||!1!==t.reviewerType.labelSelected||(t.reviewerType.typeOfReviewer="")}this.getSuggestions(e).then(function(t){e.onComplete(t)},function(e){return console.log("Issue in retrieving members"),Promise.reject(e)})},getSuggestions:function(e){var a=e.text,i=e.categoryId,r=e.contextUser,o=this;return new Promise(function(e,s){a.contains("*")||(a+="*");var l="";o.CurrModel;l="reviewer"!==i||"reviewer"===i&&"Person"===o.reviewerType.typeOfReviewer?'(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active" AND fullname:"'+a+'")':"reviewer"===i&&"Route Template"===o.reviewerType.typeOfReviewer?o.getQueryParameterForRouteTemplate(r)+" AND name:"+a+")":o.getQueryParameterForRouteTemplate(r)+" AND name:"+a+') OR (flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active" AND fullname:"'+a+'")';let c={"3dspace":{SecurityContext:t.getGlobalVariable().getSecurityContext()}};var u={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname"],select_file:["icon","thumbnail_2d"],query:l,order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:t.getGlobalVariable().tenant,login:c},d=(u=JSON.stringify(u),{isfederated:!0});n.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",u,function(t){var n=[];t&&t.results&&Array.isArray(t.results)&&t.results.forEach(function(e){var t={};e.attributes.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(t.type=e.value),"resourceid"===e.name&&(t.id=e.value),"ds6w:identifier"===e.name&&(t.identifier=e.value),"Person"===t.type?"ds6wg:fullname"===e.name&&(t.name=e.value):"ds6w:identifier"===e.name&&(t.name=e.value)}),n.push(t)});e(n)},function(e){s(e)},d)})},getListMember:function(e){var a=e.categoryId,i=e.contextUser,r=this;return new Promise(function(e,o){var s="",l=!1,c=!1;if("true"===t.getGlobalVariable().ECM_SearchRouteTemplateEnforcementForCA&&(l=!0),"true"===t.getGlobalVariable().ECM_EnableRouteTemplateEnforcementForCA&&(c=!0),"follower"===a||"assignee"===a){s='(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active")',s+="OnPremise"==t.getGlobalVariable().tenant?' OR (flattenedtaxonomies:"types/Group" AND current:"active")':" OR ([ds6w:type]:(Group))"}else s="reviewer"!==a||"reviewer"===a&&"Person"===r.reviewerType.typeOfReviewer?'(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active" )':"reviewer"===a&&"Route Template"===r.reviewerType.typeOfReviewer?r.getQueryParameterForRouteTemplate(i):"reviewer"===a&&l&&c?r.getQueryParameterForRouteTemplate(i):r.getQueryParameterForRouteTemplate(i)+' OR (flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active" )';let u={"3dspace":{SecurityContext:t.getGlobalVariable().getSecurityContext()}};var d={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname"],select_file:["icon","thumbnail_2d"],query:s,order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:t.getGlobalVariable().tenant,login:u},p=(d=JSON.stringify(d),{isfederated:!0});n.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",d,function(n){var a=[];if(n&&n.results&&Array.isArray(n.results)){var i=n.results;"OnPremise"==t.getGlobalVariable().tenant?i.forEach(function(e){var t={};e.attributes.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(t.type=e.value),"resourceid"===e.name&&(t.id=e.value),"ds6w:identifier"===e.name&&(t.identifier=e.value),"Person"===t.type?"ds6wg:fullname"===e.name&&(t.name=e.value):"ds6w:label"===e.name&&(t.name=e.value)}),a.push(t)}):i.forEach(function(e){var t={};e.attributes.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(t.type=e.value,t.type.includes("foaf")&&(t.type=t.type.slice(5))),"resourceid"===e.name&&(t.id=e.value),"ds6w:identifier"===e.name&&(t.identifier=e.value),"Person"===t.type?"ds6wg:fullname"===e.name&&(t.name=e.value):"ds6w:label"===e.name&&(t.name=e.value)}),a.push(t)})}e(a)},function(e){o(e)},p)})},getListCOMember:function(e){var a=e.categoryId,i=e.contextUser,r=this;return new Promise(function(e,o){var s="";if("follower"===a||"assignee"===a){s='(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active")',s+="OnPremise"==t.getGlobalVariable().tenant?' OR (flattenedtaxonomies:"types/Group" AND current:"active")':" OR ([ds6w:type]:(Group))"}else s="changeCordinator"===a?'(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active"  AND (userrole:"Change Coordinator" OR userrole:"VPLMProjectLeader"))':r.getQueryParameterForRouteTemplate(i);let l={"3dspace":{SecurityContext:t.getGlobalVariable().getSecurityContext()}};var c={with_indexing_date:!0,with_nls:!1,label:"yus-1515078503005",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6wg:fullname"],select_file:["icon","thumbnail_2d"],query:s,order_by:"desc",order_field:"relevance",nresults:1e3,start:"0",source:[],tenant:t.getGlobalVariable().tenant,login:l},u=(c=JSON.stringify(c),{isfederated:!0});n.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",c,function(n){var a=[];n&&n.results&&Array.isArray(n.results)&&n.results.forEach(function(e){var n={},i=e.attributes;"OnPremise"==t.getGlobalVariable().tenant?i.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(n.type=e.value),"resourceid"===e.name&&(n.id=e.value),"ds6w:identifier"===e.name&&(n.identifier=e.value),"Person"===n.type?"ds6wg:fullname"===e.name&&(n.name=e.value):"ds6w:label"===e.name&&(n.name=e.value)}):i.forEach(function(e){"ds6w:what/ds6w:type"===e.name&&(n.type=e.value,n.type.includes("foaf")&&(n.type=n.type.slice(5))),"resourceid"===e.name&&(n.id=e.value),"ds6w:identifier"===e.name&&(n.identifier=e.value),"Person"===n.type?"ds6wg:fullname"===e.name&&(n.name=e.value):"ds6w:label"===e.name&&(n.name=e.value)}),a.push(n)});e(a)},function(e){o(e)},u)})},_addFullNameToPersonObject:function(e,t){var n=e.changeaction.people;Array.isArray(n)&&n.forEach(function(e){var n=e.name;if(t&&t[n]){var a=t[n].userDisplayName;e.fullName=a,e.id=t[n].id}})},getAvatarDetails:function(e){var t={},n="",a=[[7,139,250],[249,87,83],[111,188,75],[158,132,106],[170,75,178],[26,153,123],[245,100,163],[255,138,46]],i=e.split(" "),r=i[0].charAt(0),o=i[i.length-1];o&&(n=o.charAt(0));var s=r+n,l=Math.ceil((r.charCodeAt(0)+n.charCodeAt(0))%a.length),c="rgb("+a[l][0]+","+a[l][1]+","+a[l][2]+")";return t.name=e,t.avatarStr=s,t.avatarColor=c,t},getFormatedMemberDetails:function(e){var t=[];return e.forEach(function(e){var n={};n.id=e.get("id"),n.rolesToDisplay=e.get("rolesToDisplay"),n.fullName=e.get("fullName"),n.userName=e.get("userName"),n.type=e.get("type"),n.role=e.get("role"),t.push(n)}),t},createMemberList:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].name);return t},processedMemberListWithName:function(e){for(var t=e.processList,n=0;n<t.members.length;n++){var a=t.members[n];a.fullname=e[a.name].userDisplayName}return t},getQueryParameterForRouteTemplate:function(e){return'(flattenedtaxonomies:"types/Route Template" AND (route_95_base_95_purpose:"Approval" OR (route_95_base_95_purpose:"Standard" AND bo_46_route_46_template_46_isstandard:"true")) AND (route_95_template_95_availability: "Enterprise" OR route_95_template_95_availability: "'+e+'" ) AND policycurrent:"Route Template.Active"AND route_95_completion_95_action:"Promote Connected Object" AND latestrevision:"TRUE")'}}}),define("DS/ENOChgServices/scripts/services/ChgDataService",["DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChangeActionUX/scripts/CASpinner"],function(e,t,n){"use strict";var a={updateRealizedActivityDescription:function(t,n,a){return new Promise(function(i,r){var o="/resources/v1/chguxservices/changeaction/"+t+"/realizedChanges";let s=JSON.stringify({activity_ids:n,activity_description:a,operation:"setWhy",action:"setWhy"});e.makeWSCallWithCSRF(o,"PUT","enovia","application/json",s,function(e){i(e)},r,!1)})},getCARealizedChanges:function(t,n,a){var i="";return n&&(i=n),new Promise(function(n,r){var o="/resources/v1/chguxservices/changeaction/"+t+"/realizedChanges?realizedFilter="+i+"&lastIndexedTime="+a;e.makeWSCall(o,"GET","enovia","application/json","",function(e){n(e)},function(e){r(e)},!1)})},getCASummary:function(t,n){if(null!=n)var a=n.filterView;return new Promise(function(n,i){if("inactiveCA"==a)var r="/resources/modeler/change/changeactions?contributor=1&reviewer=1&follower=1&states=Complete%7CCancelled&startDate="+t;else r="/resources/modeler/change/changeactions?contributor=1&reviewer=1&follower=1&states=Prepare%7CInWork%7CInApproval%7CApproved%7CComplete%7CCancelled&startDate="+t;e.makeWSCall(r,"GET","enovia","application/json","",function(e){n(e)},i,!1)})},getUserFullNameWithProcessData:function(n,a){return new Promise(function(i,r){var o="";if(Array.isArray(n)&&n.length>0)for(var s=0;s<n.length;s++)""!=o?-1===o.indexOf(n[s])&&(o=o+"%7C"+n[s]):o=n[s];else o=n;t.getGlobalVariable().getSecurityContext();e.makeWSCall("/resources/modeler/change/userdisplayname","GET","enovia","application/json","userNames="+o,function(e){var t={};t.userDisplayName=e,t.processList=a,i(t)},null,!1)})},getTypeIcon:function(t,n){return new Promise(function(a,i){var r={physicalid:n,label:"test",select_predicate:["ds6w:type"]},o=JSON.stringify(r);if(n.length>0)e.makeWSCall("/cvservlet/fetch/v2","POST","enovia","application/json",o,function(e){var n={};n.processedCAListWithFullName=t,n.iconDetails=e,a(n)},function(e){i(e)},!0);else{var s={};s.processedCAListWithFullName=t,s.iconDetails=[],a(s)}})},getCAFDData:function(n,a,i){var r=t.getGlobalVariable().getSecurityContext();if(r=encodeURIComponent(r),null!=i)var o=i.filterView;let s=t.getGlobalVariable().customeViewList,l=["ECM_CHG_ON_HOLD","ECM_CHANGE_REJECTION","ECM_CA_ASSIGNEE","ECM_CA_DIRECT_REVIEWER","ECM_CA_FOLLOWERS","ECM_CA_ATTACHMENT_ID","ECM_ROUTE_TEMPLATE_APPROVERS","ECM_ROUTE_TEMPLATE_LABEL","ECM_CA_ASSIGNEE_FULL_NAME","ECM_CA_DIRECT_REVIEWER_FULL_NAME","ECM_CA_FOLLOWERS_FULL_NAME","owner","current","ds6w:dueDateParametric","ds6w:label","ds6w:type","ds6w:description","ds6w:identifier","ds6w:responsible","ds6w:lastModifiedBy","ds6wg:marketing_Name"];return s.length>0&&null!=s&&(l=[...l,...s]),new Promise(function(i,s){var c=t.getGlobalVariable().contextUser,u={};u=a?"inactiveCA"==o?{with_indexing_date:!0,label:"gn1_Test",locale:"en",select_predicate:l,select_file:["icon","thumbnail_2d"],query:'(flattenedtaxonomies:"types/Change Action" AND  [ds6w:status]:"Cancelled.Cancelled" OR [ds6w:status]:"Change Action.Complete" AND ( owner:'+c+" OR [ECM_CA_ASSIGNEE]:"+c+"  OR [ECM_CA_DIRECT_REVIEWER]:"+c+" OR [ECM_CA_FOLLOWERS]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS]:"+c+" OR [ECM_ROUTE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_APPROVERS]:"+c+"))",login:{"3dspace":{SecurityContext:r}},nresults:100,next_start:a,source:[],tenant:t.getGlobalVariable().tenant}:{with_indexing_date:!0,label:"gn1_Test",locale:"en",select_predicate:l,select_file:["icon","thumbnail_2d"],query:'(flattenedtaxonomies:"types/Change Action" AND NOT [ds6w:status]:"Cancelled.Cancelled" AND NOT [ds6w:status]:"Change Action.Complete" AND ( owner:'+c+" OR [ECM_CA_ASSIGNEE]:"+c+"  OR [ECM_CA_DIRECT_REVIEWER]:"+c+" OR [ECM_CA_FOLLOWERS]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS]:"+c+" OR [ECM_ROUTE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_APPROVERS]:"+c+"))",login:{"3dspace":{SecurityContext:r}},nresults:100,next_start:a,source:[],tenant:t.getGlobalVariable().tenant}:"inactiveCA"==o?{with_indexing_date:!0,label:"gn1_Test",locale:"en",select_predicate:l,select_file:["icon","thumbnail_2d"],query:'(flattenedtaxonomies:"types/Change Action" AND ( [ds6w:status]:"Cancelled.Cancelled" OR [ds6w:status]:"Change Action.Complete") AND ( owner:'+c+" OR [ECM_CA_ASSIGNEE]:"+c+"  OR [ECM_CA_DIRECT_REVIEWER]:"+c+" OR [ECM_CA_FOLLOWERS]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS]:"+c+" OR [ECM_ROUTE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_APPROVERS]:"+c+"))",login:{"3dspace":{SecurityContext:r}},nresults:100,start:0,source:[],tenant:t.getGlobalVariable().tenant}:{with_indexing_date:!0,label:"gn1_Test",locale:"en",select_predicate:l,select_file:["icon","thumbnail_2d"],query:'(flattenedtaxonomies:"types/Change Action" AND NOT [ds6w:status]:"Cancelled.Cancelled" AND NOT [ds6w:status]:"Change Action.Complete" AND ( owner:'+c+" OR [ECM_CA_ASSIGNEE]:"+c+"  OR [ECM_CA_DIRECT_REVIEWER]:"+c+" OR [ECM_CA_FOLLOWERS]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS]:"+c+" OR [ECM_ROUTE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_TEMPLATE_APPROVERS_THROUGH_GROUP]:"+c+" OR [ECM_ROUTE_APPROVERS]:"+c+"))",login:{"3dspace":{SecurityContext:r}},nresults:100,start:0,source:[],tenant:t.getGlobalVariable().tenant},n&&(u.refine={},u.refine=n.allfilters);u=JSON.stringify(u);e.makeWSCall("/search?xrequestedwith=xmlhttprequest","POST","enovia","application/json",u,function(e){i(e)},function(){},{isfederated:!0})})},getTimestamp:function(){return new Promise(function(n,a){var i=t.getGlobalVariable().getSecurityContext(),r="/cvservlet/indexingdate?SecurityContext="+encodeURIComponent(i),o={select_service:["FTS"]};o=JSON.stringify(o);e.makeWSCall(r,"POST","enovia","application/json",o,function(e){n(e)},a,null)})},getCAMembers:function(t){return new Promise(function(n,a){var i="/resources/modeler/change/changeaction/pid:"+t.options.grid.id+"?people=1&referentials=1&tenant=OnPremise";a=function(e){a(e)};e.makeWSCall(i,"GET","enovia","application/json","",function(e){var a={};a.nodeModel=t,a.members=e.changeaction.people,a.routeTemplate=e.changeaction.routeTemplates,a.referentials=e.changeaction.referentials,n(a)},a,null)})},getDocumentImage:function(t){return new Promise(function(n,a){var i={physicalid:t,label:"test",select_predicate:["resourceid","ds6w:identifier","ds6w:type","preview_url","type_icon_url","ds6w:docextension"]},r=JSON.stringify(i);e.makeWSCall("/cvservlet/fetch/v2","POST","enovia","application/json",r,function(e){var t={};t.referentialInfo=e,n(t)},function(e){a(e)},{encodeSecurityContext:"No"})})},getObjectInfo:function(t,n){return new Promise(function(a,i){if(t&&t.length>0){t=t.toString(),n=n&&n.length>0?n.toString():"name";var r="$ids="+t;r+="&$fields="+n;e.makeWSCall("/resources/v2/e6w/service/ObjectInfo","POST","enovia","application/x-www-form-urlencoded",r,function(e){a(e.data)},i,!1)}else a(!0)})},getCAOwnerForTransfer:function(t){return new Promise(function(n,a){var i="/resources/modeler/change/changeaction/pid:"+t+"?people=1&tenant=OnPremise";a=function(e){a(e)};e.makeWSCall(i,"GET","enovia","application/json","",function(e){var a={};a.members=e.changeaction.people,a.caid=t,n(a)},a,null)})},deleteObjectStructure:function(t){return new Promise(function(n,a){var i={data:t,options:[]},r=JSON.stringify(i);e.makeWSCall("/resources/lifecycle/Delete/structure","POST","enovia","application/json",r,function(e){n(e)},a,!1)})},handleContextMenuClickHold:function(t){return new Promise(function(n,a){var i=t.userComment,r="/resources/v1/chguxservices/changeorder/"+t.chgPhysicalId+"/hold",o={data:[{dataelements:{reason:i}}],definitions:[]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){var t={};t.userDisplayName=e,n(t)},null)})},handleContextMenuClickResume:function(t){return new Promise(function(n,a){var i=t.userComment,r="/resources/v1/chguxservices/changeorder/"+t.chgPhysicalId+"/resume",o={data:[{dataelements:{reason:i}}],definitions:[]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){var t={};t.userDisplayName=e,n(t)},null)})},handleContextMenuClickCancel:function(t){return new Promise(function(n,a){var i=t.userComment,r="/resources/v1/chguxservices/changeorder/"+t.chgPhysicalId+"/cancel",o={data:[{dataelements:{reason:i}}],definitions:[]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){var t={};t.userDisplayName=e,n(t)},null)})},handleContextMenuClickHoldForCR:function(t){return new Promise(function(n,a){var i=t.userComment,r="/resources/v1/chguxservices/changerequest/"+t.chgPhysicalId+"/hold",o={data:[{reason:i}]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},handleContextMenuClickResumeForCR:function(t){return new Promise(function(n,a){var i=t.userComment,r="/resources/v1/chguxservices/changerequest/"+t.chgPhysicalId+"/resume",o={data:[{reason:i}]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},handleContextMenuClickCancelForCR:function(t){return new Promise(function(n,a){var i=t.userComment,r="/resources/v1/chguxservices/changerequest/"+t.chgPhysicalId+"/cancel",o={data:[{reason:i}],definitions:[]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},handleContextMenuClickHoldForIR:function(t){return new Promise(function(n,a){var i=t.userComment,r="/resources/v1/chguxservices/investigationRequest/"+t.chgPhysicalId+"/hold",o={data:[{reason:i}]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},handleContextMenuClickResumeForIR:function(t){return new Promise(function(n,a){var i=t.userComment,r="/resources/v1/chguxservices/investigationRequest/"+t.chgPhysicalId+"/resume",o={data:[{reason:i}]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},handleContextMenuClickCancelForIR:function(t){return new Promise(function(n,a){var i=t.userComment,r="/resources/v1/chguxservices/investigationRequest/"+t.chgPhysicalId+"/cancel",o={data:[{reason:i}],definitions:[]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},getChangeOrders:function(){return new Promise(function(t,n){e.makeWSCallWithCSRF("/resources/v1/chguxservices/changeorder","GET","enovia","application/json","",function(e){t(e)},n,!1)})},getConfiguredChangeActionList:function(t){return new Promise(function(n,a){var i="",r="",o="",s="",l="";i=1==t.simplifiedJSON?"$simpleJSON=true":"$simpleJSON=false",t.pageNumber&&(r="&page="+t.pageNumber),t.pageSize&&(o="&pageSize="+t.pageSize),s=1==t.indexed?"&indexed=true":"&indexed=false",t.timestamp&&(l="&lastIndexedTime="+t.timestamp);var c="/resources/v1/chguxservices/changeaction?"+i+r+o+s+l+(null!=t.filter&&"inactiveCA"==t.filter?"&active=false":"&active=true");let u={},d="";t.refine&&(u.refine={},u.refine={data:[t.refine.allfilters]},d="refine="+JSON.stringify(u.refine));e.makeWSCallWithCSRF(c,"POST","enovia","application/x-www-form-urlencoded",d,function(e){n(e)},a,!1)})},getConfiguredChangeOrderList:function(t){return new Promise(function(n,a){var i="",r="",o="",s="",l="";i=1==t.simplifiedJSON?"$simpleJSON=true":"$simpleJSON=false",t.pageNumber&&(r="&page="+t.pageNumber),t.pageSize&&(o="&pageSize="+t.pageSize),s=1==t.indexed?"&indexed=true":"&indexed=false",t.timestamp&&(l="&lastIndexedTime="+t.timestamp);var c="/resources/v1/chguxservices/changeorder?"+i+r+o+s+l+(null!=t.filter&&"inactiveCO"==t.filter?"&active=false":"&active=true");let u={},d="";t.refine&&(u.refine={},u.refine={data:[t.refine.allfilters]},d="refine="+JSON.stringify(u.refine));e.makeWSCallWithCSRF(c,"POST","enovia","application/x-www-form-urlencoded",d,function(e){n(e)},a,!1)})},getConfiguredChangeRequestList:function(t){return new Promise(function(n,a){var i="",r="",o="",s="",l="";i=1==t.simplifiedJSON?"$simpleJSON=true":"$simpleJSON=false",t.pageNumber&&(r="&page="+t.pageNumber),t.pageSize&&(o="&pageSize="+t.pageSize),s=1==t.indexed?"&indexed=true":"&indexed=false",t.timestamp&&(l="&lastIndexedTime="+t.timestamp);var c="/resources/v1/chguxservices/changerequest?"+i+r+o+s+l+(null!=t.filter&&"inactiveCR"==t.filter?"&active=false":"&active=true");let u={},d="";t.refine&&(u.refine={},u.refine={data:[t.refine.allfilters]},d="refine="+JSON.stringify(u.refine));e.makeWSCallWithCSRF(c,"POST","enovia","application/x-www-form-urlencoded",d,function(e){n(e)},a,!1)})},getConfiguredInvestigationRequestList:function(t){return new Promise(function(n,a){var i="",r="",o="",s="",l="";i=1==t.simplifiedJSON?"$simpleJSON=true":"$simpleJSON=false",t.pageNumber&&(r="&page="+t.pageNumber),t.pageSize&&(o="&pageSize="+t.pageSize),s=1==t.indexed?"&indexed=true":"&indexed=false",t.timestamp&&(l="&lastIndexedTime="+t.timestamp);var c="/resources/v1/chguxservices/investigationRequest?"+i+r+o+s+l+(null!=t.filter&&"inactiveCR"==t.filter?"&active=false":"&active=true");let u={},d="";t.refine&&(u.refine={},u.refine={data:[t.refine.allfilters]},d="refine="+JSON.stringify(u.refine));e.makeWSCallWithCSRF(c,"POST","enovia","application/x-www-form-urlencoded",d,function(e){n(e)},a,!1)})},getChangeOrderInfo:function(t,n){return new Promise(function(a,i){var r="/resources/v1/chguxservices/changeorder/"+t;1==n&&(r+="?$simpleJSON=true");e.makeWSCallWithCSRF(r,"GET","enovia","application/json","",function(e){a(e)},i,!1)})},getChangeRequestInfo:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changerequest/"+t;e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getChangeOrchestration:function(t,n){return new Promise(function(a,i){var r="/resources/v1/chguxservices/changeorder/"+t+"/changeorchestration";n&&(r+="?$simpleJSON=true");e.makeWSCallWithCSRF(r,"GET","enovia","application/json","",function(e){a(e)},i,!1)})},getCRChangeOrchestration:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changerequest/"+t+"/changeOrchestration";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},addExistingInCRChangeOrchestration:function(t,n,a){return new Promise(function(i,r){let o;o="Change Request"==n?"/resources/v1/chguxservices/changerequest/"+t+"/changeOrchestration/connect":"/resources/v1/chguxservices/changeorder/"+t+"/changeorchestration/connect?$simpleJSON=true";let s={data:a,definitions:[]};s=JSON.stringify(s);e.makeWSCallWithCSRF(o,"PUT","enovia","application/json",s,function(e){i(e)},r,!1)})},addExistingChangeOrchestration:function(t,n){return new Promise(function(a,i){var r="/resources/v1/chguxservices/changeorder/"+t+"/changeorchestration/connect",o={data:n,definitions:[]};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},removeInCRChangeOrchestration:function(t,n,a){return new Promise(function(i,r){let o;o="Change Request"==n?"/resources/v1/chguxservices/changerequest/"+t+"/changeOrchestration/disconnect":"/resources/v1/chguxservices/changeorder/"+t+"/changeorchestration/disconnect?$simpleJSON=true";let s={data:a,definitions:[]};s=JSON.stringify(s);e.makeWSCallWithCSRF(o,"PUT","enovia","application/json",s,function(e){i(e)},r,!1)})},removeChangeOrchestration:function(t,n){return new Promise(function(a,i){var r="/resources/v1/chguxservices/changeorder/"+t+"/changeorchestration/disconnect",o={data:n,definitions:[]};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},getChangeOrderMembers:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changeorder/"+t+"/members";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},updateChangeOrderMembers:function(t,n){return new Promise(function(a,i){var r="/resources/v1/chguxservices/changeorder/"+t+"/members",o=JSON.stringify(n);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},getApplicabilityData:function(t){return new Promise(function(n,a){let i=`/resources/ecm/modeler/changeorder/pid:${t}/getapplicability`;e.makeWSCall(i,"GET","enovia","application/json","",n,a,null)})},getAttachementData:function(t,n){return null==n&&(n="Reference Document"),new Promise(function(a,i){var r="/resources/v1/modeler/documents/parentId/"+t+"?parentRelName="+n;e.makeWSCall(r,"GET","enovia","application/json","",function(e){a(e)},function(e){i(e)},null)})},getCOChangeRequestData:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changeorder/"+t+"/changerequest";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},function(e){a(e)},null)})},getObjectInfo:function(t,n){return new Promise(function(a,i){if(t&&t.length>0){t=t.toString(),n=n&&n.length>0?n.toString():"name";var r="$ids="+t;r+="&$fields="+n;e.makeWSCall("/resources/v2/e6w/service/ObjectInfo","POST","enovia","application/x-www-form-urlencoded",r,function(e){a(e.data)},i,!1)}else a(!0)})},getIssueDetails:function(t){return new Promise(function(n,a){var i={issueVersion:"DS-API-Version",version:"2.0"},r="/resources/issues/"+t;e.makeWSCallWithCSRF(r,"GET","enovia","application/json","",function(e){n(e)},a,i)})},getFinalApprovedRT:function(e){return new Promise(function(t,n){a.getAllApprovedRouteFromCA(e).then(function(e){for(var n=e.allApproveRoute,i=[],r=0;r<n.length;r++){var o=n[r],s=a.getRouteDetails(o);i.push(s)}Promise.all(i).then(function(e){var n={};n.ApprovedRTs=e,t(n)})},function(e){return Promise.reject(e)})})},getAllApprovedRouteFromCA:function(t){return new Promise(function(n,a){var i="/resources/modeler/change/changeaction/"+t+"?allApprovalRoutes=1";e.makeWSCall(i,"GET","enovia","application/json","",function(e){var t={};t.allApproveRoute=e.changeaction.allApprovalRoutes,n(t)},null,!1)})},getRouteDetails:function(t){return new Promise(function(n,a){var i="/resources/v1/modeler/routes/"+(t=t.replace("pid:",""));e.makeWSCall(i,"GET","enovia","application/json","",function(e){var t={};t.routeInfo=e,n(t)},null,!1)})},createGroupForChangeAction:function(t){return new Promise(function(n,a){var i={title:t.title,changeactions:t.changeactions},r=JSON.stringify(i);e.makeWSCall("/resources/modeler/change/group","POST","enovia","application/json",r,function(e){n(e)},null,!1)})},removeGroupFromCA:function(t){return new Promise(function(n,a){var i=t.oldGroupId,r={addChangeActions:[],removeChangeActions:t.changeactions},o="/resources/modeler/change/group/"+i,s=JSON.stringify(r);e.makeWSCall(o,"PUT","enovia","application/json",s,function(e){n(e)},null,!1)})},updateGroupToAddCA:function(t){return new Promise(function(n,a){var i=t.availbleGroupId,r={addChangeActions:t.changeactions,removeChangeActions:[]},o="/resources/modeler/change/group/"+i,s=JSON.stringify(r);e.makeWSCall(o,"PUT","enovia","application/json",s,function(e){n(e)},null,!1)})},getListOfGroups:function(){return new Promise(function(t,n){e.makeWSCall("/resources/modeler/change/group/elligibleGroups","GET","enovia","application/json","",function(e){t(e)},null,!1)})},getRouteBasedOnContentId:function(t){return new Promise(function(n,a){var i="/resources/v1/modeler/routes?whereUsed="+t;e.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},function(e){a(e)},null)})},getAllApprovalRouteIterations:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/connectedChange/"+t+"/getAllApprovalRouteIterations";e.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getChangeOrderUserAccess:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changeorder/"+t+"/access";e.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getChangeRequestUserAccess:function(t){return new Promise(function(n,a){let i="/resources/v1/chguxservices/changerequest/"+t+"/access?$simpleJSON=false";e.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getImpactAnalysisUserAccess:function(t){return new Promise(function(n,a){let i=`/resources/v1/chguxservices/impactAnalysis/${t}/access?$simpleJSON=false`;e.makeWSCall(i,"GET","enovia","application/json","",n,a,!1)})},getChangeRequests:function(){return new Promise(function(t,n){e.makeWSCallWithCSRF("/resources/v1/chguxservices/changerequest","GET","enovia","application/json","",function(e){let n={};t(n=e)},n,!1)})},getObjectTypeInformation:function(t){return"string"==typeof t?new Promise(function(n,a){let i=`/resources/v2/e6w/service/ApplicabilityTypeInfo/${t}`;e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){let t;e.data[0].dataelements&&null!=e.data[0].dataelements.applicabilityType&&(t=e.data[0].dataelements.applicabilityType),n(t)},a,!1)}):"object"==typeof t?new Promise(function(n,a){let i=`/resources/v2/e6w/service/ApplicabilityTypeInfo/${t}`;e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)}):void 0},getChangeRequestMembers:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changerequest/"+t+"/members";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},updateChangeRequestMembers:function(t,n){return new Promise(function(a,i){var r="/resources/v1/chguxservices/changerequest/"+t+"/members",o=JSON.stringify(n);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},getCRAffectedItems:function(t,n){return new Promise(function(a,i){var r="/resources/v1/chguxservices/changerequest/"+t+"/affectedItems";r+=!0===n?"?impactAnalysis=1":"?impactAnalysis=0";e.makeWSCall(r,"GET","enovia","application/json","",function(e){a(e)},i,!1)})},getIRAffectedItems:function(t,n){return new Promise(function(a,i){var r="/resources/v1/chguxservices/investigationRequest/"+t+"/affectedItems";r+=!0===n?"?impactAnalysis=1":"?impactAnalysis=0";e.makeWSCall(r,"GET","enovia","application/json","",function(e){a(e)},i,!1)})},addExistingInCRAffectedItems:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changerequest/"+t+"/affectedItems",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},addExistingInIRAffectedItems:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/investigationRequest/"+t+"/affectedItems",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},createDispositionFromIR:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/investigationRequest/"+t+"/createDisposition",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},createResolvedByFromIR:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/investigationRequest/"+t+"/createResolvedBy",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},removeCRAffectedItems:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changerequest/"+t+"/affectedItems",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e,t){a([e,t])},i,!1)})},removeIRAffectedItems:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/investigationRequest/"+t+"/affectedItems",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e,t){a([e,t])},i,!1)})},getCRImpactAnalysis:function(t,n){return new Promise((a,i)=>{let r="",o="";n&&n.filterView&&"rolledUpIA"==n.filterView?o=`/resources/v1/chguxservices/changerequest/${t}/impactAnalysisForRolledUpViewSummary`:(o=`/resources/v1/chguxservices/changerequest/${t}/impactAnalysisSummary`,o+=r=n&&n.filterView&&"inactiveIA"==n.filterView?"?active=false":"?active=true");e.makeWSCallWithCSRF(o,"GET","enovia","application/json","",a,i,!1)})},getCRIssue:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changerequest/"+t+"/issues";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getCOIssue:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changeorder/"+t+"/issues";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getIssue:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/";"ChangeOrder"==t.type?i+="changeorder/":"ChangeRequest"==t.type?i+="changerequest/":"InvestigationRequest"==t.type?i+="investigationRequest/":i+="changeaction/",i=i+t.id+"/issues";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getIRIssue:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/investigationRequest/"+t+"/issues";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getConnectedCA:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/impactAnalysis/"+t+"/implementingChangeActions";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},addExistingChangeActionImpactAnalysis:function(t,n){return new Promise(function(a,i){var r="/resources/v1/chguxservices/impactAnalysis/"+t+"/connectCAtoIA",o={data:n,definitions:[]};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},removeInCRChangeActionView:function(t,n,a){return new Promise(function(i,r){let o;"Change Action"==n&&(o="/resources/v1/chguxservices/impactAnalysis/"+t+"/disconnectCAfromIA");let s={data:a,definitions:[]};s=JSON.stringify(s);e.makeWSCallWithCSRF(o,"PUT","enovia","application/json",s,function(e){i(e)},r,!1)})},getCRRelatedScope:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changerequest/"+t+"/reportedAgainst";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getCORelatedScope:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changeorder/"+t+"/reportedAgainst";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getGovernedDataForCA:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changeaction/"+t+"/governedData";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getChangeGroupData:function(t){return new Promise(function(n,a){var i="/resources/modeler/change/changeaction/pid:"+t+"?attributes=1";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getChangeActionForGroup:function(t){return new Promise(function(n,a){var i="/resources/modeler/change/group/"+t+"?";e.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},updateExistingImpactBasis:function(t,n,a){return new Promise(function(t,i){const r=`/resources/v1/chguxservices/impactAnalysis/${n}/impactBasis`;let o={data:a};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,t,i,!1)})},updateExistingIssue:function(t,n){return new Promise(function(a,i){let r,o="/resources/issues/"+t+"/related";r=JSON.stringify(n);e.makeWSCallWithCSRF(o,"PUT","enovia","application/json",r,function(e){a(e)},i,!1)})},removeExistingIssue:function(t,n){return new Promise(function(a,i){let r,o="/resources/issues/"+t+"/related";r=JSON.stringify(n);e.makeWSCallWithCSRF(o,"DELETE","enovia","application/json",r,function(e){a(e)},i,!1)})},updateExistingImpactItem:function(t,n,a){return new Promise(function(t,i){const r=`/resources/v1/chguxservices/impactAnalysis/${n}/impactedItems`;let o={data:a};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,t,i,!1)})},updateExistingRelatedScope:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changerequest/"+t+"/reportedAgainst",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},updateExistingCORelatedScope:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeorder/"+t+"/reportedAgainst",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},removeExistingRelatedScope:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changerequest/"+t+"/reportedAgainst",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},duplicateImpactAnalysis:(t,n)=>new Promise((a,i)=>{let r=`/resources/v1/chguxservices/changerequest/${t}/duplicateChangeAnalysis`,o={data:n};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)}),refineImpactAnalysis:(t,n)=>new Promise((a,i)=>{let r=`/resources/v1/chguxservices/changerequest/${t}/refineChangeAnalysis`,o={data:n};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)}),dispatchImpactAnalysisToSubCR:function(t,n){return new Promise((a,i)=>{let r=`/resources/v1/chguxservices/changerequest/${t}/dispatchImpactAnalysisToChildCR`,o={data:n};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)})},removeExistingCORelatedScope:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeorder/"+t+"/reportedAgainst",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},updateExistingContributors:function(t,n,a){return new Promise(function(t,i){const r=`/resources/v1/chguxservices/impactAnalysis/${n}/contributors`;let o={data:a};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,t,i,!1)})},getCAInfoImpactedItems:(t,n)=>new Promise((a,i)=>{var r="/resources/v1/chguxservices/connectedChange/"+n+"/proposedChangeActionInImpacts";let o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)}),processImpactedItems:function(e){let t=[];return e.forEach(function(e){e.impactedItems.forEach(function(e){t.push(e)})}),t},getImpactAnalysisFromId:function(t,n){return new Promise(function(a,i){let r=`/resources/v1/chguxservices/impactAnalysis/${t}/`;n&&(r+=`?$include=${n}`);e.makeWSCallWithCSRF(r,"GET","enovia","application/json","",a,i,!1)})},getImpactAnalysisFacet:function(t,n){return new Promise(function(a,i){let r=`/resources/v1/chguxservices/impactAnalysis/${t}/?$include=${n}`;e.makeWSCallWithCSRF(r,"GET","enovia","application/json","",a,i,!1)})},getNewCADetails:function(t){return new Promise(function(n,a){var i="/resources/modeler/change/changeaction/pid:"+t+"?people=1&attributes=1";e.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getChangeActionInfo:function(t){return new Promise(function(n,a){let i="/resources/v1/chguxservices/changeaction/"+t;e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",n,a,!1)})},getChangeActionUserAccess:function(t){return new Promise(function(n,a){let i="/resources/v1/chguxservices/changeaction/"+t+"/access";e.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},handleContextMenuClickHoldForCA:function(t){return new Promise(function(n,a){var i=t.userComment,r="/resources/v1/chguxservices/changeaction/"+t.chgPhysicalId+"/hold",o={data:[{reason:i}]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},handleContextMenuClickResumeForCA:function(t){return new Promise(function(n,a){var i=t.userComment,r="/resources/v1/chguxservices/changeaction/"+t.chgPhysicalId+"/resume",o={data:[{reason:i}]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},handleContextMenuClickCancelForCA:function(t){return new Promise(function(n,a){var i=t.userComment,r="/resources/v1/chguxservices/changeaction/"+t.chgPhysicalId+"/cancel",o={data:[{reason:i}],definitions:[]},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){n(e)},null)})},duplicateChangeActionCA:t=>new Promise((n,a)=>{let i=`/resources/v1/chguxservices/changeaction/${t}/duplicateChangeAction`,r="";r=JSON.stringify(r),e.makeWSCallWithCSRF(i,"GET","enovia","application/json",r,n,a,!1)}),duplicateChangeRequestCR:t=>new Promise((n,a)=>{let i=`/resources/v1/chguxservices/changerequest/${t[0].id}/duplicateChangeRequest`,r={data:t};r=JSON.stringify(r),e.makeWSCallWithCSRF(i,"PUT","enovia","application/json",r,n,a,!1)}),handleContextMenuClickBOMSyncForCA:function(t){return new Promise(function(a,i){var r="/resources/modeler/change/changeaction/"+("pid:"+t.chgPhysicalId)+"/synchronize";n.doWait(widget.body),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json","",function(e){n.endWait(widget.body),a(e)},null)})},getCAContext:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changeaction/"+t+"/contexts";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},updateExistingCAContext:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeaction/"+t+"/contexts",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},getApplicabilityDataForCA:function(t){return new Promise(function(n,a){let i=`/resources/modeler/change/changeaction/pid:${t}?applicability=1`;e.makeWSCall(i,"GET","enovia","application/json","",n,a,null)})},getChangeActionMembers:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changeaction/"+t+"/members";e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},updateChangeActionMembers:function(t,n){return new Promise(function(a,i){var r="/resources/v1/chguxservices/changeaction/"+t+"/members",o=JSON.stringify(n);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},connecteCAwithImpactedItem:(t,n)=>new Promise((a,i)=>{let r="/resources/v1/chguxservices/impactAnalysis/"+n+"/connectImpactedItemsAsProposed",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)}),moveAffactedItemToOtherCR:(t,n)=>new Promise((a,i)=>{let r="/resources/v1/chguxservices/changerequest/"+n+"/moveAffectedItems",o={data:t};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e,t){a([e,t])},i,!1)}),orchestrateImpactAnalysis:(t,n)=>new Promise((a,i)=>{let r="/resources/v1/chguxservices/connectedChange/"+n+"/orchestrateItemsForChange",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)}),orchestrateChangeOrder:(t,n)=>new Promise((a,i)=>{let r="/resources/v1/chguxservices/connectedChange/"+n+"/orchestrateItemsForChange",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)}),orchestrateChangeAction:(t,n)=>new Promise((a,i)=>{let r="/resources/v1/chguxservices/connectedChange/"+n+"/orchestrateItemsForChange",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)}),connecteIAwithAffactedItem:t=>new Promise((n,a)=>{let i={data:t};i=JSON.stringify(i),e.makeWSCallWithCSRF("/resources/v1/chguxservices/connectedChange/connectAffectedItemsAsAnalysisBasis","POST","enovia","application/json",i,n,a,!1)}),mergeChangeAction:t=>new Promise((n,a)=>{let i={data:t};i=JSON.stringify(i),e.makeWSCallWithCSRF("/resources/v1/chguxservices/connectedChange/mergeChangeAction","POST","enovia","application/json",i,n,a,!1)}),updateAIReasonForChangeValue:(t,n)=>new Promise((a,i)=>{let r="/resources/v1/chguxservices/changerequest/"+n+"/setWhyForAffectedItems",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)}),updateImpactItemReasonForChangeValue:(t,n)=>new Promise((a,i)=>{let r="/resources/v1/chguxservices/impactAnalysis/"+n+"/setWhyForImpactedItems",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)}),updateStatusOfImpactedItem:(t,n)=>new Promise((a,i)=>{let r="/resources/v1/chguxservices/impactAnalysis/"+n+"/setStatusForImpactedItems",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)}),updateImpactBasisReasonForChangeValue:(t,n)=>new Promise((a,i)=>{let r="/resources/v1/chguxservices/impactAnalysis/"+n+"/setWhyForImpactBasis",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)}),cancelRelatedImpactAnalysis:function(t,n){return new Promise(function(a,i){var r=`/resources/v1/chguxservices/changerequest/${t}/cancelChangeAnalysis`,o=JSON.stringify(n);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)})},handleContextMenuClickWorkUnder:function(t){return new Promise(function(n,a){let i="/resources/modeler/change/changeaction/"+("pid:"+t.chgPhysicalId)+"?editability=1&attributes=1";e.makeWSCall(i,"GET","enovia","application/json","",n,a,!1)})},deleteImpactAnalysis:function(t,n){return new Promise(function(a,i){var r="/resources/v1/chguxservices/connectedChange/"+t+"/deleteImpactAnalysis",o={data:n},s=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",s,function(e){a(e)},i,!1)})},getChangeImpacts:function(t,n,a){return new Promise(function(i,r){var o={data:[{id:t,service:a,type:n}]},s=JSON.stringify(o);e.makeWSCallWithCSRF("/resources/v1/chguxservices/connectedChange/getChangeImpactDetails?proposed=1","PUT","enovia","application/json",s,function(e){i(e)},r,!1)})},getStatesAttributes:function(t){return new Promise(function(n,a){var i={policies:t},r=JSON.stringify(i);e.makeWSCall("/resources/lifecycle/maturity/getStatesAttributes","POST","enovia","application/json",r,function(e){n(e)},a,!1)})},getExtensionsForClass:function(n){return new Promise(function(a,i){var r="/resources/dictionary/class/interfaces?tenant="+t.getGlobalVariable().tenant,o={classes:n},s=JSON.stringify(o);e.makeWSCall(r,"POST","enovia","application/json",s,function(e){a(e)},i,!1)})},getCAProposedChanges:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/changeaction/"+t+"/proposedChanges?flowdown=1&context=1";e.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},function(e){a(e)},!1)})},editProposed:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeaction/"+t+"/proposedChanges",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},addProposed:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeaction/"+t+"/proposedChanges",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},addProposedForDefault:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeaction/"+t+"/proposedChanges",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},removeProposedChange:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeaction/"+t+"/proposedChanges",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e,t){a([e,t])},i,!1)})},updateProposedChangeReasonForChange:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeaction/"+n+"/setWhyForProposedChange",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)})},updateProposedChangeStatus:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeaction/"+n+"/setStatusForProposedChange",o={data:t};o=JSON.stringify(o),e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,a,i,!1)})},fetchAllowedOperation:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeaction/"+t+"/allowedOperations",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"POST","enovia","application/json",o,function(e){a(e)},i,!1)})},addResolution:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeaction/"+t+"/resolutionItems",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},removeResolution:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeaction/"+t+"/resolutionItems",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},replaceProposedByRevision:function(t,n){return new Promise(function(a,i){let r="/resources/v1/chguxservices/changeaction/"+t+"/proposedChanges",o={data:n};o=JSON.stringify(o);e.makeWSCallWithCSRF(r,"PUT","enovia","application/json",o,function(e){a(e)},i,!1)})},getInvestigationRequestInfo:function(t){return new Promise(function(n,a){var i="/resources/v1/chguxservices/investigationRequest/"+t;e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getInvestigationRequestUserAccess:function(t){return new Promise(function(n,a){let i="/resources/v1/chguxservices/investigationRequest/"+t+"/access?$simpleJSON=false";e.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},getMembersByObjectType:function(t,n){var a="";if("ChangeRequest"===n)a="investigationRequest";else if("ChangeOrder"===n)a="changeorder";else if("ChangeAction"===n)a="changeaction";else{if("InvestigationRequest"!==n)return Promise.reject("Unsupported object type");a="investigationRequest"}var i=`/resources/v1/chguxservices/${a}/${t}/membersByRole`;return new Promise(function(t,n){e.makeWSCallWithCSRF(i,"GET","enovia","application/json","",function(e){t(e)},n,!1)})},updateMembers:function(t,n,a){return new Promise(function(i,r){var o="";switch(t){case"ChangeRequest":o="investigationRequest";break;case"ChangeAction":o="changeaction";break;case"ChangeOrder":o="changeorder";break;case"InvestigationRequest":o="investigationRequest";break;default:return void r("Invalid objectType")}var s=`/resources/v1/chguxservices/${o}/${n}/members`,l=JSON.stringify(a);e.makeWSCallWithCSRF(s,"PUT","enovia","application/json",l,function(e){i(e)},r,!1)})}};return a}),define("DS/ENOChgServices/scripts/factories/ChangeActionFactory",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t,n,a,i,r){"use strict";return t.extend(n,a,{init:function(e){this._options=e,console.log(e)},loadInfraForWidget:function(){return new Promise(function(e,t){i.PopulatePreferences().then(function(t){i.getExpressionValue().then(function(t){i.fetchCASubTypes(),e()})})})},loadWidget:function(e){if("undefined"==typeof dscef||r.getGlobalVariable().isPoweredBy){var t=null,n=widget.getValue("X3DContentId")?JSON.parse(widget.getValue("X3DContentId")):null,a=widget.getValue("TransientCAPid"),o=(c=widget.getValue("originatingPid"),u=widget.getValue("objName"),d=widget.getValue("originatingcaName"),p=widget.getValue("status"),widget.getValue("nameTitlePref"));if(null===n||void 0!==widget.getValue("lastRootNodeID")||widget.getValue("clearInPreview"))if(a)UWA.is(a)&&i.IsChangeAction(a).then(function(t){"TRUE"===t.isChangeAction?e({type:"IDCard",options:{transientCAPid:"pid:"+a,originatingCAPid:c,originatingCAName:d,objNametoFilterforFlowDown:u,isFromFlowDown:p,nameTitlePref:o}}):""!=that.caGlobalObject.mySecurityContext&&e({type:"LoadSummary",options:null})});else{if(""!=r.getGlobalVariable().getSecurityContext().mySecurityContext)e({type:"LoadSummary",options:null})}else{var s=n.data;if(null!==s&&s.items.length>0){var l=s.items[s.items.length-1];t=l.objectId,UWA.is(t)&&i.IsChangeAction(t).then(function(n){"TRUE"===n.isChangeAction?e({type:"IDCard",options:{transientCAPid:"pid:"+t,originatingCAPid:c,originatingCAName:d,objNametoFilterforFlowDown:u,isFromFlowDown:p,nameTitlePref:o}}):""!=r.getGlobalVariable().getSecurityContext()&&e({type:"LoadSummary",options:null})},function(e){return console.log("widget initilization failed"),Promise.reject(e)})}}}else{widget.body.empty();var c="",u="",d="",p=!1;this._options&&this._options.flowdown&&(c=this._options.flowdown.originatingPid,u=this._options.flowdown.objName,p=this._options.flowdown.status,d=this._options.flowdown.originatingcaName,nameTitlePref=this._options.flowdown.nameTitlePref);var g="pid:"+this._options.pid;e({type:"IDCard",options:{transientCAPid:g,originatingCAPid:c,originatingCAName:d,objNametoFilterforFlowDown:u,isFromFlowDown:p,nameTitlePref:"Title"}})}}})}),define("DS/ENOChgServices/scripts/services/ChgDataProcess",["i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgMembersServices","WebappsUtils/WebappsUtils","DS/PlatformAPI/PlatformAPI","DS/ENOChgServices/scripts/services/ChgInfraService","DS/RouteWebAppUX/scripts/RouteWebAppApprovalStatusUX","DS/WidgetServices/WidgetServices","DS/TreeModel/BaseFilter","text!DS/ENOChgServices/assets/ChangeViewsNLSMapping.json"],function(e,t,n,a,i,r,o,s,l,c){"use strict";var u={getPoliciesFromFedResponse:function(e){let t=new Set,n=[];for(var a=0;a<e.length;a++)e[a].dataelements.policy&&e[a].dataelements.policy.length>0&&t.add(e[a].dataelements.policy[0]),e[a].relateddata&&e[a].relateddata.activities&&e[a].relateddata.activities.length>0&&e[a].relateddata.activities.forEach(function(e){e.relateddata&&e.relateddata.referenceDetails&&t.add(e.relateddata.referenceDetails[0].dataelements.policy[0])});return t.forEach(e=>n.push(e)),n},getRealizedActivityIconName:function(e){var t=void 0;if(e&&""!==e)if(e.startsWith("ChangeStatus"))t="collaborative-lifecycle-management";else if(e.startsWith("FileAdded"))t="upload";else if(e.startsWith("FileModified"))t="update";else if(e.startsWith("FileRemoved"))t="trash";else switch(e){case"NonPrimeRoot":t="tree-view-flattened-leaves wux-ui-3ds";break;case"AddInFamily":case"Add":t="3dproduct-insert wux-ui-3ds";break;case"ConfiguredDelete":t="configuration-delete wux-ui-3ds";break;case"ConfiguredReplace":t="replace-by-configuration wux-ui-3ds";break;case"EvolveInstance":t="flow-branch-add wux-ui-3ds";break;case"ConfiguredMove":t="move-to wux-ui-3ds";break;case"EditVariant":case"ConfiguredEditVariant":t="variants-and-options wux-ui-3ds";break;case"Extend":t="evolution-effectivity-extension wux-ui-3ds";break;case"Move":t="move-to wux-ui-3ds";break;case"Replace":t="replace-by-existing wux-ui-3ds";break;case"Cut":t="tree-delete wux-ui-3ds";break;case"Create":t="plus wux-ui-3ds";break;case"Modify":t="pencil wux-ui-3ds";break;case"NewMinorVersion":case"NewVersion":t="flow-line-add wux-ui-3ds";break;case"Evolve":case"NewEvolution":t="flow-branch-add wux-ui-3ds";break;case"Clone":t="duplicate wux-ui-3ds";break;case"TransferOwnership":case"ChangeResponsible":t="user-change wux-ui-3ds";break;case"AddAlternate":t="exchange wux-ui-3ds";break;case"AltSubFor":t="replace wux-ui-3ds";break;case"AddSubstitute":t="exchange wux-ui-3ds";break;case"SubstitutionContextAdded":t="exchange-add wux-ui-3ds";break;case"SubtitutionContextRemoved":t="exchange-delete wux-ui-3ds";break;case"AltQualified":t="select-all-checkboxes wux-ui-3ds";break;case"AltObsolete":t="select-none-checkboxes wux-ui-3ds"}return t},getChangeActionNodeData:async function(e){var t=await r.getNLSValuesPromise({"ds6w:type":e.dataelements["ds6w:type"],"ds6w:status":e.dataelements["ds6w:status"]});return{id:e.id,displayName:e.dataelements["ds6w:label"][0],displayType:e.dataelements["ds6w:type"][0],title:e.dataelements["ds6w:label"][0],type:e.dataelements["ds6w:type"][0],typeNLS:t["ds6w:type"][e.dataelements["ds6w:type"][0]],name:e.dataelements["ds6w:identifier"][0],maturity:e.dataelements["ds6w:status"][0],maturityNLS:t["ds6w:status"][e.dataelements["ds6w:status"][0]],icon:e.dataelements.icon,previewIcon:e.dataelements.previewicon,thumbnail:e.dataelements.previewicon}},getClassifiedInterfaces:function(e){let t=new Array;try{e.forEach(e=>{let n={name:e.id,NLS:e.id,attrs:[]};e.relateddata&&e.relateddata.class_attrs&&e.relateddata.class_attrs.forEach(e=>{n.attrs.push({curi:e.dataelements.curi,name:e.dataelements.name,NLS:e.dataelements.NLS,type:e.dataelements.type})}),n.attrs.length>0&&t.push(n)})}catch(e){console.error("parsing realized classified attributes failed")}return t},getProposedClassifiedInterfaces:function(e){let t=new Array;try{e.forEach(e=>{let n={name:e.id,NLS:e.id,attrs:[]};e&&e.class_attrs&&e.class_attrs.forEach(e=>{n.attrs.push({curi:e.curi,name:e.name,NLS:e.NLS,type:e.type})}),n.attrs.length>0&&t.push(n)})}catch(e){console.error("parsing proposed classified attributes failed")}return t},getRealizedNodeData:async function(e,t){var n,a,i={},o=void 0,s=new Array;e.dataelements.interface&&(o=new Set(e.dataelements.interface)),n=e.dataelements["ds6w:type"],a=e.dataelements["ds6w:status"],e.relateddata&&e.relateddata.classes&&(s=[...s,...this.getClassifiedInterfaces(e.relateddata.classes)]),"TRUE"===e.dataelements.isInstanceOperation&&e.relateddata.referenceDetails&&(e.relateddata.referenceDetails[0].dataelements.interface.forEach(e=>{o.add(e)}),e.relateddata.referenceDetails[0].relateddata&&e.relateddata.referenceDetails[0].relateddata.classes&&(s=[...s,...this.getClassifiedInterfaces(e.relateddata.referenceDetails[0].relateddata.classes)]),n=e.relateddata.referenceDetails[0].dataelements["ds6w:type"],a=e.relateddata.referenceDetails[0].dataelements["ds6w:status"]),e.relateddata&&e.relateddata.beforeReferenceDetails&&(e.relateddata.beforeReferenceDetails[0].dataelements.interface.forEach(e=>{o.add(e)}),e.relateddata.beforeReferenceDetails.classes&&(s=[...s,...this.getClassifiedInterfaces(e.relateddata.beforeReferenceDetails.classes)]));var l=await r.getNLSValuesPromise({"ds6w:type":n,"ds6w:status":a});let c=[];o&&(c=(c=Array.from(o)).filter(e=>""!==e));let u=[];s&&s.length>0&&(u=s.filter(e=>""!==e.name));try{if(i={id:e.id,name:e.dataelements["ds6w:identifier"][0],title:"TRUE"===e.dataelements.isInstanceOperation&&e.relateddata.referenceDetails?e.relateddata.referenceDetails[0].dataelements["ds6w:label"][0]:e.dataelements["ds6w:label"][0],title_instance:"TRUE"===e.dataelements.isInstanceOperation&&"Cut"!==e.dataelements.operation?e.dataelements["ds6w:label"][0]:"",interfaces:c,classes:u,type:e.dataelements["ds6w:type"][0],typeNLS:l["ds6w:type"][e.dataelements["ds6w:type"][0]],instance_typeNLS:"TRUE"===e.dataelements.isInstanceOperation?l["ds6w:type"][e.dataelements["ds6w:type"][0]]:"",policy:e.dataelements.policy[0],revision:e.dataelements["ds6wg:revision"][0],maturity:e.dataelements["ds6w:status"][0],maturityWithBadge:e.dataelements["ds6w:status"][0]?l["ds6w:status"][e.dataelements["ds6w:status"][0]]:"",maturityNLS:e.dataelements["ds6w:status"][0]?l["ds6w:status"][e.dataelements["ds6w:status"][0]]:"",reasonForChange:e.dataelements.activity_description,operation:UWA.is(t)?"NonPrimeRoot":e.dataelements.operation?e.dataelements.operation:"",isInstanceOperation:e.dataelements.isInstanceOperation,sub_operations:e.dataelements.sub_operations?e.dataelements.sub_operations:[],icon:"TRUE"===e.dataelements.isInstanceOperation&&e.relateddata.referenceDetails?e.relateddata.referenceDetails[0].dataelements.icon:e.dataelements.icon,configured_icon:(e.dataelements.isRefConfigured,""),isRefConfigured:e.dataelements.isRefConfigured,instance_icon:"",previewIcon:e.dataelements.previewicon,thumbnail:e.dataelements.previewicon,displayName:e.dataelements["ds6w:label"][0],displayType:l["ds6w:type"][e.dataelements["ds6w:type"][0]],activity_id:e.dataelements.activity_id,activity_icon:UWA.is(t)?this.getRealizedActivityIconName("NonPrimeRoot"):this.getRealizedActivityIconName(e.dataelements.operation),isTransferred:e.dataelements.isTransferred,moved_to_ca_id:e.dataelements.transferred_ca_id,reasonForMove:e.dataelements.transfer_reason,isIgnored:e.dataelements.isIgnored,activities:[]},"TRUE"===e.dataelements.isInstanceOperation&&e.relateddata.referenceDetails&&(i.type=e.relateddata.referenceDetails[0].dataelements["ds6w:type"][0],i.typeNLS=l["ds6w:type"][e.relateddata.referenceDetails[0].dataelements["ds6w:type"][0]],i.maturity=e.relateddata.referenceDetails[0].dataelements["ds6w:status"][0],i.maturityWithBadge=l["ds6w:status"][e.relateddata.referenceDetails[0].dataelements["ds6w:status"][0]],i.maturityNLS=l["ds6w:status"][e.relateddata.referenceDetails[0].dataelements["ds6w:status"][0]],i.name=e.relateddata.referenceDetails[0].dataelements["ds6w:identifier"][0],i.revision=e.relateddata.referenceDetails[0].dataelements["ds6wg:revision"][0]),"TRUE"===e.dataelements.isInstanceOperation&&e.relateddata.afterDetails)if(e.relateddata.afterDetails[0].dataelements["ds6w:type"]&&e.relateddata.afterDetails[0].dataelements["ds6w:type"].length>0){var d=await r.getNLSValuesPromise({"ds6w:type":e.relateddata.afterDetails[0].dataelements["ds6w:type"]});i.type_instance_NLS=d["ds6w:type"][e.relateddata.afterDetails[0].dataelements["ds6w:type"]]}else i.type_instance_NLS=void 0}catch(e){console.log(e),i={msg:"PARSING_KO"}}return i},getPrimeActivityFromRC:async function(e){var t=null;if(e.relateddata&&e.relateddata.activities)for(var n=0;n<e.relateddata.activities.length;n++){var a=e.relateddata.activities[n];if(a.relateddata&&a.relateddata.whereDetails&&a.relateddata.afterDetails&&a.relateddata.whereDetails[0].id===a.relateddata.afterDetails[0].id){if((t=await this.getRealizedNodeData(a)).msg&&"PARSING_KO"===t.msg)return t;e.relateddata&&e.relateddata.classes&&(t.classes=this.getClassifiedInterfaces(e.relateddata.classes)),t.isRefConfigured=e.dataelements.isRefConfigured,t.isIndexed=e.dataelements.allActivitiesIndexed,"TRUE"===t.isRefConfigured&&(t.configured_icon=""),t.where_details=a.relateddata.whereDetails?a.relateddata.whereDetails[0]:void 0,t.after_details=a.relateddata.afterDetails?a.relateddata.afterDetails[0]:void 0,t.before_details=a.relateddata.beforeDetails?a.relateddata.beforeDetails[0]:void 0,t.ref_details=a.relateddata.referenceDetails?a.relateddata.referenceDetails[0]:void 0,"TRUE"===t.isTransferred&&(t.moved_to_ca_details=await this.getChangeActionNodeData(a.relateddata.transferredCADetails[0]))}}return t},addNonPrimeActivities:async function(e,t){for(var n={msg:"OK"},a=0;a<t.length;a++){var i=t[a];if(!(i.relateddata&&i.relateddata.whereDetails&&i.relateddata.afterDetails&&i.relateddata.whereDetails[0].id===i.relateddata.afterDetails[0].id)){var r=await this.getRealizedNodeData(i);r.msg&&"PARSING_KO"===r.msg?n=r:(r.where_details=i.relateddata.whereDetails?i.relateddata.whereDetails[0]:void 0,r.after_details=i.relateddata.afterDetails?i.relateddata.afterDetails[0]:void 0,r.before_details=i.relateddata.beforeDetails?i.relateddata.beforeDetails[0]:void 0,r.before_ref_details=i.relateddata.beforeReferenceDetails?i.relateddata.beforeReferenceDetails[0]:void 0,r.ref_details=i.relateddata.referenceDetails?i.relateddata.referenceDetails[0]:void 0,"TRUE"===r.isTransferred&&(r.moved_to_ca_details=await this.getChangeActionNodeData(i.relateddata.transferredCADetails[0])),e.activities.push(r))}}return n},processCARealizedChangesData:async function(e){for(var t={realized_changes:[],AllOK:!0,AllIndexed:!0,rc_count:e.length},n=0;n<e.length;n++){var a=null,i=!0;try{if(null==(a=await this.getPrimeActivityFromRC(e[n]))?(a=await this.getRealizedNodeData(e[n],!0),"FALSE"===e[n].dataelements.allActivitiesIndexed&&(t.AllIndexed=!1),"TRUE"===e[n].dataelements.isDeleted||a.msg&&"PARSING_KO"===a.msg?(t.AllOK=!1,i=!1):a.where_details=e[n].relateddata.whereDetails?e[n].relateddata.whereDetails[0]:void 0):a.msg&&"PARSING_KO"===a.msg&&(t.AllOK=!1,i=!1),!0===i&&("FALSE"===a.isIndexed&&(t.AllIndexed=!1),t.realized_changes.push(a),e[n].relateddata&&e[n].relateddata.activities)){var r=await this.addNonPrimeActivities(a,e[n].relateddata.activities);r.msg&&"PARSING_KO"===r.msg&&(t.AllOK=!1)}}catch(e){console.log(e),t.AllOK=!1}}return t},processCASummaryList:function(t){var n=[],a=[],i={},r=[],o=[],s=t.details.owner;null!=s&&null!=s&&s.forEach(function(t){t.contextUserRole=e.ECM_CA_Team_Owner,a.push(t.id),r.push(t.owner),i[t.id]=t});var l=t.details.contributor;null!=l&&null!=l&&l.forEach(function(t){-1==a.indexOf(t.id)?(t.contextUserRole=e.ECM_CA_Summary_Contributor,a.push(t.id),r.push(t.owner),i[t.id]=t):i[t.id].contextUserRole+=", "+e.ECM_CA_Summary_Contributor});var c=t.details.reviewer;null!=c&&null!=c&&c.forEach(function(t){-1==a.indexOf(t.id)?(t.contextUserRole=e.ECM_CA_Summary_Reviewer,a.push(t.id),r.push(t.owner),i[t.id]=t):i[t.id].contextUserRole+=", "+e.ECM_CA_Summary_Reviewer});var u=t.details.follower;return null!=u&&null!=u&&u.forEach(function(t){-1==a.indexOf(t.id)?(t.contextUserRole=e.ECM_CA_Summary_Follower,a.push(t.id),r.push(t.owner),i[t.id]=t):i[t.id].contextUserRole+=", "+e.ECM_CA_Summary_Follower}),a.forEach(function(t){var n=i[t],a=n.id;a=(a=a.split("pid:"))[1];var r=n.name,s=n.owner,l=n.current,c=0;"In Work"==l?c=1:"In Approval"==l?c=2:"Approved"==l&&(c=3),l=n.currentNLS;var u=n.type,d=n.attributes.Severity,p=0;"Medium"==d?p=1:"High"==d&&(p=2),d=e.get("CHG_CA_Severity_"+d);var g=n.attributes.Synopsis,f=n.attributes.EstimatedCompletionDate,m=n.contextUserRole,h=n["Change On Hold"],v=(n.contextUserRole,""),C="";n.group&&(v=n.group.title,C=n.group.id);var S={title:g,name:r,maturity:l,severity:d,responsible:s,userRole:m,id:a,type:u,displayType:u,severityGrade:p,stateGrade:c,recent:"",onHold:h,group:v,groupid:C,policy:"Change Action",icon:"https://vdevpril155plp.dsone.3ds.com:443/3DSpace/snresources/images/icons/large/I_Product_Thumbnail.png"};""!=f&&null!=f&&(S.dueDate=f),o.push(S)}),n.processData=o,n.memberList=r,n},processedListWithName:function(e){var t=e.processList;if(t){e.userDisplayName;for(var n=0;n<t.length;n++){var a=t[n],i=a.responsible;a.responsible=e[i].userDisplayName,a.ownerId=e[i].id,a.trigram=i}return t}},processChangeActionCreateData:function(t){var n=[],a=[],i=[],r=t.changeaction.name,o=t.changeaction.id,s=t.changeaction.policy;"pid"==o.substring(0,3)&&(o=o.substring(4));for(var l=t.changeaction.type,c=t.changeaction.icon,u=t.changeaction.image,d="",p="",g="",f="",m="",h=(f="",""),v=e.CHG_CA_Role_Owner,C=t.changeaction.attributes,S=0;S<C.length;S++)if("current"==C[S].name)d=C[S].value;else if("currentNLS"==C[S].name)p=C[S].value;else if("attribute_Severity"==C[S].name)g=C[S].value;else if("attribute_Synopsis"==C[S].name){f=this.escapeHTML(C[S].value)}else"interface[Change On Hold]"==C[S].name?C[S].value:"attribute_Originator"==C[S].name?m=C[S].value:"attribute_EstimatedCompletionDate"==C[S].name&&(h=C[S].value);h=h?new UWA.Date(h).strftime("%Y-%m-%d"):"";var y=0;"Medium"==g?y=1:"High"==g&&(y=2);var b=0;"In Work"==d?b=1:"In Approval"==d?b=2:"Approved"==d&&(b=3),d=d;var w={title:f,name:r,maturity:p,severity:g=e.get("CHG_CA_Severity_"+g),responsible:m,userRole:v,id:o,type:l,displayType:l,severityGrade:y,stateGrade:b,policy:s,icon:c,thumbnail:u};return""!=h&&null!=h&&(w.dueDate=h),a.push(w),i.push(m),n.processData=a,n.memberList=i,n},escapeHTML:e=>String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),makeObjList:function(e){for(var t=[],n=0;n<e.length;n++){var a=e[n].id;t.push(a)}return t},createIconMap:function(e){var n={},a="",i="",r="";if(null!=e&&e.hasOwnProperty("results"))for(var o=e.results,s=0;s<o.length;s++){for(var l=e.results[s].attributes,c=0;c<l.length;c++){var u=l[c].name;"ds6w:type"==u&&(a=l[c].value),"type_icon_url"==u&&(i=l[c].value),"preview_url"==u&&(r=l[c].value)}n[a]=n[a]||[],n[a].push(i),n[a].push(r)}else{a="Change Action";i=t.getGlobalVariable().computeUrl("/snresources/images/icons/small/I_ECM_CA.png"),r=t.getGlobalVariable().computeUrl("/snresources/images/icons/large/I_ECM_CA108x144.png"),n[a]=n[a]||[],n[a].push(i),n[a].push(r)}t.setIconMap(n)},processCAListIndexed:function(n){var a=n.results,i=[];t.getGlobalVariable().existingCAIds=[];let r=t.getGlobalVariable().customeViewList;const o=function(e){let t,n,a,i;return n=(24+(new Date).getTimezoneOffset()/60)%24,t=e+" "+(a=Math.trunc(n))+":"+(i=n%1*60)+":00 UTC",t=Date.parse(t),new Date(t)};if(null!=a)for(var s=0;s<a.length;s++){for(var l=a[s].attributes,c="",d="",p=[],g=[],f=[],m=[],h="",v="",C="",S="",y="",b="",w="",A="",O="",N="",I="false",P="false",E="false",T="",R="",_=[],D="",F="",x=0;x<l.length;x++)if("current"==l[x].name)c=l[x].value;else if("ds6w:what/ds6w:type"==l[x].name)D=l[x].value;else if("ds6w:what/ds6w:policy"==l[x].name)F=l[x].value;else if("resourceid"==l[x].name)y=l[x].value;else if("type_icon_url"==l[x].name)b=l[x].value;else if("preview_url"==l[x].name)w=l[x].value;else if("ds6w:dueDateParametric"==l[x].name){d=o(l[x].value).toLocaleDateString()}else if("ds6w:who/ds6w:responsible"==l[x].name)N=l[x].value;else if("ds6w:responsible"==l[x].name)N=l[x].value;else if("owner"==l[x].name){(O=l[x].value)==t.getGlobalVariable().contextUser&&(A="Owner")}else"ECM_CHG_ON_HOLD"==l[x].name?S=l[x].value:"ds6w:why/ds6w:fulfills/ds6w:severity"==l[x].name?h=l[x].value:"ds6w:label"==l[x].name?v=l[x].value:"ds6w:identifier"==l[x].name?C=l[x].value:"ECM_CA_ASSIGNEE_FULL_NAME"==l[x].name?p.push(l[x].value):"ECM_CA_FOLLOWERS_FULL_NAME"==l[x].name?g.push(l[x].value):"ECM_CA_DIRECT_REVIEWER_FULL_NAME"==l[x].name?f.push(l[x].value):"ECM_ROUTE_TEMPLATE_LABEL"==l[x].name?_.push(l[x].value):"ECM_CA_ATTACHMENT_ID"==l[x].name?(m.push(l[x].value),P="attach"):"ECM_CHANGE_REJECTION"==l[x].name?"Reject"==l[x].value&&(E="thumbs-down"):"ECM_CHANGE_ACTION_GROUP_NAME"==l[x].name?T=l[x].value:"ECM_CHANGE_ACTION_GROUP_PHYSICALID"==l[x].name&&(R=l[x].value);t.getGlobalVariable().existingCAIds.push(y);d=d?new UWA.Date(d).strftime("%Y-%m-%d"):"";var L=0;"Medium"==h?L=1:"High"==h&&(L=2);var j=0;"In Work"==c?j=1:"In Approval"==c?j=2:"Approved"==c&&(j=3),"TRUE"==S&&(I="true");var G={title:v,name:C,maturity:F+"."+c,severity:h=e.get("CHG_CA_Severity_"+h),responsible:N,userRole:A,id:y,type:D,displayType:D,severityGrade:L,stateGrade:j,recent:"",iconURL:b,previewURL:w,changeReviewer:f,changeFollower:g,changeAssignee:p,owner:O,onHold:I,referential:P,reject:E,referentialList:m,changeApprover:_,group:T,groupId:R,policy:F};""!=d&&null!=d&&(G.dueDate=d);let n=this.updateObjectWithCustom(r,l,G);i.push(n)}return new Promise(function(e,t){u.getNLSForProcessedList("CASummary",i).then(function(){e(i)},function(){e(i)})})},updateObjectWithCustom:function(e,t,n){for(let a of e)for(let e of t)e.name.endsWith(a)&&(n[a]=e.value);return n},getGridColumnNameForIndexTag:function(e){return{current:"state","ds6w:why/ds6w:fulfills/ds6w:severity":"severity","ds6w:what/ds6w:status":"maturity","ds6w:what/ds6w:type":"type","ds6w:who/ds6w:responsible":"responsible"}[e]},getAttribute:function(e,t){if("undefined"!=e.changeaction&&e.changeaction.attributes)for(var n=e.changeaction.attributes,a=0;a<n.length;a++)if(n[a].name==t)return n[a].value;return null},processTimestampData:function(e){var t="";return e.FTS&&(t=e.FTS.allvaultsacl),t},getThumbnailURL:function(e,n){var a={},i=[],r=[];n.forEach(function(e){for(var t=e.attributes,n="",i="",r="",o="",s=0;s<t.length;s++)"resourceid"==t[s].name?n=t[s].value:"ds6w:docextension"==t[s].name?i=t[s].value:"preview_url"==t[s].name?r=t[s].value:"type_icon_url"==t[s].name&&(o=t[s].value);var l={docextension:i,preview_url:r,icon_url:o};a[n]=l});for(var o=["JPG","JPEG","PNG","BMP","GIF"],s=0;s<e.length;s++){var l=!1,c="",u=e[s],d=u.caPhyid,p=u.referentialList;if(0!=p.length)for(var g=p.length-1;g>=0;g--){var f=p[g];if(a.hasOwnProperty(f)){var m=null!=(f=a[f]).docextension?f.docextension:"temp;";if(o.includes(m.toUpperCase())){c=f.preview_url,l=!0;break}}}1==l?(i[d]=c,r[d]=c):r[d]=u.previewURL}return t.setPreviewURLArray(r),i},getThumbnailURLForNonIndexed:function(e,n){for(var a=["JPG","JPEG","PNG","BMP","GIF"],i="",r=!1,o=[],s=e.options.grid.id,l=n.length-1;l>=0;l--){var c=null!=n[l].dataelements&&null!=n[l].dataelements.fileExtension?n[l].dataelements.fileExtension.slice(1):"temp";if(console.log(t),a.includes(c.toUpperCase())){i=n[l].dataelements.image,r=!0;break}}return(o=null!=(o=t.getPreviewURLArray())?o:[])[s]=1==r?i:e.options.grid.previewURL,t.setPreviewURLArray(o),i},processOwnerID:function(e){for(var t=[],n=0;n<e.length;n++)"owner"==e[n].role&&t.push(e[n].name);return t},createCustomOwnerField:function(e){var a="/api/user/getpicture/login/"+e.id+"/format/normal",i=t.getGlobalVariable().computeSwymUrl(a),r=new UWA.Element("div",{class:"members"}),o=new UWA.Element("div",{class:"assignee"}),s="";if(t.getGlobalVariable().isSwymInstalled)s=UWA.createElement("img",{class:"userIcon",src:i});else{var l=n.getAvatarDetails(e.fullName);(s=UWA.createElement("div",{html:l.avatarStr,class:"avatarIcon"})).style.setProperty("background",l.avatarColor)}s.inject(o);var c=UWA.createElement("span",{class:"userName",html:e.fullName});return o.inject(r),c.inject(r),r.outerHTML},processedCOSummaryList:async function(e,n){var a=[],i=e.data;t.getGlobalVariable().existingCOIds=[];let r=[];if("true"==t.getGlobalVariable().CHG_APPROVAL_COLUMN&&await o.getColumnApprovalStatusValue(u.createPayloadApprovalStatusValue(e)).then(function(e){e&&r.push(e)}),null!=i)for(var s=0;s<i.length;s++){var l,c,d,p,g,f,m,h,v,C,S,y,b,w,A,O,N,I,P="",E="";let e="ChangeOrder",o="",u="",D="",F="",x="",L="";l=i[s].id,c=i[s].type,I=i[s].typeNLS,p=i[s].name,g=i[s].revision,d=i[s].title,i[s].severity,h=i[s].severityNLS,m=i[s].current,v=i[s].currentNLS,O=i[s].description,C=i[s].project,S=i[s].organization,o=i[s].policy,y=i[s].icon,f=i[s].severity,u=i[s].applicability,D=new UWA.Date(i[s].modified).strftime("%m/%d/%y %r"),F=new UWA.Date(i[s].originated).strftime("%m/%d/%y %r"),i[s].changeCoordinator&&(P=i[s].changeCoordinator),i[s].changeCoordinatorFullName&&(E=i[s].changeCoordinatorFullName),b=i[s].owner,w=i[s].ownerFullName,A=i[s].previewicon,N="TRUE"===i[s].ecm_change_on_hold?"true":"false";var T=0;"Medium"==f?T=1:"High"==f&&(T=2);var R=0;"In Work"==m?R=1:"In Approval"==m?R=2:"Approved"==m&&(R=3),"true"==t.getGlobalVariable().CHG_APPROVAL_COLUMN&&r&&r[0][l]&&(x=r[0][l].approvalStatus,L=r[0][l].approvalStatusModel),t.getGlobalVariable().existingCOIds.push(l);var _={id:l,type:c,typeNLS:I,title:d,name:p,revision:g,maturity:m,maturityKey:o+"."+m,maturityNLS:v,severity:f,severityNLS:h,description:O,collabspace:C,organization:S,iconURL:y,changeCoordinator:P,changeCoordinatorFullName:E,owner:b,ownerFullName:w,thumbnail:A,severityGrade:T,stateGrade:R,onHold:N,isKindOfType:e,applicabilityNLS:u,modificationDate:D,creationDate:F,policy:o,interfaces:n,ApprovalStatus:x,approvalStatusModel:L};a.push(_)}return new Promise(function(e,t){u.getNLSForProcessedList("COSummary",a).then(function(){e(a)},function(){e(a)})})},processedCAList:function(e){var t=[],n=e.data;if(null!=n)for(var a=0;a<n.length;a++){var i,r,o,s,l,c,u,d,p,g,f;let e="ChangeAction",h="";i=n[a].id,r=n[a].type,o=n[a].typeNLS,l=n[a].name,s=n[a].title,c=n[a].severity,d=n[a].severityNLS,u=n[a].current,p=n[a].currentNLS,g=n[a].project,f=n[a].organization,h=n[a].policy;var m={id:i,type:r,typeNLS:o,title:s,name:l,maturity:u,maturityNLS:p,severity:c,severityNLS:d,collabspace:g,organization:f,iconURL:n[a].icon,owner:n[a].owner,ownerFullName:n[a].ownerFullName,thumbnail:n[a].previewicon,isKindOfType:e,policy:h};t.push(m)}return t},getNLSForProcessedList:(e,t)=>new Promise(function(n,a){var i={};if(t&&t.length>0){for(var o=JSON.parse(c)[e],s=0;s<t.length;s++){var l=t[s];Object.keys(o).forEach(function(e){var t=o[e];i[t]?i[t].push(l[e]):i[t]=[l[e]]})}r.getNLSValuesPromise(i).then(function(a){for(var i=0;i<t.length;i++){var r=t[i];Object.keys(o).forEach(function(t){var n=o[t];"CASummary"==e?a[n]&&a[n][r[t]]?r[t]=a[n][r[t]]:r[t]=r[t]:a[n]&&a[n][r[t]]?r[t+"NLS"]=a[n][r[t]]:r[t+"NLS"]=r[t]})}n(t)},function(e){return n(t)})}else n(t)}),getNLSForProcessedListFromSource:(e,t)=>new Promise(function(n,a){var i={};if(t&&t.length>0){for(var o=JSON.parse(c)[e],s=0;s<t.length;s++){var l=t[s];Object.keys(o).forEach(function(e){var t=o[e];let n={},a=[];a.push(l.serviceName),n.value=l[e],n.source=a,i[t]?i[t].push(n):i[t]=[n]})}r.getNLSValuesPromiseForSource(i).then(function(a){for(var i=0;i<t.length;i++){var r=t[i];Object.keys(o).forEach(function(t){var n=o[t];"CASummary"==e?a[n]&&a[n][r[t]]?r[t]=a[n][r[t]]:r[t]=r[t]:a[n]&&a[n][r[t]]?r[t+"NLS"]=a[n][r[t]]:r[t+"NLS"]=r[t]})}n(t)},function(e){return n(t)})}else n(t)}),processedChangeOrchestrationSummaryList:function(e){var t=[],n=e.data;if(null!=n)for(var a=0;a<n.length;a++){var i,r,o,s,l,c,d,p,g,f,m,h,v,C,S,y,b=!1,w=!1,A="";i=n[a].id,r=n[a].type,S=n[a].dataelements?n[a].dataelements.typeNLS:n[a].typeNLS,s=n[a].dataelements?n[a].dataelements.name:n[a].name,l=n[a].dataelements?n[a].dataelements.revision:n[a].revision,o=n[a].dataelements?n[a].dataelements.title:n[a].title,n[a].dataelements?n[a].dataelements.severity:n[a].severity,p=n[a].dataelements?n[a].dataelements.severityNLS:n[a].severityNLS,d=n[a].dataelements?n[a].dataelements.current:n[a].current,g=n[a].dataelements?n[a].dataelements.currentNLS:n[a].currentNLS,v=n[a].dataelements?n[a].dataelements.description:n[a].description,C=n[a].dataelements?n[a].dataelements.ecm_change_on_hold:n[a].ecm_change_on_hold,f=n[a].dataelements?n[a].dataelements.project:n[a].project,m=n[a].dataelements?n[a].dataelements.organization:n[a].organization,h=n[a].dataelements?n[a].dataelements.icon:n[a].icon,c=n[a].dataelements?n[a].dataelements.severity:n[a].severity,y=n[a].dataelements?n[a].dataelements.policy:n[a].policy,b=n[a].dataelements?n[a].dataelements.isChangeAction:n[a].isChangeAction,w="TRUE"===(w=n[a].dataelements?n[a].dataelements.isChangeRequest:n[a].isChangeRequest),A=1==(b="TRUE"===b)?"ChangeAction":1==w?"ChangeRequest":"ChangeOrder";var O=0;"Medium"==c?O=1:"High"==c&&(O=2);var N=0;"In Work"==d?N=1:"In Approval"==d?N=2:"Approved"==d&&(N=3);var I={id:i,type:r,typeNLS:S,title:o,name:s,revision:l,maturity:d,maturityNLS:g,severity:c,severityNLS:p,description:v,collabspace:f,organization:m,iconURL:h,changeCoordinator:n[a].dataelements?n[a].dataelements.changeCoordinator:n[a].changeCoordinator,changeCoordinatorFullName:n[a].dataelements?n[a].dataelements.changeCoordinatorFullName:n[a].changeCoordinatorFullName,owner:n[a].dataelements?n[a].dataelements.owner:n[a].owner,ownerFullName:n[a].dataelements?n[a].dataelements.ownerFullName:n[a].ownerFullName,thumbnail:n[a].dataelements?n[a].dataelements.previewicon:n[a].previewicon,severityGrade:O,stateGrade:N,isKindOfChangeAction:b,isKindOfChangeRequest:w,ecm_change_on_hold:C,isKindOfType:A,policy:y};t.push(I)}return new Promise(function(e,n){u.getNLSForProcessedList("COOrchestration",t).then(function(){e(t)},function(){e(t)})})},processChangeOrderRecentList:function(e,t){var n=[],a=e.data;if(null!=a)for(var i=0;i<a.length;i++){var r,o,s,l,c,u,d,p,g,f,m,h,v,C,S,y,b="",w="";r=a[i].id,o=a[i].type,y=a[i].typeNLS,l=a[i].name,c=a[i].revision,s=a[i].title,a[i].severity,p=a[i].severityNLS,d=a[i].current,g=a[i].currentNLS,v=a[i].description,S="TRUE"===a[i].ecm_change_on_hold?"true":"false",f=a[i].project,m=a[i].organization,h=a[i].icon,u=a[i].severity,C="TRUE"===a[i].isChangeAction,a[i].changeCoordinator&&(b=a[i].changeCoordinator),a[i].changeCoordinatorFullName&&(w=a[i].changeCoordinatorFullName);var A=0;"Medium"==u?A=1:"High"==u&&(A=2);var O=0;"In Work"==d?O=1:"In Approval"==d?O=2:"Approved"==d&&(O=3);var N={id:r,type:o,typeNLS:y,title:s,name:l,revision:c,maturity:d,maturityNLS:g,severity:u,severityNLS:p,description:v,collabspace:f,organization:m,iconURL:h,changeCoordinator:b,changeCoordinatorFullName:w,owner:a[i].owner,ownerFullName:a[i].ownerFullName,thumbnail:a[i].previewicon,severityGrade:A,stateGrade:O,isKindOfChangeAction:C,onHold:S,isKindOfType:t};n.push(N)}return n},processedChangeOrderPutOnHOld:function(e){return{id:e.userDisplayName.data[0].id,type:e.userDisplayName.data[0].type,accessBits:e.userDisplayName.data[0].dataelements}},processedChangeOrderOnResume:function(e){return{id:e.userDisplayName.data[0].id,type:e.userDisplayName.data[0].type,accessBits:e.userDisplayName.data[0].dataelements}},processedChangeOrderOnCancel:function(e){return{id:e.userDisplayName.data[0].id,type:e.userDisplayName.data[0].type,accessBits:e.userDisplayName.data[0].dataelements}},processedChangeRequestPutOnHoldResumeCancel:function(e){return{id:e.data[0].id,type:e.data[0].type,accessBits:e.data[0]}},processedChangeActionPutOnHoldResumeCancel:function(e){return{id:e.data[0].id,type:e.data[0].type,accessBits:e.data[0]}},processChangeActionInContext:function(n){var a=[],i=[],r=n.changeaction.name,o=n.changeaction.id;"pid"==o.substring(0,3)&&(o=o.substring(4));var s,l,c=n.changeaction.type,u=n.changeaction.type,d="",p="",g="",f="",m=(g="","");for(var h=n.changeaction.policy,v=(e.CHG_CA_Role_Owner,n.changeaction.attributes),C=0;C<v.length;C++)"current"==v[C].name?d=v[C].value:"attribute_Severity"==v[C].name?p=v[C].value:"attribute_Synopsis"==v[C].name?g=v[C].value:"interface[Change On Hold]"==v[C].name?v[C].value:"attribute_Originator"==v[C].name?f=v[C].value:"attribute_EstimatedCompletionDate"==v[C].name&&(m=v[C].value);m=m?new UWA.Date(m).strftime("%Y-%m-%d"):"";var S=0;"Medium"==p?S=1:"High"==p&&(S=2);var y=0;"In Work"==d?y=1:"In Approval"==d?y=2:"Approved"==d&&(y=3),s=e.get("CHG_CA_State_"+d),l=e.get("CHG_CA_Severity_"+p);var b=t.getGlobalVariable().collabspace,w=t.getGlobalVariable().organization,A=t.getGlobalVariable().computeUrl("/snresources/images/icons/large/I_ECM_CA108x144.png"),O=t.getGlobalVariable().computeUrl("/snresources/images/icons/small/I_ECM_CA.png"),N={title:g,name:r,maturity:d,severity:p,maturityNLS:s,severityNLS:l,owner:f,id:o,type:c,typeNLS:u,displayType:c,severityGrade:S,stateGrade:y,collabspaceNLS:b,organizationNLS:w,ownerFullName:t.getGlobalVariable().contextUserFullName,changeCoordinator:"",changeCoordinatorFullName:"",iconURL:O,thumbnail:A,isKindOfChangeAction:!0,isKindOfType:"ChangeAction",policy:h};return""!=m&&null!=m&&(N.dueDate=m),i.push(N),a.processData=i,a},processedChangeOrderMemberList:function(e){var n=[],a=e.data;if(null!=a)for(var i=0;i<a.length;i++){var r,o,s,l,c,u,d="",p="";d="Group"==(r=a[i].type)&&"OnPremise"!=t.getGlobalVariable().tenant&&a[i].dataelements.hasOwnProperty("groupURI")?a[i].dataelements.groupURI:a[i].id,o="Group"==r?a[i].dataelements.title:a[i].dataelements.name,s=a[i].dataelements.userid,p=a[i].dataelements.roles,l=a[i].dataelements.previewicon,c=a[i].dataelements.icon,u=p.toString();var g={id:d,type:r,fullName:o,userId:s,roles:p,role:u,thumbnail:l,icon:c,title:a[i].dataelements.title};n.push(g)}return n},processAllApprovedRoutes:function(e){for(var t="",n=0;n<e.length;n++)if(e[n].routeInfo.data[0].dataelements.actions.indexOf("selectusers.tasks")>-1){t=e[n].routeInfo.data[0].id;break}return t},processFacetDataPromise:function(e){return new Promise(function(t,n){var a={};if(null!=e){for(var i=0;i<e.length;i++){var o=e[i],s=o.sixw,l=s.lastIndexOf("/"),c=s.slice(l+1);a[c]?a[c].push(o.object):a[c]=[o.object]}r.getNLSValuesPromise(a).then(function(n){for(var a=0;a<e.length;a++){var i=e[a],r=i.sixw,o=r.lastIndexOf("/"),s=r.slice(o+1);n[s]&&n[s][i.object]?i.dispValue=n[s][i.object]:i.dispValue=i.object}t(e)},function(e){return n(e)})}else t(e)})},createPayloadApprovalStatusValue:function(e){let n=e.data;var a=[];if(null!=n){for(let e=0;e<n.length;e++){let t="",i={id:t=n[e].id};a.push(i)}var i={data:a,option:{tenant:t.getGlobalVariable().tenant,securityContext:decodeURIComponent(t.getGlobalVariable().getSecurityContext()),contextUserMailId:"testuser@gmail.com"}}}return i},processedCASummaryList:async function(e,n){let a=[],i=[],r=e.data;if("true"==t.getGlobalVariable().CHG_APPROVAL_COLUMN&&await o.getColumnApprovalStatusValue(u.createPayloadApprovalStatusValue(e)).then(function(e){e&&i.push(e)}),null!=r)for(let e=0;e<r.length;e++){let o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="",w="",A="",O="",N="",I="false",P="",E="ChangeAction",T="",R="",_="",D="";o=r[e].id,s=r[e].type,P=r[e].typeNLS,c=r[e].name,u=r[e].revision,l=r[e].title,d=r[e].severity,g=r[e].severityNLS,p=r[e].current,f=r[e].currentNLS,N=r[e].description,v=r[e].project,C=r[e].organization,S=r[e].icon,d=r[e].severity,T=r[e].applicability,D=r[e].policy,R=new UWA.Date(r[e].modified).strftime("%m/%d/%y %r"),_=new UWA.Date(r[e].originated).strftime("%m/%d/%y %r"),r[e].changeCoordinator&&(y=r[e].changeCoordinator),r[e].changeCoordinatorFullName&&(b=r[e].changeCoordinatorFullName),w=r[e].owner,A=r[e].ownerFullName,O=r[e].previewicon,I="TRUE"===r[e].ecm_change_on_hold?"true":"false";let F=0;"Medium"==d?F=1:"High"==d&&(F=2);let x=0;"In Work"==p?x=1:"In Approval"==p?x=2:"Approved"==p&&(x=3),"true"==t.getGlobalVariable().CHG_APPROVAL_COLUMN&&i&&i[0][o]&&(m=i[0][o].approvalStatus,h=i[0][o].approvalStatusModel);let L={id:o,type:s,typeNLS:P,title:l,name:c,revision:u,maturity:p,maturityNLS:f,severity:d,severityNLS:g,ApprovalStatus:m,approvalStatusModel:h,description:N,collabspace:v,organization:C,iconURL:S,changeCoordinator:y,changeCoordinatorFullName:b,owner:w,ownerFullName:A,thumbnail:O,severityGrade:F,stateGrade:x,onHold:I,isKindOfType:E,applicabilityNLS:T,modificationDate:R,creationDate:_,policy:D,interfaces:n};a.push(L)}return new Promise(function(e,t){u.getNLSForProcessedList("CRSummary",a).then(function(){e(a)},function(){e(a)})})},processedCRSummaryList:async function(e,n){let a=[],i=e.data,r=[];if("true"==t.getGlobalVariable().CHG_APPROVAL_COLUMN&&await o.getColumnApprovalStatusValue(u.createPayloadApprovalStatusValue(e)).then(function(e){e&&r.push(e)}),null!=i)for(let e=0;e<i.length;e++){let o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="",w="",A="",O="",N="",I="false",P="",E="ChangeRequest",T="",R="",_="",D="";o=i[e].id,s=i[e].type,P=i[e].typeNLS,c=i[e].name,u=i[e].revision,l=i[e].title,d=i[e].severity,g=i[e].severityNLS,p=i[e].current,f=i[e].currentNLS,N=i[e].description,m=i[e].project,h=i[e].organization,v=i[e].icon,d=i[e].severity,T=i[e].applicability,D=i[e].policy,R=new UWA.Date(i[e].modified).strftime("%m/%d/%y %r"),_=new UWA.Date(i[e].originated).strftime("%m/%d/%y %r"),i[e].changeCoordinator&&(C=i[e].changeCoordinator),i[e].changeCoordinatorFullName&&(S=i[e].changeCoordinatorFullName),y=i[e].owner,b=i[e].ownerFullName,O=i[e].previewicon,I="TRUE"===i[e].ecm_change_on_hold?"true":"false";let F=0;"Medium"==d?F=1:"High"==d&&(F=2);let x=0;"In Work"==p?x=1:"In Approval"==p?x=2:"Approved"==p&&(x=3),"true"==t.getGlobalVariable().CHG_APPROVAL_COLUMN&&r&&r[0][o]&&(w=r[0][o].approvalStatus,A=r[0][o].approvalStatusModel);let L={id:o,type:s,typeNLS:P,title:l,name:c,revision:u,maturity:p,maturityNLS:f,severity:d,severityNLS:g,ApprovalStatus:w,approvalStatusModel:A,description:N,collabspace:m,organization:h,iconURL:v,changeCoordinator:C,changeCoordinatorFullName:S,owner:y,ownerFullName:b,thumbnail:O,severityGrade:F,stateGrade:x,onHold:I,isKindOfType:E,applicabilityNLS:T,modificationDate:R,creationDate:_,policy:D,interfaces:n};a.push(L)}return new Promise(function(e,t){u.getNLSForProcessedList("CRSummary",a).then(function(){e(a)},function(){e(a)})})},processedIRSummaryList:function(e){let t=[],n=e.data;if(null!=n)for(let e=0;e<n.length;e++){let a="",i="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="false",w="",A="InvestigationRequest",O="",N="",I="",P="";a=n[e].id,i=n[e].type,w=n[e].typeNLS,o=n[e].name,s=n[e].revision,r=n[e].title,l=n[e].severity,u=n[e].severityNLS,c=n[e].current,d=n[e].currentNLS,y=n[e].description,p=n[e].project,g=n[e].organization,f=n[e].icon,l=n[e].severity,O=n[e].applicability,P=n[e].policy,N=new UWA.Date(n[e].modified).strftime("%m/%d/%y %r"),I=new UWA.Date(n[e].originated).strftime("%m/%d/%y %r"),n[e].changeCoordinator&&(m=n[e].changeCoordinator),n[e].changeCoordinatorFullName&&(h=n[e].changeCoordinatorFullName),v=n[e].owner,C=n[e].ownerFullName,S=n[e].previewicon,b="TRUE"===n[e].ecm_change_on_hold?"true":"false";let E=0;"Medium"==l?E=1:"High"==l&&(E=2);let T=0;"In Work"==c?T=1:"In Approval"==c?T=2:"Approved"==c&&(T=3);let R={id:a,type:i,typeNLS:w,title:r,name:o,revision:s,maturity:c,maturityNLS:d,severity:l,severityNLS:u,description:y,collabspace:p,organization:g,iconURL:f,changeCoordinator:m,changeCoordinatorFullName:h,owner:v,ownerFullName:C,thumbnail:S,severityGrade:E,stateGrade:T,onHold:b,isKindOfType:A,applicabilityNLS:O,modificationDate:N,creationDate:I,policy:P};t.push(R)}return new Promise(function(e,n){u.getNLSForProcessedList("CRSummary",t).then(function(){e(t)},function(){e(t)})})},processedChangeRequestNewIssueList:function(e){let n=[],a=t.getGlobalVariable();if(null!=e){let t="",i="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="";m=e.state,i=a.computeUrl("/"+e.iconurl),r=e.physicalId,g=e.type,p=e.title,s=e.organization,c=a.computeUrl("/"+e.image),u=e.collaborativeSpace,d=e.revision,o=e.name,l=e.owner.fullName,f=e.type;let v={type:g,state:m,revision:d,title:p,id:r,name:o,thumbnail:c,icon:i,maturity:t=e.policy+"."+e.state,ownerFullName:l,collabSpce:u,organization:s,policy:h=e.policy};n.push(v)}return new Promise(function(e,t){u.getNLSForProcessedList("createIssue",n).then(function(){e(n)},function(){e(n)})})},processCRChangeOrchestration:function(e){let t=[],n=e.data;if(null!=n)for(let e=0;e<n.length;e++){let a="",i="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="false",w="",A=!1,O=!1,N="",I="";a=n[e].id,i=n[e].type,w=n[e].typeNLS,o=n[e].name,s=n[e].revision,r=n[e].title,l=n[e].severity,u=n[e].severityNLS,c=n[e].current,d=n[e].currentNLS,y=n[e].description,p=n[e].project,g=n[e].organization,f=n[e].icon,l=n[e].severity,n[e].changeCoordinator&&(m=n[e].changeCoordinator),n[e].changeCoordinatorFullName&&(h=n[e].changeCoordinatorFullName),v=n[e].owner,C=n[e].ownerFullName,S=n[e].previewicon,I=n[e].policy,b="TRUE"===n[e].ecm_change_on_hold?"true":"false";let P=0;"Medium"==l?P=1:"High"==l&&(P=2);let E=0;"In Work"==c?E=1:"In Approval"==c?E=2:"Approved"==c&&(E=3),A="TRUE"===n[e].isChangeAction,O="TRUE"===n[e].isChangeRequest;let T={id:a,type:i,typeNLS:w,title:r,name:o,revision:s,maturity:c,maturityNLS:d,severity:l,severityNLS:u,description:y,collabspace:p,organization:g,iconURL:f,changeCoordinator:m,changeCoordinatorFullName:h,owner:v,ownerFullName:C,thumbnail:S,severityGrade:P,stateGrade:E,policy:I,ecm_change_on_hold:b,isKindOfType:N=1==A?"ChangeAction":1==O?"ChangeRequest":"ChangeOrder",isKindOfChangeAction:A,isKindOfChangeRequest:O};t.push(T)}return new Promise(function(e,n){u.getNLSForProcessedList("CROrchestration",t).then(function(){e(t)},function(){e(t)})})},processedChangeOrderDetail:function(e){var t=[],n=e.data;if(null!=n)for(var a=0;a<n.length;a++){var i,r,o,s,l,c,u,d,p,g,f,m,h,v,C="",S="";let e="ChangeOrder";i=n[a].id,r=n[a].type,v=n[a].dataelements.typeNLS,s=n[a].dataelements.name,l=n[a].dataelements.revision,o=n[a].dataelements.title,n[a].dataelements.severity,d=n[a].dataelements.severityNLS,u=n[a].dataelements.current,p=n[a].dataelements.currentNLS,h=n[a].dataelements.description,g=n[a].dataelements.project,f=n[a].dataelements.organization,m=n[a].dataelements.icon,c=n[a].dataelements.severity,n[a].dataelements.changeCoordinator&&(C=n[a].dataelements.changeCoordinator),n[a].dataelements.changeCoordinatorFullName&&(S=n[a].dataelements.changeCoordinatorFullName);var y=0;"Medium"==c?y=1:"High"==c&&(y=2);var b=0;"In Work"==u?b=1:"In Approval"==u?b=2:"Approved"==u&&(b=3);var w={id:i,type:r,typeNLS:v,title:o,name:s,revision:l,maturity:u,maturityNLS:p,severity:c,severityNLS:d,description:h,collabspace:g,organization:f,iconURL:m,changeCoordinator:C,changeCoordinatorFullName:S,owner:n[a].dataelements.owner,ownerFullName:n[a].dataelements.ownerFullName,thumbnail:n[a].dataelements.previewicon,severityGrade:y,stateGrade:b,onHold:"TRUE"===n[a].dataelements.ecm_change_on_hold?"true":"false",isKindOfType:e};t.push(w)}return t},processedChangeRequestMemberList:function(e){var n=[],a=e.data;if(null!=a)for(var i=0;i<a.length;i++){var r,o,s,l,c,u,d="",p="";d="Group"==(r=a[i].type)&&"OnPremise"!=t.getGlobalVariable().tenant?a[i].groupURI:a[i].id,o="Group"==r?a[i].title:a[i].name,s=a[i].userid,p=a[i].roles,l=a[i].previewicon,c=a[i].icon,u=p.toString();var g={id:d,type:r,fullName:o,userId:s,roles:p,role:u,thumbnail:l,icon:c,title:a[i].title};n.push(g)}return n},processedChangeRequestIssueList:function(e){var t=[],n=e.data;if(null!=n)for(var a=0;a<n.length;a++){var i,r,o,s,l,c,u,d;r=n[a].id,l=n[a].typeNLS,d=n[a].typeNLS,u=n[a].type,c=n[a].title,o=n[a].ownerFullName,s=n[a].previewicon,i=n[a].icon;var p={type:u,typeNLS:d,revision:l,title:c,id:r,name:n[a].name,thumbnail:s,icon:i,maturity:n[a].current,maturityNLS:n[a].currentNLS,ownerFullName:o,collabSpce:n[a].project,organization:n[a].organization,relId:n[a].relId,policy:n[a].policyNLS,policyNLS:n[a].policyNLS};t.push(p)}return t},processedChangeRequestRelatedScope:function(e){var t=[],n=e.data;if(null!=n)for(var a=0;a<n.length;a++){var i,r,o,s,l,c,d,p,g,f,m,h,v,C,S;s=n[a].id,m=n[a].revision,C=n[a].typeNLS,v=n[a].type,h=n[a].title,d=n[a].ownerFullName,p=n[a].previewicon,o=n[a].icon,l=n[a].name,i=n[a].status,r=n[a].currentNLS,g=n[a].project,c=n[a].organization,f=n[a].relId,S=n[a].sourceType;var y={type:v,typeNLS:C,revision:m,title:h,id:s,name:l,previewicon:p,icon:o,maturity:i,maturityNLS:r,ownerFullName:d,collabSpce:g,organization:c,relId:f,policy:n[a].policy,sourceType:S,kind:n[a]["ds6w:kind"],serviceBasedObjId:s};t.push(y)}return new Promise(function(e,n){u.getNLSForProcessedList("ReportedAgainst",t).then(function(){e(t)},function(){e(t)})})},processCRAffectedItems:function(e){var t=void 0,n=new Array,a=[],i=e.data;if(null!=i)for(var r=0;r<i.length;r++){i[r].interface&&(t=new Set(i[r].interface)),i.classes&&(n=[...n,...this.getProposedClassifiedInterfaces(data.classes)]);let e=[];t&&(e=(e=Array.from(t)).filter(e=>""!==e));let o=[];n&&n.length>0&&(o=n.filter(e=>""!==e.name));let s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S=0,y="",b="",w="",A="",O="",N="",I="";l=i[r].id,c=i[r].type,g=i[r].name,C=i[r].status,v=i[r].currentNLS,s=i[r].title,d=i[r].previewicon,p=i[r].icon,m=i[r].project,h=i[r].organization,u=i[r].typeNLS;let P={id:l,type:c,revision:f=i[r].revision,typeNLS:u,thumbnail:d,maturity:C,maturityNLS:v,icon:p,name:g,title:s,countImpactAnalysis:S=i[r].impactAnalysis.length,collabspace:m,organization:h,reasonForChange:y=i[r].reasonForChange,ownerFullName:b=i[r].ownerFullName,policy:w=i[r].policy,policyNLS:A=i[r].policyNLS,sourceType:O=i[r].sourceType,serviceName:N=i[r].service,kind:I=i[r]["ds6w:kind"],serviceBasedObjId:l,interfaces:e,classes:o};a.push(P)}return new Promise(async function(e,t){await u.getNLSForProcessedListFromSource("CRAffectedItems",a),e(a)})},processCRAffectedWithi3dxItems:function(e,t){var n=[],a=e.data;for(let e=0;e<a.length;e++){let i=0,r="",o="",s="",l=u.filterInformationFromFetchUri(a[e]),c=l.i3dx;if(t.has(c)){let e=t.get(c);r=e.reasonForChange,s=e.service,o=e.sourceType,i=e.impactAnalysis.length,t.delete(e.id)}let d={id:l.i3dx,type:l.type,revision:l.revision,typeNLS:l.typeNLS,thumbnail:l.thumbnail,maturity:l.maturity,maturityNLS:l.maturityNLS,icon:l.icon,name:l.name,title:l.title,countImpactAnalysis:i,collabspace:l.collabSpce,organization:l.organization,reasonForChange:r,ownerFullName:l.ownerFullName,sourceType:o,serviceName:s,policy:l.policy,kind:l["ds6w:kind"],serviceBasedObjId:l.id};n.push(d)}return new Promise(async function(e,t){await u.getNLSForProcessedListFromSource("CRAffectedItems",n),e(n)})},processIRAffectedItems:function(e){var t=[],n=e.data;if(null!=n)for(var a=0;a<n.length;a++){let e="",i="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="",w="";i=n[a].id,r=n[a].type,c=n[a].name,f=n[a].status,g=n[a].currentNLS,e=n[a].title,s=n[a].previewicon,l=n[a].icon,d=n[a].project,p=n[a].organization,o=n[a].typeNLS,u=n[a].revision,m=n[a].reasonForChange,h=n[a].ownerFullName,v=n[a].policy,C=n[a].policyNLS,S=n[a].sourceType,y=n[a].service,b=n[a]["ds6w:kind"],n[a].DispositionInformation&&(w=n[a].DispositionInformation);let A={id:i,type:r,revision:u,typeNLS:o,thumbnail:s,maturity:f,maturityNLS:g,icon:l,name:c,title:e,collabspace:d,organization:p,reasonForChange:m,ownerFullName:h,policy:v,policyNLS:C,sourceType:S,serviceName:y,kind:b,serviceBasedObjId:i,dispositionInformation:w};t.push(A)}return new Promise(async function(e,n){await u.getNLSForProcessedListFromSource("CRAffectedItems",t),e(t)})},processIAImpacts:function(e){var t=[],n=e.data;if(null!=n)for(var a=0;a<n.length;a++){let e="",i="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="",w="",A="",O="",N="",I="",P="";i=n[a].id,r=n[a].type,u=n[a].name,m=n[a].status,f=n[a].currentNLS,e=n[a].title,s=n[a].previewicon,l=n[a].previewicon,c=n[a].icon,p=n[a].project,O=n[a].project,g=n[a].organization,o=n[a].typeNLS;let E={id:i,type:r,revision:d=n[a].revision,typeNLS:o,thumbnail:s,previewicon:l,current:m,currentNLS:f,icon:c,name:u,title:e,collabspace:p,project:O,organization:g,reasonForChange:v="",impactedItem:C="IMPACTED",ownerFullName:S=n[a].ownerFullName,policy:y=n[a].policy,policyNLS:b=n[a].policyNLS,sourceType:w=n[a].sourceType,serviceName:A=n[a].service,service:N=n[a].service,owner:h=n[a].owner,cestamp:I=n[a].cestamp,kind:P=n[a]["ds6w:kind"],serviceBasedObjId:i};t.push(E)}return new Promise(function(e,n){u.getNLSForProcessedList("IAImpacts",t).then(function(){e(t)},function(){e(t)})})},processIAImpactsForGet:function(e){var t=void 0,n=new Array,a=[],i=e;if(null!=i)for(var r=0;r<i.length;r++){i[r].interface&&(t=new Set(i[r].interface)),i.classes&&(n=[...n,...this.getProposedClassifiedInterfaces(data.classes)]);let e=[];t&&(e=(e=Array.from(t)).filter(e=>""!==e));let o=[];n&&n.length>0&&(o=n.filter(e=>""!==e.name));let s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="",w="",A="",O="",N="",I="",P="",E="",T="",R="",_="";l=i[r].id,c=i[r].type,f=i[r].name,S=i[r].status,C=i[r].currentNLS,s=i[r].title,d=i[r].previewicon,p=i[r].previewicon,g=i[r].icon,h=i[r].project,E=i[r].project,v=i[r].organization,u=i[r].typeNLS;let D={id:l,type:c,revision:m=i[r].revision,typeNLS:u,thumbnail:d,previewicon:p,current:S,currentNLS:C,icon:g,name:f,title:s,collabspace:h,project:E,organization:v,reasonForChange:b=i[r].reasonForChange,impactedItem:w=i[r].impactedItem,ownerFullName:A=i[r].ownerFullName,policy:O=i[r].policy,policyNLS:N=i[r].policyNLS,sourceType:I=i[r].sourceType,serviceName:P=i[r].service,service:T=i[r].service,owner:y=i[r].owner,cestamp:R=i[r].cestamp,kind:_=i[r]["ds6w:kind"],serviceBasedObjId:l,interfaces:e,classes:o};a.push(D)}return new Promise(async function(e,t){await u.getNLSForProcessedList("IAImpacts",a),e(a)})},processIAAnalysisBasis:function(e){var t=[],n=e.data;if(null!=n)for(var a=0;a<n.length;a++){let e="",i="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="",w="",A="",O="",N="",I="";i=n[a].id,r=n[a].type,u=n[a].name,m=n[a].status,f=n[a].currentNLS,e=n[a].title,s=n[a].previewicon,l=n[a].previewicon,c=n[a].icon,p=n[a].project,A=n[a].project,g=n[a].organization,o=n[a].typeNLS;let P={id:i,type:r,revision:d=n[a].revision,typeNLS:o,thumbnail:s,previewicon:l,current:m,currentNLS:f,icon:c,name:u,title:e,collabspace:p,project:A,organization:g,reasonForChange:v="",ownerFullName:C=n[a].ownerFullName,policy:S=n[a].policy,policyNLS:y=n[a].policyNLS,sourceType:b=n[a].sourceType,serviceName:w=n[a].service,service:O=n[a].service,owner:h=n[a].owner,cestamp:N=n[a].cestamp,kind:I=n[a]["ds6w:kind"],serviceBasedObjId:i};t.push(P)}return new Promise(function(e,n){u.getNLSForProcessedList("IAImpactBasis",t).then(function(){e(t)},function(){e(t)})})},processIAAnalysisBasisWithi3dxItems:function(e,t){var n=[],a=e.data;for(let e=0;e<a.length;e++){let i="",r="",o="",s=u.filterInformationFromFetchUri(a[e]),l=s.i3dx;if(t.has(l)){let e=t.get(l);i=e.reasonForChange,o=e.service,r=e.sourceType,t.delete(e.id)}let c={id:s.i3dx,type:s.type,revision:s.revision,typeNLS:s.typeNLS,thumbnail:s.thumbnail,maturity:s.maturity,maturityNLS:s.maturityNLS,icon:s.icon,name:s.name,title:s.title,collabspace:s.collabSpce,organization:s.organization,reasonForChange:i,ownerFullName:s.ownerFullName,sourceType:r,serviceName:o,policy:s.policy,kind:s["ds6w:kind"],serviceBasedObjId:s.id};n.push(c)}return new Promise(async function(e,t){await u.getNLSForProcessedListFromSource("IAImpactBasis",n),e(n)})},processIAImpactsWithi3dxItems:function(e,t){var n=[],a=e.data;for(let e=0;e<a.length;e++){let i="",r="",o="",s=u.filterInformationFromFetchUri(a[e]),l=s.i3dx;if(t.has(l)){let e=t.get(l);i=e.reasonForChange,o=e.service,r=e.sourceType,t.delete(e.id)}let c={id:s.i3dx,type:s.type,revision:s.revision,typeNLS:s.typeNLS,thumbnail:s.thumbnail,maturity:s.maturity,maturityNLS:s.maturityNLS,icon:s.icon,name:s.name,title:s.title,collabspace:s.collabSpce,organization:s.organization,reasonForChange:i,ownerFullName:s.ownerFullName,sourceType:r,serviceName:o,policy:s.policy,kind:s["ds6w:kind"],serviceBasedObjId:s.id};n.push(c)}return new Promise(async function(e,t){await u.getNLSForProcessedListFromSource("IAImpacts",n),e(n)})},processIAAnalysisBasisForGet:function(e){var t=void 0,n=new Array,a=[],i=e;if(null!=i)for(var r=0;r<i.length;r++){i[r].interface&&(t=new Set(i[r].interface)),i.classes&&(n=[...n,...this.getProposedClassifiedInterfaces(data.classes)]);let e=[];t&&(e=(e=Array.from(t)).filter(e=>""!==e));let o=[];n&&n.length>0&&(o=n.filter(e=>""!==e.name));let s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="",w="",A="",O="",N="",I="",P="",E="",T="",R="";l=i[r].id,c=i[r].type,f=i[r].name,S=i[r].status,C=i[r].currentNLS,s=i[r].title,d=i[r].previewicon,p=i[r].previewicon,g=i[r].icon,h=i[r].project,P=i[r].project,v=i[r].organization,u=i[r].typeNLS;let _={id:l,type:c,revision:m=i[r].revision,typeNLS:u,thumbnail:d,previewicon:p,current:S,currentNLS:C,icon:g,name:f,title:s,collabspace:h,project:P,organization:v,reasonForChange:b=i[r].reasonForChange,ownerFullName:w=i[r].ownerFullName,policy:A=i[r].policy,policyNLS:O=i[r].policyNLS,sourceType:N=i[r].sourceType,serviceName:I=i[r].service,service:E=i[r].service,owner:y=i[r].owner,cestamp:T=i[r].cestamp,kind:R=i[r]["ds6w:kind"],serviceBasedObjId:l,interfaces:e,classes:o};a.push(_)}return new Promise(function(e,t){u.getNLSForProcessedList("IAImpactBasis",a).then(function(){e(a)},function(){e(a)})})},processCAContextItems:function(e){var t=[],n=e.data;if(null!=n)for(var a=0;a<n.length;a++){let e="",i="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="";i=n[a].id,r=n[a].type,c=n[a].name,f=n[a].status,g=n[a].currentNLS,e=n[a].title,s=n[a].previewicon,l=n[a].icon,d=n[a].project,p=n[a].organization,o=n[a].typeNLS;let w={id:i,type:r,revision:u=n[a].revision,typeNLS:o,thumbnail:s,current:f,currentNLS:g,icon:l,name:c,title:e,collabspace:d,organization:p,reasonForChange:m=n[a].reasonForChange,ownerFullName:h=n[a].ownerFullName,policy:v=n[a].policy,policyNLS:C=n[a].policyNLS,sourceType:S=n[a].sourceType,serviceName:y=n[a].service,kind:b=n[a]["ds6w:kind"],serviceBasedObjId:i};t.push(w)}return new Promise(function(e,n){u.getNLSForProcessedList("CAContextItems",t).then(function(){e(t)},function(){e(t)})})},processedInvestigationRequestIssueList:function(e){var t=[],n=e.data;if(null!=n)for(var a=0;a<n.length;a++){var i,r,o,s,l,c,u,d;r=n[a].id,l=n[a].typeNLS,d=n[a].typeNLS,u=n[a].type,c=n[a].title,o=n[a].ownerFullName,s=n[a].previewicon,i=n[a].icon;var p={type:u,typeNLS:d,revision:l,title:c,id:r,name:n[a].name,thumbnail:s,icon:i,maturity:n[a].current,maturityNLS:n[a].currentNLS,ownerFullName:o,collabSpce:n[a].project,organization:n[a].organization,relId:n[a].relId,policy:n[a].policyNLS,policyNLS:n[a].policyNLS};t.push(p)}return t},processInformationForRecentCRAffected:function(e){var t=[],n=new Set;for(let i=0;i<e.length;i++){let r=0,o="",s="",l="",c="",d=u.parsingInformationFromRecentSearch(e[i].nonIndexedData);var a=e[i].nonIndexedModelerData;a&&(a.reasonForChange&&(o=a.reasonForChange),a.service&&(l=a.service),a.sourceType&&(s=a.sourceType),a.impactAnalysis&&(r=a.impactAnalysis.length),a["ds6w:kind"]&&(c=a["ds6w:kind"])),n.add(d.ownerFullName);let p={id:d.id,type:d.type,revision:d.revision,typeNLS:d.typeNLS,thumbnail:d.thumbnail,maturity:d.maturity,maturityNLS:d.maturityNLS,icon:d.icon,name:d.name,title:d.title,countImpactAnalysis:r,collabspace:d.collabSpce,organization:d.organization,reasonForChange:o,ownerFullName:d.ownerFullName,sourceType:s,serviceName:l,policy:d.policy,kind:c,serviceBasedObjId:d.id};t.push(p)}let i="";return i="("+(i=u.getQueryFromTriagram(n))+")",console.log(i),new Promise(async function(e,n){var a=u.predicatesForFullNameForRecentData();const o=await Promise.all([u.getNLSForProcessedList("CRAffectedItems",t),r.federatedSearch(i,a)]);e(t=u.getOwnerFullNameForRecent(o[1],t))})},processInformationForRecentIRAffected:function(e){var t=[],n=new Set;for(let i=0;i<e.length;i++){let r=0,o="",s="",l="",c="",d="",p=u.parsingInformationFromRecentSearch(e[i].nonIndexedData);var a=e[i].nonIndexedModelerData;a&&(a.reasonForChange&&(o=a.reasonForChange),a.service&&(l=a.service),a.sourceType&&(s=a.sourceType),a.impactAnalysis&&(r=a.impactAnalysis.length),a["ds6w:kind"]&&(c=a["ds6w:kind"]),a.DispositionInformation&&(c=a.DispositionInformation)),n.add(p.ownerFullName);let g={id:p.id,type:p.type,revision:p.revision,typeNLS:p.typeNLS,thumbnail:p.thumbnail,maturity:p.maturity,maturityNLS:p.maturityNLS,icon:p.icon,name:p.name,title:p.title,countImpactAnalysis:r,collabspace:p.collabSpce,organization:p.organization,reasonForChange:o,ownerFullName:p.ownerFullName,sourceType:s,serviceName:l,policy:p.policy,kind:c,serviceBasedObjId:p.id,dispositionInformation:d};t.push(g)}let i="";return i="("+(i=u.getQueryFromTriagram(n))+")",console.log(i),new Promise(async function(e,n){var a=u.predicatesForFullNameForRecentData();const o=await Promise.all([u.getNLSForProcessedList("CRAffectedItems",t),r.federatedSearch(i,a)]);e(t=u.getOwnerFullNameForRecent(o[1],t))})},processInformationForRecentIAImpactBasis:function(e){var t=[],n=new Set;for(let r=0;r<e.length;r++){let o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="",w="",A="",O="";for(let t=0;t<e[r].nonIndexedData.length;t++){var a=e[r].nonIndexedData[t];"resourceid"==a.name?s=a.value:"type_icon_url"==a.name?d=a.value:"preview_url"==a.name?u=a.value:"ds6w:identifier"==a.name?p=a.value:"ds6w:label"==a.name?o=a.value:"ds6w:type"==a.name?(l=a.value,c=a.dispValue):"ds6wg:revision"==a.name?g=a.value:"ds6w:status"==a.name?(A=a.value.split(".")[0],C=a.value.split(".")[1],v=a.dispValue):"ds6w:organizationResponsible"==a.name?(m=a.value,h=a.dispValue):"ds6w:project"==a.name?f=a.value:"ds6w:responsible"==a.name&&(y=a.value,O=a.value,n.add(y))}var i=e[r].nonIndexedModelerData;i&&(i.reasonForChange&&(S=i.reasonForChange),i.service&&(w=i.service),i.sourceType&&(b=i.sourceType));let N={id:s,type:l,revision:g,typeNLS:c,thumbnail:u,previewicon:u,current:C,currentNLS:v,icon:d,name:p,title:o,collabspace:f,organization:m,reasonForChange:S,ownerFullName:y,sourceType:b,serviceName:w,policy:A,owner:O,serviceBasedObjId:s};t.push(N)}let o="";return o="("+(o=u.getQueryFromTriagram(n))+")",console.log(o),new Promise(async function(e,n){var a=u.predicatesForFullNameForRecentData();const i=await Promise.all([u.getNLSForProcessedList("IAImpactBasis",t),r.federatedSearch(o,a)]);e(t=u.getOwnerFullNameForRecent(i[1],t))})},processInformationForRecentIAImpacts:function(e){var t=[],n=new Set;for(let r=0;r<e.length;r++){let o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S=0,y="",b="",w="",A="",O="",N="",I="";for(let t=0;t<e[r].nonIndexedData.length;t++){var a=e[r].nonIndexedData[t];"resourceid"==a.name?s=a.value:"type_icon_url"==a.name?d=a.value:"preview_url"==a.name?u=a.value:"ds6w:identifier"==a.name?p=a.value:"ds6w:label"==a.name?o=a.value:"ds6w:type"==a.name?(l=a.value,c=a.dispValue):"ds6wg:revision"==a.name?g=a.value:"ds6w:status"==a.name?(N=a.value.split(".")[0],C=a.value.split(".")[1],v=a.dispValue):"ds6w:organizationResponsible"==a.name?(m=a.value,h=a.dispValue):"ds6w:project"==a.name?f=a.value:"ds6w:responsible"==a.name&&(w=a.value,I=a.value,n.add(w))}var i=e[r].nonIndexedModelerData;i&&(i.reasonForChange&&(y=i.reasonForChange),i.service&&(O=i.service),i.sourceType&&(A=i.sourceType),i.impactAnalysis&&(S=i.impactAnalysis.length),i.impactedItem&&(b=i.impactedItem));let P={id:s,type:l,revision:g,typeNLS:c,thumbnail:u,previewicon:u,current:C,currentNLS:v,icon:d,name:p,title:o,countImpactAnalysis:S,collabspace:f,organization:m,reasonForChange:y,ownerFullName:w,sourceType:A,serviceName:O,impactedItem:b,policy:N,owner:I,serviceBasedObjId:s};t.push(P)}let o="";return o="("+(o=u.getQueryFromTriagram(n))+")",console.log(o),new Promise(async function(e,n){var a=u.predicatesForFullNameForRecentData();const i=await Promise.all([u.getNLSForProcessedList("IAImpacts",t),r.federatedSearch(o,a)]);e(t=u.getOwnerFullNameForRecent(i[1],t))})},processInformationForRecentCAContext:function(e){var t=[],n=new Set;for(let r=0;r<e.length;r++){let o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="",w="";for(let t=0;t<e[r].nonIndexedData.length;t++){var a=e[r].nonIndexedData[t];"resourceid"==a.name?s=a.value:"type_icon_url"==a.name?d=a.value:"preview_url"==a.name?u=a.value:"ds6w:identifier"==a.name?p=a.value:"ds6w:label"==a.name?o=a.value:"ds6w:type"==a.name?(l=a.value,c=a.dispValue):"ds6wg:revision"==a.name?g=a.value:"ds6w:status"==a.name?(w=a.value.split(".")[0],C=a.value.split(".")[1],v=a.dispValue):"ds6w:organizationResponsible"==a.name?(m=a.value,h=a.dispValue):"ds6w:project"==a.name?f=a.value:"ds6w:responsible"==a.name&&(S=a.value,n.add(S))}var i=e[r].nonIndexedModelerData;i&&(i.service&&(b=i.service),i.sourceType&&(y=i.sourceType));let A={id:s,type:l,revision:g,typeNLS:c,thumbnail:u,previewicon:u,current:C,currentNLS:v,icon:d,name:p,title:o,collabspace:f,organization:m,ownerFullName:S,sourceType:y,serviceName:b,policy:w,serviceBasedObjId:s};t.push(A)}let o="";return o="("+(o=u.getQueryFromTriagram(n))+")",console.log(o),new Promise(async function(e,n){var a=u.predicatesForFullNameForRecentData();const i=await Promise.all([u.getNLSForProcessedList("CAContextItems",t),r.federatedSearch(o,a)]);e(t=u.getOwnerFullNameForRecent(i[1],t))})},processInformationForRecentReportedAgainst:function(e){var t=[],n=new Set;for(let r=0;r<e.length;r++){let o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="",w="";for(let t=0;t<e[r].nonIndexedData.length;t++){var a=e[r].nonIndexedData[t];"resourceid"==a.name?s=a.value:"type_icon_url"==a.name?d=a.value:"preview_url"==a.name?u=a.value:"ds6w:identifier"==a.name?p=a.value:"ds6w:label"==a.name?o=a.value:"ds6w:type"==a.name?(l=a.value,c=a.dispValue):"ds6wg:revision"==a.name?g=a.value:"ds6w:status"==a.name?(w=a.value.split(".")[0],C=a.value.split(".")[1],v=a.dispValue):"ds6w:organizationResponsible"==a.name?(m=a.value,h=a.dispValue):"ds6w:project"==a.name?f=a.value:"ds6w:responsible"==a.name&&(S=a.value,n.add(S))}var i=e[r].nonIndexedModelerData;i&&(i.service&&(b=i.service),i.sourceType&&(y=i.sourceType));let A={id:s,type:l,revision:g,typeNLS:c,thumbnail:u,previewicon:u,maturity:C,maturityNLS:v,icon:d,name:p,title:o,collabspace:f,organization:m,ownerFullName:S,sourceType:y,serviceName:b,policy:w,serviceBasedObjId:s};t.push(A)}let o="";return o="("+(o=u.getQueryFromTriagram(n))+")",console.log(o),new Promise(async function(e,n){var a=u.predicatesForFullNameForRecentData();const i=await Promise.all([u.getNLSForProcessedList("ReportedAgainst",t),r.federatedSearch(o,a)]);e(t=u.getOwnerFullNameForRecent(i[1],t))})},processCRAffectedItemsFederatedSearch:function(e,t){var n=[],a=e.results;for(let e=0;e<a.length;e++){let i=0,r="",o="",s="",l=u.filterInformationFromFederatedSearch(a[e].attributes),c=l.i3dx?l.i3dx:l.id;if(t.get(c)){let e=t.get(c);r=e.reasonForChange,s=e.service,o=e.sourceType,i=e.impactAnalysis.length,t.delete(e.id)}let d={id:l.i3dx?l.i3dx:l.id,type:l.type,revision:l.revision,typeNLS:l.typeNLS,thumbnail:l.thumbnail,maturity:l.maturity,maturityNLS:l.maturityNLS,icon:l.icon,name:l.name,title:l.title,countImpactAnalysis:i,collabspace:l.collabSpce,organization:l.organization,reasonForChange:r,ownerFullName:l.ownerFullName,sourceType:o,serviceName:s,policy:l.policy,kind:l["ds6w:kind"],serviceBasedObjId:l.id};n.push(d)}return new Promise(async function(e,t){await u.getNLSForProcessedListFromSource("CRAffectedItems",n),e(n)})},processIRAffectedItemsFederatedSearch:function(e,t){var n=[],a=e.results;for(let e=0;e<a.length;e++){let i=0,r="",o="",s="",l=u.filterInformationFromFederatedSearch(a[e].attributes),c=l.i3dx?l.i3dx:l.id;if(t.get(c)){let e=t.get(c);r=e.reasonForChange,s=e.service,o=e.sourceType,i=e.impactAnalysis.length,t.delete(e.id)}let d={id:l.i3dx?l.i3dx:l.id,type:l.type,revision:l.revision,typeNLS:l.typeNLS,thumbnail:l.thumbnail,maturity:l.maturity,maturityNLS:l.maturityNLS,icon:l.icon,name:l.name,title:l.title,countImpactAnalysis:i,collabspace:l.collabSpce,organization:l.organization,reasonForChange:r,ownerFullName:l.ownerFullName,sourceType:o,serviceName:s,policy:l.policy,kind:l["ds6w:kind"],serviceBasedObjId:l.id};n.push(d)}return new Promise(async function(e,t){await u.getNLSForProcessedListFromSource("CRAffectedItems",n),e(n)})},processIAAnalysisBasisFederatedSearch:function(e,t){var n=[],a=e.results;for(let e=0;e<a.length;e++){let i="",r="",o="",s=u.filterInformationFromFederatedSearch(a[e].attributes),l=s.i3dx?s.i3dx:s.id;if(t.get(l)){let e=t.get(l);i=e.reasonForChange,o=e.service,r=e.sourceType,t.delete(e.id)}let c={id:s.i3dx?s.i3dx:s.id,type:s.type,revision:s.revision,typeNLS:s.typeNLS,thumbnail:s.thumbnail,previewicon:s.thumbnail,current:s.maturity,currentNLS:s.maturityNLS,icon:s.icon,name:s.name,title:s.title,collabspace:s.collabSpce,organization:s.organization,reasonForChange:i,ownerFullName:s.ownerFullName,sourceType:r,serviceName:o,policy:s.policy,kind:s["ds6w:kind"],owner:s.owner,serviceBasedObjId:s.id};n.push(c)}return new Promise(async function(e,t){await u.getNLSForProcessedListFromSource("IAImpactBasis",n),e(n)})},processIAImpactsFederatedSearch:function(e,t){var n=[],a=e.results;for(let e=0;e<a.length;e++){let i="",r="",o="",s="",l=u.filterInformationFromFederatedSearch(a[e].attributes),c=l.i3dx?l.i3dx:l.id;if(t.get(c)){let e=t.get(c);i=e.reasonForChange,s=e.service,o=e.sourceType,r=e.impactedItem,t.delete(e.id)}let d={id:l.i3dx?l.i3dx:l.id,type:l.type,revision:l.revision,typeNLS:l.typeNLS,thumbnail:l.thumbnail,previewicon:l.thumbnail,current:l.maturity,currentNLS:l.maturityNLS,icon:l.icon,name:l.name,title:l.title,collabspace:l.collabSpce,organization:l.organization,reasonForChange:i,impactedItem:r,ownerFullName:l.ownerFullName,sourceType:o,serviceName:s,policy:l.policy,kind:l["ds6w:kind"],owner:l.owner,serviceBasedObjId:l.id};n.push(d)}return new Promise(async function(e,t){await u.getNLSForProcessedListFromSource("IAImpactBasis",n),e(n)})},processCAContextItemsFederatedSearch:function(e,t){var n=[],a=e.results;for(let e=0;e<a.length;e++){let i="",r="",o=u.filterInformationFromFederatedSearch(a[e].attributes),s=o.i3dx?o.i3dx:o.id;if(t.get(s)){let e=t.get(s);r=e.service,i=e.sourceType,t.delete(e.id)}let l={id:o.i3dx?o.i3dx:o.id,type:o.type,revision:o.revision,typeNLS:o.typeNLS,thumbnail:o.thumbnail,previewicon:o.thumbnail,current:o.maturity,currentNLS:o.maturityNLS,icon:o.icon,name:o.name,title:o.title,collabspace:o.collabSpce,organization:o.organization,ownerFullName:o.ownerFullName,sourceType:i,serviceName:r,policy:o.policy,kind:o["ds6w:kind"],owner:o.owner,serviceBasedObjId:o.id};n.push(l)}return new Promise(async function(e,t){await u.getNLSForProcessedListFromSource("CAContextItems",n),e(n)})},processReportedAgainstFederatedSearch:function(e,t){var n=[],a=e.results;for(let e=0;e<a.length;e++){let i="",r="",o=u.filterInformationFromFederatedSearch(a[e].attributes),s=o.i3dx?o.i3dx:o.id;if(t.get(s)){let e=t.get(s);r=e.service,i=e.sourceType,t.delete(e.id)}let l={id:o.i3dx?o.i3dx:o.id,type:o.type,revision:o.revision,typeNLS:o.typeNLS,thumbnail:o.thumbnail,previewicon:o.thumbnail,current:o.maturity,currentNLS:o.maturityNLS,icon:o.icon,name:o.name,title:o.title,collabspace:o.collabSpce,organization:o.organization,ownerFullName:o.ownerFullName,sourceType:i,serviceName:r,policy:o.policy,kind:o["ds6w:kind"],owner:o.owner,serviceBasedObjId:o.id};n.push(l)}return new Promise(async function(e,t){await u.getNLSForProcessedListFromSource("CAContextItems",n),e(n)})},filterInformationFromFederatedSearch:function(e){let t={};for(let a=0;a<e.length;a++){var n=e[a];"resourceid"==n.name?t.id=n.value:"type_icon_url"==n.name?t.icon=n.value:"preview_url"==n.name?t.thumbnail=n.value:"ds6w:identifier"==n.name?t.name=n.value:"ds6w:label"==n.name?t.title=n.value:"ds6w:what/ds6w:type"==n.name?(t.type=n.value,t.typeNLS=n.value):"ds6wg:revision"==n.name?t.revision=n.value:"ds6w:what/ds6w:status"==n.name?n.value.includes(".")?(t.policy=n.value.split(".")[0],t.maturity=n.value.split(".")[1],t.maturityNLS=n.value.split(".")[1]):(t.maturity=n.value,t.maturityNLS=n.value):"ds6w:who/ds6w:responsible/ds6w:organizationResponsible"==n.name?(t.organization=n.value,t.organizationNLS=n.value):"ds6w:where/ds6w:context/ds6w:project"==n.name?t.collabSpce=n.value:"ds6w:who/ds6w:responsible"==n.name?t.ownerFullName=n.value:"ds6w:what/ds6w:i3dx"==n.name||"ds6w:i3dx"==n.name?t.i3dx=n.value:"ds6w:what/ds6w:kind"==n.name&&(t["ds6w:kind"]=n.value)}return t},filterInformationFromFetchUri:function(e){let t={};if(e.hasOwnProperty("objectState")&&(t.objectState=e.objectState),e.hasOwnProperty("ds6w:icon")&&(t.icon=e["ds6w:icon"]),e.hasOwnProperty("ds6w:previewURL")&&(t.thumbnail=e["ds6w:previewURL"]),e.hasOwnProperty("ds6w:identifier")&&(t.name=e["ds6w:identifier"]),e.hasOwnProperty("ds6w:label")&&(t.title=e["ds6w:label"]),e.hasOwnProperty("ds6w:type")&&(t.type=e["ds6w:type"],t.typeNLS=e["ds6w:type"]),e.hasOwnProperty("ds6wg:revision")&&(t.revision=e["ds6wg:revision"]),e.hasOwnProperty("ds6w:status")){var n=e["ds6w:status"];n.includes(".")?(t.policy=n.split(".")[0],t.maturity=n.split(".")[1],t.maturityNLS=n.split(".")[1]):(t.maturity=n,t.maturityNLS=n)}return e.hasOwnProperty("ds6w:project")&&(t.collabSpce=e["ds6w:project"]),e.hasOwnProperty("ds6wg:responsible")&&(t.ownerFullName=e["ds6wg:responsible"]),e.hasOwnProperty("ds6w:i3dx")&&(t.i3dx=e["ds6w:i3dx"]),e.hasOwnProperty("ds6w:kind")&&(t["ds6w:kind"]=e["ds6w:kind"]),t},parsingInformationFromRecentSearch:function(e){let t={};for(let a=0;a<e.length;a++){var n=e[a];"resourceid"==n.name?t.id=n.value:"type_icon_url"==n.name?t.icon=n.value:"preview_url"==n.name?t.thumbnail=n.value:"ds6w:identifier"==n.name?t.name=n.value:"ds6w:label"==n.name?t.title=n.value:"ds6w:type"==n.name?(t.type=n.value,t.typeNLS=n.dispValue):"ds6wg:revision"==n.name?t.revision=n.value:"ds6w:status"==n.name?(t.policy=n.value.split(".")[0],t.maturity=n.value.split(".")[1],t.maturityNLS=n.dispValue):"ds6w:organizationResponsible"==n.name?(t.organization=n.value,t.organizationNLS=n.dispValue):"ds6w:project"==n.name?t.collabSpce=n.value:"ds6w:responsible"==n.name&&(t.ownerFullName=n.value)}return t},callFederatedSearch:async function(e,t){var n=u.getQueryForNon3DSpace(e);return new Promise(async function(e,a){e(await r.federatedSearch(n,t))})},getQueryFromId:function(e){let t="";for(let n=0;n<e.length;n++){let a='physicalid:"'+e[n]+'"';n!=e.length-1&&(a+=" OR "),t+=a}return t},getQueryForNon3DSpace:function(e){let t="";for(let n=0;n<e.length;n++){let a='[ds6w:i3dx]:("'+e[n]+'")';n!=e.length-1&&(a+=" OR "),t+=a}return t},getOwnerFullNameForRecent:function(e,t){let n=new Map;for(let t=0;t<e.results.length;t++){let i=void 0,r=void 0;for(let n=0;n<e.results[t].attributes.length;n++){var a=e.results[t].attributes[n];"ds6w:label"==a.name&&(i=a.value),"ds6w:identifier"==a.name&&(r=a.value)}null!=i&&null!=r&&n.set(r,i)}for(let e=0;e<t.length;e++){let a=t[e].ownerFullName;n.has(a)&&(t[e].ownerFullName=n.get(a))}return t},getQueryFromTriagram:function(e){let t="",n=Array.from(e);for(let e=0;e<n.length;e++){let a='3dexpPerson:"'+n[e]+'"';e!=n.length-1&&(a+=" OR "),t+=a}return t},getCRTypeIconOuterHTML:function(e){var t=UWA.createElement("span",{class:"CRTypeIconHolderOnIADGV",styles:{}});return UWA.createElement("img",{src:e.Icon,id:e.Id}).inject(t),t.outerHTML},processIADataList:function(t,n){let a="<div>";return t.length>1&&(a="<div style='padding-left:5px'>"),1===t.length?(a+=this.getCRTypeIconOuterHTML(t[0]),a+="&nbsp;",a+="<span id='"+t[0].Id+"'>",a+="Name"===n?t[0].Name:"Title"===n?t[0].Title:"",a+="</span>"):t.length>1&&(a+="<a id='MULTIPLE'>"+e.CHG_GOV_MULTIPLE+"</a>"),a+="</div>"},processCRImpactAnalysis:function(t,n,a){let i=[],r=t.data;if(null!=r)for(let t=0;t<r.length;t++){let o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="",w="",A=0,O=0,N=0,I=0,P="ChangeAnalysis",E=0,T="true",R=0,_="true",D=0,F="true",x=0,L="true",j=0,G="true",W="",U="",k="",M="",V="",H="",z=null,q=null,B=null,J=a;s=r[t].id,l=r[t].type,c=r[t].type,f=r[t].name,o=r[t].title,u=r[t].previewicon,d=r[t].icon,p=r[t].owner,g=r[t].ownerFullName,h=r[t].current,m=r[t].currentNLS,v=r[t].policy,C=r[t]["Abstract Change Analysis.Completion Date Due"]?r[t]["Abstract Change Analysis.Completion Date Due"]:e.CHG_NOT_VALID_VALUE,S=r[t]["Abstract Change Analysis.Completion Date Estimated"]?r[t]["Abstract Change Analysis.Completion Date Estimated"]:e.CHG_NOT_VALID_VALUE,y=r[t]["Abstract Change Analysis.Start Date Estimated"]?r[t]["Abstract Change Analysis.Start Date Estimated"]:e.CHG_NOT_VALID_VALUE,b=r[t]["Abstract Change Analysis.Completion Date Actual"]?r[t]["Abstract Change Analysis.Completion Date Actual"]:e.CHG_NOT_VALID_VALUE,w=r[t]["Abstract Change Analysis.Start Date Actual"]?r[t]["Abstract Change Analysis.Start Date Actual"]:e.CHG_NOT_VALID_VALUE,A=parseInt(r[t].impactBasisCount),O=parseInt(r[t].impactedItemsCount),N=parseInt(r[t].attachmentCount),I=parseInt(r[t].contributorsCount),E=r[t]["Default Change Analysis Metrics.Benefit Impact"]?parseInt(r[t]["Default Change Analysis Metrics.Benefit Impact"]):e.CHG_NOT_VALID_VALUE,T=r[t]["Default Change Analysis Metrics.Benefit Impact"]?"true":"false",R=r[t]["Default Change Analysis Metrics.Cost Impact"]?parseInt(r[t]["Default Change Analysis Metrics.Cost Impact"]):e.CHG_NOT_VALID_VALUE,_=r[t]["Default Change Analysis Metrics.Cost Impact"]?"true":"false",D=r[t]["Default Change Analysis Metrics.Validation Effort"]?parseInt(r[t]["Default Change Analysis Metrics.Validation Effort"]):e.CHG_NOT_VALID_VALUE,F=r[t]["Default Change Analysis Metrics.Validation Effort"]?"true":"false",x=r[t]["Default Change Analysis Metrics.Risk Impact"]?parseInt(r[t]["Default Change Analysis Metrics.Risk Impact"]):e.CHG_NOT_VALID_VALUE,L=r[t]["Default Change Analysis Metrics.Risk Impact"]?"true":"false",j=r[t]["Default Change Analysis Metrics.Implementation Effort"]?parseInt(r[t]["Default Change Analysis Metrics.Implementation Effort"]):e.CHG_NOT_VALID_VALUE,G=r[t]["Default Change Analysis Metrics.Implementation Effort"]?"true":"false",W=r[t].cancelComment,r[t].Refinement&&(U=r[t].Refinement),r[t].Dispatch_To&&(k=this.processIADataList(r[t].Dispatch_To,"Name"),M=this.processIADataList(r[t].Dispatch_To,"Title"),z=r[t].Dispatch_To),r[t].Dispatch_From&&(V=this.processIADataList(r[t].Dispatch_From,"Name"),H=this.processIADataList(r[t].Dispatch_From,"Title"),q=r[t].Dispatch_From),r[t].Dispatch_From_ParentCR&&(B=r[t].Dispatch_From_ParentCR);let K={id:s,type:l,typeNLS:c,thumbnail:u,icon:d,name:f,title:o,owner:p,ownerFullName:g,maturity:h,maturityNLS:m,policy:v,dueDate:C,estimatedEndDate:S,estimatedStartDate:y,completionDateActual:b,startDateActual:w,countImpactBasis:A,countImpactedItems:O,countAttachment:N,countContributors:I,isKindOfType:P,parentCRId:n,benefitImpact:E,benefitImpactValid:T,costImpact:R,costImpactValid:_,validationEffort:D,validationEffortValid:F,riskImpact:x,riskImpactValid:L,implementationEffort:j,implementationEffortValid:G,cancelComment:W,refinement:U,dispTo:k,dispToTitle:M,dispFrom:V,dispFromTitle:H,Dispatch_To:z,Dispatch_From:q,Dispatch_From_ParentCR:B,interfaces:J};i.push(K)}return i},processChangeActionDetails:function(t){let n=[],a=t.data;if(null!=a)for(let t=0;t<a.length;t++){let i="",r="",o="",s="",l="",c="",u="",d="",p="",g="",f="",m="",h="",v="",C="",S="",y="",b="",w="false",A="",O="ChangeAction";i=a[t].id,r=a[t].type,A=a[t].typeNLS,s=a[t].name,l=a[t].revision,o=a[t].title,c=a[t].severity,d=a[t].severityNLS,u=a[t].current,p=a[t].currentNLS,S=a[t].description,y=null!=a[t].groupId?"pid:"+a[t].groupId:"",b=null!=a[t].groupName?a[t].groupName:e.CHG_Header_Unassigned,g=a[t].project,f=a[t].organization,m=a[t].icon,c=a[t].severity,h=a[t].owner,v=a[t].ownerFullName,C=a[t].previewicon,w="TRUE"===a[t].ecm_change_on_hold?"true":"false";let N=0;"Medium"==c?N=1:"High"==c&&(N=2);let I=0;"In Work"==u?I=1:"In Approval"==u?I=2:"Approved"==u&&(I=3);let P={id:i,type:r,typeNLS:A,title:o,name:s,revision:l,maturity:u,maturityNLS:p,severity:c,severityNLS:d,description:S,collabspace:g,organization:f,iconURL:m,owner:h,ownerFullName:v,thumbnail:C,severityGrade:N,stateGrade:I,onHold:w,isKindOfType:O,groupId:y,groupName:b};n.push(P)}return n},processedChangeActionContext:function(e){var t=[],n=e.data;if(null!=n)for(var a=0;a<n.length;a++){var i,r,o,s,l,c,u,d;r=n[a].id,l=n[a].typeNLS,d=n[a].typeNLS,u=n[a].type,c=n[a].title,o=n[a].ownerFullName,s=n[a].previewicon,i=n[a].icon;var p={type:u,typeNLS:d,revision:l,title:c,id:r,name:n[a].name,previewicon:s,icon:i,maturity:n[a].current,maturityNLS:n[a].currentNLS,ownerFullName:o,collabSpce:n[a].project,organization:n[a].organization,relId:n[a].relId,sourceType:n[a].sourceType,policy:n[a].policy,policyNLS:n[a].policyNLS};t.push(p)}return t},processChangeAction:function(e){var t=e;let n="";if(null!=t){let e="",a="",i="",r="",o="",s="",l="",c="",u="";i=t.id,c=t.type,r=t.name,t.current,e=t.currentNLS,l=t.title,s=t.previewicon,a=t.icon,o=t.organization,n={id:i,type:c,typeNLS:u=t.typeNLS,previewicon:s,current:e,currentNLS:e,icon:a,name:r,title:l,organization:o}}return n},processedChangeActionMemberList:function(e){let n=[],a=e.data;if(null!=a)for(let e=0;e<a.length;e++){let i="",r="",o="",s="",l="",c="",u="",d="",p="";i="Group"==(r=a[e].type)&&"OnPremise"!=t.getGlobalVariable().tenant?a[e].groupURI:a[e].id,o="Group"==r?a[e].title:a[e].name,s=a[e].userid,l=a[e].roles,c=a[e].previewicon,u=a[e].icon,d=l.toString();let g={id:i,type:r,fullName:o,userId:s,roles:l,role:d,thumbnail:c,icon:u,title:p=a[e].title};n.push(g)}return n},processAccessBitCO:function(e){return"true"===t.getGlobalVariable().isFullLicence||"true"===t.getGlobalVariable().isDerivativeLicense?e:("true"===t.getGlobalVariable().isLiteLicence&&(e.Delete&&(e.Delete="false"),e.Edit&&(e.Edit="false"),e.Hold&&(e.Hold="false"),e.Resume&&(e.Resume="false"),e.Cancel&&(e.Cancel="false"),e.SetCoordinator&&(e.SetCoordinator="false"),e.ManageRouteTemplates&&(e.ManageRouteTemplates="false"),e.setApplicability&&(e.setApplicability="false"),e.AddReferential&&(e.AddReferential="false"),e.Promote&&(e.Promote="false"),e.Demote&&(e.Demote="false"),e.ManageGovernedChanges&&(e.ManageGovernedChanges="false"),e.ManageReportedAgainst&&(e.ManageReportedAgainst="false"),e.ManageFollowers&&(e.ManageFollowers="false"),e.ManageAssignees&&(e.ManageAssignees="false")),e)},processAccessBitCR:function(e){return e.CROrchestrationCreateCR="true",e.CROrchestrationCreateCO="true",e.CROrchestrationAddExisting="true",e.CROrchestrationMergeCA="true",e.CROrchestrationRemove="true",e.CROrchestrationDelete="true","false"==e.ManageImplementingChanges&&(e.CROrchestrationCreateCR="false",e.CROrchestrationCreateCO="false",e.CROrchestrationAddExisting="false",e.CROrchestrationMergeCA="false",e.CROrchestrationRemove="false",e.CROrchestrationDelete="false"),"true"===t.getGlobalVariable().isFullLicence||"true"===t.getGlobalVariable().isDerivativeLicense?e:("true"===t.getGlobalVariable().isLiteLicence&&(e.Hold&&(e.Hold="false"),e.Resume&&(e.Resume="false"),e.Cancel&&(e.Cancel="false"),e.CROrchestrationDelete&&(e.CROrchestrationDelete="false"),e.CROrchestrationCreateCO&&(e.CROrchestrationCreateCO="false"),e.CROrchestrationMergeCA&&(e.CROrchestrationMergeCA="false"),e.CROrchestrationRemove&&(e.CROrchestrationRemove="false"),e.ManageChangeAnalysis&&(e.ManageChangeAnalysis="false")),e)},processAccessBitIA:function(e){return"true"===t.getGlobalVariable().isFullLicence||"true"===t.getGlobalVariable().isDerivativeLicense?e:("true"===t.getGlobalVariable().isLiteLicence&&(e.Cancel&&(e.Cancel="false"),e.AddAssignee&&(e.AddAssignee="false"),e.RemoveAssignee&&(e.RemoveAssignee="false"),e.ManageImplementingChanges&&(e.ManageImplementingChanges="false")),e)},processAccessBitCA:function(e){return e.AddToGroup&&e.RemoveFromGroup&&(e.AddToGroup="true"==e.AddToGroup||"true"==e.RemoveFromGroup),"true"===t.getGlobalVariable().isFullLicence?e:("true"===t.getGlobalVariable().isDerivativeLicense?(e.RealizedTransfer&&(e.RealizedTransfer="false"),e.AddToGroup&&(e.AddToGroup="false")):"true"==t.getGlobalVariable().isLiteLicence&&(e.Hold&&(e.Hold="false"),e.Resume&&(e.Resume="false"),e.RealizedTransfer&&(e.RealizedTransfer="false"),e.Synchronization&&(e.Synchronization="false"),e.AddToGroup&&(e.AddToGroup="false")),e)},processedChangeActionBOMSync:function(e){return{id:e.userDisplayName.data[0].id,type:e.userDisplayName.data[0].type,accessBits:e.userDisplayName.data[0].dataelements}},processAccessBitIR:function(e){return e.CROrchestrationCreateCR="true",e.CROrchestrationCreateCO="true",e.CROrchestrationAddExisting="true",e.CROrchestrationMergeCA="true",e.CROrchestrationRemove="true",e.CROrchestrationDelete="true","false"==e.ManageImplementingChanges&&(e.CROrchestrationCreateCR="false",e.CROrchestrationCreateCO="false",e.CROrchestrationAddExisting="false",e.CROrchestrationMergeCA="false",e.CROrchestrationRemove="false",e.CROrchestrationDelete="false"),"true"===t.getGlobalVariable().isFullLicence||"true"===t.getGlobalVariable().isDerivativeLicense?e:("true"===t.getGlobalVariable().isLiteLicence&&(e.Hold&&(e.Hold="false"),e.Resume&&(e.Resume="false"),e.Cancel&&(e.Cancel="false"),e.CROrchestrationDelete&&(e.CROrchestrationDelete="false"),e.CROrchestrationCreateCO&&(e.CROrchestrationCreateCO="false"),e.CROrchestrationMergeCA&&(e.CROrchestrationMergeCA="false"),e.CROrchestrationRemove&&(e.CROrchestrationRemove="false"),e.ManageChangeAnalysis&&(e.ManageChangeAnalysis="false")),e)},getGetCellValueFunction:function(e,t){return"dateTime"===e?(e,n)=>s.formatDate(new Date(e.nodeModel.getAttributeValue(t)),!0):(e,n)=>e.nodeModel.getAttributeValue(t)},identifierNameFilter:l.inherit({isDataFiltered:function(e){const t=t=>{let n=e.options[t];return n?n.toLowerCase():n},n=t("identifier"),a=t("name");if(n&&a&&this.filterModel&&this.filterModel.text){const e=this.filterModel.text.toLowerCase();return!(n.includes(e)||a.includes(e))}return!1},isEmpty:function(){return!this.filterModel.text}}),uniqBy:function(e,...t){return t.filter(e=>e).flatMap(e=>[...e]).filter((n=new Set,function(t){return a=e(t),!n.has(a)&&n.add(a);var a}));var n},searchFromModelAndUniqAndAdd:function(e,t,n){return this.uniqBy(e,t.selectedItems,n.map(e).map(n=>t._model.getRoots().find(t=>e(t)===n))||[])},getDefaultFilter:function(e){var t={};for(let a in e){var n=e[a].dataIndex;"tree"==e[a].dataIndex?t.label={filterId:"stringRegexp",filterModel:""}:e[a].filterId?t[n]={filterId:e[a].filterId,filterModel:e[a].filterModel}:"boolean"==e[a].dataType?t[n]={filterId:"set",filterModel:[]}:"integer"==e[a].dataType||"real"==e[a].dataType?t[n]={filterId:"number",filterModel:""}:"string"==e[a].dataType&&(e[a].range?t[n]={filterId:"set",filterModel:[]}:t[n]={filterId:"stringRegexp",filterModel:""})}return t},getProposedNodeData:function(e){var t=void 0,n=new Array;e.interface&&(t=new Set(e.interface)),e.classes&&(n=[...n,...this.getProposedClassifiedInterfaces(e.classes)]);let a=[];t&&(a=(a=Array.from(t)).filter(e=>""!==e));let i=[];return n&&n.length>0&&(i=n.filter(e=>""!==e.name)),{id:e.id,cestamp:e.cestamp,type:e.type,displayName:e.title,title:e.title,interfaces:a,classes:i,name:e.name,revision:e.revision?e.revision:"",maturity:e.status,organization:e.organization,collabspace:e.project,isLastRevision:e.isLastRevision,icon:e.icon,previewIcon:e.previewicon,owner:e.owner,ownerFullName:e.ownerFullName,proposedOperation:e.proposedOperation,proposedPID:e.proposedPID,proposedStatus:e.proposedStatus,reasonForChange:e.proposedWhy,evolutionPrefix:e.evolutionPrefix,sourceType:e.sourceType,serviceName:e.service,kind:e["ds6w:kind"],serviceBasedObjId:e.id,activity:e.activity}},processCAProposedChangesData:async function(e){var t=e[0].proposed,n={deletedOrUnaccessiblePropFound:"false",proposed:[],policies:[]},a=[];if(t&&t.length>0){let w=new Set;for(var i=0;i<t.length;i++){var o;w.add(t[i].policy);var s=this.getProposedNodeData(t[i]);if(s.resolution=[],t[i].resolution&&t[i].resolution.length>0){t[i].resolution[0].idsOfNonIndexedResolution&&(o=t[i].resolution[0].idsOfNonIndexedResolution,t[i].resolution.splice(0,1));for(var l=0;l<t[i].resolution.length;l++){var c=t[i].resolution[l];s.resolution.push(this.getProposedNodeData(c)),w.add(c.policy)}}if(o&&o.length>0){var d=new Map,p=o.length;for(let t=0;t<p;t+=50){let n;n=p<50?o.slice(t,t+p):o.slice(t,t+50);var g,f=[],m=new Map;for(i=0;i<n.length;i++){e=n[i];f.push(e.id),m.set(e.id,e)}if(f.length>0){var h=this.commonPredicatedForFedSearch(),v=await this.callFederatedSearch(f,h);v&&v.results&&v.results.length>0&&(g=this.processCAProposedChangeResolutionFedSearch(v,m)),g&&g.length>0&&(s.resolution=s.resolution.concat(g))}d=new Map([...d,...m]),p-=50}if(d&&d.size>0){var C=await r.recent();if(C&&C.results&&C.results.length>0){var S=this.filterNonIndexedDataNew(C,d);d.size!=S.length&&console.log("Some data for resolution is not accessible");var y=this.processInformationForRecentResolution(S);y&&y.length>0&&(s.resolution=s.resolution.concat(y))}}}a.push(s)}w.forEach(e=>n.policies.push(e));var b=await u.getNLSForProcessedListFromSource("CAProposedChange",a);n.proposed=b}return n},processCAProposedChangesFedSearch:async function(e,t){var n={proposed:[],policies:[]};let a=new Set;var i=[],o=e.results;for(let e=0;e<o.length;e++){let n=u.filterInformationFromFederatedSearch(o[e].attributes),O=n.i3dx?n.i3dx:n.id;var s;if(t.get(O)){let e=t.get(O);var l=this.getProposedNodeDataFed(e,n);if(l.resolution=[],e.resolution&&e.resolution.length>0){e.resolution[0].idsOfNonIndexedResolution&&(s=e.resolution[0].idsOfNonIndexedResolution,e.resolution.splice(0,1));for(var c=0;c<e.resolution.length;c++){var d=e.resolution[c];l.resolution.push(this.getProposedNodeData(d)),a.add(d.policy)}}if(s&&s.length>0){var p=new Map,g=s.length;for(let e=0;e<g;e+=50){let t;t=g<50?s.slice(e,e+g):s.slice(e,e+50);for(var f,m=[],h=new Map,v=0;v<t.length;v++){var C=t[v];m.push(C.id),h.set(C.id,C)}if(m.length>0){var S=this.commonPredicatedForFedSearch(),y=await this.callFederatedSearch(m,S);y&&y.results&&y.results.length>0&&(f=this.processCAProposedChangeResolutionFedSearch(y,h)),f&&f.length>0&&(l.resolution=l.resolution.concat(f))}p=new Map([...p,...h]),g-=50}if(p&&p.size>0){var b=await r.recent();if(b&&b.results&&b.results.length>0){var w=this.filterNonIndexedDataNew(b,p);p.size!=w.length&&console.log("Some data for resolution is not accessible");var A=await this.processInformationForRecentResolution(w);A&&A.length>0&&(l.resolution=l.resolution.concat(A))}}}i.push(l),t.delete(O)}}var O=await u.getNLSForProcessedListFromSource("CAProposedChange",i);return n.proposed=O,n},processCAProposedChangeResolutionFedSearch:function(e,t){var n=[],a=e.results;for(let e=0;e<a.length;e++){let r=u.filterInformationFromFederatedSearch(a[e].attributes),o=r.i3dx?r.i3dx:r.id;if(t.get(o)){let e=t.get(o);var i=this.getProposedNodeDataFed(e,r);n.push(i),t.delete(o)}}return n},processInformationForRecentResolution:function(e){var t=[];for(let a=0;a<e.length;a++){let i=this.parsingInformationFromRecentSearch(e[a].nonIndexedData);var n=e[a].nonIndexedModelerData;let r=this.getProposedNodeDataFed(n,i);t.push(r)}return t},getProposedNodeDataFed:function(e,t){return{id:t.i3dx?t.i3dx:t.id,cestamp:e.cestamp,type:t.type,displayName:t.title,title:t.title,name:t.name,revision:t.revision?t.revision:"",policy:t.policy,maturity:t.maturity,organization:t.organization,collabspace:t.project||t.collabSpce,isLastRevision:t.isLastRevision,icon:t.icon,previewIcon:t.previewicon,owner:t.owner,ownerFullName:t.ownerFullName,proposedOperation:e.proposedOperation,proposedPID:e.proposedPID,proposedStatus:e.proposedStatus,reasonForChange:e.proposedWhy,evolutionPrefix:e.evolutionPrefix,sourceType:e.sourceType,serviceName:e.service,kind:t["ds6w:kind"],activity:e.activity,serviceBasedObjId:t.id}},processInformationForRecentProposed:function(e){var t={proposed:[],policies:[]};let n=new Set;var a=[],i=new Set;for(let t=0;t<e.length;t++){let r=u.parsingInformationFromRecentSearch(e[t].nonIndexedData);var o=e[t].nonIndexedModelerData;let s=this.getProposedNodeDataFed(o,r);n.add(s.policy),a.push(s),i.add(s.ownerFullName)}let s="";return s="("+(s=u.getQueryFromTriagram(i))+")",n.forEach(e=>t.policies.push(e)),new Promise(async function(e,n){var i=u.predicatesForFullNameForRecentData();const o=await Promise.all([u.getNLSForProcessedList("CAProposedChange",a),r.federatedSearch(s,i)]);a=u.getOwnerFullNameForRecent(o[1],a),t.proposed=a,e(t)})},filterNonIndexedData:function(e,t){var n=e.results,a=[];for(let e=0;e<t.length;e++)for(let r=0;r<n.length;r++){let o=n[r].attributes.filter(e=>"resourceid"==e.name).map(e=>e.value);if(o&&1==o.length&&t[e].id===o[0]){var i={};i.nonIndexedData=n[r].attributes,i.nonIndexedModelerData=t[e],a.push(i);break}}return console.log(a),a},filterNonIndexedDataNew:function(e,t){var n=e.results,a=[];for(let[e,r]of t)for(let t=0;t<n.length;t++){let o=n[t].attributes.filter(e=>"resourceid"==e.name).map(e=>e.value);if(o&&1==o.length&&e===o[0]){var i={};i.nonIndexedData=n[t].attributes,i.nonIndexedModelerData=r,a.push(i);break}}return console.log(a),a},commonPredicatedForFedSearch:function(){return["resourceid","ds6w:identifier","ds6w:label","ds6w:type","ds6w:modified","ds6w:created","preview_url","type_icon_url","ds6w:responsible","owner","ds6w:docextension","ds6w:isLastRevision","ds6w:organizationResponsible","ds6w:status","ds6w:responsible_value","ds6w:responsible:snippet","ds6wg:revision","ds6w:project","ds6w:project_value","ds6wg:owner","ds6w:kind","ds6w:responsibleUid","ds6w:i3dx"]},predicatesForFullNameForRecentData:function(){return["ds6w:label","owner","ds6wg:owner","ds6w:identifier"]},processMembersList:function(e){let t=[],n=e.data;if(void 0!==n&&n.length>0)for(let e=0;e<n.length;e++){let a={};for(const t in n[e])if(Array.isArray(n[e][t])){let i=n[e][t].map(e=>({id:e.id,type:e.type,fullName:e.name,userId:e.userid,thumbnail:n.previewicon,icon:n.icon,title:e.title||"",roles:e.roles}));a[t]=i}t.push(a)}return t}};return u}),define("DS/ENOChgServices/scripts/services/ChgSearchConfigServcies",["UWA/Core","UWA/Utils/InterCom","UWA/Class/Model","DS/ENO6WPlugins/jQuery","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgErrors","DS/ENOChgServices/scripts/services/ChgMembersServices","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS","require"],function(e,t,n,a,i,r,o,s,l){"use strict";var c=function(e){this.multiSelectVal=e,this.socketName="search_socket_"+(new Date).getTime(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var n=this.options();this.socket.dispatchEvent("RegisterContext",n)};return c.prototype.destroy=function(){var e={};e.widget_id=widget&&widget.id?widget.id:this.socketName,this.socket.dispatchEvent("unregisterSearchContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.disconnect()},c.prototype.options=function(e,t,n,r,s,c,u,d,p,g,f){const m="true"===i.getGlobalVariable().ECM_EnableAddMemberGenericComponent;var h={};let v;if(h.title=e,h.multiSel=this.multiSelectVal,h.mode="furtive",h.app_socket_id=this.socketName,h.widget_id=widget&&widget.id?widget.id:this.socketName,h.default_with_precond=0!=f&&1!=f||f,h.show_precond=!1,h.idcard_activated=!1,h.role=n,h.tenant=i.getGlobalVariable().tenant,v=m?t&&t.length>0:t&&"Person"!=t){if("string"==typeof t&&t.length>0&&(t=t.split(",")),"string"==typeof g&&g.length>0&&(g=g.split(",")),h.precond="(",g&&g.length>0?(a.each(g,function(e,t){h.precond+=0!==e?" OR ":"NOT(",h.precond+='[ds6w:type]:"'+t.trim()+'"'}),h.precond+=")"):a.each(t,function(e,t){0!==e&&(h.precond+=" OR "),h.precond+='[ds6w:type]:"'+t.trim()+'"'}),h.precond+=")",""!=s&&(h.precond+=s),"Depend"!==e&&"Dependency"!==e||(h.precond+=' AND (NOT flattenedtaxonomies:"interfaces/Change On Hold") AND (NOT current:"On Hold" AND NOT current:"Cancelled")'),null!=p&&"addExistingOrchestration"==p.condition&&(h.precond+=p.extendedQuery),null!=p&&"addExistingCROrchestration"==p.condition&&(h.precond+=p.extendedQuery),null!=p&&"addExistingIssue"==p.condition&&(h.precond+=p.extendedQuery),null!=p&&"addExistingRelatedScope"==p.condition&&(h.precond+=p.extendedQuery),null!=p&&"addExistingAffectedItem"==p.condition&&(h.precond+=p.extendedQuery),null!=p&&"addExistingImpactBasis"==p.condition&&(h.precond="",h.precond+=p.extendedQuery),null!=p&&"addExistingImpactedItems"==p.condition&&(h.precond+=p.extendedQuery),null!=p&&"addExistingContexts"==p.condition&&(h.precond+=p.extendedQuery),null!=p&&"addExistingImpactAnalysis"==p.condition&&(h.precond="",h.precond+=p.extendedQuery),null!=p&&"addExistingChangeAction"==p.condition&&(h.precond="",h.precond+=p.extendedQuery),null!=p&&"addExistingProposed"==p.condition&&(h.precond+=p.extendedQuery),null!=p&&"addExistingDependancy"==p.condition&&(h.precond+=p.extendedQuery),null!=p&&"addChildChangeRequest"==p.condition&&(h.precond+=p.extendedQuery),"true"===i.getGlobalVariable().ECM_EnableAddMemberGenericComponent){let e=l("DS/ENOChgGovernanceUX/scripts/components/addMemberPanel/ChgAddMembersServices");h.precond=e.buildAppendedQueries(u,t,p)}else"Route Template"==t&&(h.precond=o.getQueryParameterForRouteTemplate(u))}if(!m&&"Person"===t){var C="",S=!1,y=!1;"true"===i.getGlobalVariable().ECM_SearchRouteTemplateEnforcementForCA&&(S=!0),"true"===i.getGlobalVariable().ECM_EnableRouteTemplateEnforcementForCA&&(y=!0);if(C="reviewer"!==c||"reviewer"===c&&"Person"===o.reviewerType.typeOfReviewer?'(flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active")':"reviewer"===c&&"Route Template"===o.reviewerType.typeOfReviewer?o.getQueryParameterForRouteTemplate(u):"reviewer"===c&&S&&y?o.getQueryParameterForRouteTemplate(u):o.getQueryParameterForRouteTemplate(u)+' OR (flattenedtaxonomies:"types/Person" AND policycurrent:"Person.Active")',"informedUser"===c||"assignee"===c||"Assignee"===c||"userGroupForIA"==c){C+="OnPremise"==i.getGlobalVariable().tenant?' OR (flattenedtaxonomies:"types/Group" AND current:"active")':" OR ([ds6w:type]:(Group))"}if(h.precond=C,null!=p&&"addExistingIAAssignee"==p.condition&&(h.precond+=p.extendedQuery),null!=p&&"addExistingAssignee"==p.condition){C+="OnPremise"==i.getGlobalVariable().tenant?' OR (flattenedtaxonomies:"types/Group" AND current:"active")':" OR ([ds6w:type]:(Group))",h.precond=C,h.precond+=p.extendedQuery}null!=p&&"addExistingFollower"==p.condition&&(h.precond+=p.extendedQuery)}return r&&(h.default_search_criteria=r),h},c.prototype.activate=function(e,t,n,a,i,r,o,s,l,c,u,d){var p=this.options(e,t,n,i,r,o,s,l,c,u,d);this.callback&&(this.callback=void 0),this.callback=a;var g={};g.widget_id=widget?widget.id:null,this.socket.dispatchEvent("unregisterSearchContext",g),this.socket.dispatchEvent("RegisterContext",p),this.socket.dispatchEvent("InContextSearch",p);var f=this;this.socket.addListener("onCloseTransient",function(e){f.socket.dispatchEvent("UnregisterContext",{widget_id:g.widget_id})})},c.prototype.isAvailable=function(){return e.is(this.socket)},c.prototype.objectsSelected=function(e){var t=[];if(this.callback){for(var a=!1,i=0;i<e.length;i++){var o=new n(e[i]);let r=o.get("id"),s=o.get("ds6w:i3dx_value"),c=o.get("sourceid_value");c=c&&c.includes(":")?c.split(":")[0]:c;let u=o.get("ds6w:type_value");if("Group"==u||"foaf:Group"==u||!("3DSPACE"!=c.toUpperCase()||r&&r.contains(":"))||s&&""!=s.trim()){var l=[];l.push(r),l.push(o.get("ds6w:identifier")),l.push(o.get("ds6w:type_value")),l.push(o.get("ds6w:policy_value")),l.push(o.get("type_icon_url")),l.push(o.get("ds6w:label")),l.push(o.get("ds6wg:revision")),l.push(c),l.push(s),t.push(l)}else a=!0,console.log("Service: "+c+" objectId:"+r+"i3dx:"+s)}a&&(r.warn(s.CHG_GOV_MISSING_INFO_WARNING),console.log("Objects with missing Service or i3dx information will be skipped")),this.callback(t)}},c}),define("DS/ENOChgServices/scripts/services/ChgIDCardCommonServices",["DS/UIKIT/Mask","DS/ENOChgServices/scripts/services/ChgSearchConfigServcies","DS/UIKIT/Alert","DS/WAFData/WAFData","UWA/Core","UWA/Class/Promise","DS/UIKIT/Native/Dropdown","DS/UIKIT/DropdownMenu","UWA/String","DS/i3DXCompassServices/i3DXCompassPubSub","require","UWA/Utils/InterCom","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgNativeInitService","DS/DocumentManagement/DocumentManagement","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS","DS/i3DXCompassPlatformServices/OpenWith","DS/WebappsUtils/WebappsUtils","DS/ENOChgServices/scripts/services/ChgErrors"],function(e,t,n,a,i,r,o,s,l,c,u,d,p,g,f,m,h,v,C,S){"use strict";var y={CurrModel:null,ChgIDCardCommonServices_CAModel:null,collectionToFilter:null,caEditComp:null,summaryCloned:null,dependencyElem:{},taggerObject:{},maturityCmd:null,initHandleBarsCalled:!1,selectedItemsArr:[],areCallbacksForOpenWithSet:!1,search:function(e,t,n,a,i,r,o,s,l,c,u){var d="";if("referentials"==a||"context"==a||"Contributors"==a||"Reviewers"==a||"Followers"==a||"proposed"==a||"Dependency"==a){for(var g=a+"ExcludeList",f=null!=r?r:null!=this.CurrModel&&null!=this.CurrModel?this.CurrModel.get(g):null,m=0;null!=f&&null!=f&&m<f.length;m++)if(f[m]){var h=f[m].toString();d=d+"NOT ("+(h=null!=r?"physicalid:"+h:h.replace("pid","physicalid"))+")"}}else if("ChangeOrder"==a||"TransferOwnership"==a){var v="ChangeOrder"==a?this.CurrModel.get("changeOrderId"):this.CurrModel.get("ownerId");UWA.is(v)&&""!=v&&(d="NOT ("+v.replace("pid","physicalid")+")")}var C=p.getGlobalVariable().getRole(),S=l,y=p.getGlobalVariable().contextUser,b=null!=this.CurrModel&&null!=this.CurrModel?this.CurrModel.get("id").slice(4):null;i.activate(e,t,C,n,S,d,o,y,b,s,c,u)},activateSearch:function(e,n){return new t(null==e||null==e||"Change Order"!=e&&"Issue"!==n&&"IA_Assignees"!=e&&("Person"!==e||"TransferOwnership"!==n)&&"proposed"!=n&&"Dependency"!==n&&"Change Request"!==n&&"Change Action"!==n&&"IA_ImpactAnalysis"!==n&&"resolutionItems"!==n)},activateSearch:function(e){return new t(e)},createCA:function(e,t,n){u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall("/resources/modeler/change/changeaction","POST","enovia","application/json",e,t,n)},editCA:function(e,t,n,a){var i="/resources/modeler/change/changeaction/"+t;u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall(i,"PUT","enovia","application/json",e,n,a)},getUserFullName:function(e){return new r(function(t,n){var a="";if(Array.isArray(e))for(var i=0;i<e.length;i++)""!=a?-1===a.indexOf(e[i])&&(a=a+"%7C"+e[i]):a=e[i];else a=e;g.makeWSCall("/resources/modeler/change/userdisplayname","GET","enovia","application/json","userNames="+a,function(e){var n={};n.userDisplayName=e,t(n)},null,!1)})},getUserAccess:function(e){return new r(function(t,n){var a="/resources/modeler/change/access/"+e;u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall(a,"GET","enovia","application/json","",function(e){var n={};n.userAccess=e,t(n)},n,!1)})},getCADetails:function(e){return new r(function(t,n){var a="/resources/modeler/change/changeaction/"+e+"?people=1&referentials=1&dependency=1&attributes=1&context=1&changeOrder=1&applicability=1";u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall(a,"GET","enovia","application/json","",function(e){t(e)},n,!1)})},onItemViewDragForContents:function(e,t){var n,a,i,r,o,s,l,c,u=t.caId.substr(4);n=e[1];var d=[],p=Object.keys(n);for(var g in p){var m=n[p[g]];if(m){r=m.get("objectName"),o=m.get("fullName"),!UWA.is(r)&&UWA.is(o)&&""!=o&&(r=o),(i=(s=t.typeOfDrag&&"Proposed"===t.typeOfDrag?m.get("objectId"):m.get("id")).lastIndexOf(":"))>0&&(i+=1,s=s.substring(i)),(l=m.get("objectType"))||(l=m.get("type")),c=m.get("revision");var h={envId:widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise",serviceId:"3DSpace",objectId:s,objectType:l,displayName:r,Revision:c,ChangeActionID:u,displayType:l,caContextIds:""};t.caContextIds&&0!=t.caContextIds.length&&(h.caContextIds=t.caContextIds),d.push(h)}}a=e[2];var v={protocol:"3DXContent",version:"1.1",source:"X3DCSMA_AP",widgetId:widget.id,data:{items:d}};f.DispatchEventToWin("DragStart",JSON.stringify(v)),a.dataTransfer.setData("Text",JSON.stringify(v))},updateExcludeList:function(e,t){var n=[];if("referentials"==t)e.get(t).forEach(function(e,t){n.push(e.get("id"))});else if("context"==t){e.get(t).forEach(function(e,t){n.push(e.get("id"))})}else"Depend"==t&&n.push(e.get("id"));e.set(t+"ExcludeList",n)},SetSpinnerWait:function(e,t){widget.body.style.pointerEvents="true"==e?"none":"auto"},removeDuplicatesToBeDroppedObjects:function(e){for(var t=0;t<e.data.items.length;t++)for(var n=t+1;n<e.data.items.length;n++)e.data.items[t].objectId==e.data.items[n].objectId&&(e.data.items.splice(n,1),n-=1);return e},getLatestRevisionFlag:function(e){return new r(function(t,n){var a={lastVersionRequests:[]};if(e&&e.length>0){e.forEach(function(e){a.lastVersionRequests.push({id:e})});var i=UWA.Json.encode(a);u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall("/resources/v1/dslc/getlastversions?validIntents=E","POST","enovia","application/json",i,function(e){var n={},a={};if(e.lastVersionRequests&&Array.isArray(e.lastVersionRequests))for(var i=0;i<e.lastVersionRequests.length;i++){var r=e.lastVersionRequests[i];r&&(a[r.id]=r.islast.toString())}n.versionInfo=a,t(n)},n,!1)}else t(!0)})},getFlowdownEnrichedInfo:function(e){var t=this;return new r(function(n,a){var i=[],r={};UWA.is(e)&&e.forEach(function(e){var t=e.id;if(r[t]={},"Cannot be found"!=e.get("flowDownFromTitle")&&""!=e.get("flowDownFromTitle")&&UWA.is(e.get("flowDownFromId"))&&""!=e.get("flowDownFromId")&&(r[t].flowdownFrom=e.get("flowDownFromId").replace("pid:",""),i.push(e.get("flowDownFromId").replace("pid:",""))),"Cannot be found"!=e.get("flowdownForObjectTitle")&&""!=e.get("flowdownForObjectTitle")&&UWA.is(e.get("flowdownForObjectId"))&&""!=e.get("flowdownForObjectId")&&(r[t].flowdownFor=e.get("flowdownForObjectId").replace("pid:",""),i.push(e.get("flowdownForObjectId").replace("pid:",""))),UWA.is(e.get("flowdownInfo"))){var n=e.get("flowdownInfo"),a=n.flowdownFor,o=[];for(var s in a){var l=a[s];l&&"Cannot be found"!=l.info["display name"]&&o.push(l.id.replace("pid:",""))}var c=[],u=n.flowdownFrom;for(var s in u){var d=u[s];d&&"Cannot be found"!=d.caTitle&&c.push(d.caID.replace("pid:",""))}o.length>0&&(i=i.concat(o)),c.length>0&&(i=i.concat(c))}}),i.length>0?t.getAdditionObjectInfo(i).then(function(t){var a=Object.keys(r);for(var i in a){var o=a[i];if(UWA.is(o)){var s=e.findWhere({id:o});if(s){var l=r[o];if(UWA.is(l)){var c=l.flowdownFrom;if(UWA.is(c)){var u=t.additionObjectInfo?t.additionObjectInfo[c]:null;UWA.is(u)&&(s.set("flowdownFromImage",u.image),s.set("flowdownFromIcon",u.icon))}var d=s.get("flowdownInfo");if(UWA.is(d)){var p=d.flowdownFrom;if(UWA.is(p)){var g=p.map(function(e){return e.caID});for(var f in g){(S=t.additionObjectInfo?t.additionObjectInfo[g[f].replace("pid:","")]:void 0)&&(p[f].icon=S.icon,p[f].image=S.image)}}}var m=l.flowdownFor;if(UWA.is(m)){var h=t.additionObjectInfo?t.additionObjectInfo[m]:null;UWA.is(h)&&(s.set("flowdownForImage",h.image),s.set("flowdownForIcon",h.icon))}var v=s.get("flowdownInfo");if(UWA.is(v)){var C=d.flowdownFor;if(UWA.is(C)){g=C.map(function(e){return e.id});for(var f in g){var S;(S=t.additionObjectInfo?t.additionObjectInfo[g[f].replace("pid:","")]:void 0)&&(C[f].info.icon=S.icon,C[f].info.image=S.image)}}}}}}}n(!0)}):n(!0)})},getAdditionObjectInfo:function(e){return new r(function(t,n){if(e&&e.length>0){var a="$ids="+(e=e.toString());u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall("/resources/v2/e6w/service/ObjectInfo?$fields=ownerFullname,collabSpace,collabSpaceTitle,policy,icon,image,synopsis,functionalname,organization,organizationTitle","POST","enovia","application/x-www-form-urlencoded",a,function(e){var n,a=new Object;UWA.is(e)&&UWA.is(e.data)&&e.data.forEach(function(e){var t="";e.dataelements.firstname&&e.dataelements.lastname&&(t=e.dataelements.firstname+" "+e.dataelements.lastname),(n=new Object).pid=e.id,n.type=e.type,n.typeNLS=e.dataelements.typeNLS,n.objectName=e.dataelements.name,n.revision=e.dataelements.revision,n.objectTitle=e.dataelements.title,n.icon=e.dataelements.icon,n.image=e.dataelements.image,n.fileExtension=e.dataelements.fileExtension,n.policy=e.dataelements.policy,n.collabSpace=e.dataelements.collabSpace,n.collabSpaceTitle=e.dataelements.collabSpaceTitle,n.organizationTitle=e.dataelements.organizationTitle,n.ownerFullname=e.dataelements.ownerFullname,n.fullName=t,n.synopsis=e.dataelements.synopsis,n.revision=e.dataelements.revision,n.stateNLS=e.dataelements.stateNLS,a[e.id]=n});var i={};i.additionObjectInfo=a,t(i)},n,!1)}else t(!0)})},getObjectAdditionalInfo:function(e){var t=[];return new r(function(n,a){if(e&&e.data&&e.data.items){var i=e.data.items;if(UWA.is(i)&&UWA.is(i.length)&&i.length>0){for(var r=[],o=[],s=[],l=0;l<i.length;l++)if(i[l].objectId){var c=i[l].serviceId.toLowerCase();"3dspace"==c||c.includes("3dspace")?r.push(i[l].objectId):"3dswym"==c&&"pno:Person"==i[l].objectType&&(o.push(i[l].objectId.replace("iam:","")),s.push(i[l].displayName))}0!=r.length||0!=o.length?y.getAdditionObjectInfo(r).then(function(e){for(var a=0;a<r.length;a++){var i=e.additionObjectInfo[r[a]];t.push(i)}for(a=0;a<o.length;a++){(i={}).label=s[a],i.objectName=o[a],i.name=s[a],i.identifier=o[a],i.type="Person",i.pid=o[a],t.push(i)}n(t)},function(e){return console.log("Failed in getting person id"),a(e)}):S.error(h.CHG_GOV_FAILED_TO_GETID)}else console.log("Failed in getting search service response")}})},enrichCollection:function(t,n,a){var i=this;return this.UpdateUnAccessibleObject(t),new r(function(o,s){var l=[],c=[],u={};if(UWA.is(n)?t.forEach(function(e){UWA.is(e.get(n))&&""!=e.get(n)&&e.get(n)!=e.get("id")?1==e.get("Access")&&(c.push(e.id),u[e.id]=e.get(n).replace("pid:",""),l.push(e.get(n).replace("pid:",""))):e.destroy()}):t.forEach(function(e){1==e.get("Access")&&(c.push(e.id),u[e.id]=e.id.replace("pid:",""),l.push(e.id.replace("pid:","")))}),l.length>0){var d=[],p=i.getAdditionObjectInfo(l);if(d.push(p),a){var g;g=i.getLatestRevisionFlag(l),d.push(g);var f;f=i.getFlowdownEnrichedInfo(t),d.push(f)}r.all(d).then(function(a){a.forEach(function(e){UWA.is(e)&&UWA.is(e.additionObjectInfo)&&c.forEach(function(n){i=u[n],UWA.is(e.additionObjectInfo[i])&&((a=t.get(n)).set("objectName",e.additionObjectInfo[i].objectName),""==e.additionObjectInfo[i].objectTitle?a.set("objectTitle",e.additionObjectInfo[i].objectName):a.set("objectTitle",e.additionObjectInfo[i].objectTitle),a.get("revision")&&a.set("IdentifierWithRevision",a.get("objectTitle")+a.get("revision")),a.set("icon",e.additionObjectInfo[i].icon),a.set("image",e.additionObjectInfo[i].image),a.set("fileExtension",e.additionObjectInfo[i].fileExtension),a.set("policy",e.additionObjectInfo[i].policy),a.set("collabSpace",e.additionObjectInfo[i].collabSpace),a.set("collabSpaceTitle",e.additionObjectInfo[i].collabSpaceTitle),a.set("organizationTitle",e.additionObjectInfo[i].organizationTitle),a.set("ownerFullname",e.additionObjectInfo[i].ownerFullname))});if(UWA.is(e)&&UWA.is(e.versionInfo)){var a=null,i="",r=e.versionInfo;l.forEach(function(e){if(r[e]){i=UWA.is(n)?u[e]:"pid:"+e,a=t.get(i);var o=r[e];a&&a.set("isLastVersion",o)}})}}),e.unmask(widget.body),o(t)},function(t){return console.log("failed from getting additional info"),e.unmask(widget.body),r.reject(t)})}else e.unmask(widget.body),o(t)})},UpdateUnAccessibleObject:function(e,t){if(!UWA.is(t))t="objectTitle";e.forEach(function(e){if(0==e.get("Access"))for(var n=e.pairs(),a=0;a<n.length;a++)"string"!=typeof n[a][1]||"Cannot be found"!=n[a][1]&&"Access denied"!=n[a][1]||n[a][0]!=t&&e.set(n[a][0],"",{silent:!0})})},activateDeactiveTaggerProxies:function(e,t){var n=this.getTaggerObject(e);n&&n.activateTaggerProxy();var a=this.getTaggerObject(t);a&&a.deactivateTaggerProxy()},killTaggerProxies:function(e){var t=[];t=-1===e?[0,1,2,3,4,5]:[e];for(var n=0;n<t.length;n++){var a=t[n],i=this.getTaggerObject(a);if(i){i.taggerProxy.die();var r=i.viewName;delete this.taggerObject[r]}}},setTaggerObject:function(e,t){this.taggerObject[e]=t,t.activateTaggerProxy()},getTaggerObject:function(e){var t="",n=null;switch(e){case 0:t="Properties";break;case 1:t="Team";break;case 2:t="Proposed";break;case 3:t="Realized";break;case 4:t="Referential";break;case 5:t="Approval";break;case 6:t="Context";break;default:console.log("incorrect view selected")}return""!=t&&this.taggerObject&&(n=this.taggerObject[t]),n},filterInCurrentDashboard:function(e){var t=p.getGlobalVariable().mySkeleton,n=[];if(t){var a=t.getCollectionAt(0);null===this.summaryCloned&&(this.summaryCloned=new UWA.Class.Collection(a.toArray())),""===e&&(a.reset(),a.add(this.summaryCloned.toArray()));for(var i=a.toArray(),r=new UWA.Class.Collection(i),o=0;o<r.length;o++){var s=r.at(o);if(s){s.get("synopsis").indexOf(e)>=0&&n.push(s)}}var l=r.without(n);a.remove(l)}},_initDropDown:function(e,t){this.dropDown&&(this.dropDown.destroy(),this.dropDown=null),0===e.length&&e.push({text:h.ECM_CA_Command_NO_Action});var n={items:e,target:t,className:"CA_ConnectedObj_DropDown"};p.getGlobalVariable().isNative?this.dropDown=new o(n):this.dropDown=new s(n),this.dropDown&&this.dropDown.show()},checkTenantInforamation:function(e){var t=[];if(e){for(var n=e.data.items,a=[],i=[],r=0;r<n.length;r++)""===n[r].envId||void 0===n[r].envId||null===n[r].envId?a.push(n[r].displayName):n[r].envId!=p.getGlobalVariable().tenant&&i.push(n[r].displayName);t.TenantInfoMissing=a,t.DiffTenantData=i}return t},filterBasedOnServiceId:function(e){var t={};if(e){for(var n=e.data.items,a=[],i=[],r=0;r<n.length;r++)n[r].serviceId&&n[r].objectType?i.push(n[r]):a.push(n[r].displayName);e.data.items=i,t.dataJSON=e,t.incorrectServiceInfo=a}return t},sanitizeText:function(e){return e=e.trim(),UWA.is(e,"string")&&e.length>0?isNaN(parseFloat(e))?e=l.stripScripts(e):e:UWA.is(e,"number")?e:""},openRelationalExplorer:function(e){this.launchAppBasedOnAppId(e,"ENORIPE_AP")},openCompareApp:function(e){this.launchAppBasedOnAppId(e,"ENOCOMP_AP")},launchAppBasedOnAppId:function(e,t){var n=p.getGlobalVariable().getSecurityContext(),a=[];e.forEach(function(e){var t={envId:p.getGlobalVariable().tenant,serviceId:"3DSpace",contextId:n,objectId:e.replace("pid:","")};a.push(t)});var i=widget.getValue("appId");i||(i="ENOWCHA_AP");var r={protocol:"3DXContent",version:"1.1",source:i,widgetId:widget.id,data:{items:a}},o=UWA.is(widget)&&widget.id?"caCompassSocket_"+widget.id:"caCcompassSocket";this._compass_socket||(this._compass_socket=new d.Socket(o),this._compass_socket.subscribeServer("com.ds.compass",p.getGlobalVariable().compassWindow)),this._compass_socket.dispatchEvent("onSetX3DContent",r,o);var s={appId:t};this._compass_socket.dispatchEvent("onLaunchApp",s,o)},launchAppInAppMode:function(e,t,n){let a=p.getGlobalVariable().getSecurityContext(),i=[],r=[];t.forEach(function(e){let t=e.replace("pid:",""),n={envId:p.getGlobalVariable().tenant,serviceId:"3DSpace",contextId:a,objectId:t};r.push(t),i.push(n)});let o=widget.getValue("appId");o||(o="ENOWCHA_AP");let s={protocol:"3DXContent",version:"1.1",source:o,widgetId:widget.id,data:{items:i},inAppMode:!0,inAppOptions:{relationSet:"AutoModeProfile",localUID:e,selectedObjectIds:r}},l=UWA.is(widget)&&widget.id?"caCompassSocket_"+widget.id:"caCcompassSocket";this._compass_socket||(this._compass_socket=new d.Socket(l),this._compass_socket.subscribeServer("com.ds.compass",p.getGlobalVariable().compassWindow)),this._compass_socket.dispatchEvent("onSetX3DContent",s,l);let c={appId:n};this._compass_socket.dispatchEvent("onLaunchApp",c,l)},getContentForCompassInteraction:function(e){var t=p.getGlobalVariable().getSecurityContext(),n=[];return e.forEach(function(e){var a={envId:widget.getValue("x3dPlatformId"),serviceId:"3DSpace",contextId:t,objectId:e.objectId,objectType:e.objectType,objectTaxonomies:e.objectTaxonomies,displayName:e.displayName,displayType:e.displayType,facetName:e.facetName?e.facetName:"",path:[{resourceid:e.objectId,type:e.objectType}]};n.push(a)}),{protocol:"3DXContent",version:"1.1",source:widget.getValue("appId"),widgetId:widget.id,data:{items:n}}},setSelectedItem:function(e){var t=!1;if(this.selectedItemsArr.forEach(function(n){n.phid!==e.selectedItem.objectId||(t=!0)}),!t){var n={phid:e.selectedItem.objectId,facetName:e.facetName};this.selectedItemsArr.push(n)}},getSelectedItem:function(e){var t={};return this.selectedItemsArr.forEach(function(n){n.facetName!==e||(t=n)}),t},getFacetName:function(e){var t="";if(!e)return t;var n=e.items;if(Array.isArray(n)&&n.length>0)for(var a=0;a<n.length;a++){var i=n[a];i&&(t=i.facetName?i.facetName:"")}return t},setCallbacksForOpenWith:function(e){var t=this;this.areCallbacksForOpenWithSet||c.subscribe("setTypesCallback",function(e){if(e.widgetId===window.widget.id){var n=t.getFacetName(e.data),a=t.buildDataForsetTypes(n),i=JSON.stringify(a),r={appId:e.appId,widgetId:e.widgetId,fileName:"-file",fileContent:i};c.publish("launchApp",r)}t.areCallbacksForOpenWithSet=!0}),c.publish("setTypes",{widgetId:window.widget.id})},buildDataForsetTypes:function(e){var t=this.CurrModel,n={},a=this.getSelectedItem(e),i=[],r=(new Date).valueOf();i.push({id:""+r,phid:a.phid});var o=[{structure:[{id:""+r,show:!0,select:!0,children:[]}]}];if(UWA.is(t)&&t.get("userAccess")){var s=t.get("userAccess").WorkUnder,l={};if("true"===s)l={version:"1.0",AuthoringContextHeader:null,change:{id:t.get("id").replace("pid:",""),name:t.name,title:t.title,description:t.description,severity:t.severity,maturity:t.maturity}};n={version:"2.4",completionOnCAD:"yes",results:i,structures:o,viewpoint:[]},"true"===s&&(n.workUnder=l)}return n},getBlobObject:function(e,t){(0,a.authenticatedRequest)(e,{method:"GET",responseType:"blob",onload:t,onFailure:function(){},onComplete:function(){}})},downloadDocuments:function(e,t){var n=this,a={tenant:p.getGlobalVariable().tenant,securityContext:p.getGlobalVariable().getSecurityContext(),tenantUrl:p.getGlobalVariable().baseURL,autoDownload:!0,onFailure:function(e){t(e)},onComplete:function(t){UWA.is(t,"array")&&t.forEach(function(t){t.downloadUrl&&n.getBlobObject(t.downloadUrl,function(){var n=this.response,a=e.length>1||void 0===t.fileName?"multiple_files.zip":t.fileName;if(window.navigator.msSaveOrOpenBlob){var i=this.getResponseHeader("content-type");window.navigator.msSaveOrOpenBlob(new Blob([n],{type:i}),a)}else{UWA.createElement("a",{href:window.URL.createObjectURL(n),download:a,type:"application/octet-stream"}).dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))}console.log("download docuemnt sucess...!")})})}};e.length>1&&(a.asZip=!0),m.downloadDocuments(e,a)},getCollectionToFilter:function(){return this.collectionToFilter},getSummaryCloned:function(){return this.summaryCloned},setCurrModel:function(e){this.CurrModel=e},getCurrentModel:function(){return this.CurrModel},getUserFullNameMap:function(){return this.userFullNameMap},setUserFullNameMap:function(e){this.userFullNameMap=e},updateUserFullNameMap:function(e){this.setUserFullNameMap(e);var t=this.getUserFullNameMap();Object.keys(e).forEach(function(n){t[n]=e[n]})},getUserFullNameFromIDs:function(e){var t=this,n={};return new r(function(a,i){var r=y.getUserFullNameMap(),o=[];e.forEach(function(e){r&&r[e]?n[e]=r[e]:o.push(e)}),o.length>0?t.getUserFullName(o).then(function(e){var i=e.userDisplayName.userInfo;t.updateUserFullNameMap(i),o.forEach(function(e){i&&i[e]?n[e]=i[e]:o.push(e)}),a(n)}):a(n)})},openWith:function(e){var t=this;return new r(function(n,a){var i=null,r=[];r.push(e);var o=t.getContentForCompassInteraction(r),s=new v;s.set3DXContent(o);var l=[];UWA.is(s.retrieveCompatibleApps,"function")&&s.retrieveCompatibleApps(function(e){e.forEach(function(e){e.className&&1==e.className.contains("app-widget")?"Change Execution"==e.text?l.push({type:"PushItem",title:e.text,icon:{iconPath:e.icon,className:"change-widget"},tooltip:h.CHG_Tooltip_Change_Execution_Widget,action:{callback:function(t){e.handler()}}}):l.push({type:"PushItem",title:e.text,icon:{iconPath:e.icon,className:"change-widget"},action:{callback:function(t){e.handler()}}}):"Change Execution"==e.text?l.push({type:"PushItem",title:e.text,icon:e.icon,tooltip:h.CHG_Tooltip_Change_Execution_Native,action:{callback:function(t){e.handler()}}}):l.push({type:"PushItem",title:e.text,icon:e.icon,action:{callback:function(t){e.handler()}}})});var t=p.getGlobalVariable();l.length>0&&t.isNative?"true"==t.CHG_OPENWITH&&(i={type:"PushItem",title:h.CHG_OpenWith_Menu,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-menu-dot"},submenu:l}):l.length>0&&(i={type:"PushItem",title:h.CHG_OpenWith_Menu,fonticon:{family:1,content:"wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-menu-dot"},submenu:l}),n(i)})})},getExploreMenu:function(e,t){return{type:"PushItem",title:h.ECM_CA_Command_Explore,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToVPMNavigator.png"),action:{callback:function(){var e=t.objectID;f.DispatchEventToWin("Explore",e)}}}},getExploreWithMenu:function(e,t){var n=[];return n.push({type:"PushItem",title:h.ECM_CA_Command_ExploreSys,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_ExploreInRFLPNavigator.png"),action:{callback:function(){var e=t.objectID;f.DispatchEventToWin("ExploreInRFLP",e)}}}),n.push({type:"PushItem",title:h.ECM_CA_Command_ExploreMfg,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToPPRNavigatorWithParent.png"),action:{callback:function(){var e=t.objectID;f.DispatchEventToWin("ExploreInPPR",e)}}}),n.push({type:"PushItem",title:h.ECM_CA_Command_ExploreParents,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_GetParents.png"),action:{callback:function(){var e=t.objectID;f.DispatchEventToWin("ExploreParents",e)}}}),n.push({type:"PushItem",title:h.ECM_CA_Command_ExploreMSB,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_SendToPPRNavigatorWithParent.png"),action:{callback:function(){var e=t.instanceID?t.instanceID:t.objectID;f.DispatchEventToWin("ExploreInMSB",e)}}}),n.push({type:"PushItem",title:h.ECM_CA_Command_ExploreContext,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_FindInContext.png"),action:{callback:function(){var e=t.instanceID?t.instanceID:t.objectID;f.DispatchEventToWin("ExploreinContext",e)}}}),{type:"PushItem",title:h.ECM_CA_Command_ExploreWith,submenu:n}},getOpenMenu:function(e,t){return{type:"PushItem",title:h.ECM_CA_Command_Open,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenDB.png"),action:{callback:function(){var e=t.objectID;f.DispatchEventToWin("Open",e)}}}},getOpenWithNativeMenu:function(e,t){var n=[],a=!1;return"true"===p.getGlobalVariable().ECM_EnableExploreInCollabNApprovalForNative&&(a=!0),a&&n.push({type:"PushItem",title:h.ECM_CA_Command_Explore3DSpace,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_ExploreInCentral_normal.png"),action:{callback:function(){var e=t.objectID;f.DispatchEventToWin("ExploreInCollabNApproval",e)}}}),n.push({type:"PushItem",title:h.ECM_CA_Command_OpenAdv,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenAdvDB.png"),action:{callback:function(){var e=t.objectID;f.DispatchEventToWin("OpenAdv",e)}}}),n.push({type:"PushItem",title:h.ECM_CA_Command_OpenRO,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenInReadOnly.png"),action:{callback:function(){var e=t.objectID;f.DispatchEventToWin("OpenReadOnly",e)}}}),{type:"PushItem",title:h.ECM_CA_Command_OpenWith_RichClient,submenu:n}},getOpenCAMenu:function(e,t){return{type:"PushItem",title:h.ECM_CA_Command_OpenCA,icon:C.getWebappsAssetUrl("ENOChangeActionUX","images/I_OpenDB.png"),action:{callback:function(){var e=t.objectID;f.DispatchEventToWin("OpenCA",e)}}}},setLabelManagerView:function(e){y.labelManagerView=e},getLabelManagerView:function(){return y.labelManagerView},getAdditionSwymPersonInfo:function(e){return new r(function(t,n){if(e&&e.length>0){var a="/resources/v2/e6w/service/PersonSearchByName?searchStr="+(e=e.toString());u("DS/ENOChgServices/scripts/services/ChgInfraService").makeWSCall(a,"GET","enovia","application/json","",function(e){var n,a=new Object;UWA.is(e)&&UWA.is(e.data)&&e.data.forEach(function(e){var t="";e.dataelements.firstname&&e.dataelements.lastname&&(t=e.dataelements.firstname+" "+e.dataelements.lastname),(n=new Object).pid=e.id,n.type=e.type,n.objectName=e.dataelements.name,n.fullName=t,a[e.dataelements.name]=n});var i={};i.additionObjectInfo=a,t(i)},n,!1)}else t(!0)})}};return y}),define("DS/ENOChgServices/scripts/services/ChgDependencyServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices"],function(e,t,n){"use strict";return{changeActionDependenciesLoaded:!1,changeActionDependencyModel:null,getDependUserAccess:function(e){return new Promise(function(n,a){var i="/resources/changedependencies/services/graph/access/"+e;t.makeWSCall(i,"GET","enovia","application/json","",function(e){var t={};t.dependUserAccess=e,n(t)},a,!1)})},getCADependencies:function(e){return new Promise(function(n,a){var i="/resources/changedependencies/services/graph/"+e+"?depth=1";t.makeWSCall(i,"GET","enovia","application/json","",function(e){n(e)},a,!1)})},addDependencyLink:function(e){var n=this;return new Promise(function(a,i){t.makeWSCall("/resources/changedependencies/services/create","PUT","enovia","application/json",e,function(e){n.getDependencyOwnerFullName(e.elements).then(function(t){a(e)})},function(e){i(e)})})},removeDependencyLink:function(e,n){return new Promise(function(e,a){var i="/resources/changedependencies/services/remove/"+n.options.linkid;t.makeWSCall(i,"PUT","enovia","application/json","",function(t){e(t)},function(e){a(e)})})},syncDependency:function(e){return new Promise(function(n,a){var i=e.getSelectedNodes(),r=[];i&&Array.isArray(i)&&i.forEach(function(e){var t="";e&&(t=e.options.resourceid),""!=t&&r.push(t)});var o={changeToSynchronize:r};t.makeWSCall("/resources/modeler/change/utils/synchronizeChanges","POST","enovia","application/json",JSON.stringify(o),function(e){n(e)},function(e,t){t.errorMessage&&a(t.errorMessage)})})},getDependencyOwnerFullName:function(e){return new Promise(function(t,a){var i=[];e.forEach(function(e){var t=e.owner;i.push(t)}),n.getUserFullNameFromIDs(i).then(function(n){e.forEach(function(e){var t=e.owner;e.ownerFullName=n[t]?n[t].userDisplayName:""}),t(e)})})}}}),define("DS/ENOChgServices/scripts/services/ChgRealizedServices",["UWA/Core","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgDataProcess","DS/ENOChgServices/scripts/services/ChgDataService","DS/ENOChgServices/scripts/services/ChgIDCardCommonServices","DS/UIKIT/Mask","DS/PlatformAPI/PlatformAPI","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS"],function(e,t,n,a,i,r,o,s,l){"use strict";return{getCARealizedFilterMapping:function(){return{ALL:1,DEFAULT:2,TRANSFERRED:8,IGNORED:4}},createCAAndTransferRealized:function(e,a,i,l){var c=r.getCurrentModel();a.originChangeActionId=c.id,a.receivingChangeAction=e,a=JSON.stringify(a);n.makeWSCall("/resources/modeler/change/transfer","PUT","enovia","application/json",a,function(e){if(e&&"success"===e.status&&c){var n={};o.mask(widget.body),e={CADetails:e.receivingChangeAction,isSelect:"false"},s.publish("ca-create-grid-injection",e),n.onComplete=function(n){t.getGlobalVariable().arrOid=[],o.unmask(widget.body),i(e)},c.fetch(n)}},function(){o.unmask(widget.body)})},flowDownToNewChangeAction:function(e,a,i,l){var c=r.getCurrentModel();a.originChangeActionId=c&&c.id?c.id:e.originChangeActionId?e.originChangeActionId:"",a.receivingChangeAction=e;var u=[];a.receivingChangeAction&&a.receivingChangeAction.synopsis&&u.push({name:"attribute_Synopsis",value:a.receivingChangeAction.synopsis}),a.receivingChangeAction&&a.receivingChangeAction.severity&&u.push({name:"attribute_Severity",value:a.receivingChangeAction.severity}),a.receivingChangeAction&&a.receivingChangeAction.scheduledCompletionDate&&u.push({name:"attribute_EstimatedCompletionDate",value:a.receivingChangeAction.scheduledCompletionDate}),a.receivingChangeAction&&(u.push({name:"current",value:"Prepare"}),u.push({name:"currentNLS",value:"Draft"}),u.push({name:"currentNLS",value:"Draft"}),u.push({name:"attribute_Originator",value:t.getGlobalVariable().contextUser})),a=JSON.stringify(a),o.mask(widget.body);n.makeWSCall("/resources/modeler/change/flowdown","PUT","enovia","application/json",a,function(e){if(e&&e.changeaction){var n="";if(e.changeaction&&e.changeaction.name&&(e.changeaction.attributes=u,e.changeaction.name&&(n=e.changeaction.name)),c){var a={CADetails:e,isSelect:"false"};s.publish("ca-create-grid-injection",a);var r={onComplete:function(a){t.getGlobalVariable().arrOid=[],o.unmask(widget.body),e.caName=n,i(e)}};c.fetch(r)}else a={CADetails:e,isSelect:"false"},s.publish("ca-create-grid-injection",a),t.getGlobalVariable().arrOid=[],o.unmask(widget.body),e.caName=n,i(e)}},function(){o.unmask(widget.body)})},transferRealized:function(e,a,i,s){var l=r.getCurrentModel();a.originChangeActionId=l.id,a.receivingChangeActionId=e.changeaction.id,a=JSON.stringify(a);n.makeWSCall("/resources/modeler/change/transfer","PUT","enovia","application/json",a,function(e){if(l){var n={};o.mask(widget.body),n.onComplete=function(n){t.getGlobalVariable().arrOid=[],o.unmask(widget.body),i(e)},l.fetch(n)}},function(){o.unmask(widget.body)})},flowDownToExistingChangeAction:function(e,a,i,s){var l=r.getCurrentModel();a.originChangeActionId=l&&l.id?l.id:e.originChangeActionId?e.originChangeActionId:"",a.receivingChangeActionId=e.id,a.originChangeActionId=e.originChangeActionId,a=JSON.stringify(a),o.mask(widget.body);n.makeWSCall("/resources/modeler/change/flowdown","PUT","enovia","application/json",a,function(n){if(l){var a={onComplete:function(a){t.getGlobalVariable().arrOid=[],o.unmask(widget.body),n.caName=e.name,i(n)}};l.fetch(a)}else t.getGlobalVariable().arrOid=[],o.unmask(widget.body),n.caName=e.name,i(n)},function(){o.unmask(widget.body)})},getCARealizedData:function(e,t){return new Promise(function(a,i){var r="/resources/modeler/change/changeaction/"+e+"?realized="+t+"&attributes=1&context=1";n.makeWSCall(r,"GET","enovia","application/json","",function(e){a(e)},i,!1)})},getGroupCARealizedData:function(e){return new Promise(function(t,a){var i="/resources/modeler/change/group/"+e+"?realized=1";n.makeWSCall(i,"GET","enovia","application/json","",function(e){t(e)},a,!1)})},enrichCollectionForRealized:function(e){return r.UpdateUnAccessibleObject(e),new Promise(function(t,n){var a=[],i={};e.forEach(function(e){if(1==e.get("Access")){var t=e.id.replace("pid:","");-1===a.indexOf(t)&&a.push(e.id.replace("pid:","")),i[e.id.replace("pid:","")]=e}e.get("activities").forEach(function(e,t){if(UWA.is(e.get("Afterobject"))&&UWA.is(e.get("Afterobject").id)&&1==e.get("Afterobject").Access){var n=e.get("Afterobject").id.replace("pid:","");-1===a.indexOf(n)&&(a.push(e.get("Afterobject").id.replace("pid:","")),i[e.id.replace("pid:","")]=e)}if(UWA.is(e.get("Beforeobject"))&&UWA.is(e.get("Beforeobject").id)&&1==e.get("Beforeobject").Access){n=e.get("Beforeobject").id.replace("pid:","");-1===a.indexOf(n)&&(a.push(e.get("Beforeobject").id.replace("pid:","")),i[e.id.replace("pid:","")]=e)}})}),a.length>0?r.getAdditionObjectInfo(a).then(function(n){if(UWA.is(n)&&UWA.is(n.additionObjectInfo)){var a=n.additionObjectInfo,i=Object.keys(a);e.forEach(function(e){if(1==e.get("Access")){var t=e.id.replace("pid:",""),n=i.indexOf(t);if(n>-1){var r=a[i[n]];e.set("objectName",r.objectName),e.set("objectTitle",r.objectTitle),e.get("revision")&&e.set("IdentifierWithRevision",e.get("objectTitle")+e.get("revision")),e.set("icon",r.icon),e.set("policy",r.policy),e.set("collabSpace",r.collabSpace),e.set("ownerFullname",r.ownerFullname)}}e.get("activities").forEach(function(e,t){if(UWA.is(e.get("Afterobject"))&&e.get("Afterobject").id&&1==e.get("Afterobject").Access){var n=e.get("Afterobject").id.replace("pid:","");if((t=i.indexOf(n))>-1){var r=a[i[t]];e.get("Afterobject").name=r.objectName,e.get("Afterobject").title=r.objectTitle,e.get("Afterobject").icon=r.icon,e.get("Afterobject").collabSpace=r.collabSpace,e.get("Afterobject").ownerFullname=r.ownerFullname}}if(UWA.is(e.get("Beforeobject"))&&e.get("Beforeobject").id&&1==e.get("Beforeobject").Access){n=e.get("Beforeobject").id.replace("pid:","");if((t=i.indexOf(n))>-1){r=a[i[t]];e.get("Beforeobject").name=r.objectName,e.get("Beforeobject").title=r.objectTitle,e.get("Beforeobject").icon=r.icon,e.get("Beforeobject").collabSpace=r.collabSpace,e.get("Beforeobject").ownerFullname=r.ownerFullname}}})})}t(e)}):t(e)})},getFlowdownCandidatesAndTheirStatus:function(e,t){return new Promise(function(a,i){if(e.length>0&&t.length>0){var r;r="/resources/modeler/change/changeaction/"+t+"?flowdown=1";n.makeWSCall(r,"GET","enovia","application/json",{},function(e){a(e)},function(e){alert("flowdown status failed")})}})},ignoreChangeRealized:function(e,a,i){var s=r.getCurrentModel();""==e.originChangeActionId&&(e.originChangeActionId=s.id),e=JSON.stringify(e);n.makeWSCall("/resources/modeler/change/reject","POST","enovia","application/json",e,function(e){if(s){var n={};o.mask(widget.body),n.onComplete=function(n){t.getGlobalVariable().arrOid=[],o.unmask(widget.body),a(e)},s.fetch(n)}},function(){o.unmask(widget.body)})},setSelectedProposedPerRealizedObject:function(e){this.selectedproposedObjectsArr=[],this.selectedproposedObjectsArr=e},getSelectedProposedPerRealizedObject:function(){return this.selectedproposedObjectsArr}}}),define("DS/ENOChgServices/scripts/services/CACommonIgnore",["UWA/Core","DS/ENOChgServices/scripts/services/ChgRealizedServices","DS/ENOChgServices/scripts/services/ChgErrors","i18n!DS/ENOChgServices/assets/nls/ChgServiceNLS","DS/ENOChgServices/scripts/services/ChgInfodialog","DS/UIKIT/Mask","require"],function(e,t,n,a,i,r,o){"use strict";return{ignoreNodes:function(e,n,o,s){var l=a.ECM_CA_Realized_Ignore_Change_Content+"<br><br>",c=[{label:a.ECM_CA_OK_Button_Label,handler:function(){n&&r.mask(n),t.ignoreChangeRealized(e,o,s),i.closeDialog()},className:"primary"},{label:a.ECM_CA_Cancel,handler:function(){i.closeDialog()},className:"default"}],u={title:a.ECM_CA_Realized_Ignore_Change,content:l,buttonArray:c};i.launchInfoDailog(u)}}}),define("DS/ENOChgServices/scripts/services/ChgImpactAnalysisServices",["DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable"],function(e,t){"use strict";return{getCustomAttributesWithUXService:function(n,a){t.getGlobalVariable().customeViewIAList;return new Promise(function(i,r){t.getGlobalVariable().contextUser;let o=[...n],s={data:[{physicalid:a,label:"test",select_predicate:o}]},l=JSON.stringify(s);e.makeWSCallWithCSRF("/resources/v1/chguxservices/connectedChange/genericResourceFetch","POST","enovia","application/json",l,function(e){let t={};i(t=e)},function(e){r(e)})})}}}),define("DS/ENOChgServices/scripts/services/ChgCustomAttributeService",["DS/ENOChgServices/scripts/services/ChgServiceGlobalVariable","DS/FedDictionaryAccess/FedDictionaryAccessAPI","DS/ENOChgServices/scripts/services/ChgInfraService","DS/ENOChgServices/scripts/services/ChgImpactAnalysisServices","DS/ENOChgServices/scripts/services/ChgDataService"],function(e,t,n,a,i){"use strict";let r={ImpactAnalysis:"Impact Analysis",ChangeAction:"Change Action",ChangeOrder:"Change Order",ChangeRequest:"Change Request",createCustomColumn:function(t){let n=this;return new Promise(function(a,o){let s,l=[];var c=e.getGlobalVariable();if(t==n.ImpactAnalysis){if(c.changeAnalysisCustomColumns)return void a(c.changeAnalysisCustomColumns);s=e.getGlobalVariable().changeAnalysisSubTypes}else if(t==n.ChangeAction){if(c.changeActionCustomColumns)return void a(c.changeActionCustomColumns);s=e.getGlobalVariable().changeActionSubTypes}else if(t==n.ChangeOrder){if(c.changeOrderCustomColumns)return void a(c.changeOrderCustomColumns);s=e.getGlobalVariable().changeOrderSubTypes}else if(t==n.ChangeRequest){if(c.changeRequestCustomColumns)return void a(c.changeRequestCustomColumns);s=e.getGlobalVariable().changeRequestSubTypes}for(let e of s)e.hasOwnProperty("value")?l.push(e.value):l.push(Object.keys(e)[0]);i.getExtensionsForClass(l).then(function(e){var i=new Set,o=[];if(e&&e.results&&e.results.length>0)for(var s=0;s<e.results.length;s++)for(var u=e.results[s].interfaces,d=0;d<u.length;d++)if(u[d].automatic&&"Yes"===u[d].automatic||u[d].Automatic&&"Yes"===u[d].Automatic)console.log("automatic extension detected: "+u[d].name);else{var p=u[d].name;p&&!p.startsWith("ds6wg:")&&(p="ds6wg:"+p),i.add(p)}i.forEach(function(e){o.push(e)});let g=[...l,...o].join(",");n.getPropertyForClassGrid(g).then(function(e){let i=r.makeCombinedColumnList(e);t==n.ImpactAnalysis?c.changeAnalysisCustomColumns=i:t==n.ChangeAction?c.changeActionCustomColumns=i:t==n.ChangeOrder?c.changeOrderCustomColumns=i:t==n.ChangeRequest&&(c.changeRequestCustomColumns=i),a(i)})})})},getCombinedClassList:function(e){let t=this;return new Promise(function(n,a){let i=[],r=[],o=[];for(let n of e)if(n.hasOwnProperty("value")){i.push(n.value);let e=t.getClassExtensionInterface(n.value);o.push(e)}else{i.push(Object.keys(n)[0]);let e=t.getClassExtensionInterface(Object.keys(n)[0]);o.push(e)}Promise.all(o).then(function(e){if("[object Error]"!==Object.prototype.toString.call(e))for(let t of e)if(t.extensions.length>0)for(let e of t.extensions)r.push(e.curi);let t=[...i,...r].join(",");n(t)})})},getPropertyForClassGrid:function(n){return new Promise(function(a,i){let r=e.getGlobalVariable().tenant;var o="en";widget.lang&&(o=widget.lang);let s={tenantId:r,lang:o,onComplete:function(e){a(e)},onFailure:function(e){a(e)}};t.getPropertiesForClass(n,s)})},getClassExtensionInterface:function(n){return new Promise(function(a,i){let r={tenantId:e.getGlobalVariable().tenant,lang:"en",onComplete:function(e){a(e)},onFailure:function(e){a(e)}};t.getExtensionsForClass(n,r)})},getExtensions:async function(e){let t=new Array,n=await r.getClassExtensionInterface(e);return n&&Array.isArray(n.extensions)&&n.extensions.length>0&&n.extensions.forEach(e=>{t.push(e.curi.substring(6))}),t},makeCombinedColumnList:function(e){let t=new Map;if("[object Error]"!==Object.prototype.toString.call(e)){let n=e.classPredicates;for(let e of n){let n=e.vocabularyPredicateInfo;for(let e of n){let n=e.uri,a=e.selectable,i={vocabColumnsNameNLS:e.nlsName,dataType:e.range.dataTypes[0],range:e.hasOwnProperty("rangeValues"),select:a};t.set(n,i)}}}return t},iaSubTypesFetched:function(){return new Promise(function(t,n){null!=e.getGlobalVariable().subTypes?t():r.fetchSubTypes(t,n)})},coSubTypesFetched:function(){return new Promise(function(t,n){null!=e.getGlobalVariable().changeOrderSubTypes?t():r.fetchCOSubTypes(t,n)})},crSubTypesFetched:function(){return new Promise(function(t,n){null!=e.getGlobalVariable().changeRequestSubTypes?t():r.fetchCRSubTypes(t,n)})},fetchCRSubTypes:function(t){var a=this;n.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",'["Change Request"]',function(n){if(Object.keys(n).length>1){e.getGlobalVariable().changeRequestSubTypes=[];var i=[];Object.keys(n).forEach(function(e){var t=a.fetchNLSForCRSubType(e);i.push(t)}),Promise.all(i).then(function(){e.getGlobalVariable().changeRequestSubTypePresent=!0;var n=[],a=0;Object.keys(e.getGlobalVariable().changeRequestSubTypes).forEach(function(t){var i=e.getGlobalVariable().changeRequestSubTypes[t];n[a]={label:i,value:t},a++}),n.sort(function(e,t){return e.label.toUpperCase()>t.label.toUpperCase()?1:-1}),e.getGlobalVariable().changeRequestSubTypes=n,null!=t&&t()})}else if(1==Object.keys(n).length){var r=Object.keys(n),o={};o[r[0]]=r[0],e.getGlobalVariable().changeRequestSubTypePresent=!1,e.getGlobalVariable().changeRequestSubTypes=[],e.getGlobalVariable().changeRequestSubTypes.push(o),null!=t&&t()}else null!=t&&t()},function(n){e.getGlobalVariable().changeRequestSubTypePresent=!1,null!=t&&t()},!0)},fetchCOSubTypes:function(t){var a=this;n.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",'["Change Order"]',function(n){if(Object.keys(n).length>1){e.getGlobalVariable().changeOrderSubTypes=[];var i=[];Object.keys(n).forEach(function(e){var t=a.fetchNLSForCOSubType(e);i.push(t)}),Promise.all(i).then(function(){e.getGlobalVariable().changeOrderSubTypePresent=!0;var n=[],a=0;Object.keys(e.getGlobalVariable().changeOrderSubTypes).forEach(function(t){var i=e.getGlobalVariable().changeOrderSubTypes[t];n[a]={label:i,value:t},a++}),n.sort(function(e,t){return e.label.toUpperCase()>t.label.toUpperCase()?1:-1}),e.getGlobalVariable().changeOrderSubTypes=n,null!=t&&t()})}else if(1==Object.keys(n).length){var r=Object.keys(n),o={};o[r[0]]=r[0],e.getGlobalVariable().changeOrderSubTypePresent=!1,e.getGlobalVariable().changeOrderSubTypes=[],e.getGlobalVariable().changeOrderSubTypes.push(o),null!=t&&t()}else null!=t&&t()},function(n){e.getGlobalVariable().changeOrderSubTypePresent=!1,null!=t&&t()},!0)},fetchNLSForCOSubType:function(t){return new Promise(function(a,i){var r="/resources/dictionary/class/"+t+"/attributes";n.makeWSCall(r,"GET","enovia","application/json","",function(n){UWA.is(n.NLSName)&&""!=n.NLSName?e.getGlobalVariable().changeOrderSubTypes[t]=n.NLSName:e.getGlobalVariable().changeOrderSubTypes[t]=t,a()},function(n){e.getGlobalVariable().changeOrderSubTypes[t]=t,a()},!0)})},fetchNLSForCRSubType:function(t){return new Promise(function(a,i){var r="/resources/dictionary/class/"+t+"/attributes";n.makeWSCall(r,"GET","enovia","application/json","",function(n){UWA.is(n.NLSName)&&""!=n.NLSName?e.getGlobalVariable().changeRequestSubTypes[t]=n.NLSName:e.getGlobalVariable().changeRequestSubTypes[t]=t,a()},function(n){e.getGlobalVariable().changeRequestSubTypes[t]=t,a()},!0)})},fetchSubTypes:function(t){var a=JSON.stringify(["Change Action","Change Order"]);n.makeWSCall("/resources/dictionary/getTypeInfo","POST","enovia","application/json",a,function(n){if(Object.keys(n).length>0){e.getGlobalVariable().subTypes=[];var a=[];Object.keys(n).forEach(function(e){a.push(e)}),e.getGlobalVariable().subTypes=a,e.getGlobalVariable().subTypePresent=!0,null!=t&&t()}},function(n){e.getGlobalVariable().subTypePresent=!1,null!=t&&t()},!0)},updateAsynAttributeColumn:function(e,t,n){window.performance.now();a.getCustomAttributesWithUXService(e,t,n).then(function(t){let a=t.data;if(null!=a){Array.isArray(n)&&n.length>0&&n[0].getTreeDocument().prepareUpdate();for(let t=0;t<a.length;t++){let i=n.filter(e=>e.options.grid.id===a[t].id),r=[...e],o=a[t];if(Array.isArray(i)&&i.length>0)for(let e=0;e<r.length;e++)i[0].setAttribute(r[e],o[r[e]])}Array.isArray(n)&&n.length>0&&n[0].getTreeDocument().pushUpdate()}})}};return r}),define("DS/ENOChgServices/scripts/factories/RegisteredChangeObjectFactories",["UWA/Core","DS/ENOChgServices/scripts/factories/ChangeActionFactory","DS/ENOChgServices/scripts/factories/ChangeOrderFactory","DS/ENOChgServices/scripts/factories/ChangeRequestFactory"],function(e,t,n,a){"use strict";return{ChangeAction:t,ChangeOrder:n,ChangeRequest:a}}),define("DS/ENOChgServices/scripts/factories/ChangeObjectFactory",["UWA/Core","UWA/Class","UWA/Class/Debug","UWA/Class/Events","DS/ENOChgServices/scripts/factories/RegisteredChangeObjectFactories"],function(e,t,n,a,i){"use strict";return t.extend(n,a,{init:function(e){this._changeObjectFactory=null,this._options=e,this._changeObjectFactory=new i[this._options.type](this._options.information),console.log(e)},getChangeObject:function(){return this._changeObjectFactory}})});