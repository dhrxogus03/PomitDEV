define("DS/XCTWebCreativeAppPlay/StuSoundListenerWrapperWeb",[],function(){"use strict";var e=function(){};return e.prototype.getVolume=function(){if(void 0!==this.listener)return this.listener._volume},e.prototype.setVolume=function(e){if(void 0!==this.listener&&(this.listener._volume=e),void 0!==this.listSoundPlayers)for(let t of this.listSoundPlayers)t.setListenerVolume(e)},e.prototype.setTransformation=function(e){var t=e.vector,n=e.matrix.getFirstColumn(),o=e.matrix.getThirdColumn();void 0!==t&&void 0!==n&&void 0!==o&&(this.setPosition(t),this.setOrientation(n,o))},e.prototype.setPosition=function(e){if(void 0!==this.listener&&(this.listener._position=e),void 0!==this.listSoundPlayers)for(let t of this.listSoundPlayers)t.setListenerPosition(e)},e.prototype.setOrientation=function(e,t){if(void 0!==this.listener&&(this.listener._forward=e,this.listener._up=t),void 0!==this.listSoundPlayers)for(let n of this.listSoundPlayers)n.setListenerDirection(e,t)},e}),define("DS/XCTWebCreativeAppPlay/StuSoundSourceWrapperWeb",["DS/VENHowler/2.2.3/dist/howler"],function(e){"use strict";var t=function(){};const n=function(e){return e*(180/Math.PI)},o=function(e){return e*(Math.PI/180)};return t.prototype.initEngine=function(){this.resource=null,void 0!==this.sound&&null!==this.sound&&this.sound.unload(),e&&e.Howler&&(e.Howler.pos(0,0,0),e.Howler.orientation(0,0,-1,0,1,0))},t.prototype.playSoundEngine=function(){this.initEngine()},t.prototype.stopSoundEngine=function(){this.initEngine(),this.mustResetWrappers=!0},t.prototype.getEngineStatus=function(){let e=-1;return null!==this.sound&&void 0!==this.sound&&(this.isPaused()?e=0:this.isPlaying()?e=1:this.isStopped()&&(e=2)),e},t.prototype.setResource=function(t){if(null===t)return;let n=this;return t._modelObject.QueryInterface("CATI3DXSoundResourceAsset").getSound().then(function(o){if(void 0!==n.resource&&null!==n.resource&&n.resource.src===o.src)return;n.resource=o;const i=o.src;void 0!==n.sound&&(n.isPlaying()?n.mustPlay=!0:n.mustPlay=!1,n.sound.unload());var s=t._modelObject.QueryInterface("CATI3DXSoundResourceAsset").getExtension();n.sound=new e.Howl({src:[i],format:[s],html5:!1,autoplay:void 0!==n.mustPlay&&n.mustPlay,volume:void 0!==n.volume?n.volume:1,loop:void 0===n.mustLoop||n.mustLoop,spatial:void 0===n.mustSpatialize||n.mustSpatialize,rate:void 0!==n.speed?n.speed:1,orientation:[1,0,0],stereo:0,pos:[0,0,0],coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"exponential",maxDistance:1e4,refDistance:1,rolloffFactor:1,panningModel:"HRTF",onstart:function(){console.log("start!")},onpause:function(){n.isPausedNotStopped=!0},onstop:function(){n.isPausedNotStopped=!1}})}).then(function(e){return e}).catch(function(e){return UWA.Promise.reject(e)})},t.prototype.getConeInnerAngle=function(){return null!==this.sound&&void 0!==this.sound?o(this.sound.pannerAttr.coneInnerAngle):-1},t.prototype.setConeInnerAngle=function(e){return null!==this.sound&&void 0!==this.sound?(this.sound.pannerAttr.coneInnerAngle=n(e),1):-1},t.prototype.getConeOuterAngle=function(){return null!==this.sound&&void 0!==this.sound?o(this.sound.pannerAttr.coneOuterAngle):-1},t.prototype.setConeOuterAngle=function(e){return null!==this.sound&&void 0!==this.sound?(this.sound.pannerAttr.coneOuterAngle=n(e),1):-1},t.prototype.getRollOffFactor=function(){return null!==this.sound&&void 0!==this.sound?this.sound.pannerAttr.rolloffFactor:-1},t.prototype.setRollOffFactor=function(e){return null!==this.sound&&void 0!==this.sound?(this.sound.pannerAttr.rolloffFactor=e,1):-1},t.prototype.getTempo=function(){return-1},t.prototype.setTempo=function(e){return-1},t.prototype.getVolume=function(){return null!==this.sound&&void 0!==this.sound?this.sound.volume():-1},t.prototype.setVolume=function(e){null!==this.sound&&void 0!==this.sound&&e>0?this.sound.volume(e):e>0&&(this.volume=e)},t.prototype.getPitch=function(){return null!==this.sound&&void 0!==this.sound?this.sound.rate():-1},t.prototype.setPitch=function(e){null!==this.sound&&void 0!==this.sound&&e>.001?this.sound.rate(e):e>.001&&(this.pitch=e)},t.prototype.setTransformation=function(e){var t=e.vector,n=e.matrix.getFirstColumn();void 0!==t&&void 0!==n&&(this.setPosition(t),this.setDirection(n))},t.prototype.setPosition=function(e){null!==this.sound&&void 0!==this.sound&&"loaded"===this.sound.state()?this.sound.pos(e.x,e.y,e.z):this.position=e},t.prototype.setDirection=function(e){null!==this.sound&&void 0!==this.sound&&"loaded"===this.sound.state()?this.sound.orientation(e.x,e.y,e.z):this.direction=e},t.prototype.setSpeed=function(e){null!==this.sound&&void 0!==this.sound?this.sound.rate(e.x):this.speed=e.x},t.prototype.isLooping=function(){return null!==this.sound&&void 0!==this.sound&&this.sound.loop()},t.prototype.getPlayPostion=function(){if(null!==this.sound&&void 0!==this.sound&&0!==this.sound.duration()){let e=-1;return e=this.sound.seek()/this.sound.duration()*100}return-1},t.prototype.getDuration=function(){return null!==this.sound&&void 0!==this.sound&&0!==this.sound.duration()?this.sound.duration():-1},t.prototype.setSpatialized=function(e){null!==this.sound&&void 0!==this.sound?this.sound.spatial=e:this.mustSpatialize=e},t.prototype.setLoopMode=function(e){null!==this.sound&&void 0!==this.sound?this.sound.loop(e):this.mustLoop=e},t.prototype.setListenerVolume=function(t){e&&e.Howler&&e.Howler.volume(t)},t.prototype.setListenerPosition=function(t){null!==this.sound&&void 0!==this.sound&&"loaded"===this.sound.state()&&e&&e.Howler&&e.Howler.pos(t.x,t.y,t.z)},t.prototype.setListenerDirection=function(t,n){null!==this.sound&&void 0!==this.sound&&"loaded"===this.sound.state()&&n&&e&&e.Howler&&e.Howler.orientation(t.x,t.y,t.z,n.x,n.y,n.z)},t.prototype.play=function(){null!==this.sound&&void 0!==this.sound?(this.sound.playing()&&this.sound.stop(),this.sound.play()):this.mustPlay=!0},t.prototype.pause=function(){null!==this.sound&&void 0!==this.sound&&this.isPlaying()&&this.sound.pause()},t.prototype.stop=function(){null===this.sound||void 0===this.sound||this.isStopped()||this.sound.stop()},t.prototype.isPlaying=function(){return null!==this.sound&&void 0!==this.sound&&this.sound.playing()},t.prototype.isPaused=function(){return null!==this.sound&&void 0!==this.sound&&!this.sound.playing()&&this.isPausedNotStopped},t.prototype.isStopped=function(){return null!==this.sound&&void 0!==this.sound&&!this.sound.playing()&&!this.isPausedNotStopped},t}),define("DS/XCTWebCreativeAppPlay/commands/XCTWebSoundMuteCmd",["UWA/Core","UWA/Class/Listener","DS/ApplicationFrame/Command"],function(e,t,n){"use strict";return e.Class.extend(n,t,{init:function(e){this._parent(e,{isAsynchronous:!0});var t=this.getFrameWindow(),n=t._experienceBase;this.listenTo(n.getManager("CXPWebPlayManager"),"PlayStateChanged",this._switchEnableFromPlayState.bind(this)),t.getActionBar().onActionBarReady(()=>{this.getFrameWindow()._actionBar.elements.container.getChildren()[0].getChildren()[2].getChildren()[1].getChildren()[0].getChildren()[5].hide()})},beginExecute:function(){this._soundUnmute(),this.done()},endExecute:function(){this._soundUnmute(),this.done()},_soundUnmute:function(){var e=this.getFrameWindow()._experienceBase;if(e){var t=e.getManager("CXPWebSoundManager");t&&t.unmute()}},_switchEnableFromPlayState:function(e){var t=this.getFrameWindow()._experienceBase;if(t){var n=t.getManager("CXPWebPlayManager");n.ePlayState.ePlaying===e||n.ePlayState.ePause===e?this.enable():this.disable()}}})}),define("DS/XCTWebCreativeAppPlay/commands/XCTWebSoundCmd",["UWA/Core","UWA/Class/Listener","DS/ApplicationFrame/Command"],function(e,t,n){"use strict";return e.Class.extend(n,t,{init:function(e){this._parent(e,{isAsynchronous:!0});var t=this.getFrameWindow()._experienceBase;this.listenTo(t.getManager("CXPWebPlayManager"),"PlayStateChanged",this._switchEnableFromPlayState.bind(this));var n=t.getManager("CXPWebSoundManager");n&&this.listenTo(n,"SoundMuteStateChanged",this._switchMuteImageIcon.bind(this))},beginExecute:function(){this._soundMute(),this.done()},endExecute:function(){this._soundMute(),this.done()},_soundMute:function(){var e=this.getFrameWindow()._experienceBase;if(e){var t=e.getManager("CXPWebSoundManager");t&&t.mute()}},_switchMuteImageIcon:function(e){e?(this.getFrameWindow()._actionBar.elements.container.getChildren()[0].getChildren()[2].getChildren()[1].getChildren()[0].getChildren()[4].hide(),this.getFrameWindow()._actionBar.elements.container.getChildren()[0].getChildren()[2].getChildren()[1].getChildren()[0].getChildren()[5].show()):(this.getFrameWindow()._actionBar.elements.container.getChildren()[0].getChildren()[2].getChildren()[1].getChildren()[0].getChildren()[5].hide(),this.getFrameWindow()._actionBar.elements.container.getChildren()[0].getChildren()[2].getChildren()[1].getChildren()[0].getChildren()[4].show())},_switchEnableFromPlayState:function(e){var t=this.getFrameWindow()._experienceBase;if(t){var n=t.getManager("CXPWebPlayManager");n.ePlayState.ePlaying===e||n.ePlayState.ePause===e?this.enable():this.disable()}}})}),define("DS/XCTWebCreativeAppPlay/extensions/StuESoundListenerPrototypeBuild",["UWA/Core","DS/XCTWebExperienceAppPlay/extensions/StuEExperienceBasePrototypeBuild","DS/XCTWebCreativeAppPlay/StuSoundListenerWeb"],function(e,t){"use strict";return t.extend({})}),define("DS/XCTWebCreativeAppPlay/StuSoundPlayerWeb",["DS/StuSound/StuSoundPlayer","DS/XCTWebCreativeAppPlay/StuSoundSourceWrapperWeb","DS/XCTWebCreativeAppPlay/managers/StuSoundManagerWeb"],function(e,t,n){"use strict";return e.prototype._listSoundPlayers=[],e.prototype.getListSoundWebPlayers=function(){return e.prototype._listSoundPlayers},e.prototype._registerSoundWebPlayer=function(t){e.prototype._listSoundPlayers.push(t)},e.prototype._deleteAllSoundWebPlayer=function(){e.prototype._listSoundPlayers.splice(0,e.prototype._listSoundPlayers.length)},e.prototype.buildWrapper=function(){if(e.prototype._listSoundPlayers.length>0){let t=e.prototype._listSoundPlayers[e.prototype._listSoundPlayers.length-1];null!==t&&!0===t.mustResetWrappers&&e.prototype._deleteAllSoundWebPlayer()}let n=new t;return e.prototype._registerSoundWebPlayer(n),n},e}),define("DS/XCTWebCreativeAppPlay/extensions/StuESoundPlayerPrototypeBuild",["UWA/Core","DS/XCTWebExperienceAppPlay/extensions/StuEExperienceBasePrototypeBuild","DS/XCTWebCreativeAppPlay/StuSoundPlayerWeb"],function(e,t){"use strict";return t.extend({})}),define("DS/XCTWebCreativeAppPlay/managers/CXPWebSoundManager",["UWA/Core","UWA/Class/Events","DS/XCTWebCreativeAppPlay/StuSoundPlayerWeb"],function(e,t,n){"use strict";return e.Class.extend(t,{Build:function(){},Dispose:function(){},mute:function(){let e=n.prototype.getListSoundWebPlayers();for(let t of e)void 0!==t&&void 0!==t.sound&&t.sound.mute(!0);this.dispatchEvent("SoundMuteStateChanged",!0)},unmute:function(){let e=n.prototype.getListSoundWebPlayers();for(let t of e)void 0!==t&&void 0!==t.sound&&t.sound.mute(!1);this.dispatchEvent("SoundMuteStateChanged",!1)},GetType:function(){return"CXPWebSoundManager"}})}),define("DS/XCTWebCreativeAppPlay/StuSoundListenerWeb",["DS/StuSound/StuSoundListener","DS/XCTWebCreativeAppPlay/StuSoundListenerWrapperWeb","DS/XCTWebCreativeAppPlay/StuSoundPlayerWeb"],function(e,t,n){"use strict";return e.prototype.buildWrapper=function(){let e=this,o=new t;return void 0!==o&&(o.listSoundPlayers=n.prototype.getListSoundWebPlayers(),o.listener=e),o},e}),define("DS/XCTWebCreativeAppPlay/managers/StuSoundManagerWeb",["UWA/Core","DS/StuSound/StuSoundManager","DS/XCTWebCreativeAppPlay/managers/CXPWebSoundManager"],function(e,t){"use strict";return t.prototype.mute=function(){var e=STU.Experience.getCurrent().CATI3DExperienceObject.getModelObject()._experienceBase.getManager("CXPWebSoundManager");void 0!==e&&"function"==typeof e.mute&&e.mute()},t.prototype.unmute=function(){var e=STU.Experience.getCurrent().CATI3DExperienceObject.getModelObject()._experienceBase.getManager("CXPWebSoundManager");void 0!==e&&"function"==typeof e.unmute&&e.unmute()},t});