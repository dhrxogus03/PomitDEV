define("DS/XSRCommonComponents/components/XPLMNew/tweakers/UsageDimRMTweakerView",["UWA/Controls/Abstract","DS/Controls/ComboBox","DS/Controls/Toggle","DS/Controls/LineEditor","DS/WUXAutoComplete/AutoComplete","DS/XSRCommonComponents/utils/TypeUtils","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","i18n!DS/XSRCommonComponents/assets/nls/XSRCommonComponents"],function(e,t,l,a,n,i,s,o,d){"use strict";return e.extend({init:function(e){this._parent(e),this.tweakerCtx=e.tweakerCtx},_build:function(){var e=UWA.createElement("div",{id:"xsr-usagedim-tweaker-create"});return this._buildDimensionField().inject(e),this._buildUsageField().inject(e),e},_buildDimensionField:function(){var e=this,l=i.getDimensions(),a=[];Object.keys(l).forEach(function(t){a.push({labelItem:e.isNonNlsLabel(l[t])?t:l[t],valueItem:t})});var n=new t({elementsList:a,enableSearchFlag:!1,value:"",placeholder:d.placeholder_Dimensions});return n.elements.container.addClassName("xsr-tweaker-dim"),n.elements.container.setStyle("width","100%"),n.elements.container.setStyle("display","flex"),e.selectedDimension={label:n.label,value:n.value},n.addEventListener("change",function(t){t.stopPropagation(),t.preventDefault();var l=t.dsModel.value,a=t.dsModel.value;e.selectedDimension={label:a,value:l},e.loadUOMs(),e.valueUpdated()}),n},_buildUsageField:function(){var e=this,t=UWA.createElement("div",{id:"xsr-usage-qty-row"});t.setStyle("padding-top","5px"),t.setStyle("display","flex");var i=new a({value:"",domId:"xsr-line-editor-qty-tweaker",placeholder:d.placeholder_Quantity,displayClearFieldButtonFlag:!0,pattern:"^(s*|[+]?[0-9]*[0-9.]+)$"});i.elements.container.setStyle("width","40%"),i.elements.container.setStyle("padding-right","3px"),i.addEventListener("change",function(t){t.stopPropagation(),t.preventDefault();var l=t.dsModel.value;!l||parseFloat(l)>0?(e.qtyValue=l,e.valueUpdated()):e.tweakerCtx._dispatchNotification("warning",d.errMsg_basicErrMessageQuantity)}),i.inject(t),this.qtyField=i;var o=new s,r=new n({domId:"xsr-auto-complete",placeholder:d.placeholder_dropdown,multiSearchMode:!1,elementsTree:o,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!0});r.addEventListener("change",function(t){t.stopPropagation(),t.preventDefault();var l=t.dsModel.value;if(l){var a=t.dsModel.selectedItems.getLabel();e.selectedUOM={label:a,value:l}}else e.selectedUOM={label:void 0,value:void 0};e.valueUpdated()}),this.uomField=r,e.loadUOMs(),r.inject(t),r.elements.container.setStyle("width","30%"),r.elements.container.setStyle("padding-right","3px");var u=new l({type:"switch",label:d.label_AsNeeded,domId:"xsr-toggle-button",value:void 0,allowUnsafeHTMLLabel:!1});return e.asReqVal=!1,u.addEventListener("change",function(t){t.stopPropagation(),t.preventDefault();var l=t.dsModel.checkFlag;e.asReqVal=l,e.valueUpdated()}),u.inject(t),u.elements.container.setStyle("width","30%"),t},valueUpdated:function(){let e=this.selectedDimension.value,t=this.selectedUOM?this.selectedUOM.value:void 0,l=this.qtyValue,a=this.asReqVal;var n=!1;if(a&&e&&!t&&!l?n=!0:a&&e&&t&&l?n=!0:!a&&e&&t&&l&&(n=!0),n){let n=l?l+" "+this.selectedUOM.label:this.selectedDimension.label;this.tweakerCtx._tooltip=n;var i=e+"|"+(l=l||"")+"|"+(t=t||"")+"|"+a;this.tweakerCtx._dispatchChange(i,!0)}else this.tweakerCtx._tooltip=void 0,this.tweakerCtx._dispatchChange(void 0,!1)},loadUOMs:function(){var e=this,t=this.selectedDimension.value,l=i.getUOMUnits(t),a=[];Object.keys(l).forEach(function(t){a.push({labelItem:e.isNonNlsLabel(l[t])?t:l[t],valueItem:t})}),a.sort(function(e,t){let l=e.labelItem.toLowerCase(),a=t.labelItem.toLowerCase();return l>a?1:l<a?-1:0});var n=this.uomField.elementsTree;this.uomField.value="",this.qtyField.value="",n.prepareUpdate(),n.empty(),null!=a&&Object.keys(a).forEach(function(t){var l=e.createNode(a[t].labelItem,a[t].valueItem);n.addRoot(l)}),n.pushUpdate()},isNonNlsLabel:function(e){return!!e.includes("emxFramework.")},createNode:function(e,t,l){return new o({label:e,value:t,grid:l||{}})}})});