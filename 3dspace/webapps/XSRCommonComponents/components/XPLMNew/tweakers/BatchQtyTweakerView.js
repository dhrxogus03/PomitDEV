define("DS/XSRCommonComponents/components/XPLMNew/tweakers/BatchQtyTweakerView",["UWA/Controls/Abstract","DS/WUXAutoComplete/AutoComplete","DS/Controls/LineEditor","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/XSRCommonComponents/utils/TypeUtils","i18n!DS/XSRCommonComponents/assets/nls/XSRCommonComponents"],function(e,t,n,a,o,i,r){"use strict";return e.extend({init:function(e){this._parent(e),this.tweakerCtx=e.tweakerCtx},_buildReferenceBatchQty:function(){var e=UWA.createElement("div",{id:"xsr-refqty-tweaker-create"});e.setStyle("display","flex");var o=new n({value:"",domId:"xsr-line-editor-qty-tweaker",placeholder:r.placeholder_Quantity,displayClearFieldButtonFlag:!1,pattern:"^(s*|[+]?[0-9]*[0-9.]+)$"});o.elements.container.setStyle("width","50%");var i=this;o.addEventListener("change",function(e){e.stopPropagation(),e.preventDefault();var t=e.dsModel.value;i.qtyValue=t,i.valueUpdated()}),o.inject(e);var l=new a,s=new t({domId:"xsr-auto-complete-uom-tweaker",placeholder:r.placeholder_UOM,multiSearchMode:!1,elementsTree:l,allowFreeInputFlag:!1,allowResetToUndefinedByUIFlag:!0});i=this;return s.addEventListener("change",function(e){e.stopPropagation(),e.preventDefault();var t=e.dsModel.value;i.dimNodesArr.indexOf(t)>=0?s.value=void 0:i.valueUpdated()}),s.addEventListener("click",function(e){i._loadBatchUnitOfMeasurements(s)}),s.elements.container.setStyle("width","50%"),s.elements.container.setStyle("padding-left","5px"),s.inject(e),this.uomField=s,this._loadBatchUnitOfMeasurements(s),e},updateTooltip:function(e){this.tweakerCtx._tooltip=e},valueUpdated:function(){if(this.qtyValue&&this.uomField.value){var e=this.qtyValue+" "+this.uomField.value;this.updateTooltip(this.qtyValue+" "+this.uomField.selectedItems.getLabel()),this.tweakerCtx._dispatchChange(e,!0)}else this.updateTooltip(),this.tweakerCtx._dispatchChange(void 0,!1)},_loadBatchUnitOfMeasurements:function(e){var t=this,n=e.elementsTree;t.dimNodesArr=[],t.uomObj={},n.prepareUpdate();var a=i.getDimensions();Object.entries(a).forEach(([e,a])=>{t.dimNodesArr.push(a);let o=t.createNode(a,e);n.addRoot(o);var r=i.getUOMUnits(e),l=Object.fromEntries(Object.entries(r).sort(([,e],[,t])=>e.localeCompare(t)));Object.keys(l).forEach(function(n){var a=t.isNonNlsLabel(l[n])?n:l[n],i=n+":"+e,r=t.createNode(a,i);o.addChild(r),t.uomObj[n]=i})}),n.expandAll(),n.pushUpdate(),e.elementsTree=n},isNonNlsLabel:function(e){return!!e.includes("emxFramework.")},createNode:function(e,t,n){return new o({label:e,value:t,grid:n||{}})}})});