define("DS/E6WCommonUI/WidgetUtils",["UWA/Core"],function(e){"use strict";String.prototype.htmlEncode=function(){var e=this.toString();return e=(e=(e=(e=(e=(e=(e=(e=e.replace(/&/g,"&amp;")).replace(/>/g,"&gt;")).replace(/</g,"&lt;")).replace(/"/g,"&quot;")).replace(/'/g,"&#x27;")).replace(/\//g,"&#x2F;")).replace(/`/g,"&#x60;")).replace(/=/g,"&#x3D;")},String.prototype.htmlDecode=function(){var e=this.toString();return(e=(e=(e=(e=(e=(e=(e=e.replace(/&amp;/g,"&")).replace(/&lt;/g,"<")).replace(/&gt;/g,">")).replace(/&quot;/g,'"')).replace(/&#39;/g,"'")).replace(/&#x60;/g,"`")).replace(/&#x3D;/g,"=")).hexDecode()},String.prototype.hexDecode=function(){for(var e=this.toString(),t=e.split("&#x");t.length;){var i,n,a="0x"+t.pop().split(";")[0];!isNaN(parseFloat(a))&&isFinite(a)&&(i=String.fromCharCode(a),n=new RegExp("&#x"+a.substring(2)+";","g"),e=e.replace(n,i))}return e};var t={doNotOverrideDropEffect:!1,makeHTML5Date:function(t){if(!t)return"";var i;if(t instanceof Date)i=t;else{var n=t;e.is(t,"string")&&(n=parseInt(t,10)),isNaN(n)||(i=new Date(n))}if(i){var a=i.getDate();a=a<10?"0"+a:a;var o=i.getMonth()+1;return o=o<10?"0"+o:o,i.getFullYear()+"-"+o+"-"+a}return""},topWindowcache:null,getTopWindow:function(e){if(this.topWindowcache)return this.topWindowcache;for(var t=window;t&&t.parent!==t;)try{if(t.parent.test="temp","temp"!==t.parent.test)break;t=t.parent}catch(e){break}if(e)try{for(;t.opener&&t.opener.top&&(t.opener.top.test="temp2","temp2"===t.opener.top.test);)t=t.opener.top}catch(e){}return this.topWindowcache=t,this.topWindowcache},addDragDropListeners:function(){document.addEventListener("dragover",function(e){(e=e||event).preventDefault(),t.doNotOverrideDropEffect&&(e.dataTransfer.dropEffect="copy"),t.doNotOverrideDropEffect=!1},!1),document.addEventListener("drop",function(e){(e=e||event).preventDefault()},!1)},getSessionId:function(){return"session-"+widget.id+".widgetViewModeBeforePreview"},restoreWidgetViewModeBeforePreview:function(){var e=sessionStorage.getItem(this.getSessionId());e&&(widget.dispatchEvent("onViewRequest",{type:e}),sessionStorage.removeItem(this.getSessionId()))}};return t}),define("DS/E6WCommonUI/PlatformManager",["UWA/Core","UWA/Array","UWA/Class/Events","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/PlatformAPI/PlatformAPI","UWA/Utils"],function(e,t,i,n,a,o){"use strict";function s(){return void 0!==window.widget}var r=i.extend({_serviceData:[],_rolesData:[],initPlatformServiceData:function(e){this.isServiceDataLoaded()?e.onComplete():n.getPlatformServices({onComplete:function(t){r._instance.storePlatformServiceData(t),e.tenant&&r._instance.setTenant(e.tenant),e.onComplete()}})},filterCollabSpaces:function(e,t){n.getAppInfo({appId:window.widget.getValue("appId"),onComplete:function(i){var n=[...e]||[],a=i&&i.platforms&&i.platforms.map(e=>e.id);n=n.filter(e=>a.includes(e.platformId)),t(n)}})},isXppViewer:function(){return Boolean(this._isXppViewer)},setXppViewer:function(e){this._isXppViewer=e},storePlatformServiceData:function(e){this._serviceData=e,this.dispatchEvent("serviceDataLoaded")},isServiceDataLoaded:function(){return 0!==this._serviceData.length},getServiceUrl:function(e,t){var i=this.getTenantServiceData();if(!i||!i[e]){if(t)return!1;throw new Error("Service data not loaded")}return i[e]},getTenant:function(){return s()?widget.getValue("x3dPlatformId"):this._tenant},setTenant:function(e){s()?widget.setValue("x3dPlatformId",e):this._tenant=e},isOnPremise:function(){return"OnPremise"===this.getTenant()},isInternalProduction:function(){return"DSEXT001"===this.getTenant()||widget&&"DSEXT001"===widget.getValue("fakeInternalProd")},getTenantServiceData:function(e){var i=e||this.getTenant();return t.detect(this._serviceData,function(e){return e.platformId===i})},fetchRolesData:function(){var e=this;n.getGrantedRoles(function(t){e._rolesData=t,e.setXPPLicenseStatus(),e.dispatchEvent("rolesDataLoaded")})},hasLoadedRolesData:function(){return this._rolesData.length>0},hasRole:function(t){if(this.hasLoadedRolesData()){var i=e.Array.detect(this._rolesData,function(e){return"InternalDS"===e.id}),n=e.Array.detect(this._rolesData,function(e){return e.id===t}),a=n&&-1!==n.platforms.indexOf(this.getTenant());return Boolean(i||a)}throw new Error("Fetching of Roles Data is not finished.")},hasSimulationRole:function(){var e=this;return["SPF","SPF-OC","MDO","MDO-OC","SPI","SPI-OC","SEI","SEI-OC"].some(function(t){return e.hasRole(t)})},setAuthorized:function(e,t){this["_"+e+"Authorized"]=t},hasRiskRole:function(){return this.isAuthorized("DPM")||this.isAuthorized("RSK")},isXPPAuthorized:function(){return!!this.hasOwnProperty("_XPPAuthorized")&&(this._XPPAuthorized||(this._XPPAuthorized=this.hasRole("XPP")||this.hasRole("CTR")),this._XPPAuthorized)},isAuthorized:function(e){return this["_"+e+"Authorized"]||this.hasRole(e)},setXPPAuthorized:function(e){this._XPPAuthorized=e,this.setXPPLicenseStatus(),this.dispatchEvent("xppAuthorizedLoaded")},hasXPPAuthorizationChecked:function(){return this.hasOwnProperty("_XPPAuthorized")},setXPPLicenseStatus:function(){this.hasLoadedRolesData()&&this.hasXPPAuthorizationChecked()&&!this.isXPPAuthorized()&&(this._XPPLicenseOK=!1)},isXPPLicenseOK:function(){return!this.hasOwnProperty("_XPPLicenseOK")||this._XPPLicenseOK},clearCachedServiceData:function(){this._serviceData=[],this._rolesData=[]},hasAccess:function(e){try{return Boolean(this.getServiceUrl(e))}catch(e){return!1}},getCurrentLanguage:function(){return widget.lang},setContextUserUid:function(e){this._userUid=e,this.dispatchEvent("userUidSet")},getContextUserUid:function(){return this._userUid},getContextUser:function(){return window.enoviaServer.user},getContextUserName:function(){var e=a.getUser();return e.firstName+" "+e.lastName},getCollaborativeSpaceName:function(){return WidgetUwaUtils.spaceNames&&WidgetUwaUtils.spaceNames[widget.getValue("collabspace")]&&WidgetUwaUtils.spaceNames[widget.getValue("collabspace")].displayName},setInvalidTenant:function(e){this._invalidTenant=e},getInvalidTenant:function(){return this._invalidTenant}});r._instance=r._instance||new r;let l=a.subscribe("DS/PADUtils/PADCommandProxy/sessionContent",()=>{r._instance._is3DViewerPresent=!0,a.unsubscribe(l)});return a.publish("DS/PADUtils/PADCommandProxy/getSessionContent",{metadata:{uid:`this should be documented ${o.getUUID()}`}}),r._instance}),define("DS/E6WCommonUI/FileSaver",[],function(){"use strict";var e=window;function t(e,t,i){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){a(n.response,t,i)},n.onerror=function(){console.error("could not download file")},n.send()}function i(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return t.status>=200&&t.status<=299}function n(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(i){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="download"in HTMLAnchorElement.prototype?function(a,o,s){var r=e.URL||e.webkitURL,l=document.createElement("a");o=o||a.name||"download",l.download=o,l.rel="noopener","string"==typeof a?(l.href=a,l.origin!==location.origin?i(l.href)?t(a,o,s):n(l,l.target="_blank"):n(l)):(l.href=r.createObjectURL(a),setTimeout(function(){r.revokeObjectURL(l.href)},4e4),setTimeout(function(){n(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,a,o){if(a=a||e.name||"download","string"==typeof e)if(i(e))t(e,a,o);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout(function(){n(s)})}else navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,o),a)}:function(i,n,a,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof i)return t(i,n,a);var s="application/octet-stream"===i.type,r=/constructor/i.test(e.HTMLElement)||e.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||s&&r)&&"object"==typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},d.readAsDataURL(i)}else{var c=e.URL||e.webkitURL,u=c.createObjectURL(i);o?o.location=u:location.href=u,o=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}};return{saveAs:a}}),define("DS/E6WCommonUI/CompassUtil",["DS/i3DXCompassServices/i3DXCompassPubSub","DS/PlatformAPI/PlatformAPI"],function(e,t){"use strict";return{openCompassWithModel:function(t,i){var n;(i&&i.transferObject||t.getTransferObject)&&(n=i&&i.transferObject||t.getTransferObject&&t.getTransferObject()),n&&(e.publish("setObject",n.data.items[0]),e.publish("setX3DContent",n))},publishOnPlatformAPI:function(e,i){i.getTransferObject&&t.publish(e,i.getTransferObject())}}}),define("DS/E6WCommonUI/NumberUtils",["UWA/Core"],function(e){"use strict";return{digitsToASCII:function(e){return function(){var e=new RegExp("([0-9٠-٩۰-۹߀-߉๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９]|\ud801[\udca0-\udca9]|\ud804[\udcf0-\udcf9\uddd0-\uddd9\udef0-\udef9]|\ud805[\udc50-\udc59\udcd0-\udcd9\ude50-\ude59\udec0-\udec9\udf30-\udf39]|\ud806[\udce0-\udce9]|\ud807[\udc50-\udc59]|\ud81a[\ude60-\ude69]|\ud81a[\udf50-\udf59]|\ud83a[\udd50-\udd59])|([०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯᥆-᥏]|\ud804[\udc66-\udc6f\udd36-\udd3f])|(\ud835[\udfce-\udfff])","g");function t(e,t,i,n){var a=e.charCodeAt(e.length-1),o=t?15&a:i?a-6&15:n?(a-206&63)%10:null;return String.fromCharCode(48+o)}return function(i){return i.replace(e,t)}}()(e)}}}),define("DS/E6WCommonUI/Collections/MergingCollection",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener"],function(e,t,i,n){"use strict";var a=i.extend(n,{_uwaClassName:"MergingCollection",sortedModels:null,_models:{},addSubCollection:function(t,i){this._subCollections||(this._subCollections=[]);var n=e.clone(i||{},!1);n.previousModels=this.toArray(),this._subCollections.push(t),this.listenTo(t,"onAnyEvent",function(e,t){"onRemove"===e&&this.sortedModels&&this.indexOf(t)>-1&&this.sortedModels.splice(this.indexOf(t),1);var i=Array.prototype.slice.call(arguments,1);this.dispatchEvent(e,i)}),i&&i.silent||this.dispatchEvent("onReset",[this,n])},_arrayReturningFunction:function(e){return this._subCollections?(this.sort(),Array.prototype.concat.apply([],this._subCollections.map(e))):[]},toArray:function(){return this.sort(),this._arrayReturningFunction(function(e){return e.toArray()})},size:function(){var e=0;return this._subCollections&&this._subCollections.forEach(function(t){e+=t.size()}),e},toJSON:function(){return this._arrayReturningFunction(function(e){return e.toJSON()})},get:function(){var e;this.sort();for(var t=this._subCollections,i=t.length,n=0;n<i;n++){var a=t[n];if(e=a.get.apply(a,arguments))break}return e},indexOf:function(e){return this.sort(),this.sortedModels.indexOf(e)},at:function(e){return this.sort(),this.sortedModels.at(e)},complete:function(){for(var t=this._subCollections,i=t.length,n=0;n<i;n++){var a=t[n];e.is(a.complete,"function")&&a.complete.apply(a,arguments)}this.sort()},updateModels:function(){this._models={};var e=this;this._subCollections.forEach(function(t){t._models.forEach(function(t){e._models[t.id]=t})}),delete this.sortedModels},sort:function(){if((!this.sortedModels||this.sortedModels.length!==this.size())&&this.size()>0){this.updateModels();var e=Object.values(this._models);this.sortedModels=e.sort(function(e,t){let i=new Date(e.get("endDate")),n=new Date(t.get("endDate"));return i.getTime()!==n.getTime()?i.getTime()-n.getTime():e.get("title")!==t.get("title")?e.get("title").toLowerCase().localeCompare(t.get("title").toLowerCase()):0}),this.sortedModels.length>0&&this.dispatchEvent("sortComplete",[this])}},contains:function(e){return-1!==this.indexOf(e)}});return Object.defineProperty(a.prototype,"length",{get:function(){return this.size()}}),a}),define("DS/E6WCommonUI/CommonUIHandlebarsHelper",["DS/Handlebars/Handlebars","text!DS/E6WCommonUI/assets/templates/showhidearrow.html.handlebars","text!DS/E6WCommonUI/assets/templates/attachURL.html.handlebars"],function(e,t,i){"use strict";return{registerPartials:function(){e.registerPartial("showHideArrow",t),e.registerPartial("attachURL",i)}}}),define("DS/E6WCommonUI/E6WCommonUIConstants",[],function(){"use strict";return{WORKING_HOURS_IN_A_DAY:8,LOGICAL_USER_TYPE:"dsplan:LogicalUser",URL_TYPE:"dsplan:url",WORK_CONTEXT_ATTR:"dsxplan:hasWorkContext",CHECKLIST_ITEM_TYPE:"dsplan:ChecklistItem",JS_TYPE_ATTR:"dsxplan:jsType",DSLC_TITLE_ATTR:"dsxplan:label",USER_GROUP_TYPE:"foaf:Group",PERSON_TYPE:"pno:Person",ACTUAL_DELIVERABLE_ATTR:"dsplan:actualDeliverable",ATTACHMENT_ATTR:"dsplan:hasAttachment",BOOKMARK_FOR_FILE_REPOSITORY:"dsplan:hasBookmark",PROJECT_TEMPLATE_TYPE:"dsplan:ProjectPlanningTemplate",IMAGE_TILE_ATTR:"image_tile",IMAGE_THUMBNAIL_ATTR:"image_thumbnail",CANDIDATE_ASSIGNEE_ATTR:"dsxplan:hasCandidateAssignee",TAGS_DATA:"tagsData",USER_TAGS:"userTags",SERVICE_3DPLAN:"3dplan",SERVICE_3DSWYM:"3DSwym",ACTUAL_START_DATE:"dsplan:actualStartDate",ACTUAL_END_DATE:"dsplan:actualEndDate",ACTUAL_START_ATTR:"actualStartDate",ACTUAL_FINISH_ATTR:"actualFinishDate",ENDDATE_ATTR:"dsplan:estimatedEndDate",STARTDATE_ATTR:"dsplan:estimatedStartDate",USER_DEFINED_START_DATE_ATTR:"dsxplan:userDefinedStart",USER_DEFINED_END_DATE_ATTR:"dsxplan:userDefinedEnd",ESTIMATED_START_DATE:"estimatedStartDate",ESTIMATED_DUE_DATE:"dueDate",PLANNED_START_LABEL:"Planned Start",ACTUAL_START_LABEL:"Actual Start",PLANNED_END_LABEL:"Planned End",ACTUAL_END_LABEL:"Actual End",APP_3DPLAN:"ENXPLAN_AP",APP_TSK:"ENOTASK_AP"}}),define("DS/E6WCommonUI/TopBarSearchDispatcher",["UWA/Core","UWA/Class/Events","UWA/Class/Listener"],function(e,t,i){"use strict";var n=t.extend(i,{_uwaClassName:"TopBarSearchDispatcher",listenToTopBarSearch:function(){this.listenTo(widget,{onSearch:this._dispatchSearchEvent,onResetSearch:this._dispatchResetSearch})},_dispatchSearchEvent:function(e){this._search=e,this.dispatchEvent("onTopBarSearch",arguments)},_dispatchResetSearch:function(){delete this._search,this.dispatchEvent("onTopBarResetSearch",arguments)},getSearchString:function(){return this._search},getSearchStringConvertedToRegex:function(){var e=this._search,t="";return e?/[*?]/.test(e)?(e.split("").forEach(e=>{switch(e){case"*":t=t.concat(".*");break;case"?":t=t.concat(".");break;default:t=t.concat(e)}}),t):t=".*"+e+".*":""}});return n._instance=n._instance||new n,n._instance}),define("DS/E6WCommonUI/Search",["UWA/Core","UWA/Utils/InterCom","UWA/Utils","DS/RDFFoundation/MemberUtils"],function(e,t,i,n){"use strict";var a=["3dspace","drive"],o=function(e,n){this.socketName="search_socket_"+i.getUUID(),this.socket=new t.Socket(this.socketName,{dispatchRetryInterval:5}),this.socket.subscribeServer("SearchComServer"),this.listener=this.objectsSelected.bind(this),this.socket.addListener("Selected_Objects_search",this.listener);var a=this;this.socket.addListener("onCloseTransient",function(){a.unregister()});var o=this.options({title:"iTitle"});n&&(o.idcard_activated=!0)};return o.prototype.destroy=function(){var e={};e.widget_id=widget&&widget.id||enoviaServer.widgetId,this.socket.dispatchEvent("UnregisterContext",e),this.socket.unsubscribeServer("SearchComServer"),this.socket.removeListener("Selected_Objects_search",this.listener),this.socket.removeListener("onCloseTransient"),this.socket.disconnect()},o.prototype.options=function(t){var i,n=e.clone(t||{},!1),a=((i={title:"",types:"",role:"",default_search_criteria:""}).app_socket_id=this.socketName,i.mode="furtive",i.widget_id=widget.id,i.default_with_precond=!0,i.show_precond=!1,i.idcard_activated=!1,i.select_result_max_idcard=!1,i.source=["3dspace"],i.tenant=window.enoviaServer?enoviaServer.tenant:widget.getValue("x3dPlatformId"),i.precond="",i.excluded_types={},i.callback=null,i);n.excludedSearchTypes&&(a.excluded_types=n.excludedSearchTypes),e.extend(a,n);let s=a.fieldConfig;delete a.fieldConfig;let r=a.default_search_criteria;if(s?a.specific_source_parameter=o.computeSourceParameters(s,r):(!function(t){if(e.is(t.types,"object")){var i="Config not supported by 3dsearch. If you specify types for any source, you must do so for all sources",n=e.is(t.source,"array")?t.source:[t.source],a=Object.keys(t.types);if(a.length!==n.length)throw new Error(i);for(var o=0;o<a.length;o++){const e=a[o];if(-1===n.indexOf(e)||!e||0===e.length)throw new Error(i)}}}(a),a.precond||(a.precond=o.buildSearchTypeQuery(a.types,a))),a.additionalQuery)if(e.is(a.additionalQuery,"string")){var l=a.precond||"";a.precond=l+a.additionalQuery}else for(const e of Object.keys(a.additionalQuery)){let t=a.specific_source_parameter[e];t&&t.additional_query?a.specific_source_parameter[e].additional_query+=a.additionalQuery[e]:((t={})[e].additional_query=a.additionalQuery[e],a.specific_source_parameter[e]=t)}return a},o.prototype.activate=function(t){var i=this,n=this.options(t),a=n.callback;e.is(a,"function")||(n.mode="default"),this.callback=a;var o={};o.widget_id=widget&&widget.id||enoviaServer.widgetId,this.socket.dispatchEvent("UnregisterContext",o),this.socket.addListener("RegisterContext_Response",function(){i.socket.dispatchEvent("InContextSearch",n),i.socket.removeListener("RegisterContext_Response")}),this.socket.dispatchEvent("RegisterContext",n)},o.prototype.isAvailable=function(){return e.is(this.socket)},o.prototype.objectsSelected=function(e){this.callback&&this.callback(e)},o.prototype.unregister=function(){var e={widget_id:widget&&widget.id||enoviaServer.widgetId};this.socket.dispatchEvent("UnregisterContext",e)},o.buildSearchTypeQuery=function(t,i){var n;if(t){if(e.is(t,"string")){var a=i.source||["3dspace"];if(-1===(a=e.is(a,"array")?a:[i.source]).indexOf("3dspace")&&a.length)throw new Error("types as string only supported for 3dspace source as it is a backward compatibility feature");t={"3dspace":t.split(",")}}var s=Object.keys(t),r=s.length;n="(";for(var l=0;l<r;l++){0!==l&&(n+=" OR ");var d=s[l],c=t[d];e.is(c,"string")&&(c=[c]),n+=o.buildSearchTypeQueryForSource(d,c,i)}if(i.excluded_types)n+=Object.keys(i.excluded_types).length>0?") AND NOT "+o.buildSearchTypeQuery(i.excluded_types,{exclude:!0}):")";else n+=")"}else i.excluded_types&&(n=" NOT "+o.buildSearchTypeQuery(i.excluded_types,{exclude:!0}));return n},o.buildSearchTypeQueryForSource=function(e,t,i){var n,a=o.isM1BasedSource(e);if(n=a?"flattenedtaxonomies:":"[ds6w:type]:",n+="(","swym"===e&&t&&-1!==t.indexOf("pno:Person")&&i&&!i.exclude&&i.excludePendingUser&&(n="ut_state:1 && "+n),t)for(var s=0;s<t.length;s++){var r=t[s];0!==s&&(n+=" OR "),n+=a?'"types/'+r.trim()+'"':'"'+r.trim()+'"'}return n+=")"},o.isM1BasedSource=function(e){return-1!==a.indexOf(e)},o.computeSourceParameters=function(t,i){var n=e.clone(t.excludeSearchTypes||{},!1),s={};a.forEach(function(i){(e.is(t.searchSource,"array")&&-1!==t.searchSource.indexOf(i)||t.searchSource===i)&&(n[i]||(n[i]=["Person","Security Context"]))});var r,l=t.searchSourceTypes;return l&&(r={types:l,specificSourceParameter:s,excludePendingUser:t.excludePendingUser,agoraMode:t.agoraMode},o._buildSpecificSourceParameter(r,i)),r={types:n,specificSourceParameter:s,exclude:!0,agoraMode:t.agoraMode},o._buildSpecificSourceParameter(r,i),s},o._buildSpecificSourceParameter=function(e,t){for(var i=e.specificSourceParameter,a=e.types,s=e.agoraMode,r=Object.keys(a),l=r.length,d=0;d<l;d++){var c=r[d],u=a[c],h=i[c],m=h&&h.additional_query||"";m&&(m+=" AND "),e.exclude&&(m+="NOT "),t&&"usersgroup"in e.types?("swym"===c&&(m=" AND personOrGroup:("+t+")"),"usersgroup"===c&&(m=" AND [ds6w:label]:("+n.escapeRegExp(t)+"*)")):m+=o.buildSearchTypeQueryForSource(c,u,e),i[c]={additional_query:m,...s&&{agoraMode:s}}}return i},o}),define("DS/E6WCommonUI/Models/BulkModel",["UWA/Class/Model","DS/RDFFoundation/RDFUtils"],function(e,t){"use strict";var i=e.extend({_uwaClassName:"BulkModel",setup:function(e){var t=this;if(!(Array.isArray(e)&&e.length>0))throw new Error("Invalid arguments: an array of one or more models should be passed");this.constructor=e[0].constructor,this.models=e,this.models.forEach(function(e){t.listenTo(e,"onAnyEvent",function(e){var i=Array.prototype.slice.call(arguments,1);t.dispatchEvent(e,i)})})},get:function(e){return this.models.map(function(t){return t.get(e)})},fetchForProperty:function(){let e=t.getBatchGenerator();this.models.forEach(function(t){t.fetchForProperty&&t.fetchForProperty({batchBuilder:e})}),e.sendBatch()},hasSameModels:function(e){return this.models.length===e.models.length&&this.models.every(function(t){e.models.includes(t)})},getObjectType:function(){return this.models[0].getObjectType()},isProjectTask:function(){return this.models[0].isProjectTask()},isRouteTask:function(){return this.models[0].isRouteTask()},isIteropTask:function(){return this.models[0].isIteropTask()},isRDFTask:function(){return this.models[0].isRDFTask()},isDPMMilestoneGate:function(){return this.models[0].isDPMMilestoneGate&&this.models[0].isDPMMilestoneGate()},subscriptionsEnabled:function(){return this.models[0].subscriptionsEnabled()},hasFetchedAccessData:function(){return!1},canAssignToSelf:function(){let e=this.models.every(function(e){return e.hasPermissionToAssignToSelf()}),t=this.models.some(function(e){return e.isAssignedToCurrentUser()});return e&&!t},getCustomFields:function(){}});return Object.defineProperty(i.prototype,"isRDF",{get:function(){return this.models.every(function(e){return e.isRDF})},set:function(e){this.models.forEach(function(t){t.isRDF=e})}}),i}),define("DS/E6WCommonUI/Views/CustomizedAutocomplete",["DS/UIKIT/Autocomplete"],function(e){"use strict";var t=0;return e.extend({init:function(){this._cid=t++,this._parent.apply(this,arguments),this.options.infoMessageCallback&&(this._infoMessageElement=UWA.createElement("div",{class:"info-message-bar",html:[{tag:"span",class:"fonticon fonticon-info"},{class:"info-message",tag:"span"}]}))},_shouldDropUp:function(e){var t=this.boundingElement||document.documentElement;return(e||this.getContent().getOffsets().y+this.elements.inputContainer.getDimensions().height)+this.elements.suggestsContainer.getSize().height>(t.clientHeight||window.innerHeight)+(window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop)},setBoundingElement:function(e){this.boundingElement=e},reset:function(){this._parent.apply(this,arguments),this.dispatchEvent("onHideSuggests")},getSuggestions:function(e){"function"==typeof this.options.noResultsMessageCallback&&(this.options.noResultsMessage=this.options.noResultsMessageCallback(e)),e.length>=this.options.minLengthBeforeSearch?this._parent.apply(this,arguments):this.reset(),this.options.infoMessageCallback&&setTimeout(()=>{this._infoMessageElement.getElements("span")[1].setText(this.options.infoMessageCallback(e)),this._infoMessageElement.inject(this.elements.suggestsContainer,"top")},0)},onUpdateSuggests:function(){this._parent.apply(this,arguments),this.options.infoMessageCallback&&this.elements.suggestsContainer.setStyle("height",parseInt(this.elements.suggestsContainer.getStyle("height"))+20)},destroy:function(){this._infoMessageElement&&(this._infoMessageElement.destroy(),this._infoMessageElement=void 0),this._parent.apply(this,arguments)}})}),define("DS/E6WCommonUI/UnitBezier",["UWA/Class"],function(e){"use strict";return e.extend({epsilon:1e-6,init:function(){this.cx=1.26,this.bx=3*(.58-.42)-this.cx,this.ax=1-this.cx-this.bx,this.cy=0,this.by=3-this.cy,this.ay=1-this.cy-this.by},sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){var i,n,a,o,s,r;for(a=e,r=0;r<8;r++){if(o=this.sampleCurveX(a)-e,Math.abs(o)<t)return a;if(s=this.sampleCurveDerivativeX(a),Math.abs(s)<t)break;a-=o/s}if((a=e)<(i=0))return i;if(a>(n=1))return n;for(;i<n;){if(o=this.sampleCurveX(a),Math.abs(o-e)<t)return a;e>o?i=a:n=a,a=.5*(n-i)+i}return a},solve:function(e,t){var i=t||this.epsilon;return this.sampleCurveY(this.solveCurveX(e,i))}})}),define("DS/E6WCommonUI/TagUtils",["DS/E6WCommonUI/PlatformManager","DS/RDFFoundation/RDFUtils","DS/WAFData/WAFData"],function(e,t,i){"use strict";return{getTagInfo:function(n){const a=(n.isRDF?e.getServiceUrl("6WTags",!0):e.getServiceUrl("3DSpace",!0))+"/resources/6w/tags?xrequestedwith=xmlhttprequest&tenant="+e.getTenant(),o={tag:[{subject:[{uri:n.getTagPrefix&&n.getTagPrefix()+encodeURIComponent(t.jsonURIToSparqlURI(n.id))}]}]};i.authenticatedRequest(a,{method:"POST",headers:{"Content-Type":"application/json"},type:"json",data:JSON.stringify(o),onComplete:function(e){var t=[];e.results&&e.data&&e.data[0].tag.forEach(e=>{var i={};i.type=e.predicate.split(":")[1],i.value=e.object.literal,t.push(i)}),n.set("tagsData",t,{dontRegisterChange:!0})},onFailure:function(){console.log("unable to get tags")}})}}}),define("DS/E6WCommonUI/ApolloUtils",["UWA/Core","UWA/Class/Events","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Collections/CollectionTaggerHelper","DS/RDFFoundation/FederatedSearchUtil","DS/E6WCommonUI/PlatformManager"],function(e,t,i,n,a,o){"use strict";var s=["what","when","where","who","why","how"],r={"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Kernel/label>":"dsxplan:label","<urn:x-arq:DefaultGraph> <http://www.3ds.com/vocabularies/ds6w/type>":"@type",estimatedEnd:"dsxplan:estimatedEndDate",estimatedStart:"dsxplan:estimatedStartDate",created:"dspol:creationDate",modified:"dspol:modificationDate",actualStart:"dsxplan:actualStartDate",actualEnd:"dsxplan:actualEndDate","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/parentProjectIndexId>":"dsxplan:workscopeParent","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/workDecompositionParentIndex>":"dsxplan:workDecompositionParent","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/parentProjectMilestoneIndexId>":"dsxplan:workscopeParent","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/parentTaskIndexId>":"dsxplan:taskParent","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/jsType>":"dsxplan:jsType","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/comment>":"dsxplan:comment","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/logicalAssignee>":"dsplan:hasAssignee","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasRolledUpInfo>":"dsxplan:hasRolledUpInfo"},l={"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Kernel/owner>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasAssignee>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/logicalAssignee>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/com/hasMaturity>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasPriority>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasAttachment>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/actualDeliverable>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/parentProjectIndexId>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/parentProjectMilestoneIndexId>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/workDecompositionParentIndex>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasMilestone>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasGate>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasFromConstraint>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/parentTaskIndexId>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/xPlan/from>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/xPlan/to>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/isRolledUpInfoFor>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasRolledUpInfo>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasWorkContext>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasScheduleError>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasReferenceProject>":!0};var d,c={"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Kernel/owner>":"foaf:Person","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasAssignee>":"foaf:Person","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/logicalAssignee>":"dsplan:LogicalUser","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/parentProjectIndexId>":"dsplan:Project","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/parentProjectMilestoneIndexId>":"dsplan:Project","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/workDecompositionParentIndex>":"dsplan:Project","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasMilestone>":"dsplan:Milestone","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasGate>":"dsplan:Gate","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/parentTaskIndexId>":"dsplan:Task","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/isRolledUpInfoFor>":"dsplan:Project","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasRolledUpInfo>":"dsplan:RolledUpInfo","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasFromConstraint>":"dsplan:TemporalConstraint","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasWorkContext>":function(e){return"dsplan:Task"===e["dsxplan:jsType"]?"dscom:ComponentProxy":"dsplan:Project"},"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasReferenceProject>":"dsplan:Project"},u={"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasAttachment>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/actualDeliverable>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasAssignee>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/logicalAssignee>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasMilestone>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasGate>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasReferenceProject>":!0,"<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasWorkContext>":!0},h=i.inverseMapping(i.typeDictionary.context),m={"ds6w:who/ds6w:responsible":"ownerFilter","ds6w:who/ds6w:assignee":"assigneeFilter","ds6w:where/ds6w:context/ds6w:parent":"parentFilter","ds6w:why/ds6w:priority":"priorityFilter","ds6w:what/ds6w:status":"stateFilter","ds6w:what":"whatFilter","ds6w:who":"whoFilter","ds6w:when":"whenFilter","ds6w:where":"whereFilter","ds6w:why":"whyFilter","ds6w:how":"howFilter","ds6w:when/ds6w:ends/ds6w:actualEnd":"actualEndFilter","ds6w:when/ds6w:ends/ds6w:plannedEnd":"plannedEndFilter","ds6w:when/ds6w:starts/ds6w:plannedStart":"plannedStartFilter","ds6w:when/ds6w:starts/ds6w:actualStart":"actualStartFilter","ds6w:when/ds6w:created":"createdFilter","ds6w:when/ds6w:modified":"modifiedFilter","ds6w:what/ds6w:type":"typeFilter","ds6w:where/ds6w:context/ds6w:community":"communityFilter","ds6w:what/ds6w:storyPoints":"storyPointsFilter"},p=i.inverseMapping(m),f=new RegExp("<.*> <(.*)>"),g={};var v=t.extend({_deletedModels:{},parse:function(t){var n=this,a=[],o=0,s=function(e){var t,i=e.match(/"(.*?)"/);return i.length>1&&(t=i[1]),t};try{t&&t.forEach(function(t){if(t&&t.stringPredicates){var r={},l=i.removeBracketLongURI(t.stringPredicates["<urn:x-arq:DefaultGraph> <http://www.3ds.com/vocabularies/ds6w/resourceUid>"][0]);if(n.userDeletedModel(l))o++;else{r["@id"]=l;const o={},c=i.getObjectById(l);let u=t.datetimePredicates&&t.datetimePredicates["<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Policy/modificationDate>"]&&t.datetimePredicates["<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Policy/modificationDate>"][0];u&&!u.endsWith("Z")&&(u+="Z"),c&&new Date(c.get("dspol:modificationDate"))>new Date(u)&&(o.noOverwrite=!0,o.fetchedAttributes=c.getFetchedAttributes()),n.addPredicatesToObject(r,t.datetimePredicates,e.merge({isDate:!0},o)),n.addPredicatesToObject(r,t.doublePredicates,o),n.addPredicatesToObject(r,t.longPredicates,o),n.addPredicatesToObject(r,t.stringPredicates,o),n.addPredicatesToObject(r,t.booleanPredicates,o),["<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/parentProjectIndexId>","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/workDecompositionParentIndex>","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/parentProjectMilestoneIndexId>","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/parentTaskIndexId>","<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Plan/hasRolledUpInfo>"].forEach(function(e){t.uriPredicates[e]||(t.uriPredicates[e]=t.stringPredicates[e])}),n._parseUriPredicates(r,t,o),r._tagData=t.tags,r.explicitTagsData=n.getApolloExplicitTagsData(t.tags),r._workscopeParent=t.workscopeParent,t.intervalMin&&(r["dsplan:durationIntervalMin"]=s(t.intervalMin)),t.intervalMax&&(r["dsplan:durationIntervalMax"]=s(t.intervalMax)),t.duration&&(r["dsplan:estimatedDuration"]=s(t.duration)),d.addMask(r),a.push(r)}}})}catch(e){console.error(e.message),console.error(e.stack)}return{models:a,deletedModelsFound:o}},getApolloExplicitTagsData:function(t){var i;return t&&s.forEach(function(n){var a=t[n];a&&(i||(i={}),i[n]||(i[n]=[]),e.is(a,"array")?i[n]=i[n].concat(a):i[n].push(a))}),i},_parseUriPredicates:function(e,t,i){for(var n in t.uriPredicates){var a=this.getAttributeFromPredicate(n);if(a){if(!i.noOverwrite||!i.fetchedAttributes[a]){var o=t.uriPredicates[n];u[n]?(e[a]=e[a]||{"@type":"Collection","@id":e["@id"]+"/"+a,member:[]},o.forEach(function(t){e[a].member.push(this._parseNestedObject(t,n,e))}.bind(this))):o&&l[n]&&(e[a]=this._parseNestedObject(o[0],n,e))}}else console.error(`No attribute mapping for ${n}. Skipping it.`)}},_parseNestedObject:function(t,n,a){if(!l[n])return;var o=this.getClientId(t),s={"@id":o};if(!i.getObjectById(o)){let t=c[n];t&&(e.is(t,"function")&&(t=t(a)),s["dsxplan:jsType"]=t)}return s},addPredicatesToObject:function(t,i,n){const a=e.clone(n||{},!1);for(var o in i)if(i[o]){if("<urn:x-arq:DefaultGraph> <http://www.3ds.com/RDF/Corpus/Kernel/comment>"===o&&("dsplan:Milestone"===t["dsxplan:jsType"]||"dsplan:Gate"===t["dsxplan:jsType"]))continue;var s=i[o][0],r=this.getAttributeFromPredicate(o);if(n.noOverwrite&&n.fetchedAttributes[r])continue;r&&e.is(s)&&(a.isDate&&!s.endsWith("Z")&&(s+="Z"),t[r]=s)}},getAttributeFromPredicate:function(e){if(g[e])return g[e];if(r[e])g[e]=r[e];else{var t=e.match(f)[1];g[e]=this.longToShortURI(t)}return g[e]},longToShortURI:function(e){var t=e.split("/"),i=t.pop(),n=t.join("/")+"/";return h[n]?`${h[n]}:${i}`:(console.error(`${n} does not have short URI defined in ApolloUtils.js`),e)},parseTags:function(e){var t=JSON.parse(e),n=[],o={};if(t.body.outputs)for(var s in t.body.outputs)Object.values(t.body.outputs[s].views).forEach(function(e){var t=e.data.axes[0].dimensions[0].ticks;t&&e.data.points.forEach(function(a,s){if(!t[a[0][0]]||!t[a[0][0]].value)return;var r=!1;const l=t[a[0][0]].value;l&&l.match&&l.match(/(\d\d\d\d\/\d\d\/\d\d)/)&&(r=!0);var d,c={object:l?l.toString():l,sixw:(d=e.data.axes[0].name,p[d]||d),count:a[1][0],type:r?"date":isNaN(l)?"string":"double"};if("ds6w:where/ds6w:context/ds6w:community"===c.sixw){var u=i.removeBracketLongURI(c.object);u&&(u=u.substring(u.indexOf("_")+1)),o[u]=c}else n.push(c)})});return function(e,t){for(var i=[],n=0;n<e.length;n++)i.push('[ds6w:resourceUid]:"'+e[n]+'"');if(i.length>0){var o={sources:["swym"],nresults:i.length+10,query:i,select_predicate:["ds6w:label","ds6w:type","ds6w:resourceUid"],delimeter:" BOR ",onComplete:function(e){t.onComplete&&t.onComplete(e)},onFailure:function(e){t.onFailure&&t.onFailure(e)}};a.sendRequestWithDelimiter(o)}}(Object.keys(o),{onComplete:function(e){var t=e.results;if(t&&t.length){for(var i=[],a=0;a<t.length;a++){var s=o[t[a].attributes.find(e=>"resourceid"===e.name).value];s.dispValue=t[a].attributes.find(e=>"ds6w:label"===e.name).value,i.push(s)}d.dispatchEvent("onCommunityDataLoaded",[n.concat(i)])}}}),n},createFilterParams:function(e){var t=[],i=this;for(var a in e){var o=[];e[a].forEach(function(e){if("date"===e.type){var s=n.getFromAndToDateFromDateTagFilter(e.object);s.to&&t.push({key:i.getServiceVariableForTag(a)+"To",value:JSON.stringify(s.to.toISOString())}),s.from&&t.push({key:i.getServiceVariableForTag(a)+"From",value:JSON.stringify(s.from.toISOString())})}else"double"===e.type?o.push(parseFloat(e.object)):o.push(e.object)}),o.length>0&&t.push({key:i.getServiceVariableForTag(a),value:JSON.stringify(o)})}return t},onModelDeleted:function(e){this._deletedModels[e.id]=!0},userDeletedModel:function(e){return this._deletedModels[e]},sendInitialRequest:function(){i.request(this.getServiceLoginUrl(),{ignoreDictionary:!0,method:"GET"})},getServiceUrl:function(){return o.getServiceUrl("3dplan",!0)+"/3drdfindexfts/services/customdataquery"},getServiceLoginUrl:function(){return o.getServiceUrl("3dplan",!0)+"/3drdfindexfts/services/login"},addMask:function(e){var t;switch(e["dsxplan:jsType"]){case"dsplan:Project":case"dsplan:xProject":t="dsplan:MVMask.WorkPackage.Apollo";break;case"dsplan:Task":t="dsplan:MVMask.Task.Apollo";break;case"dsplan:Milestone":case"dsplan:Gate":t="dsplan:MVMask.Milestone.Complex"}t&&(e["@mask"]=t)},getClientId:function(e){var t=e;return e.startsWith("<uuid")?t=i.removeBracketLongURI(e):e.startsWith("<http")&&(t=e.match(/<(.*)>/)[1],t=this.longToShortURI(t)),t}});return(d=new v).PROJECT_TAGS_SERVICE="custom_ProjectTaskTags",d.getServiceVariableForTag=function(e){return m[e]||e},d.APOLLO_EXPLICIT_TAG_KEYS=s,d}),define("DS/E6WCommonUI/UIHelper",["UWA/Core","UWA/Utils/Client","UWA/Utils/InterCom","UWA/Promise","DS/UIKIT/Alert","DS/UIKIT/SuperModal","DS/UIKIT/Mask","DS/UIKIT/Tooltip","DS/UIKIT/Modal","DS/UIKIT/DropdownMenu","DS/Handlebars/Handlebars4","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/MemberUtils","DS/RDFFoundation/ProjectTypeUtils","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/E6WCommonUI/FileSaver","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/E6WCommonUIConstants","DS/i3DXCompassPlatformServices/OpenWith","DS/WAFData/WAFData","DS/Usage/TrackerAPI","DS/Notifications/NotificationsManagerAbstract","i18n!DS/RDFFoundation/assets/nls/RDFFoundationNLS","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n,a,o,s,r,l,d,c,u,h,m,p,f,g,v,E,D,_,w,C,b,y){"use strict";f.setNotificationManager(p);var T=y.get("E6WCommonUI.Info.LoadingData"),S={autoHide:!0,closable:!0,closeOnClick:!1,className:"eno6wcommonui-alert-root"},A={"dsplan:Task":y.get("E6WCommonUI.Label.Task"),"dsplan:Milestone":y.get("E6WCommonUI.Label.Milestone"),"dsplan:Gate":y.get("E6WCommonUI.Label.Gate"),"dsplan:Project":y.get("E6WCommonUI.Label.Project"),"dsplan:xProject":y.get("E6WCommonUI.Label.xProject"),"dsplan:ProjectPlanningTemplate":b.get("xPlan.Label.Template"),"pno:Person":y.get("E6WCommonUI.Label.Person"),"dsplan:LogicalUser":y.get("E6WCommonUI.Label.LogicalUser")},I=["Simulation","Simulation Template"];let U=c.compile("{{message}}");var x={trackPageEvent:function(t){var i=e.clone(t,!1),n=window.widget&&window.widget.getValue("appId");n===E.APP_3DPLAN?i.scope="3DPlan":n===E.APP_TSK&&(i.scope="CollabTask"),i.appID=n,i.tenant=v.getTenant(),i.eventAction=i.eventAction||i.eventCategory,w.trackPageEvent(i)},trackPageView:function(t){var i=e.clone(t,!1);i.appID=widget.getValue("appId"),i.tenant=v.getTenant(),w.trackPageView(i)},removeFromArray:function(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)},enrichObjectFromSearch:function(t){var i=t.sourceid||t.sourceId;if(i){var n=i.indexOf(":");t.source=-1===n?i:i.substring(0,n),t.serviceId=u.serviceFromSource(t.source)}t.id&&e.merge(t,{objectType:t["ds6w:type_value"]||t["ds6w:type"],displayType:t["ds6w:type_value"]||t["ds6w:type"]})},drag21compliant:function(e){e&&e.data&&e.data.items&&e.data.items.forEach(e=>delete e.objectTaxonomies)},extraDragForSwym:function(e){try{"3DSwym"===e.data.items[0].serviceId&&(widget.socket||(widget.socket=new i.Socket("DetailsDisplayView"+widget.id),widget.socket.subscribeServer("ifweServer",window.parent)),widget.socket.dispatchEvent("SwymContentDragStarted",e))}catch(e){console.log(e)}},getParentTypesFromMap:function(e){return this.parentTypesMap[e]},addToParentTypesMap:function(e,t){this.parentTypesMap[e]=t},destroyOpenWith:function(e){e.openWith&&(delete e.openWith._content,delete e.openWith._dropdown,e.openWith._appsList&&(e.openWith._appsList.request&&e.openWith._appsList.request.cancel(),delete e.openWith._appsList)),delete e.openWith},addOpenWith:function(e){let t;return e.view.openWith&&this.destroyOpenWith(e.view),e.view.openWith=new D,e.view.openWith.set3DXContent(e.modelData).retrieveCompatibleApps(function(i){i.length>0&&(t=e.dropdownMenu.addItem({id:"OpenWith",title:"Open With",text:y.get("E6WCommonUI.Label.OpenWith"),fonticon:"open-menu-dot",index:0}),i.forEach(function(t){e.dropdownMenu.addItem(x.compatibleAppToMenuItem(t))}))}),t},compatibleAppToMenuItem:function(e){return{name:e.text,text:e.text,type:"PushItem",title:e.text,icon:e.icon,handler:e.handler,parentItemId:"OpenWith",action:e.handler}},launchPreviewGroupMembers:function(e,t){let i=require("DS/i3DXRDFGroupViewer/js/GroupViewer");var n=require("DS/RDFFoundation/SecurityContextUtils").getDefaultSecurityContext().split("::")[1],a={platformId:v.getTenant(),groupId:e,language:v.getCurrentLanguage()};if(v.isOnPremise()&&(a.securityContext=n),i){var o=new i(a);this._modal=new l({closable:!0,renderTo:t,className:"group-viewer",header:x.i18n("E6WCommonUI.Label.PreviewGroupMembers"),body:o.render()}),this._modal.getBody().addClassName("members-view"),this._modal.show()}},pictureAPIConfig:{defaultSwym:"https://dsext001-eu1-215dsi0708-3dswym.3dexperience.3ds.com",pictureAPIPrefix:"/api/user/getpicture/login/",pictureAPISuffixMini:"/format/mini",pictureAPISuffixNormal:"/format/normal"},i18n:function(e){return e?(window.WidgetConstants&&window.WidgetConstants.str||console.error("getWidgetConstant called too early (prior to constants initialization) "),(window.WidgetConstants&&window.WidgetConstants.str?window.WidgetConstants.str[e]:null)||y.get(e)):""},userPictureURL:function(e,t,i){var n="";if(!i||"Group"!==i.type&&"Group Proxy"!==i.type){if(e){var a=this.pictureAPIConfig.pictureAPISuffixMini,o=window.enoviaServer.swym;"normal"===t&&(a=this.pictureAPIConfig.pictureAPISuffixNormal),n=o?o+this.pictureAPIConfig.pictureAPIPrefix+e+a:""}}else n=i.imageUrl;return n},isIpad:function(){return t.Platform.ipad},isAndroid:function(){return t.Platform.android},isIOS:function(){return t.Platform.ios},isSurface:function(){return t.Platform.tablet&&(t.Platform.win32||t.Platform.win64)},isMobile:function(){return this.isIpad()||this.isAndroid()||this.isSurface()},isTouchExceptTablet:function(){return!(!this.isMobile()&&!t.Platform.ios)&&!t.Platform.tablet},isTouchDevice:function(){return Boolean("ontouchstart"in window||window.navigator.msMaxTouchPoints)},isIE:function(){return t.Engine.ie},isEdge:function(){return-1!==window.navigator.userAgent.indexOf("Edge/")},isWidgetNarrow:function(){return window.innerWidth<450},parentTypesMap:{},DATA_KEY_LIST:[void 0!==t.Engine.ie||-1!==window.navigator.userAgent.indexOf("Edge/")?"text":"text/plain","text/searchitems","dragObjectDetails"],isDataTransferTypeSupported:function(e){var t=!1;return e.types&&(t=this.DATA_KEY_LIST.some(function(t){for(var i=0;i<e.types.length;i++)return e.types[i].toLowerCase()===t;return!1})),t},saveBlobToFile:function(t,i){var n=new Blob([t],{type:"text/plain;charset=utf-8"}),a=i.get("title"),o=(a?a.replace(/[*/?\\<>:"]/g,"_"):"")+"_"+e.Date.strftime(new Date,"%m%d%Y")+".csv";g.saveAs(n,o)},isIconURL:function(e){return e&&(e.contains("images/icons")||e.contains("assets/img"))},getTransferObject:function(t){var i=e.clone(t,!1);i.serviceId=i.serviceId||"3DSpace";let n=i.source,a=i.i3dx?"2.1":"1.0";return"2.1"===a&&(delete i.objectType_Internal,delete i.displayType,i.image&&(!i.displayIcon&&x.isIconURL(i.image)?i.displayIcon=i.image:i.displayPreview=i.image,delete i.image),delete i.source),{protocol:"3DXContent",version:a,source:n,data:{items:[i]}}},i3dx:function(e){return e.get("i3dx")||"i3dx:"+e.serviceHosting+"!"+e.id},getDataTransferJSON:function(t){var i,n,a=["0.1","1.0","1.1","2.0","2.1"];return this.DATA_KEY_LIST.some(function(o){if(i=t.getData(o),e.is(i,"string"))try{i=JSON.parse(i)}catch(e){return!1}return(n=i.version&&"3DXContent"===i.protocol)?-1===a.indexOf(i.version)&&(n=!1):n=!1,n}),n?i:(x.displayError(x.i18n("E6WCommonUI.Alert.InvalidDataDropped")),!1)},dateForJSON:function(e,t,i,n){var a=e;return a=n&&n.dataForRendering?e&&{actualValue:a.getTime().toString(),displayValue:isNaN(a)?"":i&&i.getLocaleDate(a)}:"UTC"===t?isNaN(a.getTime())?"":a.toISOString():e.getTime()},getIntlDateFormat:function(e){var t=e,i=new Date(e);return"Invalid Date"!==i.toString()&&(t={actualValue:i,displayValue:isNaN(i.getTime())?t:x.DATE_FORMAT.format(i)}),t},getIntlDateTimeFormat:function(e){var t=e,i=new Date(e);return"Invalid Date"!==i.toString()&&(t={actualValue:i,displayValue:isNaN(i.getTime())?t:`${x.DATE_LONG_FORMAT.format(i)} (${x.TIME_FORMAT.format(i)})`}),t},getIntLongDateFormat:function(e){var t=e,i=new Date(e);return"Invalid Date"!==i.toString()&&(t={actualValue:i,displayValue:isNaN(i.getTime())?t:`${x.DATE_LONG_FORMAT.format(i)}`}),t},setHelper:function(t,i,n){var a,o=n;return t?e.is(t,"object")?(a=t,o=i||{}):((a={})[t]=i,o=n||{}):o=i,{attrs:a,options:o}},match:function(e,t){return!(!e||!t)&&(e=e.toLowerCase(),t=t.toLowerCase(),-1===e.indexOf("*")?-1!==t.indexOf(e):new RegExp("^"+e.split("*").join(".*")+"$").test(t))},processDroppedObjectPreview:function(e,t,i){t.onload=function(){x.scaleImage(this,null,null,i),window.URL.revokeObjectURL(this.src)},t.onerror=function(){i(null),window.URL.revokeObjectURL(this.src)};var n={method:"GET",type:"blob",onComplete:function(e){var i=new Blob([e]);t.src=window.URL.createObjectURL(i)},onFailure:function(){i(null)}};_.authenticatedRequest(e,n)},processDroppedImage:function(e,t,i){var n=e[0],a=n.name,o=n.type;t.onload=function(){window.URL.revokeObjectURL(this.src),x.scaleImage(this,a,o,i)},t.src=window.URL.createObjectURL(n)},openFileExplorer:function(t){var i={id:"fileUploadButton",type:"file",accept:t.accept};e.Utils.Client.Platform.ios||x.isSurface()||x.isAndroid()||!0===t.single||(i.multiple=!0);var n=e.createElement("input",{attributes:i,styles:{display:"none"},events:{change:function(){n.destroy(),t.callback&&t.callback(this.files)}}});n.inject(document.body),n.click()},scaleImage:function(e,t,i,n,a){var o=document.createElement("canvas"),s=o.getContext("2d");let r=a||{},l=r.maxWidth||160,d=r.maxHeight||120,c=r.maxByteSize||16300;var u=e.naturalWidth,h=e.naturalHeight,m=Math.min(d/h,l/u);m<1&&(h*=m,u*=m);for(var p,f=1;o.width=u,o.height=h,s.fillStyle="white",s.fillRect(0,0,o.width,o.height),s.drawImage(e,0,0,u,h),(p=o.toDataURL("image/jpeg",f)).length>c;)f-=.05;n(p)},initializeAlert:function(e){widget.alerter=new a(S),widget.alerter.inject(e,"top"),widget.alerter._lastInjectedTo=e;let t=widget.getValue("appId");"ENXPLAN_AP"!==t&&"ENOTASP_AP"!==t||(C.prototype.addNotif=function(e){x.displayMessage({message:e.message||e.title||e.subtitle,className:e.level})})},displayMessage:function(t,i){if(e.clone(t||{},!1).showWebUX)p.addNotif(t);else{if(!widget.alerter)return console.log("No alerter defined. This must be done by the application."),!1;widget.alerter.setOptions&&(i?widget.alerter.setOptions(i):widget.alerter.setOptions(S)),widget.alerter.elements&&!widget.alerter.elements.container.isInjected()&&widget.alerter.inject(widget.alerter._lastInjectedTo,"top"),widget.alerter.add(t),widget.alerter.show()}return!0},displayMessageBasedOnType:function(e){var t=e.msg,i=e.msgType;switch(e.msgType){case"warning":return this.displayWarning(t);case"info":return this.displayInfo(t);case"error":return this.displayError(t);case"success":return this.displaySuccess(t);case"primary":return this.displayPrimary(t);default:var n={message:t,className:i};return this.displayMessage(n)}},displaySuccess:function(e){return this.displayMessage({message:e,className:"success"})},displayError:function(t,i){var n=e.clone(i||{},!1);return e.merge(n,{message:t,className:"error"}),this.displayMessage(n,{hideDelay:4e3})},displayInfo:function(e,t){return this.displayMessage({message:e,className:"info"},{hideDelay:t||4e3})},displayWarning:function(e,t){return this.displayMessage({message:e,className:"warning"},{hideDelay:t||4e3})},displayPrimary:function(e){return this.displayMessage({message:e,className:"primary"})},getAlertInjectionLocation:function(){return widget.alerter&&widget.alerter._lastInjectedTo},updateDocumentConfirmation:function(e,t,i,n){if(e.length>1)x.displayError(y.get("E6WCommonUI.Alert.MultipleFilesNotSupported"));else{var a=e[0],s=t.get("title"),r=a.name,l={nameA:r,nameB:s};if("DriveFile"!==t.get("ds6w:type")&&(l={nameA:r=this.getFileNameWithoutExtension(r),nameB:r}),s!==r){var d={title:y.get("E6WCommonUI.Label.Update")+" "+s,body:y.replace(y.get("E6WCommonUI.Alert.UpdateDifferentFileNames"),l),buttons:[{className:"primary",value:y.get("E6WCommonUI.Label.Update"),action:function(e){e.hide(),i(a,t,n)}},{value:y.get("E6WCommonUI.Label.Cancel"),action:function(e){e.hide()}}]};new o({renderTo:document.body}).dialog(d)}else i(a,t)}},getFileNameWithoutExtension:function(e){var t=e.lastIndexOf(".");return-1!==t&&(e=e.substring(0,t)),e},widgetInPreviewMode:function(){return widget.id&&-1!==widget.id.indexOf("preview")&&!widget.getValue("addinmode")},showLoadingMessage:function(e,t){e&&!s.isMasked(e)&&s.mask(e,t||T)},hideLoadingMessage:function(e){e&&s.unmask(e)},dropdownMenuHasItems:function(e){if(e instanceof d||e.items){if(e.items){return e.items.filter(function(e){return!e.className||!e.className.contains("hidden")}).length>0}return!1}return!0},showAndUpdateContextualDropdownMenuPosition:function(e,t,i){try{e.options.contextual=!0,i&&!x.dropdownMenuHasItems(e)||e.show(),e.updatePosition(t),e.options.contextual=!1}catch(e){console.log("exception while udpating contextual menu")}},_alreadyHasObjectInRelatedData:function(t,i,n){var a=t.get(i)||[],o=a.detect||a.find;return o&&o.call(a,function(t){return!e.is(t,"string")&&(e.equals(t.id,n)||t.get("physicalId")===n||t.get("dsaccess:accountName")===n||"iam:"+t.get("dsaccess:accountName")===n||t.get("groupURI")&&t.get("groupURI")===n)},n)},setHeaderMetaTag:function(){var e=top.document.getElementsByName("viewport");e&&e.length&&e[0].setAttribute("content","user-scalable=0, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height")},disableBrowserDefaultPinchZoom:function(){t.Platform.ios&&document.documentElement.addEventListener("touchstart",function(e){e.touches.length>1&&(e.stopPropagation(),e.preventDefault())},{passive:!1})},isWedoTask:function(e){return"swym:WeDo"===e},isTask:function(e){return"dsplan:Task"===e||x.isWedoTask(e)||"Task"===e},isProject:function(e){return m.isProject(e)},isTemplate:function(e){return m.isTemplate(e)},isTaskAnyType:function(e){return x.isTask(e)||"Inbox Task"===e},isGate:function(e){return"Gate"===e},isMilestone:function(e){return"Milestone"===e},isPhaseTask:function(e){return"Phase"===e},getObjectDataFromDataTransfer:function(e){const t=x.getDataTransferJSON(e);return t?t.data.items.map(V):[]},dropdownMenuItemToWebuxMenuItem:function(t){const i={submenu:t.submenu,type:"PushItem",title:t.title||t.text,state:t.disabled?"disabled":"enabled",fonticon:e.is(t.fonticon,"object")?t.fonticon:{content:`wux-ui-3ds wux-ui-3ds-${t.fonticon}`}};return(t.handler||t.func)&&(i.action={callback:t.handler||t.func}),i}};function V(e){var t={},i=e.objectId;return"foaf:Group"!==e.objectType&&e.resourceUid&&(i=h.addUUIDToURI(e.resourceUid)),t.id=i,t.title=e.displayName,t.serviceId=e.serviceId,t.tenant=e.envId,t.image=e.image||e.displayPreview,t.type=e.objectType,t.i3dx=e.i3dx,"pno:Person"===e.objectType&&(t.accountName=u.splitUri(e.objectId)[1]),t}function W(e){var t={};x.enrichObjectFromSearch(e);var i=e.sourceId?e.sourceId.split(":")[1]:window.enoviaServer.tenant,n=e.id,a=e.objectType;return e.resourceUid&&!n.startsWith("mailto:")&&a&&"Group"!==a&&(n=h.preProcessPersonObject(e.resourceUid,e)),t.id=n,t.title=e.label||e["ds6w:label"],t.serviceId=e.serviceId||e.sourceId||"3DSpace",t.tenant=i,t.image=e.image||e.type_icon_url,t.type=e["ds6w:type_value"]||e["ds6w:type"],"pno:Person"===t.type&&(t.accountName=h.getAccountNameForUser(n,e.resourceUid)),t}let R,M,P;return x.getTenantErrorMessage=function(e,t){return y.replace(y.get("E6WCommonUI.Alert.FailedToAttachObjectWithDifferentTenant"),{TENANT1:e,TENANT2:t})},x.displayAlreadyAttachedErrorMessage=function(e,t,i){var n;n="Person"===t.get("type")||"pno:Person"===t.get("type")?y.replace(y.get("E6WCommonUI.Warning.AlreadyAssociated"),{TASK_NAME:e,ALREADY:t.get("name")}):"foaf:Group"===t.get("type")||"Group"===t.get("type")||"Group Proxy"===t.get("type")?y.replace(y.get("E6WCommonUI.Warning.GroupAlreadyAssociated"),{TASK_NAME:e,ALREADY:t.get("name")}):t.getObjectType()===E.LOGICAL_USER_TYPE?y.replace(y.get("E6WCommonUI.Warning.LogicalUserAlreadyAssociated"),{TASK_NAME:e,ALREADY:t.get("name")}):I.includes(t.get("type"))?y.replace(y.get("E6WCommonUI.Warning.ProcessAlreadyAttached"),{PARENT_NAME:e,EXISTING_CHILD_NAME:t.get("title")}):y.replace(y.get("E6WCommonUI.Warning.AlreadyAttached"),{PARENT_NAME:e,EXISTING_CHILD_NAME:t.get("title")}),x.displayError(n)},x.getObjectDataFromDropSearchOrTypeAhead=function(e){var t;return e.dropObj?t=V(e.dropObj):e.detailedObject&&(t=W(e.detailedObject)),t},x.normalizedToJson=function(t,i){return"function"==typeof t.dataForRendering?t.dataForRendering(i):"function"==typeof t.toJSON?t.toJSON(i):e.clone(t,!1)},x.copyTextToClipboard=function(e){var t=document.createElement("INPUT");t.setAttribute("type","text"),t.setAttribute("value",e),document.body.appendChild(t),t.select(),t.setSelectionRange(0,999999),document.execCommand("copy"),document.body.removeChild(t)},x.isLoggedInUser=function(e){return e&&e.toUpperCase()===window.enoviaServer.user.toUpperCase()},x.isModelOwnerTheLoggedInUser=function(e){var t=e.get("dskern:owner");return t&&x.isLoggedInUser(t.get("dsaccess:accountName"))},x.getNewRouteIndexFromManagmentView=function(e,t){var i=t.collection,n=i.indexOf(e);return n===i.size()-1&&(n-=1),n},x.getDaysStringForDate=function(e){let t="Days",i=0;return void 0!==e&&(i=u.xsdDayTimeDurationToMilliseconds(e)/(60*E.WORKING_HOURS_IN_A_DAY*60*1e3)),1===i&&(t="Day"),t},x.validateObjectTenant=function(){var e=widget.getValue("X3DContentId");if(e){var t=(e=JSON.parse(widget.getValue("X3DContentId"))).data.items[0],i=v.getTenant();if(t&&t.envId!==i){var n=y.get("E6WComonUI.Warning.TenantMismatch");x.displayWarning(y.replace(n,{TENANT:t.envId}),1e4)}}},x.translateType=function(e){return A[e]||e},x.isValidDate=function(e){return e instanceof Date&&!isNaN(e)},x.isFileNotFound=function(e){return!!(e&&e.errorMsg&&e.errorMsg.contains("404"))},x.fixDisplayMessageMethod=function(){x.displayMessage=x.workaroundDisplayMessage},x.assignToSelfButtonConfig=function(e){var t=e;return{id:"assignToSelfItem",iconClass:e?"fonticon-user-ok disabled":"fonticon-user-ok",callback:function(){t||this.model.assignToSelf(this.options)},toolTip:x.i18n("E6WCommonUI.Command.AssignToSelf")}},x.getDefaultImage=function(e){return x.isTask(e["dsxplan:jsType"])?require.toUrl("E6WCommonApps/assets/img/iconSmallTask.png"):m.getDefaultProjectImage(e["dsplan:projectType"],{isTemplate:e["dsplan:isTemplate"]})},x.loadJSDependency=function(e){return new n(function(t,i){require([e],function(e){t(e)},function(e){i(e)})})},x.sanitizeMessage=function(e){return U({message:e})},x.createTooltip=function(e,t,i){return new r({target:e,body:t||"",position:i||"bottom"})},Object.defineProperty(x,"DATE_FORMAT",{get:()=>(R||(R=new Intl.DateTimeFormat(v.getCurrentLanguage(),{weekday:"short",year:"numeric",month:"short",day:"numeric"})),R)}),Object.defineProperty(x,"DATE_LONG_FORMAT",{get:()=>(M||(M=new Intl.DateTimeFormat(v.getCurrentLanguage(),{weekday:"long",year:"numeric",month:"long",day:"numeric"})),M)}),Object.defineProperty(x,"TIME_FORMAT",{get:()=>(P||(P=new Intl.DateTimeFormat(v.getCurrentLanguage(),{hour:"numeric",minute:"numeric"})),P)}),x.IMAGE_MAX_WIDTH=160,x.IMAGE_MAX_HEIGHT=120,x.IMAGE_MAX_BYTE_SIZE=16300,x.LONG_MSG_DELAY=15e3,x.workaroundDisplayMessage=x.displayMessage,x.getObjectDataFromFedSearchOrTypeAheadData=W,x}),define("DS/E6WCommonUI/Views/E6WHandlebarsHelpers",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/WidgetUtils","DS/E6WCommonUI/UIHelper"],function(e,t,i,n){"use strict";var a={};if(!t.helpers.userPictureUrl){var o={registerHelper:function(e,i){t.registerHelper(e,i)}};o.registerHelper("userPictureUrl",function(e,t,i){return e?n.userPictureURL(e,void 0,{type:t,imageUrl:i}):""}),o.registerHelper("assetImageURL",function(e){return e?require.toUrl(e):""}),o.registerHelper("makeHTML5Date",function(e){return i.makeHTML5Date(e)}),o.registerHelper("i18n",function(e){return a.i18n(e)});t.registerHelper("eachLimit",function(e){return function(t,i,n){var a,o="",s=t?t.length:0,r=s>i&&i>0?i:s,l=n&&n.hash&&n.hash.startingIndex||0;if(n.data&&(a=e.createFrame(n.data)),"number"!=typeof s)o=n.fn(t);else{for(var d=0,c=r;d<c;d++)a&&(a.index=d,a.indexWithOffset=d+l),o+=n.fn(t[d],{data:a});r!==s&&(o+=n.inverse(this,{data:a}))}return o}}(t)),o.registerHelper("E6Wif",function(e,t,i){return e===t?i.fn(this):i.inverse(this)}),o.registerHelper("readOnlyValue",function(e){return isNaN(e)?e:e&&0!==parseInt(e)&&0!==parseFloat(e)?e:"--"}),o.registerHelper("ifEmpty",function(t,i){return t&&e.is(t,"array")&&t.length>0||t&&0!==parseInt(t)&&0!==parseFloat(t)?i.inverse(this):i.fn(this)}),t.registerHelper("isdefined",function(e){return void 0!==e}),o.registerHelper("concat",function(){var e="";for(var t in arguments)"object"!=typeof arguments[t]&&(e+=arguments[t]);return e})}return a}),define("DS/E6WCommonUI/MultiEditHelper",["UWA/Core","DS/E6WCommonUI/UIHelper","DS/Controls/Popup","DS/E6WCommonUI/E6WCommonUIConstants","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n,a){"use strict";var o=function(e){return a.get(e)},s={Draft:o("E6WCommonUI.Label.Draft"),"To Do":o("E6WCommonUI.Label.ToDo"),"In Work":o("E6WCommonUI.Label.InWork"),"In Approval":o("E6WCommonUI.Label.InApproval"),"On Hold":o("E6WCommonUI.Label.OnHold"),Completed:o("E6WCommonUI.Label.Completed"),Done:o("E6WCommonUI.Label.Done"),Create:o("E6WCommonUI.Label.Draft"),Assign:o("E6WCommonUI.Label.ToDo"),Active:o("E6WCommonUI.Label.InWork"),Review:o("E6WCommonUI.Label.InApproval"),Complete:o("E6WCommonUI.Label.Completed"),"dsxplan:Low":o("E6WCommonUI.Label.Low"),"dsxplan:Medium":o("E6WCommonUI.Label.Medium"),"dsxplan:High":o("E6WCommonUI.Label.High"),"dsxplan:Urgent":o("E6WCommonUI.Label.Urgent"),Low:o("E6WCommonUI.Label.Low"),Medium:o("E6WCommonUI.Label.Medium"),High:o("E6WCommonUI.Label.High"),Urgent:o("E6WCommonUI.Label.Urgent"),"dsxplan:Open":o("E6WCommonUI.Label.ToDo"),"dsxplan:InProgress":o("E6WCommonUI.Label.InWork"),"dsxplan:Done":o("E6WCommonUI.Label.Completed")};return{getUniqueAttrValues:function(t,i){let n=e.is(i.map,"function")&&i.map(e=>{if("number"===t.type||"range"===t.type)return void 0!==e[t.name]&&null!==e[t.name]||(e[t.name]=0),"range"===t.type?{label:e[t.name]+"%",value:e[t.name]}:e[t.name];if("uom"===t.type){let i=parseFloat(e[t.name])+" "+t.uomValues[e.estimatedDurationInputUnit||0],n=e[t.toleranceName];return n>0&&(i+=" "+t.toleranceLabel+" "+n),{label:i,value:e[t.name],offsetValue:n}}if(e[t.name]&&e[t.name].displayValue)return e[t.name];if(Array.isArray(e[t.name])){let i={};for(let n=0;n<e[t.name].length;n++){const a=e[t.name][n];t.attributeToDisplay&&(i[a[t.attributeToDisplay]]=a),a["@id"]&&(i[a["@id"]]=a),a.title&&(i[a.title]=a),a.displayValue&&(i[a.displayValue]=a)}return i}return Array.isArray(e[t.name])||"object"!=typeof e[t.name]?e[t.name]?s[e[t.name]]||e[t.name]:void 0!==e[t.name]&&null!==e[t.name]?e[t.name]:void 0:t.attributeToDisplay?{label:e[t.name][t.attributeToDisplay],value:e[t.name]}:e[t.name]["@id"]?{label:e[t.name].title||s[e[t.name]["@id"]],value:e[t.name]["@id"]}:e[t.name].displayValue?{label:e[t.name].displayValue,value:e[t.name].actualValue}:e[t.name].title?{label:e[t.name].title,value:e[t.name]}:e[t.name]});return"date"!==t.type&&"startStop"!==t.type||(n=n.filter((e,t,i)=>{if(e&&e.displayValue){let n="Invalid Date"===new Date(e.displayValue).toString()?e.displayValue:new Date(e.displayValue).toISOString();return e.actualValue="Invalid Date"!==new Date(e.actualValue).toString()?e.actualValue:n,t===i.findIndex(t=>t&&t.displayValue===e.displayValue)}if(e&&e.label)return e.value="Invalid Date"===!new Date(e.value).toString()?e.value:new Date(e.label).toISOString(),t===i.findIndex(t=>t&&t.label===e.label)})),Array.from(new Set(n.map(JSON.stringify))).map(JSON.parse)},getComboBoxOptions:function(e,n){let a={enableSearchFlag:!1,actionOnClickFlag:!1,popupSizeAdjustPolicy:i.SizeAdjustPolicyEnum.Crop,selectedIndex:0},r=[];for(let i=0;i<n.length;i++){let a=n[i];var l;if("object"==typeof a&&Object.keys(a).length>0)if(a.label)l={label:s[a.label]||a.label,value:a.value},"uom"===e.type&&a.offsetValue&&(l.value=[a.value,a.offsetValue]);else if("date"===e.type||"startStop"===e.type){var d=new Date(a.actualValue);"Invalid Date"===d.toString()&&(d=new Date(a.displayValue||a)),l={label:t.getIntLongDateFormat(a.value||a).displayValue,value:d}}else l=a.actualValue?{label:a.displayValue,value:a.actualValue}:{label:Object.keys(a)[0],value:a[Object.keys(a)[0]].actualValue||a[Object.keys(a)[0]]};else l={label:s[a]||a,value:a};r.push(l)}return r.length>0?a.elementsList=[{label:o("E6WCommonUI.Label.MutipleValues")}].concat(r):a.elementsList=null,a},isActualDateOfCompletedTask:function(e,t){return"Complete"===t.state&&(e.name===n.ACTUAL_START_ATTR||e.name===n.ACTUAL_FINISH_ATTR)}}}),define("DS/E6WCommonUI/FeatureFlagUtils",["DS/E6WCommonUI/PlatformManager"],function(e){"use strict";return{is3DViewerEnabled:function(){return e._is3DViewerPresent},userGroupsEnabled:function(){return window.widget&&window.widget.getValue("assignedToUserGroups")},referencedSimulationsEnabled:function(){return e.hasLoadedRolesData()&&e.hasSimulationRole()&&window.widget.getValue("referencedSimulations")},riskManagementEnabled:function(){return e.hasLoadedRolesData()&&e.hasRiskRole()}}}),define("DS/E6WCommonUI/Models/DropValidator",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/FeatureFlagUtils","DS/E6WCommonUI/E6WCommonUIConstants","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n,a,o,s){"use strict";var r={validateDroppedObject:function(e,i){var n=r._validateType(e,i);if(!n&&i.validateSameTenant&&(n=r.validateTenant(e)),!n){var a=i.searchSource;i.dropTypes&&(a=a?i.searchSource.concat(Object.keys(i.dropTypes)):Object.keys(i.dropTypes)),n=r._validateSource(t.sourceFromService(e.serviceId),a)}return n||"pno:Person"!==e.objectType||i.excludePendingUser&&0===e.objectId.indexOf("mailto:")&&(n=s.get("E6WComonUI.Error.CantAddPendingPersons")),n||"dsxplan:workscopeParentForMilestone"!==i.name&&"dsxplan:workscopeParentForGate"!==i.name||(n=s.get("E6WCommonUI.Alert.InvalidDataDropped")),n},validateTenant:function(e){var t;return e.envId!==n.getTenant()&&(t=i.getTenantErrorMessage(e.envId,n.getTenant())),t},_validateSource:function(e,t){var i;return-1===(t&&t.length>0?t.slice(0):["3dspace"]).indexOf(e)&&("3dplan"===e&&(e=s.get("E6WCommonUI.Label.ProjectPlanning")),i=s.replace(s.get("E6WCommonUI.Alert.FailedToAttachObjectBadSource"),{SOURCE:e})),i},_validateType:function(e,n){var a=!1,l=e.objectType,d=e.displayType,c=t.sourceFromService(e.serviceId);let u=n.searchSourceTypes&&n.searchSourceTypes[c];u&&(a=-1===u.indexOf(l));var h,m=n.searchSource&&n.searchSource.indexOf(c)>-1;if(u&&n.dropTypes&&n.dropTypes[c]?a=a&&m&&-1===n.dropTypes[c].indexOf(l):!m&&n.dropTypes&&n.dropTypes[c]&&(a=-1===n.dropTypes[c].indexOf(l)),n.searchTypes){var p=n.searchTypes.split(",");a=a||-1===p.indexOf(l)}if(!a&&n.excludeSearchTypes){var f=r._getExcludedSearchTypeArray(c,n);a=f.length&&-1!==f.indexOf(l)}return a||"URL"!==l&&"dsplan:url"!==l||(a=n.name===o.WORK_CONTEXT_ATTR&&!n.allowUrlLink),a&&(h=s.replace(s.get("E6WCommonUI.Alert.FailedToAttachObjectBadType"),{TYPE:d||i.translateType(l)})),h},_getExcludedSearchTypeArray:function(t,i){var n=i.excludeSearchTypes;return e.is(n,"object")?i.excludeSearchTypes[t]||[]:n.split(",")},PERSON_DROP_TYPES:{"3dspace":["Person"],swym:["pno:Person"]}};return r.RDF_ASSIGNEE_DROP_TYPES={swym:[o.PERSON_TYPE],"3dplan":["dsplan:LogicalUser"]},r.MEMBER_DROP_TYPES={swym:["pno:Person"],usersgroup:["foaf:Group"]},r}),define("DS/E6WCommonUI/LinkDialog",["UWA/Core","UWA/Utils","UWA/Class/Listener","UWA/Class/Model","DS/UIKIT/SuperModal","DS/RDFFoundation/Models/URLModel","DS/E6WCommonUI/E6WCommonUIConstants","DS/E6WCommonUI/UIHelper","DS/Controls/Toggle","DS/RDFFoundation/RDFUtils","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n,a,o,s,r,l,d,c){"use strict";var u=function(e){return c.get(e)};return a.extend({destroy:function(){this._detailsView&&this._detailsView.destroy(),delete this._detailsView,this._repeatCheckBox&&this._repeatCheckBox.destroy(),delete this._repeatCheckBox,this.modals.queue.forEach(e=>e.destroy()),this.modals.queue=[],this.modals.current&&this.modals.current.destroy(),this.modals.current=void 0,this._parent.apply(this,arguments)},init:function(t){this._parent.apply(this,arguments);var n=e.clone(t||{},!1);this._initialModel=n.urlModel;let a=n.urlModel,s=n.parentModel;this.fieldName=n.fieldName,this._listener=new i;var r=!1;a?(this.model=a,this.model.set("canEdit",!0)):(this.model=new o({canEdit:!0,parentNode:s.id}),r=!0);var l=this;require(["DS/E6WCommonUI/Views/DetailsDisplayView"],e=>{l.callback=n.callback,l._detailsView=new e({model:l.model}),l._detailsView.setConfig(this.getLinkConfig()),l.renderDialog(r,s),r&&l.addRepeatCheckbox(),l._detailsView.render(),l._setDisabledClassOnCreateButton(!0),l._listener.listenTo(l.model,"onChange:title",l.validate.bind(l)),l._listener.listenTo(l.model,"onChange:dsplan:linkURL",l.validate.bind(l))})},addRepeatCheckbox:function(){var t=e.createElement("div",{class:"primary repeat-check-box"});this._repeatCheckBox=new l({type:"checkbox",label:u("E6WCommonUI.Label.Repeat"),value:this._detailsView.model.repeatLink,checkFlag:this._detailsView.model.repeatLink||this.options&&this.options.noOfClicks>1});var i=this;this._repeatCheckBox.addEventListener("change",function(e){e.dsModel.checkFlag?i._detailsView.model.repeatLink=!0:i._detailsView.model.repeatLink=!1}),this._repeatCheckBox.elements.container.addClassName("primary"),this._repeatCheckBox.elements.container.addClassName("repeat-check-box"),this._repeatCheckBox.inject(t).inject(this.modals.current.elements.footer,"top")},validate:function(e,t,i){if(this._detailsView.isModelValid()){this._setDisabledClassOnCreateButton(!1);let t=/(^|\s)((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)/gi;if(e.get("dsplan:linkURL")){!(!e.get("dsplan:linkURL").contains(" ")&&e.get("dsplan:linkURL").match(t))&&this._setDisabledClassOnCreateButton(!0)}}else this._setDisabledClassOnCreateButton(!0)},_setDisabledClassOnCreateButton:function(e){var t=document.getElementsByClassName("modal")[0];t&&t.getElement(".btn-create").toggleClassName("disabled",e)},getLinkConfig:function(){var e=this;return[{readWrite:!0,name:"title",label:"Title",type:"text",maxLength:128,required:!0,removeCarriageReturns:!0,validate:!0,events:{onChange:function(){e._setDisabledClassOnCreateButton()}}},{label:"URL",name:"dsplan:linkURL",type:"textarea",readWrite:!0,required:!0,numberOfDisplayLines:2,numberOfEditableLines:2,maxLength:2048,removeCarriageReturns:!0,validate:!0}]},renderDialog:function(e,t){var i=this;this.dialog({body:this._detailsView,title:u(e?"E6WCommonUI.Label.NewLink":"E6WCommonUI.Label.EditLink"),buttons:[{className:"primary btn-create",value:u(e?"E6WCommonUI.Label.Create":"E6WCommonUI.Label.Save"),action:function(n){i.saveAction(e,t,n)}},{className:"default",value:u("E6WCommonUI.Label.Cancel"),action:function(e){i._initialModel&&i.model.rollbackChanges(i.model._changedAttributesSinceLastSave,[],i._initialModel._attributes),e.hide()}}]})},resetDialog:function(e){this.model=new o({canEdit:!0,parentNode:e.id}),this._detailsView.resetModel(this.model),this._listener.listenTo(this.model,"onChange:title",this.validate.bind(this)),this._listener.listenTo(this.model,"onChange:dsplan:linkURL",this.validate.bind(this)),this._detailsView.model.repeatLink=!0,this._setDisabledClassOnCreateButton(!0)},saveAction:function(i,n,a){let o=this.model;if(this._detailsView.isModelValid()){let m={};var l=m.onFailure;if(i){var u=d.getBatchGenerator();delete o.collection,o.set("@id","<uuid:"+t.getUUID()+">"),o.forcedNew=!0,delete o._skeletonId,o.save(void 0,{ajax:u.ajax,newTransaction:!0,onFailure:function(e,t){t&&401===t["@code"]?r.displayError(c.get("E6WCommonUI.Error.noAccessOnObject")):r.displayError(c.get("E6WCommonUI.Error.UrlLinkCreationFailed")),l&&l(arguments)}}),this.fieldName!==s.WORK_CONTEXT_ATTR||r.isProject(n.get("dsxplan:jsType"))?n.model&&n.model.addObjects&&n.model.addObjects([o],n.model.dslcMapping[this.fieldName],void 0,{silentOnChange:!0,at:0,values:[o]}):(n._checkUrlOfWorkContext(o),n.set(s.WORK_CONTEXT_ATTR,o)),m.changed=!0,m.ajax=u.ajax,m.newTransaction=!0;var h=this;m.onComplete=function(){h._detailsView.model.repeatLink?h.resetDialog(n):a.hide()},n.model&&n.model.save(void 0,m),delete(m=e.clone(m||{},!1)).ajax,delete m.onComplete,delete m.onFailure,u.sendBatch(m)}else o.set("parentNode",n.id)&&o.sync("update",o,m),a.hide()}}})}),define("DS/E6WCommonUI/URLUtils",["UWA/Core","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/SecurityContextUtils","DS/RDFFoundation/Models/ComponentProxyModel","DS/RDFFoundation/Models/URLModel","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/LinkDialog","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n,a,o,s,r,l){"use strict";var d=function(e){return l.get(e)};const c={createOrEditLink:function(t){let n=e.clone(t||{},!1),a=i.getDefaultSecurityContext(),d=n&&n.modelToBeEdited,c=n.fieldName,u=n.cloneModel,h=n.isRDF;if(h){new r({urlModel:d,parentModel:u,fieldName:c})}else u&&!u.model.urlRoot&&(u.model.urlRoot="/resources/v1/modeler/tasks"),s.loadJSDependency("DS/ENOProjectMgmtCommonComponents/components/CommonInitializer").then(e=>{let t={isComponent:!0,loadLinks:!0,fieldName:c,currentModel:h?void 0:u,securityContext:window.enoviaServer.space||a,callback:function(e){d||u.model.updateRelatedObjectWithNewEntry(e._attributes,c)},onFailure:function(){arguments&&arguments[1]&&arguments[1].error?s.displayError(arguments[1].error):s.displayError(l.get("E6WCommonUI.Error.UrlLinkCreationFailed"))}};d&&(d.set("canEdit",o.hasAccess("3DSpace")),t.model=d),new e(t)})},createURLForRDFObjects:function(i,n,o){let s=e.clone(o||{},!1),r=t.getObjectById(n.id);if(r){var l=new a({title:r.get("title")||r.get("name"),"dsplan:linkURL":r.get("dsplan:linkURL")||r.get("linkURL"),parentNode:i.id});s.onComplete=function(e){if(s.callback){let t=e&&e.id;s.urlModel=l,t&&s.callback(s)}},s.onFailure=function(){c.onFailureFunc(s)},l.save({},s)}},deleteUrlLinkFor3DPlan:function(i,n,a){let o=e.clone(a||{},!1);return t.request(t.expandUrl("/invoke/dsxplan:deleteURLObject"),{method:"POST",noStringify:!0,type:"json",data:JSON.stringify([{urlId:n.id,parentNode:i.id}]),onComplete:function(){o.callback&&o.callback({})},onFailure:function(){c.onFailureFunc(o)}})},onFailureFunc:function(t){let i=e.clone(t||{},!1);"add"===i.operation?s.displayError(d("E6WCommonUI.Error.UrlLinkCreationFailed")):s.displayError(d("E6WCommonUI.Error.UrlLinkDeletionFailed")),i.callback&&i.callback({onFailure:!0})},createOrDeleteURLForERTasks:function(n){let a=e.clone(n||{},!1),s=a.targetObj,r=a.model,l=a&&a.csrf;const d=o.getServiceUrl("3DSpace",!0)+"/resources/v1/modeler/tasks/"+r.get("id")+"?$include=none";let u={id:r.get("id"),type:r.get("type"),updateAction:"MODIFY",relateddata:{}};for(let e in s)s[e].forEach(t=>{u.relateddata[e]?u.relateddata[e].push(c.createERDataElements(t,e,a)):u.relateddata[e]=[c.createERDataElements(t,e,a)]});t.request(d,{method:"PUT",headers:{"Content-Type":"application/json",securityContext:i.getDefaultSecurityContext()},type:"json",data:JSON.stringify({csrf:l,data:[u]}),onComplete:function(e){let t=e&&e.data&&e.data[0]&&e.data[0].relateddata;if(t&&t[a.fieldName]&&t[a.fieldName][0]&&t[a.fieldName][0].id){let e=t&&t[a.fieldName]&&t[a.fieldName][0]&&t[a.fieldName][0].id;e&&a.callback(e)}else{if(t)for(let e in t)t[e].forEach(t=>{r.updateRelatedObjectWithNewEntry(t,e)});a.callback&&a.callback({})}},onFailure:function(){c.onFailureFunc(a)}})},createERDataElements:function(e,t,i){return"add"===i.operation?{type:e.get("type"),serviceId:"3DSpace",updateAction:"CREATE",dataelements:{title:e.get("name")||e.get("title"),linkURL:e.get("linkURL"),description:e.get("description")||" "}}:"remove"===i.operation?(i.model.removeObject(t,e),{serviceId:"3DSpace",updateAction:"DISCONNECT",id:e.id,type:"URL"}):void 0}};return c}),define("DS/E6WCommonUI/DragUtil",["DS/E6WCommonUI/UIHelper"],function(e){"use strict";var t={setDragModels:function(e){this._dragModels=e},getDragModels:function(){return this._dragModels},setDragTransferData:function(e,i){var n=JSON.stringify(i);event.dataTransfer.clearData(),event.dataTransfer.setData(t.getDragDataKey(),n),event.dataTransfer.setData("text",n)},getDragDataKey:function(){return e.isIE()||e.isEdge()?"text":"text/searchitems"},setDragView:function(e){this._view=e},getDragView:function(){return this._view}};return t}),define("DS/E6WCommonUI/Models/CloneModel",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","UWA/Class/Collection","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/URLUtils","DS/E6WCommonUI/E6WCommonUIConstants"],function(e,t,i,n,a,o,s,r){"use strict";function l(e,t){var i;if(t)for(var n=0;n<t.length;n++){var a=t[n];if(a.id===e){i=a;break}}return i}var d=t.extend(i,{init:function(e,t){this.config=t&&t.config||{imageAttribute:"image",attributeToDisplay:"title"},this.file=e},get:function(e){return"canEdit"!==e&&(e===this.config.imageAttribute&&this.file?this.file.FileName?"":window.URL.createObjectURL(this.file):e===this.config.attributeToDisplay&&this.file instanceof window.File?this.file.name:this.file.FileName)},toJSON:function(){var e={};return e[this.config.imageAttribute]=this.get(this.config.imageAttribute),e[this.config.attributeToDisplay]=this.get(this.config.attributeToDisplay),e.canEdit=this.get("canEdit"),e}}),c=t.extend(i,n,{_uwaClassName:"CloneModel",FileValue:d,i18n:function(e,t){return t||e},init:function(t,i){var n=e.clone(i||{},!1);n.i18n&&(this.i18n=i.i18n),this.model=t,e.is(this.model.addEvent,"function")&&this.listenTo(this.model,"onAnyEvent",function(e){if(0===e.indexOf("onChange")){var t=Array.prototype.slice.call(arguments,1);t[0]=this,this.dispatchEvent(e,t)}}),this.localAttributes={},this.localRelatedData={},this._options=n,this.childCloneModels=[],Object.defineProperty(this,"csrf",{get:function(){return this.model.csrf}}),Object.defineProperty(this,"id",{get:function(){return this.model.id}}),e.is(this.model.updateDocument,"function")&&(this.updateDocument=this.model.updateDocument.bind(this.model))},addChildCloneModel:function(e,t){const i=this;this.listenTo(e,"onChange",function(){i.modificationsPending=!0,i.localRelatedData[t]=i.localRelatedData[t]||[],i.localRelatedData[t].push({operation:"modify",input:e,value:e}),i.dispatchEvent("onChange:modificationsPending")}),this.childCloneModels.push(e)},removeChildCloneModel:function(e){this.stopListening(e,"onChange"),this.childCloneModels.splice(this.childCloneModels.indexOf(e),1)},createWhitelistMap:function(e){var t,i=e||{};if(i.attributes){t={};for(var n=i.attributes.length,a=0;a<n;a++){t[i.attributes[a]]=!0}}return t},_dataForRendering:function(){return e.is(this.dataForRendering,"function")?this.dataForRendering.apply(this,arguments):e.is(this.toJSON,"function")?this.toJSON():e.clone(this,!1)},toJSON:function(){var t=e.is(this.model.toJSON,"function")?this.model.toJSON.apply(this.model,arguments):e.clone(this.model,!1);return this._overlayAttributes(t),t},dataForRendering:function(){if(this.model){var e=this._dataForRendering.apply(this.model,arguments);return this._overlayAttributes(e),e}return{}},_overlayAttributes:function(t){for(var i=t,n=Object.keys(this.localRelatedData),a=n.length,o=0;o<a;o++){for(var s=n[o],r=this.get(s),l=r?r.length:0,d=[],c=0;c<l;c++){var u=r.at?r.at(c):r[c];d.push(this._dataForRendering.call(u))}i[s]=d}var h=Object.keys(this.localAttributes);a=h.length;for(var m=0;m<a;m++){var p=h[m],f=this.localAttributes[p];e.is(f,"object")&&(f=this._dataForRendering.call(f)),i[p]=f}return i},_hasModifiedProperty:function(e){return!(!this.localAttributes.hasOwnProperty(e)&&!this.localRelatedData.hasOwnProperty(e))},get:function(t){var i=this.localRelatedData[t],n=this.model?this.model.get(t):null;if(!i){var o=this.localAttributes[t];return void 0!==o?o:n}(n=n||[])instanceof a&&(n=n.toArray());for(var s=i.length,r=0;r<s;r++){var l,d=i[r];if("add"===d.operation)l=d.value,n&&n.unshift?n.unshift(l):n=[l];else if("remove"===d.operation)if(e.is(n.toArray,"function")&&(n=n.toArray()),!e.is(n,"string")&&e.is(n.indexOf,"function")){var c=n.indexOf(d.value);n.splice(c,1)}else n===d.value?n=void 0:e.is(n,"string")&&n===d.value.id&&(n=void 0)}return n},set:function(t,i,n){var a=e.clone(n||{},!1),o=i,s=a&&a.whisper;s&&delete a.silent;var r=a&&a.silent;this.localAttributes[t]=o;var l=this.modificationsPending;this.modificationsPending=!0,r||s||this.dispatchEvent("onChange",[this,n]),r||s||this.dispatchEvent("onChange:"+t,[this,i,n]),r||l===this.modificationsPending||this.dispatchEvent("onChange:modificationsPending",[this]),a&&a.validate&&this.validate&&(this.validationError=this.validate(this.toJSON(),a),!r&&this.validationError?this.dispatchEvent("onValidationFailure"):this.dispatchEvent("onValidationSuccess"))},add:function(i,n,a){var o;e.is(n,"array")||n instanceof window.FileList?o=n:n instanceof t?o=[n]:e.is(n.split,"function")&&(o=n.split(",").map(function(e){return e.trim()}));for(var s=o.length,r=[],d=!1,c=!1,u=e.clone(a||{},!1),h=0;h<s;h++){var m=o[h];u.detailedObject=l(m,u.detailedObjects);var p=this.addIndividualObject(i,m,void 0,u);p.ret&&r.push(p.ret),d=d||p.changed,c=c||p.changedModificationPending}return c&&this.dispatchEvent("onChange:modificationsPending",[this]),d&&(u.operation="add",u.added=r,this._fireRelationshipChangeEvents(i,u)),r},addIndividualObject:function(t,i,n,a){a=a||{};var s,r=this.localRelatedData[t];r||(r=this.localRelatedData[t]=[]);var l=!1,d=this.modificationsPending,c=a.DocumentManagement&&a.DocumentManagement.MSFDocumentClient;if(!e.is(i,"string")){if(c&&c.IsConnectedToMSFClient()||i instanceof window.File||i instanceof window.Blob){var u=i,h=new this.FileValue(u,a),m={operation:"add",input:u,value:h};return m.isThumbnail=a&&a.config&&a.config.isThumbnail,r.push(m),this.modificationsPending=!0,u&&(s=h),{ret:s,changed:!0,changedModificationPending:this.modificationsPending!==d}}return this.addIndividualObjectAsModel(t,i,{multiEdit:a.multiEdit})}var p=o._alreadyHasObjectInRelatedData(this,t,i);if(p)return a&&!a.multiEdit&&o.displayAlreadyAttachedErrorMessage(this.get("title"),p),{ret:s,changed:l,changedModificationPending:this.modificationsPending!==d};var f,g=n||this.getObjectToBeAdded(t,i,a);g&&e.is(this.model.addEvent,"function")&&e.is(this.model.removeEvent,"function")&&this.listenTo(g,"onDestroy",function(){var i=e.clone(a||{},!1);this._removeByValueFromLocalRelatedData(t,g)&&this._fireRelationshipChangeEvents(t,i),this.stopListening(g)});var v=r.length,E=void 0!==g;for(f=v-1;E&&f>=0;f--){var D=r[f];if(D.value.id===i)switch(E=!1,D.operation){case"remove":r.splice(f,1),l=!0}}return E&&(r.push({operation:"add",input:g.id,value:g}),this.modificationsPending=!0,l=!0),{ret:s=g,changed:l,changedModificationPending:this.modificationsPending!==d}},addIndividualObjectAsModel:function(e,t,i){this.localRelatedData[e]=this.localRelatedData[e]||[];var n=o._alreadyHasObjectInRelatedData(this,e,t.id);if(n&&!t.isNew())return i&&!i.multiEdit&&o.displayAlreadyAttachedErrorMessage(this.get("title"),n),{ret:void 0,changed:!1,changedModificationPending:!1};var a=this.modificationsPending;return this.localRelatedData[e].push({operation:"add",input:t,value:t}),this.modificationsPending=!0,{ret:t,changed:!0,changedModificationPending:this.modificationsPending!==a}},getObjectToBeAdded:function(t,i,n){var a,o,s,r;n&&n.dropObj&&n.dropObj.serviceId?(o=n.dropObj.serviceId,s=n.dropObj.envId):n&&n.detailedObject&&(o=n.detailedObject.serviceId),n&&n.dropObj&&"URL"===n.dropObj.objectType&&(r="$fields=description");let l="3DSpace"!==o;return a=e.is(this.model.collection.getRelatedObject,"function")&&this.model.collection.getRelatedObject(t,i,l,void 0,{attributes:{service:o,tenant:s},urlParam:r}),l&&"3DDrive"!==o&&(a.serviceId=o,a.fetch()),a},remove:function(t,i,n){var o=e.clone(n||{},!1);o.at=i;var s,r=this.get(t);e.is(r,"array")?s=r[i]:e.is(r.at,"function")&&(s=r.at(i)),s||e.is(r,"array")||r instanceof a||(s=r),s&&this._removeByValue(t,s,o)},removeAll:function(t,i){var n=e.clone(i||{},!1);let a=this.get(t)||[];var o=this.localRelatedData[t];o||(o=this.localRelatedData[t]=[]),a.forEach((e,t)=>{var n={operation:"remove",input:t,value:e};i&&i.config&&i.config.isThumbnail&&(n.isThumbnail=!0),o.push(n)}),n.operation="remove",n.removed=a,this.modificationsPending=!0,this.dispatchEvent("onChange:modificationsPending",[this]),this._fireRelationshipChangeEvents(t,n)},_removeByValue:function(t,i,n){var a=e.clone(n||{},!1),o=n.at||0,s=this.localAttributes[t];if(!s||this.model.get(t)){var r=this.localRelatedData[t];if(r||(r=this.localRelatedData[t]=[]),!this._removeByValueFromLocalRelatedData(t,i)){var l={operation:"remove",input:o,value:i};n&&n.config&&n.config.isThumbnail&&(l.isThumbnail=!0),r.push(l),this.modificationsPending=!0,this.dispatchEvent("onChange:modificationsPending",[this])}a.operation="remove",a.removed=i,this._fireRelationshipChangeEvents(t,a)}else{delete this.localAttributes[t],a.operation="remove",a.removed=s,this._fireRelationshipChangeEvents(t,a);var d=Object.keys(this.localAttributes),c=Object.keys(this.localRelatedData);0===d.length&&0===c.length&&(this.modificationsPending=!1,this.dispatchEvent("onChange:modificationsPending",[this]))}},_removeByValueFromLocalRelatedData:function(e,t){var i=this.localRelatedData[e],n=!1;if(i)for(var a=i.length-1;a>=0;a--){var o=i[a];if(o.value===t)switch(n=!0,o.operation){case"add":if(i.splice(a,1),0===i.length){delete this.localRelatedData[e];var s=Object.keys(this.localAttributes),r=Object.keys(this.localRelatedData);0===s.length&&0===r.length&&(this.modificationsPending=!1,this.dispatchEvent("onChange:modificationsPending",[this]))}}}return n},cancel:function(){var e=this.localAttributes,t=this.localRelatedData;if(this.localAttributes={},this.localRelatedData={},this.modificationsPending){this.modificationsPending=!1,this.dispatchEvent("onChange:modificationsPending",[this]),this.dispatchEvent("onChange",[this]);var i=Object.keys(e);i.push.apply(i,Object.keys(t));for(var n=i.length,a=0;a<n;a++)this.dispatchEvent("onChange:"+i[a])}},save:function(t){var i=e.clone(t||{});this.modificationsPending=!1,this.dispatchEvent("onChange:modificationsPending",[this]);var n=this._saveRelatedData(i)||i.changed,a=this.localAttributes;Object.keys(a).length?n=!0:a=null,this.localAttributes={},n&&this._modelSave(a,i)},_modelSave:function(t,i){var n=e.clone(i||{},!1);e.merge(n,this._options),this.model.save(t,n)},_saveRelatedData:function(t){var i=!1,n=this.localRelatedData,a=Object.keys(n);this.localRelatedData={};for(var o=a.length,s=0;s<o;s++){var r=a[s],l=n[r];if(l)for(var d=l.length,c=0;c<d;c++){var u=l[c];"add"===u.operation?u.input instanceof window.File||u.input.FileName?this.model._addFile(r,u,t):(e.is(this.model.addObjects,"function")&&this.model.addObjects([u.input],r,void 0,{silentOnChange:!0,at:0,values:[u.value]}),i=!0):"remove"===u.operation?u.isThumbnail?e.is(this.model.removeThumbnail,"function")&&this.model.removeThumbnail(r,u.value,{silentOnChange:!0}):(e.is(this.model.removeObject,"function")&&this.model.removeObject(r,u.value,{silentOnChange:!0}),i=!0):"modify"===u.operation&&(i=!0)}}return i},destroy:function(){this.stopListening(),delete this.model},isValid:function(e){return!this.validate||!this.validate(this.toJSON(),e)},_fireRelationshipChangeEvents:function(e,t,i,n){t&&t.silent||(n||(this.dispatchEvent("onChange:"+e,[this,t]),"add"===t.operation?this.dispatchEvent("onAdd:"+e,[this,t]):"remove"===t.operation&&this.dispatchEvent("onRemove:"+e,[this,t])),i||this.dispatchEvent("onChange",[this,t]))},isAttributeBeingRemoved:function(e){return this._hasModifiedProperty(e)&&!this.localAttributes[e]},_onURLUpdate:function(t){var i=e.clone(t||{},!1);(i.proxyModel||i.urlModel)&&(i.attribute!==r.WORK_CONTEXT_ATTR||o.isProject(this.model.get("dsxplan:jsType"))?this.addIndividualObjectAsModel(i.attribute,i.proxyModel||i.urlModel):(delete this.localAttributes[r.WORK_CONTEXT_ATTR],this.set(r.WORK_CONTEXT_ATTR,i.proxyModel||i.urlModel))),this.urlUpdated=!0,this.dispatchEvent("onUrlUpdate"),i.onFailure&&this.dispatchEvent("onUrlFailure")},_checkUrlOfWorkContext:function(e,t){let i=this.model.get(r.WORK_CONTEXT_ATTR);!e||e===i||"URL"!==e.get("type")&&"dsplan:url"!==e.get("dsxplan:jsType")||(!i||"URL"!==i.get("type")&&"dsplan:url"!==i.get("dsxplan:jsType")||s.deleteUrlLinkFor3DPlan(this.model,e,{}),t&&(t[r.WORK_CONTEXT_ATTR]=[e]))},_addToModelArray:function(e,t,i){e[t]?e[t].push(i):e[t]=[i]},_isUrlAttached:function(e){var t=this;let i=!1;if(this.urlUpdated)return i;let n=t.model.isRDF,a={},o={};for(let s in e.localRelatedData)e.localRelatedData&&Object.keys(e.localRelatedData).length>0&&e.localRelatedData[s].forEach((e,r)=>{let l=e.value&&e.value.get("type")||e.value&&e.value.get("dsxplan:jsType");"URL"!==l&&"dsplan:url"!==l||(i=!0,"add"===e.operation?(t._addToModelArray(a,s,e.value),t.localRelatedData[s][r]={}):"remove"===e.operation&&(t._addToModelArray(o,s,e.value),n||(t.localRelatedData[s][r]={})))});if(n){let e={};e.callback=this._onURLUpdate.bind(this);for(const t in a)if(Object.hasOwnProperty.call(a,t)){const i=a[t];e.attribute=t;for(let t=0;t<i.length;t++){const n=i[t];s.createURLForRDFObjects(this.model,n,e)}}for(const t in o)if(Object.hasOwnProperty.call(o,t)){const i=o[t];e.attribute=t;for(let t=0;t<i.length;t++){const n=i[t];s.deleteUrlLinkFor3DPlan(this.model,n,e)}}}else Object.keys(a).length>0&&t.checkAndSetCSRF({targetObj:a,model:t.model,operation:"add",callback:t._onURLUpdate.bind(this)},s.createOrDeleteURLForERTasks),Object.keys(o).length>0&&t.checkAndSetCSRF({targetObj:o,model:t.model,operation:"remove",callback:t._onURLUpdate.bind(this)},s.createOrDeleteURLForERTasks);return i}});return c.FileValue=d,c}),define("DS/E6WCommonUI/SvgUtils",["UWA/Core","DS/E6WCommonUI/UnitBezier"],function(e,t){"use strict";return{createSVGElement:function(t,i){var n=e.extendElement(document.createElementNS("http://www.w3.org/2000/svg",t));return i&&n.setAttributes(i),this.convertToAnimatableSVG(n),Object.defineProperty(n,"offsetHeight",{get:function(){try{return this.getBBox?this.getBBox().height:0}catch(e){return 0}}}),Object.defineProperty(n,"offsetWidth",{get:function(){try{return this.getBBox?this.getBBox().width:0}catch(e){return 0}}}),n},convertToAnimatableSVG:function(i){return i.animationFrameTimestamps={},i.setAttribute=function(e){var t=this.animationFrameTimestamps[e];t&&(window.cancelAnimationFrame(t),delete this.animationFrameTimestamps[e]),this.__proto__.setAttribute.apply(this,arguments)}.bind(i),i.animateAttribute=function(n,a,o){var s,r=null,l=i.getAttribute(n),d=0,c=this,u=function(e){delete c.animationFrameTimestamps[n],r||(r=e);var t=e-r;if(t<o){var i=parseFloat(l+d*s.solve(t/o));c.setAttribute(n,i),c.animationFrameTimestamps[n]=window.requestAnimationFrame(u)}else c.setAttribute(n,a)};["x","y","width","x2","cx"].indexOf(n)>-1?(l=l?parseFloat(l):0,o=o||"0.5s",s=new t({easeOut:(d=a-l)<0}),c.animationFrameTimestamps[n]=window.requestAnimationFrame(u)):(e.log("Animate not defined for attribute "+n+". Just setting it."),i.setAttribute(n,a))}.bind(i),-1!==this.displayPosition}}}),define("DS/E6WCommonUI/Views/FoundationBaseView",["UWA/Core","UWA/Element","UWA/Event","UWA/Class/View","DS/E6WCommonUI/SvgUtils"],function(e,t,i,n,a){"use strict";var o=new WeakMap,s=t.prototype.constructor.hasClassName;t.prototype.constructor.hasClassName=function(e){if(this instanceof SVGElement){var t=this.className.baseVal;return t&&t.contains(e," ")}return s.apply(this,arguments)};var r=t.prototype.constructor.addClassName;t.prototype.constructor.addClassName=function(e){return this instanceof SVGElement?(this.hasClassName(e)||this.setAttribute("class",this.getAttribute("class")+" "+e),this):r.apply(this,arguments)};var l=t.prototype.constructor.removeClassName;t.prototype.constructor.removeClassName=function(e){if(this instanceof SVGElement){var t=this.getAttribute("class")||"";return this.setAttribute("class",t.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)"),"$1").trim()),this}return l.apply(this,arguments)};var d=n.extend({tagName:"div",id:function(){var e;return this.collection?e=this.collection.extid:this.model&&(e=this.model.id),e},_startOfSetup:Function.prototype,_endOfdestroy:Function.prototype,setup:function(e){return this._startOfSetup(),o.set(this.container,this),this._parentView=e?e.parentView:void 0,e},init:function(t){var i=t&&t.tagName||this.tagName,n=t&&t.className||this.className,a=t&&t.id||this.id;if(!t||!t.container){var o=/^svg:(.*)/.exec(i);if(o){this.model=t&&t.model,this.collection=t&&t.collection;var s=t&&t.attributes||this.attributes||{};n&&(n=e.is(n,"function")?n.call(this):n,s.class=n),this.container=this.createSVGElement(o[1],s),a&&(e.is(a,"function")&&(a=a.call(this)),this.container.id=a)}}return this._parent.apply(this,arguments)},addChildView:function(e){return this._childrenViews?this._childrenViews.push(e):this._childrenViews=[e],e._parentView||(e._parentView=this),e},cleanUpChildren:function(){var t=this;this._childrenViews&&(e.clone(this._childrenViews,!1).forEach(function(i){t.stopListening(i),i._parentView===t?e.is(i.destroy,"function")&&i.destroy():console.log("parentView of childView is inconsistent, check for bugs")}),delete this._childrenViews)},removeChildView:function(e){if(this._childrenViews){var t=this._childrenViews.indexOf(e);if(-1!==t)return this._childrenViews.splice(t,1),e._parentView===this&&delete e._parentView,!0}return!1},destroy:function(){this.isDestroyed?console.log("FoundationBaseView: View destroyed twice. Check for bug."):(this.dispatchEvent("onDestroy"),this.cleanUpChildren(),this.stopListening(),this.collection=null,this.model=null,this._parentView&&this._parentView.removeChildView(this),this._parent(),this.container&&e.is(this.container,"empty")&&this.container.empty(!0),this.container=null,this._parentView=null,this.isDestroyed=!0,this._endOfdestroy())},setDefaultImages:function(e){for(var t=(e||this.container).getElements("img"),i=t.length,n=function(){this.removeEvent("error"),this.src=""},a=0;a<i;a++){t[a].addEvent("error",n)}},createSVGElement:function(e,t){return a.createSVGElement(e,t)},escapeCssId:function(e){return e.replace(/[:=? ~!@$%^&*()+,./';"><[\]{}|`#]/g,"\\$&")}});return d.getViewFromContainer=function(e){return e&&o.get(e)},d}),define("DS/E6WCommonUI/Views/DetailsDisplaySharedView",["UWA/Core","DS/Controls/TooltipModel","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/E6WHandlebarsHelpers","DS/E6WCommonUI/UIHelper","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","text!DS/E6WCommonUI/assets/templates/labelWithTooltip.html.handlebars","text!DS/E6WCommonUI/assets/templates/attachURL.html.handlebars"],function(e,t,i,n,a,o,s,r,l){"use strict";i.registerPartial("labelWithTooltip",r),i.registerPartial("attachURL",l);var d=n.extend({_uwaClassName:"E6WCommonUIDetailsDisplaySharedView",tagName:"div",className:"details-display-shared-view ddv-field form-group ",name:"E6WCommonUI.DetailsDisplaySharedView",id:function(){return this._config.type+"Property_"+this.cid},canReadWrite:function(){return"true"===this._config.readWrite||"boolean"==typeof this._config.readWrite&&this._config.readWrite},init:function(t){var i=e.clone(t||{},!1);this._config=i.config,this._parent.apply(this,arguments),this.setConfiguredTemplate()},setConfig:function(e){this._config=e,this.setConfiguredTemplate()},setup:function(t){var i=e.clone(t||{},!1);this._options=i;var n=i.i18n;n&&(this.i18n=n),this.tenant=i.tenant,this.model&&this._config&&this.addModelEvents(),this._setContainerAttributes(),this._parent.apply(this,arguments)},setConfiguredTemplate:function(){if(this.compiledTemplate){var e=a.i18n;a.i18n=s.get.bind(s);var t=this._config;t.viewId="_"+this.cid;var n=this.compiledTemplate(t);t.template=i.compile(n),a.i18n=e}},template:function(e){var t=e.data,i=a.i18n;a.i18n=s.get.bind(s);var n=this._config.template(t);return a.i18n=i,n},_setContainerAttributes:function(){var e=this._config;e.className&&this.container.toggleClassName(e.className,!0),e.W&&this.container.toggleClassName("sixdub "+e.W,!0),this.container.setAttribute("data-field-type",e.type),this.container.setAttribute("data-field-name",e.name),this.container.setAttribute("data-field-index",e.index)},enableRefreshView:()=>!0,addModelEvents:function(){var e=this._config;this.model&&this.model.addEvent&&(this.listenTo(this.model,"onChange:"+e.name,function(e,t,i){i&&i.detailsDisplayViewDebounce||!this.enableRefreshView()||this.refreshView(t)}),e.endDateAttribute&&this.listenTo(this.model,"onChange:"+e.endDateAttribute,function(){this.render()}),this.listenTo(this.model,"onValidationFailure",this._highlightValidationErrors),this.listenTo(this.model,"onValidationSuccess",this._clearValidationErrors))},refreshView:function(){this.render()},resetModel:function(e){e!==this.model&&(this.model&&this.stopListening(this.model),this.model=e,this.addModelEvents(),this._highlightValidationErrors())},_highlightValidationErrors:function(){if(this._clearValidationErrors(),this.model&&this.model.validationError&&this.model.validationError.fields){var e=this._config,t=!1,i=this.getContainerElement(),n=e.name;if(-1!==this.model.validationError.fields.indexOf(n)){t=!0;var a=this.model.validationError.messages&&this.model.validationError.messages[n];a&&this._displayValidationError(a)}i&&i.toggleClassName("has-error",t)}},_displayValidationError:function(t){this._errorSpanNode||(this._errorSpanNode=e.createElement("span",{class:"text-error"})),this._errorSpanNode.inject(this.getContainerElement()),this._errorSpanNode.setText(t)},getContainerElement:function(){return this.container},_clearValidationErrors:function(){var e=this.getContainerElement();this._errorSpanNode&&this._errorSpanNode.remove(),e&&e.toggleClassName("has-error",!1)},normalizedSet:function(t,i,n){var a,o=t.validationError,s=e.clone(i||{},!1);return s.detailsDisplayViewDebounce=!0,e.is(t.set,"function")?(s.whisper=!0,a=t.set(i.name,n,s)):a=t[i.name]=n,o&&!t.validationError&&e.is(t.dispatchEvent,"function")&&t.dispatchEvent("onValidationSuccess"),a},normalizedGet:function(t,i){return t&&i?e.is(t.get,"function")?t.get(i):t[i]:""},render:function(t){if(!this.model)return this;var i=e.clone(t||{},!1).data;i=this._getData(i),this.undelegateDOMEvents();var n=this._config.readWrite;return n||(n=!1),this.container.toggleClassName("editable",Boolean(n&&i.canEdit)),this.container.setHTML(this.template({data:i})),this.delegateDOMEvents(),this._highlightValidationErrors(),this._addTooltip(),this},_addTooltip:function(){if(this._config.tooltipTitle){const e=this.getTooltipElement();e&&(e.tooltipInfos=new t({title:this._config.tooltipTitle,shortHelp:this._config.tooltipBody}))}},getTooltipElement:function(){return this.getElement(".field-label .field-label-actions .fonticon-info")},getDataOptions:function(){return this._config.accPointsName?{attributes:[this._config.name,this._config.accPointsName,"canEdit"],level:0}:{attributes:[this._config.name,"canEdit"],level:0}},_getData:function(e){var t=e;if(!e&&this.model){var i=this.getDataOptions();t=o.normalizedToJson(this.model,i)}return t}});return d.events={menuOpened:"menuOpened"},d}),define("DS/E6WCommonUI/Views/ObjectView",["UWA/Core","UWA/Class/Collection","DS/Handlebars/Handlebars4","UWA/Controls/Drag","UWA/Class/Promise","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/E6WCommonUI/Search","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/DragUtil","DS/E6WCommonUI/Views/CustomizedAutocomplete","DS/E6WCommonUI/Models/DropValidator","DS/E6WCommonUI/URLUtils","DS/RDFFoundation/FederatedSearchUtil","DS/RDFFoundation/RDFUtils","DS/RDFFoundation/Models/ComponentProxyModel","text!DS/E6WCommonUI/assets/templates/object.html.handlebars","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n,a,o,s,r,l,d,c,u,h,m,p,f,g){"use strict";var v=i.compile(f);r.isIE()||r.isEdge();function E(e){e.preventDefault()}var D=o.extend({_uwaClassName:"E6WCommonUIObjectView",tagName:"div",name:"E6WCommonUI.ObjectView",domEvents:{"dragenter .drop-target":"handleDragEnter","dragover .drop-target":"handleDragOver","dragleave .drop-target":"handleDragLeave","drop .drop-target":"handleDrop","dragend .drop-target":"handleDragEnd","click .object-list a":"objectClick","click ul":"_activateObjectField","click button.ds-group-plus":"_activateObjectField","click button.ds-group-upload":"_uploadToObjectList","click button.ds-group-link-url":"_attachUrlToObject","click button.clear-all":"_clearAll","click .custom-button":"_onClickCustomButton",'keypress .ds-group-add input[type="text"]':"_keyUpInputAddObject",'input .ds-group-add input[type="text"]':"_enableDisableSearch","click label":"_preventLabelDefault","click input":"_onInputClicked","keyup input":"_onKeyUp"},i18n:function(e,t){return t||e},_clearAll:function(){this.model.removeAllValues(this._config.name)},getDataOptions:function(){var e=this._parent.apply(this,arguments);e.level=1;var t=e.attributes.indexOf("canEdit");return e.attributes.splice(t,1,"physicalId",this._config.attributeToDisplay,this._config.imageAttribute,"busType","type","hasfiles"),e},_getData:function(){var e=this._parent.apply(this,arguments);return e.hasOwnProperty("canEdit")||(e.canEdit=this.normalizedGet(this.model,"canEdit")),e},setup:function(e){this._parentContainerId=e.detailDisplayViewId,this._parent.apply(this,arguments);this.canReadWrite()&&(this.search=this._config.search||new s("",!1,"furtive")),this.context=e&&e.context,this._createAutocomplete()},_getMinLengthBeforeSearch:function(){var e=this._config.minLengthBeforeAutocomplete;return void 0===e&&(e=2),e},_createAutocomplete:function(){let e={disabled:!0,cid:this.cid,placeholder:this._config.placeHolder||"",minLengthBeforeSearch:this._getMinLengthBeforeSearch(),noResultsMessage:g.get("emxFoundation.Label.NoResultsFound"),datasets:[{configuration:{templateEngine:this._addAutoCompleteItemToContainer.bind(this),remoteSearchEngine:this._getAndSendAutoCompleteRequest.bind(this)}}],infoMessageCallback:this._config.infoMessageCallback};this._config.noResultsMessageCallback&&(e.noResultsMessageCallback=this._config.noResultsMessageCallback),this.autoCompleteControl=new d(e),this.autoCompleteControl.elements.input.addClassName("form-control")},_preventLabelDefault:function(e){return e.preventDefault(),!1},render:function(t){var i=e.clone(t||{},!1);this.removeAutoCompleteFromDOM(),this.autoCompleteControl.setBoundingElement(i.boundingElement);var n=this._parent.apply(this,arguments);return this._postTreatmentObjectList(),this._listenToSubModels(),this.setDefaultImages(),this.autoCompleteControl.enable(),n},_submodelCallback:function(){this.render()},_listenToSubModels:function(){this.stopListening(null,null,this._submodelCallback);var t=this.normalizedGet(this.model,this._config.name);e.is(t,"array")||(t=t?[t]:[]);for(var i=t.length,n=0;n<i;n++){var a=t[n];a&&a.addEvent&&(this.listenTo(a,"onChange",this._submodelCallback),this.listenTo(a,"onModelAccessChanged",this._submodelCallback))}},checkDialogDeactivation:function(t,i){if(t!==i){if(this){var n=this.container.getElement("ul");n&&(n.toggleClassName("active",!1),e.is(t.activationCallback,"function")&&t.activationCallback(t.name,!1))}}},_uploadToObjectList:function(){var e=this,t=this._config;r.openFileExplorer({callback:function(i){t.customAdd?t.customAdd.call(e,void 0,e._options,i):e.model&&e.model.model&&e.model.model.uploadFiles?e.model.model.uploadFiles(i,t.name,{config:t,cloneModel:e.model}):e._addToModel(i)},accept:t.accept})},_attachUrlToObject:function(e){let t={fieldName:this._config.name,isRDF:this.model&&this.model.model&&this.model.model.isRDF,cloneModel:this.model,computeDragDataFromModel:this.computeDragDataFromModel,modelToBeEdited:e&&e.model};u.createOrEditLink(t)},_addToModel:function(t,i){var n=e.clone(i||this._options||{},!1),a=this._config,o=this.normalizedGet(this.model,a.name);if(a.singleObjectOnly&&o&&e.is(o,"array")&&o.length>0&&e.is(this.model.remove,"function")){var s=n.singleObjectRemove;n.singleObjectRemove=!0,this.model.remove(a.name,0,n),n.singleObjectRemove=s}return a.customAdd?a.customAdd.call(this,t,n):this.modelAdd(a.name,t,n)},_onClickCustomButton:function(t){t.preventDefault&&t.preventDefault();var i=e.Event.getElement(t),n=this._config,a=i.getAttribute("data-custom-button-index");a=parseInt(a);var o=n.customButtons;o&&o[a].callback.call(this,o)},handleDragEnter:function(t){e.Event.getElement(t).addClassName("drag-over")},handleDragLeave:function(t){e.Event.getElement(t).removeClassName("drag-over")},handleDragOver:function(t){return t.preventDefault&&t.preventDefault(),t.dataTransfer.dropEffect="copy",e.Event.getElement(t).addClassName("drag-over"),!1},handleDrop:function(t){this.getElement(".object-list")&&this.getElement(".object-list").removeClassName("drag-over"),t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault();var i=this.getElement("input");i&&(i.value="",i.removeClassName("drag-over"),this.autoCompleteControl.reset());var n=this._config,a=e.clone(this._options||{},!1);if((a.config=n,a.objectView=this,n.dropHandler)&&(e.is(n.dropHandler,"function")?n.dropHandler:this.model.dropHandler).call(this.model,t.dataTransfer,n,a))return!1;return t.dataTransfer.files&&t.dataTransfer.files.length?this._handleDroppedFiles(t.dataTransfer.files):!this.validateDroppedObjects(t.dataTransfer)&&this.dropHandler(t.dataTransfer,n,a)},dropHandler:function(e){var t=r.getDataTransferJSON(e);return t&&this.processDropData(t),!1},_handleDroppedFiles:function(e){var t=this._config;if(t.allowFileManagement&&this.canReadWrite()&&this.normalizedGet(this.model,"canEdit")){if(t.accept){for(var i=t.accept.toLowerCase().split(","),n=e.length,a=[],o=0;o<n;o++){var s=e[o],r=s.name,l=r.lastIndexOf(".");if(-1!==l){var d=r.substring(l);-1!==i.indexOf(d.toLowerCase())&&a.push(s)}}if(e=a,!a.length)return!1}return this.model&&this.model.model&&this.model.model.uploadFiles?this.model.model.uploadFiles(e,t.name,{config:t,cloneModel:this.model}):this._addToModel(e),!1}if(!t.allowFileManagement){var c=g.get("E6WCommonUI.Error.DroppingFilesNotSupported");c&&this._displayErrorMessage(c)}return!0},_displayErrorMessage:function(e){this._parentView&&this._parentView._displayMessage?e&&this._parentView._displayMessage({msg:e,msgType:"error"}):r.displayError(e)},validateDroppedObjects:function(e){for(var t,i=r.getDataTransferJSON(e).data.items,n=0;n<i.length&&!t;n++){var a=i[n];(t=this.validateDroppedObject(a))&&t&&this._displayErrorMessage(t)}return Boolean(t)},validateDroppedObject:function(e){return c.validateDroppedObject(e,this._config)},processDropData:function(t){for(var i=t.data.items,n=i.length,a=this._config,o=!1,s=0;s<n;s++){var r=i[s],l=r.displayName;e.is(this.model.preprocessPersonObject,"function")&&this.model.preprocessPersonObject(r);var d=e.clone(this._options||{},!1);d.config=a,d.dropObj=r;var c=this._addToModel(r.objectId,d);if(c&&c.length>0){o=!0;var u,h=c[0];u="person"===a.type?"firstname":this._config.attributeToDisplay,this.normalizedGet(h,u)||this.normalizedSet(h,{name:u},l)}}o&&this.render()},getDataIdFromObjectClick:function(e){return e.getClosest("li").getAttribute("data-id")},objectClick:function(i,n){var a=e.clone(n||{},!1),o=e.Event.getElement(i),s=this._config;i.stopPropagation&&i.stopPropagation(),i.preventDefault&&i.preventDefault(),i.clickedOnObject=!0;var l,d,c=this.getDataIdFromObjectClick(o),u=h.filterSearchSources(s.searchSource),m=this.normalizedGet(this.model,s.name);if(e.is(m,"array")||m instanceof t||(m=[m]),m&&m.length>0)for(var p=m.length,f=0;f<p;f++){var v=m.at?m.at(f):m[f],E=r.normalizedToJson(v,{attributes:["physicalId"]});if(e.is(E,"array"))for(var D=E.length,_=0;_<D;_++)if(E[_].physicalId===c||E[_].id===c){E=E[_];break}if(E.physicalId===c||E.id===c){l=v,d=v.find&&v.find(function(e){return e.get("resourceid")&&e.get("resourceid")===c||e.id===c});break}}if(a.model=d||l,!s.linkCallback||!s.linkCallback.call(this,c,a)){var w=g.get("emxFoundation.Label.ObjectDetails");a={title:w=w.replace("%NAME%",o.getText()),source:u,tenant:void 0,role:this.context,idcard_activated:!0,select_result_max_idcard:!0,default_search_criteria:"physicalid:"+c,fieldConfig:this._config},this.search&&this.search.activate(a)}return!0},_onKeyUp:function(e){"Tab"===e.key&&this._activateObjectField(e)},_activateObjectField:function(t){t.preventDefault&&t.preventDefault();var i=this.dropdownMenu&&this.dropdownMenu.isVisible;if(!t.clickedOnObject&&!i){var n=this._config,a=this.getElement("ul");if(this.canReadWrite()&&this.normalizedGet(this.model,"canEdit")&&a){a.toggleClassName("active",!0),e.is(n.activationCallback,"function")&&n.activationCallback(n.name,!0);var o=a.getElement("input");o&&o.focus()}}},handleDragEnd:function(t){e.Event.getElement(t).removeClassName("drag-over")},_postTreatmentObjectList:function(e){if(e||(e=this._config),e.typeAheadCallback&&this.canReadWrite()&&this._postTreatmentObjectListAutocomplete(e),this.postTreatmentObjectListClickHandlers(e),"object"===e.type||"person"===e.type){var t=this.getElement(".ds-group-add .btn");t&&(t.disabled=this.shouldDisableSearch())}},getSearchOptions:function(){var t=this._config,i=this.getElement("input"),n=i.value.trim().split(",").map(function(e){return e.trim()});n=this.getFederatedQueryCriteria(n,t);var a=this.getFederatedQueryPreCondition(t),o=h.filterSearchSources(t.searchSource),s=o&&t.searchSourceTypes||t.searchTypes;if(e.is(s,"object")&&o){var r={};o.forEach(function(e){r[e]=s[e]}),s=r}var l=t.excludeSearchTypes;s||(s="person"===t.type?"Person":"");var d=t.searchTitle;return d||(d=""),i.value="",this._toggleSearchButton(i),{title:d,source:o,role:this.context,types:s,multiSel:!0!==t.singleObjectOnly,default_search_criteria:n,precond:a,excludedSearchTypes:l,callback:this._searchCallback.bind(this),additionalQuery:this._config.additionalQuery,fieldConfig:this._config}},_onSearchButtonClick:function(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.doSearch(),this.autoCompleteControl.reset()},doSearch:function(){this.search&&this.search.activate(this.getSearchOptions())},getFederatedQueryCriteria:function(e,t){var i={criteria:e,fieldConfig:t};return h.getFederatedQueryCriteria(i)},getFederatedQueryPreCondition:function(e){var t;return e&&"person"===e.type&&e.userRole&&e.searchSource&&-1!==e.searchSource.indexOf("3dspace")&&(t='userrole:"'+e.userRole+'"'),t},postTreatmentObjectListClickHandlers:function(t){var i,n=this;if(e.is(this.model.add,"function")){var a=this.getElement("button.ds-search");a&&a.addEvent("click",this._onSearchButtonClick.bind(this))}if(e.is(this.model.remove,"function"))for(var o=function(i,a){a.stopPropagation();var o=e.clone(n._options||{},!1);o.config=t;var s=this.getAttribute("data-field-name");n.model.remove(s,i,o)},s=this.getElements(".ds-group-remove"),l=s.length,d=0;d<l;d++){var c=s[d];i=c.getClosest("button"),r.createTooltip(i,r.i18n("E6WCommonUI.Label.ClearField")),i.addEvent("click",o.bind(c,d))}for(var u=this.getElements(".fonticon-download"),h=u.length,m=0;m<h;m++){var p=u[m];(i=p.getClosest("button")).addEvent("click",this.objectClickDownload.bind(this)),this._donwloadAddedCode(p)}this._makeDraggableAndDroppable()},_donwloadAddedCode:Function.prototype,_makeDraggableAndDroppable:function(){var e=this.container.getElements('[draggable="true"]');r.isIpad()||r.isAndroid()||this._makeDraggableAndDroppableUWA();for(var t=0;t<e.length;t++){var i=e[t];i&&i.addEvent("dragstart",this._dragHandler.bind(this,i.getParent()))}},_dragHandler:function(e,t){var i=this.computeDragDataFromElement(e);t.dataTransfer.effectAllowed="copy",r.drag21compliant(i),l.setDragTransferData(t,i),r.extraDragForSwym(i)},getDataIdFromElement:function(e){return e.getClosest("li").getAttribute("data-id")},getModelFromCard:function(e){var t=this.getDataIdFromElement(e),i=this,n=this.normalizedGet(this.model,this._config.name),a=n;return n.forEach&&n.forEach(function(e){i._normalizedGetPhysicalId(e)!==t&&i.normalizedGet(e,"groupURI")!==t||(a=e)}),a},_normalizedGetPhysicalId:function(e){var t=this.normalizedGet(e,"physicalId");return t||(t=r.normalizedToJson(e).physicalId),t},computeDragDataFromModel:function(e){var t,i=this.model&&this.model.model;if(e.getTransferObject){var n={};i&&(n.parentObject=i),t=e.getTransferObject(n)}else{var a=this.normalizedGet(e,"type")||this.normalizedGet(e,"busType");t=r.getTransferObject({source:window.widget.getValue("appId")||"X3DCSMA_AP",envId:this.tenant||window.widget.getValue("x3dPlatformId"),contextId:this.context,objectId:this._normalizedGetPhysicalId(e),objectType:a,objectType_Internal:a,displayName:this.normalizedGet(e,this._config.attributeToDisplay)})}return t},computeDragDataFromElement:function(e){var t=this.getModelFromCard(e);return this.computeDragDataFromModel(t)},_iPadScrollIssueFix:function(e){r.isIpad()&&(e?document.body.addEventListener("touchmove",E,{passive:!1}):document.body.removeEventListener("touchmove",E))},_makeDraggableAndDroppableUWA:function(){this.dragControl&&this.dragControl.destroy();var t=this;this.dragControl=new n.Move({container:widget.body,root:this.container,zoneCss:".drop-target",zones:function(){return widget.body.getElements(this.options.zoneCss)},delegate:".draggable-item *",centerHandles:!0,handles:function(i){var n=i.target.getParent(".draggable-item");i.elemToClone=n;var a=e.Element.extend(n.cloneNode(!0));a.setStyle("width",n.offsetWidth),a.setStyle("height",n.offsetHeight);for(var o=a.getElements("button"),s=0;s<o.length;s++)o[s].remove();var r=e.createElement("ul",{class:"object-list"});a.inject(r);var l=e.createElement("div",{styles:{position:"absolute",zIndex:100}});l.toggleClassName("draggable-helper",!0),r.inject(l);var d=t._config.appendTo?t._config.appendTo:"body",c=n.getClosest(d);return l.inject(c),l},start:function(e){if(e.currentEvent instanceof MouseEvent)return!1;var i=e.target.getParent(".draggable-item");i.toggleClassName("ui-being-dragged",!0);var n=t.computeDragDataFromElement(i);return i.setData(D.DRAG_DATA_TAG,n),t._iPadScrollIssueFix(!0),!0},stop:function(e){var i=e.elemToClone;i.toggleClassName("ui-being-dragged",!1),i.toggleClassName("drag",!1),e.handles.destroy(),t._iPadScrollIssueFix()},enter:function(e){var t=e.zone;e.accept()&&(t.toggleClassName("drag-over",!0),t.dispatchEvent(e.getCustomEvent("dragenter")))},leave:function(e){e.zone.toggleClassName("drag-over",!1)},drop:function(e){var t=e.zone;t.toggleClassName("drag-over",!1),e.accept()&&t.dispatchEvent(e.getCustomEvent("drop"))}}),this.dragControl.accept=function(){return this.target.getClosest(this.options.zoneCss)!==this.zone},this.dragControl.getCustomEvent=function(e){var t=this.target.getParent(".draggable-item").getData(D.DRAG_DATA_TAG);t.getData=function(){return this};var i=new window.Event(e,{bubbles:!0});return i.dataTransfer=t,i}},objectClickDownload:function(t,i){var n=e.Event.getElement(t);t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.clickedOnObject=!0;var a=this.getDataIdFromElement(n);return this.download({pid:a,tenant:i&&this.normalizedGet(i,"dscom:Tenant"),serviceId:i&&this.normalizedGet(i,"dscom:ServiceHosting")}),!0},download:function(t){var i;t=t||{};var n=this,a=e.clone(t,!1);return a.autoDownload=!0,a.csrf=this.model.csrf,a.onFailure=function(e){var i=g.get("E6WCommonUI.Error.DownloadFailed");r.isFileNotFound(e)&&(i=g.get("E6WCommonUI.Info.itemNotFound")),n._parentView._displayMessage({msg:i,msgType:"error"}),t.onFailure&&t.onFailure()},this._options.DocumentManagement&&(i=this._options.DocumentManagement.downloadDocument(a.pid,void 0,Boolean(t.checkout),a)),i},processAutoCompleteData:function(e){return e},_addAutoCompleteItemToContainer:function(t,i,n){var a=this.processAutoCompleteData(n),o=e.createElement("span",{class:"thumbnail profile-image"});a.image&&e.createElement("img",{draggable:"false",src:a.image,title:a.label,"data-actualvalue":a.value,events:{contextmenu:function(){return!1}}}).inject(o),o.inject(t),e.createElement("span",{text:a.label}).inject(t)},_getExistingIds:function(){var e={},t=this.getExistingObjs(this._config.name);return t&&(Array.isArray(t)||(t=[t]),t.forEach(function(t){e[t.id]=!0})),e},_getAndSendAutoCompleteRequest:function(t,i){var n=this;return new a(function(a){var o=D.filter.bind(void 0,function(i){var o={};o.dataset=t;var s=[];e.is(i,"array")&&i.forEach(function(e){e.handler=n.onAutocompleteSelect.bind(n,n._config,e),s.push(e)}),o.matchingItems=s,a(o)},n._getExistingIds());n._previousTypeaheadRequest&&n._previousTypeaheadRequest.cancel&&n._previousTypeaheadRequest.cancel(),n._previousTypeaheadRequest=n._config.typeAheadCallback(n._config,i,o,{model:n.model})})},removeAutoCompleteFromDOM:function(){this.autoCompleteControl&&this.autoCompleteControl.remove()},_postTreatmentObjectListAutocomplete:function(){if(this.normalizedGet(this.model,"canEdit")&&this.canReadWrite()&&this.getElement("li.chooser")){var e=this.getElement("input");e&&e.remove(),this.autoCompleteControl.inject(this.getElement("li.chooser"),"top")}},_searchCallback:function(t,i){for(var n=[],a=t.length,o=!1,s=i&&i.fromAutoComplete,l=0;l<a;l++){var d=t[l];if(!s&&"object"==typeof d){var u=e.clone(d,!1);if(r.enrichObjectFromSearch(u),o=c._validateType(u,this._config))continue}d.id?(r.enrichObjectFromSearch(d),n.push(d.id)):n.push(d)}o&&r.displayError(g.get("E6WCommonUI.Alert.FailedToAddBadObjectType"));var h=n.join(","),m=e.clone(this._options||{},!1);if(m.detailedObjects=t,m.config=this._config,this._config.singleObjectOnly&&t&&t.length>0&&h.length>0)return h=n[0],m.detailedObjects=[t[0]],void this._addToModel(h,m);h.length>0&&this.modelAdd(this._config.name,h,m)},modelAdd:function(t,i,n){return this._config.customAdd?this._config.customAdd.call(this,i,n):e.is(this.model.add,"function")?this.model.add.apply(this.model,arguments):void 0},destroy:function(){this.search&&this.search.destroy(),delete this.search,this.autoCompleteControl.disable(),document.removeEventListener("click",this.autoCompleteControl.events.document.click,!0),this.autoCompleteControl.destroy(),delete this.autoCompleteControl,this._parent()},_keyUpInputAddObject:function(t){if("Enter"===t.key){var i=e.Event.getElement(t).getClosest(".form-group").getElement(".ds-group-add .btn");i.disabled||i.click()}},_enableDisableSearch:function(t){var i=e.Event.getElement(t);this._toggleSearchButton(i)},_toggleSearchButton:function(){var e=this.getElement(".ds-group-add .btn");e&&(e.disabled=this.shouldDisableSearch())},onAutocompleteSelect:function(t,i){var n=e.clone(i,!1);n.id=i.value||i.id,delete n.value,this._searchCallback([n],{fromAutoComplete:!0}),this.autoCompleteControl&&this.autoCompleteControl.reset()},getExistingObjs:function(e){return this.normalizedGet(this.model,e)},showAutoComplete:function(){var e=this.getElement("input");this.autoCompleteControl&&this.autoCompleteControl.getSuggestions(e.value)},_onInputClicked:function(){this.getElement("input").value.length>=this._getMinLengthBeforeSearch()&&this.showAutoComplete()},shouldDisableSearch:function(){var e=this.getElement("input")?this.getElement("input").value:"";if(e&&e.length>0)return!1;if(this._config.searchSourceTypes){const e=Object.keys(this._config.searchSourceTypes);return this._config.searchSource&&this._config.searchSource.find(t=>!e.includes(t))}return!this._config.searchTypes},getCardById:function(e){return this.container.getElement('li[data-id="'+e+'"]')}});return D.filter=function(e,t,i){e(i.filter(function(e){return!t[e.value]}))},D.prototype.compiledTemplate=v,D.DRAG_DATA_TAG="dragDataTransfer",D.DROP_CLASS_NAME="drag-over",D}),define("DS/E6WCommonUI/Views/TextAreaView",["UWA/Core","DS/Handlebars/Handlebars4","DS/UIKIT/Tooltip","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/E6WCommonUI/E6WCommonUIConstants","text!DS/E6WCommonUI/assets/templates/textarea.html.handlebars"],function(e,t,i,n,a,o,s){"use strict";var r=0,l=t.compile(s),d=a.extend({_uwaClassName:"E6WCommonUITextAreaView",tagName:"div",name:"E6WCommonUI.TextAreaView",domEvents:{"click .show-more":"_textAreaShowMore","click .show-less":"_textAreaShowLess","input textarea.content ":"_inputDataEntry"},addModelEvents:function(){this._parent.apply(this,arguments),this.model.addEvent&&this.listenTo(this.model,"onChange:"+this._config.name,this._postTreatmentTextArea)},setup:function(){this._tooltips=[],this._parent.apply(this,arguments)},render:function(){var e=this;this.removeEventListener();var t=this._parent.apply(this,arguments);this.addEventListener(),this.container.toggleClassName("hide-links",!0);var n=this.getElements(".tag-content");return n&&n.forEach(function(t){e._tooltips.push(new i({target:t,body:t.getText()}))}),t},refreshView:function(){this._parent.apply(this,arguments),this._postTreatmentTextArea()},destroy:function(){this.removeEventListener(),this._tooltips.forEach(function(e){e.destroy()}),this._tooltips=[],this._parent.apply(this,arguments)},addEventListener:function(){var e=this.container.getElement("textarea,input");e&&(e.addEventListener("focus",this._textAreaShowMore.bind(this)),this._config.required&&(this._blurListener=this._onBlurInputDataEntry.bind(this),e.addEventListener("blur",this._blurListener)))},removeEventListener:function(){if(this.container){var e=this.container.getElement("textarea,input");e&&e.removeEventListener("blur",this._blurListener)}},_getInputValue:function(){var e,t=(e=this.canReadWrite()&&this.normalizedGet(this.model,"canEdit")?this.getElement(".content"):this.getElement(".read-only")).value;return this._config.removeCarriageReturns&&(t=t.replace(/\n/g," "),e.value=t),t},_inputDataEntry:function(){this.normalizedSet(this.model,this._config,this._getInputValue()),this._postTreatmentTextArea(this._config)},_onBlurInputDataEntry:function(){var e=this._getInputValue().trim();e!==this.normalizedGet(this.model,this._config.name)&&this.normalizedSet(this.model,this._config,e),!(this.model.validationError&&this.model.validationError.fields)&&this._config.required&&this.container.toggleClassName("has-error",!e||0===e.length)},_textAreaShowMore:function(){this.container.toggleClassName("showing-more",!0)},_textAreaShowLess:function(t){e.Event.getElement(t).getClosest(".form-group").toggleClassName("showing-more",!1),this._postTreatmentTextArea()},_postTreatmentTextArea:function(){var e,t=this._config;"text"===t.type&&(e=!0);var i=this.getContentElement();if(i){var n=this.getElement("style");if(n){var a="",o="",s="";try{r||(r=this.getLineHeight()),e&&(i.style.transition="none",i.style.height=r+"px"),this._viewAllHeight=this.getViewAllHeight();var l=this.getDesiredHeight();"textarea"!==t.type&&"RichText"!==t.type||(this._viewAllHeight<=l&&(this._viewAllHeight=l),this.container.toggleClassName("hide-links",isNaN(this._viewAllHeight)||isNaN(l)||this._viewAllHeight<=l)),a=this.getRegularStyle(),o=this.getFocusStyle(),s=this.getShowingMoreStyle(),n.setHTML(a+o+s)}finally{e&&(i.style.height="",window.requestAnimationFrame(function(){i.style.transition=""}))}}}},getContentElement:function(){return this.getElement(".content")},getHeightCalculatorElement:function(){return this.getElement(".height-calculator")},getSelectorBase:function(){return"#"+this._config.type+"Property_"+this.cid},getSelector:function(){return this.getSelectorBase()+" .content"},getSelectorFocus:function(){return this.getSelector()+":focus"},getLineHeight:function(){var e=this.getContentElement();return parseInt(e.getStyle("lineHeight"),10)},getDesiredHeight:function(){return this._config.numberOfDisplayLines*r},getFocusDesiredHeight:function(){return this._config.numberOfEditableLines*r},getShowingMoreStyle:function(){return"#"+this._config.type+"Property_"+this.cid+".showing-more .content"+this.getViewAllTextStyle()},getViewAllTextStyle:function(){return"{\n height:"+this._viewAllHeight+"px;\n line-height:"+r+"px;}"},getRegularStyle:function(){var e="",t=this.getSelector();if("text"===this._config.type)e=t+this.getViewAllTextStyle();else{var i=this.getDesiredHeight();isNaN(i)||(e=t+" { \n height:"+i+"px;\n line-height:"+r+"px; \n}\n")}return e},getFocusStyle:function(){var e="",t=this.getSelectorFocus(),i=this.getFocusDesiredHeight();return isNaN(i)||(e=t+" { \n height:"+i+"px;\r }\n"),e},getViewAllHeight:function(){var e,t=this.getContentElement(),i=this.getHeightCalculatorElement(),n=r;return i&&(e="SPAN"===t.tagName?t.textContent:(e=this.getTextValue()).htmlDecode().replace(/&nbsp;/g," ").replace(/(<([^>]+)>)/gi,""),i.textContent=e,i.style.lineHeight!==r+"px"&&(i.style.lineHeight=r+"px"),n=i.scrollHeight),n},getTextValue:function(){return this.getContentElement().value}});return d.prototype.compiledTemplate=l,d}),define("DS/E6WCommonUI/Views/DateView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/FoundationBaseView","DS/UIKIT/Input/Date","DS/ENO6WPlugins/jQuery_3.3.1","DS/E6WCommonUI/Views/DetailsDisplaySharedView","text!DS/E6WCommonUI/assets/templates/date.html.handlebars"],function(e,t,i,n,a,o,s){"use strict";var r=t.compile(s),l=!1,d=o.extend({_uwaClassName:"E6WCommonUIDateView",tagName:"div",name:"E6WCommonUI.DateView",domEvents:{'change input.data-entry[type="date"]':"_dateDataEntry","keyup input.input-date":"_dateDataEntry"},render:function(){var e=this._parent.apply(this,arguments);return this._setupUIKITDatePickers(),e},_setupUIKITDatePickers:function(){for(var e=this.getElements("input[type=date]"),t=e.length,i=this._dateDataEntry.bind(this),n=0;n<t;n++){var a=e[n],o=this._getInputDate(a,i);o.getContent().addEventListener("change",i),this._completeCurInput(a,o)}},_getInputDate:function(t,i){var a=this._config,o=a.name,s=t.getParent(),r="";"startStop"===a.type&&a.endDateAttribute&&s.hasClassName("stop")&&(o=a.endDateAttribute,r=".stop"),"startStop"===a.type&&s.hasClassName("start")&&(r=".start");var l=this.normalizedGet(this.model,o);l&&l.actualValue&&(l=l.actualValue);var d={events:{onChange:i},allowTextEdition:void 0===a.allowTextEdition||a.allowTextEdition,renderTo:this.container.getElement(".input-group"+r)};a.min instanceof Date&&(d.min=new Date(a.min.getTime())),a.max instanceof Date&&(d.max=new Date(a.max.getTime())),e.is(l,"string")&&l?d.value=new Date(parseInt(l,10)):l instanceof Date?d.value=isNaN(l)?"":l:e.is(l,"number")&&l&&(d.value=new Date(parseInt(l,10))),this._childrenViews||(this._childrenViews=[]);let c=navigator.language,u=new Intl.Locale(c),h=u.getWeekInfo?u.getWeekInfo():u.weekInfo;if(h){let e=h.firstDay;d.firstDay=e}return new n(d)},_completeCurInput:function(e,t){var i=e.getParent(),n=this;this.addChildView(t),a.data(i,"dateInput",t),e.remove(),t.inject(i),t.elements.picker.addEvent("onShow",function(){var e=this.options.renderTo.offsetLeft,t=this.options.renderTo.offsetWidth,i=this.options.renderTo.getBoundingClientRect(),a=i.top+i.height,o=n.container.offsetWidth,s=n.container.offsetHeight,r=this.elements.container.offsetWidth,l=this.elements.container.offsetHeight,d=e,c=a;(e?t+e:e)+r>o&&(d=t-r),a+l+s>window.innerHeight&&(c=this.options.field.offsetTop-l,this.elements.container.setStyle("top",c+"px")),this.elements.container.setStyle("left",d+"px")})},_dateDataEntry:function(t){if(t.ctrlKey||17===t.keyCode)l=!0;else if(l&&67===t.keyCode)l=!1;else{var i=e.Event.getElement(t),n=this._config;if(n){var a;if(t.firedBy)a=t.firedBy.getDate()?t.firedBy.getDate().getTime():"";else if(a=i.value,""!==i.value){var o=new Date(i.value);a=new Date(o.getTime()+6e4*o.getTimezoneOffset()).getTime()}var s=n.name;"startStop"===n.type&&n.endDateAttribute&&i.getParent().hasClassName("stop")&&(s=n.endDateAttribute);var r=e.clone(this._config,!1);r.name=s;var d=isNaN(a)?"":{actualValue:a};this.normalizedSet(this.model,r,d)}}}});return d.prototype.compiledTemplate=r,d}),define("DS/E6WCommonUI/Views/NumberView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","text!DS/E6WCommonUI/assets/templates/number.html.handlebars","DS/E6WCommonUI/NumberUtils"],function(e,t,i,n,a,o){"use strict";var s=t.compile(a),r=n.extend({_uwaClassName:"E6WCommonUINumberView",tagName:"div",name:"E6WCommonUI.NumberView",domEvents:{'input input.data-entry[type="number-as-text"]':"_numberDataEntry"},render:function(){var e=this._parent.apply(this,arguments);return this._postTreatmentNumber(),e},_numberDataEntry:function(t){var i=e.Event.getElement(t),n=this._config,a=o.digitsToASCII(i.value),s=new RegExp("^-?[0-9]*[,.]?[0-9]*$");n&&n.integerOnly&&(s=new RegExp("^[0-9]*$"));var r=n.name;n.toleranceName&&i.getClosest(".field-group").hasClassName("tolerance")&&(r=n.toleranceName);var l=this.normalizedGet(this.model,r),d=s.test(a);if(-1!==a.indexOf(",")&&(a=a.replace(/,/g,".")),d&&!isNaN(a))if(a||!(n.allowEmpty||void 0===n.allowEmpty&&!1===n.required)){var c=parseFloat(a,10),u=parseFloat(n.minimumValue,10),h=parseFloat(n.maximumValue,10);!isNaN(u)&&!isNaN(c)&&c<u&&(c=l,i.value=c),!isNaN(h)&&!isNaN(c)&&c>h&&(c=l,i.value=c);var m=!1;a||"dsxplan:reminderDays"!==r?a=this._getActualValueBasedOnNumValue(c):(a=void 0,m=!0),(m||this.isValidInput(a))&&this.normalizedSet(this.model,{name:r,validate:n.validate},a)}else this.normalizedSet(this.model,{name:r,validate:n.validate},void 0);else i.value=isNaN(l)?"":l},isValidInput:function(e){return!isNaN(e)},_getActualValueBasedOnNumValue:function(e){return String(e)},_postTreatmentNumber:function(){var e,t=this._config,i=this.getElement("input"),n=this.normalizedGet(this.model,t.name);null!=(n=null===n?0:n)&&i&&(e=n.actualValue||0===n.actualValue?n.actualValue:n,e=(e=t.integerOnly?parseInt(e):parseFloat(e)).toLocaleString(widget.lang,{useGrouping:!1,maximumFractionDigits:this._config.maximumFractionDigits}),i.value=e)}});return r.prototype.compiledTemplate=s,r}),define("DS/E6WCommonUI/Views/CheckBoxView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","text!DS/E6WCommonUI/assets/templates/checkbox.html.handlebars"],function(e,t,i,n,a){"use strict";var o=t.compile(a),s=n.extend({_uwaClassName:"E6WCommonUICheckBoxView",tagName:"div",name:"E6WCommonUI.CheckBoxView",domEvents:{'change input.data-entry[type="checkbox"]':"_checkBoxDataEntry"},_checkBoxDataEntry:function(){var e=this._config,t=String(this.getElement("input").checked).toUpperCase();this.normalizedSet(this.model,e,t)}});return s.prototype.compiledTemplate=o,s}),define("DS/E6WCommonUI/Views/MultiDetailsDisplaySharedView",["UWA/Core","DS/UIKIT/Tooltip","UWA/Element","DS/Handlebars/Handlebars4","DS/Controls/Button","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/E6WCommonUI/Views/E6WHandlebarsHelpers","DS/E6WCommonUI/MultiEditHelper","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","text!DS/E6WCommonUI/assets/templates/multiEditField.html.handlebars"],function(e,t,i,n,a,o,s,r,l,d){"use strict";var c=n.compile(d),u=function(e){return l.get(e)},h=o.extend({_uwaClassName:"MultiDetailsDisplaySharedView",tagName:"div",name:"E6WCommonUI.MultiDetailsDisplaySharedView",className:"details-display-shared-view ddv-field form-group ",id:function(){return"MultiDetailsDisplaySharedView_"+this.cid},setup:function(e){this._renderToggleButtons=e.renderToggleButtons,this._parent.apply(this,arguments)},setupAddNewView:function(){throw new Error("In MultiDetailsDisplaySharedView setupAddNewView, this should be implemented in subclass.")},setupChooseExistingView:function(){throw new Error("In MultiDetailsDisplaySharedView setupChooseExistingView, this should be implemented in subclass.")},render:function(t){if(!this.model)return this;var i=e.clone(t||{},!1).data||[];this.undelegateDOMEvents(),this.delegateDOMEvents();let n=i.every(e=>e.canEdit||r.isActualDateOfCompletedTask(this._config,e));var a=this._config.readWrite;a||(a=!1),this.container.setHTML(this.template({data:i,canEdit:n}));let o=a&&n;this.container.toggleClassName("editable",o);let s=r.getUniqueAttrValues(this._config,i);return o&&(this._inputElement=this.getElement(".input-group:not(.multi-object,.multi-object-edit-button)"),this._setupViews(s),this._select&&this._switchToChooseExistingMode()),this},_getInputValue:function(){var e=this.getElement("input.data-entry"),t=e.value;return this._config.removeCarriageReturns&&(t=t.replace(/\n/g," "),e.value=t),t},setValueOnCloneModel:function(e){this.normalizedSet(this.model,this._config,e)},template:function(e){var t=e.data,i=s.i18n;s.i18n=l.get.bind(l);let n=r.getUniqueAttrValues(this._config,t),a="",o=[];if(1===n.length)"object"==typeof(a=n[0])&&(a.label&&(a=a.label),a.displayValue&&(a=a.displayValue)),o.push(a);else if(0===n.length)a="--";else{for(let e=0;e<n.length;e++){let t=n[e];"object"==typeof t&&(t.label&&(t=t.label),t.displayValue&&(t=t.displayValue)),o.push(t)}a=u("E6WCommonUI.Label.MutipleValues")}var d={values:a,labels:o?o.join(", "):"",canEdit:e.canEdit},c=this._config.template(d);return s.i18n=i,c},resetModel:function(e){this.model&&e.hasSameModels(this.model)||(this.model&&this.stopListening(this.model),this.model=e,this.addModelEvents(),this._highlightValidationErrors())},_setupViews:function(e){let t=e.length>1;t&&this._renderToggleButtons&&this._setupToggleButtons(),this.setupAddNewView(e),t&&this.setupChooseExistingView(e),this.listenTo(this._parentView,"onScroll",()=>{this.dispatchEvent("onScroll")})},_switchToChooseExistingMode:function(){this._addNewButton&&this._addNewButton.elements.container.removeClassName("hide"),this._chooseExistingButton&&this._chooseExistingButton.elements.container.addClassName("hide"),this.hideAddNewView(),this.showChooseExistingView()},_switchToAddNewMode:function(){this._addNewButton&&this._addNewButton.elements.container.addClassName("hide"),this._chooseExistingButton&&this._chooseExistingButton.elements.container.removeClassName("hide"),this.hideChooseExistingView(),this.showAddNewView()},_setupToggleButtons:function(){var e=this;this._addNewButton=new a({name:"addNewValue",icon:"plus",attributes:{title:u("E6WCommonUI.Label.AddNewValue")}}),this._addnewTooltip=new t({target:this._addNewButton.elements.button,body:u("E6WCommonUI.Label.AddNewValue")}),this._chooseExistingButton=new a({name:"chooseExistingValue",icon:"close",attributes:{title:u("E6WCommonUI.Label.ChooseExistingValue")}}),this._chooseExistingTooltip=new t({target:this._chooseExistingButton.elements.button,body:u("E6WCommonUI.Label.ChooseExistingValue")}),this._addNewButton.addEventListener("buttonclick",function(){e._switchToAddNewMode()}),this._addNewButton.inject(this.container.getElement(".multi-object-edit-button")),this._chooseExistingButton.addEventListener("buttonclick",function(){e._switchToChooseExistingMode()}),this._chooseExistingButton.inject(this.container.getElement(".multi-object-edit-button"))},destroy:function(){this._addNewButton&&this._addNewButton.destroy(),delete this._addNewButton,this._chooseExistingButton&&this._chooseExistingButton.destroy(),delete this._chooseExistingButton,this._parent()}});return h.prototype.compiledTemplate=c,h.i18n=u,h}),define("DS/E6WCommonUI/Views/RangeView",["UWA/Core","DS/Handlebars/Handlebars4","DS/Controls/Gauge","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","text!DS/E6WCommonUI/assets/templates/range.html.handlebars"],function(e,t,i,n,a,o){"use strict";var s=t.compile(o),r=a.extend({_uwaClassName:"E6WCommonUIRangeView",tagName:"div",name:"E6WCommonUI.RangeView",domEvents:{},render:function(){var e=this._parent.apply(this,arguments);return this._postTreatmentRange(),e},_rangeDataEntry:function(){if(!this.parent.dontUpdateModel){var e=this.parent._config,t=this.getValue();this.parent.normalizedSet(this.parent.model,e,t)}},destroy:function(){this._parent.apply(this,arguments),delete this._gauge},_postTreatmentRange:function(){var e,t,n=this._config,a=this.normalizedGet(this.model,n.name),o="[data-field-name='"+n.name+"'] .range";e=this.getElement(o);var s={minValue:n.minimumValue||0,maxValue:n.maximumValue||100,stepValue:n.step||.1,dynamicGraduations:!1,graduationsLabel:!1,dynamicGaugeColor:!1,graduations:2,value:a};n.percents&&(s.displayFunction=this._percentDisplay);var r=(t=new i(s)).destroy;t.destroy=function(){delete this.elements.scales,delete this.elements.cursors,this._parentView&&this._parentView.removeChildView(this),r.apply(this,arguments)},t.parent=this,this.listenTo(t,"change",this._rangeDataEntry),this.addChildView(t),this._gauge&&this._gauge.destroy(),this._gauge=t,Object.defineProperty(n,"control",{value:t,enumerable:!1,configurable:!0,writable:!0}),t.inject(e),this.canReadWrite()&&this.normalizedGet(this.model,"canEdit")||t.disable()},_percentDisplay:function(e){return e.toString()+"%"}});return r.prototype.compiledTemplate=s,r}),define("DS/E6WCommonUI/Views/TextView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/TextAreaView","text!DS/E6WCommonUI/assets/templates/text.html.handlebars"],function(e,t,i,n,a){"use strict";var o=t.compile(a),s=n.extend({_uwaClassName:"E6WCommonUITextView",tagName:"div",name:"E6WCommonUI.TextView",domEvents:{'input input.data-entry[type="text"]':"_inputDataEntry"}});return s.prototype.compiledTemplate=o,s}),define("DS/E6WCommonUI/Views/UomView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/NumberView","DS/Controls/ComboBox","text!DS/E6WCommonUI/assets/templates/uom.html.handlebars"],function(e,t,i,n,a,o){"use strict";var s=t.compile(o),r=n.extend({_uwaClassName:"E6WCommonUIUomView",tagName:"div",name:"E6WCommonUI.UomView",domEvents:{"change select.ddv-uom":"_uomDataEntry"},render:function(){var e=this._parent.apply(this,arguments),t=[];if(this._selectElement=this.getElement("select.ddv-uom"),this._selectElement&&widget&&widget.useUIKitSelect){if(this._config&&this._config.uomValues&&this._config.uomValues.length)for(var i,n=0;n<this._config.uomValues.length;n++)i=this._config.uomValues[n],t.push({valueItem:i,labelItem:i});this._select=new a({className:"ddv-uom",enableSearchFlag:!1,actionOnClickFlag:!1,elementsList:t}),this._select.inject(this._selectElement.parentElement),this._selectElement.destroy(),delete this._selectElement}return this._postTreatmentNumber(),this._select&&this._select.addEventListener("change",this._uomDataEntry.bind(this)),e},destroy:function(){this._select&&this._select.destroy(),delete this._select,this._parent()},_uomDataEntry:function(t){for(var i,n=e.Event.getElement(t).getClosest(".form-group").getElements("input"),a=0;a<n.length;a++)this._numberDataEntry({target:n[a]});this._config.unitAttribute&&(i=this._select?this._select.selectedIndex:this.getElement("select.ddv-uom").selectedIndex,this.normalizedSet(this.model,{name:this._config.unitAttribute,validate:this._config.validate},i))},_getActualValueBasedOnNumValue:function(e){var t,i;return this._config.unitAttribute?this._parent.apply(this,arguments):(t=this._select?this._select.selectedIndex:this.getElement("select.ddv-uom").selectedIndex,i=this._config.conversionTable[t],String(e/i))},_postTreatmentNumber:function(){if(this._parent.apply(this,arguments),this._config.unitAttribute){var e=this.normalizedGet(this.model,this._config.unitAttribute);if(e>=0&&e<this._config.uomValues.length)if(this._select)this._select.selectedIndex=e;else{var t=this.getElement("select.ddv-uom");t&&(t.selectedIndex=e)}this.postTreatmentReadOnlyMode(e)}},postTreatmentReadOnlyMode:function(e){var t=this.getElement("span.read-only");if(t){var i=this.normalizedGet(this.model,this._config.name);i=i&&0!==parseFloat(i)?i:"--",t.textContent=i+" "+this._config.uomValues[e]}}});return r.prototype.compiledTemplate=s,r}),define("DS/E6WCommonUI/Views/SelectView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/RDFFoundation/RDFUtils","DS/Controls/ComboBox","text!DS/E6WCommonUI/assets/templates/select.html.handlebars"],function(e,t,i,n,a,o,s){"use strict";var r=t.compile(s),l=n.extend({_uwaClassName:"E6WCommonUISelectView",tagName:"div",name:"E6WCommonUI.SelectView",domEvents:{"change select.data-entry":"_selectDataEntry"},setup:function(){this._parent.apply(this,arguments),e.is(this._config.values,"function")&&(this._valuesFunc=this._config.values,this._config.values=this._valuesFunc(),this._valuesFunc.dispatchEvent?this.listenTo(this._valuesFunc,"onChange",function(){this._updateValuesAndRender()}):this.canReadWrite()&&this._config.dispatcher&&this.listenTo(this._config.dispatcher,"onChange",function(){this._updateValuesAndRender()}))},_updateValuesAndRender:function(){this._updateValues(),this.setConfiguredTemplate(),this.render()},render:function(){var e=this._parent.apply(this,arguments),t=[];if(this._selectElement=this.getElement("select"),this._selectElement&&widget&&widget.useUIKitSelect){if(this._config&&this._config.values&&this._config.values.length)for(var i,n=0;n<this._config.values.length;n++)(i=this._config.values[n]).icon?t.push({valueItem:i.actualValue,labelItem:i.displayValue,iconItem:{iconPath:i.icon}}):i.fontIcon?t.push({valueItem:i.actualValue,labelItem:i.displayValue,iconItem:{iconName:i.fontIcon}}):t.push({valueItem:i.actualValue,labelItem:i.displayValue});this._select=new o({enableSearchFlag:!1,actionOnClickFlag:!1,elementsList:t}),this._select.inject(this._selectElement.parentElement,"top"),this._selectElement.destroy(),delete this._selectElement}return this._postTreatmentSelect(),this._select&&this._select.addEventListener("change",this._selectDataEntry.bind(this)),e},destroy:function(){this._select&&this._select.destroy(),delete this._select,this._parent()},_selectDataEntry:function(){var e=this._config,t=this._select?this._select.value:this._selectElement.value,i=e.values.detect(function(e){return e.actualValue===t});this.normalizedSet(this.model,e,i),this.handleHelperText(e)},handleHelperText:function(t){if(e.is(t.helperTextFunc,"function")){var i=t.helperTextFunc(this.model),n=this.container.getElement(".form-control-helper-text");n&&n.setText(i)}},_postTreatmentSelect:function(){var e=this._config,t=this.normalizedGet(this.model,e.name);if(e.isObject&&(t=t&&t.id),this.canReadWrite()&&this.normalizedGet(this.model,"canEdit")){var i=t&&t.actualValue||t;this._select?this._select.value=i:this._selectElement&&(this._selectElement.value=i)}else if(t){for(var n=e.values&&e.values.length||0,a=t&&t.displayValue||t,o=t&&t.actualValue||t,s=0;s<n;s++){var r=e.values[s];if(r.actualValue===o){a=r.displayValue;break}}this.getElement("span").setText(a),this.handleHelperText(e)}},_updateValues:function(){this._valuesFunc&&(this._config.values=this._valuesFunc())}});return l.prototype.compiledTemplate=r,l}),define("DS/E6WCommonUI/SubscribeUtilBase",["UWA/Core","UWA/Utils","UWA/Class/Events","DS/E6WCommonUI/UIHelper","DS/PlatformAPI/PlatformAPI","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n,a,o){"use strict";var s={i18n:function(){return o.get.bind(o)},getMessage:function(e){var t=e&&this.i18n(e.reason);return e.args&&(t=o.replace(t,e.args)),t},subscribeActivity:function(i,n){var o=e.clone(n||{},!1),r=o.uuid||t.getUUID(),l="XApp.Magic.Feedback."+r,d={name:i,id:r};return a.subscribe(l,function(e){console.log(JSON.stringify(e));var t=e.type,i=s.getMessage(e);i&&console.log(t+": "+i),s.events.dispatchEvent("onActivityProgress",{activity:d,loaded:e.loaded,total:e.total,type:t,log:i}),"complete"!==t&&"fail"!==t||(d.msgType=t,s.events.dispatchEvent("onActivityComplete",d))}),o.start&&s.startActivity(i,r),r},startActivity:function(e,t){s.events.dispatchEvent("onActivityStart",{name:e,id:t})},ACTIVITY_COMPLETE:"onActivityComplete",MESSAGE_COMPLETE:"complete"};return s.events=new i,s}),define("DS/E6WCommonUI/Views/MultiEditUomView",["DS/E6WCommonUI/Views/UomView","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t){"use strict";return e.extend({_uwaClassName:"E6WCommonUIMultiEditUomView",tagName:"div",name:"E6WCommonUI.MultiEditUomView",postTreatmentReadOnlyMode:function(){this._options&&this._options.fieldValues&&this._options.fieldValues.length>1||this._parent.apply(this,arguments)},_postTreatmentNumber:function(){var e;if(this._parent.apply(this,arguments),this._options&&this._options.fieldValues&&this._options.fieldValues.length>1){var i=this.getElement("span.read-only");if(i){i.textContent=(e="E6WCommonUI.Label.MutipleValues",t.get(e));var n=this.getElement(".field-group.tolerance");n&&n.remove()}}}})}),define("DS/E6WCommonUI/Views/MultiEditFieldView",["UWA/Core","UWA/Class","UWA/Class/Events","UWA/Class/Listener","UWA/Class/Model","UWA/Element","DS/UIKIT/Tooltip","DS/Controls/ComboBox","DS/Controls/Button","DS/E6WCommonUI/Views/TextView","DS/E6WCommonUI/Views/TextAreaView","DS/E6WCommonUI/Views/SelectView","DS/E6WCommonUI/Views/CheckBoxView","DS/E6WCommonUI/Views/DateView","DS/E6WCommonUI/Views/NumberView","DS/E6WCommonUI/Views/RangeView","DS/E6WCommonUI/Views/MultiEditUomView","DS/E6WCommonUI/Views/MultiDetailsDisplaySharedView","DS/E6WCommonUI/MultiEditHelper","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n,a,o,s,r,l,d,c,u,h,m,p,f,g,v,E,D){"use strict";var _={"To Do":"dsxplan:Open","In Work":"dsxplan:InProgress",Done:"dsxplan:Done",Completed:"dsxplan:Done"},w={Draft:"Create","To Do":"Assign","In Work":"Active","In Approval":"Review",Completed:"Complete"},C="dsplan:durationRange",b=function(e){return D.get(e)};return v.extend(i,n,{_uwaClassName:"MultiEditFieldView",init:function(e){e.renderToggleButtons=!0,this._config=e.config,this.uniqueDates=e.dateValues||{},this._config.label=this._config.fieldLabel||this._config.label,this._parent.apply(this,arguments);var t={};t[this._config.name]=null,t.canEdit=!0,this.displayModel=new a(t)},_inputDataEntry:function(){this.setValueOnCloneModel(this._getInputValue())},_getInputValue:function(){var e=this.getElement("input.data-entry"),t=e.value;return this._config.removeCarriageReturns&&(t=t.replace(/\n/g," "),e.value=t),t},setupChooseExistingView:function(e){this._setupCombobox(e)},isDurationField:function(e){return"dsplan:duration"===e.name||"estimatedDurationInputValue"===e.name},resetModel:function(e){e!==this.model&&(this.model&&this.stopListening(this.model),this.model=e,this.addModelEvents(),this._highlightValidationErrors())},getDataOptions:function(){return this._config.accPointsName?{attributes:[this._config.name,this._config.accPointsName,"canEdit"],level:0}:{attributes:[this._config.name,"canEdit"],level:0}},_highlightValidationErrors:function(){var e=this._config.name;if("dsplan:actualStartDate"===e||"dsplan:actualEndDate"===e||"dsplan:duration"===e||"dsplan:durationRange"===e)return this._parent.apply(this,arguments)},_clearValidationErrors:function(){var e=this.getContainerElement(),t=e&&e.getElement(".form-control-error-text");return t&&t.remove(),this._parent.apply(this,arguments)},render:function(t){var i=e.clone(this._config||{},!1),n=t&&(t.data||[]);if(0===(n=n||[]).length)return this.container;let a=n.every(function(e){return e.canEdit||E.isActualDateOfCompletedTask(i,e)}),s={canEdit:a};this.displayModel.set("canEdit",a);var r,l=E.getUniqueAttrValues(this._config,n),d={model:this.displayModel,config:i,data:s,fieldValues:l};if("uom"===i.type&&i.fieldLabel&&delete i.label,this.fieldView=this.fetchView(i.type,d),this.multiEditGroup=new o("div",{class:"input-group multi-object"}),this.multiEditButtonGroup=new o("div",{class:"input-group multi-object-edit-button"}),this.isDurationField(i)){let t=e.clone(i||{},!1);if(1===l.length){var c=l[0];null!==c.value&&void 0!==c.value&&(r=c.label,c=c.value),t.name=i.unitAttribute;let e=r.contains("Days")?0:1;this.fieldView.normalizedSet(this.displayModel,t,e),t.name=C,this.fieldView.normalizedSet(this.displayModel,t,l[0].offsetValue||0)}else!this.displayModel.get(i.name)&&this.fieldView.normalizedSet(this.displayModel,i,1),t.name=C,!this.displayModel.get(C)&&this.fieldView.normalizedSet(this.displayModel,t,0)}if(1===l.length){let e=this.getDefaultValue(l[0],this._config,a);!this.displayModel.get(i.name)&&this.fieldView.normalizedSet(this.displayModel,i,e),s[i.name]=e}else!(l.length>1)||a&&i.readWrite||(s[i.name]=this.getReadOnlyValue(this._config,l[0]));this.isDurationField(i)&&(s[C]=this.displayModel.get(C)||0),"range"===i.type&&this.model.model&&this.model.model.isDPMMilestoneGate()&&(d.config.step=100),this.container=this.fieldView.render(d);var u=this;return this.listenTo(this.displayModel,"onChange:"+i.name,function(e,t){u.setValueOnCloneModel(t)}),this.listenTo(this.displayModel,"onChange:"+C,function(e,t){u._config.name=C,u.setValueOnCloneModel(t)}),i.unitAttribute&&this.listenTo(this.displayModel,"onChange:"+i.unitAttribute,(e,t)=>{u._config.name=i.unitAttribute,u.setValueOnCloneModel(t),u._config.name=i.name}),l.length>1&&a&&i.readWrite?(this._setupToggleButtons(),this._setupCombobox(l),this._switchToChooseExistingMode()):this._switchToAddNewMode(),this.container},getReadOnlyValue:function(e,t){let i,n=b("E6WCommonUI.Label.MutipleValues");return"uom"===e.type?i="--":"select"===e.type?(e.values.push({actualValue:"disabled",displayValue:n}),i="disabled",!this.displayModel.get(e.name)&&this.fieldView.normalizedSet(this.displayModel,e,"disabled")):i=t.displayValue?{actualValue:"",displayValue:n}:t.label?{label:n,value:""}:n,i},getDefaultValue:function(e,t,i){if(null!==(e="state"===t.name?w[e]||e:_[e]||e).value&&void 0!==e.value&&(e=e.value),"date"===t.type){if(!i||!t.readWrite)return e;var n=new Date(e.actualValue||e);"Invalid Date"===n.toString()&&(n=new Date(e.displayValue||e)),e=n}return e},setValueOnCloneModel:function(t){if(this.isDurationField(this._config)){let i="object"==typeof t?t:[];this.fieldView.normalizedSet(this.model,this._config,i[0]||t);let n=e.clone(this._config||{},!1);n.name=this._config.toleranceName,this.fieldView.normalizedSet(this.model,n,i[1]||this.displayModel.get(C)||0)}else this.fieldView.normalizedSet(this.model,this._config,t)},_setupCombobox:function(e){if(this._select=new r(E.getComboBoxOptions(this._config,e)),this.container.getElement(".input-group-wrapper")){let e=new o("div",{class:"input-element"});this._select.inject(e),e.inject(this.multiEditGroup),this.multiEditGroup.inject(this.container.getElement(".input-group-wrapper")),this._select&&this._select.addEventListener("change",this._selectDataEntry.bind(this))}},inject:function(e){this.fieldView.inject(e)},getContainerElement:function(){return this.fieldView&&this.fieldView.container},_setupToggleButtons:function(){var e=this;this._addNewButton=new l({name:"addNewValue",icon:"plus",attributes:{title:b("E6WCommonUI.Label.AddNewValue")}}),this._addnewTooltip=new s({target:this._addNewButton.elements.button,body:b("E6WCommonUI.Label.AddNewValue")}),this._chooseExistingButton=new l({name:"chooseExistingValue",icon:"close",attributes:{title:b("E6WCommonUI.Label.ChooseExistingValue")}}),this._chooseExistingTooltip=new s({target:this._chooseExistingButton.elements.button,body:b("E6WCommonUI.Label.ChooseExistingValue")}),this._addNewButton.addEventListener("buttonclick",function(){e._switchToAddNewMode()});let t=new o("div",{class:"input-element"});this._addNewButton.inject(t),this._chooseExistingButton.addEventListener("buttonclick",function(){e._switchToChooseExistingMode()}),this._chooseExistingButton.inject(t),this.container.getElement(".input-group-wrapper")&&(t.inject(this.multiEditButtonGroup),this.multiEditButtonGroup.inject(this.container.getElement(".input-group-wrapper"),"top"))},_switchToChooseExistingMode:function(){this._addNewButton&&this._addNewButton.elements.container.removeClassName("hide"),this._chooseExistingButton&&this._chooseExistingButton.elements.container.addClassName("hide"),this.hideAddNewView(),this.showChooseExistingView()},_switchToAddNewMode:function(){this._addNewButton&&this._addNewButton.elements.container.addClassName("hide"),this._chooseExistingButton&&this._chooseExistingButton.elements.container.removeClassName("hide"),this.hideChooseExistingView(),this.showAddNewView()},hideAddNewView:function(){let e=this.fieldView.getElements(".input-group:not(.multi-object,.multi-object-edit-button)");if(e.length>0)for(let t=0;t<e.length;t++){e[t].addClassName("hide")}let t=this.fieldView.getElements(".field-group");if(t.length>1)for(let e=1;e<t.length;e++){t[e].addClassName("hide")}},showAddNewView:function(){let e=this.fieldView.getElements(".input-group:not(.multi-object,.multi-object-edit-button)");if(e.length>0)for(let t=0;t<e.length;t++){e[t].removeClassName("hide")}let t=this.fieldView.getElements(".field-group");if(t.length>1)for(let e=1;e<t.length;e++){t[e].removeClassName("hide")}},hideChooseExistingView:function(){this.multiEditGroup.addClassName("hide")},showChooseExistingView:function(){this.multiEditGroup.removeClassName("hide")},fetchView:function(e,t){var i;switch(e){case"text":i=new d(t);break;case"textarea":i=new c(t);break;case"select":i=new u(t);break;case"checkbox":i=new h(t);break;case"date":i=new m(t);break;case"number":i=new p(t);break;case"range":i=new f(t);break;case"uom":i=new g(t);break;default:i=new d(t)}return i},_selectDataEntry:function(){var e;switch(e=0===this._select.selectedIndex?void 0:this._select?this._select.value:this._selectElement.value,this._config.type){case"select":e="state"===this._config.name?w[e]?w[e]:e:_[e]||e}if(this.setValueOnCloneModel(e),"estimatedDurationInputValue"===this._config.name){this._config.name=this._config.unitAttribute;let e=this._select.label.contains("Days")?0:1;this.setValueOnCloneModel(e)}},removeEvent:function(){this.fieldView&&this.fieldView.removeEvent(this,arguments)},_postTreatmentTextArea:()=>{},destroy:function(){this._select&&this._select.destroy(),delete this._select,this.fieldView&&this.fieldView.destroy(),delete this.fieldView,this._parent()}})}),define("DS/E6WCommonUI/Views/MultiPriorityView",["UWA/Core","UWA/Element","DS/Controls/ComboBox","DS/UIKIT/Input/Button","DS/UIKIT/Input/ButtonGroup","DS/E6WCommonUI/Views/MultiDetailsDisplaySharedView","DS/E6WCommonUI/MultiEditHelper"],function(e,t,i,n,a,o,s){"use strict";var r=o.i18n;return o.extend({_uwaClassName:"MultiPriorityView",className:"details-display-shared-view ddv-field form-group ",id:function(){return"MultiPriorityView_"+this.cid},setup:function(e){e.renderToggleButtons=!0,this._parent.apply(this,arguments)},setupAddNewView:function(e){this.fieldView=this.createPriorityButtonGroup(e),this.fieldView.inject(this._inputElement),this.multiEditGroup=this.container.getElement(".multi-object"),this.multiEditGroup&&this.multiEditGroup.addClassName("hide")},setupChooseExistingView:function(e){this._setupCombobox(e)},hideChooseExistingView:function(){this.multiEditGroup.addClassName("hide")},showChooseExistingView:function(){this.multiEditGroup.removeClassName("hide")},_setupCombobox:function(e){this._select=new i(s.getComboBoxOptions(this._config,e)),this.container.getElement(".input-group-wrapper")&&(this._select.inject(this.multiEditGroup),this.addChildView(this._select),this._select&&this._select.addEventListener("change",this._selectDataEntry.bind(this)))},hideAddNewView:function(){this.container.getElement(".input-group:not(.multi-object,.multi-object-edit-button)")&&this.container.getElement(".input-group:not(.multi-object,.multi-object-edit-button)").addClassName("hide")},showAddNewView:function(){this.container.getElement(".input-group:not(.multi-object,.multi-object-edit-button)")&&this.container.getElement(".input-group:not(.multi-object,.multi-object-edit-button)").removeClassName("hide")},createPriorityButtonGroup:function(e){var t=this.model.get(this._config.name);if(t&&t.id&&(t=t&&t.id),1===e.length){var i=e[0];i.label&&(t=i.label)}this._config.priorityMapping&&(t=this._config.priorityMapping[t]);var o=new a({type:"radio",buttons:[new n({name:"dsxplan:Low",className:"success large",icon:"low",attributes:{title:r("E6WCommonUI.Label.Low")},active:"Low"===t}),new n({name:"dsxplan:Medium",className:"info large",icon:"medium",attributes:{title:r("E6WCommonUI.Label.Medium")},active:"Medium"===t}),new n({name:"dsxplan:High",className:"warning large",icon:"high",attributes:{title:r("E6WCommonUI.Label.High")},active:"High"===t}),new n({name:"dsxplan:Urgent",className:"error large",icon:"alert",attributes:{title:r("E6WCommonUI.Label.Urgent")},active:"Urgent"===t})],events:{onClick:this.onClickButton.bind(this)}});return o.setClassName("item-priority"),o},_selectDataEntry:function(){var e;switch(e=0===this._select.selectedIndex?void 0:this._select?this._select.value:this._selectElement.value){case"Low":e="dsxplan:Low";break;case"Medium":e="dsxplan:Medium";break;case"High":e="dsxplan:High";break;case"Urgent":e="dsxplan:Urgent"}this.setValueOnCloneModel(e)},destroy:function(){this._select&&this._select.destroy(),delete this._select,this._parent()},onClickButton:function(e,t){this.setValueOnCloneModel(t.options.name)}})}),define("DS/E6WCommonUI/Views/PersonView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/ObjectView","DS/E6WCommonUI/Models/DropValidator","DS/E6WCommonUI/UIHelper","text!DS/E6WCommonUI/assets/templates/person.html.handlebars"],function(e,t,i,n,a,o){"use strict";var s=t.compile(o),r=i.extend({_uwaClassName:"E6WCommonUIPersonView",tagName:"div",name:"E6WCommonUI.PersonView",init:function(t){this._dropTypes=e.clone(t&&t.config&&t.config.dropTypes||{},!1),this._dropTypes["3dspace"]=this._dropTypes["3dspace"]||[],this._dropTypes.swym=this._dropTypes.swym||[],this._dropTypes["3dspace"]=this._dropTypes["3dspace"].concat("Person"),this._dropTypes.swym=this._dropTypes.swym.concat("pno:Person"),this._parent(t)},processAutoCompleteData:function(t){var i=e.clone(t,!1);return!i.image&&i.name&&(i.image=a.userPictureURL(i.name)),i},validateDroppedObject:function(t){return n.validateDroppedObject(t,e.extend(this._config,{dropTypes:this._dropTypes}))}});return r.prototype.compiledTemplate=s,r}),define("DS/E6WCommonUI/Views/ToggleView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/Controls/Toggle","DS/Controls/ButtonGroup","DS/Controls/TooltipModel","text!DS/E6WCommonUI/assets/templates/toggle.html.handlebars"],function(e,t,i,n,a,o,s){"use strict";var r=t.compile(s),l=i.extend({_uwaClassName:"E6WCommonUIToggleView",tagName:"div",name:"E6WCommonUI.ToggleView",setup:function(){this._parent.apply(this,arguments),e.is(this._config.values,"function")&&(this._valuesFunc=this._config.values,this._config.values=this._valuesFunc(),this._valuesFunc.dispatchEvent?this.listenTo(this._valuesFunc,"onChange",function(){this._updateValuesAndRender()}):this.canReadWrite()&&this._config.dispatcher&&this.listenTo(this._config.dispatcher,"onChange",function(){this._updateValuesAndRender()}))},_updateValuesAndRender:function(){this._updateValues(),this.setConfiguredTemplate(),this.render()},render:function(){var e=this._parent.apply(this,arguments);this.inputContainer=this.getElement(".input-element");var t=this._config,i=this.normalizedGet(this.model,t.name);if(this.canReadWrite()&&this.normalizedGet(this.model,"canEdit")){this._buttonGroup=new a({type:this._config.toggleType});var s=this.normalizedGet(this.model,this._config.name);if(this._config&&this._config.values&&this._config.values.length){for(var r=0;r<this._config.values.length;r++){let e=this._config.values[r];if(e.icon){var l=new n({type:this._config.toggleType,value:e.actualValue,label:e.displayValue,allowUnsafeHTMLLabel:!0,checkFlag:s&&s===e.actualValue,tooltipInfos:e.helperText?new o({title:e.displayValue,shortHelp:e.helperText}):null});this._buttonGroup.addChild(l),l.elements.label.innerHTML=`<img src="${e.icon}" /> ${e.displayValue}`+(e.helperText?'<i class="fonticon fonticon-info" style="margin-left:5px" />':"")}else e.fontIcon?this._buttonGroup.addChild(new n({type:this._config.type,value:e.actualValue,label:e.displayValue,icon:e.fontIcon,checkFlag:s&&s===e.actualValue,tooltipInfos:e.helperText?new o({title:e.displayValue,shortHelp:e.helperText}):null})):this._buttonGroup.addChild(new n({type:this._config.type,value:e.actualValue,label:e.displayValue,checkFlag:s&&s===e.actualValue,tooltipInfos:e.helperText?new o({title:e.displayValue,shortHelp:e.helperText}):null}))}var d=this;this._buttonGroup&&this._buttonGroup.addEventListener("change",function(){var e=d._config,t=d._buttonGroup.value,i=e.values.detect(function(e){return e.actualValue===t[0]});d.normalizedSet(d.model,e,i)})}this._buttonGroup.inject(this.inputContainer.parentElement,"top"),this.inputContainer.destroy(),delete this.inputContainer}else if(i){for(var c=t.values&&t.values.length||0,u=i&&i.displayValue||i,h=i&&i.actualValue||i,m=0;m<c;m++){var p=t.values[m];if(p.actualValue===h){u=p.displayValue;break}}this.getElement("span").setText(u)}return e},destroy:function(){this._buttonGroup&&this._buttonGroup.destroy(),delete this._buttonGroup,this._parent()},_updateValues:function(){this._valuesFunc&&(this._config.values=this._valuesFunc())}});return l.prototype.compiledTemplate=r,l}),define("DS/E6WCommonUI/Views/MultiStartStopView",["UWA/Core","UWA/Class","DS/E6WCommonUI/Views/MultiEditFieldView","DS/E6WCommonUI/E6WCommonUIConstants","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n,a){"use strict";return t.extend({_uwaClassName:"MultiStartStopView",tagName:"div",name:"E6WCommonUI.MultiStartStopView",id:function(){return"MultiStartStopView_"+this.cid},init:function(t){var i=e.clone(t||{},!1);this.dateViews=[],this.createDateFields(i)},createDateFields:function(t){let o=t.config;var s=t.model&&t.model.getDatesType(o.name)||{};let r={canEditStartDate:o.canEditStartDate,canEditEndDate:o.canEditEndDate,multiCustomView:o.multiCustomView,readWrite:o.readWrite,isStartDateManualAttribute:o.isStartDateManualAttribute,isEndDateManualAttribute:o.isEndDateManualAttribute,type:"date",validate:!0,index:7};if(s[n.STARTDATE_ATTR]){let o=e.clone(r||{},!1);o.label=a.get("E6WCommonUI.Label.PlannedStartDate"),o.name=n.STARTDATE_ATTR,t.config=o,t.dateValues=s[n.STARTDATE_ATTR];let l=new i(t);this.dateViews.push(l)}if(s[n.ENDDATE_ATTR]){let o=e.clone(r||{},!1);o.name=n.ENDDATE_ATTR,o.label=a.get("E6WCommonUI.Label.PlannedEndDate"),o.endDateAttribute=n.ENDDATE_ATTR,t.config=o,t.dateValues=s[n.ENDDATE_ATTR];let l=new i(t);this.dateViews.push(l)}if(s[n.ACTUAL_START_DATE]){let o=e.clone(r||{},!1);o.label=a.get("E6WCommonUI.Label.ActualStart"),o.name=n.ACTUAL_START_DATE,t.config=o,t.dateValues=s[n.ACTUAL_START_DATE];let l=new i(t);this.dateViews.push(l)}if(s[n.ACTUAL_END_DATE]){let o=e.clone(r||{},!1);o.label=a.get("E6WCommonUI.Label.ActualEnd"),o.name=n.ACTUAL_END_DATE,o.endDateAttribute=n.ACTUAL_END_DATE,t.config=o,t.dateValues=s[n.ACTUAL_END_DATE];let l=new i(t);this.dateViews.push(l)}if(s[n.ACTUAL_START_ATTR]){let l=e.clone(r||{},!1);l.label=a.get("E6WCommonUI.Label.ActualStartDate"),l.name=n.ACTUAL_START_ATTR,l.group=o.group,t.config=l,t.dateValues=s[n.ACTUAL_START_ATTR];let d=new i(t);this.dateViews.push(d)}if(s[n.ACTUAL_FINISH_ATTR]){let l=e.clone(r||{},!1);l.label=a.get("E6WCommonUI.Label.ActualFinishDate"),l.name=n.ACTUAL_FINISH_ATTR,l.endDateAttribute=n.ACTUAL_FINISH_ATTR,l.group=o.group,t.config=l,t.dateValues=s[n.ACTUAL_FINISH_ATTR];let d=new i(t);this.dateViews.push(d)}if(s[n.ESTIMATED_START_DATE]){let o=e.clone(r||{},!1);o.label=a.get("E6WCommonUI.Label.EstimatedStartDate"),o.name=n.ESTIMATED_START_DATE,t.config=o,t.dateValues=s[n.ESTIMATED_START_DATE];let l=new i(t);this.dateViews.push(l)}if(s[n.ESTIMATED_DUE_DATE]){let o=e.clone(r||{},!1);o.label=a.get("E6WCommonUI.Label.EstimatedFinishDate"),o.name=n.ESTIMATED_DUE_DATE,o.endDateAttribute=n.ESTIMATED_DUE_DATE,t.config=o,t.dateValues=s[n.ESTIMATED_DUE_DATE];let l=new i(t);this.dateViews.push(l)}}})}),define("DS/E6WCommonUI/MultiEditRequestBuilder",["UWA/Core","UWA/Class","DS/E6WCommonUI/SubscribeUtilBase","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n){"use strict";return t.extend({init:function(e){this.ajax=this.ajax.bind(this),this.requests=[],this._baseUrl=e.baseUrl,this._mask=e.mask,this._ajax=e.ajax},ajax:function(t,i){var n=e.clone(i||{},!1);n.url=t,this.requests.push(n)},sendRequest:function(t){var a=e.clone(t||{},!1);if(0===this.requests.length)return;let o={method:"POST"},s=this.requests.map(function(e){return e.onComplete}),r=this.requests.map(function(e){return e.onFailure}),l=this.requests.map(function(e){return JSON.parse(e.data)}),d=i.subscribeActivity((c="E6WCommonUI.Label.SavingChanges",n.get(c)),{start:!0});var c;return o.data=JSON.stringify([{data:l,identifier:d}]),o.onComplete=function(t){let i=JSON.parse(t),n=i.member;if(e.is(n,"array"))for(let e=0;e<i.member.length;e++){let t=n[e];s[e](t)}else for(let e=0;e<r.length;e++)r[e](new Error("Multi edit failure"),t)},o.onFailure=function(t,i){for(let e=0;e<r.length;e++)r[e](t,i);e.is(a.onFailure,"function")&&a.onFailure.apply(this,arguments)},this._ajax(this._baseUrl+"?$mask="+this._mask,o)}})}),define("DS/E6WCommonUI/Models/BulkCloneModel",["UWA/Class/Model","DS/E6WCommonUI/Models/CloneModel","DS/E6WCommonUI/MultiEditRequestBuilder","DS/E6WCommonUI/UIHelper","UWA/Core","UWA/Class/Collection","UWA/Class/Events","UWA/Class/Listener","DS/RDFFoundation/Models/ResultModel","DS/RDFFoundation/RDFUtils","DS/E6WCommonUI/E6WCommonUIConstants","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n,a,o,s,r,l,d,c,u){"use strict";c.PLANNED_START_LABEL,c.PLANNED_END_LABEL,c.ACTUAL_START_LABEL,c.ACTUAL_END_LABEL;var h={Create:!0,Assign:!1,Active:!1,Review:!0,Complete:!0},m=t.extend(s,r,{_uwaClassName:"BulkCloneModel",init:function(e,t,i,n){var a=this;this.model=e,this.models=[],this.model.models.forEach(function(e){let o=new t(e,i);o.scopesTypes=n.scopesTypes,o.projectTypes=n.projectTypes,o.contentsTypes=n.contentsTypes,a.models.push(o),a.listenTo(o,"onAnyEvent",function(e){var t=Array.prototype.slice.call(arguments,1);a.dispatchEvent(e,t)})})},dataForRendering:function(e){return this.models.map(function(t){return t.dataForRendering(e)})},toJSON:function(e){return this.models.map(function(t){return t.toJSON(e)})},get:function(e){let t=[];return this.models.forEach(function(i){let n=i.get(e);if(n){let e,i;Array.isArray(n)?e=n:n instanceof o?e=n.toArray():i=n,e?t=t.concat(e):t.push(i)}}),t},add:function(e,t,i){this.modificationsPending=!0,i.multiEdit=!0,this.dispatchEvent("onChange:modificationsPending",[this]),this.models.forEach(function(n){i.addAsSingleValue?n.add(e,t,i):n.add(e,[t],i)})},replaceAll:function(e,t,i){this.removeAllValues(e),this.add(e,t,i)},replaceSingleValue:function(e,t,i){i.addAsSingleValue=!0,this.add(e,t,i)},removeAllValues:function(e){this.models.forEach(function(t){t.removeAll(e)})},remove:function(e,t,i){this.modificationsPending=!0,this.dispatchEvent("onChange:modificationsPending",[this]),this.models.forEach(function(n){n.remove(e,t,i)})},removeById:function(e,t,i){this.modificationsPending=!0,this.dispatchEvent("onChange:modificationsPending",[this]),this.models.forEach(function(n){let a,o=n.get(e);o.length>0&&(a=o.find(function(e){return e.id===t}))&&n._removeByValue(e,a,i)})},canAssignToSelf:function(e){let t=this.models.every(e=>e.model.hasPermissionToAssignToSelf()),i=this.models.some(t=>t.model.isAssignedToCurrentUser(e));return t&&i},assignToSelf:function(e){e.multiEdit=!0,this.models.forEach(function(t){t.assignToSelf(e)})},set:function(e,t,i){var n=a.clone(i||{},!1);n&&n.whisper&&delete n.silent;var o=n&&n.silent;this.modificationsPending=!0,this.dispatchEvent("onChange:modificationsPending",[this]),("dscom:hasMaturity"===e&&!enoviaServer.useFD01CodeFor3DPlan||"dsplan:hasPriority"===e)&&(t=t&&t.actualValue?t.actualValue:t)&&(t=d.getObjectForAdding(l,t));var s=[];this.models.forEach(n=>{this.shouldSetPercentField(e,t,n)&&n.set(e,t,i),("dsplan:duration"===e||"dsplan:durationRange"===e)&&delete n.localAttributes["dsplan:estimatedEndDate"],n.validationError&&n.validationError.fields&&(s=[...new Set([...s,...n.validationError.fields])])}),this.validationError={fields:s},!o&&this.validationError&&this.validationError.fields&&this.validationError.fields.length>0?this.dispatchEvent("onValidationFailure"):this.dispatchEvent("onValidationSuccess")},shouldSetPercentField:function(e,t,i){if("dsplan:percentageCompletion"===e&&i.localAttributes["dscom:hasMaturity"]){if("dsxplan:Done"===i.localAttributes["dscom:hasMaturity"].id||0===t||100===t)return!1}else if("dscom:hasMaturity"===e){let e=i.localAttributes["dsplan:percentageCompletion"];0!==e&&100!==e||delete i.localAttributes["dsplan:percentageCompletion"]}return!0},attrIsDate:function(e){return e===c.ENDDATE_ATTR||e===c.STARTDATE_ATTR||e===c.ACTUAL_START_DATE||e===c.ACTUAL_END_DATE||e===c.ESTIMATED_START_DATE||e===c.ESTIMATED_DUE_DATE||"actualStartDate"===e||"actualStartEnd"===e},validateDate:function(e,t){(e===c.ACTUAL_START_DATE||"actualStartDate"===e)&&new Date(t.actualValue||t)>new Date?this.dispatchEvent("onValidationFailure"):(e===c.ACTUAL_END_DATE||"actualStartEnd"===e)&&new Date(t.actualValue||t)>new Date?this.dispatchEvent("onValidationFailure"):this.dispatchEvent("onValidationSuccess")},shouldSetModel:function(e,t,i){var n=!0;if((e===c.STARTDATE_ATTR&&t.get(c.ACTUAL_START_DATE)||e===c.ENDDATE_ATTR&&t.get(c.ACTUAL_END_DATE)||e===c.STARTDATE_ATTR&&!t.get(c.USER_DEFINED_START_DATE_ATTR)||e===c.ENDDATE_ATTR&&!t.get(c.USER_DEFINED_END_DATE_ATTR)||e===c.ESTIMATED_START_DATE&&!h[t.get("state")]||e===c.ESTIMATED_DUE_DATE&&"complete"===t.get("state"))&&(n=!1),e===c.ACTUAL_START_DATE){let e=new Date(i.actualValue);(t.localAttributes[c.ACTUAL_END_DATE]&&t.localAttributes[c.ACTUAL_END_DATE]<e||t.get(c.ACTUAL_END_DATE)&&t.get(c.ACTUAL_END_DATE).actualValue<e)&&(n=!1)}if(e===c.ACTUAL_END_DATE){let e=new Date(i.actualValue);(t.localAttributes[c.ACTUAL_START_DATE]&&t.localAttributes[c.ACTUAL_START_DATE]>e||t.get(c.ACTUAL_START_DATE).actualValue>e)&&(n=!1)}return n},isActualDate:function(e){return e===c.ACTUAL_START_DATE||"actualStartDate"===e||e===c.ACTUAL_END_DATE||"actualStartEnd"===e},hasSameModels:function(e){return this.models.length===e.models.length&&this.models.every(function(t){e.models.includes(t)})},getDatesType:function(e){var t={};return this.models.forEach(i=>{let n=i.model;n.isRDFTask()?(i.get(c.STARTDATE_ATTR)&&this.addDatesTypes(c.STARTDATE_ATTR,i.get(c.STARTDATE_ATTR),t),i.get(c.ENDDATE_ATTR)&&this.addDatesTypes(c.ENDDATE_ATTR,i.get(c.ENDDATE_ATTR),t),i.get(c.ACTUAL_START_DATE)&&this.addDatesTypes(c.ACTUAL_START_DATE,i.get(c.ACTUAL_START_DATE),t),i.get(c.ACTUAL_END_DATE)&&this.addDatesTypes(c.ACTUAL_END_DATE,i.get(c.ACTUAL_END_DATE),t)):e===c.ACTUAL_START_ATTR||e===c.ACTUAL_FINISH_ATTR?(n.get(c.ACTUAL_START_ATTR)&&this.addDatesTypes(c.ACTUAL_START_ATTR,n.get("actualStartDate"),t),n.get(c.ACTUAL_FINISH_ATTR)&&this.addDatesTypes(c.ACTUAL_FINISH_ATTR,n.get("actualFinishDate"),t)):e!==c.ESTIMATED_START_DATE&&e!==c.ESTIMATED_DUE_DATE||(n.get(c.ESTIMATED_START_DATE)&&this.addDatesTypes(c.ESTIMATED_START_DATE,n.get("estimatedStartDate"),t),n.get(c.ESTIMATED_DUE_DATE)&&this.addDatesTypes(c.ESTIMATED_DUE_DATE,n.get("dueDate"),t))}),t},addDatesTypes:function(e,t,i){i[e]?i[e].push(t):i[e]=[t]},cancel:function(){this.modificationsPending=!1,this.models.forEach(function(e){e.cancel()})},save:function(e){var t=a.clone(e||{},!1);t.isMassEdit=!0,this.model.isRDFTask()?(this.multiEditRequestBuilder=new i({ajax:d.request,baseUrl:d.expandUrl("","v1")+"invoke/dsxplan:massEdit",mask:"dsplan:MVMask.Task.Property"}),t.ajax=this.multiEditRequestBuilder.ajax,this.modificationsPending=!1,this.models.forEach(function(e){e.save(t)}),this.multiEditRequestBuilder.sendRequest({onFailure:()=>{this.model.dispatchEvent("massEditFailed")}})):(t.delayedSave=!0,this.modificationsPending=!1,this.models.forEach(function(e){e.save(t)}),this.model.models[0].collection.save())}});return Object.defineProperty(m.prototype,"modificationsPending",{get:function(){return this.models.some(function(e){return e.modificationsPending})},set:function(e){this.models.forEach(function(t){t.modificationsPending=e}),this.dispatchEvent("onChange:modificationsPending",[this])}}),m}),define("DS/E6WCommonUI/Views/ObjectCardView",["UWA/Core","UWA/Class/Collection","DS/UIKIT/DropdownMenu","DS/E6WCommonUI/Views/ObjectView","DS/E6WCommonUI/PlatformManager","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/CompassUtil","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/Handlebars/Handlebars4","DS/UIKIT/Tooltip","DS/RDFFoundation/Models/PersonRDFModel","DS/RDFFoundation/FederatedSearchUtil","DS/RDFFoundation/MemberUtils","text!DS/E6WCommonUI/assets/templates/objectCard.html.handlebars","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n,a,o,s,r,l,d,c,u,h,m,p){"use strict";var f=function(e){return p.get(e)},g=l.compile(m),v=function(e){return!e||!e.hasViewAccess||e.hasViewAccess()},E=n.extend({_uwaClassName:"ObjectCardView",domEvents:{"click li.object-card":"_onClickObjectField"},setup:function(){var e=this;this._tooltips=[],this.container.addEventListener("contextmenu",function(t){return e.createAndShowContextMenu(t),!1},!1),this._parent.apply(this,arguments)},render:function(){var t=e.Element.extend(document.activeElement),i=this.container===t.getClosest(".ddv-field");this._parent.apply(this,arguments);var n=this,o=this.getElements(".fonticon-down-open"),s=n.getElement(".btn.ds-group-plus");0===o.length&&s&&s.toggleClassName("disabled",!0),o.forEach(function(e){n._tooltips.push(new d({target:e,body:f("E6WCommonUI.Label.Menu")}))});const r=this.getElement("#uploadButton");r&&n._tooltips.push(new d({target:r,body:f("E6WCommonUI.Label.Upload")}));const l=this.getElement("#newLinkButton");l&&(a.hasAccess("3DSpace")?n._tooltips.push(new d({target:l,body:f("E6WCommonUI.Label.NewLink")})):l.addClassName("disabled"));const c=this.getElement("#clearAllButton");return c&&n._tooltips.push(new d({target:c,body:f("E6WCommonUI.Label.ClearAll")})),this.getElements(".custom-button").forEach((e,t)=>{n._tooltips.push(new d({target:e,body:n._config.customButtons[t].toolTip}))}),s&&n._tooltips.push(new d({target:s,body:"person"===n._config.type?f("E6WCommonUI.Label.AddMember"):f("E6WCommonUI.Label.AddExisting")})),i&&this.container.getElement("ul").click(),this._addDummyCard(),this},_addDummyCard:function(){this._clearDummyCard();let e=this._config.limit,t=this.normalizedGet(this.model,this._config.name);if(t&&t.length>e){let i=t.length-e,n=this._getInfoMessageForDummycard(i);this._injectDummyCard(n)}},_clearDummyCard:function(){this._dummyListNode&&this._dummyListNode.remove()},_getInfoMessageForDummycard:function(e){return p.replace(p.get("E6WCommonUI.Label.DummyCard"),{OBJECT_COUNT:e})},_injectDummyCard:function(t){this._dummyListNode||(this._dummyListNode=e.createElement("li",{class:"text-info object-card",contextMenu:!1,styles:{display:"grid","text-align":"center"},events:{click:function(t){t.stopPropagation(),e.Event.stop(t)},contextmenu:function(t){t.stopPropagation(),e.Event.stop(t)}}}));var i=this.container.getElement(".object-list");i&&this._dummyListNode.inject(i),this._dummyListNode.setText(t)},_onClickObjectField:function(t){if(t.preventDefault&&t.preventDefault(),!t.clickedOnObject){var i=e.Event.getElement(t),n=i.getClosest("li");this.deactivateAllListElements(n),n&&n.addClassName("active"),this.selectInCompass(i)}},addOpenWith:function(e){o.addOpenWith({view:this,dropdownMenu:this.dropdownMenu,modelData:this.computeDragDataFromModel(e)})},selectInCompass:function(e){var t=e.model?e.model:this.getModelFromCard(e),i=this.normalizedGet(t,"type")||t&&(t.get("type")||t.getObjectType&&t.getObjectType());if(i&&-1===i.indexOf("Person")){var n=this.computeDragDataFromElement(e);s.openCompassWithModel(t,{transferObject:n})}},_dontActivateObjectField:function(){},checkDialogDeactivation:function(e,t){this._parent(e,t),e!==t&&this.deactivateAllListElements()},deactivateAllListElements:function(){var e=this.container.getElements("li");e&&e.forEach(function(e){e.toggleClassName("active",!1)})},getObjectsArray:function(){return this.normalizedGet(this.model,this._config.name)},getActiveModel:function(t){var i,n=this.getObjectsArray(),a=this;return n&&(e.is(n,"array")||n instanceof e.Class.Collection)?n.some(function(e){return(t===a.normalizedGet(e,"physicalId")||t===a.normalizedGet(e,"groupURI")||t===a.normalizedGet(e,"objectId"))&&(i=e,!0)}):t===this.normalizedGet(n,"physicalId")&&(i=n),i},postTreatmentObjectListClickHandlers:function(e){this._parent(e),this._addDropDownMenuListener()},_addDropDownMenuListener:function(){for(var e=this,t=e.getElements(".fonticon-down-open"),i=t.length,n=0;n<i;n++){t[n].getClosest("button").addEvent("click",function(t){e.createMenu(t,{target:this}),e._showDropDownMenu(e.dropdownMenu)})}},_showDropDownMenu:function(e,t){t&&!o.dropdownMenuHasItems(e)||e.show()},createAndShowContextMenu:function(e){this.createMenu(e),o.showAndUpdateContextualDropdownMenuPosition(this.dropdownMenu,e,!0)},createMenu:function(t,i){t.stopPropagation(),t.preventDefault();var n=e.Event.getElement(t),a=n.getClosest(".object-card").getAttribute("data-id"),o=this.getElements(".object-card").findIndex(function(e){return e.getAttribute("data-id")===a}),s=e.clone(this._options||{},!1);s.config=this._config;var r={target:i&&i.target||n,options:s,event:t,index:o,model:this.getActiveModel(a)};this.dropdownMenu&&this.dropdownMenu.destroy(),this.createMenuButtons(r)},createMenuButtons:function(e){this.checkDialogDeactivation();var t,i=this;e.model&&(t=!0===(t=this.normalizedGet(e.model,"hasfiles"))||"TRUE"===t);const n={target:e.target,items:[],events:{onClickOutside:function(){this.menus&&this.destroy(),delete i.dropdownMenu},onHide:function(){this.menus&&this.destroy(),delete i.dropdownMenu}},currentModel:this.normalizedGet(this.model,this._config.name)};e.zIndex&&(n.zindex=e.zIndex),i.createDropdownMenu(n),e.model&&"swym:WeDo"!==e.model.get("dsxplan:jsType")&&this.addOpenAndOpenWith(e),(this._config.getDropDownMenuItems&&this._config.getDropDownMenuItems.call(this,t,e)||this.getDropDownMenuItems(t,e)).forEach(function(e){i.dropdownMenu.addItem(e)})},createDropdownMenu:function(e){this.dropdownMenu=new i(e),this.dispatchEvent(r.events.menuOpened,[this.dropdownMenu])},getMenuItems:function(e){return[this.getDownloadButton(e),this.getRemoveItemButton(e)]},needPropertiesButton:function(e){return e.model&&v(e.model)&&(!e.model.canShowProperties||e.model.canShowProperties())&&e.options&&"team_members"!==e.options.config.name},getDropDownMenuItems:function(t,i){var n=e.clone(i||{},!1);n.canDownload=t;var o=n.model&&this.normalizedGet(n.model,"type"),s=this.getMenuItems(n);let r=this.needPropertiesButton(n);var l=n.model&&("foaf:Group"===n.model.get("ds6w:type")||"Group"===n.model.get("type")||"Group Proxy"===n.model.get("type")||"foaf:Group"===n.model.get("type"));try{let e=require("DS/i3DXRDFGroupViewer/js/GroupViewer");l&&e&&s.unshift(this.getShowMembersButton(n,this.getGroupViewerContainer()))}catch(e){}if(r&&!i.isUrl&&s.unshift(this.getPropertiesButton(n)),"propertiesButton"===s[0].name&&s[0].className&&"disabled"===s[0].className&&s.shift(),o&&-1!==o.indexOf("Person")||l){var d=s.findIndex(e=>"downloadButton"===e.name);-1!==d&&s.splice(d,1)}if("pno:Person"!==o&&"Person"!==o||"team_members"!==n.options.config.name||s.unshift(this.getViewProfileButtonConfig(n)),e.is(this.model.updateDocument,"function")){var c=this.getUpdateButton(n);s.splice(2,0,c)}return i.isUrl&&s.unshift({text:f("E6WCommonUI.Label.Edit"),id:"EditURL",fonticon:"fonticon fonticon-pencil",disabled:!a.hasAccess("3DSpace"),handler:this._attachUrlToObject.bind(this,i)}),s},shouldDisable:function(e){return e._hasViewAccess?!e._hasViewAccess:e.get("memberPersonModel")?!e.get("memberPersonModel")._hasViewAccess:void 0},getUpdateButton:function(e){var t=this,i=e.model,n=this.normalizedGet(e.model,"hasfiles");return n=!0===n||"TRUE"===n,{text:f("E6WCommonUI.Label.Update"),id:"documentUpdateButton",fonticon:"update",className:n?null:"disabled",handler:function(){e.documentUpdateHandler?e.documentUpdateHandler(i,t.model.updateDocument):o.openFileExplorer({callback:function(e){o.updateDocumentConfirmation(e,i,t.model.updateDocument)}})}}},removeItemButtonHandler:function(e){this.model.remove(this._config.name,e.index,e.options)},getRemoveItemButton:function(e){var t=this.canReadWrite();let i=e&&e.isUrl;return t||(t=!1),{text:f(i?"E6WCommonUI.Label.Delete":"E6WCommonUI.Label.Remove"),name:"remove-button",fonticon:i?"trash":"remove",className:this.normalizedGet(this.model,"canEdit")&&t?null:"disabled hidden",handler:this.removeItemButtonHandler.bind(this,e)}},getPropertiesButton:function(e){var t=this;return{text:f("E6WCommonUI.Label.Properties"),fonticon:"attributes",handler:function(){t.objectClick(e.event,e)},name:"propertiesButton"}},getDownloadButton:function(e){var t=this;return{text:f("E6WCommonUI.Label.Download"),fonticon:"download",className:e.canDownload?null:"disabled",handler:function(){t.objectClickDownload(e.event,e.model)},name:"downloadButton"}},getShowMembersButton:function(e,t){var i;return e.model&&(i=this.shouldDisable(e.model)?"disabled":null),{text:o.i18n("E6WCommonUI.Label.ShowMembers"),fonticon:"users-group",className:i,handler:function(){var i=e.model.get("physicalId")||e.model.id;e.model&&["Group","Group Proxy"].indexOf(e.model.get("type"))>-1&&(i=e.model.get("groupURI")),o.launchPreviewGroupMembers(i,t)},name:"showMembersButton"}},destroy:function(){this.dropdownMenu&&this.dropdownMenu.destroy(),this._clearDummyCard(),this._tooltips.forEach(function(e){e.destroy()}),this._tooltips=[],this._parent.apply(this,arguments)},getGroupViewerContainer:function(){return this._parentView._parentView._parentView.container},addOpenAndOpenWith:Function.prototype});return E.prototype.modelHasViewAccess=v,E.prototype.compiledTemplate=g,E}),define("DS/E6WCommonUI/Views/MultiObjectCardView",["UWA/Core","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/Views/E6WHandlebarsHelpers","DS/E6WCommonUI/Views/ObjectCardView","DS/Handlebars/Handlebars4","DS/RDFFoundation/MemberUtils","DS/UIKIT/Tooltip","text!DS/E6WCommonUI/assets/templates/multiObjectCard.html.handlebars","text!DS/E6WCommonUI/assets/templates/multiEditField.html.handlebars","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS"],function(e,t,i,n,a,o,s,r,l,d){"use strict";var c=function(e){return d.get(e)},u=a.compile(r),h=a.compile(l),m=n.extend({_uwaClassName:"MultiObjectCardView",domEvents:{"click button.clear-all":"_clearAll"},_clearAll:function(){this.model.removeAllValues(this._config.name)},getDataIdFromElement:function(e){return e.getAttribute("data-id")},getDataIdFromObjectClick:function(e){var t=e.getClosest(".object-card");return this.getDataIdFromElement(t)},getModelFromCard:function(e){var t=this.getDataIdFromElement(e),i=this,n=this.getObjectsArray();let a=n;return n.forEach&&n.forEach(function(e){i._normalizedGetPhysicalId(e)!==t&&i.normalizedGet(e,"groupURI")!==t||(a=e)}),a},render:function(t){var n=e.clone(t||{},!1).data;n=this._getData(n);let o=this.getObjectsArray(),r=Array.from(new Set(o.map(JSON.stringify))).map(JSON.parse);if(n.canEdit&&this._config.readWrite||1===r.length){this._parent.apply(this,arguments);var l=this.getElements(".fonticon-down-open");const e=this.getElement("#clearAllButton");0===l.length&&e&&e.toggleClassName("disabled",!0),e&&this._tooltips.push(new s({target:e,body:c("E6WCommonUI.Label.ClearAll")}));let t=this.getElement("#assignToSelfItem");t&&(this._config.readWrite&&!this.model.canAssignToSelf(this.model.get(this._config.name))||t.toggleClassName("disabled",!0))}else{var u=i.i18n;i.i18n=d.get.bind(d);let e="",t=[];if(0===r.length)e="--";else{for(let e=0;e<r.length;e++){let i=r[e];"object"==typeof i&&(i.label&&(i=i.label),i.displayValue&&(i=i.displayValue)),t.push(i)}e=c("E6WCommonUI.Label.MutipleValues")}n.values=e,n.labels=t?t.join(", "):"",n.canEdit=!1;let o=this._config,s=h(o);o.readOnlyTemplate=a.compile(s),this.container.setHTML(o.readOnlyTemplate({values:e,labels:t?t.join(", "):""})),i.i18n=u}},getUniquePersonValues:function(e){var t=this;let i=[];return e.forEach(function(e){i.some(function(i){return t.isSameUser(e,i)})||i.push(e)}),i},getUpdatedCommonValues:function(e,t){var i=this;if(!t)return[];if(0===e.length)t.forEach(function(t){e.push(t)});else{let n=[];e.forEach(function(e){t.some(function(t){return i.isSameUser(e,t)})&&n.push(e)}),e=n}return e},isSameUser:function(e,t){return this.getIdFromDataValue(e)===this.getIdFromDataValue(t)},setReadOnlyConfiguredTemplate:function(){var e=i.i18n;i.i18n=d.get.bind(d);var t=this._config;t.viewId="_"+this.cid;var n=h(t);t.template=a.compile(n),i.i18n=e},readOnlyTemplate:function(e){this.setReadOnlyConfiguredTemplate();var t=e.data;return h(t)},template:function(e){var t=this;this.data=e.data;var n=i.i18n;i.i18n=d.get.bind(d),this.data.forEach(function(e){t.commonValues.some(function(i){return t.isSameUser(i,e)})&&(e.appliesToAll=!0)});let a={};a[t._config.name]=this.data,this.data.canEdit&&(a.canEdit=this.data.canEdit);var o=this._config.template(a);return i.i18n=n,o},getObjectsArray:function(){return this.normalizedGet(this.model,this._config.name)||[]},getDataOptions:function(){var e;return this._config.accPointsName&&(e={attributes:[this._config.name,this._config.accPointsName,"canEdit"],level:0}),(e={attributes:[this._config.name,"canEdit"],level:0}).level=1,e.attributes.push("physicalId",this._config.attributeToDisplay,this._config.imageAttribute,"busType","type","hasfiles"),e},_getData:function(e){var i=e;if(!e&&this.model){var n=this.getDataOptions();i=t.normalizedToJson(this.model,n)}let a=i.every(function(e){return e.canEdit}),o=[],s=[],r=!0,l=this._config.singleObjectOnly;for(let e=0;e<i.length;e++){let t=i[e][this._config.name];t&&(t.canEdit=i[e].canEdit),r&&0===(s=l?this.getUpdatedCommonValues(s,[t]):this.getUpdatedCommonValues(s,t)).length&&(r=!1),Array.isArray(t)?o=o.concat(t):t&&o.push(t)}return this.commonValues=s,(o=this.getUniquePersonValues(o)).canEdit=a,o},getExistingObjs:function(e){let t=[],i=this.model.get(e);return Array.isArray(i)?t=t.concat(i):t.push(i),t},_getMinLengthBeforeSearch:function(){return 2},_onClickObjectField:function(t){if(t.preventDefault&&t.preventDefault(),!t.clickedOnObject){var i=e.Event.getElement(t).getClosest("li");this.deactivateAllListElements(i),i&&i.addClassName("active")}},getRemoveItemButton:function(){let e=this._parent.apply(this,arguments);return this._config.disableRemove&&(e.className="disabled hidden"),e},removeItemButtonHandler:function(e){let t=this.data[e.index],i=this.getIdFromDataValue(t);this.model.removeById(this._config.name,i,e.options)},getMenuItems:function(e){var t=[this.getRemoveItemButton(e)];return this._config.singleObjectOnly?this._config.readWrite&&t.splice(0,0,this.getReplaceAllButton(e)):t.splice(0,0,this.getPropagateButton(e),this.getReplaceAllButton(e)),t},_showDropDownMenu:function(e){this._parent(e,!0)},getPropagateButton:function(e){var t=this,i=this.canReadWrite();return i||(i=!1),{text:c("E6WCommonUI.Label.Propagate"),name:"propagate-button",fonticon:"propagate",disabled:this.data[e.index].appliesToAll||!1,className:t.normalizedGet(t.model,"canEdit")&&i?null:"disabled hidden",handler:function(){let i=t.getTargetObjectModel(e);t.model.add(t._config.name,i,e.options)}}},getIdFromDataValue:function(e){let t;return t=e.resourceUid?e.resourceUid.startsWith("<")?e.resourceUid.slice(1,-1):o.addUUIDToURI(e.resourceUid):e.physicalId?e.physicalId.startsWith("<")?e.physicalId.slice(1,-1):e.physicalId:e["@id"]?e["@id"]:e.id},getTargetObjectModel:function(e){let t=this.data[e.index],i=this.getIdFromDataValue(t);return this.getObjectsArray(this._config.name).find(function(e){return e.id===i})},getReplaceAllButton:function(e){var t=this,i=this.canReadWrite();return i||(i=!1),{text:c("E6WCommonUI.Label.ReplaceAll"),name:"replaceall-button",disabled:t.data&&1===t.data.length,fonticon:"replace",className:t.normalizedGet(t.model,"canEdit")&&i?null:"disabled hidden",handler:function(){let i=t.getTargetObjectModel(e);t._config.singleObjectOnly?t.model.replaceSingleValue(t._config.name,i,e.options):t.model.replaceAll(t._config.name,i,e.options)}}},getCardById:function(e){return this.container.getElement('div[data-id="'+e+'"]')}});return m.prototype.compiledTemplate=u,m}),define("DS/E6WCommonUI/Views/StartStopView",["UWA/Core","DS/Handlebars/Handlebars4","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/DateView","text!DS/E6WCommonUI/assets/templates/startstop.html.handlebars"],function(e,t,i,n,a){"use strict";var o=t.compile(a),s=n.extend({_uwaClassName:"E6WCommonUIStartStopView",tagName:"div",name:"E6WCommonUI.StartStopView",_highlightValidationErrors:function(){if(this.model&&this.model.validationError&&this.model.validationError.fields){var e=this._config,t=!1,i=this.container,n=e.name;-1!==this.model.validationError.fields.indexOf(n)&&(t=!0);var a=i&&i.getElement(".start");a&&a.toggleClassName("has-error",t),t=!1,n=e.endDateAttribute,-1!==this.model.validationError.fields.indexOf(n)&&(t=!0);var o=i&&i.getElement(".stop");o&&o.toggleClassName("has-error",t)}},template:function(){var e=arguments[0].data;return e&&!0===e.canEdit&&this.setEditFlagOnFields(e),this._parent.apply(this,arguments)},setEditFlagOnFields:function(t){var i=!0;this._config.hasOwnProperty("canEditStartDate")&&(i=e.is(this._config.canEditStartDate,"function")?this._config.canEditStartDate(this.model):this._config.canEditStartDate),t.canEditStartDate=i,i=!0,this._config.hasOwnProperty("canEditEndDate")&&(i=e.is(this._config.canEditEndDate,"function")?this._config.canEditEndDate(this.model):this._config.canEditEndDate),t.canEditEndDate=i},moveLabelPosition:function(e){var t;t=this.container.getElement(".input-group.start");var i=this.container.getElement(".start label");t&&i&&t.grab(i,e),t=this.container.getElement(".input-group.stop");var n=this.container.getElement(".stop label");t&&n&&t.grab(n,e)},render:function(){return this._parent.apply(this,arguments),this._config.hasOwnProperty("labelPosition")&&"top"===this._config.labelPosition&&this.moveLabelPosition("top"),this}});return s.prototype.compiledTemplate=o,s}),define("DS/E6WCommonUI/Views/DetailsDisplayView",["UWA/Core","UWA/Utils","UWA/Event","UWA/Class/Model","UWA/Class/Events","UWA/Controls/Drag","DS/Handlebars/Handlebars4","DS/ENO6WPlugins/jQuery_3.3.1","DS/E6WCommonUI/Views/FoundationBaseView","DS/E6WCommonUI/Views/TextView","DS/E6WCommonUI/Views/TextAreaView","DS/E6WCommonUI/Views/SelectView","DS/E6WCommonUI/Views/ToggleView","DS/E6WCommonUI/Views/CheckBoxView","DS/E6WCommonUI/Views/DateView","DS/E6WCommonUI/Views/NumberView","DS/E6WCommonUI/Views/ObjectView","DS/E6WCommonUI/Views/PersonView","DS/E6WCommonUI/Views/RangeView","DS/E6WCommonUI/Views/StartStopView","DS/E6WCommonUI/Views/UomView","DS/E6WCommonUI/Views/E6WHandlebarsHelpers","DS/E6WCommonUI/UIHelper","DS/E6WCommonUI/Views/DetailsDisplaySharedView","DS/E6WCommonUI/E6WCommonUIConstants","text!DS/E6WCommonUI/assets/templates/meta.html.handlebars","i18n!DS/E6WCommonUI/assets/nls/E6WCommonUINLS","css!DS/E6WCommonUI/E6WCommonUI","css!DS/UIKIT/UIKIT"],function(e,t,i,n,a,o,s,r,l,d,c,u,h,m,p,f,g,v,E,D,_,w,C,b,y,T,S){"use strict";return C.fixDisplayMessageMethod(),l.extend({_uwaClassName:"DetailsDisplayView",getHtmlFromTemplate:s.compile(T),className:"ds-dialog ds-detail-display ddv-view",id:function(){return"detailDisplayView"+this.cid},domEvents:{"click .form-section-title":"_showGroupProperties"},i18n:function(e,t){return t||e},_displayMessage:function(e){this._options.displayMessage?this._options.displayMessage.apply(this,arguments):C.displayMessageBasedOnType(e)},setup:function(t){var i=e.clone(t||{},!1);this._options=i,this._parent.apply(this,arguments);var n=this;document.body.addEventListener("click",function(t){if(n._config)for(var i=e.Event.getElement(t),a=n._getConfigFromElement(i),o=n._config.length,s=0;s<o;s++){var r=n._config[s];switch(r.type){case"object":case"person":var l=n._getChildViewBasedOnConfig(r);l&&e.is(l.checkDialogDeactivation,"function")&&l.checkDialogDeactivation(r,a)}}})},getChildViewBasedOnConfig:function(e){for(var t,i=this._childrenViews,n=0;n<i.length;n++){var a=i[n];if(a._config&&a._config.type===e.type&&a._config.name===e.name){t=a;break}}return t},_getChildViewBasedOnConfig:function(e){return this._configMap.get(e)},_resizeHandler:function(){var e=this;!function(){var t=e.container.clientWidth,i=e._config.length,n=0!==t&&t!==e.previousResizeWidth;n&&(e.previousResizeWidth=t);for(var a=0;a<i;a++){var o=e._config[a];switch(o.type){case"text":if(n&&("boolean"==typeof o.readWrite&&o.readWrite||"true"===o.readWrite)&&b.prototype.normalizedGet(e.model,"canEdit")){var s=e._getChildViewBasedOnConfig(o);s&&s._postTreatmentTextArea()}break;case"textarea":if(n){var r=e._getChildViewBasedOnConfig(o);r&&r._postTreatmentTextArea()}}}}()},_dataForRenderingWithWhiteListAttributes:function(){var t=[],i={};this._childrenViews.forEach(function(e){var i=e.getDataOptions(),n=t[i.level];n||(n=t[i.level]={}),i.attributes.forEach(function(e){n[e]=!0})});for(var n=0;n<t.length;n++){var a=t[n];a&&e.extend(i,C.normalizedToJson(this.model,{level:n,attributes:Object.keys(a)}))}return i},_setChildViews:function(t){var i=this._childrenViews;if(i)for(var n=this._dataForRenderingWithWhiteListAttributes(),a=0;a<i.length;a++){var o=i[a],s=o._config;o.model||(o.model=this.model);var r={data:n};e.merge(r,t),o.render(r),this.injectFieldViewForConfig(s,o)}},injectFieldViewForConfig:function(e,t){var i=e.group?e.group.actualValue||e.group:void 0;i?t.inject(this.container.getElement("#_"+this.cid+this.groupMap[i].actualValue+" .form-section-body")):this.container.getElement(".form-section")&&e.name!==y.USER_TAGS?t.inject(this.container.getElement(".form-section"),"before"):t.inject(this.container.getElement(".form.form-vertical"))},_template:function(e){for(var t=0;t<this._config.length;t++){var i=this._config[t];if(i.required&&!i.hideRequiredLegend){e.required=!0,e.requiredLegend=S.get("emxFoundation.Label.RequiredFieldLegend");break}}return Object.keys(this.groupMap).length>0&&(e.groupNames=this.groupMap,e.viewid="_"+this.cid),this.getHtmlFromTemplate(e)},_filterConfigIntoGroups:function(){for(var e=this._config,t={},i=0;i<e.length;i++){var n=e[i],a=n.group?n.group.actualValue||n.group:void 0;if(a){var o=t[a];o?a&&o.push(n):(t[a]=[n],t[a].displayValue=a,t[a].actualValue="G"+i)}}return t},render:function(e){var t;if(!this._config)return this;t=this.getElements(".accordion.expanded").map(function(e){return e.id});var i={};return i.openedGroups=t,this.container.setHTML(this._template(i)),this._setChildViews(e),this.dispatchEvent("onFinishRender"),delete this.previousResizeWidth,this.container.isInjected()?this._resizeHandler():this.listenToOnce(this,"onPostInject",this._resizeHandler),this._toggleGroups(t,!0),this},setConfig:function(t){this._config=t.map(function(t){return e.clone(t,!1)}),this._config.options=e.clone(t.options||{},!1),this.groupMap=this._filterConfigIntoGroups(),delete t.options,this.cleanUpChildren();for(var i=0;i<this._config.length;i++){var n=this._config[i];n.index=i;var a=e.clone(this._options||{},!1);e.extend(a,{config:n,model:this.model}),this._createAndAddChildView(n,a)}},cleanUpChildren:function(){return this._configMap=new WeakMap,this._parent.apply(this,arguments)},_createAndAddChildView:function(t,i){var n,a=e.clone(i||{},!1);if(a.detailDisplayViewId="#"+(e.is(this.id,"function")?this.id():this.id),delete a.parentView,t.customView)n=new t.customView(a);else switch(t.type){case"text":n=new d(a);break;case"textarea":n=new c(a);break;case"select":n=new u(a);break;case"toggle":n=new h(a);break;case"checkbox":n=new m(a);break;case"date":n=new p(a);break;case"number":n=new f(a);break;case"object":n=new g(a);break;case"person":n=new v(a);break;case"range":n=new E(a);break;case"startStop":n=new D(a);break;case"uom":n=new _(a)}n&&(this._configMap.set(t,n),this.addChildView(n),this.listenTo(n,b.events.menuOpened,function(e){this.dropdownMenu&&this.dropdownMenu.destroy(),this.dropdownMenu=e}))},resetModel:function(t,i,n){var a=e.clone(n||{},!1);if(t!==this.model){var o=this.getElements(".accordion.expanded").map(function(e){return e.id});this._toggleGroups(o,i);var s=this._childrenViews;if(s)for(var r=0;r<s.length;r++)s[r].resetModel(t);this.model=t,!a.noRender&&this.render()}},_toggleGroups:function(e,t){var i=this;e&&e.forEach(function(e){e&&e.length>0&&i.getElement("#"+e).toggleClassName("expanded",t)})},destroy:function(){delete this._configMap,this._parent()},_showGroupProperties:function(t){var i=e.Event.getElement(t);e.extendElement(i.parentElement).toggleClassName("expanded")},_getConfigFromElement:function(e){var t,i=e.getClosest(".ddv-field");if(i){var n=i.getAttribute("data-field-index");n=parseInt(n,10),t=this._config[n]}return t},isModelValid:function(){for(var e=this._config,t=0;t<e.length;t++)if(e[t].required&&!b.prototype.normalizedGet(this.model,e[t].name))return!1;return!0},getFieldViewByName:function(e){var t;return this._childrenViews.some(function(i){return i._config.name===e&&(t=i,!0)}),t},dispatchScrollToElementEvent:function(e){this.dispatchEvent("scrollToElement",e)},handleParentScroll:function(){this.dispatchEvent("onScroll")}})}),define("DS/E6WCommonUI/Views/MultiDetailsDisplayView",["UWA/Core","DS/E6WCommonUI/Views/DetailsDisplayView","DS/E6WCommonUI/Views/MultiPriorityView","DS/E6WCommonUI/Views/MultiStartStopView","DS/E6WCommonUI/Views/MultiEditFieldView","DS/E6WCommonUI/UIHelper"],function(e,t,i,n,a,o){"use strict";var s=["object","dependencies","userTags","RichText","textarea","checkbox","dsplan:storyPoints","actualDuration"];return t.extend({_uwaClassName:"MultiDetailsDisplayView",_createAndAddChildView:function(t,i){var n,o=e.clone(i||{},!1);o.detailDisplayViewId="#"+(e.is(this.id,"function")?this.id():this.id),delete o.parentView,s.includes(t.type)||s.includes(t.name)||(t.readWrite?n=t.multiCustomView?new t.multiCustomView(o):new a(o):"startStop"===t.type?n=!t.disableMultiEdit&&t.multiCustomView&&new t.multiCustomView(o):t.multiCustomView?n=new t.multiCustomView(o):("text"===t.type&&!t.neverEditable||"uom"===t.type)&&(n=new a(o)),n&&(n.dateViews?n.dateViews.length>0?n.dateViews.forEach(e=>{this._configMap.set(e._config,e),this.addChildView(e)}):this.groupMap.More&&(this.groupMap={}):(this._configMap.set(t,n),this.addChildView(n))))},injectFieldViewForConfig:function(e,t){let i=t.container?t.container:t;this._parent(e,i)},_dataForRenderingWithWhiteListAttributes:function(){var t=[],i=[];this._childrenViews.forEach(function(e){var i=e.getDataOptions(),n=t[i.level];n||(n=t[i.level]={}),i.attributes.forEach(function(e){n[e]=!0})});for(var n=0;n<t.length;n++){var a=t[n];if(a)if(0===i.length)i=i.concat(o.normalizedToJson(this.model,{level:n,attributes:Object.keys(a)}));else{let t=o.normalizedToJson(this.model,{level:n,attributes:Object.keys(a)});for(let n=0;n<t.length;n++){let a=i[n];e.extend(a,t[n])}}}return i}})});