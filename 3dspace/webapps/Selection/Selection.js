define("DS/Selection/XSO",["require","exports","DS/CoreEvents/ModelEvents","UWA/Core","DS/Utilities/WUXUWAUtils"],function(t,e,n,i,s){"use strict";var o="/WEBAPP/",h=-1,r=function(){function t(){this.buckets={}}return t.prototype.add=function(t){var e=t.hash(),n=this.buckets[e];if(n){for(var i=!1,s=0;s<n.length;++s)n[s].isEqual(t)&&(i=!0);i||n.push(t)}else(n=[]).push(t),this.buckets[e]=n},t.prototype.remove=function(t){var e=t.hash(),n=this.buckets[e];if(n){for(var i=!1,s=0;s<n.length;++s)if(n[s].isEqual(t)){i=!0,n.splice(s,1);break}return i}},t.prototype.contains=function(t){var e=t.hash(),n=this.buckets[e];if(n){for(var i=!1,s=0;s<n.length;++s)n[s].isEqual(t)&&(i=!0);return i}return!1},t.prototype.empty=function(){this.buckets={}},t}();return function(){function t(t){s.extendingClassFlag||(this.options={areEquals:function t(e,n){if(e&&e.pathElement&&n&&n.pathElement)return e.pathElement.isEqual(n.pathElement);if(e instanceof Function)return n instanceof Function&&e.toString()===n.toString();if(null==e||null==n)return e===n;if(e===n)return!0;if("function"==typeof e.valueOf&&"function"==typeof n.valueOf&&e.valueOf()===n.valueOf())return!0;if(e instanceof Date)return!1;if(n instanceof Date)return!1;if(!(e instanceof Object&&n instanceof Object))return!1;var i=Object.keys(e);return!!Object.keys(n).every(function(t){return-1!==i.indexOf(t)})&&i.every(function(i){return t(e[i],n[i])})},useUniqueID:!1,publishOnlyPrePostEvents:!1},i.extend(this.options,t),this._modelEvents=new n,this._xsoUuid=i.Utils.getUUID(),this.options.useUniqueID?this._items={}:this._items=[],this.hashSetPathElement=new r,this.init.apply(this,arguments))}return t.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype._getXsoID=function(t){return void 0!==t.__xso__?t.__xso__[this._xsoUuid]:void 0},t.prototype._setXsoID=function(t,e){void 0===t.__xso__&&(t.__xso__={}),t.__xso__[this._xsoUuid]=e},t.prototype._subscribe=function(t){var e={event:"",arrayOutput:!1,callback:null};if(i.extend(e,t),e.callback){var n=o+this.options.eventChannel+e.event;return this._modelEvents.subscribe({event:n},function(t){if(e.arrayOutput){var n=[];Array.isArray(t)?n.concat(t):n.push(t),e.callback&&e.callback.call(window,n)}else e.callback&&e.callback.call(window,t)})}},t.prototype.unsubscribe=function(t){return this._modelEvents.unsubscribe(t)},t.prototype.get=function(){if(this.options.useUniqueID){if(!this._cachedItems||this._needUpdateCachedItems){var t=this;this._cachedItems=Object.keys(this._items).map(function(e){return t._items[e]}),this._needUpdateCachedItems=!1}return this._cachedItems}return this._items},t.prototype.isIn=function(t){var e=!1,n=this;if(this.options.useUniqueID){if(this.options.getElementID){var i=this.options.getElementID(t);if(null!=i)return void 0!==this._items[i];throw"XSO: getElementID return something null or undefined"}return void 0!==this._getXsoID(t)}return t&&t.pathElement?this.hashSetPathElement.contains(t.pathElement):(this._items.forEach(function(i){n.options.areEquals(i,t)&&(e=!0)}),e)},t.prototype.isEmpty=function(){if(this.options.useUniqueID){for(var t in this._items)if(Object.prototype.hasOwnProperty.call(this._items,t))return!1;return!0}return!(this._items.length>0)},t.prototype.isBeingEmptied=function(){return this._isBeingEmptied},t.prototype.empty=function(t){var e=[];if(!this.isEmpty()){void 0===t&&(t=!0);if(this._modelEvents.publish({event:o+this.options.eventChannel+"PRE_REMOVE",data:this.get()}),t&&this._modelEvents.publish({event:o+this.options.eventChannel+"PRE_EMPTY",data:this.get()}),this.options.useUniqueID){for(var n in this._isBeingEmptied=!0,this._items){var i=this._items[n];e.push(i),void 0!==i&&this.remove(i)}this._isBeingEmptied=!1}else{for(;this._items.length;){i=this._items.shift();e.push(i),this._modelEvents.publish({event:o+this.options.eventChannel+"REMOVE",data:i}),this._modelEvents.publish({event:o+this.options.eventChannel+"UPDATE",data:i})}this.hashSetPathElement.empty()}this._modelEvents.publish({event:o+this.options.eventChannel+"POST_REMOVE",data:e}),t&&this._modelEvents.publish({event:o+this.options.eventChannel+"EMPTY",data:null})}},t.prototype.unique=function(t){this.options.useUniqueID?(!this.isIn(t)||this.get().length>1)&&(this.empty(!0),this.add(t)):(!this.isIn(t)||this.get().length>1)&&(this.empty(!1),this.add(t))},t.prototype._addUnit=function(t,e){var n=!0;if(this.options.useUniqueID)if(n=!1,this.options.getElementID){var i=this.options.getElementID(t);if(null==i)throw"XSO: getElementID return something null or undefined";void 0===this._items[i]&&(this._needUpdateCachedItems=!0,this._items[i]=t,e.call(this,t),n=!0)}else{var s=this._getXsoID(t);void 0===s&&void 0===this._items[s]&&(this._needUpdateCachedItems=!0,h++,this._setXsoID(t,h),this._items[h]=t,e.call(this,t),n=!0)}else{if(t&&t.pathElement)n=!this.hashSetPathElement.contains(t.pathElement);else for(var o=0;o<this._items.length;o++){var r=this._items[o];if(this.options.areEquals(r,t)){n=!1;break}}n&&(t&&t.pathElement&&this.hashSetPathElement.add(t.pathElement),this._items.push(t),e.call(this,t))}return n},t.prototype.add=function(t){var e=[],n=this,i=function(t){n.options.publishOnlyPrePostEvents||(n._modelEvents.publish({event:o+n.options.eventChannel+"ADD",data:t}),n._modelEvents.publish({event:o+n.options.eventChannel+"UPDATE",data:t}))};this._modelEvents.publish({event:o+n.options.eventChannel+"PRE_ADD",data:t}),Array.isArray(t)?t.forEach(function(t){n._addUnit(t,i)&&e.push(t)}):n._addUnit(t,i)&&e.push(t),this._modelEvents.publish({event:o+n.options.eventChannel+"POST_ADD",data:e})},t.prototype._removeUnit=function(t,e){var n=this,i=!1;if(this.options.useUniqueID)if(this.options.getElementID){var s=this.options.getElementID(t);if(null==s)throw"XSO: getElementID return something null or undefined";void 0!==this._items[s]&&(this._needUpdateCachedItems=!0,delete this._items[s],e.call(this,t),i=!0)}else{var o=this._getXsoID(t);void 0!==o&&void 0!==this._items[o]&&(this._needUpdateCachedItems=!0,delete this._items[o],this._setXsoID(t,void 0),e.call(this,t),i=!0)}else t&&t.pathElement&&(i=this.hashSetPathElement.remove(t.pathElement)),this._items.some(function(s,o){if(n.options.areEquals(s,t))return n._items.splice(o,1),e.call(this,t),i=!0,!0});return i},t.prototype.remove=function(t){var e=[],n=this,i=[];Array.isArray(t)?t.forEach(function(t){i.push(t)}):i.push(t),this._modelEvents.publish({event:o+n.options.eventChannel+"PRE_REMOVE",data:i});var s=function(t){n.options.publishOnlyPrePostEvents||(n._modelEvents.publish({event:o+n.options.eventChannel+"REMOVE",data:t}),n._modelEvents.publish({event:o+n.options.eventChannel+"UPDATE",data:t}))};Array.isArray(t)?t.forEach(function(t){n._removeUnit(t,s)&&!n._isBeingEmptied&&e.push(t)}):n._removeUnit(t,s)&&!n._isBeingEmptied&&e.push(t);this._isBeingEmptied||this._modelEvents.publish({event:o+n.options.eventChannel+"POST_REMOVE",data:e})},t.prototype.onChange=function(t,e){return this._subscribe({event:"UPDATE",arrayOutput:!(!e||!e.arrayOutput)&&e.arrayOutput,callback:t})},t.prototype.onAdd=function(t){if(t)return this._modelEvents.subscribe({event:o+this.options.eventChannel+"ADD"},function(e){t.call(window,e)})},t.prototype.onPreAdd=function(t){if(t)return this._modelEvents.subscribe({event:o+this.options.eventChannel+"PRE_ADD"},function(e){t.call(window,e)})},t.prototype.onPostAdd=function(t){if(t)return this._modelEvents.subscribe({event:o+this.options.eventChannel+"POST_ADD"},function(e){t.call(window,e)})},t.prototype.onPreRemove=function(t){if(t)return this._modelEvents.subscribe({event:o+this.options.eventChannel+"PRE_REMOVE"},function(e){t.call(window,e)})},t.prototype.onPostRemove=function(t){if(t)return this._modelEvents.subscribe({event:o+this.options.eventChannel+"POST_REMOVE"},function(e){t.call(window,e)})},t.prototype.onUpdate=function(t){t&&(this.onEmpty(t),this.onRemove(t),this.onAdd(t))},t.prototype.onRemove=function(t){if(t)return this._modelEvents.subscribe({event:o+this.options.eventChannel+"REMOVE"},function(e){t.call(window,e)})},t.prototype.onEmpty=function(t){if(t)return this._modelEvents.subscribe({event:o+this.options.eventChannel+"EMPTY"},function(e){t.call(window,e)})},t.prototype.onPreEmpty=function(t){if(t)return this._modelEvents.subscribe({event:o+this.options.eventChannel+"PRE_EMPTY"},function(e){t.call(window,e)})},t.extend=s.extend,t.singleton=s.singleton,t}()}),define("DS/Selection/CSOManager",["UWA/Core","UWA/Event","DS/CoreEvents/Events","DS/Selection/XSO"],function(t,e,n,i){"use strict";var s=i.singleton({init:function(t){t={eventChannel:"CSO/"},this._parent(t)}});return t.namespace("WUX/Selection/CSOManager",s)}),define("DS/Selection/HSOManager",["UWA/Core","UWA/Event","DS/CoreEvents/Events","DS/Selection/XSO"],function(t,e,n,i){"use strict";var s=i.singleton({init:function(t){t={eventChannel:"HSO/"},this._parent(t)}});return t.namespace("WUX/Selection/HSOManager",s)}),define("DS/Selection/PSOManager",["UWA/Core","UWA/Event","DS/CoreEvents/Events","DS/Selection/XSO"],function(t,e,n,i){"use strict";var s=i.singleton({init:function(t){t={eventChannel:"PSO/"},this._parent(t)}});return t.namespace("WUX/Selection/PSOManager",s)});