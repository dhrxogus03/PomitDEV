function ReplaceWithPolyfill(){var e,t=this.parentNode,n=arguments.length;if(t)for(n||t.removeChild(this);n--;)"object"!=typeof(e=arguments[n])?e=this.ownerDocument.createTextNode(e):e.parentNode&&e.parentNode.removeChild(e),n?t.insertBefore(this.previousSibling,e):t.replaceChild(e,this)}define("DS/LifecycleServices/NotificationPublish",["UWA/Core","DS/PlatformAPI/PlatformAPI"],function(e,t){"use strict";return{publish:function(n,r){var i;i=e.is(r,"string")?r:JSON.stringify(r),t.publish(n,i),t.publish("webinwin:web:notification",i)}}}),define("DS/LifecycleServices/LifecycleServicesSettings",["UWA/Class","UWA/Class/Options","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/PlatformAPI/PlatformAPI","DS/WAFData/WAFData"],function(e,t,n,r,i){"use strict";var o,s={CATIAV5:{name:"CATIAV5",require:"DS/ENOXCADCATIAV5UI/ENOXCADFileNameValidation"}},a=null;require(["DS/CfgAuthoringContextUX/scripts/CfgAuthoringContext"],function(e){o=e});var c=e.singleton(t,{folder_json:null,tenant:"",options:{wintop:!1},init:function(e){this._parent(),this._roles=null},instance:function(){return this},getTenant:function(){return this.tenant},setTenant:function(e){this.tenant=e},getInstance:function(e){try{this.init(e)}catch(e){}for(var t in e)this.options[t]=e[t];return this},get3DSpaceUrl:function(e){var t=location.protocol+"//"+location.hostname;return e&&(e.serverUrl=t,e.serverUri="3DSpace"),t+"/3DSpace"},get3DSpaceBaseUrl:function(e){if(!UWA.is(this.getOption("platform_services"),"array"))throw new Error("Platform services not initialize yet");var t;try{for(var n=0;n<this.getOption("platform_services").length;n++)if(this.getOption("platform_services")[n].platformId==e){t=this.getOption("platform_services")[n]["3DSpace"];break}}catch(e){t=this.get3DSpaceUrl()}return t},get3DSpaceWSUrl:function(e,t,n){e&&""!=e||(e=widget.getValue("x3dPlatformId")||"OnPremise");var r=this.get3DSpaceBaseUrl(e)+t+(t.indexOf("?")<0?"?":"&")+"tenant="+e;return null!=n&&null!=n&&(r=r+"&"+n),r},getServerURL:function(){var e="";return n.getPlatformServices({onComplete:function(t){e=t[0]["3DSpace"]}}),e},getPlatformUrl:function(e,t){var n=location.protocol+"//"+location.hostname,r=e;return t&&(t.serverUrl=n,t.serverUri=r),n+"/"+r},getPlatformBaseUrl:function(e,t){if(!UWA.is(this.getOption("platform_services"),"array"))throw new Error("Platform services not initialize yet");var n;try{for(var r=0;r<this.getOption("platform_services").length;r++)if(this.getOption("platform_services")[r].platformId==t){n=this.getOption("platform_services")[r][e];break}}catch(e){n=this.getPlatformUrl()}return n},getPlatformWSUrl:function(e,t,n,r){null!=t&&null!=t&&""!=t||(t="OnPremise");var i=this.getPlatformBaseUrl(e,t)+n+"?tenant="+t;return null!=r&&null!=r&&(i=i+"&"+r),i},app_initialization:function(e,t){var r=this,i=!1;try{UWA.is(this.getOption("platform_services"),"array")||(i=!0)}catch(e){i=!0}i?t?(r.setOption("platform_services",t),e()):n.getPlatformServices({onComplete:function(t){r.setOption("platform_services",t),void 0!==window.widget&&window.widget&&void 0!==window.widget.getValue("x3dPlatformId")&&window.widget.getValue("x3dPlatformId")&&window.widget.getValue("x3dPlatformId").trim().length>0?r.tenant=window.widget.getValue("x3dPlatformId"):r.tenant=t[0].platformId,r.getEnforceFolderLinkSetting(),e()},onFailure:function(t){e()}}):e()},setFolderCommunicationChannel:function(e){e&&e.getCurrentFolder&&this.setCurrentFolder(e.getCurrentFolder()),r.subscribe("FolderEditor.CurrentFolder",this.setCurrentFolder.bind(this)),r.subscribe("FolderEditor.ActiveFolder",function(e){void 0===e.origin?a=e:widget.id===e.origin&&""==(a=e).id&&(a.id=null),require(["DS/LifecycleServices/LifecycleServicesSettings"],function(e){e.getActiveFolder=function(){return a}})}),require(["DS/PlatformAPI/PlatformAPI"],function(e){e.publish("FolderEditor.ActiveFolderCallBack",null)})},setCurrentFolder:function(e){this.folder_json=JSON.parse(e)},getCurrentFolderID:function(){return null!=this.folder_json&&this.folder_json.hasOwnProperty("FolderID")?this.folder_json.FolderID:null},getCurrentFolderSecurityContext:function(){return null!=this.folder_json&&this.folder_json.hasOwnProperty("SecurityContext")?this.folder_json.SecurityContext:null},hasPARRole:function(e){var t=this;void 0===t._hasPARRole?(t._hasPARRole=!1,this.hasRole(n=>{t._hasPARRole=n,e(t._hasPARRole)},["InternalDS","PAR","PAU","UWE"])):e(t._hasPARRole)},getGrantedRoles:function(e){let t=this;if(Array.isArray(this._roles)&&this._roles.length)e(this._roles);else try{n.getGrantedRoles(function(n){t._roles=n,e(t._roles)})}catch(t){e([])}},hasRole:function(e,t){var n=!1;this.getGrantedRoles(r=>{for(var i=0;i<r.length&!n;i++)for(var o=0;o<t.length;o++)if(r[i]&&r[i].id===t[o]){n=!0;break}e(n)})},getServices:function(){return this.options.wintop?(void 0!==this.options.platform_services&&this.options.platform_services.length>0&&void 0!==this.options.platform_services[0].platformId&&(this.tenant=this.options.platform_services[0].platformId),c.getInstance(this.options)):c},getEnforceFolderLinkSettingAsync:function(e){if(void 0!==this._enforceFolderLink)e(null,this._enforceFolderLink);else{if(void 0!==this._enforceFolderLinkReturned&&0==this._enforceFolderLinkReturned)return void e(null,this._enforceFolderLink);this._enforceFolderLinkReturned=!1;var t=this.getServices().get3DSpaceWSUrl(this.tenant,"/resources/lifecycle/product/getEnforceFolderSetting",null),n=this,r={type:"json",method:"POST",proxy:"passport",authentication:"passport",data:UWA.Json.encode(""),headers:c.getHeaders(),onComplete:function(t){n._enforceFolderLinkReturned=!0;var r=t.result;r&&"true"===r&&(n._enforceFolderLink=!0),r&&"false"===r&&(n._enforceFolderLink=!1),e(null,n._enforceFolderLink)},onFailure:function(t){n._enforceFolderLinkReturned=!0,console.log("getEnforceFolderLinkSetting: Failure..."+t),e("getEnforceFolderLinkSetting: Failure..."+t)},onTimeout:function(){n._enforceFolderLinkReturned=!0,console.log("getEnforceFolderLinkSetting: A connection timeout occured."),e("getEnforceFolderLinkSetting: A connection timeout occured.")}};i.handleRequest(t,r)}},getEnforceFolderLinkSettingPromise:function(){var e=this;return new Promise(function(t,n){e.getEnforceFolderLinkSettingAsync(function(e,r){e?n(e):t(r)})})},getEnforceFolderLinkSetting:function(){return void 0!==this._enforceFolderLink?this._enforceFolderLink:void this.getEnforceFolderLinkSettingAsync(function(){})},isLogicalDeleteActive:function(e){var t=this;void 0===t._isLogicalDeleteActive?c.app_initialization(function(){var n=c.get3DSpaceWSUrl(t.tenant,"/resources/lifecycle/product/isLogicalDeleteActivated",null);UWA.Data.request(n,{type:"json",method:"POST",proxy:"passport",data:UWA.Json.encode(""),headers:c.getHeaders(),onComplete:function(n){console.log("isLogicalDeleteActive: onComplete:"+n),n.hasOwnProperty("result")&&"true"==n.result?(t._isLogicalDeleteActive=!0,t._trashSecurityContext=n.securityContext):t._isLogicalDeleteActive=!1,e(t._isLogicalDeleteActive)},onFailure:function(t){console.log("isLogicalDeleteActive: onFailure:"+t),e(!1)},onTimeout:function(){console.log("isLogicalDeleteActive: onTimeout: A connection timeout occured."),e(!1)}})}):e(t._isLogicalDeleteActive)},getHeaders:function(e){var t={Accept:"application/json","Content-Type":"application/json","Accept-Language":widget.lang};e&&(t.SecurityContext=encodeURIComponent(decodeURIComponent(e)));try{var n=o.get();n.change.id.length>0&&(t["DS-Change-Authoring-Context"]="pid:"+n.change.id),n.evolution.id.length>0&&(t["DS-Configuration-Authoring-Context"]="pid:"+n.evolution.id)}catch(e){}return t},isOpenWithCATIAV5Available:function(e){this.hasPARRole(e)},getCADvalidityService:function(e){return new Promise(function(t,n){var r=s[e];if(null!=r){var i=r.require;require([i],function(e){t(e)},function(){n("No Mapping found")})}else n("No Mapping found")})}});return c}),define("DS/LifecycleServices/NewBranchObjectProp",["i18n!DS/LifecycleServices/assets/nls/LifecycleServicesNls","UWA/Core","UWA/Controls/Abstract","DS/EditPropWidget/facets/Properties/Properties","DS/EditPropWidget/models/EditPropAttributeModel","DS/EditPropWidget/models/EditPropModel","DS/EditPropWidget/utils/AttributesUtils"],function(e,t,n,r,i,o,s){"use strict";return n.extend({defaultOptions:{className:"newbranchobjectprop",data_rec_id:"newbranchobjectprop-id",showTitle:!1,showProposedRevision:!1,editable:!1},init:function(e){this._parent(e),this.propUI=null,this.model=null,this._currentIntent=null,this.attributes=null,this.container=UWA.createElement("div",{name:"newbranch_prop",class:this.options.className})},getComputedMinHeight:function(){return this._min_height},isIntentModified:function(){if(null==this.model)return!1;var e=null,t=this.model.getChangedValues();return t.hasOwnProperty("intentsList")&&(e=t.intentsList),null!=e&&e.modified},getIntent:function(){return this._currentIntent},getErrors:function(){if(!this.model||!this.attributes)return null;var e=[];return this.attributes.forEach(t=>{var n=s.validateAttributes(this.model,[t]);if(n&&n.length&&"ERROR"===n[0].code){var r=t.label;(r=r?r.toLowerCase():"")&&n[0].message&&(n[0].message=n[0].message.replaceAll(r,t.label)),e.push(n[0])}}),e},_onObjectAttributeValueHasChanged:function(e,t,n,r){let i=n&&n.volatile;if(r&&i&&e.volatileAttributes&&e.volatileAttributes.hasOwnProperty(t))delete e.volatileAttributes[t];else if(r&&e.modifiedAttributes&&e.modifiedAttributes.hasOwnProperty(t))delete e.modifiedAttributes[t];else{i&&!e.volatileAttributes?e.volatileAttributes={}:e.modifiedAttributes||(e.modifiedAttributes={}),i?e.volatileAttributes[t]=n.valueDB:e.modifiedAttributes[t]=n.valueDB;var o=s.validateAttributes(this.model,[n]);if(null!=o&&o.length>0){var a=n.label;return(a=a?a.toLowerCase():"")&&o[0]&&o[0].message&&(o[0].message=o[0].message.replaceAll(a,n.label)),void this.dispatchEvent("onAttributeValidationError",[o])}"function"!=typeof n.onAttributeValueChanged||n.onAttributeValueChanged()}},setObject:function(t,n,s){var a=0,c={},l=this,u=[];if(t.hasOwnProperty("attributes_mask")&&(u=t.attributes_mask),this.options.showTitle){var d="",f="",h="",p=!0;t["attribute[PLMEntity.V_Name]"]&&(f="attribute[PLMEntity.V_Name]"),t["attribute[PLMEntity.V_Name]"]&&(h="PLMEntity.V_Name"),t["attribute[PLMEntity.V_Name]"]&&(d=t["attribute[PLMEntity.V_Name]"]),t.Title&&(f="Title"),t.Title&&(h="Title"),t.Title&&(d=t.Title),t.computedLabel&&t.computedLabel.selectable&&(f=t.computedLabel.selectable),t.computedLabel&&t.computedLabel.path&&(h=t.computedLabel.path),t.computedLabel&&t.computedLabel.value&&t.computedLabel.value.length>=1&&(d=t.computedLabel.value[0]);u=[];if(t.hasOwnProperty("attributes_mask")&&(u=t.attributes_mask),u.forEach(function(e){e.selectable==f&&!0===e.readOnly&&(p=!1)}),t.hasOwnProperty("modifiedAttributes")&&t.modifiedAttributes.hasOwnProperty(h)&&(d=t.modifiedAttributes[h]),p){(v=new i({name:"title",path:"title",label:e.title,valueDB:d,maxlength:100,readOnly:!1})).saveInitialValues(),c[v.name]=v,a+=46}else{var v=new i({name:"title",path:"title",label:e.title,value:d});c[v.name]=v,a+=28}}if(this.options.showProposedRevision){var g=t.proposedRevision;t.hasOwnProperty("modifiedAttributes")&&t.modifiedAttributes.hasOwnProperty("revision")&&(g=t.modifiedAttributes.revision);var y=!1;if(u.forEach(function(e){"revision"==e.selectable&&!1===e.readOnly&&(y=!0)}),y){(m=new i({name:"proposedRevision",path:"proposedRevision",label:e.proposedRevision,valueDB:g,readOnly:!1})).saveInitialValues(),c[m.name]=m,a+=46}else{var m=new i({name:"proposedRevision",path:"proposedRevision",label:e.proposedRevision,value:g});c[m.name]=m,a+=28}}var S={};if(u.forEach(function(e){if("revision"!=e.selectable&&e.selectable!=f){var n="",r=!1,o=!1,s=!1,l=void 0;if(e.hasOwnProperty("multiline")&&(o=e.multiline),e.hasOwnProperty("value")&&(n=e.value),e.hasOwnProperty("readOnly")&&(r=!e.readOnly),e.hasOwnProperty("volatile")&&(s=e.volatile),e.hasOwnProperty("onAttributeValueChanged")&&(l=e.onAttributeValueChanged),s&&t.volatileAttributes&&t.volatileAttributes.hasOwnProperty(e.path)?n=t.volatileAttributes[e.path]:t.modifiedAttributes&&t.modifiedAttributes.hasOwnProperty(e.path)&&(n=t.modifiedAttributes[e.path]),S[e.selectable]=e.path,r){u=new i({name:e.selectable,path:e.selectable,label:e.nls,valueDB:n,readOnly:!1,maxlength:e.maxlength?e.maxlength:-1,multiline:o});e.authorizedValues&&u.set("authorizedValues",e.authorizedValues),e.authorizedValuesNLS&&u.set("authorizedValuesNLS",e.authorizedValuesNLS),s&&(u.volatile=!0),l&&(u.onAttributeValueChanged=l),u.saveInitialValues(),c[u.name]=u,e.authorizedValues?a+=46:a+=o?64:46}else{var u=new i({name:e.selectable,path:e.selectable,label:e.nls,value:n,multiline:o});c[u.name]=u,a+=28}}}),n&&n.length>0){var b=[],A=[];n.forEach(function(e){b.push(e.operation),A.push(e.nls)}),this._currentIntent=s||b[0];var C=new i({name:"intentsList",path:"intentsList",label:e.IntentSelection,authorizedValues:b,authorizedValuesNLS:A,valueDB:this._currentIntent,readOnly:!1});C.saveInitialValues(),c[C.name]=C,a+=46}this.model=new o({metatype:"businessobject",objectId:t.physicalid}),this.model.set(c);var P=!1;null!==this.propUI&&(P=!0),P||(this.propUI=new r({setCloseButton:!1,editMode:this.options.editable,readOnly:!this.options.editable,identifier:this.options.identifier?this.options.identifier:void 0})),this.propUI.initData([this.model]),this.model.clearChangedValue(),this._min_height=a,P||(this.propUI.elements.container.setStyle("min-height",a+"px"),this.propUI.elements.mainDiv.setStyle("height","100%"),this.propUI.elements.container.setStyle("width","100%"),this.propUI.inject(this.container)),this.model.addEvent("onChangeAttributes",function(e,n){l.attributes=n,n.forEach(function(e){"intentsList"===e.name?e.valueDB!==l._currentIntent&&(l._currentIntent=e.valueDB,l.dispatchEvent("onIntentChanged")):"title"!==e.name||e.valueDB?"title"===e.name?l._onObjectAttributeValueHasChanged(t,h,e,!1):"proposedRevision"===e.name?l._onObjectAttributeValueHasChanged(t,"revision",e,!1):l._onObjectAttributeValueHasChanged(t,S[e.name],e,!1):l._onObjectAttributeValueHasChanged(t,h,e,!0)})})}})}),define("DS/LifecycleServices/AssemblyJson",["UWA/Class"],function(e){"use strict";var t=e.singleton({init:function(){this._parent({})},convertFromExpandFormat:function(e,t){return(new function(){var e=[],n=[],r=[],i={},o={},s={},a={},c={},l=[],u=[],d=[],f=0,h=0,p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],v=-1,g={},y=null;function m(t,u){f=u&&u.firstNodeId||0,h=u&&u.firstOccId||0;var m=t.results,A=m.length;if(A>0){a={};var C=0;for(C=0;C<A;C++)if((P=m[C]).hasOwnProperty("icon__default_thumbnail_2d"))y=P.icon__default_thumbnail_2d;else if(void 0===(w=P.attributes)){if(void 0===(w=P.path))continue;l.push(w),b(w)}for(c={},C=0,C=0;C<A;C++){var P,w;void 0!==(w=(P=m[C]).attributes)&&S(w)}!function(){var e=l.length,t=0;for(t=0;t<e;t++){var a=l[t],u="",f=a.length,y=0,m=!1,S=null,b=null,A=null,C=null,P=null;for(y=0;y<f;y++)if(!0===m)C=a[y],i[C]||(C=c[C]),u+=C,m=!1;else{if(b=a[y],i[b]||(b=c[b]),u=u+"|"+b,!d.hasOwnProperty(u)){var w=h++;d[u]=w,(A={}).occurrenceid=w,A.nodeid=i[b],o.hasOwnProperty(C)?A.xform=o[C]:A.xform=p,n.push(A),0!==y?((P={}).parent=S,P.child=w,P.physicalid=C,P.treeOrder=g[C],P.type=s[C],r.push(P)):-1==v&&(v=w)}S=d[u],m=!0}}}();var _={uicontroltype:"piecewisecgrviewer",version:2};return _.rootoccurrence=v,_.nodes=e,_.occurrences=n,_.occurrencerelationships=r,u&&u.returnIdCounters&&(_.nextNodeId=f,_.nextOccId=h),_}}function S(n){var r,l,d,h=n.length,v=0,m={},S={},b=[];for(v=0;v<h;v++)l=(r=n[v]).name,d=r.value,m[l]=d;var A,C=a[m.did],P=m.physicalid;if(P||(P=m.resourceid),c[m.did]=P,s[P]=m["ds6w:type"],"relationship"==C){var w={physicalid:P};u.push(w);var _=!1;if(m.hasOwnProperty("matrixtxt")){var D=m.matrixtxt.split(",");b=[];var x=0;if(_=!0,12==D.length)for(x=0;x<12;x++){var E=Number(D[x]);if(NaN==E){_=!1;break}b.push(E),2==x&&b.push(0),5==x&&b.push(0),8==x&&b.push(0),11==x&&b.push(1)}else _=!1}0==_&&(b=p);var O=1;m.hasOwnProperty("TreeOrder")?O=parseFloat(m.TreeOrder):m.hasOwnProperty("ro.plminstance.V_treeorder")&&(O=parseFloat(m["ro.plminstance.V_treeorder"])),isNaN(O)&&(O=1),g[P]=O,o[P]=b}else if("node"==C){var I=f++;i[P]=I,S.nodeid=I,S.physicalid=P,S.mod=m["ds6w:modified"],S.modms=Date.parse(S.mod),S.type=m["ds6w:type"],S.state=m["ds6w:status"],S.cadMaster=m["ds6w:cadMaster"],S.project=m["ds6w:project"];var L=m.cgr;null==L&&(L=""),S.cgrurl=L,S.Title=m["ds6w:label"];var T=m["ds6w:revision"];void 0!==T&&""!==T||(T=m["ds6wg:revision"]),null==T&&(T="");var N=m.type_icon_url;if(void 0===N&&y){var W=!1;y.some(function(e){return e.did.some(function(t){return t===m.did&&(N=e.icon,W=!0),W}),W})}t&&t.baseUrl&&N&&(A=N)&&-1===A.indexOf("http://")&&-1===A.indexOf("https://")&&(N=t.baseUrl+N),S.revision=T,S.attributes={originated:m["ds6w:created"],name:m["ds6w:label"],locked:m["ds6w:reserved"],revision:T,description:m["ds6w:description"],owner:m["ds6w:responsible"],locker:m["ds6w:reservedBy"],type_icon_url:N},Object.keys(m).filter(e=>e.startsWith("expand::")).forEach(e=>{S.attributes[e]=m[e]}),e.push(S)}}function b(e){var t=e.length,n=0,r=!1;for(n=0;n<t;n++)!0===r?(a[e[n]]="relationship",r=!1):(a[e[n]]="node",r=!0)}return{convert:function(e,t){return m(e,t)}}}).convert(e,t)},convertToViewerFormat:function(e){var t,n={results:[]},r={attributes:[{name:"did",value:""},{name:"resourceid",value:""},{name:"ds6w:type",value:""}]},i={attributes:[{name:"did",value:""},{name:"resourceid",value:""},{name:"ds6w:type",value:""},{format:"attribute",name:"thumbnail_3d",type:"STRING",value:""},{format:"attribute",name:"cgr",type:"STRING",value:""},{name:"ds6w:globalType",value:"ds6w:Document"}]},o={attributes:[{name:"did",value:"12832"},{name:"resourceid",value:"134EB556B30A000072A1EA5672400800"},{name:"type",value:"CAD SubComponent"},{name:"matrixtxt",value:"1,0,0,0,1,0,0,0,1,0,0,0"}]};function s(e){return"CATPart"==e||"CATShape"==e||"CATIA CGR"==e||"3DShape"==e||"FEM"==e||"SIMShape"==e||"CATIA V4 Model"==e}function a(e){return e.attributes.isTypeOf3DShape}function c(e){return"string"==typeof e.cgrurl&&e.cgrurl.length>0}var l=e.nodes.length;for(t=0;t<l;t++){var u=e.nodes[t],d=u.type;if(null!=d)"Part"==d&&(e&&u&&void 0!==u.cgrurl&&""!==u.cgrurl?u.type=d="3DShape":u.type=d="VPMReference"),(p=JSON.parse(JSON.stringify(s(d)||a(u)||c(u)?i:r))).attributes[0].value=""+u.nodeid,p.attributes[1].value=u.physicalid,s(d)||a(u)||c(u)?(p.attributes[2].value=d==a(u)?"3DShape":u.type,p.attributes[3].value=u.thumbnail_3d,p.attributes[4].value=u.cgrurl):p.attributes[2].value=u.type,n.results.push(p)}var f=e.occurrences.length,h=e.occurrencerelationships.length;for(t=1;t<f;t++){var p=JSON.parse(JSON.stringify(o)),v=[];if(null!=e.occurrences[t].xform)if(12==e.occurrences[t].xform.length)for(var g=0;g<12;g++)v.push(e.occurrences[t].xform[g]);else v.push(e.occurrences[t].xform[0]),v.push(e.occurrences[t].xform[1]),v.push(e.occurrences[t].xform[2]),v.push(e.occurrences[t].xform[4]),v.push(e.occurrences[t].xform[5]),v.push(e.occurrences[t].xform[6]),v.push(e.occurrences[t].xform[8]),v.push(e.occurrences[t].xform[9]),v.push(e.occurrences[t].xform[10]),v.push(e.occurrences[t].xform[12]),v.push(e.occurrences[t].xform[13]),v.push(e.occurrences[t].xform[14]);var y=JSON.stringify(v);y=(y=y.replace("[","")).replace("]","");for(var m="",S="",b=0;b<h;b++)if(e.occurrences[t].occurrenceid==e.occurrencerelationships[b].child){m=e.occurrencerelationships[b].physicalid,S=e.occurrencerelationships[b].relname;break}p.attributes[0].value=(l+t-1).toString(),p.attributes[1].value=null!=m&&""!=m?m:(l+t-1).toString(),p.attributes[2].value=null!=S&&""!=S?S:(l+t-1).toString(),p.attributes[3].value=y,"CatDesignTable"==S&&p.attributes.splice(3,1),n.results.push(p)}for(var A=e.nodes,C=e.occurrences,P=e.occurrencerelationships,w={},_=0;_<A.length;_++){w[O=(I=A[_]).nodeid]=I}var D={},x={},E={};for(_=0;_<C.length;_++){var O,I,L=C[_],T=L.occurrenceid,N=(I=w[O=L.nodeid]).physicalid;D[T]=N,x[T]=O,E[T]=_}var W={},U={};for(_=0;_<P.length;_++){var F=P[_],R=F.child,k=F.parent,M=F.physicalid;W[R]=M,U[R]=k}var j=new Array(f),V={};for(t=0;t<f;t++){var B=t,q=e.occurrences[B].nodeid,H=[];for(T=C[t].occurrenceid;null!=T;)H.push(T),T=U[T];H.reverse();var z=[],G=[],J=l-1;for(b=0;b<H.length;b++){T=H[b];if(b>0){var K=W[T];z.push(K);var X=E[T];G.push((X+J).toString())}var Y=D[T];z.push(Y);var Q=x[T];G.push(Q.toString())}j[t]=z.slice();var Z=w[q];(s(Z.type)||a(Z)||c(Z))&&n.results.push({path:G.slice()}),V[JSON.stringify(j[t])]=t}return n.mapOccurrenceToPath=j,n.mapPathToOccurrence=V,n},getNodeCount:function(e){return e.nodes.length},getRootPhysicalId:function(e){if(0==e.occurrences.length)return e.nodes[0].physicalid;var t=this.getRootOccurenceId(e),n=this.getNodeIdFromOccurenceId(e,t);return this.getNodeAttributeValue(e,n,"physicalid")},getRootOccurenceId:function(e){return e.rootoccurrence},_getChildOccurenceIds:function(e,t,n){for(var r=[],i=e.occurrencerelationships,o=i.length,s=[],a=n||!1,c=0;c<o;c++){var l=i[c];if(l.parent==t){if(a){var u=this.getOccurence(e,l.child);if(-1!==s.indexOf(u.nodeid))continue;s.push(u.nodeid)}r.push({id:l.child,treeOrder:l.treeOrder})}}return r},getChildOccurenceIds:function(e,t,n){return this._getChildOccurenceIds(e,t,n).map(function(e){return e.id})},getChildOccurenceIdsTreeOrder:function(e,t,n){return this._getChildOccurenceIds(e,t,n).sort(function(e,t){return e.treeOrder-t.treeOrder}).map(function(e){return e.id})},setOccurenceRelationshipOrder:function(e,t,n,r){for(var i=e.occurrencerelationships.length,o=0;o<i;o++)if(e.occurrencerelationships[o].parent==t&&e.occurrencerelationships[o].child==n){e.occurrencerelationships[o].order=r;break}},getOccurence:function(e,t){for(var n=e.occurrences,r=n.length,i=0;i<r;i++){var o=n[i];if(o.occurrenceid==t)return o}return null},getAllNodePhysicalIds:function(e){for(var t=[],n=e.nodes,r=n.length,i=0;i<r;i++){var o=n[i];t.push(o.physicalid)}return t},getNodePhysicalId:function(e,t){return this.getNode(e,t).physicalid},getNode:function(e,t){for(var n=e.nodes,r=n.length,i=0;i<r;i++){var o=n[i];if(o.nodeid==t)return o}return null},getNodeFromPhysicalId:function(e,t){for(var n=e.nodes,r=n.length,i=0;i<r;i++){var o=n[i];if(o.physicalid===t)return o}return null},Node:function(e){return{setAttribute:function(e,t){null!=this.nodeJson[e]?this.nodeJson[e]=t:this.nodeJson.attributes[e]=t},getAttribute:function(e){var t=this.nodeJson[e];return null==t&&(t=this.nodeJson.attributes[e]),t},nodeJson:e}},Assembly:function(e){return{getNodeByPhysicalId:function(e){for(var n=this.nodes.length,r=0;r<n;r++){var i=this.nodes[r];if(i.physicalid==e)return t.Node(i)}return null},getNodeCount:function(){return this.nodes.length},getNode:function(n){return t.Node(e.nodes[n])},nodes:e.nodes}},AssemblyHelper:function(e){return{getNode:function(e){return this._nodeIdMap.get(e)},getNodeByPid:function(e){return this._nodePidMap.get(e)},getOccurence:function(e){return this._occurrenceMap.get(e)},getNodeIdFromOccurenceId:function(e){return this.getOccurence(e).nodeid},getNodeFromOccurenceId:function(e){var t=this.getOccurence(e);return this.getNode(t.nodeid)},getRootOccurenceId:function(){return this._assembly.rootoccurrence},getNodeAttributeValues:function(e,t){const n=new Map(Object.entries({Title:"ds6w:label",type_icon_url:"icon"}));var r=[],i=this.getNode(e);return t.forEach(function(e){var t=i[e];null==t&&(t=i.attributes[e]),null==t&&n.has(e)&&(t=i[n.get(e)]),r.push(t)}),r},getParentOccurence:function(e){for(var t=null,n=this._assembly.occurrencerelationships,r=n.length,i=0;i<r;i++){var o=n[i];if(o.child==e){t=this.getOccurence(o.parent);break}}return t},getChildOccurenceIds:function(e,t){return this._getChildOccurenceIds(e,t).map(function(e){return e.id})},getChildOccurenceIdsTreeOrder:function(e,t){return this._getChildOccurenceIds(e,t).sort(function(e,t){return e.treeOrder-t.treeOrder}).map(function(e){return e.id})},addNode:function(e){this._assembly.nodes.push(e),this._nodeIdMap.set(e.nodeid,e),this._nodePidMap.set(e.physicalid,e)},addOccurrence:function(e){this._assembly.occurrences.push(e),this._occurrenceMap.set(e.occurrenceid,e)},_getChildOccurenceIds:function(e,t){var n=this,r=[],i=this._assembly.occurrencerelationships,o=(i.length,[]),s=t||!1;return i.forEach(function(t){if(t.parent==e){if(s){var i=n.getOccurence(t.child);if(-1!==o.indexOf(i.nodeid))return;o.push(i.nodeid)}r.push({id:t.child,treeOrder:t.treeOrder})}}),r},_assembly:e,_nodeIdMap:new Map(e.nodes.map(e=>[e.nodeid,e])),_nodePidMap:new Map(e.nodes.map(e=>[e.physicalid,e])),_occurrenceMap:new Map(e.occurrences.map(e=>[e.occurrenceid,e]))}},getNodeAttributeValue:function(e,t,n){var r=[n];return this.getNodeAttributeValues(e,t,r)[0]},getNodeAttributeValues:function(e,t,n){for(var r=[],i=this.getNode(e,t),o=n.length,s=0;s<o;s++){var a=n[s],c=i[a];null==c&&(c=i.attributes[a]),r.push(c)}return r},getNodeIdFromOccurenceId:function(e,t){return this.getOccurence(e,t).nodeid},getNodeIdsFromOccurenceIds:function(e,t){for(var n=[],r=t.length,i=0;i<r;i++){var o=this.getNodeIdFromOccurenceId(e,t[i]);-1==n.indexOf(o)&&n.push(o)}return n},getRelationshipId:function(e,t,n){for(var r=e.occurrencerelationships.length,i=0;i<r;i++)if(e.occurrencerelationships[i].parent===t&&e.occurrencerelationships[i].child===n)return e.occurrencerelationships[i].physicalid;return null},getRelationshipData:function(e,t,n){for(var r=e.occurrencerelationships.length,i=0;i<r;i++)if(e.occurrencerelationships[i].parent===t&&e.occurrencerelationships[i].child===n)return{pid:e.occurrencerelationships[i].physicalid,type:e.occurrencerelationships[i].type};return null},getRelationships:function(e,t,n){for(var r=[],i=e.occurrencerelationships.length,o=0;o<i;o++){var s=e.occurrencerelationships[o].parent,a=this.getOccurence(e,s).nodeid,c=e.occurrencerelationships[o].child,l=this.getOccurence(e,c).nodeid;a===t&&l===n&&-1===r.indexOf(e.occurrencerelationships[o].physicalid)&&r.push(e.occurrencerelationships[o].physicalid)}return r},foo:function(){}});return t}),define("DS/LifecycleServices/UUIDGenerator",["UWA/Class"],function(e){"use strict";return e.singleton({init:function(){this.counter=0},create:function(){return(new Date).getTime()+this.counter++}})}),define("DS/LifecycleServices/EventHandler",[],function(){"use strict";function e(t,n,r){if(!(this instanceof e))return new e(t,n,r);this.element=t,this.event=n,this.fn=r,void 0!==this.fn&&this.bind()}return e.prototype.bind=function(e){"function"==typeof e&&(this.fn=e),this.element.addEventListener(this.event,this.fn)},e.prototype.unbind=function(){this.element.removeEventListener(this.event,this.fn)},e}),define("DS/LifecycleServices/XMLDocHelper",["UWA/Utils"],function(e){"use strict";return{loadXMLDoc:function(t){return e.loadXml(t)},filterNodes:function(e,t){if("object"!=typeof t)throw Error("XMLDocHelper.filterNodes:Invalid input: Cannot filter nodes");if(!e||0===e.length)throw Error("XMLDocHelper.filterNodes:nodeList does not contain nodes");for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r],s=!t.tag||"string"==typeof t.tag&&o.tagName===t.tag;if("object"==typeof t.attrList)for(var a in t.attrList){var c=o.getAttribute(a),l=t.attrList[a];s=s&&"string"==typeof c&&(!0===l.allowPartialMatch?(l.value instanceof RegExp?l.value:new RegExp(l.value)).test(c):c===l.value)}if("object"==typeof t.text){var u=o.textContent;s=s&&"string"==typeof u&&(!0===t.text.allowPartialMatch?(t.text.value instanceof RegExp?t.text.value:new RegExp(t.text.value)).test(u):u===t.text.value)}s&&n.push(o)}return n},filterDescendants:function(e,t){if(!e||0===e.length)throw Error("XMLDocHelper.filterDescendants:nodeList does not contain nodes");t=t||{};var n=[];function r(e,t){t.push(e);for(var n=0,i=e.childNodes.length;n<i;n++)(s=e.childNodes[n]).nodeType===Node.ELEMENT_NODE&&r(s,t);return t}for(var i=0,o=e.length;i<o;i++){var s=e[i];if("string"==typeof t.tag){var a=t.tag.split(":");n=2===a.length?s.getElementsByTagNameNS(s.lookupNamespaceURI(a[0]),a[1]):s.getElementsByTagName(a[0])}else n=r(s,n)}return"object"==typeof t.attrList?this.filterNodes(n,{attrList:t.attrList}):n},filterChildren:function(e,t){if(!e||0===e.length)throw Error("XMLDocHelper.filterChildren:nodeList does not contain nodes");t=t||{};for(var n=0,r=e.length,i=[];n<r;n++)for(var o,s=0,a=e[n].childNodes.length;s<a;s++)(o=e[n].childNodes[s]).nodeType===Node.ELEMENT_NODE&&i.push(o);return this.filterNodes(i,t)},filterIfDescendantElementExists:function(e,t){if(!e||0===e.length)throw Error("XMLDocHelper.filterIfDescendantElementExists:nodeList does not contain nodes");t=t||{};for(var n,r=[],i=0,o=e.length;i<o;i++)n=e[i],this.filterDescendants([n],t).length>0&&r.push(n);return r},filterFirstMatchingAncestor:function(e,t){if(!e||0===e.length)throw Error("XMLDocHelper.filterNodes:nodeList does not contain nodes");if("object"!=typeof t)throw Error("XMLDocHelper.filterNodes:Invalid input: Cannot filter nodes");for(var n=0,r=[],i=e.length;n<i;n++){for(var o=e[n].parentNode;o&&!this.filterNodes([o],t).length;)o=o.parentNode;r.push(o)}return r},getParent:function(e){return e.parentNode},getSiblings:function(e){var t=e.parentNode,n=t&&this.filterChildren([t])||[];return n.length&&n.splice(n.indexOf(e),1),n},getNodeInfo:function(e){var t={tag:void 0,value:void 0,attrList:{},text:void 0};if(t.tag=e.tagName,t.value=e.nodeValue,t.text=e.textContent,e.hasAttributes())for(var n=e.attributes,r=0,i=n.length;r<i;r++)t.attrList[n[r].name]=n[r].value;return t},getChildren:function(e){return this.filterChildren([e])}}}),define("DS/LifecycleServices/ArrayFunctions",function(){"use strict";return Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,i=arguments[1],o=0;o<r;o++)if(t=n[o],e.call(i,t,o,n))return t}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,i=arguments[1],o=0;o<r;o++)if(t=n[o],e.call(i,t,o,n))return o;return-1}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),r=n.length>>>0;if(0===r)return!1;for(var i,o,s=0|t,a=Math.max(0<=s?s:r-Math.abs(s),0);a<r;){if((i=n[a])===(o=e)||"number"==typeof i&&"number"==typeof o&&isNaN(i)&&isNaN(o))return!0;a++}return!1}}),"function"!=typeof Array.prototype.flatMap&&(Array.prototype.flatMap=function(e){for(var t=[],n=0;n<this.length;++n){var r=e(this[n],n,this);Array.isArray(r)||(r=[r]);for(var i=0;i<r.length;++i)t.push(r[i])}return t}),null}),define("DS/LifecycleServices/LifecycleObjectList",["css!DS/LifecycleServices/LifecycleServices","UWA/Core","UWA/Controls/Abstract","DS/DataGridWidget/DataGridWidget","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls","i18n!DS/LifecycleServices/assets/nls/LifecycleServicesNls","DS/PlatformAPI/PlatformAPI"],function(e,t,n,r,i,o,s){"use strict";var a=null;function c(){return null==a&&(a=s.getUser()),a}return n.extend({defaultOptions:{className:"Lifecycle-objectlist",showDisplayNameColumn:!0,showNameColumn:!1,showRevisionColumn:!1,showTypeColumn:!1,appendObjects:!1,showMaturityColumn:!1,showLockColumn:!1},objectsTableBody:null,objectsTable:null,init:function(e){this._parent(e),this.buildSkeleton()},buildSkeleton:function(){var e=this.options;this.objectsTable=new r([{text:"PhysicalID",dataIndex:"Id",sortKey:function(e){return e},sortable:!0,hidden:!0},{text:"",dataIndex:"Symbol",sortKey:function(e){return e},sortable:!0},{text:i.title,dataIndex:"Title",sortKey:function(e){return e},sortable:!0},{text:i.type,dataIndex:"Type",sortKey:function(e){return e},sortable:!0},{text:i.revision,dataIndex:"Revision",sortKey:function(e){return e},sortable:!0},{text:o.maturitystate,dataIndex:"Current",sortKey:function(e){return e},sortable:!0},{text:o.reserved,dataIndex:"Locked",sortKey:function(e){return e},sortable:!0}],{className:e.className,activeSelection:!1,setScroller:!0,useNativeScroller:!0,maxHeightScroller:""}),this.objectsTable.CurrentSortColumn=-1,this.objectsTable.getContent().setAttribute("data-rec-id","dataRecInitialSelectedGridAccess"),this.elements.container=this.objectsTable},setObjects:function(e){var t=this;t.objectsTable.clearAllLine();var n=[];e.forEach(function(e){var r=t.AddObjectInTable(e);null!=r&&n.push(r)}),t.objectsTable.AddDatasInTable(n)},AddObjectInTable:function(e){var t=e.type;e.typeDisplayName?t=e.typeDisplayName:e.displayType&&(t=e.displayType);var n,r,i=UWA.createElement("img",{src:e.imageUrl}),o=e.locked,s=UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-lock-open"});if(void 0===o)s=UWA.createElement("span",{});else if(!0===o){var a=(n=c(),r="",void 0!==n&&(r=n.login),r),l=function(){var e=c(),t="";return void 0!==e&&(t=e.firstName+" "+e.lastName),t}(),u=!0,d=e.lockedBy;d.trim().length>0&&((u=d.toUpperCase().trim()===a.toUpperCase().trim()||!1)||(u=d.toUpperCase().trim()===l.toUpperCase().trim()||!1)),s=u?UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-key lc_dgv_lock"}):UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-lock lc_dgv_lock_other"})}else!1===o&&(s=UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-lock-open"}));var f=e.revision;return null==f&&(f=""),{Id:e.physicalid,Title:e.name,Type:t,Revision:f,Current:e.current,Symbol:i,Locked:s}},empty:function(){if(null!==this.objectsTableBody)for(;this.objectsTableBody.firstChild;)this.objectsTableBody.removeChild(this.objectsTableBody.firstChild)}})}),define("DS/LifecycleServices/Utils",[],function(){"use strict";function e(){}return e.prototype={debounce:function(e,t,n){var r;return function(){var i=this,o=arguments,s=n&&!r;clearTimeout(r),r=setTimeout(function(){r=null,n||e.apply(i,o)},t),s&&e.apply(i,o)}},toArray:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},toMaturityArray:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},htmlFromString:function(e){if(this._htmlFromString)return this._htmlFromString(e);try{return this._htmlFromString=function(e){return document.createRange().createContextualFragment(e)},this._htmlFromString(e)}catch(t){return this._htmlFromString=function(e){var t=document.createRange();return t.selectNode(document.body),t.createContextualFragment(e)},this._htmlFromString(e)}},createDbgNlsProxy:function(e){if(window&&window.showTranslated&&42!=e.isNlsProxy){return new Proxy(e,{get:function(e,t,n){return"isNlsProxy"===t?42:"T("+e[t]+")"}})}return e},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},forEach:function(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),this.isArray(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)},getWidgetDomainSearchParams:function(){var e=null,t=new URLSearchParams(window.location.search);if(t&&t.has("widgetDomain")){var n=t.get("widgetDomain");e=new URLSearchParams(n.substring(n.indexOf("?")))}return e},urlHasParam:function(e){var t=this.getWidgetDomainSearchParams();return t&&t.has(e)},getURLParamValue:function(e){var t=null,n=this.getWidgetDomainSearchParams();return n&&n.has(e)&&(t=n.get(e)),t},urlHasParamValue:function(e,t){var n=this.getURLParamValue(e);return n&&n===t}},new e}),define("DS/LifecycleServices/LifecycleObjectBlacklist",["UWA/Class"],function(e){"use strict";return e.singleton({init:function(){this.blacklistedTypes=["Person","pno:Person","CATPart","CATProduct","CATDrawing"],this.isBlacklistedStr=function(e){return-1!==this.blacklistedTypes.indexOf(e)},this.isBlacklistedArray=function(e){for(var t=0;t<e.length;++t){var n=e[t].type||e[t].objectType||"";if(this.isBlacklistedStr(n))return!0}return!1}},isBlacklisted:function(e){return"[object Array]"===Object.prototype.toString.call(e)?this.isBlacklistedArray(e):("string"==typeof e||e instanceof String)&&this.isBlacklistedStr(e)}})}),define("DS/LifecycleServices/Expandv2Parser",["UWA/Class"],function(e){"use strict";return e.singleton({parse:function(e,t){let n={rootoccurrence:-1,nodes:[],occurrences:[],occurrencerelationships:[]};if(!e)return n;const r=new Map,i=new Map;let o=t&&t.firstNodeId?t.firstNodeId:0,s=0;for(var a of e.results)if(a.from){let e=r.get(a.to);n.occurrences.push({occurrenceid:s,nodeid:e}),i.set(a.to,s),n.occurrencerelationships.push({parent:i.get(a.from),child:s,physicalid:a.resourceid,type:a["ds6w:type"],treeOrder:a["ro.plminstance.V_treeorder"]?parseFloat(a["ro.plminstance.V_treeorder"]):void 0,...a}),++s}else{a.physicalid=a.resourceid,r.set(a.resourceid,o);let e={nodeid:o,mod:a["ds6w:modified"],modms:Date.parse(a.mod),type:a["ds6w:type"],state:a["ds6w:status"],cadMaster:a["ds6w:cadMaster"],project:a["ds6w:project"],Title:a["ds6w:label"],attributes:{},...a};n.nodes.push(e),a.icon&&(e.attributes.type_icon_url=a.icon),-1==n.rootoccurrence&&(n.rootoccurrence=s,n.occurrences.push({occurrenceid:s,nodeid:o}),i.set(a.resourceid,s),++s),++o}return t&&t.returnIdCounters&&(n.nextNodeId=o,n.nextOccId=s),n}})}),define("DS/LifecycleServices/LifecycleAlert",["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t){"use strict";return{_notif_manager:null,displayNotification:function(n){null===this._notif_manager&&(this._notif_manager=e,t.setNotificationManager(this._notif_manager),t.setStackingPolicy(3));var r="info";UWA.is(n.eventID)&&"primary"!==n.eventID&&(r=n.eventID),this._notif_manager.addNotif({level:r,title:n.title||"",subtitle:n.subtitle||"",message:n.msg,sticky:n.sticky||!1,category:n.category||""})},clearNotifications:function(){t.removeNotifications("","")}}}),define("DS/LifecycleServices/log",["UWA/Class"],function(e){return e.singleton({rootElement:null,inject:function(e,t){e.innerHTML='<div id="_logRoot_"></div>',this.rootElement=e.querySelector("#_logRoot_"),this.rootElement.style.height=t+"px",this.rootElement.style.border="1px solid grey",this.rootElement.style.overflow="auto"},info:function(e){this.rootElement.insertAdjacentHTML("beforeend","<div>"+e+"</div>")}})}),define("DS/LifecycleServices/IllegalCharMapping",["UWA/Controls/Abstract","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleCmd/Dictionary"],function(e,t,n){"use strict";return e.extend({init:function(){this.mappings=new n,this.types=new n},addCADType:function(e,t){return!this.mappings.find(e)&&(!this.types.find(e)&&(this.types.add(e,t),!0))},getMappings:function(){var e=this,t=[];return this.types.each(function(n,r){t.push(e._getTypeIllegalChar(n,r))}),this.types.clear(),new Promise(function(n,r){Promise.all(t).then(function(t){t.forEach(function(t){e.mappings.add(t.type,t.chars)}),n(e.mappings)}).catch(function(t){console.log("Some illegal char mapping service failed, error: "+t),n(e.mappings)})})},_getTypeIllegalChar:function(e,n){return new Promise(function(r,i){t.getCADvalidityService(e).then(function(t){return t.getInvalidCharInTitle?t.getInvalidCharInTitle():(console.warn("Illegal char implementation for:"+e+' does not implement "getInvalidCharInTitle" using default charlist:"'+n+'"'),n)}).then(function(t){r({type:e,chars:t})}).catch(function(t){console.warn("Failed to get illegal char mapping for:"+e+' using default charlist:"'+n+'" error: '+t),r({type:e,chars:null!=n?n:""})})})}})}),define("DS/LifecycleServices/DictionaryServices",["UWA/Class","UWA/Class/Options","DS/LifecycleServices/LifecycleServicesSettings","DS/WAFData/WAFData"],function(e,t,n,r){"use strict";return e.singleton(t,{init:function(){this.typeCache.push({type:"Workspace Vault",hierarchy:[]}),this.typeCache.push({type:"Workspace",hierarchy:["Project Management"]}),this.typeCache.push({type:"Personal Workspace",hierarchy:[]}),this.typeCache.push({type:"Folder",hierarchy:[]}),this.typeCache.push({type:"RootFolder",hierarchy:[]})},typeCache:[],isTypeInCache:function(e){return this.typeCache.some(function(t){return t.type===e})},isKindOfFromCache:function(e,t){var n=this.typeCache.filter(function(e){return e.type===t})[0];return n?e.some(function(e){return n.hierarchy.indexOf(e)>=0}):void console.log("isKindOfFromCache: Called when type is not in cache!")},getIsKindOfPromise:function(e,t,n){var r=this;return new UWA.Class.Promise(function(i,o){r.isKindOf(e,t,n,function(e){i(e)})})},isKindOf:function(e,t,i,o){var s=this,a=!1,c=!1;if(t.some(function(e){return e===i})&&(a=!0,c=!0),c)o(c);else if(s.isTypeInCache(i)&&(a=!0,c=s.isKindOfFromCache(t,i)),a)o(c);else{var l=n.get3DSpaceWSUrl(e,"/resources/enong/dico/gettypeshierarchy",null),u={types:[i]};r.authenticatedRequest(l,{method:"POST",type:"json",timeout:6e4,data:UWA.Json.encode(u),headers:n.getHeaders(),onComplete:function(e){console.log("gettypeshierarchy: onComplete:"+e);var n=!1;if(e.hasOwnProperty("types_hierarchies")&&e.types_hierarchies.length>0){var r=e.types_hierarchies[0];s.isTypeInCache(i)||s.typeCache.push(r),r.type===i&&(n=t.some(function(e){return r.hierarchy.indexOf(e)>=0},this))}o(n)},onFailure:function(e){console.log("gettypeshierarchy: onFailure:"+e)},onTimeout:function(){console.log("gettypeshierarchy: onTimeout: A connection timeout occured.")}})}}})}),define("DS/LifecycleServices/LifecyclePerfTimer",["DS/LifecycleServices/LifecycleServicesSettings","DS/WAFData/WAFData","UWA/Widget","DS/ENOFloatingPanel/ENOFloatingPanel"],function(e,t,n,r){"use strict";function i(){this._name="",this._sections={},this._options={}}var o;return i.prototype={init:function(e,t){e&&(this._name=e),t&&(this._options=t),this._sections={}},stop:function(e){if(this.getSectionIsRunning(e)){this.setSectionIsRunning(e,!1);var t=Date.now(),n=this.getStartMs(e);0!=n&&this.setInterval(e,n,t)}},start:function(e){if(!this.getSectionIsRunning(e)){this.setSectionIsRunning(e,!0);var t=Date.now();this.setStartMs(e,t)}},getTotalMs:function(e){var t=0;if(this._sections[e]&&this._sections[e].intervals)for(let r=0;r<this._sections[e].intervals.length;++r){const i=this._sections[e].intervals[r];var n=i.startMs;t=t+i.endMs-n}return t},getTotalMinutesAndSeconds:function(e){var t=this.getTotalMs(e);return this.millisToMinutesAndSeconds(t)},printTime:function(e){if(void 0===this._sections[e])console.log(e+" has not been executed or measured");else{var t=this.getTotalMinutesAndSeconds(e);console.log(e+"  "+t)}},getStartMs:function(e){var t=0;return this._sections[e]&&this._sections[e].currentStartMs&&(t=this._sections[e].currentStartMs),t},setStartMs:function(e,t){void 0===this._sections[e]&&(this._sections[e]={}),this._sections[e].currentStartMs=t},setSectionIsRunning:function(e,t){void 0===this._sections[e]&&(this._sections[e]={}),this._sections[e].isRunning=t},getSectionIsRunning:function(e){return void 0!==this._sections[e]&&this._sections[e].isRunning},setInterval:function(e,t,n){void 0===this._sections[e]&&(this._sections[e]={}),void 0===this._sections[e].intervals&&(this._sections[e].intervals=[]);var r={};r.startMs=t,r.endMs=n,this._sections[e].intervals.push(r)},millisToMinutesAndSeconds:function(e){var t=Math.floor(e/6e4),n=Math.trunc(e%6e4/1e3),r=Math.trunc(e%6e4%1e3/10),i=":"+n;return 0==n?i=":00":n<10&&(i=":0"+n),t+i+"."+(0==r?"00":(r<10?"0":"")+r)},launchDialog:function(e){if(null!=e){var t=new n;t.body=UWA.extend(document.body);var i="<head><style>pre {outline: 1px solid #ccc; padding: 5px; margin: 5px; overflow-y:scroll; height: 100%; width: 100% } .row { display: flex;} ";i+=" .column { flex: 50%; padding: 10px;} </style> </head> <body>",i+=' <h2>Timing Run</h2> <div class="row"> <div class="column" style="background-color:#FFF;"> ',i+=" <p>"+JSON.stringify(e)+"</p> ";var o=new r({className:"LifecycleCommandCheck_Dlg",title:"Report",body:i+=" </div> </div> </body> ",overlay:!0,escapeToClose:!0,closable:!0,animate:!0,resizable:!0,maximizable:!0,autocenter:!0,visible:!0,limitParent:!0});o.getBody().style.overflowY="scroll",o.getBody().style.overflowX="scroll",o.inject(t.body)}},printTimeShowDialogAndProcess:function(n,r,i){var o=this;for(let e=0;e<n.length;++e){var s=n[e];o.printTime(s)}i&&console.log(i);var a=e.get3DSpaceWSUrl(this.tenant,"/resources/lifecycle/util/getExpressionAndUser",null);t.authenticatedRequest(a,{method:"GET",headers:e.getHeaders(encodeURIComponent(r)),timeout:288e5,data:{expression:"LifecyclePerfTimerExpression"},onComplete:function(e){console.log("fetchOfExpression: completed"),console.log(e);var t="";if(null!=e){var r={},s="";e.result&&(t=e.result,r=JSON.parse(t)),e.user&&(s=e.user);var a="",c=!1;if(r.all&&(a=r.all),""!==s&&r[s]&&(a=r[s]),a.showDialog&&"true"===a.showDialog&&(c=!0),a.doPostAnalysis&&a.doPostAnalysis,!0===c){var l=[];for(let e=0;e<n.length;++e){var u=n[e],d={section:u,time:o.getTotalMinutesAndSeconds(u)};l.push(d)}i&&l.push(i),o.launchDialog(l)}}},onFailure:function(e,t){console.log("Failed to retrive data from the server")},onTimeout:function(e){console.log("Timed out on trying to retrive data from the server")},type:"json"})}},o||(o=new i)}),Element.prototype.replaceWith||(Element.prototype.replaceWith=ReplaceWithPolyfill),CharacterData.prototype.replaceWith||(CharacterData.prototype.replaceWith=ReplaceWithPolyfill),DocumentType.prototype.replaceWith||(DocumentType.prototype.replaceWith=ReplaceWithPolyfill);var _get=function(e,t){return t.split(".").reduce(function(e,t){return null==e?e:e[t]},e)};define("DS/LifecycleServices/HTMLTemplating",["UWA/Class","UWA/Controls/Abstract","DS/LifecycleServices/Utils","DS/LifecycleCmd/Dictionary","DS/Controls/Button","DS/Controls/LineEditor","DS/Controls/Toggle","DS/Controls/ComboBox","DS/Controls/ButtonGroup","DS/Utilities/TouchUtils"],function(e,t,n,r,i,o,s,a,c,l){"use strict";return e.singleton({_isTouchMode:void 0,Expand:function(e,t,n){var r=t?e.replace(/\{\{(.*?)\}\}/g,function(e){return e=(e=e.replace("{{","")).replace("}}",""),"function"==typeof t[e]?t[e]():t[e]}):e;return n&&(r=r.replace(/\[\[(.*?)\]\]/g,function(e){return e=(e=e.replace("[[","")).replace("]]",""),n[e]?n[e]:e})),r},ElementFromTemplate:function(e,t,r,i,o){r=n.createDbgNlsProxy(r);var s=this.Expand(e,t,r),a=n.htmlFromString(s);return i&&Array.prototype.slice.call(a.querySelectorAll("*[id]")).forEach(function(e){e.setAttribute("id",i+e.id)}),a.inject=function(e){e.appendChild(a)},this._replaceControls(a),o&&this._applyBindings(a,o),this._setTouchAttribute(a),a},isTouchMode:function(){return void 0===this._isTouchMode&&(this._isTouchMode=!!l.getTouchMode()),this._isTouchMode},_setTouchAttribute:function(e){var t=this;Array.prototype.slice.call(e.querySelectorAll(".is-mobile")).forEach(function(e){t.isTouchMode()&&e.setAttribute("touch-mode","")})},_applyBindings:function(e,t){var n=0,r=1,i=2,o=3,s=0,a=1,c=2,l=3,u=function(e){var t={type:n,event:s,key:-1,fn:null,property:null};return e.forEach(function(e){var n=e.split("=");if(2==n.length){var u=n[0].trim(),d=n[1].trim();if("event"===u)t.event=function(e){var t={click:a,change:c,keydown:l};if(t.hasOwnProperty(e))return t[e];for(var n in console.error("Invalid event binding: ",e),console.error("Supported bindings:"),t)t.hasOwnProperty(n)&&console.log(n);return s}(d),t.type=r;else if("function"===u)t.fn=d;else if("key"===u)t.key=parseInt(d);else if("attribute"===u)if("value"===d)t.type=i;else{if("wuxchecked"!==d)return void console.error("Currently unsupported attribute binding: ",d);t.type=o}else"property"===u&&(t.property=d)}}),t},d=function(e,t,n){return"function"==typeof t[n]||(console.error("Invalid binding, missing function"),console.error("Binding function: "+n),console.error("Element ID: "+e.id),!1)};Array.prototype.slice.call(e.querySelectorAll("[data-bind]")).forEach(function(e){e.getAttribute("data-bind").split(";").forEach(function(n){var s=n.split(",");if(!(s.length<2)){var f=u(s);f.type===r?f.event===a?function(e,t,n){if(d(e,n,t)){var r=n[t];"ComboBox"===e.wuxControlType&&(r=function(e){e.dsModel&&n[t]()}),e.addEventListener("click",r)}}(e,f.fn,t):f.event===c?function(e,t,n){if(d(e,n,t)){var r=[];if("Toggle"===e.wuxControlType){var i=function(e){n[t](e.dsModel?e.dsModel.checkFlag:void 0,e)};r.push({event:"change",fn:i})}else"ComboBox"===e.wuxControlType?(i=function(e){n[t](e.dsModel?e.dsModel.currentValue:void 0,_get(e,"event.dsModel.elements.popup.visibleFlag"),e)},r.push({event:"change",fn:i})):"LineEditor"===e.wuxControlType?(i=function(e){n[t](e.dsModel?e.dsModel.value:void 0,!0,e)},r.push({event:"change",fn:i}),r.push({event:"uncommittedChange",fn:function(e){n[t](e.dsModel?e.dsModel._properties.valueToCommit.value:void 0,!1,e)}})):console.error("Fix binding to new type!");r.forEach(function(t){e.addEventListener(t.event,t.fn)})}}(e,f.fn,t):f.event===l&&function(e,t,n,r){d(e,r,n)&&e.addEventListener("keydown",function(e){e.keyCode===t&&r[n]()})}(e,f.key,f.fn,t):f.type===i?function(e,t,n){if("function"==typeof n.setProperty)return"LineEditor"!==e.wuxControlType?(console.error("Invalid value binding, element type currently unsupported"),void console.error("Element ID: "+e.id)):void("LineEditor"===e.wuxControlType&&(e.wuxControl.addEventListener("change",function(e){n.setProperty(t,e.dsModel.value)}),e.wuxControl.addEventListener("uncommittedChange",function(e){n.setProperty(t,e.dsModel._properties.valueToCommit.value)})));console.error("Invalid value binding, model missing setProperty()")}(e,f.property,t):f.type===o&&function(e,t,n){e.wuxControl&&"Toggle"===e.wuxControlType&&(void 0!==n[t]&&(e.wuxControl.checkFlag=n[t]),e.wuxControl.addEventListener("change",function(e){void 0!==n[t]&&(n[t]=event.dsModel?event.dsModel.checkFlag:void 0)}))}(e,f.property,t)}})})},_replaceControls:function(e){var n=function(e,t){if(e){var n={};e.split(";").forEach(function(e){var t=e.split(":");2===t.length&&(n[t[0].trim()]=t[1].trim())}),t.setStyles(n)}},l=function(e,t,r){var i=t.getContent();i.id=e.id,i.wuxControl=t,i.wuxControlType=r,n(e.getAttribute("data-wuxstyle"),i),n(e.getAttribute("style"),i),function(e,t){e.className.split(" ").forEach(function(e){t.addClassName(e)})}(e,i),function(e,t){["data-bind"].forEach(function(n){var r=e.getAttribute(n);r&&t.setAttribute(n,r)})}(e,i),e.replaceWith(i)};var u=function(e,t,n){var r=Array.prototype.slice.call(e.querySelectorAll("option")).map(function(e){return{labelItem:e.text,valueItem:e.value}});0===r.length&&(r=function(e){var t=e.innerText;if(t.split)return t.split(",")}(e));var i=e.getAttribute("data-wuxDisplayStyle");return i||(i=e.getAttribute("displayStyle")),new a({elementsList:r,enableSearchFlag:t,actionOnClickFlag:n,displayStyle:i})},d={LineEditor:function(e){var t=e.getAttribute("data-wuxplaceholder");t||(t=e.getAttribute("placeholder"));var n=new o({placeholder:t});return l(e,n,"LineEditor"),n},Button:function(e){var t=e.getAttribute("data-wuxlabel");t||(t=e.innerText);var n=new i({label:t});return l(e,n,"Button"),n},Checkbox:function(e){var t=e.getAttribute("data-wuxlabel");t||(t=e.innerText);var n=e.checked;void 0===n&&(n=e.getAttribute("checked"));var r=new s({type:"checkbox",checkFlag:n,label:t});return l(e,r,"Toggle"),r},Radio:function(e){var t=e.getAttribute("data-wuxlabel"),n=e.getAttribute("data-wuxchecked");t||(t=e.innerText),n||(n=e.getAttribute("checked"));var r=new s({type:"radio",label:t,checkFlag:"true"===n});return l(e,r,"Toggle"),r},Combo:function(e){var t=u(e,!1,!1);return l(e,t,"ComboBox"),t},DropdownBtn:function(e){var t=u(e,!1,!0);return l(e,t,"ComboBox"),t}},f={Radio:function(e){var t=e.getAttribute("data-wuxlabel"),n=e.getAttribute("data-wuxchecked"),r=new s({type:"radio",label:t,checkFlag:"true"===n}),i=r.getContent();return i.id=e.id,i.wuxControl=r,i.wuxControlType="Toggle",r}},h=t.extend({init:function(){this.elements=[]},add:function(e){this.elements.push(e)},create:function(){var e=new c({type:"radio"});this.elements.forEach(function(t){e.addChild(t.factory(t.element))}),l(this.elements[0].element,e),e.getContent().id="",this.elements.splice(1).forEach(function(e){var t=e.element;t.parentElement.removeChild(t)})}}),p=new r;Array.prototype.slice.call(e.querySelectorAll("[data-wuxcontrol]")).forEach(function(e){var t=function(e){var t=e.getAttribute("data-wuxcontrol"),n=e.getAttribute("data-wuxgroup");if(n){var r=p.find(n);return r||(r=new h)&&p.add(n,r),r?(r.add({element:e,factory:f[t]}),{create:function(){console.error("Dont call")},isGroup:!0}):null}var i=d[t];return i?{create:i,isGroup:!1}:null}(e);t&&!1===t.isGroup&&t.create(e)}),p.each(function(e,t){t.create()}),Array.prototype.slice.call(e.querySelectorAll("[data-delete-element]")).forEach(function(e){e.parentElement.removeChild(e)});[{tag:"wuxbutton",factory:"Button"},{tag:"wuxcombo",factory:"Combo"},{tag:"wuxcheckbox",factory:"Checkbox"},{tag:"wuxlineEditor",factory:"LineEditor"},{tag:"wuxradio",factory:"Radio"},{tag:"wuxdropdownButton",factory:"DropdownBtn"}].forEach(function(t){Array.prototype.slice.call(e.querySelectorAll(t.tag)).forEach(function(e){var n=d[t.factory];n&&n(e)})})}})}),define("DS/LifecycleServices/Notification",["DS/LifecycleServices/LifecycleAlert"],function(e){"use strict";return{displayError:function(e,t){this.displayNotification(e,{eventID:"error",msg:t})},displayWarning:function(e,t){this.displayNotification(e,{eventID:"warning",msg:t})},displayInfo:function(e,t){this.displayNotification(e,{eventID:"info",msg:t})},displayNotification:function(e,t){var n;if(e&&UWA.is(e.displayNotification,"function"))return n=UWA.is(t,"string")?{eventID:"warning",msg:t}:t,void e.displayNotification(n);this._displayAlert(t)},_displayAlert:function(t){var n;n=UWA.is(t,"string")?{msg:t}:t,e.displayNotification(n)}}}),define("DS/LifecycleServices/LifecycleServices",["UWA/Array","UWA/Class","UWA/Class/Options","UWA/Class/Promise","DS/LifecycleServices/LifecycleServicesSettings","DS/WAFData/WAFData","DS/LifecycleServices/AssemblyJson","DS/WidgetServices/WidgetServices","DS/UIKIT/SuperModal","DS/PADUtils/PADSettingsMgt","text!DS/LifecycleServices/assets/x3DSpaceResources.properties","i18n!DS/LifecycleServices/assets/nls/LifecycleServicesNls","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls"],function(e,t,n,r,i,o,s,a,c,l,u,d,f){"use strict";function h(e,t,n,r,i,s,c){var l=-1!=e.indexOf("?")?"&":"?",u=r.tenant?r.tenant:"OnPremise",d=r.url3DSpace+e+l+"tenant="+u,f={headers:{"Accept-Language":a.getLanguage(),Accept:"application/json","Content-Type":"application/json",SecurityContext:encodeURIComponent(r.securityContext)},method:1==t?"POST":"GET",type:"json",timeout:i,proxy:"passport",onComplete:s,onFailure:c};t&&(f.data=n),o.authenticatedRequest(d,f)}function p(e,t,n,r,i,o){h(e,!0,UWA.Json.encode(t),n,r,i,o)}var v=t.singleton(n,{init:function(){},isBaselineMode:function(e,t){var n=!1;return t&&Array.isArray(t.allowedSemantics)&&t.allowedSemantics.forEach(function(t){Array.isArray(t.mode)&&t.mode.indexOf("baseline")>=0&&(e?e===t.id&&(n=!0):n=!0)}),n},isFirstSemantic:function(e,t){var n=!1;return t&&Array.isArray(t.allowedSemantics)&&t.allowedSemantics.forEach(function(t){Array.isArray(t.semantic)&&t.semantic.indexOf("FIRST")>=0&&(e?e===t.id&&(n=!0):n=!0)}),n},getAllowedSemanticsPromise:function(e,t,n){var r=[];return e.forEach(function(e){r.push({id:e})}),new UWA.Class.Promise(function(e,s){v.getSecurityContextPromise(i.getTenant(),t).then(function(t){var a={allowedSemantics:r,output:{infos:"version"}};n&&n.nlsintents&&(a.output.nlsintents=!0);var c=JSON.stringify(a),l=null;n&&n.scope&&(l="scope="+n.scope);var u=i.get3DSpaceWSUrl(i.getTenant(),"/resources/v1/dslc/getallowedsemantics",l);o.authenticatedRequest(u,{method:"POST",headers:i.getHeaders(encodeURIComponent(t)),timeout:6e5,onComplete:function(t){e(t)},data:c,onFailure:function(e,t){var n=v.parseWebServiceError(e,t);s(n)},type:"json"})})})},getVersionNumberProposalPromise:function(e,t,n,r){var s=[];return e.forEach(function(e){var r={copyId:e};t&&(r.ancestors=[{semantic:t,id:e}]),n&&(r.prefix=n),s.push(r)}),new UWA.Class.Promise(function(e,t){v.getSecurityContextPromise(i.getTenant(),r).then(function(n){var r={addRequests:s},a=JSON.stringify(r),c=i.get3DSpaceWSUrl(i.getTenant(),"/resources/v1/dslc/getversionnumberproposal",null);o.authenticatedRequest(c,{method:"POST",headers:i.getHeaders(encodeURIComponent(n)),timeout:6e5,onComplete:function(t){e(t)},data:a,onFailure:function(e,n){var r=v.parseWebServiceError(e,n);t(r)},type:"json"})})})},_getAncestorsPromise:function(e,t){return new UWA.Class.Promise(function(t,n){v.getSecurityContextPromise(i.getTenant()).then(function(r){var s=i.get3DSpaceWSUrl(i.getTenant(),"/resources/v1/dslc/versiongraph/"+e,null);o.authenticatedRequest(s,{method:"GET",headers:i.getHeaders(encodeURIComponent(r)),timeout:6e5,onComplete:function(n){var r=JSON.parse(n).graphs[0].versions.find(t=>t.id===e).ancestors;t(r)},data:"",onFailure:function(e,t){var r=v.parseWebServiceError(e,t);n(r)}})})})},hasFilter:function(e,t){return e&&e._biFilter&&e._biFilter.hasFilter?e._biFilter.hasFilter(t):!(!e||!e.hasFilter)&&e.hasFilter(t)},getPublicFilterSpecificationPromise:function(e,t){return new r(function(n,r){e&&e._biFilter&&e._biFilter.getPublicFilterSpecification?(e._biFilter.removeEvent(t.eventName),e._biFilter.addEvent(t.eventName,function(e){n(e)}),e._biFilter.getPublicFilterSpecification(t)):r()})},createFirstConfigurationRevisionPromise:function(e,t,n){return new UWA.Class.Promise(function(r,s){v.getSecurityContextPromise(i.getTenant()).then(function(a){var c={addRequests:[{copyId:e,code:t,ancestors:[{id:e,semantic:"FIRST"}],attributes:[{name:"description",value:n}]}]},l=JSON.stringify(c),u=i.get3DSpaceWSUrl(i.getTenant(),"/resources/v1/dslc/addversions",null);o.authenticatedRequest(u,{method:"POST",headers:i.getHeaders(encodeURIComponent(a)),timeout:6e5,onComplete:function(e){r(e)},data:l,onFailure:function(e,t){var n=v.parseWebServiceError(e,t);s(n)},type:"json"})})})},getAssemblyInfo:function(e,t,n,r){""!=t?v.listAttributes(e,[t],["name","owner","modified.generic","originated.generic","attribute[PLMEntity.V_description]"],function(e){var t=e.results[0],r=t.physicalid,i=t.name,o=t.ownerFullName;null==o&&(o=t.owner);var s=t["modified.generic"],a=t["originated.generic"],c=t["attribute[PLMEntity.V_description]"];null==c&&(c="");n({physicalid:r,title:i,owner:o,mod:s,originated:a,desc:c,thumbnailUrl:""})},function(e){r(e)}):n(null)},expandAssembly2:function(e,t,n,r){var i=this;this.expandAssembly2D(e,t,function(o){var a=s.convertFromExpandFormat(o,!1);i.expandAssembly3D(e,t,function(e){for(var t=s.convertFromExpandFormat(e,!1),r=s.Assembly(t),i=s.Assembly(a),o=i.getNodeCount(),c=0;c<o;c++){var l=i.getNode(c),u=l.getAttribute("physicalid"),d=r.getNodeByPhysicalId(u).getAttribute("cgrurl");l.setAttribute("cgrurl",d)}n(a)},function(e){console.log(e),r(e)})},function(e){console.log(e),r(e)})},expandAssembly:function(e,t,n,r){this.expandAssemblyNoConversion(e,t,function(e){var t=s.convertFromExpandFormat(e,!1);n(t)},function(e){console.log(e),r(e)})},expandAssemblyNoConversion:function(e,t,n,r){this.expandAssemblyWithIntent(e,t,"compareExpand",n,r)},expandAssembly2D:function(e,t,n,r){this.expandAssemblyWithIntent(e,t,"explore_2D",n,r)},expandAssembly3D:function(e,t,n,r){this.expandAssemblyWithIntent(e,t,"explore_3D",n,r)},expandAssemblyWithIntent:function(e,t,n,r,s){var a={intent:n,debug:!1,type_filter_bo:["CATProduct","CATProcess","CATPart","CATDrawing","CATAnalysis","VPMReference","VPMRepReference","CATIA Embedded Component","3DShape","CATIA CGR","CATShape","CATIA V4 Model","CATIA Design Table"],roots:[{id:t}],level:"-1",source:"cstorage",select_bo:["did","resourceid","relcount","physicalid","ds6w:label","ds6w:reserved","ds6wg:revision","ds6w:description","ds6w:modified","ds6w:created","ds6w:responsible","type_icon_url","ds6w:type","ds6w:policy","ds6w:organizationResponsible","ds6w:project","ds6w:reservedBy","thumbnail_2d","thumbnail_3d"],authored:!0},c=i.get3DSpaceWSUrl(e,"/resources/enopad/navigate/expand",null);o.authenticatedRequest(c,{method:"POST",headers:i.getHeaders(),timeout:864e5,data:JSON.stringify(a),type:"json",onComplete:function(e){r(e)},onFailure:function(e){s(e)},onTimeout:function(){s("timeout")}})},formatDate:function(e,t){return e=(e=a.formatDate(e,!0)).replace(", "," ")},listAttributes:function(e,t,n,r,i){for(var o=[],s=t.length,a=0;a<s;a++){var c=t[a];o.push({physicalid:c})}var l={data:o,attributes:n};this.post(e,"/resources/lifecycle/product/attributeList",l,function(e){r(e)},function(e){i(e)})},listAttributesPromise:function(e,t,n){var r=this;return new UWA.Class.Promise(function(i,o){r.listAttributes(e,t,n,function(e){i(e)},function(e){o(e)})})},getAttributeDisplayName:function(e){return"revision"==e||"code"==e?d.rev:"owner"==e?d.owner:"description"==e||"PLMEntity.V_description"==e?d.desc:"policy"==e||"policyTranslated"==e||"policy_nls"===e?d.policy:"modified"==e?d.mDate:"originated"==e||"creationDate"===e?d.cDate:"type"==e||"type_nls"===e?d.type:"project"==e?d.collSpace:"isdup"==e?d.isDup:"islast"==e?d.isLastRev:"title"==e||"displayName"==e?d.title:"newTitle"==e?d.newTitle:"ispublished"==e?d.published:"current"==e||"maturitystate"===e?d.maturitystate:"maturityNls"==e||"maturity_nls"==e?d.maturity:"PLMReference.V_versionComment"==e?d.comment:"locked"==e?d.reserved:"reserved"==e?d.reserved:"reservedby"==e?d.reservedby:"locker"==e?d.reservedby:"organization"==e?d.organization:"vault"==e?d.vault:"maturity"==e?d.maturity:d[e]},getAttributeDisplayNames:function(e){for(var t=[],n=e.length,r=0;r<n;r++){var i=this.getAttributeDisplayName(e[r]);t.push(i)}return t},getTypeIcon:function(e,t){var n=this,r="x3DSpaceResources.smallIcon.type_"+t.replace(/\s+/g,"");null==n.typeIcons&&(n.typeIcons={},u.split("\n").forEach(function(t){if(""!=t.trim()){var r=t.split(" = "),o=r[0].trim(),s=r[1].trim(),a=i.get3DSpaceWSUrl(e,"/snresources/images/icons/small/"+s,null);n.typeIcons[o]=a}}));var o=n.typeIcons[r];null==o&&(o=i.get3DSpaceWSUrl(e,"/snresources/images/icons/small/I_CDM_Document.png"));return o},get:function(e,t,n,r,s){var a=this,c=Date.now().toString();n["timestamp"+c]=c,v.getSecurityContext(e,function(c){var l=i.get3DSpaceWSUrl(e,t,null);for(var u in-1!=l.indexOf("?")?l+="&":l+="?",n){l+=u+"="+n[u]+"&"}o.authenticatedRequest(l,{method:"GET",headers:i.getHeaders(c),timeout:864e5,type:"json",onComplete:function(e){r(e)},onFailure:function(e,t){a.onWebServiceError(s,e,t)},onTimeout:function(){a.onWebServiceError(s,null,d.timeout)}})},function(e){a.onWebServiceError(s,null,e)})},post:function(e,t,n,r,s){var a=this;v.getSecurityContextPromise(e).then(function(c){var l=i.get3DSpaceWSUrl(e,t,null);o.authenticatedRequest(l,{method:"POST",headers:i.getHeaders(c),timeout:864e5,data:UWA.Json.encode(n),type:"json",onComplete:function(e){r(e)},onFailure:function(e,t){a.onWebServiceError(s,e,t)},onTimeout:function(){a.onWebServiceError(s,null,d.timeout)}})})},_getSecurityContextFromPreferencesOrOptions:function(e){if("function"==typeof widget.hasPreference&&widget.hasPreference("xPref_CREDENTIAL")){var t=widget.getPreference("xPref_CREDENTIAL");if(void 0!==t.value&&null!==t.value&&t.hasOwnProperty("value"))return"ctx::"+t.value}if("function"==typeof widget.hasPreference&&null!=widget.getPreference("pad_security_ctx"))return widget.getPreference("pad_security_ctx").value;if("function"==typeof widget.hasPreference&&widget.hasPreference("securityContext"))return widget.getPreference("securityContext").value;var n=i.getOption(e,null);return n&&n.hasOwnProperty("defaultValue")?"ctx::"+n.defaultValue:null},getSecurityContextForCollaborativeSharingCommands:function(){var e={tenant:{label:"onPremises",value:""},SecurityContext:""};if(e.tenant.value=i.getTenant(),widget.hasPreference("xPref_CREDENTIAL")){var t=widget.getPreference("xPref_CREDENTIAL");return void 0!==t.value&&null!==t.value&&t.hasOwnProperty("value")&&(e.SecurityContext="ctx::"+t.value),e}return null!=widget.getPreference("pad_security_ctx")?widget.getPreference("pad_security_ctx").value:null},_getSecurityContextFromContext:function(e){if(!e)return null;if("function"!=typeof e.getSecurityContext)return null;var t=e.getSecurityContext();return t&&t.hasOwnProperty("SecurityContext")?t.SecurityContext:null},getSecurityContextPromise:function(e,t){var n=this._getSecurityContextFromContext(t),r=this._getSecurityContextFromPreferencesOrOptions(e);return n?new UWA.Class.Promise.resolve(n):r?new UWA.Class.Promise.resolve(r):(this._getSecCtxPromise||(this._getSecCtxPromise=new UWA.Class.Promise(function(t,n){v.getSecurityContext(e,function(e){t(e)},function(e){n(e)})})),this._getSecCtxPromise)},getSecurityContext:function(e,t,n){var r=i.get3DSpaceWSUrl(e,"/resources/pno/person/getsecuritycontext",null);o.authenticatedRequest(r,{type:"json",method:"GET",proxy:"passport",headers:i.getHeaders(),timeout:6e5,onComplete:function(e){var r="";if(null!=e&&""!=e&&e.hasOwnProperty("SecurityContext")&&null!=e.SecurityContext){(r=e.SecurityContext.replace("ctx::","")).trim().length>0&&(r="ctx::"+e.SecurityContext),t(r)}else n(f.ErrorSecurityContextEmpty)},onFailure:function(e,t){console.log("getSecurityContext:Failure..."+e),v.onWebServiceError(n,e,t)},ontimeout:function(){console.log("getSecurityContext: A connection timeout occurred."),v.onWebServiceError(n,null,f.connectionTimeout)}})},getSecurityContextList:function(e,t){var n=e;i.get3DSpaceWSUrl(e,"/resources/modeler/pno/person","current=true&select=preferredcredentials&select=collabspaces");require(["DS/ENOXWidgetPreferences/js/ENOXWidgetPreferences"],function(e){var r=e.getCredentialPreferenceKey(),o=e.getPlatformPreferenceKey();if(!1===widget.hasPreference(o))console.log(widget.hasPreference(o)),console.log(widget.getPreference(o)),e.addPlatformSelectionPreferenceToWidget({roles:["CSV"]});else{var s=widget.getPreference(o);console.log(s),e.addPlatformSelectionPreferenceToWidget(s)}e.addCredentialPreferenceToWidget({usePreferredCredentials:!0},1).then(function(){var e=widget.getValue(r),o=widget.preferences[0].label,s=widget.preferences[0].options;i.setOption(n,{label:o,name:"xPref_CREDENTIAL",options:s,type:"list",value:e}),t()},function(){})},function(){})},getCsrfKeyPromise:function(e){var t=this;return new UWA.Class.Promise(function(n,r){t._csrfKey?n(t._csrfKey):v.getCsrfKey(e,function(e){t._csrfKey=e,n(t._csrfKey)},function(e){r(e)})})},getCsrfKey:function(e,t,n){var r=i.get3DSpaceWSUrl(e,"/resources/v1/application/E6WFoundation/CSRF",null);o.authenticatedRequest(r,{type:"json",method:"GET",proxy:"passport",headers:i.getHeaders(),timeout:6e5,onComplete:function(e){e&&e.csrf?t(e.csrf):n(f.ErrorCsrfKeyEmpty)},onFailure:function(e,t){console.log("getCsrfKey:Failure..."+e),v.onWebServiceError(n,e,t)},ontimeout:function(){console.log("getCsrfKey: A connection timeout occurred."),v.onWebServiceError(n,null,f.connectionTimeout)}})},getOslcConfigPromise:function(){var e=this;return new UWA.Class.Promise(function(t,n){e._oslcConfig?t(e._oslcConfig):require(["text!DS/OSLCConsumer/assets/OSLCConfig.json"],function(n){var r=JSON.parse(n);e._oslcConfig=r,t(e._oslcConfig)},function(){n(d.ErrorOslcConfig)})})},getHistoryConfigPromise:function(){var e=this;return new UWA.Class.Promise(function(t,n){null!=e._historyConfig?t(e._historyConfig):require(["text!DS/HistoryExplorer/assets/HistoryExplorerCustomConfig.json"],function(r){if(""===r)e._historyConfig=null,n();else{var i=JSON.parse(r);e._historyConfig=i,t(e._historyConfig)}},function(){e._historyConfig=null,n()})})},oslcRequest:function(t,n,r,i){var o,s=this;this.getOslcConfigPromise().then(function(a){var c=e.detect(a.repositories,function(e){return e.id&&""==n?(console.log("getting default 1rst repository definition ",e.id),e.id):e.id===n});c?(""==r&&(console.log("getting default resourceUrl ",c.resourceUrl),r=c.resourceUrl),c.oauth?s.oauthRequest(c.oauth,t,r,i):c.parameters&&c.parameters.authorization?(i.retryIfUnauthorized=!0,o={Accept:"application/rdf+xml",Authorization:c.parameters.authorization},s._makeRequest(r,o,i)):(o={Accept:"application/rdf+xml"},s._makeRequest(r,o,i))):i.onError(d.replace(d.ErrorOslcServiceNotFound,{service:n}))},function(e){i.onError(e)})},_makeRequest:function(e,t,n){var r,i=this;if(n.headers)for(var s in n.headers)t[s]=n.headers[s];var a={method:n.method,proxy:"passport",headers:t,timeout:6e5,onComplete:n.onSuccess,onFailure:function(o,s,a){401!==r.xhr.status&&0!==r.xhr.status||!n.retryIfUnauthorized?401!==r.xhr.status&&0!==r.xhr.status||!n.oauth?i.onWebServiceError(n.onError,o,s,r.xhr.status,a):i._oauthAuthenticateUser(n.oauth,n.tenant,n.onError):(n.retryIfUnauthorized=!1,i._makeRequest(e,t,n))},ontimeout:function(){i.onWebServiceError(n.onError,null,d.timeout)}};n.data&&(a.data=n.data),r=o.authenticatedRequest(e,a)},_getAuthorizationHeaderPromise:function(e,t,n,r){return new UWA.Class.Promise(function(i,o){require(["DS/OAuthSimple/OAuthSimple"],function(){var o="xrequestedwith=xmlhttprequest",s=t.split("?");t=s[0],s.length>1&&(o=s[1]+"&"+o),n&&Object.keys(n).forEach(function(e){o+="&"+e+"="+encodeURIComponent(n[e])});var a=(new OAuthSimple).sign({action:e,path:t,parameters:o,signatures:{consumer_key:r.oauth_consumer_key,shared_secret:r.oauth_consumer_secret,access_token:r.oauth_token,oauth_secret:r.oauth_token_secret}});i(a.header)},function(e){"DS/OAuthSimple/OAuthSimple"===(e.requireModules&&e.requireModules[0])&&o(d.ErrorOAuthSimple)})})},oauthRequest:function(e,t,n,r){var i=this;this._getOauthInfoPromise(e,t).then(function(e){return i._getAuthorizationHeaderPromise(r.method,n,r.data,e)}).then(function(o){var s={Accept:"application/rdf+xml",Authorization:o};r.oauth=e,r.tenant=t,i._makeRequest(n,s,r)}).catch(function(e){r.onError(e)})},_getOauthInfoPromise:function(e,t){return new UWA.Class.Promise(function(n,r){v._getOauthInfo(e,t,function(e){n(e)},function(e){r(e)})})},_getOauthInfo:function(e,t,n,r){var s=this,a=i.getPlatformWSUrl("3DPassport",t,"oauth/access_token/"+e,null);o.authenticatedRequest(a,{type:"json",method:"GET",proxy:"passport",headers:i.getHeaders(),timeout:6e5,onComplete:function(i){"no.token.found"===i.error?s._oauthAuthenticateUser(e,t,r):i.error?r(i.error):n(i)},onFailure:function(e,t){console.log("_getOauthInfo:Failure..."+e),v.onWebServiceError(r,e,t)},ontimeout:function(){console.log("_getOauthInfo: A connection timeout occurred."),v.onWebServiceError(r,null,f.connectionTimeout)}})},_oauthAuthenticateUser:function(e,t,n){this._getAuthenticationUrlPromise(e,t).then(function(t){var r=new c({events:{onHide:function(){n(d.authorizationRequired)}},renderTo:document.body}),i=d.replace(d.authorizationDialogBody,{identityProvider:e,authenticationUrl:t}),o=i.indexOf("target=");i=[i.slice(0,o),"onclick=\"if (typeof dscef !== 'undefined') {dscef.sendString('launchOSLCAuthorization', '"+t+"'); return false;}\"",i.slice(o)].join(" "),r.dialog({body:i,title:d.authorizationDialogTitle,buttons:[{className:"primary",value:d.ok,action:function(e){e.hide()}}]})},function(e){n(e)})},_getAuthenticationUrlPromise:function(e,t){return new UWA.Class.Promise(function(n,r){v._getAuthenticationUrl(e,t,function(e){n(e)},function(e){r(e)})})},_getAuthenticationUrl:function(e,t,n,r){var s=i.getPlatformWSUrl("3DPassport",t,"oauth/authenticate/"+e,null);o.authenticatedRequest(s,{type:"json",method:"GET",proxy:"passport",headers:i.getHeaders(),timeout:6e5,onComplete:function(e){e.redirect_uri?n(e.redirect_uri):r(d.authenticationError)},onFailure:function(e,t){console.log("_getAuthenticationUrl:Failure..."+e),v.onWebServiceError(r,e,t)},ontimeout:function(){console.log("_getAuthenticationUrl: A connection timeout occurred."),v.onWebServiceError(r,null,f.connectionTimeout)}})},showWebServiceError:function(e,t,n,r){var i=null,o=null;"function"==typeof t?o=t:(i=t,o=n);var s=e;e.hasOwnProperty("error")?s=e.error:e.hasOwnProperty("message")&&(s=e.message);var a=v._parseWebServiceError(s,i,r);o(a.message,a.isNotificationInfo,a.title,a.subtitle,a.submessage)},parseWebServiceError:function(e,t,n){return this._parseWebServiceError(e,t,n,null).message},_parseWebServiceError:function(e,t,n,r){var i=e,o=null,s=null,a=null;if(null!=r&&r.trim().length>0&&(a=d.replace(d.backgroundNotifMsgWithCommandName,{commandName:r})),!t||"object"!=typeof t||e instanceof Error){if("string"==typeof e||e instanceof Error){var c=e;e instanceof Error&&(c=e.message),c.startsWith("NetworkError:")?c.endsWith('return ResponseCode with value "0".')?i=d.noConnection:c.endsWith('return ResponseCode with value "401".')||c.endsWith('return ResponseCode with value "403".')?i=d.unauthorized:c.endsWith('return ResponseCode with value "504".')?(i=null!==a?UWA.is(n,"boolean")&&n?a:d.timedOut+" "+d.verifyConnection:UWA.is(n,"boolean")&&n?d.backgroundNotifMsg:d.timedOut+" "+d.verifyConnection,o=d.timedOut,s=d.verifyConnection):i=c.endsWith('return ResponseCode with value "500".')&&t&&"object"==typeof t&&t.message?t.message:c.endsWith('return ResponseCode with value "500".')&&t&&"object"==typeof t.error&&t.error.message?t.error.message:d.webServiceError:c.startsWith("The request has timedout")?(i=null!==a?UWA.is(n,"boolean")&&n?a:d.timedOut+" "+d.verifyConnection:UWA.is(n,"boolean")&&n?d.backgroundNotifMsg:d.timedOut+" "+d.verifyConnection,o=d.timedOut,s=d.verifyConnection):"string"==typeof c?i=c:"null"===e&&(i=d.webServiceError)}}else t.error&&t.error.message?i=t.error.message:t.message?i=t.message:t.errorMessage&&(i=t.errorMessage);return{message:i,isNotificationInfo:i===d.backgroundNotifMsg||i===a,title:o,subtitle:s,submessage:null}},onWebServiceError:function(e,t,n,r,i){e(v.parseWebServiceError(t,n),r,i)},getCurrentAppName:function(e){var t=null;return e?(e.hasOwnProperty("widget")&&"object"==typeof e.widget?e.widget.hasOwnProperty("data")&&(e.widget.data.hasOwnProperty("appId")||e.widget.data.hasOwnProperty("x3dAppId"))&&(e.widget.data.hasOwnProperty("appId")?t=e.widget.data.appId:e.widget.data.hasOwnProperty("x3dAppId")&&(t=e.widget.data.x3dAppId)):e.hasOwnProperty("options")?!e.options.hasOwnProperty("x3dAppId")||"ENOPRSU_AP"!=e.options.x3dAppId&&"ENOPSTR_AP"!=e.options.x3dAppId||(t=e.options.x3dAppId):"undefined"!=typeof widget&&widget.hasOwnProperty("data")&&widget.data.hasOwnProperty("appId")&&(t=widget.data.appId),t):t},getDeletedItems:function(e,t){var n=this;i.app_initialization(function(){v.getSecurityContext(this.tenant,function(r){var s=i.get3DSpaceWSUrl(n.tenant,"/resources/lifecycle/Delete/deleteditems",null);o.authenticatedRequest(s,{method:"POST",headers:i.getHeaders(r),timeout:6e5,onComplete:function(t){console.log("getDeletedItems: onComplete:"+t),e(t)},data:"",onFailure:function(e,n){var r=v.parseWebServiceError(e,n);console.log("Failed to retrive data from the server"),t(r)},ontimeout:function(e){console.log("Timeout error"),t(d.timeout)},type:"json"})})})},isDECType:function(e){return e.startsWith("CAT")},_getAppId:function(e){try{return e.getValue("appId")}catch(e){return""}},isInLifecycleWidget:function(e){return"ENOLCMI_AP"===v._getAppId(e)},isInPSEditorWidget:function(e){return"ENOPSTE_AP"===v._getAppId(e)},isInXCADEditorWidget:function(e){return"ENOSTDE_AP"===v._getAppId(e)},translationServicePromise:function(e,t){var n=this;return new UWA.Class.Promise(function(r,i){n.post(e,"/resources/lifecycle/util/i18n",t,function(e){r(e)},function(e){i(e)})})},getEffectivityPromise:function(e){return new UWAPromise(t=>{this.loadEffectivities(e,e=>{var n=this.formatEffectivities(e);t(n)})})},formatEffectivities:function(e){var t=[];if(null==e)return console.log("unexpected effectivity"),t;var n=e.expressions;if(null==n)return console.log("unexpected effectivity"),t;for(var r=Object.keys(n),i=r.length,o=0;o<i;o++){var s=r[o],a=n[s],c=a.hasEffectivity;if("ERROR"!=c){var l=[],u={metatype:"effectivity",physicalID:s,data:l};t.push(u);var f="YES"==c?d.Yes:d.No;if(l.push({name:"Effectivity",nls:d.Effectivity,type:"string",value:[f]}),"NO"!=c){var h=a.content;if(null!=h){var p=h.Variant;null!=p&&l.push({name:"VariantOption",nls:d.VariantOption,type:"string",value:p});var v="",g="",y=h.Evolution;null!=y&&(v=null==y.Current?"":y.Current,g=null==y.Projected?"":y.Projected,l.push({name:"CurrentEvolution",nls:d.CurrentEvolution,type:"string",value:[v]}),l.push({name:"ProjectedEvolution",nls:["ProjectedEvolution"],type:"string",value:[g]}))}else console.log("unexpected effectivity")}}}return{results:t}},loadEffectivities:function(e,t){var n="/resources/modeler/configuration/navigationServices/getMultipleFilterableObjectInfo?timestamp="+(new Date).getTime().toString(),r={version:"1.0",output:{targetFormat:"TXT",withDescription:"YES",view:"ALL",domains:"ALL"},pidList:"["+e.join(",")+"]"};this.doPost(n,r,widget.getValue("x3dPlatformId"),widget.securityContext,function(e){t(e)}.bind(this),function(e){t({expressions:{}})}.bind(this))},getPropertiesPromise:function(e,t,n,i){return new r(function(r,o){("GET"==i?function(e,t,n,r,i,o){var s=-1!=e.indexOf("?")?"&":"?",a=e;for(var c in t)a+=s+c+"="+t[c],s="&";h(a,!1,null,n,r,i,o)}:p)(e,n,t,864e5,r,o)})},doPost:function(e,t,n,r,o,s){p(e,t,{url3DSpace:i.get3DSpaceBaseUrl(n),tenant:n,securityContext:r},864e5,o,s)},loadAttrs:function(e,t,n,o,s,a,c,l,u){for(var d=null,f=[],h=[],p=[],v=[],g=[],y=[],m=[],S={objectIds:[],serviceIds:[],tenant:s,securityContext:widget.securityContext},b=0;b<e.length;b++)"3DSpace"===t[b]?g.push(e[b]):"3dportfolio"===t[b]?v.push(e[b]):(S.objectIds.push(e[b]),S.serviceIds.push(t[b]));if(o.indexOf(1)>=0)for(b=0;b<n.length;b++)y.push(n[b]);if(o.indexOf(2)>=0)for(b=0;b<n.length;b++)m.push(n[b]);if(v.length){var A="",C="";if(null!=l)A="/"+l.typeInfo["dsxpfl:PortfolioVersion"].attributes.url,C=l.typeInfo["dsxpfl:PortfolioVersion"].url;else if(u&&u._RDF_SETTINGS&&u._RDF_SETTINGS._BASE_URL)C=u._RDF_SETTINGS._BASE_URL.replace("/3drdfpersist/v0","/3dportfolio"),A="/getAttrs";f.push(this.getPropertiesPromise(A,{securityContext:widget.securityContext,tenant:s,url3DSpace:C},{objectIds:v.join(",")},"GET"))}else g.length?(d={debug_properties:"",readonly:"false",navigateToMain:"true",attributes:"true",plmparameters:"true",busIDs:g,relIDs:[],lIds:[]},f.push(this.getPropertiesPromise("/resources/v1/collabServices/attributes/op/read",{tenant:s,securityContext:widget.securityContext,url3DSpace:i.get3DSpaceBaseUrl(s)},d,"POST"))):null!=c&&S.objectIds.length&&f.push(this.getFederatedAttributesPromise(S));y.length&&(d={debug_properties:"",readonly:"false",navigateToMain:"false",attributes:"true",plmparameters:"true",busIDs:[],relIDs:y,lIds:[]},h.push(this.getPropertiesPromise("/resources/v1/collabServices/attributes/op/read",{tenant:s,securityContext:widget.securityContext,url3DSpace:i.get3DSpaceBaseUrl(s)},d,"POST"))),m.length&&p.push(this.getEffectivityPromise(m));var P=f.concat(h).concat(p);r.allSettled(P).then(function(e){for(var t=[],n=0;n<e.length;n++)if("rejected"!==e[n].state){var r=e[n].value;void 0!==r&&void 0!==r.results&&null!==r.results&&(t=t.concat(r.results))}a(t)})}});return v}),define("DS/LifecycleServices/TranslationService",["UWA/Core","UWA/Controls/Abstract","UWA/Class/Promise","DS/LifecycleCmd/Set","DS/LifecycleCmd/Dictionary","DS/LifecycleServices/LifecycleServices"],function(e,t,n,r,i,o){"use strict";return t.extend({translationFailure:!1,init:function(e){this.states=new i,this.types=new r,this.policies=new r,this.handleError=e&&e.handleError||!1},addStateAndType:function(e,t){this.states.add(e,{type:t})},addStateAndId:function(e,t){this.states.add(e,{physicalid:t})},addStateAndPolicy:function(e,t){this.states.add(e,{policy:t})},addType:function(e){this.types.add(e)},addPolicy:function(e){this.policies.add(e)},initAsync:function(e){var t=this;return new UWA.Class.Promise(function(n,r){o.translationServicePromise(e,t._createPayload()).then(function(e){t._parseResponse(e),n()},function(e){t.handleError?(console.log("TranslationService translation failed: ",e),t.translationFailure=!0,n()):r(e)})})},translateState:function(e){return this.stateNls&&this.stateNls.contains(e)?this.stateNls.find(e):e},translateType:function(e){return this.typeNls&&this.typeNls.contains(e)?this.typeNls.find(e):e},translatePolicy:function(e){return this.policyNls&&this.policyNls.contains(e)?this.policyNls.find(e):e},_createPayload:function(){var e=this,t={states:[],types:[],policies:[]};return this.states.each(function(n,r){t.states.push(e._createStatePayload(n,r))}),this.types.each(function(e){t.types.push(e)}),this.policies.each(function(e){t.policies.push(e)}),t},_createStatePayload:function(e,t){var n={state:e};return UWA.merge(n,t)},_parseResponse:function(e){var t=this;this.stateNls=new i;var n=0;this.states.each(function(r){e.states&&e.states.length>n?t.stateNls.add(r,e.states[n++]):t.stateNls.add(r,r)}),this.typeNls=new i,n=0,this.types.each(function(r){e.types&&e.types.length>n?t.typeNls.add(r,e.types[n++]):t.typeNls.add(r,r)}),this.policyNls=new i,n=0,this.policies.each(function(r){e.policies&&e.policies.length>n?t.policyNls.add(r,e.policies[n++]):t.policyNls.add(r,r)})}})}),define("DS/LifecycleServices/LifecycleCommandManager",["css!DS/LifecycleServices/LifecycleServices","UWA/Core","UWA/Controls/Abstract","DS/Controls/Toggle","DS/PlatformAPI/PlatformAPI","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings","DS/UIKIT/Accordion","DS/WAFData/WAFData","i18n!DS/LifecycleWidget/assets/nls/LifecycleWidgetNls"],function(e,t,n,r,i,o,s,a,c,l){return n.extend({tenant:null,_conditionalDiv:null,_conditionalInput:null,init:function(){this.options=[]},getOptions:function(e,t,n){var r=this;o.getSecurityContextPromise(this.tenant,n).then(function(n){r._getOptions(e,t,n)}).catch(function(e){t(o.parseWebServiceError(e))})},_getOptions:function(e,t,n){var r=function(e,n){"function"==typeof t&&t(e,n)},i=this,a=s.get3DSpaceWSUrl(i.tenant,"/resources/lifecycle/"+e.command+"/options",null);c.authenticatedRequest(a,{method:"POST",type:"json",headers:s.getHeaders(n),timeout:6e5,data:JSON.stringify(e),onComplete:function(t){console.log("options for "+e.command+": COMPLETED"),console.log(t);var n={logicalDeleteSupported:!1};if(t.results&&t.results.length>0){var o=[],s=[];let e=new Set,r=!1,c=null;for(var a=0;a<t.results.length;a++){if(Array.isArray(t.results[a].options)&&t.results[a].options.length>0){let n=!1;t.results[a].options.forEach(function(t){let r=t.key+t.value,i="advanced"===t.key&&1==t.value;i&&(n=!0),e.has(r)||(i?c=t:o.push(t),e.add(r))}),n||(r=!0)}Array.isArray(t.results[a].objects)&&t.results[a].objects.length>0&&t.results[a].objects.forEach(function(e){s.push(e)})}c&&!r&&o.push(c),i.options=o,t.results[0].hasOwnProperty("logicalDelete")&&(n.logicalDeleteSupported=t.results[0].logicalDelete),n.objects=s||[]}n.options=i.options?i.options:[],n.report=t.report,n.status=t.status,t.hasExtProviders&&(n.hasExtProviders=[...t.hasExtProviders]),"failure"===n.status?r(n.report[0].error,n):i.dispatchEvent("onCompleteGetOptions",n)},onFailure:function(e,t){console.log("options:Failure..."+e),r(o.parseWebServiceError(e,t))},ontimeout:function(){console.log("options: A connection timeout occured."),r()}})},buildOptionPanel:function(e){var t=this,n=document.createElement("div");return n.className="lifecycle-options",void 0!==e&&e.forEach(function(e){var r=e.key,i=e.type,o=e.nlsKey;void 0===o&&(o=r);var s=e.value,c=e.availability;void 0===c&&(c=!0);var l=document.createElement("div");l.className="lifecycle-option",l.dataset.optionType=e.type,l.dataset.optionKey=e.key;var u=document.createElement("div");u.className="lifecycle-textOptionKey";var d=document.createElement("b");if(d.innerHTML=o,u.appendChild(d),"text"===i){void 0===s&&(s="");var f=document.createElement("div");f.className="input-validation-container",(h=document.createElement("input")).className="lifecycle-option-"+r,h.type=i,h.name=r,h.value=s,h.disabled=!c,h.addEventListener("blur",function(){e.value=h.value;var n={options:t.options};t.dispatchEvent("onModifyOptions",n)},!0),l.appendChild(u),f.appendChild(h),l.appendChild(f)}else if("checkbox"===i){var h;void 0===s&&(s=!1),(h=document.createElement("input")).className="lifecycle-option-"+r,h.type=i,h.name=r,h.disabled=!c,h.checked=s,h.addEventListener("change",function(){e.value=h.checked;var n={options:t.options};t.dispatchEvent("onModifyOptions",n)}),l.appendChild(h),l.appendChild(u);e.conditional&&!0===e.conditional&&e.conditionaltext&&t.buildConditionalDeleteDiv(e.conditionaltext,"none")}else"radio"===i||"accordion"===i&&new a({className:"filled",items:[{title:o,content:UWA.createElement("div")}],events:{onOpen:function(){var e=this.items[0].elements.content||this.items[0].content;t.dispatchEvent("onOpenAccordion",{div:e})},onClose:function(){t.dispatchEvent("onCloseAccordion")}}}).inject(l);n.appendChild(l),t._conditionalDiv&&n.appendChild(t._conditionalDiv)}),n},buildCheckboxOptionPanel:function(e){var t,n=this;if(!(void 0!==e&&Array.isArray(e)&&e.length>0))return(t=document.createElement("div")).className="lifecycle-options",t;if("checkbox"!==(e[0].type?e[0].type:"checkbox"))return n.buildObjectPanel(e);if((t=document.createElement("div")).className="lifecycle-options",void 0!==e){var i=e[0],o=i.key,s=(i.type,i.nlsKey);void 0===s&&(s=o);var a=i.value,c=i.availability;void 0===c&&(c=!0);var l=document.createElement("div");l.className="lifecycle-option-checkbox",void 0===a&&(a=!1);var u=new r({type:"checkbox",label:s,checkFlag:a});u.name=o,u.addEventListener("buttonclick",function(e){i.value=e.dsModel.checkFlag;var t={options:n.options};n.dispatchEvent("onModifyOptions",t)}),u.inject(l);i.conditional&&!0===i.conditional&&i.conditionaltext&&n.buildConditionalDeleteDiv(i.conditionaltext,"none")}return t.appendChild(l),n._conditionalDiv&&t.appendChild(n._conditionalDiv),t},buildConditionalDeletePanel:function(e){var t=document.createElement("div");return t.className="lifecycle-options",this.buildConditionalDeleteDiv(e,"block"),this._conditionalDiv&&t.appendChild(this._conditionalDiv),t},buildConditionalDeleteDiv:function(e,t){that=this,that._conditionalDiv=document.createElement("div"),that._conditionalDiv.className="lifecycle-conditional-checkbox",that._conditionalDiv.name="lifecycle-conditional-div",that._conditionalDiv.style.display=t,that._conditionalInput=new r({type:"checkbox",label:e,checkFlag:!1}),that._conditionalInput.name="conditional",that._conditionalInput.addEventListener("buttonclick",function(e){var t={};t.value=e.dsModel.checkFlag,that.dispatchEvent("onModifyConditional",t)}),that._conditionalInput.inject(that._conditionalDiv)},setDisplayStateConditionalDeleteCheckbox:function(e){that=this,that._conditionalDiv&&(!0===e?that._conditionalDiv.style.display="block":(that._conditionalDiv.style.display="none",!0===that._conditionalInput.checkFlag&&that._conditionalInput.toggle()))},findObjectDerivedFromSelection:function(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];if(void 0!==i){var o=i["attribute[PLMReference.V_DerivedFrom]"],s=i.derivedFromPhysicalid;if(void 0===s&&(s=i.derivedfromphysicalid),void 0!==o||void 0!==s)for(var a=0;a<t.length;a++){var c=t[a];if(void 0!==c){var l=c.physicalid;if(o===l||s===l){n.push(i);break}}}}}return n},setTenant:function(e){this.tenant=e}})}),define("DS/LifecycleServices/DefaultCredential",["UWA/Controls/Abstract","DS/LifecycleServices/LifecycleServices"],function(e,t){"use strict";return{loadDefaultContexCredential:e=>((e,n)=>t.getSecurityContextPromise(e,n))(e.tenant,e.context).then(e=>UWA.Promise.resolve((e=>e.startsWith&&e.startsWith("ctx::")?e:"ctx::"+e)(e)))}}),define("DS/LifecycleServices/OSLCServicesHelper",["UWA/Class","DS/LifecycleServices/XMLDocHelper","DS/LifecycleServices/LifecycleServices"],function(e,t,n){"use strict";return{ServiceProvider:e.extend({xmlDoc:void 0,operationTypes:{CREATION_DIALOG:"oslc:creationDialog",SELECTION_DIALOG:"oslc:selectionDialog"},init:function(e){this.xmlDoc=t.loadXMLDoc(e)},getServiceDetails:function(e,n,r,i){var o,s=[];if(1===(e=t.filterDescendants([this.xmlDoc],{tag:"oslc:ServiceProvider",attrList:{"rdf:about":{value:e,allowPartialMatch:!0}}})).length){o=t.filterDescendants(e,{tag:n}),o=t.filterIfDescendantElementExists(o,{tag:"oslc:resourceType",attrList:{"rdf:resource":{value:r}}}),i&&(o=t.filterIfDescendantElementExists(o,{tag:"oslc:usage",attrList:{"rdf:resource":{value:"#default",allowPartialMatch:!0}}}));for(var a=0,c=o.length;a<c;a++){for(var l=t.getChildren(t.filterChildren(o.slice(a,a+1))[0]),u={},d=0,f=l.length;d<f;d++){var h=l[d],p=t.getNodeInfo(h);u[p.tag]=p}s.push(u)}}return s}}),ProjectAreaCatalog:e.extend({xmlDoc:void 0,serviceProviderList:[],init:function(e){this.serviceProviderList.length=0,this.xmlDoc=t.loadXMLDoc(e);for(var n=t.filterDescendants([this.xmlDoc],{tag:"oslc:ServiceProvider"}),r=0,i=n.length;r<i;r++){var o=t.getNodeInfo(n[r]),s={};s.url=o.attrList["rdf:about"],s.title=t.getNodeInfo(t.filterChildren([n[r]],{tag:"dcterms:title"})[0]).text,s.details=t.getNodeInfo(t.filterChildren([n[r]],{tag:"oslc:details"})[0]).attrList["rdf:resource"],this.serviceProviderList.push(s)}this.serviceProviderList.sort(function(e,t){var n=e.title.toUpperCase(),r=t.title.toUpperCase();return n<r?-1:n>r?1:0})}}),getProxyObjectExternalDetails:function(e,r,i){n.oslcRequest(e.tenantId,e.proxyService,e.OSLCResource,{method:"GET",headers:{Accept:"application/rdf+xml"},onSuccess:function(n){var r,i=t.loadXMLDoc(n),o=t.filterDescendants([i],{tag:"rdf:Description"}),s=t.getNodeInfo(t.filterChildren(o,{tag:"dcterms:identifier"})[0]).text,a=t.getNodeInfo(t.filterChildren(o,{tag:"dcterms:title"})[0]).text,c=t.getNodeInfo(t.filterChildren(o,{tag:"dcterms:modified"})[0]).text;r=e.repositoryRootURL&&e.OSLCResource.startsWith(e.repositoryRootURL)?e.OSLCResource.substring(e.repositoryRootURL.length):e.OSLCResource,e.onSuccess({type:e.proxyType,dataelements:{Proxy_Id:s,Proxy_Service:e.proxyService,Proxy_Tenant:e.tenantId,Proxy_URL:r,Proxy_Title:a,Proxy_Modified:c,Proxy_State:""}})},onError:e.onError})},updateProxyObject:function(e){UWA.Class.Promise.all([n.getCsrfKeyPromise(e.tenantId),n.getSecurityContextPromise(e.tenantId)]).then(function(t){e.data.csrf=t[0],n.post(e.tenantId,"/resources/v1/modeler/e6wproxy",e.data,e.onSuccess,e.onError)}).catch(function(t){e.onError(t)})}}}),define("DS/LifecycleServices/Refresh",["UWA/Class","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings","DS/LifecycleServices/NotificationPublish","DS/LifecycleCmd/MessageMediator"],function(e,t,n,r,i){"use strict";return e.singleton({init:function(e){i.addEvent("onModification",function(e){this._refreshCb(e)},this)},setContext:function(e){null!=e&&(this.context=e)},_refreshCb:function(e){var t;null==e.context?(console.warn("No context sent for refresh"),t=this.context):(t=e.context,e.context=null),this._refresh(e,t)},_refresh:function(e,i){var o=t.getCurrentAppName(i),s=n.getCurrentFolderID(),a=n.getTenant();a||(a="undefined"!=typeof widget&&widget?widget.getValue("x3dPlatformId"):null),this.refreshEditors(s,e,o,i,function(){if("function"==typeof i.refreshView&&["ENOLCMI_AP","DELMGA_AP","DELMFN_AP","X3DRYAP_AP","ENORETV_AP","ENXENG_AP","ENXWDOC_AP"].indexOf(o)>-1)try{i.refreshView(e)}catch(e){}var t=null;UWA.is(i.getUUID,"function")&&(t=i.getUUID());var n;n={From:"Lifecycle",Refresh:e,AppID:o,OriginID:t,tenant:a,WidgetID:widget?widget.id:void 0},r.publish("Lifecycle.Modification",n)})},refreshEditors:function(e,t,n,r,i){var o=0;if(t.hasOwnProperty("created")&&(o+=t.created.length),t.hasOwnProperty("modified")&&(o+=t.modified.length),t.hasOwnProperty("deleted")&&(o+=t.deleted.length),t.hasOwnProperty("restored")&&(o+=t.restored.length),o>0){var s=[],a=[];t.hasOwnProperty("created")&&t.created.forEach(function(r){"ENOPRSU_AP"!=n&&"ENOPSTR_AP"!=n||a.push(r.physicalid);var i=!0;(t.hasOwnProperty("refreshFolder")&&(i=t.refreshFolder),i&&r.hasOwnProperty("folders")&&e)&&(-1==r.folders.indexOf(e)&&(i=!1));if(i&&(null==e&&r.hasOwnProperty("folders")&&r.folders.length>0&&r.folders[0]&&(e=r.folders[0]),e)){var o=[e,r.physicalid];s.push(o)}});var c=!1;a.length>0&&r&&"function"==typeof r.author&&"function"==typeof r.add&&(r.author(!0),r.add({pids:a}),c=!0);var l=[],u=[],d=[],f="deleted",h=!1;t.hasOwnProperty("deleted")&&t.deleted.forEach(function(e){u.push(e.physicalid),"PhysicalDeleteAfterLogical"===e.operation&&(f="physicaldeleteafterlogical"),e.impl&&(e.impl.contains("Workspace_Vault")||e.impl.contains("Workspace"))&&(h=!0)}),t.hasOwnProperty("modified")&&t.modified.forEach(function(e){l.push(e.physicalid)}),t.hasOwnProperty("restored")&&t.restored.forEach(function(e){d.push(e.physicalid)}),require(["DS/PADUtils/PADCommandProxy","DS/PADUtils/PADSession","i18n!DS/PADUtils/assets/nls/PADUtils.json"],function(e,t,n){var o=e.create();if(h){(v={}).deleted=u,(p={}).authored=v,r.author(!0),r.onRefresh(p),o.destroy()}else{o.authored({authored:!0});var p,v={};l.length>0&&(v.modified=l),u.length>0&&(v[f]=u),s.length>0&&(v.connected=s),d.length>0&&(v.restored=d),a.length>0&&!c&&(v.created=a),(p={}).authored=v,o.refresh(p),o.destroy()}i()},function(e){i()})}}})}),define("DS/LifecycleServices/WebReq",["UWA/Class","UWA/Promise","DS/WAFData/WAFData","DS/LifecycleServices/Utils","DS/LifecycleServices/LifecycleServices","DS/LifecycleServices/LifecycleServicesSettings"],function(e,t,n,r,i,o){var s=e.singleton({defaults:{type:"json",timeout:6e4},init:function(){["delete","get","head","options"].forEach(function(e){this[e]=function(t,n){return this.request(UWA.merge(n||{},{url:t,method:e}))}},this),["post","put","patch"].forEach(function(e){this[e]=function(t,n,r){let i={...r||{}};return this.request(UWA.merge(i,{url:t,method:e,data:n}))}},this)},request:function(e){return"string"==typeof e?e={url:arguments[0]}:(e=e||{}).data&&"string"!=typeof e.data&&(e.data=JSON.stringify(e.data)),UWA.Utils.parseUrl(e.url).protocol||(e.url=o.get3DSpaceWSUrl(e.tenant,e.url,null)),(e=UWA.merge(e,this.defaults)).method=e.method?e.method.toLowerCase():"get",e.headers=e.headers||o.getHeaders(e.securityContext),e.securityContext||delete e.headers.SecurityContext,this._dispatchPromise(e)},_dispatchPromise:function(e){var t=this;return new UWA.Promise(function(r,i){n.authenticatedRequest(t._createURL(e),{method:e.method,headers:e.headers,timeout:e.timeout,data:e.data,type:e.type,onComplete:function(e){r(e)},onFailure:function(e,n,r){i({error:e,response:n,headers:r,errorMessage:t._parseError(e,n)})},onTimeout:function(){i({isTimeout:!0})}})})},_parseError:function(e,t){return t&&t.error?JSON.stringify(t.error):i.parseWebServiceError(e,t)},_createURL:function(e){var t=e.url;return r.forEach(e.params,function(e,n){t+=(-1===t.indexOf("?")?"?":"&")+n+"="+e}),t}});return s.init(),s});const chunkit=(e,t,n)=>{if(n){if(!e.hasOwnProperty(n)&&!Array.isArray(e[n]))return[e];const r=[];return chunkit(e[n],t).forEach(t=>{let n={...e};n.ids=t,r.push(n)}),r}if(!Array.isArray(e))return[e];const r=[];for(;e.length>0;){const n=e.splice(0,t);r.push(n)}return r};define("DS/LifecycleServices/ChunkedwebReq",["UWA/Class","UWA/Promise","DS/WAFData/WAFData","DS/LifecycleServices/Utils","DS/LifecycleServices/WebReq"],function(e,t,n,r,i){return e.singleton({defaults:{chunkSize:1e3},post:function(e,t,n){chunkSize=n&&n.chunkSize||this.defaults.chunkSize;let r=n&&n.chunkMember||void 0;return new UWA.Promise((o,s)=>{let a=chunkit(t,chunkSize,r),c=[];a.forEach(t=>{c.push(i.post(e,t,n))}),UWA.Promise.all(c).then(e=>{let t=[];e.forEach(e=>{t=t.concat(e)}),o(t)}).catch(e=>{s(e)})})}})});