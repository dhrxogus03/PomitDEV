!function(e){"use strict";var n=!1;e.onmessage=function(a){require(["DS/EasySax/EasySax","DS/Formats/CGRFile"],function(t,s){n=!0;var r,i,l,o,d,p,g,h=a.data.xmlData,u=a.data.loadingIndex,c=a.data.ctxTypes&&a.data.ctxTypes.length?a.data.ctxTypes:null,m=0,f=!0;let x=a.data.conditions,b=a.data.nodeName;function y(e){return e?parseFloat(e.replace?e.replace(",","."):e):void 0}function T(e){var n=e;return-1!==n.indexOf("&amp;")&&(n=n.replace(/&amp;/g,"&")),-1!==n.indexOf("&gt;")&&(n=n.replace(/&gt;/g,">")),-1!==n.indexOf("&lt;")&&(n=n.replace(/&lt;/g,"<")),-1!==n.indexOf("&quot;")&&(n=n.replace(/&quot;/g,'"')),-1!==n.indexOf("&#xD;&#xA;")&&(n=n.replace(/&#xD;&#xA;/g,"&#xA;")),-1!==n.indexOf("&#xD;")&&(n=n.replace(/&#xD;/g,"&#xA;")),n}var k=function(e,n,a){for(var t=[],s=e.split(" "),r=0;r<s.length;r++)if(" "!==s[r]&&""!==s[r]){var i=a?s[r]:y(s[r]);void 0!==i&&(!n||n&&-1===t.indexOf(i))&&t.push(i)}return t};var C,v=function(e){var n=e.attributes;if(delete e.attributes,n){var a=e.type;1===e.type&&function(e,n){var a=n.indexOf("#x&amp;",0);-1!==a?e.Text=n.substring(0,a):n.length&&(e.Text=n)}(e,n),30===e.type&&function(e,n){var a="#x&amp;",t=0,s=n.indexOf(a,t);if(-1!==s){for(e.NOAText=n.substring(t,s),t=s+a.length;-1!==s;)-1!==(s=n.indexOf(a,t))&&(t=s+a.length);a=";",-1!==(s=n.indexOf(a,t))&&(e.NOAType=n.substring(s+1,n.length))}}(e,n),n=function(e,n){var a,t,s,r,i,l=0,o={};if(1===e.type||2===e.type||30===e.type){-1!==(a=n.indexOf("#x&amp;",l))&&(l=a+"#x&amp;".length),-1!==(a=n.indexOf("#x&amp;",l))&&(i=n.substring(0,a),s=n.substring(l,a),o.hiddenText=s||void 0,l=a+"#x&amp;".length),a=n.indexOf("#x&amp;",l);for(var d=[];-1!==a;)i||(i=n.substring(0,a)),(s=n.substring(l,a))&&(30===e.type?-1===s.indexOf(";",0)&&d.push({address:s}):d.push({address:s})),l=a+"#x&amp;".length,a=n.indexOf("#x&amp;",l);-1===a&&0!==l&&(i||(i=n.substring(0,l)),(s=n.substring(l,n.length))&&30===e.type?-1===s.indexOf(";",0)&&d.push({address:s}):s&&d.push({address:s})),d.length&&(o.urls=d)}else{var p=[],g="";if(-1!==(a=n.indexOf("#x&amp;$)"))){if(i||(i=n.substring(0,a)),(t=n.split("amp;$)")).length){var h=t[1].split("#x&amp;");if(g=h[0],h.length>1)for(r=1;r<h.length;r++)p.push({address:h[r]})}}else if(-1!==(a=n.indexOf("#x&amp;"))&&(i||(i=n.substring(0,a)),(t=n.split("#x&amp;")).length>1))for(r=1;r<t.length;r++)p.push({address:t[r]});(g||p&&p.length)&&(o={urls:p.length>0?p:void 0,hiddenText:""!==g?g:void 0})}if(e.hyperlinksData&&e.hyperlinksData.length)return i||n;if((o.hiddenText||o.urls&&o.urls.length)&&(e.hyperlinksData=[],o.hiddenText&&e.hyperlinksData.push({type:-1,text:o.hiddenText}),o.urls&&o.urls.length))for(r=0;r<o.urls.length;r++)e.hyperlinksData.push({type:0,address:o.urls[r].address});return i||n}(e,n),0!==a&&1!==a&&2!==a&&30!==a&&(12===a||13===a||14===a||15===a||37===a||38===a||34===a?function(e,n){var a,t=0,s="^";if(-1!==(a=n.indexOf(s,t))&&(t=a+s.length,-1!==(a=n.indexOf(s,t))&&(t=a+s.length,-1!==(a=n.indexOf(s,t))&&(t=a+s.length),-1!==(a=n.indexOf(s,t))&&(t=a+s.length))),s=";",e.dimensionLimits={min:null,max:null},a=n.indexOf(s,t),e.dimensionLimits.min=y(n.substring(t,a)),t=a+s.length,a=n.indexOf(s,t),e.dimensionLimits.max=y(n.substring(t,a)),t=a+s.length,-1!==(a=n.indexOf(s,t)))e.nominalValue=n.substring(t,a),t=a+s.length,s="!",-1!==(a=n.indexOf(s,t))?e.tabLimit=n.substring(t,-1!==a?a:n.length):(a=n.indexOf("#x&amp;",t),e.tabLimit=n.substring(t,-1!==a?a:n.length));else if(s="#",-1!==(a=n.indexOf(s,t))&&-1===n.indexOf("#x&amp;",t)){a=n.indexOf(s,t),e.nominalValue=n.substring(t,a),t=a+s.length;var r={};if(-1!==(a=n.indexOf(s,t))?(r.name=n.substring(t,a),t=a+s.length,s=";",-1===(a=n.indexOf(s,t))&&(a=n.length)):(s="#x&amp;$)",-1!==(a=n.indexOf(s,t))?r.name=n.substring(t,a):(s=";",r.name=n.substring(t,a)),t=a+s.length),r.name){var i=n.substring(t,a);a=i.indexOf("!",0),r.variation=i&&-1!==a?i.substring(0,a):i,e.genTol=r}}else s="!",-1!==(a=n.indexOf(s,t))?(e.nominalValue=n.substring(t,a),t=a+s.length,s="#x&amp;$)"):s="#x&amp;$)"}(e,n):5===a||6===a||33===a?function(e,n){var a,t,s="^",r=0,i=[];if(5===e.type){-1!==(a=n.indexOf(s,r))&&(r=a+s.length),-1!==(a=n.indexOf(s,r))&&(r=a+s.length),s=";";for(var l=n.indexOf(s,r);-1!==l;)r=l+s.length,(t=-1!==(l=n.indexOf(s,r))?parseInt(n.substring(r,l),10):parseInt(n.substring(r,n.length),10))&&i.push(t)}else 6===e.type&&(-1!==(a=n.indexOf(s,r))&&(r=a+s.length,-1!==(a=n.indexOf(s,r))&&(r=a+s.length,-1!==(a=n.indexOf(s,r))&&(r=a+s.length))),s="#x&amp;$)",(t=-1!==(a=n.indexOf(s,r))?parseInt(n.substring(r,a),10):parseInt(n.substring(r,n.length),10))&&i.push(t));i.length&&(e.datumTargets=i)}(e,n):7!==a&&8!==a&&9!==a&&10!==a&&11!==a&&17!==a&&18!==a&&19!==a&&20!==a&&21!==a&&22!==a&&23!==a&&24!==a&&25!==a&&26!==a&&27!==a&&28!==a||function(e,n){var a="^",t=0,s=n.indexOf(a,t);if(a="@#",-1!==(s=n.indexOf(a,0))){var r=n.split(a);r.length&&(0!==s&&r.splice(0,1),e.toleranceZoneValue=y(r[10]))}if(a=";",-1!==(s=n.indexOf("!",t))){var i,l,o=n.indexOf(":",t);t=s+a.length,s=n.indexOf(a,t),i=y(n.substring(t,s)),t=s+a.length,s=n.indexOf(a,t),l=y(-1!==o?n.substring(t,o):-1!==(s=n.indexOf("#x&amp;$)",t))?n.substring(t,s):n.substring(t,n.length)),e.toleranceUnitBasis={val1:i,val2:l}}}(e,n),function(e,n){var a=[],t=n.indexOf(":");if(-1!==t){var s=n.substring(t+":".length,n.length).split(":");if(s.length)for(var r=0;r<s.length;r++){var i=parseInt(s[r],10);null!=i&&a.push(i)}}0!==a.length&&(e.associatedBasicDims=a)}(e,n))}},O=function(e){return r.openSceneGraph(new Uint8Array(function(e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var a=new ArrayBuffer(e.length/4*3);return function(e,a){var t,s,r,i,l,o,d,p=n.indexOf(e.charAt(e.length-1)),g=n.indexOf(e.charAt(e.length-2)),h=e.length/4*3;64===p&&h--,64===g&&h--;var u=0,c=0;for(t=a?new Uint8Array(a):new Uint8Array(h),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),u=0;u<h;u+=3)s=n.indexOf(e.charAt(c++))<<2|(l=n.indexOf(e.charAt(c++)))>>4,r=(15&l)<<4|(o=n.indexOf(e.charAt(c++)))>>2,i=(3&o)<<6|(d=n.indexOf(e.charAt(c++))),t[u]=s,64!==o&&(t[u+1]=r),64!==d&&(t[u+2]=i)}(e,a),a}(e)),function(){},{processText:f,withBlankingRep:!0})},A=function(a){n&&(a.done&&(a.hasTesseletedTextReps=!d||o,h=null,u=null,n=!1,f=!1,r=null,i=null,l=null,c=null,o=null,d=null,m=0),a&&(a.processText=f),e.postMessage(a))},S=function(){A({done:!0,loadingIndex:u,loadingPartiallyFailed:!0})},I=function(e,a){if(n){var t,s=a();if(!1!==s)switch(p=!1,e){case"Functional_Tolerancing_Annotation":s.Version&&(g=y(s.Version)),l.push({name:e,node:{}});break;case"AnnotationSet":m++;var r={nodeXMLtype:e,version:g};s.ContextType&&(r.contextType=y(s.ContextType)),s.Standard&&(r.standard=s.Standard),c&&-1===c.indexOf(r.contextType)?A({node:r,done:!0,loadingIndex:u,loadingCancelled:!0,annotSetID:m}):!x||!b||!x[r.contextType]||!x[r.contextType].assemblyPrefix&&!x[r.contextType].assemblySuffix||x[r.contextType].assemblyPrefix&&b.startsWith(x[r.contextType].assemblyPrefix)||x[r.contextType].assemblySuffix&&b.endsWith(x[r.contextType].assemblySuffix)?l.push({name:e,node:r}):A({node:r,done:!0,loadingIndex:u,loadingCancelled:!0,annotSetID:m});break;case"RootTTRSs":case"RefFrame":l.push({name:e,node:{nodeXMLtype:e}});break;case"TPSView":var i={nodeXMLtype:e};s.Version&&(i.version=y(s.Version)),l.push({name:e,node:i});break;case"TPS":d=!0;var h={nodeXMLtype:e};s.Att&&(h.attributes=s.Att),s.Ref&&(h.ref=y(s.Ref)),s.Val&&(h.val=y(s.Val)),s.Def&&(h.def=y(s.Def)),l.push({name:e,node:h});break;case"TPSCap":var f={nodeXMLtype:e};l.push({name:e,node:f}),s.Att&&(f.attributes=s.Att),"1"===s.ActVieSt&&s.ActVie&&(f.view=y(s.ActVie)),s.RepMngt&&(f.RepMngt=y(s.RepMngt)),s.InstMngt&&(f.InstMngt=y(s.InstMngt)),s.ClipPla&&(f.ClipPla=y(s.ClipPla)),s.FavCtxMngt&&(f.FavCtxMngt=y(s.FavCtxMngt)),s.Version&&(f.version=y(s.Version)),s.FeatureVersion&&(f.FeatureVersion=y(s.FeatureVersion));break;case"TPSCG":var C={nodeXMLtype:e};l.push({name:e,node:C}),s.Att&&(C.attributes=s.Att);break;case"TPSAttribute":var v={nodeXMLtype:e};if(l.push({name:e,node:v}),s.Categ&&(v.category=s.Categ),s.AttrType){var O=s.AttrType.split(".");O&&2===O.length?v.attrType=parseFloat(O[1]):v.attrType=parseFloat(s.AttrType)}break;case"TPSAttributes":var I={nodeXMLtype:e};l.push({name:e,node:I}),s.Categ&&(I.category=s.Categ);break;case"Rep":"2"===s.Type?l.push({name:"Rep2D",node:l[l.length-1].node}):"3"===s.Type?l.push({name:"Rep",node:l[l.length-1].node}):"4"===s.Type&&l.push({name:"CappingRep",node:l[l.length-1].node});break;case"SurfaceNormalRep":l.push({name:"SurfaceNormalRep",node:l[l.length-1].node});break;case"Buf":"Rep"===l[l.length-1].name&&l.push({name:e,node:l[l.length-1].node});break;case"AlternativeTextBuf":"Rep"===l[l.length-1].name&&(o=!0,l.push({name:e,node:l[l.length-1].node}));break;case"TPSId":s.Name&&(l[l.length-1].node.name=T(s.Name)),s.Att&&(l[l.length-1].node.attributes=s.Att),s.Uuid&&(l[l.length-1].node.uuid=s.Uuid);break;case"TPSLoc":s.Status&&(l[l.length-1].node.status=y(s.Status)),s.Id&&(l[l.length-1].node.tpsID=y(s.Id)),s.Type&&(l[l.length-1].node.type=y(s.Type));break;case"Standard":l[l.length-1].node.standards||(l[l.length-1].node.standards=[]);var D={};s.Title&&(D.title=T(s.Title)),s.Year&&(D.year=T(s.Year)),s.Code&&(D.code=T(s.Code)),l[l.length-1].node.standards.push(D);break;case"DefaultSpec":l[l.length-1].node.standardNorms||(l[l.length-1].node.standardNorms=[]);var R={};s.Type&&(R.type=T(s.Type)),s.SubType&&(R.subtype=T(s.SubType)),s.Code&&(R.code=T(s.Code)),s.Year&&(R.year=T(s.Year)),l[l.length-1].node.standardNorms.push(R);break;case"Symbol":var P,V=l[l.length-1].node.standardNorms;V[V.length-1].symbols||(V[V.length-1].symbols=[]),s.Name&&(P=s.Name),l[l.length-1].node.standardNorms[l[l.length-1].node.standardNorms.length-1].symbols.push(P);break;case"Value":p=!0;break;case"Hyperlink":l[l.length-1].node.hyperlinksData||(l[l.length-1].node.hyperlinksData=[]);var M={};s.AnchorText&&(M.anchorText=s.AnchorText),s.Address&&(M.address=s.Address),s.Type&&(M.type=y(s.Type)),s.AddressRelId&&(M.addressRelId=s.AddressRelId),l[l.length-1].node.hyperlinksData.push(M);break;case"HiddenText":l[l.length-1].node.hyperlinksData||(l[l.length-1].node.hyperlinksData=[]);var F={type:-1};s.Text&&(F.text=T(s.Text)),l[l.length-1].node.hyperlinksData.push(F);break;case"Failure":l[l.length-1].node.failureModes||(l[l.length-1].node.failureModes=[]);var N={};null!==s.Criticity&&void 0!==s.Criticity&&(N.crit=s.Criticity),l[l.length-1].node.failureModes.push(N);break;case"Description":case"TPSs":case"Thumbnail":case"Datum":case"Views":case"Caps":case"CGs":l.push({name:e,node:l[l.length-1].node});break;case"VisibleCG":t="0"===s.Cut?"UncutCGs":e,l[l.length-1].node[t]||(l[l.length-1].node[t]=[]),l.push({name:e,node:l[l.length-1].node,Uncut:"0"===s.Cut});break;case"HiddenBodyInst":case"VisibleBodyInst":l.push({name:e,node:l[l.length-1].node});break;case"VisibleCompRelId":t="0"===s.Cut?"UncutCompRelId":e,l[l.length-1].node[t]||(l[l.length-1].node[t]=[]),l.push({name:e,node:l[l.length-1].node,Uncut:"0"===s.Cut});break;case"VisibleCompXmlId":t="0"===s.Cut?"UncutCompXmlId":e,l[l.length-1].node[t]||(l[l.length-1].node[t]=[]),l[l.length-1].node[t].push([]),l.push({name:e,node:l[l.length-1].node,Uncut:"0"===s.Cut});break;case"Cam":l[l.length-1].node.camera={},l[l.length-1].node.camera.angle=y(s.Angle),l[l.length-1].node.camera.mode=s.Mode,l[l.length-1].node.camera.type=s.Type,l[l.length-1].node.camera.zoom=y(s.Zoom),s.Nature&&(l[l.length-1].node.camera.nature=s.Nature),l.push({name:e,node:l[l.length-1].node});break;case"Po":case"Di":case"Ze":case"Ta":l.push({name:e,node:l[l.length-1].node});break;case"Math":l[l.length-1].node.planeInfos={},l.push({name:e,node:l[l.length-1].node});break;case"Or":case"No":l.push({name:e,node:l[l.length-1].node});break;case"MultiClipping":l[l.length-1].node.multiClipping={},l[l.length-1].node.multiClipping.inverted=y(s.Inverted),l.push({name:e,node:l[l.length-1].node});break;case"CircularClipping":l[l.length-1].node.clipping2D={type:"circular"},l.push({name:e,node:l[l.length-1].node});break;case"PolygonalClipping":l[l.length-1].node.clipping2D={type:"polygonal",points:[]},l.push({name:e,node:l[l.length-1].node});break;case"Center":case"Radius":case"SketchOrigin":case"SketchNormal":case"Point":l.push({name:e,node:l[l.length-1].node});break;case"PointsDef":l[l.length-1].node.multiClipping.pointsDef=[],l.push({name:e,node:l[l.length-1].node});break;case"ReframeArea":l[l.length-1].node.reframeArea={cornerX:y(s.CornerX),cornerY:y(s.CornerY),width:y(s.Width),length:y(s.Length)};break;case"SCSRestrictedArea":l[l.length-1].node.scsReframeArea={upperLimit:null,lowerLimit:null};break;case"UpperLimit":case"LowerLimit":l.push({name:e,node:l[l.length-1].node});break;case"TTRS":"RootTTRSs"===l[l.length-1].name?l.push({name:e,node:{nodeXMLtype:e}}):l.push({name:e,node:l[l.length-1].node});break;case"ReferencedCGs":case"GeoP":case"TRep":case"Grou":case"OccId":l.push({name:e,node:l[l.length-1].node});break;case"AttrLink":var L={};s.Name&&(L.name=s.Name),s.Uuids&&(L.uuids=k(s.Uuids,!0,!0)),l[l.length-1].node.pointedFeatureUuids||(l[l.length-1].node.pointedFeatureUuids=[]),l[l.length-1].node.pointedFeatureUuids.push(L);break;case"Param":l[l.length-1].node.params||(l[l.length-1].node.params=[]);var U={};s.Name&&(U.Name=s.Name),s.Magnitude&&(U.Magnitude=s.Magnitude),s.Value&&(U.Value="String"===U.Magnitude?T(s.Value):s.Value),s.Hidden&&(U.Hidden=s.Hidden),l[l.length-1].node.params.push(U),l.push({name:e,node:l[l.length-1].node});break;case"AuxFeatIndicator":l[l.length-1].node.auxiliaryFeatures={annotations:[],cgs:[]},l.push({name:e,node:l[l.length-1].node});break;case"OrientationPlaneDF":case"OrientationPlaneAngleTED":case"IntersectionPlaneDF":case"CollectionPlaneDF":case"OrientationPlaneAngleCG":l.push({name:e,node:l[l.length-1].node})}else S()}},D=function(e,a){if(n)if(p){var t=l[l.length-1].node.standardNorms;if(t){t[t.length-1].symbols||(t[t.length-1].symbols=[]);var s=T(a(e));t[t.length-1].symbols.push(s)}}else if(l.length){var r,i,o,d,g=l[l.length-1].name,h=l[l.length-2]?l[l.length-2].name:null,u=l[l.length-1].node;switch(g){case"Buf":(r=O(a(e)))&&r.reps&&(u.reps||(u.reps=[]),u.reps.push(r));break;case"AlternativeTextBuf":f=!1,(r=O(a(e)))&&r.reps&&(u.reps||(u.reps=[]),u.reps.push(r));break;case"Rep2D":break;case"CappingRep":(r=O(a(e)))&&r.reps&&(u.cappingRep=r);break;case"SurfaceNormalRep":(r=O(a(e)))&&r.reps&&(u.surfaceNormalRep=r);break;case"Thumbnail":var c=a(e);c&&(u.thumbnail=c);break;case"Caps":case"CGs":(i=k(a(e),!0)).length&&(u[g]=i);break;case"VisibleCG":var m=k(a(e),!0);1===m.length&&l[l.length-1].Uncut&&u.UncutCGs.push(m[0]);break;case"TPSs":(i=k(a(e),!0)).length&&(u[g]=i);break;case"UpperLimit":i=k(a(e),!0),u.scsReframeArea&&i.length&&(u.scsReframeArea.upperLimit=i);break;case"LowerLimit":i=k(a(e),!0),u.scsReframeArea&&i.length&&(u.scsReframeArea.lowerLimit=i);break;case"HiddenBodyInst":case"VisibleBodyInst":(o=k(a(e),!0)).length&&(u[g]||(u[g]=[]),u[g].push(o));break;case"VisibleCompRelId":var x=k(a(e),!0,!0);1===x.length&&(l[l.length-1].Uncut?u.UncutCompRelId.push(x[0]):u[g].push(x[0]));break;case"OccId":var b=k(a(e),!0,!0);1===b.length&&(!l[l.length-2].Uncut&&u.VisibleCompXmlId?u.VisibleCompXmlId[u.VisibleCompXmlId.length-1].push(b[0].split("#")[1]):u.UncutCompXmlId&&u.UncutCompXmlId[u.UncutCompXmlId.length-1].push(b[0].split("#")[1]));break;case"Po":u.camera&&(d=k(a(e),!1),u.camera.position={x:d[0],y:d[1],z:d[2]});break;case"Di":u.camera?(d=k(a(e),!1),u.camera.direction={x:d[0],y:d[1],z:d[2]}):u.planeInfos&&(d=k(a(e),!1),u.planeInfos.direction={x:d[0],y:d[1],z:d[2]});break;case"Ze":u.camera&&(d=k(a(e),!1),u.camera.zenith={x:d[0],y:d[1],z:d[2]});break;case"Ta":u.camera&&(d=k(a(e),!1),u.camera.target={x:d[0],y:d[1],z:d[2]});break;case"Or":u.planeInfos&&(d=k(a(e),!1),u.planeInfos.origin={x:d[0],y:d[1],z:d[2]});break;case"No":u.planeInfos&&(d=k(a(e),!1),u.planeInfos.normal={x:d[0],y:d[1],z:d[2]});break;case"Views":(i=k(a(e),!0)).length&&"MultiClipping"===h?u.multiClipping.views=i:i.length&&(u[g]=i);break;case"Point":"PointsDef"===h?(d=k(a(e),!1))&&3===d.length&&u.multiClipping.pointsDef.push({x:d[0],y:d[1],z:d[2]}):"PolygonalClipping"===h&&(d=k(a(e),!1))&&2===d.length&&u.clipping2D.points.push({x:d[0],y:d[1]});break;case"Center":"CircularClipping"===h&&(d=k(a(e),!1))&&2===d.length&&(u.clipping2D.center={x:d[0],y:d[1]});break;case"Radius":"CircularClipping"===h&&(u.clipping2D.radius=y(a(e)));break;case"SketchNormal":case"SketchOrigin":"MultiClipping"===h&&(d=k(a(e),!1))&&(u.multiClipping[g]={x:d[0],y:d[1],z:d[2]});break;case"TTRS":"TPSCG"!==h&&"TPS"!==h&&"TPSAttribute"!==h||(u.ttrs=k(a(e),!0));break;case"ReferencedCGs":"TTRS"!==h&&"TPS"!==h&&"TPSAttribute"!==h||(u.referencedCGs=k(a(e),!0));break;case"TRep":u.trep=k(a(e),!0);break;case"GeoP":var C=k(a(e),!1);C.length&&(u[g]||(u[g]=[]),u[g].push(C));break;case"Datum":u.datums=k(a(e),!0);break;case"Grou":u.grou=k(a(e),!0);break;case"Param":u.params=a(e);break;case"Description":if(u.failureModes&&u.failureModes.length){var v=u.failureModes[u.failureModes.length-1];v.descriptions||(v.descriptions=[]),v.descriptions.push(T(a(e)))}break;case"OrientationPlaneDF":case"OrientationPlaneAngleTED":case"IntersectionPlaneDF":case"CollectionPlaneDF":i=k(a(e),!0),u.auxiliaryFeatures&&i&&i.length&&(u.auxiliaryFeatures.annotations=u.auxiliaryFeatures.annotations.concat(i));break;case"OrientationPlaneAngleCG":i=k(a(e),!0),u.auxiliaryFeatures&&i&&i.length&&(u.auxiliaryFeatures.cgs=u.auxiliaryFeatures.cgs.concat(i))}}},R=function(e){if(n&&l.length){var a=l[l.length-1].name,t=l[l.length-2]?l[l.length-2].name:null,s=l[l.length-1].node;if(a===e)switch(e){case"TPS":case"TPSView":case"TPSCap":case"TPSCG":v(s),A({node:s,done:!1,loadingIndex:u,annotSetID:m}),l.pop();break;case"TPSAttribute":"TPSAttribute"===t||"TPSAttributes"===t?(l[l.length-2].node.childrenAttr||(l[l.length-2].node.childrenAttr=[]),l[l.length-2].node.childrenAttr.push(s)):A({node:s,done:!1,loadingIndex:u,annotSetID:m}),l.pop();break;case"TPSAttributes":case"RefFrame":A({node:s,done:!1,loadingIndex:u,annotSetID:m}),l.pop();break;case"TTRS":"RootTTRSs"===t&&A({node:s,done:!1,loadingIndex:u,annotSetID:m}),l.pop();break;case"AnnotationSet":v(s),A({node:s,done:!1,loadingIndex:u,annotSetID:m}),l.pop();break;case"Functional_Tolerancing_Annotation":l.pop(),A({node:s,done:!0,loadingIndex:u}),n=!1;break;default:l.pop()}else"CappingRep"!==a&&"Rep2D"!==a||"Rep"!==e||l.pop()}};C=h,l=[],i||(i=new t),r||(r=new s(void 0,void 0,void 0,!0)),i.on("startNode",I),i.on("textNode",D),i.on("endNode",R),i.on("error",S),i.parse(C)})}}(this);