define("DS/MPFConnector/ConnectorBackend",[],function(){"use strict";return Object.freeze({MARKETPLACE:"marketplace",SWYM:"3DSwym"})}),define("DS/MPFConnector/Connector",["UWA/Core","UWA/Class"],function(e,t){"use strict";return t.extend({url:function(e){},request:function(e,t){}})}),define("DS/MPFConnector/MarketplaceConnector",["UWA/Core","UWA/Utils","UWA/Class","UWA/Promise","DS/MPFConnector/Connector","DS/MPFUtils/MPFUtils","DS/WAFData/WAFData","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/PlatformAPI/PlatformAPI","DS/MPFUrl/UrlUtils","DS/MPFServices/MarketplaceServices","DS/MPFConnector/ConnectorBackend"],(e,t,r,o,n,s,i,a,c,l,p,u)=>{"use strict";const f={},m=n.extend({init(e,t,r){if("string"!=typeof e)throw new Error("Marketplace base URL must be a string");if(r||(r={}),e.length>0){const t=e.slice(-1);this.rootUrl="/"===t?e.slice(0,-1):e}this.platformId=t,this.tenant=this.platformId,this.service=r.service||p.MAKE,this.app=r.app},url(e,r={}){const o=e.split("#"),n=o[0].split("?");let s;s=n.length>1?n[1].split("&"):[],this.service&&s.push("service="+this.service),this.platformId&&s.push("tenant="+this.platformId);const i=r.esid||t.getQueryString(window.location.href,"esid");i&&!1!==r.addESID&&s.push("project="+i);const a=s.join("&");return a&&(n[1]=a),o[0]=n.join("?"),e=o.join("#"),this.rootUrl+e},request(r,o){const n=o.method||"GET",s="number"==typeof o.retry?o.retry:1,a={...o,method:n,type:"json",timeout:18e4,retry:s};if("POST"===n||"PATCH"===n||"PUT"===n){o.data&&Object.prototype.isPrototypeOf.call(FormData.prototype,o.data)||(a.headers||(a.headers={}),a.headers["Content-Type"]="application/json")}e.is(t.Client)&&t.Client.Engine.ie&&"GET"===n&&(r=new l(r).addParameter("iecache",Date.now()).getUrl()),a.onFailure=function(){return a.retry-=1,a.retry>=0?i.authenticatedRequest(r,a):o.onFailure(...arguments)};const c=r.contains("service=clicknbuy");return c&&"POST"===n&&r.contains("/me/carts")?a.onPassportError=((e,t)=>{console.error(e);const r="/welcome/compass-world/3dexperience-collaborative-innovation/3dswymer/buy";let o;o=window.location.pathname.contains("/checkout")?r+"/checkout":window.location.pathname.contains("/cart")?r+"/cart":window.location.pathname;const n=new l(window.location.origin+o+window.location.hash).getUrl();window.location.href=t.replace("/logout","")+"/login?service="+encodeURIComponent(n)+"&theme=clicknbuy"}):c&&"GET"===n&&r.contains("/mdcart/carts/")&&new l(window.location.href).hasParameter("cartId")?a.onPassportError=((e,t)=>{console.error(e),window.location.href=t.replace("/logout","")+"/login?service="+encodeURIComponent(window.location.href)+"&theme=clicknbuy"}):r.contains("/me/cartsV2")?a.onPassportError=((e,t)=>{console.error(e)}):"function"!=typeof a.onPassportError&&(a.onPassportError=(e=>{if("NetworkError: Invalid, expired or missing CASTGC"===e.message){window.sessionStorage.getItem("mpui-has-reloaded-passport")||(window.sessionStorage.setItem("mpui-has-reloaded-passport",!0),window.location.reload())}})),i.authenticatedRequest(r,a)}});return m.fetchPromise=function(e){e=e||{},e=m._sanitizeOptions(e);const t=s.objectHashCode(e),r=o.deferred();if(f[t])r.resolve(f[t]);else{const o=e.platformId||c.getApplicationConfiguration("app.mp.tenant")||window.$nuxt&&window.$nuxt.$env.PLATFORM_ID;o||console.warn("MarketplaceConnector - no platformId provided or found in configuration"),a.getServiceUrl({platformId:o,serviceName:e.backend,onComplete:function(n){if(n){const s=m._extractServiceDetails(n);let i;s.url?(s.platformId||(s.platformId=o),e.backend===u.MARKETPLACE&&(s.url+="/resources"),i=new m(s.url,s.platformId,e),f[t]=i,r.resolve(i)):m._fetchMyAppsUrl().then(m._fetchMarketplaceUrlFromMyApps).then(function(o){o.url?(i=new m(o.url+"/resources",o.platformId,e),f[t]=i,r.resolve(i)):r.reject(new Error("Unable to finc marketplace url from MyApps"))}).catch()}else r.reject(new Error("Unable to find marketplace service url for platformId "+o))},onFailure:function(){r.reject("Unable to get platform services from i3DXCompassPlatformServices")}})}return r.promise},m._fetchMyAppsUrl=function(){return new o(function(e,t){a.getServiceUrl({serviceName:"3DCompass",onComplete:function(r){Array.isArray(r)?e(m._extractFirstServiceWithAnUrlFromArray(r)):t(new Error("Unable to get MyApps url from i3DXCompassPlatformServices"))},onFailure:function(){t(new Error("Unable to get MyApps url from i3DXCompassPlatformServices"))}})})},m._fetchMarketplaceUrlFromMyApps=function(e){return new o(function(t,r){const o=e.url+"/resources/AppsMngt/api/v1/public/services";i.request(o,{type:"json",onComplete:function(e){const r=e&&e.platforms;if(r){const e=s.findInArray(r,e=>s.findInArray(e.services,e=>"marketplace"===e.id));if(e){const r=s.findInArray(e.services,function(e){return"marketplace"===e.id});t({platformId:e.id,url:r.url})}}},onFailure:function(){r(new Error("Unable to get marketplace url from MyApps"))}})})},m._sanitizeOptions=function(e){const t={};return(e=e||{}).service&&(t.service=e.service),e.platformId&&(t.platformId=e.platformId),t.backend=e.backend||"marketplace",t},m._extractServiceDetails=function(e){const t="string"==typeof e,r=Array.isArray(e);let o={};return t?o.url=e:r?o=m._extractFirstServiceWithAnUrlFromArray(e):o.url="",o},m._extractFirstServiceWithAnUrlFromArray=function(e){const t=s.findInArray(e,function(e){return e.url}),r={};return t&&(r.platformId=t.platformId,r.url=t.url),r},m.get3DPassportUrl=function(){const e=o.deferred();return a.getPlatformServices({onComplete:function(t){const r=t.filter(function(e){return!!e["3DPassport"]}).pop();if(r){const t=r["3DPassport"];e.resolve(t)}else e.reject("Unable to find a 3DPassport in platform services from i3DXCompassPlatformServices")},onFailure:function(){e.reject("Unable to get platform services from i3DXCompassPlatformServices")}}),e.promise},m}),define("DS/MPFConnector/SheerIdConnector",["DS/MPFConnector/Connector","DS/WAFData/WAFData"],function(e,t){"use strict";return e.extend({init(){this.rootUrl="https://services.sheerid.com/rest/v2"},request(){return this.fetch(...arguments)},async fetch(e,{method:t="GET",isJson:r=!0,contentType:o,data:n}={}){const s=this._createUrl(e),i={method:t};return r?(i.headers={"Content-Type":"application/json"},i.body=JSON.stringify(n)):o?(i.headers={"Content-Type":o},i.body=n):i.body=n,window.fetch(s,i).then(e=>e.json())},async fetchProxified(e,{method:r="GET",type:o="json",headers:n,data:s}={}){const i=this._createUrl(e);return new Promise((e,a)=>{t.proxifiedRequest(i,{method:r,type:o,headers:n,data:s,onComplete(t){e(JSON.parse(t))},onFailure(e){console.error(e),a(e)},onTimeout(e){console.error("Request timed out"),console.error(e),a(e)}})})},_createUrl(e){return new RegExp("^(?:[a-z]+:)?//","i").test(e)?e:this.rootUrl+e}})}),define("DS/MPFConnector/AppsConnector",["DS/MPFConnector/Connector","DS/MPFUrl/UrlUtils","DS/WAFData/WAFData","UWA/Promise","UWA/Core","DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices"],(e,t,r,o,n,s)=>{"use strict";const i=e.extend({init(e,t={}){this.rootUrl=e,n.is(t.platformId)&&(this.platformId=t.platformId)},url(e){return new t(this.rootUrl+e).getUrl()},request(e,t){const o={method:t.method||"GET",type:"json",timeout:18e4,onComplete:t.onComplete,onFailure:t.onFailure,data:t.data};return r.authenticatedRequest(e,o)}});return i.fetchPromise=function(){const e=o.deferred();return s.getPlatformServices({onComplete:function(t){const r=t.filter(function(e){return!!e["3DCompass"]}).shift();if(r){const t=r["3DCompass"]+"/resources/AppsMngt",o=new i(t);e.resolve(o)}else e.reject("Unable to find a compass in platform services from i3DXCompassPlatformServices")},onFailure:function(){e.reject("Unable to get platform services from i3DXCompassPlatformServices")}}),e.promise},i.fetchPromiseSynchro=function(){const e=o.deferred();return s.getPlatformServices({onComplete:function(t){const r=t.filter(function(e){return!!e["3DCompass"]}).shift();if(r){const t=r["3DCompass"]+"/resources/AppsMngtSynchro/api/v1",o=new i(t,{platformId:r.platformId});e.resolve(o)}else e.reject("Unable to find a compass in platform services from i3DXCompassPlatformServices")},onFailure:function(){e.reject("Unable to get platform services from i3DXCompassPlatformServices")}}),e.promise},i.getUser=function(e){return e||(e={}),s.getUser(e)},i}),define("DS/MPFConnector/NoConnector",["DS/MPFConnector/Connector","DS/MPFUtils/MPFUtils"],function(e,t){"use strict";let r;const o=e.extend({url:t.doNothing,request:t.doNothing});return o.getInstance=function(){return r||(r=new o),r},Object.freeze(o),o}),define("DS/MPFConnector/MarketplaceAdminConnector",["UWA/Core","UWA/Utils","DS/MPFConnector/Connector","DS/MPFServices/MarketplaceServices","DS/MPFData/MPFData"],(e,t,r,o,n)=>{"use strict";const s=r.extend({init(e,t,r){if("string"!=typeof e)throw new Error("Marketplace base URL must be a string");if(r||(r={}),e.length>0){const t=e.slice(-1);this.rootUrl="/"===t?e.slice(0,-1):e}this.platformId=t,this.tenant=this.platformId,this.service=r.service||o.MAKE,this.app=r.app},url(e,r={}){const o=e.split("#"),n=o[0].split("?");let s;s=n.length>1?n[1].split("&"):[],this.service&&s.push("service="+this.service),this.platformId&&s.push("tenant="+this.platformId);const i=r.esid||t.getQueryString(window.location.href,"esid");i&&!1!==r.addESID&&s.push("project="+i),s.push("xrequestedwith=xmlhttprequest");const a=s.join("&");return a&&(n[1]=a),o[0]=n.join("?"),e=o.join("#"),this.rootUrl+e},request(t,r){const o=r.method||"GET",s=e.extend({httpVerb:o,type:"json",timeout:18e4,retry:1},r);if("POST"===o||"PATCH"===o||"PUT"===o){r.data&&Object.prototype.isPrototypeOf.call(FormData.prototype,r.data)||(s.headers||(s.headers={}),s.headers["Content-Type"]="application/json")}return s.onFailure=function(){return s.retry-=1,s.retry>=0?n.request(t,s):r.onFailure(...arguments)},s.onPassportError=((e,t)=>{console.error(e),window.location.href=t.replace("/logout","")+"/login?service="+encodeURIComponent(window.location.href)}),n.request(t,s)}});return s.fromMpDataMgtUrl=function(e,t){return new s(e.replace(/\/webapps\/[^/]+$/,"/resources"),e.replace(/^https?:\/\/([^-]+).*/,"$1").toUpperCase(),t)},s}),define("DS/MPFConnector/EchoConnector",["DS/MPFConnector/Connector","DS/MPFUtils/MPFUtils"],function(e,t){"use strict";let r;const o=e.extend({url:function(e){return e},request:t.doNothing});return o.getInstance=function(){return r||(r=new o),r},Object.freeze(o),o});