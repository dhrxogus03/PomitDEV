define("DS/3DPlayWidgetViews/W3DPlayMainView",["DS/CoreEvents/Events","DS/WebSystem/Environment","UWA/Class","css!DS/3DPlayWidget/assets/3DPlayWidget","DS/WebUtils/StringUtils","DS/WebSystem/Nls","i18n!DS/3DPlay/assets/nls/3DPlay"],function(e,t,i,n,s,o,a){"use strict";var r,l,c,d,h,p=[],u=!1;return i.extend({init:function(e,t){r=e,l=t,c=this,this.buildView(),this.createBlueBackground(),this.declareAllSubscribers()},buildView:function(){r.body.setStyle("height","100%"),this.buildCanvas()},buildCanvas:function(){if(l.applicationFrameOptions&&l.applicationFrameOptions.options&&(u=void 0!==l.applicationFrameOptions.options.pad3DViewer),this.canvasDiv=u&&l.applicationFrameOptions.options.appMainDiv?l.applicationFrameOptions.options.appMainDiv:document.getElementById("canvas-div"),!this.canvasDiv)if(this.canvasDiv=document.getElementById("canvas-div"),this.canvasDiv||(this.canvasDiv=UWA.createElement("div",{class:"appMain",id:"canvas-div",html:"",styles:{overflow:"hidden"}})),u){var t=l.applicationFrameOptions.options.pad3DViewer.elements.container;this.canvasDiv.inject(t.parentNode),t.inject(this.canvasDiv)}else this.canvasDiv.inject(r.body);this.canvasDiv.id="canvas-div",this.canvasDiv.setAttribute("data-rec-id","canvasDivID"),this.canvasDiv.style.overflow="hidden",l.setCanvasDiv(this.canvasDiv),e.subscribeOnce({event:"Model.PreferencesReady"},function(e){if(!l.isPreferencesEmpty()){var t=l.getCurrentData();t.displayName&&c.updateWidgetTitle(t.displayName)}}),this.createDragAndDropZone(this.canvasDiv)},createBlueBackground:function(){if(this.backgroundContainer=document.getElementById("background_container"),!this.backgroundContainer){this.backgroundContainer=UWA.createElement("div",{id:"background_container",class:"blue_background_container",styles:{display:"none"}}),this.backgroundContainer.inject(this.canvasDiv),this.backgroundContainer.setContent({tag:"div",class:"background_container_display drop"});var e=l.getBoxMessageText("DROPIT");this.backgroundContainer.addContent({tag:"div",class:"drop_container_display"}),this.backgroundContainer.addContent({tag:"div",class:"drop_container_txt",html:[{tag:"h3",id:"drop_msg",class:"drop_invite_txt font-3dsregular drop",html:e}]})}this.drop_msgDom=this.backgroundContainer.getElement("h3.drop_invite_txt")},hideBlueBackground:function(e){this.backgroundContainer.setStyle("display",e)},displayBlueBackground:function(){this.hideBlueBackground("block")},updateBlueBackgroundMessage:function(e){var t=l.getBoxMessageText(e);this.drop_msgDom.setHTML(t)},create3DPlayInviteContainer:function(){if(this.inviteContainer=document.getElementById("pad_invite"),!this.inviteContainer){this.inviteContainer=UWA.createElement("div",{id:"pad_invite",class:"pad_invite_container",html:"Invite Container",styles:{display:"none"}}),this.inviteContainer.inject(this.canvasDiv,"before");var e=l.getBoxMessageText("DROPIT");this.inviteContainer.setContent([{tag:"div",class:"pad_invite_display drop",html:[{tag:"span",id:"invite_img",class:"pad_invite_img fonticon fonticon-3x fonticon-down-circled"},{tag:"h5",id:"invite_msg",class:"pad_invite_txt font-3dsregular drop",html:e}]}])}this.invite_imgDom=this.inviteContainer.getElement("span.pad_invite_img"),this.invite_msgDom=this.inviteContainer.getElement("h5.pad_invite_txt")},addWidgetNotification:function(e){d?h.addNotif({level:e.level,message:e.message,title:e.title,sticky:e.sticky}):require(["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(t,i){h=t,(d=i).setNotificationManager(t),c.addWidgetNotification(e)})},hideLastWidgetNotification:function(){d&&d.removeLastNotificationDisplayed()},refresh:function(){var e=l.getCurrentData();e.displayName&&this.updateWidgetTitle(e.displayName)},updateWidgetHeight:function(){r.body.setStyle("height","100%")},declareAllSubscribers:function(){p.push(e.subscribe({event:"Model.changeTitle"},function(e){null!=e&&l.setCurrentTitle(e),c.refresh()}))},dispose:function(){c=null,this.removeDragAndDropZone&&this.removeDragAndDropZone(this.canvasDiv);for(var t=0;t<p.length;t++)e.unsubscribe(p[t]);p=[]},createDragAndDropZone:function(i){var n=function(e){this.removeClassName("drag_over_class"),c.hideBlueBackground("none")},o=function(i){i.preventDefault(),this.removeClassName("drag_over_class"),c.hideBlueBackground("none");var n,o=!1;l.drag=!0;try{n=JSON.parse(i.dataTransfer.getData("text"))}catch(e){}if(n)t.isSet("3DPlay.Debug")&&console.log("3DPlay.Debug:W3DPlayMainView.dropFunction",n),n&&n.data&&n.data.items&&n.data.items.length>1&&(o=!0),l.setCurrentContent(n);else if(i.dataTransfer.files&&i.dataTransfer.files.length>0&&void 0!==i.dataTransfer.files[0]){t.isSet("3DPlay.Debug")&&console.log("3DPlay.Debug:W3DPlayMainView.dropFunction",i.dataTransfer.files),o=i.dataTransfer.files.length>1;var r=i.dataTransfer.files[0],d=s.getExtension(r.name);t.isSet("3DPlay.AllowDND")||["3DXML","PDF","STP","STEP","STPA"].indexOf(d.toUpperCase())>-1?e.publish({event:"Player.load",data:{input:{asset:{useConvertors:!1,localFile:r,format:d,filename:window.URL.createObjectURL(r),provider:"FILE",proxyurl:"none",requiredAuth:null,serverurl:""}}}}):(c.hideLastWidgetNotification(),c.addWidgetNotification({level:"error",title:"",message:a.DNDUnSupportedFileType+d,sticky:!1}))}if(o){c.hideLastWidgetNotification();var h={level:"info",title:a.FirstSelectedObjectLoaded_Title,message:a.FirstSelectedObjectLoaded,sticky:!1};if(l&&l.getPlayerRef()&&l.getPlayerRef().getExperience()&&c)l.getPlayerRef().getExperience().subscribeOnce("ASSET/LOADINGSTARTED",function(){c.addWidgetNotification(h)})}},r=function(e){e.preventDefault(),this.addClassName("drag_over_class"),c.displayBlueBackground(),c.updateBlueBackgroundMessage("DROPIT"),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")};i.addEventListener("dragenter",r),i.addEventListener("dragover",r),i.addEventListener("dragleave",n),i.addEventListener("dragend",n),i.addEventListener("drop",o),this.removeDragAndDropZone=function(e){e.removeEventListener("dragenter",r),e.removeEventListener("dragover",r),e.removeEventListener("dragleave",n),e.removeEventListener("dragend",n),e.removeEventListener("drop",o)}},hideShowBoxMessage:function(e){this.inviteContainer.setStyle("display",e)},updateBoxMessage:function(e){var t=l.getBoxClassIcon(e),i=l.getBoxMessageText(e);"DEFAULT"==e?(this.invite_imgDom.removeClassName(t),this.invite_imgDom.addClassName("fonticon-down-circled")):(this.hideShowBoxMessage("block"),this.invite_msgDom.setHTML(i),this.invite_imgDom.removeClassName("fonticon-down-circled"),this.invite_imgDom.addClassName(t))},updateWidgetTitle:function(e){if(r.setTitle(""),!l.widgetHasLightbox){var t="3DPlay";""!=e&&null!=e&&(t=e),r.setTitle(t)}}})}),define("DS/3DPlayWidgetViews/W3DPlayLightboxView",["UWA/Class","DS/vuekit/vuekit","DS/vue/vue","DS/ApplicationFrame/CommandsManager","DS/CoreEvents/Events","DS/3DPlaySupport/SupportList","DS/3DPlayConnectors/3DPlayInputPreProcessor","text!DS/3DPlayWidgetViews/W3DPlayLightboxView.html","i18n!DS/3DPlayHelper/assets/nls/SplashScreen","DS/3DPlay/3DPlay","DS/WebUtils/Tracker"],function(e,t,i,n,s,o,a,r,l,c,d){"use strict";var h,p,u={upload:"Upload3Dexp",comment:"Share3DComment",share:"ShareTo3DSwYm",download:"DownloadPDF",information:"RightSidePanel",saveScreenshot:"ShareDownload",printScreenshot:"SharePrint"};return e.extend({init:function(e){this._parent(e),this._content=e.content,this._createLightbox(e),this._exp=null,this._assetInfo=null},dispose:function(){this._exp=null,this._lightbox.hide(),p=null},onAssetLoadingStarted:function(e){if(this._lightbox.clean(),!widget.welcomeScreen||widget.getValue("xsceneStoredObjects")){let e=this._lightbox.$el.getElementsByClassName("vu-icon fonticon fonticon-close default");if(e)for(var t=0;t<e.length;t++)e[t].parentNode.className.contains("vu-icon-btn lightbox-bar-menu-item default")&&(e[t].parentNode.remove(),this.noCloseButton=!0)}this._lightbox.show(),this._lightbox.unselectAllActions(),e&&(this._assetInfo=this._assetInfoFromEventData(e),this._assetInfo&&this._updateWithAssetInfo(this._assetInfo))},onAssetLoadingEnd:function(e){this._lightbox.show(),e&&(this._assetInfo=this._assetInfoFromEventData(e),this._updateWithAssetInfo(this._assetInfo))},onAssetLoadingError:function(e){this._lightbox.ctx=e.ctx,this._lightbox.clean(),this._lightbox.show(),e&&(this._assetInfo=this._assetInfoFromEventData(e),this._updateWithAssetInfo(this._assetInfo))},setExperience:function(e){if(this._exp=e,this._lightbox.exp=e,e.lightbox=this,this._lightbox.customActions=[],e.onLightboxReady(),this._exp.subscribe("ASSET/LOADINGSTARTED",this.onAssetLoadingStarted.bind(this),!0),this._exp.subscribe("Model.changeCurrent",this.onAssetLoadingStarted.bind(this),!0),this._exp.subscribe("ASSET/LOADINGFINISHED",this.onAssetLoadingEnd.bind(this),!0),this._exp.subscribe("ASSET/LOADINGERROR",this.onAssetLoadingError.bind(this),!0),this._exp.subscribe("EXPERIENCE/ERROR",this.onAssetLoadingError.bind(this),!0),this._exp.addOnScenarioChangeCB(this.update.bind(this)),this._exp.loadAssetInfo&&(this._assetInfo=this._exp.loadAssetInfo),this._assetInfo&&(this._lightbox.show(),this._updateWithAssetInfo(this._assetInfo)),!this._assetInfo&&this._exp.isLoadingFinished())try{this.onAssetLoadingStarted(),this.onAssetLoadingEnd(this._exp.asset.input)}catch(e){console.warn("Lightbox : unable to update lightbox with asset information.")}},getContainer:function(){return this._container},onUploadCompleted:function(){this._lightbox.hideAllActions(),this._lightbox.setPlatformContentMode()},manageUploadCommand:function(e){this._lightbox.showAction("upload",e)},update:function(){this._assetInfo&&this._updateWithAssetInfo(this._assetInfo)},addActionToMoreMenu:function(e){this._lightbox.customActions||(this._lightbox.customActions=[]),this._lightbox.customActions.push(e)},_createLightbox:function(e){var t=e.parentHTML?e.parentHTML:document.body,n=e.idHTML?e.idHTML:"vue-lightbox",s=document.getElementsByClassName("vu-lightbox")[0];p=this,s||(this._container=UWA.createElement("div"),this._container.id=n,t.prepend(this._container),h=null),h||(h=new i({el:"#"+n,template:r,data:this._getLightboxData(),methods:this._getLightboxMethods(),mounted:function(){var t,i;t=this,i=e.content,t.$refs.W3DPlayLightboxContentRef.appendChild(i),t.hide()},updated:g})),this._lightbox=h},_getLightboxData:function(){return function(){return{title:"",objectType:{icon:"doc",backgroundColor:"#70036b"},actions:[{name:"upload",label:l.Lightbox_Upload,fonticon:"upload",selected:!1,hidden:!0},{name:"comment",label:l.Lightbox_Comment,fonticon:"comment",selected:!1,hidden:!0},{name:"share",label:l.Lightbox_Share,fonticon:"share-alt",selected:!1,hidden:!0},{name:"download",label:l.Lightbox_Download,fonticon:"download",selected:!1,hidden:!0},{name:"information",label:l.Lightbox_Information,fonticon:"info",selected:!1,hidden:!0}],moreMenuActions:[],moreActionsLabel:l.Lightbox_More,closeLabel:l.Lightbox_Close}}},_getLightboxMethods:function(){return{show:function(){var e=this.$el.querySelector(".lightbox-bar--widget-header");e&&(e.style.display="inherit")},hide:function(){var e=this.$el.querySelector(".lightbox-bar--widget-header");e&&(e.style.display="none")},clean:function(){this.hideAllActions(),this.title="",this.setObjectType("doc")},showAction:function(e,t){(f(u[e],this.exp)||"download"==e||"comment"==e&&this.exp&&"FTA"==this.exp.getScenarioManager().currentScenarioName)&&(t=void 0!==t&&t,this.getAction(e).hidden=t)},onClickClose:function(){if(this.exp)this.exp.toggleSplash?(this.exp.toggleSplash(!0),this.exp.clearView(),this.exp.playerSplashScreen.showView(this.exp.playerSplashScreen.views.loading),c.endAllCommands({ctx:this.exp.ctx,resetDefaultCmd:!0})):this.exp.playerSplashScreen&&(this.exp.playerSplashScreen.show(),this.exp.playerSplashScreen.showView(this.exp.playerSplashScreen.views.loading));else{var e=this.ctx;require(["DS/WebUtils/ContextedSingleton"],function(t){var i=t.get(e,"helper");i&&i.playerSplashScreen&&i.playerSplashScreen.showView(i.playerSplashScreen.views.loading)})}d.trackPageEvent("widget","lightbox","close"),this.clean(),this.hide(),widget.setValue("W3DPlayContent",""),widget.welcomeScreen.show(),widget.setTitle("")},onClickUpload:function(){v("Upload3Dexp",this.exp)},onClickComment:function(){this.toggleAction("comment",u.comment,"social")},onClickShare:function(){v("ShareTo3DSwYm",this.exp)},onClickDownload:function(){this._isPDFMode?v("DownloadPDF",this.exp):function(e){if(e&&e.args&&e.args.input&&e.args.input.asset&&"FILE"===e.args.input.asset.provider)if(e.args.input.asset.originalAsset){var t=new a;t.run(e.args.input.asset.originalAsset,function(t){D(t.asset,e)})}else e.loadAssetInfo&&e.loadAssetInfo.originalAsset?D(e.loadAssetInfo.originalAsset,e):D(e.args.input.asset,e)}(this.exp)},onClickInformation:function(){this.toggleAction("information",u.information,"properties")},onClickSaveScreenshot:function(){v("ShareDownload",this.exp)},onClickPrintScreenshot:function(){v("SharePrint",this.exp)},setObjectType:function(e){this.objectType=e},setFileMode:function(){this.showAction("upload"),this.showAction("information")},setPlatformContentMode:function(){this.showAction("comment"),this.showAction("share"),this.showAction("information"),this.addMoreMenuActionsIfNotExists(function(e,t){var i=[];e.customActions&&e.customActions.forEach(function(e){i.push(e)});f(u.saveScreenshot,t)&&f(u.printScreenshot,t)&&i.push({name:"saveScreenshot",fonticon:"picture-export",text:l.Lightbox_Save_Screenshot,handler:e.onClickSaveScreenshot},{name:"printScreenshot",fonticon:"print",text:l.Lightbox_Print_Screenshot,handler:e.onClickPrintScreenshot});return i}(this,this.exp)),this.unselectActionsOnSidePanelClose()},setDownloadableContentMode:function(){this._isPDFMode=!1,this.showAction("download")},setPDFMode:function(){this._isPDFMode=!0,this.showAction("download"),function(e){if(e.frmWindow)try{e.frmWindow.getActionBar().getContent().querySelector("[data-name=DownloadPDF]").hide()}catch(e){console.warn("Lightbox: no Download command to hide from ActionBar")}}(this.exp)},hideAllActions:function(){this.actions.forEach(function(e){e.hidden=!0}),this.moreMenuActions=[]},unselectAllActions:function(){this.exp&&this.actions.forEach(function(e){e.selected&&(e.selected=!1,b(!1,u[e.name],this.exp))},this)},toggleAction:function(e,t,i){var n=this.getAction(e),s=f("RightSidePanel",this.exp);n&&(n.selected?(n.selected=!1,b(!1,t,this.exp)):(s&&s.forEachPropFacet&&(s.forEachPropFacet(function(e){e.facet.name==i?e.visible=!0:e.visible=!1}),s._propertiesWdg.selectFacet(i)),this.unselectAllActions(this.exp),n.selected=!0,"comment"==e&&this.exp&&"FTA"==this.exp.getScenarioManager().currentScenarioName&&s?s.toggleState():v(t,this.exp)))},addMoreMenuActionsIfNotExists:function(e){e.forEach(function(e){this.moreMenuActions.find(function(t){t.name,e.name})||this.moreMenuActions.push(e)}.bind(this))},unselectActionsOnSidePanelClose:function(){var e=f("RightSidePanel",this.exp);e&&e.onStateChange(function(e){!e&&this.actions&&this.actions.length&&this.actions.forEach(function(e){e.selected=!1})}.bind(this))},getAction:function(e){return this.actions.find(t=>t.name==e)}}},_updateWithAssetInfo:function(e){var t=e;if(Array.isArray(t)&&(t=t[0]),t){var i=m(t);i&&(this._lightbox.title=i),this._lightbox.hideAllActions();var n=function(e){if(e.localFile&&-1===[].indexOf(e.format.toUpperCase())||e.fileAttr)return"FILE";if("EV6"==e.provider||e.originalAsset&&"EV6"==e.originalAsset.provider)return"3DSPACE";if(e.driveAttr)return"3DDRIVE";if(e.swymAttr)return"3DSWYM";if(e.originalAsset)return e.originalAsset.provider;return""}(t);switch(n){case"FILE":this._lightbox.setFileMode();break;case"3DDRIVE":case"3DSWYM":case"3DSPACE":this._lightbox.setPlatformContentMode()}(t.url||"3DSWYM"==n)&&this._lightbox.setDownloadableContentMode(),this._lightbox.setObjectType(function(e){var t={icon:null,backgroundColor:"#70036b"},i=m(e),n=e.type;!n&&i&&(n=i.split(".").pop());if(!n)return t.icon="3d-object",t;t.icon=function(e){var t,i=Object.assign({},o.FILE,o["3DSPACE"])[e];return i&&(t={"3DPlay2DExperience":"doc","3DPlayUDLExperience":"doc","3DPlayTextExperience":"doc","3DPlayImageExperience":"picture","3DPlaySVGExperience":"picture","3DPlayImageExperience":"picture","3DPlayVideoExperience":"video","3DPlay360VideoExperience":"video","3DPlayCollaborativeExperience":"3d-object"}[i[1]]),t}(n),t.icon||"story"!=e.objectSubType||(t.icon="app-3dstory");t.icon||(t.icon="doc");return t}(t)),this._exp&&function(e,t){try{const i=y(e);if(t.showDownloadCommand&&"pdf"==i)return!0}catch(e){console.error("Lightbox: unable to check if asset is PDF\n"+e.message)}return!1}(t,this._exp)&&this._lightbox.setPDFMode()}},_assetInfoFromEventData:function(e){return e.loadAssetInfo&&(e.loadAssetInfo.tenant||e.loadAssetInfo.source||e.loadAssetInfo.driveAttr||e.loadAssetInfo.swymAttr)?e.loadAssetInfo:e.data?e.data:e.model&&"blob"!=e.model?e.model:this._exp&&this._exp.loadAssetInfo?this._exp.loadAssetInfo:this._assetInfo}});function g(){if(p&&p.noCloseButton){let e=document.getElementsByClassName("lightbox-bar__divider")[0];e&&e.remove()}}function m(e){var t=null,i=e;return Array.isArray(i)&&(i=i[0]),i.localFile&&i.localFile.name?t=i.localFile.name:i.swymAttr&&i.swymAttr.title?t=i.swymAttr.title:i.originalAsset&&i.originalAsset.displayname?t=i.originalAsset.displayname:i.displayname?t=i.displayname:i.displayName?t=i.displayName:i.fileAttr&&i.fileAttr.title?t=i.fileAttr.title:i.fileAttr&&i.fileAttr.name?t=i.fileAttr.name:i.driveAttr&&i.driveAttr.title&&(t=i.driveAttr.title),t}function f(e,t){if(t&&e){var i;if(i=n.getCommand(e,t.ctx))return i;if(i=n.getCommandCheckHeader(e,t.ctx))return i}return null}function v(e,t){if(t&&e){t.viewer&&t.viewer.launchReviewMode&&!t.viewer.reviewMode&&t.viewer.launchReviewMode();var i=n.getCommand(e,t.ctx);if(i)return void i.begin();if(i=n.getCommandCheckHeader(e,t.ctx))return void i.setState(!0);console.warn("Can not launch command from lightbox: command "+e+" not found")}}function b(e,t,i){if(t&&i){"Share3DComment"==t&&(t="RightSidePanel");var n=f(t,i);n&&n.setState&&n.setState(e)}}function D(e,t){var i=null;if(function(e){const t=["3DPlayImageExperience"];try{return t.includes((i=y(e),Object.assign({},o.FILE,o["3DSPACE"])[i][1]))}catch(e){console.error("Lightbox: unable to check if asset is image\n"+e.message)}var i;return!1}(e))try{i=t.loader.doc.src}catch(e){console.warn("Lightbox: cannot get blob url from exp for image download. http url will be used. It might trigger a new tab opening instead of browser download\n"+e)}if(!i)if(e.filename&&(e.filename.startsWith("http")||e.filename.startsWith("https")))i=e.filename;else{if(!e.url)throw new Error("Lightbox: cannot get a download URL from asset.");i=e.url}var n=e.title;if(!n||""==n)try{n=m(e)}catch(e){n="file",console.warn("Lightbox: cannot get file name for download. Default name will be set : "+n+"\n"+e.message)}var s=document.createElement("a"),a=function(e){e.stopPropagation(),document.body.removeChild(s),s.removeEventListener("click",a)};s.href=i,s.target="_blank",s.download=n,s.addEventListener("click",a),document.body.appendChild(s),s.click()}function y(e){var t=e.type;if(!t){t=m(e).split(".").pop()}return t}}),define("DS/3DPlayWidgetViews/W3DPlayerView",["DS/CoreEvents/Events","UWA/Class","DS/3DPlayHelper/3DPlayHelper","DS/3DPlaySupport/AssetSupport","i18n!DS/3DPlayHelper/assets/nls/SplashScreen","css!DS/3DPlayWidgetViews/W3DPlayerView","DS/WebSystem/Environment","DS/WebappsUtils/WebappsUtils","DS/WebUtils/Tracker","DS/Windows/ImmersiveFrame","DS/Controls/Button","DS/Controls/Expander","DS/Windows/Panel","DS/WebUtils/WebServices","DS/Controls/ThumbnailView","DS/WelcomeScreenView/WelcomeScreen","DS/WelcomeScreenView/WelcomeScreenButtonController","DS/WelcomeScreenView/WelcomeScreenMRUController","DS/3DPlayWidgetViews/W3DPlayLightboxView","DS/WebUAUtils/WebUAUtils"],function(e,t,i,n,s,o,a,r,l,c,d,h,p,u,g,m,f,v,b,D){"use strict";var y,S,x,A,w=[];return t.extend({init:function(t,i){y=t,S=i,a.isSet("ODT_MODE")||window.__karma__||(this.lightbox=new b({content:S.getCanvasDiv(),parentHTML:y.body}),S.widgetHasLightbox=!0,y.hasLightbox=!0),this._parent(t,i),A=this,w.push(e.subscribeOnce({event:"PrefsCtrl.PreferencesReady"},function(e){A.instantiate3DPlayWebPlayer()})),w.push(e.subscribe({event:"Player.load"},function(e){x&&(x.load(e),S.firstLoading=!0,!S.widgetHasLightbox&&e&&e.input&&e.input.asset&&e.input.asset.localFile&&y.setTitle(e.input.asset.localFile.name))})),w.push(e.subscribe({event:"Model.changeCurrent"},function(e){if(A.instantiate3DPlayWebPlayer(),A.lightbox){var t={};e&&e.data&&e.data.items&&e.data.items.length&&(t.loadAssetInfo=e.data.items[0]),A.lightbox.onAssetLoadingStarted(t)}})),w.push(e.subscribe({event:"Model.changeCSO"},function(e){var t;x.instance&&x.instance.pad3DViewer&&(t=x.instance.pad3DViewer._lockCSONotification,x.instance.pad3DViewer._lockCSONotification=!0),x.emptySelection(),x.selectNode(e);setTimeout(function(){x.instance&&x.instance.pad3DViewer&&(x.instance.pad3DViewer._lockCSONotification=t)},50)}))},instantiate3DPlayWebPlayer:function(e){var t=S.getCurrentData();a.isSet("3DPlay.Debug")&&console.log("3DPlay.Debug:instantiate3DPlayWebPlayer",t),t.displayName?S.setCurrentTitle(t.displayName):y.setTitle(""),S.get3DPlayWebInputObject(t,function(i){i.container=S.getCanvasDiv(),!i.input.asset&&e?i.input.asset=e:i.input&&i.input.asset&&(i.input.asset.displayname=t.displayName),A.startPlayer(i)})},dispose:function(t){x&&(x.dispose(t),x=null),this.lightbox&&(this.lightbox.dispose(),this.lightbox=null),S.widgetHasLightbox&&(S.widgetHasLightbox=!1),y=null,S=null,A=null;for(var i=0;i<w.length;i++)e.unsubscribe(w[i]);w=[]},startPlayer:function(e){if(this.applicationFrameOptions&&e.options&&(e.options.callbacks&&(e.options.callbacks=UWA.extend(e.options.callbacks,this.applicationFrameOptions.options.callbacks,!0)),e.options=UWA.extend(e.options,this.applicationFrameOptions.options,!0),e.input&&this.applicationFrameOptions.experience&&(e.input.experience=this.applicationFrameOptions.experience,delete this.applicationFrameOptions.experience)),this.applicationFrameOptions&&this.applicationFrameOptions.options&&this.applicationFrameOptions.options.pad3DViewer&&delete this.applicationFrameOptions.options.pad3DViewer,x)x.isReady()?x.load(e):S.isPendingLoadingCozNotReady=!0;else{if(e.options.callbacks.EXPERIENCE=e.options.callbacks.EXPERIENCE||{},this.lightbox){e.options.callbacks.EXPERIENCE.ExperienceReady=function(e){this.lightbox.setExperience(e)}.bind(this),e.options.callbacks.EXPERIENCE.Error=function(e){this.lightbox.onAssetLoadingError(e)}.bind(this),e.options.callbacks.ASSET||(e.options.callbacks.ASSET={});var t=e.options.callbacks.ASSET.LOADINGFINISHED;e.options.callbacks.ASSET.LOADINGFINISHED=function(e){t&&t(e),this.lightbox.onAssetLoadingEnd(e)}.bind(this);var n=e.options.callbacks.ASSET.LOADINGSTARTED;e.options.callbacks.ASSET.LOADINGSTARTED=function(e){n&&n(e),this.lightbox.onAssetLoadingStarted(e)}.bind(this);var o=e.options.callbacks.ASSET.LOADINGERROR;e.options.callbacks.ASSET.LOADINGERROR=function(e){o&&o(e),this.lightbox.onAssetLoadingError(e)}.bind(this)}e.options.callbacks.EXPERIENCE.EXPERIENCESPLASHSCREEN=function(e){if(!a.isSet("3DPlay.LandingPage.disable")&&(!S.getW3DPlayContentPref()||S.getW3DPlayContentPref()&&y.welcomeScreen)){var t=e.elements.container;t.addClassName("Landing-Page_container");var i="",n="https://help.3ds.com/2023x/"+{en:"English",fr:"French",de:"German",ja:"Japanese",zh:"Simplified_Chinese",es:"Spanish",ko:"Korean",ru:"Russian",it:"Italian","pt-BR":"Portuguese_Brazil","zh-TW":"Traditional_Chinese",pl:"Polish",cs:"Czech"}[y.lang]+"/DSDoc/X3dplawWidgetMap/X3dplaw-c-ov.htm";document.location.host.includes("215dsi0708")?(!0,i="https://dsext001-eu1-215dsi0708-3dswym.3dexperience.3ds.com/#community:1309"):(!0,i="https://r1132100503382-eu1-3dswym.3dexperience.3ds.com/#community:4");var o=D.getEmbeddedHelpFullPath("WNApps/X3DPLAW_AP-index.html");let a=new m({title:"3DPlay",subtitle:s.Play_Subtitle,background:r.getWebappsBaseUrl()+"3DPlayWidgetViews/assets/images/3DPlayHomePage.png",linksCategories:[{id:"ContentAndKnowledge",i18n:{title:s.Content_And_Knowledge},links:[{id:"UserAssistance",i18n:{title:s.User_Assistance},icon:"i-question",url:n},{id:"WhatsNew",i18n:{title:s.Whats_New},icon:"megaphone",url:o}]},{id:"SocialNetworks",i18n:{title:s.Social_Networks},links:[{id:"Community",i18n:{title:s.Community},icon:"topbar-users",url:i}]}],buttons:{items:[{id:"OpenContent",icon:"open",i18n:{title:s.Open_Content},controller:new f({onAction:e=>(require(["DS/PADServices/utils/SearchUtils"],function(e){var t=!0,i={title:"Open Content",precond:'([ds6w:type]:"swym:Picture" OR [ds6w:type]:"swym:3dModel" OR [ds6w:type]:"swym:Document" OR types/Document OR types/File OR types/CATProduct OR types/CATPart OR types/Products OR types/DOCUMENTS OR types/Part OR types/DesignSight)',search_criteria_to_display:"",showApplyButton:!1,applyButton_Nls:"",multiSel:!1,callback:function(e){let t={provider:(e=Array.isArray(e)?e[0]:e).sourceid.split(":")[0],displayName:e["ds6w:label"],displayPreview:e.preview_url_value,objectId:e.id,envId:e.sourceid.split(":")[1],objectType:e["ds6w:type_value"]};t.serviceId=t.provider,"3dspace"===t.provider?(t.serverurl=S.availableServices[0].url,t.displayType=e["ds6w:type"],t.requiredAuth="passport",t.contextid=e.contextid,t.envId||(t.envId="OnPremise")):"drive"===t.provider?(t.serviceId=e["ds6w:dataSource"],t.provider=e["ds6w:dataSource"],t.physicalid=t.objectId,t.requiredAuth="passport"):"3DSwym"!==t.provider&&"swym"!==provider||(t.serviceId=t.provider,t.tenant=t.envId),S.setCurrentContentFromPublishedFile(t),A.instantiate3DPlayWebPlayer(t),l.trackPageEvent("widget","search",t.provider)},cancel:function(e){(t=!t)&&l.trackPageEvent("widget","search","cancel")}};e.inAppsSearch(i)}),Promise.resolve())})},{id:"MostRecentContent",i18n:{title:s.Most_Recent_Content},icon:"search-recent",hasCustomContent:!0,controller:new f({onAction:e=>{var t=document.createElement("div"),i=new c;i.inject(t),i.elements.container.style.setProperty("position","relative");document.createElement("div");return S.loadMru().then(e=>{var i=[];0<e.length&&e.forEach(function(e,n){var s=e.data.items[0],o=new g({size:"small"}).inject(t);s.title||(s.title=s.displayName),s.image||(s.image=s.displayPreview),o.setTitle(s.title),o.setSubtitle(s.displayType),o.setPicture(s.image),o.elements.menu.remove(),o.elements.badgeBottomRight.remove(),o.elements.badgeTopRight.remove(),o.elements.checkbox.remove(),o.asset=s,o.content=e,o.onClick(function(e){o.asset.displayName&&S.setCurrentTitle(o.asset.displayName),S.setCurrentContent(o.content,!1),l.trackPageEvent("widget","mru","index",n)}),i.push(o)})}),l.trackPageEvent("widget","mru","open"),Promise.resolve(t)}})}]},MRU:{items:[],controller:new v({onDblHit:e=>{console.log("Double Hit on ${cellInfo.nodeModel.options.label}")},onContextualMenu:e=>{}})},dragAndDrop:{callbacks:{onDragEnter:e=>Promise.resolve("OverFullPage"),onDrop:e=>{console.log("Object Drop")}}}});t.prepend(a.getDOM()),y.welcomeScreen=a}},x=new i(e)}S.setPlayerRef(x)},widgetRefreshHandler:function(){var e;if(x){x.instance&&x.instance.refresh&&(e=x.instance.refresh());try{var t=x.instance.args.input.experience.filename||x.instance.args.input.experience;l.trackPageEvent("infos","refresh",t,e?1:0,{count:l.incCommandCounter()})}catch(e){}if(e)return!0;x.dispose(),x=null}return S.getCanvasDiv().empty(),!1},search:function(e){x&&x.instance&&x.instance.search&&x.instance.search(e)},resetsearch:function(e){x&&x.instance&&x.instance.resetsearch&&x.instance.resetsearch(e)}})});