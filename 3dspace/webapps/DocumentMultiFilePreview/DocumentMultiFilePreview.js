define("DS/DocumentMultiFilePreview/eventHandlers/FilesEvents",["UWA/Core"],function(e){"use strict";return e.Class.extend({init:function(e){this.ctrl=e},connect:function(e,t,n){var o=this;this.ctrl.events.addEventListener("user-dropped-files",function(e){}),this.ctrl.events.addEventListener("user-selects-files-for-upload",function(e){}),this.ctrl.events.addEventListener("enox-files-collection-count-changed",function(t){e.switchView(e.view)}),this.ctrl.events.addEventListener("enox-file-node-selection-changed",function(e){}),this.ctrl.events.addEventListener("enox-docfiles-switch-view",function(t){e.switchView(t)}),this.ctrl.events.addEventListener("search-toggle-change",function(e){t.selectionChanged()}),this.ctrl.events.addEventListener("left-navigationPanel-Expanded",function(e){t.selectionChanged()}),this.ctrl.events.addEventListener("enox-files-parent-changed",function(e){t.selectionChanged(),o.ctrl.events.publish({event:"reset-search-textbox"})})}})}),define("DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Download",["UWA/Core","i18n!DS/DocumentMultiFilePreview/assets/nls/DocumentPreview","css!DS/DocumentPreview/DocumentPreview.css"],function(e,t){"use strict";var n=function(e){return{id:"CustomPreviewDownload",dataElements:{docV2Public:!0,typeRepresentation:"functionMenuIcon",icon:{iconName:"download",fontIconFamily:1},label:t.get("Download"),tooltip:{shortHelp:t.get("Download")},position:"far",priority:6,value:{menu:[{type:"PushItem",title:t.get("Download_File"),icon:{iconName:"download",fontIconFamily:1},tooltip:{shortHelp:t.get("Download_File")},action:{callback:function(){console.log("File Download Initiated!"),n.DownloadFile(e)}}},{type:"PushItem",title:t.get("Download_Document"),tooltip:{shortHelp:t.get("Download_Document")},icon:{iconName:"download",fontIconFamily:1},action:{callback:function(){console.log("Document Download Initiated!"),n.DownloadDocument(e)}}}]},visibleFlag:!0},updateForSelection:function(t,n){var o=e.previewedDocumentStatusModel.getPreviewedDocumentFiles().length>1;t({visibleFlag:1==e.getSelectedNodes().length&&o})}}};return n.DownloadDocument=function(e){require(["DS/DocumentCommands/V2/Actions/Download"],function(t){e.DocumentDownloadInstance=new t(e.DocCmdOptions),e.DocumentDownloadInstance.execute()})},n.DownloadFile=function(e){require(["DS/DocumentCommands/V2/FileActions/Download"],function(t){e.FileDownloadInstance=new t(e),e.FileDownloadInstance.execute()})},n.execute=function(e){console.warn("Strange! I should not be here.")},n}),define("DS/DocumentMultiFilePreview/containers/rightSideContent/RightInformationPanelContainer",["UWA/Core","UWA/Element","DS/CoreEvents/ModelEvents","css!DS/DocumentMultiFilePreview/css/RightInformationPanelContainer.css"],function(e,t,n,o){return e.Controls.Abstract.extend({name:"docm-preview-right-container",options:{className:""},init:function(e){e.rightContainerContentControl=this,this.events=e.options.events||new n,delete e.options.events,this._parent(e.options),e.options.events=this.events,this.buildSkeleton()},buildSkeleton:function(){this.elements.container=e.createElement("div",{class:this.getClassNames()}),this.elements.content=e.createElement("div",{class:this.getClassNames("-content")}).inject(this.elements.container),this.elements.info=e.createElement("div",{class:this.getClassNames("-content-info")}).inject(this.elements.content),this.elements.info.hide(),this.options.skeleton.rightContainerContent.setHTML(this.elements.container),this.loadPanel()},loadPanel:function(){}})}),define("DS/DocumentMultiFilePreview/containers/centerContent/PreviewProvider",["UWA/Core","DS/3DPlayHelper/3DPlayHelper","DS/WebappsUtils/WebappsUtils","DS/DocumentCommonInfra/TrackerAPI","i18n!DS/DocumentPreview/assets/nls/DocumentPreview"],function(e,t,n,o,i){"use strict";return function(t,l){var s,r={build:function(t,n){this.ctrl=t,t.options.document&&t.options.document.relateddata&&e.is(t.options.document.relateddata.files,"array")?this.files=t.options.document.relateddata.files:this.files=[],this.selectedFileId=t.options.selectedFileId;var o=this;if(null!=this.selectedFileId){var l=this.files.find(function(e){return e.id==o.selectedFileId});null!=l?(this.selectedFile=l,t.options.selectedFileId=void 0):t.showNotification("error",i.get("CANNOTACCESSFILE_TITLE"),"",i.get("CANNOTACCESSFILE_MESSAGE"),!0)}if(null==this.selectedFile&&this.files.length>0&&(this.selectedFile=this.ctrl.options.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile()||this.files[0]),this.playdata={asset:{provider:"EV6",dtype:"DOCUMENTS",serverurl:t.options.platformUrls["3DSpace"],tenant:t.options.platformUrls.platformId||t.options.tenant,contextId:t.options.securityContext}},this.container=n,this.fillFilebar(),this.canvas=e.createElement("div",{class:"viewer-canvas"}),this.canvas.inject(this.container),null!=this.selectedFile&&this.files.length>1){r.documentId=t.options.document.id,r.playdata.asset.physicalid=t.options.document.id;var s={asset:r.playdata.asset,physicalId:this.selectedFile.id,renderTo:r.canvas,fileName:this.selectedFile.dataelements.title,docId:t.options.document.id,docType:t.options.document.type,fileCount:this.files.length};r.fileid=this.selectedFile.id,r.filename=this.selectedFile.dataelements.title,r.play(s)}else{r.documentId=t.options.document.id,r.playdata.asset.physicalid=t.options.document.id;s={asset:r.playdata.asset,physicalId:t.options.document.id,renderTo:r.canvas,docId:t.options.document.id,docType:t.options.document.type,fileCount:1};r.play(s)}},fillFilebar:function(){t.options.previewedDocumentStatusModel.addEvent("onChange:previewedDocumentSelectedFileId",function(e,t){if(console.log(e),null!=t&&e.getPreviewedDocumentFiles().length>1){r.playdata.asset.physicalid=e.getPreviewedDocument().id;var n={asset:r.playdata.asset,physicalId:t||e.getPreviewedDocumentSelectedFile().id,renderTo:r.canvas,fileName:e.getPreviewedDocumentSelectedFile().dataelements.title,docId:e.getPreviewedDocument().id,docType:e.getPreviewedDocument().type,fileCount:1};r.fileid=t,r.filename=e.getPreviewedDocumentSelectedFile().dataelements.title,r.play(n)}else{r.playdata.asset.physicalid=e.getPreviewedDocument().id;n={asset:r.playdata.asset,physicalId:e.getPreviewedDocument().id,renderTo:r.canvas,docId:e.getPreviewedDocument().id,docType:e.getPreviewedDocument().type,fileCount:1};r.play(n)}}),t.options.previewedDocumentStatusModel.addEvent("onChange:previewedDocument",function(e,n){if(console.log(e),n.id!=r.documentId)if(null!=e.getPreviewedDocumentSelectedFile()&&e.getPreviewedDocumentFiles().length>1){r.documentId=t.options.document.id,r.playdata.asset.physicalid=n.id;var o={asset:r.playdata.asset,physicalId:e.getPreviewedDocumentSelectedFileId()||e.getPreviewedDocumentSelectedFile().id,renderTo:r.canvas,fileName:e.getPreviewedDocumentSelectedFile().dataelements.title,docId:n.id,docType:n.type,fileCount:1};r.fileid=e.getPreviewedDocumentSelectedFileId()||e.getPreviewedDocumentSelectedFile().id,r.filename=e.getPreviewedDocumentSelectedFile().dataelements.title,r.play(o)}else{r.documentId=t.options.document.id,r.playdata.asset.physicalid=n.id;o={asset:r.playdata.asset,physicalId:n.id,renderTo:r.canvas,docId:n.id,docType:n.type,fileCount:1};r.play(o)}})},play:function(i){i.asset.physicalid=i.physicalId,i.renderTo.empty(),i.renderTo.setAttribute("fileName",i.fileName),s&&s.dispose&&s.dispose(),s=void 0;var l={input:{asset:i.asset},options:{loading:"autoplay"}},r=e.createElement("iframe").inject(i.renderTo);r.style.position="absolute",r.style.width="100%",r.style.height="100%",r.style.border="0px",r.style.top="0px",r.style.left="0px",r.allowFullScreen=r.mozAllowFullScreen=r.webkitAllowFullScreen=!0,r.setAttribute("allowFullScreen",""),r.addEventListener("load",function(e){try{e.target.contentDocument.getElementById("canvas-div").style.backgroundColor="white"}catch(e){}});var a=n.getProxifiedWebappsBaseUrl();a||(a=n.getWebappsBaseUrl()),r.src=a+"/3DPlayHelper/3DPlaySyndication.html?params="+encodeURI(JSON.stringify(l));var c=new Date-window.previewLoadStart;o.sendTrackerPageEvent({category:"docm.command.preview2",action:"click",label:"Document Preview",pd:{docId:i.docId,docType:i.docType,source:t.options.uaSource},pv:{totalTimeTaken:c,success:1,fileCount:i.fileCount}})},destroy:function(){s&&s.dispose&&s.dispose(),s=void 0,this.container.empty(!0)}};return r.build(t,l),r}}),define("DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Information",["UWA/Core","i18n!DS/DocumentMultiFilePreview/assets/nls/DocumentPreview","css!DS/DocumentMultiFilePreview/css/TopNavBarContainer.css"],function(e,t){"use strict";var n=function(e){return{id:"CustomPreviewInformation",dataElements:{docV2Public:!0,typeRepresentation:"functionIcon",icon:{iconName:"info",fontIconFamily:1},label:t.get("INFORMATION"),tooltip:t.get("INFORMATION"),position:"far",priority:8,value:function(t){t.options=e,n.execute(t)},visibleFlag:!0},execute:function(){n.execute({options:e})},updateForSelection:function(t,n){var o=!1;e.ctrl.rightContainerContentControl&&(null==e.ctrl.rightContainerContentControl.elements.info||e.ctrl.rightContainerContentControl.elements.info.isHidden()||(o=!0)),t({visibleFlag:1==e.getSelectedNodes().length,icon:{iconName:"info",fontIconFamily:1,className:o?"info-active":""}})}}};return n.execute=function(e){var t=e.options.ctrl.rightContainerContentControl,n=e.options;(e.options.keepOpen||t.elements.info.isHidden())&&(e.options.keepOpen=!0,null==t.propertiesComponent?(t.options.nodeModels=[t.options.nodeModel],t.options.documents=[t.options.document],require(["DS/DocumentPreview/PropertiesComponent"],function(o){t.propertiesComponent=new o(t.options),t.propertiesComponent.events.unsubscribeAll({event:"close-document-properties"}),t.propertiesComponent.events.subscribe({event:"close-document-properties"},function(){t.elements.info.hide(),t.options.skeleton.setCollapseFlagFromUIInteraction("right",!0),e.options.ctrl.topbarControl.toolbar.selectionChanged()}),e.options.ctrl.previewedDocumentStatusModel.addEvent("onChange:previewedDocumentFiles",function(e,n){t.propertiesComponent.nodeModels=[t.options.nodeModel],t.propertiesComponent.setSelection([t.options.document])}),t.propertiesComponent.events.subscribe({event:"edit-prop-property-change"},function(e){if("Title"===e.attribute){var t=e.attribute,o=e.editprop._attributes[t].value;n.ctrl.navBar.updateDocumentName(o)}}),t.propertiesComponent.inject(t.elements.info)})):(t.propertiesComponent.nodeModels=[t.options.nodeModel],t.propertiesComponent.setSelection([t.options.document]))),t.elements.info.isHidden()?(t.elements.info.show(),t.options.skeleton.setCollapseFlagFromUIInteraction("right",!1)):e.options.keepOpen&&(t.elements.info.hide(),t.options.skeleton.setCollapseFlagFromUIInteraction("right",!0)),e.options.ctrl.navBar.toolbar.selectionChanged()},n}),define("DS/DocumentMultiFilePreview/models/PreviewedDocumentStatusModel",["UWA/Class/Model","UWA/Class/Debug"],function(e,t){return e.extend(t,{defaults:{previewedDocument:void 0,previewedDocumentFiles:[],previewedDocumentSelectedFile:void 0,previewedDocumentSelectedFileId:void 0,selectedFileModifiedToken:(new Date).toISOString()},getPreviewedDocument:function(){return this.get("previewedDocument")},getPreviewedDocumentFiles:function(){return this.get("previewedDocumentFiles")},getPreviewedDocumentSelectedFile:function(){return this.get("previewedDocumentSelectedFile")},getPreviewedDocumentSelectedFileId:function(){return this.get("previewedDocumentSelectedFileId")},appendNewFileInToPreviewedDocument:function(e){var t=[...this.get("previewedDocumentFiles"),e];this.set({previewedDocumentFiles:t})},appendNewFilesInToPreviewedDocument:function(e){var t=[...this.get("previewedDocumentFiles"),...e];this.set({previewedDocumentFiles:t})},changePreviewedDocumentSelectedFile:function(e){this.set({previewedDocumentSelectedFile:e})},changePreviewedDocumentSelectedFileId:function(e){this.set({previewedDocumentSelectedFileId:e})},changePreviewedDocument:function(e){this.set({previewedDocument:e})},changePreviewedDocumentFilesArray:function(e){this.set({previewedDocumentFiles:e})},changePreviewedDocumentSelectedFileWithId:function(e){var t=this.get("previewedDocumentFiles").filter(t=>t.id==e);t.length>0&&this.set({previewedDocumentSelectedFile:t[0]})},removeFileFromPreviewedDocumentFiles:function(e){var t=this.getPreviewedDocumentFiles().length,n=this.getPreviewedDocumentFiles().filter(t=>t.id!==e);n.length<t&&(this.set({previewedDocumentFiles:n}),this.handlePreviewedDocumentSelectedFile())},removeFilesFromPreviewedDocumentFiles:function(e){var t=this.getPreviewedDocumentFiles().length,n=this.getPreviewedDocumentFiles().filter(t=>!e.includes(t.id));n.length<t&&this.set({previewedDocumentFiles:n})},updateFileInPreviewedDocumentFiles:function(e,t){const n=this.get("previewedDocumentFiles").map(n=>n.id===e?t:n);this.set({previewedDocumentFiles:n})},handlePreviewedDocumentSelectedFile:function(){var e=this.getPreviewedDocumentFiles(),t=this.getPreviewedDocumentSelectedFile();e.find(e=>e.id==t.id)||(e.length>0?this.set({previewedDocumentSelectedFile:e[0]}):this.set({previewedDocumentSelectedFile:void 0}))},refreshSelectedFileModifiedToken:function(){this.set({selectedFileModifiedToken:(new Date).toISOString()})},getSelectedFileModifiedToken:function(){return this.get("selectedFileModifiedToken")}})}),define("DS/DocumentMultiFilePreview/MultiFilePreviewEvents",["UWA/Core"],function(e){"use strict";return e.Class.extend({init:function(e){this.ctrl=e,this.connect()},connect:function(){var e=this;if(!this.ctrl.events.addSingletonEventListener){var t={};e.ctrl.events.addSingletonEventListener=function(n,o,i){t[n]&&e.ctrl.events.unsubscribe(t[n]),t[n]=e.ctrl.events.addEventListener(o,i)}}this.ctrl.events.addEventListener("enox-file-node-selection-add",function(t){e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFileWithId(t.options.data.id),e.ctrl._updateSelectedNodeCache(t)}),e.ctrl.events.addSingletonEventListener("doc-cmd-evts-show-notification","docv2-show-notification",function(t){e.ctrl.controller.helper.showNotification(t.level,t.title,t.subtitle,t.message,t.sticky,t.allowUnsafeHTML)})}})}),define("DS/DocumentMultiFilePreview/eventHandlers/PreviewedDocumentModelEvents",["UWA/Core"],function(e){"use strict";return e.Class.extend({init:function(e){this.ctrl=e,this.connect(),this.ctrl.options.documentManagedByPreview&&this.hookGlobalFileEvents()},connect:function(){var e=this;this.ctrl.previewedDocumentStatusModel.addEvent("onChange:previewedDocumentFiles",function(t,n){var o=n.length;o>1&&!e.ctrl.leftPanelLoaded?e.ctrl.reCreateLeftNavigationPanel():o<2&&e.ctrl.destroyLeftNavigationPanel()}),this.ctrl.previewedDocumentStatusModel.addEvent("onChange:previewedDocumentSelectedFile",function(e,t){e.refreshSelectedFileModifiedToken(),t?e.changePreviewedDocumentSelectedFileId(t.id):e.changePreviewedDocumentSelectedFileId(void 0)})},hookGlobalFileEvents:function(){var e=this;require(["DS/PlatformAPI/PlatformAPI"],function(t){e.docmFileAddedToDocumentToken=t.subscribe("docm-file-added-to-document",function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&(e.ctrl.controller.files.addFiles(t.newFiles,"left Panel event"),e.ctrl.previewedDocumentStatusModel.appendNewFilesInToPreviewedDocument(t.newFiles),e.ctrl.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile()||e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFile(e.ctrl.previewedDocumentStatusModel.getPreviewedDocumentFiles()[0]),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())}),e.docmFilesDeletedFromDocumentToken=t.subscribe("docm-files-deleted-from-document",function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&(e.ctrl.controller.files.removeFilesByIds(t.deletedFileIds),e.ctrl.previewedDocumentStatusModel.removeFilesFromPreviewedDocumentFiles(t.deletedFileIds),t.deletedFileIds.includes(e.ctrl.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile().id)&&e.ctrl.previewedDocumentStatusModel.handlePreviewedDocumentSelectedFile(),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())}),e.docmFilesUpdatedDocumentToken=t.subscribe("docm-file-updated-to-document",function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&e.ctrl.controller.files.treeDocument.getRoots().forEach(n=>{n.options.data.id==t.oldFileId&&(n.options.updateData(t.updatedFile),e.ctrl.previewedDocumentStatusModel.updateFileInPreviewedDocumentFiles(t.oldFileId,t.updatedFile),e.ctrl.previewedDocumentStatusModel.get("previewedDocumentSelectedFile").id==t.oldFileId&&e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFileWithId(t.updatedFile.id),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())})}),e.docmFileEditedDocumentToken=t.subscribe("docm-file-edited-in-document",function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&e.ctrl.controller.files.treeDocument.getRoots().forEach(n=>{n.options.data.id==t.file.id&&(n.options.updateData(t.file),e.ctrl.previewedDocumentStatusModel.updateFileInPreviewedDocumentFiles(t.file.id,t.file),e.ctrl.previewedDocumentStatusModel.get("previewedDocumentSelectedFile").id==t.file.id&&e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFileWithId(t.file.id),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())})}),e.docmFileUndoeditedDocumentToken=t.subscribe("docm-file-undoedited-in-document",function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&e.ctrl.controller.files.treeDocument.getRoots().forEach(n=>{n.options.data.id==t.file.id&&(n.options.updateData(t.file),e.ctrl.previewedDocumentStatusModel.updateFileInPreviewedDocumentFiles(t.file.id,t.file),e.ctrl.previewedDocumentStatusModel.get("previewedDocumentSelectedFile").id==t.file.id&&e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFileWithId(t.file.id),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())})}),e.docmFileLockDocumentToken=t.subscribe("docm-file-locked-in-document",function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&e.ctrl.controller.files.treeDocument.getRoots().forEach(n=>{n.options.data.id==t.file.id&&(n.options.updateData(t.file),e.ctrl.previewedDocumentStatusModel.updateFileInPreviewedDocumentFiles(t.file.id,t.file),e.ctrl.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile().id==t.file.id&&e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFileWithId(t.file.id),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())})}),e.docmFileUnlockDocumentToken=t.subscribe("docm-file-unlocked-in-document",function(t){t.platformId==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.documentId&&e.ctrl.controller.files.treeDocument.getRoots().forEach(n=>{n.options.data.id==t.file.id&&(n.options.updateData(t.file),e.ctrl.previewedDocumentStatusModel.updateFileInPreviewedDocumentFiles(t.file.id,t.file),e.ctrl.previewedDocumentStatusModel.get("previewedDocumentSelectedFile").id==t.file.id&&e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFileWithId(t.file.id),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel())})}),e.docmFileLifeCycleChangeDocumentToken=t.subscribe("Lifecycle.Modification",function(t){((t="string"==typeof t?JSON.parse(t):t).Refresh.modified&&t.Refresh.modified[0]&&"RestoreIteration"==t.Refresh.modified[0].operation||t.Refresh.created&&t.Refresh.created[0]&&"RestoreIteration"==t.Refresh.created[0].operation)&&t.tenant==e.ctrl.options.platformServices.platformId&&e.ctrl.previewedDocumentStatusModel.getPreviewedDocument().id==t.Refresh.modified[0].physicalid&&e.ctrl.controller.data.getFiles(t.Refresh.modified[0].physicalid).then(t=>{var n=t.files,o=e.ctrl.previewedDocumentStatusModel.getPreviewedDocumentFiles();const i=new Set(o.map(e=>e.id)),l=new Set(n.map(e=>e.id)),s=[...l].filter(e=>!i.has(e)),r=[...i].filter(e=>!l.has(e));if(1===s.length&&1===r.length){const t=s[0],o=r[0],i=n.find(e=>e.id===t);e.ctrl.controller.files.treeDocument.getRoots().forEach(t=>{t.options.data.id==o&&(t.options.updateData(i),e.ctrl.previewedDocumentStatusModel.updateFileInPreviewedDocumentFiles(o,i))}),e.ctrl.previewedDocumentStatusModel.get("previewedDocumentSelectedFile").id==o&&e.ctrl.previewedDocumentStatusModel.changePreviewedDocumentSelectedFile(i),e.ctrl.topbarControl.toolbar.selectionChanged(),e.ctrl._syncSelectionInLeftPanel()}})})})},unHookGlobalFileEvents:function(){var e=this;require(["DS/PlatformAPI/PlatformAPI"],function(t){e.docmFileAddedToDocumentToken&&t.unsubscribe(e.docmFileAddedToDocumentToken),e.docmFilesDeletedFromDocumentToken&&t.unsubscribe(e.docmFilesDeletedFromDocumentToken),e.docmFilesUpdatedDocumentToken&&t.unsubscribe(e.docmFilesUpdatedDocumentToken),e.docmFileEditedDocumentToken&&t.unsubscribe(e.docmFileEditedDocumentToken),e.docmFileUndoeditedDocumentToken&&t.unsubscribe(e.docmFileUndoeditedDocumentToken),e.docmFileLockDocumentToken&&t.unsubscribe(e.docmFileLockDocumentToken),e.docmFileUnlockDocumentToken&&t.unsubscribe(e.docmFileUnlockDocumentToken),e.docmFileLifeCycleChangeDocumentToken&&t.unsubscribe(e.docmFileLifeCycleChangeDocumentToken)})}})}),define("DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationTopbarActions/CollapsePanel",["UWA/Core","i18n!DS/DocumentMultiFilePreview/assets/nls/DocumentPreview"],function(e,t){"use strict";var n=function(e){return{id:"closeButton",dataElements:{docV2Private:!0,typeRepresentation:"functionIcon",icon:{iconName:"close",fontIconFamily:1},label:t.get("Close"),tooltip:t.get("Close"),position:"far",category:"resize",value:function(t){t.options=e,n.execute(t)},visibleFlag:!0,priority:6},updateForSelection:function(e,t){},execute:function(){n.execute({options:e})}}};return n.execute=function(e){e.options.skeleton.setCollapseFlagFromUIInteraction("left",!0),e.options.events.publish({event:"left-navigationPanel-Expanded",data:!1})},n}),define("DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationTopbarActions/PanelExpander",["UWA/Core","i18n!DS/DocumentMultiFilePreview/assets/nls/DocumentPreview"],function(e,t){"use strict";var n=function(e){return{id:"PanelExpander",dataElements:{docV2Private:!0,typeRepresentation:"functionIcon",icon:{iconName:"resize-full",fontIconFamily:1},label:t.get("Expand"),tooltip:t.get("Expand"),position:"far",category:"resize",value:function(t){t.options=e,n.execute(t)},visibleFlag:!0,priority:5},updateForSelection:function(n,o){n({icon:{iconName:"left"==e.skeleton._maximizedSide?"resize-small":"resize-full",fontIconFamily:1},label:"left"==e.skeleton._maximizedSide?t.get("Restore_Down"):t.get("Expand"),tooltip:"left"==e.skeleton._maximizedSide?t.get("Restore_Down"):t.get("Expand")})},execute:function(){n.execute({options:e})}}};return n.execute=function(e){"left"==e.options.skeleton._maximizedSide?(e.options.skeleton.maximizeSide("left",!1),e.options.events.publish({event:"left-navigationPanel-Expanded",data:!1})):(e.options.skeleton.maximizeSide("left",!0),e.options.events.publish({event:"left-navigationPanel-Expanded",data:!0}))},n}),define("DS/DocumentMultiFilePreview/containers/TopNavBarContent/PreviewCommands",["UWA/Core","DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Information"],function(e,t){"use strict";return e.Class.extend({init:function(e){this.options=e,this.commands={Information:new t(e)}},commands:[],connectToWebUXToolbar:function(e){e.items.getRoots().forEach(e=>{e.options.docV2Preview&&e.options.extend&&e.options.extend(e),e.options.docV2Private&&e.options.extend&&e.options.extend(e)})},selectionChangedForWebUXToolbar:function(e){e.items.getRoots().forEach(e=>{e.options.docV2Preview&&(e.options.grid.action=e,e.options.updateForSelection&&e.options.updateForSelection(function(t){e.updateOptions(t)})),e.options.docV2Private&&(e.options.grid.action=e,e.options.updateForSelection&&e.options.updateForSelection(function(t){e.updateOptions(t)}))})},getWebUXContextMenuItemsForCurrentSelection:function(t,n){var o=this,i=[],l=t[0].dataElements.category;return t.forEach(t=>{t.updateForSelection&&t.updateForSelection(function(n){t.dataElements=e.extend(t.dataElements,n,!0)})}),t.forEach(e=>{e.dataElements.visibleFlag&&(n&&l!=e.dataElements.category&&i.push({type:"SeparatorItem"}),i.push({rawItem:e,type:"PushItem",title:e.dataElements.label,fonticon:{content:"wux-ui-3ds wux-ui-3ds-"+e.dataElements.icon.iconName},action:{callback:e.dataElements.value||function(e,t,n){console.error("This command doesnt have value")},context:{options:o.options}},recId:e.id,category:e.dataElements.category}),l=e.dataElements.category)}),i},getUIKitItemsForCurrentSelection:function(t,n){var o=[],i=t[0].dataElements.category;return t.forEach(t=>{t.updateForSelection&&t.updateForSelection(function(n){t.dataElements=e.extend(t.dataElements,n,!0)})}),t.forEach(e=>{e.dataElements.visibleFlag&&(n&&i!=e.dataElements.category&&o.push({className:"divider"}),o.push({rawItem:e,type:"PushItem",title:e.dataElements.label,name:e.id,text:e.dataElements.label,fonticon:e.dataElements.icon.iconName,handler:e.execute||function(e,t,n){console.error("This command doesnt have value")},category:e.dataElements.category}),i=e.dataElements.category)}),o}})}),define("DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationToolbarCommands",["UWA/Core","DS/DocumentFiles/actions/SearchTextBox","DS/DocumentFiles/actions/SearchToggle","DS/DocumentFiles/actions/SortSwitcher","DS/DocumentFiles/actions/ViewSwitcher","DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationTopbarActions/PanelExpander","DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationTopbarActions/CollapsePanel"],function(e,t,n,o,i,l,s){"use strict";return e.Class.extend({init:function(e){this.commands={SearchTextBox:new t(e),SearchToggle:new n(e),SortSwitcher:new o(e),ViewSwitcher:new i(e),PanelExpander:new l(e),CollapsePanel:new s(e)}},commands:[],connectToWebUXToolbar:function(e){e.items.prepareUpdate(),e.items.getRoots().forEach(e=>{e.options.docV2Private&&e.options.extend&&e.options.extend(e)}),e.items.pushUpdate()},selectionChangedForWebUXToolbar:function(t){t.items.getRoots().forEach(t=>{t.options.docV2Private&&(t.options.grid.action=t,t.options.grid.data&&(t.options.grid.data.argument&&(t.options.grid.data.argument.action=t),t.options.grid.data.value&&!e.is(t.options.grid.data.value,"string")&&(t.options.grid.data.value.action=t)),t.options.updateForSelection&&t.options.updateForSelection(function(e){t.updateOptions(e)}))})}})}),define("DS/DocumentMultiFilePreview/containers/TopNavBarContent/Toolbar",["UWA/Core","DS/Tweakers/GeneratedToolbar","DS/DocumentPreview/PreviewCommandsV2","DS/DocumentCommands/DocumentCommandsV2","DS/DocumentCommands/DocumentFileCommandsV2","DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Information","DS/DocumentMultiFilePreview/containers/TopNavBarContent/CustomPreviewActions/Download","DS/DocumentCommands/V2/Actions/Download"],function(e,t,n,o,i,l,s,r){"use strict";return e.Class.extend({init:function(a,c){let d,u;a.toolbar=this;let m={entries:[]},p={entries:[]},v={entries:[]},h={entries:[]};this.DocCmdOptions=a.toolbar.DocCmdOptions={fetchSecurityContext:function(){return a.options.fetchSecurityContext()},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return a.options.document?[a.options.nodeModel]:[]},getDocumentFromNodeModel:function(e){return a.options.document},getOrigin:function(){return{source:e.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"MultiFilePreviewtoolbar"}},skeleton:a.parentCtrl.mySkeletonlayout,platformUrls:a.options.platformUrls||this.ctrl.options.platformServices,events:a.options.events,previewedDocumentStatusModel:a.parentCtrl.previewedDocumentStatusModel,container:a.elements.container,ctrl:a.parentCtrl.controller.ctrl,uaSource:"Preview"},this.FileCmdOptions=a.toolbar.FileCmdOptions={fetchSecurityContext:function(){return a.options.fetchSecurityContext()},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){var e=a.parentCtrl.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile();if(e){var t=a.parentCtrl.controller.files.treeDocument.getRoots().find(t=>t.options.data.id===e.id);return t?[t]:[]}return[]},getDocumentFromNodeModel:function(e){return e.options.data},getParentDocument:function(){if(a.parentCtrl.previewedDocumentStatusModel.getPreviewedDocument())return a.parentCtrl.previewedDocumentStatusModel.getPreviewedDocument().id;a.options.document.id},getModifyAccess:function(){if(a.parentCtrl.previewedDocumentStatusModel.getPreviewedDocument())return a.parentCtrl.previewedDocumentStatusModel.getPreviewedDocument().dataelements.hasModifyAccess;a.options.document.dataelements.hasModifyAccess},getOrigin:function(){return{source:e.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"MultiFilePreviewtoolbar"}},skeleton:a.parentCtrl.mySkeletonlayout,previewedDocumentStatusModel:a.parentCtrl.previewedDocumentStatusModel,platformUrls:a.options.platformUrls||this.ctrl.options.platformServices,events:a.options.events,container:a.elements.container,ctrl:a.parentCtrl.controller.ctrl,uaSource:"Preview"},this.privateDocumentCommands=new n(this.DocCmdOptions),this.privateDocumentCommands.commands.CustomPreviewInformation=new l(this.DocCmdOptions);var f=this.privateDocumentCommands.commands;this.publicDocumentCommands=new o(this.DocCmdOptions);this.publicDocumentCommands.commands;this.fileCommands=new i(this.FileCmdOptions),this.fileCommands.commands.DocumentDownload=new r(this.DocCmdOptions),this.fileCommands.commands.CustomPreviewDownload=new s({...this.FileCmdOptions,DocCmdOptions:this.DocCmdOptions});var D=this.fileCommands.commands;h.entries=[D.OfficeWebEdition,D.Edit,D.LockAndDownload,D.Lock,D.UndoEdit,D.Unlock,D.Update,D.UpdateAndUnlock,D.CopyLink,D.DocumentDownload,D.CustomPreviewDownload],h.entries.forEach(function(e){e.dataElements.category="fileCommands"}),a.options.events.publish({event:"preview-toolbar-items-prepared",data:{documentCommandsModel:v}}),v.entries.push(f.CustomPreviewInformation),v.entries.forEach(function(e){e.dataElements.category="DocCommands",e.dataElements.docV2Public=!0}),p.entries=[...h.entries,...v.entries],m.entries=[f.Previous,f.Next,f.Close],d=this.DynamicToolbarTreeDocument=t.prototype.createTreeDocument(p);let w=this.DynamicToolbar=new t({items:d,direction:"horizontal",overflowManagement:"dropdown"});w.elements.container.setStyles({"max-width":"250px"}),this.privateDocumentCommands.connectToWebUXToolbar(w),w.inject(c),e.createElement("div",{class:"toolbarSeperator"}).inject(c),u=this.FixedToolbarTreeDocument=t.prototype.createTreeDocument(m);let g=this.FixedToolbar=new t({items:u});this.privateDocumentCommands.connectToWebUXToolbar(g),g.inject(c),this.selectionChanged()},selectionChanged:function(){this.fileCommands.selectionChangedForWebUXToolbar(this.DynamicToolbar),this.privateDocumentCommands.selectionChangedForWebUXToolbar(this.FixedToolbar)},enterOverflowMode:function(){this.DynamicToolbar.elements.container.addClassName("overFlowMode")},exitOverflowMode:function(){this.DynamicToolbar.elements.container.removeClassName("overFlowMode")}})}),define("DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationToolbar",["UWA/Core","DS/Tweakers/GeneratedToolbar","DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationToolbarCommands","DS/Utilities/Utils"],function(e,t,n,o){"use strict";return e.Class.extend({init:function(e){var t=this;t.ctrl=e,e.toolbar=this,t.selectionChanged=o.debounce(function(){t.navigationToolbarCommands.selectionChangedForWebUXToolbar(t.GeneratedToolbar)},10),t.ctrl.events.subscribe({event:"selection-add"},function(){t.selectionChanged()}),t.ctrl.events.subscribe({event:"selection-remove"},function(){t.selectionChanged()})},build:function(o){var i=this;let l,s={entries:[]};var r={fetchSecurityContext:function(){return i.ctrl.options.fetchSecurityContext()||widget.getValue("credentials")},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return i.ctrl.controller.files.treeDocument.getSelectedNodes()},getParentDocument:function(){return i.previewedDocumentStatusModel.getPreviewedDocument()||i.options.document},getModifyAccess:function(){return i.ctrl.options.previewedDocumentStatusModel.getPreviewedDocument()?i.ctrl.options.previewedDocumentStatusModel.getPreviewedDocument().dataelements.hasModifyAccess:i.ctrl.options.document.dataelements.hasModifyAccess},getDocumentFromNodeModel:function(e){return e.options.data},getOrigin:function(){return{source:e.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"toolbar"}},skeleton:i.ctrl.options.skeleton,platformUrls:i.ctrl.options.platformUrls||i.ctrl.options.platformServices,events:i.ctrl.options.events,ctrl:i.ctrl.controller.ctrl,uaSource:"Preview"};i.navigationToolbarCommands=new n(r);var a=i.navigationToolbarCommands.commands;s.entries=[a.SearchTextBox,a.SearchToggle,a.SortSwitcher,a.ViewSwitcher,a.PanelExpander,a.CollapsePanel],l=i.ToolbarTreeDocument=t.prototype.createTreeDocument(s);let c=i.GeneratedToolbar=new t({items:l,direction:"horizontal",overflowManagement:"dropdown",executionContext:{}});return i.navigationToolbarCommands.connectToWebUXToolbar(c),c.inject(o),i.selectionChanged(),c},selectionChanged:void 0})}),define("DS/DocumentMultiFilePreview/containers/TopNavBarContent/TopNavBarContainer",["UWA/Core","DS/CoreEvents/ModelEvents","DS/DocumentMultiFilePreview/containers/TopNavBarContent/Toolbar","DS/Controls/TooltipModel","css!DS/DocumentMultiFilePreview/css/TopNavBarContainer.css"],function(e,t,n,o,i){"use strict";return e.Controls.Abstract.extend({name:"docm-preview-topnavbar-container",options:{className:""},init:function(e){this.parentCtrl=e,this.events=e.options.events||new t,delete e.options.events,this._parent(e.options),e.topbarControl=this,this.options.events=this.events,e.options.events=this.events,this.build()},build:function(){this.elements.container=e.createElement("div",{class:this.getClassNames()}),this.imgDiv=e.createElement("div",{class:"topbar-image-container"}).inject(this.elements.container),this.img=e.createElement("div",{class:"topbar-image"}).inject(this.imgDiv),this.docTitle=e.createElement("div",{class:"topbar-title-container-documentTitle"}).inject(this.elements.container),new n(this,this.elements.container),this.syncTitleData(this.options.previewedDocumentStatusModel.getPreviewedDocument(),this.options.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile()),this.connectPreviewedStatusModel()},connectPreviewedStatusModel:function(){var e=this;this.options.previewedDocumentStatusModel.addEvent("onChange",function(t,n){e.syncTitleData(t.getPreviewedDocument(),t.getPreviewedDocumentSelectedFile()),e.toolbar&&e.toolbar.selectionChanged()})},updateDocumentName:function(e){var t="";t=""==this.docTitle.fileName?e:e+" | "+this.docTitle.fileName,this.docTitle.setText(t),this.docTitle.fullTitle=t,this.docTitle.docName=e,this.docTitle.tooltipInfos=new o({shortHelp:t,mouseRelativePosition:!0})},updateTitle:function(e,t){var n="";n=""==t?e:e+" | "+t,this.docTitle.setText(n),this.docTitle.fullTitle=n,this.docTitle.docName=e,this.docTitle.fileName=t,this.docTitle.tooltipInfos=new o({shortHelp:n,mouseRelativePosition:!0})},getTitleValues:function(){return titleObject={documentTitle:this.docTitle.title,fileTitle:this.fileTitle.title}},extractTitleFromDocument:function(e){return e?e.title||e.name||e.dataelements.title||e.dataelements.name:""},extractFileName:function(e){return e?e.dataelements.title||e.dataelements.name:""},syncTitleData:function(e,t){e=this.options.previewedDocumentStatusModel.getPreviewedDocument();var n=this.extractTitleFromDocument(e),o=this.extractFileName(this.options.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile());this.updateTitle(n,o),e&&(this.img.style.backgroundImage="url("+(e.typeicon||e.dataelements.indexedTypeicon||e.dataelements.typeicon)+")")},resize:function(e){e.newSkeletonDimensions.width<640?this.toolbar.enterOverflowMode():this.toolbar.exitOverflowMode()}})}),define("DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationTopbar",["UWA/Core","DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationToolbar"],function(e,t){"use strict";return e.Controls.Abstract.extend({name:"enox-preview-left-container",options:{className:""},_options:{},init:function(e){e.navigationTopbar=this,this.ctrl=e,this.events=e.events,this._parent({})},build:function(n){this.elements.container=e.createElement("div",{class:this.getClassNames("-topbar")}),this.elements.toolbar=new t(this.ctrl),this.elements.toolbar.build(this.elements.container),this.elements.container.inject(n)},updateToolbar:function(){this.elements.toolbar.selectionChanged()}})}),define("DS/DocumentMultiFilePreview/containers/centerContent/CenterPreviewContainer",["UWA/Core","DS/CoreEvents/ModelEvents","DS/DocumentMultiFilePreview/containers/centerContent/PreviewProvider","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],function(e,t,n,o,i){"use strict";return e.Controls.Abstract.extend({name:"docm-preview-center-container",options:{className:""},_options:{},modelEvents:void 0,init:function(e){this.parentCtrl=e,e.centerContainerContentControl=this,this.events=e.events||e.options.events||new t,delete e.options.events,this._parent(e.options),e.options.events=this.events,this.notificationManager=o,i.setNotificationManager(this.notificationManager),i.setStackingPolicy(5),this.buildSkeleton()},buildSkeleton:function(){this.elements.container=e.createElement("div",{class:this.getClassNames()}),this.elements.preview=e.createElement("div",{class:this.getClassNames("-preview")}),this.elements.preview.inject(this.elements.container),this.options.skeleton.centerContainerContent.setHTML(this.elements.container),this.previewProvider=new n(this,this.elements.preview)}})}),define("DS/DocumentMultiFilePreview/containers/leftSideContent/LeftNavigationContainer",["UWA/Core","UWA/Promise","DS/CoreEvents/ModelEvents","DS/DocumentFiles/data/Controller","DS/DocumentFiles/views/Topbar","DS/DocumentMultiFilePreview/containers/leftSideContent/NavigationTopbar","DS/DocumentFiles/views/UploadPane","DS/DocumentFiles/views/GridPane","DS/DocumentFiles/views/TilePane","DS/DocumentFiles/ContextMenu","DS/DocumentMultiFilePreview/eventHandlers/FilesEvents","DS/DocumentFiles/utils/DnDManager","DS/Controls/Loader","DS/Controls/ModalContainer","css!DS/DocumentMultiFilePreview/css/LeftNavigationContainer.css"],function(e,t,n,o,i,l,s,r,a,c,d,u,m,p,v){"use strict";return e.Controls.Abstract.extend({name:"docm-preview-left-container",options:{className:""},_options:{},modelEvents:void 0,init:function(e){e.leftContainerContentControl=this,this.parentCtrl=e,this.inputFiles=e.options.files,this.events=e.events||e.options.events||new n,delete e.options.events,this._parent(e.options),e.options.events=this.events,this.options.events=this.events,this.controller=this.options.controller=e.controller,this.events._pubsub._spyEvents=function(e,t){console.log("ENOXPreviewLeftPanelFiles:",e,t,this)},this.buildSkeleton()},buildSkeleton:function(){var t=this;this.elements.container=e.createElement("div",{class:this.getClassNames()}),this.elements.content=e.createElement("div",{class:this.getClassNames("-content")}),this.elements.content.inject(this.elements.container),this.loader=new m,this.startLoading(),this.options.customization=this.makefilePaneOptions().customization,this.e6wDocument=this.options.document,this.controller.ready.promise.then(function(){new l(t).build(t.elements.content),t.buildContentPanes(),t.controller.ctrl.tilePane=t.tilePane,t.controller.ctrl.gridPane=t.gridPane,t.controller.ctrl.uploadPane=t.uploadPane,t.controller.ctrl.dndManager=t.dndManager,t.controller.ctrl.tilesRCV=t.tilesRCV,t.tilePane.rcv.rowSelection="single",t.tilePane.rcv.selectionBehavior.canMultiSelect=!1,t.tilePane.rcv.selectionBehavior.canInteractiveMultiselectWithCheckboxClick=!1,t.tilePane.rcv.selectionBehavior.enableShiftSelection=!1,t.gridPane.datagridview.rowSelection="single",t.contextMenu=new c(t),new d(t).connect(t.controller,t.toolbar,t.contextMenu),t.connectPreviewedDocumentModel(),t.options.skeleton.leftContainerContent=t.elements.container,t.parentCtrl._syncSelectionInLeftPanel()})},buildContentPanes:function(){this.elements.panes=e.createElement("div",{class:this.getClassNames("-panes")}),this.elements.panes.inject(this.elements.content),new s(this).build(this.elements.panes),new r(this).build(this.elements.panes),new a(this).build(this.elements.panes),new u(this)},connectPreviewedDocumentModel:function(){var e=this;e.setDefaultParentIdAndFiles(this.options.previewedDocumentStatusModel.get("previewedDocument")),this.options.previewedDocumentStatusModel.addEvent("onChange:previewedDocument",function(t,n){console.log(t),console.log(n),e.setDefaultParentIdAndFiles(n),e.parentCtrl._syncSelectionInLeftPanel()})},initialize:function(){var e=[];if(this.inputFiles)for(let t=0;t<this.inputFiles.length;t++)e.push(this.inputFiles[t]);this.controller.showPreselectedFiles(e)},setDefaultParentIdAndFiles:function(e){this.parentId=e.id,this.controller.switchView(this.controller.view),this.finishLoading()},setParentId:function(e){this.parentId=e,this.finishLoading(),this.startLoading(),this.controller.clearAll(),this.controller.loadFiles(),this.events.publish({event:"enox-files-parent-changed"})},getParentId:function(){return this.parentId},startLoading:function(){this.loader.on(),p.createModal(this.elements.container,this.loader.elements.container)},finishLoading:function(){this.loader.off(),p.removeModal(this.elements.container)},makefilePaneOptions:function(e){return{customization:{selectionChangedForWebUXToolbar:function(e,t){console.log("selectionChangedForWebUXToolbar",e,t)},postToolbarItemsPreparation:function(e,t,n){console.warn("variables printed below would have been modified by the time you expand them. Better to put a breakpoint and print and then expand immediately"),console.log("postToolbarItemsPreparation",e,t,n),console.log(e);for(var o=["Preview","SearchTextBox","SearchToggle","FileIterations","UploadFile","Delete","SortSwitcher","ViewSwitcher"],i=e.length-1;i>=0;i--)o.includes(e[i].id)&&e.splice(i,1);console.log(e)},connectToWebUXToolbar:function(e,t,n){console.log("connectToWebUXToolbar",e,t,n)},postContextMenuItemsPreparation:function(e,t,n){console.warn("variables printed below would have been modified by the time you expand them. Better to put a breakpoint and print and then expand immediately"),console.log("postContextMenuItemsPreparation",e,t,n);for(var o=["Preview","SearchTextBox","SearchToggle","FileIterations","UploadFile","Delete","SortSwitcher","ViewSwitcher"],i=e.length-1;i>=0;i--)o.includes(e[i].id)&&e.splice(i,1);console.log(e)},preDataGridColumnBinding:function(e,t){console.log("preDataGridColumnBinding",e,t)}}}}})}),define("DS/DocumentMultiFilePreview/MultiFilePreviewComponent",["UWA/Core","DS/CoreEvents/ModelEvents","DS/Skeleton/SkeletonLayout","DS/Skeleton/SkeletonUtils","DS/DocumentMultiFilePreview/containers/leftSideContent/LeftNavigationContainer","DS/DocumentMultiFilePreview/containers/centerContent/CenterPreviewContainer","DS/DocumentMultiFilePreview/containers/rightSideContent/RightInformationPanelContainer","DS/DocumentMultiFilePreview/containers/TopNavBarContent/TopNavBarContainer","DS/DocumentFiles/data/Controller","DS/DocumentMultiFilePreview/models/PreviewedDocumentStatusModel","DS/DocumentMultiFilePreview/eventHandlers/PreviewedDocumentModelEvents","DS/DocumentMultiFilePreview/MultiFilePreviewEvents","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","css!DS/DocumentMultiFilePreview/css/MultiFilePreviewComponent.css"],function(e,t,n,o,i,l,s,r,a,c,d,u,m,p,v){"use strict";return e.Controls.Abstract.extend({name:"multifile-preview",options:{className:""},init:function(e){var n=this;this._parent(e),this.events=e.modelEvents||new t,this.options.events=e.modelEvents||new t,this.options.context={securityContext:n.options.securityContext?n.options.securityContext:void 0,getSecurityContext:function(){return this.securityContext}},this.options.fetchSecurityContext=function(){if(n.options.context&&n.options.context.getSecurityContext())return n.options.context.getSecurityContext()},this.options.platformUrls.platformId||(this.options.platformUrls.platformId=this.options.tenant),this.notificationManager=m,p.setNotificationManager(this.notificationManager),p.setStackingPolicy(5),this.mySkeletonlayout=void 0,this.leftPanelLoaded=!0,this.buildSkeleton()},buildSkeleton:function(){var t=this;t.elements.container=e.createElement("div",{class:this.getClassNames()}),t.elements.content=e.createElement("div",{class:this.getClassNames("-content")}).inject(this.elements.container),this.previewedDocumentStatusModel=this.options.previewedDocumentStatusModel=new c,this.previewedDocumentModelEvents=this.options.previewedDocumentModelEvents=new d(this),this.multifilePreviewEvents=this.options.multifilePreviewEvents=new u(this),new a(t),this.controller.ready.promise.then(function(){if(t.navBar=new r(t),t.navBar.inject(t.elements.content),t.mySkeletonlayout=new n({leftContainerContent:new e.Element("div",{html:"Loading...",id:"Enox-Preview-LeftContent",class:"Enox-Preview-LeftContent",title:"Left Side Title"}),centerContainerContent:new e.Element("div",{html:"Center Space",id:"Enox-Preview-CenterContent",class:"Enox-Preview-CenterContent"}),statusContainerContent:null,idCardContainerContent:null,leftContainerCollapsedFlag:!0,rightContainerCollapsedFlag:!0,leftContainerWidth:320,leftContainerMinWidth:320,leftContainerMaxWidth:480,rightContainerWidth:320,rightContainerMinWidth:320,rightContainerMaxWidth:480,navigationContainerVisibleFlag:!1,idCardContainerVisibleFlag:!1,statusContainerVisibleFlag:!1,identifier:"EnoxDocumentPreviewSkeletonLayout"}),t.mySkeletonlayout.rightContainerCollapsedFlag=!0,t.mySkeletonlayout.rightContainerContent=o.createSideContentWithTitleBar({skeleton:t.mySkeletonlayout,title:"Loading",close:!0,maximize:!0,content:new e.Element("div",{html:".",id:"Enox-Preview-RightContent",class:"Enox-Preview-RightContent"}),commands:[]}),t.leftContainerTemplate=new e.Element("div",{html:"Loading...",id:"LeftContent",class:"Enox-Preview-LeftContent",title:"Left Side Title"}),t.mySkeletonlayout.leftContainerContent=t.leftContainerTemplate,t.skeleton=t.options.skeleton=t.mySkeletonlayout,t.updateDocument(t.options.document,t.options.selectedFileId),t.options.document.relateddata.files&&t.options.document.relateddata.files.length<2)t.destroyLeftNavigationPanel();else{t.mySkeletonlayout.leftContainerCollapsedFlag=!1,t.mySkeletonlayout.leftContainerMinWidth=320,t.mySkeletonlayout.leftContainerWidth=320;new i(t);t.leftPanelLoaded=!0}new l(t),new s(t);t.mySkeletonlayout.inject(t.elements.content),t.events.publish({event:"onPreviewLoaded"}),t.elements.container.addEvent("resize",t.resize.bind(t)),t.mySkeletonlayout.addEventListener("leftContainerCollapse",function(e){t._syncSelectionInLeftPanel()}),t.mySkeletonlayout.addEventListener("rightContainerCollapse",function(e){t.events.publish({event:"close-document-properties"})}),t.mySkeletonlayout.addEventListener("skeletonResized",function(e){t.topbarControl&&t.topbarControl.resize(e.options)})})},getSkeletonBuild:function(){return this.mySkeletonlayout},updateDocument:function(t,n){if(n||this.selectedNodeCache&&this.selectedNodeCache.options&&(n=this.selectedNodeCache.options.data.id),this.selectedNodeCacheModifiedToken=void 0,this.selectedNodeCache=void 0,t=e.clone(t,"true"),this.updateChildOptions(),t){if(t.relateddata.files){this.leftContainerContentControl&&this.leftContainerContentControl.startLoading();var o=t.relateddata.files;this.controller.clearAll(),this.controller.files.addFiles(o,"left panel"),this.leftContainerContentControl&&this.leftContainerContentControl.finishLoading(),this.previewedDocumentStatusModel.changePreviewedDocumentFilesArray(t.relateddata.files)}if(t.relateddata.files&&t.relateddata.files.length>0){var i=t.relateddata.files;if(n){var l;(l=i.filter(e=>e.id==n)).length>0?this.previewedDocumentStatusModel.changePreviewedDocumentSelectedFile(l[0]):this.previewedDocumentStatusModel.changePreviewedDocumentSelectedFile(i[0])}else this.previewedDocumentStatusModel.changePreviewedDocumentSelectedFile(i[0])}else this.previewedDocumentStatusModel.changePreviewedDocumentSelectedFile(void 0);this.previewedDocumentStatusModel.changePreviewedDocument(t)}},updateChildOptions:function(){this.centerContainerContentControl&&this.centerContainerContentControl.setOptions({document:this.options.document,platformUrls:this.options.platformUrls,modelEvents:this.options.events,tenant:this.options.platformUrls.platformId,securityContext:this.options.fetchSecurityContext(),nodeModel:this.options.nodeModel,enableFavoriteToggle:this.options.enableFavoriteToggle,readOnly:this.options.readOnly}),this.leftContainerContentControl&&this.leftContainerContentControl.setOptions({document:this.options.document,platformUrls:this.options.platformUrls,modelEvents:this.options.events,tenant:this.options.platformUrls.platformId,securityContext:this.options.fetchSecurityContext(),nodeModel:this.options.nodeModel,enableFavoriteToggle:this.options.enableFavoriteToggle,readOnly:this.options.readOnly}),this.navBar&&this.navBar.setOptions({document:this.options.document,platformUrls:this.options.platformUrls,modelEvents:this.options.events,tenant:this.options.platformUrls.platformId,securityContext:this.options.fetchSecurityContext(),nodeModel:this.options.nodeModel,enableFavoriteToggle:this.options.enableFavoriteToggle,readOnly:this.options.readOnly}),this.rightContainerContentControl&&this.rightContainerContentControl.setOptions({document:this.options.document,platformUrls:this.options.platformUrls,modelEvents:this.options.events,tenant:this.options.platformUrls.platformId,securityContext:this.options.fetchSecurityContext(),nodeModel:this.options.nodeModel,enableFavoriteToggle:this.options.enableFavoriteToggle,readOnly:this.options.readOnly})},destroyLeftNavigationPanel:function(){this.leftPanelLoaded=!1,this.mySkeletonlayout.leftContainerCollapsedFlag=!0,this.mySkeletonlayout.leftContainerContent=null,this.mySkeletonlayout.leftContainerMinWidth=0,this.mySkeletonlayout.leftContainerWidth=0},reCreateLeftNavigationPanel:function(){this.mySkeletonlayout.leftContainerContent=this.leftContainerTemplate,this.mySkeletonlayout.leftContainerCollapsedFlag=!1,this.mySkeletonlayout.leftContainerMinWidth=320,this.mySkeletonlayout.leftContainerWidth=320;new i(this);this.leftPanelLoaded=!0},prepareLeftNavigationPanelViewCommandsOptions:function(){var t=this;return{fetchSecurityContext:function(){return t.options.fetchSecurityContext()||widget.getValue("credentials")},getWorkUnderHeaders:function(){return{}},getSelectedNodes:function(){return t.controller.files.treeDocument.getSelectedNodes()},getParentDocument:function(){return t.previewedDocumentStatusModel.getPreviewedDocument()||t.options.document},getModifyAccess:function(){return t.previewedDocumentStatusModel.getPreviewedDocument()?t.previewedDocumentStatusModel.getPreviewedDocument().dataelements.hasModifyAccess:t.options.document.dataelements.hasModifyAccess},getDocumentFromNodeModel:function(e){return e.options.data},getOrigin:function(){return{source:e.is(widget.data.appId)?widget.data.appId:widget.environment.data._data._x_appId,widgetId:widget.id,component:"toolbar"}},platformUrls:t.options.platformUrls||t.options.platformServices,events:t.options.events,ctrl:t.controller.ctrl,uaSource:"Preview"}},_syncSelectionInLeftPanel:function(){this.selectedNodeCacheModifiedToken==this.previewedDocumentStatusModel.getSelectedFileModifiedToken()?this.selectedNodeCache&&(this.controller.files.treeDocument.getXSO().empty(),this.controller.files.treeDocument.getXSO().add(this.selectedNodeCache)):0==this.controller.files.treeDocument.getXSO().get().length&&this.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile()&&(this.selectedNodeCache=this.controller.files.treeDocument.getRoots().find(e=>e.options.data.id===this.previewedDocumentStatusModel.getPreviewedDocumentSelectedFile().id),this.selectedNodeCache&&(this.controller.files.treeDocument.getXSO().add(this.selectedNodeCache),this.selectedNodeCacheModifiedToken=this.previewedDocumentStatusModel.getSelectedFileModifiedToken()))},_updateSelectedNodeCache:function(e){this.selectedNodeCache=e,this.selectedNodeCacheModifiedToken=this.previewedDocumentStatusModel.getSelectedFileModifiedToken()},resize:function(e){}})});