define("DS/WebExtensionServers/WebExtensionServer",["UWA/Class"],function(e){"use strict";return e.extend({init:function(){this._extensionTable={},this._interfaceTable={},this._componentTable={}},_require:async function(e){return new Promise((t,n)=>{require([e],e=>{t(e)},e=>{n(e)})})},DeclareDictionary:async function(e){var t=null,n=()=>{for(var e=(e,t)=>Promise.race([e,Promise.resolve({myTestFunction:!0})]).then(e=>{e&&e.myTestFunction&&console.warn(Object.keys(this.requireToLoad)[t]+" still pending")}).catch(e=>{console.error(new Error("Can't load "+Object.keys(this.requireToLoad)[t]))}),i=0;i<this.requirePromises.length;i++)e(this.requirePromises[i],i);t=setTimeout(n,1e3)},i=[];Object.keys(e.interfaces).forEach(t=>{i.push(this._require(e.interfaces[t]).then(e=>(this.AddInterface(t,e),t)))}),this.requireToLoad=e.interfaces,this.requirePromises=i,t=setTimeout(n,1e3),(await UWA.Promise.allSettled(i)).forEach(e=>{"fullfilled"!==e.state&&console.warn(new Error("Unable to load "+e.reason))}),t&&(clearTimeout(t),t=null);var o=[];Object.keys(e.components).forEach(t=>{o.push(this._require(e.components[t]).then(e=>(this.AddComponent(t,e),t)))}),this.requireToLoad=e.components,this.requirePromises=o,t=setTimeout(n,1e3),(await UWA.Promise.allSettled(o)).forEach(e=>{"fullfilled"!==e.state&&console.warn(new Error("Unable to load "+e.reason))}),t&&(clearTimeout(t),t=null);var r=[];return Object.keys(e.extensions).forEach(t=>{Object.keys(e.extensions[t]).forEach(n=>{r.push(this._require(e.extensions[t][n]).then(e=>(e.GetOrigin=(()=>e),this.AddExtension(t,n,e),t+":"+n)))})}),this.requireToLoad=e.extensions,this.requirePromises=r,t=setTimeout(n,1e3),(await UWA.Promise.allSettled(r)).forEach(e=>{"fullfilled"!==e.state&&console.warn(new Error("Unable to load "+e.reason))}),t&&(clearTimeout(t),t=null),this},AddExtension:function(e,t,n){var i=this._extensionTable[e];i?void 0===i[t]?(i[t]=n,this._extensionTable[e]=i):console.warn("trying to override existing extension"):((i={})[t]=n,this._extensionTable[e]=i)},AddInterface:function(e,t){void 0===this._interfaceTable[e]&&(this._interfaceTable[e]=t)},AddComponent:function(e,t){void 0===this._componentTable[e]&&(this._componentTable[e]=t)},GetExtension:function(e,t){var n=this._extensionTable[e];if(n)return n[t]},GetInterface:function(e){return this._interfaceTable[e]},GetComponent:function(e){return this._componentTable[e]}})});