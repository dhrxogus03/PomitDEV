define("DS/IssueCommon/commands/CreateIssuePLMNew",["DS/ENONewWidget/command/NewContentCommandBase","DS/PlatformAPI/PlatformAPI","DS/PADUtils/views/PADAlert","DS/IssueServices/Contexts","i18n!DS/IssueComponents/assets/nls/IssueComponents"],function(e,t,n,s,i){"use strict";var a="IssueCommon";return e.extend({defaults:{type:"Issue"},init:function(e){this.app=e.app,this._parent(e)},getType(){return this.defaults.type},execute:function(){this.launchCreationDialog()},launchCreationDialog(){var e=this.getCreateOptions({});this.launchCreateNew(e)},getOptions:e=>({options:{typeName:"Issue"},events:{onSuccess:function(e){let o=e.result[0].identifier;var r=s.get("widget")||window.widget,d=[],l={};d.push([o]),l[o]={};var c=Math.floor(Date.now()),u={metadata:{appId:r.id,appName:a,timestamp:c,options:{}},data:{paths:d,attributes:l},version:"1.0"};t.publish("DS/Object/create",u);const m=i.replace(i.create.creationSuccess,{title:""});n.displayNotification({msg:m.replace("''",""),eventID:"success"})},onFailure:function(e){n.displayNotification({msg:i.create.creationFailed,eventID:"error"})},onCancel:function(e){}}}),_publishEvent:function(e,n){var i=s.get("widget")||window.widget,o=[],r={};o.push([e]),r[e]={};var d=Math.floor(Date.now()),l={metadata:{appId:i.id,appName:a,timestamp:d,options:{}},data:{paths:o,attributes:r},version:"1.0"};t.publish(n,l)}})}),define("DS/IssueCommon/commands/Open",["UWA/Class","DS/ApplicationFrame/Command"],function(e,t){"use strict";return e.extend(t,{execute:function(){require(["DS/IssueComponents/open/Open"],function(e){e.openWith()})}})}),define("DS/IssueCommon/utils/Selector",["UWA/Core","DS/IssueServices/Contexts"],function(e,t){"use strict";var n="Issue",s="ENXISSU_AP",i="ENX3DIR_AP",a=function(s){for(var i={physicalIds:[],issueNames:[],map:{}},a=s&&e.is(s.type,"string")?s.type:"all",o=t.get("component").getSelectedNodes(),r=0;r<o.length;r++){var d=o[r];"issue"!==a&&"all"!==a||d.options.type!==n&&d.options.baseType!==n||(i.physicalIds.push(d.options.physicalId),i.issueNames.push(d.options.name),i.map[d.options.physicalId]={id:d.options.physicalId,physicalId:d.options.physicalId,type:d.options.type,name:d.options.name,title:d.options.title,serviceId:"3DSpace",description:d.options.description,owner:d.options.owner,coOwners:d.options.coOwners,assignees:d.options.assignees,contributors:d.options.contributors,contexts:d.options.contexts,reportedAgainst:d.options.reportedAgainst,resolvedBy:d.options.resolvedBy,resolvedItems:d.options.resolvedItems}),"object"!==a&&"all"!==a||d.options.baseType===n||(i.physicalIds.push(d.options.physicalId),i.issueNames.push(d.options.name),i.map[d.options.physicalId]={id:d.options.physicalId,pid:d.options.pid,serviceId:d.options.serviceId,physicalId:d.options.physicalId,type:d.options.type,name:d.options.name,title:d.options.title})}return i},o=function(s){var i={physicalIds:[],issueNames:[],map:{}},a=s&&e.is(s.type,"string")?s.type:"all",o=t.get("component").getManager();if(null===o)return i;for(var r=t.get("component").getSelectedIssues(),d=o.getIssues().map,l=0;l<r.length;l++){var c=d[r[l].id].model;"issue"!==a&&"all"!==a||c.get("type")!==n&&c.get("baseType")!==n||(i.physicalIds.push(c.get("physicalId")),i.issueNames.push(c.get("name")),i.map[c.get("physicalId")]={id:c.get("physicalId"),physicalId:c.get("physicalId"),type:c.get("type"),name:c.get("name"),title:c.get("title"),serviceId:"3DSpace",description:c.get("description"),owner:c.get("owner"),coOwners:c.get("coOwners"),assignees:c.get("assignees"),contributors:c.get("contributors"),contexts:c.get("contexts"),reportedAgainst:c.get("reportedAgainst"),resolvedBy:c.get("resolvedBy"),resolvedItems:c.get("resolvedItems")}),"object"!==a&&"all"!==a||c.type===n&&c.get("baseType")===n||(i.physicalIds.push(c.id),i.issueNames.push(c.name),i.map[c.id]={id:c.id,physicalId:c.id,type:c.type,name:c.name,title:c.title,serviceId:"3DSpace"})}return i},r=function(e){for(var n={physicalIds:[],issueNames:[],map:{}},s=(t.get("templateComponentDialog")?t.get("templateComponentDialog"):t.get("templateComponent")).document.getSelectedTemplateNodes(),i=0;i<s.length;i++){var a=s[i];n.physicalIds.push(a.options.physicalId),n.issueNames.push(a.options.name),n.map[a.options.physicalId]={id:a.options.physicalId,physicalId:a.options.physicalId,type:a.options.type,name:a.options.name,title:a.options.title,serviceId:"3DSpace",description:a.options.description,owner:a.options.owner,coOwners:a.options.coOwners,assignees:a.options.assignees,contributors:a.options.contributors,contexts:a.options.contexts,reportedAgainst:a.options.reportedAgainst,resolvedBy:a.options.resolvedBy,resolvedItems:a.options.resolvedItems}}return n};return{getSelection:function(e){var n=t.get("widget")||window.widget;return n.name===s?n.getValue("IsIssueSummaryView")?a(e):r(e):n.name===i?t.get("templateComponentDialog")?r(e):o(e):{physicalIds:[],issueNames:[],map:{}}}}}),define("DS/IssueCommon/commands/Delete",["UWA/Class","DS/ApplicationFrame/Command"],function(e,t){"use strict";return e.extend(t,{init:function(e){this._parent(e)},execute:function(){require(["DS/IssueComponents/delete/Delete","DS/IssueCommon/utils/Selector","DS/IssueServices/Contexts"],function(e,t,n){var s=n.get("widget")||window.widget,i=t.getSelection({type:"issue"});s.body.getElement(".delete-issues-dialog")||new e({physicalIds:i.physicalIds}).render()})}})}),define("DS/IssueCommon/utils/TaskManager",["UWA/Core","UWA/Class","UWA/Class/Events","DS/PlatformAPI/PlatformAPI","DS/IssueServices/Contexts","css!DS/IssueCommon/IssueCommon.css"],function(e,t,n,s,i){"use strict";var a={ISU_TASK_MANAGER:"ISU_TASK_MANAGER"},o={FILTER:"FILTER",SELECT_IN_3D:"SELECT_IN_3D",PREFERENCES:"PREFERENCES",ADD_OBJECTS:"ADD_OBJECTS",TAKE_SCREENSHOT:"TAKE_SCREENSHOT",GET_FILTERED_ISSUES:"GET_FILTERED_ISSUES"},r={NEW:"NEW",PROCESSING:"PROCESSING"},d=0;return t.singleton(n,{_counter:0,_taskList:[],_subscriber:[],_metadataOpts:{},init:function(){this._counter=0,this._taskList=[],this._subscriber=[],this._metadataOpts={},this._metadataOpts[a.ISU_TASK_MANAGER]=a.ISU_TASK_MANAGER,this._subscriber.push(s.subscribe("DS/IssueManagementTask/ready",this._ready.bind(this))),this._subscriber.push(s.subscribe("DS/IssueManagementTask/done",this._end.bind(this)))},destroy:function(){},add:function(t,n,a,d){if(!e.is(t,"string"))throw new Error('Invalid arguments[0] "type". Expected a String');if(-1===Object.keys(o).indexOf(t))throw new Error('Task type "'+t+'" is not supported');if(!e.is(n,"array"))throw new Error('Invalid arguments[1] "args". Expected an Array');if(!e.is(a,"function"))throw new Error('Invalid arguments[2] "callback". Expected a Function');if(e.is(d)&&!e.is(d,"function"))throw new Error('Invalid arguments[3] "cancelCallback". Expected a Function');var l=i.get("widget")||window.widget;this._counter+=1;var c={taskType:t,taskId:"id-"+this._counter,state:r.NEW,widgetIdIM:l.id,widgetId3D:"",args:n,callback:a,cancelCallback:d||null};this._taskList.push(c);var u=[],m={};return u.push([c.taskId]),m[c.taskId]={taskType:c.taskType,widgetIdIM:c.widgetIdIM},s.publish("DS/IssueManagementTask/add",{metadata:{appId:l.id,appName:l.name,timestamp:Math.floor(Date.now()),options:e.clone(this._metadataOpts)},data:{paths:u,attributes:m},version:"1.0"}),c},cancelAll:function(){for(var e=this._taskList.slice(),t=0;t<e.length;t++)this.cancel(e[t].taskId)},getTaskList:function(){return this._taskList},_searchTask:function(e){for(var t=0;t<this._taskList.length;t++)if(this._taskList[t].taskId===e)return this._taskList[t];return null},_removeTask:function(e){for(var t=0;t<this._taskList.length;t++)if(this._taskList[t].taskId===e){this._taskList.splice(t,1);break}},_end:function(t){var n,s,a=i.get("widget")||window.widget;if(t.data.paths.length>0){var o=t.data.paths[d][d],r=t.data.attributes[o],l=this._searchTask(o);n=a.body.getDimensions().height,s=window.getComputedStyle(a.body),0!==n&&"none"!==s.display&&l&&l.widgetIdIM===r.widgetIdIM&&l.widgetId3D===r.widgetId3D&&(this._removeTask(l.taskId),t.metadata.options.canceled?e.is(l.cancelCallback,"function")&&l.cancelCallback():l.callback(r.response))}},cancel:function(t){var n=this._searchTask(t);n&&(""!==n.widgetId3D?this.publish(n,"cancel"):(this._removeTask(n.taskId),e.is(n.cancelCallback,"function")&&n.cancelCallback()))},publish:function(t,n){var a=i.get("widget")||window.widget,o=[],r={};o.push([t.taskId]),r[t.taskId]={taskId:t.taskId,taskType:t.taskType,widgetIdIM:t.widgetIdIM,widgetId3D:t.widgetId3D},s.publish("DS/IssueManagementTask/"+n,{metadata:{appId:a.id,appName:a.name,timestamp:Math.floor(Date.now()),options:e.clone(this._metadataOpts)},data:{paths:o,attributes:r},version:"1.0"})},addSelectIn3DTask:function(e,t,n){return this.add(o.SELECT_IN_3D,[n],e,t)},addFilterTask:function(t,n){if(!e.is(t,"array"))throw new Error('Invalid arguments[0] "ids". Expected an Array');if(!e.is(n,"function"))throw new Error('Invalid arguments[1] "callback". Expected a Function');var s=[t];return this.add(o.FILTER,s,n,null)},addPreferencesTask:function(t){if(!e.is(t,"function"))throw new Error('Invalid arguments[1] "callback". Expected a Function');return this.add(o.PREFERENCES,[],t,null)},addGetFilteredIssuesTask:function(t){if(!e.is(t,"function"))throw new Error('Invalid arguments[1] "callback". Expected a Function');return this.add(o.GET_FILTERED_ISSUES,[],t,null)},addObjectsTask:function(e,t){return this.add(o.ADD_OBJECTS,[],e,t)},addTakeScreenshotTask:function(e,t){return this.add(o.TAKE_SCREENSHOT,[],e,t)},_isMasked:function(e){return e.hasClassName("masked")},_ready:function(t){var n=i.get("widget")||window.widget;if(t.data.paths.length>0){var a=t.data.paths[d][d],o=t.data.attributes[a],l=this._searchTask(a);if(l&&l.widgetIdIM===o.widgetIdIM&&l.state===r.NEW){l.state=r.PROCESSING,l.widgetId3D=o.widgetId3D;var c=[],u={};c.push([l.taskId]),u[l.taskId]={taskId:l.taskId,taskType:l.taskType,widgetIdIM:l.widgetIdIM,widgetId3D:l.widgetId3D,args:l.args},s.publish("DS/IssueManagementTask/exec",{metadata:{appId:n.id,appName:n.name,timestamp:Math.floor(Date.now()),options:e.clone(this._metadataOpts)},data:{paths:c,attributes:u},version:"1.0"})}}}})}),define("DS/IssueCommon/utils/DocumentUtils",["UWA/Promise","DS/IssueServices/services/PlatformServices","DS/PADUtils/views/PADAlert","DS/DocumentManagement/DocumentManagement"],function(e,t,n,s){"use strict";return{init:function(){},preview:function(e){this._loadCommands(e,"Preview")},edit:function(e){this._loadCommands(e,"Edit")},undoEdit:function(e){this._loadCommands(e,"UndoEdit")},update:function(e){this._loadCommands(e,"Update")},download:function(e){this._loadCommands(e,"Download")},getDocumentsData:function(n){return new e(function(e,i){s.getDocuments(n,{tenant:t.getTenant(),securityContext:"ctx::"+decodeURIComponent(t.getSecurityContext()),tenantUrl:t.get3DSpaceUrl(),additionalURLParams:"$fields=indexedTypeicon",onComplete:function(t){t.success&&Array.isArray(t.data)?e(t):i()},onFailure:function(e){i()}})})},_loadCommands:function(e,n){var s=this;require(["DS/DocumentCommands/ENOXDocumentCommands","DS/DocumentCommands/DocumentCommandsV2","DS/CoreEvents/ModelEvents","DS/IssueCommon/utils/Utils"],function(i,a,o,r){var d=decodeURIComponent(t.getSecurityContext()),l=t.getTenant(),c=t.get3DSpaceUrl(),u=t.get3DDashboardUrl(),m=(t.get3DSwymUrl(),t.getPlatformUrl()),p={};if("Download"===n||"Preview"===n){var g=e.selected.map(function(e){return e.id});s.getDocumentsData(g).then(function(e){var i=e.data,d=new o;d.subscribe({event:"docv2-show-notification"},function(e){r.displayErrorMessage(e,e.level)}),d.subscribe({event:"docv2-undoedit-complete"},function(e){s.getDocumentsData(g).then(function(t){i=t.data,d.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModel}})})}),d.subscribe({event:"docv2-edit-complete"},function(e){s.getDocumentsData(g).then(function(t){i=t.data,d.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModel}})})}),d.subscribe({event:"docv2-update-complete"},function(e){s.getDocumentsData(g).then(function(t){i=t.data,d.publish({event:"docv2-preview-reload-toolbar",data:{nodeModel:e.nodeModel}}),d.publish({event:"docv2-preview-reload-viewer",data:{nodeModel:e.nodeModel}})})}),new a(p={fetchSecurityContext:function(){return decodeURIComponent(t.getSecurityContext())},getSelectedNodes:function(){return i},getDocumentFromNodeModel:function(e){return e},platformUrls:m,events:d}).commands[n].execute()})}else{p={document:{id:e.data.id,contextId:d,serviceId:"3DSpace",envId:l,index:1,data:e.data,type:"Document"},platformUrls:{"3DSpace":c,"3DDashboard":u},onComplete:function(t){"Update"===t.action&&"attachments"===e.from&&e.menu.dispatchEvent("request:updateFile",{item:e.selected[0],lock:!0})}};var E=new i;E.init(p),s.cmds=E.render(),s.cmds[n].handler()}})}}}),define("DS/IssueCommon/commands/Compare",["DS/ApplicationFrame/Command"],function(e){"use strict";return e.extend({execute:function(){var e=this;require(["DS/IssueCommon/utils/Selector","DS/IssueComponents/external/Compare"],function(t,n){e.selection=t.getSelection({type:"all"});var s=[];Object.keys(e.selection.map).forEach(function(t){var n=e.selection.map[t].physicalId.split(","),i=n[n.length-1];s.push({physicalId:i.includes("i3dx:")?e.selection.map[t].pid:i,type:e.selection.map[t].type,serviceId:e.selection.map[t].serviceId})}),n.execute(s)})}})}),define("DS/IssueCommon/commands/CollaborativeLifecycle",["DS/ApplicationFrame/Command"],function(e){"use strict";return e.extend({execute:function(){require(["DS/IssueCommon/utils/Selector","DS/IssueComponents/external/CollaborativeLifecycle"],function(e,t){var n=e.getSelection({type:"all"}),s=[];n.physicalIds.forEach(function(e){var t=e.split(","),i=t[t.length-1];i.includes("i3dx:")?s.push(n.map[i].pid):s.push(i)}),t.execute(s)})}})}),define("DS/IssueCommon/commands/CommandsManager",["DS/ApplicationFrame/CommandsManager"],function(e){"use strict";var t={disabled:!1,commands:{toEnable:[],toDisable:[]},commandCheckHeaders:{toEnable:[],toDisable:[]}},n="Default";return{setContext:function(e){n=e},disableAll:function(){if(!0!==t.disabled){var s=n,i=e.getCommands(s),a=i?Object.keys(i):[],o=e.getCommandCheckHeaders(s),r=o?Object.keys(o):[];t={disabled:!0,commands:{toEnable:[],toDisable:[]},commandCheckHeaders:{toEnable:[],toDisable:[]}};for(var d=0;d<a.length;d++)"function"==typeof i[a[d]].isEnabled&&(i[a[d]].isEnabled()?t.commands.toEnable.push(a[d]):t.commands.toDisable.push(a[d]));for(var l=0;l<r.length;l++)"function"==typeof o[r[l]].isEnabled&&(o[r[l]].isEnabled()?t.commandCheckHeaders.toEnable.push(r[l]):t.commandCheckHeaders.toDisable.push(r[l]));(t&&(t.commands.toEnable.length||t.commands.toDisable.length)||t&&(t.commandCheckHeaders.toEnable.length||t.commandCheckHeaders.toDisable.length))&&e.disableAll(s)}},enableAll:function(){if(!1!==t.disabled){var s=n;(t&&(t.commands.toEnable.length||t.commands.toDisable.length)||t&&(t.commandCheckHeaders.toEnable.length||t.commandCheckHeaders.toDisable.length))&&e.enableAll(s);var i=e.getCommands(s);if(t&&t.commands){for(var a=0;a<t.commands.toEnable.length;a++)i[t.commands.toEnable[a]].enable();for(var o=0;o<t.commands.toDisable.length;o++)i[t.commands.toDisable[o]].disable()}var r=e.getCommandCheckHeaders(s);if(t&&t.commandCheckHeaders){for(var d=0;d<t.commandCheckHeaders.toEnable.length;d++)r[t.commandCheckHeaders.toEnable[d]].enable();for(var l=0;l<t.commandCheckHeaders.toDisable.length;l++)r[t.commandCheckHeaders.toDisable[l]].disable()}t={disabled:!1,commands:{toEnable:[],toDisable:[]},commandCheckHeaders:{toEnable:[],toDisable:[]}}}},getCommand:function(t){var s=n;return e.getCommand(t,s)},getCommandCheckHeader:function(t){var s=n;return e.getCommandCheckHeader(t,s)},clean:function(t){t||(t="Default"),e._commandsState[t]={lastCommand:[],currentCommand:null,defaultCommand:null},e.resetDefaultCommand(t),e._isCommandEnding=!1,e._ignoreCommandBeginWhileEndingCommand=!1,["_commands","_cmdCheckHeader"].forEach(function(n){var s=t&&e[n][t]?e[n][t]:e[n];Object.keys(s).forEach(function(e){var t=s[e];t&&t._destroy&&t._destroy(),delete s[e]})})}}}),define("DS/IssueCommon/commands/Move",["UWA/Core","DS/ApplicationFrame/Command"],function(e,t){"use strict";var n=200;return t.extend({init:function(e){this._parent(e,{isAsynchronous:!0})},execute:function(t){var s=this;require(["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_ChangeOwnerCmd","DS/LifecycleServices/LifecycleServicesSettings","DS/PlatformAPI/PlatformAPI","DS/IssueCommon/commands/CommandsManager","DS/IssueCommon/utils/Selector","DS/IssueServices/Contexts","DS/IssueServices/services/PlatformServices"],function(t,i,a,o,r,d,l){var c=d.get("widget")||window.widget,u=o.getCommand("ActionBar_ChangeOwnerCmd_"+c.id);e.is(u,"object")||i.app_initialization(function(){var i=r.getSelection({type:"issue"}),o=[];i.physicalIds.forEach(function(e){var t={getID:function(){return i.map[e].id},getLabel:function(){return i.map[e].title}};o.push(t)});var d={securityContext:{SecurityContext:"ctx::"+decodeURIComponent(l.getSecurityContext())},getSecurityContext:function(){return this.securityContext},getSelectedNodes:function(){return o}};e.is(u,"object")||(u=new t({ID:"ActionBar_ChangeOwnerCmd_"+c.id,context:d})),u.onEnd(function(){s.end();var e=setInterval(function(){u.transferOwnershipPanel&&u.transferOwnershipPanel.addEvent&&(clearInterval(e),u.transferOwnershipPanel.addEvent("onClose",function(){for(var e=[],t={},n=r.getSelection({type:"issue"}),s=n.physicalIds,i=0;i<s.length;i++)e.push([n.map[s[i]].id]),t[n.map[s[i]].id]={id:n.map[s[i]].id,type:n.map[s[i]].type,name:n.map[s[i]].name,title:n.map[s[i]].title,modifiedAttributes:["owner"]};a.publish("DS/Object/update",{metadata:{appId:c.id,appName:c.name,timestamp:Math.floor(Date.now())},data:{paths:e,attributes:t},version:"1.0"})}))},n)})}),e.is(u,"object")&&u.begin()})}})}),define("DS/IssueCommon/commands/RelationalExplorer",["DS/ApplicationFrame/Command"],function(e){"use strict";return e.extend({execute:function(){require(["DS/IssueCommon/utils/Selector","DS/IssueComponents/external/RelationalExplorer"],function(e,t){var n=e.getSelection({type:"all"}),s=[];n.physicalIds.forEach(function(e){var t=e.split(","),i=t[t.length-1],a=n.map[i]?n.map[i].serviceId:"3DSpace";i.includes("i3dx:")&&(i=n.map[i].pid);var o={id:i,serviceId:a};s.push(o)}),t.execute(s)})}})}),define("DS/IssueCommon/commands/Duplicate",["UWA/Class","DS/ApplicationFrame/Command"],function(e,t){"use strict";return e.extend(t,{init:function(e){this._parent(e)},execute:function(){require(["DS/IssueComponents/duplicate/Duplicate","DS/IssueCommon/utils/Selector","DS/IssueServices/Contexts"],function(e,t,n){var s=n.get("widget")||window.widget,i=t.getSelection({type:"issue"});s.body.getElement(".duplicate-issues-dialog")||new e({physicalIds:i.physicalIds}).render()})}})}),define("DS/IssueCommon/commands/3DMarkup",["DS/ApplicationFrame/Command"],function(e){"use strict";return e.extend({execute:function(){require(["DS/IssueCommon/utils/Selector","DS/IssueComponents/external/3DMarkup"],function(e,t){var n=e.getSelection({type:"all"});t.execute(n.physicalIds)})}})}),define("DS/IssueCommon/commands/AttachmentManager",["UWA/Class","UWA/Core","UWA/Class/Listener","DS/ApplicationFrame/Command"],function(e,t,n,s){"use strict";var i="ENXISSU_AP",a="ENX3DIR_AP",o=100,r=!0;return e.extend(s,n,{_instances:[],init:function(e){this._parent(e,{isAsynchronous:!0}),this.authoring=null,this.selectedObject=null},execute:function(){var e=this;require(["DS/ENOFloatingPanel/ENOFloatingPanel","DS/PlatformAPI/PlatformAPI","DS/IssueAttachmentManager/IssueAttachmentManager","DS/IssueCommon/utils/Utils","DS/IssueServices/Contexts","DS/IssueServices/utils/LocalStorage","UWA/Class/Promise","i18n!DS/IssueCommon/assets/nls/IssueCommon"],function(n,s,d,l,c,u,m,p){var g=c.get("widget"),E=c.get("component"),I=c.get("eventsHandler");new m(function(n){var s="",o="",r="";if(t.is(e.selectedObject)&&t.is(e.selectedObject.physicalId,"string")&&t.is(e.selectedObject.title,"string")&&t.is(e.selectedObject.name,"string"))n({id:e.selectedObject.physicalId,title:e.selectedObject.title,name:e.selectedObject.name});else if(g.name===i){var d=E.getSelectedNodes();d.length>0&&(s=d[d.length-1].options.id,o=d[d.length-1].options.title,r=d[d.length-1].options.name),n({id:s,title:o,name:r})}else if(g.name===a){var l=E.getSelectedIssues();l.length>0&&(s=l[l.length-1].id,o=l[l.length-1].title,r=l[l.length-1].name),n({id:s,title:o,name:r})}}).then(function(i){var u=i.id,m=i.title,S=i.name,h=Date.now(),f=g.body.getDimensions(),A={mode:1,catalogLayout:g.getValue("attachmentLayout")?g.getValue("attachmentLayout"):1,catalogVisibility:!0,sliderVisibility:!1,height:f.height-100,width:f.width-100,top:"20px",left:"50px",annotationPreLaunchCallback:function(){if(e._instances.hasOwnProperty(h)&&l.Mask.mask(e._instances[h].elements.container),g.name===a)try{this.annotationCanvasTarget=t.Element.getElement.call(E.get3DContext().root.getFrameWindow().elements.viewerFrame,"canvas")}catch(e){}else this.annotationCanvasDefaultDimensions={width:f.width-50,height:f.height-50}},annotationSaveCallback:function(){e._instances.hasOwnProperty(h)&&l.Mask.unmask(e._instances[h].elements.container)},annotationExitCallback:function(){e._instances.hasOwnProperty(h)&&l.Mask.unmask(e._instances[h].elements.container)}},v=t.clone(g.getValue("attachmentManagerModalPreferences")),D=t.clone(g.getValue("attachmentManagerPreferences")),w=t.merge(v||{},A);(w=t.merge(D||{},w)).id=u,w.authoring=t.is(e.authoring,"boolean")?e.authoring:r;var y=new d(w),C=e._instances[h]=new n({animate:!0,autocenter:!0,closable:!0,limitParent:!1,overlay:!1,resizable:!0,visible:!0,className:"isu-am-modal",title:p.replace(p.attachments.title,{title:m,name:S}),header:null,body:y,events:{onShow:function(){var t=this;t.attachmentManager=y,t.instanceId=h,t._subscriberId=Math.random().toString(36).substr(2,9),t.attachmentManager.render(),t.attachmentManager.isLoaded.then(function(){e._utils._addCustomCommands.apply(t),t.attachmentManager.container.setAttribute("tabindex","0"),t.attachmentManager.container.focus(),t.attachmentManager.resize();var n=l.throttle(function(){t.attachmentManager.resize()},o);e.listenTo(t,"onResizeFloating",n),e.listenTo(t.attachmentManager,"onRefresh",e._utils._addCustomCommands.bind(t)),e.listenTo(t.attachmentManager,"onUpdate",function(e){for(var n=[],i={},a=Object.keys(e.objects),o=0;o<a.length;o++)n.push([e.objects[a[o]].physicalId]),i[e.objects[a[o]].physicalId]={id:e.objects[a[o]].physicalId,type:e.objects[a[o]].type||"Issue",modifiedAttributes:["attachments"]};var r="DS/Object/update",d={metadata:{appId:c.get("widget").id,appName:c.get("widget").name,timestamp:Math.floor(Date.now()),options:{}},data:{paths:n,attributes:i},version:"1.0"};null!==I?I.publish(t._subscriberId,r,d):s.publish(r,d)}),t._eventListeners=[{event:"DS/Object/update",listener:function(e){t.attachmentManager&&t.attachmentManager.id&&(e.data.paths.some(function(e){return t.attachmentManager.id===e[0]})&&t.attachmentManager.refresh())},conditions:{type:"issue",attributes:["attachments"]}},{event:"DS/Object/select",listener:function(n){if(!t._holdIssueFlg){var s="";if(1===n.data.paths.length&&(s=n.data.paths.pop().pop()),""!==s&&s!==t.attachmentManager.collection.id){var i="",a="";if(n.data.attributes.hasOwnProperty(s)){var o=n.data.attributes[s];i=o.title,a=o.name}t.setTitle(p.replace(p.attachments.title,{title:i,name:a})),t.attachmentManager.refresh(s).then(function(){e._utils._addCustomCommands.apply(t)})}}},conditions:{type:"issue"}}];for(var i=0;i<t._eventListeners.length;i++){var a=t._eventListeners[i];a.token=null!==I?I.subscribe(t._subscriberId,a.event,a.listener.bind(t),a.conditions):s.subscribe(a.event,a.listener.bind(t))}e.authoring=null,e.selectedObject=null,e.end()}).catch(function(e){if(e.internalError&&e.internalError.includes("ErrorCode:1500127")){var t=l.getErrorMessage("0");l.displayErrorMessage(t,"error"),C.destroy()}else PADAlert.displayNotification({msg:p.notifications.Init.failure,eventID:"error"})})},onClose:function(){if(g.setValue("attachmentManagerModalPreferences",{width:this.elements.container.clientWidth,height:this.elements.container.clientHeight,top:this.elements.container.offsetTop,left:this.elements.container.offsetLeft}),e.stopListening(this,"onResizeFloating"),e.stopListening(this.attachmentManager,"onUpdate"),Array.isArray(this._eventListeners))for(var t=0;t<this._eventListeners.length;t++){var n=this._eventListeners[t];null!==I?I.unsubscribe(n.token):s.unsubscribe(n.token)}this._eventListeners=[],this.attachmentManager.resetPADAlert(),this.attachmentManager.destroy(),this.attachmentManager=null,delete e._instances[this.instanceId],this.destroy()}}});C.inject(g.body),C.elements.container.setStyle("height",w.height),C.elements.container.setStyle("width",w.width),C.elements.container.setStyle("zIndex","25")})})},_utils:{_addCustomCommands:function(){var e=this;require(["i18n!DS/IssueCommon/assets/nls/IssueCommon"],function(t){var n=function(){e._holdIssueFlg=!e._holdIssueFlg,e.attachmentManager.views.header.iconBarFix.getItem("hold").elements.container.toggleClassName("active",e._holdIssueFlg),e.attachmentManager.contextualMenu.customCommands.forEach(function(t){"hold"===t.name&&(t.state=e._holdIssueFlg?"selected":"unselected")})};(e._holdIssueFlg=!1,e.attachmentManager.views.header.iconBarFix.addItem({id:"hold",fonticon:"pin",text:t.attachments.holdIssue,selectable:!0,handler:n}),e.attachmentManager&&e.attachmentManager.contextualMenu&&e.attachmentManager.contextualMenu.customCommands)&&(e.attachmentManager.contextualMenu.customCommands.some(function(e){return"hold"===e.name})||e.attachmentManager.contextualMenu.customCommands.push({name:"hold",title:t.attachments.holdIssue,type:"RadioItem",fonticon:{content:"wux-ui-3ds wux-ui-3ds-1x fonticon-pin"},data:null,state:e._holdIssueFlg?"selected":"unselected",action:{callback:n}}))})}}})}),define("DS/IssueCommon/commands/Close",["UWA/Class","DS/ApplicationFrame/Command"],function(e,t){"use strict";return e.extend(t,{init:function(e){this._parent(e)},execute:function(){require(["DS/IssueComponents/close/Close","DS/IssueCommon/utils/Selector","DS/IssueServices/Contexts"],function(e,t,n){var s=n.get("widget")||window.widget,i=t.getSelection({type:"issue"});s.body.getElement(".isu-close-dialog")||new e({physicalIds:i.physicalIds}).render()})}})}),define("DS/IssueCommon/commands/Reopen",["UWA/Class","DS/ApplicationFrame/Command"],function(e,t){"use strict";return e.extend(t,{init:function(e){this._parent(e)},execute:function(){require(["DS/IssueComponents/reopen/Reopen","DS/IssueCommon/utils/Selector","DS/IssueServices/Contexts"],function(e,t,n){var s=n.get("widget"),i=t.getSelection({type:"issue"});s.body.getElement(".isu-reopen-dialog")||new e({physicalIds:i.physicalIds}).render()})}})}),define("DS/IssueCommon/commands/ChangeOwner",["UWA/Core","UWA/Class/Promise","DS/ApplicationFrame/Command"],function(e,t,n){"use strict";var s=200;return n.extend({init:function(e){this._parent(e,{isAsynchronous:!0})},execute:function(){var t=this;require(["DS/ENOCollabSharingCmds/commands/TransferOwnershipCmd/ActionBar_TransferOwnershipCmd","DS/LifecycleServices/LifecycleServicesSettings","DS/PlatformAPI/PlatformAPI","DS/IssueCommon/commands/CommandsManager","DS/IssueCommon/utils/Selector","DS/IssueServices/Contexts","DS/IssueServices/services/PlatformServices"],function(n,i,a,o,r,d,l){var c=d.get("widget")||window.widget,u=o.getCommand("ActionBar_TransferOwnershipCmd_"+c.id);e.is(u,"object")||i.app_initialization(function(){var e=r.getSelection({type:"issue"}),i=[];e.physicalIds.forEach(function(t){var n={getID:function(){return e.map[t].id},getLabel:function(){return e.map[t].title}};i.push(n)});var o={securityContext:{SecurityContext:"ctx::"+decodeURIComponent(l.getSecurityContext())},getSecurityContext:function(){return this.securityContext},getSelectedNodes:function(){return i}};(u=new n({ID:"ActionBar_TransferOwnershipCmd_"+c.id,context:o})).onEnd(function(){t.end();var e=setInterval(function(){u.transferOwnershipPanel&&u.transferOwnershipPanel.addEvent&&(clearInterval(e),u.transferOwnershipPanel.addEvent("onClose",function(){for(var e=[],t={},n=r.getSelection({type:"issue"}),s=n.physicalIds,i=0;i<s.length;i++)e.push([n.map[s[i]].id]),t[n.map[s[i]].id]={id:n.map[s[i]].id,type:n.map[s[i]].type,name:n.map[s[i]].name,title:n.map[s[i]].title,modifiedAttributes:["owner"]};a.publish("DS/Object/update",{metadata:{appId:c.id,appName:c.name,timestamp:Math.floor(Date.now())},data:{paths:e,attributes:t},version:"1.0"})}))},s)})}),e.is(u,"object")&&u.begin()})}})}),define("DS/IssueCommon/utils/Utils",["UWA/Class/Promise","UWA/Controls/Input","UWA/Core","DS/UIKIT/Mask","DS/PlatformAPI/PlatformAPI","DS/Logger/Logger","DS/PADUtils/views/PADAlert","DS/WebappsUtils/WebappsUtils","DS/IssueServices/services/PlatformServices","DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen","DS/TransientWidget/TransientWidget","DS/IssueServices/Contexts","DS/ApplicationFrame/ActionBar","DS/IssueCommon/commands/CommandsManager","DS/IssueTracker/IssueTracker","DS/IssueTracker/IssueDimension","DS/IssueTracker/IssueDimensionMapping","DS/IssueTracker/IssueValue","i18n!DS/IssueCommon/assets/nls/IssueCommon"],function(e,t,n,s,i,a,o,r,d,l,c,u,m,p,g,E,I,S,h,f){"use strict";var A="Issue",v="Create",D="Assign",w="Active",y="Review",C="Closed",b=["created","modified","estimatedStartDate","estimatedEndDate","actualStartDate","actualEndDate","resolutionDate"],T=10,N="#dashboard:/tab:/app:ENXISSU_AP/content:XSharedContentId=";return{getIconByState:function(e,t,n){var s="";if(m.get("ISU_LISTVIEW"))if(t!=A&&""!=n)s=n.indexOf("http")>=0?n:d.get3DSpaceUrl()+"/"+n;else switch(e){case v:s=r.getWebappsAssetUrl("IssueCommon","icons/32/states/iconCreateState.png");break;case D:s=r.getWebappsAssetUrl("IssueCommon","icons/32/states/iconAssignState.png");break;case w:s=r.getWebappsAssetUrl("IssueCommon","icons/32/states/iconActiveState.png");break;case y:s=r.getWebappsAssetUrl("IssueCommon","icons/32/states/iconReviewState.png");break;case C:s=r.getWebappsAssetUrl("IssueCommon","icons/32/states/iconClosedState.png")}else s=n.indexOf("http")>=0?n:n.indexOf("http")<0||n.indexOf("common/images")?n.indexOf("http")>=0?n:d.get3DSpaceUrl()+"/"+n:""==n||n.indexOf("http")<0?(n="common/images/iconSmallIssue.png").indexOf("http")>=0?n:d.get3DSpaceUrl()+"/"+n:n;return s},getColorByState:function(e){var t="";switch(e){case v:t="#9B2C98";break;case D:t="#E03400";break;case w:t="#007DA3";break;case y:t="#018308";break;case C:t="#757575"}return t},getFormattedDate:function(e,t){for(var n=window.widget.lang,s=b,i=0;i<s.length;i++)isNaN(Date.parse(e[s[i]]))?e[s[i]]="":e[s[i]]=new Date(e[s[i]]).toLocaleString(n,t);return e},getTypeRepOfAttribute:function(e){let t="string";if(e.type)return"timestamp"===e.type?t:"real"===e.type?"number":e.type;let n="";if(e.range&&e.range.dataTypes){const s=e.range.dataTypes[0].indexOf("#");switch(n=e.range.dataTypes[0].slice(s+1)){case"real":case"integer":t="number";break;case"timestamp":t="datetime";break;case"boolean":t="boolean";break;default:t="string"}}return t},getFormattedValueAsPerTypeRepresentation:function(e,t){const n=m.get("CustomAttributesPredicates");if(n&&!n[e])return t;let s="";switch(n[e].typeRepresentation){case"datetime":case"timestamp":s=new Date(t);break;case"integer":s=""!==t?parseInt(t):t;break;case"real":case"number":s=isNaN(t)?"":""!==t?Number(t):t;break;case"boolean":s="FALSE"!=t&&"false"!=t&&"False"!=t&&(""!==t?Boolean(t):t);break;default:s=t}return s},setColumnFilteringOnColumn:function(e,t){var n=e.getTreeDocument().getFilterManager();const s=this._getFilterIdForColumn(t);n.setPropertyFilterModel(t.dataIndex,{filterId:s})},setColumnFilteringOnAllColumns:function(e){var t=e.getTreeDocument().getFilterManager();const n=["ds6w:contexts","ds6w:reportedAgainst","ds6w:resolvedBy","ds6w:priority","ds6w:state","Approvals"];e.columns.forEach(e=>{if(n.indexOf(e.dataIndex)>=0){let n=e.dataIndex;t.setPropertyFilterModel(n,{filterId:"set"})}else if(n.indexOf(e.dataIndex)<0){const n=this._getFilterIdForColumn(e);let s=e.dataIndex;"tree"===e.dataIndex&&(s="label"),t.setPropertyFilterModel(s,{filterId:n})}})},_getFilterIdForColumn:function(e){let t="set";switch(e.typeRepresentation?e.typeRepresentation:"string"){case"datetime":t="date";break;case"integer":t="number";break;case"boolean":t="set";break;case"real":case"number":t="number";break;default:t="string"}return t},getTextFromHTML:function(e){var t=n.createElement("div",{html:n.String.escapeHTML(e)});return t.textContent||t.innerText||""},timeSince:function(e){var t=Math.floor((new Date-e)/1e3),n=Math.floor(t/31536e3);return n>1?f.replace(f.dates.years,{number:n}):(n=Math.floor(t/2592e3))>1?f.replace(f.dates.months,{number:n}):(n=Math.floor(t/86400))>1?f.replace(f.dates.days,{number:n}):(n=Math.floor(t/3600))>1?f.replace(f.dates.hours,{number:n}):(n=Math.floor(t/60))>1?f.replace(f.dates.minutes,{number:n}):f.replace(f.dates.seconds,{number:Math.floor(t>=0?t:0)})},getFilesFromDrop:function(e){var t=[];if(e.dataTransfer.items)for(var n=0;n<e.dataTransfer.items.length;n++)"file"===e.dataTransfer.items[n].kind&&t.push(e.dataTransfer.items[n].getAsFile());else for(var s=0;s<e.dataTransfer.files.length;s++)t.push(e.dataTransfer.files[s]);return t},uploadImages:function(n){var s=this;return new e(function(e){var s=new t.File("Input.File",{visibility:"hidden",styles:{display:"none"}});s.elements.container.setStyle("display","none"),s.elements.input.multiple=void 0===n||n,s.elements.input.accept="image/png, image/jpeg",s.elements.input.addEventListener("change",function(t){s.destroy(),s=null,e(t.target.files)},!1),s.elements.input.addEventListener("click",function(e){e.stopPropagation()}),s.elements.input.click()}).then(function(t){if(0===(t=Array.from(t)).length)return e.reject(new Error("No selected files to be uploaded"));var n=[];return t.forEach(function(e){n.push(s.isImage(e))}),e.all(n)}).then(function(t){return 0===(t=t.reduce(function(e,t){return"success"===t.status?e.push(t.file):o.displayNotification({msg:f.replace(f.images.errorUpload,{name:t.file.name}),eventID:"error"}),e},[])).length?e.reject(new Error("No valid files to be uploaded")):e.resolve(t)})},isImage:function(t){var n=new FileReader;return new e(function(e){n.onload=function(n){var s=n.target.result,i=new Uint8Array(s);255===i[0]&&216===i[1]&&255===i[i.byteLength-2]&&217===i[i.byteLength-1]?e({status:"success",file:t}):137===i[0]&&80===i[1]&&78===i[2]&&71===i[3]?e({status:"success",file:t}):71===i[0]&&73===i[1]&&70===i[2]&&56===i[3]?e({status:"error",file:t}):(66===i[0]&&i[1],e({status:"error",file:t}))},n.readAsArrayBuffer(t)})},readImageURI:function(t){var n=new FileReader;return new e(function(e){n.onload=function(t){e(t.target.result)},n.readAsDataURL(t)})},getDroppableData:function(e){for(var t={},s=n.is(e.dataTransfer.types.indexOf,"function")?"indexOf":"contains",i="",a=["text/searchitems","text/plain","Text"],o=0;o<a.length&&""===i;o++){var r=e.dataTransfer.types[s](a[o]);(n.is(r,"number")&&r>=0||n.is(r,"boolean")&&!0===r)&&(i=a[o])}var d={};if(""===i)throw new Error("Unknown type in DnD");d=e.dataTransfer.getData(i);try{t=JSON.parse(d)}catch(e){t={data:{items:[]}}}return t},showRevisionModal:function(e){new p({context:{},file:"IssueRevision.xml",module:"IssueCommon"});!1===e.nodeModel.isSelected()&&e.nodeModel.select();d.get3DSpaceUrl(),d.get3DDashboardUrl(),m.get("widget")||window.widget;var t=[];"object"==typeof e.nodeModel.options.icons[0]&&e.nodeModel.options.icons.shift(),t.push(e.nodeModel);var n=function(){return t}().map(function(e){var t=e,n=t.options.id.split(",");return t.options.id=n[n.length-1],t.options.physicalId&&0!=t.options.physicalId.length||(t.options.physicalId=t.options.data.id),t.getID||(t.getID=function(){return physicalID}),t}),s={getSelectedNodes:()=>n};if(e.nodeModel){var i=g.getCommand("HistoryHdr");i.context=s,i&&i.begin()}},_debounceTimeouts:[],debounce:function(e,t,n){var s,i=this;return function(){var a=this,o=arguments,r=n&&!s;clearTimeout(s);var d=i._debounceTimeouts.indexOf(s);-1!==d&&i._debounceTimeouts.splice(d,1),s=setTimeout(function(){s=null,n||e.apply(a,o)},t),i._debounceTimeouts.push(s),r&&e.apply(a,o)}},throttle:function(e,t,n){var s,i,a,o=null,r=0;n||(n={});var d=function(){r=!1===n.leading?0:Date.now(),o=null,a=e.apply(s,i),o||(s=i=null)};return function(){var l=Date.now();r||!1!==n.leading||(r=l);var c=t-(l-r);return s=this,i=arguments,c<=0||c>t?(o&&(clearTimeout(o),o=null),r=l,a=e.apply(s,i),o||(s=i=null)):o||!1===n.trailing||(o=setTimeout(d,c)),a}},isValid3DXContent:function(e){if(n.equals(e,null)||n.equals(e,void 0))return!1;if(!e.hasOwnProperty("protocol")||!n.equals(e.protocol,"3DXContent"))return!1;if(!e.hasOwnProperty("version")||!n.is(e.version,"string"))return!1;if(!e.hasOwnProperty("source")||!n.is(e.source,"string"))return!1;if(e.hasOwnProperty("widgetId")&&!n.is(e.widgetId,"string"))return!1;if(!e.hasOwnProperty("data")||!n.is(e.data,"object"))return!1;if(!e.data.hasOwnProperty("items")||!n.is(e.data.items,"array"))return!1;if(e.data.items.length>0&&!e.data.items.every(function(e){if(!e.hasOwnProperty("envId")||!n.is(e.envId,"string"))return!1;if(!e.hasOwnProperty("objectId")||!n.is(e.objectId,"string"))return!1;if(!e.hasOwnProperty("serviceId")||!n.is(e.serviceId,"string")||!e.serviceId.toLowerCase().includes("3dspace")&&!e.hasOwnProperty("i3dx")||!e.serviceId.toLowerCase().includes("3dspace")&&e.hasOwnProperty("i3dx")&&""==e.i3dx)return!1;if(!e.hasOwnProperty("objectType")||!n.is(e.objectType,"string"))return!1;if(e.hasOwnProperty("displayName")&&!n.is(e.displayName,"string"))return!1;if(e.hasOwnProperty("contextId")&&!n.is(e.contextId,"string"))return!1;if(e.hasOwnProperty("displayPreview")&&!n.is(e.displayPreview,"string"))return!1;if(e.hasOwnProperty("displayIcon")&&!n.is(e.displayIcon,"string"))return!1;if(e.hasOwnProperty("path")){if(!n.is(e.path,"array"))return!1;if(!e.path.every(function(e){return!(!e.hasOwnProperty("resourceid")||!n.is(e.resourceid,"string"))&&!(e.hasOwnProperty("type")&&!n.is(e.type,"string"))}))return!1}return!0}))return!1;return!0},computeSharedIssuesURL:function(e){var t=d.get3DDashboardUrl()+N;return t+=encodeURIComponent(JSON.stringify({issues:n.clone(e)}))},copyTextToClipboard:function(e){var t=document.createElement("textarea");t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.width="2em",t.style.height="2em",t.style.padding=0,t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=e,document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(e){}document.body.removeChild(t)},isJson:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},isInteger:function(e){return Number.isInteger?Number.isInteger(e):"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},addCSSMaturityClasses:function(e,t){var n={};if(void 0===t.policies)return;let s=t.policies;for(let e=0;s&&e<s.length;e++){n[s[e].policyName]=s[e].states}for(let t in n){let s=n[t];for(let n=0;n<s.length;n++){let i=s[n].activeColor,a="{color:"+("#FFFFFF"===i?"#000000":"#FFFFFF")+" ; background-color:"+i+";}",o=this.cleanStatusForCSS(s[n].stateSysName),r="lc-status-"+this.cleanStatusForCSS(t)+"-"+o+(e?"-withClass":""),d="."+r+(e?" ."+e:"");this.createCSSClass(r,a,d)}}},cleanStatusForCSS:function(e){return e.replace(/(\.| )/g,"-")},createCSSClass:function(e,t,n){if(null===document.getElementById(e)){var s=document.createElement("style");s.type="text/css",s.id=e;let i=n||"."+e;s.innerHTML=i+t,document.getElementsByTagName("head")[0].appendChild(s)}},publishSelectAll:function(e){var t=m.get("widget")||window.widget,n=t.getValue("appId")+"_"+t.id,s={metadata:{uid:Math.random(),originUid:Math.random(),appid:n,originWidgetId:t.id,timestamp:Math.floor(Date.now())},data:{paths:e.paths,attributes:e.attributes,version:"1.1",tenant:d.getTenant()}};i.publish("DS/PADUtils/PADCommandProxy/select",s)},getNLSValueForCustomAttr:function(e,t){let n=[];return e.split(",").forEach(s=>{t.literalInfo.forEach(t=>{s.trim()==t.value.trim()?n.push(t.nlsValue):e=e})}),n},Mask:{_timeouts:[],mask:function(e,t){var i=n.merge({},t);if(!0===this._timeouts.every(function(t){return t.element!==e})){var a=setTimeout(function(){s.mask(e,i.message)},i.delay||T);Array.isArray(this._timeouts)||(this._timeouts=[]),this._timeouts.push({element:e,timeout:a})}},unmask:function(e){var t=-1;this._timeouts.some(function(n,s){return n.element===e&&(t=s,!0)}),t>-1&&(clearInterval(this._timeouts[t].timeout),this._timeouts.splice(t,1)),s.isMasked(e)&&s.unmask(e)}},get3DSwymUrl:function(){return d.get3DSwymUrl()},getErrorMessage:function(e){var t={};return t.title=f.error[e].title,t.subtitle=f.error[e].subtitle,t.message=f.error[e].message,t},displayErrorMessage:function(e,t){e.level=t,e.sticky=!1,e.allowUnsafeHTML=!1,void 0===this._notif_manager&&(this._notif_manager=l,c.setNotificationManager(this._notif_manager),c.setStackingPolicy(5)),this._notif_manager.addNotif(e)},viewProperties:function(e,t){var n=m.get("widget")||window.widget;t.toLowerCase().includes("3dspace")?t="3DSpace":t.toLowerCase().includes("swym")&&(t="3DSwym");var s=[],i={getID:function(){return e},source:t,tenant:d.getTenant(),type:""};s.push(i);var a={appId:n.name,_selection:s,getSecurityContext:function(){return{SecurityContext:decodeURIComponent(d.getSecurityContext())}},getSelectedNodes:function(){return this._selection},displayNotification:function(){}};require(["DS/LifecycleControls/EditPropDialog"],function(e){(new e).launchProperties(a)})},removeErrorNotification:function(){c.removeNotifications(null,"error")},cloudProbeUtils:{sendCreateIssueTrackerEvent:function(e){var t,n=(m.get("widget")||window.widget).name,s="",i=E.Availability.FALSE,a=E.Availability.FALSE,o=E.Availability.FALSE,r=E.Availability.FALSE,l=E.Availability.FALSE,c=E.Availability.FALSE,u=E.Availability.FALSE,p=E.Availability.FALSE,g=E.Availability.FALSE,S="",h="",f=E.Availability.FALSE,A=e.createData;if(null==e.options.escapeToClose||e.options.escapeToClose||(s=E.IssueCreation.TOOLBAR),"CreateFrom3D"==e.options.issueCreationType&&(s=E.IssueCreation.GEOMETRY),"InlineIssue"==e.options.issueCreationType&&(s=E.IssueCreation.INLINE,h=E.IssueCreationStatus.SAVEASDRAFT),"IFB"==e.options.issueCreationType&&e.options.escapeToClose&&(s=E.IssueCreation.NEWISSUE),"IFT"==e.options.issueCreationType&&e.options.escapeToClose&&(s=E.IssueCreation.NEWFROMTEMPLATE),null!=e.options.advancedDuplicate){s=e.options.advancedDuplicate?E.IssueCreation.ADVANCEDUPLICATE:E.IssueCreation.DUPLICATE,h=E.IssueCreationStatus.SAVEASDRAFT;var v=d.getSecurityContexts();v.cspaces.forEach(e=>{e.value.includes(v.securityContext)&&(S=e.roleNls)})}A&&(A.waitingOn&&"Analyst"==A.waitingOn&&(i=E.Availability.TRUE),A.classification&&A.classification.length>0&&(a=E.Availability.TRUE),A.contexts&&A.contexts.length>0&&(o=E.Availability.TRUE),A.reportedAgainst&&A.reportedAgainst.length>0&&(r=E.Availability.TRUE),e.views&&e.views.attachments.view.collection.length>0&&(l=E.Availability.TRUE),A.coOwners&&A.coOwners.length>0&&(c=E.Availability.TRUE),A.assignees&&A.assignees.length>0&&(u=E.Availability.TRUE),A.type&&"Issue"!=A.type&&(p=E.Availability.TRUE),A.contributors&&A.contributors.length>0&&(g=E.Availability.TRUE),A.securityContexts&&d.getSecurityContexts().cspaces.forEach(e=>{e.value.includes(A.securityContexts)&&(S=e.roleNls)}),A.state&&"Create"==A.state?h=E.IssueCreationStatus.SAVEASDRAFT:A.state&&"Assign"==A.state&&(h=E.IssueCreationStatus.START),A.informedUsers&&A.informedUsers.length>0&&(f=E.Availability.TRUE)),t=E.getDeviceUsedForOperation(),E.createEventBuilder({category:E.Category.USAGE,action:E.Events.CLICK,tenant:d.getTenant()}).setLabel(E.Labels.ISSUEMANAGEMENT_CREATE_ISSUE).setAppId(n).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE,s).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_APPROVAL_ACTIVATE,i).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CLASSIFICATION,a).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_CONTEXTS,o).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_AFFECTEDITEMS,r).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_ATTACHMENTS,l).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_COOWNER,c).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_ASSIGNEE,u).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUE_CUSTOM_TYPE_OOTB,p).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_CONTRIBUTORS,g).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATION_ROLE,S).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_STATUS_AT_CREATION,h).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_MEDIA,t).addDimension(I.ISSUEMANAGEMENT_CREATE_ISSUE.ISSUEMANAGEMENT_CREATEISSUE_CONTAINS_INFORMEDUSERS,f).send()},sendIMCommandsTrackerEvent:function({options:e}){var t=(m.get("widget")||window.widget).name,n="",s="",i="",a="",o="";S[I.ISSUEMANAGEMENT_COMMANDS.TYPE].allowedValues.includes(e.pd1)&&(n=e.pd1),S[I.ISSUEMANAGEMENT_COMMANDS.VIEW].allowedValues.includes(e.pd2)&&(s=e.pd2),S[I.ISSUEMANAGEMENT_COMMANDS.FACET].allowedValues.includes(e.pd3)&&(i=e.pd3),S[I.ISSUEMANAGEMENT_COMMANDS.COMMAND].allowedValues.includes(e.pd4)&&(a=e.pd4),null!=e.pd5&&null!=e.pd5&&(o=e.pd5),E.createEventBuilder({category:E.Category.USAGE,action:E.Events.CLICK,tenant:d.getTenant()}).setLabel(E.Labels.ISSUEMANAGEMENT_COMMANDS).setAppId(t).addDimension("IMtype",n).addDimension("IMview",s).addDimension("IMfacet",i).addDimension("IMcommand",a).addDimension("IMcommandpath",o).send()},sendI3DRCommandsTrackerEvent:function({options:e}){var t=(m.get("widget")||window.widget).name,n="",s="",i="",a="",o="";S[I.ISSUE3DREVIEW_COMMANDS.TYPE].allowedValues.includes(e.pd1)&&(n=e.pd1),S[I.ISSUE3DREVIEW_COMMANDS.VIEW].allowedValues.includes(e.pd2)&&(s=e.pd2),S[I.ISSUE3DREVIEW_COMMANDS.FACET].allowedValues.includes(e.pd3)&&(i=e.pd3),S[I.ISSUE3DREVIEW_COMMANDS.COMMAND].allowedValues.includes(e.pd4)&&(a=e.pd4),null!=e.pd5&&null!=e.pd5&&(o=e.pd5),E.createEventBuilder({category:E.Category.USAGE,action:E.Events.CLICK,tenant:d.getTenant()}).setLabel(E.Labels.ISSUE3DREVIEW_COMMANDS).setAppId(t).addDimension("I3DRtype",n).addDimension("I3DRview",s).addDimension("I3DRfacet",i).addDimension("I3DRcommand",a).addDimension("I3DRcommandpath",o).send()},sendIssueFacetsTrackerEvent:function({options:e}){var t=(m.get("widget")||window.widget).name,n="";S[I.ISSUE_FACET.ISSUE_FACET].allowedValues.includes(e.pd1)&&(n=e.pd1),E.createEventBuilder({category:E.Category.USAGE,action:E.Events.CLICK,tenant:d.getTenant()}).setLabel(E.Labels.ISSUE_FACETS).setAppId(t).addDimension(I.ISSUE_FACET.ISSUE_FACET,n).send()},sendFilterIssueMgmtTrackerEvent:function(e){var t,n,s,i,a,o,r,l,c,u,p,g,S,f,A,v,D,w,y,C=(m.get("widget")||window.widget).name,b=this.fetchFilterValues(e);t=b.owned,n=b.assigned,s=b.reported,i=b.responsible,a=b.contributed,o=b.closed,r=b.media,l=b.ownedCount,c=b.assignedCount,u=b.reportedCount,p=b.responsibleCount,g=b.contributedCount,S=b.closedCount,f=b.ownedAssigned,A=b.ownedAssignedOrg,v=b.ownedAssignedComb,D=b.ownedAssignedCompleted,w=b.ownedAssignedOrgCompleted,y=b.ownedAssignedCombCompleted,E.createEventBuilder({category:E.Category.USAGE,action:E.Events.CLICK,tenant:d.getTenant()}).setLabel(E.Labels.ISSUEMANAGEMENT_FILTER).setAppId(C).addDimension(I.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDBYME,t).addDimension(I.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_ASSIGNEDTOME,n).addDimension(I.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDBYMYORGANIZATION,s).addDimension(I.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_ASSIGNEDTOMYORGANIZATION,i).addDimension(I.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_WHEREICONTRIBUTE,a).addDimension(I.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_COMPLETED,o).addDimension(I.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_MEDIA,r).addPersonalValue(h.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDBYME_TOTALNOISSUES,l).addPersonalValue(h.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_ASSIGNEDTOME_TOTALNOISSUES,c).addPersonalValue(h.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDBYMYORGANIZATION_TOTALNOISSUES,u).addPersonalValue(h.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_ASSIGNEDTOMYORGANIZATION_TOTALNOISSUES,p).addPersonalValue(h.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_WHEREICONTRIBUTE_TOTALNOISSUES,g).addPersonalValue(h.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_COMPLETED_TOTALNOISSUES,S).addPersonalValue(h.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDASSIGNED_TOTALNOISSUES,f).addPersonalValue(h.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDASSIGNEDORG_TOTALNOISSUES,A).addPersonalValue(h.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDASSIGNEDCOMBINED_TOTALNOISSUES,v).addPersonalValue(h.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDASSIGNEDCOMPLETED_TOTALNOISSUES,D).addPersonalValue(h.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDASSIGNEDORGCOMPLETED_TOTALNOISSUES,w).addPersonalValue(h.ISSUEMANAGEMENT_FILTER.ISSUEMANAGEMENT_FILTER_OWNEDASSIGNEDCOMPLETEDCOMBINED_TOTALNOISSUES,y).send()},sendFilterIssue3DReviewTrackerEvent:function(e){var t,n,s,i,a,o,r,l,c,u,p,g,S,f,A,v,D,w,y,C,b=(m.get("widget")||window.widget).name,T=this.fetchFilterValues(e);t=T.owned,n=T.assigned,s=T.reported,i=T.responsible,a=T.contributed,o=T.closed,r=T.synchronize,l=T.media,c=T.ownedCount,u=T.assignedCount,p=T.reportedCount,g=T.responsibleCount,S=T.contributedCount,f=T.closedCount,A=T.ownedAssigned,v=T.ownedAssignedOrg,D=T.ownedAssignedComb,w=T.ownedAssignedCompleted,y=T.ownedAssignedOrgCompleted,C=T.ownedAssignedCombCompleted,E.createEventBuilder({category:E.Category.USAGE,action:E.Events.CLICK,tenant:d.getTenant()}).setLabel(E.Labels.ISSUE3DREVIEW_FILTER).setAppId(b).addDimension(I.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDBYME,t).addDimension(I.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_ASSIGNEDTOME,n).addDimension(I.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDBYMYORGANIZATION,s).addDimension(I.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_ASSIGNEDTOMYORGANIZATION,i).addDimension(I.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_WHEREICONTRIBUTE,a).addDimension(I.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_COMPLETED,o).addDimension(I.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_SYNCHRONIZED,r).addDimension(I.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_MEDIA,l).addPersonalValue(h.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDBYME_TOTALNOISSUES,c).addPersonalValue(h.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_ASSIGNEDTOME_TOTALNOISSUES,u).addPersonalValue(h.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDBYMYORGANIZATION_TOTALNOISSUES,p).addPersonalValue(h.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_ASSIGNEDTOMYORGANIZATION_TOTALNOISSUES,g).addPersonalValue(h.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_WHEREICONTRIBUTE_TOTALNOISSUES,S).addPersonalValue(h.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_COMPLETED_TOTALNOISSUES,f).addPersonalValue(h.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDASSIGNED_TOTALNOISSUES,A).addPersonalValue(h.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDASSIGNEDORG_TOTALNOISSUES,v).addPersonalValue(h.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDASSIGNEDCOMBINED_TOTALNOISSUES,D).addPersonalValue(h.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDASSIGNEDCOMPLETED_TOTALNOISSUES,w).addPersonalValue(h.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDASSIGNEDORGCOMPLETED_TOTALNOISSUES,y).addPersonalValue(h.ISSUE3DREVIEW_FILTER.ISSUE3DREVIEW_FILTER_OWNEDASSIGNEDCOMPLETEDCOMBINED_TOTALNOISSUES,C).send()},fetchFilterValues:function(e){var t,n=e.filter,s=E.Availability.FALSE,i=E.Availability.FALSE,a=E.Availability.FALSE,o=E.Availability.FALSE,r=E.Availability.FALSE,d=E.Availability.FALSE,l=E.Availability.FALSE,c=0,u=0,m=0,p=0,g=0,I=0,S=0,h=0,f=0,A=0,v=0,D=0;return n.owned&&1==n.owned&&(s=E.Availability.TRUE),n.assigned&&1==n.assigned&&(i=E.Availability.TRUE),n.reported&&1==n.reported&&(a=E.Availability.TRUE),n.responsible&&1==n.responsible&&(o=E.Availability.TRUE),n.contributed&&1==n.contributed&&(r=E.Availability.TRUE),n.closed&&1==n.closed&&(d=E.Availability.TRUE),n.synchronize&&1==n.synchronize&&(l=E.Availability.TRUE,s=E.Availability.FALSE,i=E.Availability.FALSE,a=E.Availability.FALSE,o=E.Availability.FALSE,r=E.Availability.FALSE,d=E.Availability.FALSE),t=E.getDeviceUsedForOperation(),1!=n.owned||0!=n.assigned&&null!=n.assigned||0!=n.reported&&null!=n.reported||0!=n.responsible&&null!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?0!=n.owned&&null!=n.owned||1!=n.assigned||0!=n.reported&&null!=n.reported||0!=n.responsible&&null!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?0!=n.owned&&null!=n.owned||0!=n.assigned&&null!=n.assigned||1!=n.reported||0!=n.responsible&&null!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?0!=n.owned&&null!=n.owned||0!=n.assigned&&null!=n.assigned||0!=n.reported&&null!=n.reported||1!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?0!=n.owned&&null!=n.owned||0!=n.assigned&&null!=n.assigned||0!=n.reported&&null!=n.reported||0!=n.responsible&&null!=n.responsible||1!=n.contributed||0!=n.closed&&null!=n.closed?0!=n.owned&&null!=n.owned||0!=n.assigned&&null!=n.assigned||0!=n.reported&&null!=n.reported||0!=n.responsible&&null!=n.responsible||0!=n.contributed&&null!=n.contributed||1!=n.closed?1!=n.owned||1!=n.assigned||0!=n.reported&&null!=n.reported||0!=n.responsible&&null!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?0!=n.owned&&null!=n.owned||0!=n.assigned&&null!=n.assigned||1!=n.reported||1!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?1!=n.owned||1!=n.assigned||1!=n.reported||1!=n.responsible||0!=n.contributed&&null!=n.contributed||0!=n.closed&&null!=n.closed?1!=n.owned||1!=n.assigned||0!=n.reported&&null!=n.reported||0!=n.responsible&&null!=n.responsible||0!=n.contributed&&null!=n.contributed||1!=n.closed?0!=n.owned&&null!=n.owned||0!=n.assigned&&null!=n.assigned||1!=n.reported||1!=n.responsible||0!=n.contributed&&null!=n.contributed||1!=n.closed?1!=n.owned||1!=n.assigned||1!=n.reported||1!=n.responsible||0!=n.contributed&&null!=n.contributed||1!=n.closed||(D=e.noOfIssues):v=e.noOfIssues:A=e.noOfIssues:f=e.noOfIssues:h=e.noOfIssues:S=e.noOfIssues:I=e.noOfIssues:g=e.noOfIssues:m=e.noOfIssues:p=e.noOfIssues:u=e.noOfIssues:c=e.noOfIssues,{owned:s,assigned:i,reported:a,responsible:o,contributed:r,closed:d,synchronize:l,media:t,ownedCount:c,assignedCount:u,reportedCount:m,responsibleCount:p,contributedCount:g,closedCount:I,ownedAssigned:S,ownedAssignedOrg:h,ownedAssignedComb:f,ownedAssignedCompleted:A,ownedAssignedOrgCompleted:v,ownedAssignedCombCompleted:D}}}}}),define("DS/IssueCommon/commands/Templates",["UWA/Class","DS/ApplicationFrame/Command","DS/IssueCommon/utils/Utils","DS/IssueServices/Contexts"],function(e,t,n,s){"use strict";var i="PLMNewEnablement";return e.extend(t,{init:function(e){this._parent(e,{isAsynchronous:!0}),s.get(i)&&this.disable()},execute:function(){var e=this;!0!==e.utils.isAlreadyRunning()&&require(["DS/IssueComponents/templates/TemplatesDialog"],function(t){var n=s.get("widget")||window.widget;e.component=new t(n.body,{editMode:!0,onClose:function(){e.end()},onEnd:function(){}}),e.component.render()})},beginExecute:function(){if(!0!==this.utils.isAlreadyRunning()){var e=s.get("widget")||window.widget;n.Mask.mask(e.body)}},endExecute:function(){var e=s.get("widget")||window.widget;n.Mask.unmask(e.body)},utils:{isAlreadyRunning:function(){var e=s.get("widget")||window.widget;return null!==e.body.getElement(".create-template-chooser-dialog")||null!==e.body.getElement(".create-view-dialog")}}})}),define("DS/IssueCommon/commands/Create",["UWA/Core","UWA/Class","UWA/Class/Listener","UWA/Class/Promise","DS/ApplicationFrame/Command","DS/IssueCommon/utils/Utils","DS/IssueCommon/commands/CommandsManager","DS/IssueCommon/commands/CreateIssuePLMNew","DS/IssueServices/Contexts","DS/UIKIT/Mask"],function(e,t,n,s,i,a,o,r,d,l){"use strict";var c="ENXISSU_AP",u="ENX3DIR_AP",m="PLMNewEnablement";return t.extend(i,n,{mode:"",component:null,init:function(e){this._parent(e,{isAsynchronous:!0}),d.get(m)&&"CreateFromTemplate"==e.ID&&this.disable()},execute:function(){var e=this;if(!0===e.utils.isAlreadyRunning())return e._reset(),void e.end();var t=d.get("widget"),n=d.get("component");new s(function(s){t.name===u&&!0!==n.isDisplayed()?require(["DS/UIKIT/Mask"],function(i){i.mask(t.body),e.listenTo(n,"onDisplay",function(){e.stopListening(n,"onDisplay"),i.unmask(t.body),s()}),o.getCommandCheckHeader("Display").toggleState()}):s()}).then(function(){var t=e.getArguments();t&&t.length>0&&(e.mode=t[t.length-1].Value),void 0!==e.utils[e.mode]?e.utils[e.mode].apply(e):e.utils.IFB.apply(e)})},beginExecute:function(){if(!0!==this.utils.isAlreadyRunning()&&!this.utils.isPLMNew_Enabled()){var e=d.get("widget")||window.widget;a.Mask.mask(e.body)}},endExecute:function(){var e=d.get("widget")||window.widget;a.Mask.unmask(e.body),this.mode=null},_reset:function(){this.autoFillData=null,this.template=null,this.mode=null},utils:{isAlreadyRunning:function(){var e=d.get("widget")||window.widget;return null!==e.body.getElement(".create-template-chooser-dialog")||null!==e.body.getElement(".create-view-dialog")},isPLMNew_Enabled:function(){return d.get(m)},IFB:function(){var t=this;t.utils.isPLMNew_Enabled()?(new r({app:"ISU_3D"}).execute(),t.end()):require(["DS/IssueComponents/create/Create"],function(n){var i=d.get("widget")||window.widget,a=i.name===u;t.component=new n(i.body,{escapeToClose:!a,issueCreationType:t.mode}),t.component.render(),t.component.isLoaded.then(function(){var n=d.get("widget")||window.widget;if(n.name!==c&&n.name!==u||o.disableAll(),t.listenTo(t.component,"onCreateDialogClose",function(){var e=d.get("widget")||window.widget;t.stopListening(t.component,"onCreateDialogClose"),e.name!==c&&e.name!==u||o.enableAll()}),e.is(t.autoFillData,"object")){var i={id:"template-"+n.id+"-"+Date.now(),info:{description:null,name:null},ui:{},data:e.clone(t.autoFillData),hidden:{}};return t.component.applyTemplate(i)}return s.resolve()}).finally(function(){t._reset(),t.end()})})},_openCreateAndApplyTemplate:function(t){var n=this,s=d.get("widget")||window.widget,i=s.name===u,a=d.get("templateComponentDialog")?d.get("templateComponentDialog"):d.get("templateComponent");require(["DS/PADUtils/views/PADAlert","DS/IssueComponents/create/Create","i18n!DS/IssueCommon/assets/nls/IssueCommon"],function(r,m,p){if(null!==t&&null!=a){var g=new m(s.body,{escapeToClose:!i,issueCreationType:n.mode}),E=t.data;null==E&&((E={}).data={},E.info={}),a.updateDataPresentOnNode(t.physicalId,E).then(s=>{a.updateTemplateData(E).then(function(){g.render(),g.isLoaded.then(function(){var t=d.get("widget")||window.widget;t.name!==c&&t.name!==u||o.disableAll(),n.listenTo(g,"onCreateDialogClose",function(){var e=d.get("widget")||window.widget;n.stopListening(n.component,"onCreateDialogClose"),e.name!==c&&e.name!==u||o.enableAll()});var s=e.clone(E);e.is(n.autoFillData,"object")&&(s=e.extend(s,{data:e.clone(n.autoFillData)},!0));return g.applyTemplate(s)}).catch(function(e){g._logger.error(e),l.unmask(g.elements.dialog.getBody()),g.dispatchEvent("onCreateDialogClose"),g.elements.dialog.destroy(),g.destroy(),r.displayNotification({msg:p.replace(p.create.templateApplyError,{name:t.info.name}),eventID:"error"})}).finally(function(){n._reset(),n.end()})})}).catch(e=>{})}else n._reset(),n.end()})},IFT:function(){var t=this;if(e.is(t.template,"object")){var n=e.clone(t.template);t.utils._openCreateAndApplyTemplate.call(t,n)}else require(["DS/IssueComponents/templates/TemplatesDialog"],function(e){var n=d.get("widget")||window.widget;t.component=new e(n.body,{editMode:!1,onClose:function(){t._reset(),t.end()},onEnd:t.utils._openCreateAndApplyTemplate.bind(t)}),t.component.render()})}}})}),define("DS/IssueCommon/utils/ModelParser",["UWA/Core","DS/Logger/Logger","DS/IssueCommon/utils/Utils","DS/IssueServices/utils/Performance","DS/IssueServices/services/IssueServices","DS/IssueServices/Contexts","i18n!DS/IssueCommon/assets/nls/IssueCommon"],function(e,t,n,s,i,a,o){"use strict";var r={BASE_NLS:"ISU_TYPE_NLS",ISSUE_EXTENSIONS:"ISSUE_EXTENSIONS",NODE:{id:"",physicalId:"",type:"",name:"",title:"",baseType:"",organizationTitle:"",organization:"",collaborativeSpaceTitle:"",collaborativeSpace:"",actionTaken:"",actualEndDate:"",actualStartDate:"",validation:{activated:!1,fetched:!1,toString:{validation:function(){if(!0!==this.activated)return o.validationNone;if(!this.status)return o.validationLoading;var e="";switch(this.status){case"none":e=o.validationNone;break;case"loading":e=o.validationLoading;break;case"approved":e=o.validationApproved;break;case"rejected":e=o.validationRejected;break;case"inProgress":e=o.validationInProgress;break;case"notStarted":e=o.validationNotStarted;break;default:e=""}return e}}.validation},assignees:[],contributors:[],informedUsers:[],contexts:[],created:"",description:"",estimatedEndDate:"",estimatedStartDate:"",modified:"",originator:{},owner:{},coOwners:[],priority:"",isAffectedItemsIds:"",reportedAgainst:[],reportingOrganization:"",reportingOrganizationTitle:"",resolutionDate:"",resolutionRecommendation:"",resolutionStatement:"",resolvedBy:[],resolvedItems:[],responsibleOrganization:"",responsibleOrganizationTitle:"",revision:"",isLastRevision:"",state:"",completionType:"",waitingOn:"",iconurl:"",custom:{},escalationRequired:"",occurrence:"",library:"",libraries:"",completionType:""},MAPPING:{id:"",physicalId:"",isAffectedItemsIds:"",type:"ds6w:type",name:"ds6w:name",title:"ds6w:title",organizationTitle:"ds6w:organization",organization:"ds6w:organization",collaborativeSpaceTitle:"ds6w:collaborativeSpace",collaborativeSpace:"ds6w:collaborativeSpace",actionTaken:"ds6w:actionTaken",actualEndDate:"ds6w:actualEndDate",actualStartDate:"ds6w:actualStartDate",validation:"ds6w:validation",assignees:"ds6w:assignees",contributors:"ds6w:contributors",informedUsers:"ds6w:informedUsers",contexts:"ds6w:contexts",created:"ds6w:created",description:"ds6w:description",estimatedEndDate:"ds6w:estimatedEndDate",estimatedStartDate:"ds6w:estimatedStartDate",modified:"ds6w:modified",originator:"ds6w:originator",owner:"ds6w:owner",coOwners:"ds6w:coOwners",priority:"ds6w:priority",reportedAgainst:"ds6w:reportedAgainst",reportingOrganizationTitle:"ds6w:reportingOrganization",resolutionDate:"ds6w:resolutionDate",resolutionRecommendation:"ds6w:resolutionRecommendation",resolutionStatement:"ds6w:resolutionStatement",resolvedBy:"ds6w:resolvedBy",resolvedItems:"ds6w:resolvedItems",responsibleOrganizationTitle:"ds6w:responsibleOrganization",revision:"ds6w:revision",isLastRevision:"ds6w:isLastRevision",state:"ds6w:state",completionType:"ds6w:completionType",waitingOn:"ds6w:waitingOn",escalationRequired:"ds6w:escalationRequired",occurrence:"ds6w:occurrence",library:"LibraryClasses",libraries:"Library"},NO_VALIDATION:"Unassigned",VALIDATION:"Analyst"},d=function(t){var s=e.clone(r.NODE);for(var d in s.grid={},s.icons=[],r.NODE)r.NODE.hasOwnProperty(d)&&(s[d]=t[d]?t[d]:e.clone(r.NODE[d]));s.id=t.physicalId?t.physicalId:s.id,s.physicalId=s.id,s.grid.id=s.id,s.resourceid=s.id;var l=n.getIconByState(s.state,s.type,s.iconurl);for(var c in s.icons.push(l),r.MAPPING)switch(c){case"organization":""==s.organizationTitle&&(s.grid[r.MAPPING[c]]=s[c]);break;case"collaborativeSpace":""==s.collaborativeSpaceTitle&&(s.grid[r.MAPPING[c]]=s[c]);break;case"waitingOn":s.grid.Approvals="Unassigned"!==s[c]&&""!==s[c];break;default:s.grid[r.MAPPING[c]]=s[c]}var u=a.get(r.BASE_NLS);if(u&&u["ds6w:type"]&&Object.keys(u["ds6w:type"]).includes(s.type))s.grid["ds6w:type"]=u["ds6w:type"][s.type],s.grid.type=s.type,s.grid.typeNLS=u["ds6w:type"][s.type];else{var m={"ds6w:type":[s.type]};i.getNLSValuesPromise(m).then(t=>{e.is(t)&&e.is(t["ds6w:type"])&&e.is(t["ds6w:type"][s.type])&&(s.grid["ds6w:type"]=t["ds6w:type"][s.type],s.grid.type=s.type,s.grid.typeNLS=t["ds6w:type"][s.type])})}var p=a.get(r.ISSUE_EXTENSIONS);if(p){const e=[];for(const t of p){let n=t.replace("ds6w:","");n=t.replace("ds6wg:",""),e.push(n)}s.grid.interfaces=e}s.grid["ds6w:organization"]=""!=s.organizationTitle?s.organizationTitle:s.organization,s.grid["ds6w:reportingOrganization"]=""!=s.reportingOrganizationTitle?s.reportingOrganizationTitle:s.reportingOrganization,s.grid["ds6w:responsibleOrganization"]=""!=s.responsibleOrganizationTitle?s.responsibleOrganizationTitle:s.responsibleOrganization,s.label=s.display=""!==s.title?s.title:s.name,s.grid[r.MAPPING.assignees]=s.assignees.reduce(function(e,t){return e+t.fullName+", "},""),s.grid[r.MAPPING.assignees].length>0&&(s.grid[r.MAPPING.assignees]=s.grid[r.MAPPING.assignees].trim(),s.grid[r.MAPPING.assignees]=s.grid[r.MAPPING.assignees].substring(0,s.grid[r.MAPPING.assignees].length-1)),s.grid[r.MAPPING.contributors]=s.contributors.reduce(function(e,t){return e+t.fullName+", "},""),s.grid[r.MAPPING.contributors].length>0&&(s.grid[r.MAPPING.contributors]=s.grid[r.MAPPING.contributors].trim(),s.grid[r.MAPPING.contributors]=s.grid[r.MAPPING.contributors].substring(0,s.grid[r.MAPPING.contributors].length-1)),s.grid[r.MAPPING.informedUsers]=s.informedUsers.reduce(function(e,t){return e+t.fullName+", "},""),s.grid[r.MAPPING.informedUsers].length>0&&(s.grid[r.MAPPING.informedUsers]=s.grid[r.MAPPING.informedUsers].trim(),s.grid[r.MAPPING.informedUsers]=s.grid[r.MAPPING.informedUsers].substring(0,s.grid[r.MAPPING.informedUsers].length-1)),s.grid[r.MAPPING.coOwners]=s.coOwners.reduce(function(e,t){return e+t.fullName+", "},""),s.grid[r.MAPPING.coOwners].length>0&&(s.grid[r.MAPPING.coOwners]=s.grid[r.MAPPING.coOwners].trim(),s.grid[r.MAPPING.coOwners]=s.grid[r.MAPPING.coOwners].substring(0,s.grid[r.MAPPING.coOwners].length-1)),s.grid[r.MAPPING.contexts]=String(s.contexts.length),s.grid[r.MAPPING.originator]=s.originator.fullName?s.originator.fullName:"",s.grid[r.MAPPING.owner]=s.owner.fullName?s.owner.fullName:"",s.grid[r.MAPPING.priority]=o.priorities[s.priority.toLowerCase()],s.grid[r.MAPPING.reportedAgainst]=String(s.reportedAgainst.length),s.grid[r.MAPPING.resolvedBy]=String(s.resolvedBy.length),s.grid[r.MAPPING.resolvedItems]=String(s.resolvedItems.length);var g=a.get("maturityGraph");if(s.grid[r.MAPPING.state]=g?g[t.state]:o.maturity[s.state.toLowerCase()],"Issue Template"==t.policy){var E=a.get("templateMaturityGraph");s.grid[r.MAPPING.state]=E?E[t.state]:o.maturity[s.state.toLowerCase()],s.data=t.data}for(var I in s.waitingOn===r.VALIDATION&&(s.validation.activated=!0),s.custom)s.custom.hasOwnProperty(I)&&(s.grid[I]=s.custom[I]);if(Array.isArray(t.classification)?s.classification=t.classification:s.classification=t.classification?t.classification.split(""):[],Array.isArray(t.additionalPredicate))for(let e=0;e<t.additionalPredicate.length;e++){let n=Object.keys(t.additionalPredicate[e])[0],i=t.additionalPredicate[e][n];switch(n){case"ds6w:what/ds6w:libraries":s.grid[r.MAPPING.libraries]=i,s.libraries=i;break;case"ds6w:what/ds6w:library":s.grid[r.MAPPING.library]=i,s.library=i}}return s},l=function(t,n){var s=e.clone(r.NODE);s.grid={},s.icons=[];for(var i=t.attributes,a=0;a<i.length;a++){var o=i[a];if("Warning:Flattening"!==o.value&&"Warning:JPO"!==o.value)switch(e.is(o.name,"string")?o.name.replace("ds6w:what/","").replace("ds6w:when/","").replace("ds6w:who/",""):o.name){case"resourceid":null!=s.id&&""!=s.id||(s.id=o.value),s.physicalId=o.value;break;case"organization":s.organization=o.value,s.grid["ds6w:organization"]=o.dispValue;break;case"project":s.collaborativeSpace=o.value,s.grid["ds6w:collaborativeSpace"]=o.value;break;case"ds6w:project":s.collaborativeSpace=o.dispValue,s.grid["ds6w:collaborativeSpace"]=o.dispValue;break;case"ds6w:identifier":s.name=o.value;break;case"ds6w:label":s.title=o.value;break;case"ds6w:status":s.state=o.value,s.grid["ds6w:state"]=o.dispValue;break;case"ds6w:type":s.type=o.value,s.grid["ds6w:type"]=o.dispValue,s.grid.type=o.dispValue,s.grid.typeNLS=o.dispValue;break;case"ds6w:responsible":s.owner.fullName=o.value;break;case"owner":case"ds6w:responsibleUid":s.owner.user=o.value;break;case"type_icon_url":s.icons.push(o.value);break;case"ds6w:modified":s.modified=o.value;break;case"ds6w:created":s.created=o.value;break;case"ds6wg:revision":s.revision=o.value;break;case"ds6wg:PLMReference.V_isLastVersion":var d=o.value;d&&""!==d&&(s.isLastRevision="true"===d.toLowerCase());break;case"lastrevision":var l=o.value;""===s.isLastRevision&&l&&""!==l&&(s.isLastRevision="true"===l.toLowerCase());break;case"description":case"ds6w:description":s.description=o.value,s.grid["ds6w:description"]=o.value;break;case"ds6w:i3dx":""!=o.value&&(s.id=o.value);break;case"sourceid":s.serviceId=o.value;break;default:-1!==n.indexOf(o.name)&&(s.grid[o.name]=o.value)}}return s.resourceid=s.id,s.label=s.display=""!==s.title?s.title:s.name,s.grid["ds6w:owner"]=s.owner,s.grid["ds6w:modified"]=s.modified,s.grid["ds6w:created"]=s.created,s.grid["ds6w:revision"]=s.revision,s.grid["ds6w:isLastRevision"]=s.isLastRevision,s.grid["ds6w:originator"]=s.owner,s.originator=s.owner,s.grid.id=s.id,s};return{name:"DS/IssueCommon/utils/ModelParser",parse:function(e,t){var n=[];if(s.start(this.name+" parse"),t=t||{},Array.isArray(t.predicates)||(t.predicates=[]),Array.isArray(e))if(!0===t.useIndex)for(var i=0;i<e.length;i++)n.push(l(e[i],t.predicates));else for(var a=0;a<e.length;a++)n.push(d(e[a]));else n=!0===t.useIndex?l(e,t.predicates):d(e);return s.end(this.name+" parse"),n},update:function(e,t){e.context=t.context}}}),define("DS/IssueCommon/commands/ChangeAction",["UWA/Class","UWA/Core","DS/ApplicationFrame/Command","DS/Logger/Logger","DS/PADUtils/views/PADAlert","DS/PlatformAPI/PlatformAPI","DS/IssueCommon/utils/Utils","DS/IssueServices/Contexts","DS/IssueServices/services/IssueServices"],function(e,t,n,s,i,a,o,r,d){"use strict";var l={TREE_TYPE_RESOLVED_BY:"resolvedBy"},c="Issue";return e.extend(n,{init:function(e){this._logger=s.getLogger("DS/IssueCommon/components/IssueTreeListView"),this._parent(e)},execute:function(){var e=this,n=r.get("widget");o.Mask.mask(n.body),require(["DS/IssueAttachmentManager/services/AttachmentServices","DS/IssueCommon/utils/Selector","DS/ENOChgActionCMDs/scripts/CAActionBarController","DS/ENOChgActionCMDs/scripts/Commands/AddToNewCA","DS/IssueServices/services/PlatformServices"],function(s,i,a,r,d){var l=i.getSelection({type:"issue"});if(1===l.physicalIds.length){var c=l.physicalIds[l.physicalIds.length-1];s.getDocumentsFrom(c).then(function(e){var t=e.attachments,n=[];return t.forEach(function(e){n.push({id:e.id,type:e.type,service:"3dspace"})}),n}).then(function(s){var i=decodeURIComponent(d.getSecurityContext());a.initializeInfra().then(function(){a.clearObjects(),a.setSecurityContext(i);var u=d.getTenant();a.setTenant(u),a.setVersion("v1");var m=[];l.map[c].contexts.forEach(function(e){var t=e.type?e.type:e.objectType;m.push({id:e.physicalId,type:t,service:"3dspace"})}),a.addContext(m);var p=[];l.map[c].reportedAgainst.forEach(function(e){var t=e.type?e.type:e.objectType;p.push({id:e.physicalId,type:t,service:"3dspace"})}),a.addProposed(p),a.addReferential(s),a.addAssignee(l.map[c].assignees.filter(e=>"person"===e.type).map(e=>e.user)),a.addFollower([l.map[c].owner.user]),a.addTitle(l.map[c].title),a.addDescription(l.map[c].description),o.Mask.unmask(n.body),r.prototype.execute(function(n){t.is(n,"string")&&(n=JSON.parse(n));var s=n.changeaction.id.replace("pid:",""),i=d.getTenant(),a=n.changeaction.type;e.addAsResolvedBy(s,c,i,"3dspace",a)},function(){})})}).catch(function(e){if(o.Mask.unmask(n.body),e.internalError&&e.internalError.includes("ErrorCode:1500127")){var t=o.getErrorMessage("0");o.displayErrorMessage(t,"error")}})}})},addAsResolvedBy:function(e,t,n,s,u){var m=this,p=r.get("widget");o.Mask.mask(p.body);var g={physicalId:t};g[l.TREE_TYPE_RESOLVED_BY]=[{physicalId:e,envId:n,serviceId:s,objectType:u}],d.related.update({data:{objects:[g]}}).then(function(){var e=[],n={};e.push([t]),n[t]={id:t,type:c,modifiedAttributes:["resolvedBy"]};var s=r.get("widget");a.publish("DS/Object/update",{metadata:{appId:s.id,appName:s.name,timestamp:Math.floor(Date.now())},data:{paths:e,attributes:n},version:"1.0"}),o.Mask.unmask(s.body)},function(t){if(o.Mask.unmask(p.body),d.issues.delete({data:{objects:[{physicalId:e}]}}),m._logger.error(t),t.error.internal.includes("2005")){var n=o.getErrorMessage("2005");o.displayErrorMessage(n,"error")}else i.displayNotification({msg:t.error.message,eventID:"error"})})}})}),define("DS/IssueCommon/commands/Share",["UWA/Class","DS/ApplicationFrame/Command","DS/PADUtils/views/PADAlert","DS/IssueCommon/utils/Selector","DS/IssueCommon/utils/Utils","DS/IssueServices/services/PlatformServices","i18n!DS/IssueCommon/assets/nls/IssueCommon"],function(e,t,n,s,i,a,o){"use strict";var r=100;return e.extend(t,{init:function(e){this._parent(e)},execute:function(){var e=s.getSelection({type:"issue"}).physicalIds,t=s.getSelection({type:"issue"}).issueNames,a=i.computeSharedIssuesURL(e);i.copyTextToClipboard(a),e.length>=r?n.displayNotification({msg:o.replace(o.share.info,{number:r}),eventID:"info"}):1==t.length?n.displayNotification({msg:o.replace(o.share.successSingle,{name:t}),eventID:"success"}):n.displayNotification({msg:o.replace(o.share.successMultiple,{number:e.length}),eventID:"success"})}})});