define("DS/VCXWeb3DMaster/VCXModifiableOccurrenceComposer",["DS/CoreEvents/Events","DS/VCXWebExperienceBase/VCXModifiableOccurrenceExt","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebModifiables/VCXModelChangeListener","DS/VCXWebVisibility/VCXIVisibility","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueLink","DS/VCXWebProperties/VCXPropertyValueFloat","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXPropertyValueBoolean","DS/VCXWebProperties/VCXPropertyValueColor","DS/VCXWebSystem/VCXEnums","DS/VCXWebComponents/VCXWebComponentOccurrence","DS/Visualization/ThreeJS_DS","DS/VCXWebVisu/VCXVisuTools","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables","i18n!DS/VCXWeb3DMaster/assets/nls/VCXWeb3DMaster","DS/Visualization/IdPath"],function(e,t,r,i,a,n,o,s,l,p,c,h,u,d,g,y,D,C,P,M){"use strict";return t.extend({init:function(){this._parent(),this._requestedBOMID=null,this._requestedPartListID=null,this._requestedPartListEnabled=null,this._requestedPartListDescription=null},OnChangeProperty:function(e,t,r){if(r||(r={}),r.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if(r.fromChildClass=!0,!this._parent(e,t,r)){var i=null;switch(e){case"Actor.BomId":this._requestedBOMID=t.GetValue();break;case"Actor.PartList.ID":this._requestedPartListID=t.GetValue();break;case"Actor.PartList.Enabled":this._requestedPartListEnabled=t.GetValue();break;case"Actor.PartList.Description":this._requestedPartListDescription=t.GetValue();break;case"Actor.Env.Effect":this._requestedEnvEffect=t.GetValue();break;case"Actor.PLM.Material":this._requestedPLMMaterial=t.GetValue();break;default:if(!e.startsWith("Actor.Highlight."))return!1;var a=e.substring(16);(i=this.GetObject()).HighlightData||(i.HighlightData=i.DefaultHighlightData),i.HighlightData[a]=t.GetValue()}}return!0},OnChangePropertiesEnd:function(){this._parent();var e=this.GetObject();if(null!==this._requestedBOMID){if(e.bomID!==this._requestedBOMID)(t=e._experienceBase.getManager("VCXModelChangeListener"))&&t.hasChanged(a.FChangeFlag.BomID,!0),e.bomID=this._requestedBOMID;this._requestedBOMID=null}if(null!==this._requestedPartListID){if(e.PartListID!==this._requestedPartListID)(t=e._experienceBase.getManager("VCXModelChangeListener"))&&t.hasChanged(a.FChangeFlag.PartListID,!0),e.PartListID=this._requestedPartListID;this._requestedPartListID=null}if(null!==this._requestedPartListEnabled){if(e.PartListEnabled!==this._requestedPartListEnabled)(t=e._experienceBase.getManager("VCXModelChangeListener"))&&t.hasChanged(a.FChangeFlag.PartListEnabled,!0),e.PartListEnabled=this._requestedPartListEnabled;this._requestedPartListEnabled=null}if(null!==this._requestedPartListDescription){var t;if(e.PartListDescription!==this._requestedPartListDescription)(t=e._experienceBase.getManager("VCXModelChangeListener"))&&t.hasChanged(a.FChangeFlag.PartListDescription,!0),e.PartListDescription=this._requestedPartListDescription;this._requestedPartListDescription=null}if(void 0!==this._requestedEnvEffect&&(e._envID!==this._requestedEnvEffect&&(e._envID=this._requestedEnvEffect,e.setDirtyFlag(g.FDirty.Material|g.FDirty.EnvID)),e._envID!==d.EnvironmentalId.PLM&&(this._requestedPLMMaterial=null),delete this._requestedEnvEffect),void 0!==this._requestedPLMMaterial){e._envID!==d.EnvironmentalId.PLM&&(this._requestedPLMMaterial=null);var r=e._experienceBase.getManager("VCXCAT3DXModelManager");if(r){var i=this._requestedPLMMaterial,n=null;i&&(n=e._experienceBase.ComponentsMap.GetComponentFromID(i));let t=e._experienceBase.getManager("VCXLivePreviewRenderingManager");t&&t.ProcessEditing({variableName:"update_material_actor",arg:this.GetObject()}),r.ApplyMaterial(this.GetObject(),n,!1)}delete this._requestedPLMMaterial}if(e.IsMesh()||this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("FullFeaturesOnNodes")){var o=!1;e.getDirtyFlag(g.FDirty.Material)&&(e._dirtyMask|=g.FDirty.Color,e._dirtyMask|=g.FDirty.Alpha,o=!0),e.getDirtyFlag(g.FDirty.Color)&&e._textureDocID&&(e._dirtyMask|=g.FDirty.Material),e.getDirtyFlag(g.FDirty.Alpha)&&(null==e._visibilityAlpha&&null==e._alpha||(e._localAlpha=1,null!=e._visibilityAlpha&&(e._localAlpha*=e._visibilityAlpha),null!=e._alpha&&(e._localAlpha*=e._alpha)))}(e._dirtyMask||o)&&this.applyChanges()},applyChanges:function(){var t=this.GetObject(),r=t._experienceBase.getManager("VCXContextManager");if(t._dirtyMask){var i=(s=r.getActiveViewport())&&s.QueryInterface("VCXIModifiable").GetPropertyValue("Render.ChildrenStronger")||!1;if(t.getDirtyFlag(g.FDirty.Position)&&(t.setPosition(t.matrix),t.setDirtyFlag(g.FDirty.Position,!1)),t.getDirtyFlag(g.FDirty.Priority)&&(t.setRenderPriority(t.priority),t.setDirtyFlag(g.FDirty.Priority,!1)),t.getDirtyFlag(g.FDirty.LayerOpacity)&&(t.setRenderOpacity(t.layerOpacity),t.setDirtyFlag(g.FDirty.LayerOpacity,!1)),t.getDirtyFlag(g.FDirty.Alpha)&&(t.OverrideAlpha(t.localOpacityIsDefined?t.localAlpha*t.visibilityAlpha:1!==t.visibilityAlpha?t.visibilityAlpha:null,null,i),t.setDirtyFlag(g.FDirty.Alpha,!1)),t.getDirtyFlag(g.FDirty.Highlight)){if(!t.HighlightData||!t.HighlightData.Enabled)if(t._highlightSet)(n=t._experienceBase.getManager("VCXContextManager").getMainViewer()).removeHighlightSet(t._highlightSet),delete t._highlightSet;if(t.HighlightData&&t.HighlightData.Enabled){var a=t.QueryInterface("W3AISGNodeHolder").getPathElement(),n=t._experienceBase.getManager("VCXContextManager").getMainViewer();t.HighlightData||(t.HighlightData=t.DefaultHighlightData);var o=t.HighlightData.polite?new y.AdvancedPoliteHighlightData(t.HighlightData):new y.HaloHighlightData(t.HighlightData);t._highlightSet||(t._highlightSet=n.createHighlightSet(o,!1,t.HighlightData.polite,!0),t._highlightSet.add(a,{highlightColor:o},!0)),t._highlightSet.setHighlightData(t.HighlightData.polite,o)}}if((t.getDirtyFlag(g.FDirty.Color)||t.getDirtyFlag(g.FDirty.Material))&&(t.UpdateLocalMaterial(),t.OverrideMaterial(t.localMaterial,null,null,i),t.setDirtyFlag(g.FDirty.Color,!1),t.setDirtyFlag(g.FDirty.Material,!1)),t.getDirtyFlag(g.FDirty.RenderingMode)){var s,l=t.renderingMode;if(s=t._experienceBase.getManager("VCXVisuManager").getActiveViewport()){var p=s.QueryInterface("VCXIModifiable").GetPropertyValue("Render.Mode"),c=s.QueryInterface("VCXIModifiable").GetPropertyValue("Render.ShowConstructions");p!==g.ERenderingMode.Custom&&(l=p)}t.OverrideRenderingMode(l,null,i,c),t.setDirtyFlag(g.FDirty.RenderingMode,!1)}t.getDirtyFlag(g.FDirty.Visibility)&&(t.OverrideVisibility(t.localVisibility,null,i),t.setDirtyFlag(g.FDirty.Visibility,!1)),e.publish({event:"VCX_PROPERTIES_CHANGED",data:{component:t,dirtyFlag:t._dirtyMask}})}},GetProperty:function(e){var t=null,a=this.GetObject();a._experienceBase.getManager("VCXContextManager");let n,d;switch(e){case"Actor.Opacity":if(this.GetObject().localOpacityIsDefined)return this._parent(e);(n=new l).SetValue(1),(d=new i(e,0,!0,C)).SetBounds(0,1,.1),d.SetDefined(!1),t=new r(d,n);break;case"Actor.BomId":n=new o(this.GetObject().bomID),t=new r(new i(e,0,!0,P),n);break;case"Actor.Env.Effect":(d=new p(e,0,!0,P)).Seti18nGroup(C),d.SetGroupId("Group.Appearance"),d.SetVisible(!1),n=new c(a._envID),t=new r(d,n);break;case"Actor.PartList.ID":(d=new i(e,2,!0,P)).Seti18nGroup(C),d.SetGroupId("Group.PartList"),n=new o(a.PartListID),t=new r(d,n);break;case"Actor.PartList.Description":(d=new i(e,2,!0,P)).Seti18nGroup(C),d.SetGroupId("Group.PartList"),n=new o(a.PartListDescription),t=new r(d,n);break;case"Actor.PartList.Enabled":(d=new i(e,0,!0,P)).Seti18nGroup(C),d.SetGroupId("Group.PartList"),d.SetControlsGroupVisibility(!0),n=new h(a.PartListEnabled),t=new r(d,n);break;case"Actor.PLM.Material":var g=a.PLMMaterialID||"";n=new s(g),(d=new i(e,0,!0,C)).SetGroupId("Group.Appearance"),d.SetVisible(!1),t=new r(d,n);break;case"Actor.Thumbnail.URL":this.GetObject()._thumbURL&&(n=new o(this.GetObject()._thumbURL),t=new r(new i(e,0,!0,P),n));break;case"Actor.Prop.Area":(n=new l).SetValue(a._area),(d=new i(e,0,!0,P)).Seti18nGroup(C),d.SetGroupId("Group.Geometry"),t=new r(d,n);break;case"Actor.Prop.Volume":(n=new l).SetValue(a._volume),(d=new i(e,0,!0,P)).Seti18nGroup(C),d.SetGroupId("Group.Geometry"),t=new r(d,n);break;case"Actor.Color.CAD":var y=D.buildGraphicPropertiesStructure(a,null,{getColor:!0});(n=new u).SetValue(y&&y[0].visible&&y[0].visible.ComputedColor),(d=new i(e,0,!1,P)).Seti18nGroup(C),d.SetGroupId("Group.Appearance"),t=new r(d,n);break;case"Actor.Material.CAD":(n=new o).SetValue(a._MaterialDescription&&a._MaterialDescription.Name),(d=new i(e,0,!1,P)).Seti18nGroup(C),d.SetGroupId("Group.Appearance"),t=new r(d,n);break;default:if(e.startsWith("Actor.Highlight.")){var M=e.substring(16);switch((d=new i(e,0,!0,P)).Seti18nGroup(C),d.SetGroupId("Group.Highlight"),M){case"Enabled":d.SetControlsGroupVisibility(!0),n=new h;break;case"colorEnabled":case"haloEnabled":case"outlineEnabled":case"polite":d.SetControlsGroupVisibility(!0),n=new h;break;case"color":case"haloColor":case"lineicHaloColor":case"outlineColor":case"lineicOutlineColor":n=new u;break;case"intensity":n=new l;break;case"haloIntensity":n=new l,d.SetBounds(0,8,.1);break;case"visibleAlpha":case"occludedAlpha":case"outlineAlpha":case"lineicOutlineAlpha":n=new l,d.SetBounds(0,1,.1);break;case"haloThickness":n=new l,d.SetBounds(0,4,.1);break;case"outlineThickness":n=new l,d.SetBounds(0,16,.1)}a.HighlightData||(a.HighlightData=a.DefaultHighlightData),n.SetValue(a.HighlightData[M]),t=new r(d,n)}else t=this._parent(e)}return t},RequestModification:async function(e,t){if(e){var i=e.GetPropertyInfo().GetPropertyName();if("Actor.Highlight.color"===i){let i=new p("Actor.Highlight.haloColor",0,!0,P);return t.AddOrModifyProperty(this.GetHashing(),new r(i,e.GetPropertyValue().Clone())),i=new p("Actor.Highlight.outlineColor",0,!0,P),t.AddOrModifyProperty(this.GetHashing(),new r(i,e.GetPropertyValue().Clone())),t.AddOrModifyProperty(this.GetHashing(),e),t}if("Actor.PLM.Material.Choice"===i){let i=this.GetObject();var a=e.GetPropertyValue().Value,n=a>=d.EnvironmentalId.PLM,l=new p("Actor.Env.Effect",0,!0,P),h=new c(n?d.EnvironmentalId.PLM:a);t.AddOrModifyProperty(this.GetHashing(),new r(l,h));let o=i._experienceBase.getManager("VCXMaterialManager").getMaterialsPLM();if(o.length<=a-(d.EnvironmentalId.PLM+1))return this._parent(e,t);{let e=0===a?null:o[a-(d.EnvironmentalId.PLM+1)],n=i.originalMaterial&&i._experienceBase.ComponentsMap.GetComponentFromID(i.originalMaterial),l=new s;null===e&&0===a||n===e.QueryInterface("VCXIMaterialCache").GetInternalMaterial()?l.SetValue(""):e&&l.SetValue(await e.QueryInterface("VCXIMaterialCache").GetExternalID());let p=this.GetProperty("Actor.PLM.Material").GetPropertyInfo();return t.AddOrModifyProperty(this.GetHashing(),new r(p,l)),t}}if("Actor.PartList.Enabled"===i&&e.GetPropertyValue().Value){var u=this.GetObject()._experienceBase.getManager("VCXComponentPartListManager");u&&(u.turnOnPartListVisibility=!0);var g=this.GetObject();if(""===g.PartListID){var y=g._refid,D=1,C=1,M=g._experienceBase.getManager("VCXContextManager").getRootComponent();if(M){var b=M.QueryInterface("VCXIModelNavigable");b&&b.traverse(function(e,t,r){e.GetObject().IsKindOf("VCXComponentOccurrenceComposer")&&(C=parseInt(e.GetObject().PartListID),void 0===y&&""===y||y!==e.GetObject()._refid?C>=parseInt(D)&&(D=C+1):C>=1&&(D=C,r.stop=!0))},null,{})}g.PartListID=D.toString();var f=g.PartListDescription;""===f&&(""===(f=this.GetProperty("Actor.Name.ReferenceTitle")&&this.GetProperty("Actor.Name.ReferenceTitle").GetPropertyValue().Value)&&(f=this.GetProperty("Actor.Name")&&this.GetProperty("Actor.Name").GetPropertyValue().Value),g.PartListDescription=f);let i=this.GetProperty("Actor.PartList.ID").GetPropertyInfo(),a=new o(g.PartListID),n=this.GetProperty("Actor.PartList.Description").GetPropertyInfo(),s=new o(g.PartListDescription);return this._parent(e,t),t.AddOrModifyProperty(this.GetHashing(),new r(i,a)),t.AddOrModifyProperty(this.GetHashing(),new r(n,s)),t}}}return this._parent(e,t)},Dispose:function(){const e=this.GetObject();e._highlightSet&&(e._highlightSet.clearAll(),e._experienceBase.getManager("VCXContextManager").getMainViewer().removeHighlightSet(e._highlightSet),delete e._highlightSet);return this._parent()},GetProperties:function(){var e=this._parent();return(this.GetObject().IsMesh()||this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("FullFeaturesOnNodes"))&&(e.AddOrModifyProperty(this.GetProperty("Actor.Env.Effect")),e.AddOrModifyProperty(this.GetProperty("Actor.PLM.Material"))),e.AddOrModifyProperty(this.GetProperty("Actor.PartList.Enabled")),e.AddOrModifyProperty(this.GetProperty("Actor.PartList.ID")),e.AddOrModifyProperty(this.GetProperty("Actor.PartList.Description")),e.AddOrModifyProperty(this.GetProperty("Actor.Thumbnail.URL")),e},IsLiving:function(){var e=this.QueryInterface("VCXIVisibility");return!e||e.GetVisibility()!==n.EVisState.Hidden}})}),define("DS/VCXWeb3DMaster/VCXModifiableViewOccurrenceComposer",["DS/VCXWebExperienceBase/VCXModifiableViewOccurrenceExt","DS/VCXWebVisu/VCXVisuTools","DS/VCXWebProperties/VCXPropertyGroup","DS/VCXWebPlatform/VCXSearchServices","i18n!DS/VCXWebModifiables/assets/nls/VCXWebModifiables","i18n!DS/VCXWeb3DMaster/assets/nls/VCXWeb3DMaster"],function(e,t,r,i,a,n){"use strict";return e.extend({init:function(){this._parent()},getPropertyGroups:function(e){e||(e={});var t=this.getGroupPropertiesOrders();(this._parent(e),e["Group.Essentials"]||(e["Group.Essentials"]=new r({groupID:"Group.Essentials"}),e["Group.Essentials"].i18nGroup=a),e["Group.Essentials"].priority=0,e["Group.Essentials"].removeProperty,e["Group.Essentials"].addProperties([{propertyName:"Actor.Name",i18n:a},{propertyName:"Actor.Opacity",i18n:a}]),this.GetObject().IsMesh()||this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("FullFeaturesOnNodes"))&&(this.GetObject()._experienceBase.getManager("VCXContextManager").getProdHighMode()&&e["Group.Essentials"].addProperties([{propertyName:"Actor.Position",i18n:a,hiddenFields:["Orientation","Pivot"]}]),e["Group.Appearance"]||(e["Group.Appearance"]=new r({groupID:"Group.Appearance"})),e["Group.Appearance"].priority=10,e["Group.Appearance"].i18nGroup=a,e["Group.Appearance"].setPropertiesOrder(t["Group.Appearance"]),e["Group.Appearance"].addProperties([{propertyName:"Actor.PLM.Material.Choice",i18n:n}]),e["Group.Highlight"]||(e["Group.Highlight"]=new r({groupID:"Group.Highlight"}),e["Group.Highlight"].visibility=!0,e["Group.Highlight"].PropertyControlingGroupVisibility="Actor.Highlight.Enabled"),e["Group.Highlight"].priority=10,e["Group.Highlight"].i18nGroup=a,e["Group.Highlight"].setPropertiesOrder(t["Group.Highlight"]),e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.Enabled",i18n:a}]),(i=this.QueryInterface("VCXIModifiable"))&&i.GetProperty("Actor.Highlight.Enabled")&&i.GetProperty("Actor.Highlight.Enabled").GetPropertyValue().Value&&(e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.color",i18n:a}]),e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.haloEnabled",i18n:a}]),i.GetProperty("Actor.Highlight.haloEnabled").GetPropertyValue().Value&&(e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.haloIntensity",i18n:a},{propertyName:"Actor.Highlight.haloThickness",i18n:a}]),i.GetProperty("Actor.Highlight.polite").GetPropertyValue().Value&&e["Group.Highlight"].addProperties([])),e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.colorEnabled",i18n:a}]),i.GetProperty("Actor.Highlight.colorEnabled").GetPropertyValue().Value&&(i.GetProperty("Actor.Highlight.polite").GetPropertyValue().Value?e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.visibleAlpha",i18n:a}]):e["Group.Highlight"].addProperties([{propertyName:"Actor.Highlight.intensity",i18n:a}]))));if(this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("PartList")){e["Group.PartList"]||(e["Group.PartList"]=new r({groupID:"Group.PartList"}),e["Group.PartList"].visibility=!0,e["Group.PartList"].PropertyControlingGroupVisibility="Actor.PartList.Enabled"),e["Group.PartList"].priority=300,e["Group.PartList"].i18nGroup=n,e["Group.PartList"].setPropertiesOrder(t["Group.PartList"]),e["Group.PartList"].addProperties([{propertyName:"Actor.PartList.Enabled",i18n:n}]);var i=this.QueryInterface("VCXIModifiable");e["Group.PartList"].addProperties([{propertyName:"Actor.PartList.ID",i18n:n}]),e["Group.PartList"].addProperties([{propertyName:"Actor.PartList.Description",i18n:n}])}return this.GetObject()._experienceBase.ModifiablesAdvancedProperties&&(e["Group.Introspection"]||(e["Group.Introspection"]=new r({groupID:"Group.Introspection"}),e["Group.Introspection"].i18nGroup=a),e["Group.Introspection"].priority=200,e["Group.Introspection"].addProperty({propertyName:"Actor.3DReference",i18n:a})),e},_pushAdditionalPropertyButton:function(e,t,r){e[t]||(e[t]={}),e[t].buttons||(e[t].buttons=[]),e[t].buttons.push(r)},getAdditionalPropertySettings:function(e){let r=this._parent()||{};var a=this.QueryInterface("VCXIModifiable");let n=this.GetObject()._experienceBase.getManager("VCXScenarioManager"),o=this.GetObject()._experienceBase.getManager("VCXSelectionManager");if(this._pushAdditionalPropertyButton(r,"Actor.PartList.ID",{type:"Clear",tooltip:"Clear value",data:{object:e||o.GetComponentsFromCurrentSelection(),propertiesToClear:["Actor.PartList.ID"]},available:!0}),r["Actor.PartList.ID"].overridePropertyList=["Actor.PartList.ID"],this._pushAdditionalPropertyButton(r,"Actor.PartList.Description",{type:"Clear",tooltip:"Clear value",data:{object:e||o.GetComponentsFromCurrentSelection(),propertiesToClear:["Actor.PartList.Description"]},available:!0}),r["Actor.PartList.Description"].overridePropertyList=["Actor.PartList.Description"],a.GetProperty("Actor.Opacity.Defined")&&a.GetProperty("Actor.Opacity.Defined").GetPropertyValue()){let e=!1,t=["Actor.Opacity","Actor.Opacity.Defined"];for(let r=0;r<t.length;r++)if(n.IsCurrentPropertyDifferentFromNeutral(a,t[r])){e=!0;break}this._pushAdditionalPropertyButton(r,"Actor.Opacity",{type:"Restore",data:{object:this.GetObject(),propertiesToRestore:t},tooltip:"Restore default opacity",available:!0,buttonDisabled:!e})}else r["Actor.Opacity"]={};r["Actor.Opacity"].overridePropertyList=["Actor.Opacity","Actor.Opacity.Defined"],r["Actor.PLM.Material.Choice"]={overridePropertyList:["Actor.Env.Effect","Actor.PLM.Material"],disableLiveChange:500};let s=!1,l=["Actor.Env.Effect","Actor.PLM.Material"];for(let e=0;e<l.length;e++)if(n.IsCurrentPropertyDifferentFromNeutral(a,l[e])){s=!0;break}this._pushAdditionalPropertyButton(r,"Actor.PLM.Material.Choice",{type:"Restore",data:{object:this.GetObject(),propertiesToRestore:l},tooltip:"Restore default material",available:!0,buttonDisabled:!s}),this._pushAdditionalPropertyButton(r,"Actor.PLM.Material.Choice",{functionCB:function(e){e&&e.data&&e.data.object&&i.SearchInApp("[ds6w:type]:dsc_matref_ref_Covering",void 0).then(function(t){if(t&&t.id&&t.label)return e.data.object._experienceBase.getManager("VCXCAT3DXModelManager").InsertMaterial(t.label,null,t.id,[e.data.object])})},type:"materialAdd",iconName:"material-add",tooltip:"Add a new material to the list",location:3,data:{object:this.GetObject()},available:!0});for(var p,c,h=t.buildGraphicPropertiesStructure(this,null,{getColor:!0,getMaterial:!0,getOpacity:!0}),u=!1,d=1;d<h.length;d++)h&&h[d].override&&(!c&&h[d].override.Material&&(c=h[d].object),!p&&h[d].override.Opacity&&(p=h[d].object)),h&&h[d].cad&&h[d].cad.material&&(u=!0);return u&&(r["Actor.PLM.Material.Choice"].showUndefined=!0),c&&this._pushAdditionalPropertyButton(r,"Actor.PLM.Material.Choice",{type:"NavigateTo",data:{objectToNavigateTo:c},available:!0}),p&&this._pushAdditionalPropertyButton(r,"Actor.Opacity",{type:"NavigateTo",data:{objectToNavigateTo:p},available:!0}),r},getGroupPropertiesOrders:function(){var e={"Group.Appearance":["Actor.Color","Actor.Color.Defined"],"Group.Highlight":[],"Group.PartList":["Actor.PartList.ID","Actor.PartList.Description"]},t=this._parent()||{};for(const r in e)t[r]=e[r];return t}})}),define("DS/VCXWeb3DMaster/CXPRenderingFeature_Spec",["require","exports","DS/VCXWebComponents/VCXWebComponentOccurrence"],function(e,t,r){"use strict";class i extends r{}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"CXPRenderingFeature_Spec"}}),i}),define("DS/VCXWeb3DMaster/VCXNavigableAssetOccurrenceComposer",["DS/WebApplicationBase/VCXAModelNavigable"],function(e){"use strict";return e.extend({getAssetNavigable:function(){return this}})}),define("DS/VCXWeb3DMaster/VCXSGNodeHolderAssetOccurrenceComposer",["DS/WebApplicationBase/W3AASGNodeHolder","DS/Visualization/Node3D"],function(e,t){"use strict";return e.extend({init:function(){},buildSGNode:function(){if(!this._sgNode){this._sgNode=new t({name:"LoadedAsset"}),this._sgNode.productType="Instance3D"}var e=this.QueryInterface("VCXIModelNavigable");if(e){var r=e.getParent();if(r){var i=r.QueryInterface("W3AISGNodeHolder");i&&(i.getSGNode().addChild(this._sgNode),this._pathElement=i.getPathElement().clone(),this._pathElement.addElement(this._sgNode))}}return this._sgNode},isSelfManagedPathElement:function(){return!0}})});var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWeb3DMaster/VCXComponentOccurrenceComposer",["require","exports","DS/VCXWebSystem/VCXEnums","DS/Visualization/IdPath","DS/Visualization/SceneGraphUtils","DS/SceneGraphOverrides/GenericOverride","DS/Visualization/PrimitiveIterator","DS/Visualization/ThreeJS_DS","DS/Visualization/OccurrenceExplorer","DS/Visualization/MaterialApplication","DS/VCXWebExperienceBase/VCXComponentOccurrenceExt","DS/VCXWebComponents/VCXWebComponentOccurrence"],function(e,t,r,i,a,n,o,s,l,p,c,h){"use strict";c=__importDefault(c),(h=__importDefault(h)).default.addDirtyFlags(["EnvID","TextureDocID","TextureProjectionType","TextureProjectionMatrix","TextureUVMatrix","TextureUVscale","TextureUVratio","TextureBlending","TextureTransparency","TextureBorderMode","Geometry"]);class u extends c.default{constructor(){super(),this._bomID="",this._PartListEnabled=!1,this._PartListID="",this._PartListDescription="",this._isRenderable=!1,this._isMesh=!1,this._envID=r.EnvironmentalId.None,this._area=-1,this._volume=-1,this.PLMMaterialID=null}IsRenderable(){return this._isRenderable}IsMesh(){return this._isMesh}SetIsRenderable(e){this._isRenderable=e}SetIsMesh(e){this._isMesh=e,e&&(this._isRenderable=!0)}getSharedSceneGraphOverride(e=null,t=!0){var r=e;if(!e){var a=this.QueryInterface("W3AISGNodeHolder");r=(r=null==a?void 0:a.getPathOfIDs())?new i(["rootBag",...r.ids]):null==a?void 0:a.getPathElement()}return this._experienceBase.getManager("VCXContextManager").getSharedSceneGraphOverride(r,t)}getMaterial(){var e=this.getSharedSceneGraphOverride();return e?e._values.fullMaterial&&void 0!==e._values.fullMaterial?e._values.fullMaterial:e.getMaterial():null}setMaterial(e,t=null){var r=this.getSharedSceneGraphOverride(null,!0);r&&r.setMaterial(e,t)}getColor(){var e=this.getSharedSceneGraphOverride();return e?e.getColor():null}setColor(e,t=null){var r=this.getSharedSceneGraphOverride(null,!0);r&&r.setColor(e,t)}getOpacity(){var e=this.getSharedSceneGraphOverride();return e?e.getOpacity():null}setOpacity(e,t=null){var r=this.getSharedSceneGraphOverride(null,!0);r&&r.setOpacity(e,t)}getVisibility(){var e=this.getSharedSceneGraphOverride();return e?e.getVisibility():null}setVisibility(e,t=null){var r=this.getSharedSceneGraphOverride(null,!0);r&&r.setVisibility(e,t),this._experienceBase.getManager("VCXContextManager").partHasMoved=!0}setPickability(e){var t=this.getSharedSceneGraphOverride(null,!0);t&&t.setPickability(e)}setPosition(e){var t=this.getSharedSceneGraphOverride(null,!0);t&&t.setPosition(e),this._experienceBase.getManager("VCXContextManager").partHasMoved=!0;let r=this._experienceBase.getManager("VCXLivePreviewRenderingManager");r&&r.ProcessEditing({variableName:"update_varpos_actor",arg:this})}getPosition(){var e=this._experienceBase.getManager("VCXContextManager"),t=this.QueryInterface("W3AISGNodeHolder");if(t)return t.getMatrix(e.getMainViewer());console.error("We shouldn't be here");var r=this.getSharedSceneGraphOverride();return r?r.getPosition():null}getRenderPriority(){return this._priority}setRenderPriority(e,t=null){this._priority=e;var r=this._experienceBase.getManager("VCXContextManager"),i=this.QueryInterface("W3AISGNodeHolder");i&&r&&a.setRenderPriority&&a.setRenderPriority(i.getPathElement(),this._priority,r.getMainViewer())}getRenderOpacity(){return this._layerOpacity}setRenderOpacity(e,t=null){this._layerOpacity=e;var r=this._experienceBase.getManager("VCXContextManager"),i=this.QueryInterface("W3AISGNodeHolder");i&&r&&a.setRenderPriorityOpacity&&a.setRenderPriorityOpacity(i.getPathElement(),this._layerOpacity,r.getMainViewer())}HasMaterialOverrideToApply(){return!!this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("FullFeaturesOnNodes")||!!this.IsMesh()&&(this.PLMMaterialID&&this._envID===r.EnvironmentalId.PLM||this._envID||this.renderingMode>2)}HasColorOverrideToApply(){if(this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("FullFeaturesOnNodes"))return this.localColorIsDefined;if(!this.IsMesh())return!0;var e=!1;switch(this._envID){case r.EnvironmentalId.PLM:e=!1;break;case r.EnvironmentalId.None:e=!0;break;default:e=!1}return e}HasOpacityOverrideToApply(){return!0}UpdateLocalMaterial(){(this.IsMesh()||this.GetObject()._experienceBase.getManager("VCXContextManager").isSupported("FullFeaturesOnNodes"))&&(!1===this.HasMaterialOverrideToApply()?this._localMaterial=null:this._localMaterial=this._PLMMaterial,this._dirtyMask&=~u.maskMaterialParamsDirty)}OverrideAlpha(e,t,r){var i=this.getSharedSceneGraphOverride(t,!0);i&&i.setOpacity(this.HasOpacityOverrideToApply()?e:null,r)}OverrideVisibility(e,t,r){var i=this.getSharedSceneGraphOverride(t,!0);i&&i.setVisibility(e,r),this._experienceBase.getManager("VCXContextManager").partHasMoved=!0}OverrideColor(e,t,r){if(this.HasColorOverrideToApply()){var i=this.getSharedSceneGraphOverride(t,!0);i&&(e?i.setColor(e,r):i.resetColor())}}OverrideMaterial(e,t,r,i){var a=this.getSharedSceneGraphOverride(r,!0);if(a){var o=this.HasMaterialOverrideToApply()?e:null;if(o?a.setMaterial(new p({faceMaterial:o}),i):a.setMaterial(null,i),this.HasColorOverrideToApply()){var s=null;t?s=t:this.localColor&&(!0===this.localColorIsDefined||this.HasMaterialOverrideToApply()&&e)&&(s=this.localColor),a.setColor(s,i)}else o?a.setColor(n.NO_COLOR,i):a.setColor(null,i)}}GetCurrentMaterial(){return this.PLMMaterialID?this._experienceBase.ComponentsMap.GetComponentFromID(this.PLMMaterialID):this.originalMaterial?this._experienceBase.ComponentsMap.GetComponentFromID(this.originalMaterial):null}OverrideRenderingMode(e,t,r,i){var a=this.getSharedSceneGraphOverride(t,!0);if(a){var n=this._experienceBase.getManager("VCXMaterialManager");if(n){var o=null;switch(e){case h.default.ERenderingMode.Custom:o=n.getRenderStyle(this.renderingMode,h.default.EOutlineType.Smart,i);break;case h.default.ERenderingMode.SmoothOutline:case h.default.ERenderingMode.Technical:case h.default.ERenderingMode.FlatTechnical:case h.default.ERenderingMode.Silhouette:var s=2,l=this._experienceBase.getManager("VCXVisuManager").getActiveViewport();l&&(s=l.QueryInterface("VCXIModifiable").GetPropertyValue("Render.OutlineType")),o=n.getRenderStyle(e,s,i)}a.setRenderStyle(o,r)}}}debugVisu(){function e(e,t){var r,i,a,n,s=o._authorizedTeamsOnly_getKey();for(r=e.getMesh3D(),n=t.getLastElement(!0)===r?t:r,i=new o(n,s),a=0;a<i.getNbPrimitives();a++)console.log(i.getGas(a)._alpha);return[]}var t=this._experienceBase.getManager("VCXContextManager"),r=new l(t.getMainViewer()),i=this.QueryInterface("W3AISGNodeHolder"),a=null==i?void 0:i.getPathElement();r.explore(function(t){var r,i,n=(i=t.getOccurrenceItf(a)).getRenderableDescendants();for(r=0;r<n.length;r++)(i=n[r]).getVisibility()&&e(i,a)})}get bomID(){return this._bomID}set bomID(e){this._bomID=e}get PartListDescription(){return this._PartListDescription}set PartListDescription(e){this._PartListDescription=e}get PartListID(){return this._PartListID}set PartListID(e){this._PartListID=e}get PartListEnabled(){return this._PartListEnabled}set PartListEnabled(e){this._PartListEnabled=e}get DefaultHighlightData(){return{Enabled:!1,polite:!0,priority:-1,colorEnabled:!0,color:new s.Color(16703488),intensity:1,visibleAlpha:.6,occludedAlpha:.15,haloEnabled:!0,haloColor:new s.Color(16703488),lineicHaloColor:new s.Color(16703488),haloIntensity:2,haloThickness:4,outlineEnabled:!1,outlineColor:new s.Color(16703488),lineicOutlineColor:new s.Color(16703488),outlineAlpha:1,outlineThickness:1}}get HighlightData(){return this._highlightData}set HighlightData(e){let t=this.QueryInterface("VCXIModelNavigable"),r=0;for(;t;)t=t.getParent(),r++;e.priority=-r,this._highlightData=e,this._dirtyMask|=h.default.FDirty.Highlight}get PLMMaterial(){return this._PLMMaterial}set PLMMaterial(e){this._PLMMaterial=e,this._dirtyMask|=h.default.FDirty.Material|h.default.FDirty.Color|h.default.FDirty.Alpha}}return u.mask=h.default.FDirty.Alpha|h.default.FDirty.Color|h.default.FDirty.Material|h.default.FDirty.Visibility|h.default.FDirty.RenderingMode,u.maskMaterialParamsDirty=h.default.FDirty.TextureDocID|h.default.FDirty.TextureProjectionType|h.default.FDirty.TextureProjectionMatrix|h.default.FDirty.TextureUVMatrix|h.default.FDirty.TextureUVscale|h.default.FDirty.TextureUVratio|h.default.FDirty.TextureBlending|h.default.FDirty.TextureTransparency|h.default.FDirty.TextureBorderMode,Object.defineProperty(u.prototype,"componentType",{enumerable:!0,get:()=>"VCXComponentOccurrenceComposer"}),u});__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWeb3DMaster/VCXComponentAssetOccurrenceComposer",["require","exports","DS/VCXWeb3DMaster/VCXComponentOccurrenceComposer"],function(e,t,r){"use strict";r=__importDefault(r);class i extends r.default{constructor(){super(),this._nodeID=null,this._assetID=null,this._eType=0,this._bIsLoaded=!1}SetAssetID(e){this._assetID=e}GetAssetID(){return this._assetID}SetNodeID(e){this._nodeID=e}GetNodeID(){return this._nodeID}SetAssetType(e){this._eType=e}GetAssetType(){return this._eType}SetIsLoaded(e){this._bIsLoaded=e}IsLoaded(){return this._bIsLoaded}}return Object.defineProperty(i.prototype,"componentType",{enumerable:!0,get:function(){return"VCXComponentAssetOccurrenceComposer"}}),i});__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};define("DS/VCXWeb3DMaster/VCXVolatileComponentOccurrenceComposer",["require","exports","DS/CoreEvents/Events","DS/VCXWeb3DMaster/VCXComponentOccurrenceComposer","DS/WebComponentModeler/WebComponentBase"],function(e,t,r,i,a){"use strict";i=__importDefault(i),a=__importDefault(a);class n extends i.default{constructor(){super(...arguments),this._previousComponentID="",this._registeredToPersistent=!1}setPersistentComponent(e){this._previousComponentID=this.GetID();const t=e.GetID();r.publish({event:"VCX_VOLATILE_PERSISTENT_PRE",data:{component:this}}),this._experienceBase.ComponentsMap.RemoveComponent(t),this._experienceBase.ComponentsMap.RemoveComponent(this._previousComponentID),this._experienceBase.ComponentsMap.AddComponent(this),this.SetID(t),this._experienceBase.ComponentsMap.AddComponent(this),this._instanciatedExtensions.CATI3DExperienceObject=e._instanciatedExtensions.CATI3DExperienceObject,e._instanciatedExtensions=[],this._instanciatedExtensions.CATI3DExperienceObject.SetObject(this),this.SetPersistency(e.GetPersistency()),e.SetPersistency(a.default.EPersistencyType.notPersistent),this._instanciatedExtensions.CATI3DExperienceObject._GetExpDataObject()._SetObjectModelerComponent(this),r.publish({event:"VCX_VOLATILE_PERSISTENT_POST",data:{component:this}})}registerToPersistent(){if(!this._registeredToPersistent){this._registeredToPersistent=!0,r.publish({event:"VCX_VOLATILE_PERSISTENT_REGISTERED",data:{component:this}});var e=this._experienceBase.getManager("VCXCAT3DXModelManager");e&&e.registerVolatileToPeristentCandidate(this)}}isRegisteredToPersistent(){return this._registeredToPersistent}getPreviousComponentID(){return this._previousComponentID}}return Object.defineProperty(n.prototype,"componentType",{enumerable:!0,get:()=>"VCXVolatileComponentOccurrenceComposer"}),n}),define("DS/VCXWeb3DMaster/VCXModifiableAssetOccurrenceComposer",["DS/VCXWeb3DMaster/VCXModifiableOccurrenceComposer","DS/VCXWebProperties/VCXPropertyValueString","DS/VCXWebProperties/VCXPropertyValueEnum","DS/VCXWebProperties/VCXProperty","DS/VCXWebProperties/VCXPropertyInfo","DS/VCXWebProperties/VCXPropertyInfoEnum","DS/Visualization/ModelLoader","DS/CoreEvents/Events","UWA/Utils","i18n!DS/VCXWeb3DMaster/assets/nls/VCXWeb3DMaster"],function(e,t,r,i,a,n,o,s,l,p){"use strict";return e.extend({init:function(){this._parent()},OnChangeProperty:function(e,t,r){if(r||(r={}),r.fromChildClass);else if(this.OnChangePropertyBegin(e,t))return!0;if(r.fromChildClass=!0,!this._parent(e,t,r))switch(e){case"Actor.NodeID":var i=this.GetObject(),a=t.GetValue();i.GetNodeID()!==a&&i.SetNodeID(a);break;case"Actor.AssetID":i=this.GetObject(),a=t.GetValue();i.GetAssetID()!==a&&i.SetAssetID(a);break;case"Actor.AssetType":i=this.GetObject(),a=t.GetValue();i.GetAssetType()!==a&&i.SetAssetType(a);break;default:return!1}return!0},OnChangePropertiesEnd:function(){if(this._parent(),!this.GetObject().IsLoaded()){var e=this.GetObject();e.SetIsLoaded(!0);var t=e.GetAssetID(),r=this.QueryInterface("W3AISGNodeHolder").getSGNode(),i=t.split(".")[0];if(e.GetNodeID());else{var a=i+"-"+l.getUUID().substr(0,18);e.SetNodeID(a)}if(e.name=i,r.setName(e.GetNodeID()),e.name=i,e._experienceBase._mapAssetsBlob){var n=e._experienceBase._mapAssetsBlob[t],p=e.GetAssetType();if(n&&0===p){var c=e._experienceBase.getManager("VCXContextManager").getMainViewer(),h=new o(c.getWebGLContext(),!1);h.setFileType("xmlv43"),h.activateSmartLoading(c.getRenderer()),h.setRenderCallback(c.render),h.setOnLoadedCallback(function(){s.publish({event:"VCX_ASSET_LOADED",data:e})}),h.loadModel(n,r)}else if(n&&1===p){require(["DS/VCXWebInteropSMG/VCXSmgGeomLoader"],function(t){t&&new t(e._experienceBase).LoadAsModel(n,r,function(){s.publish({event:"VCX_ASSET_LOADED",data:e})})})}}}},GetProperty:function(e){if("Actor.NodeID"===e)return(o=new t).SetValue(this.GetObject().GetNodeID()),new i(new a(e,0,!0,p),o);if("Actor.AssetID"===e)return(o=new t).SetValue(this.GetObject().GetAssetID()),new i(new a(e,0,!0,p),o);if("Actor.AssetType"===e){var o;(o=new r).SetValue(this.GetObject().GetAssetType());var s=new n(e,1,!0,p);return s.AddOrModifyChoice(0,"AssetType.3dxml"),s.AddOrModifyChoice(1,"AssetType.smgGeom"),new i(s,o)}return this._parent(e)},GetProperties:function(){var e=this._parent();return e.AddOrModifyProperty(this.GetProperty("Actor.NodeID")),e.AddOrModifyProperty(this.GetProperty("Actor.AssetID")),e.AddOrModifyProperty(this.GetProperty("Actor.AssetType")),e}})});