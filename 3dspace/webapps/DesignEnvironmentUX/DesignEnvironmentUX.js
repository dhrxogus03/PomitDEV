/*!  COPYRIGHT DASSAULT SYSTEMES 2021   */
define("DS/DesignEnvironmentUX/utils/DesignEnvConstants",[],()=>{return Object.freeze({GLOBAL_EVENT_CLOSE_LANDING_PAGE:"ENXViews/WelcomePanel/closeLandingPage",EVENT_CLEAN_APP:"event/clean/app",EVENT_LAUNCH_COMMAND:"event/launch/command",EVENT_CROSS_HEIGHLIGHT_SELECT:"DS/PADUtils/PADCommandProxy/select",EVENT_ONSELECT:"event/onselect",EVENT_DESIGNENV_REMOVEROOT:"ENXModel/DesignEnv/removeRoot",EVENT_DESIGNENV_CLOSE:"ENXModel/DesignEnv/close",EVENTS_RESET_VIEW:"ENXModel/DesignEnv/resetView",EVENTS_ADD_ITEM:"ENXModel/DesignEnv/wip/addItem",EVENT_ROOT_REMOVE:"ENXModel/Root/remove",EVENT_ROOT_ADDTITLE:"ENXModel/Root/addTile",EVENT_ROOT_SELECT:"ENXModel/Root/select",EVENT_ROOT_REMOVE_TILE:"ENXModel/Root/removeTile",EVENTS_REMOVE_ITEMS:"DesignExp/remove/items",OPEN_DESIGN_ENV_COMMAND_ID:"OpenDesignEnvHdr",TYPE_SUB_FOLDER:"Workspace Vault",TYPE_ADVANCED_FILTER:"ENOStrRefinementSpecification",TYPE_WORKSPACE:"Workspace",TYPE_CHECKBOX:"checkbox",DISPLAY_TYPE_ADVANCED_FILTER:"Advanced Filter",KIND_DESIGNENV:"designenv",KIND_CONTEXT:"ctx",KIND_WIP:"wip",LABEL_CONTEXT:"Context",LABEL_WIP:"Work In Progress",DS_FONT_ICON_FAMILY:"DSFontIcon",DS_FONT_CONTENT:"wux-ui-3ds wux-ui-3ds",STATUS_SUCCESS:"success",STATUS_FAILURE:"failure"})}),define("DS/DesignEnvironmentUX/commands/EditPropertiesCmd",["DS/ApplicationFrame/Command"],function(e){"use strict";return e.extend({_propertiesCommandPath:"DS/ENOCollabSharingCmds/commands/EditPropCmd/EditPropCmdBase",init:function(e){e.withTimeout=!1,this._parent(e,{isAsynchronous:!0}),this.editProp=null},execute:function(){var e=this;require([this._propertiesCommandPath],function(t){t=new t;var i=e.options.context.getActiveDesignEnv();e.disable(),i.getSelectedNodes=(()=>[i]),t.launchProperties(i),setTimeout(()=>{e.enable()},2e3)})}})}),define("DS/DesignEnvironmentUX/utils/DesignEnvUtils",["DS/i3DXCompassPlatformServices/i3DXCompassPlatformServices","DS/PlatformAPI/PlatformAPI","DS/CoreEvents/ModelEvents","DS/Utilities/UUID"],function(e,t,i,n){"use strict";var s=null,o=null,r=null,a=new i;return{init:function(t){var i=[];return new Promise(function(n,s){null===o&&t&&!0===t.initURL&&i.push(new Promise(function(t,i){e.getPlatformServices({onComplete:function(e){o=e,t()},onFailure:function(e){i(e)}})})),t&&!0===t.initWSAccess&&i.push(new Promise(function(e,i){require(["DS/DesignEnvironmentUX/ws/WSAccess"],function(n){n.initialize({addDefaults:!0,WSDefinitionAMDs:t.WSDefinitionAMDs}).then(e).catch(i)},i)})),Promise.all(i).then(n).catch(s)})},setModelEvents:function(e){a=e},getModelEvents:function(){return a},publish:function(e){return a.publish(e)},subscribe:function(e,t){return a.subscribe(e,t)},unsubscribe:function(e){return a.unsubscribe(e)},unsubscribeAll:function(e){return a.unsubscribeAll(e)},getWidgetId:function(){return"undefined"!=typeof widget?widget.id:"default-widget-id"},getAppId:function(){if("undefined"!=typeof widget)return widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):widget.getValue("appId")},getSharedId:function(){if("undefined"!=typeof widget)return widget.getValue("x3dSharedId")?widget.getValue("x3dSharedId"):this.getAppId()},uid:function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},getPlatformId:function(){return"undefined"!=typeof widget&&widget.getValue("x3dPlatformId")?widget.getValue("x3dPlatformId"):"OnPremise"},getPlatformIdForWin:function(){return o&&o.length?o[o.length-1].platformId:"OnPremise"},getTenantInfo:function(e){for(var t={},i=0;i<o.length;i++)if(o[i].platformId===e){t=o[i];break}return t},get3DSpaceURL:function(){return this.getPlatformURL("3DSpace")},getPlatformURL:function(e){if(!UWA.is(o,"array"))throw new Error("Platform services not initialize yet");var t=window.isWebInWin?this.getPlatformIdForWin():this.getPlatformId(),i=this.getTenantInfo(t);if(void 0===i[e])throw console.error("No "+e+" URL available for this tenant."),new Error("Unknown service "+e);return i[e]},getLang:function(){return"undefined"!=typeof widget?widget.lang:"en"},getUser:function(){return null==r&&(r=t.getUser()),r},setSecurityContext:function(e){s=e},getSecurityContext:function(){return s},isValidDesignEnv:function(e){return!0},getRequestLabel:function(){return this.getUserLogin()+"-"+this.getAppId()+"-"+Date.now()},getUserLogin:function(){var e=this.getUser(),t="";return void 0!==e&&(t=e.login),t},retrieveAndSetSC:function(e){var t=this;return new Promise(function(e,i){require(["DS/DesignEnvironmentUX/ws/WSAccess"],function(i){i.getscandcollab().then(function(i){var n,s,o,r,a,d=UWA.is(i,"string")?JSON.parse(i):i;d.pid;for(var l in d.preferredcredentials){var c=d.preferredcredentials[l];switch(l){case"collabspace":s=c.name,o=c.title?c.title:s;break;case"organization":r=c.name;break;case"role":a=c.name}}n="ctx::"+a+"."+r+"."+o,t.setSecurityContext(n),e()})},i)})},getIndexCallParams:function(e){return{input_physical_ids:[e],primitives:[{navigate_to_sr:{id:1,mode:"path",filter:{role:["574"],semantics:["1"]}}},{navigate_to_sr:{id:2,mode:"path",filter:{role:["575"],semantics:["1"]}}}],patterns:{Context:[{id:1,iter:1}],WIP:[{id:2,iter:1}]},flags:["returnMatches"],version:3,label:"DesignExp3dExcite"}}}}),define("DS/DesignEnvironmentUX/utils/DesignEnvModelEvents",["DS/CoreEvents/ModelEvents"],function(e){"use strict";var t=new e;return{getModelEvents:function(){return t},publish:function(e){return t.publish(e)},subscribe:function(e,i){return t.subscribe(e,i)},subscribeOnce:t.subscribeOnce,unsubscribe:function(e){return t.unsubscribe(e)},unsubscribeAll:function(e){return t.unsubscribeAll(e)}}}),define("DS/DesignEnvironmentUX/commands/AddInViewCmd",["DS/ApplicationFrame/Command"],e=>{return class extends e{constructor(e){super(e,"Design_Env_add_in_view_command"),this.app=e.app}execute(){this.addInView()}addInView(){let e=this,t=this.app.core.dataProvider.getItemsAsArray(this.app.core.contextManager.getSelectedItems());if(this.app.core.dataProvider.getDeTypes().includes(this._ctx._selectedContext.getKind())){let e=this._ctx.app.core.dataProvider.getMissingItems().filter(e=>!this._ctx.app.core.contextManager.isFilter(e));t=t.filter(t=>this._ctx.app.core.contextManager.isFilter(t)?t:e.find(e=>e.options.resourceid==t.options.resourceid))}this.app.core.pseCommonService.filtersToLoad=[],t.forEach(t=>{if(e.app.core.contextManager.isFilter(t)&&(t.options.isFilterModified||!e.app.core.contextManager.isDeFilterAvailableInDGV(t))){this.app.core.pseCommonService.filtersToLoad.push(t);let i=this.app.core.pseCommonService.getChildren().filter(e=>e.options.resourceid==t.options.associatedRoot);i.length&&(e.app.core.pseCommonService.removItems([i[0].options.resourceid]),t.options.isFilterModified&&(t.options.isFilterModified=!1,i[0].options.isFilterModified=!1))}}),this.app.core.pseCommonService.addItems(t),setTimeout(()=>{t.length&&(e.app.core.pseCommonService.updateIsReadOnlyAndAssetType(t.filter(t=>!e.app.core.contextManager.isFilter(t))),"designenv"==this._ctx._selectedContext.getKind()&&e.app.core.pseCommonService.applyDefaultSort(),this.app.is3dExcite&&(e.app.core.pseCommonService.reorderDgvAssets(),e.app.core.pseCommonService.reorderDgvAssets(),this.app.core.pseCommonService.filtersToLoad.length&&(e.app.core.pseCommonService.isCustomFilterLoad=!0)))},1e3)}}}),define("DS/DesignEnvironmentUX/utils/DesignEnvCtx",["DS/PlatformAPI/PlatformAPI"],function(e){"use strict";function t(){return"object"==typeof t.instance?t.instance:(t.instance=this,this.designEnvCtx=void 0,this.appId=void 0,this)}return t.prototype.initialize=function(t){return new Promise(function(i,n){t.appId?(this.appId=t.appId,e.subscribe("DS/DesignEnvCtx/"+t.appId+"/setContext",this._setContext.bind(this)),i()):n("DesignEnvCtx#initialize: Invalid input parameters missing appId")}.bind(this))},t.prototype.setContext=function(t){this._setContext(t),e.publish("DS/DesignEnvCtx/"+this.appId+"/setContext",t)},t.prototype.getContext=function(){return"my_sandbox"},t.prototype.hasContext=function(){return void 0!==this.designEnvCtx&&null!==typeof this.designEnvCtx},t.prototype._setContext=function(e){if(void 0===e.designEnvCtx)throw new Error("DesignEnvCtx#_setContextAPI: Invalid input parameters missing designEnvCtx");this.designEnvCtx=e.designEnvCtx},new t}),define("DS/DesignEnvironmentUX/services/DesignEnvEventsManager",["DS/CoreEvents/ModelEvents","DS/PlatformAPI/PlatformAPI"],(e,t)=>{let i=null;return class{constructor(e){return i||this.getNewInstance(e)}initialize(e){}getNewInstance(t){return this.options=t,this._eventBroker=new e,i=this,this}publish(e,t){this._eventBroker.publish({event:e,data:t})}subscribe(e,t){return this._eventBroker.subscribe({event:e},t)}unsubscribe(e){this._eventBroker.unsubscribe(e)}unsubscribeAll(){this._eventBroker&&(this._eventBroker.destroy(),this._eventBroker=new e)}destroy(){this._eventBroker.destroy()}publishPlatformEvent(e,i){t.publish(e,i)}subscribePlatformEvent(e,i){return t.subscribe(e,i)}}}),define("DS/DesignEnvironmentUX/services/DesignEnvAlertManager",["DS/Notifications/NotificationsManagerUXMessages","DS/Notifications/NotificationsManagerViewOnScreen"],(e,t)=>{return class{constructor(e){this.options=e}static initialize(){this.notifManager=e,t.setNotificationManager(this.notifManager),t.setStackingPolicy(5),t.setRemoveStackOnFirstTimeoutFlag(!0),t.setFadeOutPolicy(2)}static successAlert(e){this.notifManager||this.initialize(),this.notifManager.addNotif({level:"success",message:e,sticky:!1})}static infoAlert(e){this.notifManager||this.initialize(),this.notifManager.addNotif({level:"info",message:e,sticky:!1})}static warningAlert(e){this.notifManager||this.initialize(),this.notifManager.addNotif({level:"warning",message:e,sticky:!1})}static errorAlert(e){this.notifManager||this.initialize(),this.notifManager.addNotif({level:"error",message:e,sticky:!1})}}}),define("DS/DesignEnvironmentUX/services/DesignEnvContextManager",[],()=>{let e=null;return class{constructor(t){return e||this.getNewInstance(t)}getNewInstance(t){return this.app=t&&t.app?t.app:{},e=this,this}initialize(){this._activeDesignEnv=null,this._selectedContext={},this._modelEvents={}}isValidContextToOpen(e){return!0}getWidgetId(){return"undefined"!=typeof widget?widget.id:"default-widget-id"}getAppId(){if("undefined"!=typeof widget)return widget.getValue("x3dAppId")?widget.getValue("x3dAppId"):widget.getValue("appId")}getSharedId(){if("undefined"!=typeof widget)return widget.getValue("x3dSharedId")?widget.getValue("x3dSharedId"):this.getAppId()}getServiceId(){return"3DSpace"}setActiveDesignEnv(e){this._activeDesignEnv=e}removeActiveDesignExp(){this._activeDesignEnv=null}getActiveDesignEnv(){return this._activeDesignEnv}setNextOpenSelection(e){this._nextOpenSelection=e}getNextOpenSelection(){return this._nextOpenSelection}setSelectedContext(e){this._selectedContext=e}getSelectedContext(){return this._selectedContext}getContextAssets(){return this._activeDesignEnv.getContext().getChildren()}getWipAssets(){return this._activeDesignEnv.getWip().getChildren()}getAllDesignExpAssetsOnly(){return this.getContextAssets().concat(this.getWipAssets())}isDeFilterAvailableInDGV(e){return!!this.app.core.pseCommonService.getChildren().find(t=>t.options.filterId==e.options.resourceid)}handleDesignExpItemsSelection(e){let t=this.getSelectedItems();this.designAssetTypeSelection="";let i=this.app.core.dataProvider.getDeTypes(),n=this.app.core.pseCommonService.getChildren();if(!e.paths.length&&t.length&&n.length&&Array.isArray(t)&&!t.filter(e=>i.includes(e.options.kind)).length)e.dePaths=[];else{if(Array.isArray(t)?(e.designAssetTypeSelection=t.length&&i.includes(t[0].getKind())?t[0].getKind():"",e.dePaths=t.filter(e=>!i.includes(e.options.kind)).map(e=>e.options.resourceid)):!t||n.find(e=>e.options.resourceid===t.options.resourceid&&!this.hasFilterCondition(t,e)||t.options.resourceid===e.options.filterId)||i.includes(t.options.kind)||(e.dePaths=[t.options.resourceid]),!this.app.listView.isSelectionFromDE&&e.dePaths&&e.dePaths.length>1&&1==e.paths.length&&!e.designAssetTypeSelection)if(2==e.dePaths.length){let t=e.dePaths.findIndex(t=>t==e.paths[0][0]);-1==t||n.find(t=>t.options.resourceid==e.paths[0][0]&&t.options.filtered)?e.dePaths=[]:e.dePaths.slice(t,1)}else e.dePaths=[];!this.app.listView.isSelectionFromDE&&e.dePaths&&e.paths&&(e.dePaths=e.paths),this.designAssetTypeSelection=e.designAssetTypeSelection}}hasFilterCondition(e,t){return!!(!this.isFilter(e)&&this.app.core.pseCommonService.isPSEFilter(t)&&t.options.filterId||this.isFilter(e)&&!this.app.core.pseCommonService.isPSEFilter(t))}isFilter(e){return e.getType()==this.app.core.dataProvider.getDeConstants().TYPE_ADVANCED_FILTER}getDesignExpFilterItem(e){let t=this;return this.app.core.dataProvider.getItemsAsArray(this.getActiveDesignEnv().getAllDescendants().filter(i=>t.isFilter(i)&&i.options.associatedRoot==e))}getSelectedItems(){let e=this.app.listView.getModels().getSelectedNodes();return Array.isArray(e)&&1==e.length?e[0]:e}isWipSelected(){return!!this.app.core.dataProvider.getItemsAsArray(this.getSelectedItems()).filter(e=>"wip"==e.getParent().getKind()).length}isCtxSelected(){return!!this.app.core.dataProvider.getItemsAsArray(this.getSelectedItems()).filter(e=>"ctx"==e.getParent().getKind()).length}handleExpandCollapseEvents(){this.app.deFolderNodes.forEach(e=>{e.onPostCollapse(this.onPostCollapseExpand.bind(this)),e.onPostExpand(this.onPostCollapseExpand.bind(this))})}onPostCollapseExpand(e){"postCollapse"==e.event&&e.data.nodeModel.getAllDescendants().find(e=>e._isSelected)?(e.data.nodeModel.highlight(),this.updateFolderBorder(e.data.nodeModel.getKind(),"update")):this.designAssetTypeSelection!=e.data.nodeModel.getKind()&&e.data.nodeModel.isHighlighted()&&(e.data.nodeModel.unhighlight(),this.updateFolderBorder(e.data.nodeModel.getKind(),"remove"))}updateFolderBorder(e,t){let i=this,n="1px solid #368ec4";setTimeout(()=>{"designenv"==e?(document.querySelectorAll('.designenvpanel-main [data-node-depth="0"]')[0].style.border="update"==t?n:document.querySelectorAll('.designenvpanel-main [data-node-depth="0"]')[0].style.removeProperty("border"),"remove"==t&&(document.querySelectorAll('.designenvpanel-main [data-node-depth="1"]').forEach(e=>{e.style.removeProperty("border")}),document.querySelectorAll('.designenvpanel-main [data-node-depth="2"]').forEach(e=>{e.style.removeProperty("border")}),i.app.deFolderNodes[1].isHighlighted()&&(document.querySelectorAll('.designenvpanel-main [data-node-depth="1"]')[0].style.border=n),i.app.deFolderNodes[2].isHighlighted()&&(document.querySelectorAll('.designenvpanel-main [data-node-depth="1"]')[1].style.border=n))):"ctx"==e?document.querySelectorAll('.designenvpanel-main [data-node-depth="1"]')[0].style.border="update"==t?n:document.querySelectorAll('.designenvpanel-main [data-node-depth="1"]')[0].style.removeProperty("border"):"wip"==e&&(document.querySelectorAll('.designenvpanel-main [data-node-depth="1"]')[1].style.border="update"==t?n:document.querySelectorAll('.designenvpanel-main [data-node-depth="1"]')[1].style.removeProperty("border"))},10)}setModelEvents(e){this._modelEvents=e}getModelEvents(){return this._modelEvents}}}),define("DS/DesignEnvironmentUX/collections/DesignEnvTreeDocument",["DS/Tree/TreeDocument"],e=>{function t(t){t=t||{},e.call(this,t)}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t}),define("DS/DesignEnvironmentUX/services/HelperService",["DS/WebappsUtils/WebappsUtils"],e=>{return class{static getIconPath(t){return e.getWebappsAssetUrl("DesignEnvironmentUX",`icons/32/${t}.png`)}}}),define("DS/DesignEnvironmentUX/services/DataBuilder",["DS/DesignEnvironmentUX/utils/DesignEnvUtils","DS/Utilities/UUID","DS/DesignEnvironmentUX/utils/DesignEnvConstants"],(e,t,i)=>{return class{constructor(e){this.core=e&&e.app?e.app.core:e}buildContentOptions(e){let i={protocol:"3DXContent",version:"1.1",source:t.v4(),widgetId:"undefined"==typeof widget?t.v4():widget.id,data:{}};return e?(i.data.items=this.core.dataProvider.app.is3dExcite?e.results.map(this.getContentOption.bind(this)):e.content.map(this.getContentOption.bind(this)),i):i}getContentOption(t){return{...this.core.dataProvider.app.is3dExcite&&{objectId:t.filterId?t.filterId:t.AssetID,actorType:t.ActorType,actorID:t.ActorID,label:t.filterId?t.filterTitle:t.AssetName,displayName:t.filterId?t.filterTitle:t.AssetName,objectType:t.filterId?i.TYPE_ADVANCED_FILTER:t.AssetType,displayType:t.filterId?i.DISPLAY_TYPE_ADVANCED_FILTER:t.AssetType==i.TYPE_ADVANCED_FILTER?i.DISPLAY_TYPE_ADVANCED_FILTER:t.AssetType},...!this.core.dataProvider.app.is3dExcite&&{objectId:t.id?t.id:t.filterId,label:t.label?t.label:t.filterTitle,displayName:t.label?t.label:t.filterTitle,objectType:t.filterId?i.TYPE_ADVANCED_FILTER:t.type,displayType:t.displayType},envId:e.getPlatformId(),serviceId:this.core.contextManager.getServiceId(),contextId:e.getSecurityContext()}}}}),define("DS/DesignEnvironmentUX/commands/DesignEnvAddItemToWIPCmd",["DS/ApplicationFrame/Command","DS/DesignEnvironmentUX/utils/DesignEnvUtils"],(e,t)=>{return class extends e{constructor(e){super(e,"newAdd_contexItem_command"),this.app=e.app}execute(){let e=this;this.app.core.searchService.launchSearch({precondition:'flattenedtaxonomies:"types/VPMReference" OR flattenedtaxonomies:"types/VPMRepReference"',fts_value:void 0,showApplyButton:!1,ok:function(t){let i=e.app.core.searchService.searchDataToDropData(t),n=e.app.core.contextManager.getSelectedContext();e.app.core.dsEnvEventManager.publish(e.app.core.designEnvConstants.EVENTS_ADD_ITEM,{data:i,kind:n.getKind()})}})}}}),define("DS/DesignEnvironmentUX/services/DesignEnvSearchService",["DS/DesignEnvironmentUX/utils/DesignEnvUtils"],e=>{let t=null;return class{constructor(e){return t||this.getNewInstance(e)}getNewInstance(e){return this.core=e&&e.app?e.app.core:e,t=this,this}launchSearch(e){let t={parent_window:e.odtSpecificParentWindow,title:e.title,precond:e.precondition,fts_value:e.fts_value,showApplyButton:e.showApplyButton,applyButton_Nls:e.applyButton_Nls,callback:e.ok,apply:e.apply,cancel:function(e){}};this.core.wsDataService.inAppsSearch(t)}searchDataToDropData(t){var i="string"==typeof t?JSON.parse(t):t,n={data:{items:[]}};if(i.length>0)for(var s=0;s<i.length;s++){var o={displayName:i[s]["ds6w:label"],displayType:i[s]["ds6w:type"],objectId:i[s].id,objectType:i[s]["ds6w:type_value"],serviceId:"3DSpace",envId:e.getPlatformId(),contextId:e.getSecurityContext()};n.data.items.push(o)}return n}}}),define("DS/DesignEnvironmentUX/ws/WSDesignEnv",["DS/DesignEnvironmentUX/utils/DesignEnvUtils","DS/WebappsUtils/WebappsUtils"],function(e,t){"use strict";function i(){}return i.prototype.getFolderContent=function(t){var i=this;return new Promise(function(n,s){var o=e.get3DSpaceURL()+"/resources/v1/FolderManagement/Folder/"+t.folderId+"/content?Content=All&tenant="+e.getPlatformId(),r={method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},onComplete:n,onFailure:s};i.executeRequest(o,r)}.bind(this))},i.prototype.addFolderContent=function(t){var i=e.getSecurityContext(),n=this,s=function(){var i={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLang()},timeout:6e4},s=e.get3DSpaceURL()+"/resources/v1/FolderManagement/Folder/"+t.folderId+"/content?tenant="+e.getPlatformId(),o={IDs:String(t.ids)};return i.data=o,n.executeRequestPromise(s,i)};return i?s():new Promise(function(t,i){e.retrieveAndSetSC().then(function(){s().then(t)})}.bind(this))},i.prototype.removeFolderContents=function(t){var i=e.getSecurityContext(),n=this,s=function(){i||(i=e.getSecurityContext());var s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLang()},timeout:6e4},o=e.get3DSpaceURL()+"/resources/v1/FolderManagement/Folder/"+t.folderId+"/removecontent?tenant="+e.getPlatformId();i&&(o+="&SecurityContext="+i);var r={IDs:String(t.ids)};return s.data=r,n.executeRequestPromise(o,s)};return i?s():new Promise(function(t,i){e.retrieveAndSetSC().then(function(){s().then(t)})}.bind(this))},i.prototype.createFolder=function(t){var i=e.getSecurityContext(),n=this,s=function(){var s=t.rootFolder?t.rootFolder:"Native";i||(i=e.getSecurityContext());var o={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLang()},timeout:6e4},r=e.get3DSpaceURL()+"/resources/v1/collabServices/authoring/op/createContent?tenant="+e.getPlatformId();r+="&folderID="+s,i&&(r+="&SecurityContext="+i);var a={expectSingleCreation:!1,type:"folder"};return t.title&&(a.title=t.title),o.data=a,n.executeRequestPromise(r,o)};return i?s():new Promise(function(t,i){e.retrieveAndSetSC().then(function(){s().then(t)})}.bind(this))},i.prototype.deleteFolderStructure=function(t){var i=e.getSecurityContext(),n=this,s=function(){i||(i=e.getSecurityContext());var s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLang()},timeout:6e4},o=e.get3DSpaceURL()+"/resources/lifecycle/Delete/structure?tenant="+e.getPlatformId();i&&(o+="&SecurityContext="+i);var r={data:[{physicalid:t.id}],options:[]};return s.data=r,n.executeRequestPromise(o,s)};return i?s():new Promise(function(t,i){e.retrieveAndSetSC().then(function(){s().then(t)})}.bind(this))},i}),define("DS/DesignEnvironmentUX/services/CommandsService",["DS/ApplicationFrame/CommandsManager","text!DS/DesignEnvironmentUX/assets/menus/MenuInfo.json","text!DS/DesignEnvironmentUX/assets/menus/Commands.json","DS/DesignEnvironmentUX/utils/DesignEnvConstants","i18n!DS/DesignEnvironmentUX/assets/nls/DesignEnvironmentUX","text!DS/DesignEnvironmentUX/assets/menus/MenuInfoReadOnlyInWeb.json"],(e,t,i,n,s,o)=>{return class{constructor(e){this.app=e.app,this._commandsInfo=JSON.parse(i),this._menuInfos=this.app.isReadOnly?{}:this.app.isReadOnlyInWeb?JSON.parse(o):JSON.parse(t)}initialize(){let e=this;this._eventToken=this.app.core.dsEnvEventManager.subscribe(this.app.core.designEnvConstants.EVENT_LAUNCH_COMMAND,function(t){e._commandsListener(t)}),this.commandLoaderStatus={},this.app.core.mandatoryStartupPromises.push(...this.loadAllCommand())}renderMenu(){return this.getMenu()}getMenu(){let e=this.getSelectedItemInfo(),t=this._getTemplateMenu(e.kind),i=this.getCommands(e);return this.buildMenu(t,i,e)}getCommands(e){let t=[],i=this._commandsInfo;if(e.kind==n.KIND_DESIGNENV||e.kind==n.KIND_CONTEXT||e.kind==n.KIND_WIP)return i;let s=e.multiSelected;for(let e in i){let n=i[e],o=!0;o=!s||1==n.multiSelect,n.nls_key="DesignEnvRemoveContentHdr"==n.commandHdr?s?"removeItems":"remove":n.nls_key,o&&(t[e]=n)}return t}buildMenu(e,t,i){var n=this;let s=[];return e.forEach(e=>{if(e.type){let o=t[e.ID];s.push(n._buildMenuEntry(o,"PushItem",i.kind))}}),s}_buildMenuEntry(e,t,i){var o=this;return{type:t,title:s.designenv[e.nls_key],fonticon:{family:n.DS_FONT_ICON_FAMILY,content:`${n.DS_FONT_CONTENT}-${e.fonticon}`},action:{context:this,callback:function(){o.commandHandler(e,i)}},state:e.checkState?o.getState(e.commandHdr):"enabled"}}commandHandler(e,t){this.executeCommand(e.commandHdr)}executeCommand(t,i){var n=this._commandsInfo[t];i&&i();let s=e.getCommand(n.commandHdr,widget);s&&s.begin()}loadAllCommand(){var e=this;let t=[];for(let i in this._commandsInfo){let n=e._commandsInfo[i],s=new Promise(function(t,i){e.loadCommand(n,t,i)});t.push(s)}return t}loadCommand(e,t,i){if(!e||!e.commandHdr||!e.AmdLoader)return console.error("Oups ! no valid command description"),void i("Oups ! no valid command description");var n=this;return require([e.AmdLoader],function(i){new i({context:n.app.core.contextManager,app:n.app,ID:e.commandHdr}),t()},function(e){i(e)})}_getTemplateMenu(e){return Object.keys(this._menuInfos).length&&this._menuInfos.templates[e]||[]}_commandsListener(e){this.executeCommand(e.commandId)}getSelectedItemInfo(){let e=1,t=!1,i=[],n=this.app.core.contextManager.getSelectedItems();Array.isArray(n)&&n.length>0&&(t=!0,e=n.length,n.forEach(e=>{-1==i.indexOf(e.getKind())&&i.push(e.getKind())}));let s=this.app.core.contextManager.getSelectedContext();return{kind:null!=s?s.getKind():0==i.length?n.getKind():1==i.length?i[0]:void 0,nbSelectedItems:e,multiSelected:t,selectedItemsKind:i,areSameKindOfItemsSelected:i.length<=1}}getState(e){let t="enabled",i=this.app.core.contextManager.getSelectedItems();if(Array.isArray(i))return this.app.core.dataProvider.getMissingItems().length||"AddInViewCmd"!=e?t:"disabled";if(this.app.core.dataProvider.getDeTypes().includes(i.getKind())&&!i.getChildren().length&&"AddInViewCmd"==e)return"disabled";if(this.app.core.contextManager.isFilter(i)&&!this.app.core.contextManager.isDeFilterAvailableInDGV(i))return t;switch(e){case"RemoveItemsFromFolderCmd":t=i.hasChildren()?"enabled":"disabled";break;case"AddInViewCmd":t=this.app.core.dataProvider.isItemInPseView()?"disabled":"enabled"}return t}}}),define("DS/DesignEnvironmentUX/ws/WSDesignExp",["DS/DesignEnvironmentUX/utils/DesignEnvUtils","DS/WebappsUtils/WebappsUtils"],function(e,t){"use strict";function i(){}return i.prototype.createExperience=function(t){var i=e.getSecurityContext(),n=this,s=function(){i||(i=e.getSecurityContext());var s={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLang()},timeout:6e4},o=e.get3DSpaceURL()+"/resources/v1/3dcommunication/experiences?tenant="+e.getPlatformId();i&&(o+="&SecurityContext="+i);var r={experienceType:"ENOExpDesignExperience"};return t.title&&(r.name=t.title),s.data=r,n.executeRequestPromise(o,s)};return i?s():new Promise(function(t,i){e.retrieveAndSetSC().then(function(){s().then(t)})}.bind(this))},i.prototype.addExperienceAssets=function(t){var i=e.getSecurityContext(),n=this,s=function(){var i={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLang()},timeout:6e4},s=e.get3DSpaceURL()+"/resources/v1/3dcommunication/experiences/"+t.deId+"/actors?tenant="+e.getPlatformId();return i.data=t.assets.map(e=>({assetID:e,role:"wip"==t.actorKind?"V_DEtoWIPAsset":"V_DEtoContextAsset",actorType:"wip"==t.actorKind?"DEWIPActor":"DEContextActor"})),n.executeRequestPromise(s,i)};return i?s():new Promise(function(t,i){e.retrieveAndSetSC().then(function(){s().then(t)})}.bind(this))},i.prototype.removeExperienceAssets=function(t){var i=e.getSecurityContext(),n=this,s=function(){var i={method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLang()},timeout:6e4},s=e.get3DSpaceURL()+"/resources/v1/3dcommunication/experiences/"+t.folderId+"/actors?tenant="+e.getPlatformId();return i.data=t.ids,n.executeRequestPromise(s,i)};return i?s():new Promise(function(t,i){e.retrieveAndSetSC().then(function(){s().then(t)})}.bind(this))},i.prototype.getExperienceAssets=function(t){var i=e.getSecurityContext(),n=this,s=function(){var i=e.get3DSpaceURL()+"/resources/v1/3dcommunication/experiences/"+t.deId+"/actors?Content=All&tenant="+e.getPlatformId()+"&pageSize=50",s={method:"GET",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLang()},timeout:6e4};return n.executeRequestPromise(i,s)};return i?s():new Promise(function(t,i){e.retrieveAndSetSC().then(function(){s().then(t)})}.bind(this))},i.prototype.getExperienceAssetsonIndex=function(t){var i=e.getSecurityContext(),n=this,s=function(){var s=e.get3DSpaceURL()+"/cvservlet/navigate?tenant="+e.getPlatformId();i&&(s+="&SecurityContext="+i);var o={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLang()},timeout:6e4};return o.data=e.getIndexCallParams(t.deId),n.executeRequestPromise(s,o)};return i?s():new Promise(function(t,i){e.retrieveAndSetSC().then(function(){s().then(t)})}.bind(this))},i.prototype.fetch=function(t){return new Promise(function(i,n){var s=t.data||{},o=Object.assign({label:"fetch-"+e.getRequestLabel(),locale:e.getLang(),tenant:e.getPlatformId()},s);void 0!==t.pids&&(o.physicalid=t.pids);var r=[];r.push("ds6w:type"),r.push("ds6w:label"),o.select_predicate=r;var a=e.getSecurityContext(),d=e.get3DSpaceURL()+"/cvservlet/fetch/v2?tenant="+e.getPlatformId(),l={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Accept-Language":e.getLang()},timeout:t.timeout?t.timeout:void 0,data:JSON.stringify(o),onComplete:i,onFailure:n};a&&(d+="&SecurityContext="+a),this.executeRequest(d,l)}.bind(this))},i}),define("DS/DesignEnvironmentUX/commands/DesignEnvAddItemToContextCmd",["DS/ApplicationFrame/Command","DS/DesignEnvironmentUX/utils/DesignEnvUtils"],(e,t)=>{return class extends e{constructor(e){super(e,"DesignEnvAddItemToContextCmd"),this.app=e.app}execute(){let e=this;this.app.core.searchService.launchSearch({precondition:'flattenedtaxonomies:"types/VPMReference" OR flattenedtaxonomies:"types/VPMRepReference" OR flattenedtaxonomies:"types/ENOStrRefinementSpecification"',fts_value:void 0,showApplyButton:!1,ok:function(t){e.selectedItems=t;let i=e.selectedItems.filter(e=>"ENOStrRefinementSpecification"==e["ds6w:type_value"]).map(e=>e.id);i.length?e.app.core.dataProvider._getRootsForFilters(i).then(t=>{let i=e.app.core.searchService.searchDataToDropData(e.selectedItems);i.data.items.forEach(e=>{"ENOStrRefinementSpecification"==e.objectType&&(e.rootId=t.find(t=>t[e.objectId])[e.objectId].rootPhysicalId,e.isFiltered=!0)}),e.addItems(i)}):e.addItems(e.app.core.searchService.searchDataToDropData(e.selectedItems))}})}addItems(e){this.app.core.dsEnvEventManager.publish(this.app.core.designEnvConstants.EVENTS_ADD_ITEM,{data:e,kind:this.app.core.contextManager.getSelectedContext().getKind()})}}}),define("DS/DesignEnvironmentUX/ws/WSMisc",["UWA/Utils/InterCom","DS/Utilities/Utils","DS/DesignEnvironmentUX/utils/DesignEnvUtils"],function(e,t,i){"use strict";function n(){}return n.prototype.getscandcollab=function(){var e=this;return new Promise(function(t,n){var s={},o=i.get3DSpaceURL()+"/resources/modeler/pno/person?current=true&select=preferredcredentials&select=collabspaces&tenant="+i.getPlatformId();s.method="GET",s.headers={Accept:"application/json","Accept-Language":i.getLang(),"Content-Type":"application/json"},s.cache=-1,s.onComplete=t,s.onFailure=n,e.executeRequest(o,s)}.bind(this))},n.prototype.fetchFilter=function(e){return new Promise(function(t,n){var s=e.data.filterids,o=i.getSecurityContext(),r=i.get3DSpaceURL()+"/resources/FilterBIAPI/Filter/getBasicsInDBFromIds?tenant="+i.getPlatformId(),a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},timeout:e.timeout?e.timeout:void 0,data:JSON.stringify(s),onComplete:t,onFailure:n};o&&(r+="&SecurityContext="+o),this.executeRequest(r,a)}.bind(this))},n.prototype.getFiltersFromIds=function(e){return new Promise(function(t,n){var s=e.data.filterids,o=i.getSecurityContext(),r=i.get3DSpaceURL()+"/resources/FilterBIAPI/Filter/getFiltersFromIds?tenant="+i.getPlatformId(),a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},timeout:e.timeout?e.timeout:void 0,data:JSON.stringify(s),onComplete:t,onFailure:n};o&&(r+="&SecurityContext="+o),this.executeRequest(r,a)}.bind(this))},n.prototype.retrieveFiltersForRoots=function(e){return new Promise(function(t,n){var s=e.data.rootIds,o=i.getSecurityContext(),r=i.get3DSpaceURL()+"/resources/FilterBIAPI/Filter/retrieveFiltersForRoots?tenant="+i.getPlatformId(),a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},timeout:e.timeout?e.timeout:void 0,data:JSON.stringify(s),onComplete:t,onFailure:n};o&&(r+="&SecurityContext="+o),this.executeRequest(r,a)}.bind(this))},n.prototype.inAppsSearch=function(n){var s=Object.assign({mode:"furtive",default_with_precond:!0,widget_id:i.getWidgetId(),app_socket_id:"enosearchutils_"+i.getWidgetId(),idcard_activated:!1,advanced_search:{showByDefault:!1},tenant:i.getPlatformId()},n),o=new e.Socket(s.app_socket_id,{dispacthRetryInterval:0});!0===n.debug_mode&&o.setDebugMode(!0),UWA.is(n.parent_window)?o.subscribeServer("SearchComServer",window):o.subscribeServer("SearchComServer"),o.dispatchEvent("RegisterContext",s),UWA.is(n.context_name)&&(s.context_title=n.context_name),s.default_search_criteria=n.fts_value,o.dispatchEvent("InContextSearch",s);var r,a=[];o.addListener("InContextSearch_Response",function(e){e,a=e.selected_objects,r=e.selected_command});var d=t.debounce(function(e){switch(r){case"in_app_ok":n.callback.call(null,a);break;case"in_app_apply":n.apply?n.apply.call(null,a):n.callback.call(null,a);break;default:n.cancel&&n.cancel.call(null)}o.removeListener("onCloseTransient",d),o.dispatchEvent("UnregisterContext",{widget_id:s.widget_id})},200);o.addListener("onCloseTransient",d),o.addListener("onCloseTransient",function(e){n.cancel&&n.cancel.call(null),o.dispatchEvent("UnregisterContext",{widget_id:s.widget_id})})},n}),define("DS/DesignEnvironmentUX/commands/CloseDesignEnvCmd",["DS/ApplicationFrame/Command","DS/DesignEnvironmentUX/utils/DesignEnvConstants"],(e,t)=>{return class extends e{constructor(e){super(e,"CloseDesignEnvCmd"),this.app=e.app}execute(){this.app.modelEvent.publish({event:t.EVENT_DESIGNENV_CLOSE,data:{designExp:this.app.core.contextManager.getActiveDesignEnv()}})}}}),define("DS/DesignEnvironmentUX/views/DesignExpDialogs/js/DesignExpUXDialog",["DS/Windows/ImmersiveFrame","DS/Windows/Dialog","DS/UIKIT/Input/Toggle","DS/Controls/Button","DS/DesignEnvironmentUX/utils/DesignEnvConstants","i18n!DS/DesignEnvironmentUX/assets/nls/DesignEnvironmentUX"],(e,t,i,n,s,o)=>{let r;class a{constructor(e){this.core=e&&e.core?e.core:{}}static getInstance(e){return r||(r=new a(e)),r}buildRemoveItemsConfirmationDialog(e){e.content=UWA.Element("div",{class:"remove-dialog-content",html:e.message}),e.showDonNotShowAttr&&(this.doNotShowAttrRef=new i({type:s.TYPE_CHECKBOX,label:o.designenv.doNotShowDialogAgainTitle,checked:!1}),this.doNotShowAttrRef.inject(e.content)),this.getDialog(e)}buildFilterCriteriaConfirmationDialog(e){e.content=UWA.Element("div",{class:"restore-dialog-content",html:[UWA.createElement("span",{class:"wux-ui-3ds wux-ui-3ds-2x wux-ui-3ds-attention color-red"}),e.message]}),this.getDialog(e)}getDialog(i){let n=new e;return n.inject(widget.body),new t({immersiveFrame:n,title:i.title,content:i.content,width:i.width?i.width:400,resizableFlag:!i.resizableFlag||i.resizableFlag,modalFlag:!i.modalFlag||i.modalFlag,buttons:i.buttons})}getButtons(e){let t=this;return{Close:new n({onClick:function(i){e.onCloseDialogCallback(i,t.doNotShowAttrRef?t.doNotShowAttrRef.isChecked():"")}}),Ok:new n({onClick:function(i){e.onOkCallback(),e.onCloseDialogCallback(i,t.doNotShowAttrRef?t.doNotShowAttrRef.isChecked():"")}})}}}return a}),define("DS/DesignEnvironmentUX/services/PseCommonService",["DS/DesignEnvironmentUX/utils/DesignEnvUtils","DS/DesignEnvironmentUX/services/HelperService","DS/DesignEnvironmentUX/utils/DesignEnvConstants","DS/DesignEnvironmentUX/views/DesignExpDialogs/js/DesignExpUXDialog","DS/Utilities/Dom"],(e,t,i,n,s)=>{return class{constructor(e){this.app=e.app?e.app:e,this.options=e}getModels(){return this.app.pseModel||this.app.globalModelEvent&&this.app.globalModelEvent.publish({event:"DesignEnv/updatePSEModel",data:this.updatePSEModel.bind(this)}),this.app.pseModel?this.app.pseModel:{}}updatePSEModel(e){this.app.pseModel=e}getChildren(){return this.getModels().getChildren?this.getModels().getChildren():[]}addOrRemoveEvents(e,t){this.padDGV=this.getModels().options.context.getPADDGVView(),this.filtersToLoad=[],this.clearDeDataInPSE(),this.deSortModel={isSorted:!1,sort:""},this.padDGV.options.dgv.sortModel||(this.sortModel=this.padDGV.options.dgv.sortModel=[]),"add"===e?(this.padDGV.changeVisibilityCB("asset-type",!0),this.handler=(async e=>{e.ctrlKey||(await function(e){return new Promise(t=>setTimeout(t,e))}(100),e.dsModel&&this.deSortModel.isSorted&&e.dsModel.sortModel&&e.dsModel.sortModel.length&&"asset-type"!=e.dsModel.sortModel[0].dataIndex?(this.applyDefaultSort(e.dsModel.sortModel,this.deSortModel.sort),this.padDGV.options.dgvLayout.saveColumnSortModelInPreferences()):e.dsModel._preselectedCellStableID&&"asset-type"!=e.dsModel._preselectedCellStableID.columnDataIndex&&this.deSortModel.isSorted&&!e.dsModel.sortModel.length?this.applyDefaultSort(e.dsModel.sortModel,this.deSortModel.sort):e.dsModel.sortModel&&!e.dsModel.sortModel.length&&e.dsModel._preselectedCellStableID&&"asset-type"==e.dsModel._preselectedCellStableID.columnDataIndex?this.applyDefaultSort(e.dsModel.sortModel,"asc"):!e.dsModel.sortModel&&e.dsModel._preselectedCellStableID&&"asset-type"==e.dsModel._preselectedCellStableID.columnDataIndex&&(this.deSortModel.isSorted=!1))}),this.applyDefaultSort(this.padDGV.options.dgv.sortModel),this.addOrRemoveCompareFunction(this.padDGV,"add"),this.getModels().options.context.getPADTreeDocument().refresh({datagrid:this.padDGV,dispatch:!1}),t&&this.addOrRemoveEventListener("remove"),this.addOrRemoveEventListener("add")):"remove"===e&&(this.padDGV.options.dgv.sortModel&&this.padDGV.options.dgv.sortModel.length&&this.padDGV.options.dgv.sortModel.splice(this.padDGV.options.dgv.sortModel.findIndex(e=>"asset-type"==e.dataIndex),1),this.deSortModel.isSorted=!1,this.addOrRemoveCompareFunction(this.padDGV,"remove"),this.addOrRemoveEventListener("remove"),this.padDGV.changeVisibilityCB("asset-type",!1),this.clearDeDataInPSE())}applyDefaultSort(e,t){this.padDGV.options.dgv.sortModel||(this.padDGV.options.dgv.sortModel=[]),e||(e=this.padDGV.options.dgv.sortModel),e.find(e=>"asset-type"==e.dataIndex)&&0==e.findIndex(e=>"asset-type"==e.dataIndex)||(e.unshift({dataIndex:"asset-type",sort:t||"desc"}),this.padDGV.options.dgv.reapplySortModel())}addOrRemoveEventListener(e){let t=this.padDGV.options.dgv.elements.header;"add"==e&&t?t.addEventListener("click",this.handler,!1):"remove"==e&&t&&t.removeEventListener("click",this.handler,!1)}addOrRemoveCompareFunction(e,t){e.options.dgvLayout._leafColumns.forEach(i=>{"asset-type"!=i.dataIndex&&("add"==t?i.compareFunction=this.commonCompareFunction.bind(e):"remove"==t&&delete i.compareFunction)})}commonCompareFunction(){let e=this.options.context.getPseService();return e.deSortModel.isSorted?arguments[2].options.deType==arguments[3].options.deType&&arguments[0]&&arguments[1]?e.handleCompare(arguments):0:arguments[0]&&arguments[1]?e.handleCompare(arguments):void 0}handleCompare(e){return"string"==typeof e[0]||"string"==typeof e[1]?e[0].localeCompare(e[1]):!e[0]&&!e[1]||UWA.equals(e[0],e[1])?0:e[0]>e[1]?1:e[0]<e[1]?-1:!e[0]&&e[1]?-1:1}clearDeDataInPSE(){this.getChildren().forEach(e=>{delete e.options.deType,delete e.options.isReadOnly})}getAssetTypeCellValue(e){var i=e.nodeModel.options;return i.sortIdentifier=1,["WIP","WIPModified"].includes(i.deType)||null==i.deType&&this.isWip(e.nodeModel.getID())&&e.nodeModel.isRoot()&&!i.filterId?(i.deType="WIP",i.sortIdentifier=2,i.isFilterModified&&(i.deType="WIPModified")):(["Context","ContextModified"].includes(i.deType)||null==i.deType&&this.isContext(i.filterId||e.nodeModel.getID())&&e.nodeModel.isRoot())&&(i.deType="Context",i.isFilterModified&&(i.deType="ContextModified"),i.filterId&&null==e.nodeModel.options.isFilterModified&&(i.isFilterModified=!1),i.sortIdentifier=3),i.deType?t.getIconPath(i.deType):""}confirmCellAction(e){e.nodeModel.options.isFilterModified&&this.confirmToRestoreFilterCriteria(this.actionOnClick.bind(this,e))}actionOnClick(e){let t=this;var i=e.nodeModel;i.options.isFilterModified&&(i.options.isFilterModified=!1,i.options.filterId?t.getModels().withTransactionUpdate(()=>{t.getModels().options.context._biFilter.resetNGFilterUI({appId:t.app.core.contextManager.getAppId(),widgetId:t.app.core.contextManager.getWidgetId(),rootIds:[i.options.resourceid]}),t.isFromActionClick=!0;let e=t.getModels().options.context.xNavPersistFilterSpec.filterSpecDE.get(i.options.resourceid),n=t.app.core.dataProvider.saveFilterData[i.options.filterId];e&&n&&e.filter.filterSpecifications[0].filterCriteria.forEach((t,i)=>{let s=n.filterUIComponents[1].toFeedUI.findIndex(e=>e.criteriaType==t.criteriaType);-1!=s?e.filter.filterSpecifications[0].filterCriteria[i].addedNodesList=n.filterUIComponents[1].toFeedUI[s].addedNodesList:e.filter.filterSpecifications[0].filterCriteria.splice(i,1)}),t.getModels().options.context._biFilter.setPublicFilterSpecification({rootId:i.options.resourceid,specification:e,eventName:"setFilterSpec-"+i.options.filterId,applyFilter:1,displayFilter:0})}):!i.options.filterId&&i.options.filtered&&(i.options.deType="ContextModified"==i.options.deType?"Context":"WIP",t.getModels().options.context._biFilter.resetNGFilterUI({appId:t.app.core.contextManager.getAppId(),widgetId:t.app.core.contextManager.getWidgetId(),rootIds:[i.options.resourceid]}),delete i.options.filtered,t.getModels().refreshNodeById({modified:[i.options.resourceid]}),i.select()))}confirmToRestoreFilterCriteria(e){let t=this.app.core.dataProvider.getNLS();this.designExpUXDialog=n.getInstance(this.app);let i=this.designExpUXDialog.getButtons({onOkCallback:e,onCloseDialogCallback:this.onCloseDialog.bind(this)});this.designExpUXDialog.buildFilterCriteriaConfirmationDialog({title:t.restoreConfimrationRequestTitle,message:t.restoreConfimrationRequestMessage,buttons:i})}onCloseDialog(e){e.dsModel.dialog.close()}getCellTooltip(e){let t=this.app.core.dataProvider.getNLS();return{shortHelp:e.nodeModel&&["ContextModified","Context"].includes(e.nodeModel.options.deType)?e.nodeModel.options.isFilterModified?t.ModifiedFilterTooltip:t.RetainedFilterTooltip:e.nodeModel&&["WIP","WIPModified"].includes(e.nodeModel.options.deType)?e.nodeModel.options.isFilterModified?t.ModifiedFilterWIPTooltip:t.WIPTooltip:"",updateModel:!0}}isContext(e){let t=this;return!!this.app.core.contextManager.getActiveDesignEnv().getContext()&&this.app.core.contextManager.getContextAssets().find(i=>i.options.associatedRoot==e&&t.app.core.contextManager.isDeFilterAvailableInDGV(i)||i.getID()==e)}isWip(e){return!!this.app.core.contextManager.getActiveDesignEnv().getWip()&&this.app.core.contextManager.getWipAssets().find(t=>e==t.getID())}isLastFilterLoaded(e){this.filtersMap=this.app.core.contextManager.getContextAssets().filter(e=>this.app.core.contextManager.isFilter(e)),this.isCustomFilterLoad&&(this.filtersMap=this.filtersToLoad),this.filtersMap.length&&this.filtersMap[this.filtersMap.length-1].getID()==e.options.filterId&&(setTimeout(()=>{this.getAllPseFilters().forEach(e=>{e.options.isReadOnly&&this.getModels().readOnyRootData.readOnlyRootIds.push(e.options.resourceid),(this.app.is3dExcite||this.app.isReadOnlyInWeb)&&this.reorderFilterInPSE(e)}),this.getModels().readOnyRootData.hasReadOnlyRoot=!0,this.getModels()._cmdProxy.getReadOnlyRoots&&this.getModels()._cmdProxy.getReadOnlyRoots(this.getModels().readOnyRootData)},1e3),this.isCustomFilterLoad=!this.isCustomFilterLoad&&this.isCustomFilterLoad)}reorderFilterInPSE(e){let t=this.app.core.contextManager.getContextAssets().findIndex(t=>t.getID()==e.options.filterId),i=-1!=t?this.getChildren()[t]:"";this.getModels().withTransactionUpdate(()=>{i&&i.options.filterId!=e.options.filterId&&this.getModels().insertBefore(e,i)})}reorderDgvAssets(){let e,t,i=this.getChildren(),n=this.app.core.contextManager.getAllDesignExpAssetsOnly();i.forEach(s=>{e=n.findIndex(e=>e.getID()==s.options.resourceid),t=-1!=e?i[e]:"",this.getModels().withTransactionUpdate(()=>{t&&t.options.resourceid!=s.options.resourceid&&this.getModels().insertBefore(s,t)})})}removItems(e){Array.isArray(e)&&e.length>0&&this.app.globalModelEvent.publish({event:i.EVENT_ROOT_REMOVE,data:{pids:e}})}isItemAvailableInPSE(e){return this.getChildren().find(t=>this.isPSEFilter(t)?t.options.filterId==e.options.resourceid:e.options.resourceid==t.options.resourceid)}handleFilterModifications(e,t,i){let n,s=this,o=this.app.core.contextManager.getActiveDesignEnv().getContext().getChildren(),r=o.filter(e=>s.app.core.contextManager.isFilter(e));if(s.isFromActionClick)return s.isFromActionClick=!1,!1;if(null!=e.empty&&r.forEach(t=>{n=this.getModels().getNodesById(t.options.associatedRoot),(t.getID()==e.filterId||i&&t.getID()==i.options.filterId)&&(t.options.isFilterModified=!0,n.length&&(n[0].options.isFilterModified=!0,n[0].updateOptions(n[0].options)))}),i&&i.options.filtered&&!i.options.filterId)o.forEach(e=>{n=this.getModels().getNodesById(e.options.resourceid),e.options.resourceid==i.options.resourceid&&(e.options.isFilterModified=!0,n.length&&(n[0].options.isFilterModified=!0,n[0].updateOptions(n[0].options)))}),s.isWip(i.options.resourceid)&&(i.options.isFilterModified=!0,i.updateOptions(i.options));else if("removed"==t&&!i&&e.filterRootIds&&e.filterRootIds.length){let t=this.getModels().getNodesById(e.filterRootIds[0])[0];!t.options.filterId&&t.options.isFilterModified&&(t.options.isFilterModified=!1)}}handleAuthoringModeChange(e){e&&this.getChildren().forEach(e=>{e.options.isFilterModified&&(e.options.isFilterModified=!1,e.updateOptions(e.options))})}updateIsReadOnlyAndAssetType(e,t,i){let n=this,s=[];this.getChildren().forEach(o=>{e.find(e=>n.app.core.contextManager.isFilter(e)?o.options.resourceid==e.options.associatedRoot:e.options.resourceid==o.options.resourceid)&&(i&&(o.options.deType="add"==t?"wip"==i?"WIP":"Context":"",o.updateOptions(o.options)),o.options.isReadOnly="remove"!=t&&!!["ContextModified","Context"].includes(o.options.deType)),o.options.isReadOnly&&s.push(o.options.resourceid)}),this.getModels().readOnyRootData={hasReadOnlyRoot:!!s.length,readOnlyRootIds:s},this.getModels()._cmdProxy.getReadOnlyRoots&&this.app.pseModel._cmdProxy.getReadOnlyRoots(this.getModels().readOnyRootData),this.app.core.dataProvider.reapplySortModel()}removeItemsOnPreference(e){return new Promise(t=>{let i=e?this.getChildren().filter(e=>["ContextModified","Context","WIP","WIPModified"].includes(e.options.deType)):this.getChildren();(i=i.map(e=>e.options.resourceid))&&i.length?(this.removItems(i),t()):t()})}removeTile(e){this.app.globalModelEvent.publish({event:i.EVENT_ROOT_REMOVE_TILE,data:{tile_id:e}})}updateModifiedAssetTitle(e,t){let i=this.app.core.contextManager.getActiveDesignEnv().getAllDescendants().find(e=>e.options.resourceid==t);i&&(i.options.label=e,i.updateOptions())}updateDesignExpTitle(e){var t=this.app.core.contextManager.getActiveDesignEnv();this.getModels()._getFetchFunc(!0)({data:{physicalid:[e]},autoAttSelection:!0}).then(e=>{let i="string"==typeof e?JSON.parse(e):e;t.options.label=i.results&&i.results.length?i.results[0].attributes.find(e=>"ds6w:label"==e.name).value:t.options.label,t.updateOptions()})}addItems(e){if(Array.isArray(e)&&e.length>0){if(!this.app.isReadOnlyInWeb&&this.getModels()._getAuthoringFlag()&&e.find(e=>this.app.core.contextManager.isFilter(e)))return this.app.core.dataProvider.authoringModeErrorNotification(),!1;this.app.globalModelEvent.publish({event:i.EVENT_ROOT_ADDTITLE,data:{unserializedData:this.getUnserializedData(e),behavior:"WITHOUT_CONTEXT",broadcast:!0,mode:void 0,isDesignExpCall:!0}})}}isPSEFilter(e){return!(!e.options||!e.options.filtered)}getAllPseFilters(){return this.getChildren().filter(e=>this.isPSEFilter(e))}selectNodes(t){e.publish({event:i.EVENT_ROOT_SELECT,data:{tile_ids:t}})}filterAlreadyLoadedItemsInPSEView(e){let t=this.getChildren().map(e=>e.getID());return e.filter(e=>!t.includes(e))}collapseAll(){let e=this;require(["DS/ENXNav/commands/view/_xNavCollapseAll"],function(t){t.execute({model:e.getModels()})})}getUnserializedData(t){let i=this.app.core.contextManager.getActiveDesignEnv();return{data:{items:t.map(function(t){return{objectId:t.getID(),label:t.getLabel(),designEnvId:i.getID(),objectType:t.getType(),displayName:t.getLabel(),displayType:t.getDisplayType(),envId:e.getPlatformId(),serviceId:this.app.core.contextManager.getServiceId(),contextId:e.getSecurityContext()}}.bind(this))}}}}}),define("DS/DesignEnvironmentUX/commands/RemoveItemsGenericCmd",["DS/ApplicationFrame/Command","DS/UIKIT/Mask","DS/DesignEnvironmentUX/views/DesignExpDialogs/js/DesignExpUXDialog","DS/DesignEnvironmentUX/services/DesignEnvAlertManager","DS/DesignEnvironmentUX/utils/DesignEnvConstants","i18n!DS/DesignEnvironmentUX/assets/nls/DesignEnvironmentUX"],(e,t,i,n,s,o)=>{return class extends e{constructor(e){super(e,"Design_Env_remove_items_command"),this.app=e.app?e.app:e}remove(e){let t=this;var i="ctx"==e.getParent().getKind();this.app.core.wsDataService.removeFolderContents({folderId:e.getParent().getID(),ids:self.widget.is3dExcite?e.options.actorId:e.getID()}).then(o=>{let r=o&&o.status?o.status:self.widget.is3dExcite&&""==o?"success":"";s.STATUS_SUCCESS==r?(e.remove(!0),t.app.core.dataProvider.updateSortModelInDGV(e.options.resourceid,"remove"),t.app.core.pseCommonService.updateIsReadOnlyAndAssetType([e],"remove",i?"ctx":"wip"),this.updateEditionMode(),n.successAlert(`${e.getLabel()} is removed succesfully`)):n.errorAlert(`${e.getLabel()} is failed to remove`)})}updateEditionMode(){this.app.core.contextManager.getActiveDesignEnv().getContext().getAllDescendants().length||this.app.globalModelEvent.publish({event:"ENXModel/ReadWriteTriggered",data:!1})}removeItems(e){let i=this;this.removeItemsPromises=[],t.mask(this.app.listView.getDEContainer(),o.designenv.removingMaskTitle);let r=e.filter(e=>e.getParent().getKind()==this.app.core.designEnvConstants.KIND_CONTEXT),a=e.filter(e=>e.getParent().getKind()==this.app.core.designEnvConstants.KIND_WIP),d=[];this.addRemovalItemesToPromise(r),this.addRemovalItemesToPromise(a),Promise.allSettled(this.removeItemsPromises).then(e=>{i.removeItemsFromView(r),i.removeItemsFromView(a),d=r.map(e=>e.getType()==s.TYPE_ADVANCED_FILTER?e.options.associatedRoot:e.options.resourceid).concat(a.map(e=>e.options.resourceid)),i.app.core.dataProvider.updateSortModelInDGV(d,"remove"),i.app.core.pseCommonService.updateIsReadOnlyAndAssetType(r,"remove","ctx"),i.app.core.pseCommonService.updateIsReadOnlyAndAssetType(a,"remove","wip"),i.updateEditionMode(),t.unmask(i.app.listView.getDEContainer()),n.successAlert(o.designenv.contentRemovedsuccessMessage)})}addRemovalItemesToPromise(e){if(Array.isArray(e)&&e.length>0){let t=e.map(e=>self.widget.is3dExcite?e.options.actorId:e.getID());this.removeItemsPromises.push(this.app.core.wsDataService.removeFolderContents({folderId:e[0].getParent().getID(),ids:t}))}}removeItemsFromView(e){var t=this;if(Array.isArray(e)&&e.length>0){let i=e.map(e=>e.getID());this.app.core.dsEnvEventManager.publish(this.app.core.designEnvConstants.EVENTS_REMOVE_ITEMS,{parentNode:e[0].getParent(),ids:i}),e.map(e=>t.app.core.dataProvider.getFilterAppliedProductId(e))}}confirmToRemoveItems(e){if(1==this.isdontShowRemoveItemsDialog)return void e();this.designExpUXDialog=i.getInstance(this.app);let t=this.designExpUXDialog.getButtons({onOkCallback:e,onCloseDialogCallback:this.onCloseDialog.bind(this)});this.designExpUXDialog.buildRemoveItemsConfirmationDialog({title:o.designenv.removeItemsDialogTitle,message:o.designenv.removeItemsDialogMessage,buttons:t,showDonNotShowAttr:!0})}onCloseDialog(e,t){e.dsModel.dialog.close(),this.isdontShowRemoveItemsDialog=t}}}),define("DS/DesignEnvironmentUX/commands/RemoveItemsFromFolderCmd",["DS/DesignEnvironmentUX/commands/RemoveItemsGenericCmd"],e=>{return class extends e{constructor(e){super(e,"Design_Env_remove_items_command"),this.app=e.app}execute(){let e=this.app.core.contextManager.getSelectedItems();Array.isArray(e)?this.confirmToRemoveItems(this.removeItems.bind(this,e)):e&&this.confirmToRemoveItems(this.remove.bind(this,e))}}}),define("DS/DesignEnvironmentUX/commands/RemoveContentCmd",["DS/DesignEnvironmentUX/commands/RemoveItemsGenericCmd"],e=>{return class extends e{constructor(e){super(e,"Design_Env_remove_content_command"),this.app=e.app}execute(){let e=this.app.core.contextManager.getSelectedItems();Array.isArray(e)?0==e.length?this.confirmToRemoveItems(this.remove.bind(this,this.app.core.contextManager.getSelectedContext())):this.confirmToRemoveItems(this.removeItems.bind(this,e)):this.confirmToRemoveItems(this.remove.bind(this,e))}}}),define("DS/DesignEnvironmentUX/models/DesignEnvItemModel",["DS/TreeModel/TreeNodeModel","DS/DesignEnvironmentUX/services/DesignEnvEventsManager","DS/DesignEnvironmentUX/utils/DesignEnvConstants"],(e,t,i)=>{return class extends e{constructor(e){e.grid=e&&e.grid?e.grid:{},super(e),this.options=e}getID(){return this.options.resourceid}getRootID(){return this.options.associatedRoot}getType(){return this.options.objectType}getDisplayType(){return this.options.displayType}getKind(){return this.options.kind}getContext(){return i.KIND_DESIGNENV==this.getKind()?this.getChildren().find(e=>i.KIND_CONTEXT==e.getKind()):void 0}getWip(){return i.KIND_DESIGNENV==this.getKind()?this.getChildren().find(e=>i.KIND_WIP==e.getKind()):void 0}getContents(){let e=[];return i.KIND_DESIGNENV!=this.getKind()?this.getChildren():(e.push.apply(e,this.getContext().getChildren()),e.push.apply(e,this.getWip().getChildren()),e)}}}),define("DS/DesignEnvironmentUX/services/DesignEnvFactory",["DS/DesignEnvironmentUX/models/DesignEnvItemModel","DS/DataGridView/DataGridView","DS/DataGridView/DataGridViewLayout","DS/DesignEnvironmentUX/collections/DesignEnvTreeDocument","DS/DesignEnvironmentUX/services/HelperService","DS/DesignEnvironmentUX/utils/DesignEnvConstants","UWA/Core","DS/UIKIT/Spinner","css!DS/UIKIT/UIKIT.css"],(e,t,i,n,s,o,r,a,d)=>{let l=null;return class{constructor(e){return l||this.getNewInstance(e)}getNewInstance(e){return this.app=e&&e.app?e.app:{},l=this,this}createDesignEnvItem(t){let i=this._buildDesignEnvItemOptions(t);return new e(i)}createSubFolder(t){let i=this._buildOptionsForSubFolder(t);return new e(i)}createContentItem(t,i){let n=this._buildOptionsForContent(t,i);return new e(n)}createDataGridViewLayout(e){return new i({cellHeight:38,rowsHeader:!1,columnsHeader:!1})}createDataGridView(e){return e.placeholder=this.createLoadingElement(this),new t(e)}createLoadingElement(e){return r.createElement("div",{class:"mask-wrapper",html:{tag:"div",class:"mask-content",html:[new a({visible:!0,animate:!0,spin:!0}),r.createElement("span",{class:"text font-size",text:e.app.core.dataProvider.getNLS().readOnlyModeLoadMessage})]}})}createModel(){return new n({})}_buildOptionsForContent(e,t){let i=e.objectId,n=e.objectType==o.TYPE_ADVANCED_FILTER||e.isFiltered?"filter":"product";return{resourceid:i,kind:"content",label:e.displayName,displayType:e.displayType,objectType:e.objectType,associatedRoot:this.app.core.dataProvider.getFilterAppliedProductIdFromFilter(i),icons:[{iconName:n,fontIconFamily:WUXManagedFontIcons.Font3DS}],...this.app.core.dataProvider.app.is3dExcite&&{actorId:e.actorID}}}_buildOptionsForSubFolder(e){let t=e.displayName,i=t===o.LABEL_CONTEXT,n=s.getIconPath(i?"Context":"WIP");return{resourceid:e.objectId,label:t,type:e.objectType,kind:t===o.LABEL_CONTEXT?o.KIND_CONTEXT:o.KIND_WIP,deid:e.deid,children:[],icons:[n]}}_buildDesignEnvItemOptions(e){return{resourceid:e.objectId,label:e.displayName,kind:o.KIND_DESIGNENV,deid:e.objectId,detype:e.objectType,objectType:e.objectType,children:[],icons:[{iconName:"user-cog",fontIconFamily:WUXManagedFontIcons.Font3DS}],grid:{version:0}}}}}),define("DS/DesignEnvironmentUX/views/DesignEnvLeftSidePanel/js/mixins/DesignEnvListViewManager",["DS/DesignEnvironmentUX/utils/DesignEnvConstants","DS/Utilities/UUID","DS/DesignEnvironmentUX/utils/DesignEnvUtils","i18n!DS/DesignEnvironmentUX/assets/nls/DesignEnvironmentUX","DS/DesignEnvironmentUX/utils/DesignEnvUtils"],(e,t,i,n,s)=>{return class{constructor(e){this.options=e,this.core=this.options&&this.options.core?this.options.core:{},this.initialize()}initialize(){this.core.dsEnvEventManager.subscribePlatformEvent(e.EVENT_CROSS_HEIGHLIGHT_SELECT,this.applyCrossHighlights.bind(this)),this.core.dsEnvEventManager.subscribe(e.EVENTS_RESET_VIEW,this._resetView.bind(this)),this.core.dsEnvEventManager.subscribe(e.EVENTS_ADD_ITEM,this._addContent.bind(this)),this.core.dsEnvEventManager.subscribe(e.EVENTS_REMOVE_ITEMS,this._removeContents.bind(this)),this.assetsToHighlightOnlyInDE=[]}getDgvViewOptions(){let e=UWA.extend({treeDocument:this.getModels(),columns:this.getColumnsInfo()},this.getDefaultOptions());return this.handleDataGridViewAction(e)}handleDataGridViewAction(e){return e.onDragStartCell=this._dragStart.bind(this),e.onContextualEvent=this._onContextualEvent.bind(this),e.onDropCell=this._dropCell.bind(this),e.onDragOverCell=this._dragOverCell.bind(this),e}getTabLabel(){return n.designenv.tablabel}getDefaultOptions(){return{defaultColumnDef:{width:"auto",typeRepresentation:"string"},cellDragEnabledFlag:!0,showRowIndexFlag:!1,showAlternateBackgroundFlag:!1,rowSelection:"multiple",cellSelection:"none",showContextualMenuColumnFlag:!this.options.isReadOnly,selectionBehavior:this.getSelectionBehavior(),treeNodeCellOptions:{expanderStyle:"triangle",buildLinks:!1}}}getSelectionBehavior(){return{canInteractiveMultiselectWithCheckboxClick:!0,canMultiSelect:!0,enableFeedbackForActiveCell:!0,enableShiftSelection:!0,toggle:!1,unselectAllOnEmptyArea:!0}}getColumnsInfo(){return[{dataIndex:"tree",typeRepresentation:"string",editableFlag:!1,sortableFlag:!1,resizableFlag:!1}]}handleDataGridViewEvents(e){}onSelectionUpdated(e){let t;this.isInternalCall=!0;let i=this,n=[];if(this.isSelectionFromDE=!1,!this.isCrossHighLights){e.forEach(e=>{this.selectAllContents(e)}),this.filteredDeAssets=[],this.pseFilters=this.options.isReadOnly?[]:i.core.pseCommonService.getAllPseFilters();let s=this.getModels().getSelectedNodes();this.isSelectionFromMultiSelect=!1,this.options.isReadOnly?(this.options.deFolderNodes.forEach(e=>{"designenv"!=e.getKind()&&this.core.contextManager.updateFolderBorder(e.getKind(),"remove")}),1==s.length&&this.core.dataProvider.getDeTypes().includes(s[0].getKind())?(this.core.contextManager.updateFolderBorder(s[0].getKind(),"update"),s[0].unselect(),s=[]):i.filteredDeAssets=s.filter(e=>!i.core.dataProvider.getDeTypes().includes(e.getKind()))):s.forEach(e=>{let t=this.pseFilters.find(t=>t.options.resourceid==e.getID()&&t.options.filtered&&t.options.filterId);i.core.contextManager.isFilter(e)?i.core.contextManager.isDeFilterAvailableInDGV(e)&&i.filteredDeAssets.push(e):t?this.assetsToHighlightOnlyInDE.push(e):i.filteredDeAssets.push(e),s.length>1&&(this.core.pseCommonService.isItemAvailableInPSE(e)||this.core.dataProvider.getDeTypes().includes(e.getKind())||n.push(e)),this.isSelectionFromDE=!0}),t=i.filteredDeAssets.map(e=>this._getId(e)),this.options.isReadOnly?this.options.isReadOnly&&this.applyCrossHighlights(this.buildEventDataForReadOnly(t)):this.core.pseCommonService.selectNodes(t),n.length&&!s.find(e=>this.core.dataProvider.getDeTypes().includes(e.getKind()))&&(n.forEach(e=>{this.isSelectionFromMultiSelect=!0,e.select()}),n=[]),this.isSelectionFromDE=!1}this.isInternalCall=!1}buildEventDataForReadOnly(e){return{data:{attributes:{},sharedID:this.core.contextManager.getSharedId(),paths:e,focusOn:!1,tenant:s.getPlatformId(),version:"1.1"},metadata:{appid:s.getAppId(),xappid:s.getAppId(),originWidgetId:s.getWidgetId(),uid:s.uid(),timestamp:Date.now()}}}checkForMismatch(e,t){return e.length<t.length||!t.every(t=>e.some(e=>e.options.resourceid===t.options.resourceid&&!e.options.filtered||e.options.filterId===t.options.resourceid))}applyCrossHighlights(e){let t=this;if("undefined"!=typeof widget&&null!==widget&&widget.id,!e||!e.data||!Array.isArray(e.data.paths))return;if(this.isInternalCall)return void(this.isInternalCall=!1);if(this.isSelectionFromMultiSelect)return void(this.isSelectionFromMultiSelect=!1);this.isCrossHighLights=!0;let i=[],n=!1,s=this.options.isReadOnly?[]:this.core.pseCommonService.getChildren(),o=this.getModels().getAllDescendants().filter(e=>!this.core.dataProvider.getDeTypes().includes(e.options.kind)),r=s.length;if(n=!this.options.isReadOnly&&this.checkForMismatch(s,o),this.getModels().unselectAll(),this.core.contextManager._activeDesignEnv&&this.core.contextManager._activeDesignEnv.getContext()&&(i=this.core.contextManager._activeDesignEnv.getContext().__children),o.length&&o.forEach(i=>{function s(e,n){let s=t.core.contextManager.isFilter(i)?t.core.dataProvider.getFilterAppliedProductId(i):void 0,o=t.options.isReadOnly?[]:t.core.pseCommonService.getModels().getNodesById(e);!n&&o.length&&(t.core.pseCommonService.isPSEFilter(o[0])||t.core.contextManager.isFilter(i))?i.getID()==o[0].options.filterId?i.select():o[0].options.filtered&&!o[0].options.filterId&&i.getID()==o[0].options.resourceid&&i.select():n?e!=i.getID()||t.core.contextManager.isFilter(i)?e==i.getID()&&t.core.contextManager.isFilter(i)?i.select():o.length&&o[0].options.filtered&&!o[0].options.filterId&&i.getID()==o[0].options.resourceid&&i.select():i.select():e!=i.getID()&&(e!=s||!t.options.isReadOnly&&t.core.contextManager.isDeFilterAvailableInDGV(i))||i.select()}(r||this.options.isReadOnly)&&e.data.paths.forEach(e=>{Array.isArray(e)?e.forEach(s):s(e)}),this.options.isReadOnly||(!e.data.paths.length&&e.data.dePaths&&e.data.dePaths.length&&n&&e.data.dePaths.forEach(e=>s(e,!0)),!e.data.paths.length&&t.assetsToHighlightOnlyInDE.length&&(t.assetsToHighlightOnlyInDE.forEach(e=>s(e.getID(),!0)),t.assetsToHighlightOnlyInDE=[]),e.data.paths.length&&e.data.dePaths&&e.data.designAssetTypeSelection&&e.data.dePaths.forEach(e=>s(e,!0)),e.data.dePaths&&e.data.dePaths.length>1&&!e.data.designAssetTypeSelection&&e.data.dePaths.forEach(e=>s(e,!0)))}),this.isCrossHighLights=!1,i.length&&!this.options.isReadOnly&&this.options.globalModelEvent.publish({event:"ENXModel/ReadWriteTriggered",data:!!i.filter(e=>e._isSelected).length}),this.core.contextManager.getActiveDesignEnv()&&this.options.deFolderNodes&&this.options.deFolderNodes.filter(e=>!e.isExpanded()).length){let e=this.core.contextManager.isWipSelected(),t=this.core.contextManager.isCtxSelected();e&&!this.options.deFolderNodes[2].isExpanded()&&(this.options.deFolderNodes[2].highlight(),this.core.contextManager.updateFolderBorder("wip","update")),t&&!this.options.deFolderNodes[1].isExpanded()&&(this.options.deFolderNodes[1].highlight(),this.core.contextManager.updateFolderBorder("ctx","update")),this.options.deFolderNodes[0].isExpanded()||!e&&!t||(this.options.deFolderNodes[0].highlight(),this.core.contextManager.updateFolderBorder("designenv","update"))}let a=this.options.deFolderNodes?this.options.deFolderNodes.filter(e=>e.isHighlighted()):[];a.length&&!t.core.dataProvider.getItemsAsArray(t.core.contextManager.getSelectedItems()).length&&a.forEach(e=>{e.unhighlight(),t.core.contextManager.updateFolderBorder(e.getKind(),"remove")})}selectAllContents(e){e&&e.getChildren()&&e.getChildren().length>0&&(e.isSelected()&&!e.areAllChildrenSelected()?e.selectAll():e.isSelected()||e.areAllChildrenUnselected()||e.unselectAll())}_getId(t){return t.getType()==e.TYPE_ADVANCED_FILTER?this.core.dataProvider.getFilterAppliedProductIdFromFilter(t.getID()):t.getID()}_addContent(e){this.core.dataProvider.addContent(e),"ctx"===e.kind&&this.options.globalModelEvent.publish({event:"ENXModel/ReadWriteTriggered",data:!0})}_resetView(e){this.core.dataProvider.resetView(e)}_removeContents(e){let t=this.getModels(),i=t.getAllDescendants().filter(t=>e.ids.indexOf(t.getID())>=0);t.prepareUpdate(),1==e.removeAll?e.parentNode.removeChildren():i.forEach(t=>{e.parentNode.removeChild(t)}),i.forEach(e=>{t.removeRoot(e)}),t.pushUpdate()}_onContextualEvent(e){var t=this;return new Promise(function(i){if(e.cellInfos){let i=e.cellInfos.nodeModel;i._isSelected||t.getModels().unselectAll(),t.options.core.contextManager.setSelectedContext(i),i.isSelected()||i.select(),t.selectAllContents(i)}i(t.options.core.commandService.renderMenu())})}_dragOverCell(e,t){if(e.dataTransfer)switch(t.nodeModel.options.kind){case"ctx":case"wip":case"designenv":e.dataTransfer.dropEffect="copy",e.preventDefault();break;default:this._dragStart(e,t)}return!0}_dropCell(e,t){let i=this,n=t.nodeModel;if(!this.options.isReadOnly&&!this.options.isReadOnlyInWeb)switch(n.options.kind){case"ctx":case"wip":e.preventDefault(),e.stopPropagation();var s={deid:n.options.deid,kind:n.options.kind};try{s.data=JSON.parse(e.dataTransfer.getData("text"))}catch(e){wrongDropFormat=!0}var o=s.data.data.items;if(o){let e=o.filter(e=>e.path&&e.path.length>1);if(e.length){let t=e.filter(e=>o.find(t=>t.objectId==e.path[0].resourceid));s.data.data.items=t.length?o.filter(e=>!t.find(t=>t.objectId==e.objectId)):o}}let t=s.data.data.items.filter(e=>"ENOStrRefinementSpecification"==e.objectType&&!e.filterId&&!e.filterTitle).map(e=>e.objectId);t.length?i.core.dataProvider._getRootsForFilters(t).then(e=>{o.forEach(t=>{"ENOStrRefinementSpecification"==t.objectType&&(t.rootId=e.find(e=>e[t.objectId])[t.objectId].rootPhysicalId,t.isFiltered=!0)}),i._addContent(s)}):i._addContent(s)}}_dragStart(e,n){let s=this,o=n.draggedNodes&&n.draggedNodes.length&&n.draggedNodes[0].options.kind?n.draggedNodes:n.nodeModel,r={protocol:"3DXContent",version:"1.1",source:t.v4(),widgetId:"undefined"==typeof widget?t.v4():widget.id,data:{items:[]}};function a(e){Array.isArray(e)?e.forEach(e=>{d(e)}):d(e)}function d(e){if(e.getType()&&r.data.items.push({envId:i.getPlatformId(),serviceId:s.core.contextManager.getServiceId(),contextId:i.getSecurityContext(),objectId:e.getID(),objectType:e.getType(),displayName:e.getLabel(),displayType:e.getDisplayType(),designEnvType:e.getKind()?e.getKind():parentkind,associatedRoot:e.options.associatedRoot}),e.hasChildren()){let i=e.getChildren();for(var t=0;t<i.length;t++)a(i[t],e.getKind())}}return a(o),e.dataTransfer.setData("text",JSON.stringify(r)),e.dataTransfer.effectAllowed="all",!1}}}),define("DS/DesignEnvironmentUX/utils/Utils",["DS/DesignEnvironmentUX/utils/DesignEnvConstants"],e=>{return class{static isAdvancedFilter(t){return null!=t&&(t.objectType==e.TYPE_ADVANCED_FILTER||t.displayType==e.DISPLAY_TYPE_ADVANCED_FILTER)}}}),define("DS/DesignEnvironmentUX/services/DesignEnvDataProvider",["DS/DesignEnvironmentUX/services/DesignEnvAlertManager","DS/DesignEnvironmentUX/utils/DesignEnvUtils","DS/DesignEnvironmentUX/utils/DesignEnvConstants","DS/DesignEnvironmentUX/utils/Utils","DS/UIKIT/Mask","i18n!DS/DesignEnvironmentUX/assets/nls/DesignEnvironmentUX","text!DS/DesignEnvironmentUX/assets/menus/DesignExpSettings.json"],(e,t,i,n,s,o,r)=>{return class{constructor(e){this.app=e.app?e.app:e,this.options=e,this.initialize(e)}initialize(e){this.filtersRootsMap={},this.contentLoaderPromise=[],this.saveFilterData={}}getNewInstance(e){return this.options=e,instance=this,this}buildPreferences(e){return Object.keys(e).map(t=>({defaultValue:e[t].value,name:t,type:e[t].preference.type,label:o.designenv[e[t].preference.label]}))}fetchPreferences(){return this.buildPreferences(JSON.parse(r).preferences)}buildFetchParams(e){return{pids:[e],data:{select_predicate:["ds6w:label"]},isReadOnly:this.app.isReadOnly}}getDesignEnvItem(e){let i=this,n=i.app.core;return this.models=this.app.isReadOnly?{}:n.pseCommonService.getModels(),new Promise(function(o){t.init({initURL:!0,initWSAccess:!0}).then(function(){t.retrieveAndSetSC().then(function(){1===e.length&&(s.mask(i.app.listView.getDEContainer(),"Loading Design Experience..."),n.wsDataService.getDesignExperienceLabel(i.buildFetchParams(e[0].objectId)).then(t=>{e[0].displayName=i.app.isReadOnly&&t?t:e[0].displayName;let r=n.factory.createDesignEnvItem(e[0]);i.app.isReadOnly||(i.widget=i.models.options.context.options.widget),n.contextManager.setActiveDesignEnv(r),n.wsDataService.getFolderContent(r).then(function(e){i.app.is3dExcite&&(e.data={items:[{objectId:r.getID(),label:i.getNLS().contextLabel,displayName:i.getNLS().contextLabel,objectType:"Workspace Vault",envId:"OnPremise",serviceId:"3DSpace",contextId:"ctx::VPLMProjectLeader.MyCompany.3DS Collab Space"},{objectId:r.getID(),label:i.getNLS().wipLabel,displayName:i.getNLS().wipLabel,objectType:"Workspace Vault",envId:"OnPremise",serviceId:"3DSpace",contextId:"ctx::VPLMProjectLeader.MyCompany.3DS Collab Space"}]}),i.buildSubFolders(e.data.items),Promise.allSettled(i.contentLoaderPromise).then(e=>{i.buildDesignExpContents(e).forEach(e=>{r.addChild(e)}),i.app.deFolderNodes=i.app.listView.getModels().getAllDescendants().filter(e=>i.getDeTypes().includes(e.options.kind)),n.contextManager.handleExpandCollapseEvents(),i.app.isReadOnly||(n.pseCommonService.removeItemsOnPreference(!1).then(()=>{setTimeout(()=>{i.widget.getValue("autoload_items")&&(n.pseCommonService.addItems(r.getContents()),setTimeout(()=>{r.getContext().getChildren().length&&(n.pseCommonService.updateIsReadOnlyAndAssetType(r.getContext().getChildren().filter(e=>!i.app.core.contextManager.isFilter(e))),n.pseCommonService.applyDefaultSort(),i.app.isReadOnlyInWeb&&i.app.is3dExcite&&(n.pseCommonService.reorderDgvAssets(),n.pseCommonService.reorderDgvAssets()))},1e3))},300)}),n.pseCommonService.addOrRemoveEvents("add",!0),setTimeout(()=>{i.reapplySortModel()},200)),s.unmask(i.app.listView.getDEContainer())}),r.expandAll(),i.app.isReadOnly||i.app.globalModelEvent.publish({event:n.designEnvConstants.GLOBAL_EVENT_CLOSE_LANDING_PAGE}),o(r)})}))})})})}buildDesignExpContents(e){return this.app.is3dExcite?e.filter(e=>"fulfilled"==e.status).map(e=>e.value)[0].sort((e,t)=>e.getKind()>t.getKind()?1:-1):e.filter(e=>"fulfilled"==e.status).map(e=>e.value).sort((e,t)=>e.getKind()>t.getKind()?1:-1)}buildSubFolders(e){if(this.contentLoaderPromise=[],e)if(this.app.is3dExcite)this.contentLoaderPromise.push(this.buildFolder3dExcite(e));else for(let t of e)this.contentLoaderPromise.push(this.buildFolder(t))}buildFolder(e){let t=this;return new Promise((i,n)=>{let s=this.createFolder(e);if(null!=s){if(self.widget&&self.widget.newDesignExpCreated)return"wip"==s.getKind()&&(self.widget.newDesignExpCreated=!1),i(s),!1;t.app.core.wsDataService.getFolderContent(s).then(function(e){t.buildFolderContent(e,s.getKind()).then(e=>{Array.isArray(e)&&e.length>0&&(s.addChild(e),s.expand()),i(s)})})}})}buildFolder3dExcite(e){var t=this,i=e.map(e=>this.createFolder(e)),n=[];return new Promise((e,s)=>{if(i.length){if(self.widget&&self.widget.newDesignExpCreated)return self.widget.newDesignExpCreated=!1,e(i),!1;t.app.core.wsDataService.getFolderContent(i[0]).then(function(s){s.data.items||(s.data.items=[]);let o=s.data.items.reduce((e,t)=>(e["DEContextActor"==t.actorType?"DEContextActor":"DEWIPActor"].push(t),e),{DEContextActor:[],DEWIPActor:[]});i.forEach(i=>{"ctx"==i.getKind()&&!o.DEContextActor.length||"wip"==i.getKind()&&!o.DEWIPActor.length?(n.push(i),2==n.length&&e(n)):t.buildFolderContent("ctx"==i.getKind()?o.DEContextActor:o.DEWIPActor,i.getKind()).then(t=>{Array.isArray(t)&&t.length>0&&(i.addChild(t),i.expand()),n.push(i),2==n.length&&e(n)})})})}})}buildFolderContent(e,t){let n=(e=this.areValidContents(e,t)).data?e.data.items:e;return t===i.KIND_CONTEXT?this.getContextItems(n):t===i.KIND_WIP?this.getWipItems(n):void 0}createFolder(e,t){return e.objectType===i.TYPE_SUB_FOLDER?this.app.core.factory.createSubFolder(e):null}getContextItems(e){let t=this;return new Promise((i,s)=>{let o=e.filter(n.isAdvancedFilter.bind(t)).map(e=>e.objectId),r=e.filter(e=>1==e.isFiltered).map(e=>e.filterId);Array.isArray(o)&&o.length>0?t._getRootsForFilters(o).then(function(n){i(t.getItems(e))}):Array.isArray(r)&&r.length>0?t.buildFilteredItems(e,r).then(e=>{i(e)},e=>{s(e)}):i(t.getItems(e))})}getWipItems(e){let t=this;return new Promise((i,n)=>{i(t.getItems(e))})}authoringModeErrorNotification(){e.warningAlert(o.designenv.errorDeNotAllowedInAuthoring)}getNLS(){return o.designenv}getDeConstants(){return i}getDeTypes(){return["designenv","wip","ctx"]}getItems(e){let t=this;return e.map(e=>t.app.core.factory.createContentItem(e))}getItemsAsArray(e){return Array.isArray(e)?e:[e]}buildFilteredItems(e,t){let i=this;return new Promise((n,s)=>{let r=!1;t.forEach(e=>{void 0!==e||(r=!0)}),r?s({message:o.designenv.errorFilterIsNotSaved}):(e=e.map(e=>1==e.isFiltered?i.app.core.dataBuilder.getContentOption(e):e),i._getRootsForFilters(t).then(function(t){for(var s of e)"ENOStrRefinementSpecification"==s.objectType&&(s.displayName=t.filter(e=>e[s.objectId])[0][s.objectId].filterTitle);n(i.getItems(e))}))})}areValidContents(t,s){if(this.app.is3dExcite&&!t.length&&(!t.data||!t.data.items))return!1;if(!(this.app.is3dExcite||t.data&&t.data.items&&Array.isArray(t.data.items)))return!1;t.data&&t.data.items&&(t=t.data.items);let r=[];for(let a of t)a.objectType.includes(i.TYPE_WORKSPACE)||(s!=i.KIND_WIP||1!=a.isFiltered&&!n.isAdvancedFilter(a)?a.rootId&&this.checkExisting(a.rootId)||this.checkExisting(a.objectId)?e.warningAlert(a.isFiltered?o.designenv.FiltersFromSameRootMessage:o.replace(o.designenv.warningExisting,{label:a.displayName})):a.path&&a.path.length>1&&this.options.app.core.contextManager.getActiveDesignEnv().getAllDescendants().find(e=>e.getID()==a.path[0].resourceid||e.getRootID()==a.path[0].resourceid)?e.warningAlert(o.replace(o.designenv.warningExisting,{label:a.displayName})):r.push(a):e.warningAlert(o.designenv.warningFiltersNotAllowedToWIP));return r}addContent(t){let i=this,n="string"==typeof t.data?JSON.parse(t.data):t.data,o=this.app.core.contextManager.getActiveDesignEnv();if(n.data.items.length>0){s.mask(i.app.listView.getDEContainer(),"Loading...");let r="ctx"==t.kind?o.getContext():o.getWip();this.buildFolderContent(n,t.kind).then(e=>{Array.isArray(e)&&e.length>0?i.app.core.wsDataService.addFolderContent(r,e).then(t=>{i.app.is3dExcite&&t.results&&t.results.length&&e.forEach(e=>{e.options.actorId=t.results.find(t=>t.AssetID==e.getID()).ActorID}),r.addChild(e),r.expand(),i.addItemsToPseView(e,r.options.kind),s.unmask(i.app.listView.getDEContainer())}):s.unmask(i.app.listView.getDEContainer())},t=>{e.warningAlert(t.message),s.unmask(i.app.listView.getDEContainer())})}}addItemsToPseView(e,t){let i=this,n=(e.map(e=>(e.select(),t&&(e.options.sortIdentifier="ctx"===t?3:2,i.updateSortModelInDGV(i.app.core.contextManager.isFilter(e)?e.options.associatedRoot:e.options.resourceid,"added",t)),this._getId(e))),e.filter(e=>!this.app.core.pseCommonService.isItemAvailableInPSE(e)));this.models.withTransactionUpdate(()=>{i.app.core.pseCommonService.addItems(n),setTimeout(()=>{i.app.core.pseCommonService.updateIsReadOnlyAndAssetType(e,"add",t)},300)})}updateSortModelInDGV(e,t,i){let n,s=this;"remove"===t?Array.isArray(e)?e.forEach(e=>{(n=s.models.getNodesById(e)).length&&(n[0].options.sortIdentifier=1)}):(n=s.models.getNodesById(e)).length&&(n[0].options.sortIdentifier=1):"added"===t&&(n=s.models.getNodesById(e)).length&&(n[0].options.sortIdentifier="ctx"===i?3:2)}reapplySortModel(){this.models.options.context.getPADDGVView().options.dgv.reapplySortModel()}getFilterAppliedProductIdFromFilter(e){return this.filtersRootsMap[e]?this.filtersRootsMap[e]:e}_getRootsForFilters(e){let t=this;return new Promise(function(i,n){e.length>0?t.app.core.wsDataService.getRootsForFilters({data:{filterids:e}}).then(function(e){if((e="string"==typeof e?JSON.parse(e):e).success){for(var s=0;s<e.success.length;s++)for(var o=e.success[s],r=Object.getOwnPropertyNames(o),a=0;a<r.length;a++)t.filtersRootsMap[r[a]]=o[r[a]].rootPhysicalId,t.saveFilterData[r[a]]||(t.saveFilterData[r[a]]=o[r[a]]);i(e.success)}else n()}):i(t.filtersRootsMap)})}checkExisting(e){return!!this.app.core.contextManager.getActiveDesignEnv().getAllDescendants().find(t=>this.app.core.contextManager.isFilter(t)&&t.options.associatedRoot==e||t.options.resourceid===e)}getMissingItems(){let e=this,t=this.app.core,i=t.contextManager.getSelectedContext();if(!i.getContents())return t.contextManager.getSelectedItems().filter(e=>!t.pseCommonService.isItemAvailableInPSE(e));let n=t.pseCommonService.getChildren().map(e=>e.getID());return i.getContents().filter(t=>-1==n.indexOf(e._getId(t)))}isItemInPseView(){let e=this.app.core.contextManager.getSelectedContext();return this.app.core.pseCommonService.getChildren().map(e=>e.getID()).indexOf(this._getId(e))>=0}getFilterAppliedProductId(e){return this._getId(e)}_getId(e){return e.getType()==i.TYPE_ADVANCED_FILTER?this.getFilterAppliedProductIdFromFilter(e.getID()):e.getID()}}}),define("DS/DesignEnvironmentUX/ws/WSAccess",["DS/WAFData/WAFData","DS/DesignEnvironmentUX/utils/DesignEnvUtils"],function(e,t){"use strict";function i(){return"object"==typeof i.instance?i.instance:(i.instance=this,this)}return i.prototype.getKind=function(){return"Static"},i.prototype.initialize=function(e){return new Promise(function(t,n){var s=[],o=[];if(!0===e.addDefaults&&(o=o.concat(["DS/DesignEnvironmentUX/ws/WSMisc","DS/DesignEnvironmentUX/ws/WSDesignEnv","DS/DesignEnvironmentUX/ws/WSDesignExp"])),Array.isArray(e.WSDefinitionAMDs)&&(o=o.concat(e.WSDefinitionAMDs)),Array.isArray(o))for(var r=0;r<o.length;r++){var a=r;s.push(new Promise(function(e,t){require([o[a]],function(t){i.prototype=Object.assign(i.prototype,t.prototype),e()},t)}.bind(this)))}Promise.all(s).then(t).catch(n)}.bind(this))},i.prototype.executeRequest=function(i,n,s,o){var r=t.getSecurityContext();if(UWA.is(r,"string")&&!0!==s&&(n.headers.SecurityContext=r,!0!==o)){var a=t.getUser();a&&a.login&&(n.headers.SecurityToken=a.login+"|"+r+"|preferred")}return e.authenticatedRequest(i,n)},i.prototype.executeRequestPromise=function(e,t){var i=this;return new Promise(function(n,s){t.onComplete=function(e){var t=function(e){return"string"==typeof e&&e?JSON.parse(e):e}(e);n(t)},t.onFailure=function(e){s(e)},t.onTimeout=function(e){s(e)},["POST","DELETE"].includes(t.method)&&"string"!=typeof t.data&&(t.data=JSON.stringify(t.data)),i.executeRequest(e,t)})},new i}),define("DS/DesignEnvironmentUX/services/WSDataService",["DS/DesignEnvironmentUX/ws/WSAccess","i18n!DS/DesignEnvironmentUX/assets/nls/DesignEnvironmentUX"],(e,t)=>{return class{constructor(e){this.core=e&&e.app?e.app.core:e}addFolderContent(t,i){return this.core.dataProvider.app.is3dExcite?e.addExperienceAssets({actorKind:t._options.kind,deId:t._parentNode.getID(),assets:i.map(e=>e.getID())}):e.addFolderContent({folderId:t.getID(),ids:i.map(e=>e.getID())})}getRootsForFilters(t){return e.getFiltersFromIds(t)}getDesignExperienceLabel(t){return new Promise(i=>{t.isReadOnly?e.fetch(t).then(e=>{let t="string"==typeof e?JSON.parse(e):e;t=t.results&&t.results.length?t.results[0].attributes.find(e=>"ds6w:label"==e.name):"",i(t?t.value:t)}):i()})}getFolderContent(t){let i=this;var n,s=t.getKind();return new Promise(function(o){i.core.dataProvider.app.is3dExcite?"designenv"==s?o(i.core.dataBuilder.buildContentOptions(void 0)):["ctx","wip"].includes(s)&&e.getExperienceAssets({actorKind:s,deId:t.getID()}).then(e=>{n="string"==typeof e?JSON.parse(e):e,!e.hasOwnProperty("")&&n.results&&n.results.length&&(n.results=n.results.filter(e=>e.AssetType)),o(i.core.dataBuilder.buildContentOptions(e.hasOwnProperty("")?void 0:n))}):i.core.dataProvider.app.is3dExcite||e.getFolderContent({folderId:t.getID()}).then(function(e){let t="string"==typeof e?JSON.parse(e):e;o(i.core.dataBuilder.buildContentOptions(t))})})}removeFolderContents(t){return this.core.dataProvider.app.is3dExcite?(t.ids=this.core.dataProvider.getItemsAsArray(t.ids),e.removeExperienceAssets(t)):e.removeFolderContents(t)}inAppsSearch(t){return e.inAppsSearch(t)}}}),define("DS/DesignEnvironmentUX/DesignEnvCore",["DS/DesignEnvironmentUX/services/DesignEnvEventsManager","DS/DesignEnvironmentUX/utils/DesignEnvConstants"],(e,t)=>{let i={};const n="DS/DesignEnvironmentUX/services/";return class{constructor(e){i={app:e},this.initialize()}initialize(){this.mandatoryPromises=[],this.mandatoryStartupPromises=[],this.dsEnvEventManager=new e(i),this.initServices()}start(){let e=this;return new Promise((t,i)=>{Promise.allSettled(e.mandatoryPromises).then(()=>{Promise.allSettled(e.mandatoryStartupPromises).then(()=>{t(!0)})})})}initServices(){this.loadConstant(),this.servicesMap=[{key:"commandService",name:"CommandsService"},{key:"contextManager",name:"DesignEnvContextManager"},{key:"searchService",name:"DesignEnvSearchService"},{key:"dataProvider",name:"DesignEnvDataProvider"},{key:"factory",name:"DesignEnvFactory"},{key:"pseCommonService",name:"PseCommonService"},{key:"dataBuilder",name:"DataBuilder"},{key:"wsDataService",name:"WSDataService"}],this.loadServices(this.servicesMap)}loadServices(e){let t=this;return e.forEach(e=>{let i=new Promise((i,n)=>{t.requireService(e,i,n)});t.mandatoryPromises.push(i)}),this}requireService(e,t,s){let o=this;require([n+e.name],n=>{let s=new n(i);s.initialize&&s.initialize(),o[e.key]=s,t()})}loadConstant(){this.designEnvConstants=t}isValidSelectionForOpen(){return!0}}}),define("DS/DesignEnvironmentUX/DesignEnvironment",["DS/DesignEnvironmentUX/DesignEnvCore","DS/DesignEnvironmentUX/services/DesignEnvAlertManager","DS/DesignEnvironmentUX/utils/DesignEnvUtils"],(e,t,i)=>{return class{constructor(e){e&&(this.modelEvent=e.modelEvent,i.setModelEvents(e.modelEvent),this.globalModelEvent=e.globalModelEvent,this.pseModel=e.pseModel,this.isReadOnlyInWeb=e.isReadOnlyInWeb),e&&i.isValidDesignEnv(e.designEnvCtx)?this.initialize(e):t.errorAlert("Dropped item is not a valid Design environemt item.")}initialize(t){this.core=new e(this),this.loadApp(t)}loadApp(e){let t=this;this.core.start().then(()=>{this.core.isValidSelectionForOpen(e.designEnvCtx)&&(t.core.dsEnvEventManager.subscribe(t.core.designEnvConstants.EVENT_CLEAN_APP,t.cleanApp.bind(t)),this.core.contextManager.setNextOpenSelection(e.designEnvCtx),t.core.dsEnvEventManager.publish(t.core.designEnvConstants.EVENT_LAUNCH_COMMAND,{commandId:t.core.designEnvConstants.OPEN_DESIGN_ENV_COMMAND_ID}))})}cleanApp(){this.core.dsEnvEventManager.unsubscribeAll()}}}),define("DS/DesignEnvironmentUX/views/DesignEnvLeftSidePanel/js/DesignEnvListView",["DS/DesignEnvironmentUX/views/DesignEnvLeftSidePanel/js/mixins/DesignEnvListViewManager","DS/Utilities/UUID","css!DS/DesignEnvironmentUX/DesignEnvironmentUX"],(e,t,i)=>{let n={};return class extends e{constructor(e){super(e),n.core=e&&e.core?e.core:{},this.initializeView()}initializeView(){this.elements={},this.elements.container=UWA.createElement("div",{class:"designenvpanel-main"}),this._buildDataGridView()}getDEContainer(){return this.elements.container}setVisible(e){e?this.elements.container.removeAttribute("hidden"):this.elements.container.setAttribute("hidden","")}addDesignEnv(e){let t=this;return new Promise(function(i){n.core.dataProvider.getDesignEnvItem(e).then(e=>{t.getModels().removeRoots(),t.getModels().addRoot(e),i(e)})})}getDataGridViewInstance(){return n.dgv?n.dgv:this._buildDataGridView()}getModels(){return n.model}_buildDataGridView(){var e=this;return new Promise(function(i){let s=UWA.extend({identifier:"DataGridView-DesignEnvPanel-"+t.v4()},e.getDgvViewOptions());s.layout=n.core.factory.createDataGridViewLayout();let o=n.core.factory.createDataGridView(s);n.dgv=o,n.model=n.core.factory.createModel(),o.treeDocument=n.model,o.getContent().addClassName("designenv-dgv"),o.getContent().inject(e.elements.container),o.layout.setColumnPinned("ContextualMenuColumn","unpinned"),o.getNodesXSO().onPostAdd(e.onSelectionUpdated.bind(e)),o.getNodesXSO().onPostRemove(e.onSelectionUpdated.bind(e)),e.handleDataGridViewEvents(o),i()})}}}),define("DS/DesignEnvironmentUX/commands/OpenDesignEnvItemCmd",["DS/ApplicationFrame/Command","DS/DesignEnvironmentUX/views/DesignEnvLeftSidePanel/js/DesignEnvListView"],(e,t)=>{return class extends e{constructor(e){super(e,"Open_Design_Env_item_command"),this.app=e.app}execute(e){this.launchOpenItem()}launchOpenItem(){let e=this;require(["DS/DesignEnvironmentUX/utils/DesignEnvCtx"],function(t){var i={appId:e.app.core.contextManager.getAppId()};t.initialize(i),i={designEnvCtx:"my_sandbox"},t.setContext(i)}).bind(this),this.navigateToDesignEnvListView()}navigateToDesignEnvListView(){let e=new t(this.app);this.app.listView=e,this.app.globalModelEvent.publish({event:"ENXModel/DesignEnv/leftSidePanel/loadTab",data:{designenvpanel:e}}),this.app.globalModelEvent.publish({event:"ENXModel/DesignEnv/leftSidePanel/content"})}}});