define("DS/DELWKOModelBehaviors/DELWKOLinkBehavior",["UWA/Core","UWA/Promise"],function(e,t){"use strict";return{plugins:["DatabasePlugin","DicoPlugin","WebServicePlugin","AttributePlugin","ResourcePlugin","ImplementPlugin","SelectionPlugin","PlatformPlugin"],creator:function(n,r,i,a,o,s,c,u,l,g){var f=u.getScopeLinkType(),d=u.getImplementLinkType();u.getScopeLinkType(),u.getImplementLinkType();var p,m,L,y,I,P,h,v,S;return p=function(t,n,i,a){i=i||{},e.is(n,"string")&&r.info(n,a),r.notify("stopProgress",t),e.is(i.onComplete,"function")&&i.onComplete.call(null,n)},m=function(t,n,i,a,o){a=a||{},e.is(i,"string")&&(n+="\n"+i),e.is(n,"string")&&(r.warn(n,o),r.debug(n)),r.notify("stopProgress",t),e.is(a.onFailure,"function")&&a.onFailure.call(null,n)},L=function(t){return new e.Promise(function(n){var a=[],o=function(t){var n,r;-1===a.indexOf(t)&&(n=i.getInstance(t),r=t,e.is(n)&&(r=n.get("isInstanceOf"),i.needToQueryForConnections(t)&&a.push(t)),-1===a.indexOf(r)&&i.needToQueryForConnections(r)&&a.push(r))};i.isNavigateOnDemand()||n({impactedList:[],relationsLoaded:!0}),(e.is(t)?t:l.getModuleSelections(r.getId())).forEach(function(e){o(e.id),Array.isArray(e.path)&&e.path.forEach(function(e){o(e)})}),a.length>0?i.getConnectionsFromServer(a,function(t){e.is(t)&&Array.isArray(t.connections)&&t.connections.length>0&&r.notify("addConnection",[t.connections]),n({impactedList:a,result:t,relationsLoaded:!0})}):n({impactedList:a,relationsLoaded:!0})})},y=function(e){return L(e).then(function(e){var t=e.impactedList;t.length>0&&(r.notify("refreshImpacted",{impactedChildren:[],impactedObjects:t}),r.getBehavior("RefreshBehavior").onRefreshSelected({impactedChildren:[],impactedObjects:t}))})},I=function(t,n){var r,o,s,u,l,g=!0,f={};return e.is(t.fromSideRefPID)&&e.is(t.toSideRefPID)?(n.contains("inverse")?(r=t.toSideRefPID,o=t.fromSideRefPID):(r=t.fromSideRefPID,o=t.toSideRefPID),s=i.getReference(r),u=i.getReference(o)):(g=!1,l=c.getNLSValue("LinkBehavior.canCreateOutputLinkError.InsufficentInfo")),g&&(a.isAKindOf(u,"Provide")||a.isAKindOf(s,"DELLmiHeaderWorkPlanReference")||a.isAKindOf(s,"DELLmiQtyControlProcessReference")?(g=!1,l=c.getNLSValue("LinkBehavior.canCreateOutputLinkError.ObjectTypeDoesntSupport")):i.hasConnection({from:r,to:o,type:"DELLmiProductionSystemOutputCnxToMBOM"})&&(g=!1,l=c.getNLSValue("LinkBehavior.canCreateOutputLinkError.LinkAlreadyExists"))),f={canCreateLink:g},g?f.data=e.merge({type:n,IDFrom:t.fromSideRefPID,IDTo:t.toSideRefPID,displayText:c.getNLSValue(n,null,"CreateLink"),buttonIdentifier:c.getNLSValue(n,null,"CreateLink")},e.clone(t)):f.errorMessage=l,f},P=function(t,n){var r,o,s,u,l,g=!0,f={};return e.is(t.fromSideRefPID)&&e.is(t.toSideRefPID)?(o=t.fromSideRefPID,s=t.toSideRefPID,u=i.getReference(o),l=i.getReference(s)):(g=!1,r=c.getNLSValue("LinkBehavior.canCreateOriginateLinkError.InsufficentInfo")),g&&(i.hasConnection({from:o,to:s,type:"HistorizationLinkRefRef"})||i.hasConnection({from:s,to:o,type:"HistorizationLinkRefRef"})?(g=!1,r=c.getNLSValue("LinkBehavior.canCreateOriginateLinkError.LinkAlreadyExists")):(a.isAKindOf(u,"DELLmiHeaderWorkPlanReference")||a.isAKindOf(l,"DELLmiHeaderWorkPlanReference"))&&(g=!1,r=c.getNLSValue("LinkBehavior.canCreateOriginateLinkError.ObjectTypeDoesntSupport"))),f={canCreateLink:g},g?f.data=e.merge({type:n,IDFrom:o,IDTo:s,displayText:c.getNLSValue(n,null,"CreateLink"),buttonIdentifier:c.getNLSValue(n,null,"CreateLink")},e.clone(t)):f.errorMessage=r,f},h=function(t,n){var r,a,o,s=!0,u={};return e.is(t.fromSideRefPID)&&e.is(t.toSideRefPID)?(r=t.fromSideRefPID,a=t.toSideRefPID,(i.hasConnection({from:r,to:a,type:"MfgProcessAlternate"})||i.hasConnection({from:a,to:r,type:"MfgProcessAlternate"}))&&(s=!1,o=c.getNLSValue("LinkBehavior.canCreateAlternateLinkError.LinkAlreadyExists"))):(s=!1,o=c.getNLSValue("LinkBehavior.canCreateAlternateLinkError.InsufficentInfo")),u={canCreateLink:s},s?u.data=e.merge({type:n,IDFrom:r,IDTo:a,displayText:c.getNLSValue(n,null,"CreateLink"),buttonIdentifier:c.getNLSValue(n,null,"CreateLink")},e.clone(t)):u.errorMessage=o,u},v=function(e){var t;switch(e.type){case"DELLmiProductionSystemOutputCnxToMBOM":case"DELLmiProductionSystemOutputCnxToMBOM_inverse":t=I(e,e.type);break;case"MfgProcessAlternate":t=h(e,e.type);break;case"HistorizationLinkRefRef":t=P(e,e.type);break;default:t={canCreateLink:!0}}return t},S=function(n,r,a){var o,s,c,u;return o=(n=n||{}).IDFrom,s=n.IDTo,c=n.type,n.type.endsWith("_inverse")?(n.IDFrom=e.is(s,"array")?s.toString():s,n.IDTo=e.is(o,"array")?o.toString():o,n.type=n.type.replace("_inverse","")):(n.IDFrom=e.is(o,"array")?o.toString():o,n.IDTo=e.is(s,"array")?s.toString():s),new t(function(t,a){var o=e.is(n.IDFrom,"array")?n.IDFrom[n.IDFrom.length-1]:n.IDFrom,s=e.is(n.IDTo,"array")?n.IDTo[n.IDTo.length-1]:n.IDTo,l={linkType:c,target:o,source:s},g=function(t,n){e.is(n)&&(l.errorMessage=n),a(l)};(u=v(n)).canCreateLink?(r=r||{},i.createConnection({IDFrom:n.IDFrom,IDTo:n.IDTo,type:n.type},e.merge({onFailure:g,onTimeout:g,onCancel:g,onComplete:function(){t(l)}},r))):(l.errorMessage=u.errorMessage,a(l))})},{listenTo:function(){return{LoadRelations:function(e){var t;return Array.isArray(e)&&(t=e),y(t)}}},onStart:function(){},onStop:function(){},getPossibleRelationTypes:function(t){var n=r.getBehavior("ImplementBehavior"),o=r.getBehavior("ProductFlowLinkBehavior"),s=r.getBehavior("CapableResourceLinkBehaviour"),c=n.getScopeLinkType(),u=c+"_inverse",l=n.getImplementLinkType(),g=l+"_inverse",f=e.is(t.fromSideRefPID)?i.getReference(t.fromSideRefPID):null,d=e.is(t.toSideRefPID)?i.getReference(t.toSideRefPID):null,p=e.is(f)?f.get("type"):null,m=e.is(d)?d.get("type"):null,L={};return e.is(p)&&e.is(m)?(a.getPossibleRelations(p,m,"write").forEach(function(r){var i=t.fromSideAbsPath,a=t.toSideAbsPath,f=t.fromSideRefPID,d=t.toSideRefPID,p={};switch(r){case c:case u:p=n.canCreateScopeLink(t,r);break;case l:case g:p=n.canCreateImplementLink(i,a,r);break;case"ResultingProductLink":case"ResultingProductLink_inverse":p=n.canCreateResultingProductLink(f,d,r);break;case"DELLmiProductionSystemOutputCnxToMBOM":case"DELLmiProductionSystemOutputCnxToMBOM_inverse":p=I(t,r);break;case"MfgProcessAlternate":p=h(t,r);break;case"HistorizationLinkRefRef":p=P(t,r);break;case"DELAsmProcessCanUseCnx":case"DELAsmProcessCanUseCnx_inverse":p=s.canCreatePrimaryCapableRscLink(t,r);break;case"SecondaryCandidateResourceLink":case"SecondaryCandidateResourceLink_inverse":p=s.canCreateSecondaryCapableRscLink(t,r);break;case"DELLmiTimeConstraintCnx":case"DELLmiMaterialPathCnxCust":case"DELLmiExecTimeConstraintRelation":p=o.canCreateProductFlowLink(t,r);break;default:p={canCreateLink:!1}}p.canCreateLink&&(delete p.canCreateLink,p.data=e.is(p.data,"array")?p.data:[p.data],L[r]=p)}),L):(r.debug("No Types on models"),[])},isLinkPossible:function(e,t,n,r){return a.isLinkPossible(e,t,n,r)},webServiceRequest:function(e){o.webServiceRequest(e)},getConnection:function(e){return i.getConnection(e)},isExploreWebAppEnabled:function(){return!g.isCloud()},createConnectionsByType:function(e,t){var n=r.getBehavior("ImplementBehavior"),i=n.getScopeLinkType(),a=i+"_inverse",o=n.getImplementLinkType(),s=o+"_inverse",c=e.linkType,u=e.linksData;switch(c){case i:case a:n.createScopeLink(u,t);break;case o:case s:n.createImplementLink(u,t);break;default:this.createConnection(u,t)}},createConnection:function(t,n){var a,o={},s=[],u=r.getBehavior("ProductFlowLinkBehavior"),l=r.getBehavior("CapableResourceLinkBehaviour");e.is(t)&&e.is(t,"array")&&(r.notify("startProgress",o),a=r.log(c.getNLSValue("CreateLink.LogMessage")),s=t.map(function(e){var t;switch(e.type){case"DELAsmProcessCanUseCnx":case"DELAsmProcessCanUseCnx_inverse":case"SecondaryCandidateResourceLink":case"SecondaryCandidateResourceLink_inverse":t=l.createConnection(e,n);break;case"DELLmiTimeConstraintCnx":case"DELLmiMaterialPathCnxCust":case"DELLmiExecTimeConstraintRelation":t=u.createProductFlowLink(e,n);break;default:t=S(e,n)}return t}),e.Promise.allSettled(s).then(function(t){var s=0,u={},l={},g={success:u,failed:l};t.forEach(function(t,n){var i,a;"rejected"===t.state?(s++,a=l,i=t.reason,e.is(i.errorMessage,"string")&&r.debug(i.linkType+" creation failed :  "+i.errorMessage)):(a=u,i=t.value),e.is(a[i.linkType])||(a[i.linkType]={}),e.is(a[i.linkType][i.target])||(a[i.linkType][i.target]=[]),a[i.linkType][i.target].push(i.source)}),Object.keys(g).forEach(function(e){var t="success"===e,n=t?"CreateLink.Success":"CreateLink.Failure",o=g[e];Object.keys(o).forEach(function(e){var s=o[e];Object.keys(s).forEach(function(o){var u,l=s[o],g=[],f=i.getReferenceModel(o).get("V_Name");l.forEach(function(e){var t=i.getReferenceModel(e);g.push(t.get("V_Name"))}),u=c.getNLSValue(n,{linkType:c.getNLSValue(e),target:f,source:g.join(", ")}),t?r.info(u,a):(r.warn(u,a),r.debug(u))})})}),0===s?p(o,null,n,a):m(o,null,null,n,a)}))},canDeleteRelation:function(t){var n,r,o,s,c,u,l=!1;return n=this.getConnection(t),e.is(n)&&("CapableResourcesStructureLink"===(r=n.getAttribute("type"))?l=!1:"SecondaryCandidateResourceLink"===r?l=!0:(o=n.getAttribute("from"),s=i.getReferenceModel(o).get("type"),c=n.getAttribute("to"),u=i.getReferenceModel(c).get("type"),l=a.isRelationTypeConfigured(r,s,u,"write"))),l},deleteConnection:function(t,n){var a,o,s,g,L={},y=i.getConnection(t),I=y.getAttribute("type"),P=c.getNLSValue(I),h=null,v=r.getBehavior("ImplementBehavior");if(n=n||{},s=r.log(c.getNLSValue("DeleteLink.LogMessage",{linkType:P})),e.is(I)&&"PartialProductImplementLink"===I){const t=l.getSelectionsWithPaths(r.getId())[0];if(e.is(t,"array")&&t.length>0){const n=t;if(e.is(n,"array")&&n.length>0){const t=n[0].path,r=e.is(t)&&t.length>0?t:n.id;u.isPartialScoped(r)&&(e.is(r,"array")&&r.length>0?h=r:h.push(r))}if(e.is(h,"array")&&h.length>0)return v.managePartialScopeLink({implementingAbsPath:h,cmdAction:v.PartialScopeAction.DELETE_PARTIALSCOPE})}r.warn(c.getNLSValue("DeletePartialScopeLink.Failure"),s)}else r.notify("startProgress",L),a={onComplete:function(t,i){var a={};p(L,c.getNLSValue("DeleteLink.Success",{linkType:P}),n,s),e.is(t.preferred)&&(a.linkPID=t.preferred,a.state=!0,r.notify("updatePreferredLink",a)),e.is(i)?r.notify("deleteLink",[i.deletedConnections]):r.notify("deleteLink",y.toJSON())},onFailure:g=function(e,t){m(L,c.getNLSValue("DeleteLink.Failure",{linkType:P}),t,n,s)},onTimeout:g,onCancel:g},o=e.extend({},n),a=e.extend(o,a),f===I?u.deleteScopeLink(t,a):d===I?u.deleteImplementLink(t,a):i.deleteConnection(t,a)},addConnection:function(e,t){return i.addConnection(e,t)},updateLinkAttributes:function(e,t,n){var a,o,u,l,g,f,d,L=[],y={},I={},P={};for(t=t||{},n=n||{},a=0;a<t.length;a++)g=s.getNLS(t[a].attributeInfo),f=s.hasRangeDefined(t[a].attributeInfo,t[a].attributeDef)&&s.isInteger(t[a].attributeInfo),l=(d=t[a].objectToBeModified).get(t[a].dataIndex),u=t[a].newValue,f&&(l=s.getAuthorizedValueIndex(t[a].attributeInfo,t[a].attributeDef,l)),s.isDate(t[a].attributeInfo)&&(l=new Date(l).getTime()/1e3),l!==u&&(s.doesAttributeExist(d,t[a].dataIndex)?(t[a].previousValue=l,L.push(t[a])):r.warn(c.getNLSValue("TableView.AvailabilityFailure",{key:g})));if(0!==L.length){for(a=0;a<L.length;a++)y[L[a].attributeName]=L[a].newValue;o={data:y,onFailure:function(e){for(a=0;a<L.length;a++)e.set(L[a].dataIndex,L[a].previousValue);m(P,c.getNLSValue("AttributeUtil.SaveFailed"),e,n)},onComplete:function(){p(P,c.getNLSValue("AttributeUtil.SaveSucceeded"),n),r.notify("editLinkAttributes",I),r.notify("refreshImpacted")},logMessage:c.getNLSValue("AttributeUtil.EditAttributesLogMessage")},r.notify("startProgress",P),i.updateConnection(e,o)}},getConnectionsByModel:function(e,t,n){i.getConnectionsByModel(e,t,n)},getImpactedConnections:function(e,t,n){return i.getImpacted(e,t,n)},getConnectedObjects:function(t,n,a){var o,s,c,u,l=r.getBehavior("ImplementBehavior"),g=r.getBehavior("CapableResourceLinkBehaviour"),f=[];return o=i.getInstance(t),e.is(o)?(s=t,c=i.getReferenceModelFromInstance(o),u=c.get("PID")):(c=i.getReference(t),u=t),i.getImpacted(t,!1,a).forEach(function(e){var t,r=e.get("type"),i=e.get("from"),a=e.get("to");switch(r){case"ProcessImplementLink":case"PartialProcessImplementLink":case"ProcessImplementLinkOcc":case"ItemSpecOcc":f=f.concat(l.getConnectedObjects(u,s,n,e)),t=i===u?a:i,f.push(t);break;case"CapableResourcesStructureLink":case"DELAsmProcessCanUseCnx":case"SecondaryCandidateResourceLink":f=f.concat(g.getConnectedObjects(u,s,n,e));break;case"DELLmiProductionSystemOutputCnxToMBOM":case"MfgProcessAlternate":case"HistorizationLinkRefRef":case"DELIsSerializedFrom":t=i===u?a:i,f.push(t);break;case"DELIsSerializedFromOp":t=i===s?a:i,f.push(t);break;case"ProductImplementLink":case"ProductImplementLinkOcc":case"ResultingProductLink":case"DELLmiTimeConstraintCnx":case"DELLmiMaterialPathCnxCust":break;default:console.log("Invalid Type")}}),f},getXMLValues:function(e,t,n){return o.getXMLValues(e,t,n)},getRelations:function(t){return L(t).then(function(t){var n=t.result;return{isRelationsLoaded:t.relationsLoaded,connections:e.is(n)?n.connections:[]}})},areRelationsLoaded:function(t){var n=!0;return t=Array.isArray(t)?t:[t],i.isNavigateOnDemand()&&(n=t.some(function(t){var n,r,a,o=i.getReferenceModel(t),s=o.id===t;return e.is(o)&&(s||(a=t),r=i.getInstance(a),n=e.is(r)?o.getAdditionalInfo("queriedForConnections")&&r.getAdditionalInfo("queriedForConnections"):o.getAdditionalInfo("queriedForConnections")),n})),n},hasConnection:function(e){return i.hasConnection(e)},getLinkInfo:function(t){var n,r,i,o,u,l={NLS:null,type:null,subType:null,iconName:null};return e.is(t)&&("DELLmiTimeConstraintCnx"===(n=t.get("type"))?(i=a.getAttributeInfo("DELLmiTimeConstraintCnx.V_DependencyType"),"TRUE"===t.get("V_MaterialNeed")?r=n+"_ProductFlow":(o=t.get("V_DependencyType"),u=s.getAuthorizedValueIndex(i,null,o),r=n+"_"+s.getAuthorizedValueDB(i,u)),l.NLS=c.getNLSValue(r),l.type=n,l.subType=r,l.iconName=r):(l.NLS=c.getNLSValue(n),l.type=n,l.subType=t._attributes.kind||t._attributes.flowType,l.iconName=n)),l},getSecondaryRscLinksFromPrimaryLink:function(e){var t;return t=e.get("PID"),i.getImpacted(t,!1,{relationTypes:["SecondaryCandidateResourceLink"]})},cloneSecondaryCapableRscLinkWithFromAttr:function(t){var n=this.getConnection(t.get("from"));return e.is(n)&&(t=t.clone()).set("from",n.get("from")),t},getSecondaryResourceLinksInfo:function(t){var n,r=this,a=[],o=i.getConnection(t),s=this.getSecondaryRscLinksFromPrimaryLink(o);return n=function(t){var n=t.get("PID"),r=t.get("type"),a=t.get("V_IsPreferred"),o=t.get("from"),s=t.get("to"),c=i.getReference(o),u=i.getReference(s),l=e.is(c)?c.get("type"):null,g=e.is(u)?u.get("type"):null,f=e.is(c)?c.get("V_Name"):null,d=e.is(u)?u.get("V_Name"):null,p=e.is(t.get("ResourceUsage"))?t.get("ResourceUsage"):null,m=e.is(p)?i.getInstance(p):null;return{connPID:n,isPreferred:"DELAsmProcessCanUseCnx"===r?a:"",fromPID:o,toPID:s,fromType:l,toType:g,fromName:f,toName:d,resourceUsage:e.is(m)?m.get("PLM_ExternalID"):"",resourceUsagePID:p}},s.forEach(function(e){var t=r.cloneSecondaryCapableRscLinkWithFromAttr(e);a.push(n(t))}),a}}}}}),define("DS/DELWKOModelBehaviors/DELWKOModelBehavior",["UWA/Core","UWA/Promise","DS/DELPPWModelBehaviors_FD02/ModelBehavior","DS/DELPPWModelServices_FD02/BehaviorUtil"],function(e,t,n,r){"use strict";return{plugins:["DatabasePlugin","ResourcePlugin","AttributePlugin","WebServicePlugin","DicoPlugin","BIPlugin"],creator:function(n,i,a,o,s,c,u,l){var g,f,d,p,m,L,y;return m=function(t,n,r,a,o){var s=r||{};!0===(!e.is(s.popupMessage)||s.popupMessage)?i.info(n,a):i.log(n,a),i.notify("stopProgress",t),e.is(s.onComplete,"function")&&s.onComplete.call(null,n,r,o)},L=function(t,n,r,a,o,s){var c=a||{},u=!e.is(c.popupMessage)||c.popupMessage;e.is(r)&&e.is(r.message,"string")&&(n+="\n"+r.message),!0===u?i.warn(n,o):i.log(n,o),i.notify("stopProgress",t),e.is(c.onFailure,"function")&&c.onFailure.call(null,n,s)},g=function(n,r,s,c,u,l){var g,f,d,p,y,I,P=o.getNLSValue("DeleteObject.Success"),h=o.getNLSValue("DeleteObject.Failure"),v=o.getNLSValue("DeleteObject.PatialFailure"),S=[],C=n?"Instance":"Reference",D={};if(l=!!e.is(l)&&l,g=function(e,t){y=o.getNLSValue(C,{objectLabel:e.get(c)},"Delete","Success"),i.log(y,p),e.isInstance()&&(d=a.getReferenceModelFromInstance(e)),t(d)},f=function(t,n,r){y=o.getNLSValue(C,{objectLabel:t.get(c)},"Delete","Failure"),e.is(r)&&e.is(r.message,"string")&&(y+="\n"+r.message),i.log(y,p),n()},e.is(r,"array")&&r.length>0){if(i.notify("startProgress",D),p=i.log(o.getNLSValue("DeleteObject.LogMessage")),I=a[n?"deleteInstance":"deleteReference"],!e.is(I,"function"))return void i.debug("delete function not found on database plugin.");r.forEach(function(r){S.push(new t(function(t,a){I(r.id,{deep:!!e.is(u)&&u,onComplete:function(){g(r,t),n&&i.notify("deleteInstance",r.toJSON())},onFailure:function(e,t){f(r,a,t)}})}))}),e.Promise.allSettled(S).then(function(t){var r=!1,a=0,o=0,c=[];for(a=0;a<t.length;a++)"rejected"!==t[a].state?e.is(t[a].value)&&c.push(t[a].value):o++;0===o?(m(D,P,s,p),r=!0):o===t.length?L(D,h,null,s,p):(L(D,v,null,s,p),r=!0),r&&n&&l&&i.notify("addToAuxiliaryView",[c,{askAddToAuxConfirmation:!l}])})}},y=function(e,t){return a.isInstancePossible(e,t)},d=function(t,n){var r,s,c,u={},l={},g=!1;return n=n||{},e.is(n.securityContextOverride,"string")&&(c=n.securityContextOverride,delete n.securityContextOverride),e.is(n.silent,"boolean")&&(g=n.silent,delete n.silent),e.is(t)?e.is(t.V_Type)&&e.is(t.type)?(r=i.log(o.getNLSValue("ModelBehavior.createWorkOrderFromProcess.LogMessage",{title:t.V_Name,type:t.type})),i.notify("startProgress",u),s=a.createWorkOrderFromProcess(t,{onComplete:function(t){for(var a=t.instancesAndReferences,s=null,c=null,g=a.length,f=[],d=[],p=0;p<g;p++)null!=a[p]&&("WORKORDER"===a[p]._attributes.PPRTYPE&&(s=a[p]),"SYSTEM"===a[p]._attributes.PPRTYPE&&(c=a[p]),void 0===a[p]._attributes.isAggregatedBy?f.push(a[p]):d.push(a[p]));var L={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:f,instanceAttrs:d};n.newRef=s,e.is(s)&&m(u,o.getNLSValue("ModelBehavior.createWorkOrderFromProcess.Success",{name:s._attributes.V_Name,processname:c._attributes.V_Name}),n,r,L),i.notify("createReference",l)},onFailure:function(t,i){var a={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:null,instanceAttrs:null};L(u,o.getNLSValue("ModelBehavior.createWorkOrderFromProcess.Failure"),i,n,r,a)},securityContextOverride:c,silent:g})):i.debug("Type is required to create createWorkOrderFromProcess",s):i.debug("data is empty to addReference"),s},f=function(t,n){var r,s,c,u={},l={},g=!1;return n=n||{},e.is(n.securityContextOverride,"string")&&(c=n.securityContextOverride,delete n.securityContextOverride),e.is(n.silent,"boolean")&&(g=n.silent,delete n.silent),e.is(t)?e.is(t.V_Type)&&e.is(t.type)?(r=i.log(o.getNLSValue("ModelBehavior.CreateReference.LogMessage",{title:t.V_Name,type:t.type})),i.notify("startProgress",u),s=a.createReference(t,{onComplete:function(t){var a={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:t.toJSON(),instanceAttrs:null};n.newRef=t,m(u,o.getNLSValue("ModelBehavior.createWorkOrderFromProcess.Success",{name:t.get("PLM_ExternalID")}),n,r,a),i.notify("createReference",l)},onFailure:function(t,i){var a={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:null,instanceAttrs:null};L(u,o.getNLSValue("ModelBehavior.createWorkOrderFromProcess.Failure"),i,n,r,a)},securityContextOverride:c,silent:g})):i.debug("Type is required to create createReference",s):i.debug("data is empty to addReference"),s},p=function(t,n){var r,s,c={},u=!0;n=n||{},e.is(n.securityContextOverride,"string")&&(s=n.securityContextOverride,delete n.securityContextOverride),e.is(t)?e.is(t.isAggregatedBy)?(e.is(t.isInstanceOf)&&(u=y(a.getReference(t.isAggregatedBy),a.getReference(t.isInstanceOf))),u?(i.notify("startProgress",c),r=i.log(o.getNLSValue("ModelBehavior.CreateInstance.LogMessage")),a.createInstance(t,{onComplete:function(t){var s=a.getReferenceModelFromInstance(t),u={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:e.is(s)?s.toJSON():null,instanceAttrs:e.is(t)?t.toJSON():null};n.newInst=t,m(c,o.getNLSValue("ModelBehavior.CreateInstance.Success",{name:t.get("PLM_ExternalID")}),n,r,u),i.notify("createInstance",t.toJSON())},onFailure:function(t,i){var a={transactionUUID:e.is(n.transactionUUID,"string")&&n.transactionUUID.length>0?n.transactionUUID:null,referenceAttrs:null,instanceAttrs:null};L(c,o.getNLSValue("ModelBehavior.CreateInstance.Failure"),i,n,r,a)},securityContextOverride:s})):i.debug("Instance object cannot be created between two selected Types")):i.debug("isAggregatedBy required to create instance"):i.debug("data is empty to createInstance")},{onStart:function(){},onStop:function(){},moveInstance:function(t){var n,r,s,u=t||{},g=null,f=null,d={},p=widget.getBool("oneDelmiaAggregationMode"),y=o.getNLSValue("ModelBehavior.ReparentInstances"),I=o.getNLSValue("ModelBehavior.ReparentInstances.Success"),P=o.getNLSValue("ModelBehavior.ReparentInstances.Failure");n=function(t){var n,r={formerParentsPIDArray:g.formerInstancesParentPIDs,movedInstPIDArray:g.instancesPIDsToReparent,newParentPID:g.newParentPID,newInstPIDArray:[]},o=[],s={stackedObjects:{stackedReferences:[],stackedInstances:[],stackedConnections:[],deletedObjects:[]},silentOpt:!0,onComplete:function(t){var n,s=i.getPreferenceValue("refreshBIOnAuthoring");for(n of(s=!!e.is(s,"boolean")&&s,r.newInstPIDArray=t.instancePIDs.slice(),r.newInstPIDArray))a.manageLinearProductFlowsOnCreateInstancePID(n);i.notify("reparentInstances",r),o.length>0&&i.notify("removeInstance",[o]),s&&l.getBICmdState()&&l.computeBI(),m(d,I,u,f),i.notify("reparentEnd",g.newParentPID)}};for(n of g.instancesPIDsToReparent)a.manageLinearProductFlowsOnDeleteInstancePID(n);e.is(t.deletedObjects)&&t.deletedObjects.forEach(function(t){var n=a.getInstance(t);e.is(n)&&o.push(n)}),a.parseServerObjects(t,s)},r=function(e,t){u.popupMessage=!0,i.notify("reparentEnd",g.newParentPID),L(d,P,t,u,f)},f=i.log(y),i.notify("startProgress",d),g={oneDelmiaAggregationMode:p,instancesPIDsToReparent:e.is(u.instancesPIDsToReparent)?u.instancesPIDsToReparent:[],formerInstancesParentPIDs:e.is(u.formerInstancesParentPIDs)?u.formerInstancesParentPIDs:[],newParentPID:e.is(u.newParentPID)?u.newParentPID:"",newParentInstancesOrder:e.is(u.newParentInstancesOrder)?u.newParentInstancesOrder:[]},s={url:"dsmfg/private/V0/invoke/reparent",method:"POST",headers:c.getHeaders({isAuthoringCtx:!0,isJsonOnly:!0}),onComplete:n,onFailure:r,data:e.Json.encode(g)},i.notify("reparentBegin",g.newParentPID),i.debug("Reparent instance ("+g.instancesPIDsToReparent.reduce(function(e,t,n){return e+(0===n?"":", ")+t+"#"+a.getInstance(t).get("PLM_ExternalID")},"")+"), formerly under reference ("+g.formerInstancesParentPIDs.reduce(function(e,t,n){return e+(0===n?"":", ")+t+"#"+a.getReference(t).get("V_Name")},"")+"), under new reference ("+g.newParentPID+"#"+a.getReference(g.newParentPID).get("V_Name")+")"),c.webServiceRequest(s)},moveMultipleInstances:function(n,r,a){var s=this;return new t(function(t,r){var i=e.merge({onComplete:t,onFailure:r,popupMessage:!1},n);s.moveInstance(i)}).then(function(){var e=o.getNLSValue("ModelBehavior.MoveInstances.Success",{instanceLabel:a,newParentLabel:r});return i.info(e),t.resolve(e)})},createWorkOrderFromProcess:function(t,n,r){var a,o={};if(e.is(t)){for(a in t)Object.prototype.hasOwnProperty.call(t,a)&&(o[a]=t[a]);d(o,r)}else i.debug("createWorkOrderFromProcess: No data to insert")},createRefOrInst:function(t,n,r){var a,o={};if(e.is(t)){for(a in t)Object.prototype.hasOwnProperty.call(t,a)&&(o[a]=t[a]);e.is(n,"string")?(o.isAggregatedBy=n,p(o,r)):f(o,r)}else i.debug("createRefOrInst: No data to insert")},createMultipleInstances:function(e,n,r){var s;return s=e.map(function(e){return function(e){return new t(function(t,n){const r=a.getReference(e.referencePID);p({isAggregatedBy:e.targetReferencePID,isInstanceOf:e.referencePID,skipScopeCheck:i.getPreferenceValue("skipVaidationIfScopedCheck")&&u.isAKindOf(r,"Provide")},{onComplete:t,onFailure:n,popupMessage:!1})})}(e)}),t.all(s).then(function(){var e=o.getNLSValue("ModelBehavior.CreateInstances.Success",{instanciatedReference:r,referenceName:n});return i.info(e),t.resolve(e)}).fail(function(e){return i.warn(e),t.reject(e)})},deleteReference:function(t,n){var r,s,c,u=i.getBehavior("UXFactoryBehavior"),l=o.getNLSValue("Delete.Confirmation.Title");if(e.is(u)){if(n=n||{},e.is(t,"array")&&t.length>0){for(s=o.getNLSValue("DeleteReference.Confirmation.Message"),r=0;r<t.length;r++)if(a.getInstancesFromCollection(t[r].id).length>0){c=o.getNLSValue("Confirmation.DeleteWholeStructure");break}e.is(c)?u.showConfirmation(l,s,{attributes:["V_Name"],models:t},function(r,i,a){e.is(r)&&r&&g(!1,t,n,"V_Name",a)},{check:c}):u.showConfirmation(l,s,{attributes:["V_Name"],models:t},function(r){e.is(r)&&r&&g(!1,t,n,"V_Name",!1)})}}else i.debug("uxFactoryBehavior is not available.")},deleteInstance:function(t,n){var r,a,s,c=i.getBehavior("UXFactoryBehavior"),u=o.getNLSValue("Confirmation.addRefToAuxViewPostDelete");e.is(c)?(n=n||{},r=!e.is(n.askDeleteConfirmation)||n.askDeleteConfirmation,e.is(t,"array")&&t.length>0&&(r?(e.is(n.isDetachInstance)&&n.isDetachInstance?(s=o.getNLSValue("Detach.Confirmation.Title"),a=o.getNLSValue("DetachInstance.Confirmation.Message")):(s=o.getNLSValue("Delete.Confirmation.Title"),a=o.getNLSValue("DeleteInstance.Confirmation.Message")),c.showConfirmation(s,a,{attributes:["PLM_ExternalID"],models:t},function(r,i,a){e.is(r)&&r&&g(!0,t,n,"PLM_ExternalID",!1,a)},{check:u})):g(!0,t,n,"PLM_ExternalID"))):i.debug("uxFactoryBehavior is not available.")},fetchRoot:function(e,t){return a.fetchRoot(e,t)},fetchInstancesAndTheirReferences:function(e,t){return a.fetchInstancesAndTheirReferences(e,t)},isNavigateOnDemand:function(){return a.isNavigateOnDemand()},fetchInstance:function(e,t){return a.fetchInstance(e,t)},getReference:function(e){return a.getReference(e)},removeReference:function(e,t){a.removeReference(e,t)},getInstance:function(e){return a.getInstance(e)},getReferenceModelFromInstance:function(e){return a.getReferenceModelFromInstance(e)},getAggregatingReferenceModelFromInstance:function(e){return a.getAggregatingReferenceModelFromInstance(e)},getReferenceIdFromInstance:function(e){return a.getReferenceIdFromInstance(e)},getReferenceId:function(e){var t=e;return this.isInstance(e)&&(t=a.getReferenceIdFromInstance(e)),t},getInstancesFromCollection:function(e){return a.getInstancesFromCollection(e)},needToQueryForConnections:function(e){return a.needToQueryForConnections(e)},needToQueryForChildren:function(e){return a.needToQueryForChildren(e)},getDescendantsFromServer:function(e,t,n){a.getDescendantsFromServer(e,t,n)},getConnectionsFromServer:function(e,t,n){a.getConnectionsFromServer(e,t,n)},getAllChildrenFromCollection:function(e){return a.getAllChildrenFromCollection(e)},getImpactedConnections:function(t,n,r){var i,o=[];return e.is(t,"array")&&t.forEach(function(t){i=a.getImpacted(t,n,r),e.is(i)&&e.is(i,"array")&&i.length>0&&(o=o.concat(i))}),o},getReferenceModel:function(e){return a.getReferenceModel(e)},isReference:function(t){return e.is(this.getReference(t))},isInstance:function(t){return e.is(this.getInstance(t))},updateModelAttribute:function(t,n,c,u){var l,g,f,d,p,y,I,P,h,v,S,C,D,k,R,b,T,A,F,O,V,N,M,E,w=this,B=[],U=function(t){var n=t,r=function(t){return e.is(t,"string")?s.getFormattedDate(t):s.getFormattedDate(1e3*t)};return s.isDate(D)?n=Array.isArray(t)?t.map(function(e){return r(e)}):r(t):v&&!I&&(n=s.getValueAsString(t,s.getType(D))),n};e.is(n,"array")&&(n=n[0]),n=n||{},u=u||{},e.is(n.instOrRef)&&e.is(n.dataIndex)&&e.is(n.attributeInfo)&&e.is(n.objectToBeModified)&&e.is(n.attributeName)?(R=n.attributeName,D=n.attributeInfo,k=e.is(n.attributeDef)?n.attributeDef:{},p=s.getNLS(D),b=n.objectToBeModified,C=n.dataIndex,y="instance"===n.instOrRef,I=s.hasRangeDefined(D,k),P=s.isString(D),h=s.isInteger(D),v=s.isDouble(D),S=s.isMultiValuated(D),d=b.get(C),e.is(d)&&"NULL"!==d||(d=""),I&&!S&&(P||h||v)&&(d=s.getAuthorizedValue(D,k,d)),A=function(e,t,n,r){var a,s=U(n),c=i.getBehavior("UXFactoryBehavior"),u=c.getComponent("Button"),l=c.createElement("div",{class:"confirmation-dialog-content-container",html:"<p>"+o.getNLSValue("UpdateAttributeUI.Text",{prevValue:s})+"</p>"});(a=c.create("Dialog",{title:o.getNLSValue("UpdateAttributeUI.Header",{attributeName:p}),domId:"EditAttributeUI-Dialog",content:l,resizableFlag:!0,modalFlag:!0,buttons:{No:new u({onClick:function(){n===t&&T(e,r,n),a.close()}}),Yes:new u({disabled:!1,onClick:function(){T(e,t,n),a.close()}})}})).close=function(){this.destroy(),a=null}},F=function(t){var n=!1,r=c;return e.is(t)&&(f=t.get(C),I&&!S&&(P||h)&&(f=s.getAuthorizedValue(D,k,f)),s.isDate(D)&&!s.isMultiValuated(D)?(f=(f=new Date(f).getTime()/1e3).toString(),r=c=r.toString()):v&&s.hasMagnitude(D)&&!S&&(f=parseFloat(f),r=parseFloat(r),c=r.toString()),f!==r&&(s.doesAttributeExist(t,C)?n=!0:i.warn(o.getNLSValue("TableView.AvailabilityFailure",{key:p})))),n},e.is(t,"array")?t.forEach(function(e){l=y?w.getInstance(e):w.getReference(e),F(l)&&B.push(l.id)}):F(b)&&B.push(b.id),0!==B.length&&(1===B.length?(T=function(t,n,s){var c={previous:{}},l={},f={};c.previous[R]=s,r.isCloud()?c[a.getReference(t).getODMAttr(R)]=n:c[R]=n,g={data:c,forceUpdate:!0,onRevisionFailure:function(e,t){L(f,e.message,t,u)},onFailure:function(e,t){L(f,o.getNLSValue("TableView.SingleUpdateFailure",{key:p,value:U(n)}),t,u)},onComplete:function(a,c){var g=a.get(C);r.isCloud()?(m(f,o.getNLSValue("TableView.SingleUpdateSuccess",{key:p,value:U(n)}),u),i.notify("editAttribute",l)):e.is(c)&&e.is(c.isInSync)&&!c.isInSync?(L(f,o.getNLSValue("TableView.UpdateWarning",{key:p})),A(t,n,g,s)):e.is(a._changed.modified)?(m(f,o.getNLSValue("TableView.SingleUpdateSuccess",{key:p,value:U(g)}),u),i.notify("editAttribute",l)):L(f,o.getNLSValue("TableView.SingleUpdateFailure",{key:p,value:U(n)}),c,u)},logMessage:o.getNLSValue("TableView.SingleUpdateLogMessage")},i.notify("startProgress",f),!0===y?a.updateInstance(t,g):a.updateReference(t,g)})(B[0],c,d):B.length>1&&(V=c,M={},E={},(N={keyValues:{},pids:O=B}).keyValues[R]=V,g={data:N,onFailure:function(e){L(E,o.getNLSValue("TableView.MassUpdateFailure",{key:p,value:U(V)}),e,u)},onComplete:function(e){e.length!==O.length?L(E,o.getNLSValue("TableView.UpdateWarning",{key:p})):(m(E,o.getNLSValue("TableView.MassUpdateSuccess",{key:p,value:U(V)}),u),i.notify("editAttribute",M))},logMessage:o.getNLSValue("TableView.MassUpdateLogMessage")},i.notify("startProgress",E),!0===y?a.updateInstances(C,g):a.updateReferences(C,g)))):i.debug("Required attribute information is missing to update the model attribute")},getValidChildTypes:function(e){return a.getValidChildTypes(e)},isInstancePossible:function(e,t){return y(e,t)},isMovePossible:function(t,n){var r,i=!1;return a.isWorkInstruction(n)?i=!1:n&&n.get("isAggregatedBy")!==t.id&&(r=this.getReferenceModelFromInstance(n).get("PPRTYPE"),e.is(r)&&(i=u.isReparentPossible(r))),i},isAKindOf:function(e,t){return u.isAKindOf(e,t)},getTypeHierarchy:function(e){return u.getTypeHierarchy(e)},getPPRType:function(e){return a.getPPRType(e)},getPPRTypeFromType:function(e){return u.getPPRType(e)},getParentTypes:function(e){return u.getParentTypes(e)},getReadOnlyTypes:function(){return u.getReadOnlyTypes()},isReferencesHasReadOnlyType:function(e){return u.isReferencesHasReadOnlyType(e)},getMajorRevisions:function(t,n,r){var s,u,l,g=a.getReferenceModel(t).get("V_Name");u=function(e,t,n){i.debug("jsonData: "+e+" error:"+t+" options: "+n),s=o.getNLSValue("Error.GetMajorRevisionFailure.Title",{objectName:g}),r(s)},l=function(e){n(e)},c.webServiceRequest({url:"dsmfg/private/V0/invoke/getMajorRevisions",method:"POST",data:e.Json.encode({pid:t}),onFailure:u,onTimeout:u,onCancel:u,onComplete:l})},isReadOnly:function(t,n,r,a){var s,u,l;u=function(e,t,n){i.debug("jsonData: "+e+" error:"+t+" options: "+n),a()},l=function(t){e.is(t.isReadOnly)&&t.isReadOnly&&(s=o.getNLSValue("Error.ObjNotInReadWrite.Title",{objectName:n})),r(s)},c.webServiceRequest({url:"dsmfg/private/V0/invoke/isReadOnly",method:"GET",data:{pid:t},onFailure:u,onTimeout:u,onCancel:u,onComplete:l})},isLatestRevision:function(t,n,r,a){var s,u,l;u=function(e,t,n){i.debug("jsonData: "+e+" error:"+t+" options: "+n),a()},l=function(t){e.is(t.isLatestRevision)&&!t.isLatestRevision&&(s=o.getNLSValue("Error.ObjNotLatestRevision.Title",{objectName:n})),r(s)},c.webServiceRequest({url:"dsmfg/private/V0/invoke/isLatestRevision",method:"GET",data:{pid:t},onFailure:u,onTimeout:u,onCancel:u,onComplete:l})},getWhereUsedReferences:function(e,t,n){a.getWhereUsedReferences(e,t,n)},getTenant:function(){return c.getTenant()},getSecurityContext:function(){return c.getSecurityContext()},get3DSpaceUrl:function(){return c.get3DSpaceUrl()},isEntityInstance:function(e){return u.isEntityInstance(e)},getAcceptedBaseTypesForCreation:function(){var t=[],n=u.getAcceptedBaseTypesForActions();return e.is(n)&&e.is(n.CREATION,"array")&&(t=n.CREATION),t},getFilteredInstancesFromCollection:function(e,t){return a.getFilteredInstancesFromCollection(e,t)}}}}}),define("DS/DELWKOModelBehaviors/DELWKOProductFlowBehavior",["UWA/Core","UWA/Promise"],function(e,t){"use strict";return{plugins:["DatabasePlugin","DicoPlugin","WebServicePlugin","ResourcePlugin"],creator:function(n,r,i,a,o,s){var c,u,l=["DELLmiTimeConstraintCnx","DELLmiMaterialPathCnxCust","LinearProductFlowCnx","DELLmiExecTimeConstraintRelation"];return u=function(t,n){var r,a,o;return o=t[t.length-1],!(!i.getImpacted(o,!1,{relationTypes:l}).some(function(r){return e.equals(r.get("from"),t)&&e.equals(r.get("to"),n)})&&(r=!1,(a=function(n){var o,s,c,u=n[n.length-1],g=i.getImpacted(u,!1,{relationTypes:l});for(c=0;c<g.length&&(o=g[c],!0!==r);c++)if(e.equals(o.get("from"),n)){if(e.equals(o.get("to"),t)){r=!0;break}s=o.get("to"),a(s)}})(n),!r))},c=function(t,n){var r,a,o,s,c,u,l={},g={},f=!1;if(e.is(t,"array")&&e.is(n,"array")){for(r=t.length-1;r>=0;r--){for(o=t[r],a=i.getInstance(o).get("isAggregatedBy"),s=n.length-1;s>=0;s--)if(c=n[s],e.is(g[c])?u=g[c]:(u=i.getInstance(c).get("isAggregatedBy"),g[c]=u),a===u&&o!==c){f=!0;break}if(f)break}l.fromPath=t.slice(r),l.toPath=n.slice(s)}return l},{listenTo:function(){},onStart:function(){},onStop:function(){},canCreateProductFlowLink:function(t,n){var r,o,l,g,f,d,p,m,L=!0,y={};return d=function(){var t=!1,n=g.toString(),i=f.toString();return g.length>0&&f.length>0&&0!==n.indexOf(i)&&0!==i.indexOf(n)&&(r=c(g,f),t=e.is(r)&&Array.isArray(r.fromPath)&&r.fromPath.length>0&&Array.isArray(r.toPath)&&r.toPath.length>0),t},p=function(){var t,n,o=!1;return e.is(r)&&Array.isArray(r.fromPath)&&r.fromPath.length>0&&(n=i.getInstance(r.fromPath[0]),e.is(n)&&(t=i.getReference(n.get("isAggregatedBy")),o=a.isAKindOf(t,"DELLmiHeaderWorkPlanReference"))),o},m=function(){var e;return e=i.getInstance(g[g.length-1]),"Linear"===i.getReference(e.get("isAggregatedBy")).get("V_SequencingMode")},t=t||{},e.is(t.fromSideAbsPath)&&e.is(t.toSideAbsPath)?(g=t.fromSideAbsPath,f=t.toSideAbsPath,o=s.getNLSValue(n),d()?p()?(L=!1,l=s.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.CommonParentIsHeaderWP",{linkType:o})):m()?(L=!1,l=s.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.ParentisInLinearSeqMode",{linkType:o})):u(r.fromPath,r.toPath)&&(L=!1,l=s.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.ExistOrLoop",{linkType:o})):(L=!1,l=s.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.NoCommonParent",{linkType:o}))):(L=!1,l=s.getNLSValue("ProductFlowLinkBehavior.canCreateProductFlowLinkError.InsufficentInfo")),y={canCreateLink:L},L?y.data=e.merge({type:n,fromSideOccPath:e.is(r,"object")?r.fromPath:null,toSideOccPath:e.is(r,"object")?r.toPath:null,displayText:e.is(o)?o:null,buttonIdentifier:e.is(o)?o:null},e.clone(t)):y.errorMessage=l,y},createProductFlowLink:function(n,r){var a=this;return new t(function(t,o){var s,c,u,l,g,f;n=n||{},u=a.canCreateProductFlowLink(n,n.type),l=n.fromSideOccPath[n.fromSideOccPath.length-1],g=n.toSideOccPath[n.toSideOccPath.length-1],f={linkType:n.type,target:l,source:g},u.canCreateLink?(s=function(){t(f)},c=function(t,n){e.is(n)&&(f.errorMessage=n),o(f)},i.createConnection({IDFrom:n.fromSideOccPath.toString(),IDTo:n.toSideOccPath.toString(),type:n.type},e.merge({onFailure:c,onTimeout:c,onCancel:c,onComplete:s},r||{}))):(f.errorMessage=u.errorMessage,o(f))})},getProductFlowRelationTypes:function(){return l},getProductFlowRelationTypeByPPRType:function(e){return l["OPERATION"===e?0:1]}}}}});