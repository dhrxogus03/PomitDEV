define("DS/UnifiedImportResults/models/JobNodeModel",["DS/TreeModel/TreeNodeModel","DS/UnifiedImport/utils/Essentials"],(e,t)=>e.extendNode({getImportedData:function(e){let i=this;var o=i.options.serviceName;return new UWA.Promise((e,n)=>{var s=null;(s=t._contextData.importerId?t.METHODS.find(e=>t._contextData.importerId===e.value):t.METHODS.find(e=>o===e.service&&"3DEXPERIENCE"!==e.value))?t.server({url:t.PLATFORM_SERVICES[s.service]+UWA.String.format(s.import.resulturl,i.options.jobId),onComplete:function(t){if(t){const i=JSON.parse(t),o=i&&i["Root Objects"]?i["Root Objects"]:null;o?e(o):n(new Error("no objects found"))}},onFailure:function(e,t){n(t.errormsg)}}):n(new Error("no method found"))})}})),define("DS/UnifiedImportResults/models/ImportResultNodeModel",["DS/Controls/TooltipModel","DS/TreeModel/TreeNodeModel","DS/UnifiedImport/utils/Essentials"],(e,t,i)=>{let o={label:"Import-PhysicalID",locale:"en",select_predicate:["ds6w:label","ds6w:type","ds6w:identifier","ds6w:modified","ds6w:created","ds6wg:revision","ds6w:status","ds6w:responsible","owner","ds6w:responsibleUid","ds6wg:filesize","ds6w:project","ds6w:dataSource","ds6w:community","ds6w:originator","dsgeo:referential","ds6w:lastModifiedBy","ds6w:repository","dcterms:title","dcterms:description","ds6w:containerUid","ds6w:description"],select_file:["icon","thumbnail_2d"],physicalid:"",select_snippets:["ds6w:snippet","ds6w:label:snippet","ds6w:responsible:snippet"],source:["3dspace"],tenant:""};return t.extendNode({verbose:function(){var e=this;return new UWA.Promise((t,n)=>{o.physicalid=e.options.resourceId,o.tenant=i.x3dPlatformId,i.server({url:i.PLATFORM_SERVICES["3DSpace"]+`/cvservlet/fetch/v2?tenant=${i.x3dPlatformId}`,data:JSON.stringify(o),method:"POST",headers:{SecurityContext:i.SECURITY_CONTEXT},onComplete:function(i){i=JSON.parse(i);try{i&&null!==i.results?(e.updateOptions(e.toNodeOpts(i.results[0])),t()):n(new Error("answer or answer.results is null"))}catch(e){n(new Error("answer or answer.results is null"))}},onFailure:function(){n()}})})},toNodeOpts:function(t){var o=this;o.__private__={};var n=t.attributes;n=n.reduce((e,t)=>(e[t.name]=t.value,e),{}),o.__private__.resourceId=n.resourceid,o.__private__.type=n["ds6w:type"],o.__private__.label=n["ds6w:label"];let s=n["ds6w:status"].split(".").pop().toUpperCase();return o.__private__.statusKey=i.STATUS_CODES[s].nlsKey?i.STATUS_CODES[s].nlsKey:void 0,{label:n["ds6w:label"],icon:n.type_icon_url,thumbnail:n.preview_url,subLabel:`${n["ds6w:type"]} | ${n["ds6wg:revision"]} | ${n["ds6w:responsible:snippet"]||n["ds6w:responsible"]}`,description:`${n["ds6w:identifier"]} ${n["ds6w:description"]?"| "+n["ds6w:description"]:""}`,contextualMenu:["contextualMenu"],emptyStatusbarVisibleFlag:!0,customTooltip:new e({title:n["ds6w:label"],allowUnsafeHTMLLongHelp:!0,allowUnsafeHTMLContent:!0,longHelp:o.buildTooltipHTML(n),reshowDelay:2.5}),grid:{title:{label:n["ds6w:label"],icon:n.preview_url},type:n["ds6w:type"],description:n["ds6w:description"],name:n["ds6w:identifier"],modified:n["ds6w:modified"],created:n["ds6w:created"],revision:n["ds6wg:revision"],status:o.__private__.statusKey?UWA.i18n(o.__private__.statusKey):void 0,statusKey:n["ds6w:status"],owner:{label:n["ds6w:responsible"]},contextualMenuData:null}}},buildTooltipHTML(e){let t={title:e["ds6w:label:snippet"],type:e["ds6w:type"],revision:e["ds6wg:revision"],maturityState:this.__private__.statusKey?UWA.i18n(this.__private__.statusKey):void 0,owner:e["ds6w:responsible"],modified:e["ds6w:modified"],CollaborativeSpace:e["ds6w:project"],name:e["ds6w:identifier"],description:e["ds6w:description"]},i=[];for(const e in t)!["type_icon_url","preview_url"].includes(e)&&t[e]&&(i.push({tag:"span",styles:{"font-weight":"bold"},text:`${UWA.i18n(`importresults.grid.column.${e}`)} : `}),i.push({tag:"span",text:`${t[e]}`}),i.push({tag:"br"}));return UWA.createElement("div",{html:i})},getActionResource:function(){return{resourceId:this.__private__.resourceId,type:this.__private__.type,label:this.__private__.label}},setContextualMenuData:function(e){this.options.grid.contextualMenuData={...e}}})}),define("DS/UnifiedImportResults/filters/ImportedDataFilter",["DS/TreeModel/BaseFilter"],e=>e.inherit({isDataFiltered:function(e){return!!this.filterModel.allowedEntries&&!(e.options.label&&e.options.label.search(new RegExp(this.filterModel.allowedEntries,"i"))>-1||e.options.subLabel&&e.options.subLabel.search(new RegExp(this.filterModel.allowedEntries,"i"))>-1)}})),define("DS/UnifiedImportResults/collections/ImportResultTreeDocument",["DS/TreeModel/TreeDocument","DS/UnifiedImportResults/models/ImportResultNodeModel","DS/UnifiedImportResults/filters/ImportedDataFilter"],(e,t,i)=>e.extend({init:function(e){this._parent(e),this._private_={dataIndex:0,ids:[]},this.getFilterManager().registerFilter("importedDataFilter",i)},populate:function(e,i){e.prepareUpdate(),i.forEach(i=>{var o=new t({resourceId:i,label:UWA.i18n("importresults.loader.loadingdetails"),thumbnail:"fakeurl"});e.addRoot(o),o.verbose()}),e.pushUpdate()},search:function(e,t){t&&t.trim()&&t.length?e.setFilterModel({status:{filterId:"importedDataFilter",filterModel:{allowedEntries:t},filterOptions:{ensureVisible:!0,keepChildren:!0}}}):e.resetSearch(e)},resetSearch:function(e){e.setFilterModel({status:{filterId:"importedDataFilter",filterModel:{allowedEntries:void 0}}})}})),define("DS/UnifiedImportResults/views/ImportResults",["UWA/Core","UWA/Class/View","DS/i3DXCompassPlatformServices/OpenWith","DS/Tweakers/GeneratedToolbar","DS/Tweakers/TypeEnums","DS/UIKIT/Native/Dropdown","DS/DataGridView/DataGridView","DS/CollectionView/ResponsiveTilesCollectionView","DS/UnifiedImportResults/collections/ImportResultTreeDocument","DS/UnifiedImport/utils/Essentials","i18n!DS/UnifiedImportResults/assets/nls/UnifiedImportResultsNLS","css!DS/UnifiedImportResults/UnifiedImportResults"],function(e,t,i,o,n,s,r,l,a,d,u){return UWA.i18n(u),t.extend({tagName:"div",className:"exchange-results-view-importresults",setup:function(){let e=this;e.container.style.position="relative",e.container.style.height="100%";var t=new UWA.Element("div",{class:"main-container",styles:{position:"relative",display:"flex",flexDirection:"column",height:"inherit"}}).inject(e.container);e.setupToolbar().inject(t),e.setupLayout().inject(t),e.subscription(),e.tileView.displayModalLoader(UWA.i18n("importresults.loader.pleasewait")),e.options.treeNodeModel.getImportedData().then(e.options.treeDocument.populate.bind(null,e.options.treeDocument)).finally(()=>{e.tileView.removeModalLoader()})},setupToolbar:function(){var e=this,t={entries:[{id:"layout",dataElements:{typeRepresentation:"functionIcon",value:function(t){var i=n.Layout.SmallTile.value;t.dsModel.icon.iconName===n.Layout.DataGridView.icon.iconName?(i=n.Layout.DataGridView.value,e.toolbar.updateNodeModel("layout",{label:UWA.i18n("importresults.actions.layout.tiles"),icon:n.Layout.SmallTile.icon})):(i=n.Layout.SmallTile.value,e.toolbar.updateNodeModel("layout",{label:UWA.i18n("importresults.actions.layout.grid"),icon:n.Layout.DataGridView.icon})),e.changeView(i)},icon:n.Layout.DataGridView.icon,position:"far",category:"Layout",label:UWA.i18n("importresults.actions.layout.grid")}}]},i=o.prototype.createTreeDocument(t);return e.toolbar=new o({touchMode:!1,overflowManagement:"dropdown",direction:"horizontal",items:i}),e.toolbar},setupLayout:function(){var e=this;e.options.treeDocument=new a({});let t=new l({displayedOptionalCellProperties:["contextualMenu","description"],useProgressBar:!1,displayTitleTooltip:!1,allowUnsafeHTMLContent:!0});return t.onContextualEvent={callback:function(t){e.setOpenWithMenu(e,t)}},t.loadApplicativeModel(e.options.treeDocument),e.tileView=t,e.tileView},setOpenWithMenu:function(e,t){let o=this;e.ctxMenu&&(e.ctxMenu.destroy(),e.dropdownOptions.target=t.data.target);let n=(new i).set3DXContent({data:{items:[{objectType:""}]}}).render(new s({items:[]}));t&&t.cellInfos&&t.cellInfos.cellModel&&[].push({text:"test",id:"noActionsAvailable"}),e.dropdownOptions={items:[]},e.dropdownOptions.events={onHide:function(){e.ctxMenu=null},onClickOutside:function(){e.ctxMenu=null}},e.dropdownOptions.target=t.data.target,e.dropdownOptions.bound=!1,e.dropdownOptions.removeOnHide=!0,e.dropdownOptions.className="search-ctx-actions-dropdown-container",e.ctxMenu=null,e.ctxMenu=new s(e.dropdownOptions);let r=t.cellInfos.nodeModel.options.grid.contextualMenuData;if(r)return n.set3DXContent(r).setIndex(0).render(e.ctxMenu),e.ctxMenu.show(),e.ctxMenu;o.contextMenuActions(t.cellInfos.nodeModel.getActionResource()).then(i=>(t.cellInfos.nodeModel.setContextualMenuData(i),n.set3DXContent(i).setIndex(0).render(e.ctxMenu),e.ctxMenu.show(),e.ctxMenu)).catch(e=>{console.error("An error occurred:",e)})},contextMenuActions:function(e){return new UWA.Promise((t,i)=>{let o={appName:widget.data.appId,objects:[{id:e.resourceId,type:e.type,source:"3dspace",isRecentObject:!1}],platformId:d.x3dPlatformId,applicativeInfo:{incontextMode:!1,clientAppInfo:{identifier:"3DDashboard"},addOpenWith:!0}};d.server({url:d.PLATFORM_SERVICES["3DSpace"]+"/resources/SNAPI/search_delegation/actions",data:JSON.stringify(o),method:"POST",headers:{SecurityContext:d.SECURITY_CONTEXT},onComplete:o=>{if("success"==(o=JSON.parse(o)).status){let i=o.actions[0].actions.find(e=>"3DCompass_#OpenWith"==e.id),n={protocol:"3DXContent",version:"2.0",source:"X3DSEAR_AP",widgetId:widget.id,data:{items:[{objectId:e.resourceId,objectType:e.type,envId:d.x3dPlatformId,serviceId:"3DSpace",displayName:e.label,displayType:"3D Shape",contextId:d.SECURITY_CONTEXT,objectTaxonomies:i.cmdInfo.type}]}};t(n)}else i()},onFailure:()=>{i("action not completed")}})})},subscription:function(){var e=this;widget.addEvent("onSearch",t=>{e.options.treeDocument.search(e.options.treeDocument,t)}),widget.addEvent("onRefresh",()=>{}),widget.addEvent("onResetSearch",function(t){e.options.treeDocument.resetSearch(e.options.treeDocument,t)})},changeView:function(e){let t=this;if("datagridview"==e){if(t.gridView)t.gridView.show();else{var i=new r({touchMode:!1,showContextualMenuColumnFlag:!0,treeDocument:t.options.treeDocument,placeholder:"",columns:[{text:UWA.i18n("importresults.grid.column.title"),dataIndex:"title",typeRepresentation:"url",width:250},{text:UWA.i18n("importresults.grid.column.type"),dataIndex:"type"},{text:UWA.i18n("importresults.grid.column.revision"),dataIndex:"revision",width:100},{text:UWA.i18n("importresults.grid.column.status"),dataIndex:"status",typeRepresentation:"tag",getCellSemantics:function(e){var t=e.nodeModel.options.grid.statusKey?e.nodeModel.options.grid.statusKey.split(".").pop().toUpperCase():void 0;if(t)return d.STATUS_CODES[t]}},{text:UWA.i18n("importresults.grid.column.created"),dataIndex:"created",typeRepresentation:"datetime",alignment:"near",getCellSemantics:function(e){return{timePickerPrecision:"sec"}}},{text:UWA.i18n("importresults.grid.column.modified"),dataIndex:"modified",typeRepresentation:"datetime",alignment:"near",getCellSemantics:function(e){return{timePickerPrecision:"sec"}}},{text:UWA.i18n("importresults.grid.column.description"),dataIndex:"description"},{text:UWA.i18n("importresults.grid.column.name"),dataIndex:"name"},{text:UWA.i18n("importresults.grid.column.owner"),dataIndex:"owner",typeRepresentation:"user"}],onContextualEvent:function(e){t.setOpenWithMenu(this,e)}}).inject(t.container);i.layout.cellHeight=40,i.layout.collectionView.showAlternateBackgroundFlag=!0,i.layout.rowsHeader=!1,i.layout.collectionView.showRowBorderFlag=!0,t.gridView=i}t.tileView.hide()}else t.gridView&&t.gridView.hide(),t.tileView.show()}})});