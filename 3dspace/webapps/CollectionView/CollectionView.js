define("DS/CollectionView/layouts/CollectionViewLayout",["DS/Core/BaseComponent","DS/Utilities/Utils"],function(e,t){"use strict";return e.inherit({name:"CollectionViewLayout",publishedProperties:{cellHeight:{defaultValue:30,type:"integer"},scrollPaddingBottom:{defaultValue:0,type:"integer"}},init:function(e){this._parent(e)},_applyProperties:function(e){this._parent(e),this.isDirty("scrollPaddingBottom")&&this._applyScrollPaddingBottom(e.scrollPaddingBottom),this.invalidate()},_applyScrollPaddingBottom:function(e,t){if(this.collectionView){var i=this;this.collectionView.getAllScrollers().forEach(function(e){e&&e.elements.container&&(e.elements.container.style.paddingBottom=i.scrollPaddingBottom+"px")})}},prepareLayout:function(){this._isInvalid=!1},postRender:function(){},_invalidate:function(e){return void 0===e&&(e={freePool:!0}),this._isInvalid=e,e},_getInvalidationContext:function(){return this._isInvalid},invalidate:function(e){var t=this._invalidate(e);this.collectionView&&this.collectionView.invalidateLayout(t)},isValid:function(){return!this._isInvalid},isCellSyncedAt:function(e){return!1},getCellType:function(e){var t="__item__";return this.isCellSyncedAt(e)&&(t="__sync_item__"),t},cellTypeCanChangeOnScroll:function(e){return!1},getHeaderContainerHeight:function(){return 0},_getFirstCellIDInScroller:function(){return 0},getLeftContainerWidth:function(){return 0},getRightContainerWidth:function(){return 0},getPositionForCellAt:function(e){return{top:e*this.cellHeight,left:0}},getDimensionsForCellAt:function(e){return{width:this.getContentDimensions().width,height:this.cellHeight}},getBoundingBoxForCellAt:function(e){return UWA.extend(this.getPositionForCellAt(e),this.getDimensionsForCellAt(e))},getContentDimensions:function(){var e=this.collectionView.getViewportDimensions(),i=this.collectionView.getModelLength()*this.cellHeight,n=e.height>i?0:t.getScrollbarWidth();return{width:e.width-n,height:i}},renderListOfVisibleCellsInViewport:function(e){var t=this.collectionView.getViewportDimensions(),i=this.collectionView.getScrollerPosition(),n=Math.floor(i.y/this.cellHeight),o=Math.floor((i.y+t.height)/this.cellHeight);n=Math.max(0,n),o=Math.min(o,this.collectionView.getModelLength()-1);for(var l=n;l<=o;l++)e.render(l)},getLayoutStylesForCellAt:function(e){var t=this.getPositionForCellAt(e);return{transform:"translate("+t.left+"px,"+t.top+"px)"}},getLayoutAttributesForCellAt:function(e){return{"cell-id":e}},isCellLayoutValidAt:function(e){return!0},computeCellRange:function(e,t){for(var i=[],n=Math.min(e,t),o=Math.max(e,t),l=n;l<=o;l++)this.collectionView.cellShouldBeSelected(l)&&i.push(l);return i},isCellInRange:function(e,t,i){var n=Math.min(t,i),o=Math.max(t,i);return e>=n&&e<=o},isNodeModelInRange:function(e,t,i){var n=!1;if(e){var o=e._getRowID();n=this.isCellInRange(o,t,i)}return n},getCellsFromNodeModel:function(e){var t=[];if(e){var i=e._getRowID();t.push(i)}return t},computeCenterContainerSideMargin:function(e,t,i){var n=t>i?i:t;return"right"===e&&(n+=t?-this._rightScrollContainerBorderSize:0),n},computeSideContainerMaxWidth:function(e,t,i,n){var o={left:{containerWidth:i,oppositeContainerWidth:n},right:{containerWidth:n,oppositeContainerWidth:i}}[e];if(o){var l=0;return o.containerWidth>0&&(l=o.oppositeContainerWidth>0?Math.floor((t-100)/2):Math.floor(t-100)),l}},computeCenterContainerMinWidth:function(e,t,i){var n=i-e-t;return e<=0&&t<=0&&(n=100),n},computeSideContainerWidth:function(e,t,i){var n=0;if("left"===e){const e=i||2;n=t+(t?e:0)}else if("right"===e){const e=i||1;n=t+(t?e:0)}return n},hasCellsInLeftContainer:function(){return!1},hasCellsInRightContainer:function(){return!1}})}),define("DS/CollectionView/CollectionViewCell",["DS/Controls/Abstract","DS/Controls/TooltipModel","DS/Utilities/Dom"],function(e,t,i){"use strict";return e.inherit({name:"CollectionViewCell",publishedProperties:{},init:function(e){this.collectionView=e&&void 0!==e.collectionView?e.collectionView:null,this.cellType=e&&void 0!==e.cellType?e.cellType:"",this._parent(),this._reusableContent=null,this.__cachedAttributes={},this.__cachedStyles={},this.__cachedCssClasses=null},_preBuildView:function(){this._parent(),this.elements.container.addClassName("wux-layouts-collectionview-cell")},_getContentContainer:function(){return this.getContent()},_getReusableContent:function(){return this.getReusableContent()},getReusableContent:function(){return this._reusableContent},_setReusableContent:function(e){this.setReusableContent(e)},setReusableContent:function(e){if(this._reusableContent!==e&&this.elements.container){var t=this._getContentContainer();if(t){if(this._reusableContent){var i=this._reusableContent.getContent?this._reusableContent.getContent():this._reusableContent;if(e){let n=e.getContent?e.getContent():e;null===i.parentElement?t.appendChild(n):t.replaceChild(n,i)}else t.innerHTML="";this._reusableContent.__disposable__&&this._reusableContent.__disposable__.dispose()}else if(e){let i=e.getContent?e.getContent():e;t.appendChild(i)}this._reusableContent=e}}},reuseCellContent:function(e){var t=this.collectionView.reuseCellContent(e);this.setReusableContent(t)},computeContentSize:function(){var e=0;let t;if(this._reusableContent&&(this._reusableContent.computeContentSize?e+=this._reusableContent.computeContentSize():i.isInstanceOfHTMLElementOrElement(this._reusableContent,"HTMLElement")?t=this._reusableContent:this._reusableContent.elements&&this._reusableContent.elements.container&&i.isInstanceOfHTMLElementOrElement(this._reusableContent.elements.container,"HTMLElement")&&(t=this._reusableContent.elements.container)),t){var n=this.getContent().style,o=n.lineHeight,l=n.display;n.lineHeight="",n.display="block",e+=t.offsetWidth,n.display=l,n.lineHeight=o}return Math.ceil(e)},_updateTooltip:function(e){this.tooltipInfos=void 0===e?void 0:e instanceof t?e:new t(e)},getInitialClassName:function(){return"wux-controls-abstract wux-layouts-collectionview-cell"},destroy:function(){this._reusableContent&&this._reusableContent.__disposable__&&this._reusableContent.__disposable__.destroy(),this._parent()}})}),define("DS/CollectionView/ModelBase",["DS/Core/BaseComponent","DS/TreeModel/ModelUtils","DS/TreeModel/TreeDocument","DS/Utilities/StringUtils"],function(e,t,i,n){"use strict";return e.inherit({name:"ModelBase",publishedProperties:{collectionView:{defaultValue:null,type:"object"},treeDocument:{defaultValue:null,type:"object"}},collectionView:{},_applyProperties:function(e){this._parent(e),this.isDirty("collectionView")&&this._applyCollectionView(e.collectionView),this.isDirty("treeDocument")&&this._applyTreeDocument(e.treeDocument)},_applyCollectionView:function(e){},_applyTreeDocument:function(e){},_getTreeDocument:function(){return this.treeDocument},_computeMatchingStringsCount:function(){for(var e=0,t=0;t<this.collectionView._matchingFoundArrays.length;t++)e+=this.collectionView._matchingFoundArrays[t].length;return e},_findAndDisplayAllCellIDsMatchingFindStr:function(e,t,i,n,o,l,s){var r=this,a=this.collectionView,c=performance.now();r._lastFindRequestTimeStamp=c;var h=function(i,o,s){o||r._findAllCellIDsMatchingFindStrInClientSide(e,t,n),l.call(a,i,s)};o?h.call(r,i,s):this._updateClientModelFromFind(e,t,i,h,s)},_updateClientModelFromFind:function(e,t,i,n,o,l){return n?n.call(this,i,o,l):0},_findAllCellIDsMatchingFindStrInClientSide:function(e,t,n){var o=this.collectionView;if(o._matchingFoundArrays=[],o._matchingCellIDsArray=[],o._matchingCellIDsMap={},o._matchingNodeModelsArray=[],o._matchingNodeModelsMap={},o._matchingAllNodeModelsArray=[],!n){var l=o.getNodeModelToProcessForFind;if(l)n=l.call(o,e,t);else{n=[];var s=this._getTreeDocument();o.modelProvider?(n=o.modelProvider.flattenApplicativeModel(o.applicativeModel),o.getTreeDocument()instanceof i&&(n=n.filter(e=>!1===e.isHidden()&&!1===e.isFiltered()))):s._getTrueRoot().processDescendants({onlyVisibleNodes:!1,processNode:function(e){var t=e.nodeModel;t&&!1===t.isHidden()&&!1===t.isFiltered()&&n.push(t)}})}}0!==n.length&&this._processNodeModelsForFind(n,e,t)},_processNodeModelsForFind:function(e,t,i){for(var o=this.collectionView,l=(o.layout,n.toComparable(o.findStr.toString(),{toLowerCase:!i})),s=0;s<e.length;s++){var r=e[s];if(r&&(r.hasRowID&&r.hasRowID()/*!nodeModel.hasNoRepresentation()*/||!r.hasRowID)){var a=!r.isVisible||r.isVisible(),c=!(void 0===r.hasRowID||!a||null!==r._getRowID())||void 0,h=(r._getRowID&&r._getRowID(c),o.getCellInfosAt(s)),u=!1===a?-1:h.cellID,d=o._getCellValueAsStringForFind(h);if(d&&UWA.is(d,"string")){var g=n.toComparable(d.toString(),{toLowerCase:!i}),p=o._getIndexesOfMatchingString(g,l);if(p.length>0){o._matchingFoundArrays.push(p),o._matchingCellIDsArray.push(u);var f=r.buildStringIdentifierArray;r._idForFind=f,o._matchingAllNodeModelsArray.push(r),-1!==u&&(o._matchingCellIDsMap[u]=o._matchingCellIDsArray.length-1),-1===o._matchingNodeModelsArray.indexOf(r)&&o._matchingNodeModelsArray.push(r),r._getRowID&&void 0!==r._getRowID()&&null!==r._getRowID()&&void 0===o._matchingNodeModelsMap[r._getRowID()]&&(o._matchingNodeModelsMap[r._getRowID()]=o._matchingNodeModelsArray.length-1)}}}}},_computeCurrentMatchingStringIndex:function(e,t){return t>0?t-1:0},_computeFindEditorCurrentValue:function(){var e=void 0;return"substring"===this.collectionView.findNavigationMode&&(e=this.collectionView._currentMatchingStringIndex+1),e},_computeMatchingNodeModelsCount:function(){return this.collectionView._matchingNodeModelsArray.length},_computeNextMatchingData:function(e,t){var i=-1;if("substring"===e.findNavigationMode)i=e._currentMatchingStringIndex===this._computeMatchingStringsCount(t)-1?0:e._currentMatchingStringIndex+1;else if("cell"===e.findNavigationMode){var n=e._currentMatchingCellIDIndex;n===e._matchingCellIDsArray.length-1?n=0:n+=1,i=e._getMatchingStringIndexFromMatchingCellIDIndex(n)}return i},_computePreviousMatchingData:function(e){var t=-1;if("substring"===e.findNavigationMode)t=0===e._currentMatchingStringIndex?e.matchingStringCount-1:e._currentMatchingStringIndex-1;else if("cell"===e.findNavigationMode){var i=e._currentMatchingCellIDIndex;0===i?i=e._matchingCellIDsArray.length-1:i-=1,t=e._getMatchingStringIndexFromMatchingCellIDIndex(i)}else{var n=e._currentMatchingRowIDIndex;0===n?n=e._matchingNodeModelsArray.length-1:n-=1,t=e._getMatchingStringIndexFromMatchingRowIDIndex(n)}return t},_isServerSide:function(){return!1}})}),define("DS/CollectionView/CollectionViewPaginationManager",["DS/Controls/Abstract"],function(e){"use strict";return e.inherit({name:"CollectionViewPaginationManager",publishedProperties:{pageSize:{defaultValue:100,type:"number"},currentPage:{defaultValue:1,type:"integer",advancedSetter:!0}},_id:0,updatePagination:function(){if(this._collectionView&&this._collectionView._onPaginationChangeAsyncLoadModelCB){var e=this;this._asyncPaginationTimeout&&clearTimeout(this._asyncPaginationTimeout),this._asyncPaginationTimeout=setTimeout(function(){e._collectionView._modelEvents.subscribeOnce({event:"paginationChangeAsyncDone"},function(){e._collectionView._asyncPaginationInitialized=1,e._collectionView.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!1}),e._broadcastPaginationUpdate()}),e._collectionView._onPaginationChangeAsyncLoadModelCB.call(e._collectionView,{pageSize:e.pageSize,currentPage:e.currentPage})},800)}else this._collectionView&&this._collectionView._updateModel(),this._broadcastPaginationUpdate()},_applyPageSize:function(){this.updatePagination()},_preEditCurrentPage:function(e,t){return parseInt(t)===t&&t>=1},_applyCurrentPage:function(){this.updatePagination()},_applyProperties:function(e){this._parent(e),(this.isDirty("pageSize")||this.isDirty("currentPage"))&&this.updatePagination()},_broadcastPaginationUpdate:function(){if(this._paginationUpdateSubscribers&&this._paginationUpdateSubscribers.length)for(var e=0;e<this._paginationUpdateSubscribers.length;e++){var t=this._paginationUpdateSubscribers[e];t.methodToCall.call(t.instance)}},subscribeToPaginationUpdate:function(e,t){return this._paginationUpdateSubscribers||(this._paginationUpdateSubscribers=[]),this._paginationUpdateSubscribers.push({instance:e,methodToCall:t,id:this._id++}),this._id},unsubscribeToPaginationUpdate:function(e){if(!this._paginationUpdateSubscribers||e>this.id||e<0)return console.warn("Trying to unsubscribe from pagination update an id that has not been subscribed before"),!1;for(var t=0;t<this._paginationUpdateSubscribers.length;t++)if(this._paginationUpdateSubscribers[t].id===e)return this._paginationUpdateSubscribers.splice(t,1),!0;return!1},pageNumberModified:function(){this._collectionView&&this._broadcastPaginationUpdate()},getPageNumber:function(){if(this._collectionView){var e=this._collectionView.getModelLength();if(e)return Math.ceil(e/this.pageSize);if(0===e)return 1}},getNumberOfItemsOnPage:function(e){void 0===e&&(e=this.currentPage);var t=this._collectionView.getModelLength(),i=Math.max(Math.ceil(t/this.pageSize),1);return e>i||e<0?void 0:e===i?t-(i-1)*this.pageSize:this.pageSize}})}),define("DS/CollectionView/CollectionViewStatusBar",["DS/TreeModel/TreeDocument","DS/Tweakers/GeneratedToolbar","i18n!DS/CollectionView/assets/nls/collectionviewstatusbar"],function(e,t,i){"use strict";function n(e,t){return t?{grid:{data:e}}:{id:this._defaultStatusCpt++,dataElements:{typeRepresentation:"string",value:e}}}function o(e,t){var o=i.get("TotalRows")+e;return n.call(this,o,t)}function l(e,t){var o=i.get("TotalVisibleRows")+e;return n.call(this,o,t)}function s(e,t){var o=i.get("SelectedRows")+e;return n.call(this,o,t)}function r(e,t,o){var l=i.get("SelectedCountOfTotalCount",{selectedCount:e,totalCount:t});return n.call(this,l,o)}function a(e,t){var o=i.get("SelectedCells")+e;return n.call(this,o,t)}function c(e,t){var o=e>-1?this.collectionView.getCellIDAsString(e):i.get("NoActiveCell"),l=n.call(this,o,t);return!t&&l&&l.dataElements&&(l.dataElements.tooltip=i.get("ActiveCellTooltip")),l}function h(e){var t=this;if(t.collectionView&&t.collectionView.paginationManager){var i=t.collectionView.paginationManager.currentPage,n=t.collectionView.paginationManager.getPageNumber();return i>n&&(i=n),e?{grid:{data:i},minValue:1,maxValue:n}:{id:t._defaultStatusCpt++,dataElements:{typeRepresentation:"pagination",value:i,readOnly:!1,minValue:1,maxValue:n}}}}var u=t.inherit({publishedProperties:{overflowManagement:{defaultValue:"dropdown",type:"string",category:"Behavior"},height:{defaultValue:"auto",type:"string"},collectionView:{defaultValue:null,type:"DS/CollectionView/CollectionView",readOnly:!0,noNeedToApplyFlag:!0}},updateActiveCellID:function(e){var t=c.call(this,e,!0);this._listOfActiveCellStatusNode.forEach(function(e){e.updateOptions(t)})},updateTotalRows:function(){let e=this.collectionView,t=e.virtuallyLoadAllModelItems?e.getModelLength():this._isCollectionViewUsingATreeDocument?e.getTreeDocument().getAllDescendants().length:e.getModelLength();var i=o.call(this,t,!0);this._listOfTotalRowsStatusNode.forEach(function(e){e.updateOptions(i)})},updateTotalVisibleRows:function(){let e=this.collectionView,t=e.virtuallyLoadAllModelItems?e.getModelLength():this._isCollectionViewUsingATreeDocument?e.getTreeDocument().getNumberOfVisibleDescendants():e.getModelLength(),i=l.call(this,t,!0);this._listOfTotalVisibleRowsStatusNode.forEach(function(e){e.updateOptions(i)})},updatePagination:function(e){var t=h.call(this,!0);this._listOfPaginationNode.forEach(function(e){e.updateOptions(t)})},setModel:function(e){this._clean();var t=[],i=this;e.forEach(function(e){var n=function(e){var t={position:e.position||"near",readOnly:!0};switch(e.type){case u.STATUS.NB_ITEMS:var i=this._isCollectionViewUsingATreeDocument&&!this.collectionView.virtuallyLoadAllModelItems?this.collectionView.getTreeDocument().getAllDescendants().length:this.collectionView.getModelLength();UWA.extend(t,o.call(this,i)),this._listOfTotalRowsStatusNode.push(t.id);break;case u.STATUS.NB_VISIBLE_ITEMS:i=this._isCollectionViewUsingATreeDocument&&!this.collectionView.virtuallyLoadAllModelItems?this.collectionView.getTreeDocument().getNumberOfVisibleDescendants():this.collectionView.getModelLength(),UWA.extend(t,l.call(this,i)),this._listOfTotalVisibleRowsStatusNode.push(t.id);break;case u.STATUS.NB_SELECTED_ROWS:if(!(d=this.collectionView.getNodesXSO()))return;UWA.extend(t,s.call(this,d.get().length)),this._listOfSelectedRowsStatusNode.push(t.id);break;case u.STATUS.NB_SELECTED_CELLS:var n=this.collectionView.getCellsXSO();if(!n)return;UWA.extend(t,a.call(this,n.get().length)),this._listOfSelectedCellsStatusNode.push(t.id);break;case u.STATUS.NB_SELECTED_AND_TOTAL_ROWS:var d;if(!(d=this.collectionView.getNodesXSO()))return;i=this._isCollectionViewUsingATreeDocument&&!this.collectionView.virtuallyLoadAllModelItems?this.collectionView.getTreeDocument().getAllDescendants().length:this.collectionView.getModelLength(),UWA.extend(t,r.call(this,d.get().length,i)),this._listOfSelectedAndTotalRowsStatusNode.push(t.id);break;case u.STATUS.ACTIVE_CELL:var g=this.collectionView.getActiveCellID();UWA.extend(t,c.call(this,g)),this._listOfActiveCellStatusNode.push(t.id);break;case u.STATUS.PAGINATION:UWA.extend(t,h.call(this)),this._listOfPaginationNode.push(t.id);break;case u.STATUS.CUSTOM:default:UWA.extend(t,e)}return t}.call(i,e);n&&n.dataElements&&t.push(n)}),i.updateModel({entries:t}),this._listOfTotalRowsStatusNode.forEach(function(e,t){i._listOfTotalRowsStatusNode[t]=i.getNodeModelByID(e)}),this._listOfSelectedRowsStatusNode.forEach(function(e,t){i._listOfSelectedRowsStatusNode[t]=i.getNodeModelByID(e)}),this._listOfSelectedAndTotalRowsStatusNode.forEach(function(e,t){i._listOfSelectedAndTotalRowsStatusNode[t]=i.getNodeModelByID(e)}),this._listOfSelectedCellsStatusNode.forEach(function(e,t){i._listOfSelectedCellsStatusNode[t]=i.getNodeModelByID(e)}),this._listOfActiveCellStatusNode.forEach(function(e,t){i._listOfActiveCellStatusNode[t]=i.getNodeModelByID(e)}),this._listOfPaginationNode.forEach(function(e,t){i._listOfPaginationNode[t]=i.getNodeModelByID(e)}),this._listOfTotalVisibleRowsStatusNode.forEach(function(e,t){i._listOfTotalVisibleRowsStatusNode[t]=i.getNodeModelByID(e)});var n=this.collectionView.paginationManager;n&&(i._listOfPaginationNode.forEach(function(e){e.addEventListener("nodeModelUpdate",function(){n.currentPage=e.options.grid.data})}),n.subscribeToPaginationUpdate(i,function(){i.updatePagination()}))},_preBuildView:function(t){t.items||(t.items=new e,this._properties.items.value=t.items),this._parent(t)},buildView:function(){this._parent(),this.getContent().addClassName("wux-collectionview-statusBar"),this._clean(),this._isCollectionViewUsingATreeDocument=!1},_postBuildView:function(){if(this._parent(),this.collectionView){var e=this,t=this.collectionView,i=this.collectionView.getNodesXSO();if(i){var n=function(n){if(e._listOfSelectedRowsStatusNode.length>0){var o=s.call(e,i.get().length,!0);e._listOfSelectedRowsStatusNode.forEach(function(e){e.updateOptions(o)})}if(e._listOfSelectedAndTotalRowsStatusNode.length>0){var l=t.virtuallyLoadAllModelItems?t.getModelLength():t.getTreeDocument().getAllDescendants().length;o=r.call(e,i.get().length,l,!0);e._listOfSelectedAndTotalRowsStatusNode.forEach(function(e){e.updateOptions(o)})}};i.onPostAdd(n),i.onPostRemove(n)}var o=this.collectionView.getCellsXSO();if(o){var l=function(t){var i=a.call(this,o.get().length,!0);e._listOfSelectedCellsStatusNode.forEach(function(e){e.updateOptions(i)})};o.onPostAdd(l),o.onPostRemove(l)}var c=this.collectionView.getTreeDocument();if(c){this._isCollectionViewUsingATreeDocument=!0;var h=!1;c.onUpdate(function(){h&&(h=!1,e.updateTotalRows(),e.updateTotalVisibleRows())});var u=function(){h=!0};c.addEventListener("addChild",u),c.addEventListener("removeChild",u),c.onPostExpand(this.updateTotalVisibleRows.call(this)),c.onPostCollapse(this.updateTotalVisibleRows.call(this))}}},_clean:function(){this._defaultStatusCpt=0,this._listOfTotalRowsStatusNode=[],this._listOfTotalVisibleRowsStatusNode=[],this._listOfSelectedRowsStatusNode=[],this._listOfSelectedAndTotalRowsStatusNode=[],this._listOfSelectedCellsStatusNode=[],this._listOfActiveCellStatusNode=[],this._listOfPaginationNode=[]},_applyHeight:function(e){this.getContent().setStyle("height",this.height)},_applyProperties:function(e){this._parent(e),this.isDirty("height")&&this._applyHeight(e.height)}});return u.STATUS={CUSTOM:0,NB_ITEMS:1,NB_SELECTED_ROWS:2,NB_SELECTED_CELLS:3,ACTIVE_CELL:4,PAGINATION:5,NB_VISIBLE_ITEMS:6,NB_SELECTED_AND_TOTAL_ROWS:7},u}),define("DS/CollectionView/edition/CollectionViewEdition",["UWA/Core","DS/Core/BaseComponent","DS/Utilities/KeyboardUtils"],function(e,t,i){"use strict";return t.inherit({onCellActivate:function(e){return 0},onCellUnactivate:function(e){return 0},onCellPreselect:function(e){return 0},onCellEndPreselect:function(e){return 0},onCellPointerDown:function(e){return 0},onCellDoubleClick:function(e){return 0},onCellDragStart:function(e){return 0},onF2:function(e){return 0},onEscape:function(e){return 0},onEnter:function(e){return 0},onKeyEvent:function(e,t){return!this.collectionView.editOnKeyPressFlag||this.collectionView.getFocusOnCellContentFlag()||"keydown"!==t.type||t.ctrlKey||t.altKey||t.keyCode===i.SHIFT||!(t.keyCode<i.F1||t.keyCode>i.F12)?{stopPropagation:!1}:(this.collectionView._setEditionMode(e,!0),this.collectionView.setFocusOnCellContentFlag(!0),{stopPropagation:!0})},isCellAlwaysInEdition:function(e){return!1},_applyProperties:function(e){this._parent(e)}})}),define("DS/CollectionView/commands/CollectionViewCommands",[],function(){"use strict";return{copy:function(){return this.onCopy()},paste:function(){return this.onPaste()},cut:function(){return this.onCut()},deleteKeyPressed:function(){var e=this.getTreeDocument?this.getTreeDocument():void 0;return e&&e.getXSO()&&this._modelEvents.publish({event:"deleteKeyPressed",data:e.getXSO().get()}),{stopPropagation:!1}},selectAll:function(){return this.selectAllVisibleNodes(),{preventDefault:!0}},escape:function(){var e=!1,t=this.getActiveCellID();if(-1!==t){var i=this.getEditionManager(t);i&&(e=1===i.onEscape(t))}return this.selectionBehavior.unselectAllOnEscapeKey&&!e&&this.unselectAll(),{stopPropagation:e}},enter:function(){var e=this.getActiveCellID();if(-1!==e){var t=this.getEditionManager(e);return t&&t.onEnter(e),this.selectCell(this.computeCellIDFromActiveCell("enter"),!1,!1),{preventDefault:!0}}return{preventDefault:!0,stopPropagation:!1}},shiftEnter:function(){var e=this.getEditionManager(this.getActiveCellID());return e&&e.onEnter(this.getActiveCellID()),this.selectCell(this.computeCellIDFromActiveCell("enter",!1,!0),!1,!1),{preventDefault:!0}},ctrlSpaceKeyPressed:function(e){if(!e.actionPerformed){var t=this.getActiveCellID();return void 0!==t&&(this.isCellSelected(t)?this.unselectCell(t):this.selectCell(t,!0,!1)),{preventDefault:!0}}},upMove:function(){var e=this.computeCellIDFromActiveCell("up");return this.selectionBehavior.toggle?this.setActiveCell(e):this.selectCell(e,!1,!1),{preventDefault:!0}},rightMove:function(){var e=this.computeCellIDFromActiveCell("right");return this.selectionBehavior.toggle?this.setActiveCell(e):this.selectCell(e,!1,!1),{preventDefault:!0}},downMove:function(){var e=this.computeCellIDFromActiveCell("down");return this.selectionBehavior.toggle?this.setActiveCell(e):this.selectCell(e,!1,!1),{preventDefault:!0}},leftMove:function(){var e=this.computeCellIDFromActiveCell("left");return this.selectionBehavior.toggle?this.setActiveCell(e):this.selectCell(e,!1,!1),{preventDefault:!0}},ctrlUp:function(){return this.setActiveCell(this.computeCellIDFromActiveCell("up",!0)),{preventDefault:!0}},ctrlRight:function(){return this.setActiveCell(this.computeCellIDFromActiveCell("right",!0)),{preventDefault:!0}},ctrlDown:function(){return this.setActiveCell(this.computeCellIDFromActiveCell("down",!0)),{preventDefault:!0}},ctrlLeft:function(){return this.setActiveCell(this.computeCellIDFromActiveCell("left",!0)),{preventDefault:!0}},shiftUp:function(){return this.selectCell(this.computeCellIDFromActiveCell("up",!1,!0),!1,!0),{preventDefault:!0}},shiftRight:function(){return this.selectCell(this.computeCellIDFromActiveCell("right",!1,!0),!1,!0),{preventDefault:!0}},shiftDown:function(){return this.selectCell(this.computeCellIDFromActiveCell("down",!1,!0),!1,!0),{preventDefault:!0}},shiftLeft:function(){return this.selectCell(this.computeCellIDFromActiveCell("left",!1,!0),!1,!0),{preventDefault:!0}},tab:function(){return this.selectCell(this.computeCellIDFromActiveCell("tab"),!1,!1),{preventDefault:!0}},shiftTab:function(){return this.selectCell(this.computeCellIDFromActiveCell("tab",!1,!0),!1,!1),{preventDefault:!0}},pageup:function(){return this.selectCell(this.computeCellIDFromActiveCell("pageup"),!1,!1),{preventDefault:!0}},pagedown:function(){return this.selectCell(this.computeCellIDFromActiveCell("pagedown"),!1,!1),{preventDefault:!0}},shiftPageup:function(){return this.selectCell(this.computeCellIDFromActiveCell("pageup",!1,!0),!1,!0),{preventDefault:!0}},shiftPagedown:function(){return this.selectCell(this.computeCellIDFromActiveCell("pagedown",!1,!0),!1,!0),{preventDefault:!0}},home:function(){return this.selectCell(this.computeCellIDFromActiveCell("home"),!1,!1),{preventDefault:!0}},end:function(){return this.selectCell(this.computeCellIDFromActiveCell("end"),!1,!1),{preventDefault:!0}},ctrlHome:function(){return this.setActiveCell(this.computeCellIDFromActiveCell("home",!0),!0,!1),{preventDefault:!0}},ctrlEnd:function(){return this.setActiveCell(this.computeCellIDFromActiveCell("end",!0),!0,!1),{preventDefault:!0}},shiftHome:function(){return this.selectCell(this.computeCellIDFromActiveCell("home",!1,!0),!1,!0),{preventDefault:!0}},shiftEnd:function(){return this.selectCell(this.computeCellIDFromActiveCell("end",!1,!0),!1,!0),{preventDefault:!0}},f2:function(){var e=this.getEditionManager(this.getActiveCellID());return e&&e.onF2(this.getActiveCellID()),{preventDefault:!0}},plus:function(e){if(this._onPlusKeyPressed&&this._onPlusKeyPressed(e),e.actionPerformed)return{preventDefault:!0};this.commands.defaultKeyEventCallback.call(this,e)},minus:function(e){if(this._onMinusKeyPressed&&this._onMinusKeyPressed(e),e.actionPerformed)return{preventDefault:!0};this.commands.defaultKeyEventCallback.call(this,e)},asterisk:function(e){if(this._onAsteriskKeyPressed&&this._onAsteriskKeyPressed(e),e.actionPerformed)return{preventDefault:!0};this.commands.defaultKeyEventCallback.call(this,e)},slash:function(e){if(this._onSlashKeyPressed&&this._onSlashKeyPressed(e),e.actionPerformed)return{preventDefault:!0};this.commands.defaultKeyEventCallback.call(this,e)},defaultKeyEventCallback:function(e){var t=this.getActiveCellID(),i=this.getEditionManager(t);return i?i.onKeyEvent(t,e):{stopPropagation:!1}}}}),define("DS/CollectionView/modelProviders/CollectionViewModelProvider",["require","exports","DS/Selection/XSO"],function(e,t,i){"use strict";return function(){function e(){this.modelEventsListener=[]}return e.prototype._pushUpdateView=function(e,t){var i=this.collectionView;i&&(i._updateCounter--,0===i._updateCounter&&(i._updateNeeded||t)&&this.updateView(e,t))},e.prototype.getModelClass=function(){return""},e.prototype.addModelEvents=function(){},e.prototype.removeModelEvents=function(){},e.prototype.flattenApplicativeModel=function(e){throw"No implementation found for flattenApplicativeModel method."},e.prototype.fillApplicativeModelFromViewModel=function(e,t){throw"No implementation found for fillApplicativeModelFromArrayModel method."},e.prototype.getNodeModelRowID=function(e,t){return this.collectionView.model.indexOf(e)},e.prototype.selectNode=function(e,t){var i=this.getNodesXSO();i&&(t?i.unique(e):this.isNodeSelected(e)||i.add(e))},e.prototype.unSelectNode=function(e){var t=this.getNodesXSO();t&&this.isNodeSelected(e)&&t.remove(e)},e.prototype.isNodeSelected=function(e){var t=this.getNodesXSO();return!!t&&t.isIn(e)},e.prototype.selectAllVisibleNodes=function(){throw"No implementation found for selectAllVisibleNodes method."},e.prototype.unselectAll=function(){var e=this.getNodesXSO();e&&e.empty()},e.prototype.isNodeVisible=function(e){return!0},e.prototype.isNodeModelInRange=function(e,t,i){var n=!1;if(e){var o=this.getNodeModelRowID(e);n=this.isCellInRange(o,t,i)}return n},e.prototype.isCellInRange=function(e,t,i){var n=Math.min(t,i),o=Math.max(t,i);return e>=n&&e<=o},e.prototype.shouldAcceptDrag=function(e){return!0},e.prototype.dumpNodeModel=function(e,t){throw"No implementation found for dumpNodeModel method."},e.prototype.getNodesXSO=function(){return this.collectionView.supportsSelection()?(this.selectionModel||(this.selectionModel=new i({getElementID:this.getXSOElementID,useUniqueID:!0,areEquals:this.areXSONodesEquals}),this.collectionView._addModelEvents()),this.selectionModel):null},e.prototype.getXSOElementID=function(e){throw"No implementation of getXSOElementID is found."},e.prototype.areXSONodesEquals=function(e,t){return e.getXSOElementID()===t.getXSOElementID()},e.prototype.getPropertyValue=function(e,t){return""},e.prototype.updateView=function(e,t){var i=this.collectionView;if(i&&i._isReady)return i._renderViewport(e)},e}()}),define("DS/CollectionView/modelProviders/IconChooserBaseModelProvider",["require","exports","DS/UWAUtils/WUXUWAUtils2"],function(e,t,i){"use strict";return function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.modelEventsListener=[]}return e.prototype.addModelEvents=function(e){},e.prototype.removeModelEvents=function(e){},e.prototype.areItemsEquals=function(e,t){return JSON.stringify(e)===JSON.stringify(t)},e.prototype.flattenModel=function(e){return e},e.prototype.getIconDefinition=function(e){return e.icon?e.icon:e},e.prototype.getTooltip=function(e){return e.description?e.description:null},e.inherit=i.inherit,e.extend=i.extend,e}()}),define("DS/CollectionView/edition/CollectionViewDelayedEditionOnClick",["DS/CollectionView/edition/CollectionViewEdition","DS/Utilities/TouchUtils"],function(e,t){"use strict";return e.inherit({onCellUnactivate:function(e){this.collectionView._setEditionMode(e,!1),this._avoidCellEdition()},onCellActivate:function(e){this.collectionView.getFocusOnCellContentFlag()&&!0!==this.collectionView.PointerDownScope&&!0!==this.collectionView.PointerHitScope?(this.collectionView._setEditionMode(e,!0),this.collectionView._focusActiveCellContent()):this.collectionView.getContent().focus({preventScroll:!0})},onCellEndPreselect:function(e){},onCellPreselect:function(e){},onCellPointerDown:function(e){var t=this.collectionView;if(t.isCellSelected(e)&&t.isCellActive(e)){var i,n=t.rowSelection,o=t.cellSelection;if("single"===o||"multiple"===o?i=t.getCellsXSO():"single"!==n&&"multiple"!==n||(i=t.getNodesXSO()),i&&i.get().length>1);else{this._avoidCellEdition(),this._editionTimeout=setTimeout(function(){t._setEditionMode(e,!0),t.setFocusOnCellContentFlag(!0)},500)}}else t.setFocusOnCellContentFlag(!1);t.__latestPointerDown__={cellID:e,timestamp:Date.now()}},onCellDoubleClick:function(e){this._avoidCellEdition()},onCellDragStart:function(e){this._avoidCellEdition()},onF2:function(e){this.collectionView._setEditionMode(e,!0),this.collectionView.setFocusOnCellContentFlag(!0)},onEscape:function(e){return this._avoidCellEdition(),this.collectionView.getFocusOnCellContentFlag()?(this.collectionView.setFocusOnCellContentFlag(!1),this.collectionView._setEditionMode(e,!1),1):0},onEnter:function(e){this.collectionView.setFocusOnCellContentFlag(!1),this.collectionView._setEditionMode(e,!1)},_avoidCellEdition:function(){this._editionTimeout&&(clearTimeout(this._editionTimeout),this._editionTimeout=null)}})}),define("DS/CollectionView/edition/CollectionViewEditionOnClick",["UWA/Core","DS/CollectionView/edition/CollectionViewEdition"],function(e,t){"use strict";return t.inherit({onCellUnactivate:function(e){this.collectionView._setEditionMode(e,!1)},onCellActivate:function(e){this.collectionView._setEditionMode(e,!0),this.collectionView.getFocusOnCellContentFlag()&&this.collectionView._focusActiveCellContent()},onCellEndPreselect:function(e){},onCellPreselect:function(e){},onCellPointerDown:function(e){this.collectionView.setFocusOnCellContentFlag(!0)},onCellDoubleClick:function(e){},onF2:function(e){this.onCellPointerDown(e)},onEscape:function(e){return this.collectionView.getFocusOnCellContentFlag()?(this.collectionView.setFocusOnCellContentFlag(!1),1):0},onEnter:function(e){this.collectionView.setFocusOnCellContentFlag(!1)}})}),define("DS/CollectionView/edition/CollectionViewEditionOnDoubleClick",["UWA/Core","DS/CollectionView/edition/CollectionViewEdition"],function(e,t){"use strict";return t.inherit({onCellActivate:function(e){this.collectionView.getFocusOnCellContentFlag()?(this.collectionView._setEditionMode(e,!0),this.collectionView._focusActiveCellContent()):this.collectionView.getContent().focus({preventScroll:!0})},onCellUnactivate:function(e){this.collectionView._setEditionMode(e,!1)},onCellPreselect:function(e){},onCellEndPreselect:function(e){},onCellPointerDown:function(e){this.collectionView.getActiveCellID()!==e&&this.collectionView.setFocusOnCellContentFlag(!1)},onCellDoubleClick:function(e){this.collectionView._setEditionMode(e,!0),this.collectionView.setFocusOnCellContentFlag(!0)},onF2:function(e){this.onCellDoubleClick(e)},onEscape:function(e){return this.collectionView.getFocusOnCellContentFlag()?(this.collectionView.setFocusOnCellContentFlag(!1),this.collectionView._setEditionMode(e,!1),1):0},onEnter:function(e){this.collectionView.setFocusOnCellContentFlag(!1),this.collectionView._setEditionMode(e,!1)}})}),define("DS/CollectionView/edition/CollectionViewEditionInPlace",["UWA/Core","DS/CollectionView/edition/CollectionViewEdition"],function(e,t){"use strict";return t.inherit({onCellUnactivate:function(e){},onCellActivate:function(e){this.collectionView._focusActiveCellContent()},onCellEndPreselect:function(e){},onCellPreselect:function(e){},onCellPointerDown:function(e){this.collectionView.setFocusOnCellContentFlag(!0)},onCellDoubleClick:function(e){},onF2:function(e){this.onCellPointerDown(e)},onEscape:function(e){return this.collectionView.getFocusOnCellContentFlag()?(this.collectionView.setFocusOnCellContentFlag(!1),1):0},isCellAlwaysInEdition:function(e){return!0},onEnter:function(e){this.collectionView.setFocusOnCellContentFlag(!1)}})}),define("DS/CollectionView/edition/CollectionViewEditionOnOver",["UWA/Core","DS/CollectionView/edition/CollectionViewEdition"],function(e,t){"use strict";return t.inherit({publishedProperties:{},onCellUnactivate:function(e){this.collectionView.getPreselectedCellID()!==e&&this.collectionView._setEditionMode(e,!1)},onCellActivate:function(e){this.collectionView._setEditionMode(e,!0),this.collectionView.getFocusOnCellContentFlag()&&!0!==this.collectionView.PointerDownScope&&this.collectionView._focusActiveCellContent()},onCellEndPreselect:function(e){this.collectionView.getActiveCellID()!==e&&this.collectionView._setEditionMode(e,!1)},onCellPreselect:function(e){this.collectionView._setEditionMode(e,!0)},onCellPointerDown:function(e){this.collectionView.setFocusOnCellContentFlag(!0)},onCellDoubleClick:function(e){},onF2:function(e){this.onCellPointerDown(e)},onEscape:function(e){return this.collectionView.getFocusOnCellContentFlag()?(this.collectionView.setFocusOnCellContentFlag(!1),1):0},onEnter:function(e){this.collectionView.setFocusOnCellContentFlag(!1)}})});var __extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/CollectionView/modelProviders/CollectionViewUWACollectionModelProvider",["require","exports","UWA/Core","UWA/Class/Collection","DS/CollectionView/modelProviders/CollectionViewModelProvider"],function(e,t,i,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getModelClass=function(){return n},t.prototype._updateModel=function(e,t,i){var n=this.collectionView,o=this,l=this.modelProvider;!1!==i&&n&&n._updateCounter>0?n._updateNeeded=!0:("update"===e&&(o=this.collectionView.applicativeModel,l=this),"onAdd"!==e&&"onRemove"!==e&&"onChange"!==e&&"onReset"!==e&&"onSort"!==e&&"update"!==e||(n.model=l.flattenApplicativeModel(o),n.invalidateLayout({updateCellContent:!0})))},t.prototype.addModelEvents=function(){var e=this.collectionView.applicativeModel;e&&(e.addEvent("onAnyEvent",this._updateModel),e.collectionView=this.collectionView,e.modelProvider=this)},t.prototype.removeModelEvents=function(){var e=this.collectionView.applicativeModel;e&&e.removeEvent("onAnyEvent",this._updateModel,this)},t.prototype.flattenApplicativeModel=function(e){return e.toArray()},t.prototype.fillApplicativeModelFromViewModel=function(e,t){e&&t&&e.reset(t,{silent:!0})},t.prototype.selectAllVisibleNodes=function(){var e=this.collectionView.applicativeModel;if(e){var t=[],i=this.getNodesXSO();if(!i)return;for(var n=0;n<e.size();n++)t.push(e.at(n));i.empty(),i.add(t),this.collectionView.model&&this.collectionView.model.length&&this.collectionView.setActiveNode(this.collectionView.model[this.collectionView.model.length-1],!1)}},t.prototype.getXSOElementID=function(e){return e.cid},t.prototype.shouldAcceptDrag=function(e){return!0},t.prototype.dumpNodeModel=function(e,t){var n={};return(t=i.extend({properties:[function(){return{property:"label",value:e.get("label")}},function(){return{property:"icons",value:e.get("icons")}}]},t)).properties.forEach(function(t){if("function"===i.typeOf(t)){var o=t.call(e);n[o.property]=o.value}}),n},t.prototype.getPropertyValue=function(e,t){return e.get(t)},t.prototype.updateView=function(e,t){this.collectionView&&this._updateModel("update",void 0,!1)},t}(o)}),define("DS/CollectionView/layouts/CollectionViewGridLayout",["DS/CollectionView/layouts/CollectionViewLayout"],function(e){"use strict";function t(e,t,i){var n,o=e.collectionView.getViewportDimensions(!0);for(var l in i){if(!(t>=parseFloat(l)))break;var s=i[l];if("string"==typeof s){var r=parseFloat(e.rowMaxHeight);s=(o.height-e.gutter-e.layoutMargins.marginTop)/100*r}n=s}return n}return e.inherit({name:"CollectionViewGridLayout",publishedProperties:{gutter:{defaultValue:0,type:"integer"},layoutMargins:{defaultValue:{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0},type:"object"},direction:{defaultValue:"vertical",type:"string"},columnMaxWidth:{defaultValue:140,type:"integer"},rowMaxHeight:{defaultValue:140,type:"integer"},useDynamicColumnWidth:{defaultValue:!0,type:"boolean"},useDynamicRowHeight:{defaultValue:!1,type:"boolean"},getRowHeightFunction:{defaultValue:null,type:"function"}},_applyGutter:function(e){this.layoutMargins!==e&&this.collectionView._onGutterOrMarginsChange()},_applyLayoutMargins:function(e){this.layoutMargins!==e&&this.collectionView._onGutterOrMarginsChange()},_applyGetRowHeightFunction:function(e,t){this._useVariableRowHeight=void 0!==this.getRowHeightFunction&&null!==this.getRowHeightFunction,this.resetRowHeights()},_computeRowHeight:function(e){if(this._computedRows[e]||(this._computedRows[e]={}),void 0===this._computedRows[e].height){var t=this.getDefaultRowHeight(),i=0;if("function"==typeof this.getRowHeightFunction){var n=this.getRowHeightFunction(e);i=void 0!==n?n:t}this._computedRows[e]||(this._computedRows[e]={}),this._computedRows[e].height=i||t}return this._computedRows[e].height},resetRowHeights:function(e){this._resetComputedRows();var t=e||{updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1};this.invalidate(t)},_resetComputedRows:function(){this._computedRows=[]},resetRowHeight:function(e){if(this._computedRows[e]&&void 0!==this._computedRows[e].height){var t=this._computedRows[e].height;if(this._computedRows[e].height=void 0,this.getRowHeight(e)!==t){for(var i=e+1;i<this._computedRows.length;i++)this._computedRows[i]&&(this._computedRows[i].top=void 0);this.invalidate({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})}}},_computeRowHeightAndPosition:function(e){this._computeRowPosition(e),this._computeRowHeight(e)},_postBuild:function(){this._parent()},isSectionAt:function(e){return this.collectionView.getNodeModelAtRowID(e).options&&"fake"===collectionView.getNodeModelAtRowID(e).options.nodeCategory},init:function(e){this._parent(e),this._useVariableRowHeight=!!this._useVariableRowHeight},_applyProperties:function(e){this._parent(e),this.isDirty("getRowHeightFunction")&&this._applyGetRowHeightFunction(e.getRowHeightFunction)},prepareLayout:function(){this._parent();var e=this,t=e.collectionView.getViewportDimensions(!0),i=e._getColumnMaxWidthInPixel(t),n=e._getRowHeightInPixel(t);!function(){var o=(t.width-e.gutter-e.layoutMargins.marginLeft-e.layoutMargins.marginRight)/(i+e.gutter);e._numberOfColumns=Math.max(Math.floor(o),1);var l=(t.height-e.gutter-e.layoutMargins.marginTop-e.layoutMargins.marginBottom)/(n+e.gutter);e._numberOfRows=Math.max(Math.floor(l),1)}();var o=function(){if(this.useDynamicColumnWidth){var l=this._columnWidth;this._columnWidth=Math.floor((t.width-(this._numberOfColumns+1)*this.gutter-this.layoutMargins.marginLeft-this.layoutMargins.marginRight)/this._numberOfColumns),this._columnWidthUsedForRowHeight=this._columnWidth,e.collectionView.getViewportDimensions(!0).width!==t.width&&(this._columnWidthUsedForRowHeight=l)}else this._columnWidth=Math.floor(i),this._columnWidthUsedForRowHeight=this._columnWidth;this.useDynamicRowHeight?this._rowHeight=Math.floor((t.height-(this._numberOfRows+1)*this.gutter-this.layoutMargins.marginTop-this.layoutMargins.marginBottom)/this._numberOfRows):this._rowHeight=Math.floor(n);var s=!1;this._columnWidth>this.columnMaxWidth&&(this._numberOfColumns++,s=!0),this._rowHeight>this.rowMaxHeight&&(this._numberOfRows++,s=!0),s&&o.call(this)};o.call(this)},getCellCoordinatesAt:function(e){var t;if("vertical"===this.direction){var i=this._getNumberOfColumns();t={rowID:Math.floor(e/i),columnID:e%i}}else{var n=this._numberOfRows;t={rowID:e%n,columnID:Math.floor(e/n)}}return t},getCellIDFromCoordinates:function(e){return this._numberOfColumns*e.rowID+e.columnID},_getPositionForCellAt:function(e){var t=this.getCellCoordinatesAt(e);if(t)var i={left:t.columnID*(this._getColumnWidth()+this.gutter)+this.gutter+this.layoutMargins.marginLeft,top:this.getRowPosition(t.rowID)};return i},getPositionForCellAt:function(e){return this._getPositionForCellAt(e)},getCellIDFromPositionInView:function(e){var t=-1;if(e){var i=this.getHeaderContainerHeight();if(e.top>=i){var n=this.gutter,o=this._getRowIDFromPosition(e.top),l=Math.floor((e.left-this.layoutMargins.marginLeft)/(this._getColumnWidth()+n));if(o>=0&&l>=0){var s=e.top-this.getRowPosition(o),r=e.left-this.layoutMargins.marginLeft-l*(this._getColumnWidth()+n);s>=0&&r>=n&&(t=this.getCellIDFromCoordinates({rowID:o,columnID:l}))}}}return t},getDimensionsForCellAt:function(e){return{width:this._getColumnWidth(),height:this.getRowHeight(e)}},_getRowIDFromPosition:function(e,t){var i=-1,n=this.getRowSpacing();if(this._useVariableRowHeight){if(e>=0){for(var o=this.collectionView.getModelLength()-1,l=0;l<=o;l++){if(e<=this.getRowPosition(l)){i=Math.max(0,l-1),t&&i+1<=o&&i++;break}}-1===i&&(i=o)}}else i=t?Math.ceil(e/(this.getRowHeight()+n)):Math.floor(e/(this.getRowHeight()+n));return i},_getColumnIDFromPosition:function(e,t){var i=-1;if(this._useVariableRowHeight){if(e>=0){for(var n=this.collectionView.getModelLength()-1,o=0;o<=n;o++){if(e<=this._getColumnPosition(o)){i=Math.max(0,o-1),t&&i+1<=n&&i++;break}}-1===i&&(i=n)}}else{let n=this.gutter;i=t?Math.ceil(e/(this._getColumnWidth()+n)):Math.floor(e/(this._getColumnWidth()+n))}return i},_getColumnMaxWidthInPixel:function(e){var i;switch(typeof this.columnMaxWidth){case"string":var n=parseFloat(this.columnMaxWidth);i=Math.floor((e.width-this.gutter-this.layoutMargins.marginLeft)/100*n);break;case"number":i=this.columnMaxWidth;break;case"object":i=t(this,e.width,this.columnMaxWidth)}return i},_getRowHeightInPixel:function(e){var i;switch(typeof this.rowMaxHeight){case"string":var n=parseFloat(this.rowMaxHeight);i=Math.round((e.height-this.gutter-this.layoutMargins.marginTop)/100*n);break;case"number":i=this.rowMaxHeight;break;case"object":i=t(this,e.height,this.rowMaxHeight)}return i},_getColumnWidth:function(){return this._columnWidth},getRowHeight:function(e){return(this._useVariableRowHeight&&void 0!==e&&e>=0?this._computeRowHeight(e):this.getDefaultRowHeight())+(this.collectionView.showRowBorderFlag?1:0)},_computeRowPosition:function(e,t){if(this._computedRows[e]||(this._computedRows[e]={}),void 0===this._computedRows[e].top){for(var i=0;!t&&i<e;i++)this._computeRowPosition(i,!0),this._computeRowHeight(i);let n=this.layoutMargins.marginTop+this.gutter;this._computedRows[e].top=e>0?this.getRowPosition(e-1)+this.getRowHeight(e-1)+this.getRowSpacing()+n:n}return this._computedRows[e].top},getRowPosition:function(e){var t=0;if(e>=0)if(this._useVariableRowHeight&&void 0!==e)this._computedRows[e]&&void 0!==this._computedRows[e].top||this._computeRowHeightAndPosition(e),this._computedRows[e]&&void 0!==this._computedRows[e].top&&(t=this._computedRows[e].top);else{let i=this.layoutMargins.marginTop+this.gutter;t=(this.getRowHeight()+this.getRowSpacing())*e+i}return t},getRowSpacing:function(){return this.gutter},getDefaultRowHeight:function(){return this._rowHeight?this._rowHeight:this.rowMaxHeight},_getColumnPosition:function(e){return e*(this._getColumnWidth()+this.gutter)+this.gutter+this.layoutMargins.marginLeft},getContentDimensions:function(){var e=this.collectionView.getViewportDimensions(),t=this._getLastCellIDInScroller(),i=this.getPositionForCellAt(t),n=this.getDimensionsForCellAt(t),o={height:i.top+n.height+this.gutter+this.layoutMargins.marginBottom,width:i.left+n.width+this.gutter+this.layoutMargins.marginRight},l=this.collectionView.getScrollbarWidth();if("vertical"===this.direction)return{width:o.height>e.height?e.width-l:e.width,height:o.height};var s=o.width>e.width?e.height-l:e.height;return{width:o.width,height:s}},getMinMaxVisibleRowIDs:function(){this.isValid()||this.prepareLayout();var e=this.collectionView.getViewportDimensions(),t=this.collectionView.getScrollerPosition(),i=this._getRowIDFromPosition(t.y),n=this._getRowIDFromPosition(t.y+e.height,!0),o=this._getNumberOfItems(),l=o-1;return(n<=-1||n>=l)&&t.y+e.height>0&&(n=l),0===o&&(i=-1,n=-1),{minRowID:i,maxRowID:n}},getMinMaxVisibleColumnIDs:function(){this.isValid()||this.prepareLayout();var e=this.collectionView.getViewportDimensions(),t=this.collectionView.getScrollerPosition(),i=this._getColumnIDFromPosition(t.x),n=this._getColumnIDFromPosition(t.x+e.width,!0),o=this._getNumberOfItems(),l=o-1;return(n<=-1||n>=l)&&t.x+e.width>0&&(n=l),0===o&&(i=-1,n=-1),{minColumnID:i,maxColumnID:n}},getMinMaxVisibleCellIDs:function(){this.isValid()||this.prepareLayout();var e=this._getFirstCellIDInScroller();let t,i;if("horizontal"===this.direction){let n=this.getMinMaxVisibleColumnIDs(),o=this._getNumberOfRows();t=e+n.minColumnID*o-0*o,i=e+(n.maxColumnID+1)*o+0*o-1}else{let n=this.getMinMaxVisibleRowIDs(),o=this._getNumberOfColumns();t=e+n.minRowID*o-0*o,i=e+(n.maxRowID+1)*o+0*o-1}return{minCellID:t=Math.max(e,t),maxCellID:i=Math.min(i,e+this._getLastCellIDInScroller())}},_getLastCellIDInScroller:function(){return this._getNumberOfItems()-1},_getNumberOfColumns:function(){return this._numberOfColumns},_getNumberOfRows:function(){return this._numberOfRows},_computeMinCellID:function(){var e=0,t=this.collectionView.getViewportDimensions(!0),i=this.collectionView.getScrollerPosition();return e="vertical"===this.direction?Math.max(Math.floor((i.y-this.layoutMargins.marginTop)/(this.getRowHeight()+this.gutter)),0)*Math.floor((t.width-this.layoutMargins.marginLeft-this.layoutMargins.marginRight)/(this._getColumnWidth()+this.gutter)):Math.max(Math.floor((i.x-this.layoutMargins.marginLeft)/(this._getColumnWidth()+this.gutter)),0)*Math.floor((t.height-this.layoutMargins.marginTop-this.layoutMargins.marginBottom)/(this.getRowHeight()+this.gutter)),e=Math.min(e,this._getNumberOfItems()-1)},renderListOfVisibleCellsInViewport:function(e){this.collectionView.getViewportDimensions(),this.collectionView.getScrollerPosition();this.direction;var t=this.getMinMaxVisibleCellIDs();let i=t.minCellID,n=t.maxCellID;if(!isNaN(i)&&i>=0){for(var o=i;o<=n;o++)e.render(o);this.__currentRenderedRange={minCellID:i,maxCellID:n}}},getLayoutStylesForCellAt:function(e){var t=this.getPositionForCellAt(e),i=this.getDimensionsForCellAt(e);if(t){var n=i.height+"px";return{transform:"translate3d("+Math.round(t.left)+"px,"+Math.round(t.top)+"px,0)",width:i.width+"px",height:n,lineHeight:n}}return{}},getLayoutAttributesForCellAt:function(e){var t=this.getCellCoordinatesAt(e);return{"cell-id":e,"row-id":t?t.rowID:void 0,"column-id":t?t.columnID:void 0}},_getNumberOfItems:function(){return this.collectionView.paginationManager?this.collectionView.paginationManager.getNumberOfItemsOnPage():this.collectionView.getModelLength()}})}),define("DS/CollectionView/layouts/CollectionViewListLayout",["DS/CollectionView/layouts/CollectionViewGridLayout"],function(e){"use strict";return e.inherit({name:"CollectionViewListLayout",publishedProperties:{rowMaxHeight:{defaultValue:40,type:"integer"},columnMaxWidth:{defaultValue:"100%",type:"integer"}}})}),define("DS/CollectionView/CollectionView",["UWA/Drivers/Alone","DS/CoreEvents/ModelEvents","DS/Core/PointerEvents","DS/Controls/Scroller","DS/Utilities/Dom","DS/Utilities/Utils","UWA/Utils/Client","DS/Utilities/RAFDispatcher","DS/Utilities/ReusableContentsManager","DS/Controls/Abstract","DS/CollectionView/layouts/CollectionViewGridLayout","DS/CollectionView/CollectionViewCell","DS/CollectionView/commands/CollectionViewCommands","DS/CollectionView/CollectionViewStatusBar","DS/Selection/XSO","DS/Utilities/DeviceUtils","DS/Controls/ModalContainer","DS/Controls/ModalLoader","DS/Core/WebUXComponents","DS/CollectionView/ModelBase"],function(e,t,i,n,o,l,s,r,a,c,h,u,d,g,p,f,m,C,v,_){"use strict";var w=s.Engine;const y=Object.freeze({toggle:!1,unselectAllOnEmptyArea:!0,unselectAllOnEscapeKey:!1,selectNodeModelOnCellSelection:!0,selectOnContextualEvent:!0,selectOnPointerUp:!1,showMixedStateOnParents:!1});function S(e,t){var i={},n={};for(var o in t)e[o]!==t[o]&&(i[o]=t[o]);for(var l in e)void 0===t[l]&&(n[l]=t[l]);return{toAdd:i,toRemove:n}}return c.inherit({name:"CollectionView",publishedProperties:{model:{defaultValue:[],type:"array"},cellClass:{defaultValue:u,type:"object"},layout:{defaultValue:void 0,type:"object"},height:{defaultValue:"inherit",type:"integer"},showScrollbarsOnHover:{defaultValue:!1,type:"boolean"},rowSelection:{defaultValue:"multiple",type:"string"},cellPreselectionFeedback:{defaultValue:"cell",type:"string"},cellSelection:{defaultValue:"none",type:"string"},selectionBehavior:{defaultValue:void 0,type:"object",advancedSetter:!0},onDelayedModelDataRequest:{defaultValue:null,type:"function"},pageScrollValueTriggeringInfiniteScroll:{defaultValue:void 0,type:"object"},showBackgroundFlag:{defaultValue:!0,type:"boolean"},editOnKeyPressFlag:{defaultValue:!0,type:"boolean"},paginationManager:{defaultValue:void 0,type:"Object"},getScrollbarWidth:{defaultValue:function(e){return l.getScrollbarWidth(e)},type:"function"},findNavigationMode:{defaultValue:"substring",type:"string"}},_preBuildView:function(i){this._uuid=e.Utils.getUUID(),this._properties.selectionBehavior.value=Object.assign({},y),this._isInitialized=!1,this._reusableCellContentManager=new a,this._cellPool=new a,this._listOfRenderedCells=new Map,this._updateCounter=0,this._updateNeeded=!1,this._visibleCellsInViewport={},this._modelEvents=new t,i&&void 0!==i.layout||void 0!==this._properties.layout.value||(this._properties.layout.value=new h),this._manageKeyboard(),this._parent(i)},buildView:function(){this._parent(),this._buildLayout(),this.elements.container.setAttribute("tabindex","0")},_handleEvents:function(){this._parent(),this._manageSelection()},_applyIdentifier:function(e){this.identifier&&this.getContent().setAttribute("wux-identifier",this.identifier)},getUUID:function(){return this._uuid},supportsKeyboardNavigation:function(){return!1},supportsSelection:function(){return!1},supportsLightRendering:function(){return!1},supportsCustomScrolling:function(){return!1},getXSOElementID:function(e){return e},_getXSOElementFromCellID:function(e){return e},getCellIDFromXSOElement:function(e){return e},isCellSelected:function(e){var t=!1,i=this.cellSelection;if("single"!==i&&"multiple"!==i||(t=this._XSO&&this._XSO.isIn(this._getXSOElementFromCellID(e))),!t){var n=this.rowSelection;if("single"===n||"multiple"===n){var o=this.getNodeModelAt(e);if(o){var l=this.getNodesXSO();l&&(t=l.isIn(o))}}}return t},isCellPreselected:function(e){return this.getPreselectedCellID()===e},isCellHighlighted:function(e){return!(!e.nodeModel||!e.nodeModel.isHighlighted)&&e.nodeModel.isHighlighted()},isCellActive:function(e){return this.getActiveCellID()===e},_hasSelectedDescendants:function(e){var t=this.getNodeModelAt(e);return!!(t&&t._nbSelectedDescendants>0)},setActiveCell:function(e,t,i){var n=!1,l=this.getActiveCellID();if(l!==e){var s;if(l>=0)(s=this.getEditionManager(l))&&(o.pushUserInteractionContext(),s.onCellUnactivate(l),o.popUserInteractionContext());if(this.getCellActivableState(e)||(e=-1),this._activeCellStableID=this._getXSOElementFromCellID(e),l>=0&&this._updateRenderedActiveCell(l),e>=0)(s=this.getEditionManager(e))&&!i&&s.onCellActivate(e),this._updateRenderedActiveCell(e),0!=t&&(n=this.ensureCellVisible(e));this.elements.statusBar&&this.elements.statusBar.updateActiveCellID(e),this.fire("activeCellChange")}return this._setLastRangeCell(e,t),n},getCellEditableState:function(e){return!1},getCellActivableState:function(e){return!0},getEditionManager:function(e){return null},_addCellInEdition:function(e){this._cellInEdition||(this._cellInEdition={}),this._cellInEdition[e]=!0},_removeCellInEdition:function(e){this._cellInEdition&&delete this._cellInEdition[e]},isCellInEdition:function(e){if(!this.getCellEditableState(e))return!1;if(this._cellInEdition&&this._cellInEdition[e])return!0;var t=this.getEditionManager(e);return!!t&&t.isCellAlwaysInEdition(e)},_setEditionMode:function(e,t){if(this.isCellInEdition(e)===t||t&&!this.getCellEditableState(e))return!1;if(!t){var i=this.getEditionManager(e);if(!i||i.isCellAlwaysInEdition(e))return!1}var n=this._getViewAt(e);return n&&n._reusableContent&&(t?(this._addCellInEdition(e),n._reusableContent.getContent&&n._reusableContent.getContent()&&n._reusableContent.getContent().setAttribute("tabindex",-1)):(this._removeCellInEdition(e),n._reusableContent.getContent&&n._reusableContent.getContent()&&n._reusableContent.getContent().removeAttribute("tabindex"),document.activeElement&&o.isActiveElementInContainer(n.getContent(),{lookInPopup:!0})&&document.activeElement.blur()),void 0!==n._reusableContent.readOnly&&n._reusableContent.readOnly===!t||(void 0!==n._reusableContent.readOnly&&(n._reusableContent.readOnly=!t),this._onEditionModeChanged(e,t),this.updateCellView(e,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0}))),!0},_onEditionModeChanged:function(e,t){},setFocusOnCellContentFlag:function(e){e?(this._focusActiveCellContent(),this._focusOnCellMode=!0):this._focusOnCellMode&&(this.getContent().focus({preventScroll:!0}),this._focusOnCellMode=!1)},getFocusOnCellContentFlag:function(){return this._focusOnCellMode},_focusActiveCellContent:function(){var e=this._getViewAt(this.getActiveCellID());if(e&&e._reusableContent&&e._reusableContent.focus){e._reusableContent.focus({preventScroll:!0});let t=e._reusableContent.getContent?e._reusableContent.getContent():e._reusableContent;o.isActiveElementInContainer(t,{lookInPopup:!0})||this.getContent().focus({preventScroll:!0})}else this.getContent().focus({preventScroll:!0})},getActiveCellID:function(){return this.getCellIDFromXSOElement(this._activeCellStableID)},_setLastRangeCell:function(e,t){this._lastRangeCellID!==e&&(this._lastRangeCellID=e,0!=t&&this.ensureCellVisible(e))},_getLastRangeCellID:function(){return this._lastRangeCellID},computeCellIDFromActiveCell:function(e,t,i){return-1},_applyRowSelection:function(){this.getContent().setAttribute("row-selection",this.rowSelection),this.unselectAll(),this._isReady&&this._renderViewport({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})},getUsedCellPreselectionFeedback:function(){if(void 0===this._usedCellPreselectionFeedback){var e=this.cellPreselectionFeedback;if("cell"===e){var t=this.cellSelection;"single"!==t&&"multiple"!==t&&(e="row")}this._usedCellPreselectionFeedback=e}return this._usedCellPreselectionFeedback},_applyCellPreselectionFeedback:function(e){this._usedCellPreselectionFeedback=void 0},_applyCellSelection:function(){this.getContent().setAttribute("cell-selection",this.cellSelection),this.unselectAll()},getNodesXSO:function(){let e=null;const t=this.getTreeDocument();return t&&(e=t.getXSO()),e},getNodesPXSO:function(){let e=null;const t=this.getTreeDocument();return t&&(e=t.getPXSO()),e},getCellsXSO:function(){return this._XSO},selectNodeModel:function(e,t,i){var n=this.model;if(e&&n&&n.length>0){var o=this.rowSelection;if("single"===o||"multiple"===o){this.layout;if(i&&"multiple"===o){var l=this.getTreeDocument();if(l){var s=l.getXSO();if(s){var r=0,a=this.getActiveCellID();if(a>=0){var c=this.getNodeModelAt(a);c&&(r=c._getRowID())}var h=e._getRowID(),u=Math.min(r,h),d=Math.max(r,h);if(!t){var g=[];s.get().forEach(function(e){var t=e._getRowID();(t<u||t>d)&&g.push(e)}),g.length>0&&s.remove(g)}for(var p=[],f=u;f<=d;f++){(e=this.getNodeModelAtRowID(f))&&!s.isIn(e)&&l.options.shouldBeSelected.call(l,e)&&(p.push(e),l.options.shouldSelectDescendants.call(l,e)&&e.processDescendants({processNode:function(e){l.options.shouldBeSelected.call(l,e.nodeModel)&&p.push(e.nodeModel)}}))}p.length>0&&s.add(p)}}}else t&&"multiple"===o?e.select(!1):e.select(!0)}}},unselectNodeModel:function(e){e&&e.unselect()},selectCell:function(e,t,i,n){var o=this.rowSelection,l=this.cellSelection;if(!this.cellShouldBeSelected(e)||"single"!==o&&"multiple"!==o&&"single"!==l&&"multiple"!==l)this.setActiveCell(e,n);else{var s=this,r=this.layout;if("single"===l||"multiple"===l){if(this._XSO)if(i&&"multiple"===l){var a=this.getActiveCellID(),c=r.computeCellRange(a,e);if(c){var h=[];this._XSO.get().forEach(function(t){r.isCellInRange(s.getCellIDFromXSOElement(t),a,e)||h.push(t)}),h.length>0&&this._XSO.remove(h);for(var u=this.getTreeDocument(),d=[],g=0;g<c.length;g++){var p=c[g];(f=this.getNodeModelAt(p))&&(!u||u&&u.options.shouldBeSelected.call(u,f))&&d.push(this._getXSOElementFromCellID(p))}this._XSO.add(d)}}else{u=this.getTreeDocument();(f=this.getNodeModelAt(e))&&(!u||u&&u.options.shouldBeSelected.call(u,f))?t&&"multiple"===l?this._XSO.add(this._getXSOElementFromCellID(e)):this._XSO.unique(this._getXSOElementFromCellID(e)):t||this._XSO.empty()}}else if(!1!==this.selectionBehavior.selectNodeModelOnCellSelection){var f;(f=this.getNodeModelAt(e))&&this.selectNodeModel(f,t,i)}i?this._setLastRangeCell(e,n):this.setActiveCell(e,n)}},unselectCell:function(e){var t=this.cellSelection;if("single"===t||"multiple"===t)this._XSO&&this._XSO.remove(this._getXSOElementFromCellID(e));else{var i=this.rowSelection;if("single"===i||"multiple"===i){var n=this.getNodeModelAt(e);n&&n.unselect()}}},selectAll:function(e){var t=this.rowSelection,i=this.cellSelection;if("multiple"===t||"multiple"===i){var n=this.getTreeDocument();if(n){var o=this,l=this.layout,s=[],r=[];void 0===e&&(e=!1),n.withTransactionUpdate(function(){return n.processDescendants({onlyVisibleNodes:e||o.__selectAllOnlyOnVisibleNodes,processNode:function(a){if(n.options.shouldBeSelected.call(n,a.nodeModel))if("multiple"===t)s.push(a.nodeModel);else if("multiple"===i){var c=l.getCellsFromNodeModel(a.nodeModel,e);if(c&&c.length>0)for(var h=0;h<c.length;h++)r.push(o._getXSOElementFromCellID(c[h]))}}}),"multiple"===t?(o.__selectAllOnlyOnVisibleNodes||n.getXSO().empty(),n.getXSO().add(s)):"multiple"===i&&o._XSO&&(o._XSO.empty(),o._XSO.add(r)),{updateType:WUXModelUpdateTypes.Selection}})}}},selectAllVisibleNodes:function(){this.selectAll(!0)},unselectAll:function(){if(this.__selectAllOnlyOnVisibleNodes){const e=this.layout,t=[],i=[],n=this.getTreeDocument();n&&(n.processDescendants({onlyVisibleNodes:!0,processNode:n=>{t.push(n.nodeModel);const o=e.getCellsFromNodeModel(n.nodeModel,!0);i.push(...Array.from(o,e=>this._getXSOElementFromCellID(e)))}}),n.getXSO().remove(t),this._XSO&&this._XSO.remove(i))}else{this._XSO&&this._XSO.empty();const e=this.getTreeDocument();e&&e.unselectAll()}},isEveryVisibleNodeSelected:function(){var e=!1,t=this.getTreeDocument();if(t){var i=t.getXSO();if(i){var n=this.model;if(i.get().length){e=!0;const s=t.options.shouldBeSelected!==t.defaultOptions.shouldBeSelected;for(var o=0;o<n.length;o++){var l=this.getNodeModelAtRowID(o);if((!s||t.options.shouldBeSelected.call(t,l))&&!i.isIn(l)){e=!1;break}}}}}return e},cellShouldBeSelected:function(e){return e>=0&&e<this.getModelLength()},setPreselectedCell:function(e){var t=this.getPreselectedCellID();if(t!==e){var i,n;if(this._preselectedCellStableID=void 0!==e?this._getXSOElementFromCellID(e):void 0,t>=0)(i=this.getNodeModelAt(t))&&i.unPreSelect&&i.unPreSelect(),this._updateRenderedCellAttributes(t),(n=this.getEditionManager(t))&&n.onCellEndPreselect(t);if(e>=0)(i=this.getNodeModelAt(e))&&i.preSelect&&i.preSelect(),this._updateRenderedCellAttributes(e),(n=this.getEditionManager(e))&&n.onCellPreselect(e);this.fire("preselectedCellChange")}},getPreselectedCellID:function(){return void 0!==this._preselectedCellStableID?this.getCellIDFromXSOElement(this._preselectedCellStableID):void 0},_shouldHandleCopy:function(e){return!!this._useClipboardFlag&&!!this._isFocused()},_shouldHandlePaste:function(e){return this._shouldHandleCopy(e)},_manageSelection:function(){if(this.supportsSelection()){var e,t=this;this._XSO=new p({useUniqueID:!0,getElementID:this.getXSOElementID}),this._XSO.onPostAdd(function(e){e.forEach(function(e){var i=t.getCellIDFromXSOElement(e);t._updateRenderedCellAttributes(i)})}),this._XSO.onPostRemove(function(e){e.forEach(function(e){var i=t.getCellIDFromXSOElement(e);t._updateRenderedCellAttributes(i)})}),o.addEventOnElement(this,this,i.POINTERMOVE,function(n,o){i.isTouchEvent(n)?(t._preventSelectionForTouchScroll=!0,clearTimeout(e),e=setTimeout(function(){t._preventSelectionForTouchScroll=!1},2e3),t._preventPreSelectionForTouchMode=!0):t._preventPreSelectionForTouchMode=!1,o?o.cellView&&o.cellView._reusableContent&&o.cellView._reusableContent.managePreselection&&o.cellView._reusableContent.managePreselection(n)?t.setPreselectedCell(void 0):t.setPreselectedCell(o.cellID):t.setPreselectedCell(void 0)}),o.addEventOnElement(this,this,"mouseleave",function(){t.setPreselectedCell(void 0)}),o.addEventOnElement(this,this,i.POINTERHIT,function(e,i){if(2===e.multipleHitCount&&i){e.preventDefault();var n=t.getEditionManager(i.cellID);n&&n.onCellDoubleClick(i.cellID)}}),o.addEventOnElement(this,this.getContent(),"copy",function(e){if(t._shouldHandleCopy(e)){var i=t._copyToPlainText();if(e&&e.clipboardData)e.clipboardData.setData("text/plain",i);else{var n=window.clipboardData;n&&n.setData("Text",i)}e.preventDefault(),t._hiddenInput&&(t._hiddenInput.destroy(),t._hiddenInput=null,t._oldActiveElement&&(t._oldActiveElement.focus({preventScroll:!0}),t._oldActiveElement=null))}}),o.addEventOnElement(this,this.getContent(),"paste",function(e){if(t._shouldHandlePaste(e)){var i=null;if(e.clipboardData?i=e.clipboardData:(i=window.clipboardData)&&t._pasteFromPlainText(i.getData("Text")),i&&i.items)for(var n=0;n<i.items.length;n++){var o=i.items[n];if("text/plain"===o.type){o.getAsString(function(e){t._pasteFromPlainText(e)});break}}e.preventDefault(),t._hiddenInput&&(t._hiddenInput.destroy(),t._hiddenInput=null,t._oldActiveElement&&(t._oldActiveElement.focus({preventScroll:!0}),t._oldActiveElement=null))}})}},onCopyDefault:function(){if(!this._useClipboardFlag){var e=this.getTreeDocument?this.getTreeDocument():void 0;return e&&e.getXSO()&&this._modelEvents.publish({event:"copy",data:e.getXSO().get()}),{preventDefault:!0}}this._activateHiddenInput()},onCopy:function(){this.onCopyDefault()},onPasteDefault:function(){if(!this._useClipboardFlag){var e=this.getTreeDocument?this.getTreeDocument():void 0;return e&&e.getXSO()&&this._modelEvents.publish({event:"paste",data:e.getXSO().get()}),{preventDefault:!0}}this._activateHiddenInput()},onPaste:function(){this.onPasteDefault()},onCutDefault:function(){if(!this._useClipboardFlag){var e=this.getTreeDocument?this.getTreeDocument():void 0;return e&&e.getXSO()&&this._modelEvents.publish({event:"cut",data:e.getXSO().get()}),{preventDefault:!0}}},onCut:function(){this.onCutDefault()},_activateHiddenInput:function(){this._hiddenInput||(this._hiddenInput=new e.Element("input",{styles:{width:"1px",height:"1px",top:"0px",left:"0px",position:"absolute",opacity:0}}),this._hiddenInput.setAttribute("type","text"),this._hiddenInput.inject(this.elements.container)),this._oldActiveElement=document.activeElement,this._hiddenInput.value=" ",this._hiddenInput.focus({preventScroll:!0}),this._hiddenInput.select()},_copyToPlainText:function(){},_pasteFromPlainText:function(e){},_manageKeyboard:function(){if(this.supportsKeyboardNavigation()){this.keymaps={"ctrl+c":"copy","ctrl+v":"paste","ctrl+x":"cut",del:"deleteKeyPressed","ctrl+a":"selectAll",esc:{keydown:"escape"},"shift+return":"shiftEnter",return:"enter","ctrl+space":"ctrlSpaceKeyPressed",up:"upMove",right:"rightMove",down:"downMove",left:"leftMove","ctrl+up":"ctrlUp","ctrl+right":"ctrlRight","ctrl+down":"ctrlDown","ctrl+left":"ctrlLeft","shift+up":"shiftUp","shift+right":"shiftRight","shift+down":"shiftDown","shift+left":"shiftLeft","ctrl+shift+up":"shiftUp","ctrl+shift+right":"shiftRight","ctrl+shift+down":"shiftDown","ctrl+shift+left":"shiftLeft","shift+ctrl+up":"shiftUp","shift+ctrl+right":"shiftRight","shift+ctrl+down":"shiftDown","shift+ctrl+left":"shiftLeft",tab:"tab","shift+tab":"shiftTab",pageup:"pageup",pagedown:"pagedown","shift+pageup":"shiftPageup","shift+pagedown":"shiftPagedown",home:"home",end:"end","ctrl+home":"ctrlHome","ctrl+end":"ctrlEnd","shift+home":"shiftHome","shift+end":"shiftEnd",f2:"f2","+":"plus","-":"minus","*":"asterisk","/":"slash",defaultKey:"defaultKeyEventCallback"},this.commands=d}},_onPlusKeyPressed:function(e){var t=this.getActiveCellID();if(t){var i=this.getNodeModelAt(t);i&&i.canBeExpanded()&&(i.isExpanded()||i.expand(),e.actionPerformed=!0)}},_onMinusKeyPressed:function(e){var t=this.getActiveCellID();if(t){var i=this.getNodeModelAt(t);i&&i.canBeExpanded()&&(i.isExpanded()&&i.collapse(),e.actionPerformed=!0)}},_onAsteriskKeyPressed:function(e){var t=this.getActiveCellID();if(t){var i=this.getNodeModelAt(t);i&&i.canBeExpanded()&&(i.expandAll(),e.actionPerformed=!0)}},_onSlashKeyPressed:function(e){var t=this.getActiveCellID();if(t){var i=this.getNodeModelAt(t);i&&i.canBeExpanded()&&(i.collapseAll(),e.actionPerformed=!0)}},_registerPool:function(e,t,i){var n=this;this._cellPool.register({id:e,buildContent:function(){const o=new i({collectionView:n,cellType:e});return o.getContent().setAttribute("is-visible",!1),t&&o.getContent().inject(t),o},cleanContent:function(e){e.clean&&e.clean()}})},_registerPools:function(){var e=this.cellClass;this._registerPool("__item__",this.elements.poolContainer,e),this._registerPool("__sync_item__",this.elements.poolContainerSyncRel,e),this._registerPool("__top_item__",this.elements.headerPoolContainer,e)},initialize:function(){this.paginationManager&&this.paginationManager.updatePagination()},_postBuildView:function(){var e=this;this._registerPools(),this.layout.collectionView=this,this.layout.preferencesToApply&&this.layout.importJsonPreferences(this.layout.preferencesToApply,{importCurrentCustomViewId:!0}),this._lastModelViewport={minCellID:0,maxCellID:0},this._renderViewportOptions={},this._isReady=!1,o.onNodeRendered(this._getScroller().getContent(),function(){if(e._isReady)e._updateDimensions(),e.getAllScrollers().forEach(function(t){t&&(t._updatePosition(),e._onScrollBegin(t),e._onScroll(t),e._onScrollEnd(t))}),e.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1});else{e._isReady=!0,e._updateDimensions(),e.initialize(),e._initialize();var t=l.debounce(function(t){e.requestDelayedModelData(t)},1);o.addEndResizeListener(e.elements.container,function(){e._onEndResizeListener()},200),o.addResizeListener(e._getScroller().elements.container,function(){e.getAllScrollers().forEach(function(e){e&&e._updatePosition()}),e._updateDimensions(),e.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1}),e._onEndResizeOrOnReadyModelCompletionRequest("OnEndResize"),t("OnResize"),e._modelEvents.publish({event:"ENDRESIZE",context:e})},100),e._applyVirtualViewportSize(),e._updateDimensions(),e.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!0}),e._onEndResizeOrOnReadyModelCompletionRequest("OnReady"),e.requestDelayedModelData("OnReady"),e._isInitialized=!0,e._onPrivateReady(),e._modelEvents.publish({event:"READY",context:e})}})},getAllScrollers:function(){var e=[];return this.hasLeftContainer()&&e.push(this.elements.leftScroller),e.push(this.elements.scroller),this.hasRightContainer()&&e.push(this.elements.rightScroller),e},onReady:function(e){if(!this._isReady)return this._modelEvents.subscribe({event:"READY"},e);e()},_onEndResizeListener:function(){this._updateDimensions(),this.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1})},getCellInfosFromHtmlElement:function(e){var t=o.firstParentWithClass(e,"wux-layouts-collectionview-cell");if(t){var i=parseInt(t.getAttribute("cell-id"),10),n=this.getCellInfosAt(i);return n.cellView=this._getViewAt(i),n.manager=this,n}},addEventListener:function(e,t,i){var n=this,l=function(e){if(!n._isRequestingCell){e.dsModel=n;var i=o.firstParentWithClass(e.target,"wux-layouts-collectionview-cell");if(i){var l=parseInt(i.getAttribute("cell-id"),10);if(!isNaN(l)){var s=n.getCellInfosAt(l);s.cellView=n._getViewAt(l),t(e,s)}}else t(e)}};return n.getContent().addEventListener(e,l,i),l},_onEndResizeOrOnReadyModelCompletionRequest:function(e){var t=this;t._onEndResizeOrOnReadyModelRequestCB&&(t._isRequestingEndResizeOrOnReadyModelUpdate||(t._isRequestingEndResizeOrOnReadyModelUpdate=!0,setTimeout(function(){t._modelEvents.subscribeOnce({event:"endResizeOrOnReadyModelRequestDone"},function(){t.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),t._isRequestingEndResizeOrOnReadyModelUpdate=!1});var i=t.getViewportDimensions(),n=Math.floor((i.width-t.layout.gutter)/(t.layout._getColumnWidth()+t.layout.gutter)),o=Math.ceil((i.height-t.layout.gutter)/(t.layout.getRowHeight()+t.layout.gutter));t._onEndResizeOrOnReadyModelRequestCB.call(t,{model:t.model,RowMaxNumber:o,ColumnsMaxNumber:n,viewportDimensions:i,event:e})},1)))},_onEndResize:function(e){return this._modelEvents.subscribe({event:"ENDRESIZE"},e)},getCellIDAsString:function(e){return String(e)},getStatusBarContainerHeight:function(){return this.elements.statusBar?0===this.elements.statusBar.items.getRoots().length?0:this._getCurrentTouchMode()?39:23:0},buildStatusBar:function(e){var t=this.elements.statusBar;if(!t&&e.length>0&&((t=new g({collectionView:this})).inject(this.getContent()),this.elements.statusBar=t),t){var i=t.items.getRoots().length;t.setModel(e),(0===i&&e.length>0||i>0&&0===e.length)&&this.invalidateLayout({updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!1})}},_applyHeight:function(){this.elements.container.style.height="inherit"===this.height?"":this.height+"px","inherit"===this.height?this.elements.container.setStyles({position:"absolute",top:0,left:0,bottom:0,width:"100%"}):this.elements.container.setStyles({position:"",top:"",left:"",bottom:"",width:""})},_buildLayout:function(){this.elements.container.addClassName("wux-layouts-collectionview"),o.setStyles(this.elements.container,{overflow:"hidden",width:"100%",position:"relative",height:"inherit"===this.height?"":this.height}),this.elements.container.setAttribute("platform-name",s.Platform.name),"inherit"===this.height&&o.setStyles(this.elements.container,{position:"absolute",top:0,left:0,bottom:0,width:"100%"}),this.elements.header=new e.Element("div",{class:"wux-layouts-header"}).inject(this.elements.container),this.elements.headerScrollContainer=new e.Element("div",{class:"wux-layouts-header-scroller-container"}).inject(this.elements.header),this.elements.headerPoolContainer=new e.Element("div",{class:"wux-layouts-header-poolcontainer"}).inject(this.elements.headerScrollContainer),this.elements.body=new e.Element("div",{class:"wux-layouts-body"}).inject(this.elements.container),this.elements.centerSpacerContainer=new e.Element("div",{class:"wux-layouts-center-spacer-container"}).inject(this.elements.body,"before"),this.elements.scrollContainerRel=new e.Element("div",{class:"wux-layouts-gridengine-scroller-container","show-at-hover":this.showScrollbarsOnHover}).inject(this.elements.body),this.elements.poolContainer=new e.Element("div",{class:"wux-layouts-gridengine-poolcontainer-rel"});var t={scrollEndTimeout:200,scrollDebounceTimeout:0,useRequestAnimationFrame:!0};this.elements.scroller=new n(this.elements.poolContainer,t).inject(this.elements.scrollContainerRel),this.elements.scroller._id="center",this.elements.poolContainerSync=new e.Element("div",{class:"wux-layouts-gridengine-poolcontainer-sync"}),this.elements.poolContainerSyncRel=new e.Element("div",{class:"wux-layouts-gridengine-poolcontainer-sync-rel"}),this.elements.poolContainerSyncRel.inject(this.elements.poolContainerSync),this.elements.poolContainerSync.inject(this.elements.scrollContainerRel)},_createLeftFixedContainer:function(){this.elements.leftHeaderScrollContainer=new e.Element("div",{class:"wux-layouts-left-header-scroller-container"}).inject(this.elements.headerScrollContainer,"before"),this.elements.leftHeaderPoolContainer=new e.Element("div",{class:"wux-layouts-left-header-poolcontainer"}).inject(this.elements.leftHeaderScrollContainer),this.elements.leftScrollContainer=new e.Element("div",{class:"wux-layouts-left-scroller-container"}).inject(this.elements.body,"before"),this.elements.leftSpacerContainer=new e.Element("div",{class:"wux-layouts-left-spacer-container"}).inject(this.elements.body,"before"),this.elements.leftPoolContainer=new e.Element("div",{class:"wux-layouts-left-poolcontainer"}).inject(this.elements.leftScrollContainer);var t={scrollEndTimeout:200,scrollDebounceTimeout:0,useRequestAnimationFrame:!0};this.elements.leftScroller=new n(this.elements.leftPoolContainer,t).inject(this.elements.leftScrollContainer),this.elements.leftScroller._id="left",this._initializeScroller(this.elements.leftScroller),this._registerPool("__topleft_item__",this.elements.leftHeaderPoolContainer,this.cellClass),this._registerPool("__left_item__",this.elements.leftPoolContainer,this.cellClass)},hasLeftContainer:function(){return!!this.elements.leftScroller},_createRightFixedContainer:function(){this.elements.rightHeaderScrollContainer=new e.Element("div",{class:"wux-layouts-right-header-scroller-container"}).inject(this.elements.header),this.elements.rightHeaderPoolContainer=new e.Element("div",{class:"wux-layouts-right-header-poolcontainer"}).inject(this.elements.rightHeaderScrollContainer),this.elements.rightScrollContainer=new e.Element("div",{class:"wux-layouts-right-scroller-container"}).inject(this.elements.container),this.elements.rightSpacerContainer=new e.Element("div",{class:"wux-layouts-right-spacer-container"}).inject(this.elements.container),this.elements.rightPoolContainer=new e.Element("div",{class:"wux-layouts-right-poolcontainer"});var t={scrollEndTimeout:200,scrollDebounceTimeout:0,useRequestAnimationFrame:!0};this.elements.rightScroller=new n(this.elements.rightPoolContainer,t).inject(this.elements.rightScrollContainer),this.elements.rightScroller._id="right",this._initializeScroller(this.elements.rightScroller),this._registerPool("__topright_item__",this.elements.rightHeaderPoolContainer,this.cellClass),this._registerPool("__right_item__",this.elements.rightPoolContainer,this.cellClass)},hasRightContainer:function(){return!!this.elements.rightScroller},_updateDimensions:function(){this.elements.container&&this._updateViewportDimensions()},getDimensions:function(){return this._dimensions||this._updateDimensions(),this._dimensions},_updateViewportDimensions:function(){var t=this.elements.scrollContainerRel.getDimensions();if(this._dimensions=this.getContent().getDimensions(),t.height>0)this._viewportDimensions=t;else{var i=this.layout;this._viewportDimensions=e.clone(this._dimensions),this._viewportDimensions.height-=this.layout.getHeaderContainerHeight();const t=Math.floor(i.getLeftContainerWidth()),n=Math.ceil(i.computeSideContainerWidth("left",t,this._leftScrollContainerBorderSize?this._leftScrollContainerBorderSize:0)),o=Math.floor(i.getRightContainerWidth());let l=i.computeSideContainerWidth("right",o,this._rightScrollContainerBorderSize?this._rightScrollContainerBorderSize:0);const s=i.getContentDimensions();this._viewportDimensions.height<s.height&&l>0&&(this._scrollbarWidth||(this._scrollbarWidth=this.getScrollbarWidth()),l+=this._scrollbarWidth);const r=i.computeSideContainerMaxWidth("left",this._dimensions.width,n,l),a=i.computeSideContainerMaxWidth("right",this._dimensions.width,n,l),c=Math.min(n,r),h=Math.min(l,a),u=i.computeCenterContainerSideMargin("left",c,r),d=i.computeCenterContainerMinWidth(r,a,this._dimensions.width);this._viewportDimensions.width=Math.max(this._dimensions.width-u-h,d)}},getViewportDimensions:function(e){if(e){var t=this.layout.getContentDimensions();this._scrollbarWidth||(this._scrollbarWidth=this.getScrollbarWidth());var i=t.width>this._viewportDimensions.width?this._scrollbarWidth:0,n=t.height>this._viewportDimensions.height?this._scrollbarWidth:0;return{width:this._viewportDimensions.width-n,height:this._viewportDimensions.height-i}}return this._viewportDimensions||(this._viewportDimensions=this._getScroller().getContent().getDimensions()),this._viewportDimensions},_getScroller:function(){return this.elements.scroller},getScrollerDeltaPosition:function(){return this.__cachedDeltaScrollPos},getScrollerPosition:function(e){var t=this._getScroller();if(t){var i=t.getPosition(e);return{x:i.x,y:i.y}}return{x:0,y:0}},setScrollerPosition:function(t,i){var n=this,o=this._getScroller(),l=o.elements.container,s=n.getScrollerPosition();if((t=e.extend({x:s.x,y:s.y,animate:!1},t)).animate){var a=function(e,t,i,n){return(e/=n/2)<1?i/2*e*e+t:-i/2*(--e*(e-2)-1)+t},c=l.scrollLeft,h=t.x-c,u=l.scrollTop,d=t.y-u,g=Date.now(),p=function(){r.addTask({callback:function(){var e=Date.now()-g;l.scrollLeft=a(e,c,h,500),l.scrollTop=a(e,u,d,500),e<500?p():o.setPosition(t,void 0===i||i)},taskArgs:[]})};p()}else o.setPosition(t,void 0===i||i),w.firefox&&(n._scrollTimeout&&clearTimeout(n._scrollTimeout),n._scrollTimeout=setTimeout(function(){o._updatePosition();var e=n._activeScroller;e||n._onScrollBegin(o),n._onScroll(o),e||n._onScrollEnd(o),n._scrollTimeout=null},100))},_onScrollBegin:function(e){this._activeScroller||!this._synchronizedScrollers||this._synchronizedScrollers.includes(e)||(this._activeScroller=e,this._scrollDistanceFromBeginning=0),this._preventSelectionForTouchScroll=!0},_onScroll:function(t){var i=this;if(this.isInitialized())if(i.elements.scroller&&i._activeScroller&&i._activeScroller===t){if(i.hasLeftContainer()&&t===i.elements.leftScroller){var n=i.elements.leftScroller.getPosition();i.elements.leftHeaderPoolContainer.setStyle("left",-n.x+"px")}if(i.hasRightContainer()&&t===i.elements.rightScroller){var o=i.elements.rightScroller.getPosition();i.elements.rightHeaderPoolContainer.setStyle("left",-o.x+"px")}var l=i._activeScroller.getPosition(),s={x:i.elements.scroller.getPosition().x,y:l.y};if(i.__cachedScrollDistance=Math.sqrt((s.x-i.__previousScrollPos.x)*(s.x-i.__previousScrollPos.x)+(s.y-i.__previousScrollPos.y)*(s.y-i.__previousScrollPos.y)),i._scrollDistanceFromBeginning+=i.__cachedScrollDistance,i.__cachedDeltaScrollPos={x:s.x-i.__previousScrollPos.x,y:s.y-i.__previousScrollPos.y},i.__previousScrollPos=s,0!==i.__cachedDeltaScrollPos.x||0!==i.__cachedDeltaScrollPos.y){if(i.getAllScrollers().forEach(function(e){t!=e&&e&&e.elements.container.scrollTop!==s.y&&(i._synchronizedScrollers&&!i._synchronizedScrollers.includes(e)&&i._synchronizedScrollers.push(e),e.setPosition({y:s.y},"immediate"))}),i.elements.headerPoolContainer.setStyle("left",-s.x+"px"),i._onInfiniteScrollCB&&(i.__cachedDeltaScrollPos.x>0||i.__cachedDeltaScrollPos.y>0)){var r=i.getViewportDimensions(),a=i.__cachedContentDimensions,c=a.height-r.height-2;c-i._infiniteScrollingVerticalDistance>0&&(c-=i._infiniteScrollingVerticalDistance);var h=a.width-r.width-2;h-i._infiniteScrollingHorizontalDistance>0&&(h-=i._infiniteScrollingHorizontalDistance);var u=!1,d=!1,g=!1,p=!1,f=i.pageScrollValueTriggeringInfiniteScroll;if(null!=f){if(e.is(f,"number")){if(f<=0||f>=1)throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll option. Please provide a value strictly between 0 and 1.";d=Math.abs(s.y)+f*r.height>=f*a.height,p=Math.abs(s.y)>=c&&c>0,u=Math.abs(s.x)>=h&&h>0}else if(e.is(f,"object")){if(null!=f.x){if(f.x<=0||f.x>=1)throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll.x publish property. Please provide a value strictly between 0 and 1.";u=Math.abs(s.x)+f.x*r.width>=f.x*a.width,g=Math.abs(s.x)>=h&&h>0}else u=Math.abs(s.x)>=h&&h>0;if(null!=f.y){if(f.y<=0||f.y>=1)throw"You gave a wrong value for pageScrollValueTriggeringInfiniteScroll.y publish property. Please provide a value strictly between 0 and 1.";d=Math.abs(s.y)+f.y*r.height>=f.y*a.height,p=Math.abs(s.y)>=c&&c>0}else d=Math.abs(s.y)>=c&&c>0}}else u=Math.abs(s.x)>=h&&h>0,d=Math.abs(s.y)>=c&&c>0;(d||u)&&(i._isRequestingModelUpdate||(i._isRequestingModelUpdate=!0,setTimeout(function(){i._modelEvents.subscribeOnce({event:"infiniteScrollDone"},function(){i.invalidateLayout({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!1}),i._isRequestingModelUpdate=!1}),i._onInfiniteScrollCB.call(i,{reachBottom:d,reachRight:u,isVeryCloseFromRight:g,isVeryCloseFromBottom:p})},1)))}var m=!i.layout.isCellLayoutValidAt(0),C=i._renderViewport({updateCellContent:!1,updateCellLayout:m,updateCellAttributes:!1,allottedTime:80});C&&void 0!==C.taskInterrupted&&(i._renderingTaskInterrupted=C.taskInterrupted)}}else if(i._synchronizedScrollers){var v=i._synchronizedScrollers.indexOf(t);v>-1&&i._synchronizedScrollers.splice(v,1)}},_onPrivateScrollEnd:function(){},_onScrollEnd:function(e){if(this._activeScroller===e&&(this._activeScroller=null,!0===this._waitForScrollEndAfterLimitReached&&(this._waitForScrollEndAfterLimitReached=!1,this._scrollEndAfterLimitReachedOccured=!0),this.requestDelayedModelData("OnScrollEnd"),this._onPrivateScrollEnd(),this._renderingTaskInterrupted&&!this._infoOnTouchDown)){var t=!this.layout.isCellLayoutValidAt(0);this._renderViewport({updateCellContent:!1,updateCellLayout:t,updateCellAttributes:!1}),this._renderingTaskInterrupted=!1}this._preventSelectionForTouchScroll=!1},_hasUniformRowHeight:function(){return!1},isInitialized:function(){return this._isInitialized},_initialize:function(){this._isRendering(!1),this.__previousScrollPos={x:0,y:0},this.__cachedDeltaScrollPos={x:0,y:0},this.__cachedScrollDistance=0,this._renderingTaskInterrupted=!1;this.elements.scroller;this._scrollDistanceFromBeginning=0,this._activeScroller=null,this._synchronizedScrollers=[],this._initializeScroller(this.elements.scroller)},_initializeScroller:function(e){var t=this;if(t._initializedScrollers||(t._initializedScrollers=[]),!t._initializedScrollers.includes(e)){t._initializedScrollers.push(e),e.onScrollBegin(function(i){t._onScrollBegin(e)}),e.onScroll(function(i){t._onScroll(e)}),e.onScrollEnd(function(i){t._onScrollEnd(e)});var i,n=function(i){t._activeScroller=e,t._synchronizedScrollers=[];let n=!1,o=function(i){let o;const l=-1*Math.max(-1,Math.min(1,i.wheelDelta||-i.detail));let s=0;if(t._hasUniformRowHeight()){let i=e.elements.container.scrollTop%t.layout.cellHeight;0===i||(s=t.layout.cellHeight-i)}let r=void 0;if(i.deltaMode&&1===i.deltaMode)r=Math.abs(i.deltaY);else{const e=33.33;r=Math.round(Math.abs(i.deltaY)/e)}let a=Math.floor(t.getViewportDimensions().height/t.layout.cellHeight);return o=l*(Math.min(r,a)*t.layout.cellHeight)+s,(n=o<0&&0===e.elements.container.scrollTop||o>0&&e.elements.container.scrollTop+o+t.getViewportDimensions().height>=e.getContent().getChildren()[0].offsetHeight)&&(o=0),o}(i);n?!0===t._scrollEndAfterLimitReachedOccured?t._activeScroller=null:t._waitForScrollEndAfterLimitReached=!0:(i.preventDefault(),i.stopPropagation(),t._scrollEndAfterLimitReachedOccured=!1),e.setPosition({y:e.elements.container.scrollTop+o},!0)};switch(e._id){case"left":i=t.elements.leftPoolContainer;break;case"center":i=t.elements.poolContainer;break;case"right":i=t.elements.rightPoolContainer}if(o.addEventOnElement(t,i,"wheel",n),this.supportsCustomScrolling()){t.getContent().addClassName("supportsCustomScrolling");var l,s=function(i){var l;(t._scrollDirection=null,t._infoOnTouchDown=null,t._previousTouch=null,clearInterval(t._inertiaInterval),t._inertiaInterval=null,t._previousTouch||(t._previousTouch={}),i.touches.length<=1)&&(l=t.hasLeftContainer()&&i.currentTarget===t.elements.leftScrollContainer?t.elements.leftScroller.elements.container.scrollLeft:t.hasRightContainer()&&i.currentTarget===t.elements.rightScrollContainer?t.elements.rightScroller.elements.container.scrollLeft:t.elements.scroller.elements.container.scrollLeft,t._infoOnTouchDown={clientX:i.touches[0].clientX,clientY:i.touches[0].clientY,scrollLeft:l,scrollTop:e.elements.container.scrollTop,firstTarget:i.currentTarget},o.addEventOnElement(t,document,"touchmove",r,{passive:!1}),o.addEventOnElement(t,document,"touchend",c),o.addEventOnElement(t,document,"touchcancel",c),i.currentTarget!==t.elements.leftPoolContainer&&i.currentTarget!==t.elements.poolContainer&&i.currentTarget!==t.elements.rightPoolContainer||(t.hasLeftContainer()&&o.removeEventOnElement(t,t.elements.leftPoolContainer,"wheel",n),o.removeEventOnElement(t,t.elements.poolContainer,"wheel",n),t.hasRightContainer()&&o.removeEventOnElement(t,t.elements.rightPoolContainer,"wheel",n),t._touchStartELRemoved=!0),f.isMobileiOS()&&e.showScrollingFeedbacks())},r=function(e){if(!t._preventScroll&&e.touches.length<=1&&!e.defaultPrevented&&(t._previousTouch||(t._previousTouch={}),t._infoOnTouchDown)){if(!t._scrollDirection)if(Math.abs(e.touches[0].clientY-t._infoOnTouchDown.clientY)>5)t._scrollDirection="y";else{if(!(Math.abs(e.touches[0].clientX-t._infoOnTouchDown.clientX)>5||e.firstTarget===t.elements.headerPoolContainer))return;t._scrollDirection="x"}e.preventDefault(),a("y"===t._scrollDirection?e.touches[0].clientY:e.touches[0].clientX)}},a=function(i){var n=(new Date).getTime();if(t._infoOnTouchDown){if("y"===t._scrollDirection&&t._infoOnTouchDown.firstTarget!==t.elements.headerPoolContainer){var o=t._infoOnTouchDown.scrollTop-(i-t._infoOnTouchDown.clientY);e.elements.container.scrollTop!==o&&(t._previousTouch.direction=e.elements.container.scrollTop<o,e.setPosition({y:o},!0)),t._previousTouch.timeStamp&&t._previousTouch.timeStamp!==n&&e.elements.container.scrollTop!==t._previousTouch.scroll&&(t._speed=(e.elements.container.scrollTop-t._previousTouch.scroll)/(n-t._previousTouch.timeStamp)),t._previousTouch.scroll=e.elements.container.scrollTop}else if("x"===t._scrollDirection){o=t._infoOnTouchDown.scrollLeft-(i-t._infoOnTouchDown.clientX);var l=null;t._infoOnTouchDown.firstTarget===e.getContent()||t._infoOnTouchDown.firstTarget===t.elements.headerPoolContainer?l=t.elements.scroller:t.hasLeftContainer()&&t._infoOnTouchDown.firstTarget===t.elements.leftScrollContainer?l=t.elements.leftScroller:t.hasRightContainer()&&t._infoOnTouchDown.firstTarget===t.elements.rightScrollContainer&&(l=t.elements.rightScroller),l&&(l.elements.container.scrollLeft!==o&&(t._previousTouch.direction=l.elements.container.scrollLeft<o,l.setPosition({x:o},!0)),t._previousTouch.timeStamp&&t._previousTouch.timeStamp!==n&&l.elements.container.scrollLeft!==t._previousTouch.scroll&&(t._speed=(l.elements.container.scrollLeft-t._previousTouch.scroll)/(n-t._previousTouch.timeStamp)),t._previousTouch.scroll=l.elements.container.scrollLeft)}t._previousTouch.client=i,t._previousTouch.timeStamp=n}},c=function(i){if(o.removeEventOnElement(t,document,"touchmove",r,{passive:!1}),o.removeEventOnElement(t,document,"touchend",c),o.removeEventOnElement(t,document,"touchcancel",c),t._touchStartELRemoved&&(t._touchStartELRemoved=void 0,t.hasLeftContainer()&&o.addEventOnElement(t,t.elements.leftPoolContainer,"wheel",n),o.addEventOnElement(t,t.elements.poolContainer,"wheel",n),t.hasRightContainer()&&o.addEventOnElement(t,t.elements.rightPoolContainer,"wheel",n)),Math.abs(t._speed)>=.5){var l=t._speed,s=t._previousTouch.client,h=(t._previousTouch.direction,(new Date).getTime()),u=t._previousTouch.timeStamp,d=Math.min(1e3*Math.abs(l)/2,1500),g=function(){0;var i=(new Date).getTime();if(i-h>=d){if(t._scrollDirection=null,t._infoOnTouchDown=null,t._previousTouch=null,clearInterval(t._inertiaInterval),t._inertiaInterval=null,t._speed=0,f.isMobileiOS()&&e.hideScrollingFeedbacks(),t._renderingTaskInterrupted){var n=!t.layout.isCellLayoutValidAt(0);t._renderViewport({updateCellContent:!1,updateCellLayout:n,updateCellAttributes:!1}),t._renderingTaskInterrupted=!1}}else{var o=s-(i-u)*l*(1-(i-h)/d);a(o),s=o,u=i}};t._inertiaInterval&&clearInterval(t._inertiaInterval),t._inertiaInterval=setInterval(g,5),g()}else if(t._scrollDirection=null,t._infoOnTouchDown=null,t._previousTouch=null,t._speed=0,f.isMobileiOS()&&e.hideScrollingFeedbacks(),t._renderingTaskInterrupted){var p=!t.layout.isCellLayoutValidAt(0);t._renderViewport({updateCellContent:!1,updateCellLayout:p,updateCellAttributes:!1}),t._renderingTaskInterrupted=!1}};switch(e._id){case"left":l=t.elements.leftScrollContainer;break;case"center":l=e.getContent();break;case"right":l=t.elements.rightScrollContainer}o.addEventOnElement(t,l,"touchstart",s),"center"===e._id&&o.addEventOnElement(t,t.elements.headerPoolContainer,"touchstart",s)}var h=this.layout;h&&h.scrollPaddingBottom>0&&(e.elements.container.style.paddingBottom=h.scrollPaddingBottom+"px")}},_onPrivateReady:function(){},lockUI:function(){this._getScroller()&&this._getScroller().getContent().classList.add("wux-ui-locked")},unlockUI:function(){this._getScroller()&&this._getScroller().getContent().classList.remove("wux-ui-locked")},onPostUpdateView:function(e){return this._modelEvents.subscribe({event:"UPDATE_VIEW_COMPLETED"},e)},onPostUpdateViewOnce:function(e){return this._modelEvents.subscribeOnce({event:"UPDATE_VIEW_COMPLETED"},e)},_freeUpCell:function(e,t){var i=this._getRenderedCellAt(e);if(i){switch(t){default:case 0:break;case 1:i.component.getContent().setAttribute("is-visible",!1);break;case 2:i.component.getContent().remove()}i.component.__disposable__.dispose(),this._listOfRenderedCells.delete(e)}},_freeUpPool:function(e){var t=this;void 0===e&&(e=1),t._listOfRenderedCells.forEach(function(i,n){t._freeUpCell(n,e)}),t._listOfRenderedCells.clear()},_applyVirtualViewportSize:function(){const e=this.layout;if(e.isValid()||e.prepareLayout(),!this._dimensions)return;let t=l.getGlobalWindow(window);const i=this._zoomRefValue!==t.innerWidth;if(i||this.hasLeftContainer()&&!this._leftScrollContainerBorderSize||this.hasRightContainer()&&!this._rightScrollContainerBorderSize||!this._scrollbarWidth){if(this._leftScrollContainerBorderSize=0,this.hasLeftContainer()){const e=window.getComputedStyle(this.elements.leftScrollContainer);e&&(this._leftScrollContainerBorderSize+=parseFloat(e.getPropertyValue("border-left-width").replace("px","")),this._leftScrollContainerBorderSize+=parseFloat(e.getPropertyValue("border-right-width").replace("px","")))}if(this._rightScrollContainerBorderSize=0,this.hasRightContainer()){const e=window.getComputedStyle(this.elements.rightScrollContainer);e&&(this._rightScrollContainerBorderSize+=parseFloat(e.getPropertyValue("border-left-width").replace("px","")),this._rightScrollContainerBorderSize+=parseFloat(e.getPropertyValue("border-right-width").replace("px","")))}this._scrollbarWidth&&!i||(this._scrollbarWidth=this.getScrollbarWidth(i))}let n=0;const o=Math.floor(e.getLeftContainerWidth()),s=Math.ceil(e.computeSideContainerWidth("left",o,this._leftScrollContainerBorderSize)),r=Math.floor(e.getRightContainerWidth()),a=e.computeSideContainerWidth("right",r,this._rightScrollContainerBorderSize);this.hasLeftContainer()&&(0===o?(this.elements.leftScrollContainer.setAttribute("empty",""),this.elements.leftHeaderScrollContainer.setAttribute("empty",""),this.elements.leftSpacerContainer.setAttribute("empty","")):(this.elements.leftScrollContainer.removeAttribute("empty"),this.elements.leftHeaderScrollContainer.removeAttribute("empty",""),this.elements.leftSpacerContainer.removeAttribute("empty","")),n=e.computeSideContainerMaxWidth("left",this._dimensions.width,s,a));let c=0;if(this.hasRightContainer()&&(0===r?(this.elements.rightScrollContainer.setAttribute("empty",""),this.elements.rightHeaderScrollContainer.setAttribute("empty",""),this.elements.rightSpacerContainer.setAttribute("empty","")):(this.elements.rightScrollContainer.removeAttribute("empty"),this.elements.rightHeaderScrollContainer.removeAttribute("empty",""),this.elements.rightSpacerContainer.removeAttribute("empty","")),c=e.computeSideContainerMaxWidth("right",this._dimensions.width,s,a)),(n>0||c>0)&&(this._leftMaxWidth!==n||this._rightMaxWidth!==c)){var h=e.computeCenterContainerMinWidth(n,c,this._dimensions.width);this.elements.centerSpacerContainer.setStyle("min-width",h)}this.hasLeftContainer()&&n>=0&&this._leftMaxWidth!==n&&(this._leftMaxWidth=n,this.elements.leftHeaderScrollContainer.setStyle("max-width",n),this.elements.leftScrollContainer.setStyle("max-width",n),this.elements.leftSpacerContainer.setStyle("max-width",n)),this.hasRightContainer()&&c>=0&&this._rightMaxWidth!==c&&(this._rightMaxWidth=c,this.elements.rightHeaderScrollContainer.setStyle("max-width",c),this.elements.rightScrollContainer.setStyle("max-width",c),this.elements.rightSpacerContainer.setStyle("max-width",c));const u=this.getViewportDimensions(),d=e.getContentDimensions(),g=u.width<d.width,p=u.height<d.height;p?this.getContent().setAttribute("has-vertical-overflow",""):this.getContent().removeAttribute("has-vertical-overflow");let f=r,m=a;p&&m>0&&(f+=this._scrollbarWidth,m+=this._scrollbarWidth),m=Math.ceil(m);const C=p&&0===a;if(this._zoomRefValue!==t.innerWidth||!this.__cachedContentDimensions||this.__cachedContentDimensions.width!==d.width||this.__cachedContentDimensions.height!==d.height||this._leftContainerWidth!==s||this._rightContainerWidth!==m||this._hasCenterContainerHorizontalOverflow!==g){this.__cachedContentDimensions=d,this.elements.poolContainerSync.setStyle("bottom",g?this._scrollbarWidth+"px":"0px"),this.elements.poolContainerSync.setStyle("right",C?this._scrollbarWidth+"px":"0px");const e=d.width+"px";g?this.elements.poolContainer.setStyle("width",e):this.elements.poolContainer.setStyle("width","100%"),this.elements.poolContainerSyncRel.setStyle("width",e),this.elements.headerPoolContainer.setStyle("width",e);const t=d.height+"px";this.elements.poolContainer.setStyle("height",t),this.elements.poolContainerSyncRel.setStyle("height",t),this.hasLeftContainer()&&this.elements.leftPoolContainer.setStyle("height",t),this.hasRightContainer()&&this.elements.rightPoolContainer.setStyle("height",t);const i=!!this.elements.scrollContainerRel.getAttribute("has-overflow-x");this.elements.scrollContainerRel.setAttribute("has-overflow-x",!!g),g&&this.showScrollbarsOnHover?(this.elements.scrollContainerRel.setStyle("height","calc(100% + "+this._scrollbarWidth+"px)"),this.elements.scrollContainerRel.setStyle("margin-bottom","-"+this._scrollbarWidth+"px")):this.showScrollbarsOnHover&&!g&&i&&(this.elements.scrollContainerRel.setStyle("height","100%"),this.elements.scrollContainerRel.setStyle("margin-bottom","0px"));const n=!!this.elements.scrollContainerRel.getAttribute("has-overflow-y");this.elements.scrollContainerRel.setAttribute("has-overflow-y",!!C),C&&this.showScrollbarsOnHover?this.elements.scrollContainerRel.setStyle("margin-right","-"+this._scrollbarWidth+"px"):this.showScrollbarsOnHover&&!C&&n&&this.elements.scrollContainerRel.setStyle("margin-right","0px")}if(n>=0){const t=e.computeCenterContainerSideMargin("left",s,n);this._marginLeft!==t&&(this._marginLeft=t,this.elements.headerScrollContainer.setStyle("margin-left",t),this.elements.body.setStyle("margin-left",t),this.elements.centerSpacerContainer.setStyle("margin-left",t))}if(this.hasLeftContainer()&&this._leftContainerWidth!==s&&(this._leftContainerWidth=s,this.elements.leftHeaderScrollContainer.setStyle("width",s),this.elements.leftScrollContainer.setStyle("width",s),this.elements.leftSpacerContainer.setStyle("width",s),this.elements.leftHeaderPoolContainer.setStyle("width",o),this.elements.leftPoolContainer.setStyle("width",o)),c>=0){const t=e.computeCenterContainerSideMargin("right",m,c);this._marginRight!==t&&(this._marginRight=t,this.elements.headerScrollContainer.setStyle("margin-right",t),this.elements.body.setStyle("margin-right",t),this.elements.centerSpacerContainer.setStyle("margin-right",t))}if(this.hasRightContainer()&&this._rightContainerWidth!==m){const e=this._rightContainerWidth;this._rightContainerWidth=m,this.elements.rightHeaderScrollContainer.setStyle("width",m),this.elements.rightScrollContainer.setStyle("width",m),this.elements.rightSpacerContainer.setStyle("width",m),this.elements.rightHeaderPoolContainer.setStyle("width",f),this.elements.rightPoolContainer.setStyle("width",r);const t=r>0?"hidden":"auto";if(this.elements.scroller.getContent().setStyle("overflow-y",t),e<=0&&this._rightContainerWidth>0){const e=this.getScrollerPosition();this.elements.rightScroller.setPosition({y:e.y},!0)}}var v,_;this.hasLeftContainer()&&((v=n>=0&&n<s)?this.elements.leftScroller.getContent().setStyle("overflow-x","scroll"):this.elements.leftScroller.getContent().setStyle("overflow-x","hidden")),this.hasRightContainer()&&((_=c>=0&&c<m)?this.elements.rightScroller.getContent().setStyle("overflow-x","scroll"):this.elements.rightScroller.getContent().setStyle("overflow-x","hidden"));const w=e.getHeaderContainerHeight(),y=this.getStatusBarContainerHeight();if(this._zoomRefValue!==t.innerWidth||this._headerContainerHeight!==w||this._statusBarContainerHeight!==y||this.hasLeftContainer()&&this._hasLeftContainerHorizontalOverflow!==v||this._hasCenterContainerHorizontalOverflow!==g||this.hasRightContainer()&&this._hasRightContainerHorizontalOverflow!==_){this._headerContainerHeight=w,this._statusBarContainerHeight=y;const e=w+"px";if(this.elements.header.setStyle("height",e),0===w?this.elements.header.setAttribute("empty",""):this.elements.header.removeAttribute("empty"),this.elements.statusBar){const e=y+"px";this.elements.statusBar.height=e}let t=0;if(this.hasLeftContainer()){v||!g&&!_||(t=this._scrollbarWidth);const e="calc(100% - "+(w+y+t)+"px)";this.elements.leftScrollContainer.setStyle("height",e),this.elements.leftSpacerContainer.setStyle("height",t+"px"),this.elements.leftSpacerContainer.setStyle("bottom",y+"px")}let i=0;if(this.hasRightContainer()){_||!v&&!g||(i=this._scrollbarWidth);const e="calc(100% - "+(w+y+i)+"px)";this.elements.rightScrollContainer.setStyle("height",e),this.elements.rightScrollContainer.setStyle("top",w),this.elements.rightSpacerContainer.setStyle("height",i+"px"),this.elements.rightSpacerContainer.setStyle("bottom",y+"px")}let n=0;g||!v&&!_||(n=this._scrollbarWidth);const o="calc(100% - "+(w+y+n)+"px)";this.elements.body.setStyle("height",o),this.elements.centerSpacerContainer.setStyle("height",n+"px"),this.elements.centerSpacerContainer.setStyle("bottom",y+"px")}this._hasLeftContainerHorizontalOverflow=v,this._hasCenterContainerHorizontalOverflow=g,this._hasRightContainerHorizontalOverflow=_,this._zoomRefValue=t.innerWidth},getCellInfosAt:function(e){var t=this.getModelAt(e);return{cellID:e,cellModel:t,nodeModel:t}},getLightCellInfosAt:function(e){return{cellID:e}},getVisibleCellsInViewport:function(){return this._visibleCellsInViewport},_getViewAt:function(e){var t=this._getRenderedCellAt(e);return t?t.component:null},getTreeDocument:function(){return null},getNodeModelAt:function(e){if(e>=0&&e<this.getModelLength())return this.getNodeModelAtRowID(e)},getModelAt:function(e){return this.getNodeModelAt(e)},_getModelAt:function(e){return this.getModelAt(e)},_getRenderedCellAt:function(e){return this._listOfRenderedCells.get(e)},_setRenderedCellAt:function(e,t){this._listOfRenderedCells.set(e,t)},updateView:function(e){if(this._isReady)return this._renderViewport(e)},prepareUpdateView:function(){this._updateCounter++},pushUpdateView:function(e,t){this._updateCounter--,0===this._updateCounter&&(this._updateNeeded||t)&&this.updateView(e)},invalidateLayout:function(e){this.layout._invalidate(e),this._isReady&&(e||(e={}),this._renderViewport(e))},updateCellView:function(e,t){if(t&&(t.updateCellContent||!0===t.updateCellLayout||t.updateCellAttributes||t.updateCellVisibility)){var i,n=this._getViewAt(e);if(n)(i=t.updateCellContent||!0===t.updateCellLayout?this.getCellInfosAt(e):this.getLightCellInfosAt(e)).cellView=n,t.updateCellContent&&(this.getCellEditableState(e)||this._removeCellInEdition(e),this._requestCellContent(i)),!0===t.updateCellLayout&&this._layoutCell(i),(t.updateCellContent||!0===t.updateCellLayout)&&this._applyCssClassesOnCell(i),t.updateCellAttributes&&this._applyAttributesOnCell(i),t.updateCellVisibility&&n.getContent().setAttribute("is-visible",!0)}},_updateRenderedCellAttributes:function(e){this.updateCellView(e,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})},_updateRenderedActiveCell:function(e){return this._updateRenderedCellAttributes(e)},_renderCell:function(e,t){var i=this.layout,n=t;this._visibleCellsInViewport[e]=e;var o=this._getRenderedCellAt(e);if(!o||t&&(t.updateCellContent||t.updateCellLayout||t.updateCellAttributes||t.updateCellVisibility)||i.cellTypeCanChangeOnScroll(e)){var l=t&&void 0!==t.cellType?t.cellType:i.getCellType(e);if(void 0===o||o.component.cellType!==l)o&&o.component.cellType!==l&&this._freeUpCell(e,1),o=(t&&t.cellPool?t.cellPool:this._cellPool).use(l),this._setRenderedCellAt(e,o),n={updateCellContent:!0,updateCellLayout:!t||"ignore"!==t.updateCellLayout,updateCellAttributes:!0,updateCellVisibility:void 0===t.updateCellVisibility||t.updateCellVisibility};return this.updateCellView(e,n),o}},_updateRenderViewportOptions:function(t){if(t){var i=this,n=function(e,n){var o=t[e];if(void 0!==o){var l=-1,s=i._renderViewportOptions[e];if(void 0!==s&&(l=n.indexOf(s)),l===n.length-1)return;n.indexOf(o)>l&&(i._renderViewportOptions[e]=o)}};n("updateCellContent",["ignore",!1,!0]),n("updateCellLayout",["ignore",!1,!0]),n("updateCellAttributes",["ignore",!1,!0]),n("freePool",[!1,!0]),function(e,n){var o=t[e];if(void 0!==o){var l=i._renderViewportOptions[e];(void 0===l||1===n&&o>l||-1===n&&o<l)&&(i._renderViewportOptions[e]=o)}}("allottedTime",1),i._renderViewportOptions=e.extend(t,i._renderViewportOptions)}},_renderViewport:function(t){var i=this,n=i.layout,o={taskInterrupted:!1};if(i._updateRenderViewportOptions(t),i._updateCounter>0)return i._updateNeeded=!0,o;if(!i.elements||!i.elements.container)return o;if(!1===i._isRendering()){var l=e.clone(this._renderViewportOptions,!0);l=e.extend({updateCellContent:!1,updateCellLayout:!0,updateCellAttributes:!0,allottedTime:void 0,freePool:!1},l),i._isRendering(!0),n.isValid()||(n.prepareLayout(),l.updateCellLayout=!0,l.freePool&&i._freeUpPool(1)),i._visibleCellsInViewport={};var s=e.clone(l);s.render=function(e,t){return l.cellType=t&&void 0!==t.cellType?t.cellType:void 0,l.cellPool=t&&void 0!==t.cellPool?t.cellPool:void 0,l.updateCellVisibility=t&&void 0!==t.updateCellVisibility?t.updateCellVisibility:void 0,i._renderCell(e,l)},!this.hasLeftContainer()&&n.hasCellsInLeftContainer()&&this._createLeftFixedContainer(),!this.hasRightContainer()&&n.hasCellsInRightContainer()&&this._createRightFixedContainer(),(o=n.renderListOfVisibleCellsInViewport(s))&&o.taskInterrupted&&(l.taskInterrupted=!0),i._postRender(l),i._isRendering(!1),i._updateNeeded=!1,i._renderViewportOptions={},i._endRendering()}return o},_postRender:function(e){var t=this;t.layout.postRender(),t._applyVirtualViewportSize(),e&&(e.lightRendering||e.taskInterrupted)||t._listOfRenderedCells.forEach(function(e,i){void 0===t._visibleCellsInViewport[i]&&t._freeUpCell(i,1)}),t._modelEvents.publish({event:"UPDATE_VIEW_COMPLETED",context:t,data:{hasAborted:!1}})},_isRendering:function(e){if(void 0===e)return void 0!==this.__isRendering&&this.__isRendering;this.__isRendering=e},onInfiniteScroll:function(t,i){i=e.extend({horizontalTolerance:10,verticalTolerance:10},i),this._infiniteScrollingHorizontalDistance=i.horizontalTolerance,this._infiniteScrollingVerticalDistance=i.verticalTolerance,this._onInfiniteScrollCB=t},infiniteScrollProcessDone:function(){this._modelEvents.publish({event:"infiniteScrollDone",context:this})},onEndResizeOrOnReadyModelRequest:function(e){this._onEndResizeOrOnReadyModelRequestCB=e},EndResizeOrOnReadyModelRequestDone:function(){return this._modelEvents.publish({event:"endResizeOrOnReadyModelRequestDone",context:this})},_requestCellContent:function(e){this._onCellRequest&&this._onCellRequest(e)},_layoutCell:function(e){var t=this.layout.getLayoutStylesForCellAt(e.cellID)||{},i=S(e.cellView.__cachedStyles,t);e.cellView.__cachedStyles=t;var n=e.cellView.getContent();for(o in i.toAdd)n.style[o]=i.toAdd[o];for(var o in i.toRemove)n.style[o]=""},getCellCssClassesAt:function(e){var t="";return e.cellView&&(t=e.cellView.getInitialClassName()),t},_applyCssClassesOnCell:function(e){var t=this.getCellCssClassesAt(e);e.cellView.__cachedCssClasses!==t&&(e.cellView.__cachedCssClasses=t,e.cellView.getContent().className=t)},getCellAttributesAt:function(e){var t={};return this.isCellPreselected(e.cellID)&&(t["is-preselected"]=!0,this.getPreselectedCellID()===e.cellID&&(t.hover=!0)),this.isCellSelected(e.cellID)&&(t["is-selected"]=!0),this.isCellHighlighted(e)&&(t["is-highlighted"]=!0),this.isCellActive(e.cellID)&&(t["is-active"]=!0),this.isCellInEdition(e.cellID)&&(t["is-in-edition"]=!0),this.selectionBehavior.showMixedStateOnParents&&this._hasSelectedDescendants(e.cellID)&&(t["has-selected-descendants"]=""),t},_applyAttributesOnCell:function(t){var i=this.getCellAttributesAt(t),n=this.layout.getLayoutAttributesForCellAt(t.cellID);e.extend(i,n);var o=S(t.cellView.__cachedAttributes,i);for(var l in t.cellView.__cachedAttributes=i,o.toAdd)t.cellView.getContent().setAttribute(l,o.toAdd[l]);for(var l in o.toRemove)t.cellView.getContent().removeAttribute(l,o.toRemove[l])},registerReusableCellContent:function(e){this._reusableCellContentManager.register(e)},isReusableCellContentRegistered:function(e){return this._reusableCellContentManager.isRegistered(e)},_reuseCellContent:function(e,t){var i=t.getReusableContent();i&&i.__disposable__&&i.__disposable__.identifier===e||(i&&i.__disposable__,i=this._reusableCellContentManager.use(e).component,t.setReusableContent(i));return i},reuseCellContent:function(e){var t=this._reusableCellContentManager.use(e);return t?t.component:null},onCellRequest:function(e){this._onCellRequest=e},_applyProperties:function(e){this._parent(e),this.isDirty("selectionBehavior")&&v._applyForAdvancedSetterProperty(this,"selectionBehavior",e.selectionBehavior,this.selectionBehavior),this.isDirty("layout")&&this._applyLayout(e.layout),this.isDirty("height")&&this._applyHeight(e.height),this.isDirty("rowSelection")&&this._applyRowSelection(e.rowSelection),this.isDirty("cellPreselectionFeedback")&&this._applyCellPreselectionFeedback(e.cellPreselectionFeedback),this.isDirty("cellSelection")&&this._applyCellSelection(e.cellSelection),this.isDirty("showScrollbarsOnHover")&&this._applyShowScrollbarsOnHover(e.showScrollbarsOnHover),this.isDirty("showBackgroundFlag")&&this._applyShowBackgroundFlag(e.showBackgroundFlag),this.isDirty("paginationManager")&&this._applyPaginationManager(e.paginationManager)},_applyLayout:function(e){this.layout.collectionView=this,this.getContent().setAttribute("layout",this.layout.name),this._isReady&&(this.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),this.setScrollerPosition({x:0,y:0}))},_applyModel:function(e){this._isReady&&(this._isRendering(!1),this.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0}),this.requestDelayedModelData("OnSyncModel"),this.elements.statusBar&&(this.elements.statusBar.updateTotalRows(),this.elements.statusBar.updateTotalVisibleRows()))},requestDelayedModelData:function(e,t){},_applyShowScrollbarsOnHover:function(e){this.elements.scrollContainerRel&&this.elements.scrollContainerRel.setAttribute("show-at-hover",!!this.showScrollbarsOnHover)},_applyShowBackgroundFlag:function(e){this.showBackgroundFlag?this.getContent().removeAttribute("no-background"):this.getContent().setAttribute("no-background","")},_applyPaginationManager:function(e){e&&e._collectionView===this&&(e._collectionView=void 0),this.paginationManager?(this.paginationManager._collectionView=this,this._isReady&&this.paginationManager.updatePagination()):this._isReady&&this._updateModel()},_endRendering:function(){},beginTransition:function(){},endTransition:function(){},scrollToCellAt:function(t){"number"==typeof t&&(t={cellID:t}),t=e.extend({animate:!1},t);var i=this.layout.getPositionForCellAt(t.cellID),n=i.left,o=i.top;this.setScrollerPosition({x:n,y:o,animate:t.animate})},ensureCellVisible:function(e,t,i){if(-1===e)return;var n=this.layout,o=n.getPositionForCellAt(e),l=n.getDimensionsForCellAt(e),s=this.getScrollerPosition(),r=this._getScroller().getContent().getDimensions(),a=n.getContentDimensions();this._scrollbarWidth||(this._scrollbarWidth=this.getScrollbarWidth());let c=this._getScroller().areScrollbarsDisplayed();var h=c.horizontal&&r.width<a.width?this._scrollbarWidth:0,u=c.vertical&&r.height<a.height?this._scrollbarWidth:0,d=n.gutter||0,g={x:s.x,y:s.y},p=n.getCellType(e);if("__item__"===p||"__left_item__"===p||"__right_item__"===p||"__tree_item__"===p||"__left_tree_item__"===p||"__right_tree_item__"===p){g.y+r.height-h<o.top+l.height+d&&(g.y=o.top+l.height+d-r.height+h);let e=this.layout.sectionHeight?this.layout.sectionHeight:0;g.y>o.top-d-e&&(g.y=o.top-d-e)}if("__item__"!==p&&"__tree_item__"!==p&&"__top_item__"!==p||(g.x+r.width-u<o.left+l.width+d&&(g.x=o.left+l.width+d-r.width+u),g.x>o.left-d&&(g.x=o.left-d)),s.x!==g.x||s.y!==g.y){if(void 0!==i&&i>=0&&i<=1){var f=this.getViewportDimensions(),m=0,C=0;s.x<g.x?m=(1-i)*(f.width-l.width):s.x>g.x&&(m=-i*(f.width-l.width)),s.y<g.y?C=(1-i)*(f.height-l.height):s.y>g.y&&(C=-i*(f.height-l.height)),g={x:g.x+m,y:g.y+C}}return this.setScrollerPosition({x:g.x,y:g.y,animate:t}),!0}return!1},ensureNodeModelVisible:function(e,t,i,n,o){var l=this.layout;if(!e)return!1;var s=this.getTreeDocument();if(s&&(e.getTreeDocument&&e.getTreeDocument()!==s||!e.getTreeDocument))return!1;if(!1===e.isVisible()&&!0===i&&s){s.prepareUpdate();for(var r=e;r&&!1===r.isVisible()&&r.getParent();)r.getParent().expand(),r=r.getParent();s.pushUpdate()}var a=l.getCellsFromNodeModel(e);if(a&&a.length>0){var c=this.ensureCellVisible(a[0],t,n);if(o)if(c){var h=this;this.subscribeOnceToAllCellsRendered(function(){h.flashEffectOnNodeModel("ui-modified",e)})}else this.flashEffectOnNodeModel("ui-modified",e);return c}return!1},flashEffectOnNodeModel:function(e,t){if(t){var i=this.layout.getCellsFromNodeModel(t,!0);if(i&&i.length>0)for(var n=0;n<i.length;n++)this.flashEffectOnCell(e,i[n])}},flashEffectOnCell:function(e,t){var i=this._getViewAt(t);if(i){if(i.getContent().classList.contains(e)){i.getContent().classList.remove(e);i.getContent().offsetWidth}i.getContent().classList.add(e),i.getContent().addEventListener("animationend",function(t){t.target.classList.remove(e)},{once:!0})}},_processPoolCells:function(e){var t=this;this._listOfRenderedCells.forEach(function(i,n){e.call(t,{cellView:i})})},_enableAutoScroll:function(e,t){if(this._autoScrollDistance=e||{x:0,y:0},this._autoScrollPeriod=t||20,this._disableAutoScroll(),void 0===this._autoScrollInterval){var i=this;this._autoScrollInterval=window.setInterval(function(){var e=i._getScroller(),t=e.elements.container.scrollTop,n=e.elements.container.scrollLeft;t>=0&&e.setPosition({y:t+i._autoScrollDistance.y},!0),n>=0&&e.setPosition({x:n+i._autoScrollDistance.x},!0)},this._autoScrollPeriod)}},_setAutoScrollVelocity:function(e){this._autoScrollDistance=e||{x:0,y:0}},_disableAutoScroll:function(){void 0!==this._autoScrollInterval&&(window.clearInterval(this._autoScrollInterval),delete this._autoScrollInterval)},_onGutterOrMarginsChange:function(){},displayModalContainer:function(e,t){(!e||this._modalContainerCreated||this._loaderDisplayed)&&m.removeModal(this.getContent()),m.createModal(this.getContent(),e,t),this._modalContainerCreated=!0},removeModalContainer:function(){this._modalContainerCreated&&(m.removeModal(this.getContent()),this._modalContainerCreated=!1)},displayModalLoader:function(e,t){C.displayModalLoader(this.getContent(),e,t)},removeModalLoader:function(e){C.removeModalLoader(this.getContent(),e)},getNodeModelAtRowID:function(e){if(this.model&&Array.isArray(this.model))return this.model[e]},getModelLength:function(){return this.model&&Array.isArray(this.model)?this.model.length:0},destroy:function(){this._freeUpPool(1),this._cellPool&&(this._cellPool.destroy(),this._cellPool=null),this._parent()},_updateModel(){throw"Function is not implemented on CollectionView base class!!!"},onPaginationChangeAsyncLoadModel:function(e){this._onPaginationChangeAsyncLoadModelCB=e},paginationChangeAsyncProcessDone:function(){this._modelEvents.publish({event:"paginationChangeAsyncDone",context:this})},_setScrollbarsHidden:function(e){if(!e)return;let t={};e.hasOwnProperty("horizontal")&&(t.horizontal=e.horizontal?"hidden":void 0),e.hasOwnProperty("vertical")&&(t.vertical=e.vertical?"hidden":void 0),this._getScroller()._setOverflow(t)},_preEditSelectionBehavior:function(e,t){if(!t)return!1;return{validValue:Object.assign({},e,t)}},onFindRequest:function(e,t){if(this.findCtx||(this.findCtx={opts:{}}),this.findCtx.opts=Object.assign({},e),this.findCtx.actionCompleted=t,e.findInContentSelected&&Array.isArray(e.findInContentSelected)&&e.findInContentSelected.length>0){let t={};for(const e of this.layout.getLeafColumns())t[e.text]=e.dataIndex;const i=e.findInContentSelected.map(e=>t[e]);this.getColumnsToProcessForFind=(()=>i)}else this.getColumnsToProcessForFind=void 0;const i=this._muteFind;this._muteFind=!0,this.findNavigationMode=e.navigationMode,this._muteFind=i,this.setFindStr(e.findStr,e.matchCase,e.currentValue,void 0,!0)},setFindStr:function(e,t,i,n,o,l,s){if(this._onSetFindStr=!0,this._muteFind||this.findStr!==e||t!==this.matchCase||o){this._findModel=this._getFindModel();var r=!1;!0===this._muteFind&&this._findModel._isServerSide()&&(r=!0),this._muteFind=!1;var a=this.findStr,c=this.matchCase;this.matchCase=t,(this.findStr!==e||r)&&this._initFindVariables(),this.findStr=e,this.oldFindValue=a,this._hasARegExpFilter=s,void 0===i&&this.findWidget&&this.findWidget.setLoadingState&&this.findWidget.setLoadingState(!0);var h=function(){if(this._findModel){if(this.matchingStringCount=this._findModel._computeMatchingStringsCount(),this.findCtx||this.findWidget){let e;this.findWidget&&(this.findWidget.count=-1),"substring"===this.findNavigationMode?e=this.matchingStringCount:"cell"===this.findNavigationMode?(this._matchingCellIDsCount=this._findModel._computeMatchingCellIDsCount(),e=this._matchingCellIDsCount):(this._matchingRowsCount=this._findModel._computeMatchingNodeModelsCount(),e=this._matchingRowsCount),this.findCtx?this.findCtx.opts.count=e:this.findWidget&&(this.findWidget.count=e)}if(this._matchingCellIDsArray.length>0){if(void 0===i)this._currentMatchingStringIndex=0,this._currentMatchingCellIDIndex=0,this._currentMatchingRowIDIndex=0;else{var e=this._findModel._computeCurrentMatchingStringIndex(this,i);if(this._currentMatchingStringIndex=e,this._currentMatchingCellIDIndex=this._getMatchingCellIDIndexFromMatchingStringIndex(this._currentMatchingStringIndex),this._currentMatchingRowIDIndex=this._getMatchingRowIDIndexFromMatchingStringIndex(this._currentMatchingStringIndex),this.findCtx)this.findCtx.currentValue=this._findModel._computeFindEditorCurrentValue();else if(this.findWidget){var t=this._findModel._computeFindEditorCurrentValue();this.findWidget.setCurrentValue(t)}}if(this._currentMatchingRowIDIndex>=0&&(this._findModel._currentMatchingNodeModel=this._matchingNodeModelsArray[this._currentMatchingRowIDIndex]),!n){var o=this._matchingAllNodeModelsArray[this._currentMatchingCellIDIndex];o&&this.ensureNodeModelVisible(o,!1,!0,.5),this.ensureCellVisible(this._matchingCellIDsArray[this._currentMatchingCellIDIndex],!1,.5)}}this._updateViewAfterFind(),this._rowModel&&this._rowModel._isServerSide()&&this.findCtx&&this.findCtx.opts&&this.findCtx.opts.autoSelect&&this.onFindAutoSelect(this.findCtx.opts),this.findCtx&&this.findCtx.actionCompleted?this.findCtx.actionCompleted(Object.assign({},this.findCtx.opts)):this.findWidget&&this.findWidget.setLoadingState&&this.findWidget.setLoadingState(!1)}};if(""!=this.findStr){var u;a===this.findStr&&this.matchCase!==c&&!0===this.matchCase&&this._findModel&&(u=this._findModel._getNodeModelsToProcessFromMatchCaseChange());let e=0;this.findCtx&&this.findCtx.opts.currentValue&&void 0!==i?e=this.findCtx.opts.currentValue-1:this.findWidget&&this.findWidget.currentValue&&void 0!==i&&(e=this.findWidget.currentValue-1),this._findAllCellIDsMatchingFindStr(this.findStr,this.matchCase,e,u,l,h)}else h.call(this);this._onSetFindStr=!1}else this._onSetFindStr=!1},_initFindVariables:function(){this._matchingFoundArrays=[],this._matchingCellIDsArray=[],this._matchingCellIDsMap={},this._matchingNodeModelsArray=[],this._matchingNodeModelsMap={},this._currentMatchingCellIDIndex=-1,this._currentMatchingRowIDIndex=-1,this.matchingStringCount=0,this._findModel&&(this._findModel._findResultNumber=0,this._findModel._findCurrentResultValue=void 0,this._findModel._matchingStringCount=0,this._findModel._matchingCellIDsCount=0,this._findModel._matchingRowsCount=0,this._findModel._currentMatchingNodeModel=void 0)},_getFindModel:function(){return this._findModel||(this._findModel=new _({collectionView:this,treeDocument:this.getTreeDocument()})),this._findModel},_findAllCellIDsMatchingFindStr:function(e,t,i,n,o,l,s){let r=this._getFindModel();r&&r._findAndDisplayAllCellIDsMatchingFindStr(e,t,i,n,o,l,s)},_getIndexesOfMatchingString:function(e,t){for(var i=[],n=e.indexOf(t);-1!=n;)i.push(n),n=e.indexOf(t,n+t.length);return i},_getMatchingCellIDIndexFromMatchingStringIndex:function(e){for(var t=0,i=0;i<this._matchingFoundArrays.length;i++)if((t+=this._matchingFoundArrays[i].length)>e)return i;return-1},_getMatchingStringIndexFromMatchingCellIDIndex:function(e){if(e>=0&&e<this._matchingFoundArrays.length){for(var t=0,i=0;i<e;i++)t+=this._matchingFoundArrays[i].length;return t}return-1},_getMatchingRowIDIndexFromMatchingStringIndex:function(e){for(var t=0,i=0;i<this._matchingFoundArrays.length;i++){if(t>=e){var n=this._matchingAllNodeModelsArray[i];return this._matchingNodeModelsArray.indexOf(n)}t+=this._matchingFoundArrays[i].length}return-1},onFindReset:function(){this.findCtx||(this.findCtx={opts:{}}),this.setFindStr("",!1,0,void 0,!0)},_updateViewAfterFind:function(){var e=this.oldFindValue;if(e&&""!=e)this.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0});else for(var t=0;t<this._matchingCellIDsArray.length;t++)this.updateCellView(this._matchingCellIDsArray[t],{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})},_computeHighlightModelForFind:function(e){var t=void 0;if(!this._muteFind&&this._matchingCellIDsArray&&this._matchingCellIDsArray.length>0){var i;(i=this._matchingCellIDsMap[e.cellID])>=0&&(t={label:this.findStr,isARegExp:this._hasARegExpFilter,indexes:this._matchingFoundArrays[i],selectedIndex:this._getSelectedIndexFromMatchingCellIDIndex(i)})}return t},_getSelectedIndexFromMatchingCellIDIndex:function(e){for(var t=0,i=0;i<this._matchingFoundArrays.length&&!(i>e||t>this._currentMatchingStringIndex);i++){var n=t;if(t+=this._matchingFoundArrays[i].length,i===e&&t>this._currentMatchingStringIndex)return this._currentMatchingStringIndex-n}return-1},_getMatchingStringIndexFromMatchingRowIDIndex:function(e){if(e>=0&&e<this._matchingNodeModelsArray.length){var t=0,i=this._matchingNodeModelsArray[e];if(i)for(var n=0;n<this._matchingAllNodeModelsArray.length&&this._matchingAllNodeModelsArray[n]!==i;n++)t+=this._matchingFoundArrays[n].length;return t}return-1},_getMatchingCellID:function(e){var t=-1;return this._matchingCellIDsArray&&e>=0&&e<this._matchingCellIDsArray.length&&(t=this._matchingCellIDsArray[e]),t},onFindNextResult:function(e,t){this.findCtx||(this.findCtx={opts:{}}),this.findCtx.opts=Object.assign({},e),this.findCtx.actionCompleted=t,this.goToNextMatchingCell()},goToNextMatchingCell:function(){this.findStr&&""!=this.findStr&&this.matchingStringCount>0&&(!0===this._muteFind&&(this._muteFind=!1,this.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})),this._onSetFindStr=!0,this._setCurrentMatchingCell(1),this._onSetFindStr=!1)},_setCurrentMatchingCell:function(e){var t=this._getFindModel();this.findWidget&&this.findWidget.setLoadingState&&this.findWidget.setLoadingState(!0);let i;this.findCtx?i=this.findCtx.opts.currentValue-1:this.findWidget&&(i=this.findWidget.currentValue-1),this._findAllCellIDsMatchingFindStr(this.findStr,this.matchCase,i,void 0,!1,function(i,n){var o;if(o=1===e?t._computeNextMatchingData(this,n):t._computePreviousMatchingData(this,n),this._currentMatchingStringIndex!==o||t._isServerSide()){var l=this.layout,s=this._currentMatchingStringIndex,r=this._getMatchingCellIDIndexFromMatchingStringIndex(s),a=this._getMatchingCellID(r),c=o,h=this._getMatchingCellIDIndexFromMatchingStringIndex(c),u=this._getMatchingCellID(h);if(this._currentMatchingStringIndex=c,this._currentMatchingCellIDIndex=h,this._currentMatchingRowIDIndex=this._getMatchingRowIDIndexFromMatchingStringIndex(this._currentMatchingStringIndex),this._currentMatchingRowIDIndex>=0&&(t._currentMatchingNodeModel=this._matchingNodeModelsArray[this._currentMatchingRowIDIndex]),this._currentMatchingCellIDIndex>=0){var d=this._matchingAllNodeModelsArray[this._currentMatchingCellIDIndex];if(d&&this.ensureNodeModelVisible(d,!1,!0,.5),this.updateCellView(u,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0}),"row"===this.findNavigationMode){var g=l.getCellCoordinatesAt(u).rowID;this._updateRenderedRowCellsAttributes(g)}this.ensureCellVisible(u,!1,.5)}void 0===a&&null===a||(this.updateCellView(a,{updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0}),"row"!==this.findNavigationMode)||(g=l.getCellCoordinatesAt(a).rowID,this._updateRenderedRowCellsAttributes(g)),this.findCtx&&this.findCtx.actionCompleted?this.findCtx.actionCompleted(Object.assign({},this.findCtx.opts)):this.findWidget&&this.findWidget.setLoadingState&&this.findWidget.setLoadingState(!1)}else this.findCtx&&this.findCtx.actionCompleted?this.findCtx.actionCompleted(Object.assign({},this.findCtx.opts)):this.findWidget&&this.findWidget.setLoadingState&&this.findWidget.setLoadingState(!1)},!0)},onFindPreviousResult:function(e,t){this.findCtx||(this.findCtx={}),this.findCtx.opts=Object.assign({},e),this.findCtx.actionCompleted=t,this.goToPreviousMatchingCell()},goToPreviousMatchingCell:function(){this.findStr&&""!=this.findStr&&this.matchingStringCount>0&&(!0===this._muteFind&&(this._muteFind=!1,this.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})),this._onSetFindStr=!0,this._setCurrentMatchingCell(-1),this._onSetFindStr=!1)},onFindInit:function(e){this._onFind=!0,this.findCtx||(this.findCtx={opts:{}}),this.findCtx.close=e},onFindClose:function(){this._onFind=!1,this.closeFind(),this.findCtx=null},onFindAutoSelect:function(e,t){if(this.findCtx||(this.findCtx={opts:{}}),this.findCtx.opts=Object.assign({},e),this.findCtx.actionCompleted=t,this.findCtx.opts&&this.findCtx.opts.autoSelect&&(this.findCtx.opts.autoSelect.modified&&this.unselectAll(),this.findCtx.opts.autoSelect.value))for(const e of this._matchingNodeModelsArray)this.selectNodeModel(e,!0);this.findCtx&&this.findCtx.actionCompleted&&this.findCtx.actionCompleted()},closeFind:function(){!1===this._muteFind&&(this._muteFind=!0,this.findStr&&""!==this.findStr&&this.invalidateLayout({updateCellContent:!0,updateCellLayout:!1,updateCellAttributes:!0})),this._resetFindVariables()},_resetFindVariables:function(){this._initFindVariables()},_getCellValueAsStringForFind:function(e,t,i,n){},_getMatchingStringIndexFromMatchingRowIDIndex:function(e){if(e>=0&&e<this._matchingNodeModelsArray.length){var t=0,i=this._matchingNodeModelsArray[e];if(i)for(var n=0;n<this._matchingAllNodeModelsArray.length&&this._matchingAllNodeModelsArray[n]!==i;n++)t+=this._matchingFoundArrays[n].length;return t}return-1},getMatchingFindNodeModelArray:function(){return this._matchingNodeModelsArray},getMatchingFindCurrentNodeModel:function(){return this._rowModel?this._rowModel._currentMatchingNodeModel:void 0},_findAllCellIDsMatchingFindStr:function(e,t,i,n,o,l,s){let r=this._getFindModel();r&&r._findAndDisplayAllCellIDsMatchingFindStr(e,t,i,n,o,l,s)},_updateHighlight:function(e){if(this._onFind||this._onSetFindStr||""!==this.findStr){var t=this._computeHighlightModelForFind(e);e.cellView.contentView._setHighlightModel(t)}}})});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/CollectionView/modelProviders/CollectionViewTreeDocumentModelProvider",["require","exports","UWA/Core","DS/CollectionView/modelProviders/CollectionViewModelProvider","DS/TreeModel/TreeDocument","DS/TreeModel/TreeNodeModel","DS/UWAUtils/WUXUWAUtils2"],function(e,t,i,n,o,l,s){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getModelClass=function(){return o},t.prototype.addModelEvents=function(){var e=this,t=this.collectionView.applicativeModel;if(t){var i=0,n=t.addModelEventListener("prepareUpdate",function(e){i++});this.modelEventsListener.push(n),n=t.addModelEventListener("pushUpdate",function(t){if(--i<0&&console.error("You pushed too many updates"),0===i){if(e.collectionView.keyboardMutePoolrefresh||t&&t.options&&(t.options.updateType===window.WUXModelUpdateTypes.PreSelection||t.options.updateType===window.WUXModelUpdateTypes.Selection))return;!0===e.collectionView._cellUISelectionAction||!0===e.collectionView.modelUISelectionAction?e.collectionView._updateAllPoolSelectedViews():(e.collectionView.model=e.flattenApplicativeModel(e.collectionView.applicativeModel),e.collectionView.invalidateLayout({updateCellContent:!0}))}}),this.modelEventsListener.push(n),n=t.onNodeModelUpdate(function(t){0===i&&(e.collectionView.model=e.flattenApplicativeModel(e.collectionView.applicativeModel),e.collectionView.invalidateLayout({updateCellContent:!0}))}),this.modelEventsListener.push(n);var o=function(t){var i=t.target;if(i){var n=i._getRowID();e.collectionView.updateCellView(n,{updateCellContent:!1,updateCellLayout:!1,updateCellAttributes:!0})}};n=t.addModelEventListener("highlight",o),this.modelEventsListener.push(n),n=t.addModelEventListener("unhighlight",o),this.modelEventsListener.push(n)}},t.prototype.removeModelEvents=function(){var e=this.collectionView.applicativeModel;if(e&&e.getModelEvents()){for(var t=0;t<this.modelEventsListener.length;t++)e.getModelEvents().unsubscribe(this.modelEventsListener[t]);this.modelEventsListener.splice(0,this.modelEventsListener.length)}},t.prototype.flattenApplicativeModel=function(e){var t;return e&&(t=e.getAllDescendants({onlyVisibleNodes:!0})),t},t.prototype.fillApplicativeModelFromViewModel=function(e,t){if(e&&t)for(var i=0;i<t.length;i++){var n=t[i];n instanceof l&&e.addRoot(n)}},t.prototype.getNodeModelRowID=function(e,t){return e._getRowID(t)},t.prototype.selectAllVisibleNodes=function(){var e=this.collectionView.applicativeModel;if(e){var t=[],i=this.getNodesXSO();e.withTransactionUpdate(function(){e._getTrueRoot().processDescendants({onlyVisibleNodes:!0,processNode:function(e){t.push(e.nodeModel)}}),i.empty(),i.add(t)}),this.collectionView.model&&this.collectionView.model.length&&this.collectionView.setActiveNode(this.collectionView.model[this.collectionView.model.length-1],!1)}},t.prototype.unselectAll=function(){var e=this.collectionView.applicativeModel;e&&e.unselectAll()},t.prototype.isNodeVisible=function(e){return e.isVisible()},t.prototype.shouldAcceptDrag=function(e){return e.getTreeDocument().options.shouldAcceptDrag(e)},t.prototype.dumpNodeModel=function(e,t){return e.dump({properties:[function(){return{property:"label",value:this.options.label}},function(){return{property:"grid",value:this.options.grid}},function(){return{property:"description",value:this.options.description}},function(){return{property:"statusbarIcons",value:this.options.statusbarIcons}}]})},t.prototype.selectNode=function(t,i){var n=this.collectionView.applicativeModel;if(n){var o=this.getNodesXSO();o&&(n.getXSO()===o?t.select(i):e.prototype.selectNode.call(this,t,i))}},t.prototype.unSelectNode=function(t){var i=this.collectionView.applicativeModel;if(i){var n=this.getNodesXSO();n&&(i.getXSO()===n?t.unselect():e.prototype.unSelectNode.call(this,t))}},t.prototype.isNodeSelected=function(t){var i=this.collectionView.applicativeModel;if(i){var n=this.getNodesXSO();if(n)return i.getXSO()===n?t.isSelected():e.prototype.isNodeSelected.call(this,t)}},t.prototype.getNodesXSO=function(){if(!this.collectionView.supportsSelection())return null;if(this.collectionView.selectionManagedByView)this.selectionModel=e.prototype.getNodesXSO.call(this);else{var t=this.collectionView.applicativeModel;t&&(this.selectionModel=t.getXSO())}return this.selectionModel},t.prototype.getXSOElementID=function(e){return e._getID()},t.prototype.getPropertyValue=function(e,t){return"badges"==t?e.getBadges():"icon"==t?e.options.icons&&e.options.icons.length?e.options.icons[0]:null:"picture"==t?e.options.thumbnail:"propertiesList"==t||"progressValueData"==t||"statusbarIcons"==t||"statusbarLabelsWidthRatios"==t||"statusbarIconsTooltips"==t||"contextualMenu"==t?i.clone(e.options[t]):e.options[t]},t.inherit=s.inherit,t.extend=s.extend,t}(n)}),define("DS/CollectionView/ResponsiveCollectionView",["UWA/Drivers/Alone","DS/CollectionView/CollectionView","DS/Core/PointerEvents","DS/Menu/ContextualMenu","DS/CollectionView/modelProviders/CollectionViewTreeDocumentModelProvider","DS/Utilities/Color","DS/Utilities/Utils"],function(e,t,i,n,o,l,s){"use strict";const r=!1;return t.inherit({name:"ResponsiveCollectionView",publishedProperties:{layout:{defaultValue:null,type:"object"},height:{defaultValue:"inherit",type:"integer"},modelProvider:{defaultValue:null,type:"object"},model:{defaultValue:[],type:"array"},selectionBehavior:{defaultValue:{},type:"object"},displayedOptionalCellProperties:{defaultValue:["All"],type:"array"},displayTitleTooltip:{defaultValue:!0,type:"boolean"},displayPropertiesTooltip:{defaultValue:!0,type:"boolean"},displayStatusbarTooltip:{defaultValue:!0,type:"boolean"},useDragAndDrop:{defaultValue:!1,type:"boolean"},onContextualEvent:{defaultValue:void 0,type:"function",noNeedToApplyFlag:!0},onDragStartCell:{defaultValue:function(e,t){if("function"==typeof e.dataTransfer.setDragImage&&i.isLastEventTouch()){t.manager.__draggedNode&&(t.manager.__draggedNode.remove(),t.manager.__draggedNode=void 0),t.manager.__draggedNode=e.target.cloneNode(!0),t.manager.__draggedNode.style.transform="",t.manager.__draggedNode.style.position="absolute",e.target.parentElement.appendChild(t.manager.__draggedNode);var n=e.target.getBoundingClientRect(),o=e.target.parentElement.getBoundingClientRect();t.manager.__draggedNode.style.zIndex="-10000000",t.manager.__draggedNode.style.left=n.left-o.left+"px",t.manager.__draggedNode.style.top=n.top-o.top+"px";var l=e.clientX-n.left,s=e.clientY-n.top;e.dataTransfer.setDragImage(t.manager.__draggedNode,l,s)}return this.onDragStartCellDefault(e,t)},type:"function"},onDragCell:{defaultValue:function(e,t){return this.onDragCellDefault(e,t)},type:"function"},onDragEndCell:{defaultValue:function(e,t){return t.manager.__draggedNode&&(t.manager.__draggedNode.remove(),t.manager.__draggedNode=void 0),this.onDragEndCellDefault(e,t)},type:"function"},onDragEnterBlank:{defaultValue:function(e,t){return this.onDragEnterBlankDefault(e,t)},type:"function"},onDragOverBlank:{defaultValue:function(e,t){return this.onDragOverBlankDefault(e,t)},type:"function"},onDragLeaveBlank:{defaultValue:function(e,t){return this.onDragLeaveBlankDefault(e,t)},type:"function"},onDragEnterCell:{defaultValue:function(e,t){return this.onDragEnterCellDefault(e,t)},type:"function"},onDragOverCell:{defaultValue:function(e,t){return this.onDragOverCellDefault(e,t)},type:"function"},onDragLeaveCell:{defaultValue:function(e,t){return this.onDragLeaveCellDefault(e,t)},type:"function"},onDropBlank:{defaultValue:function(e,t){return t.manager.__draggedNode&&(t.manager.__draggedNode.remove(),t.manager.__draggedNode=void 0),this.onDropBlankDefault(e,t)},type:"function"},onDropCell:{defaultValue:function(e,t){return t.manager.__draggedNode&&(t.manager.__draggedNode.remove(),t.manager.__draggedNode=void 0),this.onDropCellDefault(e,t)},type:"function"},allowUnsafeHTMLContent:{defaultValue:void 0,type:"boolean",noNeedToApplyFlag:!0},shouldCellAllowUnsafeHTMLContentAt:{defaultValue:function(e,t){return this.allowUnsafeHTMLContent},type:"function",noNeedToApplyFlag:!0}},selectionManagedByView:!1,onDragStartCellDefault:function(e,t){let i=t.nodeModel,n=t.manager;var o=n.getNodesXSO().isIn(i);let l=n.modelProvider;if(l.shouldAcceptDrag(i)&&o){let t=n.getNodesXSO().get().map(function(e){return l.dumpNodeModel(e)}),o={identifier:n.identifier,draggedNode:l.dumpNodeModel(i),selectedNodes:t};e.dataTransfer.setData("Text",JSON.stringify(o)),e.dataTransfer.effectAllowed="move"}else e.preventDefault();e._webUXpreventDefault=e.defaultPrevented},onDragCellDefault:function(e,t){e._webUXpreventDefault=e.defaultPrevented},onDragEnterBlankDefault:function(e,t){t.manager._getScroller().getContent().addClassName("wux-ui-state-drag-over"),e._webUXpreventDefault=e.defaultPrevented},onDragLeaveBlankDefault:function(e,t){this&&this._hideDndFeedbacks(),t.manager._getScroller().getContent().removeClassName("wux-ui-state-drag-over"),e._webUXpreventDefault=e.defaultPrevented},onDragEnterCellDefault:function(e,t){e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented},onDragOverCellDefault:function(e,t){this&&this._showDndFeedbacks(e,t),e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented},onDragLeaveCellDefault:function(e,t){this&&this._hideDndFeedbacks(),e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented},onDragOverBlankDefault:function(e,t){this&&this._showDndFeedbacks(e,t),e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented},onDragEndCellDefault:function(e,t){this&&this._hideDndFeedbacks(),e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented},onDropBlankDefault:function(e,t){return this&&this._hideDndFeedbacks(),t.manager._getScroller().getContent().removeClassName("wux-ui-state-drag-over"),e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented,!1},onDropCellDefault:function(e,t){return this&&this._hideDndFeedbacks(),e.preventDefault(),e._webUXpreventDefault=e.defaultPrevented,!1},_applyProperties:function(e){this._parent(e),this.isDirty("displayedOptionalCellProperties")&&this._applyDisplayedOptionalCellProperties(e.displayedOptionalCellProperties),this.isDirty("modelProvider")&&this._applyModelProvider(e.modelProvider),this._applyModel(e.model),this.isDirty("displayTitleTooltip")&&this._applyDisplayTitleTooltip(e.displayTitleTooltip),this.isDirty("displayPropertiesTooltip")&&this._applyDisplayPropertiesTooltip(e.displayPropertiesTooltip),this.isDirty("displayStatusbarTooltip")&&this._applyDisplayStatusbarTooltip(e.displayStatusbarTooltip),this.isDirty("useDragAndDrop")&&this._applyUseDragAndDrop(e.useDragAndDrop)},_applyDisplayedOptionalCellProperties:function(e){if(this._displayedOptionalCellProperties=[],0!==this.displayedOptionalCellProperties.length){if(this.displayedOptionalCellProperties.length>=1){if(-1!==this.displayedOptionalCellProperties.indexOf("All"))return void(this._displayedOptionalCellProperties=["All"]);if(-1!==this.displayedOptionalCellProperties.indexOf("None"))return void(this._displayedOptionalCellProperties=["None"])}for(var t=0;t<this.displayedOptionalCellProperties.length;t++)"contextualMenu"!==this.displayedOptionalCellProperties[t]&&"description"!==this.displayedOptionalCellProperties[t]&&"propertiesList"!==this.displayedOptionalCellProperties[t]&&"statusbarIcons"!==this.displayedOptionalCellProperties[t]&&"activeFlag"!==this.displayedOptionalCellProperties[t]||this._displayedOptionalCellProperties.push(this.displayedOptionalCellProperties[t])}else this._displayedOptionalCellProperties=["All"]},_applyDisplayTitleTooltip:function(e){this.invalidateLayout()},_applyDisplayPropertiesTooltip:function(e){this.invalidateLayout()},_applyDisplayStatusbarTooltip:function(e){this.invalidateLayout()},_applyUseDragAndDrop:function(e){this.useDragAndDrop!==e&&this._processPoolCells(function(e){var t=e.cellView.component;t&&(!0===this.useDragAndDrop?t.elements.container.setAttribute("draggable","true"):t.elements.container.setAttribute("draggable","false"))})},getTreeDocument:function(){return this.applicativeModel},_applyModelProvider:function(e){if(!this.modelProvider)throw new Error("modelProvider is mandatory for CollectionView model representation. Please provide a not null modelProvider.");this.modelProvider.collectionView=this},_applyModel:function(e){if(this.model!==e){if(!0===this._applyModelPending)return;if(this._applyModelPending=!0,this.applicativeModel)this.model instanceof this.modelProvider.getModelClass()&&(this._removeModelEvents(),this.activeNode=null,this.TreedocModel=null,this.applicativeModel=null,this.loadApplicativeModel(this.model),this.setScrollerPosition({x:0,y:0})),this.model||(this.unloadApplicativeModel(),this.setScrollerPosition({x:0,y:0}));else if(this.model instanceof this.modelProvider.getModelClass())this.loadApplicativeModel(this.model);else if(this.model&&0!==this.model.length){var t=new(this.modelProvider.getModelClass());this.modelProvider.fillApplicativeModelFromViewModel(t,this.model),this.loadApplicativeModel(t)}this._parent(e),this._applyModelPending=!1}},_interactiveCumulativeSelection:!1,_preBuildView:function(e){this._xsoEventsListener=[],this.modelProvider=new o,this._needToSelectAtRelease=!1,this._parent(e),this._properties.selectionBehavior.value={unselectAllOnEmptyArea:!0,toggle:!0,canMultiSelect:!0,canInteractiveMultiselectWithCheckboxClick:!0,enableShiftSelection:!0,enableFeedbackForActiveCell:!0}},buildView:function(){this._parent(),this.elements.container.addClassName("wux-layouts-responsivecollectionview")},_manageKeyboard:function(){this._parent();var t=this.commands.shiftUp,i=this.commands.shiftRight,n=this.commands.shiftDown,o=this.commands.shiftLeft,l=this.commands.shiftPageup,s=this.commands.shiftPagedown,r=this.commands.shiftHome,a=this.commands.shiftEnd,c=Object.assign({},this.commands);e.extend(c,{copy:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"copy",data:e?e.get():null})},paste:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"paste",data:e?e.get():null})},cut:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"cut",data:e?e.get():null})},escape:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"escapeKeyPressed",data:e?e.get():null})},deleteKeyPressed:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"deleteKeyPressed",data:e?e.get():null})},spaceKeyPressed:function(){this.activeNode&&(this.modelProvider.isNodeSelected(this.activeNode)?this.modelProvider.unSelectNode(this.activeNode):this.modelProvider.selectNode(this.activeNode))},ctrlSpaceKeyPressed:function(){this.activeNode&&(this.modelProvider.isNodeSelected(this.activeNode)?this.modelProvider.unSelectNode(this.activeNode):this.modelProvider.selectNode(this.activeNode))},tab:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"tab",data:e?e.get():null})},shiftTab:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"tab",data:e?e.get():null})},f2:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"f2",data:e?e.get():null})},enter:function(){var e=this.getNodesXSO();this._modelEvents.publish({event:"enter",data:e?e.get():null})},upMove:function(){var e=this.computeCellIDFromActiveCell("up");return this.selectCell(e,!1,!1),{preventDefault:!0}},rightMove:function(){var e=this.computeCellIDFromActiveCell("right");return this.selectCell(e,!1,!1),{preventDefault:!0}},downMove:function(){var e=this.computeCellIDFromActiveCell("down");return this.selectCell(e,!1,!1),{preventDefault:!0}},leftMove:function(){var e=this.computeCellIDFromActiveCell("left");return this.selectCell(e,!1,!1),{preventDefault:!0}},shiftUp:function(){this._modeIsShiftSel?t.call(this):this.commands.upMove.call(this)},shiftRight:function(){this._modeIsShiftSel?i.call(this):this.commands.rightMove.call(this)},shiftDown:function(){this._modeIsShiftSel?n.call(this):this.commands.downMove.call(this)},shiftLeft:function(){this._modeIsShiftSel?o.call(this):this.commands.leftMove.call(this)},shiftPageup:function(){this._modeIsShiftSel?l.call(this):this.commands.pageup.call(this)},shiftPagedown:function(){this._modeIsShiftSel?s.call(this):this.commands.pagedown.call(this)},shiftHome:function(){this._modeIsShiftSel?r.call(this):this.commands.home.call(this)},shiftEnd:function(){this._modeIsShiftSel?a.call(this):this.commands.end.call(this)}}),this.commands=c},_postBuildView:function(){this._parent(),this._onGutterOrMarginsChange()},_handleEvents:function(){this._parent();this.addEventListener(i.POINTERDOWN,this._onCellPointerDown,!1),this.addEventListener("click",this._onCellClick,!1),this._observeDragAndDropEvents(),this._observeSelMultiSel(),this._observeDoubleClickEvent(),this._observeContextualMenuEvent()},supportsKeyboardNavigation:function(){return!0},getUsedCellPreselectionFeedback:function(){if(void 0===this._usedCellPreselectionFeedback){var e=this.cellPreselectionFeedback;"none"!==e&&(e="cell"),this._usedCellPreselectionFeedback=e}return this._usedCellPreselectionFeedback},supportsSelection:function(){return!0},onPostCellRequest:function(e){this._onPostRequestCellCB=e},getNodesXSO:function(){return this.modelProvider.getNodesXSO()},loadApplicativeModel:function(e){if(e){if(this.applicativeModel===e)return;this.applicativeModel=e,this.TreedocModel=e,this.model=this.modelProvider.flattenApplicativeModel(e),this.model&&this.model.length&&(this.lastSelectedNode=this.model[0],this.activeNode=null),this._addModelEvents()}},unloadApplicativeModel:function(){this._removeModelEvents(),this.activeNode=null,this.applicativeModel=null,this.TreedocModel=null,this.model=[]},loadGridViewModel:function(e){this.loadApplicativeModel(e),e&&(this.TreedocModel=e)},unloadGridViewModel:function(){this.unloadApplicativeModel(),this.TreedocModel=null},requestDelayedModelData:function(e,t){if(this.onDelayedModelDataRequest){var i=this.layout,n=this.getViewportDimensions();if(n.height>0){var o=i._computeMinCellID(),l=o+Math.floor((n.width-this.layout.gutter-this.layout.layoutMargins.marginLeft-this.layout.layoutMargins.marginRight)/(this.layout._getColumnWidth()+this.layout.gutter))*Math.ceil((n.height-this.layout.gutter-this.layout.layoutMargins.marginTop-this.layout.layoutMargins.marginBottom)/(this.layout.getRowHeight()+this.layout.gutter))-1,s=this.getTreeDocument();s&&s.prepareUpdate(),this.onDelayedModelDataRequest({collectionView:this,startNodeIndex:o,endNodeIndex:l,context:e}),s&&s.pushUpdate()}}},pushUpdateView:function(e,t){this.modelProvider&&this.modelProvider._pushUpdateView(e,t)},updateView:function(e){this.modelProvider&&this.modelProvider.updateView(e)},onSelectionAdd:function(e){return this._modelEvents.subscribe({event:"selectionAdded"},e)},onSelectionRemove:function(e){return this._modelEvents.subscribe({event:"selectionRemoved"},e)},onCellDoubleClick:function(e){return this._modelEvents.subscribe({event:"dblclick"},e)},onCellTitleClick:function(e){return this._modelEvents.subscribe({event:"cellTitleClick"},e)},onCellsCopy:function(e){return this._modelEvents.subscribe({event:"copy"},e)},onCellsPaste:function(e){return this._modelEvents.subscribe({event:"paste"},e)},onCellsCut:function(e){return this._modelEvents.subscribe({event:"cut"},e)},onCellsEscape:function(e){return this._modelEvents.subscribe({event:"escapeKeyPressed"},e)},onEnterPressed:function(e){return this._modelEvents.subscribe({event:"enter"},e)},onDeleteKeyPressed:function(e){return this._modelEvents.subscribe({event:"deleteKeyPressed"},e)},onTabKeyPressed:function(e){return this._modelEvents.subscribe({event:"tab"},e)},onf2Pressed:function(e){return this._modelEvents.subscribe({event:"f2"},e)},onInteractiveCumulativeSelectionChanged:function(e){return this._modelEvents.subscribe({event:"interactiveCumulativeSelectionChanged"},e)},selectCell:function(e,t,i){this.keyboardMutePoolrefresh=!0,!0===i&&(this._shiftKeyboardSelection=!0),this._parent(e,t,i),this.keyboardMutePoolrefresh=!1,this._shiftKeyboardSelection=!1,e>=0&&e<this.model.length&&this._setActiveNode(this.model[e],!0),i||(this.lastSelectedNode=this.activeNode)},selectNodeModel:function(e,t,i){if(e){var n=this,o=this.layout;if(i){var l=o.computeCellRange(this.modelProvider.getNodeModelRowID(n.lastSelectedNode,!0),this.modelProvider.getNodeModelRowID(e,!0));if(l){var s=this.getNodesXSO();if(s){var r=[];s.get().forEach(function(t){o.isNodeModelInRange(t,n.modelProvider.getNodeModelRowID(n.lastSelectedNode),n.modelProvider.getNodeModelRowID(e))||r.push(t)}),r.length>0&&s.remove(r);for(var a=[],c=0;c<l.length;c++){(e=this.getNodeModelAt(l[c]))&&!s.isIn(e)&&a.push(e)}a.length>0&&s.add(a)}}}else t?this.modelProvider.selectNode(e):this.modelProvider.selectNode(e,!0)}},selectAllVisibleNodes:function(){if(!0===this.selectionBehavior.canMultiSelect)return this.modelProvider.selectAllVisibleNodes()},unselectAll:function(){return this.modelProvider.unselectAll()},setActiveNode:function(e,t){return this._setActiveNode(e,t)},getLabel:function(e){return this.modelProvider.getPropertyValue(e,"label")},getBadges:function(e){return this.modelProvider.getPropertyValue(e,"badges")},getDisabled:function(e){return this.modelProvider.getPropertyValue(e,"disabled")},getSubLabel:function(e){return this.modelProvider.getPropertyValue(e,"subLabel")},getDescription:function(e){return this.modelProvider.getPropertyValue(e,"description")},getCustomTooltip:function(e){return this.modelProvider.getPropertyValue(e,"customTooltip")},getMultipleTitleLineNumber:function(e){return this.modelProvider.getPropertyValue(e,"multipleTitleLineNumber")},getPropertiesList:function(e){return this.modelProvider.getPropertyValue(e,"propertiesList")},getThumbnail:function(e){return this.modelProvider.getPropertyValue(e,"picture")},getIcon:function(e){return this.modelProvider.getPropertyValue(e,"icon")},getStatusbarIconsTooltips:function(e){return this.modelProvider.getPropertyValue(e,"statusbarIconsTooltips")},getStatusbarIcons:function(e){return this.modelProvider.getPropertyValue(e,"statusbarIcons")},getStatusbarLabelsWidthRatios:function(e){return this.modelProvider.getPropertyValue(e,"statusbarLabelsWidthRatios")},getActiveFlag:function(e){return this.modelProvider.getPropertyValue(e,"activeFlag")},getEmptyStatusbarVisibleFlag:function(e){return this.modelProvider.getPropertyValue(e,"emptyStatusbarVisibleFlag")},getContextualMenu:function(e){return this.modelProvider.getPropertyValue(e,"contextualMenu")},getColor:function(e){return this.modelProvider.getPropertyValue(e,"color")},getClickableTitle:function(e){return this.modelProvider.getPropertyValue(e,"clickableTitle")},_applyCssClassesOnCell:function(e){},_addModelEvents:function(){var e=this;if(!this._modelEventsAlreadyAdded){this._modelEventsAlreadyAdded=!0;var t=this.getNodesXSO();if(t){var i=t.onAdd(function(t){e.modelUISelectionAction=!0,e._modelEvents.publish({event:"selectionAdded",context:t,data:t}),e.activeNode&&e.modelProvider.isNodeSelected(e.activeNode)||e._shiftKeyboardSelection||e._setActiveNode(t)});this._xsoEventsListener.push(i),i=t.onPostAdd(function(t){e._updatePoolSelectedViews(t),e.modelUISelectionAction=!1}),this._xsoEventsListener.push(i),i=t.onRemove(function(t){e.modelUISelectionAction=!0,e._modelEvents.publish({event:"selectionRemoved",context:t,data:t})}),this._xsoEventsListener.push(i),i=t.onPostRemove(function(t){e._updatePoolSelectedViews(t),e.modelUISelectionAction=!1}),this._xsoEventsListener.push(i),this._modelEvents.subscribe({event:"active"},function(t){e._updateAllPoolSelectedViews()})}return this.modelProvider.addModelEvents()}},_removeModelEvents:function(){this._modelEventsAlreadyAdded=!1;var e=this.getNodesXSO();if(e){for(var t=0;t<this._xsoEventsListener.length;t++)e.unsubscribe(this._xsoEventsListener[t]);this._xsoEventsListener.splice(0,this._xsoEventsListener.length)}return this.modelProvider.removeModelEvents()},_observeSelMultiSel:function(){var t=this;t._isInteractiveMultiSelMode=!1,t._modeIsMultiSel=!1,t._modeIsShiftSel=!1,e.Element.addEvent.call(document,"keydown",function(i){var n=e.Event.whichKey(i);!t.selectionBehavior.enableShiftSelection||"shift"!==n&&"meta+["!==n?!t.selectionBehavior.canMultiSelect||"ctrl"!==n&&"meta+["!==n||(t._modeIsMultiSel=!0):t._modeIsShiftSel=!0,"ctrl+pageup"!==n&&"ctrl+pagedown"!==n||i.preventDefault()}),e.Element.addEvent.call(document,"keyup",function(i){var n=e.Event.whichKey(i);"ctrl"!==n&&"meta+["!==n||(t._modeIsMultiSel=!1),"shift"!==n&&"meta+["!==n||(t._modeIsShiftSel=!1)})},_observeDoubleClickEvent:function(){var e=this;e.elements.container.addEventListener(i.POINTERHIT,function(t){if(2===t.multipleHitCount){var i=e._firstParentWithClass(t.target,"wux-layouts-collectionview-cell");if(1===t.which&&i){var n=e.getCellInfosFromHtmlElement(i);n.event=t,void 0!==n.cellModel&&e._modelEvents.publish({event:"dblclick",context:n.cellModel,data:n})}}})},_observeContextualMenuEvent:function(){var e=this,t=e.onContextualEvent;t&&n.addEventListener(this.elements.container,{callback:function(i){var n=Boolean(e._cellCtxMenuRequired);return e._cellCtxMenuRequired=!1,n?[]:t.callback.call(t.this,{context:i.context,infos:i.info,data:i.data,cellInfos:void 0,infoContext:i.context})}})},_firstParentWithClass:function(e,t){var i=e;return i?(" "+i.className+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1?i:this._firstParentWithClass(i.parentNode,t):void 0},_onCellClickForTouchOrPointerDownForMouse:function(e,t,n){e._cellUISelectionAction=!0;var o=e.getNodesXSO();if(o)if(t&&t.cellView){if(e._needToSelectAtRelease=!1,e._pointerDownOnBlank=!1,e.getDisabled(t.nodeModel))return e._isInMultiSelection()||e._modeIsShiftSel||o.empty(),e._setActiveNode(t.cellModel,!0),e._modeIsShiftSel||(e.lastSelectedNode=t.cellModel),void(e._cellUISelectionAction=!1);if(e.modelProvider.isNodeSelected(t.cellModel)&&!e._modeIsShiftSel){if(!i.isTouchEvent(n))return e._needToSelectAtRelease=!0,void(e._cellUISelectionAction=!1);e.selectionBehavior.toggle&&e.modelProvider.unSelectNode(t.cellModel),e._cellUISelectionAction=!1}else e._isInMultiSelection()||e._modeIsShiftSel||o.empty(),e.modelProvider.selectNode(t.cellModel),e._setActiveNode(t.cellModel,!1),e._modeIsShiftSel||(e.lastSelectedNode=t.cellModel),e._cellUISelectionAction=!1;if(e._modeIsShiftSel){e._cellUISelectionAction=!0,e._shiftKeyboardSelection=!0,o.empty();var l=e.lastSelectedNode,s=t.cellModel;if(l&&s){var r=e.modelProvider.getNodeModelRowID(l,!0),a=e.modelProvider.getNodeModelRowID(s,!0),c=a>r?r:a,h=c===r?a:r,u=e.model,d=0,g=[];for(d=c;d<=h;d++){var p=u[d];!e.modelProvider.isNodeVisible(p)||e.modelProvider.isNodeSelected(p)||e.getDisabled(p)||g.push(p)}o.add(g),e._setActiveNode(t.cellModel,!1)}e._shiftKeyboardSelection=!1,e._cellUISelectionAction=!1}}else e._cellUISelectionAction=!1,e._pointerDownOnBlank=!0,i.isTouchEvent(n)&&e._onClickOnEmptyArea(e,n)},_onCellPointerDown:function(e,t){var n=e.dsModel;if(n.getNodesXSO())return i.isTouchEvent(e)||n.selectionBehavior&&n.selectionBehavior.selectOnPointerUp?void 0:n._onCellClickForTouchOrPointerDownForMouse(n,t,e)},_onClickOnEmptyArea:function(e,t){var i=e.getNodesXSO();if(i&&!0===e.selectionBehavior.unselectAllOnEmptyArea){e._cellUISelectionAction=!0;var n=e.getViewportDimensions(),o=e.layout.getContentDimensions(),l=0;t.target===e.elements.scroller.getContent()&&("vertical"===e.layout.direction?l=n.height<o.height?18:0:"horizontal"===e.layout.direction&&(l=n.width<o.width?18:0));var s=Math.max(o.width,n.width-l),r=Math.max(o.height,n.height-l);t.offsetX<s&&t.offsetY<r&&(e._disableInteractiveMultiSelMode(),i.empty(),e._updatePoolSelectedViews()),e._cellUISelectionAction=!1}},_onCellClick:function(e,t){var n=e.dsModel,o=n.getNodesXSO();if(o)return i.isTouchEvent(e)||n.selectionBehavior&&n.selectionBehavior.selectOnPointerUp?n._onCellClickForTouchOrPointerDownForMouse(n,t,e):void(t&&t.cellView?(n._cellUISelectionAction=!0,n._pointerDownOnBlank=!1,!0===n._needToSelectAtRelease&&(!1===n._isInMultiSelection()?(o.empty(),n.selectionBehavior.toggle?n._setActiveNode(t.cellModel,!0):(n.modelProvider.selectNode(t.cellModel),n.lastSelectedNode=t.cellModel,n._setActiveNode(t.cellModel,!1))):n.selectionBehavior.toggle&&n.modelProvider.unSelectNode(t.cellModel)),n._cellUISelectionAction=!1,n._needToSelectAtRelease=!1):(n._pointerDownOnBlank&&n._onClickOnEmptyArea(n,e),n._pointerDownOnBlank=!1))},_isInMultiSelection:function(){return this._modeIsMultiSel||this._isInteractiveMultiSelMode},_getNewActiveNodeInfos:function(e,t){for(var i=this,n=i.modelProvider.getNodeModelRowID(e,!0),o=n+t,l=0!==t?void 0:e,s=Math.ceil(i.model.length/i.layout._numberOfColumns),r=Math.ceil((n+1)/i.layout._numberOfColumns),a=i.layout._numberOfColumns===t&&s===r||-i.layout._numberOfColumns===t&&1===r;0!==t&&(l=o<i.model.length?i.model[o]:void 0,!a)&&!l;)t>0?(t--,o--):(t++,o++);return{index:o,node:l}},_onCellTitleClick:function(e){this._modelEvents.publish({event:"cellTitleClick",context:e,data:e})},_computeIncrementToMove:function(e){var t=this,i=t.activeNode?t.activeNode:t.lastSelectedNode;if(i){var n=t.modelProvider.getNodeModelRowID(i,!0),o=t.getScrollerPosition(),l=t._getScroller().getContent().getDimensions(),s=o.y,r=o.x;if("vertical"===t.layout.direction)var a=Math.round(l.height/(t.layout.getRowHeight()+t.layout.gutter)),c=t.layout._numberOfColumns;else if("horizontal"===t.layout.direction)a=t.layout._numberOfRows,c=Math.round(l.width/(t.layout._columnWidth+t.layout.gutter));var h=0,u=0,d=0,g=1,p=0;if("vertical"===t.layout.direction?(u=(n-n%t.layout._numberOfColumns)*(t.layout.getRowHeight()+t.layout.gutter)/t.layout._numberOfColumns-s,d=Math.round(u/(t.layout.getRowHeight()+t.layout.gutter))):"horizontal"===t.layout.direction&&(u=(n-n%t.layout._numberOfRows)*(t.layout._columnWidth+t.layout.gutter)/t.layout._numberOfRows-r,d=Math.round(u/(t.layout._columnWidth+t.layout.gutter))),"up"===e){if("vertical"===t.layout.direction)return-c;if("horizontal"===t.layout.direction)return-1}else if("right"===e){if("vertical"===t.layout.direction)return 1;if("horizontal"===t.layout.direction)return a}else if("down"===e){if("vertical"===t.layout.direction)return c;if("horizontal"===t.layout.direction)return 1}else if("left"===e){if("vertical"===t.layout.direction)return-1;if("horizontal"===t.layout.direction)return-a}else{if("home"===e)return-n;if("end"===e)return t.model.length-1-n;if("pageup"===e){if("vertical"===t.layout.direction){if(0===(h=-d*t.layout._numberOfColumns)){for(g=1,p=0,g=1;g<=a-1;g++)if(p=g,n-t.layout._numberOfColumns*g<0){p--;break}h=-t.layout._numberOfColumns*p}}else if("horizontal"===t.layout.direction&&0===(h=-d*t.layout._numberOfRows)){for(g=1,p=0,g=1;g<=c-1;g++)if(p=g,n-t.layout._numberOfRows*g<0){p--;break}h=-t.layout._numberOfRows*p}return h}if("pagedown"===e){if("vertical"===t.layout.direction){if(0===(h=(a-d-1)*t.layout._numberOfColumns)){for(g=1,p=0,g=1;g<=a-1;g++)if(p=g,n+t.layout._numberOfColumns*g>=t.model.length){p--;break}0===(h=t.layout._numberOfColumns*p)&&(t.model.length-1)%t.layout._numberOfColumns<n%t.layout._numberOfColumns&&(h=t.layout._numberOfColumns)}}else if("horizontal"===t.layout.direction&&0===(h=(c-d-1)*a)){for(g=1,p=0,g=1;g<=c-1;g++)if(p=g,n+t.layout._numberOfRows*g>=t.model.length){p--;break}h=t.layout._numberOfRows*p}return h}}}return 0},computeCellIDFromActiveCell:function(e,t,i){var n=this,o=-1,l=(this.modelProvider.getNodeModelRowID(this.lastSelectedNode,!0),n.activeNode?n.activeNode:n.lastSelectedNode);if(l){var s=n._computeIncrementToMove(e),r=n._getNewActiveNodeInfos(l,s);r.node&&(o=r.index)}return o},_setActiveNode:function(e,t){if(this.activeNode!==e){this.activeNode=e;var i=-1;if(e){if(!((i=this.modelProvider.getNodeModelRowID(e,!0))<this.model.length))return;this.setActiveCell(i)}!0===t&&this.selectionBehavior.enableFeedbackForActiveCell&&this._modelEvents.publish({event:"active",context:e})}},setActiveCell:function(e){if(-1!==e){this._parent(e);var t=this.getNodeModelAt(e);this._setActiveNode(t,!0)}},isCellHighlighted:function(e){let t=e.cellID>=0?this.getCellInfosAt(e.cellID):e;return!(!t.nodeModel||!t.nodeModel.isHighlighted)&&t.nodeModel.isHighlighted()},_updatePoolSelectedViews:function(t){this._processPoolCells(function(i){var n=i.cellView.component.collectionView,o=i.cellView.component;if(o){var l=n.getCellInfosFromHtmlElement(o.elements.container);if(l){var s=l.cellModel;if(void 0!==s){e.is(t,"array")?-1!==t.indexOf(s)&&!0:s===t&&!0,this.selectionBehavior.enableFeedbackForActiveCell&&(s===this.activeNode?o.contentView.activate():o.contentView.deactivate()),this._applyAttributesOnCell(l),this.modelProvider.isNodeSelected(s)?o.contentView.highlight():o.contentView.unhighlight()}}}})},_updateAllPoolSelectedViews:function(){this._processPoolCells(function(e){var t=e.cellView.component.collectionView,i=e.cellView.component;if(i){var n=t.getCellInfosFromHtmlElement(i.elements.container);if(n){var o=n.cellModel;void 0!==o&&(this.selectionBehavior.enableFeedbackForActiveCell&&(o===this.activeNode?i.contentView.activate():i.contentView.deactivate()),this._applyAttributesOnCell(n),t.modelProvider.isNodeSelected(o)?i.contentView.highlight():i.contentView.unhighlight())}}})},_observeDragAndDropEvents:function(){this.elements.container.addEvent("dragstart",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("drop",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("dragover",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("drag",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("dragend",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("dragleave",this._processDragAndDropCallback.bind(this)),this.elements.container.addEvent("dragenter",this._processDragAndDropCallback.bind(this))},_processDragAndDropCallback:function(e){var t=this,i=this._firstParentWithClass(e.target,"wux-layouts-collectionview-cell"),n={dragstart:"onDragStart",dragend:"onDragEnd",dragenter:"onDragEnter",dragleave:"onDragLeave",drag:"onDrag",dragover:"onDragOver",drop:"onDrop"}[e.type],o=i?t.getCellInfosFromHtmlElement(i):{manager:this};if(i){let t=function(e,t){let i;if(t.cellView){const n=t.cellView.getContent().getBoundingClientRect();i=e.clientX<n.left+n.width/10?"left":e.clientX>=n.left+9*n.width/10?"right":"middle"}return i}(e,o);o.dropPosition=t}function l(i,n){var l=!1,s=t[i+n];s?(l=s.call(o.manager,e,o),r&&"onDragOver"!==i&&console.info("[dnd]",i+n,">",l,e.target)):r&&console.warn("[dnd]","cannot find",i+n,"callback");var a=t[i+n+"Default"];a&&(void 0===s||s&&l)&&(r&&(s&&l?console.info("\t>[dnd]","dev want to continue to the default behavior for ",i+n," callback"):console.info("\t>[dnd]","use the default behavior for ",i+n," callback")),a.call(o.manager,e,o))}o.cellView?(this._isOverBlank(e,o)&&e.type,l(n,"Cell")):l(n,"Blank")},_isOverBlank:function(e,t){let i=!0;if(t.cellView){const n=t.cellView.getContent().getBoundingClientRect();e.clientX<n.left||e.clientX>n.left+n.width||e.clientY<n.top||e.clientY>n.top+n.height||(i=!1)}return i},_hideDndFeedbacks:function(){this&&this._dnDInfos&&this._dnDInfos.elements&&this._dnDInfos.elements.dndFeeback&&this._dnDInfos.elements.dndFeeback.hide()},_showDndFeedbacks:function(t,i){if(!this||void 0===i.cellID)return;this._dnDInfos||(this._dnDInfos={elements:{dndFeeback:null},dropAccepted:!1}),this._dnDInfos.elements.dndFeeback||(this._dnDInfos.elements.dndFeeback=new e.Element("div",{class:"wux-layouts-responsivecollectionview-drag-item-feedback"}),this._dnDInfos.elements.dndFeeback.inject(this.getContent()));const n=this.layout,o=this.elements.container.getBoundingClientRect(),s=i.cellView.getContent().getBoundingClientRect();let r,a=i.dropPosition,c=s.height,h=-o.top+s.top,u=-o.left+s.left;"left"===a?(h+=-1-n.gutter/2+1,u+=-1-n.gutter/2,c+=n.gutter,r=2):"right"===a?(h+=-1-n.gutter/2+1,u+=-1+s.width+n.gutter/2,c+=n.gutter,r=2):r=s.width;let d=!0;const g=this.getTreeDocument();g&&g.options&&"function"==typeof g.options.shouldAcceptDrop&&(d=g.options.shouldAcceptDrop(i)),this._dnDInfos.elements.dndFeeback.setStyles({display:"block",left:u,top:h,width:r,height:c,border:"none",background:d?l.COLORS_3DEXPERIENCE.COLOR_DARK_BLUE:l.COLORS_3DEXPERIENCE.COLOR_DARK_RED})},_onGutterOrMarginsChange:function(){var e=this.layout.layoutMargins.marginLeft+this.layout.gutter+this.getCellViewMinWidth()+this.layout.gutter+this.layout.layoutMargins.marginRight;this.getContent().style.minWidth=e.toString()+"px"},_updateModel:function(){if(this.modelProvider){let e=this._getCurrentPaginationOptions(),t=this.modelProvider.flattenApplicativeModel(this.applicativeModel),i=[];if(t){if(e){let n=e.nodeMax-e.nodeMin+1;for(let o=e.nodeMin;o<t.length&&(t[o]&&t[o].isVisible()&&i.push(t[o]),i.length!==n);o++);}else i=t;this.model=i,this.invalidateLayout({updateCellContent:!0})}}},_getCurrentPaginationOptions:function(){var e;if(this.paginationManager){e={};var t=this.paginationManager.pageSize;e.nodeMin=(this.paginationManager.currentPage-1)*t,e.nodeMax=e.nodeMin+t-1,e.currentPage=this.paginationManager.currentPage,e.pageSize=t}return e},getModelLength:function(){if(this._getCurrentPaginationOptions()){if(this._onPaginationChangeAsyncLoadModelCB)return this._asyncPaginationInitialized?this.getWholeModelLengthForAsyncPagination():0;{let e=[];return this.modelProvider&&(e=this.modelProvider.flattenApplicativeModel(this.applicativeModel)),e.length}}return this._parent()},_hasUniformRowHeight:function(){return!0},_getCellValueAsStringForFind:function(e){let t=e.nodeModel;const i=this.allowUnsafeHTMLContent?s.extractTextContentsFromHTMLString(this.getLabel(t)):this.getLabel(t),n=this.allowUnsafeHTMLContent?s.extractTextContentsFromHTMLString(this.getSubLabel(t)):this.getSubLabel(t),o=this.allowUnsafeHTMLContent?s.extractTextContentsFromHTMLString(this.getDescription(t)):this.getDescription(t);let l=this.getStatusbarIcons(t)||[],r=[];for(let e=0;e<l.length;e++){const t=l[e]&&l[e].label;t&&r.push(this.allowUnsafeHTMLContent?s.extractTextContentsFromHTMLString(t):t)}return i+"Â¨"+n+"Â¨"+o+"Â¨"+r.join("Â¨")}})}),define("DS/CollectionView/ResponsiveTilesCollectionView",["DS/CollectionView/ResponsiveCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Controls/ResponsiveTileView"],function(e,t,i){"use strict";var n=t.inherit({name:"ResponsiveTilesCollectionViewLayout",isNodeModelInRange:function(e,t,i){return this.collectionView.modelProvider.isNodeModelInRange(e,t,i)},getRowHeight:function(){var e=this.collectionView._getPictureHeight();return-1===this.collectionView._displayedOptionalCellProperties.indexOf("All")&&-1===this.collectionView._displayedOptionalCellProperties.indexOf("statusbarIcons")||(e+=this.collectionView._getStatusbarHeight()),e},getContentDimensions:function(){var e=this._parent();return e.width=e.width-2,e}});return e.inherit({name:"ResponsiveTilesCollectionView",publishedProperties:{allowLargeItems:{defaultValue:!1,type:"boolean"}},_applyProperties:function(e){this._parent(e),this.isDirty("allowLargeItems")&&this._applyAllowLargeItems(e.allowLargeItems)},_applyAllowLargeItems:function(e){this.allowLargeItems?(this.cellStyleOverload="wux-cell-responsivetile-large-allow",this.elements.container.addClassName("wux-layout-largetilecollectionView")):(this.cellStyleOverload="wux-cell-responsivetile",this.elements.container.removeClassName("wux-layout-largetilecollectionView")),this.invalidateLayout()},_preBuildView:function(e){this._properties.layout.value||(this._properties.layout.value=new n({columnMaxWidth:540,gutter:10})),this._parent(e)},_postBuildView:function(){this.cellClassForView=i,this._parent();var e=this,t=this;e.registerReusableCellContent({id:"Tile",buildContent:function(){var i=new e.cellClassForView({layoutingCollection:t});return t._onEndResize(function(){this._processPoolCells(function(e){e.cellView.component.collectionView;var t=e.cellView.component.contentView;t&&(t._onTileResize(),this._updateHighlight(t.cellInfos))})}),i}}),e.onCellRequest(function(t){var i=e.reuseCellContent("Tile");t.cellView.collectionView=e,t.cellView.contentView=i,i.cellInfos=t,i.unPrehighlight(),!0===e.useDragAndDrop?t.cellView.elements.container.setAttribute("draggable","true"):t.cellView.elements.container.setAttribute("draggable","false"),t.cellView.elements.container.dsView=t.cellView,t.cellView.getContent().addClassName(e.cellStyleOverload),i.getContent().setStyles({width:"100%",height:"100%"});var n=t.cellModel,o=[],l=e.getBadges(n);if(l&&(l.topRight&&o.push(l.topRight),l.bottomRight&&o.push(l.bottomRight)),e.displayedOptionalCellProperties[0]==["All"])i.setProperties({title:e.getLabel(n),customTooltip:e.getCustomTooltip(n),clickableTitle:e.getClickableTitle(n),multipleTitleLineNumber:e.getMultipleTitleLineNumber(n),subtitle:e.getSubLabel(n),description:e.getDescription(n),propertiesList:e.getPropertiesList(n),picture:e.getThumbnail(n),icon:e.getIcon(n),emptyStatusbarVisibleFlag:e.getEmptyStatusbarVisibleFlag(n),statusbarIconsTooltips:e.getStatusbarIconsTooltips(n),activeFlag:e.getActiveFlag(n),statusbarIcons:e.getStatusbarIcons(n),statusbarLabelsWidthRatios:e.getStatusbarLabelsWidthRatios(n),badges:o,contextualMenu:e.getContextualMenu(n),color:e.getColor(n),disabled:e.getDisabled(n)});else if(e.displayedOptionalCellProperties[0]==["None"])i.setProperties({title:e.getLabel(n),customTooltip:e.getCustomTooltip(n),clickableTitle:e.getClickableTitle(n),multipleTitleLineNumber:e.getMultipleTitleLineNumber(n),subtitle:e.getSubLabel(n),picture:e.getThumbnail(n),icon:e.getIcon(n),badges:void 0,description:void 0,propertiesList:void 0,activeFlag:void 0,contextualMenu:void 0,emptyStatusbarVisibleFlag:!1,statusbarIcons:void 0,statusbarIconsTooltips:e.getStatusbarIconsTooltips(n),color:e.getColor(n),disabled:e.getDisabled(n)});else{var s=-1!==e._displayedOptionalCellProperties.indexOf("statusbarIcons"),r={title:e.getLabel(n),customTooltip:e.getCustomTooltip(n),clickableTitle:e.getClickableTitle(n),multipleTitleLineNumber:e.getMultipleTitleLineNumber(n),subtitle:e.getSubLabel(n),picture:e.getThumbnail(n),icon:e.getIcon(n),emptyStatusbarVisibleFlag:!!s&&e.getEmptyStatusbarVisibleFlag(n),badges:s?o:void 0,statusbarIcons:s?e.getStatusbarIcons(n):void 0,statusbarLabelsWidthRatios:e.getStatusbarLabelsWidthRatios(n),statusbarIconsTooltips:e.getStatusbarIconsTooltips(n),color:e.getColor(n),disabled:e.getDisabled(n)};r.description=-1!==e._displayedOptionalCellProperties.indexOf("description")?e.getDescription(n):void 0,r.propertiesList=-1!==e._displayedOptionalCellProperties.indexOf("propertiesList")?e.getPropertiesList(n):void 0,r.activeFlag=-1!==e._displayedOptionalCellProperties.indexOf("activeFlag")?e.getActiveFlag(n):void 0,r.contextualMenu=-1!==e._displayedOptionalCellProperties.indexOf("contextualMenu")?e.getContextualMenu(n):void 0,i.setProperties(r)}t.cellView._setReusableContent(i),this.selectionBehavior.enableFeedbackForActiveCell&&(n===this.activeNode?i.activate():i.deactivate()),this.modelProvider.isNodeSelected(n)?i.highlight():i.unhighlight(),this._updateHighlight(t),e._onPostRequestCellCB&&e._onPostRequestCellCB.call(e,t)})},_getPictureHeight:function(){return 70},_getStatusbarHeight:function(){return 28},activateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelectionByAPI=!0,this._enableInteractiveMultiSelMode(),this._interactiveCumulativeSelectionByAPI=!1},isInInteractiveCumulativeSelectionFlag:function(){return this._interactiveCumulativeSelection},deactivateInteractiveCumulativeSelection:function(){this._disableInteractiveMultiSelMode()},_enableInteractiveMultiSelMode:function(){!this.selectionBehavior.canInteractiveMultiselectWithCheckboxClick&&!0!==this._interactiveCumulativeSelectionByAPI||-1!==this.elements.container.className.indexOf("wux-multiselmode-responsivetilecollectionView")||!1===this._isInteractiveMultiSelMode&&(this._isInteractiveMultiSelMode=!0,this.elements.container.addClassName("wux-multiselmode-responsivetilecollectionView"),this._interactiveCumulativeSelection=!0,this._modelEvents.publish({event:"interactiveCumulativeSelectionChanged",data:{responsiveCollectionView:this,cumulativeSelection:!0}}))},_disableInteractiveMultiSelMode:function(){this.elements.container.className.indexOf("wux-multiselmode-responsivetilecollectionView")&&!0===this._isInteractiveMultiSelMode&&(this._isInteractiveMultiSelMode=!1,this.elements.container.removeClassName("wux-multiselmode-responsivetilecollectionView"),this._interactiveCumulativeSelection=!1,this._modelEvents.publish({event:"interactiveCumulativeSelectionChanged",data:{responsiveCollectionView:this,cumulativeSelection:!1}}))},getCellViewMinWidth:function(){return 260},getCellViewMinHeight:function(){}})}),define("DS/CollectionView/ResponsiveLargeTextualTilesCollectionView",["DS/Utilities/Utils","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Controls/ResponsiveTextualTileView"],function(e,t,i,n){"use strict";var o=i.inherit({name:"ResponsiveLargeTextualTilesCollectionViewLayout",sideGutter:60,isNodeModelInRange:function(e,t,i){return this.collectionView.modelProvider.isNodeModelInRange(e,t,i)},getRowHeight:function(){var e=130;return-1===this.collectionView._displayedOptionalCellProperties.indexOf("All")&&-1===this.collectionView._displayedOptionalCellProperties.indexOf("statusbarIcons")||(e+=16),e},prepareLayout:function(){var e=this.collectionView.getViewportDimensions(!0);e.width<640?this.sideGutter=this.collectionView.sideGutter.small:this.sideGutter=this.collectionView.sideGutter.big,this._numberOfColumns=1;var t=this._getRowHeightInPixel(e),i=(e.height-this.gutter-this.layoutMargins.marginTop-this.layoutMargins.marginBottom)/(t+this.gutter);this._numberOfRows=Math.max(Math.floor(i),1);var n=function(){this._columnWidth=Math.floor(e.width-2*this.sideGutter-this.layoutMargins.marginLeft-this.layoutMargins.marginRight),this.useDynamicRowHeight?this._rowHeight=Math.floor((e.height-(this._numberOfRows+1)*this.gutter-this.layoutMargins.marginTop-this.layoutMargins.marginBottom)/this._numberOfRows):this._rowHeight=Math.floor(t);var i=!1;this._rowHeight>this.rowMaxHeight&&(this._numberOfRows++,i=!0),i&&n.call(this)};n.call(this),this._parent()},_getPositionForCellAt:function(e){var t=this.getCellCoordinatesAt(e);return{left:this.sideGutter+this.layoutMargins.marginLeft,top:t.rowID*(this.getRowHeight()+this.gutter)+this.gutter+this.layoutMargins.marginTop}},_getColumnMaxWidthInPixel:function(e){var t;switch(typeof this.columnMaxWidth){case"string":var i=parseFloat(this.columnMaxWidth);t=Math.round((e.width-this.sideGutter-this.layoutMargins.marginLeft)/100*i);break;case"number":t=this.columnMaxWidth;break;case"object":t=responsiveMap(this,e.width,this.columnMaxWidth)}return t},_getColumnPosition:function(e){return e*(this._getColumnWidth()+this.sideGutter)+this.sideGutter+this.layoutMargins.marginLeft},getContentDimensions:function(){var t=this.collectionView.getViewportDimensions(),i=this.collectionView.model.length-1,n=this.getPositionForCellAt(i),o=this.getDimensionsForCellAt(i),l={height:n.top+this.gutter+o.height+this.gutter+this.layoutMargins.marginBottom,width:n.left+this.sideGutter+o.width+this.sideGutter+this.layoutMargins.marginRight-2},s=e.getScrollbarWidth();if("vertical"===this.direction)return{width:l.height>t.height?t.width-s:t.width,height:l.height};var r=l.width>t.width?t.height-s:t.height;return{width:l.width,height:r}},_computeMinCellID:function(){var e=0,t=this.collectionView.getViewportDimensions(),i=this.collectionView.getScrollerPosition();return e="vertical"===this.direction?Math.max(Math.floor((i.y-this.layoutMargins.marginTop)/(this.getRowHeight()+this.gutter)),0)*Math.floor((t.width-this.layoutMargins.marginLeft-this.layoutMargins.marginRight)/(this._getColumnWidth()+this.sideGutter)):Math.max(Math.floor((i.x-this.layoutMargins.marginLeft)/(this._getColumnWidth()+this.sideGutter)),0)*Math.floor((t.height-this.layoutMargins.marginTop-this.layoutMargins.marginBottom)/(this.getRowHeight()+this.gutter)),e=Math.min(e,this.collectionView.model.length-1)}});return t.inherit({name:"ResponsiveLargeTextualTilesCollectionView",publishedProperties:{layout:{defaultValue:null,type:"object"},height:{defaultValue:"inherit",type:"integer"},sideGutter:{defaultValue:{small:10,big:60},type:"object"}},_preBuildView:function(e){this._properties.layout.value||(this._properties.layout.value=new o({columnMaxWidth:"100%",gutter:10})),this._parent(e)},_postBuildView:function(){this._parent(),this.cellClassForView=n,this.cellStyleOverload="wux-cell-responsivelargetile",this.elements.container.addClassName("wux-layout-largetilecollectionView")}})}),define("DS/CollectionView/ResponsiveLargeTilesCollectionView",["UWA/Drivers/Alone","DS/CollectionView/ResponsiveTilesCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Utilities/Color"],function(e,t,i,n){"use strict";var o=i.inherit({name:"ResponsiveLargeTilesCollectionViewLayout",isNodeModelInRange:function(e,t,i){return this.collectionView.modelProvider.isNodeModelInRange(e,t,i)},getRowHeight:function(){var e=70;return-1===this.collectionView._displayedOptionalCellProperties.indexOf("All")&&-1===this.collectionView._displayedOptionalCellProperties.indexOf("statusbarIcons")||(e+=20),e},getContentDimensions:function(){var e=this._parent();return e.width=e.width-2,e}});return t.inherit({name:"ResponsiveLargeTilesCollectionView",publishedProperties:{layout:{defaultValue:null,type:"object"},height:{defaultValue:"inherit",type:"integer"}},_preBuildView:function(e){this._properties.layout.value||(this._properties.layout.value=new o({columnMaxWidth:"100%",gutter:10})),this._parent(e)},_postBuildView:function(){this._parent(),this.cellStyleOverload="wux-cell-responsivelargetile",this.elements.container.addClassName("wux-layout-largetilecollectionView")},_showDndFeedbacks:function(t,i){if(!this||void 0===i.cellID)return;this._dnDInfos||(this._dnDInfos={elements:{dndFeeback:null},dropAccepted:!1}),this._dnDInfos.elements.dndFeeback||(this._dnDInfos.elements.dndFeeback=new e.Element("div",{class:"wux-layouts-responsivecollectionview-drag-item-feedback"}),this._dnDInfos.elements.dndFeeback.inject(this.getContent()));const o=this.layout,l=this.elements.container.getBoundingClientRect(),s=i.cellView.getContent().getBoundingClientRect();let r,a;i.cellView&&(r=t.clientY<s.top+s.height/10?"top":t.clientY>=s.top+9*s.height/10?"bottom":"middle");let c=s.width,h=-l.left+s.left,u=-l.top+s.top;"top"===r?(h+=-1-o.gutter/2+1,u+=-1-o.gutter/2,c+=o.gutter,a=2):"bottom"===r?(h+=-1-o.gutter/2+1,u+=-1+s.height+o.gutter/2,c+=o.gutter,a=2):a=s.height;let d=!0;const g=this.getTreeDocument();g&&g.options&&"function"==typeof g.options.shouldAcceptDrop&&(d=g.options.shouldAcceptDrop(i)),this._dnDInfos.elements.dndFeeback.setStyles({display:"block",left:h,top:u,width:c,height:a,border:"none",background:d?n.COLORS_3DEXPERIENCE.COLOR_DARK_BLUE:n.COLORS_3DEXPERIENCE.COLOR_DARK_RED})}})});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/CollectionView/modelProviders/IconChooserTreeDocumentModelProvider",["require","exports","DS/CollectionView/modelProviders/IconChooserBaseModelProvider"],function(e,t,i){"use strict";return function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return e.apply(this,t)||this}return __extends(t,e),t.prototype.addModelEvents=function(e){var t=this;if(e){var i=0,n=e.addModelEventListener("prepareUpdate",function(e){i++});this.modelEventsListener.push(n),n=e.addModelEventListener("pushUpdate",function(e){--i<0&&console.error("You pushed too many updates"),0===i&&t.iconChooser.updateView()}),this.modelEventsListener.push(n),n=e.onNodeModelUpdate(function(e){0===i&&t.iconChooser.updateView()}),this.modelEventsListener.push(n)}},t.prototype.flattenModel=function(e){return e?e.getAllDescendants():[]},t.prototype.getIconDefinition=function(e){return e.options&&e.options.icon?e.options.icon:""},t.prototype.getTooltip=function(e){return e.options.description?e.options.description:null},t.prototype.removeModelEvents=function(e){if(e&&e.getModelEvents()){for(var t=0;t<this.modelEventsListener.length;t++)e.getModelEvents().unsubscribe(this.modelEventsListener[t]);this.modelEventsListener.splice(0,this.modelEventsListener.length)}},t.prototype.areItemsEquals=function(e,t){return e._getID()===t._getID()},t}(i)});__extends=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();define("DS/CollectionView/IconChooser",["require","exports","UWA/Core","DS/Controls/Abstract","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Core/WebUXComponents","DS/TreeModel/TreeDocument","DS/Utilities/WUXUWAUtils","DS/Controls/Button","DS/Controls/Popup","DS/CollectionView/CollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Tweakers/GeneratedToolbar","DS/CollectionView/CollectionViewCell","DS/Tweakers/TypeRepresentationFactory","DS/CollectionView/modelProviders/IconChooserBaseModelProvider","DS/CollectionView/modelProviders/IconChooserTreeDocumentModelProvider","DS/Controls/TooltipModel","DS/Core/WebUXGlobalEnums"],function(e,t,i,n,o,l,s,r,a,c,h,u,d,g,p,f,m,C,v){"use strict";function _(e){if(!e.disabled)if(e._isDropped())e.elements.popup.visibleFlag=!1,e.elements.container.removeAttribute("active");else{e._showPopup(),e.elements.gridView._isReady&&e.elements.popup.focus();var t=e.elements.gridView.getCellsXSO();if(t){var i=t.get();i&&i.length&&e.elements.gridView.onPostUpdateViewOnce(function(){e.elements.gridView.ensureCellVisible(i[0])})}}}function w(e){var t=e.elements.gridView.getActiveCellID();t>-1&&e.elements.gridView.selectCell(t),e.elements.button.focus(),!0===e.elements.button.checkFlag&&e.elements.container.removeAttribute("active"),e.elements.container.setAttribute("fakefocus",!0)}var y=function(e){function t(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return a.extendingClassFlag,n}return __extends(t,e),Object.defineProperty(t,"publishedProperties",{get:function(){return{value:{defaultValue:void 0,type:"string",category:"Behavior"},gridViewModel:{defaultValue:[],type:"array",category:"Behavior"},iconSize:{defaultValue:void 0,type:"string",category:"Appearance"},headerModel:{defaultValue:[],type:"array",category:"Behavior"},filterValue:{defaultValue:void 0,type:"string",category:"Behavior"},flyoutDirection:{defaultValue:"right",type:"string",category:"Appearance"},columnMaxCount:{defaultValue:5,type:"number",category:"Appearance"},rowMaxCount:{defaultValue:5,type:"number",category:"Appearance"},buildItemView:{defaultValue:function(e){return this.buildDefaultItemView(e)},type:"function"},buildValueItem:{defaultValue:function(e){return this.buildDefaultValueItemView(e)},type:"function"},onItemSelected:{defaultValue:void 0,type:"function",category:"Behavior"},onFilterChanged:{defaultValue:void 0,type:"function",category:"Behavior"},getTooltip:{defaultValue:function(e){return this.getDefaultTooltip(e)},type:"function"},modelProvider:{defaultValue:null,type:"object"},actionOnClickFlag:{defaultValue:!1,type:"boolean",category:"Behavior"},getHeaderIconName:{defaultValue:function(e){return this.getHeaderDefaultIconName(e)},type:"function"},getHeaderTooltip:{defaultValue:function(e){return this.getHeaderDefaultTooltip(e)},type:"function"},getScrollbarWidth:{defaultValue:function(){return i.Utils.Client.getScrollbarWidth()},type:"function"}}},enumerable:!1,configurable:!0}),t.prototype._preBuildView=function(t){this.elements.container=new i.Element("div",{class:"wux-controls-iconchooser",tabindex:0}),e.prototype._preBuildView.call(this,t)},t.prototype.buildView=function(){e.prototype.buildView.call(this);var t=this;this.elements.currentElement=new i.Element("div",{class:"wux-controls-iconchooser-current-element"}),l.addEventOnElement(this,this.elements.currentElement,"click",function(e){t.actionOnClickFlag?(t.elements.popup&&(t.elements.popup.visibleFlag=!1),e.dsModel=t,t.elements.button.checkFlag=!0,t.elements.container.setAttribute("active",!0)):(e.stopPropagation(),_(t),t.elements.button.checkFlag?t.elements.button.checkFlag=!1:t.elements.button.checkFlag=!0)}),this.elements.currentElement.inject(this.elements.container),this.elements.button=new c({icon:{iconName:"expand-down",fontIconFamily:WUXManagedFontIcons.Font3DS,fontIconSize:"1x"},type:"check"}),this.elements.button.preventTriggeringChangeEvent=!0,this.elements.button.getContent().addClassName("wux-controls-iconchooser-button"),this.elements.button.inject(this.elements.container),this.actionOnClickFlag&&this.elements.button.addClassName("wux-action-flag"),this.elements.button.onClick=function(e){e.stopPropagation(),_(t)},l.addEventOnElement(this,this.elements.button,"click",function(e){e.stopPropagation()}),l.addEventOnElement(this,this.elements.container,"blur",function(e){t.elements.container.removeAttribute("active"),t.elements.container.removeAttribute("fakefocus"),t.elements.button.checkFlag=!1}),l.addEventOnElement(this,this.elements.button,"blur",function(e){!1!==t.elements.button.checkFlag||t.actionOnClickFlag&&t.elements.container.getAttribute("active")||(t.elements.container.removeAttribute("active"),t.elements.container.removeAttribute("fakefocus")),t.actionOnClickFlag&&t.elements.container.getAttribute("active")&&(t.elements.button.checkFlag=!0)})},t.prototype._applyFlyoutDirection=function(e){var t;switch(this.flyoutDirection){case"left":t="far";break;case"right":t="near";break;case"middle":t="center";break;default:t="far"}this.elements.popup&&(this.elements.popup.alignment=t)},t.prototype._applyGridViewModel=function(e){e&&this.modelProvider&&this.modelProvider.removeModelEvents(e),this.gridViewModel instanceof r&&(this.modelProvider||(this.modelProvider=new C)),this.modelProvider||(this.modelProvider=new m),this.modelProvider.addModelEvents(this.gridViewModel),this._applyRowMaxCount(void 0),this.elements.gridView&&this.elements.gridView._updateDimensions(),this._buildHeaderAndGridViewFromModels()},t.prototype._applyHeaderModel=function(e){this._needToolbarUpdate=!0,this._buildHeaderAndGridViewFromModels()},t.prototype._buildHeaderAndGridViewFromModels=function(){this._buildHeaderCells(),this.elements.gridView&&(this.elements.gridView.model=this.modelProvider.flattenModel(this.gridViewModel))},t.prototype._applyValue=function(e){if(this.elements.currentElement&&(this.elements.currentElement.innerHTML="",this.value)){var t=this.buildValueItem(this.value);this.elements.currentElement.appendChild(t),!0===this._getCurrentTouchMode()&&t.setAttributeNode(document.createAttribute("touch-mode"))}e!==this.value&&this.fire("change")},t.prototype._applyFilterValue=function(e){if(this.headerModel&&this.elements.generatedToolbar){var t=this.headerModel.indexOf(this.filterValue);if(t<0||isNaN(t))return;var i="iconChooserHeaderModelItem_"+t.toString(),n=!!this.filterValue;this.elements.generatedToolbar.updateNodeModel(i,{grid:{data:n}})}},t.prototype._applyOnItemSelected=function(e){e&&l.removeEventOnElement(this,this,"selectionChanged",e),this.onItemSelected&&l.addEventOnElement(this,this,"selectionChanged",this.onItemSelected)},t.prototype._applyOnFilterChanged=function(e){e&&l.removeEventOnElement(this,this,"filterChanged",e),this.onFilterChanged&&l.addEventOnElement(this,this,"filterChanged",this.onFilterChanged)},t.prototype._applyIconSize=function(e){this.elements.gridView&&(this._applyColumnMaxCount(void 0),this._applyRowMaxCount(void 0),this.updateView())},t.prototype._applyColumnMaxCount=function(e){if(this.elements.gridView){var t=this._getCurrentTouchMode(),i=this._computeColumnWidth(t),n=this.columnMaxCount*i+(this.columnMaxCount+1)*this.elements.gridView.layout.gutter+this.elements.gridView.layout.layoutMargins.marginLeft+this.elements.gridView.layout.layoutMargins.marginRight;this.elements.gridView.layout.columnMaxWidth=i;var o=this.modelProvider.flattenModel(this.gridViewModel).length;n+=this.columnMaxCount&&o/this.columnMaxCount>this.rowMaxCount?this.getScrollbarWidth():0;var l=o*i+(o+1)*this.elements.gridView.layout.gutter+this.elements.gridView.layout.layoutMargins.marginLeft+this.elements.gridView.layout.layoutMargins.marginRight;this.elements.popup.popupBody.style.width=Math.min(l,n).toString()+"px",void 0!==e&&this._applyRowMaxCount(void 0)}},t.prototype._applyRowMaxCount=function(e){if(this.elements.gridView){var t=this._getCurrentTouchMode(),i=this._computeRowHeight(t),n=this._computeColumnWidth(t),o=t?50:33,l=this.headerModel&&this.headerModel.length?o:0,s=l+this.rowMaxCount*i+(this.rowMaxCount+1)*this.elements.gridView.layout.gutter+this.elements.gridView.layout.layoutMargins.marginTop+this.elements.gridView.layout.layoutMargins.marginBottom;this.elements.gridView.layout.rowMaxHeight=i;var r=this.columnMaxCount*n+(this.columnMaxCount+1)*this.elements.gridView.layout.gutter+this.elements.gridView.layout.layoutMargins.marginLeft+this.elements.gridView.layout.layoutMargins.marginRight,a=this.modelProvider.flattenModel(this.gridViewModel).length;r+=this.columnMaxCount&&a/this.columnMaxCount>this.rowMaxCount?this.getScrollbarWidth():0;var c=a*n+(a+1)*this.elements.gridView.layout.gutter+this.elements.gridView.layout.layoutMargins.marginLeft+this.elements.gridView.layout.layoutMargins.marginRight,h=this.columnMaxCount;c<=r&&(h=a);var u=Math.ceil(a/h)*i+(Math.ceil(a/h)+1)*this.elements.gridView.layout.gutter+this.elements.gridView.layout.layoutMargins.marginTop+this.elements.gridView.layout.layoutMargins.marginBottom+l,d=0===this.rowMaxCount?i:Math.min(u,s);this.elements.gridView.height=d-l,this.elements.popup.popupBody.style.height=d.toString()+"px",void 0!==e&&this._applyColumnMaxCount(void 0)}},t.prototype._applyModelProvider=function(e){var t=this.modelProvider;t&&(t.iconChooser=this)},t.prototype._applyActionOnClickFlag=function(e){this.elements.button&&(this.actionOnClickFlag?this.elements.button.getContent().addClassName("wux-action-flag"):this.elements.button.getContent().removeClassName("wux-action-flag"))},t.prototype._applyTouchMode=function(t){(e.prototype._applyTouchMode.call(this,t),this.elements.currentElement)&&(!0===this._getCurrentTouchMode()?(this.elements.currentElement.setAttributeNode(document.createAttribute("touch-mode")),this.elements.currentElement.children&&this.elements.currentElement.children.length>0&&this.elements.currentElement.children[0].setAttributeNode(document.createAttribute("touch-mode"))):(this.elements.currentElement.removeAttribute("touch-mode"),this.elements.currentElement.children&&this.elements.currentElement.children.length>0&&this.elements.currentElement.children[0].removeAttribute("touch-mode")))},t.prototype._computeColumnWidth=function(e){return this.iconSize?this._parseIconSize(this.iconSize,e)[0]+(e?19:8):e?38:24},t.prototype._parseIconSize=function(e,t){var i=t?[19,19]:[16,16];if("string"!=typeof e)return console.warn("Type of parameter for iconSize is expected to be string in format '40' or '40 60' for instance"),i;var n=e.split(" ").filter(function(e){return null!=e&&""!=e});if(null==n||n.length>2)return i;var o=Number.parseInt(n[0].endsWith("px")?n[0].slice(0,-2):n[0]),l=o,s=!1,r=!1;if(void 0===l)return i;if(l<(t?19:16)?(s=!0,l=t?19:16):l>114&&(r=!0,l=114),i[0]=l,n.length>1){var a=Number.parseInt(n[1].endsWith("px")?n[1].slice(0,-2):n[1]);if(void 0===a)return i[1]=l,i;s?a=Math.floor((t?19:16)*a/o):r?a=Math.floor(114*a/o):a<(t?19:16)?a=t?19:16:a>114&&(a=114),i[1]=a}else i[1]=l;return i},t.prototype._computeRowHeight=function(e){return this.iconSize?this._parseIconSize(this.iconSize,e)[1]+(e?19:8):e?38:24},t.prototype._applyProperties=function(t){e.prototype._applyProperties.call(this,t),this.isDirty("modelProvider")&&this._applyModelProvider(t.modelProvider),this.isDirty("flyoutDirection")&&this._applyFlyoutDirection(t.flyoutDirection),this.isDirty("columnMaxCount")&&this._applyColumnMaxCount(t.columnMaxCount),this.isDirty("rowMaxCount")&&this._applyRowMaxCount(t.rowMaxCount),this.isDirty("gridViewModel")&&this._applyGridViewModel(t.gridViewModel),this.isDirty("headerModel")&&this._applyHeaderModel(t.headerModel),this.isDirty("value")&&this._applyValue(t.value),this.isDirty("iconSize")&&this._applyIconSize(t.iconSize),this.isDirty("actionOnClickFlag")&&this._applyActionOnClickFlag(t.actionOnClickFlag),this.isDirty("filterValue")&&this._applyFilterValue(t.filterValue),this.isDirty("onItemSelected")&&this._applyOnItemSelected(t.onItemSelected),this.isDirty("onFilterChanged")&&this._applyOnFilterChanged(t.onFilterChanged)},t.prototype.buildDefaultItemView=function(e){var t=this.modelProvider.getIconDefinition(e.model);if(this.iconSize){if("string"==typeof t){var i={iconName:t,fontIconSize:this._parseIconSize(this.iconSize,this.touchMode)[0]+"px"};return l.generateIcon(i)}i=JSON.parse(JSON.stringify(t));var n=this._parseIconSize(this.iconSize,this.touchMode);return i.fontIconSize=this._parseIconSize(this.iconSize,this.touchMode)[0]+"px",i.iconSize={height:n[1]+"px",width:n[0]+"px"},l.generateIcon(i)}return l.generateIcon(t)},t.prototype.buildDefaultValueItemView=function(e){var t;if("string"==typeof e)t=l.generateIcon(e);else{var i=this.modelProvider.getIconDefinition(e);t=l.generateIcon(i)}return t.classList.add("wux-iconchooser-value"),t},t.prototype.getDefaultTooltip=function(e){return this.modelProvider.getTooltip(e)},t.prototype._buildHeaderCells=function(){var e=this;if(this.elements.headerCellsMainDiv){var t=this._getCurrentTouchMode();if(!0===t?this.elements.headerCellsMainDiv.setAttributeNode(document.createAttribute("touch-mode")):this.elements.headerCellsMainDiv.removeAttribute("touch-mode"),this.elements.headerCellsMainDiv.style.display="none",this.headerModel&&0!==this.headerModel.length){if(this.elements.headerCellsMainDiv.style.display="",this._needToolbarUpdate){this._needToolbarUpdate=!1,this.elements.headerCellsContainer||(this.elements.headerCellsBackground=new i.Element("div",{class:"wux-controls-iconchooser-headercellsbackground"}),this.elements.headerCellsBackground.inject(this.elements.headerCellsMainDiv),this.elements.headerCellsContainer=new i.Element("div",{class:"wux-controls-iconchooser-headercellscontainer"}),this.elements.headerCellsContainer.inject(this.elements.headerCellsBackground),this._onGeneratedToolbarClick=function(t){if(!this.__updateRunning){var i=null==t?void 0:t._getLocalID();e.filterValue=e.headerModel[i];for(var n=t.getBrothers(),o=0;o<n.length;o++)if(n[o].options.grid&&!0===n[o].options.grid.data){this.__updateRunning=!0,n[o].updateOptions({grid:{data:!1}}),this.__updateRunning=!1;break}e.elements.gridView.getCellsXSO().empty(),e.elements.gridView.setActiveCell(-1),e.fire("filterChanged",{modelItem:e.filterValue,clickItemIndex:i,isChecked:t.options.grid.data})}}),this.elements.headerCellsContainer.innerHTML="";var n={entries:[]};(new f).registerTypeRepresentations({buttonToggle:{stdTemplate:"toggleIcon",semantics:{possibleValues:[{value:"false",icon:{iconName:"",fontIconFamily:1}},{value:"true",icon:{iconName:"",fontIconFamily:1}}]}}});for(var o=0;o<this.headerModel.length;o++){var l={},s={};this.getHeaderIconName(this.headerModel[o])?(l={iconName:this.getHeaderIconName(this.headerModel[o])?this.getHeaderIconName(this.headerModel[o]):void 0},s={iconName:this.getHeaderIconName(this.headerModel[o])?this.getHeaderIconName(this.headerModel[o]):void 0}):(Object.assign(l,this.headerModel[o]),Object.assign(s,this.headerModel[o])),l.fontIconFamily=1,l.className=t?"wux-iconchooser-gridview-header-touch":"wux-iconchooser-gridview-header",s.fontIconFamily=1,s.className=t?"wux-iconchooser-gridview-active-header-touch":"wux-iconchooser-gridview-active-header",n.entries.push({id:"iconChooserHeaderModelItem_"+o.toString(),dataElements:{typeRepresentation:"buttonToggle",possibleValues:[{value:"false",icon:l},{value:"true",icon:s}],value:this.headerModel[o]==e.filterValue,func:this._onGeneratedToolbarClick,position:"near",category:"view",tooltip:this.getHeaderTooltip(this.headerModel[o])},onNodeUpdate:this._onGeneratedToolbarClick})}var r=g.prototype.createTreeDocument(n);this.elements.generatedToolbar=new g({overflowManagement:"dropdown",direction:"horizontal",items:r}),this.elements.generatedToolbar.inject(this.elements.headerCellsContainer),this.elements.generatedToolbar.getContent().style.height="100%"}this.elements.headerCellsMainDiv.innerHTML="",this.elements.headerCellsBackground.inject(this.elements.headerCellsMainDiv)}}},t.prototype._isDropped=function(){return this.elements&&this.elements.popup&&this.elements.popup.visibleFlag},t.prototype._showPopup=function(){var e=this;if(!this.elements.popup){var t={target:this.elements.container,position:"bottom",offset:{x:0,y:6},forceKeepOrientation:!0,alignment:"center",className:"wux-controls-iconchooser-popup wux-controls-popup",constraint:"screen",overlap:!1,trigger:""};this.elements.popup=new h(t),this.elements.popup.getContent().setStyle("visibility","hidden"),this.elements.popup.popupBody=new i.Element("div"),this.elements.popup.setBody(this.elements.popup.popupBody),this.elements.popup._getElementToFocus=function(){return e.elements.gridView.getContent()};var n=function(t){if(e.elements.popup.visibleFlag&&(!l.firstParentWithClass(t.target,"wux-controls-iconchooser-popup")&&!l.firstParentWithClass(t.target,"wux-toolbar-popup"))){var i=l.firstParentWithClass(t.target,"wux-controls-iconchooser");!!i&&i.dsModel===e||(e.elements.popup.visibleFlag=!1,e.elements.button.checkFlag=!1,e.elements.container.removeAttribute("active"),e.elements.container.removeAttribute("fakefocus"))}},s=document;this.getContent()&&this.getContent().ownerDocument&&(s=this.getContent().ownerDocument),l.addEventOnElement(this,s.body,"mousedown",n,!0),l.addEventOnElement(this,s.body,"touchstart",n,!0);var r=u.inherit({supportsSelection:function(){return!0},supportsKeyboardNavigation:function(){return!0},computeCellIDFromActiveCell:function(t,i,n){if(!e.gridViewModel||!e.modelProvider.flattenModel(e.gridViewModel).length)return-1;var o=this.getActiveCellID(),l=o,s=e.modelProvider.flattenModel(e.gridViewModel).length,r=s-1;switch(t){case"down":return l+e.columnMaxCount>=s?l/e.columnMaxCount<Math.floor((s-1)/e.columnMaxCount)?r:o:o+e.columnMaxCount;case"up":return l-e.columnMaxCount<0?o:o-e.columnMaxCount;case"right":return l+1>=s?o:o+1;case"left":return l-1<0?o:o-1;case"home":return 0;case"end":return s-1;default:return}},_manageKeyboard:function(){this._parent();var t=Object.assign({},this.commands);i.extend(t,{space:function(){return w(e),{stopPropagation:!0,preventDefault:!0}},enter:function(){w(e)},escape:function(){e.elements.button.fire("buttonclick"),e.elements.button.checkFlag=!1,e.elements.button.focus(),e.elements.container.removeAttribute("active"),e.elements.container.setAttribute("fakefocus",!0)},leftMove:function(){var e=this.computeCellIDFromActiveCell("left");return this.setActiveCell(e,!0,!0),{preventDefault:!0}},rightMove:function(){var e=this.computeCellIDFromActiveCell("right");return this.setActiveCell(e,!0,!0),{preventDefault:!0}},upMove:function(){var e=this.computeCellIDFromActiveCell("up");return this.setActiveCell(e,!0,!0),{preventDefault:!0}},downMove:function(){var e=this.computeCellIDFromActiveCell("down");return this.setActiveCell(e,!0,!0),{preventDefault:!0}},home:function(){var e=this.computeCellIDFromActiveCell("home");return this.setActiveCell(e,!0,!0),{preventDefault:!0}},end:function(){var e=this.computeCellIDFromActiveCell("end");return this.setActiveCell(e,!0,!0),{preventDefault:!0}}}),this.commands=t,this.keymaps.space="space"}}),a=p.inherit({_preBuildView:function(){this._parent(),this.getContent().addClassName("wux-layouts-iconchooser-cell"),this.getContent().setAttribute("draggable","false")},getInitialClassName:function(){return"wux-controls-abstract wux-layouts-collectionview-cell wux-layouts-iconchooser-cell"}});this.elements.popupMainDiv=new i.Element("div"),this.elements.headerCellsMainDiv=new i.Element("div",{class:"wux-layouts-iconchooser-header-cell"}).inject(this.elements.popupMainDiv),this._buildHeaderCells();var c=this._getCurrentTouchMode(),g=this._computeRowHeight(c),f=this._computeColumnWidth(c);this.elements.gridView=new r({cellClass:a,layout:new d({gutter:5,rowMaxHeight:g,columnMaxWidth:f,useDynamicColumnWidth:!1,layoutMargins:{marginTop:2,marginBottom:2,marginLeft:2,marginRight:2}}),height:"inherit",rowSelection:"single",cellSelection:"single",getScrollbarWidth:function(){return e.getScrollbarWidth()}}),this.elements.gridView.getContent().addClassName("wux-iconchooser-gridview"),this._applyFlyoutDirection(void 0),this._applyIconSize(void 0),this._applyGridViewModel(void 0),this._applyHeaderModel(void 0),this._applyValue(void 0),this._applyFilterValue(void 0),this.elements.gridView.getContent().inject(this.elements.popupMainDiv),this.elements.popupMainDiv.inject(this.elements.popup.popupBody),this.elements.gridView.onReady(function(){if(e.gridViewModel&&e.modelProvider.flattenModel(e.gridViewModel).length){var t=e.modelProvider.flattenModel(e.gridViewModel),i=-1;if(e.value)for(var n=0;n<t.length;n++)if(e.modelProvider.areItemsEquals(t[n],e.value)){i=n;break}e.elements.gridView.setActiveCell(i)}e.elements.gridView.getCellsXSO().onPostAdd(function(t){if(t&&1===t.length){var i=e.modelProvider.flattenModel(e.gridViewModel)[t[0]];e.value=i;var n=e.getTooltip(i);if(n){var o=e.tooltipInfos;o||(o=new v),"string"==typeof n?o.shortHelp=n:(o.title=n.title,o.shortHelp=n.shortHelp,o.longHelp=n.longHelp),e.tooltipInfos=o}e.fire("selectionChanged",{selectedItem:i})}}),e.elements.gridView.onPostUpdateViewOnce(function(){setTimeout(function(){e.elements.popup.getContent().setStyle("visibility","visible"),e.elements.popup.focus(),e.elements.button.checkFlag=!0,e.elements.container.setAttribute("active",!0)},100)}),c&&e.elements.gridView.invalidateLayout({updateCellContent:!0,updateCellLayout:!0,updateCellAttributes:!0})}),this.elements.gridView.onCellRequest(function(t){var i=e.elements.gridView.layout.getCellCoordinatesAt(t.cellID),n=e.buildItemView.call(e,{model:t.cellModel,rowID:i.rowID,columnID:i.columnID}),o=e.modelProvider.getTooltip(t.cellModel);o&&(t.cellView.tooltipInfos||(t.cellView.tooltipInfos=new v),"string"==typeof o?t.cellView.tooltipInfos.shortHelp=o:"object"==typeof o&&(t.cellView.tooltipInfos.title=o.title,t.cellView.tooltipInfos.shortHelp=o.shortHelp,t.cellView.tooltipInfos.longHelp=o.longHelp)),n.classList.add("wux-gridview-cell-content"),l.setContent(t.cellView.getContent(),n,!0)}),this.elements.gridView._onCellClick=function(t,i){i&&i.cellModel&&i.cellView&&(e.elements.gridView.selectCell(i.cellID,!1),e.elements.popup.visibleFlag=!1,e.elements.button.checkFlag=!1,setTimeout(function(){e.elements.button.focus(),e.elements.container.removeAttribute("active"),e.elements.container.setAttribute("fakefocus",!0)},0),e.fire("click"))},this.elements.gridView.addEventListener(o.POINTERHIT,this.elements.gridView._onCellClick,!1)}this.elements.popup.visibleFlag=!0,setTimeout(function(){e.elements.container.setAttribute("active",!0)},0)},t.prototype.getHeaderDefaultIconName=function(e){return"string"==typeof e?e:e.iconName?e.iconName:""},t.prototype.getHeaderDefaultTooltip=function(e){return e.description?e.description:null},t.prototype.updateView=function(){this.elements.gridView&&this.elements.gridView.invalidateLayout({updateCellContent:!0})},t.prototype.destroy=function(){this.modelProvider&&this.modelProvider.removeModelEvents(this.gridViewModel),e.prototype.destroy.call(this)},t}(n);return s.addClass(y,"iconChooser"),y}),define("DS/CollectionView/layouts/CollectionViewSectionGridLayout",["DS/CollectionView/layouts/CollectionViewGridLayout"],function(e){"use strict";return e.inherit({name:"CollectionViewSectionGridLayout",publishedProperties:{sectionHeight:{defaultValue:40,type:"integer"}},isSectionAt:function(e){return!(!this.collectionView.getModelLength()||!this.collectionView.getNodeModelAtRowID(e))&&(this.collectionView.getNodeModelAtRowID(e).options&&"fake"===this.collectionView.getNodeModelAtRowID(e).options.nodeCategory)},_preBuild:function(){this._parent(),this._listOfSectionsReverseIndexes={},this._listOfSections=[],this._listOfItemsInfos=[],this.__currentPreviousStackedSection=-1,this.__currentNextStackedSection=0,this.__currentStackedSection=0},prepareLayout:function(){var e=this;this._listOfSectionsReverseIndexes={},this._listOfSections=[],this._listOfItemsInfos=[],this.__currentPreviousStackedSection=-1,this.__currentNextStackedSection=0,this.__currentStackedSection=0;var t=e.collectionView.getViewportDimensions(),i=this.getContentDimensions(),n=t.height<i.height?e.collectionView.getScrollbarWidth():0,o=t.width-n,l=e._getColumnMaxWidthInPixel(t),s=(o-e.gutter-e.layoutMargins.marginLeft-e.layoutMargins.marginRight)/(l+e.gutter),r=Math.max(this.useDynamicColumnWidth?Math.round(s):Math.floor(s),1),a=Math.floor((o-(r+1)*e.gutter-e.layoutMargins.marginLeft-e.layoutMargins.marginRight)/r);a>l&&(this.useDynamicColumnWidth?(r++,a=Math.floor((o-(r+1)*e.gutter-e.layoutMargins.marginLeft-e.layoutMargins.marginRight)/r)):a=l),e._columnWidth=a,e._numberOfColumns=r;var c=0,h=0,u=0,d=0,g=!1;this.collectionView.model.forEach(function(t,i){var n=e.isSectionAt(i);n&&(e._listOfSections.push({cellID:i}),h=0,e._listOfSectionsReverseIndexes[i]=d,d++,!g&&c>0&&c++),n||h>r-1&&(h=0,c++),e._listOfItemsInfos.push({sectionsBefore:u,coordinates:{rowID:c,columnID:h}}),n||h++,n&&(c++,h=0,u++),g=n}),this._parent()},getCellCoordinatesAt:function(e){var t;return this._listOfSections&&0===this._listOfSections.length?t=this._parent(e):this._listOfItemsInfos&&(t=this._listOfItemsInfos[e].coordinates),t},_getPositionForCellAt:function(e){var t={top:0,left:0},i=this.getCellCoordinatesAt(e);if(i){var n=0;if(this._listOfItemsInfos){var o=this._listOfItemsInfos[e];o&&(n=o.sectionsBefore)}if(this.isSectionAt(e))t={left:this.gutter+this.layoutMargins.marginLeft};else{var l=this._parent(e);t={left:l?l.left:0}}t.top=(i.rowID-n)*(this.getRowHeight()+this.gutter)+n*(this.sectionHeight+this.gutter)+this.gutter+this.layoutMargins.marginTop}return t},getPositionForCellAt:function(e){var t={top:0,left:0};return e>=0&&(t=this._parent(e),this.isCellSyncedAt(e)?t.top=0:this.__currentPreviousStackedSection===e&&this.__currentPreviousStackedSection<this.__currentStackedSection&&(t.top=this._getPositionForCellAt(this.__currentStackedSection).top-this.getDimensionsForCellAt(e).height)),t},getDimensionsForCellAt:function(e){return this.isSectionAt(e)?{width:this._numberOfColumns*this._getColumnWidth()+this._numberOfColumns*this.gutter,height:this.sectionHeight}:this._parent(e)},getContentDimensions:function(){var e,t,i=this.collectionView.getViewportDimensions(),n=this.collectionView.getModelLength()-1,o=this.getPositionForCellAt(n),l=this.getDimensionsForCellAt(n),s=this.collectionView.getScrollbarWidth()>=0?this.collectionView.getScrollbarWidth():0;if(this._listOfSections&&this._listOfSections.length>0)return{width:t=(e={height:o.top+l.height+this.gutter+this.layoutMargins.marginBottom,width:this._numberOfColumns*(this._getColumnWidth()+this.gutter)+this.gutter+this.layoutMargins.marginRight}).height>i.height?i.width-s:i.width,height:e.height};if(t=(e={height:o.top+l.height+this.gutter+this.layoutMargins.marginBottom,width:o.left+l.width+this.gutter+this.layoutMargins.marginRight}).height>i.height?i.width-s:i.width,"vertical"===this.direction)return{width:t,height:e.height};var r=e.width>i.width?i.height-s:i.height;return{width:e.width,height:r}},_computeMinCellID:function(){this.collectionView.getViewportDimensions();var e,t=this.collectionView.getScrollerPosition();e="vertical"===this.direction?{pos:"top",scrollPos:"y",size:"height"}:{pos:"left",scrollPos:"x",size:"width"};var i=0;if(this._getPositionForCellAt(i)[e.pos]<=t[e.scrollPos]){for(;i<this.collectionView.getModelLength()-1&&this._getPositionForCellAt(i)[e.pos]<t[e.scrollPos];)i++;i=Math.max(0,i-this._numberOfColumns)}else if(this._getPositionForCellAt(i)[e.pos]>t[e.scrollPos])for(;i>0&&this._getPositionForCellAt(i)[e.pos]>t[e.scrollPos];)i--;return i},renderListOfVisibleCellsInViewport:function(e){var t=this,i=t.collectionView.getScrollerDeltaPosition().y,n={},o=e.render;e.render=function(l){var s=t._getPositionForCellAt(l).top,r=t.collectionView.getScrollerPosition().y;if(n[l]=!0,t.isSectionAt(l))i>0?s<r+t.getDimensionsForCellAt(t.__currentStackedSection).height&&l>t.__currentStackedSection&&t.__currentStackedSection!==t.__currentPreviousStackedSection&&(t.__currentPreviousStackedSection=t.__currentStackedSection,t.__currentStackedSection=l):t._getPositionForCellAt(t.__currentStackedSection).top-t.getDimensionsForCellAt(t.__currentStackedSection).height>r&&l<t.__currentStackedSection&&t.__currentStackedSection!==t.__currentPreviousStackedSection&&(t.__currentPreviousStackedSection=t.__currentStackedSection,t.__currentStackedSection=l);else if(t._listOfItemsInfos[l]){var a=t._listOfItemsInfos[l].sectionsBefore-1;if(a>-1){var c=t._listOfSections[a].cellID;void 0===n[c]&&e.render(c)}}o.call(this,l)},t.__currentPreviousStackedSection>-1&&o.call(this,t.__currentPreviousStackedSection),void 0!==t.__currentStackedSection&&o.call(this,t.__currentStackedSection),this._parent(e)},_isPreviousSection:function(e){var t=this._listOfSectionsReverseIndexes[this.__currentStackedSection]-1;return t>=0&&t===e},_getPreviousSectionID:function(){var e=this._listOfSectionsReverseIndexes[this.__currentNextStackedSection]-1;if(e>-1)return this._listOfSections[e].cellID},isCellSyncedAt:function(e){var t=!1;this.__currentStackedSection===e&&(this._getPositionForCellAt(this.__currentStackedSection).top>=this.collectionView.getScrollerPosition().y||(t=this.isSectionAt(e)));return t},cellTypeCanChangeOnScroll:function(e){return this.isSectionAt(e)},getLayoutStylesForCellAt:function(e){var t=this._parent(e);return t.zIndex=this.isSectionAt(e)?1e6+e:"",t},getLayoutAttributesForCellAt:function(e){var t=this._parent(e);return t["is-current"]=this.__currentStackedSection===e,t["is-section"]=this.isSectionAt(e),t["is-stacked"]=this.isCellSyncedAt(e),t}})}),define("DS/CollectionView/layouts/CollectionViewSectionListLayout",["DS/CollectionView/layouts/CollectionViewSectionGridLayout"],function(e){"use strict";return e.inherit({name:"CollectionViewSectionListLayout",publishedProperties:{columnMaxWidth:{defaultValue:"100%",type:"integer"}}})}),define("DS/CollectionView/layouts/CollectionViewWallFlowLayout",["DS/Controls/Abstract","DS/CollectionView/layouts/CollectionViewLayout","DS/Utilities/Utils"],function(e,t,i){"use strict";function n(e,t){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)}return t.inherit({name:"CollectionViewWallFlowLayout",publishedProperties:{cellHeight:{defaultValue:30,type:"integer"},preComputeLayout:{defaultValue:!1,type:"boolean"},gutter:{defaultValue:20,type:"integer"},direction:{defaultValue:"vertical",type:"string"},aggregate:{defaultValue:!1,type:"boolean"},columnMaxWidth:{defaultValue:400,type:"integer"}},_postBuild:function(){this._parent(),this._listOfCellPositions={},this._listOfCellSpan={},this._listOfCellDimensions={},this._listOfColumnsProperties=[]},_applyColumns:function(){this._listOfColumnsProperties=[];for(var e=0;e<this._numberOfColumns;e++)this._listOfColumnsProperties.push({filledHeight:0})},_applyProperties:function(e){this._parent(e),this._applyColumns(),this.invalidate(!0)},prepareLayout:function(){this._mask=!0,this._sizePattern=null;var e=this.collectionView.getViewportDimensions(!0),t=this.columnMaxWidth;if("string"==typeof t){var i=parseFloat(t);t=(e.width-this.gutter)/100*i}var n=(e.width-this.gutter)/(t+this.gutter);this._numberOfColumns=Math.max(Math.ceil(n),1),this._columnWidth=Math.floor((e.width-(this._numberOfColumns+1)*this.gutter)/this._numberOfColumns),this._applyColumns(),this._computePositions(0,this.collectionView.getModelLength()-1)},isValid:function(){return!this._isInvalid},isCellSyncedAt:function(e){return!1},postRender:function(){for(var e in this.collectionView._visibleCellsInViewport){e=parseInt(e,10);var t=this.collectionView.getCellInfosAt(e);t.cellView=this.collectionView._getViewAt(e),this.collectionView._layoutCell(t)}this._parent()},getPositionForCellAt:function(e){return this._listOfCellPositions[e]},_getColumnPrivateProperties:function(e){return this._listOfColumnsProperties[e]},_getLessFilledColumn:function(){for(var e=this._getColumnPrivateProperties(0).filledHeight,t=0,i=!1,n=0;!i&&n<this._numberOfColumns;n++){var o=this._getColumnPrivateProperties(n).filledHeight;o<e&&(e=o,t=n,0===o&&(i=!0))}return t},_getMoreFilledColumn:function(){if(this._getColumnPrivateProperties(0)){for(var e=this._getColumnPrivateProperties(0).filledHeight,t=0,i=0;i<this._numberOfColumns;i++){var n=this._getColumnPrivateProperties(i).filledHeight;n>=e&&(e=n,t=i)}return t}return-1},_computePositions:function(e,t){void 0===e&&(e=0),void 0===t&&(t=this.collectionView.getModelLength()-1);for(var i=e;i<=t;i++){var n=this.getDimensionsForCellAt(i);if(n&&void 0!==n.width&&void 0!==n.height){var o=this._getLessFilledColumn(),l=this._getColumnPrivateProperties(o).filledHeight,s=o,r=o,a=r-s+1;a<this._numberOfColumns?this._listOfCellSpan[i]=a:(this._listOfCellSpan[i]=1,r=s);var c=this._getColumnPosition(o);this._listOfCellPositions[i]={top:l+this.gutter,left:c};for(var h=s;h<=r;h++)this._getColumnPrivateProperties(h).filledHeight=l+n.height+this.gutter}}},_getColumnWidth:function(e){return this._columnWidth},_getColumnPosition:function(e){return e*(this._getColumnWidth()+this.gutter)+this.gutter},_getCellSpan:function(e){return void 0!==this._listOfCellSpan[e]?this._listOfCellSpan[e]:1},getDimensionsForCellAt:function(e){var t=this._getColumnWidth();return void 0===this._listOfCellDimensions[e]&&(this._listOfCellDimensions[e]={}),this._listOfCellDimensions[e].width=t*this._getCellSpan(e)+this.gutter*(this._getCellSpan(e)-1),this._listOfCellDimensions[e]},getContentDimensions:function(){var e=this.collectionView.getViewportDimensions(),t=this._getMoreFilledColumn();if(t>-1){var i=this._getColumnPrivateProperties(t).filledHeight,n=e.height>i?0:UWA.Utils.Client.getScrollbarWidth();return{width:e.width-n,height:i}}return{width:e.width,height:e.height}},renderListOfVisibleCellsInViewport:function(e){void 0===e&&(e={});var t=this.collectionView.getViewportDimensions(),i=this.collectionView.getScrollerPosition(),o=(Math.floor(i.y/this.cellHeight),Math.floor((i.y+t.height)/this.cellHeight));o=this.collectionView.getModelLength()-1,(u=i).top=i.y,u.left=i.x,u.right=u.left+t.width,u.bottom=u.top+t.height;for(var l=!1,s=!1,r=0;(!s||this.preComputeLayout)&&r<=o;r++){if(void 0!==(h=this._listOfCellPositions[r])){var a=this.getDimensionsForCellAt(r);h.right=h.left+a.width,h.bottom=h.top+a.height,l=n(h,u)}else l=!0;if(l&&(0,e.render&&(e.render(r),void 0===this._listOfCellDimensions[r]||void 0===this._listOfCellDimensions[r].width||void 0===this._listOfCellDimensions[r].height))){var c=this.collectionView._getViewAt(r);c&&(this._listOfCellDimensions[r]=c.getContent().getDimensions()),this._computePositions(r);var h=this._listOfCellPositions[r];a=this._listOfCellDimensions[r];h.right=h.left+a.width,h.bottom=h.top+a.height;var u;t=this.collectionView.getViewportDimensions(!0),i=this.collectionView.getScrollerPosition();(u={}).top=i.y,u.left=i.x,u.right=u.left+t.width,u.bottom=u.top+t.height,n(h,u)||(s=!0)}}},getLayoutStylesForCellAt:function(e){var t=this.getPositionForCellAt(e),i=this.getDimensionsForCellAt(e);return t?{position:"absolute",transform:"translate3d("+t.left+"px,"+t.top+"px,0)",width:i.width+"px",height:void 0!==i.height?i.height+"px":""}:{position:"absolute",width:i.width+"px",height:void 0!==i.height?i.height+"px":""}},getLayoutAttributesForCellAt:function(e){return{"cell-id":e}}})}),define("DS/CollectionView/layouts/CollectionViewListFlowLayout",["DS/Controls/Abstract","DS/CollectionView/layouts/CollectionViewWallFlowLayout","DS/Utilities/Utils"],function(e,t,i){"use strict";return t.inherit({name:"CollectionViewListFlowLayout",publishedProperties:{columnMaxWidth:{defaultValue:"100%",type:"integer"}}})}),define("DS/CollectionView/ResponsiveThumbnailsCollectionView",["DS/CollectionView/ResponsiveCollectionView","DS/CollectionView/layouts/CollectionViewGridLayout","DS/Controls/ResponsiveThumbnailView"],function(e,t,i){"use strict";var n=t.inherit({name:"ResponsiveThumbnailsCollectionViewLayout",isNodeModelInRange:function(e,t,i){return this.collectionView.modelProvider.isNodeModelInRange(e,t,i)},getRowHeight:function(){if("vertical"===this.direction){var e=this.collectionView._getPictureHeight()+this.collectionView._getMainContentHeight();if(-1!==this.collectionView._displayedOptionalCellProperties.indexOf("All")||-1!==this.collectionView._displayedOptionalCellProperties.indexOf("description")||-1!==this.collectionView._displayedOptionalCellProperties.indexOf("propertiesList"))e+=this.collectionView.descriptionLinesNumber*this.collectionView._getDescriptionLineHeight()+this.collectionView._getDescriptionTopBottomMargins();return!0===this.collectionView.useProgressBar&&(e+=this.collectionView._getProgressBarContainerHeight()),-1===this.collectionView._displayedOptionalCellProperties.indexOf("All")&&-1===this.collectionView._displayedOptionalCellProperties.indexOf("statusbarIcons")||(e+=this.collectionView._getStatusbarHeight()),e}return this.rowMaxHeight},getContentDimensions:function(){var e=this._parent();return e.width=e.width-2,e}});return e.inherit({name:"ResponsiveThumbnailsCollectionView",publishedProperties:{descriptionLinesNumber:{defaultValue:7,type:"integer"},useProgressBar:{defaultValue:!1,type:"boolean",category:"Appearance"}},_applyProperties:function(e){this._parent(e),this.isDirty("descriptionLinesNumber")&&this._applyDescriptionLinesNumber(e.descriptionLinesNumber),this.isDirty("useProgressBar")&&this._applyUseProgressBar(e.useProgressBar)},_applyDescriptionLinesNumber:function(e){e!==this.descriptionLinesNumber&&this.invalidateLayout()},_applyUseProgressBar:function(e){e!==this.useProgressBar&&this.invalidateLayout({updateCellContent:!0})},_preBuildView:function(e){this._properties.layout.value||(this._properties.layout.value=new n({columnMaxWidth:{0:320,420:240},gutter:10})),this._parent(e)},_postBuildView:function(){this._parent(),this.cellStyleOverload="wux-cell-responsivethumbnail";var e=this,t=this;e.registerReusableCellContent({id:"Thumbnail",buildContent:function(){var e=new(t._getResponsiveThumbnailViewClass())({layoutingCollection:t});return t._onEndResize(function(){this._processPoolCells(function(e){e.cellView.component.collectionView;var t=e.cellView.component.contentView;t&&(t._onViewResize(),this._updateHighlight(t.cellInfos))})}),e}}),e.onCellRequest(function(t){var i=e.reuseCellContent("Thumbnail");t.cellView.collectionView=e,t.cellView.contentView=i,i.cellInfos=t,i.unPrehighlight(),!0===e.useDragAndDrop?t.cellView.elements.container.setAttribute("draggable","true"):t.cellView.elements.container.setAttribute("draggable","false"),t.cellView.elements.container.dsView=t.cellView,t.cellView.getContent().addClassName(e.cellStyleOverload),i.getContent().setStyles({width:"100%",height:"100%"});var n=e._viewportDimensions,o=e.layout._numberOfColumns,l=(n.width,e.layout.gutter,t.cellModel),s=[],r=e.getBadges(l);if(r&&(r.topRight&&s.push(r.topRight),r.bottomRight&&s.push(r.bottomRight)),e.displayedOptionalCellProperties[0]==["All"])i.setProperties({title:e.getLabel(l),customTooltip:e.getCustomTooltip(l),clickableTitle:e.getClickableTitle(l),multipleTitleLineNumber:e.getMultipleTitleLineNumber(l),subtitle:e.getSubLabel(l),progressValueData:e.useProgressBar?e.getprogressValueData(l):void 0,description:e.getDescription(l),propertiesList:e.getPropertiesList(l),picture:e.getThumbnail(l),icon:e.getIcon(l),emptyStatusbarVisibleFlag:e.getEmptyStatusbarVisibleFlag(l),statusbarIconsTooltips:e.getStatusbarIconsTooltips(l),activeFlag:e.getActiveFlag(l),statusbarIcons:e.getStatusbarIcons(l),statusbarLabelsWidthRatios:e.getStatusbarLabelsWidthRatios(l),badges:s,contextualMenu:e.getContextualMenu(l),color:e.getColor(l),disabled:e.getDisabled(l)});else if(e.displayedOptionalCellProperties[0]==["None"])i.setProperties({title:e.getLabel(l),customTooltip:e.getCustomTooltip(l),clickableTitle:e.getClickableTitle(l),multipleTitleLineNumber:e.getMultipleTitleLineNumber(l),subtitle:e.getSubLabel(l),progressValueData:e.useProgressBar?e.getprogressValueData(l):void 0,picture:e.getThumbnail(l),icon:e.getIcon(l),badges:void 0,description:void 0,propertiesList:void 0,activeFlag:void 0,contextualMenu:void 0,emptyStatusbarVisibleFlag:!1,statusbarIcons:void 0,statusbarIconsTooltips:e.getStatusbarIconsTooltips(l),color:e.getColor(l),disabled:e.getDisabled(l)});else{var a=-1!==e._displayedOptionalCellProperties.indexOf("statusbarIcons"),c={title:e.getLabel(l),customTooltip:e.getCustomTooltip(l),clickableTitle:e.getClickableTitle(l),multipleTitleLineNumber:e.getMultipleTitleLineNumber(l),subtitle:e.getSubLabel(l),progressValueData:e.useProgressBar?e.getprogressValueData(l):void 0,picture:e.getThumbnail(l),icon:e.getIcon(l),emptyStatusbarVisibleFlag:!!a&&e.getEmptyStatusbarVisibleFlag(l),badges:a?s:void 0,statusbarIcons:a?e.getStatusbarIcons(l):void 0,statusbarLabelsWidthRatios:e.getStatusbarLabelsWidthRatios(l),statusbarIconsTooltips:e.getStatusbarIconsTooltips(l),color:e.getColor(l),disabled:e.getDisabled(l)};c.description=-1!==e._displayedOptionalCellProperties.indexOf("description")?e.getDescription(l):void 0,c.propertiesList=-1!==e._displayedOptionalCellProperties.indexOf("propertiesList")?e.getPropertiesList(l):void 0,c.activeFlag=-1!==e._displayedOptionalCellProperties.indexOf("activeFlag")?e.getActiveFlag(l):void 0,c.contextualMenu=-1!==e._displayedOptionalCellProperties.indexOf("contextualMenu")?e.getContextualMenu(l):void 0,i.setProperties(c)}t.cellView._setReusableContent(i),this.selectionBehavior.enableFeedbackForActiveCell&&(l===this.activeNode?i.activate():i.deactivate()),this.modelProvider.isNodeSelected(l)?i.highlight():i.unhighlight(),this._updateHighlight(t),e._onPostRequestCellCB&&e._onPostRequestCellCB.call(e,t)})},_getPictureHeight:function(){return 3*this.layout._columnWidthUsedForRowHeight/4},_getMainContentHeight:function(){return 70},_getProgressBarContainerHeight:function(){return 46},_getStatusbarHeight:function(){return 28},_getDescriptionLineHeight:function(){return 13},_getDescriptionTopBottomMargins:function(){return 24},_getDescriptionBottomMargins:function(){return 14},activateInteractiveCumulativeSelection:function(){this._interactiveCumulativeSelectionByAPI=!0,this._enableInteractiveMultiSelMode(),this._interactiveCumulativeSelectionByAPI=!1},isInInteractiveCumulativeSelectionFlag:function(){return this._interactiveCumulativeSelection},deactivateInteractiveCumulativeSelection:function(){this._disableInteractiveMultiSelMode()},getprogressValueData:function(e){return this.modelProvider.getPropertyValue(e,"progressValueData")},_enableInteractiveMultiSelMode:function(){!this.selectionBehavior.canInteractiveMultiselectWithCheckboxClick&&!0!==this._interactiveCumulativeSelectionByAPI||-1!==this.elements.container.className.indexOf("wux-multiselmode-responsivethumbnailcollectionView")||!1===this._isInteractiveMultiSelMode&&(this._isInteractiveMultiSelMode=!0,this.elements.container.addClassName("wux-multiselmode-responsivethumbnailcollectionView"),this._interactiveCumulativeSelection=!0,this._modelEvents.publish({event:"interactiveCumulativeSelectionChanged",data:{responsiveCollectionView:this,cumulativeSelection:!0}}))},_disableInteractiveMultiSelMode:function(){this.elements.container.className.indexOf("wux-multiselmode-responsivethumbnailcollectionView")&&!0===this._isInteractiveMultiSelMode&&(this._isInteractiveMultiSelMode=!1,this.elements.container.removeClassName("wux-multiselmode-responsivethumbnailcollectionView"),this._interactiveCumulativeSelection=!1,this._modelEvents.publish({event:"interactiveCumulativeSelectionChanged",data:{responsiveCollectionView:this,cumulativeSelection:!1}}))},_getResponsiveThumbnailViewClass:function(){return i},getCellViewMinWidth:function(){return 150},getCellViewMinHeight:function(){}})}),define("DS/CollectionView/CarouselView",["UWA/Core","DS/Controls/Abstract","DS/Windows/DockingElement","DS/Tweakers/TypeRepresentationFactory","DS/Utilities/Utils","DS/Controls/Button","DS/Core/PointerEvents","DS/Utilities/Dom","DS/Controls/TooltipModel","DS/CollectionView/ResponsiveThumbnailsCollectionView","DS/Menu/ContextualMenu","DS/Controls/ResponsiveThumbnailView","i18n!DS/CollectionView/assets/nls/carousel.json"],function(e,t,i,n,o,l,s,r,a,c,h,u,d){"use strict";var g=u.inherit({prehighlight:function(){this.isPreHighlighted||(this.elements.container.addClassName("wux-ui-state-prehighlighted"),this.elements.highlightBorder.addClassName("wux-ui-state-prehighlighted"),this.isPreHighlighted=!0)},unPrehighlight:function(){this.isPreHighlighted&&(this.elements.container.removeClassName("wux-ui-state-prehighlighted"),this.elements.highlightBorder.removeClassName("wux-ui-state-prehighlighted"),this.isPreHighlighted=!1)},highlight:function(){this.activeFlag=!0},unhighlight:function(){this.activeFlag=!1}}),p=c.inherit({_getResponsiveThumbnailViewClass:function(){return g}});p.onSelectionAdd=function(e){e&&(e.activeFlag=!0)},p.onSelectionRemove=function(e){e&&(e.activeFlag=!1)};var f=function(t){if(t.target.classList.contains("wux-layouts-carousel-main-content")){var i=e.Event.wheelDelta(t);i<0&&C(t.currentTarget._mouseWheelArg),i>0&&m(t.currentTarget._mouseWheelArg)}else r.firstParentWithClass(t.target,"wux-layouts-carousel-bottom-content")&&t.stopPropagation()},m=function(e){if(e.treeDocument){var t=e.treeDocument.getXSO().get();if(0===t.length&&e.treeDocument.getRoots()[0].select(),t.length>0){var i=t[t.length-1].getPreviousVisibleNode();i&&i.select(!0)}}},C=function(e){if(e.treeDocument){var t=e.treeDocument.getXSO().get();if(0===t.length&&e.treeDocument.getRoots()[0].select(),t.length>0){var i=t[t.length-1].getNextVisibleNode();i&&i.select(!0)}}},v=new n;return t.inherit({name:"carousel",publishedProperties:{treeDocument:{defaultValue:null,type:"object",category:"Model"},intervalTimer:{defaultValue:1,type:"number",category:"Appearance"},height:{defaultValue:"auto",type:"number",category:"Appearance"},onTitleRequest:{defaultValue:function(e){e.nodeView.setContent(e.nodeModel.options.label)},type:"function",category:"Appearance"},onSubtitleRequest:{defaultValue:function(e){e.nodeView.setContent(e.nodeModel.options.subLabel)},type:"function",category:"Appearance"},onRightViewRequest:{defaultValue:function(e){v.generateView(e.nodeModel.options.grid,{typePath:"object",readOnly:!0,onViewCreated:function(t){e.nodeView.setContent(t)}})},type:"function",category:"Appearance"},bigPicturePath:{defaultValue:function(e){return e.nodeModel.options.thumbnail},type:"function",category:"Appearance"},onMainViewRequest:{defaultValue:function(e){e.nodeView.setStyles({backgroundImage:"url("+e.view.bigPicturePath(e)+")",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"50% 50%"})},type:"function",category:"Appearance"},toolbar:{defaultValue:[],type:"array",category:"behavior"},scrollOnMainViewMouseWheel:{defaultValue:!0,type:"boolean",category:"behavior"}},buildView:function(){this.elements.container=new e.Element("div",{class:"wux-layouts-carousel",tabindex:0}),this.elements.container.setAttribute("carousel-display-mode","maxWidthDisplay"),this.elements.header=new e.Element("div",{class:"wux-layouts-carousel-header"}).inject(this.elements.container),this.elements.headerMainContainer=new e.Element("div",{class:"wux-layouts-carousel-header-main-container"}).inject(this.elements.header),this.elements.headerTitleBar=new e.Element("ul",{class:"wux-layouts-carousel-header-titlebar"}).inject(this.elements.headerMainContainer),this.elements.headerTitle=new e.Element("span",{class:"wux-layouts-carousel-header-title",html:"document title"}).inject(this.elements.headerTitleBar),this.elements.headerSubtitle=new e.Element("span",{class:"wux-layouts-carousel-header-subtitle",html:"document subtitle"}).inject(this.elements.headerTitleBar),this.elements.headerToolbar=new e.Element("ul",{class:"wux-layouts-carousel-header-toolbar"}).inject(this.elements.headerMainContainer),this.elements.containerRel=new e.Element("div",{class:"wux-layouts-carousel-rel",styles:{position:"relative",height:"calc( 100% - 70px)",width:"100%"}}).inject(this.getContent()),this.elements.collectionView=new p({displayedOptionalCellProperties:["contextualMenu"],showScrollbarsOnHover:!0}),e.extend(this.elements.collectionView.selectionBehavior,{canInteractiveMultiselectWithCheckboxClick:!1,canMultiSelect:!1,enableShiftSelection:!1}),this.elements.collectionView.layout.direction="horizontal",this.elements.collectionView.layout.columnMaxWidth=175,this.elements.collectionView.layout.rowMaxHeight=210,this.elements.collectionView.layout.useDynamicRowHeight=!1,this.elements.collectionView.layout.useDynamicColumnWidth=!1,this.elements.collectionView.getContent().setAttribute("carouselview-status-bar","false"),this.elements.collectionView.getContent().setStyles({top:1,height:"auto",bottom:"-2px","z-index":"100001"}),this.elements.rightViewContent=new e.Element("div",{class:"wux-layouts-carousel-right-content"}),this.elements.dockingZoneContentForBottom=new e.Element("div",{class:"wux-layouts-carousel-main-content wux-layouts-carousel-bottom-content",html:this.elements.collectionView,styles:{height:"100%",position:"relative"}}),this.elements.mainView=new e.Element("div",{class:"wux-layouts-carousel-main"}),this.elements.bottomDockingElement=new i({side:WUXDockAreaEnum.BottomDockArea,dockingZoneContent:this.elements.dockingZoneContentForBottom,dockingZoneSize:242,resizableFlag:!1,useBordersFlag:!1,collapsibleFlag:!1,collapseDockingZoneFlag:!1,visibleDockingZoneFlag:!0}),this.rollVisibleFlag=!0,this.sidePanelVisibleFlag=!0,this.elements.rightDockingElement=new i({side:WUXDockAreaEnum.RightDockArea,dockingZoneContent:this.elements.rightViewContent,dockingZoneSize:482,resizableFlag:!1,useBordersFlag:!1,collapsibleFlag:!1,collapseDockingZoneFlag:!1,visibleDockingZoneFlag:!0}),this.elements.bottomDockingElement.freeZoneContent=this.elements.mainView,this.elements.rightDockingElement.freeZoneContent=this.elements.bottomDockingElement,this.elements.mainViewContent=new e.Element("div",{class:"wux-layouts-carousel-main-content"}).inject(this.elements.mainView),this.elements.mainViewLeftArrow=new l({icon:{iconName:"open-left",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new a({shortHelp:d.previous,mouseRelativePosition:!1}),clickMode:1}),this.elements.mainViewRightArrow=new l({icon:{iconName:"open-right",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new a({shortHelp:d.next,mouseRelativePosition:!1}),clickMode:1}),this.elements.bottomViewLeftArrow=new e.Element("div",{class:"wux-layouts-carousel-bottom-prev wux-layouts-carousel-bottom-prev-collectiondimensions  wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-left"}).inject(this.elements.dockingZoneContentForBottom),this.elements.bottomViewRightArrow=new e.Element("div",{class:"wux-layouts-carousel-bottom-next wux-layouts-carousel-bottom-next-collectiondimensions wux-ui-3ds wux-ui-3ds-1x wux-ui-3ds-open-right"}).inject(this.elements.dockingZoneContentForBottom),this._observeEvents(),this.elements.containerRel.appendChild(this.elements.rightDockingElement.elements.container),this.elements.collectionView._getScroller().elements.container.addEventListener("wheel",function(e){e.stopPropagation()},!0)},_postBuildView:function(){var e=this;this._parent(),this._isReady=!1,r.onNodeRendered(this.getContent(),function(){!0!==e._isReady&&(e._isReady=!0,e._updateCarouselLayout())}),r.addEndResizeListener(this.elements.container,function(){e._updateCarouselLayout()},10)},_updateCarouselLayout:function(){var e=this,t=e.elements.container.getDimensions(),i=e.elements.container.getAttribute("carousel-display-mode");if(t.width<965&&"middleWidthDisplay"!==i?(e.elements.container.setAttribute("carousel-display-mode","middleWidthDisplay"),e.elements.bottomDockingElement.dockingZoneContent=null,!0===e.sidePanelVisibleFlag?(e.elements.bottomDockingElement.dockingZoneContent=e.elements.rightViewContent,e.elements.bottomDockingElement.visibleDockingZoneFlag=!0):!0===e.rollVisibleFlag?(e.elements.bottomDockingElement.dockingZoneContent=e.elements.dockingZoneContentForBottom,e.elements.bottomDockingElement.visibleDockingZoneFlag=!0):e.elements.bottomDockingElement.visibleDockingZoneFlag=!1,e.elements.rightDockingElement.visibleDockingZoneFlag=!1):t.width>=965&&"maxWidthDisplay"!==i&&(e.elements.container.setAttribute("carousel-display-mode","maxWidthDisplay"),!0===e.sidePanelVisibleFlag?e.elements.rightDockingElement.visibleDockingZoneFlag=!0:e.elements.rightDockingElement.visibleDockingZoneFlag=!1,e.elements.rightDockingElement.dockingZoneContent=null,e.elements.bottomDockingElement.dockingZoneContent=e.elements.dockingZoneContentForBottom,e.elements.rightDockingElement.dockingZoneContent=e.elements.rightViewContent,!0===e.rollVisibleFlag?e.elements.bottomDockingElement.visibleDockingZoneFlag=!0:e.elements.bottomDockingElement.visibleDockingZoneFlag=!1),"middleWidthDisplay"===i){var n=0;!0===e.rollVisibleFlag&&!1===e.sidePanelVisibleFlag?n=242:!0===e.sidePanelVisibleFlag&&(n=t.height-58-3*t.width/4)<242&&(n=242),e.elements.bottomDockingElement.dockingZoneSize=n}e._updateToolbarLayout()},_observeEvents:function(){var e,t,i=this,n=function(){e&&clearInterval(e),t&&clearInterval(t),i.getGridView()._disableAutoScroll()};this.elements.mainViewLeftArrow.addEventListener("buttonclick",function(){n(),m(i),t=setTimeout(function(){e=setInterval(m,i,i.intervalTimer)},500)}),this.elements.mainViewRightArrow.addEventListener("buttonclick",function(){n(),C(i),t=setTimeout(function(){e=setInterval(C,i,i.intervalTimer)},500)}),this.elements.bottomViewLeftArrow.addEvent(s.POINTERDOWN,function(e){e.preventDefault(),e.stopPropagation(),i.getGridView()._enableAutoScroll({x:-10,y:0},10)}),this.elements.bottomViewRightArrow.addEvent(s.POINTERDOWN,function(e){e.preventDefault(),e.stopPropagation(),i.getGridView()._enableAutoScroll({x:10,y:0},10)});var o=function(e,t,n){!0,i.getGridView().onPostUpdateViewOnce(function(){!1,n&&n.call(i)}),e.call(i,i)};this._manageKeyboardNavigation({throttleTime:50,keymap:{left:function(){o(m)},right:function(){o(C)}}});var l=function(e){e.preventDefault()};this.elements.container.addEventListener("MSHoldVisual",l,!1),this.elements.container.addEventListener("contextmenu",l,!1),this.elements.mainViewLeftArrow.addEvent("mouseleave",n),this.elements.mainViewRightArrow.addEvent("mouseleave",n),this.elements.bottomViewLeftArrow.addEvent("mouseleave",n),this.elements.bottomViewRightArrow.addEvent("mouseleave",n),this.elements.bottomViewLeftArrow.addEvent(s.POINTERUP,n),this.elements.bottomViewRightArrow.addEvent(s.POINTERUP,n),document.body.addEventListener("mouseup",n),document.body.addEventListener("mouseleave",n)},_manageKeyboardNavigation:function(t){var i=this;e.Element.addEvent.call(this.getContent(),"keydown",o.throttle(function(n){if(void 0==={input:!0,textarea:!0}[n.target.tagName.toLowerCase()]&&(r.hasClass(n.target,"wux-layouts-carousel")?n.target:r.firstParentWithClass(n.target,"wux-layouts-carousel"))===i.getContent()){var o=e.Event.whichKey(n);void 0!==t.keymap[o]&&t.keymap[o].call(i)}},t.throttleTime))},_applyHeight:function(e){"auto"===this.height?this.elements.container.setStyles({position:"absolute",top:0,bottom:0,right:0,left:0}):"number"==typeof this.height&&this.elements.container.setStyles({position:"",height:this.height}),this.elements.container.style.overflow="auto",this._parent(e)},_applyThemeStyle:function(e){this.themeStyle!=e&&("dark"===this.themeStyle?(this.elements.container&&this.elements.container.setAttribute("theme-style","dark"),this.elements.header&&this.elements.header.setAttribute("theme-style","dark"),this.elements.collectionView&&this.elements.collectionView.getContent().setAttribute("theme-style","dark"),this.elements.bottomViewLeftArrow&&this.elements.bottomViewLeftArrow.setAttribute("theme-style","dark"),this.elements.bottomViewRightArrow&&this.elements.bottomViewRightArrow.setAttribute("theme-style","dark")):"white"===this.themeStyle&&(this.elements.container&&this.elements.container.setAttribute("theme-style","white"),this.elements.header&&this.elements.header.setAttribute("theme-style","white"),this.elements.collectionView&&this.elements.collectionView.getContent().setAttribute("theme-style","white"),this.elements.bottomViewLeftArrow&&this.elements.bottomViewLeftArrow.setAttribute("theme-style","white"),this.elements.bottomViewRightArrow&&this.elements.bottomViewRightArrow.setAttribute("theme-style","white")))},_updateVisibleDescendants:function(){this._listOfVisibleDescendants=this.treeDocument._getTrueRoot().getAllDescendants([],{onlyVisibleNodes:!0}),console.log(this._listOfVisibleDescendants)},_applyTreeDocument:function(e){if(this.elements.collectionView.loadGridViewModel(this.treeDocument),this.treeDocument){var t=this,i=this.treeDocument.getXSO(),n=o.debounce(function(e){t.onRightViewRequest(e)},100),l=function(){var e=i.get(),o=e[e.length-1];t.onMainViewRequest({nodeModel:o,nodeView:t.elements.mainViewContent,view:t}),n.call(t,{nodeModel:o,nodeView:t.elements.rightViewContent,view:t}),t.onTitleRequest({nodeModel:o,nodeView:t.elements.headerTitle,view:t}),t.onSubtitleRequest({nodeModel:o,nodeView:t.elements.headerSubtitle,view:t}),t.elements.collectionView._setActiveNode(o,!0)};i.get().length>0&&l.call(i),i.onAdd(l);var s=this.treeDocument.getRoots();0===i.get().length&&s.length&&this.treeDocument.getRoots()[0].select()}this._parent(e)},_applyDisabled:function(){this._parent(),this.disabled?this.elements.container.setAttribute("tabindex",-1):this.elements.container.setAttribute("tabindex",0)},_applyToolBar:function(){var e=this;e.elements.headerToolbar.empty(),this.toolbar.forEach(function(t){t.icon.fontIconSize="2x",t.icon.fontIconFamily=WUXManagedFontIcons.Font3DS,new l({type:t.type,tooltipInfos:t.tooltipInfos,icon:t.icon,value:"1",displayStyle:"lite-borders",touchMode:!0,clickMode:1}).inject(e.elements.headerToolbar).addEventListener("click",function(e){e.stopPropagation(),t.callback&&t.callback()})}),this.getRollVisibleFlag()&&(this.elements.mainViewLeftArrow.inject(this.elements.headerToolbar),this.elements.mainViewRightArrow.inject(this.elements.headerToolbar))},_applyScrollOnMainViewMouseWheel:function(t){if(this.scrollOnMainViewMouseWheel!==t){this.scrollOnMainViewMouseWheel?(this._mouseWheelsubscriptionDoneOneTimeAtLeast=!0,e.Element.addEvent.call(this.elements.container,"mousewheel",f),this.elements.container._mouseWheelArg=this):!0===this._mouseWheelsubscriptionDoneOneTimeAtLeast&&(this._mouseWheelsubscriptionDoneOneTimeAtLeast=!1,e.Element.removeEvent.call(this.elements.container,"mousewheel",f),this.elements.container._mouseWheelArg=this)}},_applyProperties:function(e){this._parent(e),this._applyHeight(),this._applyTreeDocument(),this._applyToolBar(),this._applyScrollOnMainViewMouseWheel(e.scrollOnMainViewMouseWheel),this._applyThemeStyle()},_updateToolbarLayout:function(){var e=this.elements.container.getDimensions().width-this.elements.headerTitleBar.getDimensions().width-30;e<190&&(e=190);var t=!1===this.rollVisibleFlag?1:3,i=this.toolbar?40*(this.toolbar.length+t)+30:0,n=!1===this.rollVisibleFlag?2:4,o=[];!0===this.rollVisibleFlag&&(o.push(this.elements.mainViewLeftArrow.getContent()),o.push(this.elements.mainViewRightArrow.getContent())),o.push(this._closeButton.getContent());var s=0,r=[];if(i>e){s=Math.floor(e/40)-n,r=this.buildToolbarAdditionalButtons(s);for(var c=[],u=0;u<this.toolbar.length;u++)-1===r.indexOf(this.toolbar[u])&&c.push(this.toolbar[u]);if(this.buttonsForContextMenu=c,c.length>=1){if(!this._dotMenuButtonIcon){this._dotMenuButtonIcon=new l({icon:{iconName:"menu-dot",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new a({shortHelp:d.dotMenu,mouseRelativePosition:!1}),clickMode:1}),this._dotMenuButtonIcon.getContent().addEventListener("click",function(e){var t=document.createEvent("HTMLEvents");t.initEvent("contextmenu",!0,!1),t.pageX=e.pageX,t.pageY=e.pageY,this.dispatchEvent(t),e.stopPropagation()});var g=this;h.addEventListener(this._dotMenuButtonIcon.getContent(),{callback:function(e){return g.getContextMenuForButtons(g.buttonsForContextMenu)}})}o.push(this._dotMenuButtonIcon.getContent())}}else r=this.toolbar;this.elements.headerToolbar.empty();g=this;r.forEach(function(e){e.icon.fontIconSize="2x",e.icon.fontIconFamily=WUXManagedFontIcons.Font3DS,new l({type:e.type,tooltipInfos:e.tooltipInfos,icon:e.icon,value:"1",displayStyle:"lite-borders",touchMode:!0,clickMode:1}).inject(g.elements.headerToolbar).addEventListener("click",function(t){t.stopPropagation(),e.callback&&e.callback()})});for(var p=0;p<o.length;p++)this.elements.headerToolbar.appendChild(o[p])},buildToolbarAdditionalButtons:function(e){var t=[];if(!this.toolbar||this.toolbar.length<e)return t;for(var i=0;i<e;i++)t.push(this.toolbar[i]);return t},getContextMenuForButtons:function(e){for(var t=[],i=0;i<e.length;i++){var n=e[i];t.push({type:"PushItem",title:n.text,fonticon:{family:n.icon.fontIconFamily,content:"wux-ui-3ds wux-ui-3ds-"+n.icon.iconName},action:{callback:function(e){var t=e.context;t.callback.call(t)},context:n}})}return t},getGridView:function(){return this.elements.collectionView},getRightDockingElement:function(){return this.elements.rightDockingElement},getBottomDockingElement:function(){return this.elements.bottomDockingElement},getRollVisibleFlag:function(){return this.rollVisibleFlag},setRollVisibleFlag:function(e){var t=this;"middleWidthDisplay"===t.elements.container.getAttribute("carousel-display-mode")?e?(t.elements.bottomDockingElement.dockingZoneContent=t.elements.dockingZoneContentForBottom,t.rollVisibleFlag=!0,t.elements.bottomDockingElement.visibleDockingZoneFlag=!0):(t.sidePanelVisibleFlag?(t.elements.bottomDockingElement.dockingZoneContent=t.elements.rightViewContent,t.elements.bottomDockingElement.visibleDockingZoneFlag=!0):t.elements.bottomDockingElement.visibleDockingZoneFlag=!1,t.rollVisibleFlag=!1):e?(t.rollVisibleFlag=!0,t.elements.bottomDockingElement.visibleDockingZoneFlag=!0):(t.rollVisibleFlag=!1,t.elements.bottomDockingElement.visibleDockingZoneFlag=!1),t._updateCarouselLayout()},getSidePanelVisibleFlag:function(){return this.sidePanelVisibleFlag},setSidePanelVisibleFlag:function(e){var t=this;"middleWidthDisplay"===t.elements.container.getAttribute("carousel-display-mode")?e?(t.sidePanelVisibleFlag=!0,t.elements.bottomDockingElement.dockingZoneContent=t.elements.rightViewContent,t.elements.bottomDockingElement.visibleDockingZoneFlag=!0):(t.sidePanelVisibleFlag=!1,t.rollVisibleFlag?(t.sidePanelVisibleFlag=!1,t.elements.bottomDockingElement.visibleDockingZoneFlag=!0,t.elements.bottomDockingElement.dockingZoneContent=t.elements.dockingZoneContentForBottom):t.elements.bottomDockingElement.visibleDockingZoneFlag=!1):e?(t.sidePanelVisibleFlag=!0,t.elements.rightDockingElement.visibleDockingZoneFlag=!0):(t.sidePanelVisibleFlag=!1,t.elements.rightDockingElement.visibleDockingZoneFlag=!1),t._updateCarouselLayout()},setCarouselHeaderVisibleFlag:function(e){!0===e?this.elements.header.style.display="":!1===e&&(this.elements.header.style.display="none")}})}),define("DS/CollectionView/LightBoxView",["UWA/Core","DS/Core/Core","DS/CollectionView/CarouselView","DS/Controls/Button","DS/Controls/TooltipModel","i18n!DS/CollectionView/assets/nls/carousel.json"],function(e,t,i,n,o,l){"use strict";return i.inherit({name:"lightbox",publishedProperties:{target:{defaultValue:document.body,type:"HTMLElement"},themeStyle:{defaultValue:"dark",type:"string"}},_preBuildView:function(){this._parent()},_postBuildView:function(){window._lb=this,this._parent(),this.elements.container.addClassName("wux-layouts-lightbox"),this._applyVisibleFlag()},_applyVisibleFlag:function(t){this.visibleFlag?this.elements.wrapper||(this.elements.wrapper=new e.Element("div",{class:"wux-layouts-lightbox-overlay",html:this.getContent()}),this.elements.wrapper.inject(this.target)):this.elements.wrapper&&(this.elements.wrapper.remove(),this.elements.wrapper=void 0,this.fire("close")),this._parent(t)},_applyToolBar:function(){this._parent();var e=this,t=new n({icon:{iconName:"close",fontIconSize:"2x",fontIconFamily:WUXManagedFontIcons.Font3DS},value:"1",displayStyle:"lite-borders",tooltipInfos:new o({shortHelp:l.close,mouseRelativePosition:!1}),clickMode:1}).inject(this.elements.headerToolbar);t.addEventListener("click",function(t){t.stopPropagation(),e.visibleFlag=!1}),this._closeButton=t}})});