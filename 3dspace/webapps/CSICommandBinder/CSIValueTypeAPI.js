define("DS/CSICommandBinder/CSIValueTypeAPI",["DS/ExperienceKernel/EKBinaryHelpers","DS/CSICommandBinder/CSIValueType","DS/CSICommandBinder/CSIValueTypePrivateAPI"],function(r,e,a){"use strict";var t={};function n(r){var t=r.readUint64();if(void 0!==t&&r.readUint32()===e.CSIBufferGuid){var n=t-4;if(void 0!==n&&n>=0)return r.readArrayBuffer(n)}return a.valueTypeError}return t.readValue=function(t,i){var o,y,d=new r.BinaryReader(t),u=d.readUint8();if(u<0||u>e.endOfTypes)return a.valueTypeError;switch(u){case e.booleanType:return d.readBool();case e.int8Type:return d.readInt8();case e.uint8Type:return d.readUint8();case e.int16Type:return d.readInt16();case e.uint16Type:return d.readUint16();case e.int32Type:return d.readInt32();case e.uint32Type:return d.readUint32();case e.int64Type:return i&&i.stringify64BitsValues_?d.readInt64AsBigInt():d.readInt64();case e.uint64Type:return i&&i.stringify64BitsValues_?d.readUint64AsBigInt():d.readUint64();case e.floatType:return d.readFloat();case e.doubleType:return d.readDouble();case e.stringType:return d.readString();case e.stringsType:return y=d.readUint64(),d.readStrings(y);case e.booleanArrayType:if(void 0===(y=d.readUint64()))return a.valueTypeError;var f=Array.prototype.slice.call(d.readBoolArray(y));for(o=0;o<f.length;++o)f[o]=!!f[o];return f;case e.int8ArrayType:return void 0===(y=d.readUint64())?a.valueTypeError:Array.prototype.slice.call(d.readInt8Array(y));case e.uint8ArrayType:return void 0===(y=d.readUint64())?a.valueTypeError:Array.prototype.slice.call(d.readUint8Array(y));case e.int16ArrayType:return void 0===(y=d.readUint64())?a.valueTypeError:Array.prototype.slice.call(d.readInt16Array(y));case e.uint16ArrayType:return void 0===(y=d.readUint64())?a.valueTypeError:Array.prototype.slice.call(d.readUint16Array(y));case e.int32ArrayType:return void 0===(y=d.readUint64())?a.valueTypeError:Array.prototype.slice.call(d.readInt32Array(y));case e.uint32ArrayType:return void 0===(y=d.readUint64())?a.valueTypeError:Array.prototype.slice.call(d.readUint32Array(y));case e.int64ArrayType:return void 0===(y=d.readUint64())?a.valueTypeError:Array.prototype.slice.call(d.readInt64Array(y));case e.uint64ArrayType:return void 0===(y=d.readUint64())?a.valueTypeError:Array.prototype.slice.call(d.readUint64Array(y));case e.floatArrayType:return void 0===(y=d.readUint64())?a.valueTypeError:Array.prototype.slice.call(d.readFloatArray(y));case e.doubleArrayType:return void 0===(y=d.readUint64())?a.valueTypeError:Array.prototype.slice.call(d.readDoubleArray(y));case e.bufferArrayType:d.readUint64();var c=[];for(o=0;d.tell()<d.getSize();){d.readUint8();var p=n(d);if(p===a.valueTypeError)return a.valueTypeError;c[o++]=p}return c;case e.binaryType:return n(d)}},e.stringifyBufferFromBinary=function(r){if(void 0===r)return r;for(var e="",a=new Uint8Array(r),t=a.byteLength,n=0;n<t;n++)e+=String.fromCharCode(a[n]);for(var i,o,y,d,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=String(e),c="",p=0,s=f.length%3;p<f.length;){if((o=f.charCodeAt(p++))>255||(y=f.charCodeAt(p++))>255||(d=f.charCodeAt(p++))>255)throw new TypeError('Failed to execute "btoa": The string to be encoded contains characters outside of the Latin1 range.');c+=u.charAt((i=o<<16|y<<8|d)>>18&63)+u.charAt(i>>12&63)+u.charAt(i>>6&63)+u.charAt(63&i)}return s?c.slice(0,s-3)+"===".substring(s):c},t.readValueTypeAsString=function(t){var n=new r.BinaryReader(t),i=n.readUint8();if(i>=0){if(i<e.binaryType||i===e.bufferArrayType)return a.valueTypeToString(i);if(i===e.binaryType){n.readUint64();var o=n.readUint32();if(void 0!==o){if(o===e.CSIBufferGuid)return a.valueTypeToString(e.binaryType);if(o===e.CSIParametersGuid)return a.readObjectTypeAsString(n);if(o===e.CSIParametersArrayGuid)return a.readObjectArrayTypeAsString(n)}}}return a.valueTypeError},t.readParametersArrayBinaries=function(a){var t=new r.BinaryReader(a);if(t.readUint8()===e.binaryType&&(void 0!==t.readUint64()&&t.readUint32()===e.CSIParametersArrayGuid)){var n=t.readUint64();if(void 0!==n){if(0===n)return t.readString();for(var i=[],o=0;o<n;++o){var y=t.readUint64();if(void 0===y)return;var d=t.readArrayBuffer(y);if(void 0===d)return;i.push(d)}return i}}},t.isObject=function(a){var t=new r.BinaryReader(a);if(t.readUint8()===e.binaryType){var n=t.readUint64(),i=t.readUint32();if(void 0!==n&&void 0!==i)return i===e.CSIParametersGuid}},t.isObjectArray=function(a){var t=new r.BinaryReader(a);if(t.readUint8()===e.binaryType){var n=t.readUint64(),i=t.readUint32();if(void 0!==n&&void 0!==i){if(i===e.CSIParametersArrayGuid)if(void 0!==t.readUint64())return!0;return!1}}},t.getObjectArraySize=function(a){var t=new r.BinaryReader(a);if(t.readUint8()===e.binaryType){var n=t.readUint64(),i=t.readUint32();if(void 0!==n&&void 0!==i&&i===e.CSIParametersArrayGuid){var o=t.readUint64();if(void 0!==o)return o}}},t.importParametersFromTypedObject=function(r,e,a){if(!r)return!1;for(var t in e)if(e.hasOwnProperty(t)){var n=e[t].type,i=e[t].value;if(!n)return!1;if(void 0===i)return!1;if(!this.writePropertyFromTypedValue(r,t,n,i,a))return!1}return!0},t.writePropertyFromTypedValue=function(a,t,n,i,o){var y=function(r){if(!function(r){return r.startsWith("[")&&r.endsWith("]")}(r)){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=String(r).replace(/[\t\n\f\r ]+/g,"");if(!/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/.test(a))throw new TypeError('Failed to execute "atob" on "Window": The string to be decoded is not correctly encoded.');a+="==".slice(2-(3&a.length));for(var t,n,i,o="",y=0;y<a.length;)t=e.indexOf(a.charAt(y++))<<18|e.indexOf(a.charAt(y++))<<12|(n=e.indexOf(a.charAt(y++)))<<6|(i=e.indexOf(a.charAt(y++))),o+=64===n?String.fromCharCode(t>>16&255):64===i?String.fromCharCode(t>>16&255,t>>8&255):String.fromCharCode(t>>16&255,t>>8&255,255&t);return Uint8Array.from(o,function(r){return r.charCodeAt(0)})}if("[]"===r)return new ArrayBuffer;for(var d=r.replace("[","").replace("]","").split(" "),u=new Uint8Array(d.length),f=0;f<d.length;++f)u[f]=parseInt(d[f],16);return u},d=e.typeNames.indexOf(n),u=n.indexOf("[]"),f=u>=0;if(f&&(n=n.substring(0,u)),-1===d){if(!f){var c=new a.constructor;return!!this.importParametersFromTypedObject(c,i,o)&&a.writeParameters(t,n,c)}if(f){for(var p=[],s=0;s<i.length;++s){var l=new a.constructor,v=o<3?i[s]:i[s].value;if(!this.importParametersFromTypedObject(l,v,o))return!1;o>=3&&l.declareAsObject(i[s].type),p.push(l)}return a.writeParametersArray(t,n,p)}}else if("buffer"===n){if(!f)return a.writeBuffer(t,y(i));for(var A,T,U,h=i.replace("[","").substring(0,i.length-2).split(","),g=[],b=0;b<h.length;b++)U=(A=y(h[b]))instanceof ArrayBuffer?A.byteLength:A.length,(T=new r.BinaryWriter(U)).writeArrayBuffer(A),g[b]=T.createArrayBuffer();return a.writeBufferArray(t,g)}var S="write"+n.charAt(0).toUpperCase()+n.slice(1);return u>=0&&(S+="Array"),a[S](t,i)},t});