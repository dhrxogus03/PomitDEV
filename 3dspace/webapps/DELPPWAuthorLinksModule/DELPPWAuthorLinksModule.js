define("DS/DELPPWAuthorLinksModule/AuthorLinksUI",["UWA/Core"],function(e){"use strict";return function(t,n,r){var i,a,s,o,c,l,u,f,I,h,g,P,d,p,D,L,m,k,A=r.getComponent("Button"),S=r.getComponent("TooltipModel"),y=r.getComponent("Accordeon"),R={dialogTitle:null,parentAccHeader:null,childAccHeader:null,modalFlag:null},b=null,v=null;return P=function(a){d(),e.is(r)?((i=r.create("Dialog",{title:R.dialogTitle,domId:"AuthorLinks-UI",content:I,modalFlag:R.modalFlag,resizableFlag:!0,buttons:{Cancel:new A({onClick:function(){i.close()}}),Apply:new A({label:n.getNLSValue("AuthorLinks.Switch"),icon:n.getIconURLFromKey("SwitchFromTo"),class:"AuthorLinksUI-SwitchBtn",tooltipInfos:new S({shortHelp:n.getNLSValue("AuthorLinks.tooltipSwitchFromTo")}),onClick:function(){a()}})}})).close=function(){e.is(I)&&I.destroy(),this.destroy(),i=null},i.buttons.Apply.hide()):t.debug("uxFactoryBehavior is not available.")},d=function(){I=r.createElement("div",{class:"AuthorLinksUI-Dialog"}),a=r.createElement("div",{class:"fromToDiv-section"}).inject(I),s=r.createElement("div",{class:"instanceOrMoveSection-container"}).inject(I),o=r.createElement("div",{class:"instance-withAccordeon-section"}).inject(s),c=r.createElement("div",{class:"instance-section"}).inject(o),l=r.createElement("div",{class:"linkSection-container"}).inject(I),u=r.createElement("div",{class:"link-withAccordeon-section"}).inject(l),f=r.createElement("div",{class:"link-section"}).inject(u),h=r.create("SelectionControl",{title:R.parentAccHeader,message:n.getNLSValue("AuthorLinks.SelectAnObject"),renderTo:a,multiSelection:!0}),g=r.create("SelectionControl",{title:R.childAccHeader,message:n.getNLSValue("AuthorLinks.SelectAnObject"),renderTo:a,multiSelection:!0})},p=function(e,t,n){return new y({items:[{header:e,content:t,expandedFlag:!0}],style:"filled-separate"}).inject(n)},D=function(t,n){e.is(t)&&h.updateLabel(t),e.is(n)&&g.updateLabel(n)},L=function(e,t,n){"parentSection"===e&&h.updateAccordeon(t,n),"childSection"===e&&g.updateAccordeon(t,n),"instanceSection"===e&&v.updateItem(t,n)},m=function(){u&&(u.empty(),f.empty(),b=null)},k=function(){e.is(o)&&(o.empty(),c.empty(),v=null)},{buildSkeleton:function(t,n){e.is(t)&&e.extend(R,t),e.is(i)||P(n)},createInstanceOrMoveButton:function(t){var r,a;for(a in e.is(v)||(v=p(n.getNLSValue("AuthorLinks.MoveOrCreateInstanceTitle"),c,o)),r=function(e){new A({label:e.label,icon:e.icon,tooltipInfos:new S({shortHelp:e.tooltipInfos}),onClick:function(){e.callback(),i.close()}}).inject(c)},t)e.is(t[a])&&r(t[a])},createLinkButtons:function(t,a){var s,o,c;for(o in e.is(b)||(b=p(n.getNLSValue("AuthorLinks.LinksUITitle"),f,u)),t)if(t.hasOwnProperty(o)){if(1===(c=Object.keys(t[o])).length){let e={linkType:o,linksData:t[o][c[0]]};s=e.linksData[0].displayText,new A({icon:n.getIconURLFromKey(o),label:s,value:s,tooltipInfos:new S({shortHelp:n.getNLSValue(o,null,"CreateLink")}),onClick:function(){a(e),i.close()}}).inject(f)}else{let e=r.getComponent("ComboBox"),s=[];c.forEach(function(e){let r={linkType:o,linksData:t[o][e]};s.push({icon:n.getIconURLFromKey(o),label:t[o][e][0].displayText,value:r})});let l=new e({elementsList:s,enableSearchFlag:!1,actionOnClickFlag:!0,tooltipInfos:new S({shortHelp:n.getNLSValue(o,null,"CreateLink")})});l.addEventListener("click",function(e){a(l.value),i.close()}),l.inject(f)}c.forEach(function(e){t[o][e].forEach(function(e){delete e.displayText,delete e.buttonIdentifier})})}},switchLabels:function(e,t){h.updateLabel(e),g.updateLabel(t)},updateLabels:function(e,t){D(e,t)},isVisible:function(){return!!e.is(i)&&i.visibleFlag},updateDialogTitle:function(e){i.title=e},updateAccordeonHeader:function(e,t,n){L(e,t,n)},showSwitchButton:function(){null!==i&&i.buttons.Apply.show()},hideSwitchButton:function(){i.buttons.Apply.hide()},showMessages:function(e,n){"info"===n?i.info(e):"warning"===n?i.warning(e):"error"===n?i.error(e):t.debug("type of message is invalid")},clearMessages:function(){i.clearMessages()},destroyDialog:function(){e.is(i)&&(i.destroy(),i=null)},emptyLinkUIContainer:function(){m()},emptyInstanceUIContainer:function(){k()}}}}),define("DS/DELPPWAuthorLinksModule/AuthorLinksUIManager",["UWA/Core","DS/DELPPWAuthorLinksModule/AuthorLinksUI"],function(e,t){"use strict";return function(n,r,i,a,s){var o,c,l,u,f,I,h,g=new t(n,r,i),P={},d=!1,p=!1,D=!1,L={_parameters:[],_isSwitched:!1,_isMultiParent:!1,set:function(t){this._parameters=e.is(t,"array")?t.slice(0):[]},get:function(){return this._parameters||[]},setMultiParent:function(e){this._isMultiParent=e||!1},isMultiParent:function(){return this._isMultiParent},isUnique:function(e){return this.getChilds().indexOf(e)<0&&this.getParents().indexOf(e)<0},getChilds:function(){return this._parameters.map(function(e){return e.referencePID}).filter(function(e,t,n){return n.indexOf(e)===t})},getParents:function(){return this._parameters.map(function(e){return e.targetReferencePID}).filter(function(e,t,n){return n.indexOf(e)===t})},isEmpty:function(){return e.is(this._parameters)&&this._parameters.length<1},swap:function(){this.isEmpty()||(this._parameters=this._parameters.map(function(e){return{rootReferencePID:e.targetRootReferencePID,referencePID:e.targetReferencePID,instancePID:e.targetInstancePID,instancePIDsArray:e.targetInstancePIDsArray,targetRootReferencePID:e.rootReferencePID,targetReferencePID:e.referencePID,targetInstancePID:e.instancePID,targetInstancePIDsArray:e.instancePIDsArray,allowMove:e.allowMove}}),this._isSwitched=!this._isSwitched)},getToFromLabel:function(){var e={firstFromLabel:"",toLabel:""};return this._parameters.forEach(function(t,n){var r=a.getReference(t.targetReferencePID),i=a.getReference(t.referencePID),s=0===n?"":", ";r&&i&&(0===n&&(e.firstFromLabel=r.get("PLMEntity.V_Name")),e.toLabel+=s+i.get("PLMEntity.V_Name"))}),e},reset:function(){this._parameters=[],this._isSwitched=!1,this._isMultiParent=!1},isSwitched:function(){return this._isSwitched},isParentChildAvailable:function(){return this._parameters.every(function(t){return e.is(t.targetReferencePID)&&e.is(t.referencePID)})}};return o=function(e){g.destroyDialog(),g.buildSkeleton(e,function(){L.swap(),u()})},u=function t(){var n=L.get(),i=!0,o=!0,l=!0,u=!0,h=P.isInstanceUI&&!P.isLinkUI,m=P.isInstanceUI&&P.isLinkUI,k=[],A=[],S={},y={},R={},b=null,v=null;if(!L.isEmpty()){if(p=!1,d=!1,D=!1,n.forEach(function(t){var n=a.getReference(t.targetReferencePID),r=a.getReference(t.referencePID),c=a.getInstance(t.targetInstancePID),f=a.getInstance(t.instancePID),I={parent:n,child:r,targetAbsPath:t.targetInstancePIDsArray};if(e.is(n)&&e.is(r)){if(a.isReferencesHasReadOnlyType([n,r])&&(u=i=o=l=!1),i){const{isInstancePossible:e,errorMessage:t}=a.computeIsInstancePossible(I);i=e}if(I={parent:r,child:n,targetAbsPath:t.instancePIDsArray},u){const{isInstancePossible:e,errorMessage:t}=a.computeIsInstancePossible(I);u=e}o=o&&s.isLinkPossible(n,r,c,f),l=l&&i&&a.isMovePossible(n,f)}n&&k.push(n),r&&A.push(r)}),h&&!i&&u){L.swap();let e=A;A=k,k=e,i=!0,u=!1}L.getParents().length>1?g.updateLabels(k,A[0]):g.updateLabels(k[0],A),g.clearMessages(),g.emptyInstanceUIContainer(),g.emptyLinkUIContainer(),L.isParentChildAvailable()&&(P.isInstanceUI&&i||P.isLinkUI&&o?(P.isInstanceUI&&i&&(R={header:r.getNLSValue("AuthorLinks.InstanceUITitle")},b={label:r.getNLSValue("AuthorLinks.tooltipInstanceBtn"),icon:r.getIconURLFromKey("CreateInstance"),tooltipInfos:r.getNLSValue("AuthorLinks.tooltipInstanceBtn"),callback:c},l&&(R={header:r.getNLSValue("AuthorLinks.MoveOrCreateInstanceTitle")},v={label:r.getNLSValue("AuthorLinks.tooltipMoveBtn"),icon:r.getIconURLFromKey("MoveInstance"),tooltipInfos:r.getNLSValue("AuthorLinks.tooltipMoveBtn"),callback:I}),g.createInstanceOrMoveButton({instanceObj:b,moveObj:v}),g.updateAccordeonHeader("instanceSection",0,R),i&&u&&(p=!0)),P.isLinkUI&&o?f(null,{onComplete:function(){(p||d)&&g.showSwitchButton(),m&&!D&&!i&&u&&(L.swap(),t())}}):p&&g.showSwitchButton()):g.showMessages(P.errorMsg,"error"),!(P.isDragDrop&&P.isLinkUI&&o)||P.isInstanceUI&&i||(S={header:r.getNLSValue("AuthorLinks.From")},y={header:r.getNLSValue("AuthorLinks.To")},g.updateDialogTitle(r.getNLSValue("AuthorLinks.LinksUITitle")),g.updateAccordeonHeader("parentSection",0,S),g.updateAccordeonHeader("childSection",0,y)))}},c=function(){var e=L.getToFromLabel();a.createMultipleInstances(L.get(),e.firstFromLabel,e.toLabel)},I=function(){var t=L.get(),n=L.getToFromLabel(),r={instancesPIDsToReparent:null,formerInstancesParentPIDs:null,newParentPID:null,newParentInstancesOrder:null};t.forEach(function(t,n){var i=a.getInstance(t.instancePID),s=e.is(i)?i.get("isAggregatedBy"):null;0===n&&(r.instancesPIDsToReparent=[],r.formerInstancesParentPIDs=[],r.newParentPID=t.targetReferencePID,r.newParentInstancesOrder=a.getInstancesFromCollection(t.targetReferencePID).map(function(e){return e.get("PID")})),r.instancesPIDsToReparent.push(t.instancePID),r.formerInstancesParentPIDs.push(s),r.newParentInstancesOrder.push(null)}),a.moveMultipleInstances(r,n.firstFromLabel,n.toLabel)},f=function(t,n){var i,o,c=[],l=[],u={},f={},I=[],h=[],P={},p=L.get(),m=function(e){s.createConnectionsByType(e)},k=function(e){var t;return t=function(e){var t,n;for(t in e)if(e.hasOwnProperty(t)){let r=e[t];(n=Object.keys(r)).length>1&&n.forEach(function(e){r[e].length!==p.length&&delete r[e]})}return e}(e),Object.keys(t).forEach(function(t){0===Object.keys(e[t]).length&&delete e[t]}),e},A=function(e){var t;return t=function(e){var t,n={};for(t in e)if(e.hasOwnProperty(t)){let r,i=e[t].data,a={};r=function(e,t){var n=e.buttonIdentifier;t.hasOwnProperty(n)?t[n].push(e):t[n]=[e]},i.forEach(function(e){r(e,a)}),n[t]=a}return n}(e),t=k(t)};n=n||{},Array.isArray(p)&&p.length>0&&(o=[],p.forEach(function(t){var n=t.instancePID||t.referencePID,r=t.instancePIDsArray||[];e.is(P[n])||(o.push({id:n,path:r}),P[n]=!0),n=t.targetInstancePID||t.targetReferencePID,r=t.targetInstancePIDsArray||[],e.is(P[n])||(o.push({id:n,path:r}),P[n]=!0)})),s.getRelations(o).then(function(o){if(o.isRelationsLoaded){if(g.emptyLinkUIContainer(),p.forEach(function(e,t){var n,r,i,o=a.getReference(e.targetReferencePID),c=a.getReference(e.referencePID),l={fromSideAbsPath:e.targetInstancePIDsArray,toSideAbsPath:e.instancePIDsArray,fromSideRefPID:e.targetReferencePID,toSideRefPID:e.referencePID,fromSideInstPID:e.targetInstancePID,toSideInstPID:e.instancePID,fromSideRootRefPID:e.targetRootReferencePID,toSideRootRefPID:e.rootReferencePID,startAnchorId:e.startAnchorId,endAnchorId:e.endAnchorId},g=function(t){return{fromSideAbsPath:t.toSideAbsPath,toSideAbsPath:t.fromSideAbsPath,fromSideRefPID:t.toSideRefPID,toSideRefPID:t.fromSideRefPID,fromSideInstPID:e.instancePID,toSideInstPID:e.targetInstancePID,fromSideRootRefPID:e.rootReferencePID,toSideRootRefPID:e.targetRootReferencePID}},P=function(e,t){var n,r={};for(n in e)t.hasOwnProperty(n)&&(r[n]={data:e[n].data.concat(t[n].data)});return r};0===t?(u=s.getPossibleRelationTypes(l),i=g(l),f=s.getPossibleRelationTypes(i)):(n=s.getPossibleRelationTypes(l),u=P(n,u),i=g(l),r=s.getPossibleRelationTypes(i),f=P(r,f)),I.push(o),h.push(c)}),u=A(u),f=A(f),c=Object.keys(u),l=Object.keys(f),d=c.length>0&&l.length>0,D=c.length>0||l.length>0,0===c.length&&l.length>0&&(L.swap(),i=h,h=I,I=i,L.getParents().length>1?g.updateLabels(I,h[0]):g.updateLabels(I[0],h),c=l,u=f),e.is(t)){if(c.indexOf(t)>-1){let e={linkType:t,linksData:Object.values(u[t])[0]};m(e)}return}if(c.length<1)g.showMessages(r.getNLSValue("AuthorLinks.LinkNotPossible"),"error");else{let t,n;for(t in g.createLinkButtons(u,m),u)u.hasOwnProperty(t)&&Object.values(u[t])[0].forEach(function(t){e.is(t.linkExistsInfoMessage)&&(n=e.is(n)?n+t.linkExistsInfoMessage+". ":t.linkExistsInfoMessage+". ")});e.is(n)&&g.showMessages(n,"warning")}e.is(n.onComplete)&&n.onComplete()}})},l=function(t){var n=[],r=L.get().slice(0),i=function(e,t){var n;return e=e||{},t=t||{},L.isSwitched()&&(n=t,t=e,e=n),{targetRootReferencePID:e.targetRootReferencePID||null,targetReferencePID:e.targetReferencePID||e.referenceId,targetInstancePID:e.targetInstancePID||e.instanceId,targetInstancePIDsArray:e.targetInstancePIDsArray||e.path,rootReferencePID:null,referencePID:t.referenceId||t.referencePID,instancePID:t.instanceId||t.instancePID,instancePIDsArray:t.path||t.instancePIDsArray}};e.is(t,"array")&&t.length>0&&(0===r.length?(t.forEach(function(e){n.push(i(e))}),L.setMultiParent(n.length>1)):L.isMultiParent()?n=r.map(function(e){return i(e,t[0])}):L.isParentChildAvailable()?(n=r,L.isUnique(t[0].referenceId)&&n.push(i(r[r.length-1],t[0]))):L.isUnique(t[0].referenceId)&&n.push(i(r[0],t[0])),L.set(n))},h=function(){var t,n=!1,r=new Set;return L.get().forEach(function(t){var n,i,o,c;t.linkType&&(n=a.getReference(t.targetReferencePID),i=a.getReference(t.referencePID),o=a.getInstance(t.targetInstancePID),c=a.getInstance(t.instancePID),e.is(n)&&e.is(i)&&s.isLinkPossible(n,i,o,c)&&r.add(t.linkType))}),1===r.size&&(n=!0,t=r.values().next().value,f(t)),n},{createLinkOrInstanceUI:function(t){var n={};e.is(t,"array")&&t.length>0&&(P.isLinkUI=!0,P.isInstanceUI=!0,P.isDragDrop=!0,P.errorMsg=r.getNLSValue("AuthorLinks.NoPossibleAction"),n={dialogTitle:r.getNLSValue("AuthorLinks.AuthorLinksUITitle"),parentAccHeader:r.getNLSValue("AuthorLinks.FromOrParent"),childAccHeader:r.getNLSValue("AuthorLinks.ToOrChild"),modalFlag:!0},L.set(t),h()||(o(n),u()))},createLinkUI:function(e){var t;P.isLinkUI=!0,P.isInstanceUI=!1,P.isDragDrop=!1,P.errorMsg=r.getNLSValue("AuthorLinks.LinkNotPossible"),l(e),t={dialogTitle:r.getNLSValue("AuthorLinks.LinksUITitle"),parentAccHeader:r.getNLSValue("AuthorLinks.From"),childAccHeader:r.getNLSValue("AuthorLinks.To"),modalFlag:!1},o(t),u()},createInstanceUI:function(e){var t;P.isLinkUI=!1,P.isInstanceUI=!0,P.isDragDrop=!1,P.errorMsg=r.getNLSValue("AuthorLinks.InstanceNotPossible"),l(e),t={dialogTitle:r.getNLSValue("AuthorLinks.InstanceUITitle"),parentAccHeader:r.getNLSValue("AuthorLinks.Parent"),childAccHeader:r.getNLSValue("AuthorLinks.Child"),modalFlag:!1},o(t),u()},updateSelectionUI:function(e){l(e),u()},isDialogVisible:function(){return g.isVisible()},reset:function(){L.reset()}}}}),define("DS/DELPPWAuthorLinksModule/AuthorLinksModule",["UWA/Core","DS/DELPPWAuthorLinksModule/AuthorLinksUIManager"],function(e,t){"use strict";return{behaviors:["UXFactoryBehavior","ResourceBehavior","ModelBehavior","LinkBehavior","ProductImplementBehavior","ProcessImplementBehavior","ProductFlowLinkBehavior","CapableResourceLinkBehaviour","MfgProcessBehavior","SelectionBehavior"],creator:function(n,r,i,a,s,o,c,l,u,f,I){var h=new t(n,i,r,a,s),g=function(t){var n,r,i,s=[];return e.is(t,"array")&&t.forEach(function(t){n=a.getInstance(t.id),i=e.is(n)?n.get("isInstanceOf"):t.id,r=e.is(n)?n.get("PID"):null,s.push({referenceId:i,instanceId:r,path:t.path})}),s},P=function(){var t,n=I.getSelectionsWithPaths(),r=[],i=[];return e.is(n,"array")&&n.forEach(function(n){e.is(n,"array")&&n.length>0&&(0===i.length||0===r.length)&&(t=[],n.forEach(function(e){t.push({id:e.id,path:e.path})}),0===i.length&&t.length>0?i=g(t):0===r.length&&t.length>0&&(r=g(t)))}),{target:i,source:r}},d=function(){h.reset()};return{name:"AuthorLinksModule",listenTo:function(){return{select:this.onSelect,CreateLinkOrInstance:this.onCreateLinkOrInstance,CreateCapableResourceStructureLink:this.onCreateCapableResourceStructureLink,CreateLink:this.onCreateLink,CreatePartialScopeLinkOnHeaderOperation:this.onCreatePartialScopeLinkOnHeaderOperation,CreateInstance:this.onCreateInstance}},onStart:function(){},onStop:function(){},onCreateLinkOrInstance:function(t){var r,i,l=[],u=t[0].targetReferencePID,f=t[0].targetInstancePIDsArray,I=a.getReference(t[0].referencePID),g=a.getReference(t[0].targetReferencePID),P=n.getPreferenceValue("isOutputActivated");e.is(t,"array")&&(d(),I.isProcess()&&a.isSystem(u)?P?h.createLinkOrInstanceUI(t):(t.forEach(function(e){l.push({implementedAbsPath:e.instancePIDsArray,implementedPID:e.referencePID,implementingAbsPath:e.targetInstancePIDsArray,implementingPID:e.targetReferencePID})}),c.createScopeLink(l)):I.isProcess()&&a.isOperation(u)&&(r=t,i=!1,Array.isArray(r)&&r.length>0&&(i=null===r[0].instancePID||null===r[0].targetInstancePID),!i)?(t.forEach(function(e){l.push({implementedAbsPath:e.instancePIDsArray,implementingAbsPath:f,implementingPID:e.targetReferencePID,type:c.getImplementLinkType()})}),s.createConnection(l)):(I.isProduct()||I.isPart())&&(g.isProcess()||g.isService()||g.isConstruction())?function(e){var t=[],n=[];e.length>0&&((t=[{instancePID:e[0].targetInstancePID,instancePIDsArray:e[0].targetInstancePIDsArray,referencePID:e[0].targetReferencePID,rootReferencePID:e[0].targetRootReferencePID}]).forEach(function(e){n=n.concat(e.instancePIDsArray),e.instancePIDsArray.forEach(function(e){var t=a.getReferenceIdFromInstance(e);n.push(t)})}),s.getRelations([{id:t[0].instancePID,path:n}]).then(function(t){t.isRelationsLoaded&&o.consumeImplementedItems(e)}))}(t):I.isOrganization()&&(g.isProcess()||g.isService()||g.isConstruction()||g.isSystem()||g.isOperation())&&s.isRelationTypeConfiguredForPPRTypes("DELMfgResponsibilityCnx",g.get("PPRTYPE"),I.get("PPRTYPE"),"write")?(t.forEach(function(e){l.push({IDFrom:e.targetReferencePID,IDTo:e.referencePID,fromSideRefPID:e.targetReferencePID,fromSideRootRefPID:e.targetRootReferencePID,toSideRefPID:e.referencePID,toSideRootRefPID:e.rootReferencePID,type:"DELMfgResponsibilityCnx"})}),s.createConnection(l)):h.createLinkOrInstanceUI(t))},onCreateCapableResourceStructureLink:function(){var t,n=[];I.getSelectionsWithPaths().forEach(function(t){e.is(t,"array")&&t.length>0&&t.forEach(function(e){n.push({id:e.id,path:e.path})})}),t=g(n),e.is(t,"array")&&1===t.length&&u.createCapableResourceStructureLink(t[0].referenceId)},onCreateLink:function(){var t=P();d(),e.is(t)&&(Array.isArray(t.target)&&h.createLinkUI(t.target),Array.isArray(t.source)&&h.updateSelectionUI(t.source))},onCreatePartialScopeLinkOnHeaderOperation:function(t){var r=s.canCreatePartialScopeLink(t);e.is(r.errorMessage)?n.warn(r.errorMessage):s.createHOPMfgItemPartialScopeLink(r.linksData)},onCreateInstance:function(){var t=P();d(),e.is(t)&&(t.target&&h.createInstanceUI(t.target),t.source.length>0&&h.updateSelectionUI(t.source))},onSelect:function(e){var t={},n=[];e&&h.isDialogVisible()&&!0===e.changed.isSelected&&(n.push({id:e.changed.nodeId,path:e.changed.absPath}),(t=g(n))&&h.updateSelectionUI(t))}}}}});