define("DS/MPFBankAccountModel/BankAccountModel",["UWA/Core","DS/MPFModel/MPFModel","DS/MPFModel/ModelValidator","i18n!DS/MPFBankAccountModel/assets/nls/BankAccountModel"],function(t,n,e,o){"use strict";const a={BANK_ACCOUNT_ID:"bankAccountId",SHOP_ID:"shopId",COUNTRY:"country",IBAN:"iban",SWIFT:"swift",BSB_NUMBER:"bsbNumber",ABA_NUMBER:"abaNumber",TRANSIT_NUMBER:"transitNumber",ACCOUNT_NUMBER:"accountNumber",BANK_NUMBER:"bankNumber"},r={};r[a.BANK_ACCOUNT_ID]=null,r[a.SHOP_ID]=null,r[a.COUNTRY]=null,r[a.IBAN]=null,r[a.SWIFT]=null,r[a.BSB_NUMBER]=null,r[a.ABA_NUMBER]=null,r[a.TRANSIT_NUMBER]=null,r[a.ACCOUNT_NUMBER]=null,r[a.BANK_NUMBER]=null;const s=n.extend({idAttribute:"bank_account_id",defaults:r,setup:function(t,n){this._parent(t,n),this.constraints=n.constraints||null,this._type="BankAccountModel",this.validator=new e({model:this})},parse:function(t){const n={};return n.bank_account_id=t.bank_account_id,n[a.IBAN]=t.IBAN||null,n[a.SWIFT]=t.BIC||null,n[a.BSB_NUMBER]=t.bsbNumber||null,n[a.ABA_NUMBER]=t.abaNumber||null,n[a.TRANSIT_NUMBER]=t.transitNumber||null,n[a.ACCOUNT_NUMBER]=t.accountNumber||null,n[a.BANK_NUMBER]=t.bankNumber||null,n},validate:function(t){return this.validator.validate(t)}});return s.Fields=Object.freeze(a),s}),define("DS/MPFBankAccountModel/ShopBankAccountDataProxy",["UWA/Core","UWA/String","DS/MPFUrl/UrlUtils","DS/MPFDataProxy/DataProxy"],function(t,n,e,o){"use strict";return o.extend({init:function(t){this._parent(t,"/mdshop/shops/{0}/bank")},urlGet(n){const e=n.parentResourceId||n.get("shopId"),o=t.String.format(this.resourcePath,e);return this.connector.url(o)},urlPost(n,{stripeAccountToken:o,stripeBankToken:a}={}){const r=n.parentResourceId||n.get("shopId"),s=t.String.format(this.resourcePath,r),c=new e(this.connector.url(s));a&&c.addParameter("bankToken",a),o&&c.addParameter("accountToken",o);const i=new URLSearchParams(document.location.search);return i.has("forcePSP")&&c.addParameter("forcePSP",i.get("forcePSP")),c.getUrl()},request:function(t,n){let e;return"PATCH"!==n.method&&"PUT"!==n.method||(n.method="POST"),n.data&&((e=JSON.parse(n.data)).IBAN=e.iban,e.BIC=e.swift,delete e.iban,delete e.swift,n.data=JSON.stringify(e)),this._parent(t,n)},buildPath(t){const e=t.parentResourceId||t.get("shopId");return n.format(this.resourcePath,e)}})}),define("DS/MPFBankAccountModel/BankAccountFactory",["UWA/Core","UWA/Promise","DS/MPFModelFactory/Factory","DS/MPFBankAccountModel/BankAccountModel","DS/MPFBankAccountConstraintsModel/BankAccountConstraintsCollection","DS/MPFBankAccountModel/ShopBankAccountDataProxy","DS/MPFBankAccountConstraintsModel/BankAccountConstraintsDataProxy"],function(t,n,e,o,a,r,s){"use strict";const c=Object.freeze({BANK_ACCOUNT:"bankAccount"});return e.extend({init:function(t,e){this._parent(t,e),this.bankAccountsConstraints=new a([],{dataProxy:this.getDataProxy("constraints")});const o=n.deferred();this.bankAccountsConstraints.fetch({onComplete:function(){o.resolve()},onFailure:function(){o.reject(new Error("initialization failed"))}}),this.promise=o.promise},whenReady:function(){return this.promise},createModel:function(t,n){return t=t||{},(n=n||{}).constraints=this.bankAccountsConstraints,n.dataProxy=this.getDataProxy(c.BANK_ACCOUNT),this._parent(o,c.BANK_ACCOUNT,t,n)},getConstraints:function(){return this.bankAccountsConstraints},getDataProxy:function(t){let n=null;return t===c.BANK_ACCOUNT?(this.dataProxies.bankAccount=this.dataProxies.bankAccount||new r(this.connector),n=this.dataProxies.bankAccount):"constraints"===t&&(this.dataProxies.constraints=this.dataProxies.constraints||new s(this.connector),n=this.dataProxies.constraints),n}})});